<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Baseline Pages: 1 -->
<svg width="13765pt" height="18565pt"
 viewBox="0.00 0.00 13764.85 18565.24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 18561.24)">
<title>Baseline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-18561.24 13760.85,-18561.24 13760.85,4 -4,4"/>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="none" stroke="black" cx="8305.42" cy="-18530.37" rx="239" ry="26.74"/>
<text text-anchor="middle" x="8305.42" y="-18534.17" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="8305.42" y="-18519.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- QKV_s0_l1_tp0 -->
<g id="node2" class="node">
<title>QKV_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7546.42,-18467.5 7208.42,-18467.5 7208.42,-18414.5 7546.42,-18414.5 7546.42,-18467.5"/>
<text text-anchor="middle" x="7377.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7377.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7377.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp0 -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M8110.21,-18514.83C7964.16,-18503.44 7759.6,-18486.39 7580.42,-18467.5 7572.66,-18466.68 7564.74,-18465.82 7556.73,-18464.92"/>
<polygon fill="black" stroke="black" points="7556.89,-18461.41 7546.56,-18463.76 7556.1,-18468.37 7556.89,-18461.41"/>
</g>
<!-- QKV_s0_l1_tp1 -->
<g id="node3" class="node">
<title>QKV_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="7927.42,-18467.5 7589.42,-18467.5 7589.42,-18414.5 7927.42,-18414.5 7927.42,-18467.5"/>
<text text-anchor="middle" x="7758.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7758.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7758.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp1 -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M8171.96,-18508.05C8098.56,-18496.33 8006.74,-18481.66 7928.28,-18469.13"/>
<polygon fill="black" stroke="black" points="7928.71,-18465.65 7918.28,-18467.53 7927.61,-18472.57 7928.71,-18465.65"/>
</g>
<!-- QKV_s0_l1_tp2 -->
<g id="node4" class="node">
<title>QKV_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="8296.42,-18467.5 7958.42,-18467.5 7958.42,-18414.5 8296.42,-18414.5 8296.42,-18467.5"/>
<text text-anchor="middle" x="8127.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8127.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="8127.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp2 -->
<g id="edge3" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8253.94,-18504.1C8233.45,-18494.04 8209.72,-18482.4 8188.39,-18471.92"/>
<polygon fill="black" stroke="black" points="8189.93,-18468.78 8179.41,-18467.52 8186.84,-18475.06 8189.93,-18468.78"/>
</g>
<!-- QKV_s0_l1_tp3 -->
<g id="node5" class="node">
<title>QKV_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="8669.42,-18467.5 8331.42,-18467.5 8331.42,-18414.5 8669.42,-18414.5 8669.42,-18467.5"/>
<text text-anchor="middle" x="8500.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8500.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8500.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp3 -->
<g id="edge4" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8361.56,-18504.22C8384.21,-18494.07 8410.51,-18482.28 8434.09,-18471.72"/>
<polygon fill="black" stroke="black" points="8435.63,-18474.86 8443.33,-18467.58 8432.77,-18468.48 8435.63,-18474.86"/>
</g>
<!-- QKV_s0_l1_tp4 -->
<g id="node6" class="node">
<title>QKV_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="9043.42,-18467.5 8705.42,-18467.5 8705.42,-18414.5 9043.42,-18414.5 9043.42,-18467.5"/>
<text text-anchor="middle" x="8874.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8874.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8874.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp4 -->
<g id="edge5" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8442.44,-18508.33C8519.22,-18496.54 8615.82,-18481.71 8698.19,-18469.06"/>
<polygon fill="black" stroke="black" points="8698.81,-18472.51 8708.16,-18467.53 8697.75,-18465.59 8698.81,-18472.51"/>
</g>
<!-- QKV_s0_l1_tp5 -->
<g id="node7" class="node">
<title>QKV_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="9429.42,-18467.5 9091.42,-18467.5 9091.42,-18414.5 9429.42,-18414.5 9429.42,-18467.5"/>
<text text-anchor="middle" x="9260.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9260.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9260.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp5 -->
<g id="edge6" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M8502.61,-18515.16C8653.33,-18503.79 8866.17,-18486.62 9052.42,-18467.5 9061.82,-18466.53 9071.46,-18465.5 9081.18,-18464.43"/>
<polygon fill="black" stroke="black" points="9081.79,-18467.88 9091.34,-18463.29 9081.02,-18460.92 9081.79,-18467.88"/>
</g>
<!-- QKV_s0_l1_tp6 -->
<g id="node8" class="node">
<title>QKV_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="9817.42,-18467.5 9479.42,-18467.5 9479.42,-18414.5 9817.42,-18414.5 9817.42,-18467.5"/>
<text text-anchor="middle" x="9648.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9648.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9648.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp6 -->
<g id="edge7" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M8530.91,-18521.46C8759.79,-18512.4 9124.2,-18495.13 9438.42,-18467.5 9448.47,-18466.62 9458.78,-18465.63 9469.18,-18464.57"/>
<polygon fill="black" stroke="black" points="9469.59,-18468.05 9479.18,-18463.53 9468.87,-18461.08 9469.59,-18468.05"/>
</g>
<!-- QKV_s0_l1_tp7 -->
<g id="node9" class="node">
<title>QKV_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="7139.42,-18467.5 6801.42,-18467.5 6801.42,-18414.5 7139.42,-18414.5 7139.42,-18467.5"/>
<text text-anchor="middle" x="6970.42" y="-18452.3" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6970.42" y="-18437.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6970.42" y="-18422.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;QKV_s0_l1_tp7 -->
<g id="edge8" class="edge">
<title>Input&#45;&gt;QKV_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M8083,-18520.53C7859.49,-18510.79 7505.22,-18493.06 7199.42,-18467.5 7183.33,-18466.15 7166.62,-18464.6 7149.88,-18462.93"/>
<polygon fill="black" stroke="black" points="7149.76,-18459.4 7139.46,-18461.88 7149.06,-18466.37 7149.76,-18459.4"/>
</g>
<!-- ResAttn_s0_l1_tp0 -->
<g id="node36" class="node">
<title>ResAttn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7625.77,-17889.59 7068.45,-17889.59 6925.08,-17783.59 7482.4,-17783.59 7625.77,-17889.59"/>
<text text-anchor="middle" x="7275.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7275.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7275.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp0 -->
<g id="edge50" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M8069.28,-18525.98C7657.12,-18519.18 6844.96,-18501.54 6792.42,-18467.5 6744.71,-18436.59 6735.42,-18409.85 6735.42,-18353 6735.42,-18353 6735.42,-18353 6735.42,-18051.07 6735.42,-17979.68 6900.73,-17921.93 7048.42,-17884.59"/>
<polygon fill="black" stroke="black" points="7049.27,-17887.99 7058.12,-17882.16 7047.57,-17881.2 7049.27,-17887.99"/>
</g>
<!-- ResAttn_s0_l1_tp1 -->
<g id="node37" class="node">
<title>ResAttn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5834.77,-17889.59 5277.45,-17889.59 5134.08,-17783.59 5691.4,-17783.59 5834.77,-17889.59"/>
<text text-anchor="middle" x="5484.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5484.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5484.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp1 -->
<g id="edge52" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M8069.22,-18526.21C7410.37,-18515.85 5600.42,-18476.19 5600.42,-18353 5600.42,-18353 5600.42,-18353 5600.42,-18051.07 5600.42,-17994.44 5568.52,-17938.5 5538.18,-17898.09"/>
<polygon fill="black" stroke="black" points="5540.81,-17895.77 5531.94,-17889.97 5535.25,-17900.03 5540.81,-17895.77"/>
</g>
<!-- ResAttn_s0_l1_tp2 -->
<g id="node38" class="node">
<title>ResAttn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6691.77,-17889.59 6134.45,-17889.59 5991.08,-17783.59 6548.4,-17783.59 6691.77,-17889.59"/>
<text text-anchor="middle" x="6341.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6341.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6341.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp2 -->
<g id="edge54" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8068.36,-18526.95C7695.46,-18521.97 6988.75,-18507.44 6740.42,-18467.5 6558.27,-18438.2 6341.42,-18537.49 6341.42,-18353 6341.42,-18353 6341.42,-18353 6341.42,-18051.07 6341.42,-18000.22 6341.42,-17942.57 6341.42,-17900"/>
<polygon fill="black" stroke="black" points="6344.92,-17899.79 6341.42,-17889.79 6337.92,-17899.79 6344.92,-17899.79"/>
</g>
<!-- ResAttn_s0_l1_tp3 -->
<g id="node39" class="node">
<title>ResAttn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9695.77,-17889.59 9138.45,-17889.59 8995.08,-17783.59 9552.4,-17783.59 9695.77,-17889.59"/>
<text text-anchor="middle" x="9345.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9345.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9345.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp3 -->
<g id="edge56" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8540.96,-18525.69C8954.43,-18518.39 9772.41,-18499.95 9826.42,-18467.5 9876.96,-18437.13 9893.42,-18411.96 9893.42,-18353 9893.42,-18353 9893.42,-18353 9893.42,-18051.07 9893.42,-17983.82 9748.34,-17929.26 9607.47,-17892.13"/>
<polygon fill="black" stroke="black" points="9608.33,-17888.74 9597.77,-17889.6 9606.56,-17895.51 9608.33,-17888.74"/>
</g>
<!-- ResAttn_s0_l1_tp4 -->
<g id="node40" class="node">
<title>ResAttn_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="10637.77,-17889.59 10080.45,-17889.59 9937.08,-17783.59 10494.4,-17783.59 10637.77,-17889.59"/>
<text text-anchor="middle" x="10287.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10287.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10287.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp4 -->
<g id="edge58" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8542.35,-18526.55C8914.55,-18521 9619.4,-18505.71 9867.42,-18467.5 10058.65,-18438.04 10287.42,-18546.48 10287.42,-18353 10287.42,-18353 10287.42,-18353 10287.42,-18051.07 10287.42,-18000.22 10287.42,-17942.57 10287.42,-17900"/>
<polygon fill="black" stroke="black" points="10290.92,-17899.79 10287.42,-17889.79 10283.92,-17899.79 10290.92,-17899.79"/>
</g>
<!-- ResAttn_s0_l1_tp5 -->
<g id="node41" class="node">
<title>ResAttn_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="4685.77,-17889.59 4128.45,-17889.59 3985.08,-17783.59 4542.4,-17783.59 4685.77,-17889.59"/>
<text text-anchor="middle" x="4335.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4335.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4335.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp5 -->
<g id="edge60" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M8066.35,-18529.13C7305.56,-18526.82 4990.42,-18507.12 4990.42,-18353 4990.42,-18353 4990.42,-18353 4990.42,-18051.07 4990.42,-17978.07 4841.5,-17926.15 4685.67,-17891.8"/>
<polygon fill="black" stroke="black" points="4686.39,-17888.38 4675.87,-17889.67 4684.9,-17895.22 4686.39,-17888.38"/>
</g>
<!-- ResAttn_s0_l1_tp6 -->
<g id="node42" class="node">
<title>ResAttn_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="12796.77,-17889.59 12239.45,-17889.59 12096.08,-17783.59 12653.4,-17783.59 12796.77,-17889.59"/>
<text text-anchor="middle" x="12446.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12446.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12446.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp6 -->
<g id="edge62" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M8544,-18528.19C8990.95,-18524.94 9984.7,-18512.79 10820.42,-18467.5 11124.38,-18451.03 12185.42,-18657.4 12185.42,-18353 12185.42,-18353 12185.42,-18353 12185.42,-18051.07 12185.42,-17980.77 12242.86,-17929.45 12303.85,-17894.77"/>
<polygon fill="black" stroke="black" points="12305.81,-17897.68 12312.86,-17889.77 12302.42,-17891.56 12305.81,-17897.68"/>
</g>
<!-- ResAttn_s0_l1_tp7 -->
<g id="node43" class="node">
<title>ResAttn_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="11663.77,-17889.59 11106.45,-17889.59 10963.08,-17783.59 11520.4,-17783.59 11663.77,-17889.59"/>
<text text-anchor="middle" x="11313.42" y="-17847.89" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11313.42" y="-17832.89" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11313.42" y="-17817.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Input&#45;&gt;ResAttn_s0_l1_tp7 -->
<g id="edge64" class="edge">
<title>Input&#45;&gt;ResAttn_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M8543.21,-18527.35C9239.04,-18519.89 11222.42,-18486.87 11222.42,-18353 11222.42,-18353 11222.42,-18353 11222.42,-18051.07 11222.42,-17996.46 11247.94,-17939.83 11271.95,-17898.63"/>
<polygon fill="black" stroke="black" points="11275.08,-17900.2 11277.2,-17889.81 11269.07,-17896.61 11275.08,-17900.2"/>
</g>
<!-- SplitHeads_s0_l1_tp0 -->
<g id="node10" class="node">
<title>SplitHeads_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7525.42,-18378.5 7153.42,-18378.5 7153.42,-18325.5 7525.42,-18325.5 7525.42,-18378.5"/>
<text text-anchor="middle" x="7339.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7339.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7339.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp0&#45;&gt;SplitHeads_s0_l1_tp0 -->
<g id="edge9" class="edge">
<title>QKV_s0_l1_tp0&#45;&gt;SplitHeads_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M7366.23,-18414.37C7362.63,-18406.12 7358.57,-18396.84 7354.73,-18388.04"/>
<polygon fill="black" stroke="black" points="7357.88,-18386.51 7350.67,-18378.75 7351.46,-18389.31 7357.88,-18386.51"/>
</g>
<!-- SplitHeads_s0_l1_tp1 -->
<g id="node11" class="node">
<title>SplitHeads_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="7915.42,-18378.5 7543.42,-18378.5 7543.42,-18325.5 7915.42,-18325.5 7915.42,-18378.5"/>
<text text-anchor="middle" x="7729.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7729.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7729.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp1&#45;&gt;SplitHeads_s0_l1_tp1 -->
<g id="edge10" class="edge">
<title>QKV_s0_l1_tp1&#45;&gt;SplitHeads_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M7749.88,-18414.37C7747.16,-18406.21 7744.1,-18397.04 7741.2,-18388.32"/>
<polygon fill="black" stroke="black" points="7744.49,-18387.13 7738.01,-18378.75 7737.85,-18389.34 7744.49,-18387.13"/>
</g>
<!-- SplitHeads_s0_l1_tp2 -->
<g id="node12" class="node">
<title>SplitHeads_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="8305.42,-18378.5 7933.42,-18378.5 7933.42,-18325.5 8305.42,-18325.5 8305.42,-18378.5"/>
<text text-anchor="middle" x="8119.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8119.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="8119.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp2&#45;&gt;SplitHeads_s0_l1_tp2 -->
<g id="edge11" class="edge">
<title>QKV_s0_l1_tp2&#45;&gt;SplitHeads_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8125.07,-18414.37C8124.33,-18406.39 8123.51,-18397.43 8122.72,-18388.88"/>
<polygon fill="black" stroke="black" points="8126.19,-18388.39 8121.79,-18378.75 8119.22,-18389.03 8126.19,-18388.39"/>
</g>
<!-- SplitHeads_s0_l1_tp3 -->
<g id="node13" class="node">
<title>SplitHeads_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="8695.42,-18378.5 8323.42,-18378.5 8323.42,-18325.5 8695.42,-18325.5 8695.42,-18378.5"/>
<text text-anchor="middle" x="8509.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8509.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8509.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp3&#45;&gt;SplitHeads_s0_l1_tp3 -->
<g id="edge12" class="edge">
<title>QKV_s0_l1_tp3&#45;&gt;SplitHeads_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8503.07,-18414.37C8503.9,-18406.39 8504.83,-18397.43 8505.71,-18388.88"/>
<polygon fill="black" stroke="black" points="8509.21,-18389.06 8506.76,-18378.75 8502.25,-18388.34 8509.21,-18389.06"/>
</g>
<!-- SplitHeads_s0_l1_tp4 -->
<g id="node14" class="node">
<title>SplitHeads_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="9085.42,-18378.5 8713.42,-18378.5 8713.42,-18325.5 9085.42,-18325.5 9085.42,-18378.5"/>
<text text-anchor="middle" x="8899.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8899.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8899.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp4&#45;&gt;SplitHeads_s0_l1_tp4 -->
<g id="edge13" class="edge">
<title>QKV_s0_l1_tp4&#45;&gt;SplitHeads_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8881.79,-18414.37C8884.11,-18406.3 8886.71,-18397.23 8889.19,-18388.6"/>
<polygon fill="black" stroke="black" points="8892.63,-18389.33 8892.02,-18378.75 8885.9,-18387.39 8892.63,-18389.33"/>
</g>
<!-- SplitHeads_s0_l1_tp5 -->
<g id="node15" class="node">
<title>SplitHeads_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="9475.42,-18378.5 9103.42,-18378.5 9103.42,-18325.5 9475.42,-18325.5 9475.42,-18378.5"/>
<text text-anchor="middle" x="9289.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9289.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9289.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp5&#45;&gt;SplitHeads_s0_l1_tp5 -->
<g id="edge14" class="edge">
<title>QKV_s0_l1_tp5&#45;&gt;SplitHeads_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M9268.97,-18414.37C9271.69,-18406.21 9274.74,-18397.04 9277.65,-18388.32"/>
<polygon fill="black" stroke="black" points="9281,-18389.34 9280.84,-18378.75 9274.36,-18387.13 9281,-18389.34"/>
</g>
<!-- SplitHeads_s0_l1_tp6 -->
<g id="node16" class="node">
<title>SplitHeads_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="9865.42,-18378.5 9493.42,-18378.5 9493.42,-18325.5 9865.42,-18325.5 9865.42,-18378.5"/>
<text text-anchor="middle" x="9679.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9679.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9679.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp6&#45;&gt;SplitHeads_s0_l1_tp6 -->
<g id="edge15" class="edge">
<title>QKV_s0_l1_tp6&#45;&gt;SplitHeads_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M9657.56,-18414.37C9660.46,-18406.21 9663.73,-18397.04 9666.84,-18388.32"/>
<polygon fill="black" stroke="black" points="9670.19,-18389.34 9670.25,-18378.75 9663.59,-18386.99 9670.19,-18389.34"/>
</g>
<!-- SplitHeads_s0_l1_tp7 -->
<g id="node17" class="node">
<title>SplitHeads_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="7135.42,-18378.5 6763.42,-18378.5 6763.42,-18325.5 7135.42,-18325.5 7135.42,-18378.5"/>
<text text-anchor="middle" x="6949.42" y="-18363.3" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6949.42" y="-18348.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6949.42" y="-18333.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l1_tp7&#45;&gt;SplitHeads_s0_l1_tp7 -->
<g id="edge16" class="edge">
<title>QKV_s0_l1_tp7&#45;&gt;SplitHeads_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M6964.24,-18414.37C6962.29,-18406.3 6960.1,-18397.23 6958.02,-18388.6"/>
<polygon fill="black" stroke="black" points="6961.39,-18387.65 6955.64,-18378.75 6954.58,-18389.29 6961.39,-18387.65"/>
</g>
<!-- A2A_s0_l1 -->
<g id="node18" class="node">
<title>A2A_s0_l1</title>
<ellipse fill="none" stroke="black" cx="8314.42" cy="-18252.02" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="8314.42" y="-18263.32" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="8314.42" y="-18248.32" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8314.42" y="-18233.32" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l1_tp0&#45;&gt;A2A_s0_l1 -->
<g id="edge17" class="edge">
<title>SplitHeads_s0_l1_tp0&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M7525.45,-18326.52C7528.46,-18326.17 7531.45,-18325.83 7534.42,-18325.5 7717.43,-18305.04 7925.05,-18285.95 8080.05,-18272.5"/>
<polygon fill="black" stroke="black" points="8080.53,-18275.97 8090.19,-18271.62 8079.92,-18269 8080.53,-18275.97"/>
</g>
<!-- SplitHeads_s0_l1_tp1&#45;&gt;A2A_s0_l1 -->
<g id="edge18" class="edge">
<title>SplitHeads_s0_l1_tp1&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M7881.98,-18325.45C7960.22,-18312.35 8055.93,-18296.32 8137.41,-18282.67"/>
<polygon fill="black" stroke="black" points="8137.99,-18286.12 8147.27,-18281.02 8136.83,-18279.22 8137.99,-18286.12"/>
</g>
<!-- SplitHeads_s0_l1_tp2&#45;&gt;A2A_s0_l1 -->
<g id="edge19" class="edge">
<title>SplitHeads_s0_l1_tp2&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M8170.4,-18325.39C8190.24,-18315.42 8213.43,-18303.77 8235.33,-18292.76"/>
<polygon fill="black" stroke="black" points="8236.94,-18295.87 8244.3,-18288.25 8233.8,-18289.62 8236.94,-18295.87"/>
</g>
<!-- SplitHeads_s0_l1_tp3&#45;&gt;A2A_s0_l1 -->
<g id="edge20" class="edge">
<title>SplitHeads_s0_l1_tp3&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M8458.44,-18325.39C8438.61,-18315.42 8415.42,-18303.77 8393.51,-18292.76"/>
<polygon fill="black" stroke="black" points="8395.05,-18289.62 8384.54,-18288.25 8391.91,-18295.87 8395.05,-18289.62"/>
</g>
<!-- SplitHeads_s0_l1_tp4&#45;&gt;A2A_s0_l1 -->
<g id="edge21" class="edge">
<title>SplitHeads_s0_l1_tp4&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M8746.87,-18325.45C8668.63,-18312.35 8572.91,-18296.32 8491.44,-18282.67"/>
<polygon fill="black" stroke="black" points="8492.02,-18279.22 8481.58,-18281.02 8490.86,-18286.12 8492.02,-18279.22"/>
</g>
<!-- SplitHeads_s0_l1_tp5&#45;&gt;A2A_s0_l1 -->
<g id="edge22" class="edge">
<title>SplitHeads_s0_l1_tp5&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M9103.4,-18326.52C9100.39,-18326.17 9097.39,-18325.83 9094.42,-18325.5 8911.42,-18305.04 8703.79,-18285.95 8548.79,-18272.5"/>
<polygon fill="black" stroke="black" points="8548.92,-18269 8538.66,-18271.62 8548.32,-18275.97 8548.92,-18269"/>
</g>
<!-- SplitHeads_s0_l1_tp6&#45;&gt;A2A_s0_l1 -->
<g id="edge23" class="edge">
<title>SplitHeads_s0_l1_tp6&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M9493.41,-18326.39C9490.39,-18326.08 9487.4,-18325.79 9484.42,-18325.5 9172.38,-18295.47 8812.25,-18275.34 8574.88,-18264.06"/>
<polygon fill="black" stroke="black" points="8574.88,-18260.56 8564.73,-18263.58 8574.55,-18267.55 8574.88,-18260.56"/>
</g>
<!-- SplitHeads_s0_l1_tp7&#45;&gt;A2A_s0_l1 -->
<g id="edge24" class="edge">
<title>SplitHeads_s0_l1_tp7&#45;&gt;A2A_s0_l1</title>
<path fill="none" stroke="black" d="M7135.43,-18326.39C7138.45,-18326.08 7141.45,-18325.79 7144.42,-18325.5 7456.47,-18295.47 7816.6,-18275.34 8053.96,-18264.06"/>
<polygon fill="black" stroke="black" points="8054.29,-18267.55 8064.12,-18263.58 8053.96,-18260.56 8054.29,-18267.55"/>
</g>
<!-- Attn_s0_l1_tp0 -->
<g id="node19" class="node">
<title>Attn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7525.42,-18178.55 7153.42,-18178.55 7153.42,-18125.55 7525.42,-18125.55 7525.42,-18178.55"/>
<text text-anchor="middle" x="7339.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7339.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7339.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp0 -->
<g id="edge25" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M8090.19,-18232.42C7936.85,-18219.17 7728.7,-18200.12 7535.51,-18178.65"/>
<polygon fill="black" stroke="black" points="7535.77,-18175.16 7525.45,-18177.53 7535,-18182.12 7535.77,-18175.16"/>
</g>
<!-- Attn_s0_l1_tp1 -->
<g id="node20" class="node">
<title>Attn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="7915.42,-18178.55 7543.42,-18178.55 7543.42,-18125.55 7915.42,-18125.55 7915.42,-18178.55"/>
<text text-anchor="middle" x="7729.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7729.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7729.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp1 -->
<g id="edge26" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M8147.18,-18223.01C8067.03,-18209.59 7971.42,-18193.58 7891.9,-18180.26"/>
<polygon fill="black" stroke="black" points="7892.23,-18176.76 7881.79,-18178.56 7891.07,-18183.67 7892.23,-18176.76"/>
</g>
<!-- Attn_s0_l1_tp2 -->
<g id="node21" class="node">
<title>Attn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="8305.42,-18178.55 7933.42,-18178.55 7933.42,-18125.55 8305.42,-18125.55 8305.42,-18178.55"/>
<text text-anchor="middle" x="8119.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8119.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="8119.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp2 -->
<g id="edge27" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8244.3,-18215.79C8222.99,-18205.08 8199.79,-18193.43 8179.23,-18183.1"/>
<polygon fill="black" stroke="black" points="8180.8,-18179.97 8170.29,-18178.6 8177.65,-18186.22 8180.8,-18179.97"/>
</g>
<!-- Attn_s0_l1_tp3 -->
<g id="node22" class="node">
<title>Attn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="8695.42,-18178.55 8323.42,-18178.55 8323.42,-18125.55 8695.42,-18125.55 8695.42,-18178.55"/>
<text text-anchor="middle" x="8509.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8509.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8509.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp3 -->
<g id="edge28" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8384.55,-18215.79C8405.85,-18205.08 8429.06,-18193.43 8449.62,-18183.1"/>
<polygon fill="black" stroke="black" points="8451.19,-18186.22 8458.55,-18178.6 8448.05,-18179.97 8451.19,-18186.22"/>
</g>
<!-- Attn_s0_l1_tp4 -->
<g id="node23" class="node">
<title>Attn_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="9085.42,-18178.55 8713.42,-18178.55 8713.42,-18125.55 9085.42,-18125.55 9085.42,-18178.55"/>
<text text-anchor="middle" x="8899.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8899.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8899.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp4 -->
<g id="edge29" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8481.67,-18223.01C8561.81,-18209.59 8657.43,-18193.58 8736.95,-18180.26"/>
<polygon fill="black" stroke="black" points="8737.77,-18183.67 8747.06,-18178.56 8736.62,-18176.76 8737.77,-18183.67"/>
</g>
<!-- Attn_s0_l1_tp5 -->
<g id="node24" class="node">
<title>Attn_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="9475.42,-18178.55 9103.42,-18178.55 9103.42,-18125.55 9475.42,-18125.55 9475.42,-18178.55"/>
<text text-anchor="middle" x="9289.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9289.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9289.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp5 -->
<g id="edge30" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M8538.66,-18232.42C8692,-18219.17 8900.14,-18200.12 9093.34,-18178.65"/>
<polygon fill="black" stroke="black" points="9093.85,-18182.12 9103.4,-18177.53 9093.07,-18175.16 9093.85,-18182.12"/>
</g>
<!-- Attn_s0_l1_tp6 -->
<g id="node25" class="node">
<title>Attn_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="9865.42,-18178.55 9493.42,-18178.55 9493.42,-18125.55 9865.42,-18125.55 9865.42,-18178.55"/>
<text text-anchor="middle" x="9679.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9679.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9679.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp6 -->
<g id="edge31" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M8564.73,-18240.46C8799.46,-18229.4 9160.4,-18209.43 9483.39,-18178.62"/>
<polygon fill="black" stroke="black" points="9483.79,-18182.1 9493.41,-18177.66 9483.12,-18175.13 9483.79,-18182.1"/>
</g>
<!-- Attn_s0_l1_tp7 -->
<g id="node26" class="node">
<title>Attn_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="7135.42,-18178.55 6763.42,-18178.55 6763.42,-18125.55 7135.42,-18125.55 7135.42,-18178.55"/>
<text text-anchor="middle" x="6949.42" y="-18163.35" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6949.42" y="-18148.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6949.42" y="-18133.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l1&#45;&gt;Attn_s0_l1_tp7 -->
<g id="edge32" class="edge">
<title>A2A_s0_l1&#45;&gt;Attn_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M8064.12,-18240.46C7829.38,-18229.4 7468.44,-18209.43 7145.46,-18178.62"/>
<polygon fill="black" stroke="black" points="7145.72,-18175.13 7135.43,-18177.66 7145.05,-18182.1 7145.72,-18175.13"/>
</g>
<!-- AR_attn_s0_l1 -->
<g id="node27" class="node">
<title>AR_attn_s0_l1</title>
<ellipse fill="none" stroke="black" cx="8314.42" cy="-18052.07" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="8314.42" y="-18063.37" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="8314.42" y="-18048.37" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8314.42" y="-18033.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l1_tp0&#45;&gt;AR_attn_s0_l1 -->
<g id="edge33" class="edge">
<title>Attn_s0_l1_tp0&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M7525.45,-18126.56C7528.46,-18126.22 7531.45,-18125.88 7534.42,-18125.55 7717.43,-18105.09 7925.05,-18085.99 8080.05,-18072.55"/>
<polygon fill="black" stroke="black" points="8080.53,-18076.02 8090.19,-18071.67 8079.92,-18069.04 8080.53,-18076.02"/>
</g>
<!-- Attn_s0_l1_tp1&#45;&gt;AR_attn_s0_l1 -->
<g id="edge34" class="edge">
<title>Attn_s0_l1_tp1&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M7881.98,-18125.5C7960.22,-18112.39 8055.93,-18096.36 8137.41,-18082.72"/>
<polygon fill="black" stroke="black" points="8137.99,-18086.17 8147.27,-18081.06 8136.83,-18079.26 8137.99,-18086.17"/>
</g>
<!-- Attn_s0_l1_tp2&#45;&gt;AR_attn_s0_l1 -->
<g id="edge35" class="edge">
<title>Attn_s0_l1_tp2&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M8170.4,-18125.43C8190.24,-18115.47 8213.43,-18103.81 8235.33,-18092.81"/>
<polygon fill="black" stroke="black" points="8236.94,-18095.92 8244.3,-18088.3 8233.8,-18089.66 8236.94,-18095.92"/>
</g>
<!-- Attn_s0_l1_tp3&#45;&gt;AR_attn_s0_l1 -->
<g id="edge36" class="edge">
<title>Attn_s0_l1_tp3&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M8458.44,-18125.43C8438.61,-18115.47 8415.42,-18103.81 8393.51,-18092.81"/>
<polygon fill="black" stroke="black" points="8395.05,-18089.66 8384.54,-18088.3 8391.91,-18095.92 8395.05,-18089.66"/>
</g>
<!-- Attn_s0_l1_tp4&#45;&gt;AR_attn_s0_l1 -->
<g id="edge37" class="edge">
<title>Attn_s0_l1_tp4&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M8746.87,-18125.5C8668.63,-18112.39 8572.91,-18096.36 8491.44,-18082.72"/>
<polygon fill="black" stroke="black" points="8492.02,-18079.26 8481.58,-18081.06 8490.86,-18086.17 8492.02,-18079.26"/>
</g>
<!-- Attn_s0_l1_tp5&#45;&gt;AR_attn_s0_l1 -->
<g id="edge38" class="edge">
<title>Attn_s0_l1_tp5&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M9103.4,-18126.56C9100.39,-18126.22 9097.39,-18125.88 9094.42,-18125.55 8911.42,-18105.09 8703.79,-18085.99 8548.79,-18072.55"/>
<polygon fill="black" stroke="black" points="8548.92,-18069.04 8538.66,-18071.67 8548.32,-18076.02 8548.92,-18069.04"/>
</g>
<!-- Attn_s0_l1_tp6&#45;&gt;AR_attn_s0_l1 -->
<g id="edge39" class="edge">
<title>Attn_s0_l1_tp6&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M9493.41,-18126.43C9490.39,-18126.13 9487.4,-18125.83 9484.42,-18125.55 9172.38,-18095.51 8812.25,-18075.38 8574.88,-18064.11"/>
<polygon fill="black" stroke="black" points="8574.88,-18060.61 8564.73,-18063.63 8574.55,-18067.6 8574.88,-18060.61"/>
</g>
<!-- Attn_s0_l1_tp7&#45;&gt;AR_attn_s0_l1 -->
<g id="edge40" class="edge">
<title>Attn_s0_l1_tp7&#45;&gt;AR_attn_s0_l1</title>
<path fill="none" stroke="black" d="M7135.43,-18126.43C7138.45,-18126.13 7141.45,-18125.83 7144.42,-18125.55 7456.47,-18095.51 7816.6,-18075.38 8053.96,-18064.11"/>
<polygon fill="black" stroke="black" points="8054.29,-18067.6 8064.12,-18063.63 8053.96,-18060.61 8054.29,-18067.6"/>
</g>
<!-- O_s0_l1_tp0 -->
<g id="node28" class="node">
<title>O_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="8275.42,-17978.59 7937.42,-17978.59 7937.42,-17925.59 8275.42,-17925.59 8275.42,-17978.59"/>
<text text-anchor="middle" x="8106.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8106.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8106.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp0 -->
<g id="edge41" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M8240.21,-18016.11C8217.24,-18005.29 8192.16,-17993.48 8169.98,-17983.03"/>
<polygon fill="black" stroke="black" points="8171.2,-17979.74 8160.66,-17978.64 8168.22,-17986.07 8171.2,-17979.74"/>
</g>
<!-- O_s0_l1_tp1 -->
<g id="node29" class="node">
<title>O_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="6707.42,-17978.59 6369.42,-17978.59 6369.42,-17925.59 6707.42,-17925.59 6707.42,-17978.59"/>
<text text-anchor="middle" x="6538.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6538.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6538.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp1 -->
<g id="edge42" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M8071.2,-18037.65C7709.61,-18017.7 7038.57,-17980.68 6717.98,-17963"/>
<polygon fill="black" stroke="black" points="6717.84,-17959.49 6707.67,-17962.43 6717.46,-17966.48 6717.84,-17959.49"/>
</g>
<!-- O_s0_l1_tp2 -->
<g id="node30" class="node">
<title>O_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="7504.42,-17978.59 7166.42,-17978.59 7166.42,-17925.59 7504.42,-17925.59 7504.42,-17978.59"/>
<text text-anchor="middle" x="7335.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7335.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7335.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp2 -->
<g id="edge43" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8102.3,-18029.84C7926.88,-18012.28 7680.52,-17987.63 7514.79,-17971.04"/>
<polygon fill="black" stroke="black" points="7514.79,-17967.53 7504.49,-17970.01 7514.09,-17974.49 7514.79,-17967.53"/>
</g>
<!-- O_s0_l1_tp3 -->
<g id="node31" class="node">
<title>O_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9063.42,-17978.59 8725.42,-17978.59 8725.42,-17925.59 9063.42,-17925.59 9063.42,-17978.59"/>
<text text-anchor="middle" x="8894.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8894.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8894.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp3 -->
<g id="edge44" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8480.63,-18022.99C8559.92,-18009.6 8654.41,-17993.64 8733.06,-17980.35"/>
<polygon fill="black" stroke="black" points="8733.79,-17983.78 8743.07,-17978.66 8732.62,-17976.88 8733.79,-17983.78"/>
</g>
<!-- O_s0_l1_tp4 -->
<g id="node32" class="node">
<title>O_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="9635.42,-17978.59 9297.42,-17978.59 9297.42,-17925.59 9635.42,-17925.59 9635.42,-17978.59"/>
<text text-anchor="middle" x="9466.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9466.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9466.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp4 -->
<g id="edge45" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8537.22,-18032.12C8755.75,-18013.53 9084.76,-17985.55 9287,-17968.35"/>
<polygon fill="black" stroke="black" points="9287.47,-17971.83 9297.13,-17967.49 9286.87,-17964.85 9287.47,-17971.83"/>
</g>
<!-- O_s0_l1_tp5 -->
<g id="node33" class="node">
<title>O_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="6197.42,-17978.59 5859.42,-17978.59 5859.42,-17925.59 6197.42,-17925.59 6197.42,-17978.59"/>
<text text-anchor="middle" x="6028.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6028.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="6028.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp5 -->
<g id="edge46" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M8056.26,-18044.75C7682.19,-18034.85 6967.73,-18013.16 6360.42,-17978.59 6310.88,-17975.77 6257.24,-17971.98 6207.81,-17968.18"/>
<polygon fill="black" stroke="black" points="6207.9,-17964.67 6197.66,-17967.39 6207.36,-17971.65 6207.9,-17964.67"/>
</g>
<!-- O_s0_l1_tp6 -->
<g id="node34" class="node">
<title>O_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="11014.42,-17978.59 10676.42,-17978.59 10676.42,-17925.59 11014.42,-17925.59 11014.42,-17978.59"/>
<text text-anchor="middle" x="10845.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10845.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10845.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp6 -->
<g id="edge47" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M8568.55,-18042.22C8941.38,-18029.1 9658.52,-18003.38 10268.42,-17978.59 10401.66,-17973.18 10552.18,-17966.51 10666.07,-17961.35"/>
<polygon fill="black" stroke="black" points="10666.45,-17964.83 10676.28,-17960.88 10666.13,-17957.84 10666.45,-17964.83"/>
</g>
<!-- O_s0_l1_tp7 -->
<g id="node35" class="node">
<title>O_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="10259.42,-17978.59 9921.42,-17978.59 9921.42,-17925.59 10259.42,-17925.59 10259.42,-17978.59"/>
<text text-anchor="middle" x="10090.42" y="-17963.39" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10090.42" y="-17948.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10090.42" y="-17933.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l1&#45;&gt;O_s0_l1_tp7 -->
<g id="edge48" class="edge">
<title>AR_attn_s0_l1&#45;&gt;O_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M8558.34,-18037.97C8825.09,-18023.61 9265.19,-17999.77 9644.42,-17978.59 9732.14,-17973.7 9829.56,-17968.14 9910.92,-17963.47"/>
<polygon fill="black" stroke="black" points="9911.48,-17966.94 9921.27,-17962.87 9911.08,-17959.95 9911.48,-17966.94"/>
</g>
<!-- O_s0_l1_tp0&#45;&gt;ResAttn_s0_l1_tp0 -->
<g id="edge49" class="edge">
<title>O_s0_l1_tp0&#45;&gt;ResAttn_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M7937.26,-17927.99C7848.32,-17915.84 7735.83,-17900.48 7628.93,-17885.88"/>
<polygon fill="black" stroke="black" points="7629.32,-17882.4 7618.94,-17884.51 7628.37,-17889.33 7629.32,-17882.4"/>
</g>
<!-- O_s0_l1_tp1&#45;&gt;ResAttn_s0_l1_tp1 -->
<g id="edge51" class="edge">
<title>O_s0_l1_tp1&#45;&gt;ResAttn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M6369.37,-17932.89C6222.35,-17917.06 6004.86,-17893.64 5822.28,-17873.98"/>
<polygon fill="black" stroke="black" points="5822.56,-17870.48 5812.24,-17872.89 5821.81,-17877.44 5822.56,-17870.48"/>
</g>
<!-- O_s0_l1_tp2&#45;&gt;ResAttn_s0_l1_tp2 -->
<g id="edge53" class="edge">
<title>O_s0_l1_tp2&#45;&gt;ResAttn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M7166.24,-17931.77C7034.06,-17916.68 6846.04,-17895.21 6682.89,-17876.58"/>
<polygon fill="black" stroke="black" points="6683.01,-17873.07 6672.68,-17875.42 6682.22,-17880.03 6683.01,-17873.07"/>
</g>
<!-- O_s0_l1_tp3&#45;&gt;ResAttn_s0_l1_tp3 -->
<g id="edge55" class="edge">
<title>O_s0_l1_tp3&#45;&gt;ResAttn_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8995.92,-17925.55C9035.45,-17915.6 9082.35,-17903.8 9128.76,-17892.12"/>
<polygon fill="black" stroke="black" points="9129.81,-17895.46 9138.65,-17889.63 9128.1,-17888.68 9129.81,-17895.46"/>
</g>
<!-- O_s0_l1_tp4&#45;&gt;ResAttn_s0_l1_tp4 -->
<g id="edge57" class="edge">
<title>O_s0_l1_tp4&#45;&gt;ResAttn_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M9635.54,-17927.71C9753.23,-17911.44 9911.97,-17889.5 10043.34,-17871.34"/>
<polygon fill="black" stroke="black" points="10044.13,-17874.76 10053.55,-17869.92 10043.17,-17867.83 10044.13,-17874.76"/>
</g>
<!-- O_s0_l1_tp5&#45;&gt;ResAttn_s0_l1_tp5 -->
<g id="edge59" class="edge">
<title>O_s0_l1_tp5&#45;&gt;ResAttn_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M5859.12,-17939.74C5578.17,-17920.91 5011.21,-17882.9 4653.68,-17858.93"/>
<polygon fill="black" stroke="black" points="4653.91,-17855.44 4643.69,-17858.26 4653.44,-17862.42 4653.91,-17855.44"/>
</g>
<!-- O_s0_l1_tp6&#45;&gt;ResAttn_s0_l1_tp6 -->
<g id="edge61" class="edge">
<title>O_s0_l1_tp6&#45;&gt;ResAttn_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M11014.49,-17939.11C11293.43,-17919.33 11852.08,-17879.73 12183.12,-17856.26"/>
<polygon fill="black" stroke="black" points="12183.61,-17859.73 12193.33,-17855.54 12183.11,-17852.75 12183.61,-17859.73"/>
</g>
<!-- O_s0_l1_tp7&#45;&gt;ResAttn_s0_l1_tp7 -->
<g id="edge63" class="edge">
<title>O_s0_l1_tp7&#45;&gt;ResAttn_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M10259.51,-17935.4C10465.83,-17916.25 10816.73,-17883.69 11056.51,-17861.44"/>
<polygon fill="black" stroke="black" points="11057.13,-17864.89 11066.77,-17860.48 11056.49,-17857.92 11057.13,-17864.89"/>
</g>
<!-- Gate_s0_l1_tp0 -->
<g id="node44" class="node">
<title>Gate_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7660.42,-17747.59 7322.42,-17747.59 7322.42,-17694.59 7660.42,-17694.59 7660.42,-17747.59"/>
<text text-anchor="middle" x="7491.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7491.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7491.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp0&#45;&gt;Gate_s0_l1_tp0 -->
<g id="edge65" class="edge">
<title>ResAttn_s0_l1_tp0&#45;&gt;Gate_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M7374.57,-17783.49C7394.78,-17772.87 7415.41,-17762.04 7433.6,-17752.48"/>
<polygon fill="black" stroke="black" points="7435.64,-17755.36 7442.87,-17747.61 7432.39,-17749.16 7435.64,-17755.36"/>
</g>
<!-- ResMOE_s0_l1_tp0 -->
<g id="node85" class="node">
<title>ResMOE_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="8504.77,-17458.64 7947.45,-17458.64 7804.08,-17352.64 8361.4,-17352.64 8504.77,-17458.64"/>
<text text-anchor="middle" x="8154.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8154.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8154.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp0&#45;&gt;ResMOE_s0_l1_tp0 -->
<g id="edge138" class="edge">
<title>ResAttn_s0_l1_tp0&#45;&gt;ResMOE_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M6949.23,-17801.63C6868.03,-17794.41 6781.13,-17787.72 6700.42,-17783.59 6040.57,-17749.81 4386.26,-17797.41 3727.42,-17747.59 3442.38,-17726.04 3278.05,-17874.26 3090.42,-17658.59 3074.96,-17640.82 3074.05,-17622.53 3090.42,-17605.59 3255.94,-17434.3 7137.53,-17470.66 7375.42,-17458.64 7547.62,-17449.94 7741.02,-17437.05 7892.04,-17426.28"/>
<polygon fill="black" stroke="black" points="7892.66,-17429.74 7902.39,-17425.54 7892.16,-17422.76 7892.66,-17429.74"/>
</g>
<!-- Gate_s0_l1_tp1 -->
<g id="node45" class="node">
<title>Gate_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5378.42,-17747.59 5040.42,-17747.59 5040.42,-17694.59 5378.42,-17694.59 5378.42,-17747.59"/>
<text text-anchor="middle" x="5209.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5209.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5209.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp1&#45;&gt;Gate_s0_l1_tp1 -->
<g id="edge66" class="edge">
<title>ResAttn_s0_l1_tp1&#45;&gt;Gate_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M5358.19,-17783.49C5331.52,-17772.48 5304.27,-17761.24 5280.51,-17751.43"/>
<polygon fill="black" stroke="black" points="5281.82,-17748.19 5271.24,-17747.61 5279.15,-17754.66 5281.82,-17748.19"/>
</g>
<!-- ResMOE_s0_l1_tp1 -->
<g id="node86" class="node">
<title>ResMOE_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5808.77,-17458.64 5251.45,-17458.64 5108.08,-17352.64 5665.4,-17352.64 5808.77,-17458.64"/>
<text text-anchor="middle" x="5458.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5458.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5458.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp1&#45;&gt;ResMOE_s0_l1_tp1 -->
<g id="edge140" class="edge">
<title>ResAttn_s0_l1_tp1&#45;&gt;ResMOE_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M5172.22,-17811.85C5027.03,-17801.63 4852,-17790.47 4694.42,-17783.59 4647.93,-17781.56 3051.97,-17780.85 3019.42,-17747.59 2980.1,-17707.42 2980.4,-17535.1 3019.42,-17494.64 3056.44,-17456.26 4544.04,-17423.82 5177.49,-17411.71"/>
<polygon fill="black" stroke="black" points="5177.74,-17415.21 5187.68,-17411.52 5177.61,-17408.21 5177.74,-17415.21"/>
</g>
<!-- Gate_s0_l1_tp2 -->
<g id="node46" class="node">
<title>Gate_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6510.42,-17747.59 6172.42,-17747.59 6172.42,-17694.59 6510.42,-17694.59 6510.42,-17747.59"/>
<text text-anchor="middle" x="6341.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6341.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6341.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp2&#45;&gt;Gate_s0_l1_tp2 -->
<g id="edge67" class="edge">
<title>ResAttn_s0_l1_tp2&#45;&gt;Gate_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M6341.42,-17783.49C6341.42,-17774.82 6341.42,-17766.01 6341.42,-17757.86"/>
<polygon fill="black" stroke="black" points="6344.92,-17757.61 6341.42,-17747.61 6337.92,-17757.61 6344.92,-17757.61"/>
</g>
<!-- ResMOE_s0_l1_tp2 -->
<g id="node87" class="node">
<title>ResMOE_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="7366.77,-17458.64 6809.45,-17458.64 6666.08,-17352.64 7223.4,-17352.64 7366.77,-17458.64"/>
<text text-anchor="middle" x="7016.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7016.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7016.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp2&#45;&gt;ResMOE_s0_l1_tp2 -->
<g id="edge142" class="edge">
<title>ResAttn_s0_l1_tp2&#45;&gt;ResMOE_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M6008.59,-17796.6C5953.49,-17791.36 5896.9,-17786.72 5843.42,-17783.59 5804.79,-17781.33 3084.61,-17775.13 3057.42,-17747.59 3017.93,-17707.59 3017.93,-17534.65 3057.42,-17494.64 3084.35,-17467.36 5779.1,-17459.72 5817.42,-17458.64 6136.99,-17449.63 6504.2,-17432.74 6747.15,-17420.65"/>
<polygon fill="black" stroke="black" points="6747.37,-17424.15 6757.18,-17420.15 6747.02,-17417.15 6747.37,-17424.15"/>
</g>
<!-- Gate_s0_l1_tp3 -->
<g id="node47" class="node">
<title>Gate_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9290.42,-17747.59 8952.42,-17747.59 8952.42,-17694.59 9290.42,-17694.59 9290.42,-17747.59"/>
<text text-anchor="middle" x="9121.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9121.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9121.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp3&#45;&gt;Gate_s0_l1_tp3 -->
<g id="edge68" class="edge">
<title>ResAttn_s0_l1_tp3&#45;&gt;Gate_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M9242.6,-17783.49C9221.45,-17772.78 9199.86,-17761.84 9180.87,-17752.22"/>
<polygon fill="black" stroke="black" points="9182.28,-17749 9171.78,-17747.61 9179.11,-17755.25 9182.28,-17749"/>
</g>
<!-- ResMOE_s0_l1_tp3 -->
<g id="node88" class="node">
<title>ResMOE_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9578.77,-17458.64 9021.45,-17458.64 8878.08,-17352.64 9435.4,-17352.64 9578.77,-17458.64"/>
<text text-anchor="middle" x="9228.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9228.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9228.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp3&#45;&gt;ResMOE_s0_l1_tp3 -->
<g id="edge144" class="edge">
<title>ResAttn_s0_l1_tp3&#45;&gt;ResMOE_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M9588.01,-17809.76C9692.61,-17799.71 9816.41,-17789.26 9928.42,-17783.59 10584.74,-17750.38 12230.13,-17797.16 12885.42,-17747.59 13174.66,-17725.72 13722.72,-17815.39 13522.42,-17605.59 13487.95,-17569.49 10509.05,-17454.67 9533.74,-17418.01"/>
<polygon fill="black" stroke="black" points="9533.55,-17414.5 9523.42,-17417.62 9533.28,-17421.49 9533.55,-17414.5"/>
</g>
<!-- Gate_s0_l1_tp4 -->
<g id="node48" class="node">
<title>Gate_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="10456.42,-17747.59 10118.42,-17747.59 10118.42,-17694.59 10456.42,-17694.59 10456.42,-17747.59"/>
<text text-anchor="middle" x="10287.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10287.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10287.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp4&#45;&gt;Gate_s0_l1_tp4 -->
<g id="edge69" class="edge">
<title>ResAttn_s0_l1_tp4&#45;&gt;Gate_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M10287.42,-17783.49C10287.42,-17774.82 10287.42,-17766.01 10287.42,-17757.86"/>
<polygon fill="black" stroke="black" points="10290.92,-17757.61 10287.42,-17747.61 10283.92,-17757.61 10290.92,-17757.61"/>
</g>
<!-- ResMOE_s0_l1_tp4 -->
<g id="node89" class="node">
<title>ResMOE_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="11452.77,-17458.64 10895.45,-17458.64 10752.08,-17352.64 11309.4,-17352.64 11452.77,-17458.64"/>
<text text-anchor="middle" x="11102.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11102.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11102.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp4&#45;&gt;ResMOE_s0_l1_tp4 -->
<g id="edge146" class="edge">
<title>ResAttn_s0_l1_tp4&#45;&gt;ResMOE_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M10533.87,-17812.71C10659.61,-17801.97 10815.05,-17790.12 10954.42,-17783.59 11207.84,-17771.73 12986.38,-17784.18 13237.42,-17747.59 13382.23,-17726.49 13466.03,-17775.22 13554.42,-17658.59 13724.98,-17433.56 12575.86,-17517.42 12294.42,-17494.64 11999.02,-17470.73 11662.21,-17446.11 11422.14,-17429.01"/>
<polygon fill="black" stroke="black" points="11422.08,-17425.5 11411.86,-17428.28 11421.59,-17432.48 11422.08,-17425.5"/>
</g>
<!-- Gate_s0_l1_tp5 -->
<g id="node49" class="node">
<title>Gate_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="4074.42,-17747.59 3736.42,-17747.59 3736.42,-17694.59 4074.42,-17694.59 4074.42,-17747.59"/>
<text text-anchor="middle" x="3905.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3905.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3905.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp5&#45;&gt;Gate_s0_l1_tp5 -->
<g id="edge70" class="edge">
<title>ResAttn_s0_l1_tp5&#45;&gt;Gate_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M4138.36,-17783.58C4094.95,-17772.12 4050.56,-17760.4 4012.33,-17750.31"/>
<polygon fill="black" stroke="black" points="4012.8,-17746.82 4002.24,-17747.65 4011.01,-17753.58 4012.8,-17746.82"/>
</g>
<!-- ResMOE_s0_l1_tp5 -->
<g id="node90" class="node">
<title>ResMOE_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="3412.77,-17458.64 2855.45,-17458.64 2712.08,-17352.64 3269.4,-17352.64 3412.77,-17458.64"/>
<text text-anchor="middle" x="3062.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3062.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3062.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp5&#45;&gt;ResMOE_s0_l1_tp5 -->
<g id="edge148" class="edge">
<title>ResAttn_s0_l1_tp5&#45;&gt;ResMOE_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M4042.22,-17826.02C3658.53,-17812.1 3030.21,-17783.91 2993.42,-17747.59 2913.4,-17668.61 2949.84,-17599.88 2989.42,-17494.64 2993.02,-17485.07 2998.13,-17475.78 3004,-17467.05"/>
<polygon fill="black" stroke="black" points="3006.88,-17469.05 3009.83,-17458.87 3001.17,-17464.99 3006.88,-17469.05"/>
</g>
<!-- Gate_s0_l1_tp6 -->
<g id="node50" class="node">
<title>Gate_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="12876.42,-17747.59 12538.42,-17747.59 12538.42,-17694.59 12876.42,-17694.59 12876.42,-17747.59"/>
<text text-anchor="middle" x="12707.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12707.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12707.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp6&#45;&gt;Gate_s0_l1_tp6 -->
<g id="edge71" class="edge">
<title>ResAttn_s0_l1_tp6&#45;&gt;Gate_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M12566.23,-17783.49C12591.32,-17772.58 12616.95,-17761.44 12639.36,-17751.69"/>
<polygon fill="black" stroke="black" points="12640.98,-17754.8 12648.75,-17747.61 12638.19,-17748.38 12640.98,-17754.8"/>
</g>
<!-- ResMOE_s0_l1_tp6 -->
<g id="node91" class="node">
<title>ResMOE_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="13756.77,-17458.64 13199.45,-17458.64 13056.08,-17352.64 13613.4,-17352.64 13756.77,-17458.64"/>
<text text-anchor="middle" x="13406.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="13406.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13406.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp6&#45;&gt;ResMOE_s0_l1_tp6 -->
<g id="edge150" class="edge">
<title>ResAttn_s0_l1_tp6&#45;&gt;ResMOE_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M12722.35,-17834.43C13053.14,-17830.1 13570.85,-17812.84 13631.42,-17747.59 13707.92,-17665.21 13694.81,-17587.49 13631.42,-17494.64 13623.74,-17483.39 13614.39,-17473.58 13603.92,-17465.02"/>
<polygon fill="black" stroke="black" points="13605.76,-17462.03 13595.7,-17458.72 13601.5,-17467.58 13605.76,-17462.03"/>
</g>
<!-- Gate_s0_l1_tp7 -->
<g id="node51" class="node">
<title>Gate_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="11572.42,-17747.59 11234.42,-17747.59 11234.42,-17694.59 11572.42,-17694.59 11572.42,-17747.59"/>
<text text-anchor="middle" x="11403.42" y="-17732.39" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11403.42" y="-17717.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11403.42" y="-17702.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp7&#45;&gt;Gate_s0_l1_tp7 -->
<g id="edge72" class="edge">
<title>ResAttn_s0_l1_tp7&#45;&gt;Gate_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M11354.73,-17783.49C11362.23,-17774.04 11369.86,-17764.42 11376.79,-17755.68"/>
<polygon fill="black" stroke="black" points="11379.72,-17757.62 11383.19,-17747.61 11374.24,-17753.27 11379.72,-17757.62"/>
</g>
<!-- ResMOE_s0_l1_tp7 -->
<g id="node92" class="node">
<title>ResMOE_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="12748.77,-17458.64 12191.45,-17458.64 12048.08,-17352.64 12605.4,-17352.64 12748.77,-17458.64"/>
<text text-anchor="middle" x="12398.42" y="-17416.94" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12398.42" y="-17401.94" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12398.42" y="-17386.94" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l1_tp7&#45;&gt;ResMOE_s0_l1_tp7 -->
<g id="edge152" class="edge">
<title>ResAttn_s0_l1_tp7&#45;&gt;ResMOE_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M11564.69,-17816.19C11716.05,-17805.13 11912.71,-17791.87 12087.42,-17783.59 12232.2,-17776.73 13250.56,-17781.76 13391.42,-17747.59 13480.09,-17726.08 13527.86,-17735.84 13576.42,-17658.59 13679.62,-17494.43 13765.13,-17635.92 12927.42,-17494.64 12861.14,-17483.46 12790.17,-17471.59 12722.42,-17460.3"/>
<polygon fill="black" stroke="black" points="12722.89,-17456.83 12712.45,-17458.64 12721.74,-17463.74 12722.89,-17456.83"/>
</g>
<!-- Expert0_s0_l1_tp0 -->
<g id="node52" class="node">
<title>Expert0_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7971.42,-17658.59 7663.42,-17658.59 7663.42,-17605.59 7971.42,-17605.59 7971.42,-17658.59"/>
<text text-anchor="middle" x="7817.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="7817.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7817.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp0&#45;&gt;Expert0_s0_l1_tp0 -->
<g id="edge73" class="edge">
<title>Gate_s0_l1_tp0&#45;&gt;Expert0_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7587.03,-17694.58C7626.26,-17684.11 7671.8,-17671.95 7711.99,-17661.23"/>
<polygon fill="black" stroke="black" points="7713.06,-17664.57 7721.82,-17658.61 7711.25,-17657.8 7713.06,-17664.57"/>
</g>
<!-- Expert1_s0_l1_tp0 -->
<g id="node53" class="node">
<title>Expert1_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="8297.42,-17658.59 7989.42,-17658.59 7989.42,-17605.59 8297.42,-17605.59 8297.42,-17658.59"/>
<text text-anchor="middle" x="8143.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="8143.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8143.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp0&#45;&gt;Expert1_s0_l1_tp0 -->
<g id="edge74" class="edge">
<title>Gate_s0_l1_tp0&#45;&gt;Expert1_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7660.47,-17700.1C7751.97,-17688.97 7867.22,-17674.46 7978.9,-17658.79"/>
<polygon fill="black" stroke="black" points="7979.59,-17662.23 7989.01,-17657.37 7978.62,-17655.3 7979.59,-17662.23"/>
</g>
<!-- Expert2_s0_l1_tp0 -->
<g id="node54" class="node">
<title>Expert2_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7319.42,-17658.59 7011.42,-17658.59 7011.42,-17605.59 7319.42,-17605.59 7319.42,-17658.59"/>
<text text-anchor="middle" x="7165.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="7165.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7165.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp0&#45;&gt;Expert2_s0_l1_tp0 -->
<g id="edge75" class="edge">
<title>Gate_s0_l1_tp0&#45;&gt;Expert2_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7395.81,-17694.58C7356.59,-17684.11 7311.04,-17671.95 7270.85,-17661.23"/>
<polygon fill="black" stroke="black" points="7271.59,-17657.8 7261.03,-17658.61 7269.79,-17664.57 7271.59,-17657.8"/>
</g>
<!-- Expert3_s0_l1_tp0 -->
<g id="node55" class="node">
<title>Expert3_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="7645.42,-17658.59 7337.42,-17658.59 7337.42,-17605.59 7645.42,-17605.59 7645.42,-17658.59"/>
<text text-anchor="middle" x="7491.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="7491.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7491.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp0&#45;&gt;Expert3_s0_l1_tp0 -->
<g id="edge76" class="edge">
<title>Gate_s0_l1_tp0&#45;&gt;Expert3_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7491.42,-17694.46C7491.42,-17686.48 7491.42,-17677.52 7491.42,-17668.98"/>
<polygon fill="black" stroke="black" points="7494.92,-17668.84 7491.42,-17658.84 7487.92,-17668.84 7494.92,-17668.84"/>
</g>
<!-- Expert4_s0_l1_tp1 -->
<g id="node56" class="node">
<title>Expert4_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5363.42,-17658.59 5055.42,-17658.59 5055.42,-17605.59 5363.42,-17605.59 5363.42,-17658.59"/>
<text text-anchor="middle" x="5209.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="5209.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5209.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp1&#45;&gt;Expert4_s0_l1_tp1 -->
<g id="edge77" class="edge">
<title>Gate_s0_l1_tp1&#45;&gt;Expert4_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5209.42,-17694.46C5209.42,-17686.48 5209.42,-17677.52 5209.42,-17668.98"/>
<polygon fill="black" stroke="black" points="5212.92,-17668.84 5209.42,-17658.84 5205.92,-17668.84 5212.92,-17668.84"/>
</g>
<!-- Expert5_s0_l1_tp1 -->
<g id="node57" class="node">
<title>Expert5_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5689.42,-17658.59 5381.42,-17658.59 5381.42,-17605.59 5689.42,-17605.59 5689.42,-17658.59"/>
<text text-anchor="middle" x="5535.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="5535.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5535.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp1&#45;&gt;Expert5_s0_l1_tp1 -->
<g id="edge78" class="edge">
<title>Gate_s0_l1_tp1&#45;&gt;Expert5_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5305.03,-17694.58C5344.26,-17684.11 5389.8,-17671.95 5429.99,-17661.23"/>
<polygon fill="black" stroke="black" points="5431.06,-17664.57 5439.82,-17658.61 5429.25,-17657.8 5431.06,-17664.57"/>
</g>
<!-- Expert6_s0_l1_tp1 -->
<g id="node58" class="node">
<title>Expert6_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="4711.42,-17658.59 4403.42,-17658.59 4403.42,-17605.59 4711.42,-17605.59 4711.42,-17658.59"/>
<text text-anchor="middle" x="4557.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="4557.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4557.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp1&#45;&gt;Expert6_s0_l1_tp1 -->
<g id="edge79" class="edge">
<title>Gate_s0_l1_tp1&#45;&gt;Expert6_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5040.37,-17700.1C4948.87,-17688.97 4833.63,-17674.46 4721.94,-17658.79"/>
<polygon fill="black" stroke="black" points="4722.23,-17655.3 4711.84,-17657.37 4721.25,-17662.23 4722.23,-17655.3"/>
</g>
<!-- Expert7_s0_l1_tp1 -->
<g id="node59" class="node">
<title>Expert7_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5037.42,-17658.59 4729.42,-17658.59 4729.42,-17605.59 5037.42,-17605.59 5037.42,-17658.59"/>
<text text-anchor="middle" x="4883.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="4883.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4883.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp1&#45;&gt;Expert7_s0_l1_tp1 -->
<g id="edge80" class="edge">
<title>Gate_s0_l1_tp1&#45;&gt;Expert7_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5113.81,-17694.58C5074.59,-17684.11 5029.04,-17671.95 4988.85,-17661.23"/>
<polygon fill="black" stroke="black" points="4989.59,-17657.8 4979.03,-17658.61 4987.79,-17664.57 4989.59,-17657.8"/>
</g>
<!-- Expert8_s0_l1_tp2 -->
<g id="node60" class="node">
<title>Expert8_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6993.42,-17658.59 6685.42,-17658.59 6685.42,-17605.59 6993.42,-17605.59 6993.42,-17658.59"/>
<text text-anchor="middle" x="6839.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="6839.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6839.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp2&#45;&gt;Expert8_s0_l1_tp2 -->
<g id="edge81" class="edge">
<title>Gate_s0_l1_tp2&#45;&gt;Expert8_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6487.47,-17694.58C6549.04,-17683.82 6620.8,-17671.29 6683.41,-17660.35"/>
<polygon fill="black" stroke="black" points="6684.13,-17663.78 6693.37,-17658.61 6682.92,-17656.88 6684.13,-17663.78"/>
</g>
<!-- Expert9_s0_l1_tp2 -->
<g id="node61" class="node">
<title>Expert9_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6015.42,-17658.59 5707.42,-17658.59 5707.42,-17605.59 6015.42,-17605.59 6015.42,-17658.59"/>
<text text-anchor="middle" x="5861.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="5861.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5861.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp2&#45;&gt;Expert9_s0_l1_tp2 -->
<g id="edge82" class="edge">
<title>Gate_s0_l1_tp2&#45;&gt;Expert9_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6200.65,-17694.58C6141.43,-17683.84 6072.42,-17671.34 6012.17,-17660.42"/>
<polygon fill="black" stroke="black" points="6012.66,-17656.95 6002.19,-17658.61 6011.41,-17663.83 6012.66,-17656.95"/>
</g>
<!-- Expert10_s0_l1_tp2 -->
<g id="node62" class="node">
<title>Expert10_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6341.42,-17658.59 6033.42,-17658.59 6033.42,-17605.59 6341.42,-17605.59 6341.42,-17658.59"/>
<text text-anchor="middle" x="6187.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="6187.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6187.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp2&#45;&gt;Expert10_s0_l1_tp2 -->
<g id="edge83" class="edge">
<title>Gate_s0_l1_tp2&#45;&gt;Expert10_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6296.05,-17694.46C6279.05,-17684.86 6259.56,-17673.85 6241.83,-17663.83"/>
<polygon fill="black" stroke="black" points="6243.16,-17660.56 6232.74,-17658.69 6239.72,-17666.66 6243.16,-17660.56"/>
</g>
<!-- Expert11_s0_l1_tp2 -->
<g id="node63" class="node">
<title>Expert11_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6667.42,-17658.59 6359.42,-17658.59 6359.42,-17605.59 6667.42,-17605.59 6667.42,-17658.59"/>
<text text-anchor="middle" x="6513.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="6513.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6513.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp2&#45;&gt;Expert11_s0_l1_tp2 -->
<g id="edge84" class="edge">
<title>Gate_s0_l1_tp2&#45;&gt;Expert11_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6392.1,-17694.46C6411.43,-17684.68 6433.65,-17673.44 6453.75,-17663.28"/>
<polygon fill="black" stroke="black" points="6455.47,-17666.33 6462.81,-17658.69 6452.31,-17660.08 6455.47,-17666.33"/>
</g>
<!-- Expert12_s0_l1_tp3 -->
<g id="node64" class="node">
<title>Expert12_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="8623.42,-17658.59 8315.42,-17658.59 8315.42,-17605.59 8623.42,-17605.59 8623.42,-17658.59"/>
<text text-anchor="middle" x="8469.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="8469.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8469.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp3&#45;&gt;Expert12_s0_l1_tp3 -->
<g id="edge85" class="edge">
<title>Gate_s0_l1_tp3&#45;&gt;Expert12_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8952.37,-17700.1C8860.87,-17688.97 8745.63,-17674.46 8633.94,-17658.79"/>
<polygon fill="black" stroke="black" points="8634.23,-17655.3 8623.84,-17657.37 8633.25,-17662.23 8634.23,-17655.3"/>
</g>
<!-- Expert13_s0_l1_tp3 -->
<g id="node65" class="node">
<title>Expert13_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="8949.42,-17658.59 8641.42,-17658.59 8641.42,-17605.59 8949.42,-17605.59 8949.42,-17658.59"/>
<text text-anchor="middle" x="8795.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="8795.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8795.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp3&#45;&gt;Expert13_s0_l1_tp3 -->
<g id="edge86" class="edge">
<title>Gate_s0_l1_tp3&#45;&gt;Expert13_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9025.81,-17694.58C8986.59,-17684.11 8941.04,-17671.95 8900.85,-17661.23"/>
<polygon fill="black" stroke="black" points="8901.59,-17657.8 8891.03,-17658.61 8899.79,-17664.57 8901.59,-17657.8"/>
</g>
<!-- Expert14_s0_l1_tp3 -->
<g id="node66" class="node">
<title>Expert14_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9275.42,-17658.59 8967.42,-17658.59 8967.42,-17605.59 9275.42,-17605.59 9275.42,-17658.59"/>
<text text-anchor="middle" x="9121.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="9121.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9121.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp3&#45;&gt;Expert14_s0_l1_tp3 -->
<g id="edge87" class="edge">
<title>Gate_s0_l1_tp3&#45;&gt;Expert14_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9121.42,-17694.46C9121.42,-17686.48 9121.42,-17677.52 9121.42,-17668.98"/>
<polygon fill="black" stroke="black" points="9124.92,-17668.84 9121.42,-17658.84 9117.92,-17668.84 9124.92,-17668.84"/>
</g>
<!-- Expert15_s0_l1_tp3 -->
<g id="node67" class="node">
<title>Expert15_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="9601.42,-17658.59 9293.42,-17658.59 9293.42,-17605.59 9601.42,-17605.59 9601.42,-17658.59"/>
<text text-anchor="middle" x="9447.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="9447.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9447.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp3&#45;&gt;Expert15_s0_l1_tp3 -->
<g id="edge88" class="edge">
<title>Gate_s0_l1_tp3&#45;&gt;Expert15_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9217.03,-17694.58C9256.26,-17684.11 9301.8,-17671.95 9341.99,-17661.23"/>
<polygon fill="black" stroke="black" points="9343.06,-17664.57 9351.82,-17658.61 9341.25,-17657.8 9343.06,-17664.57"/>
</g>
<!-- Expert16_s0_l1_tp4 -->
<g id="node68" class="node">
<title>Expert16_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="9927.42,-17658.59 9619.42,-17658.59 9619.42,-17605.59 9927.42,-17605.59 9927.42,-17658.59"/>
<text text-anchor="middle" x="9773.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="9773.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9773.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp4&#45;&gt;Expert16_s0_l1_tp4 -->
<g id="edge89" class="edge">
<title>Gate_s0_l1_tp4&#45;&gt;Expert16_s0_l1_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10136.68,-17694.58C10073,-17683.8 9998.76,-17671.23 9934.05,-17660.28"/>
<polygon fill="black" stroke="black" points="9934.61,-17656.83 9924.16,-17658.61 9933.44,-17663.73 9934.61,-17656.83"/>
</g>
<!-- Expert17_s0_l1_tp4 -->
<g id="node69" class="node">
<title>Expert17_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="10253.42,-17658.59 9945.42,-17658.59 9945.42,-17605.59 10253.42,-17605.59 10253.42,-17658.59"/>
<text text-anchor="middle" x="10099.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="10099.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10099.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp4&#45;&gt;Expert17_s0_l1_tp4 -->
<g id="edge90" class="edge">
<title>Gate_s0_l1_tp4&#45;&gt;Expert17_s0_l1_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10232.29,-17694.58C10210.86,-17684.66 10186.17,-17673.23 10163.92,-17662.94"/>
<polygon fill="black" stroke="black" points="10165.1,-17659.63 10154.56,-17658.61 10162.16,-17665.98 10165.1,-17659.63"/>
</g>
<!-- Expert18_s0_l1_tp4 -->
<g id="node70" class="node">
<title>Expert18_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="10579.42,-17658.59 10271.42,-17658.59 10271.42,-17605.59 10579.42,-17605.59 10579.42,-17658.59"/>
<text text-anchor="middle" x="10425.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="10425.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10425.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp4&#45;&gt;Expert18_s0_l1_tp4 -->
<g id="edge91" class="edge">
<title>Gate_s0_l1_tp4&#45;&gt;Expert18_s0_l1_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10328.08,-17694.46C10343.11,-17684.99 10360.3,-17674.15 10376.02,-17664.24"/>
<polygon fill="black" stroke="black" points="10377.99,-17667.14 10384.58,-17658.84 10374.25,-17661.21 10377.99,-17667.14"/>
</g>
<!-- Expert19_s0_l1_tp4 -->
<g id="node71" class="node">
<title>Expert19_s0_l1_tp4</title>
<polygon fill="none" stroke="black" points="10905.42,-17658.59 10597.42,-17658.59 10597.42,-17605.59 10905.42,-17605.59 10905.42,-17658.59"/>
<text text-anchor="middle" x="10751.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="10751.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10751.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp4&#45;&gt;Expert19_s0_l1_tp4 -->
<g id="edge92" class="edge">
<title>Gate_s0_l1_tp4&#45;&gt;Expert19_s0_l1_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10423.5,-17694.58C10480.63,-17683.87 10547.18,-17671.39 10605.34,-17660.48"/>
<polygon fill="black" stroke="black" points="10606.16,-17663.89 10615.34,-17658.61 10604.87,-17657.01 10606.16,-17663.89"/>
</g>
<!-- Expert20_s0_l1_tp5 -->
<g id="node72" class="node">
<title>Expert20_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="3407.42,-17658.59 3099.42,-17658.59 3099.42,-17605.59 3407.42,-17605.59 3407.42,-17658.59"/>
<text text-anchor="middle" x="3253.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="3253.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3253.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp5&#45;&gt;Expert20_s0_l1_tp5 -->
<g id="edge93" class="edge">
<title>Gate_s0_l1_tp5&#45;&gt;Expert20_s0_l1_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3736.37,-17700.1C3644.87,-17688.97 3529.63,-17674.46 3417.94,-17658.79"/>
<polygon fill="black" stroke="black" points="3418.23,-17655.3 3407.84,-17657.37 3417.25,-17662.23 3418.23,-17655.3"/>
</g>
<!-- Expert21_s0_l1_tp5 -->
<g id="node73" class="node">
<title>Expert21_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="3733.42,-17658.59 3425.42,-17658.59 3425.42,-17605.59 3733.42,-17605.59 3733.42,-17658.59"/>
<text text-anchor="middle" x="3579.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="3579.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3579.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp5&#45;&gt;Expert21_s0_l1_tp5 -->
<g id="edge94" class="edge">
<title>Gate_s0_l1_tp5&#45;&gt;Expert21_s0_l1_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3809.81,-17694.58C3770.59,-17684.11 3725.04,-17671.95 3684.85,-17661.23"/>
<polygon fill="black" stroke="black" points="3685.59,-17657.8 3675.03,-17658.61 3683.79,-17664.57 3685.59,-17657.8"/>
</g>
<!-- Expert22_s0_l1_tp5 -->
<g id="node74" class="node">
<title>Expert22_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="4059.42,-17658.59 3751.42,-17658.59 3751.42,-17605.59 4059.42,-17605.59 4059.42,-17658.59"/>
<text text-anchor="middle" x="3905.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="3905.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3905.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp5&#45;&gt;Expert22_s0_l1_tp5 -->
<g id="edge95" class="edge">
<title>Gate_s0_l1_tp5&#45;&gt;Expert22_s0_l1_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3905.42,-17694.46C3905.42,-17686.48 3905.42,-17677.52 3905.42,-17668.98"/>
<polygon fill="black" stroke="black" points="3908.92,-17668.84 3905.42,-17658.84 3901.92,-17668.84 3908.92,-17668.84"/>
</g>
<!-- Expert23_s0_l1_tp5 -->
<g id="node75" class="node">
<title>Expert23_s0_l1_tp5</title>
<polygon fill="none" stroke="black" points="4385.42,-17658.59 4077.42,-17658.59 4077.42,-17605.59 4385.42,-17605.59 4385.42,-17658.59"/>
<text text-anchor="middle" x="4231.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="4231.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4231.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp5&#45;&gt;Expert23_s0_l1_tp5 -->
<g id="edge96" class="edge">
<title>Gate_s0_l1_tp5&#45;&gt;Expert23_s0_l1_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4001.03,-17694.58C4040.26,-17684.11 4085.8,-17671.95 4125.99,-17661.23"/>
<polygon fill="black" stroke="black" points="4127.06,-17664.57 4135.82,-17658.61 4125.25,-17657.8 4127.06,-17664.57"/>
</g>
<!-- Expert24_s0_l1_tp6 -->
<g id="node76" class="node">
<title>Expert24_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="12535.42,-17658.59 12227.42,-17658.59 12227.42,-17605.59 12535.42,-17605.59 12535.42,-17658.59"/>
<text text-anchor="middle" x="12381.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="12381.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12381.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp6&#45;&gt;Expert24_s0_l1_tp6 -->
<g id="edge97" class="edge">
<title>Gate_s0_l1_tp6&#45;&gt;Expert24_s0_l1_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12611.81,-17694.58C12572.59,-17684.11 12527.04,-17671.95 12486.85,-17661.23"/>
<polygon fill="black" stroke="black" points="12487.59,-17657.8 12477.03,-17658.61 12485.79,-17664.57 12487.59,-17657.8"/>
</g>
<!-- Expert25_s0_l1_tp6 -->
<g id="node77" class="node">
<title>Expert25_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="12861.42,-17658.59 12553.42,-17658.59 12553.42,-17605.59 12861.42,-17605.59 12861.42,-17658.59"/>
<text text-anchor="middle" x="12707.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="12707.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12707.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp6&#45;&gt;Expert25_s0_l1_tp6 -->
<g id="edge98" class="edge">
<title>Gate_s0_l1_tp6&#45;&gt;Expert25_s0_l1_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12707.42,-17694.46C12707.42,-17686.48 12707.42,-17677.52 12707.42,-17668.98"/>
<polygon fill="black" stroke="black" points="12710.92,-17668.84 12707.42,-17658.84 12703.92,-17668.84 12710.92,-17668.84"/>
</g>
<!-- Expert26_s0_l1_tp6 -->
<g id="node78" class="node">
<title>Expert26_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="13187.42,-17658.59 12879.42,-17658.59 12879.42,-17605.59 13187.42,-17605.59 13187.42,-17658.59"/>
<text text-anchor="middle" x="13033.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="13033.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13033.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp6&#45;&gt;Expert26_s0_l1_tp6 -->
<g id="edge99" class="edge">
<title>Gate_s0_l1_tp6&#45;&gt;Expert26_s0_l1_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12803.03,-17694.58C12842.26,-17684.11 12887.8,-17671.95 12927.99,-17661.23"/>
<polygon fill="black" stroke="black" points="12929.06,-17664.57 12937.82,-17658.61 12927.25,-17657.8 12929.06,-17664.57"/>
</g>
<!-- Expert27_s0_l1_tp6 -->
<g id="node79" class="node">
<title>Expert27_s0_l1_tp6</title>
<polygon fill="none" stroke="black" points="13513.42,-17658.59 13205.42,-17658.59 13205.42,-17605.59 13513.42,-17605.59 13513.42,-17658.59"/>
<text text-anchor="middle" x="13359.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="13359.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13359.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp6&#45;&gt;Expert27_s0_l1_tp6 -->
<g id="edge100" class="edge">
<title>Gate_s0_l1_tp6&#45;&gt;Expert27_s0_l1_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12876.47,-17700.1C12967.97,-17688.97 13083.22,-17674.46 13194.9,-17658.79"/>
<polygon fill="black" stroke="black" points="13195.59,-17662.23 13205.01,-17657.37 13194.62,-17655.3 13195.59,-17662.23"/>
</g>
<!-- Expert28_s0_l1_tp7 -->
<g id="node80" class="node">
<title>Expert28_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="11231.42,-17658.59 10923.42,-17658.59 10923.42,-17605.59 11231.42,-17605.59 11231.42,-17658.59"/>
<text text-anchor="middle" x="11077.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="11077.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11077.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp7&#45;&gt;Expert28_s0_l1_tp7 -->
<g id="edge101" class="edge">
<title>Gate_s0_l1_tp7&#45;&gt;Expert28_s0_l1_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11307.81,-17694.58C11268.59,-17684.11 11223.04,-17671.95 11182.85,-17661.23"/>
<polygon fill="black" stroke="black" points="11183.59,-17657.8 11173.03,-17658.61 11181.79,-17664.57 11183.59,-17657.8"/>
</g>
<!-- Expert29_s0_l1_tp7 -->
<g id="node81" class="node">
<title>Expert29_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="11557.42,-17658.59 11249.42,-17658.59 11249.42,-17605.59 11557.42,-17605.59 11557.42,-17658.59"/>
<text text-anchor="middle" x="11403.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="11403.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11403.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp7&#45;&gt;Expert29_s0_l1_tp7 -->
<g id="edge102" class="edge">
<title>Gate_s0_l1_tp7&#45;&gt;Expert29_s0_l1_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11403.42,-17694.46C11403.42,-17686.48 11403.42,-17677.52 11403.42,-17668.98"/>
<polygon fill="black" stroke="black" points="11406.92,-17668.84 11403.42,-17658.84 11399.92,-17668.84 11406.92,-17668.84"/>
</g>
<!-- Expert30_s0_l1_tp7 -->
<g id="node82" class="node">
<title>Expert30_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="11883.42,-17658.59 11575.42,-17658.59 11575.42,-17605.59 11883.42,-17605.59 11883.42,-17658.59"/>
<text text-anchor="middle" x="11729.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="11729.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11729.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp7&#45;&gt;Expert30_s0_l1_tp7 -->
<g id="edge103" class="edge">
<title>Gate_s0_l1_tp7&#45;&gt;Expert30_s0_l1_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11499.03,-17694.58C11538.26,-17684.11 11583.8,-17671.95 11623.99,-17661.23"/>
<polygon fill="black" stroke="black" points="11625.06,-17664.57 11633.82,-17658.61 11623.25,-17657.8 11625.06,-17664.57"/>
</g>
<!-- Expert31_s0_l1_tp7 -->
<g id="node83" class="node">
<title>Expert31_s0_l1_tp7</title>
<polygon fill="none" stroke="black" points="12209.42,-17658.59 11901.42,-17658.59 11901.42,-17605.59 12209.42,-17605.59 12209.42,-17658.59"/>
<text text-anchor="middle" x="12055.42" y="-17643.39" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="12055.42" y="-17628.39" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12055.42" y="-17613.39" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l1_tp7&#45;&gt;Expert31_s0_l1_tp7 -->
<g id="edge104" class="edge">
<title>Gate_s0_l1_tp7&#45;&gt;Expert31_s0_l1_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11572.47,-17700.1C11663.97,-17688.97 11779.22,-17674.46 11890.9,-17658.79"/>
<polygon fill="black" stroke="black" points="11891.59,-17662.23 11901.01,-17657.37 11890.62,-17655.3 11891.59,-17662.23"/>
</g>
<!-- AR_exp_s0_l1 -->
<g id="node84" class="node">
<title>AR_exp_s0_l1</title>
<ellipse fill="none" stroke="black" cx="8364.42" cy="-17532.12" rx="239" ry="37.45"/>
<text text-anchor="middle" x="8364.42" y="-17543.42" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="8364.42" y="-17528.42" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8364.42" y="-17513.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l1_tp0&#45;&gt;AR_exp_s0_l1 -->
<g id="edge105" class="edge">
<title>Expert0_s0_l1_tp0&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M7960.07,-17605.54C8033.53,-17592.38 8123.48,-17576.27 8199.87,-17562.59"/>
<polygon fill="black" stroke="black" points="8200.85,-17565.97 8210.07,-17560.76 8199.61,-17559.08 8200.85,-17565.97"/>
</g>
<!-- Expert1_s0_l1_tp0&#45;&gt;AR_exp_s0_l1 -->
<g id="edge106" class="edge">
<title>Expert1_s0_l1_tp0&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M8201.2,-17605.48C8224.44,-17595.18 8251.73,-17583.07 8277.29,-17571.75"/>
<polygon fill="black" stroke="black" points="8278.89,-17574.87 8286.61,-17567.61 8276.05,-17568.47 8278.89,-17574.87"/>
</g>
<!-- Expert2_s0_l1_tp0&#45;&gt;AR_exp_s0_l1 -->
<g id="edge107" class="edge">
<title>Expert2_s0_l1_tp0&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M7319.81,-17606.6C7322.7,-17606.25 7325.58,-17605.91 7328.42,-17605.59 7601.21,-17574.77 7915.98,-17554.97 8126.3,-17543.99"/>
<polygon fill="black" stroke="black" points="8126.74,-17547.47 8136.55,-17543.46 8126.38,-17540.48 8126.74,-17547.47"/>
</g>
<!-- Expert3_s0_l1_tp0&#45;&gt;AR_exp_s0_l1 -->
<g id="edge108" class="edge">
<title>Expert3_s0_l1_tp0&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M7645.83,-17606.72C7648.71,-17606.34 7651.58,-17605.96 7654.42,-17605.59 7819.88,-17584.22 8007.69,-17565.28 8148.58,-17552.13"/>
<polygon fill="black" stroke="black" points="8149.01,-17555.6 8158.64,-17551.19 8148.36,-17548.63 8149.01,-17555.6"/>
</g>
<!-- Expert4_s0_l1_tp1&#45;&gt;AR_exp_s0_l1 -->
<g id="edge109" class="edge">
<title>Expert4_s0_l1_tp1&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M5363.79,-17606.42C5366.69,-17606.12 5369.57,-17605.85 5372.42,-17605.59 5901.98,-17557.96 7497.04,-17540.17 8115.55,-17534.95"/>
<polygon fill="black" stroke="black" points="8115.96,-17538.44 8125.93,-17534.86 8115.9,-17531.44 8115.96,-17538.44"/>
</g>
<!-- Expert5_s0_l1_tp1&#45;&gt;AR_exp_s0_l1 -->
<g id="edge110" class="edge">
<title>Expert5_s0_l1_tp1&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M5689.79,-17606.43C5692.69,-17606.13 5695.57,-17605.85 5698.42,-17605.59 6162.79,-17563.13 7546.81,-17542.62 8115.86,-17535.8"/>
<polygon fill="black" stroke="black" points="8116.3,-17539.3 8126.25,-17535.68 8116.21,-17532.3 8116.3,-17539.3"/>
</g>
<!-- Expert6_s0_l1_tp1&#45;&gt;AR_exp_s0_l1 -->
<g id="edge111" class="edge">
<title>Expert6_s0_l1_tp1&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M4711.79,-17606.4C4714.69,-17606.11 4717.57,-17605.84 4720.42,-17605.59 5381.48,-17547.58 7405.48,-17535.98 8115.28,-17533.68"/>
<polygon fill="black" stroke="black" points="8115.39,-17537.18 8125.38,-17533.65 8115.36,-17530.18 8115.39,-17537.18"/>
</g>
<!-- Expert7_s0_l1_tp1&#45;&gt;AR_exp_s0_l1 -->
<g id="edge112" class="edge">
<title>Expert7_s0_l1_tp1&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M5037.79,-17606.41C5040.69,-17606.12 5043.57,-17605.85 5046.42,-17605.59 5641.58,-17552.78 7450.18,-17537.97 8115.43,-17534.25"/>
<polygon fill="black" stroke="black" points="8115.64,-17537.75 8125.62,-17534.19 8115.6,-17530.75 8115.64,-17537.75"/>
</g>
<!-- Expert8_s0_l1_tp2&#45;&gt;AR_exp_s0_l1 -->
<g id="edge113" class="edge">
<title>Expert8_s0_l1_tp2&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M6993.8,-17606.53C6996.7,-17606.2 6999.57,-17605.89 7002.42,-17605.59 7391.36,-17564.93 7845.29,-17546.57 8118.51,-17538.66"/>
<polygon fill="black" stroke="black" points="8118.66,-17542.15 8128.55,-17538.37 8118.46,-17535.16 8118.66,-17542.15"/>
</g>
<!-- Expert9_s0_l1_tp2&#45;&gt;AR_exp_s0_l1 -->
<g id="edge114" class="edge">
<title>Expert9_s0_l1_tp2&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M6015.8,-17606.44C6018.69,-17606.14 6021.57,-17605.86 6024.42,-17605.59 6424.18,-17568.28 7600.57,-17545.39 8116.8,-17536.89"/>
<polygon fill="black" stroke="black" points="8117.04,-17540.38 8126.98,-17536.72 8116.93,-17533.39 8117.04,-17540.38"/>
</g>
<!-- Expert10_s0_l1_tp2&#45;&gt;AR_exp_s0_l1 -->
<g id="edge115" class="edge">
<title>Expert10_s0_l1_tp2&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M6341.8,-17606.46C6344.69,-17606.16 6347.57,-17605.87 6350.42,-17605.59 6983.9,-17544.86 7733.89,-17533.84 8115.04,-17532.55"/>
<polygon fill="black" stroke="black" points="8115.11,-17536.05 8125.1,-17532.52 8115.09,-17529.05 8115.11,-17536.05"/>
</g>
<!-- Expert11_s0_l1_tp2&#45;&gt;AR_exp_s0_l1 -->
<g id="edge116" class="edge">
<title>Expert11_s0_l1_tp2&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M6667.8,-17606.49C6670.7,-17606.18 6673.57,-17605.88 6676.42,-17605.59 7186.14,-17554.94 7785.92,-17539.67 8115.7,-17535.08"/>
<polygon fill="black" stroke="black" points="8115.91,-17538.57 8125.86,-17534.94 8115.82,-17531.57 8115.91,-17538.57"/>
</g>
<!-- Expert12_s0_l1_tp3&#45;&gt;AR_exp_s0_l1 -->
<g id="edge117" class="edge">
<title>Expert12_s0_l1_tp3&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M8441.84,-17605.35C8432.35,-17596.5 8421.45,-17586.33 8410.88,-17576.47"/>
<polygon fill="black" stroke="black" points="8412.97,-17573.63 8403.27,-17569.37 8408.2,-17578.75 8412.97,-17573.63"/>
</g>
<!-- Expert13_s0_l1_tp3&#45;&gt;AR_exp_s0_l1 -->
<g id="edge118" class="edge">
<title>Expert13_s0_l1_tp3&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M8683.03,-17605.54C8629.27,-17593.32 8564.31,-17578.56 8507.11,-17565.55"/>
<polygon fill="black" stroke="black" points="8507.79,-17562.12 8497.27,-17563.31 8506.24,-17568.94 8507.79,-17562.12"/>
</g>
<!-- Expert14_s0_l1_tp3&#45;&gt;AR_exp_s0_l1 -->
<g id="edge119" class="edge">
<title>Expert14_s0_l1_tp3&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M8967.01,-17606.8C8964.12,-17606.39 8961.26,-17605.99 8958.42,-17605.59 8827.69,-17587.4 8680.42,-17569.41 8565.23,-17555.91"/>
<polygon fill="black" stroke="black" points="8565.58,-17552.43 8555.24,-17554.74 8564.76,-17559.38 8565.58,-17552.43"/>
</g>
<!-- Expert15_s0_l1_tp3&#45;&gt;AR_exp_s0_l1 -->
<g id="edge120" class="edge">
<title>Expert15_s0_l1_tp3&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M9293.03,-17606.63C9290.14,-17606.27 9287.27,-17605.93 9284.42,-17605.59 9051.22,-17578.21 8783.51,-17558.42 8597.24,-17546.51"/>
<polygon fill="black" stroke="black" points="8597.24,-17543.01 8587.04,-17545.86 8596.79,-17549.99 8597.24,-17543.01"/>
</g>
<!-- Expert16_s0_l1_tp4&#45;&gt;AR_exp_s0_l1 -->
<g id="edge121" class="edge">
<title>Expert16_s0_l1_tp4&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M9619.04,-17606.55C9616.14,-17606.22 9613.27,-17605.9 9610.42,-17605.59 9263.46,-17568.45 8859.97,-17549.36 8608.36,-17540.3"/>
<polygon fill="black" stroke="black" points="8608.47,-17536.81 8598.36,-17539.95 8608.22,-17543.8 8608.47,-17536.81"/>
</g>
<!-- Expert17_s0_l1_tp4&#45;&gt;AR_exp_s0_l1 -->
<g id="edge122" class="edge">
<title>Expert17_s0_l1_tp4&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M9945.04,-17606.5C9942.15,-17606.18 9939.27,-17605.88 9936.42,-17605.59 9470.04,-17558.5 8922.69,-17541.98 8612.4,-17536.2"/>
<polygon fill="black" stroke="black" points="8612.43,-17532.7 8602.37,-17536.02 8612.31,-17539.7 8612.43,-17532.7"/>
</g>
<!-- Expert18_s0_l1_tp4&#45;&gt;AR_exp_s0_l1 -->
<g id="edge123" class="edge">
<title>Expert18_s0_l1_tp4&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M10271.05,-17606.47C10268.15,-17606.16 10265.27,-17605.87 10262.42,-17605.59 9673.26,-17548.46 8977.13,-17535.81 8613.72,-17533.36"/>
<polygon fill="black" stroke="black" points="8613.62,-17529.86 8603.6,-17533.29 8613.58,-17536.86 8613.62,-17529.86"/>
</g>
<!-- Expert19_s0_l1_tp4&#45;&gt;AR_exp_s0_l1 -->
<g id="edge124" class="edge">
<title>Expert19_s0_l1_tp4&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M10597.05,-17606.45C10594.15,-17606.15 10591.27,-17605.86 10588.42,-17605.59 10211.57,-17570.11 9108.48,-17546.48 8611.82,-17537.35"/>
<polygon fill="black" stroke="black" points="8611.72,-17533.85 8601.65,-17537.16 8611.59,-17540.85 8611.72,-17533.85"/>
</g>
<!-- Expert20_s0_l1_tp5&#45;&gt;AR_exp_s0_l1 -->
<g id="edge125" class="edge">
<title>Expert20_s0_l1_tp5&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M3407.79,-17606.38C3410.69,-17606.1 3413.57,-17605.84 3416.42,-17605.59 3885.45,-17565.67 7177.88,-17540.98 8115.69,-17534.71"/>
<polygon fill="black" stroke="black" points="8115.96,-17538.2 8125.93,-17534.64 8115.91,-17531.2 8115.96,-17538.2"/>
</g>
<!-- Expert21_s0_l1_tp5&#45;&gt;AR_exp_s0_l1 -->
<g id="edge126" class="edge">
<title>Expert21_s0_l1_tp5&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M3733.79,-17606.38C3736.69,-17606.1 3739.57,-17605.84 3742.42,-17605.59 4177.86,-17568.3 7218.7,-17542 8115.83,-17534.98"/>
<polygon fill="black" stroke="black" points="8115.99,-17538.48 8125.96,-17534.9 8115.94,-17531.48 8115.99,-17538.48"/>
</g>
<!-- Expert22_s0_l1_tp5&#45;&gt;AR_exp_s0_l1 -->
<g id="edge127" class="edge">
<title>Expert22_s0_l1_tp5&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M4059.79,-17606.39C4062.69,-17606.1 4065.57,-17605.84 4068.42,-17605.59 4862.08,-17537.15 7321.76,-17532.46 8115.06,-17532.79"/>
<polygon fill="black" stroke="black" points="8115.17,-17536.29 8125.18,-17532.79 8115.18,-17529.29 8115.17,-17536.29"/>
</g>
<!-- Expert23_s0_l1_tp5&#45;&gt;AR_exp_s0_l1 -->
<g id="edge128" class="edge">
<title>Expert23_s0_l1_tp5&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M4385.79,-17606.39C4388.69,-17606.11 4391.57,-17605.84 4394.42,-17605.59 5121.66,-17542.37 7362.79,-17534.15 8115.17,-17533.2"/>
<polygon fill="black" stroke="black" points="8115.33,-17536.7 8125.32,-17533.18 8115.32,-17529.7 8115.33,-17536.7"/>
</g>
<!-- Expert24_s0_l1_tp6&#45;&gt;AR_exp_s0_l1 -->
<g id="edge129" class="edge">
<title>Expert24_s0_l1_tp6&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M12227.05,-17606.4C12224.16,-17606.11 12221.28,-17605.84 12218.42,-17605.59 11514.81,-17544.23 9351.37,-17534.78 8613.79,-17533.36"/>
<polygon fill="black" stroke="black" points="8613.57,-17529.86 8603.57,-17533.34 8613.56,-17536.86 8613.57,-17529.86"/>
</g>
<!-- Expert25_s0_l1_tp6&#45;&gt;AR_exp_s0_l1 -->
<g id="edge130" class="edge">
<title>Expert25_s0_l1_tp6&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M12553.05,-17606.39C12550.16,-17606.11 12547.28,-17605.84 12544.42,-17605.59 11774.44,-17539.01 9392.76,-17533.05 8613.79,-17532.93"/>
<polygon fill="black" stroke="black" points="8613.57,-17529.43 8603.57,-17532.93 8613.57,-17536.43 8613.57,-17529.43"/>
</g>
<!-- Expert26_s0_l1_tp6&#45;&gt;AR_exp_s0_l1 -->
<g id="edge131" class="edge">
<title>Expert26_s0_l1_tp6&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M12879.05,-17606.39C12876.16,-17606.1 12873.28,-17605.84 12870.42,-17605.59 12033.85,-17533.78 9432.56,-17531.44 8613.8,-17532.56"/>
<polygon fill="black" stroke="black" points="8613.65,-17529.06 8603.65,-17532.57 8613.66,-17536.06 8613.65,-17529.06"/>
</g>
<!-- Expert27_s0_l1_tp6&#45;&gt;AR_exp_s0_l1 -->
<g id="edge132" class="edge">
<title>Expert27_s0_l1_tp6&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M13205.06,-17606.38C13202.16,-17606.1 13199.28,-17605.84 13196.42,-17605.59 12739.38,-17566.61 9536.84,-17541.34 8613.21,-17534.8"/>
<polygon fill="black" stroke="black" points="8613.14,-17531.3 8603.12,-17534.73 8613.09,-17538.3 8613.14,-17531.3"/>
</g>
<!-- Expert28_s0_l1_tp7&#45;&gt;AR_exp_s0_l1 -->
<g id="edge133" class="edge">
<title>Expert28_s0_l1_tp7&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M10923.05,-17606.43C10920.15,-17606.14 10917.27,-17605.86 10914.42,-17605.59 10473.01,-17564.96 9162.76,-17543.56 8612.33,-17536.16"/>
<polygon fill="black" stroke="black" points="8612.32,-17532.65 8602.28,-17536.02 8612.23,-17539.65 8612.32,-17532.65"/>
</g>
<!-- Expert29_s0_l1_tp7&#45;&gt;AR_exp_s0_l1 -->
<g id="edge134" class="edge">
<title>Expert29_s0_l1_tp7&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M11249.05,-17606.42C11246.15,-17606.13 11243.28,-17605.85 11240.42,-17605.59 10734.03,-17559.8 9213.98,-17541 8612.93,-17535.23"/>
<polygon fill="black" stroke="black" points="8612.87,-17531.73 8602.84,-17535.13 8612.8,-17538.73 8612.87,-17531.73"/>
</g>
<!-- Expert30_s0_l1_tp7&#45;&gt;AR_exp_s0_l1 -->
<g id="edge135" class="edge">
<title>Expert30_s0_l1_tp7&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M11575.05,-17606.41C11572.15,-17606.12 11569.28,-17605.85 11566.42,-17605.59 10994.72,-17554.63 9262.71,-17538.73 8613.63,-17534.48"/>
<polygon fill="black" stroke="black" points="8613.23,-17530.98 8603.21,-17534.42 8613.18,-17537.98 8613.23,-17530.98"/>
</g>
<!-- Expert31_s0_l1_tp7&#45;&gt;AR_exp_s0_l1 -->
<g id="edge136" class="edge">
<title>Expert31_s0_l1_tp7&#45;&gt;AR_exp_s0_l1</title>
<path fill="none" stroke="black" d="M11901.05,-17606.4C11898.15,-17606.11 11895.28,-17605.84 11892.42,-17605.59 11254.87,-17549.43 9307.83,-17536.67 8613.58,-17533.87"/>
<polygon fill="black" stroke="black" points="8613.47,-17530.37 8603.46,-17533.83 8613.44,-17537.37 8613.47,-17530.37"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp0 -->
<g id="edge137" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M8304.81,-17495.78C8288.13,-17485.9 8269.57,-17474.89 8251.33,-17464.08"/>
<polygon fill="black" stroke="black" points="8252.8,-17460.89 8242.42,-17458.8 8249.23,-17466.91 8252.8,-17460.89"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp1 -->
<g id="edge139" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M8135.25,-17521.45C7807.61,-17507.62 7186.4,-17481.34 6657.42,-17458.64 6354.45,-17445.64 6008.42,-17430.61 5766.23,-17420.07"/>
<polygon fill="black" stroke="black" points="5766.36,-17416.57 5756.22,-17419.63 5766.06,-17423.56 5766.36,-17416.57"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp2 -->
<g id="edge141" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M8161.15,-17512.35C7945.5,-17492.43 7601.43,-17460.66 7346.74,-17437.14"/>
<polygon fill="black" stroke="black" points="7346.86,-17433.64 7336.58,-17436.2 7346.22,-17440.61 7346.86,-17433.64"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp3 -->
<g id="edge143" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M8537.45,-17506.19C8666.11,-17487.65 8843.36,-17462.12 8986.12,-17441.55"/>
<polygon fill="black" stroke="black" points="8986.94,-17444.97 8996.34,-17440.08 8985.94,-17438.04 8986.94,-17444.97"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp4 -->
<g id="edge145" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp4</title>
<path fill="none" stroke="black" d="M8592.28,-17520.76C9093.75,-17497.96 10291.16,-17443.52 10830.67,-17418.99"/>
<polygon fill="black" stroke="black" points="10831.1,-17422.48 10840.93,-17418.53 10830.78,-17415.49 10831.1,-17422.48"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp5 -->
<g id="edge147" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp5</title>
<path fill="none" stroke="black" d="M8128.32,-17526.14C7590.73,-17514.77 6234.12,-17485.72 5099.42,-17458.64 4482.52,-17443.92 3760.57,-17425.12 3363.14,-17414.63"/>
<polygon fill="black" stroke="black" points="3363.03,-17411.12 3352.94,-17414.36 3362.84,-17418.12 3363.03,-17411.12"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp6 -->
<g id="edge149" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp6</title>
<path fill="none" stroke="black" d="M8603,-17529.18C9395.79,-17522.43 11938.27,-17498.17 12757.42,-17458.64 12887.14,-17452.38 13031.15,-17441.26 13150.49,-17430.91"/>
<polygon fill="black" stroke="black" points="13150.84,-17434.4 13160.5,-17430.04 13150.23,-17427.42 13150.84,-17434.4"/>
</g>
<!-- AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp7 -->
<g id="edge151" class="edge">
<title>AR_exp_s0_l1&#45;&gt;ResMOE_s0_l1_tp7</title>
<path fill="none" stroke="black" d="M8602.49,-17528.14C9121.81,-17521.09 10395.35,-17500.68 11461.42,-17458.64 11688.13,-17449.7 11945.46,-17435.1 12133.01,-17423.64"/>
<polygon fill="black" stroke="black" points="12133.24,-17427.13 12143.01,-17423.03 12132.82,-17420.15 12133.24,-17427.13"/>
</g>
<!-- QKV_s0_l2_tp0 -->
<g id="node93" class="node">
<title>QKV_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7373.42,-17316.64 7035.42,-17316.64 7035.42,-17263.64 7373.42,-17263.64 7373.42,-17316.64"/>
<text text-anchor="middle" x="7204.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7204.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7204.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp0 -->
<g id="edge153" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7820.56,-17364.9C7693.98,-17349.82 7548.54,-17332.46 7416.42,-17316.64 7405.78,-17315.37 7394.85,-17314.05 7383.81,-17312.73"/>
<polygon fill="black" stroke="black" points="7384,-17309.23 7373.65,-17311.51 7383.17,-17316.18 7384,-17309.23"/>
</g>
<!-- QKV_s0_l2_tp1 -->
<g id="node94" class="node">
<title>QKV_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7763.42,-17316.64 7425.42,-17316.64 7425.42,-17263.64 7763.42,-17263.64 7763.42,-17316.64"/>
<text text-anchor="middle" x="7594.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7594.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7594.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp1 -->
<g id="edge154" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7897.78,-17352.62C7840.04,-17340.92 7780.98,-17328.95 7730.49,-17318.72"/>
<polygon fill="black" stroke="black" points="7731,-17315.25 7720.51,-17316.69 7729.61,-17322.11 7731,-17315.25"/>
</g>
<!-- QKV_s0_l2_tp2 -->
<g id="node95" class="node">
<title>QKV_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="8144.42,-17316.64 7806.42,-17316.64 7806.42,-17263.64 8144.42,-17263.64 8144.42,-17316.64"/>
<text text-anchor="middle" x="7975.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7975.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7975.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp2 -->
<g id="edge155" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M8072.26,-17352.54C8055.82,-17342.12 8039.04,-17331.48 8024.18,-17322.05"/>
<polygon fill="black" stroke="black" points="8025.98,-17319.05 8015.66,-17316.65 8022.23,-17324.96 8025.98,-17319.05"/>
</g>
<!-- QKV_s0_l2_tp3 -->
<g id="node96" class="node">
<title>QKV_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8509.42,-17316.64 8171.42,-17316.64 8171.42,-17263.64 8509.42,-17263.64 8509.42,-17316.64"/>
<text text-anchor="middle" x="8340.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8340.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8340.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp3 -->
<g id="edge156" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8239.8,-17352.54C8256.89,-17342.12 8274.31,-17331.48 8289.76,-17322.05"/>
<polygon fill="black" stroke="black" points="8291.9,-17324.85 8298.61,-17316.65 8288.25,-17318.87 8291.9,-17324.85"/>
</g>
<!-- QKV_s0_l2_tp4 -->
<g id="node97" class="node">
<title>QKV_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="8890.42,-17316.64 8552.42,-17316.64 8552.42,-17263.64 8890.42,-17263.64 8890.42,-17316.64"/>
<text text-anchor="middle" x="8721.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8721.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8721.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp4 -->
<g id="edge157" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8372.83,-17360.92C8443.75,-17346.72 8520.42,-17331.38 8583.74,-17318.7"/>
<polygon fill="black" stroke="black" points="8584.67,-17322.08 8593.79,-17316.69 8583.3,-17315.22 8584.67,-17322.08"/>
</g>
<!-- QKV_s0_l2_tp5 -->
<g id="node98" class="node">
<title>QKV_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="9276.42,-17316.64 8938.42,-17316.64 8938.42,-17263.64 9276.42,-17263.64 9276.42,-17316.64"/>
<text text-anchor="middle" x="9107.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9107.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9107.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp5 -->
<g id="edge158" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M8393.93,-17376.62C8540.01,-17359.46 8730.52,-17336.97 8899.42,-17316.64 8908.81,-17315.51 8918.43,-17314.35 8928.14,-17313.17"/>
<polygon fill="black" stroke="black" points="8928.78,-17316.62 8938.29,-17311.94 8927.94,-17309.67 8928.78,-17316.62"/>
</g>
<!-- QKV_s0_l2_tp6 -->
<g id="node99" class="node">
<title>QKV_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="9664.42,-17316.64 9326.42,-17316.64 9326.42,-17263.64 9664.42,-17263.64 9664.42,-17316.64"/>
<text text-anchor="middle" x="9495.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9495.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9495.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp6 -->
<g id="edge159" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M8406.99,-17386.27C8687.11,-17365.66 9121.17,-17332.99 9285.42,-17316.64 9295.46,-17315.64 9305.76,-17314.56 9316.16,-17313.43"/>
<polygon fill="black" stroke="black" points="9316.59,-17316.91 9326.15,-17312.33 9315.82,-17309.95 9316.59,-17316.91"/>
</g>
<!-- QKV_s0_l2_tp7 -->
<g id="node100" class="node">
<title>QKV_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="6991.42,-17316.64 6653.42,-17316.64 6653.42,-17263.64 6991.42,-17263.64 6991.42,-17316.64"/>
<text text-anchor="middle" x="6822.42" y="-17301.44" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6822.42" y="-17286.44" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6822.42" y="-17271.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp7 -->
<g id="edge160" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;QKV_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M7847.07,-17384.54C7620.08,-17368.75 7303.68,-17344.77 7026.42,-17316.64 7018.34,-17315.82 7010.09,-17314.94 7001.76,-17314.03"/>
<polygon fill="black" stroke="black" points="7001.88,-17310.52 6991.56,-17312.9 7001.11,-17317.48 7001.88,-17310.52"/>
</g>
<!-- ResAttn_s0_l2_tp0 -->
<g id="node127" class="node">
<title>ResAttn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7413.77,-16738.73 6856.45,-16738.73 6713.08,-16632.73 7270.4,-16632.73 7413.77,-16738.73"/>
<text text-anchor="middle" x="7063.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7063.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7063.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp0 -->
<g id="edge202" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7844.6,-17382.71C7701.79,-17372.93 7530.02,-17361.61 7375.42,-17352.64 7294.24,-17347.93 6713.09,-17360.2 6644.42,-17316.64 6595.73,-17285.76 6583.42,-17259.8 6583.42,-17202.14 6583.42,-17202.14 6583.42,-17202.14 6583.42,-16900.21 6583.42,-16789.66 6691.04,-16735.93 6804.36,-16710.01"/>
<polygon fill="black" stroke="black" points="6805.28,-16713.39 6814.28,-16707.82 6803.76,-16706.56 6805.28,-16713.39"/>
</g>
<!-- ResAttn_s0_l2_tp1 -->
<g id="node128" class="node">
<title>ResAttn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="5691.77,-16738.73 5134.45,-16738.73 4991.08,-16632.73 5548.4,-16632.73 5691.77,-16738.73"/>
<text text-anchor="middle" x="5341.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5341.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5341.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp1 -->
<g id="edge204" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7842.33,-17381.22C7699.99,-17371.21 7529.25,-17360.12 7375.42,-17352.64 6852.69,-17327.21 6719,-17370.45 6198.42,-17316.64 6053.4,-17301.65 5552.42,-17347.93 5552.42,-17202.14 5552.42,-17202.14 5552.42,-17202.14 5552.42,-16900.21 5552.42,-16834.17 5500.72,-16781.21 5448.5,-16744.55"/>
<polygon fill="black" stroke="black" points="5450.35,-16741.58 5440.13,-16738.81 5446.4,-16747.35 5450.35,-16741.58"/>
</g>
<!-- ResAttn_s0_l2_tp2 -->
<g id="node129" class="node">
<title>ResAttn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6539.77,-16738.73 5982.45,-16738.73 5839.08,-16632.73 6396.4,-16632.73 6539.77,-16738.73"/>
<text text-anchor="middle" x="6189.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6189.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6189.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp2 -->
<g id="edge206" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7844.15,-17382.44C7701.43,-17372.61 7529.87,-17361.33 7375.42,-17352.64 7026.72,-17333.01 6935.11,-17372.97 6590.42,-17316.64 6407.5,-17286.75 6189.42,-17387.48 6189.42,-17202.14 6189.42,-17202.14 6189.42,-17202.14 6189.42,-16900.21 6189.42,-16849.36 6189.42,-16791.71 6189.42,-16749.14"/>
<polygon fill="black" stroke="black" points="6192.92,-16748.93 6189.42,-16738.93 6185.92,-16748.93 6192.92,-16748.93"/>
</g>
<!-- ResAttn_s0_l2_tp3 -->
<g id="node130" class="node">
<title>ResAttn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9551.77,-16738.73 8994.45,-16738.73 8851.08,-16632.73 9408.4,-16632.73 9551.77,-16738.73"/>
<text text-anchor="middle" x="9201.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9201.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9201.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp3 -->
<g id="edge208" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8404.96,-17384.7C8542.09,-17374.22 8715.05,-17361.71 8869.42,-17352.64 8958.69,-17347.4 9596.72,-17362.6 9673.42,-17316.64 9724.19,-17286.22 9741.42,-17261.33 9741.42,-17202.14 9741.42,-17202.14 9741.42,-17202.14 9741.42,-16900.21 9741.42,-16833.57 9597.41,-16778.83 9458.13,-16741.47"/>
<polygon fill="black" stroke="black" points="9458.68,-16737.99 9448.11,-16738.81 9456.88,-16744.76 9458.68,-16737.99"/>
</g>
<!-- ResAttn_s0_l2_tp4 -->
<g id="node131" class="node">
<title>ResAttn_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="10485.77,-16738.73 9928.45,-16738.73 9785.08,-16632.73 10342.4,-16632.73 10485.77,-16738.73"/>
<text text-anchor="middle" x="10135.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10135.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10135.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp4 -->
<g id="edge210" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8404.96,-17384.57C8542.08,-17374.05 8715.04,-17361.54 8869.42,-17352.64 9245.14,-17330.99 9343.56,-17374.49 9715.42,-17316.64 9906.6,-17286.9 10135.42,-17395.62 10135.42,-17202.14 10135.42,-17202.14 10135.42,-17202.14 10135.42,-16900.21 10135.42,-16849.36 10135.42,-16791.71 10135.42,-16749.14"/>
<polygon fill="black" stroke="black" points="10138.92,-16748.93 10135.42,-16738.93 10131.92,-16748.93 10138.92,-16748.93"/>
</g>
<!-- ResAttn_s0_l2_tp5 -->
<g id="node132" class="node">
<title>ResAttn_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="4550.77,-16738.73 3993.45,-16738.73 3850.08,-16632.73 4407.4,-16632.73 4550.77,-16738.73"/>
<text text-anchor="middle" x="4200.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4200.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4200.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp5 -->
<g id="edge212" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M7841.42,-17380.41C7699.28,-17370.27 7528.95,-17359.31 7375.42,-17352.64 6979.49,-17335.44 5986.44,-17359.11 5592.42,-17316.64 5330.75,-17288.43 5011.42,-17465.33 5011.42,-17202.14 5011.42,-17202.14 5011.42,-17202.14 5011.42,-16900.21 5011.42,-16794.41 4750.02,-16739.93 4524.03,-16712.61"/>
<polygon fill="black" stroke="black" points="4524.32,-16709.12 4513.98,-16711.4 4523.49,-16716.07 4524.32,-16709.12"/>
</g>
<!-- ResAttn_s0_l2_tp6 -->
<g id="node133" class="node">
<title>ResAttn_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="12628.77,-16738.73 12071.45,-16738.73 11928.08,-16632.73 12485.4,-16632.73 12628.77,-16738.73"/>
<text text-anchor="middle" x="12278.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12278.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12278.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp6 -->
<g id="edge214" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M8403.66,-17383.55C8540.96,-17372.68 8714.5,-17360.15 8869.42,-17352.64 9005.3,-17346.05 11313.42,-17338.17 11313.42,-17202.14 11313.42,-17202.14 11313.42,-17202.14 11313.42,-16900.21 11313.42,-16758.4 11715.71,-16710.72 12000.81,-16694.73"/>
<polygon fill="black" stroke="black" points="12001.11,-16698.22 12010.9,-16694.18 12000.72,-16691.23 12001.11,-16698.22"/>
</g>
<!-- ResAttn_s0_l2_tp7 -->
<g id="node134" class="node">
<title>ResAttn_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="11479.77,-16738.73 10922.45,-16738.73 10779.08,-16632.73 11336.4,-16632.73 11479.77,-16738.73"/>
<text text-anchor="middle" x="11129.42" y="-16697.03" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11129.42" y="-16682.03" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11129.42" y="-16667.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp7 -->
<g id="edge216" class="edge">
<title>ResMOE_s0_l1_tp0&#45;&gt;ResAttn_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M8404.1,-17384.1C8541.35,-17373.41 8714.69,-17360.88 8869.42,-17352.64 9341.47,-17327.49 9461.4,-17356.61 9932.42,-17316.64 10120.14,-17300.71 10772.42,-17390.53 10772.42,-17202.14 10772.42,-17202.14 10772.42,-17202.14 10772.42,-16900.21 10772.42,-16822.3 10835.83,-16772.14 10909.19,-16740.18"/>
<polygon fill="black" stroke="black" points="10910.81,-16743.3 10918.66,-16736.18 10908.08,-16736.85 10910.81,-16743.3"/>
</g>
<!-- SplitHeads_s0_l2_tp0 -->
<g id="node101" class="node">
<title>SplitHeads_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7373.42,-17227.64 7001.42,-17227.64 7001.42,-17174.64 7373.42,-17174.64 7373.42,-17227.64"/>
<text text-anchor="middle" x="7187.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7187.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7187.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp0&#45;&gt;SplitHeads_s0_l2_tp0 -->
<g id="edge161" class="edge">
<title>QKV_s0_l2_tp0&#45;&gt;SplitHeads_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7199.41,-17263.51C7197.84,-17255.44 7196.07,-17246.37 7194.38,-17237.74"/>
<polygon fill="black" stroke="black" points="7197.81,-17237.03 7192.45,-17227.89 7190.94,-17238.37 7197.81,-17237.03"/>
</g>
<!-- SplitHeads_s0_l2_tp1 -->
<g id="node102" class="node">
<title>SplitHeads_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7763.42,-17227.64 7391.42,-17227.64 7391.42,-17174.64 7763.42,-17174.64 7763.42,-17227.64"/>
<text text-anchor="middle" x="7577.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7577.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7577.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp1&#45;&gt;SplitHeads_s0_l2_tp1 -->
<g id="edge162" class="edge">
<title>QKV_s0_l2_tp1&#45;&gt;SplitHeads_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7589.41,-17263.51C7587.84,-17255.44 7586.07,-17246.37 7584.38,-17237.74"/>
<polygon fill="black" stroke="black" points="7587.81,-17237.03 7582.45,-17227.89 7580.94,-17238.37 7587.81,-17237.03"/>
</g>
<!-- SplitHeads_s0_l2_tp2 -->
<g id="node103" class="node">
<title>SplitHeads_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="8153.42,-17227.64 7781.42,-17227.64 7781.42,-17174.64 8153.42,-17174.64 8153.42,-17227.64"/>
<text text-anchor="middle" x="7967.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7967.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7967.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp2&#45;&gt;SplitHeads_s0_l2_tp2 -->
<g id="edge163" class="edge">
<title>QKV_s0_l2_tp2&#45;&gt;SplitHeads_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7973.07,-17263.51C7972.33,-17255.53 7971.51,-17246.57 7970.72,-17238.02"/>
<polygon fill="black" stroke="black" points="7974.19,-17237.53 7969.79,-17227.89 7967.22,-17238.17 7974.19,-17237.53"/>
</g>
<!-- SplitHeads_s0_l2_tp3 -->
<g id="node104" class="node">
<title>SplitHeads_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8543.42,-17227.64 8171.42,-17227.64 8171.42,-17174.64 8543.42,-17174.64 8543.42,-17227.64"/>
<text text-anchor="middle" x="8357.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8357.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8357.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp3&#45;&gt;SplitHeads_s0_l2_tp3 -->
<g id="edge164" class="edge">
<title>QKV_s0_l2_tp3&#45;&gt;SplitHeads_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8345.43,-17263.51C8347.01,-17255.44 8348.78,-17246.37 8350.47,-17237.74"/>
<polygon fill="black" stroke="black" points="8353.91,-17238.37 8352.39,-17227.89 8347.04,-17237.03 8353.91,-17238.37"/>
</g>
<!-- SplitHeads_s0_l2_tp4 -->
<g id="node105" class="node">
<title>SplitHeads_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="8933.42,-17227.64 8561.42,-17227.64 8561.42,-17174.64 8933.42,-17174.64 8933.42,-17227.64"/>
<text text-anchor="middle" x="8747.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8747.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8747.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp4&#45;&gt;SplitHeads_s0_l2_tp4 -->
<g id="edge165" class="edge">
<title>QKV_s0_l2_tp4&#45;&gt;SplitHeads_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8729.08,-17263.51C8731.49,-17255.44 8734.2,-17246.37 8736.78,-17237.74"/>
<polygon fill="black" stroke="black" points="8740.22,-17238.47 8739.73,-17227.89 8733.51,-17236.47 8740.22,-17238.47"/>
</g>
<!-- SplitHeads_s0_l2_tp5 -->
<g id="node106" class="node">
<title>SplitHeads_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="9323.42,-17227.64 8951.42,-17227.64 8951.42,-17174.64 9323.42,-17174.64 9323.42,-17227.64"/>
<text text-anchor="middle" x="9137.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9137.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9137.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp5&#45;&gt;SplitHeads_s0_l2_tp5 -->
<g id="edge166" class="edge">
<title>QKV_s0_l2_tp5&#45;&gt;SplitHeads_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M9116.26,-17263.51C9119.07,-17255.35 9122.24,-17246.18 9125.24,-17237.46"/>
<polygon fill="black" stroke="black" points="9128.59,-17238.48 9128.54,-17227.89 9121.97,-17236.2 9128.59,-17238.48"/>
</g>
<!-- SplitHeads_s0_l2_tp6 -->
<g id="node107" class="node">
<title>SplitHeads_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="9713.42,-17227.64 9341.42,-17227.64 9341.42,-17174.64 9713.42,-17174.64 9713.42,-17227.64"/>
<text text-anchor="middle" x="9527.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9527.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9527.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp6&#45;&gt;SplitHeads_s0_l2_tp6 -->
<g id="edge167" class="edge">
<title>QKV_s0_l2_tp6&#45;&gt;SplitHeads_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M9504.85,-17263.51C9507.85,-17255.35 9511.22,-17246.18 9514.43,-17237.46"/>
<polygon fill="black" stroke="black" points="9517.78,-17238.48 9517.95,-17227.89 9511.21,-17236.07 9517.78,-17238.48"/>
</g>
<!-- SplitHeads_s0_l2_tp7 -->
<g id="node108" class="node">
<title>SplitHeads_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="6983.42,-17227.64 6611.42,-17227.64 6611.42,-17174.64 6983.42,-17174.64 6983.42,-17227.64"/>
<text text-anchor="middle" x="6797.42" y="-17212.44" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6797.42" y="-17197.44" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6797.42" y="-17182.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l2_tp7&#45;&gt;SplitHeads_s0_l2_tp7 -->
<g id="edge168" class="edge">
<title>QKV_s0_l2_tp7&#45;&gt;SplitHeads_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M6815.06,-17263.51C6812.74,-17255.44 6810.13,-17246.37 6807.65,-17237.74"/>
<polygon fill="black" stroke="black" points="6810.95,-17236.53 6804.82,-17227.89 6804.22,-17238.47 6810.95,-17236.53"/>
</g>
<!-- A2A_s0_l2 -->
<g id="node109" class="node">
<title>A2A_s0_l2</title>
<ellipse fill="none" stroke="black" cx="8162.42" cy="-17101.16" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="8162.42" y="-17112.46" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="8162.42" y="-17097.46" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8162.42" y="-17082.46" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l2_tp0&#45;&gt;A2A_s0_l2 -->
<g id="edge169" class="edge">
<title>SplitHeads_s0_l2_tp0&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M7373.45,-17175.66C7376.46,-17175.31 7379.45,-17174.97 7382.42,-17174.64 7565.43,-17154.18 7773.05,-17135.09 7928.05,-17121.64"/>
<polygon fill="black" stroke="black" points="7928.53,-17125.11 7938.19,-17120.76 7927.92,-17118.14 7928.53,-17125.11"/>
</g>
<!-- SplitHeads_s0_l2_tp1&#45;&gt;A2A_s0_l2 -->
<g id="edge170" class="edge">
<title>SplitHeads_s0_l2_tp1&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M7729.98,-17174.59C7808.22,-17161.49 7903.93,-17145.46 7985.41,-17131.81"/>
<polygon fill="black" stroke="black" points="7985.99,-17135.26 7995.27,-17130.16 7984.83,-17128.36 7985.99,-17135.26"/>
</g>
<!-- SplitHeads_s0_l2_tp2&#45;&gt;A2A_s0_l2 -->
<g id="edge171" class="edge">
<title>SplitHeads_s0_l2_tp2&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M8018.4,-17174.53C8038.24,-17164.56 8061.43,-17152.91 8083.33,-17141.9"/>
<polygon fill="black" stroke="black" points="8084.94,-17145.01 8092.3,-17137.39 8081.8,-17138.76 8084.94,-17145.01"/>
</g>
<!-- SplitHeads_s0_l2_tp3&#45;&gt;A2A_s0_l2 -->
<g id="edge172" class="edge">
<title>SplitHeads_s0_l2_tp3&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M8306.44,-17174.53C8286.61,-17164.56 8263.42,-17152.91 8241.51,-17141.9"/>
<polygon fill="black" stroke="black" points="8243.05,-17138.76 8232.54,-17137.39 8239.91,-17145.01 8243.05,-17138.76"/>
</g>
<!-- SplitHeads_s0_l2_tp4&#45;&gt;A2A_s0_l2 -->
<g id="edge173" class="edge">
<title>SplitHeads_s0_l2_tp4&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M8594.87,-17174.59C8516.63,-17161.49 8420.91,-17145.46 8339.44,-17131.81"/>
<polygon fill="black" stroke="black" points="8340.02,-17128.36 8329.58,-17130.16 8338.86,-17135.26 8340.02,-17128.36"/>
</g>
<!-- SplitHeads_s0_l2_tp5&#45;&gt;A2A_s0_l2 -->
<g id="edge174" class="edge">
<title>SplitHeads_s0_l2_tp5&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M8951.4,-17175.66C8948.39,-17175.31 8945.39,-17174.97 8942.42,-17174.64 8759.42,-17154.18 8551.79,-17135.09 8396.79,-17121.64"/>
<polygon fill="black" stroke="black" points="8396.92,-17118.14 8386.66,-17120.76 8396.32,-17125.11 8396.92,-17118.14"/>
</g>
<!-- SplitHeads_s0_l2_tp6&#45;&gt;A2A_s0_l2 -->
<g id="edge175" class="edge">
<title>SplitHeads_s0_l2_tp6&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M9341.41,-17175.53C9338.39,-17175.22 9335.4,-17174.93 9332.42,-17174.64 9020.38,-17144.61 8660.25,-17124.48 8422.88,-17113.2"/>
<polygon fill="black" stroke="black" points="8422.88,-17109.7 8412.73,-17112.72 8422.55,-17116.69 8422.88,-17109.7"/>
</g>
<!-- SplitHeads_s0_l2_tp7&#45;&gt;A2A_s0_l2 -->
<g id="edge176" class="edge">
<title>SplitHeads_s0_l2_tp7&#45;&gt;A2A_s0_l2</title>
<path fill="none" stroke="black" d="M6983.43,-17175.53C6986.45,-17175.22 6989.45,-17174.93 6992.42,-17174.64 7304.47,-17144.61 7664.6,-17124.48 7901.96,-17113.2"/>
<polygon fill="black" stroke="black" points="7902.29,-17116.69 7912.12,-17112.72 7901.96,-17109.7 7902.29,-17116.69"/>
</g>
<!-- Attn_s0_l2_tp0 -->
<g id="node110" class="node">
<title>Attn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7373.42,-17027.69 7001.42,-17027.69 7001.42,-16974.69 7373.42,-16974.69 7373.42,-17027.69"/>
<text text-anchor="middle" x="7187.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7187.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7187.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp0 -->
<g id="edge177" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7938.19,-17081.56C7784.85,-17068.31 7576.7,-17049.26 7383.51,-17027.79"/>
<polygon fill="black" stroke="black" points="7383.77,-17024.3 7373.45,-17026.67 7383,-17031.26 7383.77,-17024.3"/>
</g>
<!-- Attn_s0_l2_tp1 -->
<g id="node111" class="node">
<title>Attn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7763.42,-17027.69 7391.42,-17027.69 7391.42,-16974.69 7763.42,-16974.69 7763.42,-17027.69"/>
<text text-anchor="middle" x="7577.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7577.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7577.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp1 -->
<g id="edge178" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7995.18,-17072.15C7915.03,-17058.73 7819.42,-17042.72 7739.9,-17029.4"/>
<polygon fill="black" stroke="black" points="7740.23,-17025.9 7729.79,-17027.7 7739.07,-17032.81 7740.23,-17025.9"/>
</g>
<!-- Attn_s0_l2_tp2 -->
<g id="node112" class="node">
<title>Attn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="8153.42,-17027.69 7781.42,-17027.69 7781.42,-16974.69 8153.42,-16974.69 8153.42,-17027.69"/>
<text text-anchor="middle" x="7967.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7967.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7967.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp2 -->
<g id="edge179" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M8092.3,-17064.93C8070.99,-17054.22 8047.79,-17042.57 8027.23,-17032.24"/>
<polygon fill="black" stroke="black" points="8028.8,-17029.11 8018.29,-17027.74 8025.65,-17035.36 8028.8,-17029.11"/>
</g>
<!-- Attn_s0_l2_tp3 -->
<g id="node113" class="node">
<title>Attn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8543.42,-17027.69 8171.42,-17027.69 8171.42,-16974.69 8543.42,-16974.69 8543.42,-17027.69"/>
<text text-anchor="middle" x="8357.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8357.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8357.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp3 -->
<g id="edge180" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8232.55,-17064.93C8253.85,-17054.22 8277.06,-17042.57 8297.62,-17032.24"/>
<polygon fill="black" stroke="black" points="8299.19,-17035.36 8306.55,-17027.74 8296.05,-17029.11 8299.19,-17035.36"/>
</g>
<!-- Attn_s0_l2_tp4 -->
<g id="node114" class="node">
<title>Attn_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="8933.42,-17027.69 8561.42,-17027.69 8561.42,-16974.69 8933.42,-16974.69 8933.42,-17027.69"/>
<text text-anchor="middle" x="8747.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8747.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8747.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp4 -->
<g id="edge181" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8329.67,-17072.15C8409.81,-17058.73 8505.43,-17042.72 8584.95,-17029.4"/>
<polygon fill="black" stroke="black" points="8585.77,-17032.81 8595.06,-17027.7 8584.62,-17025.9 8585.77,-17032.81"/>
</g>
<!-- Attn_s0_l2_tp5 -->
<g id="node115" class="node">
<title>Attn_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="9323.42,-17027.69 8951.42,-17027.69 8951.42,-16974.69 9323.42,-16974.69 9323.42,-17027.69"/>
<text text-anchor="middle" x="9137.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9137.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9137.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp5 -->
<g id="edge182" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M8386.66,-17081.56C8540,-17068.31 8748.14,-17049.26 8941.34,-17027.79"/>
<polygon fill="black" stroke="black" points="8941.85,-17031.26 8951.4,-17026.67 8941.07,-17024.3 8941.85,-17031.26"/>
</g>
<!-- Attn_s0_l2_tp6 -->
<g id="node116" class="node">
<title>Attn_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="9713.42,-17027.69 9341.42,-17027.69 9341.42,-16974.69 9713.42,-16974.69 9713.42,-17027.69"/>
<text text-anchor="middle" x="9527.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9527.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9527.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp6 -->
<g id="edge183" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M8412.73,-17089.6C8647.46,-17078.54 9008.4,-17058.57 9331.39,-17027.76"/>
<polygon fill="black" stroke="black" points="9331.79,-17031.24 9341.41,-17026.8 9331.12,-17024.27 9331.79,-17031.24"/>
</g>
<!-- Attn_s0_l2_tp7 -->
<g id="node117" class="node">
<title>Attn_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="6983.42,-17027.69 6611.42,-17027.69 6611.42,-16974.69 6983.42,-16974.69 6983.42,-17027.69"/>
<text text-anchor="middle" x="6797.42" y="-17012.49" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6797.42" y="-16997.49" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6797.42" y="-16982.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l2&#45;&gt;Attn_s0_l2_tp7 -->
<g id="edge184" class="edge">
<title>A2A_s0_l2&#45;&gt;Attn_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M7912.12,-17089.6C7677.38,-17078.54 7316.44,-17058.57 6993.46,-17027.76"/>
<polygon fill="black" stroke="black" points="6993.72,-17024.27 6983.43,-17026.8 6993.05,-17031.24 6993.72,-17024.27"/>
</g>
<!-- AR_attn_s0_l2 -->
<g id="node118" class="node">
<title>AR_attn_s0_l2</title>
<ellipse fill="none" stroke="black" cx="8162.42" cy="-16901.21" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="8162.42" y="-16912.51" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="8162.42" y="-16897.51" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8162.42" y="-16882.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l2_tp0&#45;&gt;AR_attn_s0_l2 -->
<g id="edge185" class="edge">
<title>Attn_s0_l2_tp0&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M7373.45,-16975.7C7376.46,-16975.36 7379.45,-16975.02 7382.42,-16974.69 7565.43,-16954.23 7773.05,-16935.13 7928.05,-16921.69"/>
<polygon fill="black" stroke="black" points="7928.53,-16925.16 7938.19,-16920.81 7927.92,-16918.18 7928.53,-16925.16"/>
</g>
<!-- Attn_s0_l2_tp1&#45;&gt;AR_attn_s0_l2 -->
<g id="edge186" class="edge">
<title>Attn_s0_l2_tp1&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M7729.98,-16974.64C7808.22,-16961.53 7903.93,-16945.5 7985.41,-16931.86"/>
<polygon fill="black" stroke="black" points="7985.99,-16935.31 7995.27,-16930.2 7984.83,-16928.4 7985.99,-16935.31"/>
</g>
<!-- Attn_s0_l2_tp2&#45;&gt;AR_attn_s0_l2 -->
<g id="edge187" class="edge">
<title>Attn_s0_l2_tp2&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M8018.4,-16974.57C8038.24,-16964.61 8061.43,-16952.95 8083.33,-16941.95"/>
<polygon fill="black" stroke="black" points="8084.94,-16945.06 8092.3,-16937.44 8081.8,-16938.8 8084.94,-16945.06"/>
</g>
<!-- Attn_s0_l2_tp3&#45;&gt;AR_attn_s0_l2 -->
<g id="edge188" class="edge">
<title>Attn_s0_l2_tp3&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M8306.44,-16974.57C8286.61,-16964.61 8263.42,-16952.95 8241.51,-16941.95"/>
<polygon fill="black" stroke="black" points="8243.05,-16938.8 8232.54,-16937.44 8239.91,-16945.06 8243.05,-16938.8"/>
</g>
<!-- Attn_s0_l2_tp4&#45;&gt;AR_attn_s0_l2 -->
<g id="edge189" class="edge">
<title>Attn_s0_l2_tp4&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M8594.87,-16974.64C8516.63,-16961.53 8420.91,-16945.5 8339.44,-16931.86"/>
<polygon fill="black" stroke="black" points="8340.02,-16928.4 8329.58,-16930.2 8338.86,-16935.31 8340.02,-16928.4"/>
</g>
<!-- Attn_s0_l2_tp5&#45;&gt;AR_attn_s0_l2 -->
<g id="edge190" class="edge">
<title>Attn_s0_l2_tp5&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M8951.4,-16975.7C8948.39,-16975.36 8945.39,-16975.02 8942.42,-16974.69 8759.42,-16954.23 8551.79,-16935.13 8396.79,-16921.69"/>
<polygon fill="black" stroke="black" points="8396.92,-16918.18 8386.66,-16920.81 8396.32,-16925.16 8396.92,-16918.18"/>
</g>
<!-- Attn_s0_l2_tp6&#45;&gt;AR_attn_s0_l2 -->
<g id="edge191" class="edge">
<title>Attn_s0_l2_tp6&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M9341.41,-16975.57C9338.39,-16975.27 9335.4,-16974.97 9332.42,-16974.69 9020.38,-16944.65 8660.25,-16924.52 8422.88,-16913.25"/>
<polygon fill="black" stroke="black" points="8422.88,-16909.75 8412.73,-16912.77 8422.55,-16916.74 8422.88,-16909.75"/>
</g>
<!-- Attn_s0_l2_tp7&#45;&gt;AR_attn_s0_l2 -->
<g id="edge192" class="edge">
<title>Attn_s0_l2_tp7&#45;&gt;AR_attn_s0_l2</title>
<path fill="none" stroke="black" d="M6983.43,-16975.57C6986.45,-16975.27 6989.45,-16974.97 6992.42,-16974.69 7304.47,-16944.65 7664.6,-16924.52 7901.96,-16913.25"/>
<polygon fill="black" stroke="black" points="7902.29,-16916.74 7912.12,-16912.77 7901.96,-16909.75 7902.29,-16916.74"/>
</g>
<!-- O_s0_l2_tp0 -->
<g id="node119" class="node">
<title>O_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="8123.42,-16827.73 7785.42,-16827.73 7785.42,-16774.73 8123.42,-16774.73 8123.42,-16827.73"/>
<text text-anchor="middle" x="7954.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7954.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7954.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp0 -->
<g id="edge193" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M8088.21,-16865.25C8065.24,-16854.43 8040.16,-16842.62 8017.98,-16832.17"/>
<polygon fill="black" stroke="black" points="8019.2,-16828.88 8008.66,-16827.78 8016.22,-16835.21 8019.2,-16828.88"/>
</g>
<!-- O_s0_l2_tp1 -->
<g id="node120" class="node">
<title>O_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="6555.42,-16827.73 6217.42,-16827.73 6217.42,-16774.73 6555.42,-16774.73 6555.42,-16827.73"/>
<text text-anchor="middle" x="6386.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6386.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6386.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp1 -->
<g id="edge194" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7919.2,-16886.79C7557.61,-16866.84 6886.57,-16829.82 6565.98,-16812.14"/>
<polygon fill="black" stroke="black" points="6565.84,-16808.63 6555.67,-16811.57 6565.46,-16815.62 6565.84,-16808.63"/>
</g>
<!-- O_s0_l2_tp2 -->
<g id="node121" class="node">
<title>O_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="7352.42,-16827.73 7014.42,-16827.73 7014.42,-16774.73 7352.42,-16774.73 7352.42,-16827.73"/>
<text text-anchor="middle" x="7183.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7183.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7183.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp2 -->
<g id="edge195" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7950.3,-16878.98C7774.88,-16861.42 7528.52,-16836.77 7362.79,-16820.18"/>
<polygon fill="black" stroke="black" points="7362.79,-16816.67 7352.49,-16819.15 7362.09,-16823.63 7362.79,-16816.67"/>
</g>
<!-- O_s0_l2_tp3 -->
<g id="node122" class="node">
<title>O_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8709.42,-16827.73 8371.42,-16827.73 8371.42,-16774.73 8709.42,-16774.73 8709.42,-16827.73"/>
<text text-anchor="middle" x="8540.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8540.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8540.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp3 -->
<g id="edge196" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8286.19,-16868.13C8333.23,-16855.94 8386.42,-16842.15 8431.94,-16830.35"/>
<polygon fill="black" stroke="black" points="8433.03,-16833.69 8441.83,-16827.79 8431.27,-16826.91 8433.03,-16833.69"/>
</g>
<!-- O_s0_l2_tp4 -->
<g id="node123" class="node">
<title>O_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="9497.42,-16827.73 9159.42,-16827.73 9159.42,-16774.73 9497.42,-16774.73 9497.42,-16827.73"/>
<text text-anchor="middle" x="9328.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9328.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9328.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp4 -->
<g id="edge197" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8386.2,-16881.41C8608.27,-16862.75 8944.27,-16834.51 9149.28,-16817.29"/>
<polygon fill="black" stroke="black" points="9149.57,-16820.77 9159.25,-16816.45 9148.99,-16813.8 9149.57,-16820.77"/>
</g>
<!-- O_s0_l2_tp5 -->
<g id="node124" class="node">
<title>O_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="6080.42,-16827.73 5742.42,-16827.73 5742.42,-16774.73 6080.42,-16774.73 6080.42,-16827.73"/>
<text text-anchor="middle" x="5911.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5911.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5911.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp5 -->
<g id="edge198" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M7903.44,-16894.61C7529.1,-16885.6 6815.14,-16865.01 6208.42,-16827.73 6170.37,-16825.39 6129.62,-16822.29 6090.89,-16819.06"/>
<polygon fill="black" stroke="black" points="6090.81,-16815.54 6080.55,-16818.19 6090.22,-16822.51 6090.81,-16815.54"/>
</g>
<!-- O_s0_l2_tp6 -->
<g id="node125" class="node">
<title>O_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="10663.42,-16827.73 10325.42,-16827.73 10325.42,-16774.73 10663.42,-16774.73 10663.42,-16827.73"/>
<text text-anchor="middle" x="10494.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10494.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10494.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp6 -->
<g id="edge199" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M8419.37,-16893.16C8793.07,-16882.34 9508.33,-16859.51 10116.42,-16827.73 10181.27,-16824.34 10252.31,-16819.78 10315.13,-16815.44"/>
<polygon fill="black" stroke="black" points="10315.4,-16818.93 10325.14,-16814.75 10314.92,-16811.95 10315.4,-16818.93"/>
</g>
<!-- O_s0_l2_tp7 -->
<g id="node126" class="node">
<title>O_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="10107.42,-16827.73 9769.42,-16827.73 9769.42,-16774.73 10107.42,-16774.73 10107.42,-16827.73"/>
<text text-anchor="middle" x="9938.42" y="-16812.53" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9938.42" y="-16797.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9938.42" y="-16782.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l2&#45;&gt;O_s0_l2_tp7 -->
<g id="edge200" class="edge">
<title>AR_attn_s0_l2&#45;&gt;O_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M8407.08,-16887.39C8676.46,-16873.19 9122.35,-16849.42 9506.42,-16827.73 9589.34,-16823.05 9681.19,-16817.66 9758.81,-16813.04"/>
<polygon fill="black" stroke="black" points="9759.4,-16816.51 9769.17,-16812.42 9758.98,-16809.52 9759.4,-16816.51"/>
</g>
<!-- O_s0_l2_tp0&#45;&gt;ResAttn_s0_l2_tp0 -->
<g id="edge201" class="edge">
<title>O_s0_l2_tp0&#45;&gt;ResAttn_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7785.26,-16778.68C7679.87,-16765.26 7540.38,-16747.49 7412.14,-16731.15"/>
<polygon fill="black" stroke="black" points="7412.5,-16727.67 7402.14,-16729.88 7411.62,-16734.62 7412.5,-16727.67"/>
</g>
<!-- O_s0_l2_tp1&#45;&gt;ResAttn_s0_l2_tp1 -->
<g id="edge203" class="edge">
<title>O_s0_l2_tp1&#45;&gt;ResAttn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M6217.36,-16781.87C6072.58,-16766.15 5859.64,-16743.02 5679.97,-16723.5"/>
<polygon fill="black" stroke="black" points="5680.14,-16720 5669.82,-16722.4 5679.38,-16726.96 5680.14,-16720"/>
</g>
<!-- O_s0_l2_tp2&#45;&gt;ResAttn_s0_l2_tp2 -->
<g id="edge205" class="edge">
<title>O_s0_l2_tp2&#45;&gt;ResAttn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7014.24,-16780.91C6882.06,-16765.82 6694.04,-16744.35 6530.89,-16725.72"/>
<polygon fill="black" stroke="black" points="6531.01,-16722.21 6520.68,-16724.56 6530.22,-16729.17 6531.01,-16722.21"/>
</g>
<!-- O_s0_l2_tp3&#45;&gt;ResAttn_s0_l2_tp3 -->
<g id="edge207" class="edge">
<title>O_s0_l2_tp3&#45;&gt;ResAttn_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8689.18,-16774.69C8770.81,-16760.67 8873.92,-16742.97 8966.2,-16727.12"/>
<polygon fill="black" stroke="black" points="8966.97,-16730.54 8976.24,-16725.4 8965.79,-16723.64 8966.97,-16730.54"/>
</g>
<!-- O_s0_l2_tp4&#45;&gt;ResAttn_s0_l2_tp4 -->
<g id="edge209" class="edge">
<title>O_s0_l2_tp4&#45;&gt;ResAttn_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M9497.6,-16776.44C9612.01,-16760.35 9764.89,-16738.85 9892.29,-16720.93"/>
<polygon fill="black" stroke="black" points="9892.78,-16724.39 9902.2,-16719.53 9891.81,-16717.46 9892.78,-16724.39"/>
</g>
<!-- O_s0_l2_tp5&#45;&gt;ResAttn_s0_l2_tp5 -->
<g id="edge211" class="edge">
<title>O_s0_l2_tp5&#45;&gt;ResAttn_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M5742.32,-16789.05C5556.14,-16776.74 5247.93,-16756.35 4982.42,-16738.73 4829.79,-16728.61 4660.39,-16717.34 4518.4,-16707.9"/>
<polygon fill="black" stroke="black" points="4518.43,-16704.39 4508.22,-16707.22 4517.97,-16711.38 4518.43,-16704.39"/>
</g>
<!-- O_s0_l2_tp6&#45;&gt;ResAttn_s0_l2_tp6 -->
<g id="edge213" class="edge">
<title>O_s0_l2_tp6&#45;&gt;ResAttn_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M10663.72,-16789.96C10861.55,-16777.91 11198.76,-16757.23 11488.42,-16738.73 11663.58,-16727.55 11860.56,-16714.58 12014.01,-16704.4"/>
<polygon fill="black" stroke="black" points="12014.31,-16707.89 12024.06,-16703.73 12013.85,-16700.9 12014.31,-16707.89"/>
</g>
<!-- O_s0_l2_tp7&#45;&gt;ResAttn_s0_l2_tp7 -->
<g id="edge215" class="edge">
<title>O_s0_l2_tp7&#45;&gt;ResAttn_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M10107.48,-16784.12C10307.29,-16765.08 10641.83,-16733.2 10873.45,-16711.13"/>
<polygon fill="black" stroke="black" points="10874.09,-16714.58 10883.71,-16710.15 10873.42,-16707.61 10874.09,-16714.58"/>
</g>
<!-- Gate_s0_l2_tp0 -->
<g id="node135" class="node">
<title>Gate_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7524.42,-16596.73 7186.42,-16596.73 7186.42,-16543.73 7524.42,-16543.73 7524.42,-16596.73"/>
<text text-anchor="middle" x="7355.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7355.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7355.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp0&#45;&gt;Gate_s0_l2_tp0 -->
<g id="edge217" class="edge">
<title>ResAttn_s0_l2_tp0&#45;&gt;Gate_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M7197.46,-16632.63C7225.91,-16621.58 7254.97,-16610.28 7280.28,-16600.44"/>
<polygon fill="black" stroke="black" points="7281.73,-16603.63 7289.78,-16596.75 7279.2,-16597.11 7281.73,-16603.63"/>
</g>
<!-- ResMOE_s0_l2_tp0 -->
<g id="node176" class="node">
<title>ResMOE_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="8298.77,-16307.78 7741.45,-16307.78 7598.08,-16201.78 8155.4,-16201.78 8298.77,-16307.78"/>
<text text-anchor="middle" x="7948.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7948.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7948.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp0&#45;&gt;ResMOE_s0_l2_tp0 -->
<g id="edge290" class="edge">
<title>ResAttn_s0_l2_tp0&#45;&gt;ResMOE_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M6732.01,-16646.91C6671.03,-16641.19 6607.86,-16636.09 6548.42,-16632.73 5892.31,-16595.69 4246.71,-16646.3 3591.42,-16596.73 3306.38,-16575.17 3142.05,-16723.4 2954.42,-16507.73 2938.96,-16489.96 2938.06,-16471.67 2954.42,-16454.73 3118.76,-16284.62 6973.22,-16320.16 7209.42,-16307.78 7368.25,-16299.45 7546.06,-16287.04 7687.46,-16276.43"/>
<polygon fill="black" stroke="black" points="7687.87,-16279.9 7697.58,-16275.66 7687.35,-16272.92 7687.87,-16279.9"/>
</g>
<!-- Gate_s0_l2_tp1 -->
<g id="node136" class="node">
<title>Gate_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="5242.42,-16596.73 4904.42,-16596.73 4904.42,-16543.73 5242.42,-16543.73 5242.42,-16596.73"/>
<text text-anchor="middle" x="5073.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5073.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5073.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp1&#45;&gt;Gate_s0_l2_tp1 -->
<g id="edge218" class="edge">
<title>ResAttn_s0_l2_tp1&#45;&gt;Gate_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M5218.4,-16632.63C5192.52,-16621.67 5166.09,-16610.48 5143.01,-16600.7"/>
<polygon fill="black" stroke="black" points="5144.24,-16597.42 5133.67,-16596.75 5141.51,-16603.87 5144.24,-16597.42"/>
</g>
<!-- ResMOE_s0_l2_tp1 -->
<g id="node177" class="node">
<title>ResMOE_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="5724.77,-16307.78 5167.45,-16307.78 5024.08,-16201.78 5581.4,-16201.78 5724.77,-16307.78"/>
<text text-anchor="middle" x="5374.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5374.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5374.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp1&#45;&gt;ResMOE_s0_l2_tp1 -->
<g id="edge292" class="edge">
<title>ResAttn_s0_l2_tp1&#45;&gt;ResMOE_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M5028.62,-16660.71C4885.65,-16650.55 4714.05,-16639.53 4559.42,-16632.73 4512.9,-16630.69 2915.99,-16630.01 2883.42,-16596.73 2844.1,-16556.56 2844.38,-16384.22 2883.42,-16343.78 2902.44,-16324.08 4450.01,-16280.48 5096.01,-16263.12"/>
<polygon fill="black" stroke="black" points="5096.49,-16266.61 5106.4,-16262.84 5096.31,-16259.61 5096.49,-16266.61"/>
</g>
<!-- Gate_s0_l2_tp2 -->
<g id="node137" class="node">
<title>Gate_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6358.42,-16596.73 6020.42,-16596.73 6020.42,-16543.73 6358.42,-16543.73 6358.42,-16596.73"/>
<text text-anchor="middle" x="6189.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6189.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6189.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp2&#45;&gt;Gate_s0_l2_tp2 -->
<g id="edge219" class="edge">
<title>ResAttn_s0_l2_tp2&#45;&gt;Gate_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M6189.42,-16632.63C6189.42,-16623.96 6189.42,-16615.15 6189.42,-16607"/>
<polygon fill="black" stroke="black" points="6192.92,-16606.75 6189.42,-16596.75 6185.92,-16606.75 6192.92,-16606.75"/>
</g>
<!-- ResMOE_s0_l2_tp2 -->
<g id="node178" class="node">
<title>ResMOE_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="7200.77,-16307.78 6643.45,-16307.78 6500.08,-16201.78 7057.4,-16201.78 7200.77,-16307.78"/>
<text text-anchor="middle" x="6850.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6850.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6850.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp2&#45;&gt;ResMOE_s0_l2_tp2 -->
<g id="edge294" class="edge">
<title>ResAttn_s0_l2_tp2&#45;&gt;ResMOE_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M5855.7,-16645.06C5803.78,-16640.1 5750.7,-16635.73 5700.42,-16632.73 5661.89,-16630.44 2948.54,-16624.2 2921.42,-16596.73 2881.93,-16556.73 2881.93,-16383.78 2921.42,-16343.78 2948.86,-16315.98 5694.38,-16308.94 5733.42,-16307.78 6023.82,-16299.16 6356.4,-16282.85 6582.62,-16270.79"/>
<polygon fill="black" stroke="black" points="6582.84,-16274.28 6592.64,-16270.25 6582.47,-16267.29 6582.84,-16274.28"/>
</g>
<!-- Gate_s0_l2_tp3 -->
<g id="node138" class="node">
<title>Gate_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9154.42,-16596.73 8816.42,-16596.73 8816.42,-16543.73 9154.42,-16543.73 9154.42,-16596.73"/>
<text text-anchor="middle" x="8985.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8985.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8985.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp3&#45;&gt;Gate_s0_l2_tp3 -->
<g id="edge220" class="edge">
<title>ResAttn_s0_l2_tp3&#45;&gt;Gate_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M9102.27,-16632.63C9082.06,-16622.01 9061.44,-16611.18 9043.25,-16601.62"/>
<polygon fill="black" stroke="black" points="9044.46,-16598.3 9033.98,-16596.75 9041.2,-16604.5 9044.46,-16598.3"/>
</g>
<!-- ResMOE_s0_l2_tp3 -->
<g id="node179" class="node">
<title>ResMOE_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9147.77,-16307.78 8590.45,-16307.78 8447.08,-16201.78 9004.4,-16201.78 9147.77,-16307.78"/>
<text text-anchor="middle" x="8797.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8797.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8797.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp3&#45;&gt;ResMOE_s0_l2_tp3 -->
<g id="edge296" class="edge">
<title>ResAttn_s0_l2_tp3&#45;&gt;ResMOE_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M9443.48,-16658.61C9546.04,-16648.65 9666.94,-16638.34 9776.42,-16632.73 10436.27,-16598.95 12090.59,-16646.55 12749.42,-16596.73 13038.66,-16574.86 13587.04,-16664.23 13386.42,-16454.73 13349.26,-16415.93 10119.82,-16301.37 9101.44,-16266.18"/>
<polygon fill="black" stroke="black" points="9101.53,-16262.68 9091.41,-16265.83 9101.29,-16269.68 9101.53,-16262.68"/>
</g>
<!-- Gate_s0_l2_tp4 -->
<g id="node139" class="node">
<title>Gate_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="10304.42,-16596.73 9966.42,-16596.73 9966.42,-16543.73 10304.42,-16543.73 10304.42,-16596.73"/>
<text text-anchor="middle" x="10135.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10135.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10135.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp4&#45;&gt;Gate_s0_l2_tp4 -->
<g id="edge221" class="edge">
<title>ResAttn_s0_l2_tp4&#45;&gt;Gate_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M10135.42,-16632.63C10135.42,-16623.96 10135.42,-16615.15 10135.42,-16607"/>
<polygon fill="black" stroke="black" points="10138.92,-16606.75 10135.42,-16596.75 10131.92,-16606.75 10138.92,-16606.75"/>
</g>
<!-- ResMOE_s0_l2_tp4 -->
<g id="node180" class="node">
<title>ResMOE_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="11184.77,-16307.78 10627.45,-16307.78 10484.08,-16201.78 11041.4,-16201.78 11184.77,-16307.78"/>
<text text-anchor="middle" x="10834.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10834.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10834.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp4&#45;&gt;ResMOE_s0_l2_tp4 -->
<g id="edge298" class="edge">
<title>ResAttn_s0_l2_tp4&#45;&gt;ResMOE_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M10380.56,-16660.85C10498.33,-16650.35 10641.57,-16639 10770.42,-16632.73 11029.15,-16620.16 12845.09,-16634.05 13101.42,-16596.73 13246.23,-16575.65 13330.03,-16624.36 13418.42,-16507.73 13600.3,-16267.77 12373.64,-16366.82 12073.42,-16343.78 11760.75,-16319.78 11403.5,-16294.65 11153.21,-16277.42"/>
<polygon fill="black" stroke="black" points="11153.08,-16273.9 11142.86,-16276.71 11152.6,-16280.88 11153.08,-16273.9"/>
</g>
<!-- Gate_s0_l2_tp5 -->
<g id="node140" class="node">
<title>Gate_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="3938.42,-16596.73 3600.42,-16596.73 3600.42,-16543.73 3938.42,-16543.73 3938.42,-16596.73"/>
<text text-anchor="middle" x="3769.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3769.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3769.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp5&#45;&gt;Gate_s0_l2_tp5 -->
<g id="edge222" class="edge">
<title>ResAttn_s0_l2_tp5&#45;&gt;Gate_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M4002.9,-16632.72C3959.39,-16621.26 3914.9,-16609.54 3876.58,-16599.45"/>
<polygon fill="black" stroke="black" points="3877.02,-16595.95 3866.46,-16596.79 3875.24,-16602.72 3877.02,-16595.95"/>
</g>
<!-- ResMOE_s0_l2_tp5 -->
<g id="node181" class="node">
<title>ResMOE_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="3491.77,-16307.78 2934.45,-16307.78 2791.08,-16201.78 3348.4,-16201.78 3491.77,-16307.78"/>
<text text-anchor="middle" x="3141.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3141.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3141.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp5&#45;&gt;ResMOE_s0_l2_tp5 -->
<g id="edge300" class="edge">
<title>ResAttn_s0_l2_tp5&#45;&gt;ResMOE_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M3907.41,-16675.18C3523.47,-16661.27 2894.25,-16633.09 2857.42,-16596.73 2777.4,-16517.75 2785.32,-16433.25 2853.42,-16343.78 2863.9,-16330.02 2888.19,-16317.49 2918.46,-16306.48"/>
<polygon fill="black" stroke="black" points="2919.77,-16309.74 2928.04,-16303.12 2917.45,-16303.13 2919.77,-16309.74"/>
</g>
<!-- Gate_s0_l2_tp6 -->
<g id="node141" class="node">
<title>Gate_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="12740.42,-16596.73 12402.42,-16596.73 12402.42,-16543.73 12740.42,-16543.73 12740.42,-16596.73"/>
<text text-anchor="middle" x="12571.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12571.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12571.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp6&#45;&gt;Gate_s0_l2_tp6 -->
<g id="edge223" class="edge">
<title>ResAttn_s0_l2_tp6&#45;&gt;Gate_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M12412.92,-16632.63C12441.46,-16621.58 12470.62,-16610.28 12496.02,-16600.44"/>
<polygon fill="black" stroke="black" points="12497.5,-16603.62 12505.56,-16596.75 12494.97,-16597.09 12497.5,-16603.62"/>
</g>
<!-- ResMOE_s0_l2_tp6 -->
<g id="node182" class="node">
<title>ResMOE_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="13610.77,-16307.78 13053.45,-16307.78 12910.08,-16201.78 13467.4,-16201.78 13610.77,-16307.78"/>
<text text-anchor="middle" x="13260.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="13260.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13260.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp6&#45;&gt;ResMOE_s0_l2_tp6 -->
<g id="edge302" class="edge">
<title>ResAttn_s0_l2_tp6&#45;&gt;ResMOE_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M12555.17,-16684.18C12894.54,-16680.56 13432.75,-16664.1 13495.42,-16596.73 13572,-16514.42 13559.48,-16436.17 13495.42,-16343.78 13487.53,-16332.4 13477.98,-16322.49 13467.3,-16313.86"/>
<polygon fill="black" stroke="black" points="13469.41,-16311.07 13459.33,-16307.8 13465.17,-16316.64 13469.41,-16311.07"/>
</g>
<!-- Gate_s0_l2_tp7 -->
<g id="node142" class="node">
<title>Gate_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="11436.42,-16596.73 11098.42,-16596.73 11098.42,-16543.73 11436.42,-16543.73 11436.42,-16596.73"/>
<text text-anchor="middle" x="11267.42" y="-16581.53" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11267.42" y="-16566.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11267.42" y="-16551.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp7&#45;&gt;Gate_s0_l2_tp7 -->
<g id="edge224" class="edge">
<title>ResAttn_s0_l2_tp7&#45;&gt;Gate_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M11192.77,-16632.63C11204.97,-16622.6 11217.41,-16612.37 11228.54,-16603.21"/>
<polygon fill="black" stroke="black" points="11230.9,-16605.8 11236.4,-16596.75 11226.45,-16600.4 11230.9,-16605.8"/>
</g>
<!-- ResMOE_s0_l2_tp7 -->
<g id="node183" class="node">
<title>ResMOE_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="12562.77,-16307.78 12005.45,-16307.78 11862.08,-16201.78 12419.4,-16201.78 12562.77,-16307.78"/>
<text text-anchor="middle" x="12212.42" y="-16266.08" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12212.42" y="-16251.08" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12212.42" y="-16236.08" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l2_tp7&#45;&gt;ResMOE_s0_l2_tp7 -->
<g id="edge304" class="edge">
<title>ResAttn_s0_l2_tp7&#45;&gt;ResMOE_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M11381,-16665.68C11536.13,-16654.54 11739.21,-16641.09 11919.42,-16632.73 12067.76,-16625.85 13111.06,-16631.54 13255.42,-16596.73 13344.51,-16575.25 13392.57,-16585.27 13441.42,-16507.73 13453.98,-16487.8 13456.69,-16472.67 13441.42,-16454.73 13383.53,-16386.71 12887.95,-16323.58 12544.07,-16287.39"/>
<polygon fill="black" stroke="black" points="12544.26,-16283.89 12533.95,-16286.32 12543.53,-16290.85 12544.26,-16283.89"/>
</g>
<!-- Expert0_s0_l2_tp0 -->
<g id="node143" class="node">
<title>Expert0_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7835.42,-16507.73 7527.42,-16507.73 7527.42,-16454.73 7835.42,-16454.73 7835.42,-16507.73"/>
<text text-anchor="middle" x="7681.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="7681.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7681.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp0&#45;&gt;Expert0_s0_l2_tp0 -->
<g id="edge225" class="edge">
<title>Gate_s0_l2_tp0&#45;&gt;Expert0_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7451.03,-16543.72C7490.26,-16533.25 7535.8,-16521.09 7575.99,-16510.37"/>
<polygon fill="black" stroke="black" points="7577.06,-16513.71 7585.82,-16507.75 7575.25,-16506.94 7577.06,-16513.71"/>
</g>
<!-- Expert1_s0_l2_tp0 -->
<g id="node144" class="node">
<title>Expert1_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="8161.42,-16507.73 7853.42,-16507.73 7853.42,-16454.73 8161.42,-16454.73 8161.42,-16507.73"/>
<text text-anchor="middle" x="8007.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="8007.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8007.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp0&#45;&gt;Expert1_s0_l2_tp0 -->
<g id="edge226" class="edge">
<title>Gate_s0_l2_tp0&#45;&gt;Expert1_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.47,-16549.24C7615.97,-16538.11 7731.22,-16523.6 7842.9,-16507.93"/>
<polygon fill="black" stroke="black" points="7843.59,-16511.37 7853.01,-16506.51 7842.62,-16504.44 7843.59,-16511.37"/>
</g>
<!-- Expert2_s0_l2_tp0 -->
<g id="node145" class="node">
<title>Expert2_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7183.42,-16507.73 6875.42,-16507.73 6875.42,-16454.73 7183.42,-16454.73 7183.42,-16507.73"/>
<text text-anchor="middle" x="7029.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="7029.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7029.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp0&#45;&gt;Expert2_s0_l2_tp0 -->
<g id="edge227" class="edge">
<title>Gate_s0_l2_tp0&#45;&gt;Expert2_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7259.81,-16543.72C7220.59,-16533.25 7175.04,-16521.09 7134.85,-16510.37"/>
<polygon fill="black" stroke="black" points="7135.59,-16506.94 7125.03,-16507.75 7133.79,-16513.71 7135.59,-16506.94"/>
</g>
<!-- Expert3_s0_l2_tp0 -->
<g id="node146" class="node">
<title>Expert3_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7509.42,-16507.73 7201.42,-16507.73 7201.42,-16454.73 7509.42,-16454.73 7509.42,-16507.73"/>
<text text-anchor="middle" x="7355.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="7355.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7355.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp0&#45;&gt;Expert3_s0_l2_tp0 -->
<g id="edge228" class="edge">
<title>Gate_s0_l2_tp0&#45;&gt;Expert3_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7355.42,-16543.6C7355.42,-16535.62 7355.42,-16526.66 7355.42,-16518.12"/>
<polygon fill="black" stroke="black" points="7358.92,-16517.98 7355.42,-16507.98 7351.92,-16517.98 7358.92,-16517.98"/>
</g>
<!-- Expert4_s0_l2_tp1 -->
<g id="node147" class="node">
<title>Expert4_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="5227.42,-16507.73 4919.42,-16507.73 4919.42,-16454.73 5227.42,-16454.73 5227.42,-16507.73"/>
<text text-anchor="middle" x="5073.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="5073.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5073.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp1&#45;&gt;Expert4_s0_l2_tp1 -->
<g id="edge229" class="edge">
<title>Gate_s0_l2_tp1&#45;&gt;Expert4_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5073.42,-16543.6C5073.42,-16535.62 5073.42,-16526.66 5073.42,-16518.12"/>
<polygon fill="black" stroke="black" points="5076.92,-16517.98 5073.42,-16507.98 5069.92,-16517.98 5076.92,-16517.98"/>
</g>
<!-- Expert5_s0_l2_tp1 -->
<g id="node148" class="node">
<title>Expert5_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="5553.42,-16507.73 5245.42,-16507.73 5245.42,-16454.73 5553.42,-16454.73 5553.42,-16507.73"/>
<text text-anchor="middle" x="5399.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="5399.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5399.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp1&#45;&gt;Expert5_s0_l2_tp1 -->
<g id="edge230" class="edge">
<title>Gate_s0_l2_tp1&#45;&gt;Expert5_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5169.03,-16543.72C5208.26,-16533.25 5253.8,-16521.09 5293.99,-16510.37"/>
<polygon fill="black" stroke="black" points="5295.06,-16513.71 5303.82,-16507.75 5293.25,-16506.94 5295.06,-16513.71"/>
</g>
<!-- Expert6_s0_l2_tp1 -->
<g id="node149" class="node">
<title>Expert6_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="4575.42,-16507.73 4267.42,-16507.73 4267.42,-16454.73 4575.42,-16454.73 4575.42,-16507.73"/>
<text text-anchor="middle" x="4421.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="4421.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4421.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp1&#45;&gt;Expert6_s0_l2_tp1 -->
<g id="edge231" class="edge">
<title>Gate_s0_l2_tp1&#45;&gt;Expert6_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4904.37,-16549.24C4812.87,-16538.11 4697.63,-16523.6 4585.94,-16507.93"/>
<polygon fill="black" stroke="black" points="4586.23,-16504.44 4575.84,-16506.51 4585.25,-16511.37 4586.23,-16504.44"/>
</g>
<!-- Expert7_s0_l2_tp1 -->
<g id="node150" class="node">
<title>Expert7_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="4901.42,-16507.73 4593.42,-16507.73 4593.42,-16454.73 4901.42,-16454.73 4901.42,-16507.73"/>
<text text-anchor="middle" x="4747.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="4747.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4747.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp1&#45;&gt;Expert7_s0_l2_tp1 -->
<g id="edge232" class="edge">
<title>Gate_s0_l2_tp1&#45;&gt;Expert7_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4977.81,-16543.72C4938.59,-16533.25 4893.04,-16521.09 4852.85,-16510.37"/>
<polygon fill="black" stroke="black" points="4853.59,-16506.94 4843.03,-16507.75 4851.79,-16513.71 4853.59,-16506.94"/>
</g>
<!-- Expert8_s0_l2_tp2 -->
<g id="node151" class="node">
<title>Expert8_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6857.42,-16507.73 6549.42,-16507.73 6549.42,-16454.73 6857.42,-16454.73 6857.42,-16507.73"/>
<text text-anchor="middle" x="6703.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="6703.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6703.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp2&#45;&gt;Expert8_s0_l2_tp2 -->
<g id="edge233" class="edge">
<title>Gate_s0_l2_tp2&#45;&gt;Expert8_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6340.17,-16543.72C6403.84,-16532.94 6478.08,-16520.37 6542.79,-16509.42"/>
<polygon fill="black" stroke="black" points="6543.41,-16512.87 6552.68,-16507.75 6542.24,-16505.97 6543.41,-16512.87"/>
</g>
<!-- Expert9_s0_l2_tp2 -->
<g id="node152" class="node">
<title>Expert9_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="5879.42,-16507.73 5571.42,-16507.73 5571.42,-16454.73 5879.42,-16454.73 5879.42,-16507.73"/>
<text text-anchor="middle" x="5725.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="5725.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5725.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp2&#45;&gt;Expert9_s0_l2_tp2 -->
<g id="edge234" class="edge">
<title>Gate_s0_l2_tp2&#45;&gt;Expert9_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6053.34,-16543.72C5996.21,-16533.01 5929.67,-16520.53 5871.51,-16509.62"/>
<polygon fill="black" stroke="black" points="5871.97,-16506.15 5861.5,-16507.75 5870.68,-16513.03 5871.97,-16506.15"/>
</g>
<!-- Expert10_s0_l2_tp2 -->
<g id="node153" class="node">
<title>Expert10_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6205.42,-16507.73 5897.42,-16507.73 5897.42,-16454.73 6205.42,-16454.73 6205.42,-16507.73"/>
<text text-anchor="middle" x="6051.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="6051.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6051.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp2&#45;&gt;Expert10_s0_l2_tp2 -->
<g id="edge235" class="edge">
<title>Gate_s0_l2_tp2&#45;&gt;Expert10_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6148.76,-16543.6C6133.74,-16534.13 6116.54,-16523.29 6100.82,-16513.38"/>
<polygon fill="black" stroke="black" points="6102.59,-16510.35 6092.27,-16507.98 6098.86,-16516.28 6102.59,-16510.35"/>
</g>
<!-- Expert11_s0_l2_tp2 -->
<g id="node154" class="node">
<title>Expert11_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6531.42,-16507.73 6223.42,-16507.73 6223.42,-16454.73 6531.42,-16454.73 6531.42,-16507.73"/>
<text text-anchor="middle" x="6377.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="6377.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6377.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp2&#45;&gt;Expert11_s0_l2_tp2 -->
<g id="edge236" class="edge">
<title>Gate_s0_l2_tp2&#45;&gt;Expert11_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6244.56,-16543.72C6265.98,-16533.8 6290.68,-16522.37 6312.92,-16512.08"/>
<polygon fill="black" stroke="black" points="6314.68,-16515.12 6322.29,-16507.75 6311.74,-16508.77 6314.68,-16515.12"/>
</g>
<!-- Expert12_s0_l2_tp3 -->
<g id="node155" class="node">
<title>Expert12_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8487.42,-16507.73 8179.42,-16507.73 8179.42,-16454.73 8487.42,-16454.73 8487.42,-16507.73"/>
<text text-anchor="middle" x="8333.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="8333.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8333.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp3&#45;&gt;Expert12_s0_l2_tp3 -->
<g id="edge237" class="edge">
<title>Gate_s0_l2_tp3&#45;&gt;Expert12_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8816.37,-16549.24C8724.87,-16538.11 8609.63,-16523.6 8497.94,-16507.93"/>
<polygon fill="black" stroke="black" points="8498.23,-16504.44 8487.84,-16506.51 8497.25,-16511.37 8498.23,-16504.44"/>
</g>
<!-- Expert13_s0_l2_tp3 -->
<g id="node156" class="node">
<title>Expert13_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8813.42,-16507.73 8505.42,-16507.73 8505.42,-16454.73 8813.42,-16454.73 8813.42,-16507.73"/>
<text text-anchor="middle" x="8659.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="8659.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8659.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp3&#45;&gt;Expert13_s0_l2_tp3 -->
<g id="edge238" class="edge">
<title>Gate_s0_l2_tp3&#45;&gt;Expert13_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8889.81,-16543.72C8850.59,-16533.25 8805.04,-16521.09 8764.85,-16510.37"/>
<polygon fill="black" stroke="black" points="8765.59,-16506.94 8755.03,-16507.75 8763.79,-16513.71 8765.59,-16506.94"/>
</g>
<!-- Expert14_s0_l2_tp3 -->
<g id="node157" class="node">
<title>Expert14_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9139.42,-16507.73 8831.42,-16507.73 8831.42,-16454.73 9139.42,-16454.73 9139.42,-16507.73"/>
<text text-anchor="middle" x="8985.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="8985.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8985.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp3&#45;&gt;Expert14_s0_l2_tp3 -->
<g id="edge239" class="edge">
<title>Gate_s0_l2_tp3&#45;&gt;Expert14_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8985.42,-16543.6C8985.42,-16535.62 8985.42,-16526.66 8985.42,-16518.12"/>
<polygon fill="black" stroke="black" points="8988.92,-16517.98 8985.42,-16507.98 8981.92,-16517.98 8988.92,-16517.98"/>
</g>
<!-- Expert15_s0_l2_tp3 -->
<g id="node158" class="node">
<title>Expert15_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9465.42,-16507.73 9157.42,-16507.73 9157.42,-16454.73 9465.42,-16454.73 9465.42,-16507.73"/>
<text text-anchor="middle" x="9311.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="9311.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9311.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp3&#45;&gt;Expert15_s0_l2_tp3 -->
<g id="edge240" class="edge">
<title>Gate_s0_l2_tp3&#45;&gt;Expert15_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9081.03,-16543.72C9120.26,-16533.25 9165.8,-16521.09 9205.99,-16510.37"/>
<polygon fill="black" stroke="black" points="9207.06,-16513.71 9215.82,-16507.75 9205.25,-16506.94 9207.06,-16513.71"/>
</g>
<!-- Expert16_s0_l2_tp4 -->
<g id="node159" class="node">
<title>Expert16_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="9791.42,-16507.73 9483.42,-16507.73 9483.42,-16454.73 9791.42,-16454.73 9791.42,-16507.73"/>
<text text-anchor="middle" x="9637.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="9637.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9637.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp4&#45;&gt;Expert16_s0_l2_tp4 -->
<g id="edge241" class="edge">
<title>Gate_s0_l2_tp4&#45;&gt;Expert16_s0_l2_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9989.37,-16543.72C9927.8,-16532.96 9856.04,-16520.43 9793.44,-16509.49"/>
<polygon fill="black" stroke="black" points="9793.92,-16506.02 9783.47,-16507.75 9792.72,-16512.92 9793.92,-16506.02"/>
</g>
<!-- Expert17_s0_l2_tp4 -->
<g id="node160" class="node">
<title>Expert17_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="10117.42,-16507.73 9809.42,-16507.73 9809.42,-16454.73 10117.42,-16454.73 10117.42,-16507.73"/>
<text text-anchor="middle" x="9963.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="9963.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9963.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp4&#45;&gt;Expert17_s0_l2_tp4 -->
<g id="edge242" class="edge">
<title>Gate_s0_l2_tp4&#45;&gt;Expert17_s0_l2_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10084.75,-16543.6C10065.41,-16533.82 10043.19,-16522.58 10023.1,-16512.42"/>
<polygon fill="black" stroke="black" points="10024.54,-16509.22 10014.03,-16507.83 10021.38,-16515.47 10024.54,-16509.22"/>
</g>
<!-- Expert18_s0_l2_tp4 -->
<g id="node161" class="node">
<title>Expert18_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="10443.42,-16507.73 10135.42,-16507.73 10135.42,-16454.73 10443.42,-16454.73 10443.42,-16507.73"/>
<text text-anchor="middle" x="10289.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="10289.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10289.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp4&#45;&gt;Expert18_s0_l2_tp4 -->
<g id="edge243" class="edge">
<title>Gate_s0_l2_tp4&#45;&gt;Expert18_s0_l2_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10180.79,-16543.6C10197.79,-16534 10217.28,-16522.99 10235.02,-16512.97"/>
<polygon fill="black" stroke="black" points="10237.12,-16515.8 10244.11,-16507.83 10233.68,-16509.7 10237.12,-16515.8"/>
</g>
<!-- Expert19_s0_l2_tp4 -->
<g id="node162" class="node">
<title>Expert19_s0_l2_tp4</title>
<polygon fill="none" stroke="black" points="10769.42,-16507.73 10461.42,-16507.73 10461.42,-16454.73 10769.42,-16454.73 10769.42,-16507.73"/>
<text text-anchor="middle" x="10615.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="10615.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10615.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp4&#45;&gt;Expert19_s0_l2_tp4 -->
<g id="edge244" class="edge">
<title>Gate_s0_l2_tp4&#45;&gt;Expert19_s0_l2_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10276.2,-16543.72C10335.42,-16532.98 10404.42,-16520.48 10464.67,-16509.56"/>
<polygon fill="black" stroke="black" points="10465.44,-16512.97 10474.65,-16507.75 10464.19,-16506.09 10465.44,-16512.97"/>
</g>
<!-- Expert20_s0_l2_tp5 -->
<g id="node163" class="node">
<title>Expert20_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="3271.42,-16507.73 2963.42,-16507.73 2963.42,-16454.73 3271.42,-16454.73 3271.42,-16507.73"/>
<text text-anchor="middle" x="3117.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="3117.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3117.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp5&#45;&gt;Expert20_s0_l2_tp5 -->
<g id="edge245" class="edge">
<title>Gate_s0_l2_tp5&#45;&gt;Expert20_s0_l2_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3600.37,-16549.24C3508.87,-16538.11 3393.63,-16523.6 3281.94,-16507.93"/>
<polygon fill="black" stroke="black" points="3282.23,-16504.44 3271.84,-16506.51 3281.25,-16511.37 3282.23,-16504.44"/>
</g>
<!-- Expert21_s0_l2_tp5 -->
<g id="node164" class="node">
<title>Expert21_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="3597.42,-16507.73 3289.42,-16507.73 3289.42,-16454.73 3597.42,-16454.73 3597.42,-16507.73"/>
<text text-anchor="middle" x="3443.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="3443.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3443.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp5&#45;&gt;Expert21_s0_l2_tp5 -->
<g id="edge246" class="edge">
<title>Gate_s0_l2_tp5&#45;&gt;Expert21_s0_l2_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3673.81,-16543.72C3634.59,-16533.25 3589.04,-16521.09 3548.85,-16510.37"/>
<polygon fill="black" stroke="black" points="3549.59,-16506.94 3539.03,-16507.75 3547.79,-16513.71 3549.59,-16506.94"/>
</g>
<!-- Expert22_s0_l2_tp5 -->
<g id="node165" class="node">
<title>Expert22_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="3923.42,-16507.73 3615.42,-16507.73 3615.42,-16454.73 3923.42,-16454.73 3923.42,-16507.73"/>
<text text-anchor="middle" x="3769.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="3769.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3769.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp5&#45;&gt;Expert22_s0_l2_tp5 -->
<g id="edge247" class="edge">
<title>Gate_s0_l2_tp5&#45;&gt;Expert22_s0_l2_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3769.42,-16543.6C3769.42,-16535.62 3769.42,-16526.66 3769.42,-16518.12"/>
<polygon fill="black" stroke="black" points="3772.92,-16517.98 3769.42,-16507.98 3765.92,-16517.98 3772.92,-16517.98"/>
</g>
<!-- Expert23_s0_l2_tp5 -->
<g id="node166" class="node">
<title>Expert23_s0_l2_tp5</title>
<polygon fill="none" stroke="black" points="4249.42,-16507.73 3941.42,-16507.73 3941.42,-16454.73 4249.42,-16454.73 4249.42,-16507.73"/>
<text text-anchor="middle" x="4095.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="4095.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4095.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp5&#45;&gt;Expert23_s0_l2_tp5 -->
<g id="edge248" class="edge">
<title>Gate_s0_l2_tp5&#45;&gt;Expert23_s0_l2_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3865.03,-16543.72C3904.26,-16533.25 3949.8,-16521.09 3989.99,-16510.37"/>
<polygon fill="black" stroke="black" points="3991.06,-16513.71 3999.82,-16507.75 3989.25,-16506.94 3991.06,-16513.71"/>
</g>
<!-- Expert24_s0_l2_tp6 -->
<g id="node167" class="node">
<title>Expert24_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="12399.42,-16507.73 12091.42,-16507.73 12091.42,-16454.73 12399.42,-16454.73 12399.42,-16507.73"/>
<text text-anchor="middle" x="12245.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="12245.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12245.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp6&#45;&gt;Expert24_s0_l2_tp6 -->
<g id="edge249" class="edge">
<title>Gate_s0_l2_tp6&#45;&gt;Expert24_s0_l2_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12475.81,-16543.72C12436.59,-16533.25 12391.04,-16521.09 12350.85,-16510.37"/>
<polygon fill="black" stroke="black" points="12351.59,-16506.94 12341.03,-16507.75 12349.79,-16513.71 12351.59,-16506.94"/>
</g>
<!-- Expert25_s0_l2_tp6 -->
<g id="node168" class="node">
<title>Expert25_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="12725.42,-16507.73 12417.42,-16507.73 12417.42,-16454.73 12725.42,-16454.73 12725.42,-16507.73"/>
<text text-anchor="middle" x="12571.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="12571.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12571.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp6&#45;&gt;Expert25_s0_l2_tp6 -->
<g id="edge250" class="edge">
<title>Gate_s0_l2_tp6&#45;&gt;Expert25_s0_l2_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12571.42,-16543.6C12571.42,-16535.62 12571.42,-16526.66 12571.42,-16518.12"/>
<polygon fill="black" stroke="black" points="12574.92,-16517.98 12571.42,-16507.98 12567.92,-16517.98 12574.92,-16517.98"/>
</g>
<!-- Expert26_s0_l2_tp6 -->
<g id="node169" class="node">
<title>Expert26_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="13051.42,-16507.73 12743.42,-16507.73 12743.42,-16454.73 13051.42,-16454.73 13051.42,-16507.73"/>
<text text-anchor="middle" x="12897.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="12897.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12897.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp6&#45;&gt;Expert26_s0_l2_tp6 -->
<g id="edge251" class="edge">
<title>Gate_s0_l2_tp6&#45;&gt;Expert26_s0_l2_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12667.03,-16543.72C12706.26,-16533.25 12751.8,-16521.09 12791.99,-16510.37"/>
<polygon fill="black" stroke="black" points="12793.06,-16513.71 12801.82,-16507.75 12791.25,-16506.94 12793.06,-16513.71"/>
</g>
<!-- Expert27_s0_l2_tp6 -->
<g id="node170" class="node">
<title>Expert27_s0_l2_tp6</title>
<polygon fill="none" stroke="black" points="13377.42,-16507.73 13069.42,-16507.73 13069.42,-16454.73 13377.42,-16454.73 13377.42,-16507.73"/>
<text text-anchor="middle" x="13223.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="13223.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13223.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp6&#45;&gt;Expert27_s0_l2_tp6 -->
<g id="edge252" class="edge">
<title>Gate_s0_l2_tp6&#45;&gt;Expert27_s0_l2_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12740.47,-16549.24C12831.97,-16538.11 12947.22,-16523.6 13058.9,-16507.93"/>
<polygon fill="black" stroke="black" points="13059.59,-16511.37 13069.01,-16506.51 13058.62,-16504.44 13059.59,-16511.37"/>
</g>
<!-- Expert28_s0_l2_tp7 -->
<g id="node171" class="node">
<title>Expert28_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="11095.42,-16507.73 10787.42,-16507.73 10787.42,-16454.73 11095.42,-16454.73 11095.42,-16507.73"/>
<text text-anchor="middle" x="10941.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="10941.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10941.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp7&#45;&gt;Expert28_s0_l2_tp7 -->
<g id="edge253" class="edge">
<title>Gate_s0_l2_tp7&#45;&gt;Expert28_s0_l2_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11171.81,-16543.72C11132.59,-16533.25 11087.04,-16521.09 11046.85,-16510.37"/>
<polygon fill="black" stroke="black" points="11047.59,-16506.94 11037.03,-16507.75 11045.79,-16513.71 11047.59,-16506.94"/>
</g>
<!-- Expert29_s0_l2_tp7 -->
<g id="node172" class="node">
<title>Expert29_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="11421.42,-16507.73 11113.42,-16507.73 11113.42,-16454.73 11421.42,-16454.73 11421.42,-16507.73"/>
<text text-anchor="middle" x="11267.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="11267.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11267.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp7&#45;&gt;Expert29_s0_l2_tp7 -->
<g id="edge254" class="edge">
<title>Gate_s0_l2_tp7&#45;&gt;Expert29_s0_l2_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11267.42,-16543.6C11267.42,-16535.62 11267.42,-16526.66 11267.42,-16518.12"/>
<polygon fill="black" stroke="black" points="11270.92,-16517.98 11267.42,-16507.98 11263.92,-16517.98 11270.92,-16517.98"/>
</g>
<!-- Expert30_s0_l2_tp7 -->
<g id="node173" class="node">
<title>Expert30_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="11747.42,-16507.73 11439.42,-16507.73 11439.42,-16454.73 11747.42,-16454.73 11747.42,-16507.73"/>
<text text-anchor="middle" x="11593.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="11593.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11593.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp7&#45;&gt;Expert30_s0_l2_tp7 -->
<g id="edge255" class="edge">
<title>Gate_s0_l2_tp7&#45;&gt;Expert30_s0_l2_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11363.03,-16543.72C11402.26,-16533.25 11447.8,-16521.09 11487.99,-16510.37"/>
<polygon fill="black" stroke="black" points="11489.06,-16513.71 11497.82,-16507.75 11487.25,-16506.94 11489.06,-16513.71"/>
</g>
<!-- Expert31_s0_l2_tp7 -->
<g id="node174" class="node">
<title>Expert31_s0_l2_tp7</title>
<polygon fill="none" stroke="black" points="12073.42,-16507.73 11765.42,-16507.73 11765.42,-16454.73 12073.42,-16454.73 12073.42,-16507.73"/>
<text text-anchor="middle" x="11919.42" y="-16492.53" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="11919.42" y="-16477.53" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11919.42" y="-16462.53" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l2_tp7&#45;&gt;Expert31_s0_l2_tp7 -->
<g id="edge256" class="edge">
<title>Gate_s0_l2_tp7&#45;&gt;Expert31_s0_l2_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11436.47,-16549.24C11527.97,-16538.11 11643.22,-16523.6 11754.9,-16507.93"/>
<polygon fill="black" stroke="black" points="11755.59,-16511.37 11765.01,-16506.51 11754.62,-16504.44 11755.59,-16511.37"/>
</g>
<!-- AR_exp_s0_l2 -->
<g id="node175" class="node">
<title>AR_exp_s0_l2</title>
<ellipse fill="none" stroke="black" cx="8137.42" cy="-16381.26" rx="239" ry="37.45"/>
<text text-anchor="middle" x="8137.42" y="-16392.56" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="8137.42" y="-16377.56" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="8137.42" y="-16362.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l2_tp0&#45;&gt;AR_exp_s0_l2 -->
<g id="edge257" class="edge">
<title>Expert0_s0_l2_tp0&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M7800.34,-16454.68C7858.08,-16442.28 7928.04,-16427.24 7989.22,-16414.1"/>
<polygon fill="black" stroke="black" points="7990.31,-16417.44 7999.35,-16411.92 7988.84,-16410.6 7990.31,-16417.44"/>
</g>
<!-- Expert1_s0_l2_tp0&#45;&gt;AR_exp_s0_l2 -->
<g id="edge258" class="edge">
<title>Expert1_s0_l2_tp0&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M8041.58,-16454.49C8053.79,-16445.29 8067.89,-16434.66 8081.46,-16424.44"/>
<polygon fill="black" stroke="black" points="8083.93,-16426.95 8089.81,-16418.14 8079.72,-16421.36 8083.93,-16426.95"/>
</g>
<!-- Expert2_s0_l2_tp0&#45;&gt;AR_exp_s0_l2 -->
<g id="edge259" class="edge">
<title>Expert2_s0_l2_tp0&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M7183.81,-16455.76C7186.71,-16455.41 7189.58,-16455.06 7192.42,-16454.73 7434.08,-16426.61 7711.82,-16406.79 7903.35,-16395.07"/>
<polygon fill="black" stroke="black" points="7903.78,-16398.55 7913.55,-16394.45 7903.36,-16391.57 7903.78,-16398.55"/>
</g>
<!-- Expert3_s0_l2_tp0&#45;&gt;AR_exp_s0_l2 -->
<g id="edge260" class="edge">
<title>Expert3_s0_l2_tp0&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M7509.83,-16455.92C7512.72,-16455.52 7515.58,-16455.12 7518.42,-16454.73 7656.32,-16435.88 7811.92,-16417.67 7932.62,-16404.23"/>
<polygon fill="black" stroke="black" points="7933.17,-16407.69 7942.72,-16403.1 7932.39,-16400.73 7933.17,-16407.69"/>
</g>
<!-- Expert4_s0_l2_tp1&#45;&gt;AR_exp_s0_l2 -->
<g id="edge261" class="edge">
<title>Expert4_s0_l2_tp1&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M5227.79,-16455.56C5230.69,-16455.27 5233.57,-16454.99 5236.42,-16454.73 5747.84,-16408.54 7284.22,-16389.96 7888.97,-16384.3"/>
<polygon fill="black" stroke="black" points="7889.16,-16387.8 7899.13,-16384.21 7889.09,-16380.8 7889.16,-16387.8"/>
</g>
<!-- Expert5_s0_l2_tp1&#45;&gt;AR_exp_s0_l2 -->
<g id="edge262" class="edge">
<title>Expert5_s0_l2_tp1&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M5553.79,-16455.57C5556.69,-16455.28 5559.57,-16455 5562.42,-16454.73 6008.79,-16413.7 7334.95,-16392.49 7889.41,-16385.22"/>
<polygon fill="black" stroke="black" points="7889.58,-16388.71 7899.54,-16385.08 7889.49,-16381.72 7889.58,-16388.71"/>
</g>
<!-- Expert6_s0_l2_tp1&#45;&gt;AR_exp_s0_l2 -->
<g id="edge263" class="edge">
<title>Expert6_s0_l2_tp1&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M4575.79,-16455.54C4578.69,-16455.25 4581.57,-16454.98 4584.42,-16454.73 5227.07,-16398.17 7190.83,-16385.65 7888.37,-16382.97"/>
<polygon fill="black" stroke="black" points="7888.55,-16386.47 7898.54,-16382.93 7888.53,-16379.47 7888.55,-16386.47"/>
</g>
<!-- Expert7_s0_l2_tp1&#45;&gt;AR_exp_s0_l2 -->
<g id="edge264" class="edge">
<title>Expert7_s0_l2_tp1&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M4901.79,-16455.55C4904.69,-16455.26 4907.57,-16454.99 4910.42,-16454.73 5487.2,-16403.37 7235.8,-16387.7 7888.34,-16383.57"/>
<polygon fill="black" stroke="black" points="7888.83,-16387.07 7898.81,-16383.51 7888.79,-16380.07 7888.83,-16387.07"/>
</g>
<!-- Expert8_s0_l2_tp2&#45;&gt;AR_exp_s0_l2 -->
<g id="edge265" class="edge">
<title>Expert8_s0_l2_tp2&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M6857.81,-16455.69C6860.7,-16455.35 6863.57,-16455.04 6866.42,-16454.73 7222.37,-16416.83 7636.66,-16397.88 7893,-16389.07"/>
<polygon fill="black" stroke="black" points="7893.31,-16392.56 7903.19,-16388.72 7893.08,-16385.56 7893.31,-16392.56"/>
</g>
<!-- Expert9_s0_l2_tp2&#45;&gt;AR_exp_s0_l2 -->
<g id="edge266" class="edge">
<title>Expert9_s0_l2_tp2&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M5879.8,-16455.59C5882.69,-16455.29 5885.57,-16455 5888.42,-16454.73 6270.24,-16418.85 7389.24,-16395.38 7890.1,-16386.38"/>
<polygon fill="black" stroke="black" points="7890.42,-16389.88 7900.35,-16386.2 7890.29,-16382.88 7890.42,-16389.88"/>
</g>
<!-- Expert10_s0_l2_tp2&#45;&gt;AR_exp_s0_l2 -->
<g id="edge267" class="edge">
<title>Expert10_s0_l2_tp2&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M6205.8,-16455.61C6208.69,-16455.3 6211.57,-16455.01 6214.42,-16454.73 6813.21,-16396.81 7521.03,-16384.52 7888.26,-16382.32"/>
<polygon fill="black" stroke="black" points="7888.51,-16385.81 7898.49,-16382.26 7888.47,-16378.81 7888.51,-16385.81"/>
</g>
<!-- Expert11_s0_l2_tp2&#45;&gt;AR_exp_s0_l2 -->
<g id="edge268" class="edge">
<title>Expert11_s0_l2_tp2&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M6531.8,-16455.64C6534.7,-16455.32 6537.57,-16455.02 6540.42,-16454.73 7016.1,-16406.88 7574.69,-16390.61 7889.24,-16385.09"/>
<polygon fill="black" stroke="black" points="7889.47,-16388.58 7899.4,-16384.91 7889.35,-16381.58 7889.47,-16388.58"/>
</g>
<!-- Expert12_s0_l2_tp3&#45;&gt;AR_exp_s0_l2 -->
<g id="edge269" class="edge">
<title>Expert12_s0_l2_tp3&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M8282.18,-16454.62C8262.04,-16444.55 8238.47,-16432.77 8216.26,-16421.66"/>
<polygon fill="black" stroke="black" points="8217.68,-16418.46 8207.17,-16417.12 8214.55,-16424.72 8217.68,-16418.46"/>
</g>
<!-- Expert13_s0_l2_tp3&#45;&gt;AR_exp_s0_l2 -->
<g id="edge270" class="edge">
<title>Expert13_s0_l2_tp3&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M8523.3,-16454.68C8454.2,-16441.71 8369.82,-16425.88 8297.61,-16412.32"/>
<polygon fill="black" stroke="black" points="8297.98,-16408.83 8287.51,-16410.43 8296.69,-16415.71 8297.98,-16408.83"/>
</g>
<!-- Expert14_s0_l2_tp3&#45;&gt;AR_exp_s0_l2 -->
<g id="edge271" class="edge">
<title>Expert14_s0_l2_tp3&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M8831.02,-16455.88C8828.13,-16455.49 8825.26,-16455.1 8822.42,-16454.73 8664.67,-16434.06 8485.87,-16415.3 8350.51,-16402.05"/>
<polygon fill="black" stroke="black" points="8350.72,-16398.55 8340.43,-16401.06 8350.04,-16405.52 8350.72,-16398.55"/>
</g>
<!-- Expert15_s0_l2_tp3&#45;&gt;AR_exp_s0_l2 -->
<g id="edge272" class="edge">
<title>Expert15_s0_l2_tp3&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M9157.03,-16455.74C9154.14,-16455.39 9151.27,-16455.06 9148.42,-16454.73 8884.15,-16424.64 8579.51,-16404.82 8374.29,-16393.63"/>
<polygon fill="black" stroke="black" points="8374.46,-16390.13 8364.29,-16393.08 8374.08,-16397.12 8374.46,-16390.13"/>
</g>
<!-- Expert16_s0_l2_tp4&#45;&gt;AR_exp_s0_l2 -->
<g id="edge273" class="edge">
<title>Expert16_s0_l2_tp4&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M9483.04,-16455.68C9480.15,-16455.35 9477.27,-16455.03 9474.42,-16454.73 9094.67,-16414.84 8651.79,-16396.3 8383.14,-16388.14"/>
<polygon fill="black" stroke="black" points="8382.97,-16384.63 8372.87,-16387.83 8382.76,-16391.63 8382.97,-16384.63"/>
</g>
<!-- Expert17_s0_l2_tp4&#45;&gt;AR_exp_s0_l2 -->
<g id="edge274" class="edge">
<title>Expert17_s0_l2_tp4&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M9809.04,-16455.63C9806.15,-16455.32 9803.27,-16455.02 9800.42,-16454.73 9300.03,-16404.85 8711.55,-16389.29 8385.92,-16384.45"/>
<polygon fill="black" stroke="black" points="8385.94,-16380.95 8375.89,-16384.3 8385.83,-16387.94 8385.94,-16380.95"/>
</g>
<!-- Expert18_s0_l2_tp4&#45;&gt;AR_exp_s0_l2 -->
<g id="edge275" class="edge">
<title>Expert18_s0_l2_tp4&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M10135.05,-16455.61C10132.15,-16455.3 10129.27,-16455.01 10126.42,-16454.73 9502.45,-16394.77 8764.02,-16383.4 8386.68,-16381.86"/>
<polygon fill="black" stroke="black" points="8386.47,-16378.36 8376.45,-16381.82 8386.44,-16385.36 8386.47,-16378.36"/>
</g>
<!-- Expert19_s0_l2_tp4&#45;&gt;AR_exp_s0_l2 -->
<g id="edge276" class="edge">
<title>Expert19_s0_l2_tp4&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M10461.05,-16455.59C10458.15,-16455.28 10455.27,-16455 10452.42,-16454.73 10057.56,-16417.81 8896.77,-16394.76 8384.82,-16386.12"/>
<polygon fill="black" stroke="black" points="8384.77,-16382.62 8374.71,-16385.95 8384.65,-16389.62 8384.77,-16382.62"/>
</g>
<!-- Expert20_s0_l2_tp5&#45;&gt;AR_exp_s0_l2 -->
<g id="edge277" class="edge">
<title>Expert20_s0_l2_tp5&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M3271.79,-16455.52C3274.69,-16455.24 3277.57,-16454.98 3280.42,-16454.73 3740.03,-16415.55 6961.69,-16390.4 7888.54,-16383.92"/>
<polygon fill="black" stroke="black" points="7888.69,-16387.42 7898.66,-16383.85 7888.64,-16380.42 7888.69,-16387.42"/>
</g>
<!-- Expert21_s0_l2_tp5&#45;&gt;AR_exp_s0_l2 -->
<g id="edge278" class="edge">
<title>Expert21_s0_l2_tp5&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M3597.79,-16455.52C3600.69,-16455.24 3603.57,-16454.98 3606.42,-16454.73 4448.13,-16382.52 7066.39,-16380.46 7888.1,-16381.67"/>
<polygon fill="black" stroke="black" points="7888.27,-16385.17 7898.28,-16381.69 7888.28,-16378.17 7888.27,-16385.17"/>
</g>
<!-- Expert22_s0_l2_tp5&#45;&gt;AR_exp_s0_l2 -->
<g id="edge279" class="edge">
<title>Expert22_s0_l2_tp5&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M3923.79,-16455.53C3926.69,-16455.25 3929.57,-16454.98 3932.42,-16454.73 4707.47,-16387.75 7105.74,-16382.06 7887.94,-16382.04"/>
<polygon fill="black" stroke="black" points="7888.2,-16385.54 7898.2,-16382.04 7888.2,-16378.54 7888.2,-16385.54"/>
</g>
<!-- Expert23_s0_l2_tp5&#45;&gt;AR_exp_s0_l2 -->
<g id="edge280" class="edge">
<title>Expert23_s0_l2_tp5&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M4249.79,-16455.54C4252.69,-16455.25 4255.57,-16454.98 4258.42,-16454.73 4967.13,-16392.97 7147.28,-16383.79 7888.08,-16382.46"/>
<polygon fill="black" stroke="black" points="7888.35,-16385.96 7898.34,-16382.45 7888.34,-16378.96 7888.35,-16385.96"/>
</g>
<!-- Expert24_s0_l2_tp6&#45;&gt;AR_exp_s0_l2 -->
<g id="edge281" class="edge">
<title>Expert24_s0_l2_tp6&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M12091.05,-16455.53C12088.16,-16455.25 12085.28,-16454.98 12082.42,-16454.73 11360.29,-16391.91 9136.02,-16383.43 8386.75,-16382.37"/>
<polygon fill="black" stroke="black" points="8386.65,-16378.87 8376.64,-16382.36 8386.64,-16385.87 8386.65,-16378.87"/>
</g>
<!-- Expert25_s0_l2_tp6&#45;&gt;AR_exp_s0_l2 -->
<g id="edge282" class="edge">
<title>Expert25_s0_l2_tp6&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M12417.05,-16455.53C12414.16,-16455.24 12411.28,-16454.98 12408.42,-16454.73 11619.85,-16386.69 9176.87,-16381.73 8386.72,-16381.96"/>
<polygon fill="black" stroke="black" points="8386.64,-16378.46 8376.64,-16381.96 8386.64,-16385.46 8386.64,-16378.46"/>
</g>
<!-- Expert26_s0_l2_tp6&#45;&gt;AR_exp_s0_l2 -->
<g id="edge283" class="edge">
<title>Expert26_s0_l2_tp6&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M12743.05,-16455.52C12740.16,-16455.24 12737.28,-16454.98 12734.42,-16454.73 11879.21,-16381.46 9216.35,-16380.15 8386.77,-16381.6"/>
<polygon fill="black" stroke="black" points="8386.49,-16378.1 8376.49,-16381.62 8386.5,-16385.1 8386.49,-16378.1"/>
</g>
<!-- Expert27_s0_l2_tp6&#45;&gt;AR_exp_s0_l2 -->
<g id="edge284" class="edge">
<title>Expert27_s0_l2_tp6&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M13069.06,-16455.52C13066.16,-16455.24 13063.28,-16454.98 13060.42,-16454.73 12593.97,-16415.01 9320.76,-16390.2 8386.09,-16383.87"/>
<polygon fill="black" stroke="black" points="8385.91,-16380.36 8375.88,-16383.8 8385.86,-16387.36 8385.91,-16380.36"/>
</g>
<!-- Expert28_s0_l2_tp7&#45;&gt;AR_exp_s0_l2 -->
<g id="edge285" class="edge">
<title>Expert28_s0_l2_tp7&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M10787.05,-16455.57C10784.15,-16455.27 10781.27,-16454.99 10778.42,-16454.73 10318.98,-16412.66 8950.75,-16391.96 8385.74,-16385.02"/>
<polygon fill="black" stroke="black" points="8385.47,-16381.51 8375.43,-16384.89 8385.38,-16388.51 8385.47,-16381.51"/>
</g>
<!-- Expert29_s0_l2_tp7&#45;&gt;AR_exp_s0_l2 -->
<g id="edge286" class="edge">
<title>Expert29_s0_l2_tp7&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M11113.05,-16455.56C11110.15,-16455.27 11107.28,-16454.99 11104.42,-16454.73 10579.85,-16407.5 9000.92,-16389.48 8386.18,-16384.14"/>
<polygon fill="black" stroke="black" points="8385.88,-16380.64 8375.85,-16384.05 8385.82,-16387.64 8385.88,-16380.64"/>
</g>
<!-- Expert30_s0_l2_tp7&#45;&gt;AR_exp_s0_l2 -->
<g id="edge287" class="edge">
<title>Expert30_s0_l2_tp7&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M11439.05,-16455.55C11436.15,-16455.26 11433.28,-16454.99 11430.42,-16454.73 10840.28,-16402.31 9048.01,-16387.27 8386.33,-16383.44"/>
<polygon fill="black" stroke="black" points="8386.21,-16379.94 8376.19,-16383.38 8386.17,-16386.94 8386.21,-16379.94"/>
</g>
<!-- Expert31_s0_l2_tp7&#45;&gt;AR_exp_s0_l2 -->
<g id="edge288" class="edge">
<title>Expert31_s0_l2_tp7&#45;&gt;AR_exp_s0_l2</title>
<path fill="none" stroke="black" d="M11765.05,-16455.54C11762.15,-16455.25 11759.28,-16454.98 11756.42,-16454.73 11100.39,-16397.11 9092.77,-16385.26 8386.43,-16382.86"/>
<polygon fill="black" stroke="black" points="8386.39,-16379.36 8376.38,-16382.82 8386.37,-16386.36 8386.39,-16379.36"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp0 -->
<g id="edge289" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M8083.26,-16344.59C8068.49,-16334.86 8052.11,-16324.07 8035.99,-16313.45"/>
<polygon fill="black" stroke="black" points="8037.87,-16310.5 8027.59,-16307.92 8034.02,-16316.35 8037.87,-16310.5"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp1 -->
<g id="edge291" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7908.41,-16370.35C7590.44,-16356.56 6997.2,-16330.69 6491.42,-16307.78 6218.53,-16295.42 5908.16,-16280.94 5683.96,-16270.4"/>
<polygon fill="black" stroke="black" points="5683.84,-16266.89 5673.69,-16269.92 5683.51,-16273.88 5683.84,-16266.89"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp2 -->
<g id="edge293" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7936.68,-16360.84C7735.33,-16341.37 7421.71,-16311.03 7183.11,-16287.96"/>
<polygon fill="black" stroke="black" points="7183.17,-16284.45 7172.88,-16286.97 7182.49,-16291.41 7183.17,-16284.45"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp3 -->
<g id="edge295" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8287.19,-16352.01C8369.57,-16336.47 8473.57,-16316.86 8566.15,-16299.4"/>
<polygon fill="black" stroke="black" points="8567.04,-16302.79 8576.22,-16297.5 8565.75,-16295.91 8567.04,-16302.79"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp4 -->
<g id="edge297" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp4</title>
<path fill="none" stroke="black" d="M8365.04,-16369.75C8859.78,-16346.92 10031.28,-16292.85 10563.24,-16268.3"/>
<polygon fill="black" stroke="black" points="10563.53,-16271.79 10573.36,-16267.83 10563.21,-16264.79 10563.53,-16271.79"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp5 -->
<g id="edge299" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp5</title>
<path fill="none" stroke="black" d="M7901.45,-16375.14C7380.61,-16363.78 6093.29,-16335.25 5015.42,-16307.78 4460.65,-16293.64 3813.54,-16275.27 3443.21,-16264.57"/>
<polygon fill="black" stroke="black" points="3443.25,-16261.07 3433.15,-16264.28 3443.05,-16268.07 3443.25,-16261.07"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp6 -->
<g id="edge301" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp6</title>
<path fill="none" stroke="black" d="M8375.78,-16378.22C9173.16,-16371.11 11743.69,-16345.75 12571.42,-16307.78 12714.34,-16301.22 12873.64,-16289.49 13003.04,-16278.83"/>
<polygon fill="black" stroke="black" points="13003.41,-16282.31 13013.09,-16277.99 13002.84,-16275.33 13003.41,-16282.31"/>
</g>
<!-- AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp7 -->
<g id="edge303" class="edge">
<title>AR_exp_s0_l2&#45;&gt;ResMOE_s0_l2_tp7</title>
<path fill="none" stroke="black" d="M8374.75,-16376.83C8888.71,-16368.93 10143.03,-16347.03 11193.42,-16307.78 11448.68,-16298.24 11739.69,-16282.95 11945.19,-16271.41"/>
<polygon fill="black" stroke="black" points="11945.43,-16274.9 11955.21,-16270.85 11945.03,-16267.92 11945.43,-16274.9"/>
</g>
<!-- QKV_s0_l3_tp0 -->
<g id="node184" class="node">
<title>QKV_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7176.42,-16165.78 6838.42,-16165.78 6838.42,-16112.78 7176.42,-16112.78 7176.42,-16165.78"/>
<text text-anchor="middle" x="7007.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7007.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7007.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp0 -->
<g id="edge305" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7616.41,-16215.52C7487.15,-16200.39 7337.82,-16182.62 7202.42,-16165.78 7197.26,-16165.14 7192.02,-16164.48 7186.74,-16163.82"/>
<polygon fill="black" stroke="black" points="7186.88,-16160.31 7176.52,-16162.52 7186,-16167.25 7186.88,-16160.31"/>
</g>
<!-- QKV_s0_l3_tp1 -->
<g id="node185" class="node">
<title>QKV_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="7549.42,-16165.78 7211.42,-16165.78 7211.42,-16112.78 7549.42,-16112.78 7549.42,-16165.78"/>
<text text-anchor="middle" x="7380.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7380.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7380.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp1 -->
<g id="edge306" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7688.11,-16201.76C7629.55,-16190.06 7569.64,-16178.09 7518.43,-16167.86"/>
<polygon fill="black" stroke="black" points="7518.8,-16164.36 7508.31,-16165.83 7517.43,-16171.23 7518.8,-16164.36"/>
</g>
<!-- QKV_s0_l3_tp2 -->
<g id="node186" class="node">
<title>QKV_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="7930.42,-16165.78 7592.42,-16165.78 7592.42,-16112.78 7930.42,-16112.78 7930.42,-16165.78"/>
<text text-anchor="middle" x="7761.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7761.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7761.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp2 -->
<g id="edge307" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7862.58,-16201.68C7845.41,-16191.26 7827.89,-16180.62 7812.35,-16171.19"/>
<polygon fill="black" stroke="black" points="7813.82,-16167.99 7803.46,-16165.79 7810.19,-16173.97 7813.82,-16167.99"/>
</g>
<!-- QKV_s0_l3_tp3 -->
<g id="node187" class="node">
<title>QKV_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8303.42,-16165.78 7965.42,-16165.78 7965.42,-16112.78 8303.42,-16112.78 8303.42,-16165.78"/>
<text text-anchor="middle" x="8134.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8134.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8134.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp3 -->
<g id="edge308" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8033.8,-16201.68C8050.89,-16191.26 8068.31,-16180.62 8083.76,-16171.19"/>
<polygon fill="black" stroke="black" points="8085.9,-16173.99 8092.61,-16165.79 8082.25,-16168.01 8085.9,-16173.99"/>
</g>
<!-- QKV_s0_l3_tp4 -->
<g id="node188" class="node">
<title>QKV_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="8684.42,-16165.78 8346.42,-16165.78 8346.42,-16112.78 8684.42,-16112.78 8684.42,-16165.78"/>
<text text-anchor="middle" x="8515.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8515.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8515.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp4 -->
<g id="edge309" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8166.83,-16210.06C8237.75,-16195.86 8314.42,-16180.52 8377.74,-16167.84"/>
<polygon fill="black" stroke="black" points="8378.67,-16171.22 8387.79,-16165.83 8377.3,-16164.36 8378.67,-16171.22"/>
</g>
<!-- QKV_s0_l3_tp5 -->
<g id="node189" class="node">
<title>QKV_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="9062.42,-16165.78 8724.42,-16165.78 8724.42,-16112.78 9062.42,-16112.78 9062.42,-16165.78"/>
<text text-anchor="middle" x="8893.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8893.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8893.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp5 -->
<g id="edge310" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M8188.38,-16226.01C8334.43,-16208.96 8524.73,-16186.5 8693.42,-16165.78 8700.19,-16164.95 8707.09,-16164.1 8714.06,-16163.23"/>
<polygon fill="black" stroke="black" points="8714.82,-16166.66 8724.31,-16161.95 8713.95,-16159.72 8714.82,-16166.66"/>
</g>
<!-- QKV_s0_l3_tp6 -->
<g id="node190" class="node">
<title>QKV_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="9450.42,-16165.78 9112.42,-16165.78 9112.42,-16112.78 9450.42,-16112.78 9450.42,-16165.78"/>
<text text-anchor="middle" x="9281.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9281.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9281.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp6 -->
<g id="edge311" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M8188.4,-16225.94C8267.9,-16217.36 8356.89,-16208.42 8438.42,-16201.78 8719.28,-16178.9 8790.75,-16190.78 9071.42,-16165.78 9081.47,-16164.88 9091.78,-16163.89 9102.18,-16162.82"/>
<polygon fill="black" stroke="black" points="9102.59,-16166.3 9112.18,-16161.78 9101.87,-16159.34 9102.59,-16166.3"/>
</g>
<!-- QKV_s0_l3_tp7 -->
<g id="node191" class="node">
<title>QKV_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="6786.42,-16165.78 6448.42,-16165.78 6448.42,-16112.78 6786.42,-16112.78 6786.42,-16165.78"/>
<text text-anchor="middle" x="6617.42" y="-16150.58" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6617.42" y="-16135.58" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6617.42" y="-16120.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp7 -->
<g id="edge312" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;QKV_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M7639.99,-16232.96C7415.09,-16216.94 7103.08,-16192.99 6829.42,-16165.78 6818.76,-16164.72 6807.8,-16163.57 6796.76,-16162.38"/>
<polygon fill="black" stroke="black" points="6796.91,-16158.87 6786.59,-16161.26 6796.15,-16165.83 6796.91,-16158.87"/>
</g>
<!-- ResAttn_s0_l3_tp0 -->
<g id="node218" class="node">
<title>ResAttn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7264.77,-15587.87 6707.45,-15587.87 6564.08,-15481.87 7121.4,-15481.87 7264.77,-15587.87"/>
<text text-anchor="middle" x="6914.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6914.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6914.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp0 -->
<g id="edge354" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7636.15,-16230.17C7504.48,-16220.64 7349.53,-16209.98 7209.42,-16201.78 7123.92,-16196.77 6513.13,-16209.4 6439.42,-16165.78 6388.09,-16135.4 6369.42,-16110.92 6369.42,-16051.28 6369.42,-16051.28 6369.42,-16051.28 6369.42,-15749.35 6369.42,-15677.2 6537.12,-15619.4 6686.47,-15582.24"/>
<polygon fill="black" stroke="black" points="6687.41,-15585.62 6696.28,-15579.82 6685.74,-15578.82 6687.41,-15585.62"/>
</g>
<!-- ResAttn_s0_l3_tp1 -->
<g id="node219" class="node">
<title>ResAttn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="5404.77,-15587.87 4847.45,-15587.87 4704.08,-15481.87 5261.4,-15481.87 5404.77,-15587.87"/>
<text text-anchor="middle" x="5054.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5054.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5054.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp1 -->
<g id="edge356" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7634.4,-16228.84C7503.13,-16219.15 7348.96,-16208.74 7209.42,-16201.78 6665.42,-16174.66 6526.87,-16215.08 5984.42,-16165.78 5816.95,-16150.56 5236.42,-16219.44 5236.42,-16051.28 5236.42,-16051.28 5236.42,-16051.28 5236.42,-15749.35 5236.42,-15686.16 5189.67,-15632.19 5143.56,-15594.32"/>
<polygon fill="black" stroke="black" points="5145.57,-15591.44 5135.58,-15587.91 5141.18,-15596.9 5145.57,-15591.44"/>
</g>
<!-- ResAttn_s0_l3_tp2 -->
<g id="node220" class="node">
<title>ResAttn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="6325.77,-15587.87 5768.45,-15587.87 5625.08,-15481.87 6182.4,-15481.87 6325.77,-15587.87"/>
<text text-anchor="middle" x="5975.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5975.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5975.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp2 -->
<g id="edge358" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7635.71,-16229.9C7504.14,-16220.34 7349.39,-16209.73 7209.42,-16201.78 6840.34,-16180.8 6743.38,-16224.7 6378.42,-16165.78 6194.6,-16136.1 5975.42,-16237.48 5975.42,-16051.28 5975.42,-16051.28 5975.42,-16051.28 5975.42,-15749.35 5975.42,-15698.5 5975.42,-15640.85 5975.42,-15598.28"/>
<polygon fill="black" stroke="black" points="5978.92,-15598.07 5975.42,-15588.07 5971.92,-15598.07 5978.92,-15598.07"/>
</g>
<!-- ResAttn_s0_l3_tp3 -->
<g id="node221" class="node">
<title>ResAttn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="9333.77,-15587.87 8776.45,-15587.87 8633.08,-15481.87 9190.4,-15481.87 9333.77,-15587.87"/>
<text text-anchor="middle" x="8983.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8983.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8983.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp3 -->
<g id="edge360" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8187.07,-16225.04C8266.88,-16216.34 8356.39,-16207.57 8438.42,-16201.78 8495.04,-16197.78 9410.6,-16194.72 9459.42,-16165.78 9510.34,-16135.6 9527.42,-16110.47 9527.42,-16051.28 9527.42,-16051.28 9527.42,-16051.28 9527.42,-15749.35 9527.42,-15666.45 9463.12,-15661.83 9389.42,-15623.87 9364.9,-15611.24 9338.65,-15600.42 9311.73,-15591.15"/>
<polygon fill="black" stroke="black" points="9312.77,-15587.81 9302.18,-15587.94 9310.54,-15594.45 9312.77,-15587.81"/>
</g>
<!-- ResAttn_s0_l3_tp4 -->
<g id="node222" class="node">
<title>ResAttn_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="10271.77,-15587.87 9714.45,-15587.87 9571.08,-15481.87 10128.4,-15481.87 10271.77,-15587.87"/>
<text text-anchor="middle" x="9921.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9921.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9921.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp4 -->
<g id="edge362" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8187.07,-16224.98C8266.88,-16216.27 8356.39,-16207.51 8438.42,-16201.78 8603.64,-16190.23 9921.42,-16216.9 9921.42,-16051.28 9921.42,-16051.28 9921.42,-16051.28 9921.42,-15749.35 9921.42,-15698.5 9921.42,-15640.85 9921.42,-15598.28"/>
<polygon fill="black" stroke="black" points="9924.92,-15598.07 9921.42,-15588.07 9917.92,-15598.07 9924.92,-15598.07"/>
</g>
<!-- ResAttn_s0_l3_tp5 -->
<g id="node223" class="node">
<title>ResAttn_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="4190.77,-15587.87 3633.45,-15587.87 3490.08,-15481.87 4047.4,-15481.87 4190.77,-15587.87"/>
<text text-anchor="middle" x="3840.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3840.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3840.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp5 -->
<g id="edge364" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M7633.53,-16228.02C7502.46,-16218.24 7348.67,-16207.97 7209.42,-16201.78 6779.55,-16182.67 5699.27,-16227.49 5273.42,-16165.78 5084.06,-16138.34 4858.42,-16242.62 4858.42,-16051.28 4858.42,-16051.28 4858.42,-16051.28 4858.42,-15749.35 4858.42,-15600.82 4438.05,-15555.03 4137.57,-15541.27"/>
<polygon fill="black" stroke="black" points="4137.53,-15537.76 4127.38,-15540.81 4137.21,-15544.76 4137.53,-15537.76"/>
</g>
<!-- ResAttn_s0_l3_tp6 -->
<g id="node224" class="node">
<title>ResAttn_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="12510.77,-15587.87 11953.45,-15587.87 11810.08,-15481.87 12367.4,-15481.87 12510.77,-15587.87"/>
<text text-anchor="middle" x="12160.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12160.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12160.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp6 -->
<g id="edge366" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M8186.09,-16224.38C8266.13,-16215.59 8356.03,-16206.93 8438.42,-16201.78 8634.5,-16189.52 11971.42,-16247.74 11971.42,-16051.28 11971.42,-16051.28 11971.42,-16051.28 11971.42,-15749.35 11971.42,-15685.46 12019.46,-15631.73 12067.1,-15594.16"/>
<polygon fill="black" stroke="black" points="12069.26,-15596.91 12075.05,-15588.03 12064.99,-15591.37 12069.26,-15596.91"/>
</g>
<!-- ResAttn_s0_l3_tp7 -->
<g id="node225" class="node">
<title>ResAttn_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="11304.77,-15587.87 10747.45,-15587.87 10604.08,-15481.87 11161.4,-15481.87 11304.77,-15587.87"/>
<text text-anchor="middle" x="10954.42" y="-15546.17" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10954.42" y="-15531.17" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10954.42" y="-15516.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp7 -->
<g id="edge368" class="edge">
<title>ResMOE_s0_l2_tp0&#45;&gt;ResAttn_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M8186.74,-16224.75C8266.62,-16216.01 8356.27,-16207.29 8438.42,-16201.78 8573.05,-16192.74 10862.42,-16186.21 10862.42,-16051.28 10862.42,-16051.28 10862.42,-16051.28 10862.42,-15749.35 10862.42,-15694.64 10888.22,-15638.02 10912.49,-15596.84"/>
<polygon fill="black" stroke="black" points="10915.63,-15598.41 10917.8,-15588.04 10909.64,-15594.8 10915.63,-15598.41"/>
</g>
<!-- SplitHeads_s0_l3_tp0 -->
<g id="node192" class="node">
<title>SplitHeads_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7159.42,-16076.78 6787.42,-16076.78 6787.42,-16023.78 7159.42,-16023.78 7159.42,-16076.78"/>
<text text-anchor="middle" x="6973.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6973.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6973.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp0&#45;&gt;SplitHeads_s0_l3_tp0 -->
<g id="edge313" class="edge">
<title>QKV_s0_l3_tp0&#45;&gt;SplitHeads_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M6997.41,-16112.65C6994.22,-16104.49 6990.63,-16095.32 6987.23,-16086.6"/>
<polygon fill="black" stroke="black" points="6990.39,-16085.07 6983.49,-16077.03 6983.87,-16087.62 6990.39,-16085.07"/>
</g>
<!-- SplitHeads_s0_l3_tp1 -->
<g id="node193" class="node">
<title>SplitHeads_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="7549.42,-16076.78 7177.42,-16076.78 7177.42,-16023.78 7549.42,-16023.78 7549.42,-16076.78"/>
<text text-anchor="middle" x="7363.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7363.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7363.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp1&#45;&gt;SplitHeads_s0_l3_tp1 -->
<g id="edge314" class="edge">
<title>QKV_s0_l3_tp1&#45;&gt;SplitHeads_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7375.41,-16112.65C7373.84,-16104.58 7372.07,-16095.51 7370.38,-16086.88"/>
<polygon fill="black" stroke="black" points="7373.81,-16086.17 7368.45,-16077.03 7366.94,-16087.51 7373.81,-16086.17"/>
</g>
<!-- SplitHeads_s0_l3_tp2 -->
<g id="node194" class="node">
<title>SplitHeads_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="7939.42,-16076.78 7567.42,-16076.78 7567.42,-16023.78 7939.42,-16023.78 7939.42,-16076.78"/>
<text text-anchor="middle" x="7753.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7753.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7753.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp2&#45;&gt;SplitHeads_s0_l3_tp2 -->
<g id="edge315" class="edge">
<title>QKV_s0_l3_tp2&#45;&gt;SplitHeads_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7759.07,-16112.65C7758.33,-16104.67 7757.51,-16095.71 7756.72,-16087.16"/>
<polygon fill="black" stroke="black" points="7760.19,-16086.67 7755.79,-16077.03 7753.22,-16087.31 7760.19,-16086.67"/>
</g>
<!-- SplitHeads_s0_l3_tp3 -->
<g id="node195" class="node">
<title>SplitHeads_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8329.42,-16076.78 7957.42,-16076.78 7957.42,-16023.78 8329.42,-16023.78 8329.42,-16076.78"/>
<text text-anchor="middle" x="8143.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8143.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8143.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp3&#45;&gt;SplitHeads_s0_l3_tp3 -->
<g id="edge316" class="edge">
<title>QKV_s0_l3_tp3&#45;&gt;SplitHeads_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8137.07,-16112.65C8137.9,-16104.67 8138.83,-16095.71 8139.71,-16087.16"/>
<polygon fill="black" stroke="black" points="8143.21,-16087.34 8140.76,-16077.03 8136.25,-16086.62 8143.21,-16087.34"/>
</g>
<!-- SplitHeads_s0_l3_tp4 -->
<g id="node196" class="node">
<title>SplitHeads_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="8719.42,-16076.78 8347.42,-16076.78 8347.42,-16023.78 8719.42,-16023.78 8719.42,-16076.78"/>
<text text-anchor="middle" x="8533.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8533.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8533.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp4&#45;&gt;SplitHeads_s0_l3_tp4 -->
<g id="edge317" class="edge">
<title>QKV_s0_l3_tp4&#45;&gt;SplitHeads_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8520.73,-16112.65C8522.4,-16104.58 8524.27,-16095.51 8526.06,-16086.88"/>
<polygon fill="black" stroke="black" points="8529.5,-16087.53 8528.1,-16077.03 8522.64,-16086.11 8529.5,-16087.53"/>
</g>
<!-- SplitHeads_s0_l3_tp5 -->
<g id="node197" class="node">
<title>SplitHeads_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="9109.42,-16076.78 8737.42,-16076.78 8737.42,-16023.78 9109.42,-16023.78 9109.42,-16076.78"/>
<text text-anchor="middle" x="8923.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8923.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8923.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp5&#45;&gt;SplitHeads_s0_l3_tp5 -->
<g id="edge318" class="edge">
<title>QKV_s0_l3_tp5&#45;&gt;SplitHeads_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M8902.26,-16112.65C8905.07,-16104.49 8908.24,-16095.32 8911.24,-16086.6"/>
<polygon fill="black" stroke="black" points="8914.59,-16087.62 8914.54,-16077.03 8907.97,-16085.34 8914.59,-16087.62"/>
</g>
<!-- SplitHeads_s0_l3_tp6 -->
<g id="node198" class="node">
<title>SplitHeads_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="9499.42,-16076.78 9127.42,-16076.78 9127.42,-16023.78 9499.42,-16023.78 9499.42,-16076.78"/>
<text text-anchor="middle" x="9313.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9313.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9313.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp6&#45;&gt;SplitHeads_s0_l3_tp6 -->
<g id="edge319" class="edge">
<title>QKV_s0_l3_tp6&#45;&gt;SplitHeads_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M9290.85,-16112.65C9293.85,-16104.49 9297.22,-16095.32 9300.43,-16086.6"/>
<polygon fill="black" stroke="black" points="9303.78,-16087.62 9303.95,-16077.03 9297.21,-16085.21 9303.78,-16087.62"/>
</g>
<!-- SplitHeads_s0_l3_tp7 -->
<g id="node199" class="node">
<title>SplitHeads_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="6769.42,-16076.78 6397.42,-16076.78 6397.42,-16023.78 6769.42,-16023.78 6769.42,-16076.78"/>
<text text-anchor="middle" x="6583.42" y="-16061.58" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6583.42" y="-16046.58" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6583.42" y="-16031.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l3_tp7&#45;&gt;SplitHeads_s0_l3_tp7 -->
<g id="edge320" class="edge">
<title>QKV_s0_l3_tp7&#45;&gt;SplitHeads_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M6607.41,-16112.65C6604.22,-16104.49 6600.63,-16095.32 6597.23,-16086.6"/>
<polygon fill="black" stroke="black" points="6600.39,-16085.07 6593.49,-16077.03 6593.87,-16087.62 6600.39,-16085.07"/>
</g>
<!-- A2A_s0_l3 -->
<g id="node200" class="node">
<title>A2A_s0_l3</title>
<ellipse fill="none" stroke="black" cx="7948.42" cy="-15950.3" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7948.42" y="-15961.6" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="7948.42" y="-15946.6" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7948.42" y="-15931.6" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l3_tp0&#45;&gt;A2A_s0_l3 -->
<g id="edge321" class="edge">
<title>SplitHeads_s0_l3_tp0&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M7159.45,-16024.8C7162.46,-16024.45 7165.45,-16024.11 7168.42,-16023.78 7351.43,-16003.32 7559.05,-15984.23 7714.05,-15970.78"/>
<polygon fill="black" stroke="black" points="7714.53,-15974.25 7724.19,-15969.9 7713.92,-15967.28 7714.53,-15974.25"/>
</g>
<!-- SplitHeads_s0_l3_tp1&#45;&gt;A2A_s0_l3 -->
<g id="edge322" class="edge">
<title>SplitHeads_s0_l3_tp1&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M7515.98,-16023.73C7594.22,-16010.63 7689.93,-15994.6 7771.41,-15980.95"/>
<polygon fill="black" stroke="black" points="7771.99,-15984.4 7781.27,-15979.3 7770.83,-15977.5 7771.99,-15984.4"/>
</g>
<!-- SplitHeads_s0_l3_tp2&#45;&gt;A2A_s0_l3 -->
<g id="edge323" class="edge">
<title>SplitHeads_s0_l3_tp2&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M7804.4,-16023.67C7824.24,-16013.7 7847.43,-16002.05 7869.33,-15991.04"/>
<polygon fill="black" stroke="black" points="7870.94,-15994.15 7878.3,-15986.53 7867.8,-15987.9 7870.94,-15994.15"/>
</g>
<!-- SplitHeads_s0_l3_tp3&#45;&gt;A2A_s0_l3 -->
<g id="edge324" class="edge">
<title>SplitHeads_s0_l3_tp3&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M8092.44,-16023.67C8072.61,-16013.7 8049.42,-16002.05 8027.51,-15991.04"/>
<polygon fill="black" stroke="black" points="8029.05,-15987.9 8018.54,-15986.53 8025.91,-15994.15 8029.05,-15987.9"/>
</g>
<!-- SplitHeads_s0_l3_tp4&#45;&gt;A2A_s0_l3 -->
<g id="edge325" class="edge">
<title>SplitHeads_s0_l3_tp4&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M8380.87,-16023.73C8302.63,-16010.63 8206.91,-15994.6 8125.44,-15980.95"/>
<polygon fill="black" stroke="black" points="8126.02,-15977.5 8115.58,-15979.3 8124.86,-15984.4 8126.02,-15977.5"/>
</g>
<!-- SplitHeads_s0_l3_tp5&#45;&gt;A2A_s0_l3 -->
<g id="edge326" class="edge">
<title>SplitHeads_s0_l3_tp5&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M8737.4,-16024.8C8734.39,-16024.45 8731.39,-16024.11 8728.42,-16023.78 8545.42,-16003.32 8337.79,-15984.23 8182.79,-15970.78"/>
<polygon fill="black" stroke="black" points="8182.92,-15967.28 8172.66,-15969.9 8182.32,-15974.25 8182.92,-15967.28"/>
</g>
<!-- SplitHeads_s0_l3_tp6&#45;&gt;A2A_s0_l3 -->
<g id="edge327" class="edge">
<title>SplitHeads_s0_l3_tp6&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M9127.41,-16024.67C9124.39,-16024.36 9121.4,-16024.07 9118.42,-16023.78 8806.38,-15993.75 8446.25,-15973.62 8208.88,-15962.34"/>
<polygon fill="black" stroke="black" points="8208.88,-15958.84 8198.73,-15961.86 8208.55,-15965.83 8208.88,-15958.84"/>
</g>
<!-- SplitHeads_s0_l3_tp7&#45;&gt;A2A_s0_l3 -->
<g id="edge328" class="edge">
<title>SplitHeads_s0_l3_tp7&#45;&gt;A2A_s0_l3</title>
<path fill="none" stroke="black" d="M6769.43,-16024.67C6772.45,-16024.36 6775.45,-16024.07 6778.42,-16023.78 7090.47,-15993.75 7450.6,-15973.62 7687.96,-15962.34"/>
<polygon fill="black" stroke="black" points="7688.29,-15965.83 7698.12,-15961.86 7687.96,-15958.84 7688.29,-15965.83"/>
</g>
<!-- Attn_s0_l3_tp0 -->
<g id="node201" class="node">
<title>Attn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7159.42,-15876.83 6787.42,-15876.83 6787.42,-15823.83 7159.42,-15823.83 7159.42,-15876.83"/>
<text text-anchor="middle" x="6973.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6973.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6973.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp0 -->
<g id="edge329" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7724.19,-15930.7C7570.85,-15917.45 7362.7,-15898.4 7169.51,-15876.93"/>
<polygon fill="black" stroke="black" points="7169.77,-15873.44 7159.45,-15875.81 7169,-15880.4 7169.77,-15873.44"/>
</g>
<!-- Attn_s0_l3_tp1 -->
<g id="node202" class="node">
<title>Attn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="7549.42,-15876.83 7177.42,-15876.83 7177.42,-15823.83 7549.42,-15823.83 7549.42,-15876.83"/>
<text text-anchor="middle" x="7363.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7363.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7363.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp1 -->
<g id="edge330" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7781.18,-15921.29C7701.03,-15907.87 7605.42,-15891.86 7525.9,-15878.54"/>
<polygon fill="black" stroke="black" points="7526.23,-15875.04 7515.79,-15876.84 7525.07,-15881.95 7526.23,-15875.04"/>
</g>
<!-- Attn_s0_l3_tp2 -->
<g id="node203" class="node">
<title>Attn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="7939.42,-15876.83 7567.42,-15876.83 7567.42,-15823.83 7939.42,-15823.83 7939.42,-15876.83"/>
<text text-anchor="middle" x="7753.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7753.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7753.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp2 -->
<g id="edge331" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7878.3,-15914.07C7856.99,-15903.36 7833.79,-15891.71 7813.23,-15881.38"/>
<polygon fill="black" stroke="black" points="7814.8,-15878.25 7804.29,-15876.88 7811.65,-15884.5 7814.8,-15878.25"/>
</g>
<!-- Attn_s0_l3_tp3 -->
<g id="node204" class="node">
<title>Attn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8329.42,-15876.83 7957.42,-15876.83 7957.42,-15823.83 8329.42,-15823.83 8329.42,-15876.83"/>
<text text-anchor="middle" x="8143.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8143.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8143.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp3 -->
<g id="edge332" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8018.55,-15914.07C8039.85,-15903.36 8063.06,-15891.71 8083.62,-15881.38"/>
<polygon fill="black" stroke="black" points="8085.19,-15884.5 8092.55,-15876.88 8082.05,-15878.25 8085.19,-15884.5"/>
</g>
<!-- Attn_s0_l3_tp4 -->
<g id="node205" class="node">
<title>Attn_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="8719.42,-15876.83 8347.42,-15876.83 8347.42,-15823.83 8719.42,-15823.83 8719.42,-15876.83"/>
<text text-anchor="middle" x="8533.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8533.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8533.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp4 -->
<g id="edge333" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8115.67,-15921.29C8195.81,-15907.87 8291.43,-15891.86 8370.95,-15878.54"/>
<polygon fill="black" stroke="black" points="8371.77,-15881.95 8381.06,-15876.84 8370.62,-15875.04 8371.77,-15881.95"/>
</g>
<!-- Attn_s0_l3_tp5 -->
<g id="node206" class="node">
<title>Attn_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="9109.42,-15876.83 8737.42,-15876.83 8737.42,-15823.83 9109.42,-15823.83 9109.42,-15876.83"/>
<text text-anchor="middle" x="8923.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8923.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8923.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp5 -->
<g id="edge334" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M8172.66,-15930.7C8326,-15917.45 8534.14,-15898.4 8727.34,-15876.93"/>
<polygon fill="black" stroke="black" points="8727.85,-15880.4 8737.4,-15875.81 8727.07,-15873.44 8727.85,-15880.4"/>
</g>
<!-- Attn_s0_l3_tp6 -->
<g id="node207" class="node">
<title>Attn_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="9499.42,-15876.83 9127.42,-15876.83 9127.42,-15823.83 9499.42,-15823.83 9499.42,-15876.83"/>
<text text-anchor="middle" x="9313.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9313.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9313.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp6 -->
<g id="edge335" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M8198.73,-15938.74C8433.46,-15927.68 8794.4,-15907.71 9117.39,-15876.9"/>
<polygon fill="black" stroke="black" points="9117.79,-15880.38 9127.41,-15875.94 9117.12,-15873.41 9117.79,-15880.38"/>
</g>
<!-- Attn_s0_l3_tp7 -->
<g id="node208" class="node">
<title>Attn_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="6769.42,-15876.83 6397.42,-15876.83 6397.42,-15823.83 6769.42,-15823.83 6769.42,-15876.83"/>
<text text-anchor="middle" x="6583.42" y="-15861.63" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6583.42" y="-15846.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6583.42" y="-15831.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l3&#45;&gt;Attn_s0_l3_tp7 -->
<g id="edge336" class="edge">
<title>A2A_s0_l3&#45;&gt;Attn_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M7698.12,-15938.74C7463.38,-15927.68 7102.44,-15907.71 6779.46,-15876.9"/>
<polygon fill="black" stroke="black" points="6779.72,-15873.41 6769.43,-15875.94 6779.05,-15880.38 6779.72,-15873.41"/>
</g>
<!-- AR_attn_s0_l3 -->
<g id="node209" class="node">
<title>AR_attn_s0_l3</title>
<ellipse fill="none" stroke="black" cx="7964.42" cy="-15750.35" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7964.42" y="-15761.65" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="7964.42" y="-15746.65" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7964.42" y="-15731.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l3_tp0&#45;&gt;AR_attn_s0_l3 -->
<g id="edge337" class="edge">
<title>Attn_s0_l3_tp0&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M7159.45,-15824.83C7162.46,-15824.49 7165.45,-15824.16 7168.42,-15823.83 7356.18,-15803.01 7569.35,-15783.84 7727.81,-15770.45"/>
<polygon fill="black" stroke="black" points="7728.49,-15773.9 7738.16,-15769.57 7727.9,-15766.93 7728.49,-15773.9"/>
</g>
<!-- Attn_s0_l3_tp1&#45;&gt;AR_attn_s0_l3 -->
<g id="edge338" class="edge">
<title>Attn_s0_l3_tp1&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M7520.15,-15823.78C7601.2,-15810.56 7700.5,-15794.38 7784.65,-15780.66"/>
<polygon fill="black" stroke="black" points="7785.26,-15784.1 7794.57,-15779.04 7784.14,-15777.19 7785.26,-15784.1"/>
</g>
<!-- Attn_s0_l3_tp2&#45;&gt;AR_attn_s0_l3 -->
<g id="edge339" class="edge">
<title>Attn_s0_l3_tp2&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M7808.58,-15823.71C7830.35,-15813.61 7855.84,-15801.77 7879.83,-15790.63"/>
<polygon fill="black" stroke="black" points="7881.35,-15793.78 7888.95,-15786.4 7878.4,-15787.43 7881.35,-15793.78"/>
</g>
<!-- Attn_s0_l3_tp3&#45;&gt;AR_attn_s0_l3 -->
<g id="edge340" class="edge">
<title>Attn_s0_l3_tp3&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M8096.39,-15823.58C8078.61,-15813.85 8057.91,-15802.52 8038.25,-15791.76"/>
<polygon fill="black" stroke="black" points="8039.76,-15788.6 8029.31,-15786.86 8036.4,-15794.74 8039.76,-15788.6"/>
</g>
<!-- Attn_s0_l3_tp4&#45;&gt;AR_attn_s0_l3 -->
<g id="edge341" class="edge">
<title>Attn_s0_l3_tp4&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M8385.04,-15823.78C8309.65,-15810.79 8217.57,-15794.94 8138.81,-15781.38"/>
<polygon fill="black" stroke="black" points="8139.23,-15777.9 8128.78,-15779.65 8138.04,-15784.8 8139.23,-15777.9"/>
</g>
<!-- Attn_s0_l3_tp5&#45;&gt;AR_attn_s0_l3 -->
<g id="edge342" class="edge">
<title>Attn_s0_l3_tp5&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M8737.4,-15824.85C8734.38,-15824.5 8731.39,-15824.16 8728.42,-15823.83 8550.47,-15803.76 8348.77,-15784.78 8197.31,-15771.29"/>
<polygon fill="black" stroke="black" points="8197.23,-15767.76 8186.96,-15770.36 8196.61,-15774.74 8197.23,-15767.76"/>
</g>
<!-- Attn_s0_l3_tp6&#45;&gt;AR_attn_s0_l3 -->
<g id="edge343" class="edge">
<title>Attn_s0_l3_tp6&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M9127.41,-15824.72C9124.39,-15824.41 9121.4,-15824.11 9118.42,-15823.83 8811.87,-15794.19 8458.28,-15774.04 8224.13,-15762.66"/>
<polygon fill="black" stroke="black" points="8224.27,-15759.16 8214.12,-15762.17 8223.94,-15766.15 8224.27,-15759.16"/>
</g>
<!-- Attn_s0_l3_tp7&#45;&gt;AR_attn_s0_l3 -->
<g id="edge344" class="edge">
<title>Attn_s0_l3_tp7&#45;&gt;AR_attn_s0_l3</title>
<path fill="none" stroke="black" d="M6769.43,-15824.71C6772.45,-15824.41 6775.45,-15824.11 6778.42,-15823.83 7096,-15793.39 7462.71,-15773.28 7703.28,-15762.12"/>
<polygon fill="black" stroke="black" points="7703.74,-15765.61 7713.57,-15761.65 7703.42,-15758.61 7703.74,-15765.61"/>
</g>
<!-- O_s0_l3_tp0 -->
<g id="node210" class="node">
<title>O_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7628.42,-15676.87 7290.42,-15676.87 7290.42,-15623.87 7628.42,-15623.87 7628.42,-15676.87"/>
<text text-anchor="middle" x="7459.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7459.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7459.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp0 -->
<g id="edge345" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7811.88,-15719.75C7744.9,-15706.76 7666.74,-15691.6 7601.06,-15678.85"/>
<polygon fill="black" stroke="black" points="7601.54,-15675.38 7591.05,-15676.91 7600.2,-15682.25 7601.54,-15675.38"/>
</g>
<!-- O_s0_l3_tp1 -->
<g id="node211" class="node">
<title>O_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="6341.42,-15676.87 6003.42,-15676.87 6003.42,-15623.87 6341.42,-15623.87 6341.42,-15676.87"/>
<text text-anchor="middle" x="6172.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6172.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6172.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp1 -->
<g id="edge346" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7720.88,-15736.03C7355.93,-15716.08 6675.57,-15678.88 6352.14,-15661.2"/>
<polygon fill="black" stroke="black" points="6351.9,-15657.68 6341.73,-15660.63 6351.52,-15664.67 6351.9,-15657.68"/>
</g>
<!-- O_s0_l3_tp2 -->
<g id="node212" class="node">
<title>O_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="7093.42,-15676.87 6755.42,-15676.87 6755.42,-15623.87 7093.42,-15623.87 7093.42,-15676.87"/>
<text text-anchor="middle" x="6924.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6924.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6924.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp2 -->
<g id="edge347" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7747.99,-15728.96C7557.11,-15710.98 7282.25,-15685.08 7103.5,-15668.24"/>
<polygon fill="black" stroke="black" points="7103.75,-15664.75 7093.46,-15667.3 7103.09,-15671.72 7103.75,-15664.75"/>
</g>
<!-- O_s0_l3_tp3 -->
<g id="node213" class="node">
<title>O_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8787.42,-15676.87 8449.42,-15676.87 8449.42,-15623.87 8787.42,-15623.87 8787.42,-15676.87"/>
<text text-anchor="middle" x="8618.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8618.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8618.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp3 -->
<g id="edge348" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8142.27,-15722.71C8234.51,-15708.89 8346.9,-15692.05 8439.32,-15678.2"/>
<polygon fill="black" stroke="black" points="8439.97,-15681.65 8449.34,-15676.7 8438.94,-15674.72 8439.97,-15681.65"/>
</g>
<!-- O_s0_l3_tp4 -->
<g id="node214" class="node">
<title>O_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="9380.42,-15676.87 9042.42,-15676.87 9042.42,-15623.87 9380.42,-15623.87 9380.42,-15676.87"/>
<text text-anchor="middle" x="9211.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9211.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9211.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp4 -->
<g id="edge349" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8192.05,-15731.46C8433.74,-15712.48 8810.76,-15682.85 9032.19,-15665.45"/>
<polygon fill="black" stroke="black" points="9032.6,-15668.93 9042.29,-15664.66 9032.05,-15661.96 9032.6,-15668.93"/>
</g>
<!-- O_s0_l3_tp5 -->
<g id="node215" class="node">
<title>O_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="5764.42,-15676.87 5426.42,-15676.87 5426.42,-15623.87 5764.42,-15623.87 5764.42,-15676.87"/>
<text text-anchor="middle" x="5595.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5595.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5595.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp5 -->
<g id="edge350" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M7707.75,-15742.12C7331.66,-15731.03 6608.83,-15707.8 5994.42,-15676.87 5922.57,-15673.26 5843.49,-15668.39 5774.81,-15663.87"/>
<polygon fill="black" stroke="black" points="5774.97,-15660.38 5764.76,-15663.21 5774.51,-15667.36 5774.97,-15660.38"/>
</g>
<!-- O_s0_l3_tp6 -->
<g id="node216" class="node">
<title>O_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="10652.42,-15676.87 10314.42,-15676.87 10314.42,-15623.87 10652.42,-15623.87 10652.42,-15676.87"/>
<text text-anchor="middle" x="10483.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10483.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10483.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp6 -->
<g id="edge351" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M8218.01,-15740.39C8588.22,-15727.19 9298.35,-15701.42 9902.42,-15676.87 10037.07,-15671.4 10189.25,-15664.7 10304.08,-15659.54"/>
<polygon fill="black" stroke="black" points="10304.54,-15663.03 10314.37,-15659.08 10304.22,-15656.03 10304.54,-15663.03"/>
</g>
<!-- O_s0_l3_tp7 -->
<g id="node217" class="node">
<title>O_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="9893.42,-15676.87 9555.42,-15676.87 9555.42,-15623.87 9893.42,-15623.87 9893.42,-15676.87"/>
<text text-anchor="middle" x="9724.42" y="-15661.67" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9724.42" y="-15646.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9724.42" y="-15631.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l3&#45;&gt;O_s0_l3_tp7 -->
<g id="edge352" class="edge">
<title>AR_attn_s0_l3&#45;&gt;O_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M8214.22,-15738.55C8498.83,-15725.8 8977.8,-15703 9389.42,-15676.87 9440.04,-15673.66 9494.92,-15669.69 9545.33,-15665.84"/>
<polygon fill="black" stroke="black" points="9545.64,-15669.33 9555.35,-15665.08 9545.11,-15662.35 9545.64,-15669.33"/>
</g>
<!-- O_s0_l3_tp0&#45;&gt;ResAttn_s0_l3_tp0 -->
<g id="edge353" class="edge">
<title>O_s0_l3_tp0&#45;&gt;ResAttn_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7336.77,-15623.83C7288.41,-15613.76 7230.9,-15601.78 7174.13,-15589.96"/>
<polygon fill="black" stroke="black" points="7174.8,-15586.52 7164.29,-15587.91 7173.37,-15593.38 7174.8,-15586.52"/>
</g>
<!-- O_s0_l3_tp1&#45;&gt;ResAttn_s0_l3_tp1 -->
<g id="edge355" class="edge">
<title>O_s0_l3_tp1&#45;&gt;ResAttn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M6003.23,-15632.2C5841.07,-15615.73 5591.78,-15590.43 5389.41,-15569.88"/>
<polygon fill="black" stroke="black" points="5389.51,-15566.37 5379.2,-15568.84 5388.8,-15573.34 5389.51,-15566.37"/>
</g>
<!-- O_s0_l3_tp2&#45;&gt;ResAttn_s0_l3_tp2 -->
<g id="edge357" class="edge">
<title>O_s0_l3_tp2&#45;&gt;ResAttn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M6755.31,-15629.15C6634.59,-15614.71 6468.01,-15594.79 6319.79,-15577.06"/>
<polygon fill="black" stroke="black" points="6319.95,-15573.55 6309.61,-15575.84 6319.12,-15580.5 6319.95,-15573.55"/>
</g>
<!-- O_s0_l3_tp3&#45;&gt;ResAttn_s0_l3_tp3 -->
<g id="edge359" class="edge">
<title>O_s0_l3_tp3&#45;&gt;ResAttn_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8700.79,-15623.76C8732.16,-15614.01 8769.23,-15602.48 8806.04,-15591.03"/>
<polygon fill="black" stroke="black" points="8807.38,-15594.28 8815.89,-15587.97 8805.3,-15587.6 8807.38,-15594.28"/>
</g>
<!-- O_s0_l3_tp4&#45;&gt;ResAttn_s0_l3_tp4 -->
<g id="edge361" class="edge">
<title>O_s0_l3_tp4&#45;&gt;ResAttn_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M9371.2,-15623.83C9463.21,-15609.12 9580.6,-15590.36 9683.31,-15573.94"/>
<polygon fill="black" stroke="black" points="9683.88,-15577.39 9693.2,-15572.36 9682.77,-15570.48 9683.88,-15577.39"/>
</g>
<!-- O_s0_l3_tp5&#45;&gt;ResAttn_s0_l3_tp5 -->
<g id="edge363" class="edge">
<title>O_s0_l3_tp5&#45;&gt;ResAttn_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M5426.35,-15638.44C5134.13,-15619.54 4530.21,-15580.48 4157.73,-15556.39"/>
<polygon fill="black" stroke="black" points="4157.8,-15552.89 4147.6,-15555.74 4157.35,-15559.88 4157.8,-15552.89"/>
</g>
<!-- O_s0_l3_tp6&#45;&gt;ResAttn_s0_l3_tp6 -->
<g id="edge365" class="edge">
<title>O_s0_l3_tp6&#45;&gt;ResAttn_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M10652.67,-15637.92C10945.23,-15618.12 11547.53,-15577.35 11895.84,-15553.78"/>
<polygon fill="black" stroke="black" points="11896.33,-15557.26 11906.07,-15553.09 11895.85,-15550.27 11896.33,-15557.26"/>
</g>
<!-- O_s0_l3_tp7&#45;&gt;ResAttn_s0_l3_tp7 -->
<g id="edge367" class="edge">
<title>O_s0_l3_tp7&#45;&gt;ResAttn_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M9893.51,-15633.77C10101.35,-15614.59 10456.1,-15581.86 10697.66,-15559.57"/>
<polygon fill="black" stroke="black" points="10698,-15563.05 10707.64,-15558.65 10697.36,-15556.08 10698,-15563.05"/>
</g>
<!-- Gate_s0_l3_tp0 -->
<g id="node226" class="node">
<title>Gate_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7302.42,-15445.87 6964.42,-15445.87 6964.42,-15392.87 7302.42,-15392.87 7302.42,-15445.87"/>
<text text-anchor="middle" x="7133.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7133.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7133.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp0&#45;&gt;Gate_s0_l3_tp0 -->
<g id="edge369" class="edge">
<title>ResAttn_s0_l3_tp0&#45;&gt;Gate_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7014.95,-15481.77C7035.63,-15471.06 7056.74,-15460.12 7075.3,-15450.5"/>
<polygon fill="black" stroke="black" points="7076.93,-15453.6 7084.19,-15445.89 7073.7,-15447.38 7076.93,-15453.6"/>
</g>
<!-- ResMOE_s0_l3_tp0 -->
<g id="node267" class="node">
<title>ResMOE_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="8076.77,-15156.92 7519.45,-15156.92 7376.08,-15050.92 7933.4,-15050.92 8076.77,-15156.92"/>
<text text-anchor="middle" x="7726.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7726.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7726.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp0&#45;&gt;ResMOE_s0_l3_tp0 -->
<g id="edge442" class="edge">
<title>ResAttn_s0_l3_tp0&#45;&gt;ResMOE_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M6588.81,-15500.22C6505.93,-15492.89 6416.96,-15486.07 6334.42,-15481.87 5676.33,-15448.43 4026.48,-15495.56 3369.42,-15445.87 3084.38,-15424.32 2920.05,-15572.54 2732.42,-15356.87 2716.96,-15339.1 2716.06,-15320.81 2732.42,-15303.87 2896.76,-15133.76 6751.22,-15169.3 6987.42,-15156.92 7146.25,-15148.59 7324.06,-15136.18 7465.46,-15125.57"/>
<polygon fill="black" stroke="black" points="7465.87,-15129.04 7475.58,-15124.8 7465.35,-15122.06 7465.87,-15129.04"/>
</g>
<!-- Gate_s0_l3_tp1 -->
<g id="node227" class="node">
<title>Gate_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="5020.42,-15445.87 4682.42,-15445.87 4682.42,-15392.87 5020.42,-15392.87 5020.42,-15445.87"/>
<text text-anchor="middle" x="4851.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4851.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4851.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp1&#45;&gt;Gate_s0_l3_tp1 -->
<g id="edge370" class="edge">
<title>ResAttn_s0_l3_tp1&#45;&gt;Gate_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M4961.24,-15481.77C4942.42,-15471.25 4923.22,-15460.51 4906.24,-15451.02"/>
<polygon fill="black" stroke="black" points="4907.49,-15447.71 4897.05,-15445.89 4904.08,-15453.82 4907.49,-15447.71"/>
</g>
<!-- ResMOE_s0_l3_tp1 -->
<g id="node268" class="node">
<title>ResMOE_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="5502.77,-15156.92 4945.45,-15156.92 4802.08,-15050.92 5359.4,-15050.92 5502.77,-15156.92"/>
<text text-anchor="middle" x="5152.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5152.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5152.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp1&#45;&gt;ResMOE_s0_l3_tp1 -->
<g id="edge444" class="edge">
<title>ResAttn_s0_l3_tp1&#45;&gt;ResMOE_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M4744.88,-15512.25C4582.54,-15501.62 4380.32,-15489.49 4199.42,-15481.87 4156.73,-15480.08 2691.28,-15476.44 2661.42,-15445.87 2622.14,-15405.66 2622.38,-15233.36 2661.42,-15192.92 2680.44,-15173.22 4228.01,-15129.62 4874.01,-15112.26"/>
<polygon fill="black" stroke="black" points="4874.49,-15115.75 4884.4,-15111.98 4874.31,-15108.75 4874.49,-15115.75"/>
</g>
<!-- Gate_s0_l3_tp2 -->
<g id="node228" class="node">
<title>Gate_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="6144.42,-15445.87 5806.42,-15445.87 5806.42,-15392.87 6144.42,-15392.87 6144.42,-15445.87"/>
<text text-anchor="middle" x="5975.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5975.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5975.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp2&#45;&gt;Gate_s0_l3_tp2 -->
<g id="edge371" class="edge">
<title>ResAttn_s0_l3_tp2&#45;&gt;Gate_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M5975.42,-15481.77C5975.42,-15473.1 5975.42,-15464.29 5975.42,-15456.14"/>
<polygon fill="black" stroke="black" points="5978.92,-15455.89 5975.42,-15445.89 5971.92,-15455.89 5978.92,-15455.89"/>
</g>
<!-- ResMOE_s0_l3_tp2 -->
<g id="node269" class="node">
<title>ResMOE_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="6978.77,-15156.92 6421.45,-15156.92 6278.08,-15050.92 6835.4,-15050.92 6978.77,-15156.92"/>
<text text-anchor="middle" x="6628.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6628.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6628.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp2&#45;&gt;ResMOE_s0_l3_tp2 -->
<g id="edge446" class="edge">
<title>ResAttn_s0_l3_tp2&#45;&gt;ResMOE_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M5648.47,-15499.23C5571.47,-15492.29 5489.62,-15485.9 5413.42,-15481.87 5375.78,-15479.88 2725.9,-15472.71 2699.42,-15445.87 2659.94,-15405.86 2659.93,-15232.92 2699.42,-15192.92 2726.86,-15165.12 5472.38,-15158.08 5511.42,-15156.92 5801.82,-15148.3 6134.4,-15131.99 6360.62,-15119.93"/>
<polygon fill="black" stroke="black" points="6360.84,-15123.42 6370.64,-15119.39 6360.47,-15116.43 6360.84,-15123.42"/>
</g>
<!-- Gate_s0_l3_tp3 -->
<g id="node229" class="node">
<title>Gate_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8932.42,-15445.87 8594.42,-15445.87 8594.42,-15392.87 8932.42,-15392.87 8932.42,-15445.87"/>
<text text-anchor="middle" x="8763.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8763.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8763.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp3&#45;&gt;Gate_s0_l3_tp3 -->
<g id="edge372" class="edge">
<title>ResAttn_s0_l3_tp3&#45;&gt;Gate_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8882.44,-15481.77C8861.66,-15471.06 8840.46,-15460.12 8821.81,-15450.5"/>
<polygon fill="black" stroke="black" points="8823.37,-15447.36 8812.88,-15445.89 8820.16,-15453.58 8823.37,-15447.36"/>
</g>
<!-- ResMOE_s0_l3_tp3 -->
<g id="node270" class="node">
<title>ResMOE_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8925.77,-15156.92 8368.45,-15156.92 8225.08,-15050.92 8782.4,-15050.92 8925.77,-15156.92"/>
<text text-anchor="middle" x="8575.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8575.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8575.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp3&#45;&gt;ResMOE_s0_l3_tp3 -->
<g id="edge448" class="edge">
<title>ResAttn_s0_l3_tp3&#45;&gt;ResMOE_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M9225.75,-15507.9C9329.33,-15497.89 9451.67,-15487.51 9562.42,-15481.87 10220.51,-15448.38 11870.36,-15495.56 12527.42,-15445.87 12816.66,-15424 13365.04,-15513.37 13164.42,-15303.87 13127.26,-15265.07 9897.82,-15150.51 8879.44,-15115.32"/>
<polygon fill="black" stroke="black" points="8879.53,-15111.82 8869.41,-15114.97 8879.29,-15118.82 8879.53,-15111.82"/>
</g>
<!-- Gate_s0_l3_tp4 -->
<g id="node230" class="node">
<title>Gate_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="10090.42,-15445.87 9752.42,-15445.87 9752.42,-15392.87 10090.42,-15392.87 10090.42,-15445.87"/>
<text text-anchor="middle" x="9921.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9921.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9921.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp4&#45;&gt;Gate_s0_l3_tp4 -->
<g id="edge373" class="edge">
<title>ResAttn_s0_l3_tp4&#45;&gt;Gate_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M9921.42,-15481.77C9921.42,-15473.1 9921.42,-15464.29 9921.42,-15456.14"/>
<polygon fill="black" stroke="black" points="9924.92,-15455.89 9921.42,-15445.89 9917.92,-15455.89 9924.92,-15455.89"/>
</g>
<!-- ResMOE_s0_l3_tp4 -->
<g id="node271" class="node">
<title>ResMOE_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="10962.77,-15156.92 10405.45,-15156.92 10262.08,-15050.92 10819.4,-15050.92 10962.77,-15156.92"/>
<text text-anchor="middle" x="10612.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10612.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10612.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp4&#45;&gt;ResMOE_s0_l3_tp4 -->
<g id="edge450" class="edge">
<title>ResAttn_s0_l3_tp4&#45;&gt;ResMOE_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M10168.09,-15511.2C10295.56,-15500.41 10453.71,-15488.45 10595.42,-15481.87 10848.96,-15470.11 12628.27,-15482.48 12879.42,-15445.87 13024.23,-15424.77 13108.03,-15473.5 13196.42,-15356.87 13378.3,-15116.91 12151.64,-15215.96 11851.42,-15192.92 11538.75,-15168.92 11181.5,-15143.79 10931.21,-15126.56"/>
<polygon fill="black" stroke="black" points="10931.08,-15123.04 10920.86,-15125.85 10930.6,-15130.02 10931.08,-15123.04"/>
</g>
<!-- Gate_s0_l3_tp5 -->
<g id="node231" class="node">
<title>Gate_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="3716.42,-15445.87 3378.42,-15445.87 3378.42,-15392.87 3716.42,-15392.87 3716.42,-15445.87"/>
<text text-anchor="middle" x="3547.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3547.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3547.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp5&#45;&gt;Gate_s0_l3_tp5 -->
<g id="edge374" class="edge">
<title>ResAttn_s0_l3_tp5&#45;&gt;Gate_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M3705.93,-15481.77C3677.38,-15470.72 3648.22,-15459.42 3622.83,-15449.58"/>
<polygon fill="black" stroke="black" points="3623.87,-15446.24 3613.29,-15445.89 3621.35,-15452.76 3623.87,-15446.24"/>
</g>
<!-- ResMOE_s0_l3_tp5 -->
<g id="node272" class="node">
<title>ResMOE_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="3269.77,-15156.92 2712.45,-15156.92 2569.08,-15050.92 3126.4,-15050.92 3269.77,-15156.92"/>
<text text-anchor="middle" x="2919.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2919.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2919.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp5&#45;&gt;ResMOE_s0_l3_tp5 -->
<g id="edge452" class="edge">
<title>ResAttn_s0_l3_tp5&#45;&gt;ResMOE_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M3558.11,-15532.23C3222.49,-15527.37 2699.45,-15509.54 2635.42,-15445.87 2555.7,-15366.59 2563.32,-15282.39 2631.42,-15192.92 2641.9,-15179.16 2666.19,-15166.63 2696.46,-15155.62"/>
<polygon fill="black" stroke="black" points="2697.77,-15158.88 2706.04,-15152.26 2695.45,-15152.27 2697.77,-15158.88"/>
</g>
<!-- Gate_s0_l3_tp6 -->
<g id="node232" class="node">
<title>Gate_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="12518.42,-15445.87 12180.42,-15445.87 12180.42,-15392.87 12518.42,-15392.87 12518.42,-15445.87"/>
<text text-anchor="middle" x="12349.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12349.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12349.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp6&#45;&gt;Gate_s0_l3_tp6 -->
<g id="edge375" class="edge">
<title>ResAttn_s0_l3_tp6&#45;&gt;Gate_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M12247.18,-15481.77C12264.54,-15471.35 12282.25,-15460.71 12297.95,-15451.29"/>
<polygon fill="black" stroke="black" points="12300.17,-15454.04 12306.94,-15445.89 12296.56,-15448.03 12300.17,-15454.04"/>
</g>
<!-- ResMOE_s0_l3_tp6 -->
<g id="node273" class="node">
<title>ResMOE_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="13388.77,-15156.92 12831.45,-15156.92 12688.08,-15050.92 13245.4,-15050.92 13388.77,-15156.92"/>
<text text-anchor="middle" x="13038.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="13038.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13038.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp6&#45;&gt;ResMOE_s0_l3_tp6 -->
<g id="edge454" class="edge">
<title>ResAttn_s0_l3_tp6&#45;&gt;ResMOE_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M12434.27,-15531.23C12745.4,-15525.32 13217.54,-15506.35 13273.42,-15445.87 13349.72,-15363.3 13337.48,-15285.31 13273.42,-15192.92 13265.53,-15181.54 13255.98,-15171.63 13245.3,-15163"/>
<polygon fill="black" stroke="black" points="13247.41,-15160.21 13237.33,-15156.94 13243.17,-15165.78 13247.41,-15160.21"/>
</g>
<!-- Gate_s0_l3_tp7 -->
<g id="node233" class="node">
<title>Gate_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="11214.42,-15445.87 10876.42,-15445.87 10876.42,-15392.87 11214.42,-15392.87 11214.42,-15445.87"/>
<text text-anchor="middle" x="11045.42" y="-15430.67" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11045.42" y="-15415.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11045.42" y="-15400.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp7&#45;&gt;Gate_s0_l3_tp7 -->
<g id="edge376" class="edge">
<title>ResAttn_s0_l3_tp7&#45;&gt;Gate_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M10996.19,-15481.77C11003.85,-15472.23 11011.65,-15462.5 11018.71,-15453.69"/>
<polygon fill="black" stroke="black" points="11021.44,-15455.88 11024.97,-15445.89 11015.98,-15451.5 11021.44,-15455.88"/>
</g>
<!-- ResMOE_s0_l3_tp7 -->
<g id="node274" class="node">
<title>ResMOE_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="12340.77,-15156.92 11783.45,-15156.92 11640.08,-15050.92 12197.4,-15050.92 12340.77,-15156.92"/>
<text text-anchor="middle" x="11990.42" y="-15115.22" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11990.42" y="-15100.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11990.42" y="-15085.22" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l3_tp7&#45;&gt;ResMOE_s0_l3_tp7 -->
<g id="edge456" class="edge">
<title>ResAttn_s0_l3_tp7&#45;&gt;ResMOE_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M11208.19,-15516.16C11376.39,-15504.94 11602,-15490.91 11801.42,-15481.87 11938.23,-15475.68 12900.33,-15478.13 13033.42,-15445.87 13122.49,-15424.29 13170.57,-15434.41 13219.42,-15356.87 13231.98,-15336.94 13234.69,-15321.81 13219.42,-15303.87 13161.53,-15235.85 12665.95,-15172.72 12322.07,-15136.53"/>
<polygon fill="black" stroke="black" points="12322.26,-15133.03 12311.95,-15135.46 12321.53,-15139.99 12322.26,-15133.03"/>
</g>
<!-- Expert0_s0_l3_tp0 -->
<g id="node234" class="node">
<title>Expert0_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7613.42,-15356.87 7305.42,-15356.87 7305.42,-15303.87 7613.42,-15303.87 7613.42,-15356.87"/>
<text text-anchor="middle" x="7459.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="7459.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7459.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp0&#45;&gt;Expert0_s0_l3_tp0 -->
<g id="edge377" class="edge">
<title>Gate_s0_l3_tp0&#45;&gt;Expert0_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7229.03,-15392.86C7268.26,-15382.39 7313.8,-15370.23 7353.99,-15359.51"/>
<polygon fill="black" stroke="black" points="7355.06,-15362.85 7363.82,-15356.89 7353.25,-15356.08 7355.06,-15362.85"/>
</g>
<!-- Expert1_s0_l3_tp0 -->
<g id="node235" class="node">
<title>Expert1_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7939.42,-15356.87 7631.42,-15356.87 7631.42,-15303.87 7939.42,-15303.87 7939.42,-15356.87"/>
<text text-anchor="middle" x="7785.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="7785.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7785.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp0&#45;&gt;Expert1_s0_l3_tp0 -->
<g id="edge378" class="edge">
<title>Gate_s0_l3_tp0&#45;&gt;Expert1_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7302.47,-15398.38C7393.97,-15387.25 7509.22,-15372.74 7620.9,-15357.07"/>
<polygon fill="black" stroke="black" points="7621.59,-15360.51 7631.01,-15355.65 7620.62,-15353.58 7621.59,-15360.51"/>
</g>
<!-- Expert2_s0_l3_tp0 -->
<g id="node236" class="node">
<title>Expert2_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="6961.42,-15356.87 6653.42,-15356.87 6653.42,-15303.87 6961.42,-15303.87 6961.42,-15356.87"/>
<text text-anchor="middle" x="6807.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="6807.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6807.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp0&#45;&gt;Expert2_s0_l3_tp0 -->
<g id="edge379" class="edge">
<title>Gate_s0_l3_tp0&#45;&gt;Expert2_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7037.81,-15392.86C6998.59,-15382.39 6953.04,-15370.23 6912.85,-15359.51"/>
<polygon fill="black" stroke="black" points="6913.59,-15356.08 6903.03,-15356.89 6911.79,-15362.85 6913.59,-15356.08"/>
</g>
<!-- Expert3_s0_l3_tp0 -->
<g id="node237" class="node">
<title>Expert3_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="7287.42,-15356.87 6979.42,-15356.87 6979.42,-15303.87 7287.42,-15303.87 7287.42,-15356.87"/>
<text text-anchor="middle" x="7133.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="7133.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7133.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp0&#45;&gt;Expert3_s0_l3_tp0 -->
<g id="edge380" class="edge">
<title>Gate_s0_l3_tp0&#45;&gt;Expert3_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7133.42,-15392.74C7133.42,-15384.76 7133.42,-15375.8 7133.42,-15367.26"/>
<polygon fill="black" stroke="black" points="7136.92,-15367.12 7133.42,-15357.12 7129.92,-15367.12 7136.92,-15367.12"/>
</g>
<!-- Expert4_s0_l3_tp1 -->
<g id="node238" class="node">
<title>Expert4_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="5005.42,-15356.87 4697.42,-15356.87 4697.42,-15303.87 5005.42,-15303.87 5005.42,-15356.87"/>
<text text-anchor="middle" x="4851.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="4851.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4851.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp1&#45;&gt;Expert4_s0_l3_tp1 -->
<g id="edge381" class="edge">
<title>Gate_s0_l3_tp1&#45;&gt;Expert4_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4851.42,-15392.74C4851.42,-15384.76 4851.42,-15375.8 4851.42,-15367.26"/>
<polygon fill="black" stroke="black" points="4854.92,-15367.12 4851.42,-15357.12 4847.92,-15367.12 4854.92,-15367.12"/>
</g>
<!-- Expert5_s0_l3_tp1 -->
<g id="node239" class="node">
<title>Expert5_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="5331.42,-15356.87 5023.42,-15356.87 5023.42,-15303.87 5331.42,-15303.87 5331.42,-15356.87"/>
<text text-anchor="middle" x="5177.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="5177.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5177.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp1&#45;&gt;Expert5_s0_l3_tp1 -->
<g id="edge382" class="edge">
<title>Gate_s0_l3_tp1&#45;&gt;Expert5_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4947.03,-15392.86C4986.26,-15382.39 5031.8,-15370.23 5071.99,-15359.51"/>
<polygon fill="black" stroke="black" points="5073.06,-15362.85 5081.82,-15356.89 5071.25,-15356.08 5073.06,-15362.85"/>
</g>
<!-- Expert6_s0_l3_tp1 -->
<g id="node240" class="node">
<title>Expert6_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="4353.42,-15356.87 4045.42,-15356.87 4045.42,-15303.87 4353.42,-15303.87 4353.42,-15356.87"/>
<text text-anchor="middle" x="4199.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="4199.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4199.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp1&#45;&gt;Expert6_s0_l3_tp1 -->
<g id="edge383" class="edge">
<title>Gate_s0_l3_tp1&#45;&gt;Expert6_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4682.37,-15398.38C4590.87,-15387.25 4475.63,-15372.74 4363.94,-15357.07"/>
<polygon fill="black" stroke="black" points="4364.23,-15353.58 4353.84,-15355.65 4363.25,-15360.51 4364.23,-15353.58"/>
</g>
<!-- Expert7_s0_l3_tp1 -->
<g id="node241" class="node">
<title>Expert7_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="4679.42,-15356.87 4371.42,-15356.87 4371.42,-15303.87 4679.42,-15303.87 4679.42,-15356.87"/>
<text text-anchor="middle" x="4525.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="4525.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4525.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp1&#45;&gt;Expert7_s0_l3_tp1 -->
<g id="edge384" class="edge">
<title>Gate_s0_l3_tp1&#45;&gt;Expert7_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4755.81,-15392.86C4716.59,-15382.39 4671.04,-15370.23 4630.85,-15359.51"/>
<polygon fill="black" stroke="black" points="4631.59,-15356.08 4621.03,-15356.89 4629.79,-15362.85 4631.59,-15356.08"/>
</g>
<!-- Expert8_s0_l3_tp2 -->
<g id="node242" class="node">
<title>Expert8_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="6635.42,-15356.87 6327.42,-15356.87 6327.42,-15303.87 6635.42,-15303.87 6635.42,-15356.87"/>
<text text-anchor="middle" x="6481.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="6481.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6481.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp2&#45;&gt;Expert8_s0_l3_tp2 -->
<g id="edge385" class="edge">
<title>Gate_s0_l3_tp2&#45;&gt;Expert8_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6123.82,-15392.86C6186.38,-15382.1 6259.29,-15369.57 6322.9,-15358.63"/>
<polygon fill="black" stroke="black" points="6323.77,-15362.03 6333.03,-15356.89 6322.58,-15355.13 6323.77,-15362.03"/>
</g>
<!-- Expert9_s0_l3_tp2 -->
<g id="node243" class="node">
<title>Expert9_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="5657.42,-15356.87 5349.42,-15356.87 5349.42,-15303.87 5657.42,-15303.87 5657.42,-15356.87"/>
<text text-anchor="middle" x="5503.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="5503.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5503.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp2&#45;&gt;Expert9_s0_l3_tp2 -->
<g id="edge386" class="edge">
<title>Gate_s0_l3_tp2&#45;&gt;Expert9_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5837,-15392.86C5778.88,-15382.15 5711.19,-15369.67 5652.03,-15358.76"/>
<polygon fill="black" stroke="black" points="5652.32,-15355.26 5641.85,-15356.89 5651.05,-15362.14 5652.32,-15355.26"/>
</g>
<!-- Expert10_s0_l3_tp2 -->
<g id="node244" class="node">
<title>Expert10_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="5983.42,-15356.87 5675.42,-15356.87 5675.42,-15303.87 5983.42,-15303.87 5983.42,-15356.87"/>
<text text-anchor="middle" x="5829.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="5829.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5829.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp2&#45;&gt;Expert10_s0_l3_tp2 -->
<g id="edge387" class="edge">
<title>Gate_s0_l3_tp2&#45;&gt;Expert10_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5932.41,-15392.74C5916.29,-15383.14 5897.81,-15372.13 5881,-15362.11"/>
<polygon fill="black" stroke="black" points="5882.76,-15359.08 5872.38,-15356.97 5879.18,-15365.1 5882.76,-15359.08"/>
</g>
<!-- Expert11_s0_l3_tp2 -->
<g id="node245" class="node">
<title>Expert11_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="6309.42,-15356.87 6001.42,-15356.87 6001.42,-15303.87 6309.42,-15303.87 6309.42,-15356.87"/>
<text text-anchor="middle" x="6155.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="6155.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6155.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp2&#45;&gt;Expert11_s0_l3_tp2 -->
<g id="edge388" class="edge">
<title>Gate_s0_l3_tp2&#45;&gt;Expert11_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6028.45,-15392.74C6048.78,-15382.92 6072.15,-15371.62 6093.25,-15361.42"/>
<polygon fill="black" stroke="black" points="6094.98,-15364.48 6102.46,-15356.97 6091.93,-15358.17 6094.98,-15364.48"/>
</g>
<!-- Expert12_s0_l3_tp3 -->
<g id="node246" class="node">
<title>Expert12_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8265.42,-15356.87 7957.42,-15356.87 7957.42,-15303.87 8265.42,-15303.87 8265.42,-15356.87"/>
<text text-anchor="middle" x="8111.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="8111.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8111.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp3&#45;&gt;Expert12_s0_l3_tp3 -->
<g id="edge389" class="edge">
<title>Gate_s0_l3_tp3&#45;&gt;Expert12_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8594.37,-15398.38C8502.87,-15387.25 8387.63,-15372.74 8275.94,-15357.07"/>
<polygon fill="black" stroke="black" points="8276.23,-15353.58 8265.84,-15355.65 8275.25,-15360.51 8276.23,-15353.58"/>
</g>
<!-- Expert13_s0_l3_tp3 -->
<g id="node247" class="node">
<title>Expert13_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8591.42,-15356.87 8283.42,-15356.87 8283.42,-15303.87 8591.42,-15303.87 8591.42,-15356.87"/>
<text text-anchor="middle" x="8437.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="8437.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8437.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp3&#45;&gt;Expert13_s0_l3_tp3 -->
<g id="edge390" class="edge">
<title>Gate_s0_l3_tp3&#45;&gt;Expert13_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8667.81,-15392.86C8628.59,-15382.39 8583.04,-15370.23 8542.85,-15359.51"/>
<polygon fill="black" stroke="black" points="8543.59,-15356.08 8533.03,-15356.89 8541.79,-15362.85 8543.59,-15356.08"/>
</g>
<!-- Expert14_s0_l3_tp3 -->
<g id="node248" class="node">
<title>Expert14_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="8917.42,-15356.87 8609.42,-15356.87 8609.42,-15303.87 8917.42,-15303.87 8917.42,-15356.87"/>
<text text-anchor="middle" x="8763.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="8763.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8763.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp3&#45;&gt;Expert14_s0_l3_tp3 -->
<g id="edge391" class="edge">
<title>Gate_s0_l3_tp3&#45;&gt;Expert14_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8763.42,-15392.74C8763.42,-15384.76 8763.42,-15375.8 8763.42,-15367.26"/>
<polygon fill="black" stroke="black" points="8766.92,-15367.12 8763.42,-15357.12 8759.92,-15367.12 8766.92,-15367.12"/>
</g>
<!-- Expert15_s0_l3_tp3 -->
<g id="node249" class="node">
<title>Expert15_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="9243.42,-15356.87 8935.42,-15356.87 8935.42,-15303.87 9243.42,-15303.87 9243.42,-15356.87"/>
<text text-anchor="middle" x="9089.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="9089.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9089.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp3&#45;&gt;Expert15_s0_l3_tp3 -->
<g id="edge392" class="edge">
<title>Gate_s0_l3_tp3&#45;&gt;Expert15_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8859.03,-15392.86C8898.26,-15382.39 8943.8,-15370.23 8983.99,-15359.51"/>
<polygon fill="black" stroke="black" points="8985.06,-15362.85 8993.82,-15356.89 8983.25,-15356.08 8985.06,-15362.85"/>
</g>
<!-- Expert16_s0_l3_tp4 -->
<g id="node250" class="node">
<title>Expert16_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="9569.42,-15356.87 9261.42,-15356.87 9261.42,-15303.87 9569.42,-15303.87 9569.42,-15356.87"/>
<text text-anchor="middle" x="9415.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="9415.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9415.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp4&#45;&gt;Expert16_s0_l3_tp4 -->
<g id="edge393" class="edge">
<title>Gate_s0_l3_tp4&#45;&gt;Expert16_s0_l3_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9773.02,-15392.86C9710.47,-15382.1 9637.55,-15369.57 9573.94,-15358.63"/>
<polygon fill="black" stroke="black" points="9574.27,-15355.13 9563.82,-15356.89 9573.08,-15362.03 9574.27,-15355.13"/>
</g>
<!-- Expert17_s0_l3_tp4 -->
<g id="node251" class="node">
<title>Expert17_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="9895.42,-15356.87 9587.42,-15356.87 9587.42,-15303.87 9895.42,-15303.87 9895.42,-15356.87"/>
<text text-anchor="middle" x="9741.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="9741.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9741.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp4&#45;&gt;Expert17_s0_l3_tp4 -->
<g id="edge394" class="edge">
<title>Gate_s0_l3_tp4&#45;&gt;Expert17_s0_l3_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9868.39,-15392.74C9848.06,-15382.92 9824.7,-15371.62 9803.59,-15361.42"/>
<polygon fill="black" stroke="black" points="9804.91,-15358.17 9794.39,-15356.97 9801.87,-15364.48 9804.91,-15358.17"/>
</g>
<!-- Expert18_s0_l3_tp4 -->
<g id="node252" class="node">
<title>Expert18_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="10221.42,-15356.87 9913.42,-15356.87 9913.42,-15303.87 10221.42,-15303.87 10221.42,-15356.87"/>
<text text-anchor="middle" x="10067.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="10067.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10067.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp4&#45;&gt;Expert18_s0_l3_tp4 -->
<g id="edge395" class="edge">
<title>Gate_s0_l3_tp4&#45;&gt;Expert18_s0_l3_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9964.44,-15392.74C9980.55,-15383.14 9999.03,-15372.13 10015.84,-15362.11"/>
<polygon fill="black" stroke="black" points="10017.66,-15365.1 10024.46,-15356.97 10014.08,-15359.08 10017.66,-15365.1"/>
</g>
<!-- Expert19_s0_l3_tp4 -->
<g id="node253" class="node">
<title>Expert19_s0_l3_tp4</title>
<polygon fill="none" stroke="black" points="10547.42,-15356.87 10239.42,-15356.87 10239.42,-15303.87 10547.42,-15303.87 10547.42,-15356.87"/>
<text text-anchor="middle" x="10393.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="10393.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10393.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp4&#45;&gt;Expert19_s0_l3_tp4 -->
<g id="edge396" class="edge">
<title>Gate_s0_l3_tp4&#45;&gt;Expert19_s0_l3_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10059.85,-15392.86C10117.96,-15382.15 10185.66,-15369.67 10244.82,-15358.76"/>
<polygon fill="black" stroke="black" points="10245.8,-15362.14 10255,-15356.89 10244.53,-15355.26 10245.8,-15362.14"/>
</g>
<!-- Expert20_s0_l3_tp5 -->
<g id="node254" class="node">
<title>Expert20_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="3049.42,-15356.87 2741.42,-15356.87 2741.42,-15303.87 3049.42,-15303.87 3049.42,-15356.87"/>
<text text-anchor="middle" x="2895.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="2895.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2895.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp5&#45;&gt;Expert20_s0_l3_tp5 -->
<g id="edge397" class="edge">
<title>Gate_s0_l3_tp5&#45;&gt;Expert20_s0_l3_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3378.37,-15398.38C3286.87,-15387.25 3171.63,-15372.74 3059.94,-15357.07"/>
<polygon fill="black" stroke="black" points="3060.23,-15353.58 3049.84,-15355.65 3059.25,-15360.51 3060.23,-15353.58"/>
</g>
<!-- Expert21_s0_l3_tp5 -->
<g id="node255" class="node">
<title>Expert21_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="3375.42,-15356.87 3067.42,-15356.87 3067.42,-15303.87 3375.42,-15303.87 3375.42,-15356.87"/>
<text text-anchor="middle" x="3221.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="3221.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3221.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp5&#45;&gt;Expert21_s0_l3_tp5 -->
<g id="edge398" class="edge">
<title>Gate_s0_l3_tp5&#45;&gt;Expert21_s0_l3_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3451.81,-15392.86C3412.59,-15382.39 3367.04,-15370.23 3326.85,-15359.51"/>
<polygon fill="black" stroke="black" points="3327.59,-15356.08 3317.03,-15356.89 3325.79,-15362.85 3327.59,-15356.08"/>
</g>
<!-- Expert22_s0_l3_tp5 -->
<g id="node256" class="node">
<title>Expert22_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="3701.42,-15356.87 3393.42,-15356.87 3393.42,-15303.87 3701.42,-15303.87 3701.42,-15356.87"/>
<text text-anchor="middle" x="3547.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="3547.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3547.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp5&#45;&gt;Expert22_s0_l3_tp5 -->
<g id="edge399" class="edge">
<title>Gate_s0_l3_tp5&#45;&gt;Expert22_s0_l3_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3547.42,-15392.74C3547.42,-15384.76 3547.42,-15375.8 3547.42,-15367.26"/>
<polygon fill="black" stroke="black" points="3550.92,-15367.12 3547.42,-15357.12 3543.92,-15367.12 3550.92,-15367.12"/>
</g>
<!-- Expert23_s0_l3_tp5 -->
<g id="node257" class="node">
<title>Expert23_s0_l3_tp5</title>
<polygon fill="none" stroke="black" points="4027.42,-15356.87 3719.42,-15356.87 3719.42,-15303.87 4027.42,-15303.87 4027.42,-15356.87"/>
<text text-anchor="middle" x="3873.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="3873.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3873.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp5&#45;&gt;Expert23_s0_l3_tp5 -->
<g id="edge400" class="edge">
<title>Gate_s0_l3_tp5&#45;&gt;Expert23_s0_l3_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3643.03,-15392.86C3682.26,-15382.39 3727.8,-15370.23 3767.99,-15359.51"/>
<polygon fill="black" stroke="black" points="3769.06,-15362.85 3777.82,-15356.89 3767.25,-15356.08 3769.06,-15362.85"/>
</g>
<!-- Expert24_s0_l3_tp6 -->
<g id="node258" class="node">
<title>Expert24_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="12177.42,-15356.87 11869.42,-15356.87 11869.42,-15303.87 12177.42,-15303.87 12177.42,-15356.87"/>
<text text-anchor="middle" x="12023.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="12023.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12023.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp6&#45;&gt;Expert24_s0_l3_tp6 -->
<g id="edge401" class="edge">
<title>Gate_s0_l3_tp6&#45;&gt;Expert24_s0_l3_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12253.81,-15392.86C12214.59,-15382.39 12169.04,-15370.23 12128.85,-15359.51"/>
<polygon fill="black" stroke="black" points="12129.59,-15356.08 12119.03,-15356.89 12127.79,-15362.85 12129.59,-15356.08"/>
</g>
<!-- Expert25_s0_l3_tp6 -->
<g id="node259" class="node">
<title>Expert25_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="12503.42,-15356.87 12195.42,-15356.87 12195.42,-15303.87 12503.42,-15303.87 12503.42,-15356.87"/>
<text text-anchor="middle" x="12349.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="12349.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12349.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp6&#45;&gt;Expert25_s0_l3_tp6 -->
<g id="edge402" class="edge">
<title>Gate_s0_l3_tp6&#45;&gt;Expert25_s0_l3_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12349.42,-15392.74C12349.42,-15384.76 12349.42,-15375.8 12349.42,-15367.26"/>
<polygon fill="black" stroke="black" points="12352.92,-15367.12 12349.42,-15357.12 12345.92,-15367.12 12352.92,-15367.12"/>
</g>
<!-- Expert26_s0_l3_tp6 -->
<g id="node260" class="node">
<title>Expert26_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="12829.42,-15356.87 12521.42,-15356.87 12521.42,-15303.87 12829.42,-15303.87 12829.42,-15356.87"/>
<text text-anchor="middle" x="12675.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="12675.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12675.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp6&#45;&gt;Expert26_s0_l3_tp6 -->
<g id="edge403" class="edge">
<title>Gate_s0_l3_tp6&#45;&gt;Expert26_s0_l3_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12445.03,-15392.86C12484.26,-15382.39 12529.8,-15370.23 12569.99,-15359.51"/>
<polygon fill="black" stroke="black" points="12571.06,-15362.85 12579.82,-15356.89 12569.25,-15356.08 12571.06,-15362.85"/>
</g>
<!-- Expert27_s0_l3_tp6 -->
<g id="node261" class="node">
<title>Expert27_s0_l3_tp6</title>
<polygon fill="none" stroke="black" points="13155.42,-15356.87 12847.42,-15356.87 12847.42,-15303.87 13155.42,-15303.87 13155.42,-15356.87"/>
<text text-anchor="middle" x="13001.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="13001.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13001.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp6&#45;&gt;Expert27_s0_l3_tp6 -->
<g id="edge404" class="edge">
<title>Gate_s0_l3_tp6&#45;&gt;Expert27_s0_l3_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12518.47,-15398.38C12609.97,-15387.25 12725.22,-15372.74 12836.9,-15357.07"/>
<polygon fill="black" stroke="black" points="12837.59,-15360.51 12847.01,-15355.65 12836.62,-15353.58 12837.59,-15360.51"/>
</g>
<!-- Expert28_s0_l3_tp7 -->
<g id="node262" class="node">
<title>Expert28_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="10873.42,-15356.87 10565.42,-15356.87 10565.42,-15303.87 10873.42,-15303.87 10873.42,-15356.87"/>
<text text-anchor="middle" x="10719.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="10719.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10719.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp7&#45;&gt;Expert28_s0_l3_tp7 -->
<g id="edge405" class="edge">
<title>Gate_s0_l3_tp7&#45;&gt;Expert28_s0_l3_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10949.81,-15392.86C10910.59,-15382.39 10865.04,-15370.23 10824.85,-15359.51"/>
<polygon fill="black" stroke="black" points="10825.59,-15356.08 10815.03,-15356.89 10823.79,-15362.85 10825.59,-15356.08"/>
</g>
<!-- Expert29_s0_l3_tp7 -->
<g id="node263" class="node">
<title>Expert29_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="11199.42,-15356.87 10891.42,-15356.87 10891.42,-15303.87 11199.42,-15303.87 11199.42,-15356.87"/>
<text text-anchor="middle" x="11045.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="11045.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11045.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp7&#45;&gt;Expert29_s0_l3_tp7 -->
<g id="edge406" class="edge">
<title>Gate_s0_l3_tp7&#45;&gt;Expert29_s0_l3_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11045.42,-15392.74C11045.42,-15384.76 11045.42,-15375.8 11045.42,-15367.26"/>
<polygon fill="black" stroke="black" points="11048.92,-15367.12 11045.42,-15357.12 11041.92,-15367.12 11048.92,-15367.12"/>
</g>
<!-- Expert30_s0_l3_tp7 -->
<g id="node264" class="node">
<title>Expert30_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="11525.42,-15356.87 11217.42,-15356.87 11217.42,-15303.87 11525.42,-15303.87 11525.42,-15356.87"/>
<text text-anchor="middle" x="11371.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="11371.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11371.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp7&#45;&gt;Expert30_s0_l3_tp7 -->
<g id="edge407" class="edge">
<title>Gate_s0_l3_tp7&#45;&gt;Expert30_s0_l3_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11141.03,-15392.86C11180.26,-15382.39 11225.8,-15370.23 11265.99,-15359.51"/>
<polygon fill="black" stroke="black" points="11267.06,-15362.85 11275.82,-15356.89 11265.25,-15356.08 11267.06,-15362.85"/>
</g>
<!-- Expert31_s0_l3_tp7 -->
<g id="node265" class="node">
<title>Expert31_s0_l3_tp7</title>
<polygon fill="none" stroke="black" points="11851.42,-15356.87 11543.42,-15356.87 11543.42,-15303.87 11851.42,-15303.87 11851.42,-15356.87"/>
<text text-anchor="middle" x="11697.42" y="-15341.67" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="11697.42" y="-15326.67" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11697.42" y="-15311.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l3_tp7&#45;&gt;Expert31_s0_l3_tp7 -->
<g id="edge408" class="edge">
<title>Gate_s0_l3_tp7&#45;&gt;Expert31_s0_l3_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11214.47,-15398.38C11305.97,-15387.25 11421.22,-15372.74 11532.9,-15357.07"/>
<polygon fill="black" stroke="black" points="11533.59,-15360.51 11543.01,-15355.65 11532.62,-15353.58 11533.59,-15360.51"/>
</g>
<!-- AR_exp_s0_l3 -->
<g id="node266" class="node">
<title>AR_exp_s0_l3</title>
<ellipse fill="none" stroke="black" cx="7915.42" cy="-15230.4" rx="239" ry="37.45"/>
<text text-anchor="middle" x="7915.42" y="-15241.7" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="7915.42" y="-15226.7" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7915.42" y="-15211.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l3_tp0&#45;&gt;AR_exp_s0_l3 -->
<g id="edge409" class="edge">
<title>Expert0_s0_l3_tp0&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M7578.34,-15303.82C7636.08,-15291.42 7706.04,-15276.38 7767.22,-15263.24"/>
<polygon fill="black" stroke="black" points="7768.31,-15266.58 7777.35,-15261.06 7766.84,-15259.74 7768.31,-15266.58"/>
</g>
<!-- Expert1_s0_l3_tp0&#45;&gt;AR_exp_s0_l3 -->
<g id="edge410" class="edge">
<title>Expert1_s0_l3_tp0&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M7819.58,-15303.63C7831.79,-15294.43 7845.89,-15283.8 7859.46,-15273.58"/>
<polygon fill="black" stroke="black" points="7861.93,-15276.09 7867.81,-15267.28 7857.72,-15270.5 7861.93,-15276.09"/>
</g>
<!-- Expert2_s0_l3_tp0&#45;&gt;AR_exp_s0_l3 -->
<g id="edge411" class="edge">
<title>Expert2_s0_l3_tp0&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M6961.81,-15304.9C6964.71,-15304.55 6967.58,-15304.2 6970.42,-15303.87 7212.08,-15275.75 7489.82,-15255.93 7681.35,-15244.21"/>
<polygon fill="black" stroke="black" points="7681.78,-15247.69 7691.55,-15243.59 7681.36,-15240.71 7681.78,-15247.69"/>
</g>
<!-- Expert3_s0_l3_tp0&#45;&gt;AR_exp_s0_l3 -->
<g id="edge412" class="edge">
<title>Expert3_s0_l3_tp0&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M7287.83,-15305.06C7290.72,-15304.66 7293.58,-15304.26 7296.42,-15303.87 7434.32,-15285.02 7589.92,-15266.81 7710.62,-15253.37"/>
<polygon fill="black" stroke="black" points="7711.17,-15256.83 7720.72,-15252.24 7710.39,-15249.87 7711.17,-15256.83"/>
</g>
<!-- Expert4_s0_l3_tp1&#45;&gt;AR_exp_s0_l3 -->
<g id="edge413" class="edge">
<title>Expert4_s0_l3_tp1&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M5005.79,-15304.7C5008.69,-15304.41 5011.57,-15304.13 5014.42,-15303.87 5525.84,-15257.68 7062.22,-15239.1 7666.97,-15233.44"/>
<polygon fill="black" stroke="black" points="7667.16,-15236.94 7677.13,-15233.35 7667.09,-15229.94 7667.16,-15236.94"/>
</g>
<!-- Expert5_s0_l3_tp1&#45;&gt;AR_exp_s0_l3 -->
<g id="edge414" class="edge">
<title>Expert5_s0_l3_tp1&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M5331.79,-15304.71C5334.69,-15304.42 5337.57,-15304.14 5340.42,-15303.87 5786.79,-15262.84 7112.95,-15241.63 7667.41,-15234.36"/>
<polygon fill="black" stroke="black" points="7667.58,-15237.85 7677.54,-15234.22 7667.49,-15230.86 7667.58,-15237.85"/>
</g>
<!-- Expert6_s0_l3_tp1&#45;&gt;AR_exp_s0_l3 -->
<g id="edge415" class="edge">
<title>Expert6_s0_l3_tp1&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M4353.79,-15304.68C4356.69,-15304.39 4359.57,-15304.12 4362.42,-15303.87 5005.07,-15247.31 6968.83,-15234.79 7666.37,-15232.11"/>
<polygon fill="black" stroke="black" points="7666.55,-15235.61 7676.54,-15232.07 7666.53,-15228.61 7666.55,-15235.61"/>
</g>
<!-- Expert7_s0_l3_tp1&#45;&gt;AR_exp_s0_l3 -->
<g id="edge416" class="edge">
<title>Expert7_s0_l3_tp1&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M4679.79,-15304.69C4682.69,-15304.4 4685.57,-15304.13 4688.42,-15303.87 5265.2,-15252.51 7013.8,-15236.84 7666.34,-15232.71"/>
<polygon fill="black" stroke="black" points="7666.83,-15236.21 7676.81,-15232.65 7666.79,-15229.21 7666.83,-15236.21"/>
</g>
<!-- Expert8_s0_l3_tp2&#45;&gt;AR_exp_s0_l3 -->
<g id="edge417" class="edge">
<title>Expert8_s0_l3_tp2&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M6635.81,-15304.83C6638.7,-15304.49 6641.57,-15304.18 6644.42,-15303.87 7000.37,-15265.97 7414.66,-15247.02 7671,-15238.21"/>
<polygon fill="black" stroke="black" points="7671.31,-15241.7 7681.19,-15237.86 7671.08,-15234.7 7671.31,-15241.7"/>
</g>
<!-- Expert9_s0_l3_tp2&#45;&gt;AR_exp_s0_l3 -->
<g id="edge418" class="edge">
<title>Expert9_s0_l3_tp2&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M5657.8,-15304.73C5660.69,-15304.43 5663.57,-15304.14 5666.42,-15303.87 6048.24,-15267.99 7167.24,-15244.52 7668.1,-15235.52"/>
<polygon fill="black" stroke="black" points="7668.42,-15239.02 7678.35,-15235.34 7668.29,-15232.02 7668.42,-15239.02"/>
</g>
<!-- Expert10_s0_l3_tp2&#45;&gt;AR_exp_s0_l3 -->
<g id="edge419" class="edge">
<title>Expert10_s0_l3_tp2&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M5983.8,-15304.75C5986.69,-15304.44 5989.57,-15304.15 5992.42,-15303.87 6591.21,-15245.95 7299.03,-15233.66 7666.26,-15231.46"/>
<polygon fill="black" stroke="black" points="7666.51,-15234.95 7676.49,-15231.4 7666.47,-15227.95 7666.51,-15234.95"/>
</g>
<!-- Expert11_s0_l3_tp2&#45;&gt;AR_exp_s0_l3 -->
<g id="edge420" class="edge">
<title>Expert11_s0_l3_tp2&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M6309.8,-15304.78C6312.7,-15304.46 6315.57,-15304.16 6318.42,-15303.87 6794.1,-15256.02 7352.69,-15239.75 7667.24,-15234.23"/>
<polygon fill="black" stroke="black" points="7667.47,-15237.72 7677.4,-15234.05 7667.35,-15230.72 7667.47,-15237.72"/>
</g>
<!-- Expert12_s0_l3_tp3&#45;&gt;AR_exp_s0_l3 -->
<g id="edge421" class="edge">
<title>Expert12_s0_l3_tp3&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M8060.18,-15303.76C8040.04,-15293.69 8016.47,-15281.91 7994.26,-15270.8"/>
<polygon fill="black" stroke="black" points="7995.68,-15267.6 7985.17,-15266.26 7992.55,-15273.86 7995.68,-15267.6"/>
</g>
<!-- Expert13_s0_l3_tp3&#45;&gt;AR_exp_s0_l3 -->
<g id="edge422" class="edge">
<title>Expert13_s0_l3_tp3&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M8301.3,-15303.82C8232.2,-15290.85 8147.82,-15275.02 8075.61,-15261.46"/>
<polygon fill="black" stroke="black" points="8075.98,-15257.97 8065.51,-15259.57 8074.69,-15264.85 8075.98,-15257.97"/>
</g>
<!-- Expert14_s0_l3_tp3&#45;&gt;AR_exp_s0_l3 -->
<g id="edge423" class="edge">
<title>Expert14_s0_l3_tp3&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M8609.02,-15305.02C8606.13,-15304.63 8603.26,-15304.25 8600.42,-15303.87 8442.67,-15283.2 8263.87,-15264.44 8128.51,-15251.19"/>
<polygon fill="black" stroke="black" points="8128.72,-15247.69 8118.43,-15250.2 8128.04,-15254.66 8128.72,-15247.69"/>
</g>
<!-- Expert15_s0_l3_tp3&#45;&gt;AR_exp_s0_l3 -->
<g id="edge424" class="edge">
<title>Expert15_s0_l3_tp3&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M8935.03,-15304.88C8932.14,-15304.53 8929.27,-15304.2 8926.42,-15303.87 8662.15,-15273.78 8357.51,-15253.96 8152.29,-15242.77"/>
<polygon fill="black" stroke="black" points="8152.46,-15239.27 8142.29,-15242.22 8152.08,-15246.26 8152.46,-15239.27"/>
</g>
<!-- Expert16_s0_l3_tp4&#45;&gt;AR_exp_s0_l3 -->
<g id="edge425" class="edge">
<title>Expert16_s0_l3_tp4&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M9261.04,-15304.82C9258.15,-15304.49 9255.27,-15304.17 9252.42,-15303.87 8872.67,-15263.98 8429.79,-15245.44 8161.14,-15237.28"/>
<polygon fill="black" stroke="black" points="8160.97,-15233.77 8150.87,-15236.97 8160.76,-15240.77 8160.97,-15233.77"/>
</g>
<!-- Expert17_s0_l3_tp4&#45;&gt;AR_exp_s0_l3 -->
<g id="edge426" class="edge">
<title>Expert17_s0_l3_tp4&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M9587.04,-15304.77C9584.15,-15304.46 9581.27,-15304.16 9578.42,-15303.87 9078.03,-15253.99 8489.55,-15238.43 8163.92,-15233.59"/>
<polygon fill="black" stroke="black" points="8163.94,-15230.09 8153.89,-15233.44 8163.83,-15237.08 8163.94,-15230.09"/>
</g>
<!-- Expert18_s0_l3_tp4&#45;&gt;AR_exp_s0_l3 -->
<g id="edge427" class="edge">
<title>Expert18_s0_l3_tp4&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M9913.05,-15304.75C9910.15,-15304.44 9907.27,-15304.15 9904.42,-15303.87 9280.45,-15243.91 8542.02,-15232.54 8164.68,-15231"/>
<polygon fill="black" stroke="black" points="8164.47,-15227.5 8154.45,-15230.96 8164.44,-15234.5 8164.47,-15227.5"/>
</g>
<!-- Expert19_s0_l3_tp4&#45;&gt;AR_exp_s0_l3 -->
<g id="edge428" class="edge">
<title>Expert19_s0_l3_tp4&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M10239.05,-15304.73C10236.15,-15304.42 10233.27,-15304.14 10230.42,-15303.87 9835.56,-15266.95 8674.77,-15243.9 8162.82,-15235.26"/>
<polygon fill="black" stroke="black" points="8162.77,-15231.76 8152.71,-15235.09 8162.65,-15238.76 8162.77,-15231.76"/>
</g>
<!-- Expert20_s0_l3_tp5&#45;&gt;AR_exp_s0_l3 -->
<g id="edge429" class="edge">
<title>Expert20_s0_l3_tp5&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M3049.79,-15304.66C3052.69,-15304.38 3055.57,-15304.12 3058.42,-15303.87 3518.03,-15264.69 6739.69,-15239.54 7666.54,-15233.06"/>
<polygon fill="black" stroke="black" points="7666.69,-15236.56 7676.66,-15232.99 7666.64,-15229.56 7666.69,-15236.56"/>
</g>
<!-- Expert21_s0_l3_tp5&#45;&gt;AR_exp_s0_l3 -->
<g id="edge430" class="edge">
<title>Expert21_s0_l3_tp5&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M3375.79,-15304.66C3378.69,-15304.38 3381.57,-15304.12 3384.42,-15303.87 4226.13,-15231.66 6844.39,-15229.6 7666.1,-15230.81"/>
<polygon fill="black" stroke="black" points="7666.27,-15234.31 7676.28,-15230.83 7666.28,-15227.31 7666.27,-15234.31"/>
</g>
<!-- Expert22_s0_l3_tp5&#45;&gt;AR_exp_s0_l3 -->
<g id="edge431" class="edge">
<title>Expert22_s0_l3_tp5&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M3701.79,-15304.67C3704.69,-15304.39 3707.57,-15304.12 3710.42,-15303.87 4485.47,-15236.89 6883.74,-15231.2 7665.94,-15231.18"/>
<polygon fill="black" stroke="black" points="7666.2,-15234.68 7676.2,-15231.18 7666.2,-15227.68 7666.2,-15234.68"/>
</g>
<!-- Expert23_s0_l3_tp5&#45;&gt;AR_exp_s0_l3 -->
<g id="edge432" class="edge">
<title>Expert23_s0_l3_tp5&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M4027.79,-15304.68C4030.69,-15304.39 4033.57,-15304.12 4036.42,-15303.87 4745.13,-15242.11 6925.28,-15232.93 7666.08,-15231.6"/>
<polygon fill="black" stroke="black" points="7666.35,-15235.1 7676.34,-15231.59 7666.34,-15228.1 7666.35,-15235.1"/>
</g>
<!-- Expert24_s0_l3_tp6&#45;&gt;AR_exp_s0_l3 -->
<g id="edge433" class="edge">
<title>Expert24_s0_l3_tp6&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M11869.05,-15304.67C11866.16,-15304.39 11863.28,-15304.12 11860.42,-15303.87 11138.29,-15241.05 8914.02,-15232.57 8164.75,-15231.51"/>
<polygon fill="black" stroke="black" points="8164.65,-15228.01 8154.64,-15231.5 8164.64,-15235.01 8164.65,-15228.01"/>
</g>
<!-- Expert25_s0_l3_tp6&#45;&gt;AR_exp_s0_l3 -->
<g id="edge434" class="edge">
<title>Expert25_s0_l3_tp6&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M12195.05,-15304.67C12192.16,-15304.39 12189.28,-15304.12 12186.42,-15303.87 11397.85,-15235.83 8954.87,-15230.87 8164.72,-15231.1"/>
<polygon fill="black" stroke="black" points="8164.64,-15227.6 8154.64,-15231.1 8164.64,-15234.6 8164.64,-15227.6"/>
</g>
<!-- Expert26_s0_l3_tp6&#45;&gt;AR_exp_s0_l3 -->
<g id="edge435" class="edge">
<title>Expert26_s0_l3_tp6&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M12521.05,-15304.66C12518.16,-15304.38 12515.28,-15304.12 12512.42,-15303.87 11657.21,-15230.6 8994.35,-15229.29 8164.77,-15230.74"/>
<polygon fill="black" stroke="black" points="8164.49,-15227.24 8154.49,-15230.76 8164.5,-15234.24 8164.49,-15227.24"/>
</g>
<!-- Expert27_s0_l3_tp6&#45;&gt;AR_exp_s0_l3 -->
<g id="edge436" class="edge">
<title>Expert27_s0_l3_tp6&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M12847.06,-15304.66C12844.16,-15304.38 12841.28,-15304.12 12838.42,-15303.87 12371.97,-15264.15 9098.76,-15239.34 8164.09,-15233.01"/>
<polygon fill="black" stroke="black" points="8163.91,-15229.5 8153.88,-15232.94 8163.86,-15236.5 8163.91,-15229.5"/>
</g>
<!-- Expert28_s0_l3_tp7&#45;&gt;AR_exp_s0_l3 -->
<g id="edge437" class="edge">
<title>Expert28_s0_l3_tp7&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M10565.05,-15304.71C10562.15,-15304.41 10559.27,-15304.13 10556.42,-15303.87 10096.98,-15261.8 8728.75,-15241.1 8163.74,-15234.16"/>
<polygon fill="black" stroke="black" points="8163.47,-15230.65 8153.43,-15234.03 8163.38,-15237.65 8163.47,-15230.65"/>
</g>
<!-- Expert29_s0_l3_tp7&#45;&gt;AR_exp_s0_l3 -->
<g id="edge438" class="edge">
<title>Expert29_s0_l3_tp7&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M10891.05,-15304.7C10888.15,-15304.41 10885.28,-15304.13 10882.42,-15303.87 10357.85,-15256.64 8778.92,-15238.62 8164.18,-15233.28"/>
<polygon fill="black" stroke="black" points="8163.88,-15229.78 8153.85,-15233.19 8163.82,-15236.78 8163.88,-15229.78"/>
</g>
<!-- Expert30_s0_l3_tp7&#45;&gt;AR_exp_s0_l3 -->
<g id="edge439" class="edge">
<title>Expert30_s0_l3_tp7&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M11217.05,-15304.69C11214.15,-15304.4 11211.28,-15304.13 11208.42,-15303.87 10618.28,-15251.45 8826.01,-15236.41 8164.33,-15232.58"/>
<polygon fill="black" stroke="black" points="8164.21,-15229.08 8154.19,-15232.52 8164.17,-15236.08 8164.21,-15229.08"/>
</g>
<!-- Expert31_s0_l3_tp7&#45;&gt;AR_exp_s0_l3 -->
<g id="edge440" class="edge">
<title>Expert31_s0_l3_tp7&#45;&gt;AR_exp_s0_l3</title>
<path fill="none" stroke="black" d="M11543.05,-15304.68C11540.15,-15304.39 11537.28,-15304.12 11534.42,-15303.87 10878.39,-15246.25 8870.77,-15234.4 8164.43,-15232"/>
<polygon fill="black" stroke="black" points="8164.39,-15228.5 8154.38,-15231.96 8164.37,-15235.5 8164.39,-15228.5"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp0 -->
<g id="edge441" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M7861.26,-15193.73C7846.49,-15184 7830.11,-15173.21 7813.99,-15162.59"/>
<polygon fill="black" stroke="black" points="7815.87,-15159.64 7805.59,-15157.06 7812.02,-15165.49 7815.87,-15159.64"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp1 -->
<g id="edge443" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M7686.41,-15219.49C7368.44,-15205.7 6775.2,-15179.83 6269.42,-15156.92 5996.53,-15144.56 5686.16,-15130.08 5461.96,-15119.54"/>
<polygon fill="black" stroke="black" points="5461.84,-15116.03 5451.69,-15119.06 5461.51,-15123.02 5461.84,-15116.03"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp2 -->
<g id="edge445" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M7714.68,-15209.98C7513.33,-15190.51 7199.71,-15160.17 6961.11,-15137.1"/>
<polygon fill="black" stroke="black" points="6961.17,-15133.59 6950.88,-15136.11 6960.49,-15140.55 6961.17,-15133.59"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp3 -->
<g id="edge447" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M8065.19,-15201.15C8147.57,-15185.61 8251.57,-15166 8344.15,-15148.54"/>
<polygon fill="black" stroke="black" points="8345.04,-15151.93 8354.22,-15146.64 8343.75,-15145.05 8345.04,-15151.93"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp4 -->
<g id="edge449" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp4</title>
<path fill="none" stroke="black" d="M8143.04,-15218.89C8637.78,-15196.06 9809.28,-15141.99 10341.24,-15117.44"/>
<polygon fill="black" stroke="black" points="10341.53,-15120.93 10351.36,-15116.97 10341.21,-15113.93 10341.53,-15120.93"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp5 -->
<g id="edge451" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp5</title>
<path fill="none" stroke="black" d="M7679.45,-15224.28C7158.61,-15212.92 5871.29,-15184.39 4793.42,-15156.92 4238.65,-15142.78 3591.54,-15124.41 3221.21,-15113.71"/>
<polygon fill="black" stroke="black" points="3221.25,-15110.21 3211.15,-15113.42 3221.05,-15117.21 3221.25,-15110.21"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp6 -->
<g id="edge453" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp6</title>
<path fill="none" stroke="black" d="M8153.78,-15227.36C8951.16,-15220.25 11521.69,-15194.89 12349.42,-15156.92 12492.34,-15150.36 12651.64,-15138.63 12781.04,-15127.97"/>
<polygon fill="black" stroke="black" points="12781.41,-15131.45 12791.09,-15127.13 12780.84,-15124.47 12781.41,-15131.45"/>
</g>
<!-- AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp7 -->
<g id="edge455" class="edge">
<title>AR_exp_s0_l3&#45;&gt;ResMOE_s0_l3_tp7</title>
<path fill="none" stroke="black" d="M8152.75,-15225.97C8666.71,-15218.07 9921.03,-15196.17 10971.42,-15156.92 11226.68,-15147.38 11517.69,-15132.09 11723.19,-15120.55"/>
<polygon fill="black" stroke="black" points="11723.43,-15124.04 11733.21,-15119.99 11723.03,-15117.06 11723.43,-15124.04"/>
</g>
<!-- QKV_s0_l4_tp0 -->
<g id="node275" class="node">
<title>QKV_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="6945.42,-15014.92 6607.42,-15014.92 6607.42,-14961.92 6945.42,-14961.92 6945.42,-15014.92"/>
<text text-anchor="middle" x="6776.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6776.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6776.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp0 -->
<g id="edge457" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7392.56,-15063.18C7265.98,-15048.1 7120.54,-15030.74 6988.42,-15014.92 6977.78,-15013.65 6966.85,-15012.33 6955.81,-15011.01"/>
<polygon fill="black" stroke="black" points="6956,-15007.51 6945.65,-15009.79 6955.17,-15014.46 6956,-15007.51"/>
</g>
<!-- QKV_s0_l4_tp1 -->
<g id="node276" class="node">
<title>QKV_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="7335.42,-15014.92 6997.42,-15014.92 6997.42,-14961.92 7335.42,-14961.92 7335.42,-15014.92"/>
<text text-anchor="middle" x="7166.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7166.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7166.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp1 -->
<g id="edge458" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7469.78,-15050.9C7412.04,-15039.2 7352.98,-15027.23 7302.49,-15017"/>
<polygon fill="black" stroke="black" points="7303,-15013.53 7292.51,-15014.97 7301.61,-15020.39 7303,-15013.53"/>
</g>
<!-- QKV_s0_l4_tp2 -->
<g id="node277" class="node">
<title>QKV_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="7716.42,-15014.92 7378.42,-15014.92 7378.42,-14961.92 7716.42,-14961.92 7716.42,-15014.92"/>
<text text-anchor="middle" x="7547.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7547.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7547.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp2 -->
<g id="edge459" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7644.26,-15050.82C7627.82,-15040.4 7611.04,-15029.76 7596.18,-15020.33"/>
<polygon fill="black" stroke="black" points="7597.98,-15017.33 7587.66,-15014.93 7594.23,-15023.24 7597.98,-15017.33"/>
</g>
<!-- QKV_s0_l4_tp3 -->
<g id="node278" class="node">
<title>QKV_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8081.42,-15014.92 7743.42,-15014.92 7743.42,-14961.92 8081.42,-14961.92 8081.42,-15014.92"/>
<text text-anchor="middle" x="7912.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7912.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7912.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp3 -->
<g id="edge460" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7811.8,-15050.82C7828.89,-15040.4 7846.31,-15029.76 7861.76,-15020.33"/>
<polygon fill="black" stroke="black" points="7863.9,-15023.13 7870.61,-15014.93 7860.25,-15017.15 7863.9,-15023.13"/>
</g>
<!-- QKV_s0_l4_tp4 -->
<g id="node279" class="node">
<title>QKV_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="8462.42,-15014.92 8124.42,-15014.92 8124.42,-14961.92 8462.42,-14961.92 8462.42,-15014.92"/>
<text text-anchor="middle" x="8293.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8293.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8293.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp4 -->
<g id="edge461" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M7944.83,-15059.2C8015.75,-15045 8092.42,-15029.66 8155.74,-15016.98"/>
<polygon fill="black" stroke="black" points="8156.67,-15020.36 8165.79,-15014.97 8155.3,-15013.5 8156.67,-15020.36"/>
</g>
<!-- QKV_s0_l4_tp5 -->
<g id="node280" class="node">
<title>QKV_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="8848.42,-15014.92 8510.42,-15014.92 8510.42,-14961.92 8848.42,-14961.92 8848.42,-15014.92"/>
<text text-anchor="middle" x="8679.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8679.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8679.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp5 -->
<g id="edge462" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M7965.93,-15074.9C8112.01,-15057.74 8302.52,-15035.25 8471.42,-15014.92 8480.81,-15013.79 8490.43,-15012.63 8500.14,-15011.45"/>
<polygon fill="black" stroke="black" points="8500.78,-15014.9 8510.29,-15010.22 8499.94,-15007.95 8500.78,-15014.9"/>
</g>
<!-- QKV_s0_l4_tp6 -->
<g id="node281" class="node">
<title>QKV_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="9236.42,-15014.92 8898.42,-15014.92 8898.42,-14961.92 9236.42,-14961.92 9236.42,-15014.92"/>
<text text-anchor="middle" x="9067.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="9067.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9067.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp6 -->
<g id="edge463" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M7966.39,-15075.05C8045.89,-15066.46 8134.89,-15057.53 8216.42,-15050.92 8500.83,-15027.86 8573.2,-15040.13 8857.42,-15014.92 8867.47,-15014.03 8877.78,-15013.03 8888.18,-15011.97"/>
<polygon fill="black" stroke="black" points="8888.59,-15015.45 8898.18,-15010.93 8887.87,-15008.48 8888.59,-15015.45"/>
</g>
<!-- QKV_s0_l4_tp7 -->
<g id="node282" class="node">
<title>QKV_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="6563.42,-15014.92 6225.42,-15014.92 6225.42,-14961.92 6563.42,-14961.92 6563.42,-15014.92"/>
<text text-anchor="middle" x="6394.42" y="-14999.72" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6394.42" y="-14984.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6394.42" y="-14969.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp7 -->
<g id="edge464" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;QKV_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M7419.07,-15082.82C7192.08,-15067.03 6875.68,-15043.05 6598.42,-15014.92 6590.34,-15014.1 6582.09,-15013.22 6573.76,-15012.31"/>
<polygon fill="black" stroke="black" points="6573.88,-15008.8 6563.56,-15011.18 6573.11,-15015.76 6573.88,-15008.8"/>
</g>
<!-- ResAttn_s0_l4_tp0 -->
<g id="node309" class="node">
<title>ResAttn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7063.77,-14437.01 6506.45,-14437.01 6363.08,-14331.01 6920.4,-14331.01 7063.77,-14437.01"/>
<text text-anchor="middle" x="6713.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6713.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6713.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp0 -->
<g id="edge506" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7414.15,-15079.31C7282.48,-15069.78 7127.53,-15059.12 6987.42,-15050.92 6901.81,-15045.91 6288.9,-15060.76 6216.42,-15014.92 6167.69,-14984.1 6155.42,-14958.08 6155.42,-14900.42 6155.42,-14900.42 6155.42,-14900.42 6155.42,-14598.49 6155.42,-14515.59 6219.6,-14510.72 6293.42,-14473.01 6345.64,-14446.34 6405.44,-14427.76 6463.23,-14414.8"/>
<polygon fill="black" stroke="black" points="6464.22,-14418.17 6473.24,-14412.61 6462.72,-14411.33 6464.22,-14418.17"/>
</g>
<!-- ResAttn_s0_l4_tp1 -->
<g id="node310" class="node">
<title>ResAttn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="5263.77,-14437.01 4706.45,-14437.01 4563.08,-14331.01 5120.4,-14331.01 5263.77,-14437.01"/>
<text text-anchor="middle" x="4913.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4913.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4913.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp1 -->
<g id="edge508" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7412.4,-15077.99C7281.13,-15068.31 7126.96,-15057.89 6987.42,-15050.92 6446.97,-15023.92 6308.71,-15070.29 5770.42,-15014.92 5625.39,-15000 5124.42,-15046.21 5124.42,-14900.42 5124.42,-14900.42 5124.42,-14900.42 5124.42,-14598.49 5124.42,-14532.46 5072.72,-14479.49 5020.5,-14442.83"/>
<polygon fill="black" stroke="black" points="5022.35,-14439.86 5012.13,-14437.09 5018.4,-14445.63 5022.35,-14439.86"/>
</g>
<!-- ResAttn_s0_l4_tp2 -->
<g id="node311" class="node">
<title>ResAttn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="6111.77,-14437.01 5554.45,-14437.01 5411.08,-14331.01 5968.4,-14331.01 6111.77,-14437.01"/>
<text text-anchor="middle" x="5761.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5761.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5761.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp2 -->
<g id="edge510" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7414.16,-15079.1C7282.49,-15069.53 7127.55,-15058.91 6987.42,-15050.92 6621,-15030.04 6524.7,-15073.71 6162.42,-15014.92 5979.47,-14985.23 5761.42,-15085.76 5761.42,-14900.42 5761.42,-14900.42 5761.42,-14900.42 5761.42,-14598.49 5761.42,-14547.64 5761.42,-14489.99 5761.42,-14447.42"/>
<polygon fill="black" stroke="black" points="5764.92,-14447.21 5761.42,-14437.21 5757.92,-14447.21 5764.92,-14447.21"/>
</g>
<!-- ResAttn_s0_l4_tp3 -->
<g id="node312" class="node">
<title>ResAttn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="9123.77,-14437.01 8566.45,-14437.01 8423.08,-14331.01 8980.4,-14331.01 9123.77,-14437.01"/>
<text text-anchor="middle" x="8773.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8773.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8773.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp3 -->
<g id="edge512" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7965.07,-15074.17C8044.88,-15065.47 8134.39,-15056.7 8216.42,-15050.92 8273.48,-15046.9 9196.21,-15044.08 9245.42,-15014.92 9296.34,-14984.75 9313.42,-14959.61 9313.42,-14900.42 9313.42,-14900.42 9313.42,-14900.42 9313.42,-14598.49 9313.42,-14531.85 9169.41,-14477.11 9030.13,-14439.75"/>
<polygon fill="black" stroke="black" points="9030.68,-14436.27 9020.11,-14437.09 9028.88,-14443.04 9030.68,-14436.27"/>
</g>
<!-- ResAttn_s0_l4_tp4 -->
<g id="node313" class="node">
<title>ResAttn_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="10057.77,-14437.01 9500.45,-14437.01 9357.08,-14331.01 9914.4,-14331.01 10057.77,-14437.01"/>
<text text-anchor="middle" x="9707.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9707.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9707.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp4 -->
<g id="edge514" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M7965.07,-15074.11C8044.88,-15065.4 8134.39,-15056.64 8216.42,-15050.92 8382.53,-15039.33 9707.42,-15066.93 9707.42,-14900.42 9707.42,-14900.42 9707.42,-14900.42 9707.42,-14598.49 9707.42,-14547.64 9707.42,-14489.99 9707.42,-14447.42"/>
<polygon fill="black" stroke="black" points="9710.92,-14447.21 9707.42,-14437.21 9703.92,-14447.21 9710.92,-14447.21"/>
</g>
<!-- ResAttn_s0_l4_tp5 -->
<g id="node314" class="node">
<title>ResAttn_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="4122.77,-14437.01 3565.45,-14437.01 3422.08,-14331.01 3979.4,-14331.01 4122.77,-14437.01"/>
<text text-anchor="middle" x="3772.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3772.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3772.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp5 -->
<g id="edge516" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M7411.52,-15077.24C7280.46,-15067.47 7126.67,-15057.19 6987.42,-15050.92 6582.64,-15032.69 5566.08,-15068.29 5164.42,-15014.92 4956,-14987.22 4705.42,-15110.67 4705.42,-14900.42 4705.42,-14900.42 4705.42,-14900.42 4705.42,-14598.49 4705.42,-14467.28 4350.37,-14416.72 4078.32,-14397.23"/>
<polygon fill="black" stroke="black" points="4078.49,-14393.73 4068.27,-14396.52 4078,-14400.72 4078.49,-14393.73"/>
</g>
<!-- ResAttn_s0_l4_tp6 -->
<g id="node315" class="node">
<title>ResAttn_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="12200.77,-14437.01 11643.45,-14437.01 11500.08,-14331.01 12057.4,-14331.01 12200.77,-14437.01"/>
<text text-anchor="middle" x="11850.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11850.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11850.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp6 -->
<g id="edge518" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M7964.09,-15073.61C8044.13,-15064.83 8134.04,-15056.15 8216.42,-15050.92 8970.18,-15003.02 9162.42,-15073.54 9915.42,-15014.92 10105,-15000.16 10763.42,-15090.57 10763.42,-14900.42 10763.42,-14900.42 10763.42,-14900.42 10763.42,-14598.49 10763.42,-14514.15 11273.75,-14445.17 11595.06,-14410.09"/>
<polygon fill="black" stroke="black" points="11595.9,-14413.52 11605.46,-14408.96 11595.14,-14406.56 11595.9,-14413.52"/>
</g>
<!-- ResAttn_s0_l4_tp7 -->
<g id="node316" class="node">
<title>ResAttn_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="11051.77,-14437.01 10494.45,-14437.01 10351.08,-14331.01 10908.4,-14331.01 11051.77,-14437.01"/>
<text text-anchor="middle" x="10701.42" y="-14395.31" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10701.42" y="-14380.31" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10701.42" y="-14365.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp7 -->
<g id="edge520" class="edge">
<title>ResMOE_s0_l3_tp0&#45;&gt;ResAttn_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M7964.74,-15073.88C8044.62,-15065.14 8134.27,-15056.43 8216.42,-15050.92 8783.38,-15012.91 8928.06,-15060.91 9494.42,-15014.92 9684.39,-14999.49 10344.42,-15091.01 10344.42,-14900.42 10344.42,-14900.42 10344.42,-14900.42 10344.42,-14598.49 10344.42,-14520.58 10407.83,-14470.42 10481.19,-14438.46"/>
<polygon fill="black" stroke="black" points="10482.81,-14441.58 10490.66,-14434.46 10480.08,-14435.13 10482.81,-14441.58"/>
</g>
<!-- SplitHeads_s0_l4_tp0 -->
<g id="node283" class="node">
<title>SplitHeads_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="6945.42,-14925.92 6573.42,-14925.92 6573.42,-14872.92 6945.42,-14872.92 6945.42,-14925.92"/>
<text text-anchor="middle" x="6759.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6759.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6759.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp0&#45;&gt;SplitHeads_s0_l4_tp0 -->
<g id="edge465" class="edge">
<title>QKV_s0_l4_tp0&#45;&gt;SplitHeads_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M6771.41,-14961.79C6769.84,-14953.72 6768.07,-14944.65 6766.38,-14936.02"/>
<polygon fill="black" stroke="black" points="6769.81,-14935.31 6764.45,-14926.17 6762.94,-14936.65 6769.81,-14935.31"/>
</g>
<!-- SplitHeads_s0_l4_tp1 -->
<g id="node284" class="node">
<title>SplitHeads_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="7335.42,-14925.92 6963.42,-14925.92 6963.42,-14872.92 7335.42,-14872.92 7335.42,-14925.92"/>
<text text-anchor="middle" x="7149.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7149.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7149.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp1&#45;&gt;SplitHeads_s0_l4_tp1 -->
<g id="edge466" class="edge">
<title>QKV_s0_l4_tp1&#45;&gt;SplitHeads_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7161.41,-14961.79C7159.84,-14953.72 7158.07,-14944.65 7156.38,-14936.02"/>
<polygon fill="black" stroke="black" points="7159.81,-14935.31 7154.45,-14926.17 7152.94,-14936.65 7159.81,-14935.31"/>
</g>
<!-- SplitHeads_s0_l4_tp2 -->
<g id="node285" class="node">
<title>SplitHeads_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="7725.42,-14925.92 7353.42,-14925.92 7353.42,-14872.92 7725.42,-14872.92 7725.42,-14925.92"/>
<text text-anchor="middle" x="7539.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7539.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7539.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp2&#45;&gt;SplitHeads_s0_l4_tp2 -->
<g id="edge467" class="edge">
<title>QKV_s0_l4_tp2&#45;&gt;SplitHeads_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7545.07,-14961.79C7544.33,-14953.81 7543.51,-14944.85 7542.72,-14936.3"/>
<polygon fill="black" stroke="black" points="7546.19,-14935.81 7541.79,-14926.17 7539.22,-14936.45 7546.19,-14935.81"/>
</g>
<!-- SplitHeads_s0_l4_tp3 -->
<g id="node286" class="node">
<title>SplitHeads_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8115.42,-14925.92 7743.42,-14925.92 7743.42,-14872.92 8115.42,-14872.92 8115.42,-14925.92"/>
<text text-anchor="middle" x="7929.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7929.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7929.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp3&#45;&gt;SplitHeads_s0_l4_tp3 -->
<g id="edge468" class="edge">
<title>QKV_s0_l4_tp3&#45;&gt;SplitHeads_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7917.43,-14961.79C7919.01,-14953.72 7920.78,-14944.65 7922.47,-14936.02"/>
<polygon fill="black" stroke="black" points="7925.91,-14936.65 7924.39,-14926.17 7919.04,-14935.31 7925.91,-14936.65"/>
</g>
<!-- SplitHeads_s0_l4_tp4 -->
<g id="node287" class="node">
<title>SplitHeads_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="8505.42,-14925.92 8133.42,-14925.92 8133.42,-14872.92 8505.42,-14872.92 8505.42,-14925.92"/>
<text text-anchor="middle" x="8319.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8319.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8319.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp4&#45;&gt;SplitHeads_s0_l4_tp4 -->
<g id="edge469" class="edge">
<title>QKV_s0_l4_tp4&#45;&gt;SplitHeads_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M8301.08,-14961.79C8303.49,-14953.72 8306.2,-14944.65 8308.78,-14936.02"/>
<polygon fill="black" stroke="black" points="8312.22,-14936.75 8311.73,-14926.17 8305.51,-14934.75 8312.22,-14936.75"/>
</g>
<!-- SplitHeads_s0_l4_tp5 -->
<g id="node288" class="node">
<title>SplitHeads_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="8895.42,-14925.92 8523.42,-14925.92 8523.42,-14872.92 8895.42,-14872.92 8895.42,-14925.92"/>
<text text-anchor="middle" x="8709.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8709.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8709.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp5&#45;&gt;SplitHeads_s0_l4_tp5 -->
<g id="edge470" class="edge">
<title>QKV_s0_l4_tp5&#45;&gt;SplitHeads_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M8688.26,-14961.79C8691.07,-14953.63 8694.24,-14944.46 8697.24,-14935.74"/>
<polygon fill="black" stroke="black" points="8700.59,-14936.76 8700.54,-14926.17 8693.97,-14934.48 8700.59,-14936.76"/>
</g>
<!-- SplitHeads_s0_l4_tp6 -->
<g id="node289" class="node">
<title>SplitHeads_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="9285.42,-14925.92 8913.42,-14925.92 8913.42,-14872.92 9285.42,-14872.92 9285.42,-14925.92"/>
<text text-anchor="middle" x="9099.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="9099.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9099.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp6&#45;&gt;SplitHeads_s0_l4_tp6 -->
<g id="edge471" class="edge">
<title>QKV_s0_l4_tp6&#45;&gt;SplitHeads_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M9076.85,-14961.79C9079.85,-14953.63 9083.22,-14944.46 9086.43,-14935.74"/>
<polygon fill="black" stroke="black" points="9089.78,-14936.76 9089.95,-14926.17 9083.21,-14934.35 9089.78,-14936.76"/>
</g>
<!-- SplitHeads_s0_l4_tp7 -->
<g id="node290" class="node">
<title>SplitHeads_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="6555.42,-14925.92 6183.42,-14925.92 6183.42,-14872.92 6555.42,-14872.92 6555.42,-14925.92"/>
<text text-anchor="middle" x="6369.42" y="-14910.72" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6369.42" y="-14895.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6369.42" y="-14880.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l4_tp7&#45;&gt;SplitHeads_s0_l4_tp7 -->
<g id="edge472" class="edge">
<title>QKV_s0_l4_tp7&#45;&gt;SplitHeads_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M6387.06,-14961.79C6384.74,-14953.72 6382.13,-14944.65 6379.65,-14936.02"/>
<polygon fill="black" stroke="black" points="6382.95,-14934.81 6376.82,-14926.17 6376.22,-14936.75 6382.95,-14934.81"/>
</g>
<!-- A2A_s0_l4 -->
<g id="node291" class="node">
<title>A2A_s0_l4</title>
<ellipse fill="none" stroke="black" cx="7734.42" cy="-14799.44" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7734.42" y="-14810.74" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="7734.42" y="-14795.74" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7734.42" y="-14780.74" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l4_tp0&#45;&gt;A2A_s0_l4 -->
<g id="edge473" class="edge">
<title>SplitHeads_s0_l4_tp0&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M6945.45,-14873.94C6948.46,-14873.59 6951.45,-14873.25 6954.42,-14872.92 7137.43,-14852.46 7345.05,-14833.37 7500.05,-14819.92"/>
<polygon fill="black" stroke="black" points="7500.53,-14823.39 7510.19,-14819.04 7499.92,-14816.42 7500.53,-14823.39"/>
</g>
<!-- SplitHeads_s0_l4_tp1&#45;&gt;A2A_s0_l4 -->
<g id="edge474" class="edge">
<title>SplitHeads_s0_l4_tp1&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M7301.98,-14872.87C7380.22,-14859.77 7475.93,-14843.74 7557.41,-14830.09"/>
<polygon fill="black" stroke="black" points="7557.99,-14833.54 7567.27,-14828.44 7556.83,-14826.64 7557.99,-14833.54"/>
</g>
<!-- SplitHeads_s0_l4_tp2&#45;&gt;A2A_s0_l4 -->
<g id="edge475" class="edge">
<title>SplitHeads_s0_l4_tp2&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M7590.4,-14872.81C7610.24,-14862.84 7633.43,-14851.19 7655.33,-14840.18"/>
<polygon fill="black" stroke="black" points="7656.94,-14843.29 7664.3,-14835.67 7653.8,-14837.04 7656.94,-14843.29"/>
</g>
<!-- SplitHeads_s0_l4_tp3&#45;&gt;A2A_s0_l4 -->
<g id="edge476" class="edge">
<title>SplitHeads_s0_l4_tp3&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M7878.44,-14872.81C7858.61,-14862.84 7835.42,-14851.19 7813.51,-14840.18"/>
<polygon fill="black" stroke="black" points="7815.05,-14837.04 7804.54,-14835.67 7811.91,-14843.29 7815.05,-14837.04"/>
</g>
<!-- SplitHeads_s0_l4_tp4&#45;&gt;A2A_s0_l4 -->
<g id="edge477" class="edge">
<title>SplitHeads_s0_l4_tp4&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M8166.87,-14872.87C8088.63,-14859.77 7992.91,-14843.74 7911.44,-14830.09"/>
<polygon fill="black" stroke="black" points="7912.02,-14826.64 7901.58,-14828.44 7910.86,-14833.54 7912.02,-14826.64"/>
</g>
<!-- SplitHeads_s0_l4_tp5&#45;&gt;A2A_s0_l4 -->
<g id="edge478" class="edge">
<title>SplitHeads_s0_l4_tp5&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M8523.4,-14873.94C8520.39,-14873.59 8517.39,-14873.25 8514.42,-14872.92 8331.42,-14852.46 8123.79,-14833.37 7968.79,-14819.92"/>
<polygon fill="black" stroke="black" points="7968.92,-14816.42 7958.66,-14819.04 7968.32,-14823.39 7968.92,-14816.42"/>
</g>
<!-- SplitHeads_s0_l4_tp6&#45;&gt;A2A_s0_l4 -->
<g id="edge479" class="edge">
<title>SplitHeads_s0_l4_tp6&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M8913.41,-14873.81C8910.39,-14873.5 8907.4,-14873.21 8904.42,-14872.92 8592.38,-14842.89 8232.25,-14822.76 7994.88,-14811.48"/>
<polygon fill="black" stroke="black" points="7994.88,-14807.98 7984.73,-14811 7994.55,-14814.97 7994.88,-14807.98"/>
</g>
<!-- SplitHeads_s0_l4_tp7&#45;&gt;A2A_s0_l4 -->
<g id="edge480" class="edge">
<title>SplitHeads_s0_l4_tp7&#45;&gt;A2A_s0_l4</title>
<path fill="none" stroke="black" d="M6555.43,-14873.81C6558.45,-14873.5 6561.45,-14873.21 6564.42,-14872.92 6876.47,-14842.89 7236.6,-14822.76 7473.96,-14811.48"/>
<polygon fill="black" stroke="black" points="7474.29,-14814.97 7484.12,-14811 7473.96,-14807.98 7474.29,-14814.97"/>
</g>
<!-- Attn_s0_l4_tp0 -->
<g id="node292" class="node">
<title>Attn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="6945.42,-14725.97 6573.42,-14725.97 6573.42,-14672.97 6945.42,-14672.97 6945.42,-14725.97"/>
<text text-anchor="middle" x="6759.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6759.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6759.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp0 -->
<g id="edge481" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7510.19,-14779.84C7356.85,-14766.59 7148.7,-14747.54 6955.51,-14726.07"/>
<polygon fill="black" stroke="black" points="6955.77,-14722.58 6945.45,-14724.95 6955,-14729.54 6955.77,-14722.58"/>
</g>
<!-- Attn_s0_l4_tp1 -->
<g id="node293" class="node">
<title>Attn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="7335.42,-14725.97 6963.42,-14725.97 6963.42,-14672.97 7335.42,-14672.97 7335.42,-14725.97"/>
<text text-anchor="middle" x="7149.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7149.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7149.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp1 -->
<g id="edge482" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7567.18,-14770.43C7487.03,-14757.01 7391.42,-14741 7311.9,-14727.68"/>
<polygon fill="black" stroke="black" points="7312.23,-14724.18 7301.79,-14725.98 7311.07,-14731.09 7312.23,-14724.18"/>
</g>
<!-- Attn_s0_l4_tp2 -->
<g id="node294" class="node">
<title>Attn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="7725.42,-14725.97 7353.42,-14725.97 7353.42,-14672.97 7725.42,-14672.97 7725.42,-14725.97"/>
<text text-anchor="middle" x="7539.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7539.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7539.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp2 -->
<g id="edge483" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7664.3,-14763.21C7642.99,-14752.5 7619.79,-14740.85 7599.23,-14730.52"/>
<polygon fill="black" stroke="black" points="7600.8,-14727.39 7590.29,-14726.02 7597.65,-14733.64 7600.8,-14727.39"/>
</g>
<!-- Attn_s0_l4_tp3 -->
<g id="node295" class="node">
<title>Attn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8115.42,-14725.97 7743.42,-14725.97 7743.42,-14672.97 8115.42,-14672.97 8115.42,-14725.97"/>
<text text-anchor="middle" x="7929.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7929.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7929.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp3 -->
<g id="edge484" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7804.55,-14763.21C7825.85,-14752.5 7849.06,-14740.85 7869.62,-14730.52"/>
<polygon fill="black" stroke="black" points="7871.19,-14733.64 7878.55,-14726.02 7868.05,-14727.39 7871.19,-14733.64"/>
</g>
<!-- Attn_s0_l4_tp4 -->
<g id="node296" class="node">
<title>Attn_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="8505.42,-14725.97 8133.42,-14725.97 8133.42,-14672.97 8505.42,-14672.97 8505.42,-14725.97"/>
<text text-anchor="middle" x="8319.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8319.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8319.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp4 -->
<g id="edge485" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M7901.67,-14770.43C7981.81,-14757.01 8077.43,-14741 8156.95,-14727.68"/>
<polygon fill="black" stroke="black" points="8157.77,-14731.09 8167.06,-14725.98 8156.62,-14724.18 8157.77,-14731.09"/>
</g>
<!-- Attn_s0_l4_tp5 -->
<g id="node297" class="node">
<title>Attn_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="8895.42,-14725.97 8523.42,-14725.97 8523.42,-14672.97 8895.42,-14672.97 8895.42,-14725.97"/>
<text text-anchor="middle" x="8709.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8709.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8709.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp5 -->
<g id="edge486" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M7958.66,-14779.84C8112,-14766.59 8320.14,-14747.54 8513.34,-14726.07"/>
<polygon fill="black" stroke="black" points="8513.85,-14729.54 8523.4,-14724.95 8513.07,-14722.58 8513.85,-14729.54"/>
</g>
<!-- Attn_s0_l4_tp6 -->
<g id="node298" class="node">
<title>Attn_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="9285.42,-14725.97 8913.42,-14725.97 8913.42,-14672.97 9285.42,-14672.97 9285.42,-14725.97"/>
<text text-anchor="middle" x="9099.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9099.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9099.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp6 -->
<g id="edge487" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M7984.73,-14787.88C8219.46,-14776.82 8580.4,-14756.85 8903.39,-14726.04"/>
<polygon fill="black" stroke="black" points="8903.79,-14729.52 8913.41,-14725.08 8903.12,-14722.55 8903.79,-14729.52"/>
</g>
<!-- Attn_s0_l4_tp7 -->
<g id="node299" class="node">
<title>Attn_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="6555.42,-14725.97 6183.42,-14725.97 6183.42,-14672.97 6555.42,-14672.97 6555.42,-14725.97"/>
<text text-anchor="middle" x="6369.42" y="-14710.77" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6369.42" y="-14695.77" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6369.42" y="-14680.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l4&#45;&gt;Attn_s0_l4_tp7 -->
<g id="edge488" class="edge">
<title>A2A_s0_l4&#45;&gt;Attn_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M7484.12,-14787.88C7249.38,-14776.82 6888.44,-14756.85 6565.46,-14726.04"/>
<polygon fill="black" stroke="black" points="6565.72,-14722.55 6555.43,-14725.08 6565.05,-14729.52 6565.72,-14722.55"/>
</g>
<!-- AR_attn_s0_l4 -->
<g id="node300" class="node">
<title>AR_attn_s0_l4</title>
<ellipse fill="none" stroke="black" cx="7696.42" cy="-14599.49" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7696.42" y="-14610.79" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="7696.42" y="-14595.79" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7696.42" y="-14580.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l4_tp0&#45;&gt;AR_attn_s0_l4 -->
<g id="edge489" class="edge">
<title>Attn_s0_l4_tp0&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M6945.45,-14674C6948.46,-14673.65 6951.45,-14673.31 6954.42,-14672.97 7125.7,-14653.41 7319.6,-14634.58 7466.23,-14621.02"/>
<polygon fill="black" stroke="black" points="7466.62,-14624.5 7476.26,-14620.1 7465.98,-14617.53 7466.62,-14624.5"/>
</g>
<!-- Attn_s0_l4_tp1&#45;&gt;AR_attn_s0_l4 -->
<g id="edge490" class="edge">
<title>Attn_s0_l4_tp1&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M7292.07,-14672.92C7363.56,-14660.11 7450.67,-14644.51 7525.7,-14631.07"/>
<polygon fill="black" stroke="black" points="7526.5,-14634.48 7535.73,-14629.27 7525.27,-14627.59 7526.5,-14634.48"/>
</g>
<!-- Attn_s0_l4_tp2&#45;&gt;AR_attn_s0_l4 -->
<g id="edge491" class="edge">
<title>Attn_s0_l4_tp2&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M7580.67,-14672.72C7595.91,-14663.21 7613.59,-14652.18 7630.48,-14641.64"/>
<polygon fill="black" stroke="black" points="7632.59,-14644.45 7639.22,-14636.19 7628.88,-14638.51 7632.59,-14644.45"/>
</g>
<!-- Attn_s0_l4_tp3&#45;&gt;AR_attn_s0_l4 -->
<g id="edge492" class="edge">
<title>Attn_s0_l4_tp3&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M7868.51,-14672.85C7844.02,-14662.56 7815.26,-14650.46 7788.33,-14639.14"/>
<polygon fill="black" stroke="black" points="7789.47,-14635.82 7778.9,-14635.17 7786.76,-14642.27 7789.47,-14635.82"/>
</g>
<!-- Attn_s0_l4_tp4&#45;&gt;AR_attn_s0_l4 -->
<g id="edge493" class="edge">
<title>Attn_s0_l4_tp4&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M8156.96,-14672.92C8071.99,-14659.55 7967.67,-14643.15 7879.82,-14629.33"/>
<polygon fill="black" stroke="black" points="7880.16,-14625.84 7869.73,-14627.75 7879.07,-14632.76 7880.16,-14625.84"/>
</g>
<!-- Attn_s0_l4_tp5&#45;&gt;AR_attn_s0_l4 -->
<g id="edge494" class="edge">
<title>Attn_s0_l4_tp5&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M8523.4,-14673.96C8520.39,-14673.62 8517.39,-14673.29 8514.42,-14672.97 8319.74,-14651.62 8098.44,-14632.31 7935.16,-14619"/>
<polygon fill="black" stroke="black" points="7935.23,-14615.5 7924.98,-14618.18 7934.67,-14622.48 7935.23,-14615.5"/>
</g>
<!-- Attn_s0_l4_tp6&#45;&gt;AR_attn_s0_l4 -->
<g id="edge495" class="edge">
<title>Attn_s0_l4_tp6&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M8913.41,-14673.85C8910.4,-14673.54 8907.4,-14673.25 8904.42,-14672.97 8579.12,-14641.98 8203.21,-14621.89 7958.25,-14610.9"/>
<polygon fill="black" stroke="black" points="7958.28,-14607.4 7948.14,-14610.45 7957.97,-14614.39 7958.28,-14607.4"/>
</g>
<!-- Attn_s0_l4_tp7&#45;&gt;AR_attn_s0_l4 -->
<g id="edge496" class="edge">
<title>Attn_s0_l4_tp7&#45;&gt;AR_attn_s0_l4</title>
<path fill="none" stroke="black" d="M6555.43,-14673.86C6558.45,-14673.55 6561.45,-14673.26 6564.42,-14672.97 6863.3,-14643.89 7207.74,-14623.74 7437.44,-14612.19"/>
<polygon fill="black" stroke="black" points="7437.8,-14615.68 7447.61,-14611.69 7437.45,-14608.69 7437.8,-14615.68"/>
</g>
<!-- O_s0_l4_tp0 -->
<g id="node301" class="node">
<title>O_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7568.42,-14526.01 7230.42,-14526.01 7230.42,-14473.01 7568.42,-14473.01 7568.42,-14526.01"/>
<text text-anchor="middle" x="7399.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7399.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7399.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp0 -->
<g id="edge497" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7594.63,-14564.91C7559.63,-14553.36 7520.78,-14540.55 7487.01,-14529.41"/>
<polygon fill="black" stroke="black" points="7487.76,-14525.97 7477.16,-14526.16 7485.56,-14532.62 7487.76,-14525.97"/>
</g>
<!-- O_s0_l4_tp1 -->
<g id="node302" class="node">
<title>O_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="6127.42,-14526.01 5789.42,-14526.01 5789.42,-14473.01 6127.42,-14473.01 6127.42,-14526.01"/>
<text text-anchor="middle" x="5958.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5958.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5958.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp1 -->
<g id="edge498" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7447,-14587.44C7166.38,-14574.58 6697.02,-14551.79 6293.42,-14526.01 6242.81,-14522.78 6187.93,-14518.8 6137.52,-14514.96"/>
<polygon fill="black" stroke="black" points="6137.74,-14511.46 6127.5,-14514.19 6137.2,-14518.44 6137.74,-14511.46"/>
</g>
<!-- O_s0_l4_tp2 -->
<g id="node303" class="node">
<title>O_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="6640.42,-14526.01 6302.42,-14526.01 6302.42,-14473.01 6640.42,-14473.01 6640.42,-14526.01"/>
<text text-anchor="middle" x="6471.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6471.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6471.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp2 -->
<g id="edge499" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7469.95,-14580.38C7233.59,-14561.47 6867.76,-14532.21 6650.69,-14514.85"/>
<polygon fill="black" stroke="black" points="6650.71,-14511.34 6640.47,-14514.03 6650.16,-14518.32 6650.71,-14511.34"/>
</g>
<!-- O_s0_l4_tp3 -->
<g id="node304" class="node">
<title>O_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8161.42,-14526.01 7823.42,-14526.01 7823.42,-14473.01 8161.42,-14473.01 8161.42,-14526.01"/>
<text text-anchor="middle" x="7992.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7992.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7992.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp3 -->
<g id="edge500" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7797.87,-14564.91C7832.76,-14553.36 7871.48,-14540.55 7905.13,-14529.41"/>
<polygon fill="black" stroke="black" points="7906.55,-14532.62 7914.94,-14526.16 7904.35,-14525.98 7906.55,-14532.62"/>
</g>
<!-- O_s0_l4_tp4 -->
<g id="node305" class="node">
<title>O_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="9127.42,-14526.01 8789.42,-14526.01 8789.42,-14473.01 9127.42,-14473.01 9127.42,-14526.01"/>
<text text-anchor="middle" x="8958.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8958.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8958.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp4 -->
<g id="edge501" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M7924.6,-14580.78C8169.73,-14561.74 8554.25,-14531.89 8778.79,-14514.46"/>
<polygon fill="black" stroke="black" points="8779.32,-14517.93 8789.02,-14513.66 8778.78,-14510.95 8779.32,-14517.93"/>
</g>
<!-- O_s0_l4_tp5 -->
<g id="node306" class="node">
<title>O_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="5652.42,-14526.01 5314.42,-14526.01 5314.42,-14473.01 5652.42,-14473.01 5652.42,-14526.01"/>
<text text-anchor="middle" x="5483.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5483.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5483.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp5 -->
<g id="edge502" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M7437.46,-14592.62C7069.06,-14583.38 6372.65,-14562.62 5780.42,-14526.01 5742.37,-14523.66 5701.63,-14520.55 5662.89,-14517.31"/>
<polygon fill="black" stroke="black" points="5662.81,-14513.8 5652.55,-14516.44 5662.22,-14520.77 5662.81,-14513.8"/>
</g>
<!-- O_s0_l4_tp6 -->
<g id="node307" class="node">
<title>O_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="10235.42,-14526.01 9897.42,-14526.01 9897.42,-14473.01 10235.42,-14473.01 10235.42,-14526.01"/>
<text text-anchor="middle" x="10066.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10066.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10066.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp6 -->
<g id="edge503" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M7954,-14591.67C8333.74,-14581.03 9066.13,-14558.32 9688.42,-14526.01 9753.27,-14522.65 9824.31,-14518.08 9887.13,-14513.75"/>
<polygon fill="black" stroke="black" points="9887.4,-14517.24 9897.14,-14513.06 9886.92,-14510.26 9887.4,-14517.24"/>
</g>
<!-- O_s0_l4_tp7 -->
<g id="node308" class="node">
<title>O_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="9679.42,-14526.01 9341.42,-14526.01 9341.42,-14473.01 9679.42,-14473.01 9679.42,-14526.01"/>
<text text-anchor="middle" x="9510.42" y="-14510.81" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9510.42" y="-14495.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9510.42" y="-14480.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l4&#45;&gt;O_s0_l4_tp7 -->
<g id="edge504" class="edge">
<title>AR_attn_s0_l4&#45;&gt;O_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M7945.27,-14587.31C8232.38,-14574.1 8718.66,-14550.77 9136.42,-14526.01 9199.81,-14522.26 9269.21,-14517.66 9330.82,-14513.41"/>
<polygon fill="black" stroke="black" points="9331.31,-14516.88 9341.04,-14512.7 9330.82,-14509.9 9331.31,-14516.88"/>
</g>
<!-- O_s0_l4_tp0&#45;&gt;ResAttn_s0_l4_tp0 -->
<g id="edge505" class="edge">
<title>O_s0_l4_tp0&#45;&gt;ResAttn_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7245.04,-14472.97C7183.53,-14462.79 7110.28,-14450.67 7038.11,-14438.73"/>
<polygon fill="black" stroke="black" points="7038.37,-14435.23 7027.94,-14437.05 7037.23,-14442.14 7038.37,-14435.23"/>
</g>
<!-- O_s0_l4_tp1&#45;&gt;ResAttn_s0_l4_tp1 -->
<g id="edge507" class="edge">
<title>O_s0_l4_tp1&#45;&gt;ResAttn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M5789.36,-14480.15C5644.58,-14464.43 5431.64,-14441.3 5251.97,-14421.78"/>
<polygon fill="black" stroke="black" points="5252.14,-14418.28 5241.82,-14420.68 5251.38,-14425.24 5252.14,-14418.28"/>
</g>
<!-- O_s0_l4_tp2&#45;&gt;ResAttn_s0_l4_tp2 -->
<g id="edge509" class="edge">
<title>O_s0_l4_tp2&#45;&gt;ResAttn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M6311.64,-14472.97C6247.85,-14462.77 6171.86,-14450.62 6097.01,-14438.66"/>
<polygon fill="black" stroke="black" points="6097.37,-14435.17 6086.94,-14437.05 6096.26,-14442.08 6097.37,-14435.17"/>
</g>
<!-- O_s0_l4_tp3&#45;&gt;ResAttn_s0_l4_tp3 -->
<g id="edge511" class="edge">
<title>O_s0_l4_tp3&#45;&gt;ResAttn_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M8161.89,-14473.89C8269.89,-14458.19 8411.52,-14437.61 8531.28,-14420.2"/>
<polygon fill="black" stroke="black" points="8531.94,-14423.64 8541.33,-14418.74 8530.93,-14416.72 8531.94,-14423.64"/>
</g>
<!-- O_s0_l4_tp4&#45;&gt;ResAttn_s0_l4_tp4 -->
<g id="edge513" class="edge">
<title>O_s0_l4_tp4&#45;&gt;ResAttn_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M9126.98,-14472.97C9227.27,-14457.77 9356.16,-14438.24 9466.99,-14421.45"/>
<polygon fill="black" stroke="black" points="9467.62,-14424.89 9476.98,-14419.93 9466.57,-14417.97 9467.62,-14424.89"/>
</g>
<!-- O_s0_l4_tp5&#45;&gt;ResAttn_s0_l4_tp5 -->
<g id="edge515" class="edge">
<title>O_s0_l4_tp5&#45;&gt;ResAttn_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M5314.32,-14487.33C5128.14,-14475.02 4819.93,-14454.63 4554.42,-14437.01 4401.79,-14426.89 4232.39,-14415.62 4090.4,-14406.18"/>
<polygon fill="black" stroke="black" points="4090.43,-14402.67 4080.22,-14405.5 4089.97,-14409.66 4090.43,-14402.67"/>
</g>
<!-- O_s0_l4_tp6&#45;&gt;ResAttn_s0_l4_tp6 -->
<g id="edge517" class="edge">
<title>O_s0_l4_tp6&#45;&gt;ResAttn_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M10235.72,-14488.24C10433.55,-14476.19 10770.76,-14455.51 11060.42,-14437.01 11235.58,-14425.83 11432.56,-14412.86 11586.01,-14402.68"/>
<polygon fill="black" stroke="black" points="11586.31,-14406.17 11596.06,-14402.01 11585.85,-14399.18 11586.31,-14406.17"/>
</g>
<!-- O_s0_l4_tp7&#45;&gt;ResAttn_s0_l4_tp7 -->
<g id="edge519" class="edge">
<title>O_s0_l4_tp7&#45;&gt;ResAttn_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M9679.48,-14482.4C9879.29,-14463.36 10213.83,-14431.48 10445.45,-14409.41"/>
<polygon fill="black" stroke="black" points="10446.09,-14412.86 10455.71,-14408.43 10445.42,-14405.89 10446.09,-14412.86"/>
</g>
<!-- Gate_s0_l4_tp0 -->
<g id="node317" class="node">
<title>Gate_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7096.42,-14295.01 6758.42,-14295.01 6758.42,-14242.01 7096.42,-14242.01 7096.42,-14295.01"/>
<text text-anchor="middle" x="6927.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6927.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6927.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp0&#45;&gt;Gate_s0_l4_tp0 -->
<g id="edge521" class="edge">
<title>ResAttn_s0_l4_tp0&#45;&gt;Gate_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M6811.65,-14330.91C6831.68,-14320.29 6852.11,-14309.46 6870.13,-14299.9"/>
<polygon fill="black" stroke="black" points="6872.12,-14302.8 6879.32,-14295.03 6868.84,-14296.62 6872.12,-14302.8"/>
</g>
<!-- ResMOE_s0_l4_tp0 -->
<g id="node358" class="node">
<title>ResMOE_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7870.77,-14006.06 7313.45,-14006.06 7170.08,-13900.06 7727.4,-13900.06 7870.77,-14006.06"/>
<text text-anchor="middle" x="7520.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7520.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7520.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp0&#45;&gt;ResMOE_s0_l4_tp0 -->
<g id="edge594" class="edge">
<title>ResAttn_s0_l4_tp0&#45;&gt;ResMOE_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M6388.64,-14350.09C6301.61,-14342.48 6207.51,-14335.36 6120.42,-14331.01 5464.08,-14298.29 3818.71,-14344.58 3163.42,-14295.01 2878.38,-14273.45 2714.05,-14421.68 2526.42,-14206.01 2510.96,-14188.24 2510.06,-14169.95 2526.42,-14153.01 2690.76,-13982.9 6545.22,-14018.44 6781.42,-14006.06 6940.25,-13997.73 7118.06,-13985.32 7259.46,-13974.71"/>
<polygon fill="black" stroke="black" points="7259.87,-13978.18 7269.58,-13973.94 7259.35,-13971.2 7259.87,-13978.18"/>
</g>
<!-- Gate_s0_l4_tp1 -->
<g id="node318" class="node">
<title>Gate_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="4814.42,-14295.01 4476.42,-14295.01 4476.42,-14242.01 4814.42,-14242.01 4814.42,-14295.01"/>
<text text-anchor="middle" x="4645.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4645.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4645.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp1&#45;&gt;Gate_s0_l4_tp1 -->
<g id="edge522" class="edge">
<title>ResAttn_s0_l4_tp1&#45;&gt;Gate_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M4790.4,-14330.91C4764.52,-14319.95 4738.09,-14308.76 4715.01,-14298.98"/>
<polygon fill="black" stroke="black" points="4716.24,-14295.7 4705.67,-14295.03 4713.51,-14302.15 4716.24,-14295.7"/>
</g>
<!-- ResMOE_s0_l4_tp1 -->
<g id="node359" class="node">
<title>ResMOE_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="5296.77,-14006.06 4739.45,-14006.06 4596.08,-13900.06 5153.4,-13900.06 5296.77,-14006.06"/>
<text text-anchor="middle" x="4946.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4946.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4946.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp1&#45;&gt;ResMOE_s0_l4_tp1 -->
<g id="edge596" class="edge">
<title>ResAttn_s0_l4_tp1&#45;&gt;ResMOE_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M4600.62,-14358.99C4457.65,-14348.83 4286.05,-14337.81 4131.42,-14331.01 4084.9,-14328.97 2487.99,-14328.29 2455.42,-14295.01 2416.1,-14254.84 2416.38,-14082.5 2455.42,-14042.06 2474.44,-14022.36 4022.01,-13978.76 4668.01,-13961.4"/>
<polygon fill="black" stroke="black" points="4668.49,-13964.89 4678.4,-13961.12 4668.31,-13957.89 4668.49,-13964.89"/>
</g>
<!-- Gate_s0_l4_tp2 -->
<g id="node319" class="node">
<title>Gate_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="5930.42,-14295.01 5592.42,-14295.01 5592.42,-14242.01 5930.42,-14242.01 5930.42,-14295.01"/>
<text text-anchor="middle" x="5761.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5761.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5761.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp2&#45;&gt;Gate_s0_l4_tp2 -->
<g id="edge523" class="edge">
<title>ResAttn_s0_l4_tp2&#45;&gt;Gate_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M5761.42,-14330.91C5761.42,-14322.24 5761.42,-14313.43 5761.42,-14305.28"/>
<polygon fill="black" stroke="black" points="5764.92,-14305.03 5761.42,-14295.03 5757.92,-14305.03 5764.92,-14305.03"/>
</g>
<!-- ResMOE_s0_l4_tp2 -->
<g id="node360" class="node">
<title>ResMOE_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="6772.77,-14006.06 6215.45,-14006.06 6072.08,-13900.06 6629.4,-13900.06 6772.77,-14006.06"/>
<text text-anchor="middle" x="6422.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6422.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6422.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp2&#45;&gt;ResMOE_s0_l4_tp2 -->
<g id="edge598" class="edge">
<title>ResAttn_s0_l4_tp2&#45;&gt;ResMOE_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M5427.7,-14343.34C5375.78,-14338.38 5322.7,-14334.01 5272.42,-14331.01 5233.89,-14328.72 2520.54,-14322.48 2493.42,-14295.01 2453.93,-14255.01 2453.93,-14082.06 2493.42,-14042.06 2520.86,-14014.26 5266.38,-14007.22 5305.42,-14006.06 5595.82,-13997.44 5928.4,-13981.13 6154.62,-13969.07"/>
<polygon fill="black" stroke="black" points="6154.84,-13972.56 6164.64,-13968.53 6154.47,-13965.57 6154.84,-13972.56"/>
</g>
<!-- Gate_s0_l4_tp3 -->
<g id="node320" class="node">
<title>Gate_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8726.42,-14295.01 8388.42,-14295.01 8388.42,-14242.01 8726.42,-14242.01 8726.42,-14295.01"/>
<text text-anchor="middle" x="8557.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8557.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8557.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp3&#45;&gt;Gate_s0_l4_tp3 -->
<g id="edge524" class="edge">
<title>ResAttn_s0_l4_tp3&#45;&gt;Gate_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M8674.27,-14330.91C8654.06,-14320.29 8633.44,-14309.46 8615.25,-14299.9"/>
<polygon fill="black" stroke="black" points="8616.46,-14296.58 8605.98,-14295.03 8613.2,-14302.78 8616.46,-14296.58"/>
</g>
<!-- ResMOE_s0_l4_tp3 -->
<g id="node361" class="node">
<title>ResMOE_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8719.77,-14006.06 8162.45,-14006.06 8019.08,-13900.06 8576.4,-13900.06 8719.77,-14006.06"/>
<text text-anchor="middle" x="8369.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8369.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8369.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp3&#45;&gt;ResMOE_s0_l4_tp3 -->
<g id="edge600" class="edge">
<title>ResAttn_s0_l4_tp3&#45;&gt;ResMOE_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M9015.48,-14356.89C9118.04,-14346.93 9238.94,-14336.62 9348.42,-14331.01 10008.27,-14297.23 11662.59,-14344.83 12321.42,-14295.01 12610.66,-14273.14 13159.04,-14362.51 12958.42,-14153.01 12921.26,-14114.21 9691.82,-13999.65 8673.44,-13964.46"/>
<polygon fill="black" stroke="black" points="8673.53,-13960.96 8663.41,-13964.11 8673.29,-13967.96 8673.53,-13960.96"/>
</g>
<!-- Gate_s0_l4_tp4 -->
<g id="node321" class="node">
<title>Gate_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="9876.42,-14295.01 9538.42,-14295.01 9538.42,-14242.01 9876.42,-14242.01 9876.42,-14295.01"/>
<text text-anchor="middle" x="9707.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9707.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9707.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp4&#45;&gt;Gate_s0_l4_tp4 -->
<g id="edge525" class="edge">
<title>ResAttn_s0_l4_tp4&#45;&gt;Gate_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M9707.42,-14330.91C9707.42,-14322.24 9707.42,-14313.43 9707.42,-14305.28"/>
<polygon fill="black" stroke="black" points="9710.92,-14305.03 9707.42,-14295.03 9703.92,-14305.03 9710.92,-14305.03"/>
</g>
<!-- ResMOE_s0_l4_tp4 -->
<g id="node362" class="node">
<title>ResMOE_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="10756.77,-14006.06 10199.45,-14006.06 10056.08,-13900.06 10613.4,-13900.06 10756.77,-14006.06"/>
<text text-anchor="middle" x="10406.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10406.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10406.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp4&#45;&gt;ResMOE_s0_l4_tp4 -->
<g id="edge602" class="edge">
<title>ResAttn_s0_l4_tp4&#45;&gt;ResMOE_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M9952.56,-14359.13C10070.33,-14348.63 10213.57,-14337.28 10342.42,-14331.01 10601.15,-14318.44 12417.09,-14332.33 12673.42,-14295.01 12818.23,-14273.93 12902.03,-14322.64 12990.42,-14206.01 13172.3,-13966.05 11945.64,-14065.1 11645.42,-14042.06 11332.75,-14018.06 10975.5,-13992.93 10725.21,-13975.7"/>
<polygon fill="black" stroke="black" points="10725.08,-13972.18 10714.86,-13974.99 10724.6,-13979.16 10725.08,-13972.18"/>
</g>
<!-- Gate_s0_l4_tp5 -->
<g id="node322" class="node">
<title>Gate_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="3510.42,-14295.01 3172.42,-14295.01 3172.42,-14242.01 3510.42,-14242.01 3510.42,-14295.01"/>
<text text-anchor="middle" x="3341.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3341.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3341.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp5&#45;&gt;Gate_s0_l4_tp5 -->
<g id="edge526" class="edge">
<title>ResAttn_s0_l4_tp5&#45;&gt;Gate_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M3574.9,-14331C3531.39,-14319.54 3486.9,-14307.82 3448.58,-14297.73"/>
<polygon fill="black" stroke="black" points="3449.02,-14294.23 3438.46,-14295.07 3447.24,-14301 3449.02,-14294.23"/>
</g>
<!-- ResMOE_s0_l4_tp5 -->
<g id="node363" class="node">
<title>ResMOE_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="3063.77,-14006.06 2506.45,-14006.06 2363.08,-13900.06 2920.4,-13900.06 3063.77,-14006.06"/>
<text text-anchor="middle" x="2713.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2713.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2713.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp5&#45;&gt;ResMOE_s0_l4_tp5 -->
<g id="edge604" class="edge">
<title>ResAttn_s0_l4_tp5&#45;&gt;ResMOE_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M3479.41,-14373.46C3095.47,-14359.55 2466.25,-14331.37 2429.42,-14295.01 2349.4,-14216.03 2357.32,-14131.53 2425.42,-14042.06 2435.9,-14028.3 2460.19,-14015.77 2490.46,-14004.76"/>
<polygon fill="black" stroke="black" points="2491.77,-14008.02 2500.04,-14001.4 2489.45,-14001.41 2491.77,-14008.02"/>
</g>
<!-- Gate_s0_l4_tp6 -->
<g id="node323" class="node">
<title>Gate_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="12312.42,-14295.01 11974.42,-14295.01 11974.42,-14242.01 12312.42,-14242.01 12312.42,-14295.01"/>
<text text-anchor="middle" x="12143.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12143.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12143.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp6&#45;&gt;Gate_s0_l4_tp6 -->
<g id="edge527" class="edge">
<title>ResAttn_s0_l4_tp6&#45;&gt;Gate_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M11984.92,-14330.91C12013.46,-14319.86 12042.62,-14308.56 12068.02,-14298.72"/>
<polygon fill="black" stroke="black" points="12069.5,-14301.9 12077.56,-14295.03 12066.97,-14295.38 12069.5,-14301.9"/>
</g>
<!-- ResMOE_s0_l4_tp6 -->
<g id="node364" class="node">
<title>ResMOE_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="13182.77,-14006.06 12625.45,-14006.06 12482.08,-13900.06 13039.4,-13900.06 13182.77,-14006.06"/>
<text text-anchor="middle" x="12832.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12832.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12832.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp6&#45;&gt;ResMOE_s0_l4_tp6 -->
<g id="edge606" class="edge">
<title>ResAttn_s0_l4_tp6&#45;&gt;ResMOE_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M12127.17,-14382.46C12466.54,-14378.84 13004.75,-14362.38 13067.42,-14295.01 13144,-14212.7 13131.48,-14134.45 13067.42,-14042.06 13059.53,-14030.68 13049.98,-14020.77 13039.3,-14012.14"/>
<polygon fill="black" stroke="black" points="13041.41,-14009.35 13031.33,-14006.08 13037.17,-14014.92 13041.41,-14009.35"/>
</g>
<!-- Gate_s0_l4_tp7 -->
<g id="node324" class="node">
<title>Gate_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="11008.42,-14295.01 10670.42,-14295.01 10670.42,-14242.01 11008.42,-14242.01 11008.42,-14295.01"/>
<text text-anchor="middle" x="10839.42" y="-14279.81" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10839.42" y="-14264.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10839.42" y="-14249.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp7&#45;&gt;Gate_s0_l4_tp7 -->
<g id="edge528" class="edge">
<title>ResAttn_s0_l4_tp7&#45;&gt;Gate_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M10764.77,-14330.91C10776.97,-14320.88 10789.41,-14310.65 10800.54,-14301.49"/>
<polygon fill="black" stroke="black" points="10802.9,-14304.08 10808.4,-14295.03 10798.45,-14298.68 10802.9,-14304.08"/>
</g>
<!-- ResMOE_s0_l4_tp7 -->
<g id="node365" class="node">
<title>ResMOE_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="12134.77,-14006.06 11577.45,-14006.06 11434.08,-13900.06 11991.4,-13900.06 12134.77,-14006.06"/>
<text text-anchor="middle" x="11784.42" y="-13964.36" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11784.42" y="-13949.36" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11784.42" y="-13934.36" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l4_tp7&#45;&gt;ResMOE_s0_l4_tp7 -->
<g id="edge608" class="edge">
<title>ResAttn_s0_l4_tp7&#45;&gt;ResMOE_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M10953,-14363.96C11108.13,-14352.83 11311.21,-14339.37 11491.42,-14331.01 11639.76,-14324.13 12683.06,-14329.82 12827.42,-14295.01 12916.51,-14273.53 12964.57,-14283.55 13013.42,-14206.01 13025.98,-14186.08 13028.69,-14170.95 13013.42,-14153.01 12955.53,-14084.99 12459.95,-14021.86 12116.07,-13985.67"/>
<polygon fill="black" stroke="black" points="12116.26,-13982.17 12105.95,-13984.6 12115.53,-13989.13 12116.26,-13982.17"/>
</g>
<!-- Expert0_s0_l4_tp0 -->
<g id="node325" class="node">
<title>Expert0_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7407.42,-14206.01 7099.42,-14206.01 7099.42,-14153.01 7407.42,-14153.01 7407.42,-14206.01"/>
<text text-anchor="middle" x="7253.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="7253.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7253.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp0&#45;&gt;Expert0_s0_l4_tp0 -->
<g id="edge529" class="edge">
<title>Gate_s0_l4_tp0&#45;&gt;Expert0_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7023.03,-14242C7062.26,-14231.53 7107.8,-14219.37 7147.99,-14208.65"/>
<polygon fill="black" stroke="black" points="7149.06,-14211.99 7157.82,-14206.03 7147.25,-14205.22 7149.06,-14211.99"/>
</g>
<!-- Expert1_s0_l4_tp0 -->
<g id="node326" class="node">
<title>Expert1_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7733.42,-14206.01 7425.42,-14206.01 7425.42,-14153.01 7733.42,-14153.01 7733.42,-14206.01"/>
<text text-anchor="middle" x="7579.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="7579.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7579.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp0&#45;&gt;Expert1_s0_l4_tp0 -->
<g id="edge530" class="edge">
<title>Gate_s0_l4_tp0&#45;&gt;Expert1_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7096.47,-14247.52C7187.97,-14236.39 7303.22,-14221.88 7414.9,-14206.21"/>
<polygon fill="black" stroke="black" points="7415.59,-14209.65 7425.01,-14204.79 7414.62,-14202.72 7415.59,-14209.65"/>
</g>
<!-- Expert2_s0_l4_tp0 -->
<g id="node327" class="node">
<title>Expert2_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="6755.42,-14206.01 6447.42,-14206.01 6447.42,-14153.01 6755.42,-14153.01 6755.42,-14206.01"/>
<text text-anchor="middle" x="6601.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="6601.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6601.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp0&#45;&gt;Expert2_s0_l4_tp0 -->
<g id="edge531" class="edge">
<title>Gate_s0_l4_tp0&#45;&gt;Expert2_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6831.81,-14242C6792.59,-14231.53 6747.04,-14219.37 6706.85,-14208.65"/>
<polygon fill="black" stroke="black" points="6707.59,-14205.22 6697.03,-14206.03 6705.79,-14211.99 6707.59,-14205.22"/>
</g>
<!-- Expert3_s0_l4_tp0 -->
<g id="node328" class="node">
<title>Expert3_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="7081.42,-14206.01 6773.42,-14206.01 6773.42,-14153.01 7081.42,-14153.01 7081.42,-14206.01"/>
<text text-anchor="middle" x="6927.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="6927.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6927.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp0&#45;&gt;Expert3_s0_l4_tp0 -->
<g id="edge532" class="edge">
<title>Gate_s0_l4_tp0&#45;&gt;Expert3_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6927.42,-14241.88C6927.42,-14233.9 6927.42,-14224.95 6927.42,-14216.4"/>
<polygon fill="black" stroke="black" points="6930.92,-14216.26 6927.42,-14206.26 6923.92,-14216.26 6930.92,-14216.26"/>
</g>
<!-- Expert4_s0_l4_tp1 -->
<g id="node329" class="node">
<title>Expert4_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="4799.42,-14206.01 4491.42,-14206.01 4491.42,-14153.01 4799.42,-14153.01 4799.42,-14206.01"/>
<text text-anchor="middle" x="4645.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="4645.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4645.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp1&#45;&gt;Expert4_s0_l4_tp1 -->
<g id="edge533" class="edge">
<title>Gate_s0_l4_tp1&#45;&gt;Expert4_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4645.42,-14241.88C4645.42,-14233.9 4645.42,-14224.95 4645.42,-14216.4"/>
<polygon fill="black" stroke="black" points="4648.92,-14216.26 4645.42,-14206.26 4641.92,-14216.26 4648.92,-14216.26"/>
</g>
<!-- Expert5_s0_l4_tp1 -->
<g id="node330" class="node">
<title>Expert5_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="5125.42,-14206.01 4817.42,-14206.01 4817.42,-14153.01 5125.42,-14153.01 5125.42,-14206.01"/>
<text text-anchor="middle" x="4971.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="4971.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4971.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp1&#45;&gt;Expert5_s0_l4_tp1 -->
<g id="edge534" class="edge">
<title>Gate_s0_l4_tp1&#45;&gt;Expert5_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4741.03,-14242C4780.26,-14231.53 4825.8,-14219.37 4865.99,-14208.65"/>
<polygon fill="black" stroke="black" points="4867.06,-14211.99 4875.82,-14206.03 4865.25,-14205.22 4867.06,-14211.99"/>
</g>
<!-- Expert6_s0_l4_tp1 -->
<g id="node331" class="node">
<title>Expert6_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="4147.42,-14206.01 3839.42,-14206.01 3839.42,-14153.01 4147.42,-14153.01 4147.42,-14206.01"/>
<text text-anchor="middle" x="3993.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="3993.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3993.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp1&#45;&gt;Expert6_s0_l4_tp1 -->
<g id="edge535" class="edge">
<title>Gate_s0_l4_tp1&#45;&gt;Expert6_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4476.37,-14247.52C4384.87,-14236.39 4269.63,-14221.88 4157.94,-14206.21"/>
<polygon fill="black" stroke="black" points="4158.23,-14202.72 4147.84,-14204.79 4157.25,-14209.65 4158.23,-14202.72"/>
</g>
<!-- Expert7_s0_l4_tp1 -->
<g id="node332" class="node">
<title>Expert7_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="4473.42,-14206.01 4165.42,-14206.01 4165.42,-14153.01 4473.42,-14153.01 4473.42,-14206.01"/>
<text text-anchor="middle" x="4319.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="4319.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4319.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp1&#45;&gt;Expert7_s0_l4_tp1 -->
<g id="edge536" class="edge">
<title>Gate_s0_l4_tp1&#45;&gt;Expert7_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4549.81,-14242C4510.59,-14231.53 4465.04,-14219.37 4424.85,-14208.65"/>
<polygon fill="black" stroke="black" points="4425.59,-14205.22 4415.03,-14206.03 4423.79,-14211.99 4425.59,-14205.22"/>
</g>
<!-- Expert8_s0_l4_tp2 -->
<g id="node333" class="node">
<title>Expert8_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="6429.42,-14206.01 6121.42,-14206.01 6121.42,-14153.01 6429.42,-14153.01 6429.42,-14206.01"/>
<text text-anchor="middle" x="6275.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="6275.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6275.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp2&#45;&gt;Expert8_s0_l4_tp2 -->
<g id="edge537" class="edge">
<title>Gate_s0_l4_tp2&#45;&gt;Expert8_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5912.17,-14242C5975.84,-14231.22 6050.08,-14218.65 6114.79,-14207.7"/>
<polygon fill="black" stroke="black" points="6115.41,-14211.15 6124.68,-14206.03 6114.24,-14204.25 6115.41,-14211.15"/>
</g>
<!-- Expert9_s0_l4_tp2 -->
<g id="node334" class="node">
<title>Expert9_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="5451.42,-14206.01 5143.42,-14206.01 5143.42,-14153.01 5451.42,-14153.01 5451.42,-14206.01"/>
<text text-anchor="middle" x="5297.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="5297.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5297.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp2&#45;&gt;Expert9_s0_l4_tp2 -->
<g id="edge538" class="edge">
<title>Gate_s0_l4_tp2&#45;&gt;Expert9_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5625.34,-14242C5568.21,-14231.29 5501.67,-14218.81 5443.51,-14207.9"/>
<polygon fill="black" stroke="black" points="5443.97,-14204.43 5433.5,-14206.03 5442.68,-14211.31 5443.97,-14204.43"/>
</g>
<!-- Expert10_s0_l4_tp2 -->
<g id="node335" class="node">
<title>Expert10_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="5777.42,-14206.01 5469.42,-14206.01 5469.42,-14153.01 5777.42,-14153.01 5777.42,-14206.01"/>
<text text-anchor="middle" x="5623.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="5623.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5623.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp2&#45;&gt;Expert10_s0_l4_tp2 -->
<g id="edge539" class="edge">
<title>Gate_s0_l4_tp2&#45;&gt;Expert10_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5720.76,-14241.88C5705.74,-14232.41 5688.54,-14221.57 5672.82,-14211.66"/>
<polygon fill="black" stroke="black" points="5674.59,-14208.63 5664.27,-14206.26 5670.86,-14214.56 5674.59,-14208.63"/>
</g>
<!-- Expert11_s0_l4_tp2 -->
<g id="node336" class="node">
<title>Expert11_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="6103.42,-14206.01 5795.42,-14206.01 5795.42,-14153.01 6103.42,-14153.01 6103.42,-14206.01"/>
<text text-anchor="middle" x="5949.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="5949.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5949.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp2&#45;&gt;Expert11_s0_l4_tp2 -->
<g id="edge540" class="edge">
<title>Gate_s0_l4_tp2&#45;&gt;Expert11_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5816.56,-14242C5837.98,-14232.08 5862.68,-14220.65 5884.92,-14210.36"/>
<polygon fill="black" stroke="black" points="5886.68,-14213.4 5894.29,-14206.03 5883.74,-14207.05 5886.68,-14213.4"/>
</g>
<!-- Expert12_s0_l4_tp3 -->
<g id="node337" class="node">
<title>Expert12_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8059.42,-14206.01 7751.42,-14206.01 7751.42,-14153.01 8059.42,-14153.01 8059.42,-14206.01"/>
<text text-anchor="middle" x="7905.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="7905.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7905.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp3&#45;&gt;Expert12_s0_l4_tp3 -->
<g id="edge541" class="edge">
<title>Gate_s0_l4_tp3&#45;&gt;Expert12_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8388.37,-14247.52C8296.87,-14236.39 8181.63,-14221.88 8069.94,-14206.21"/>
<polygon fill="black" stroke="black" points="8070.23,-14202.72 8059.84,-14204.79 8069.25,-14209.65 8070.23,-14202.72"/>
</g>
<!-- Expert13_s0_l4_tp3 -->
<g id="node338" class="node">
<title>Expert13_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8385.42,-14206.01 8077.42,-14206.01 8077.42,-14153.01 8385.42,-14153.01 8385.42,-14206.01"/>
<text text-anchor="middle" x="8231.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="8231.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8231.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp3&#45;&gt;Expert13_s0_l4_tp3 -->
<g id="edge542" class="edge">
<title>Gate_s0_l4_tp3&#45;&gt;Expert13_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8461.81,-14242C8422.59,-14231.53 8377.04,-14219.37 8336.85,-14208.65"/>
<polygon fill="black" stroke="black" points="8337.59,-14205.22 8327.03,-14206.03 8335.79,-14211.99 8337.59,-14205.22"/>
</g>
<!-- Expert14_s0_l4_tp3 -->
<g id="node339" class="node">
<title>Expert14_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="8711.42,-14206.01 8403.42,-14206.01 8403.42,-14153.01 8711.42,-14153.01 8711.42,-14206.01"/>
<text text-anchor="middle" x="8557.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="8557.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8557.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp3&#45;&gt;Expert14_s0_l4_tp3 -->
<g id="edge543" class="edge">
<title>Gate_s0_l4_tp3&#45;&gt;Expert14_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8557.42,-14241.88C8557.42,-14233.9 8557.42,-14224.95 8557.42,-14216.4"/>
<polygon fill="black" stroke="black" points="8560.92,-14216.26 8557.42,-14206.26 8553.92,-14216.26 8560.92,-14216.26"/>
</g>
<!-- Expert15_s0_l4_tp3 -->
<g id="node340" class="node">
<title>Expert15_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="9037.42,-14206.01 8729.42,-14206.01 8729.42,-14153.01 9037.42,-14153.01 9037.42,-14206.01"/>
<text text-anchor="middle" x="8883.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="8883.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8883.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp3&#45;&gt;Expert15_s0_l4_tp3 -->
<g id="edge544" class="edge">
<title>Gate_s0_l4_tp3&#45;&gt;Expert15_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8653.03,-14242C8692.26,-14231.53 8737.8,-14219.37 8777.99,-14208.65"/>
<polygon fill="black" stroke="black" points="8779.06,-14211.99 8787.82,-14206.03 8777.25,-14205.22 8779.06,-14211.99"/>
</g>
<!-- Expert16_s0_l4_tp4 -->
<g id="node341" class="node">
<title>Expert16_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="9363.42,-14206.01 9055.42,-14206.01 9055.42,-14153.01 9363.42,-14153.01 9363.42,-14206.01"/>
<text text-anchor="middle" x="9209.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="9209.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9209.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp4&#45;&gt;Expert16_s0_l4_tp4 -->
<g id="edge545" class="edge">
<title>Gate_s0_l4_tp4&#45;&gt;Expert16_s0_l4_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9561.37,-14242C9499.8,-14231.24 9428.04,-14218.71 9365.44,-14207.77"/>
<polygon fill="black" stroke="black" points="9365.92,-14204.3 9355.47,-14206.03 9364.72,-14211.2 9365.92,-14204.3"/>
</g>
<!-- Expert17_s0_l4_tp4 -->
<g id="node342" class="node">
<title>Expert17_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="9689.42,-14206.01 9381.42,-14206.01 9381.42,-14153.01 9689.42,-14153.01 9689.42,-14206.01"/>
<text text-anchor="middle" x="9535.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="9535.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9535.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp4&#45;&gt;Expert17_s0_l4_tp4 -->
<g id="edge546" class="edge">
<title>Gate_s0_l4_tp4&#45;&gt;Expert17_s0_l4_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9656.75,-14241.88C9637.41,-14232.1 9615.19,-14220.86 9595.1,-14210.7"/>
<polygon fill="black" stroke="black" points="9596.54,-14207.5 9586.03,-14206.11 9593.38,-14213.75 9596.54,-14207.5"/>
</g>
<!-- Expert18_s0_l4_tp4 -->
<g id="node343" class="node">
<title>Expert18_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="10015.42,-14206.01 9707.42,-14206.01 9707.42,-14153.01 10015.42,-14153.01 10015.42,-14206.01"/>
<text text-anchor="middle" x="9861.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="9861.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9861.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp4&#45;&gt;Expert18_s0_l4_tp4 -->
<g id="edge547" class="edge">
<title>Gate_s0_l4_tp4&#45;&gt;Expert18_s0_l4_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9752.79,-14241.88C9769.79,-14232.28 9789.28,-14221.27 9807.02,-14211.25"/>
<polygon fill="black" stroke="black" points="9809.12,-14214.08 9816.11,-14206.11 9805.68,-14207.98 9809.12,-14214.08"/>
</g>
<!-- Expert19_s0_l4_tp4 -->
<g id="node344" class="node">
<title>Expert19_s0_l4_tp4</title>
<polygon fill="none" stroke="black" points="10341.42,-14206.01 10033.42,-14206.01 10033.42,-14153.01 10341.42,-14153.01 10341.42,-14206.01"/>
<text text-anchor="middle" x="10187.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="10187.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10187.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp4&#45;&gt;Expert19_s0_l4_tp4 -->
<g id="edge548" class="edge">
<title>Gate_s0_l4_tp4&#45;&gt;Expert19_s0_l4_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9848.2,-14242C9907.42,-14231.26 9976.42,-14218.76 10036.67,-14207.84"/>
<polygon fill="black" stroke="black" points="10037.44,-14211.25 10046.65,-14206.03 10036.19,-14204.37 10037.44,-14211.25"/>
</g>
<!-- Expert20_s0_l4_tp5 -->
<g id="node345" class="node">
<title>Expert20_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="2843.42,-14206.01 2535.42,-14206.01 2535.42,-14153.01 2843.42,-14153.01 2843.42,-14206.01"/>
<text text-anchor="middle" x="2689.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="2689.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2689.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp5&#45;&gt;Expert20_s0_l4_tp5 -->
<g id="edge549" class="edge">
<title>Gate_s0_l4_tp5&#45;&gt;Expert20_s0_l4_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3172.37,-14247.52C3080.87,-14236.39 2965.63,-14221.88 2853.94,-14206.21"/>
<polygon fill="black" stroke="black" points="2854.23,-14202.72 2843.84,-14204.79 2853.25,-14209.65 2854.23,-14202.72"/>
</g>
<!-- Expert21_s0_l4_tp5 -->
<g id="node346" class="node">
<title>Expert21_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="3169.42,-14206.01 2861.42,-14206.01 2861.42,-14153.01 3169.42,-14153.01 3169.42,-14206.01"/>
<text text-anchor="middle" x="3015.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="3015.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3015.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp5&#45;&gt;Expert21_s0_l4_tp5 -->
<g id="edge550" class="edge">
<title>Gate_s0_l4_tp5&#45;&gt;Expert21_s0_l4_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3245.81,-14242C3206.59,-14231.53 3161.04,-14219.37 3120.85,-14208.65"/>
<polygon fill="black" stroke="black" points="3121.59,-14205.22 3111.03,-14206.03 3119.79,-14211.99 3121.59,-14205.22"/>
</g>
<!-- Expert22_s0_l4_tp5 -->
<g id="node347" class="node">
<title>Expert22_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="3495.42,-14206.01 3187.42,-14206.01 3187.42,-14153.01 3495.42,-14153.01 3495.42,-14206.01"/>
<text text-anchor="middle" x="3341.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="3341.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3341.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp5&#45;&gt;Expert22_s0_l4_tp5 -->
<g id="edge551" class="edge">
<title>Gate_s0_l4_tp5&#45;&gt;Expert22_s0_l4_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3341.42,-14241.88C3341.42,-14233.9 3341.42,-14224.95 3341.42,-14216.4"/>
<polygon fill="black" stroke="black" points="3344.92,-14216.26 3341.42,-14206.26 3337.92,-14216.26 3344.92,-14216.26"/>
</g>
<!-- Expert23_s0_l4_tp5 -->
<g id="node348" class="node">
<title>Expert23_s0_l4_tp5</title>
<polygon fill="none" stroke="black" points="3821.42,-14206.01 3513.42,-14206.01 3513.42,-14153.01 3821.42,-14153.01 3821.42,-14206.01"/>
<text text-anchor="middle" x="3667.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="3667.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3667.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp5&#45;&gt;Expert23_s0_l4_tp5 -->
<g id="edge552" class="edge">
<title>Gate_s0_l4_tp5&#45;&gt;Expert23_s0_l4_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3437.03,-14242C3476.26,-14231.53 3521.8,-14219.37 3561.99,-14208.65"/>
<polygon fill="black" stroke="black" points="3563.06,-14211.99 3571.82,-14206.03 3561.25,-14205.22 3563.06,-14211.99"/>
</g>
<!-- Expert24_s0_l4_tp6 -->
<g id="node349" class="node">
<title>Expert24_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="11971.42,-14206.01 11663.42,-14206.01 11663.42,-14153.01 11971.42,-14153.01 11971.42,-14206.01"/>
<text text-anchor="middle" x="11817.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="11817.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11817.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp6&#45;&gt;Expert24_s0_l4_tp6 -->
<g id="edge553" class="edge">
<title>Gate_s0_l4_tp6&#45;&gt;Expert24_s0_l4_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12047.81,-14242C12008.59,-14231.53 11963.04,-14219.37 11922.85,-14208.65"/>
<polygon fill="black" stroke="black" points="11923.59,-14205.22 11913.03,-14206.03 11921.79,-14211.99 11923.59,-14205.22"/>
</g>
<!-- Expert25_s0_l4_tp6 -->
<g id="node350" class="node">
<title>Expert25_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="12297.42,-14206.01 11989.42,-14206.01 11989.42,-14153.01 12297.42,-14153.01 12297.42,-14206.01"/>
<text text-anchor="middle" x="12143.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="12143.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12143.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp6&#45;&gt;Expert25_s0_l4_tp6 -->
<g id="edge554" class="edge">
<title>Gate_s0_l4_tp6&#45;&gt;Expert25_s0_l4_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12143.42,-14241.88C12143.42,-14233.9 12143.42,-14224.95 12143.42,-14216.4"/>
<polygon fill="black" stroke="black" points="12146.92,-14216.26 12143.42,-14206.26 12139.92,-14216.26 12146.92,-14216.26"/>
</g>
<!-- Expert26_s0_l4_tp6 -->
<g id="node351" class="node">
<title>Expert26_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="12623.42,-14206.01 12315.42,-14206.01 12315.42,-14153.01 12623.42,-14153.01 12623.42,-14206.01"/>
<text text-anchor="middle" x="12469.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="12469.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12469.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp6&#45;&gt;Expert26_s0_l4_tp6 -->
<g id="edge555" class="edge">
<title>Gate_s0_l4_tp6&#45;&gt;Expert26_s0_l4_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12239.03,-14242C12278.26,-14231.53 12323.8,-14219.37 12363.99,-14208.65"/>
<polygon fill="black" stroke="black" points="12365.06,-14211.99 12373.82,-14206.03 12363.25,-14205.22 12365.06,-14211.99"/>
</g>
<!-- Expert27_s0_l4_tp6 -->
<g id="node352" class="node">
<title>Expert27_s0_l4_tp6</title>
<polygon fill="none" stroke="black" points="12949.42,-14206.01 12641.42,-14206.01 12641.42,-14153.01 12949.42,-14153.01 12949.42,-14206.01"/>
<text text-anchor="middle" x="12795.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="12795.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12795.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp6&#45;&gt;Expert27_s0_l4_tp6 -->
<g id="edge556" class="edge">
<title>Gate_s0_l4_tp6&#45;&gt;Expert27_s0_l4_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12312.47,-14247.52C12403.97,-14236.39 12519.22,-14221.88 12630.9,-14206.21"/>
<polygon fill="black" stroke="black" points="12631.59,-14209.65 12641.01,-14204.79 12630.62,-14202.72 12631.59,-14209.65"/>
</g>
<!-- Expert28_s0_l4_tp7 -->
<g id="node353" class="node">
<title>Expert28_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="10667.42,-14206.01 10359.42,-14206.01 10359.42,-14153.01 10667.42,-14153.01 10667.42,-14206.01"/>
<text text-anchor="middle" x="10513.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="10513.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10513.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp7&#45;&gt;Expert28_s0_l4_tp7 -->
<g id="edge557" class="edge">
<title>Gate_s0_l4_tp7&#45;&gt;Expert28_s0_l4_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10743.81,-14242C10704.59,-14231.53 10659.04,-14219.37 10618.85,-14208.65"/>
<polygon fill="black" stroke="black" points="10619.59,-14205.22 10609.03,-14206.03 10617.79,-14211.99 10619.59,-14205.22"/>
</g>
<!-- Expert29_s0_l4_tp7 -->
<g id="node354" class="node">
<title>Expert29_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="10993.42,-14206.01 10685.42,-14206.01 10685.42,-14153.01 10993.42,-14153.01 10993.42,-14206.01"/>
<text text-anchor="middle" x="10839.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="10839.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10839.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp7&#45;&gt;Expert29_s0_l4_tp7 -->
<g id="edge558" class="edge">
<title>Gate_s0_l4_tp7&#45;&gt;Expert29_s0_l4_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10839.42,-14241.88C10839.42,-14233.9 10839.42,-14224.95 10839.42,-14216.4"/>
<polygon fill="black" stroke="black" points="10842.92,-14216.26 10839.42,-14206.26 10835.92,-14216.26 10842.92,-14216.26"/>
</g>
<!-- Expert30_s0_l4_tp7 -->
<g id="node355" class="node">
<title>Expert30_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="11319.42,-14206.01 11011.42,-14206.01 11011.42,-14153.01 11319.42,-14153.01 11319.42,-14206.01"/>
<text text-anchor="middle" x="11165.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="11165.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11165.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp7&#45;&gt;Expert30_s0_l4_tp7 -->
<g id="edge559" class="edge">
<title>Gate_s0_l4_tp7&#45;&gt;Expert30_s0_l4_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10935.03,-14242C10974.26,-14231.53 11019.8,-14219.37 11059.99,-14208.65"/>
<polygon fill="black" stroke="black" points="11061.06,-14211.99 11069.82,-14206.03 11059.25,-14205.22 11061.06,-14211.99"/>
</g>
<!-- Expert31_s0_l4_tp7 -->
<g id="node356" class="node">
<title>Expert31_s0_l4_tp7</title>
<polygon fill="none" stroke="black" points="11645.42,-14206.01 11337.42,-14206.01 11337.42,-14153.01 11645.42,-14153.01 11645.42,-14206.01"/>
<text text-anchor="middle" x="11491.42" y="-14190.81" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="11491.42" y="-14175.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11491.42" y="-14160.81" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l4_tp7&#45;&gt;Expert31_s0_l4_tp7 -->
<g id="edge560" class="edge">
<title>Gate_s0_l4_tp7&#45;&gt;Expert31_s0_l4_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11008.47,-14247.52C11099.97,-14236.39 11215.22,-14221.88 11326.9,-14206.21"/>
<polygon fill="black" stroke="black" points="11327.59,-14209.65 11337.01,-14204.79 11326.62,-14202.72 11327.59,-14209.65"/>
</g>
<!-- AR_exp_s0_l4 -->
<g id="node357" class="node">
<title>AR_exp_s0_l4</title>
<ellipse fill="none" stroke="black" cx="7709.42" cy="-14079.54" rx="239" ry="37.45"/>
<text text-anchor="middle" x="7709.42" y="-14090.84" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="7709.42" y="-14075.84" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7709.42" y="-14060.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l4_tp0&#45;&gt;AR_exp_s0_l4 -->
<g id="edge561" class="edge">
<title>Expert0_s0_l4_tp0&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M7372.34,-14152.96C7430.08,-14140.56 7500.04,-14125.52 7561.22,-14112.38"/>
<polygon fill="black" stroke="black" points="7562.31,-14115.72 7571.35,-14110.2 7560.84,-14108.88 7562.31,-14115.72"/>
</g>
<!-- Expert1_s0_l4_tp0&#45;&gt;AR_exp_s0_l4 -->
<g id="edge562" class="edge">
<title>Expert1_s0_l4_tp0&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M7613.58,-14152.77C7625.79,-14143.57 7639.89,-14132.94 7653.46,-14122.72"/>
<polygon fill="black" stroke="black" points="7655.93,-14125.23 7661.81,-14116.42 7651.72,-14119.64 7655.93,-14125.23"/>
</g>
<!-- Expert2_s0_l4_tp0&#45;&gt;AR_exp_s0_l4 -->
<g id="edge563" class="edge">
<title>Expert2_s0_l4_tp0&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M6755.81,-14154.04C6758.71,-14153.69 6761.58,-14153.34 6764.42,-14153.01 7006.08,-14124.89 7283.82,-14105.07 7475.35,-14093.35"/>
<polygon fill="black" stroke="black" points="7475.78,-14096.83 7485.55,-14092.73 7475.36,-14089.85 7475.78,-14096.83"/>
</g>
<!-- Expert3_s0_l4_tp0&#45;&gt;AR_exp_s0_l4 -->
<g id="edge564" class="edge">
<title>Expert3_s0_l4_tp0&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M7081.83,-14154.2C7084.72,-14153.8 7087.58,-14153.4 7090.42,-14153.01 7228.32,-14134.16 7383.92,-14115.95 7504.62,-14102.51"/>
<polygon fill="black" stroke="black" points="7505.17,-14105.97 7514.72,-14101.38 7504.39,-14099.01 7505.17,-14105.97"/>
</g>
<!-- Expert4_s0_l4_tp1&#45;&gt;AR_exp_s0_l4 -->
<g id="edge565" class="edge">
<title>Expert4_s0_l4_tp1&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M4799.79,-14153.84C4802.69,-14153.55 4805.57,-14153.27 4808.42,-14153.01 5319.84,-14106.82 6856.22,-14088.24 7460.97,-14082.58"/>
<polygon fill="black" stroke="black" points="7461.16,-14086.08 7471.13,-14082.49 7461.09,-14079.08 7461.16,-14086.08"/>
</g>
<!-- Expert5_s0_l4_tp1&#45;&gt;AR_exp_s0_l4 -->
<g id="edge566" class="edge">
<title>Expert5_s0_l4_tp1&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M5125.79,-14153.85C5128.69,-14153.56 5131.57,-14153.28 5134.42,-14153.01 5580.79,-14111.98 6906.95,-14090.77 7461.41,-14083.5"/>
<polygon fill="black" stroke="black" points="7461.58,-14086.99 7471.54,-14083.36 7461.49,-14080 7461.58,-14086.99"/>
</g>
<!-- Expert6_s0_l4_tp1&#45;&gt;AR_exp_s0_l4 -->
<g id="edge567" class="edge">
<title>Expert6_s0_l4_tp1&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M4147.79,-14153.82C4150.69,-14153.53 4153.57,-14153.26 4156.42,-14153.01 4799.07,-14096.45 6762.83,-14083.93 7460.37,-14081.25"/>
<polygon fill="black" stroke="black" points="7460.55,-14084.75 7470.54,-14081.21 7460.53,-14077.75 7460.55,-14084.75"/>
</g>
<!-- Expert7_s0_l4_tp1&#45;&gt;AR_exp_s0_l4 -->
<g id="edge568" class="edge">
<title>Expert7_s0_l4_tp1&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M4473.79,-14153.83C4476.69,-14153.54 4479.57,-14153.27 4482.42,-14153.01 5059.2,-14101.65 6807.8,-14085.98 7460.34,-14081.85"/>
<polygon fill="black" stroke="black" points="7460.83,-14085.35 7470.81,-14081.79 7460.79,-14078.35 7460.83,-14085.35"/>
</g>
<!-- Expert8_s0_l4_tp2&#45;&gt;AR_exp_s0_l4 -->
<g id="edge569" class="edge">
<title>Expert8_s0_l4_tp2&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M6429.81,-14153.97C6432.7,-14153.63 6435.57,-14153.32 6438.42,-14153.01 6794.37,-14115.11 7208.66,-14096.16 7465,-14087.35"/>
<polygon fill="black" stroke="black" points="7465.31,-14090.84 7475.19,-14087 7465.08,-14083.84 7465.31,-14090.84"/>
</g>
<!-- Expert9_s0_l4_tp2&#45;&gt;AR_exp_s0_l4 -->
<g id="edge570" class="edge">
<title>Expert9_s0_l4_tp2&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M5451.8,-14153.87C5454.69,-14153.57 5457.57,-14153.28 5460.42,-14153.01 5842.24,-14117.13 6961.24,-14093.66 7462.1,-14084.66"/>
<polygon fill="black" stroke="black" points="7462.42,-14088.16 7472.35,-14084.48 7462.29,-14081.16 7462.42,-14088.16"/>
</g>
<!-- Expert10_s0_l4_tp2&#45;&gt;AR_exp_s0_l4 -->
<g id="edge571" class="edge">
<title>Expert10_s0_l4_tp2&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M5777.8,-14153.89C5780.69,-14153.58 5783.57,-14153.29 5786.42,-14153.01 6385.21,-14095.09 7093.03,-14082.8 7460.26,-14080.6"/>
<polygon fill="black" stroke="black" points="7460.51,-14084.09 7470.49,-14080.54 7460.47,-14077.09 7460.51,-14084.09"/>
</g>
<!-- Expert11_s0_l4_tp2&#45;&gt;AR_exp_s0_l4 -->
<g id="edge572" class="edge">
<title>Expert11_s0_l4_tp2&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M6103.8,-14153.92C6106.7,-14153.6 6109.57,-14153.3 6112.42,-14153.01 6588.1,-14105.16 7146.69,-14088.89 7461.24,-14083.37"/>
<polygon fill="black" stroke="black" points="7461.47,-14086.86 7471.4,-14083.19 7461.35,-14079.86 7461.47,-14086.86"/>
</g>
<!-- Expert12_s0_l4_tp3&#45;&gt;AR_exp_s0_l4 -->
<g id="edge573" class="edge">
<title>Expert12_s0_l4_tp3&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M7854.18,-14152.9C7834.04,-14142.83 7810.47,-14131.05 7788.26,-14119.94"/>
<polygon fill="black" stroke="black" points="7789.68,-14116.74 7779.17,-14115.4 7786.55,-14123 7789.68,-14116.74"/>
</g>
<!-- Expert13_s0_l4_tp3&#45;&gt;AR_exp_s0_l4 -->
<g id="edge574" class="edge">
<title>Expert13_s0_l4_tp3&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M8095.3,-14152.96C8026.2,-14139.99 7941.82,-14124.16 7869.61,-14110.6"/>
<polygon fill="black" stroke="black" points="7869.98,-14107.11 7859.51,-14108.71 7868.69,-14113.99 7869.98,-14107.11"/>
</g>
<!-- Expert14_s0_l4_tp3&#45;&gt;AR_exp_s0_l4 -->
<g id="edge575" class="edge">
<title>Expert14_s0_l4_tp3&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M8403.02,-14154.16C8400.13,-14153.77 8397.26,-14153.39 8394.42,-14153.01 8236.67,-14132.34 8057.87,-14113.58 7922.51,-14100.33"/>
<polygon fill="black" stroke="black" points="7922.72,-14096.83 7912.43,-14099.34 7922.04,-14103.8 7922.72,-14096.83"/>
</g>
<!-- Expert15_s0_l4_tp3&#45;&gt;AR_exp_s0_l4 -->
<g id="edge576" class="edge">
<title>Expert15_s0_l4_tp3&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M8729.03,-14154.02C8726.14,-14153.67 8723.27,-14153.34 8720.42,-14153.01 8456.15,-14122.92 8151.51,-14103.1 7946.29,-14091.91"/>
<polygon fill="black" stroke="black" points="7946.46,-14088.41 7936.29,-14091.36 7946.08,-14095.4 7946.46,-14088.41"/>
</g>
<!-- Expert16_s0_l4_tp4&#45;&gt;AR_exp_s0_l4 -->
<g id="edge577" class="edge">
<title>Expert16_s0_l4_tp4&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M9055.04,-14153.96C9052.15,-14153.63 9049.27,-14153.31 9046.42,-14153.01 8666.67,-14113.12 8223.79,-14094.58 7955.14,-14086.42"/>
<polygon fill="black" stroke="black" points="7954.97,-14082.91 7944.87,-14086.11 7954.76,-14089.91 7954.97,-14082.91"/>
</g>
<!-- Expert17_s0_l4_tp4&#45;&gt;AR_exp_s0_l4 -->
<g id="edge578" class="edge">
<title>Expert17_s0_l4_tp4&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M9381.04,-14153.91C9378.15,-14153.6 9375.27,-14153.3 9372.42,-14153.01 8872.03,-14103.13 8283.55,-14087.57 7957.92,-14082.73"/>
<polygon fill="black" stroke="black" points="7957.94,-14079.23 7947.89,-14082.58 7957.83,-14086.22 7957.94,-14079.23"/>
</g>
<!-- Expert18_s0_l4_tp4&#45;&gt;AR_exp_s0_l4 -->
<g id="edge579" class="edge">
<title>Expert18_s0_l4_tp4&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M9707.05,-14153.89C9704.15,-14153.58 9701.27,-14153.29 9698.42,-14153.01 9074.45,-14093.05 8336.02,-14081.68 7958.68,-14080.14"/>
<polygon fill="black" stroke="black" points="7958.47,-14076.64 7948.45,-14080.1 7958.44,-14083.64 7958.47,-14076.64"/>
</g>
<!-- Expert19_s0_l4_tp4&#45;&gt;AR_exp_s0_l4 -->
<g id="edge580" class="edge">
<title>Expert19_s0_l4_tp4&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M10033.05,-14153.87C10030.15,-14153.56 10027.27,-14153.28 10024.42,-14153.01 9629.56,-14116.09 8468.77,-14093.04 7956.82,-14084.4"/>
<polygon fill="black" stroke="black" points="7956.77,-14080.9 7946.71,-14084.23 7956.65,-14087.9 7956.77,-14080.9"/>
</g>
<!-- Expert20_s0_l4_tp5&#45;&gt;AR_exp_s0_l4 -->
<g id="edge581" class="edge">
<title>Expert20_s0_l4_tp5&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M2843.79,-14153.8C2846.69,-14153.52 2849.57,-14153.26 2852.42,-14153.01 3312.03,-14113.83 6533.69,-14088.68 7460.54,-14082.2"/>
<polygon fill="black" stroke="black" points="7460.69,-14085.7 7470.66,-14082.13 7460.64,-14078.7 7460.69,-14085.7"/>
</g>
<!-- Expert21_s0_l4_tp5&#45;&gt;AR_exp_s0_l4 -->
<g id="edge582" class="edge">
<title>Expert21_s0_l4_tp5&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M3169.79,-14153.8C3172.69,-14153.52 3175.57,-14153.26 3178.42,-14153.01 4020.13,-14080.8 6638.39,-14078.74 7460.1,-14079.95"/>
<polygon fill="black" stroke="black" points="7460.27,-14083.45 7470.28,-14079.97 7460.28,-14076.45 7460.27,-14083.45"/>
</g>
<!-- Expert22_s0_l4_tp5&#45;&gt;AR_exp_s0_l4 -->
<g id="edge583" class="edge">
<title>Expert22_s0_l4_tp5&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M3495.79,-14153.81C3498.69,-14153.53 3501.57,-14153.26 3504.42,-14153.01 4279.47,-14086.03 6677.74,-14080.34 7459.94,-14080.32"/>
<polygon fill="black" stroke="black" points="7460.2,-14083.82 7470.2,-14080.32 7460.2,-14076.82 7460.2,-14083.82"/>
</g>
<!-- Expert23_s0_l4_tp5&#45;&gt;AR_exp_s0_l4 -->
<g id="edge584" class="edge">
<title>Expert23_s0_l4_tp5&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M3821.79,-14153.82C3824.69,-14153.53 3827.57,-14153.26 3830.42,-14153.01 4539.13,-14091.25 6719.28,-14082.07 7460.08,-14080.74"/>
<polygon fill="black" stroke="black" points="7460.35,-14084.24 7470.34,-14080.73 7460.34,-14077.24 7460.35,-14084.24"/>
</g>
<!-- Expert24_s0_l4_tp6&#45;&gt;AR_exp_s0_l4 -->
<g id="edge585" class="edge">
<title>Expert24_s0_l4_tp6&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M11663.05,-14153.81C11660.16,-14153.53 11657.28,-14153.26 11654.42,-14153.01 10932.29,-14090.19 8708.02,-14081.71 7958.75,-14080.65"/>
<polygon fill="black" stroke="black" points="7958.65,-14077.15 7948.64,-14080.64 7958.64,-14084.15 7958.65,-14077.15"/>
</g>
<!-- Expert25_s0_l4_tp6&#45;&gt;AR_exp_s0_l4 -->
<g id="edge586" class="edge">
<title>Expert25_s0_l4_tp6&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M11989.05,-14153.81C11986.16,-14153.53 11983.28,-14153.26 11980.42,-14153.01 11191.85,-14084.97 8748.87,-14080.01 7958.72,-14080.24"/>
<polygon fill="black" stroke="black" points="7958.64,-14076.74 7948.64,-14080.24 7958.64,-14083.74 7958.64,-14076.74"/>
</g>
<!-- Expert26_s0_l4_tp6&#45;&gt;AR_exp_s0_l4 -->
<g id="edge587" class="edge">
<title>Expert26_s0_l4_tp6&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M12315.05,-14153.8C12312.16,-14153.52 12309.28,-14153.26 12306.42,-14153.01 11451.21,-14079.74 8788.35,-14078.43 7958.77,-14079.88"/>
<polygon fill="black" stroke="black" points="7958.49,-14076.38 7948.49,-14079.9 7958.5,-14083.38 7958.49,-14076.38"/>
</g>
<!-- Expert27_s0_l4_tp6&#45;&gt;AR_exp_s0_l4 -->
<g id="edge588" class="edge">
<title>Expert27_s0_l4_tp6&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M12641.06,-14153.8C12638.16,-14153.52 12635.28,-14153.26 12632.42,-14153.01 12165.97,-14113.29 8892.76,-14088.48 7958.09,-14082.15"/>
<polygon fill="black" stroke="black" points="7957.91,-14078.64 7947.88,-14082.08 7957.86,-14085.64 7957.91,-14078.64"/>
</g>
<!-- Expert28_s0_l4_tp7&#45;&gt;AR_exp_s0_l4 -->
<g id="edge589" class="edge">
<title>Expert28_s0_l4_tp7&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M10359.05,-14153.85C10356.15,-14153.55 10353.27,-14153.27 10350.42,-14153.01 9890.98,-14110.94 8522.75,-14090.24 7957.74,-14083.3"/>
<polygon fill="black" stroke="black" points="7957.47,-14079.79 7947.43,-14083.17 7957.38,-14086.79 7957.47,-14079.79"/>
</g>
<!-- Expert29_s0_l4_tp7&#45;&gt;AR_exp_s0_l4 -->
<g id="edge590" class="edge">
<title>Expert29_s0_l4_tp7&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M10685.05,-14153.84C10682.15,-14153.55 10679.28,-14153.27 10676.42,-14153.01 10151.85,-14105.78 8572.92,-14087.76 7958.18,-14082.42"/>
<polygon fill="black" stroke="black" points="7957.88,-14078.92 7947.85,-14082.33 7957.82,-14085.92 7957.88,-14078.92"/>
</g>
<!-- Expert30_s0_l4_tp7&#45;&gt;AR_exp_s0_l4 -->
<g id="edge591" class="edge">
<title>Expert30_s0_l4_tp7&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M11011.05,-14153.83C11008.15,-14153.54 11005.28,-14153.27 11002.42,-14153.01 10412.28,-14100.59 8620.01,-14085.55 7958.33,-14081.72"/>
<polygon fill="black" stroke="black" points="7958.21,-14078.22 7948.19,-14081.66 7958.17,-14085.22 7958.21,-14078.22"/>
</g>
<!-- Expert31_s0_l4_tp7&#45;&gt;AR_exp_s0_l4 -->
<g id="edge592" class="edge">
<title>Expert31_s0_l4_tp7&#45;&gt;AR_exp_s0_l4</title>
<path fill="none" stroke="black" d="M11337.05,-14153.82C11334.15,-14153.53 11331.28,-14153.26 11328.42,-14153.01 10672.39,-14095.39 8664.77,-14083.54 7958.43,-14081.14"/>
<polygon fill="black" stroke="black" points="7958.39,-14077.64 7948.38,-14081.1 7958.37,-14084.64 7958.39,-14077.64"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp0 -->
<g id="edge593" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M7655.26,-14042.87C7640.49,-14033.14 7624.11,-14022.35 7607.99,-14011.73"/>
<polygon fill="black" stroke="black" points="7609.87,-14008.78 7599.59,-14006.2 7606.02,-14014.63 7609.87,-14008.78"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp1 -->
<g id="edge595" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M7480.41,-14068.63C7162.44,-14054.84 6569.2,-14028.97 6063.42,-14006.06 5790.53,-13993.7 5480.16,-13979.22 5255.96,-13968.68"/>
<polygon fill="black" stroke="black" points="5255.84,-13965.17 5245.69,-13968.2 5255.51,-13972.16 5255.84,-13965.17"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp2 -->
<g id="edge597" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M7508.68,-14059.12C7307.33,-14039.65 6993.71,-14009.31 6755.11,-13986.24"/>
<polygon fill="black" stroke="black" points="6755.17,-13982.73 6744.88,-13985.25 6754.49,-13989.69 6755.17,-13982.73"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp3 -->
<g id="edge599" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M7859.19,-14050.29C7941.57,-14034.75 8045.57,-14015.14 8138.15,-13997.68"/>
<polygon fill="black" stroke="black" points="8139.04,-14001.07 8148.22,-13995.78 8137.75,-13994.19 8139.04,-14001.07"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp4 -->
<g id="edge601" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp4</title>
<path fill="none" stroke="black" d="M7937.04,-14068.03C8431.78,-14045.2 9603.28,-13991.13 10135.24,-13966.58"/>
<polygon fill="black" stroke="black" points="10135.53,-13970.07 10145.36,-13966.11 10135.21,-13963.07 10135.53,-13970.07"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp5 -->
<g id="edge603" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp5</title>
<path fill="none" stroke="black" d="M7473.45,-14073.42C6952.61,-14062.06 5665.29,-14033.53 4587.42,-14006.06 4032.65,-13991.92 3385.54,-13973.55 3015.21,-13962.85"/>
<polygon fill="black" stroke="black" points="3015.25,-13959.35 3005.15,-13962.56 3015.05,-13966.35 3015.25,-13959.35"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp6 -->
<g id="edge605" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp6</title>
<path fill="none" stroke="black" d="M7947.78,-14076.5C8745.16,-14069.39 11315.69,-14044.03 12143.42,-14006.06 12286.34,-13999.5 12445.64,-13987.77 12575.04,-13977.11"/>
<polygon fill="black" stroke="black" points="12575.41,-13980.59 12585.09,-13976.27 12574.84,-13973.61 12575.41,-13980.59"/>
</g>
<!-- AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp7 -->
<g id="edge607" class="edge">
<title>AR_exp_s0_l4&#45;&gt;ResMOE_s0_l4_tp7</title>
<path fill="none" stroke="black" d="M7946.75,-14075.11C8460.71,-14067.21 9715.03,-14045.31 10765.42,-14006.06 11020.68,-13996.52 11311.69,-13981.23 11517.19,-13969.69"/>
<polygon fill="black" stroke="black" points="11517.43,-13973.18 11527.21,-13969.13 11517.03,-13966.2 11517.43,-13973.18"/>
</g>
<!-- QKV_s0_l5_tp0 -->
<g id="node366" class="node">
<title>QKV_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6756.42,-13864.06 6418.42,-13864.06 6418.42,-13811.06 6756.42,-13811.06 6756.42,-13864.06"/>
<text text-anchor="middle" x="6587.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6587.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6587.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp0 -->
<g id="edge609" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7187.85,-13913.22C7060.94,-13898.18 6914.94,-13880.62 6782.42,-13864.06 6777.26,-13863.41 6772.02,-13862.76 6766.74,-13862.09"/>
<polygon fill="black" stroke="black" points="6766.88,-13858.58 6756.52,-13860.79 6766,-13865.52 6766.88,-13858.58"/>
</g>
<!-- QKV_s0_l5_tp1 -->
<g id="node367" class="node">
<title>QKV_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="7129.42,-13864.06 6791.42,-13864.06 6791.42,-13811.06 7129.42,-13811.06 7129.42,-13864.06"/>
<text text-anchor="middle" x="6960.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6960.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6960.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp1 -->
<g id="edge610" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M7263.78,-13900.04C7206.04,-13888.34 7146.98,-13876.37 7096.49,-13866.14"/>
<polygon fill="black" stroke="black" points="7097,-13862.67 7086.51,-13864.11 7095.61,-13869.53 7097,-13862.67"/>
</g>
<!-- QKV_s0_l5_tp2 -->
<g id="node368" class="node">
<title>QKV_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="7510.42,-13864.06 7172.42,-13864.06 7172.42,-13811.06 7510.42,-13811.06 7510.42,-13864.06"/>
<text text-anchor="middle" x="7341.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7341.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7341.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp2 -->
<g id="edge611" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7438.26,-13899.96C7421.82,-13889.54 7405.04,-13878.9 7390.18,-13869.47"/>
<polygon fill="black" stroke="black" points="7391.98,-13866.47 7381.66,-13864.07 7388.23,-13872.38 7391.98,-13866.47"/>
</g>
<!-- QKV_s0_l5_tp3 -->
<g id="node369" class="node">
<title>QKV_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="7875.42,-13864.06 7537.42,-13864.06 7537.42,-13811.06 7875.42,-13811.06 7875.42,-13864.06"/>
<text text-anchor="middle" x="7706.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7706.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7706.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp3 -->
<g id="edge612" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7605.8,-13899.96C7622.89,-13889.54 7640.31,-13878.9 7655.76,-13869.47"/>
<polygon fill="black" stroke="black" points="7657.9,-13872.27 7664.61,-13864.07 7654.25,-13866.29 7657.9,-13872.27"/>
</g>
<!-- QKV_s0_l5_tp4 -->
<g id="node370" class="node">
<title>QKV_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="8256.42,-13864.06 7918.42,-13864.06 7918.42,-13811.06 8256.42,-13811.06 8256.42,-13864.06"/>
<text text-anchor="middle" x="8087.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8087.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8087.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp4 -->
<g id="edge613" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M7738.83,-13908.34C7809.75,-13894.14 7886.42,-13878.8 7949.74,-13866.12"/>
<polygon fill="black" stroke="black" points="7950.67,-13869.5 7959.79,-13864.11 7949.3,-13862.64 7950.67,-13869.5"/>
</g>
<!-- QKV_s0_l5_tp5 -->
<g id="node371" class="node">
<title>QKV_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="8642.42,-13864.06 8304.42,-13864.06 8304.42,-13811.06 8642.42,-13811.06 8642.42,-13864.06"/>
<text text-anchor="middle" x="8473.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8473.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8473.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp5 -->
<g id="edge614" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M7759.93,-13924.04C7906.01,-13906.88 8096.52,-13884.39 8265.42,-13864.06 8274.81,-13862.93 8284.43,-13861.77 8294.14,-13860.59"/>
<polygon fill="black" stroke="black" points="8294.78,-13864.04 8304.29,-13859.36 8293.94,-13857.09 8294.78,-13864.04"/>
</g>
<!-- QKV_s0_l5_tp6 -->
<g id="node372" class="node">
<title>QKV_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="9030.42,-13864.06 8692.42,-13864.06 8692.42,-13811.06 9030.42,-13811.06 9030.42,-13864.06"/>
<text text-anchor="middle" x="8861.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8861.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8861.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp6 -->
<g id="edge615" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M7760.39,-13924.19C7839.89,-13915.6 7928.89,-13906.67 8010.42,-13900.06 8294.83,-13877 8367.2,-13889.27 8651.42,-13864.06 8661.47,-13863.17 8671.78,-13862.17 8682.18,-13861.11"/>
<polygon fill="black" stroke="black" points="8682.59,-13864.59 8692.18,-13860.07 8681.87,-13857.62 8682.59,-13864.59"/>
</g>
<!-- QKV_s0_l5_tp7 -->
<g id="node373" class="node">
<title>QKV_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="6366.42,-13864.06 6028.42,-13864.06 6028.42,-13811.06 6366.42,-13811.06 6366.42,-13864.06"/>
<text text-anchor="middle" x="6197.42" y="-13848.86" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6197.42" y="-13833.86" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6197.42" y="-13818.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp7 -->
<g id="edge616" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;QKV_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M7211.82,-13931C6988.71,-13914.95 6680.17,-13891.05 6409.42,-13864.06 6398.76,-13863 6387.8,-13861.85 6376.76,-13860.65"/>
<polygon fill="black" stroke="black" points="6376.91,-13857.14 6366.59,-13859.53 6376.15,-13864.1 6376.91,-13857.14"/>
</g>
<!-- ResAttn_s0_l5_tp0 -->
<g id="node400" class="node">
<title>ResAttn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6844.77,-13286.15 6287.45,-13286.15 6144.08,-13180.15 6701.4,-13180.15 6844.77,-13286.15"/>
<text text-anchor="middle" x="6494.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6494.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6494.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp0 -->
<g id="edge658" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7208.14,-13928.49C7076.47,-13918.96 6921.53,-13908.3 6781.42,-13900.06 6696.81,-13895.08 6092.36,-13907.25 6019.42,-13864.06 5968.1,-13833.67 5949.42,-13809.21 5949.42,-13749.56 5949.42,-13749.56 5949.42,-13749.56 5949.42,-13447.63 5949.42,-13375.48 6117.12,-13317.68 6266.47,-13280.52"/>
<polygon fill="black" stroke="black" points="6267.41,-13283.9 6276.28,-13278.1 6265.74,-13277.1 6267.41,-13283.9"/>
</g>
<!-- ResAttn_s0_l5_tp1 -->
<g id="node401" class="node">
<title>ResAttn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="4984.77,-13286.15 4427.45,-13286.15 4284.08,-13180.15 4841.4,-13180.15 4984.77,-13286.15"/>
<text text-anchor="middle" x="4634.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4634.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4634.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp1 -->
<g id="edge660" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M7206.4,-13927.13C7075.13,-13917.45 6920.96,-13907.03 6781.42,-13900.06 6240.97,-13873.06 6102.71,-13919.43 5564.42,-13864.06 5419.39,-13849.14 4918.42,-13895.35 4918.42,-13749.56 4918.42,-13749.56 4918.42,-13749.56 4918.42,-13447.63 4918.42,-13375.61 4859.35,-13324.88 4795.08,-13291"/>
<polygon fill="black" stroke="black" points="4796.48,-13287.78 4785.98,-13286.33 4793.28,-13294.01 4796.48,-13287.78"/>
</g>
<!-- ResAttn_s0_l5_tp2 -->
<g id="node402" class="node">
<title>ResAttn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="5905.77,-13286.15 5348.45,-13286.15 5205.08,-13180.15 5762.4,-13180.15 5905.77,-13286.15"/>
<text text-anchor="middle" x="5555.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5555.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5555.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp2 -->
<g id="edge662" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7208.16,-13928.24C7076.49,-13918.68 6921.55,-13908.05 6781.42,-13900.06 6415.89,-13879.21 6319.86,-13922.49 5958.42,-13864.06 5774.61,-13834.35 5555.42,-13935.76 5555.42,-13749.56 5555.42,-13749.56 5555.42,-13749.56 5555.42,-13447.63 5555.42,-13396.78 5555.42,-13339.13 5555.42,-13296.56"/>
<polygon fill="black" stroke="black" points="5558.92,-13296.35 5555.42,-13286.35 5551.92,-13296.35 5558.92,-13296.35"/>
</g>
<!-- ResAttn_s0_l5_tp3 -->
<g id="node403" class="node">
<title>ResAttn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8939.77,-13286.15 8382.45,-13286.15 8239.08,-13180.15 8796.4,-13180.15 8939.77,-13286.15"/>
<text text-anchor="middle" x="8589.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8589.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8589.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp3 -->
<g id="edge664" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7759.07,-13923.31C7838.88,-13914.61 7928.39,-13905.84 8010.42,-13900.06 8067.48,-13896.04 8990.21,-13893.22 9039.42,-13864.06 9090.34,-13833.89 9107.42,-13808.75 9107.42,-13749.56 9107.42,-13749.56 9107.42,-13749.56 9107.42,-13447.63 9107.42,-13383.33 9087.66,-13359.63 9035.42,-13322.15 9017.61,-13309.38 8986.54,-13298 8948.79,-13288.02"/>
<polygon fill="black" stroke="black" points="8949.61,-13284.62 8939.05,-13285.51 8947.86,-13291.4 8949.61,-13284.62"/>
</g>
<!-- ResAttn_s0_l5_tp4 -->
<g id="node404" class="node">
<title>ResAttn_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9851.77,-13286.15 9294.45,-13286.15 9151.08,-13180.15 9708.4,-13180.15 9851.77,-13286.15"/>
<text text-anchor="middle" x="9501.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9501.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9501.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp4 -->
<g id="edge666" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M7759.07,-13923.25C7838.88,-13914.54 7928.39,-13905.78 8010.42,-13900.06 8176.53,-13888.47 9501.42,-13916.07 9501.42,-13749.56 9501.42,-13749.56 9501.42,-13749.56 9501.42,-13447.63 9501.42,-13396.78 9501.42,-13339.13 9501.42,-13296.56"/>
<polygon fill="black" stroke="black" points="9504.92,-13296.35 9501.42,-13286.35 9497.92,-13296.35 9504.92,-13296.35"/>
</g>
<!-- ResAttn_s0_l5_tp5 -->
<g id="node405" class="node">
<title>ResAttn_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="3871.77,-13286.15 3314.45,-13286.15 3171.08,-13180.15 3728.4,-13180.15 3871.77,-13286.15"/>
<text text-anchor="middle" x="3521.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3521.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3521.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp5 -->
<g id="edge668" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M7205.52,-13926.38C7074.46,-13916.61 6920.67,-13906.33 6781.42,-13900.06 6376.64,-13881.83 5361.29,-13907.4 4958.42,-13864.06 4696.74,-13835.91 4377.42,-14012.75 4377.42,-13749.56 4377.42,-13749.56 4377.42,-13749.56 4377.42,-13447.63 4377.42,-13332.35 4081.43,-13278.83 3837.55,-13254.3"/>
<polygon fill="black" stroke="black" points="3837.73,-13250.8 3827.44,-13253.29 3837.04,-13257.76 3837.73,-13250.8"/>
</g>
<!-- ResAttn_s0_l5_tp6 -->
<g id="node406" class="node">
<title>ResAttn_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="11895.77,-13286.15 11338.45,-13286.15 11195.08,-13180.15 11752.4,-13180.15 11895.77,-13286.15"/>
<text text-anchor="middle" x="11545.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11545.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11545.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp6 -->
<g id="edge670" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M7758.09,-13922.65C7838.13,-13913.87 7928.03,-13905.21 8010.42,-13900.06 8182.62,-13889.3 11112.42,-13922.1 11112.42,-13749.56 11112.42,-13749.56 11112.42,-13749.56 11112.42,-13447.63 11112.42,-13349.89 11202.27,-13296.9 11300.12,-13268.17"/>
<polygon fill="black" stroke="black" points="11301.26,-13271.48 11309.92,-13265.38 11299.34,-13264.75 11301.26,-13271.48"/>
</g>
<!-- ResAttn_s0_l5_tp7 -->
<g id="node407" class="node">
<title>ResAttn_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="10884.77,-13286.15 10327.45,-13286.15 10184.08,-13180.15 10741.4,-13180.15 10884.77,-13286.15"/>
<text text-anchor="middle" x="10534.42" y="-13244.45" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10534.42" y="-13229.45" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10534.42" y="-13214.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp7 -->
<g id="edge672" class="edge">
<title>ResMOE_s0_l4_tp0&#45;&gt;ResAttn_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M7758.74,-13923.02C7838.62,-13914.28 7928.27,-13905.57 8010.42,-13900.06 8145.49,-13891 10442.42,-13884.93 10442.42,-13749.56 10442.42,-13749.56 10442.42,-13749.56 10442.42,-13447.63 10442.42,-13392.92 10468.22,-13336.3 10492.49,-13295.12"/>
<polygon fill="black" stroke="black" points="10495.63,-13296.69 10497.8,-13286.32 10489.64,-13293.08 10495.63,-13296.69"/>
</g>
<!-- SplitHeads_s0_l5_tp0 -->
<g id="node374" class="node">
<title>SplitHeads_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6739.42,-13775.06 6367.42,-13775.06 6367.42,-13722.06 6739.42,-13722.06 6739.42,-13775.06"/>
<text text-anchor="middle" x="6553.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6553.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6553.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp0&#45;&gt;SplitHeads_s0_l5_tp0 -->
<g id="edge617" class="edge">
<title>QKV_s0_l5_tp0&#45;&gt;SplitHeads_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M6577.41,-13810.93C6574.22,-13802.77 6570.63,-13793.6 6567.23,-13784.88"/>
<polygon fill="black" stroke="black" points="6570.39,-13783.35 6563.49,-13775.31 6563.87,-13785.9 6570.39,-13783.35"/>
</g>
<!-- SplitHeads_s0_l5_tp1 -->
<g id="node375" class="node">
<title>SplitHeads_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="7129.42,-13775.06 6757.42,-13775.06 6757.42,-13722.06 7129.42,-13722.06 7129.42,-13775.06"/>
<text text-anchor="middle" x="6943.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6943.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6943.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp1&#45;&gt;SplitHeads_s0_l5_tp1 -->
<g id="edge618" class="edge">
<title>QKV_s0_l5_tp1&#45;&gt;SplitHeads_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M6955.41,-13810.93C6953.84,-13802.86 6952.07,-13793.79 6950.38,-13785.16"/>
<polygon fill="black" stroke="black" points="6953.81,-13784.45 6948.45,-13775.31 6946.94,-13785.79 6953.81,-13784.45"/>
</g>
<!-- SplitHeads_s0_l5_tp2 -->
<g id="node376" class="node">
<title>SplitHeads_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="7519.42,-13775.06 7147.42,-13775.06 7147.42,-13722.06 7519.42,-13722.06 7519.42,-13775.06"/>
<text text-anchor="middle" x="7333.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7333.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7333.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp2&#45;&gt;SplitHeads_s0_l5_tp2 -->
<g id="edge619" class="edge">
<title>QKV_s0_l5_tp2&#45;&gt;SplitHeads_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7339.07,-13810.93C7338.33,-13802.95 7337.51,-13793.99 7336.72,-13785.44"/>
<polygon fill="black" stroke="black" points="7340.19,-13784.95 7335.79,-13775.31 7333.22,-13785.59 7340.19,-13784.95"/>
</g>
<!-- SplitHeads_s0_l5_tp3 -->
<g id="node377" class="node">
<title>SplitHeads_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="7909.42,-13775.06 7537.42,-13775.06 7537.42,-13722.06 7909.42,-13722.06 7909.42,-13775.06"/>
<text text-anchor="middle" x="7723.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7723.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7723.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp3&#45;&gt;SplitHeads_s0_l5_tp3 -->
<g id="edge620" class="edge">
<title>QKV_s0_l5_tp3&#45;&gt;SplitHeads_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7711.43,-13810.93C7713.01,-13802.86 7714.78,-13793.79 7716.47,-13785.16"/>
<polygon fill="black" stroke="black" points="7719.91,-13785.79 7718.39,-13775.31 7713.04,-13784.45 7719.91,-13785.79"/>
</g>
<!-- SplitHeads_s0_l5_tp4 -->
<g id="node378" class="node">
<title>SplitHeads_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="8299.42,-13775.06 7927.42,-13775.06 7927.42,-13722.06 8299.42,-13722.06 8299.42,-13775.06"/>
<text text-anchor="middle" x="8113.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8113.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8113.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp4&#45;&gt;SplitHeads_s0_l5_tp4 -->
<g id="edge621" class="edge">
<title>QKV_s0_l5_tp4&#45;&gt;SplitHeads_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M8095.08,-13810.93C8097.49,-13802.86 8100.2,-13793.79 8102.78,-13785.16"/>
<polygon fill="black" stroke="black" points="8106.22,-13785.89 8105.73,-13775.31 8099.51,-13783.89 8106.22,-13785.89"/>
</g>
<!-- SplitHeads_s0_l5_tp5 -->
<g id="node379" class="node">
<title>SplitHeads_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="8689.42,-13775.06 8317.42,-13775.06 8317.42,-13722.06 8689.42,-13722.06 8689.42,-13775.06"/>
<text text-anchor="middle" x="8503.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8503.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8503.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp5&#45;&gt;SplitHeads_s0_l5_tp5 -->
<g id="edge622" class="edge">
<title>QKV_s0_l5_tp5&#45;&gt;SplitHeads_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M8482.26,-13810.93C8485.07,-13802.77 8488.24,-13793.6 8491.24,-13784.88"/>
<polygon fill="black" stroke="black" points="8494.59,-13785.9 8494.54,-13775.31 8487.97,-13783.62 8494.59,-13785.9"/>
</g>
<!-- SplitHeads_s0_l5_tp6 -->
<g id="node380" class="node">
<title>SplitHeads_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="9079.42,-13775.06 8707.42,-13775.06 8707.42,-13722.06 9079.42,-13722.06 9079.42,-13775.06"/>
<text text-anchor="middle" x="8893.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8893.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8893.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp6&#45;&gt;SplitHeads_s0_l5_tp6 -->
<g id="edge623" class="edge">
<title>QKV_s0_l5_tp6&#45;&gt;SplitHeads_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M8870.85,-13810.93C8873.85,-13802.77 8877.22,-13793.6 8880.43,-13784.88"/>
<polygon fill="black" stroke="black" points="8883.78,-13785.9 8883.95,-13775.31 8877.21,-13783.49 8883.78,-13785.9"/>
</g>
<!-- SplitHeads_s0_l5_tp7 -->
<g id="node381" class="node">
<title>SplitHeads_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="6349.42,-13775.06 5977.42,-13775.06 5977.42,-13722.06 6349.42,-13722.06 6349.42,-13775.06"/>
<text text-anchor="middle" x="6163.42" y="-13759.86" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6163.42" y="-13744.86" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6163.42" y="-13729.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l5_tp7&#45;&gt;SplitHeads_s0_l5_tp7 -->
<g id="edge624" class="edge">
<title>QKV_s0_l5_tp7&#45;&gt;SplitHeads_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M6187.41,-13810.93C6184.22,-13802.77 6180.63,-13793.6 6177.23,-13784.88"/>
<polygon fill="black" stroke="black" points="6180.39,-13783.35 6173.49,-13775.31 6173.87,-13785.9 6180.39,-13783.35"/>
</g>
<!-- A2A_s0_l5 -->
<g id="node382" class="node">
<title>A2A_s0_l5</title>
<ellipse fill="none" stroke="black" cx="7528.42" cy="-13648.58" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7528.42" y="-13659.88" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="7528.42" y="-13644.88" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7528.42" y="-13629.88" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l5_tp0&#45;&gt;A2A_s0_l5 -->
<g id="edge625" class="edge">
<title>SplitHeads_s0_l5_tp0&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M6739.45,-13723.08C6742.46,-13722.73 6745.45,-13722.39 6748.42,-13722.06 6931.43,-13701.6 7139.05,-13682.51 7294.05,-13669.06"/>
<polygon fill="black" stroke="black" points="7294.53,-13672.53 7304.19,-13668.18 7293.92,-13665.56 7294.53,-13672.53"/>
</g>
<!-- SplitHeads_s0_l5_tp1&#45;&gt;A2A_s0_l5 -->
<g id="edge626" class="edge">
<title>SplitHeads_s0_l5_tp1&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M7095.98,-13722.01C7174.22,-13708.91 7269.93,-13692.88 7351.41,-13679.23"/>
<polygon fill="black" stroke="black" points="7351.99,-13682.68 7361.27,-13677.58 7350.83,-13675.78 7351.99,-13682.68"/>
</g>
<!-- SplitHeads_s0_l5_tp2&#45;&gt;A2A_s0_l5 -->
<g id="edge627" class="edge">
<title>SplitHeads_s0_l5_tp2&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M7384.4,-13721.95C7404.24,-13711.98 7427.43,-13700.33 7449.33,-13689.32"/>
<polygon fill="black" stroke="black" points="7450.94,-13692.43 7458.3,-13684.81 7447.8,-13686.18 7450.94,-13692.43"/>
</g>
<!-- SplitHeads_s0_l5_tp3&#45;&gt;A2A_s0_l5 -->
<g id="edge628" class="edge">
<title>SplitHeads_s0_l5_tp3&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M7672.44,-13721.95C7652.61,-13711.98 7629.42,-13700.33 7607.51,-13689.32"/>
<polygon fill="black" stroke="black" points="7609.05,-13686.18 7598.54,-13684.81 7605.91,-13692.43 7609.05,-13686.18"/>
</g>
<!-- SplitHeads_s0_l5_tp4&#45;&gt;A2A_s0_l5 -->
<g id="edge629" class="edge">
<title>SplitHeads_s0_l5_tp4&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M7960.87,-13722.01C7882.63,-13708.91 7786.91,-13692.88 7705.44,-13679.23"/>
<polygon fill="black" stroke="black" points="7706.02,-13675.78 7695.58,-13677.58 7704.86,-13682.68 7706.02,-13675.78"/>
</g>
<!-- SplitHeads_s0_l5_tp5&#45;&gt;A2A_s0_l5 -->
<g id="edge630" class="edge">
<title>SplitHeads_s0_l5_tp5&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M8317.4,-13723.08C8314.39,-13722.73 8311.39,-13722.39 8308.42,-13722.06 8125.42,-13701.6 7917.79,-13682.51 7762.79,-13669.06"/>
<polygon fill="black" stroke="black" points="7762.92,-13665.56 7752.66,-13668.18 7762.32,-13672.53 7762.92,-13665.56"/>
</g>
<!-- SplitHeads_s0_l5_tp6&#45;&gt;A2A_s0_l5 -->
<g id="edge631" class="edge">
<title>SplitHeads_s0_l5_tp6&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M8707.41,-13722.95C8704.39,-13722.64 8701.4,-13722.35 8698.42,-13722.06 8386.38,-13692.03 8026.25,-13671.9 7788.88,-13660.62"/>
<polygon fill="black" stroke="black" points="7788.88,-13657.12 7778.73,-13660.14 7788.55,-13664.11 7788.88,-13657.12"/>
</g>
<!-- SplitHeads_s0_l5_tp7&#45;&gt;A2A_s0_l5 -->
<g id="edge632" class="edge">
<title>SplitHeads_s0_l5_tp7&#45;&gt;A2A_s0_l5</title>
<path fill="none" stroke="black" d="M6349.43,-13722.95C6352.45,-13722.64 6355.45,-13722.35 6358.42,-13722.06 6670.47,-13692.03 7030.6,-13671.9 7267.96,-13660.62"/>
<polygon fill="black" stroke="black" points="7268.29,-13664.11 7278.12,-13660.14 7267.96,-13657.12 7268.29,-13664.11"/>
</g>
<!-- Attn_s0_l5_tp0 -->
<g id="node383" class="node">
<title>Attn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6739.42,-13575.11 6367.42,-13575.11 6367.42,-13522.11 6739.42,-13522.11 6739.42,-13575.11"/>
<text text-anchor="middle" x="6553.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6553.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6553.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp0 -->
<g id="edge633" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7304.19,-13628.98C7150.85,-13615.73 6942.7,-13596.68 6749.51,-13575.21"/>
<polygon fill="black" stroke="black" points="6749.77,-13571.72 6739.45,-13574.09 6749,-13578.68 6749.77,-13571.72"/>
</g>
<!-- Attn_s0_l5_tp1 -->
<g id="node384" class="node">
<title>Attn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="7129.42,-13575.11 6757.42,-13575.11 6757.42,-13522.11 7129.42,-13522.11 7129.42,-13575.11"/>
<text text-anchor="middle" x="6943.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6943.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6943.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp1 -->
<g id="edge634" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M7361.18,-13619.57C7281.03,-13606.15 7185.42,-13590.14 7105.9,-13576.82"/>
<polygon fill="black" stroke="black" points="7106.23,-13573.32 7095.79,-13575.12 7105.07,-13580.23 7106.23,-13573.32"/>
</g>
<!-- Attn_s0_l5_tp2 -->
<g id="node385" class="node">
<title>Attn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="7519.42,-13575.11 7147.42,-13575.11 7147.42,-13522.11 7519.42,-13522.11 7519.42,-13575.11"/>
<text text-anchor="middle" x="7333.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7333.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7333.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp2 -->
<g id="edge635" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7458.3,-13612.35C7436.99,-13601.64 7413.79,-13589.99 7393.23,-13579.66"/>
<polygon fill="black" stroke="black" points="7394.8,-13576.53 7384.29,-13575.16 7391.65,-13582.78 7394.8,-13576.53"/>
</g>
<!-- Attn_s0_l5_tp3 -->
<g id="node386" class="node">
<title>Attn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="7909.42,-13575.11 7537.42,-13575.11 7537.42,-13522.11 7909.42,-13522.11 7909.42,-13575.11"/>
<text text-anchor="middle" x="7723.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7723.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7723.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp3 -->
<g id="edge636" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7598.55,-13612.35C7619.85,-13601.64 7643.06,-13589.99 7663.62,-13579.66"/>
<polygon fill="black" stroke="black" points="7665.19,-13582.78 7672.55,-13575.16 7662.05,-13576.53 7665.19,-13582.78"/>
</g>
<!-- Attn_s0_l5_tp4 -->
<g id="node387" class="node">
<title>Attn_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="8299.42,-13575.11 7927.42,-13575.11 7927.42,-13522.11 8299.42,-13522.11 8299.42,-13575.11"/>
<text text-anchor="middle" x="8113.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8113.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8113.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp4 -->
<g id="edge637" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M7695.67,-13619.57C7775.81,-13606.15 7871.43,-13590.14 7950.95,-13576.82"/>
<polygon fill="black" stroke="black" points="7951.77,-13580.23 7961.06,-13575.12 7950.62,-13573.32 7951.77,-13580.23"/>
</g>
<!-- Attn_s0_l5_tp5 -->
<g id="node388" class="node">
<title>Attn_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="8689.42,-13575.11 8317.42,-13575.11 8317.42,-13522.11 8689.42,-13522.11 8689.42,-13575.11"/>
<text text-anchor="middle" x="8503.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8503.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8503.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp5 -->
<g id="edge638" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M7752.66,-13628.98C7906,-13615.73 8114.14,-13596.68 8307.34,-13575.21"/>
<polygon fill="black" stroke="black" points="8307.85,-13578.68 8317.4,-13574.09 8307.07,-13571.72 8307.85,-13578.68"/>
</g>
<!-- Attn_s0_l5_tp6 -->
<g id="node389" class="node">
<title>Attn_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="9079.42,-13575.11 8707.42,-13575.11 8707.42,-13522.11 9079.42,-13522.11 9079.42,-13575.11"/>
<text text-anchor="middle" x="8893.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8893.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8893.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp6 -->
<g id="edge639" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M7778.73,-13637.02C8013.46,-13625.96 8374.4,-13605.99 8697.39,-13575.18"/>
<polygon fill="black" stroke="black" points="8697.79,-13578.66 8707.41,-13574.22 8697.12,-13571.69 8697.79,-13578.66"/>
</g>
<!-- Attn_s0_l5_tp7 -->
<g id="node390" class="node">
<title>Attn_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="6349.42,-13575.11 5977.42,-13575.11 5977.42,-13522.11 6349.42,-13522.11 6349.42,-13575.11"/>
<text text-anchor="middle" x="6163.42" y="-13559.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6163.42" y="-13544.91" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6163.42" y="-13529.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l5&#45;&gt;Attn_s0_l5_tp7 -->
<g id="edge640" class="edge">
<title>A2A_s0_l5&#45;&gt;Attn_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M7278.12,-13637.02C7043.38,-13625.96 6682.44,-13605.99 6359.46,-13575.18"/>
<polygon fill="black" stroke="black" points="6359.72,-13571.69 6349.43,-13574.22 6359.05,-13578.66 6359.72,-13571.69"/>
</g>
<!-- AR_attn_s0_l5 -->
<g id="node391" class="node">
<title>AR_attn_s0_l5</title>
<ellipse fill="none" stroke="black" cx="7528.42" cy="-13448.63" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7528.42" y="-13459.93" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="7528.42" y="-13444.93" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7528.42" y="-13429.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l5_tp0&#45;&gt;AR_attn_s0_l5 -->
<g id="edge641" class="edge">
<title>Attn_s0_l5_tp0&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M6739.45,-13523.12C6742.46,-13522.78 6745.45,-13522.44 6748.42,-13522.11 6931.43,-13501.65 7139.05,-13482.55 7294.05,-13469.11"/>
<polygon fill="black" stroke="black" points="7294.53,-13472.58 7304.19,-13468.23 7293.92,-13465.6 7294.53,-13472.58"/>
</g>
<!-- Attn_s0_l5_tp1&#45;&gt;AR_attn_s0_l5 -->
<g id="edge642" class="edge">
<title>Attn_s0_l5_tp1&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M7095.98,-13522.06C7174.22,-13508.95 7269.93,-13492.92 7351.41,-13479.28"/>
<polygon fill="black" stroke="black" points="7351.99,-13482.73 7361.27,-13477.62 7350.83,-13475.82 7351.99,-13482.73"/>
</g>
<!-- Attn_s0_l5_tp2&#45;&gt;AR_attn_s0_l5 -->
<g id="edge643" class="edge">
<title>Attn_s0_l5_tp2&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M7384.4,-13521.99C7404.24,-13512.03 7427.43,-13500.37 7449.33,-13489.37"/>
<polygon fill="black" stroke="black" points="7450.94,-13492.48 7458.3,-13484.86 7447.8,-13486.22 7450.94,-13492.48"/>
</g>
<!-- Attn_s0_l5_tp3&#45;&gt;AR_attn_s0_l5 -->
<g id="edge644" class="edge">
<title>Attn_s0_l5_tp3&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M7672.44,-13521.99C7652.61,-13512.03 7629.42,-13500.37 7607.51,-13489.37"/>
<polygon fill="black" stroke="black" points="7609.05,-13486.22 7598.54,-13484.86 7605.91,-13492.48 7609.05,-13486.22"/>
</g>
<!-- Attn_s0_l5_tp4&#45;&gt;AR_attn_s0_l5 -->
<g id="edge645" class="edge">
<title>Attn_s0_l5_tp4&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M7960.87,-13522.06C7882.63,-13508.95 7786.91,-13492.92 7705.44,-13479.28"/>
<polygon fill="black" stroke="black" points="7706.02,-13475.82 7695.58,-13477.62 7704.86,-13482.73 7706.02,-13475.82"/>
</g>
<!-- Attn_s0_l5_tp5&#45;&gt;AR_attn_s0_l5 -->
<g id="edge646" class="edge">
<title>Attn_s0_l5_tp5&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M8317.4,-13523.12C8314.39,-13522.78 8311.39,-13522.44 8308.42,-13522.11 8125.42,-13501.65 7917.79,-13482.55 7762.79,-13469.11"/>
<polygon fill="black" stroke="black" points="7762.92,-13465.6 7752.66,-13468.23 7762.32,-13472.58 7762.92,-13465.6"/>
</g>
<!-- Attn_s0_l5_tp6&#45;&gt;AR_attn_s0_l5 -->
<g id="edge647" class="edge">
<title>Attn_s0_l5_tp6&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M8707.41,-13522.99C8704.39,-13522.69 8701.4,-13522.39 8698.42,-13522.11 8386.38,-13492.07 8026.25,-13471.94 7788.88,-13460.67"/>
<polygon fill="black" stroke="black" points="7788.88,-13457.17 7778.73,-13460.19 7788.55,-13464.16 7788.88,-13457.17"/>
</g>
<!-- Attn_s0_l5_tp7&#45;&gt;AR_attn_s0_l5 -->
<g id="edge648" class="edge">
<title>Attn_s0_l5_tp7&#45;&gt;AR_attn_s0_l5</title>
<path fill="none" stroke="black" d="M6349.43,-13522.99C6352.45,-13522.69 6355.45,-13522.39 6358.42,-13522.11 6670.47,-13492.07 7030.6,-13471.94 7267.96,-13460.67"/>
<polygon fill="black" stroke="black" points="7268.29,-13464.16 7278.12,-13460.19 7267.96,-13457.17 7268.29,-13464.16"/>
</g>
<!-- O_s0_l5_tp0 -->
<g id="node392" class="node">
<title>O_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="7387.42,-13375.15 7049.42,-13375.15 7049.42,-13322.15 7387.42,-13322.15 7387.42,-13375.15"/>
<text text-anchor="middle" x="7218.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7218.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7218.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp0 -->
<g id="edge649" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7422.61,-13414.19C7385.73,-13402.53 7344.71,-13389.57 7309.17,-13378.33"/>
<polygon fill="black" stroke="black" points="7309.89,-13374.89 7299.3,-13375.21 7307.78,-13381.57 7309.89,-13374.89"/>
</g>
<!-- O_s0_l5_tp1 -->
<g id="node393" class="node">
<title>O_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="5921.42,-13375.15 5583.42,-13375.15 5583.42,-13322.15 5921.42,-13322.15 5921.42,-13375.15"/>
<text text-anchor="middle" x="5752.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5752.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5752.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp1 -->
<g id="edge650" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M7285.2,-13434.21C6923.61,-13414.26 6252.57,-13377.24 5931.98,-13359.56"/>
<polygon fill="black" stroke="black" points="5931.84,-13356.05 5921.67,-13358.99 5931.46,-13363.04 5931.84,-13356.05"/>
</g>
<!-- O_s0_l5_tp2 -->
<g id="node394" class="node">
<title>O_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="6771.42,-13375.15 6433.42,-13375.15 6433.42,-13322.15 6771.42,-13322.15 6771.42,-13375.15"/>
<text text-anchor="middle" x="6602.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6602.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6602.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp2 -->
<g id="edge651" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7320.61,-13425.64C7158.6,-13408.5 6935.96,-13384.94 6781.7,-13368.62"/>
<polygon fill="black" stroke="black" points="6781.96,-13365.13 6771.64,-13367.56 6781.22,-13372.09 6781.96,-13365.13"/>
</g>
<!-- O_s0_l5_tp3 -->
<g id="node395" class="node">
<title>O_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8565.42,-13375.15 8227.42,-13375.15 8227.42,-13322.15 8565.42,-13322.15 8565.42,-13375.15"/>
<text text-anchor="middle" x="8396.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8396.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8396.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp3 -->
<g id="edge652" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7731.38,-13424.72C7878.53,-13408.11 8075.7,-13385.86 8217.08,-13369.9"/>
<polygon fill="black" stroke="black" points="8217.61,-13373.36 8227.16,-13368.76 8216.83,-13366.4 8217.61,-13373.36"/>
</g>
<!-- O_s0_l5_tp4 -->
<g id="node396" class="node">
<title>O_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9026.42,-13375.15 8688.42,-13375.15 8688.42,-13322.15 9026.42,-13322.15 9026.42,-13375.15"/>
<text text-anchor="middle" x="8857.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8857.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8857.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp4 -->
<g id="edge653" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M7766.1,-13432.57C7978.18,-13418.79 8297.13,-13397.25 8574.42,-13375.15 8607.99,-13372.48 8643.78,-13369.42 8678.22,-13366.36"/>
<polygon fill="black" stroke="black" points="8678.72,-13369.83 8688.37,-13365.46 8678.1,-13362.86 8678.72,-13369.83"/>
</g>
<!-- O_s0_l5_tp5 -->
<g id="node397" class="node">
<title>O_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="5446.42,-13375.15 5108.42,-13375.15 5108.42,-13322.15 5446.42,-13322.15 5446.42,-13375.15"/>
<text text-anchor="middle" x="5277.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5277.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5277.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp5 -->
<g id="edge654" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M7269.44,-13442.03C6895.1,-13433.02 6181.14,-13412.43 5574.42,-13375.15 5536.37,-13372.82 5495.62,-13369.71 5456.89,-13366.48"/>
<polygon fill="black" stroke="black" points="5456.81,-13362.96 5446.55,-13365.61 5456.22,-13369.93 5456.81,-13362.96"/>
</g>
<!-- O_s0_l5_tp6 -->
<g id="node398" class="node">
<title>O_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="10232.42,-13375.15 9894.42,-13375.15 9894.42,-13322.15 10232.42,-13322.15 10232.42,-13375.15"/>
<text text-anchor="middle" x="10063.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="10063.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10063.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp6 -->
<g id="edge655" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M7782.55,-13438.75C8155.38,-13425.61 8872.51,-13399.85 9482.42,-13375.15 9617.07,-13369.7 9769.25,-13363 9884.08,-13357.84"/>
<polygon fill="black" stroke="black" points="9884.54,-13361.32 9894.37,-13357.38 9884.22,-13354.33 9884.54,-13361.32"/>
</g>
<!-- O_s0_l5_tp7 -->
<g id="node399" class="node">
<title>O_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="9473.42,-13375.15 9135.42,-13375.15 9135.42,-13322.15 9473.42,-13322.15 9473.42,-13375.15"/>
<text text-anchor="middle" x="9304.42" y="-13359.95" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9304.42" y="-13344.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9304.42" y="-13329.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l5&#45;&gt;O_s0_l5_tp7 -->
<g id="edge656" class="edge">
<title>AR_attn_s0_l5&#45;&gt;O_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M7782.95,-13439C8082.74,-13427.99 8595.67,-13406.55 9035.42,-13375.15 9064.43,-13373.08 9095.16,-13370.52 9125.08,-13367.82"/>
<polygon fill="black" stroke="black" points="9125.55,-13371.29 9135.2,-13366.9 9124.92,-13364.32 9125.55,-13371.29"/>
</g>
<!-- O_s0_l5_tp0&#45;&gt;ResAttn_s0_l5_tp0 -->
<g id="edge657" class="edge">
<title>O_s0_l5_tp0&#45;&gt;ResAttn_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7055.49,-13322.11C6990.44,-13311.91 6912.95,-13299.76 6836.63,-13287.8"/>
<polygon fill="black" stroke="black" points="6836.78,-13284.28 6826.36,-13286.19 6835.7,-13291.2 6836.78,-13284.28"/>
</g>
<!-- O_s0_l5_tp1&#45;&gt;ResAttn_s0_l5_tp1 -->
<g id="edge659" class="edge">
<title>O_s0_l5_tp1&#45;&gt;ResAttn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M5583.23,-13330.48C5421.07,-13314.01 5171.78,-13288.71 4969.41,-13268.16"/>
<polygon fill="black" stroke="black" points="4969.51,-13264.65 4959.2,-13267.12 4968.8,-13271.62 4969.51,-13264.65"/>
</g>
<!-- O_s0_l5_tp2&#45;&gt;ResAttn_s0_l5_tp2 -->
<g id="edge661" class="edge">
<title>O_s0_l5_tp2&#45;&gt;ResAttn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M6433.33,-13329.32C6288.03,-13313.57 6074.07,-13290.38 5893.75,-13270.83"/>
<polygon fill="black" stroke="black" points="5893.88,-13267.32 5883.56,-13269.72 5893.12,-13274.28 5893.88,-13267.32"/>
</g>
<!-- O_s0_l5_tp3&#45;&gt;ResAttn_s0_l5_tp3 -->
<g id="edge663" class="edge">
<title>O_s0_l5_tp3&#45;&gt;ResAttn_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M8440.22,-13321.9C8455.7,-13312.79 8473.8,-13302.15 8491.94,-13291.48"/>
<polygon fill="black" stroke="black" points="8493.99,-13294.34 8500.84,-13286.25 8490.44,-13288.3 8493.99,-13294.34"/>
</g>
<!-- O_s0_l5_tp4&#45;&gt;ResAttn_s0_l5_tp4 -->
<g id="edge665" class="edge">
<title>O_s0_l5_tp4&#45;&gt;ResAttn_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M9002.35,-13322.11C9080.47,-13308.34 9178.76,-13291.02 9267.42,-13275.39"/>
<polygon fill="black" stroke="black" points="9268.1,-13278.83 9277.34,-13273.65 9266.89,-13271.93 9268.1,-13278.83"/>
</g>
<!-- O_s0_l5_tp5&#45;&gt;ResAttn_s0_l5_tp5 -->
<g id="edge667" class="edge">
<title>O_s0_l5_tp5&#45;&gt;ResAttn_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M5108.09,-13337.65C4908.83,-13325.79 4568.04,-13305.22 4275.42,-13286.15 4132.99,-13276.87 3975.47,-13266.09 3841.39,-13256.76"/>
<polygon fill="black" stroke="black" points="3841.59,-13253.26 3831.37,-13256.06 3841.1,-13260.24 3841.59,-13253.26"/>
</g>
<!-- O_s0_l5_tp6&#45;&gt;ResAttn_s0_l5_tp6 -->
<g id="edge669" class="edge">
<title>O_s0_l5_tp6&#45;&gt;ResAttn_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M10232.74,-13335.39C10400.49,-13323.17 10664.72,-13303.75 10893.42,-13286.15 11022.54,-13276.22 11166.01,-13264.82 11285.43,-13255.23"/>
<polygon fill="black" stroke="black" points="11285.75,-13258.71 11295.44,-13254.42 11285.19,-13251.73 11285.75,-13258.71"/>
</g>
<!-- O_s0_l5_tp7&#45;&gt;ResAttn_s0_l5_tp7 -->
<g id="edge671" class="edge">
<title>O_s0_l5_tp7&#45;&gt;ResAttn_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M9473.51,-13332.05C9681.35,-13312.87 10036.1,-13280.14 10277.66,-13257.85"/>
<polygon fill="black" stroke="black" points="10278,-13261.33 10287.64,-13256.93 10277.36,-13254.36 10278,-13261.33"/>
</g>
<!-- Gate_s0_l5_tp0 -->
<g id="node408" class="node">
<title>Gate_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6882.42,-13144.15 6544.42,-13144.15 6544.42,-13091.15 6882.42,-13091.15 6882.42,-13144.15"/>
<text text-anchor="middle" x="6713.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6713.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6713.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp0&#45;&gt;Gate_s0_l5_tp0 -->
<g id="edge673" class="edge">
<title>ResAttn_s0_l5_tp0&#45;&gt;Gate_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M6594.95,-13180.05C6615.63,-13169.34 6636.74,-13158.4 6655.3,-13148.78"/>
<polygon fill="black" stroke="black" points="6656.93,-13151.88 6664.19,-13144.17 6653.7,-13145.66 6656.93,-13151.88"/>
</g>
<!-- ResMOE_s0_l5_tp0 -->
<g id="node449" class="node">
<title>ResMOE_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="7656.77,-12855.2 7099.45,-12855.2 6956.08,-12749.2 7513.4,-12749.2 7656.77,-12855.2"/>
<text text-anchor="middle" x="7306.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7306.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7306.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp0&#45;&gt;ResMOE_s0_l5_tp0 -->
<g id="edge746" class="edge">
<title>ResAttn_s0_l5_tp0&#45;&gt;ResMOE_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M6168.81,-13198.51C6085.93,-13191.17 5996.96,-13184.35 5914.42,-13180.15 5256.33,-13146.71 3606.48,-13193.84 2949.42,-13144.15 2664.38,-13122.6 2500.05,-13270.82 2312.42,-13055.15 2296.96,-13037.38 2296.06,-13019.09 2312.42,-13002.15 2476.76,-12832.04 6331.22,-12867.58 6567.42,-12855.2 6726.25,-12846.87 6904.06,-12834.46 7045.46,-12823.85"/>
<polygon fill="black" stroke="black" points="7045.87,-12827.32 7055.58,-12823.08 7045.35,-12820.34 7045.87,-12827.32"/>
</g>
<!-- Gate_s0_l5_tp1 -->
<g id="node409" class="node">
<title>Gate_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="4600.42,-13144.15 4262.42,-13144.15 4262.42,-13091.15 4600.42,-13091.15 4600.42,-13144.15"/>
<text text-anchor="middle" x="4431.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4431.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4431.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp1&#45;&gt;Gate_s0_l5_tp1 -->
<g id="edge674" class="edge">
<title>ResAttn_s0_l5_tp1&#45;&gt;Gate_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M4541.24,-13180.05C4522.42,-13169.53 4503.22,-13158.79 4486.24,-13149.3"/>
<polygon fill="black" stroke="black" points="4487.49,-13145.99 4477.05,-13144.17 4484.08,-13152.1 4487.49,-13145.99"/>
</g>
<!-- ResMOE_s0_l5_tp1 -->
<g id="node450" class="node">
<title>ResMOE_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="5082.77,-12855.2 4525.45,-12855.2 4382.08,-12749.2 4939.4,-12749.2 5082.77,-12855.2"/>
<text text-anchor="middle" x="4732.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4732.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4732.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp1&#45;&gt;ResMOE_s0_l5_tp1 -->
<g id="edge748" class="edge">
<title>ResAttn_s0_l5_tp1&#45;&gt;ResMOE_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M4320.5,-13207.2C4185.18,-13197.3 4025.1,-13186.73 3880.42,-13180.15 3834.93,-13178.09 2273.27,-13176.71 2241.42,-13144.15 2202.11,-13103.97 2202.38,-12931.64 2241.42,-12891.2 2260.44,-12871.5 3808.01,-12827.9 4454.01,-12810.54"/>
<polygon fill="black" stroke="black" points="4454.49,-12814.03 4464.4,-12810.26 4454.31,-12807.03 4454.49,-12814.03"/>
</g>
<!-- Gate_s0_l5_tp2 -->
<g id="node410" class="node">
<title>Gate_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="5724.42,-13144.15 5386.42,-13144.15 5386.42,-13091.15 5724.42,-13091.15 5724.42,-13144.15"/>
<text text-anchor="middle" x="5555.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5555.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5555.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp2&#45;&gt;Gate_s0_l5_tp2 -->
<g id="edge675" class="edge">
<title>ResAttn_s0_l5_tp2&#45;&gt;Gate_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M5555.42,-13180.05C5555.42,-13171.38 5555.42,-13162.57 5555.42,-13154.42"/>
<polygon fill="black" stroke="black" points="5558.92,-13154.17 5555.42,-13144.17 5551.92,-13154.17 5558.92,-13154.17"/>
</g>
<!-- ResMOE_s0_l5_tp2 -->
<g id="node451" class="node">
<title>ResMOE_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="6558.77,-12855.2 6001.45,-12855.2 5858.08,-12749.2 6415.4,-12749.2 6558.77,-12855.2"/>
<text text-anchor="middle" x="6208.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6208.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6208.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp2&#45;&gt;ResMOE_s0_l5_tp2 -->
<g id="edge750" class="edge">
<title>ResAttn_s0_l5_tp2&#45;&gt;ResMOE_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M5228.47,-13197.51C5151.47,-13190.57 5069.62,-13184.18 4993.42,-13180.15 4955.78,-13178.16 2305.9,-13170.99 2279.42,-13144.15 2239.94,-13104.14 2239.93,-12931.2 2279.42,-12891.2 2306.86,-12863.4 5052.38,-12856.36 5091.42,-12855.2 5381.82,-12846.58 5714.4,-12830.27 5940.62,-12818.21"/>
<polygon fill="black" stroke="black" points="5940.84,-12821.7 5950.64,-12817.67 5940.47,-12814.71 5940.84,-12821.7"/>
</g>
<!-- Gate_s0_l5_tp3 -->
<g id="node411" class="node">
<title>Gate_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8512.42,-13144.15 8174.42,-13144.15 8174.42,-13091.15 8512.42,-13091.15 8512.42,-13144.15"/>
<text text-anchor="middle" x="8343.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8343.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8343.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp3&#45;&gt;Gate_s0_l5_tp3 -->
<g id="edge676" class="edge">
<title>ResAttn_s0_l5_tp3&#45;&gt;Gate_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M8476.5,-13180.05C8452.96,-13169.19 8428.92,-13158.1 8407.86,-13148.38"/>
<polygon fill="black" stroke="black" points="8409.27,-13145.18 8398.72,-13144.17 8406.33,-13151.53 8409.27,-13145.18"/>
</g>
<!-- ResMOE_s0_l5_tp3 -->
<g id="node452" class="node">
<title>ResMOE_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8505.77,-12855.2 7948.45,-12855.2 7805.08,-12749.2 8362.4,-12749.2 8505.77,-12855.2"/>
<text text-anchor="middle" x="8155.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8155.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8155.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp3&#45;&gt;ResMOE_s0_l5_tp3 -->
<g id="edge752" class="edge">
<title>ResAttn_s0_l5_tp3&#45;&gt;ResMOE_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M8830.35,-13205.19C8927.2,-13195.48 9039.99,-13185.58 9142.42,-13180.15 9800.44,-13145.28 11450.36,-13193.84 12107.42,-13144.15 12396.66,-13122.28 12945.04,-13211.65 12744.42,-13002.15 12707.26,-12963.35 9477.82,-12848.79 8459.44,-12813.6"/>
<polygon fill="black" stroke="black" points="8459.53,-12810.1 8449.41,-12813.25 8459.29,-12817.1 8459.53,-12810.1"/>
</g>
<!-- Gate_s0_l5_tp4 -->
<g id="node412" class="node">
<title>Gate_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9670.42,-13144.15 9332.42,-13144.15 9332.42,-13091.15 9670.42,-13091.15 9670.42,-13144.15"/>
<text text-anchor="middle" x="9501.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9501.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9501.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp4&#45;&gt;Gate_s0_l5_tp4 -->
<g id="edge677" class="edge">
<title>ResAttn_s0_l5_tp4&#45;&gt;Gate_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M9501.42,-13180.05C9501.42,-13171.38 9501.42,-13162.57 9501.42,-13154.42"/>
<polygon fill="black" stroke="black" points="9504.92,-13154.17 9501.42,-13144.17 9497.92,-13154.17 9504.92,-13154.17"/>
</g>
<!-- ResMOE_s0_l5_tp4 -->
<g id="node453" class="node">
<title>ResMOE_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="10542.77,-12855.2 9985.45,-12855.2 9842.08,-12749.2 10399.4,-12749.2 10542.77,-12855.2"/>
<text text-anchor="middle" x="10192.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10192.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10192.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp4&#45;&gt;ResMOE_s0_l5_tp4 -->
<g id="edge754" class="edge">
<title>ResAttn_s0_l5_tp4&#45;&gt;ResMOE_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M9748.09,-13209.48C9875.56,-13198.69 10033.71,-13186.73 10175.42,-13180.15 10428.96,-13168.39 12208.27,-13180.76 12459.42,-13144.15 12604.23,-13123.05 12688.03,-13171.78 12776.42,-13055.15 12958.3,-12815.19 11731.64,-12914.24 11431.42,-12891.2 11118.75,-12867.2 10761.5,-12842.07 10511.21,-12824.84"/>
<polygon fill="black" stroke="black" points="10511.08,-12821.32 10500.86,-12824.13 10510.6,-12828.3 10511.08,-12821.32"/>
</g>
<!-- Gate_s0_l5_tp5 -->
<g id="node413" class="node">
<title>Gate_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="3296.42,-13144.15 2958.42,-13144.15 2958.42,-13091.15 3296.42,-13091.15 3296.42,-13144.15"/>
<text text-anchor="middle" x="3127.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3127.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3127.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp5&#45;&gt;Gate_s0_l5_tp5 -->
<g id="edge678" class="edge">
<title>ResAttn_s0_l5_tp5&#45;&gt;Gate_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M3340.85,-13180.14C3301.25,-13168.73 3260.76,-13157.06 3225.83,-13147"/>
<polygon fill="black" stroke="black" points="3226.71,-13143.61 3216.13,-13144.21 3224.77,-13150.34 3226.71,-13143.61"/>
</g>
<!-- ResMOE_s0_l5_tp5 -->
<g id="node454" class="node">
<title>ResMOE_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="2849.77,-12855.2 2292.45,-12855.2 2149.08,-12749.2 2706.4,-12749.2 2849.77,-12855.2"/>
<text text-anchor="middle" x="2499.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2499.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2499.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp5&#45;&gt;ResMOE_s0_l5_tp5 -->
<g id="edge756" class="edge">
<title>ResAttn_s0_l5_tp5&#45;&gt;ResMOE_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M3241.66,-13232.36C2879.67,-13229.75 2286.67,-13214.61 2215.42,-13144.15 2135.47,-13065.09 2143.32,-12980.67 2211.42,-12891.2 2221.9,-12877.44 2246.19,-12864.91 2276.46,-12853.9"/>
<polygon fill="black" stroke="black" points="2277.77,-12857.16 2286.04,-12850.54 2275.45,-12850.55 2277.77,-12857.16"/>
</g>
<!-- Gate_s0_l5_tp6 -->
<g id="node414" class="node">
<title>Gate_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="12098.42,-13144.15 11760.42,-13144.15 11760.42,-13091.15 12098.42,-13091.15 12098.42,-13144.15"/>
<text text-anchor="middle" x="11929.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11929.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11929.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp6&#45;&gt;Gate_s0_l5_tp6 -->
<g id="edge679" class="edge">
<title>ResAttn_s0_l5_tp6&#45;&gt;Gate_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M11721.41,-13180.14C11759.84,-13168.78 11799.14,-13157.16 11833.08,-13147.13"/>
<polygon fill="black" stroke="black" points="11834.37,-13150.4 11842.96,-13144.21 11832.38,-13143.69 11834.37,-13150.4"/>
</g>
<!-- ResMOE_s0_l5_tp6 -->
<g id="node455" class="node">
<title>ResMOE_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="12968.77,-12855.2 12411.45,-12855.2 12268.08,-12749.2 12825.4,-12749.2 12968.77,-12855.2"/>
<text text-anchor="middle" x="12618.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12618.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12618.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp6&#45;&gt;ResMOE_s0_l5_tp6 -->
<g id="edge758" class="edge">
<title>ResAttn_s0_l5_tp6&#45;&gt;ResMOE_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M11819.45,-13229.68C12110.5,-13223.82 12549.69,-13204.81 12705.42,-13144.15 12780.58,-13114.88 12849.39,-13076.63 12818.42,-13002.15 12794.93,-12945.64 12746.71,-12896.89 12703.5,-12861.79"/>
<polygon fill="black" stroke="black" points="12705.5,-12858.9 12695.5,-12855.4 12701.13,-12864.37 12705.5,-12858.9"/>
</g>
<!-- Gate_s0_l5_tp7 -->
<g id="node415" class="node">
<title>Gate_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="10794.42,-13144.15 10456.42,-13144.15 10456.42,-13091.15 10794.42,-13091.15 10794.42,-13144.15"/>
<text text-anchor="middle" x="10625.42" y="-13128.95" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10625.42" y="-13113.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10625.42" y="-13098.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp7&#45;&gt;Gate_s0_l5_tp7 -->
<g id="edge680" class="edge">
<title>ResAttn_s0_l5_tp7&#45;&gt;Gate_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M10576.19,-13180.05C10583.85,-13170.51 10591.65,-13160.78 10598.71,-13151.97"/>
<polygon fill="black" stroke="black" points="10601.44,-13154.16 10604.97,-13144.17 10595.98,-13149.78 10601.44,-13154.16"/>
</g>
<!-- ResMOE_s0_l5_tp7 -->
<g id="node456" class="node">
<title>ResMOE_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="11920.77,-12855.2 11363.45,-12855.2 11220.08,-12749.2 11777.4,-12749.2 11920.77,-12855.2"/>
<text text-anchor="middle" x="11570.42" y="-12813.5" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11570.42" y="-12798.5" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11570.42" y="-12783.5" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l5_tp7&#45;&gt;ResMOE_s0_l5_tp7 -->
<g id="edge760" class="edge">
<title>ResAttn_s0_l5_tp7&#45;&gt;ResMOE_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M10781.12,-13209.3C10903,-13198.82 11052.33,-13187.19 11186.42,-13180.15 11344.81,-13171.85 12459.2,-13181.2 12613.42,-13144.15 12702.53,-13122.75 12750.57,-13132.69 12799.42,-13055.15 12811.98,-13035.22 12814.69,-13020.09 12799.42,-13002.15 12741.53,-12934.13 12245.95,-12871 11902.07,-12834.81"/>
<polygon fill="black" stroke="black" points="11902.26,-12831.31 11891.95,-12833.74 11901.53,-12838.27 11902.26,-12831.31"/>
</g>
<!-- Expert0_s0_l5_tp0 -->
<g id="node416" class="node">
<title>Expert0_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="7193.42,-13055.15 6885.42,-13055.15 6885.42,-13002.15 7193.42,-13002.15 7193.42,-13055.15"/>
<text text-anchor="middle" x="7039.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="7039.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7039.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp0&#45;&gt;Expert0_s0_l5_tp0 -->
<g id="edge681" class="edge">
<title>Gate_s0_l5_tp0&#45;&gt;Expert0_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6809.03,-13091.14C6848.26,-13080.67 6893.8,-13068.51 6933.99,-13057.79"/>
<polygon fill="black" stroke="black" points="6935.06,-13061.13 6943.82,-13055.17 6933.25,-13054.36 6935.06,-13061.13"/>
</g>
<!-- Expert1_s0_l5_tp0 -->
<g id="node417" class="node">
<title>Expert1_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="7519.42,-13055.15 7211.42,-13055.15 7211.42,-13002.15 7519.42,-13002.15 7519.42,-13055.15"/>
<text text-anchor="middle" x="7365.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="7365.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7365.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp0&#45;&gt;Expert1_s0_l5_tp0 -->
<g id="edge682" class="edge">
<title>Gate_s0_l5_tp0&#45;&gt;Expert1_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6882.47,-13096.66C6973.97,-13085.53 7089.22,-13071.02 7200.9,-13055.35"/>
<polygon fill="black" stroke="black" points="7201.59,-13058.79 7211.01,-13053.93 7200.62,-13051.86 7201.59,-13058.79"/>
</g>
<!-- Expert2_s0_l5_tp0 -->
<g id="node418" class="node">
<title>Expert2_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6541.42,-13055.15 6233.42,-13055.15 6233.42,-13002.15 6541.42,-13002.15 6541.42,-13055.15"/>
<text text-anchor="middle" x="6387.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="6387.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6387.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp0&#45;&gt;Expert2_s0_l5_tp0 -->
<g id="edge683" class="edge">
<title>Gate_s0_l5_tp0&#45;&gt;Expert2_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6617.81,-13091.14C6578.59,-13080.67 6533.04,-13068.51 6492.85,-13057.79"/>
<polygon fill="black" stroke="black" points="6493.59,-13054.36 6483.03,-13055.17 6491.79,-13061.13 6493.59,-13054.36"/>
</g>
<!-- Expert3_s0_l5_tp0 -->
<g id="node419" class="node">
<title>Expert3_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="6867.42,-13055.15 6559.42,-13055.15 6559.42,-13002.15 6867.42,-13002.15 6867.42,-13055.15"/>
<text text-anchor="middle" x="6713.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="6713.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6713.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp0&#45;&gt;Expert3_s0_l5_tp0 -->
<g id="edge684" class="edge">
<title>Gate_s0_l5_tp0&#45;&gt;Expert3_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6713.42,-13091.02C6713.42,-13083.04 6713.42,-13074.09 6713.42,-13065.54"/>
<polygon fill="black" stroke="black" points="6716.92,-13065.4 6713.42,-13055.4 6709.92,-13065.4 6716.92,-13065.4"/>
</g>
<!-- Expert4_s0_l5_tp1 -->
<g id="node420" class="node">
<title>Expert4_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="4585.42,-13055.15 4277.42,-13055.15 4277.42,-13002.15 4585.42,-13002.15 4585.42,-13055.15"/>
<text text-anchor="middle" x="4431.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="4431.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4431.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp1&#45;&gt;Expert4_s0_l5_tp1 -->
<g id="edge685" class="edge">
<title>Gate_s0_l5_tp1&#45;&gt;Expert4_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4431.42,-13091.02C4431.42,-13083.04 4431.42,-13074.09 4431.42,-13065.54"/>
<polygon fill="black" stroke="black" points="4434.92,-13065.4 4431.42,-13055.4 4427.92,-13065.4 4434.92,-13065.4"/>
</g>
<!-- Expert5_s0_l5_tp1 -->
<g id="node421" class="node">
<title>Expert5_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="4911.42,-13055.15 4603.42,-13055.15 4603.42,-13002.15 4911.42,-13002.15 4911.42,-13055.15"/>
<text text-anchor="middle" x="4757.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="4757.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4757.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp1&#45;&gt;Expert5_s0_l5_tp1 -->
<g id="edge686" class="edge">
<title>Gate_s0_l5_tp1&#45;&gt;Expert5_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4527.03,-13091.14C4566.26,-13080.67 4611.8,-13068.51 4651.99,-13057.79"/>
<polygon fill="black" stroke="black" points="4653.06,-13061.13 4661.82,-13055.17 4651.25,-13054.36 4653.06,-13061.13"/>
</g>
<!-- Expert6_s0_l5_tp1 -->
<g id="node422" class="node">
<title>Expert6_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="3933.42,-13055.15 3625.42,-13055.15 3625.42,-13002.15 3933.42,-13002.15 3933.42,-13055.15"/>
<text text-anchor="middle" x="3779.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="3779.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3779.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp1&#45;&gt;Expert6_s0_l5_tp1 -->
<g id="edge687" class="edge">
<title>Gate_s0_l5_tp1&#45;&gt;Expert6_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4262.37,-13096.66C4170.87,-13085.53 4055.63,-13071.02 3943.94,-13055.35"/>
<polygon fill="black" stroke="black" points="3944.23,-13051.86 3933.84,-13053.93 3943.25,-13058.79 3944.23,-13051.86"/>
</g>
<!-- Expert7_s0_l5_tp1 -->
<g id="node423" class="node">
<title>Expert7_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="4259.42,-13055.15 3951.42,-13055.15 3951.42,-13002.15 4259.42,-13002.15 4259.42,-13055.15"/>
<text text-anchor="middle" x="4105.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="4105.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4105.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp1&#45;&gt;Expert7_s0_l5_tp1 -->
<g id="edge688" class="edge">
<title>Gate_s0_l5_tp1&#45;&gt;Expert7_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4335.81,-13091.14C4296.59,-13080.67 4251.04,-13068.51 4210.85,-13057.79"/>
<polygon fill="black" stroke="black" points="4211.59,-13054.36 4201.03,-13055.17 4209.79,-13061.13 4211.59,-13054.36"/>
</g>
<!-- Expert8_s0_l5_tp2 -->
<g id="node424" class="node">
<title>Expert8_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="6215.42,-13055.15 5907.42,-13055.15 5907.42,-13002.15 6215.42,-13002.15 6215.42,-13055.15"/>
<text text-anchor="middle" x="6061.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="6061.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6061.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp2&#45;&gt;Expert8_s0_l5_tp2 -->
<g id="edge689" class="edge">
<title>Gate_s0_l5_tp2&#45;&gt;Expert8_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5703.82,-13091.14C5766.38,-13080.38 5839.29,-13067.85 5902.9,-13056.91"/>
<polygon fill="black" stroke="black" points="5903.77,-13060.31 5913.03,-13055.17 5902.58,-13053.41 5903.77,-13060.31"/>
</g>
<!-- Expert9_s0_l5_tp2 -->
<g id="node425" class="node">
<title>Expert9_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="5237.42,-13055.15 4929.42,-13055.15 4929.42,-13002.15 5237.42,-13002.15 5237.42,-13055.15"/>
<text text-anchor="middle" x="5083.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="5083.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5083.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp2&#45;&gt;Expert9_s0_l5_tp2 -->
<g id="edge690" class="edge">
<title>Gate_s0_l5_tp2&#45;&gt;Expert9_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5417,-13091.14C5358.88,-13080.43 5291.19,-13067.95 5232.03,-13057.04"/>
<polygon fill="black" stroke="black" points="5232.32,-13053.54 5221.85,-13055.17 5231.05,-13060.42 5232.32,-13053.54"/>
</g>
<!-- Expert10_s0_l5_tp2 -->
<g id="node426" class="node">
<title>Expert10_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="5563.42,-13055.15 5255.42,-13055.15 5255.42,-13002.15 5563.42,-13002.15 5563.42,-13055.15"/>
<text text-anchor="middle" x="5409.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="5409.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5409.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp2&#45;&gt;Expert10_s0_l5_tp2 -->
<g id="edge691" class="edge">
<title>Gate_s0_l5_tp2&#45;&gt;Expert10_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5512.41,-13091.02C5496.29,-13081.42 5477.81,-13070.41 5461,-13060.39"/>
<polygon fill="black" stroke="black" points="5462.76,-13057.36 5452.38,-13055.25 5459.18,-13063.38 5462.76,-13057.36"/>
</g>
<!-- Expert11_s0_l5_tp2 -->
<g id="node427" class="node">
<title>Expert11_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="5889.42,-13055.15 5581.42,-13055.15 5581.42,-13002.15 5889.42,-13002.15 5889.42,-13055.15"/>
<text text-anchor="middle" x="5735.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="5735.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5735.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp2&#45;&gt;Expert11_s0_l5_tp2 -->
<g id="edge692" class="edge">
<title>Gate_s0_l5_tp2&#45;&gt;Expert11_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5608.45,-13091.02C5628.78,-13081.2 5652.15,-13069.9 5673.25,-13059.7"/>
<polygon fill="black" stroke="black" points="5674.98,-13062.76 5682.46,-13055.25 5671.93,-13056.45 5674.98,-13062.76"/>
</g>
<!-- Expert12_s0_l5_tp3 -->
<g id="node428" class="node">
<title>Expert12_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="7845.42,-13055.15 7537.42,-13055.15 7537.42,-13002.15 7845.42,-13002.15 7845.42,-13055.15"/>
<text text-anchor="middle" x="7691.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="7691.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7691.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp3&#45;&gt;Expert12_s0_l5_tp3 -->
<g id="edge693" class="edge">
<title>Gate_s0_l5_tp3&#45;&gt;Expert12_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8174.37,-13096.66C8082.87,-13085.53 7967.63,-13071.02 7855.94,-13055.35"/>
<polygon fill="black" stroke="black" points="7856.23,-13051.86 7845.84,-13053.93 7855.25,-13058.79 7856.23,-13051.86"/>
</g>
<!-- Expert13_s0_l5_tp3 -->
<g id="node429" class="node">
<title>Expert13_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8171.42,-13055.15 7863.42,-13055.15 7863.42,-13002.15 8171.42,-13002.15 8171.42,-13055.15"/>
<text text-anchor="middle" x="8017.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="8017.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8017.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp3&#45;&gt;Expert13_s0_l5_tp3 -->
<g id="edge694" class="edge">
<title>Gate_s0_l5_tp3&#45;&gt;Expert13_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8247.81,-13091.14C8208.59,-13080.67 8163.04,-13068.51 8122.85,-13057.79"/>
<polygon fill="black" stroke="black" points="8123.59,-13054.36 8113.03,-13055.17 8121.79,-13061.13 8123.59,-13054.36"/>
</g>
<!-- Expert14_s0_l5_tp3 -->
<g id="node430" class="node">
<title>Expert14_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8497.42,-13055.15 8189.42,-13055.15 8189.42,-13002.15 8497.42,-13002.15 8497.42,-13055.15"/>
<text text-anchor="middle" x="8343.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="8343.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8343.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp3&#45;&gt;Expert14_s0_l5_tp3 -->
<g id="edge695" class="edge">
<title>Gate_s0_l5_tp3&#45;&gt;Expert14_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8343.42,-13091.02C8343.42,-13083.04 8343.42,-13074.09 8343.42,-13065.54"/>
<polygon fill="black" stroke="black" points="8346.92,-13065.4 8343.42,-13055.4 8339.92,-13065.4 8346.92,-13065.4"/>
</g>
<!-- Expert15_s0_l5_tp3 -->
<g id="node431" class="node">
<title>Expert15_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="8823.42,-13055.15 8515.42,-13055.15 8515.42,-13002.15 8823.42,-13002.15 8823.42,-13055.15"/>
<text text-anchor="middle" x="8669.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="8669.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8669.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp3&#45;&gt;Expert15_s0_l5_tp3 -->
<g id="edge696" class="edge">
<title>Gate_s0_l5_tp3&#45;&gt;Expert15_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8439.03,-13091.14C8478.26,-13080.67 8523.8,-13068.51 8563.99,-13057.79"/>
<polygon fill="black" stroke="black" points="8565.06,-13061.13 8573.82,-13055.17 8563.25,-13054.36 8565.06,-13061.13"/>
</g>
<!-- Expert16_s0_l5_tp4 -->
<g id="node432" class="node">
<title>Expert16_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9149.42,-13055.15 8841.42,-13055.15 8841.42,-13002.15 9149.42,-13002.15 9149.42,-13055.15"/>
<text text-anchor="middle" x="8995.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="8995.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8995.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp4&#45;&gt;Expert16_s0_l5_tp4 -->
<g id="edge697" class="edge">
<title>Gate_s0_l5_tp4&#45;&gt;Expert16_s0_l5_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9353.02,-13091.14C9290.47,-13080.38 9217.55,-13067.85 9153.94,-13056.91"/>
<polygon fill="black" stroke="black" points="9154.27,-13053.41 9143.82,-13055.17 9153.08,-13060.31 9154.27,-13053.41"/>
</g>
<!-- Expert17_s0_l5_tp4 -->
<g id="node433" class="node">
<title>Expert17_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9475.42,-13055.15 9167.42,-13055.15 9167.42,-13002.15 9475.42,-13002.15 9475.42,-13055.15"/>
<text text-anchor="middle" x="9321.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="9321.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9321.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp4&#45;&gt;Expert17_s0_l5_tp4 -->
<g id="edge698" class="edge">
<title>Gate_s0_l5_tp4&#45;&gt;Expert17_s0_l5_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.39,-13091.02C9428.06,-13081.2 9404.7,-13069.9 9383.59,-13059.7"/>
<polygon fill="black" stroke="black" points="9384.91,-13056.45 9374.39,-13055.25 9381.87,-13062.76 9384.91,-13056.45"/>
</g>
<!-- Expert18_s0_l5_tp4 -->
<g id="node434" class="node">
<title>Expert18_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="9801.42,-13055.15 9493.42,-13055.15 9493.42,-13002.15 9801.42,-13002.15 9801.42,-13055.15"/>
<text text-anchor="middle" x="9647.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="9647.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9647.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp4&#45;&gt;Expert18_s0_l5_tp4 -->
<g id="edge699" class="edge">
<title>Gate_s0_l5_tp4&#45;&gt;Expert18_s0_l5_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9544.44,-13091.02C9560.55,-13081.42 9579.03,-13070.41 9595.84,-13060.39"/>
<polygon fill="black" stroke="black" points="9597.66,-13063.38 9604.46,-13055.25 9594.08,-13057.36 9597.66,-13063.38"/>
</g>
<!-- Expert19_s0_l5_tp4 -->
<g id="node435" class="node">
<title>Expert19_s0_l5_tp4</title>
<polygon fill="none" stroke="black" points="10127.42,-13055.15 9819.42,-13055.15 9819.42,-13002.15 10127.42,-13002.15 10127.42,-13055.15"/>
<text text-anchor="middle" x="9973.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="9973.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9973.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp4&#45;&gt;Expert19_s0_l5_tp4 -->
<g id="edge700" class="edge">
<title>Gate_s0_l5_tp4&#45;&gt;Expert19_s0_l5_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9639.85,-13091.14C9697.96,-13080.43 9765.66,-13067.95 9824.82,-13057.04"/>
<polygon fill="black" stroke="black" points="9825.8,-13060.42 9835,-13055.17 9824.53,-13053.54 9825.8,-13060.42"/>
</g>
<!-- Expert20_s0_l5_tp5 -->
<g id="node436" class="node">
<title>Expert20_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="2629.42,-13055.15 2321.42,-13055.15 2321.42,-13002.15 2629.42,-13002.15 2629.42,-13055.15"/>
<text text-anchor="middle" x="2475.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="2475.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2475.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp5&#45;&gt;Expert20_s0_l5_tp5 -->
<g id="edge701" class="edge">
<title>Gate_s0_l5_tp5&#45;&gt;Expert20_s0_l5_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2958.37,-13096.66C2866.87,-13085.53 2751.63,-13071.02 2639.94,-13055.35"/>
<polygon fill="black" stroke="black" points="2640.23,-13051.86 2629.84,-13053.93 2639.25,-13058.79 2640.23,-13051.86"/>
</g>
<!-- Expert21_s0_l5_tp5 -->
<g id="node437" class="node">
<title>Expert21_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="2955.42,-13055.15 2647.42,-13055.15 2647.42,-13002.15 2955.42,-13002.15 2955.42,-13055.15"/>
<text text-anchor="middle" x="2801.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="2801.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2801.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp5&#45;&gt;Expert21_s0_l5_tp5 -->
<g id="edge702" class="edge">
<title>Gate_s0_l5_tp5&#45;&gt;Expert21_s0_l5_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3031.81,-13091.14C2992.59,-13080.67 2947.04,-13068.51 2906.85,-13057.79"/>
<polygon fill="black" stroke="black" points="2907.59,-13054.36 2897.03,-13055.17 2905.79,-13061.13 2907.59,-13054.36"/>
</g>
<!-- Expert22_s0_l5_tp5 -->
<g id="node438" class="node">
<title>Expert22_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="3281.42,-13055.15 2973.42,-13055.15 2973.42,-13002.15 3281.42,-13002.15 3281.42,-13055.15"/>
<text text-anchor="middle" x="3127.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="3127.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3127.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp5&#45;&gt;Expert22_s0_l5_tp5 -->
<g id="edge703" class="edge">
<title>Gate_s0_l5_tp5&#45;&gt;Expert22_s0_l5_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3127.42,-13091.02C3127.42,-13083.04 3127.42,-13074.09 3127.42,-13065.54"/>
<polygon fill="black" stroke="black" points="3130.92,-13065.4 3127.42,-13055.4 3123.92,-13065.4 3130.92,-13065.4"/>
</g>
<!-- Expert23_s0_l5_tp5 -->
<g id="node439" class="node">
<title>Expert23_s0_l5_tp5</title>
<polygon fill="none" stroke="black" points="3607.42,-13055.15 3299.42,-13055.15 3299.42,-13002.15 3607.42,-13002.15 3607.42,-13055.15"/>
<text text-anchor="middle" x="3453.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="3453.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3453.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp5&#45;&gt;Expert23_s0_l5_tp5 -->
<g id="edge704" class="edge">
<title>Gate_s0_l5_tp5&#45;&gt;Expert23_s0_l5_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3223.03,-13091.14C3262.26,-13080.67 3307.8,-13068.51 3347.99,-13057.79"/>
<polygon fill="black" stroke="black" points="3349.06,-13061.13 3357.82,-13055.17 3347.25,-13054.36 3349.06,-13061.13"/>
</g>
<!-- Expert24_s0_l5_tp6 -->
<g id="node440" class="node">
<title>Expert24_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="11757.42,-13055.15 11449.42,-13055.15 11449.42,-13002.15 11757.42,-13002.15 11757.42,-13055.15"/>
<text text-anchor="middle" x="11603.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="11603.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11603.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp6&#45;&gt;Expert24_s0_l5_tp6 -->
<g id="edge705" class="edge">
<title>Gate_s0_l5_tp6&#45;&gt;Expert24_s0_l5_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11833.81,-13091.14C11794.59,-13080.67 11749.04,-13068.51 11708.85,-13057.79"/>
<polygon fill="black" stroke="black" points="11709.59,-13054.36 11699.03,-13055.17 11707.79,-13061.13 11709.59,-13054.36"/>
</g>
<!-- Expert25_s0_l5_tp6 -->
<g id="node441" class="node">
<title>Expert25_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="12083.42,-13055.15 11775.42,-13055.15 11775.42,-13002.15 12083.42,-13002.15 12083.42,-13055.15"/>
<text text-anchor="middle" x="11929.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="11929.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11929.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp6&#45;&gt;Expert25_s0_l5_tp6 -->
<g id="edge706" class="edge">
<title>Gate_s0_l5_tp6&#45;&gt;Expert25_s0_l5_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11929.42,-13091.02C11929.42,-13083.04 11929.42,-13074.09 11929.42,-13065.54"/>
<polygon fill="black" stroke="black" points="11932.92,-13065.4 11929.42,-13055.4 11925.92,-13065.4 11932.92,-13065.4"/>
</g>
<!-- Expert26_s0_l5_tp6 -->
<g id="node442" class="node">
<title>Expert26_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="12409.42,-13055.15 12101.42,-13055.15 12101.42,-13002.15 12409.42,-13002.15 12409.42,-13055.15"/>
<text text-anchor="middle" x="12255.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="12255.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12255.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp6&#45;&gt;Expert26_s0_l5_tp6 -->
<g id="edge707" class="edge">
<title>Gate_s0_l5_tp6&#45;&gt;Expert26_s0_l5_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12025.03,-13091.14C12064.26,-13080.67 12109.8,-13068.51 12149.99,-13057.79"/>
<polygon fill="black" stroke="black" points="12151.06,-13061.13 12159.82,-13055.17 12149.25,-13054.36 12151.06,-13061.13"/>
</g>
<!-- Expert27_s0_l5_tp6 -->
<g id="node443" class="node">
<title>Expert27_s0_l5_tp6</title>
<polygon fill="none" stroke="black" points="12735.42,-13055.15 12427.42,-13055.15 12427.42,-13002.15 12735.42,-13002.15 12735.42,-13055.15"/>
<text text-anchor="middle" x="12581.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="12581.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12581.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp6&#45;&gt;Expert27_s0_l5_tp6 -->
<g id="edge708" class="edge">
<title>Gate_s0_l5_tp6&#45;&gt;Expert27_s0_l5_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12098.47,-13096.66C12189.97,-13085.53 12305.22,-13071.02 12416.9,-13055.35"/>
<polygon fill="black" stroke="black" points="12417.59,-13058.79 12427.01,-13053.93 12416.62,-13051.86 12417.59,-13058.79"/>
</g>
<!-- Expert28_s0_l5_tp7 -->
<g id="node444" class="node">
<title>Expert28_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="10453.42,-13055.15 10145.42,-13055.15 10145.42,-13002.15 10453.42,-13002.15 10453.42,-13055.15"/>
<text text-anchor="middle" x="10299.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="10299.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10299.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp7&#45;&gt;Expert28_s0_l5_tp7 -->
<g id="edge709" class="edge">
<title>Gate_s0_l5_tp7&#45;&gt;Expert28_s0_l5_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10529.81,-13091.14C10490.59,-13080.67 10445.04,-13068.51 10404.85,-13057.79"/>
<polygon fill="black" stroke="black" points="10405.59,-13054.36 10395.03,-13055.17 10403.79,-13061.13 10405.59,-13054.36"/>
</g>
<!-- Expert29_s0_l5_tp7 -->
<g id="node445" class="node">
<title>Expert29_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="10779.42,-13055.15 10471.42,-13055.15 10471.42,-13002.15 10779.42,-13002.15 10779.42,-13055.15"/>
<text text-anchor="middle" x="10625.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="10625.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10625.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp7&#45;&gt;Expert29_s0_l5_tp7 -->
<g id="edge710" class="edge">
<title>Gate_s0_l5_tp7&#45;&gt;Expert29_s0_l5_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10625.42,-13091.02C10625.42,-13083.04 10625.42,-13074.09 10625.42,-13065.54"/>
<polygon fill="black" stroke="black" points="10628.92,-13065.4 10625.42,-13055.4 10621.92,-13065.4 10628.92,-13065.4"/>
</g>
<!-- Expert30_s0_l5_tp7 -->
<g id="node446" class="node">
<title>Expert30_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="11105.42,-13055.15 10797.42,-13055.15 10797.42,-13002.15 11105.42,-13002.15 11105.42,-13055.15"/>
<text text-anchor="middle" x="10951.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="10951.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10951.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp7&#45;&gt;Expert30_s0_l5_tp7 -->
<g id="edge711" class="edge">
<title>Gate_s0_l5_tp7&#45;&gt;Expert30_s0_l5_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10721.03,-13091.14C10760.26,-13080.67 10805.8,-13068.51 10845.99,-13057.79"/>
<polygon fill="black" stroke="black" points="10847.06,-13061.13 10855.82,-13055.17 10845.25,-13054.36 10847.06,-13061.13"/>
</g>
<!-- Expert31_s0_l5_tp7 -->
<g id="node447" class="node">
<title>Expert31_s0_l5_tp7</title>
<polygon fill="none" stroke="black" points="11431.42,-13055.15 11123.42,-13055.15 11123.42,-13002.15 11431.42,-13002.15 11431.42,-13055.15"/>
<text text-anchor="middle" x="11277.42" y="-13039.95" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="11277.42" y="-13024.95" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11277.42" y="-13009.95" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l5_tp7&#45;&gt;Expert31_s0_l5_tp7 -->
<g id="edge712" class="edge">
<title>Gate_s0_l5_tp7&#45;&gt;Expert31_s0_l5_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10794.47,-13096.66C10885.97,-13085.53 11001.22,-13071.02 11112.9,-13055.35"/>
<polygon fill="black" stroke="black" points="11113.59,-13058.79 11123.01,-13053.93 11112.62,-13051.86 11113.59,-13058.79"/>
</g>
<!-- AR_exp_s0_l5 -->
<g id="node448" class="node">
<title>AR_exp_s0_l5</title>
<ellipse fill="none" stroke="black" cx="7495.42" cy="-12928.68" rx="239" ry="37.45"/>
<text text-anchor="middle" x="7495.42" y="-12939.98" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="7495.42" y="-12924.98" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7495.42" y="-12909.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l5_tp0&#45;&gt;AR_exp_s0_l5 -->
<g id="edge713" class="edge">
<title>Expert0_s0_l5_tp0&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M7158.34,-13002.1C7216.08,-12989.7 7286.04,-12974.66 7347.22,-12961.52"/>
<polygon fill="black" stroke="black" points="7348.31,-12964.86 7357.35,-12959.34 7346.84,-12958.02 7348.31,-12964.86"/>
</g>
<!-- Expert1_s0_l5_tp0&#45;&gt;AR_exp_s0_l5 -->
<g id="edge714" class="edge">
<title>Expert1_s0_l5_tp0&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M7399.58,-13001.91C7411.79,-12992.71 7425.89,-12982.08 7439.46,-12971.86"/>
<polygon fill="black" stroke="black" points="7441.93,-12974.37 7447.81,-12965.56 7437.72,-12968.78 7441.93,-12974.37"/>
</g>
<!-- Expert2_s0_l5_tp0&#45;&gt;AR_exp_s0_l5 -->
<g id="edge715" class="edge">
<title>Expert2_s0_l5_tp0&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M6541.81,-13003.18C6544.71,-13002.83 6547.58,-13002.48 6550.42,-13002.15 6792.08,-12974.03 7069.82,-12954.21 7261.35,-12942.49"/>
<polygon fill="black" stroke="black" points="7261.78,-12945.97 7271.55,-12941.87 7261.36,-12938.99 7261.78,-12945.97"/>
</g>
<!-- Expert3_s0_l5_tp0&#45;&gt;AR_exp_s0_l5 -->
<g id="edge716" class="edge">
<title>Expert3_s0_l5_tp0&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M6867.83,-13003.34C6870.72,-13002.94 6873.58,-13002.54 6876.42,-13002.15 7014.32,-12983.3 7169.92,-12965.09 7290.62,-12951.65"/>
<polygon fill="black" stroke="black" points="7291.17,-12955.11 7300.72,-12950.52 7290.39,-12948.15 7291.17,-12955.11"/>
</g>
<!-- Expert4_s0_l5_tp1&#45;&gt;AR_exp_s0_l5 -->
<g id="edge717" class="edge">
<title>Expert4_s0_l5_tp1&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M4585.79,-13002.98C4588.69,-13002.69 4591.57,-13002.41 4594.42,-13002.15 5105.84,-12955.96 6642.22,-12937.38 7246.97,-12931.72"/>
<polygon fill="black" stroke="black" points="7247.16,-12935.22 7257.13,-12931.63 7247.09,-12928.22 7247.16,-12935.22"/>
</g>
<!-- Expert5_s0_l5_tp1&#45;&gt;AR_exp_s0_l5 -->
<g id="edge718" class="edge">
<title>Expert5_s0_l5_tp1&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M4911.79,-13002.99C4914.69,-13002.7 4917.57,-13002.42 4920.42,-13002.15 5366.79,-12961.12 6692.95,-12939.91 7247.41,-12932.64"/>
<polygon fill="black" stroke="black" points="7247.58,-12936.14 7257.54,-12932.5 7247.49,-12929.14 7247.58,-12936.14"/>
</g>
<!-- Expert6_s0_l5_tp1&#45;&gt;AR_exp_s0_l5 -->
<g id="edge719" class="edge">
<title>Expert6_s0_l5_tp1&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M3933.79,-13002.96C3936.69,-13002.67 3939.57,-13002.4 3942.42,-13002.15 4585.07,-12945.59 6548.83,-12933.07 7246.37,-12930.39"/>
<polygon fill="black" stroke="black" points="7246.55,-12933.89 7256.54,-12930.35 7246.53,-12926.89 7246.55,-12933.89"/>
</g>
<!-- Expert7_s0_l5_tp1&#45;&gt;AR_exp_s0_l5 -->
<g id="edge720" class="edge">
<title>Expert7_s0_l5_tp1&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M4259.79,-13002.97C4262.69,-13002.68 4265.57,-13002.41 4268.42,-13002.15 4845.2,-12950.79 6593.8,-12935.12 7246.34,-12930.99"/>
<polygon fill="black" stroke="black" points="7246.83,-12934.49 7256.81,-12930.93 7246.79,-12927.49 7246.83,-12934.49"/>
</g>
<!-- Expert8_s0_l5_tp2&#45;&gt;AR_exp_s0_l5 -->
<g id="edge721" class="edge">
<title>Expert8_s0_l5_tp2&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M6215.81,-13003.11C6218.7,-13002.77 6221.57,-13002.46 6224.42,-13002.15 6580.37,-12964.25 6994.66,-12945.3 7251,-12936.49"/>
<polygon fill="black" stroke="black" points="7251.31,-12939.98 7261.19,-12936.14 7251.08,-12932.98 7251.31,-12939.98"/>
</g>
<!-- Expert9_s0_l5_tp2&#45;&gt;AR_exp_s0_l5 -->
<g id="edge722" class="edge">
<title>Expert9_s0_l5_tp2&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M5237.8,-13003.01C5240.69,-13002.71 5243.57,-13002.42 5246.42,-13002.15 5628.24,-12966.27 6747.24,-12942.8 7248.1,-12933.8"/>
<polygon fill="black" stroke="black" points="7248.42,-12937.3 7258.35,-12933.62 7248.29,-12930.3 7248.42,-12937.3"/>
</g>
<!-- Expert10_s0_l5_tp2&#45;&gt;AR_exp_s0_l5 -->
<g id="edge723" class="edge">
<title>Expert10_s0_l5_tp2&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M5563.8,-13003.03C5566.69,-13002.72 5569.57,-13002.43 5572.42,-13002.15 6171.21,-12944.23 6879.03,-12931.94 7246.26,-12929.74"/>
<polygon fill="black" stroke="black" points="7246.51,-12933.23 7256.49,-12929.68 7246.47,-12926.23 7246.51,-12933.23"/>
</g>
<!-- Expert11_s0_l5_tp2&#45;&gt;AR_exp_s0_l5 -->
<g id="edge724" class="edge">
<title>Expert11_s0_l5_tp2&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M5889.8,-13003.06C5892.7,-13002.74 5895.57,-13002.44 5898.42,-13002.15 6374.1,-12954.3 6932.69,-12938.03 7247.24,-12932.51"/>
<polygon fill="black" stroke="black" points="7247.47,-12936 7257.4,-12932.33 7247.35,-12929 7247.47,-12936"/>
</g>
<!-- Expert12_s0_l5_tp3&#45;&gt;AR_exp_s0_l5 -->
<g id="edge725" class="edge">
<title>Expert12_s0_l5_tp3&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M7640.18,-13002.04C7620.04,-12991.97 7596.47,-12980.19 7574.26,-12969.08"/>
<polygon fill="black" stroke="black" points="7575.68,-12965.88 7565.17,-12964.54 7572.55,-12972.14 7575.68,-12965.88"/>
</g>
<!-- Expert13_s0_l5_tp3&#45;&gt;AR_exp_s0_l5 -->
<g id="edge726" class="edge">
<title>Expert13_s0_l5_tp3&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M7881.3,-13002.1C7812.2,-12989.13 7727.82,-12973.3 7655.61,-12959.74"/>
<polygon fill="black" stroke="black" points="7655.98,-12956.25 7645.51,-12957.85 7654.69,-12963.13 7655.98,-12956.25"/>
</g>
<!-- Expert14_s0_l5_tp3&#45;&gt;AR_exp_s0_l5 -->
<g id="edge727" class="edge">
<title>Expert14_s0_l5_tp3&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M8189.02,-13003.3C8186.13,-13002.91 8183.26,-13002.53 8180.42,-13002.15 8022.67,-12981.48 7843.87,-12962.72 7708.51,-12949.47"/>
<polygon fill="black" stroke="black" points="7708.72,-12945.97 7698.43,-12948.48 7708.04,-12952.94 7708.72,-12945.97"/>
</g>
<!-- Expert15_s0_l5_tp3&#45;&gt;AR_exp_s0_l5 -->
<g id="edge728" class="edge">
<title>Expert15_s0_l5_tp3&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M8515.03,-13003.16C8512.14,-13002.81 8509.27,-13002.48 8506.42,-13002.15 8242.15,-12972.06 7937.51,-12952.24 7732.29,-12941.05"/>
<polygon fill="black" stroke="black" points="7732.46,-12937.55 7722.29,-12940.5 7732.08,-12944.54 7732.46,-12937.55"/>
</g>
<!-- Expert16_s0_l5_tp4&#45;&gt;AR_exp_s0_l5 -->
<g id="edge729" class="edge">
<title>Expert16_s0_l5_tp4&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M8841.04,-13003.1C8838.15,-13002.77 8835.27,-13002.45 8832.42,-13002.15 8452.67,-12962.26 8009.79,-12943.72 7741.14,-12935.56"/>
<polygon fill="black" stroke="black" points="7740.97,-12932.05 7730.87,-12935.25 7740.76,-12939.05 7740.97,-12932.05"/>
</g>
<!-- Expert17_s0_l5_tp4&#45;&gt;AR_exp_s0_l5 -->
<g id="edge730" class="edge">
<title>Expert17_s0_l5_tp4&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M9167.04,-13003.05C9164.15,-13002.74 9161.27,-13002.44 9158.42,-13002.15 8658.03,-12952.27 8069.55,-12936.71 7743.92,-12931.87"/>
<polygon fill="black" stroke="black" points="7743.94,-12928.37 7733.89,-12931.72 7743.83,-12935.36 7743.94,-12928.37"/>
</g>
<!-- Expert18_s0_l5_tp4&#45;&gt;AR_exp_s0_l5 -->
<g id="edge731" class="edge">
<title>Expert18_s0_l5_tp4&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M9493.05,-13003.03C9490.15,-13002.72 9487.27,-13002.43 9484.42,-13002.15 8860.45,-12942.19 8122.02,-12930.82 7744.68,-12929.28"/>
<polygon fill="black" stroke="black" points="7744.47,-12925.78 7734.45,-12929.24 7744.44,-12932.78 7744.47,-12925.78"/>
</g>
<!-- Expert19_s0_l5_tp4&#45;&gt;AR_exp_s0_l5 -->
<g id="edge732" class="edge">
<title>Expert19_s0_l5_tp4&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M9819.05,-13003.01C9816.15,-13002.7 9813.27,-13002.42 9810.42,-13002.15 9415.56,-12965.23 8254.77,-12942.18 7742.82,-12933.54"/>
<polygon fill="black" stroke="black" points="7742.77,-12930.04 7732.71,-12933.37 7742.65,-12937.04 7742.77,-12930.04"/>
</g>
<!-- Expert20_s0_l5_tp5&#45;&gt;AR_exp_s0_l5 -->
<g id="edge733" class="edge">
<title>Expert20_s0_l5_tp5&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M2629.79,-13002.94C2632.69,-13002.66 2635.57,-13002.4 2638.42,-13002.15 3098.03,-12962.97 6319.69,-12937.82 7246.54,-12931.34"/>
<polygon fill="black" stroke="black" points="7246.69,-12934.84 7256.66,-12931.27 7246.64,-12927.84 7246.69,-12934.84"/>
</g>
<!-- Expert21_s0_l5_tp5&#45;&gt;AR_exp_s0_l5 -->
<g id="edge734" class="edge">
<title>Expert21_s0_l5_tp5&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M2955.79,-13002.94C2958.69,-13002.66 2961.57,-13002.4 2964.42,-13002.15 3806.13,-12929.94 6424.39,-12927.88 7246.1,-12929.09"/>
<polygon fill="black" stroke="black" points="7246.27,-12932.59 7256.28,-12929.11 7246.28,-12925.59 7246.27,-12932.59"/>
</g>
<!-- Expert22_s0_l5_tp5&#45;&gt;AR_exp_s0_l5 -->
<g id="edge735" class="edge">
<title>Expert22_s0_l5_tp5&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M3281.79,-13002.95C3284.69,-13002.67 3287.57,-13002.4 3290.42,-13002.15 4065.47,-12935.17 6463.74,-12929.48 7245.94,-12929.46"/>
<polygon fill="black" stroke="black" points="7246.2,-12932.96 7256.2,-12929.46 7246.2,-12925.96 7246.2,-12932.96"/>
</g>
<!-- Expert23_s0_l5_tp5&#45;&gt;AR_exp_s0_l5 -->
<g id="edge736" class="edge">
<title>Expert23_s0_l5_tp5&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M3607.79,-13002.96C3610.69,-13002.67 3613.57,-13002.4 3616.42,-13002.15 4325.13,-12940.39 6505.28,-12931.21 7246.08,-12929.88"/>
<polygon fill="black" stroke="black" points="7246.35,-12933.38 7256.34,-12929.87 7246.34,-12926.38 7246.35,-12933.38"/>
</g>
<!-- Expert24_s0_l5_tp6&#45;&gt;AR_exp_s0_l5 -->
<g id="edge737" class="edge">
<title>Expert24_s0_l5_tp6&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M11449.05,-13002.95C11446.16,-13002.67 11443.28,-13002.4 11440.42,-13002.15 10718.29,-12939.33 8494.02,-12930.85 7744.75,-12929.79"/>
<polygon fill="black" stroke="black" points="7744.65,-12926.29 7734.64,-12929.78 7744.64,-12933.29 7744.65,-12926.29"/>
</g>
<!-- Expert25_s0_l5_tp6&#45;&gt;AR_exp_s0_l5 -->
<g id="edge738" class="edge">
<title>Expert25_s0_l5_tp6&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M11775.05,-13002.95C11772.16,-13002.67 11769.28,-13002.4 11766.42,-13002.15 10977.85,-12934.11 8534.87,-12929.15 7744.72,-12929.38"/>
<polygon fill="black" stroke="black" points="7744.64,-12925.88 7734.64,-12929.38 7744.64,-12932.88 7744.64,-12925.88"/>
</g>
<!-- Expert26_s0_l5_tp6&#45;&gt;AR_exp_s0_l5 -->
<g id="edge739" class="edge">
<title>Expert26_s0_l5_tp6&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M12101.05,-13002.94C12098.16,-13002.66 12095.28,-13002.4 12092.42,-13002.15 11237.21,-12928.88 8574.35,-12927.57 7744.77,-12929.02"/>
<polygon fill="black" stroke="black" points="7744.49,-12925.52 7734.49,-12929.04 7744.5,-12932.52 7744.49,-12925.52"/>
</g>
<!-- Expert27_s0_l5_tp6&#45;&gt;AR_exp_s0_l5 -->
<g id="edge740" class="edge">
<title>Expert27_s0_l5_tp6&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M12427.06,-13002.94C12424.16,-13002.66 12421.28,-13002.4 12418.42,-13002.15 11951.97,-12962.43 8678.76,-12937.62 7744.09,-12931.29"/>
<polygon fill="black" stroke="black" points="7743.91,-12927.78 7733.88,-12931.22 7743.86,-12934.78 7743.91,-12927.78"/>
</g>
<!-- Expert28_s0_l5_tp7&#45;&gt;AR_exp_s0_l5 -->
<g id="edge741" class="edge">
<title>Expert28_s0_l5_tp7&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M10145.05,-13002.99C10142.15,-13002.69 10139.27,-13002.41 10136.42,-13002.15 9676.98,-12960.08 8308.75,-12939.38 7743.74,-12932.44"/>
<polygon fill="black" stroke="black" points="7743.47,-12928.93 7733.43,-12932.31 7743.38,-12935.93 7743.47,-12928.93"/>
</g>
<!-- Expert29_s0_l5_tp7&#45;&gt;AR_exp_s0_l5 -->
<g id="edge742" class="edge">
<title>Expert29_s0_l5_tp7&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M10471.05,-13002.98C10468.15,-13002.69 10465.28,-13002.41 10462.42,-13002.15 9937.85,-12954.92 8358.92,-12936.9 7744.18,-12931.56"/>
<polygon fill="black" stroke="black" points="7743.88,-12928.06 7733.85,-12931.47 7743.82,-12935.06 7743.88,-12928.06"/>
</g>
<!-- Expert30_s0_l5_tp7&#45;&gt;AR_exp_s0_l5 -->
<g id="edge743" class="edge">
<title>Expert30_s0_l5_tp7&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M10797.05,-13002.97C10794.15,-13002.68 10791.28,-13002.41 10788.42,-13002.15 10198.28,-12949.73 8406.01,-12934.69 7744.33,-12930.86"/>
<polygon fill="black" stroke="black" points="7744.21,-12927.36 7734.19,-12930.8 7744.17,-12934.36 7744.21,-12927.36"/>
</g>
<!-- Expert31_s0_l5_tp7&#45;&gt;AR_exp_s0_l5 -->
<g id="edge744" class="edge">
<title>Expert31_s0_l5_tp7&#45;&gt;AR_exp_s0_l5</title>
<path fill="none" stroke="black" d="M11123.05,-13002.96C11120.15,-13002.67 11117.28,-13002.4 11114.42,-13002.15 10458.39,-12944.53 8450.77,-12932.68 7744.43,-12930.28"/>
<polygon fill="black" stroke="black" points="7744.39,-12926.78 7734.38,-12930.24 7744.37,-12933.78 7744.39,-12926.78"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp0 -->
<g id="edge745" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M7441.26,-12892.01C7426.49,-12882.28 7410.11,-12871.49 7393.99,-12860.87"/>
<polygon fill="black" stroke="black" points="7395.87,-12857.92 7385.59,-12855.34 7392.02,-12863.77 7395.87,-12857.92"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp1 -->
<g id="edge747" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M7266.41,-12917.77C6948.44,-12903.98 6355.2,-12878.11 5849.42,-12855.2 5576.53,-12842.84 5266.16,-12828.36 5041.96,-12817.82"/>
<polygon fill="black" stroke="black" points="5041.84,-12814.31 5031.69,-12817.34 5041.51,-12821.3 5041.84,-12814.31"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp2 -->
<g id="edge749" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M7294.68,-12908.26C7093.33,-12888.79 6779.71,-12858.45 6541.11,-12835.38"/>
<polygon fill="black" stroke="black" points="6541.17,-12831.87 6530.88,-12834.39 6540.49,-12838.83 6541.17,-12831.87"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp3 -->
<g id="edge751" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M7645.19,-12899.43C7727.57,-12883.89 7831.57,-12864.28 7924.15,-12846.82"/>
<polygon fill="black" stroke="black" points="7925.04,-12850.21 7934.22,-12844.92 7923.75,-12843.33 7925.04,-12850.21"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp4 -->
<g id="edge753" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp4</title>
<path fill="none" stroke="black" d="M7723.04,-12917.17C8217.78,-12894.34 9389.28,-12840.27 9921.24,-12815.72"/>
<polygon fill="black" stroke="black" points="9921.53,-12819.21 9931.36,-12815.25 9921.21,-12812.21 9921.53,-12819.21"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp5 -->
<g id="edge755" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp5</title>
<path fill="none" stroke="black" d="M7259.45,-12922.56C6738.61,-12911.2 5451.29,-12882.67 4373.42,-12855.2 3818.65,-12841.06 3171.54,-12822.69 2801.21,-12811.99"/>
<polygon fill="black" stroke="black" points="2801.25,-12808.49 2791.15,-12811.7 2801.05,-12815.49 2801.25,-12808.49"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp6 -->
<g id="edge757" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp6</title>
<path fill="none" stroke="black" d="M7733.78,-12925.64C8531.16,-12918.53 11101.69,-12893.17 11929.42,-12855.2 12072.34,-12848.64 12231.64,-12836.91 12361.04,-12826.25"/>
<polygon fill="black" stroke="black" points="12361.41,-12829.73 12371.09,-12825.41 12360.84,-12822.75 12361.41,-12829.73"/>
</g>
<!-- AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp7 -->
<g id="edge759" class="edge">
<title>AR_exp_s0_l5&#45;&gt;ResMOE_s0_l5_tp7</title>
<path fill="none" stroke="black" d="M7732.75,-12924.25C8246.71,-12916.35 9501.03,-12894.45 10551.42,-12855.2 10806.68,-12845.66 11097.69,-12830.37 11303.19,-12818.83"/>
<polygon fill="black" stroke="black" points="11303.43,-12822.32 11313.21,-12818.27 11303.03,-12815.34 11303.43,-12822.32"/>
</g>
<!-- QKV_s0_l6_tp0 -->
<g id="node457" class="node">
<title>QKV_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6542.42,-12713.2 6204.42,-12713.2 6204.42,-12660.2 6542.42,-12660.2 6542.42,-12713.2"/>
<text text-anchor="middle" x="6373.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6373.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6373.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp0 -->
<g id="edge761" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6973.85,-12762.36C6846.94,-12747.32 6700.94,-12729.76 6568.42,-12713.2 6563.26,-12712.55 6558.02,-12711.9 6552.74,-12711.23"/>
<polygon fill="black" stroke="black" points="6552.88,-12707.72 6542.52,-12709.93 6552,-12714.66 6552.88,-12707.72"/>
</g>
<!-- QKV_s0_l6_tp1 -->
<g id="node458" class="node">
<title>QKV_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="6915.42,-12713.2 6577.42,-12713.2 6577.42,-12660.2 6915.42,-12660.2 6915.42,-12713.2"/>
<text text-anchor="middle" x="6746.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6746.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6746.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp1 -->
<g id="edge762" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M7049.78,-12749.18C6992.04,-12737.48 6932.98,-12725.51 6882.49,-12715.28"/>
<polygon fill="black" stroke="black" points="6883,-12711.81 6872.51,-12713.25 6881.61,-12718.67 6883,-12711.81"/>
</g>
<!-- QKV_s0_l6_tp2 -->
<g id="node459" class="node">
<title>QKV_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="7296.42,-12713.2 6958.42,-12713.2 6958.42,-12660.2 7296.42,-12660.2 7296.42,-12713.2"/>
<text text-anchor="middle" x="7127.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7127.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7127.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp2 -->
<g id="edge763" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M7224.26,-12749.1C7207.82,-12738.68 7191.04,-12728.04 7176.18,-12718.61"/>
<polygon fill="black" stroke="black" points="7177.98,-12715.61 7167.66,-12713.21 7174.23,-12721.52 7177.98,-12715.61"/>
</g>
<!-- QKV_s0_l6_tp3 -->
<g id="node460" class="node">
<title>QKV_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7661.42,-12713.2 7323.42,-12713.2 7323.42,-12660.2 7661.42,-12660.2 7661.42,-12713.2"/>
<text text-anchor="middle" x="7492.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7492.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7492.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp3 -->
<g id="edge764" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7391.8,-12749.1C7408.89,-12738.68 7426.31,-12728.04 7441.76,-12718.61"/>
<polygon fill="black" stroke="black" points="7443.9,-12721.41 7450.61,-12713.21 7440.25,-12715.43 7443.9,-12721.41"/>
</g>
<!-- QKV_s0_l6_tp4 -->
<g id="node461" class="node">
<title>QKV_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="8042.42,-12713.2 7704.42,-12713.2 7704.42,-12660.2 8042.42,-12660.2 8042.42,-12713.2"/>
<text text-anchor="middle" x="7873.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7873.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7873.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp4 -->
<g id="edge765" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7524.83,-12757.48C7595.75,-12743.28 7672.42,-12727.94 7735.74,-12715.26"/>
<polygon fill="black" stroke="black" points="7736.67,-12718.64 7745.79,-12713.25 7735.3,-12711.78 7736.67,-12718.64"/>
</g>
<!-- QKV_s0_l6_tp5 -->
<g id="node462" class="node">
<title>QKV_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="8428.42,-12713.2 8090.42,-12713.2 8090.42,-12660.2 8428.42,-12660.2 8428.42,-12713.2"/>
<text text-anchor="middle" x="8259.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8259.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8259.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp5 -->
<g id="edge766" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M7545.93,-12773.18C7692.01,-12756.02 7882.52,-12733.53 8051.42,-12713.2 8060.81,-12712.07 8070.43,-12710.91 8080.14,-12709.73"/>
<polygon fill="black" stroke="black" points="8080.78,-12713.18 8090.29,-12708.5 8079.94,-12706.23 8080.78,-12713.18"/>
</g>
<!-- QKV_s0_l6_tp6 -->
<g id="node463" class="node">
<title>QKV_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="8816.42,-12713.2 8478.42,-12713.2 8478.42,-12660.2 8816.42,-12660.2 8816.42,-12713.2"/>
<text text-anchor="middle" x="8647.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8647.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8647.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp6 -->
<g id="edge767" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M7546.39,-12773.33C7625.89,-12764.74 7714.89,-12755.81 7796.42,-12749.2 8080.83,-12726.14 8153.2,-12738.41 8437.42,-12713.2 8447.47,-12712.31 8457.78,-12711.31 8468.18,-12710.25"/>
<polygon fill="black" stroke="black" points="8468.59,-12713.73 8478.18,-12709.21 8467.87,-12706.76 8468.59,-12713.73"/>
</g>
<!-- QKV_s0_l6_tp7 -->
<g id="node464" class="node">
<title>QKV_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="6152.42,-12713.2 5814.42,-12713.2 5814.42,-12660.2 6152.42,-12660.2 6152.42,-12713.2"/>
<text text-anchor="middle" x="5983.42" y="-12698" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5983.42" y="-12683" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5983.42" y="-12668" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp7 -->
<g id="edge768" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;QKV_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M6997.82,-12780.14C6774.71,-12764.09 6466.17,-12740.19 6195.42,-12713.2 6184.76,-12712.14 6173.8,-12710.99 6162.76,-12709.79"/>
<polygon fill="black" stroke="black" points="6162.91,-12706.28 6152.59,-12708.67 6162.15,-12713.24 6162.91,-12706.28"/>
</g>
<!-- ResAttn_s0_l6_tp0 -->
<g id="node491" class="node">
<title>ResAttn_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6702.77,-12135.29 6145.45,-12135.29 6002.08,-12029.29 6559.4,-12029.29 6702.77,-12135.29"/>
<text text-anchor="middle" x="6352.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6352.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6352.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp0 -->
<g id="edge810" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6994.14,-12777.63C6862.47,-12768.1 6707.53,-12757.44 6567.42,-12749.2 6482.81,-12744.22 5878.36,-12756.39 5805.42,-12713.2 5754.1,-12682.81 5735.42,-12658.35 5735.42,-12598.7 5735.42,-12598.7 5735.42,-12598.7 5735.42,-12296.77 5735.42,-12213.31 5939.6,-12155.23 6113.05,-12120.94"/>
<polygon fill="black" stroke="black" points="6113.97,-12124.33 6123.11,-12118.97 6112.63,-12117.46 6113.97,-12124.33"/>
</g>
<!-- ResAttn_s0_l6_tp1 -->
<g id="node492" class="node">
<title>ResAttn_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4843.77,-12135.29 4286.45,-12135.29 4143.08,-12029.29 4700.4,-12029.29 4843.77,-12135.29"/>
<text text-anchor="middle" x="4493.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4493.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4493.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp1 -->
<g id="edge812" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M6992.4,-12776.27C6861.13,-12766.59 6706.96,-12756.17 6567.42,-12749.2 6026.97,-12722.2 5888.71,-12768.57 5350.42,-12713.2 5205.39,-12698.28 4704.42,-12744.49 4704.42,-12598.7 4704.42,-12598.7 4704.42,-12598.7 4704.42,-12296.77 4704.42,-12230.74 4652.72,-12177.77 4600.5,-12141.11"/>
<polygon fill="black" stroke="black" points="4602.35,-12138.14 4592.13,-12135.37 4598.4,-12143.91 4602.35,-12138.14"/>
</g>
<!-- ResAttn_s0_l6_tp2 -->
<g id="node493" class="node">
<title>ResAttn_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="5691.77,-12135.29 5134.45,-12135.29 4991.08,-12029.29 5548.4,-12029.29 5691.77,-12135.29"/>
<text text-anchor="middle" x="5341.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5341.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5341.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp2 -->
<g id="edge814" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M6994.16,-12777.38C6862.49,-12767.82 6707.55,-12757.19 6567.42,-12749.2 6201.89,-12728.35 6105.86,-12771.63 5744.42,-12713.2 5560.61,-12683.49 5341.42,-12784.9 5341.42,-12598.7 5341.42,-12598.7 5341.42,-12598.7 5341.42,-12296.77 5341.42,-12245.92 5341.42,-12188.27 5341.42,-12145.7"/>
<polygon fill="black" stroke="black" points="5344.92,-12145.49 5341.42,-12135.49 5337.92,-12145.49 5344.92,-12145.49"/>
</g>
<!-- ResAttn_s0_l6_tp3 -->
<g id="node494" class="node">
<title>ResAttn_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="8772.77,-12135.29 8215.45,-12135.29 8072.08,-12029.29 8629.4,-12029.29 8772.77,-12135.29"/>
<text text-anchor="middle" x="8422.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8422.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8422.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp3 -->
<g id="edge816" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7545.07,-12772.45C7624.88,-12763.75 7714.39,-12754.98 7796.42,-12749.2 7853.48,-12745.18 8776.21,-12742.36 8825.42,-12713.2 8876.34,-12683.03 8893.42,-12657.89 8893.42,-12598.7 8893.42,-12598.7 8893.42,-12598.7 8893.42,-12296.77 8893.42,-12220.3 8841.28,-12171.08 8771.7,-12139.45"/>
<polygon fill="black" stroke="black" points="8772.79,-12136.11 8762.22,-12135.3 8769.98,-12142.52 8772.79,-12136.11"/>
</g>
<!-- ResAttn_s0_l6_tp4 -->
<g id="node495" class="node">
<title>ResAttn_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="9637.77,-12135.29 9080.45,-12135.29 8937.08,-12029.29 9494.4,-12029.29 9637.77,-12135.29"/>
<text text-anchor="middle" x="9287.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9287.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9287.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp4 -->
<g id="edge818" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7545.07,-12772.39C7624.88,-12763.68 7714.39,-12754.92 7796.42,-12749.2 7962.53,-12737.61 9287.42,-12765.21 9287.42,-12598.7 9287.42,-12598.7 9287.42,-12598.7 9287.42,-12296.77 9287.42,-12245.92 9287.42,-12188.27 9287.42,-12145.7"/>
<polygon fill="black" stroke="black" points="9290.92,-12145.49 9287.42,-12135.49 9283.92,-12145.49 9290.92,-12145.49"/>
</g>
<!-- ResAttn_s0_l6_tp5 -->
<g id="node496" class="node">
<title>ResAttn_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="3702.77,-12135.29 3145.45,-12135.29 3002.08,-12029.29 3559.4,-12029.29 3702.77,-12135.29"/>
<text text-anchor="middle" x="3352.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3352.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3352.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp5 -->
<g id="edge820" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M6991.52,-12775.52C6860.46,-12765.75 6706.67,-12755.47 6567.42,-12749.2 5757.86,-12712.75 5551.73,-12783.73 4744.42,-12713.2 4579.75,-12698.81 4009.42,-12764 4009.42,-12598.7 4009.42,-12598.7 4009.42,-12598.7 4009.42,-12296.77 4009.42,-12223.64 3860.34,-12171.74 3704.21,-12137.44"/>
<polygon fill="black" stroke="black" points="3704.91,-12134.01 3694.39,-12135.31 3703.42,-12140.85 3704.91,-12134.01"/>
</g>
<!-- ResAttn_s0_l6_tp6 -->
<g id="node497" class="node">
<title>ResAttn_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="11728.77,-12135.29 11171.45,-12135.29 11028.08,-12029.29 11585.4,-12029.29 11728.77,-12135.29"/>
<text text-anchor="middle" x="11378.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11378.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11378.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp6 -->
<g id="edge822" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M7544.09,-12771.89C7624.13,-12763.11 7714.04,-12754.43 7796.42,-12749.2 7976.09,-12737.78 11033.42,-12778.73 11033.42,-12598.7 11033.42,-12598.7 11033.42,-12598.7 11033.42,-12296.77 11033.42,-12221.61 11093.37,-12172.02 11163.28,-12139.73"/>
<polygon fill="black" stroke="black" points="11165.06,-12142.77 11172.75,-12135.49 11162.2,-12136.39 11165.06,-12142.77"/>
</g>
<!-- ResAttn_s0_l6_tp7 -->
<g id="node498" class="node">
<title>ResAttn_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="10631.77,-12135.29 10074.45,-12135.29 9931.08,-12029.29 10488.4,-12029.29 10631.77,-12135.29"/>
<text text-anchor="middle" x="10281.42" y="-12093.59" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10281.42" y="-12078.59" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10281.42" y="-12063.59" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp7 -->
<g id="edge824" class="edge">
<title>ResMOE_s0_l5_tp0&#45;&gt;ResAttn_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M7544.74,-12772.16C7624.62,-12763.42 7714.27,-12754.71 7796.42,-12749.2 8363.38,-12711.19 8508.06,-12759.19 9074.42,-12713.2 9264.39,-12697.77 9924.42,-12789.29 9924.42,-12598.7 9924.42,-12598.7 9924.42,-12598.7 9924.42,-12296.77 9924.42,-12218.86 9987.83,-12168.7 10061.19,-12136.74"/>
<polygon fill="black" stroke="black" points="10062.81,-12139.86 10070.66,-12132.74 10060.08,-12133.41 10062.81,-12139.86"/>
</g>
<!-- SplitHeads_s0_l6_tp0 -->
<g id="node465" class="node">
<title>SplitHeads_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6525.42,-12624.2 6153.42,-12624.2 6153.42,-12571.2 6525.42,-12571.2 6525.42,-12624.2"/>
<text text-anchor="middle" x="6339.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6339.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6339.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp0&#45;&gt;SplitHeads_s0_l6_tp0 -->
<g id="edge769" class="edge">
<title>QKV_s0_l6_tp0&#45;&gt;SplitHeads_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6363.41,-12660.07C6360.22,-12651.91 6356.63,-12642.74 6353.23,-12634.02"/>
<polygon fill="black" stroke="black" points="6356.39,-12632.49 6349.49,-12624.45 6349.87,-12635.04 6356.39,-12632.49"/>
</g>
<!-- SplitHeads_s0_l6_tp1 -->
<g id="node466" class="node">
<title>SplitHeads_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="6915.42,-12624.2 6543.42,-12624.2 6543.42,-12571.2 6915.42,-12571.2 6915.42,-12624.2"/>
<text text-anchor="middle" x="6729.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6729.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6729.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp1&#45;&gt;SplitHeads_s0_l6_tp1 -->
<g id="edge770" class="edge">
<title>QKV_s0_l6_tp1&#45;&gt;SplitHeads_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M6741.41,-12660.07C6739.84,-12652 6738.07,-12642.93 6736.38,-12634.3"/>
<polygon fill="black" stroke="black" points="6739.81,-12633.59 6734.45,-12624.45 6732.94,-12634.94 6739.81,-12633.59"/>
</g>
<!-- SplitHeads_s0_l6_tp2 -->
<g id="node467" class="node">
<title>SplitHeads_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="7305.42,-12624.2 6933.42,-12624.2 6933.42,-12571.2 7305.42,-12571.2 7305.42,-12624.2"/>
<text text-anchor="middle" x="7119.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7119.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7119.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp2&#45;&gt;SplitHeads_s0_l6_tp2 -->
<g id="edge771" class="edge">
<title>QKV_s0_l6_tp2&#45;&gt;SplitHeads_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M7125.07,-12660.07C7124.33,-12652.09 7123.51,-12643.13 7122.72,-12634.58"/>
<polygon fill="black" stroke="black" points="7126.19,-12634.09 7121.79,-12624.45 7119.22,-12634.73 7126.19,-12634.09"/>
</g>
<!-- SplitHeads_s0_l6_tp3 -->
<g id="node468" class="node">
<title>SplitHeads_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7695.42,-12624.2 7323.42,-12624.2 7323.42,-12571.2 7695.42,-12571.2 7695.42,-12624.2"/>
<text text-anchor="middle" x="7509.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7509.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7509.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp3&#45;&gt;SplitHeads_s0_l6_tp3 -->
<g id="edge772" class="edge">
<title>QKV_s0_l6_tp3&#45;&gt;SplitHeads_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7497.43,-12660.07C7499.01,-12652 7500.78,-12642.93 7502.47,-12634.3"/>
<polygon fill="black" stroke="black" points="7505.91,-12634.94 7504.39,-12624.45 7499.04,-12633.59 7505.91,-12634.94"/>
</g>
<!-- SplitHeads_s0_l6_tp4 -->
<g id="node469" class="node">
<title>SplitHeads_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="8085.42,-12624.2 7713.42,-12624.2 7713.42,-12571.2 8085.42,-12571.2 8085.42,-12624.2"/>
<text text-anchor="middle" x="7899.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7899.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7899.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp4&#45;&gt;SplitHeads_s0_l6_tp4 -->
<g id="edge773" class="edge">
<title>QKV_s0_l6_tp4&#45;&gt;SplitHeads_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7881.08,-12660.07C7883.49,-12652 7886.2,-12642.93 7888.78,-12634.3"/>
<polygon fill="black" stroke="black" points="7892.22,-12635.03 7891.73,-12624.45 7885.51,-12633.03 7892.22,-12635.03"/>
</g>
<!-- SplitHeads_s0_l6_tp5 -->
<g id="node470" class="node">
<title>SplitHeads_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="8475.42,-12624.2 8103.42,-12624.2 8103.42,-12571.2 8475.42,-12571.2 8475.42,-12624.2"/>
<text text-anchor="middle" x="8289.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8289.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8289.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp5&#45;&gt;SplitHeads_s0_l6_tp5 -->
<g id="edge774" class="edge">
<title>QKV_s0_l6_tp5&#45;&gt;SplitHeads_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M8268.26,-12660.07C8271.07,-12651.91 8274.24,-12642.74 8277.24,-12634.02"/>
<polygon fill="black" stroke="black" points="8280.59,-12635.04 8280.54,-12624.45 8273.97,-12632.76 8280.59,-12635.04"/>
</g>
<!-- SplitHeads_s0_l6_tp6 -->
<g id="node471" class="node">
<title>SplitHeads_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="8865.42,-12624.2 8493.42,-12624.2 8493.42,-12571.2 8865.42,-12571.2 8865.42,-12624.2"/>
<text text-anchor="middle" x="8679.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8679.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8679.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp6&#45;&gt;SplitHeads_s0_l6_tp6 -->
<g id="edge775" class="edge">
<title>QKV_s0_l6_tp6&#45;&gt;SplitHeads_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M8656.85,-12660.07C8659.85,-12651.91 8663.22,-12642.74 8666.43,-12634.02"/>
<polygon fill="black" stroke="black" points="8669.78,-12635.04 8669.95,-12624.45 8663.21,-12632.63 8669.78,-12635.04"/>
</g>
<!-- SplitHeads_s0_l6_tp7 -->
<g id="node472" class="node">
<title>SplitHeads_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="6135.42,-12624.2 5763.42,-12624.2 5763.42,-12571.2 6135.42,-12571.2 6135.42,-12624.2"/>
<text text-anchor="middle" x="5949.42" y="-12609" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5949.42" y="-12594" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5949.42" y="-12579" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l6_tp7&#45;&gt;SplitHeads_s0_l6_tp7 -->
<g id="edge776" class="edge">
<title>QKV_s0_l6_tp7&#45;&gt;SplitHeads_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M5973.41,-12660.07C5970.22,-12651.91 5966.63,-12642.74 5963.23,-12634.02"/>
<polygon fill="black" stroke="black" points="5966.39,-12632.49 5959.49,-12624.45 5959.87,-12635.04 5966.39,-12632.49"/>
</g>
<!-- A2A_s0_l6 -->
<g id="node473" class="node">
<title>A2A_s0_l6</title>
<ellipse fill="none" stroke="black" cx="7314.42" cy="-12497.72" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7314.42" y="-12509.02" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="7314.42" y="-12494.02" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7314.42" y="-12479.02" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l6_tp0&#45;&gt;A2A_s0_l6 -->
<g id="edge777" class="edge">
<title>SplitHeads_s0_l6_tp0&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M6525.45,-12572.22C6528.46,-12571.87 6531.45,-12571.53 6534.42,-12571.2 6717.43,-12550.74 6925.05,-12531.65 7080.05,-12518.2"/>
<polygon fill="black" stroke="black" points="7080.53,-12521.67 7090.19,-12517.32 7079.92,-12514.7 7080.53,-12521.67"/>
</g>
<!-- SplitHeads_s0_l6_tp1&#45;&gt;A2A_s0_l6 -->
<g id="edge778" class="edge">
<title>SplitHeads_s0_l6_tp1&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M6881.98,-12571.15C6960.22,-12558.05 7055.93,-12542.02 7137.41,-12528.37"/>
<polygon fill="black" stroke="black" points="7137.99,-12531.82 7147.27,-12526.72 7136.83,-12524.92 7137.99,-12531.82"/>
</g>
<!-- SplitHeads_s0_l6_tp2&#45;&gt;A2A_s0_l6 -->
<g id="edge779" class="edge">
<title>SplitHeads_s0_l6_tp2&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M7170.4,-12571.09C7190.24,-12561.12 7213.43,-12549.47 7235.33,-12538.46"/>
<polygon fill="black" stroke="black" points="7236.94,-12541.57 7244.3,-12533.95 7233.8,-12535.32 7236.94,-12541.57"/>
</g>
<!-- SplitHeads_s0_l6_tp3&#45;&gt;A2A_s0_l6 -->
<g id="edge780" class="edge">
<title>SplitHeads_s0_l6_tp3&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M7458.44,-12571.09C7438.61,-12561.12 7415.42,-12549.47 7393.51,-12538.46"/>
<polygon fill="black" stroke="black" points="7395.05,-12535.32 7384.54,-12533.95 7391.91,-12541.57 7395.05,-12535.32"/>
</g>
<!-- SplitHeads_s0_l6_tp4&#45;&gt;A2A_s0_l6 -->
<g id="edge781" class="edge">
<title>SplitHeads_s0_l6_tp4&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M7746.87,-12571.15C7668.63,-12558.05 7572.91,-12542.02 7491.44,-12528.37"/>
<polygon fill="black" stroke="black" points="7492.02,-12524.92 7481.58,-12526.72 7490.86,-12531.82 7492.02,-12524.92"/>
</g>
<!-- SplitHeads_s0_l6_tp5&#45;&gt;A2A_s0_l6 -->
<g id="edge782" class="edge">
<title>SplitHeads_s0_l6_tp5&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M8103.4,-12572.22C8100.39,-12571.87 8097.39,-12571.53 8094.42,-12571.2 7911.42,-12550.74 7703.79,-12531.65 7548.79,-12518.2"/>
<polygon fill="black" stroke="black" points="7548.92,-12514.7 7538.66,-12517.32 7548.32,-12521.67 7548.92,-12514.7"/>
</g>
<!-- SplitHeads_s0_l6_tp6&#45;&gt;A2A_s0_l6 -->
<g id="edge783" class="edge">
<title>SplitHeads_s0_l6_tp6&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M8493.41,-12572.09C8490.39,-12571.78 8487.4,-12571.49 8484.42,-12571.2 8172.38,-12541.17 7812.25,-12521.04 7574.88,-12509.76"/>
<polygon fill="black" stroke="black" points="7574.88,-12506.26 7564.73,-12509.28 7574.55,-12513.25 7574.88,-12506.26"/>
</g>
<!-- SplitHeads_s0_l6_tp7&#45;&gt;A2A_s0_l6 -->
<g id="edge784" class="edge">
<title>SplitHeads_s0_l6_tp7&#45;&gt;A2A_s0_l6</title>
<path fill="none" stroke="black" d="M6135.43,-12572.09C6138.45,-12571.78 6141.45,-12571.49 6144.42,-12571.2 6456.47,-12541.17 6816.6,-12521.04 7053.96,-12509.76"/>
<polygon fill="black" stroke="black" points="7054.29,-12513.25 7064.12,-12509.28 7053.96,-12506.26 7054.29,-12513.25"/>
</g>
<!-- Attn_s0_l6_tp0 -->
<g id="node474" class="node">
<title>Attn_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6525.42,-12424.25 6153.42,-12424.25 6153.42,-12371.25 6525.42,-12371.25 6525.42,-12424.25"/>
<text text-anchor="middle" x="6339.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6339.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6339.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp0 -->
<g id="edge785" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M7090.19,-12478.12C6936.85,-12464.87 6728.7,-12445.82 6535.51,-12424.35"/>
<polygon fill="black" stroke="black" points="6535.77,-12420.86 6525.45,-12423.23 6535,-12427.82 6535.77,-12420.86"/>
</g>
<!-- Attn_s0_l6_tp1 -->
<g id="node475" class="node">
<title>Attn_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="6915.42,-12424.25 6543.42,-12424.25 6543.42,-12371.25 6915.42,-12371.25 6915.42,-12424.25"/>
<text text-anchor="middle" x="6729.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6729.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6729.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp1 -->
<g id="edge786" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M7147.18,-12468.71C7067.03,-12455.29 6971.42,-12439.28 6891.9,-12425.96"/>
<polygon fill="black" stroke="black" points="6892.23,-12422.46 6881.79,-12424.26 6891.07,-12429.37 6892.23,-12422.46"/>
</g>
<!-- Attn_s0_l6_tp2 -->
<g id="node476" class="node">
<title>Attn_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="7305.42,-12424.25 6933.42,-12424.25 6933.42,-12371.25 7305.42,-12371.25 7305.42,-12424.25"/>
<text text-anchor="middle" x="7119.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7119.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7119.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp2 -->
<g id="edge787" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M7244.3,-12461.49C7222.99,-12450.78 7199.79,-12439.13 7179.23,-12428.8"/>
<polygon fill="black" stroke="black" points="7180.8,-12425.67 7170.29,-12424.3 7177.65,-12431.92 7180.8,-12425.67"/>
</g>
<!-- Attn_s0_l6_tp3 -->
<g id="node477" class="node">
<title>Attn_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7695.42,-12424.25 7323.42,-12424.25 7323.42,-12371.25 7695.42,-12371.25 7695.42,-12424.25"/>
<text text-anchor="middle" x="7509.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7509.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7509.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp3 -->
<g id="edge788" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7384.55,-12461.49C7405.85,-12450.78 7429.06,-12439.13 7449.62,-12428.8"/>
<polygon fill="black" stroke="black" points="7451.19,-12431.92 7458.55,-12424.3 7448.05,-12425.67 7451.19,-12431.92"/>
</g>
<!-- Attn_s0_l6_tp4 -->
<g id="node478" class="node">
<title>Attn_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="8085.42,-12424.25 7713.42,-12424.25 7713.42,-12371.25 8085.42,-12371.25 8085.42,-12424.25"/>
<text text-anchor="middle" x="7899.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7899.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7899.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp4 -->
<g id="edge789" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7481.67,-12468.71C7561.81,-12455.29 7657.43,-12439.28 7736.95,-12425.96"/>
<polygon fill="black" stroke="black" points="7737.77,-12429.37 7747.06,-12424.26 7736.62,-12422.46 7737.77,-12429.37"/>
</g>
<!-- Attn_s0_l6_tp5 -->
<g id="node479" class="node">
<title>Attn_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="8475.42,-12424.25 8103.42,-12424.25 8103.42,-12371.25 8475.42,-12371.25 8475.42,-12424.25"/>
<text text-anchor="middle" x="8289.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8289.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8289.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp5 -->
<g id="edge790" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M7538.66,-12478.12C7692,-12464.87 7900.14,-12445.82 8093.34,-12424.35"/>
<polygon fill="black" stroke="black" points="8093.85,-12427.82 8103.4,-12423.23 8093.07,-12420.86 8093.85,-12427.82"/>
</g>
<!-- Attn_s0_l6_tp6 -->
<g id="node480" class="node">
<title>Attn_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="8865.42,-12424.25 8493.42,-12424.25 8493.42,-12371.25 8865.42,-12371.25 8865.42,-12424.25"/>
<text text-anchor="middle" x="8679.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8679.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8679.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp6 -->
<g id="edge791" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M7564.73,-12486.16C7799.46,-12475.1 8160.4,-12455.13 8483.39,-12424.32"/>
<polygon fill="black" stroke="black" points="8483.79,-12427.8 8493.41,-12423.36 8483.12,-12420.83 8483.79,-12427.8"/>
</g>
<!-- Attn_s0_l6_tp7 -->
<g id="node481" class="node">
<title>Attn_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="6135.42,-12424.25 5763.42,-12424.25 5763.42,-12371.25 6135.42,-12371.25 6135.42,-12424.25"/>
<text text-anchor="middle" x="5949.42" y="-12409.05" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5949.42" y="-12394.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5949.42" y="-12379.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l6&#45;&gt;Attn_s0_l6_tp7 -->
<g id="edge792" class="edge">
<title>A2A_s0_l6&#45;&gt;Attn_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M7064.12,-12486.16C6829.38,-12475.1 6468.44,-12455.13 6145.46,-12424.32"/>
<polygon fill="black" stroke="black" points="6145.72,-12420.83 6135.43,-12423.36 6145.05,-12427.8 6145.72,-12420.83"/>
</g>
<!-- AR_attn_s0_l6 -->
<g id="node482" class="node">
<title>AR_attn_s0_l6</title>
<ellipse fill="none" stroke="black" cx="7272.42" cy="-12297.77" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7272.42" y="-12309.07" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="7272.42" y="-12294.07" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7272.42" y="-12279.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l6_tp0&#45;&gt;AR_attn_s0_l6 -->
<g id="edge793" class="edge">
<title>Attn_s0_l6_tp0&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M6525.45,-12372.28C6528.46,-12371.93 6531.45,-12371.59 6534.42,-12371.25 6704.62,-12351.77 6897.28,-12332.95 7043.07,-12319.38"/>
<polygon fill="black" stroke="black" points="7043.41,-12322.86 7053.04,-12318.45 7042.76,-12315.89 7043.41,-12322.86"/>
</g>
<!-- Attn_s0_l6_tp1&#45;&gt;AR_attn_s0_l6 -->
<g id="edge794" class="edge">
<title>Attn_s0_l6_tp1&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M6871.03,-12371.2C6941.85,-12358.42 7028.1,-12342.85 7102.47,-12329.43"/>
<polygon fill="black" stroke="black" points="7103.2,-12332.86 7112.41,-12327.64 7101.95,-12325.97 7103.2,-12332.86"/>
</g>
<!-- Attn_s0_l6_tp2&#45;&gt;AR_attn_s0_l6 -->
<g id="edge795" class="edge">
<title>Attn_s0_l6_tp2&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M7159.62,-12371C7174.47,-12361.49 7191.7,-12350.46 7208.16,-12339.92"/>
<polygon fill="black" stroke="black" points="7210.14,-12342.81 7216.68,-12334.47 7206.37,-12336.91 7210.14,-12342.81"/>
</g>
<!-- Attn_s0_l6_tp3&#45;&gt;AR_attn_s0_l6 -->
<g id="edge796" class="edge">
<title>Attn_s0_l6_tp3&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M7447.46,-12371.13C7422.56,-12360.84 7393.3,-12348.74 7365.91,-12337.42"/>
<polygon fill="black" stroke="black" points="7366.89,-12334.04 7356.31,-12333.45 7364.22,-12340.5 7366.89,-12334.04"/>
</g>
<!-- Attn_s0_l6_tp4&#45;&gt;AR_attn_s0_l6 -->
<g id="edge797" class="edge">
<title>Attn_s0_l6_tp4&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M7735.91,-12371.2C7650.14,-12357.79 7544.77,-12341.33 7456.18,-12327.48"/>
<polygon fill="black" stroke="black" points="7456.71,-12324.03 7446.29,-12325.94 7455.63,-12330.94 7456.71,-12324.03"/>
</g>
<!-- Attn_s0_l6_tp5&#45;&gt;AR_attn_s0_l6 -->
<g id="edge798" class="edge">
<title>Attn_s0_l6_tp5&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M8103.4,-12372.24C8100.39,-12371.9 8097.39,-12371.57 8094.42,-12371.25 7898.44,-12349.8 7675.62,-12330.47 7511.45,-12317.17"/>
<polygon fill="black" stroke="black" points="7511.47,-12313.66 7501.22,-12316.35 7510.91,-12320.64 7511.47,-12313.66"/>
</g>
<!-- Attn_s0_l6_tp6&#45;&gt;AR_attn_s0_l6 -->
<g id="edge799" class="edge">
<title>Attn_s0_l6_tp6&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M8493.41,-12372.13C8490.4,-12371.82 8487.4,-12371.53 8484.42,-12371.25 8157.79,-12340.16 7780.29,-12320.08 7534.53,-12309.12"/>
<polygon fill="black" stroke="black" points="7534.53,-12305.62 7524.39,-12308.67 7534.22,-12312.61 7534.53,-12305.62"/>
</g>
<!-- Attn_s0_l6_tp7&#45;&gt;AR_attn_s0_l6 -->
<g id="edge800" class="edge">
<title>Attn_s0_l6_tp7&#45;&gt;AR_attn_s0_l6</title>
<path fill="none" stroke="black" d="M6135.43,-12372.14C6138.45,-12371.84 6141.45,-12371.54 6144.42,-12371.25 6441.88,-12342.27 6784.64,-12322.12 7013.52,-12310.55"/>
<polygon fill="black" stroke="black" points="7013.84,-12314.04 7023.66,-12310.04 7013.49,-12307.05 7013.84,-12314.04"/>
</g>
<!-- O_s0_l6_tp0 -->
<g id="node483" class="node">
<title>O_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="7055.42,-12224.29 6717.42,-12224.29 6717.42,-12171.29 7055.42,-12171.29 7055.42,-12224.29"/>
<text text-anchor="middle" x="6886.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6886.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6886.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp0 -->
<g id="edge801" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M7146.57,-12264.82C7098.3,-12252.57 7043.63,-12238.7 6996.91,-12226.84"/>
<polygon fill="black" stroke="black" points="6997.62,-12223.41 6987.06,-12224.34 6995.9,-12230.19 6997.62,-12223.41"/>
</g>
<!-- O_s0_l6_tp1 -->
<g id="node484" class="node">
<title>O_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="5707.42,-12224.29 5369.42,-12224.29 5369.42,-12171.29 5707.42,-12171.29 5707.42,-12224.29"/>
<text text-anchor="middle" x="5538.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5538.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5538.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp1 -->
<g id="edge802" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M7029.95,-12283.07C6677.29,-12263.14 6030.88,-12226.62 5717.79,-12208.93"/>
<polygon fill="black" stroke="black" points="5717.89,-12205.43 5707.71,-12208.36 5717.5,-12212.42 5717.89,-12205.43"/>
</g>
<!-- O_s0_l6_tp2 -->
<g id="node485" class="node">
<title>O_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="6516.42,-12224.29 6178.42,-12224.29 6178.42,-12171.29 6516.42,-12171.29 6516.42,-12224.29"/>
<text text-anchor="middle" x="6347.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6347.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6347.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp2 -->
<g id="edge803" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M7064.55,-12274.75C6902.82,-12257.62 6680.76,-12234.1 6526.77,-12217.79"/>
<polygon fill="black" stroke="black" points="6527.04,-12214.3 6516.73,-12216.73 6526.3,-12221.26 6527.04,-12214.3"/>
</g>
<!-- O_s0_l6_tp3 -->
<g id="node486" class="node">
<title>O_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7594.42,-12224.29 7256.42,-12224.29 7256.42,-12171.29 7594.42,-12171.29 7594.42,-12224.29"/>
<text text-anchor="middle" x="7425.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7425.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7425.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp3 -->
<g id="edge804" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7328.09,-12261.12C7344.1,-12250.87 7361.42,-12239.78 7376.95,-12229.83"/>
<polygon fill="black" stroke="black" points="7378.84,-12232.78 7385.38,-12224.44 7375.07,-12226.88 7378.84,-12232.78"/>
</g>
<!-- O_s0_l6_tp4 -->
<g id="node487" class="node">
<title>O_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="8560.42,-12224.29 8222.42,-12224.29 8222.42,-12171.29 8560.42,-12171.29 8560.42,-12224.29"/>
<text text-anchor="middle" x="8391.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8391.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8391.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp4 -->
<g id="edge805" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7493.5,-12277.41C7704.01,-12258.98 8016.9,-12231.59 8212.28,-12214.48"/>
<polygon fill="black" stroke="black" points="8212.7,-12217.95 8222.36,-12213.6 8212.09,-12210.98 8212.7,-12217.95"/>
</g>
<!-- O_s0_l6_tp5 -->
<g id="node488" class="node">
<title>O_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="5232.42,-12224.29 4894.42,-12224.29 4894.42,-12171.29 5232.42,-12171.29 5232.42,-12224.29"/>
<text text-anchor="middle" x="5063.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5063.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5063.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp5 -->
<g id="edge806" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M7013.61,-12290.88C6645.89,-12281.62 5951.2,-12260.83 5360.42,-12224.29 5322.37,-12221.94 5281.63,-12218.83 5242.89,-12215.59"/>
<polygon fill="black" stroke="black" points="5242.81,-12212.07 5232.55,-12214.72 5242.22,-12219.05 5242.81,-12212.07"/>
</g>
<!-- O_s0_l6_tp6 -->
<g id="node489" class="node">
<title>O_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="9815.42,-12224.29 9477.42,-12224.29 9477.42,-12171.29 9815.42,-12171.29 9815.42,-12224.29"/>
<text text-anchor="middle" x="9646.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9646.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9646.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp6 -->
<g id="edge807" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M7529.73,-12289.98C7910,-12279.37 8644.45,-12256.66 9268.42,-12224.29 9333.27,-12220.93 9404.31,-12216.37 9467.13,-12212.03"/>
<polygon fill="black" stroke="black" points="9467.4,-12215.52 9477.14,-12211.34 9466.92,-12208.54 9467.4,-12215.52"/>
</g>
<!-- O_s0_l6_tp7 -->
<g id="node490" class="node">
<title>O_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="9259.42,-12224.29 8921.42,-12224.29 8921.42,-12171.29 9259.42,-12171.29 9259.42,-12224.29"/>
<text text-anchor="middle" x="9090.42" y="-12209.09" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9090.42" y="-12194.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9090.42" y="-12179.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l6&#45;&gt;O_s0_l6_tp7 -->
<g id="edge808" class="edge">
<title>AR_attn_s0_l6&#45;&gt;O_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M7516.19,-12283.63C7886.83,-12263.66 8583.57,-12226.11 8911.35,-12208.44"/>
<polygon fill="black" stroke="black" points="8911.62,-12211.93 8921.42,-12207.9 8911.24,-12204.94 8911.62,-12211.93"/>
</g>
<!-- O_s0_l6_tp0&#45;&gt;ResAttn_s0_l6_tp0 -->
<g id="edge809" class="edge">
<title>O_s0_l6_tp0&#45;&gt;ResAttn_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6766.25,-12171.25C6718.96,-12161.2 6662.75,-12149.25 6607.24,-12137.45"/>
<polygon fill="black" stroke="black" points="6607.76,-12133.99 6597.25,-12135.33 6606.3,-12140.83 6607.76,-12133.99"/>
</g>
<!-- O_s0_l6_tp1&#45;&gt;ResAttn_s0_l6_tp1 -->
<g id="edge811" class="edge">
<title>O_s0_l6_tp1&#45;&gt;ResAttn_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M5369.36,-12178.43C5224.58,-12162.71 5011.64,-12139.58 4831.97,-12120.06"/>
<polygon fill="black" stroke="black" points="4832.14,-12116.56 4821.82,-12118.96 4831.38,-12123.52 4832.14,-12116.56"/>
</g>
<!-- O_s0_l6_tp2&#45;&gt;ResAttn_s0_l6_tp2 -->
<g id="edge813" class="edge">
<title>O_s0_l6_tp2&#45;&gt;ResAttn_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M6178.19,-12177.7C6042.96,-12162.44 5849.07,-12140.57 5681.98,-12121.72"/>
<polygon fill="black" stroke="black" points="5682.35,-12118.24 5672.02,-12120.59 5681.57,-12125.19 5682.35,-12118.24"/>
</g>
<!-- O_s0_l6_tp3&#45;&gt;ResAttn_s0_l6_tp3 -->
<g id="edge815" class="edge">
<title>O_s0_l6_tp3&#45;&gt;ResAttn_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7594.55,-12177.54C7752.81,-12159.52 7991.24,-12132.38 8171.64,-12111.84"/>
<polygon fill="black" stroke="black" points="8172.26,-12115.29 8181.8,-12110.69 8171.47,-12108.34 8172.26,-12115.29"/>
</g>
<!-- O_s0_l6_tp4&#45;&gt;ResAttn_s0_l6_tp4 -->
<g id="edge817" class="edge">
<title>O_s0_l6_tp4&#45;&gt;ResAttn_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M8560.48,-12175.38C8695.95,-12158.22 8887.95,-12133.9 9040.61,-12114.56"/>
<polygon fill="black" stroke="black" points="9041.13,-12118.02 9050.61,-12113.29 9040.25,-12111.08 9041.13,-12118.02"/>
</g>
<!-- O_s0_l6_tp5&#45;&gt;ResAttn_s0_l6_tp5 -->
<g id="edge819" class="edge">
<title>O_s0_l6_tp5&#45;&gt;ResAttn_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M4894.32,-12185.61C4708.14,-12173.3 4399.93,-12152.91 4134.42,-12135.29 3981.79,-12125.17 3812.39,-12113.9 3670.4,-12104.46"/>
<polygon fill="black" stroke="black" points="3670.43,-12100.95 3660.22,-12103.78 3669.97,-12107.94 3670.43,-12100.95"/>
</g>
<!-- O_s0_l6_tp6&#45;&gt;ResAttn_s0_l6_tp6 -->
<g id="edge821" class="edge">
<title>O_s0_l6_tp6&#45;&gt;ResAttn_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M9815.73,-12186.76C10013.58,-12174.93 10350.8,-12154.46 10640.42,-12135.29 10798.12,-12124.86 10974.72,-12112.44 11115.62,-12102.36"/>
<polygon fill="black" stroke="black" points="11115.98,-12105.84 11125.7,-12101.64 11115.48,-12098.86 11115.98,-12105.84"/>
</g>
<!-- O_s0_l6_tp7&#45;&gt;ResAttn_s0_l6_tp7 -->
<g id="edge823" class="edge">
<title>O_s0_l6_tp7&#45;&gt;ResAttn_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M9259.48,-12180.68C9459.29,-12161.64 9793.83,-12129.76 10025.45,-12107.69"/>
<polygon fill="black" stroke="black" points="10026.09,-12111.14 10035.71,-12106.71 10025.42,-12104.17 10026.09,-12111.14"/>
</g>
<!-- Gate_s0_l6_tp0 -->
<g id="node499" class="node">
<title>Gate_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6676.42,-11993.29 6338.42,-11993.29 6338.42,-11940.29 6676.42,-11940.29 6676.42,-11993.29"/>
<text text-anchor="middle" x="6507.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6507.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6507.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp0&#45;&gt;Gate_s0_l6_tp0 -->
<g id="edge825" class="edge">
<title>ResAttn_s0_l6_tp0&#45;&gt;Gate_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6423.57,-12029.19C6437.54,-12018.96 6451.79,-12008.53 6464.48,-11999.24"/>
<polygon fill="black" stroke="black" points="6466.58,-12002.04 6472.58,-11993.31 6462.44,-11996.39 6466.58,-12002.04"/>
</g>
<!-- ResMOE_s0_l6_tp0 -->
<g id="node540" class="node">
<title>ResMOE_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="7450.77,-11704.34 6893.45,-11704.34 6750.08,-11598.34 7307.4,-11598.34 7450.77,-11704.34"/>
<text text-anchor="middle" x="7100.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7100.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7100.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp0&#45;&gt;ResMOE_s0_l6_tp0 -->
<g id="edge898" class="edge">
<title>ResAttn_s0_l6_tp0&#45;&gt;ResMOE_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M6031.84,-12051.4C5926.37,-12042.72 5808.47,-12034.25 5700.42,-12029.29 5043.95,-11999.15 3398.71,-12042.86 2743.42,-11993.29 2458.38,-11971.73 2294.05,-12119.96 2106.42,-11904.29 2090.96,-11886.52 2090.06,-11868.23 2106.42,-11851.29 2270.76,-11681.18 6125.22,-11716.72 6361.42,-11704.34 6520.25,-11696.01 6698.06,-11683.6 6839.46,-11672.99"/>
<polygon fill="black" stroke="black" points="6839.87,-11676.46 6849.58,-11672.22 6839.35,-11669.48 6839.87,-11676.46"/>
</g>
<!-- Gate_s0_l6_tp1 -->
<g id="node500" class="node">
<title>Gate_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4394.42,-11993.29 4056.42,-11993.29 4056.42,-11940.29 4394.42,-11940.29 4394.42,-11993.29"/>
<text text-anchor="middle" x="4225.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4225.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4225.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp1&#45;&gt;Gate_s0_l6_tp1 -->
<g id="edge826" class="edge">
<title>ResAttn_s0_l6_tp1&#45;&gt;Gate_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M4370.4,-12029.19C4344.52,-12018.23 4318.09,-12007.04 4295.01,-11997.26"/>
<polygon fill="black" stroke="black" points="4296.24,-11993.98 4285.67,-11993.31 4293.51,-12000.43 4296.24,-11993.98"/>
</g>
<!-- ResMOE_s0_l6_tp1 -->
<g id="node541" class="node">
<title>ResMOE_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4876.77,-11704.34 4319.45,-11704.34 4176.08,-11598.34 4733.4,-11598.34 4876.77,-11704.34"/>
<text text-anchor="middle" x="4526.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4526.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4526.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp1&#45;&gt;ResMOE_s0_l6_tp1 -->
<g id="edge900" class="edge">
<title>ResAttn_s0_l6_tp1&#45;&gt;ResMOE_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M4180.62,-12057.27C4037.65,-12047.11 3866.05,-12036.09 3711.42,-12029.29 3664.9,-12027.25 2067.99,-12026.57 2035.42,-11993.29 1996.1,-11953.12 1996.38,-11780.78 2035.42,-11740.34 2054.44,-11720.64 3602.01,-11677.04 4248.01,-11659.68"/>
<polygon fill="black" stroke="black" points="4248.49,-11663.17 4258.4,-11659.4 4248.31,-11656.17 4248.49,-11663.17"/>
</g>
<!-- Gate_s0_l6_tp2 -->
<g id="node501" class="node">
<title>Gate_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="5510.42,-11993.29 5172.42,-11993.29 5172.42,-11940.29 5510.42,-11940.29 5510.42,-11993.29"/>
<text text-anchor="middle" x="5341.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5341.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5341.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp2&#45;&gt;Gate_s0_l6_tp2 -->
<g id="edge827" class="edge">
<title>ResAttn_s0_l6_tp2&#45;&gt;Gate_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M5341.42,-12029.19C5341.42,-12020.52 5341.42,-12011.71 5341.42,-12003.56"/>
<polygon fill="black" stroke="black" points="5344.92,-12003.31 5341.42,-11993.31 5337.92,-12003.31 5344.92,-12003.31"/>
</g>
<!-- ResMOE_s0_l6_tp2 -->
<g id="node542" class="node">
<title>ResMOE_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="6352.77,-11704.34 5795.45,-11704.34 5652.08,-11598.34 6209.4,-11598.34 6352.77,-11704.34"/>
<text text-anchor="middle" x="6002.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6002.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6002.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp2&#45;&gt;ResMOE_s0_l6_tp2 -->
<g id="edge902" class="edge">
<title>ResAttn_s0_l6_tp2&#45;&gt;ResMOE_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M5007.7,-12041.62C4955.78,-12036.66 4902.7,-12032.29 4852.42,-12029.29 4813.89,-12027 2100.54,-12020.76 2073.42,-11993.29 2033.93,-11953.29 2033.93,-11780.34 2073.42,-11740.34 2100.86,-11712.54 4846.38,-11705.5 4885.42,-11704.34 5175.82,-11695.72 5508.4,-11679.41 5734.62,-11667.35"/>
<polygon fill="black" stroke="black" points="5734.84,-11670.84 5744.64,-11666.81 5734.47,-11663.85 5734.84,-11670.84"/>
</g>
<!-- Gate_s0_l6_tp3 -->
<g id="node502" class="node">
<title>Gate_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="8306.42,-11993.29 7968.42,-11993.29 7968.42,-11940.29 8306.42,-11940.29 8306.42,-11993.29"/>
<text text-anchor="middle" x="8137.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8137.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8137.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp3&#45;&gt;Gate_s0_l6_tp3 -->
<g id="edge828" class="edge">
<title>ResAttn_s0_l6_tp3&#45;&gt;Gate_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M8291.6,-12029.19C8263.96,-12018.18 8235.72,-12006.94 8211.09,-11997.13"/>
<polygon fill="black" stroke="black" points="8212.07,-11993.75 8201.49,-11993.31 8209.48,-12000.26 8212.07,-11993.75"/>
</g>
<!-- ResMOE_s0_l6_tp3 -->
<g id="node543" class="node">
<title>ResMOE_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="8299.77,-11704.34 7742.45,-11704.34 7599.08,-11598.34 8156.4,-11598.34 8299.77,-11704.34"/>
<text text-anchor="middle" x="7949.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7949.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7949.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp3&#45;&gt;ResMOE_s0_l6_tp3 -->
<g id="edge904" class="edge">
<title>ResAttn_s0_l6_tp3&#45;&gt;ResMOE_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M8660.81,-12052.32C8745.21,-12043.25 8840.92,-12034.31 8928.42,-12029.29 9588.05,-11991.48 11242.59,-12043.11 11901.42,-11993.29 12190.66,-11971.42 12739.04,-12060.79 12538.42,-11851.29 12501.26,-11812.49 9271.82,-11697.93 8253.44,-11662.74"/>
<polygon fill="black" stroke="black" points="8253.53,-11659.24 8243.41,-11662.39 8253.29,-11666.24 8253.53,-11659.24"/>
</g>
<!-- Gate_s0_l6_tp4 -->
<g id="node503" class="node">
<title>Gate_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="9456.42,-11993.29 9118.42,-11993.29 9118.42,-11940.29 9456.42,-11940.29 9456.42,-11993.29"/>
<text text-anchor="middle" x="9287.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9287.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9287.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp4&#45;&gt;Gate_s0_l6_tp4 -->
<g id="edge829" class="edge">
<title>ResAttn_s0_l6_tp4&#45;&gt;Gate_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M9287.42,-12029.19C9287.42,-12020.52 9287.42,-12011.71 9287.42,-12003.56"/>
<polygon fill="black" stroke="black" points="9290.92,-12003.31 9287.42,-11993.31 9283.92,-12003.31 9290.92,-12003.31"/>
</g>
<!-- ResMOE_s0_l6_tp4 -->
<g id="node544" class="node">
<title>ResMOE_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="10336.77,-11704.34 9779.45,-11704.34 9636.08,-11598.34 10193.4,-11598.34 10336.77,-11704.34"/>
<text text-anchor="middle" x="9986.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9986.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9986.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp4&#45;&gt;ResMOE_s0_l6_tp4 -->
<g id="edge906" class="edge">
<title>ResAttn_s0_l6_tp4&#45;&gt;ResMOE_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M9532.56,-12057.41C9650.33,-12046.91 9793.57,-12035.56 9922.42,-12029.29 10181.15,-12016.72 11997.09,-12030.61 12253.42,-11993.29 12398.23,-11972.21 12482.03,-12020.92 12570.42,-11904.29 12752.3,-11664.33 11525.64,-11763.38 11225.42,-11740.34 10912.75,-11716.34 10555.5,-11691.21 10305.21,-11673.98"/>
<polygon fill="black" stroke="black" points="10305.08,-11670.46 10294.86,-11673.27 10304.6,-11677.44 10305.08,-11670.46"/>
</g>
<!-- Gate_s0_l6_tp5 -->
<g id="node504" class="node">
<title>Gate_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="3090.42,-11993.29 2752.42,-11993.29 2752.42,-11940.29 3090.42,-11940.29 3090.42,-11993.29"/>
<text text-anchor="middle" x="2921.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2921.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2921.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp5&#45;&gt;Gate_s0_l6_tp5 -->
<g id="edge830" class="edge">
<title>ResAttn_s0_l6_tp5&#45;&gt;Gate_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M3154.9,-12029.28C3111.39,-12017.82 3066.9,-12006.1 3028.58,-11996.01"/>
<polygon fill="black" stroke="black" points="3029.02,-11992.51 3018.46,-11993.35 3027.24,-11999.28 3029.02,-11992.51"/>
</g>
<!-- ResMOE_s0_l6_tp5 -->
<g id="node545" class="node">
<title>ResMOE_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="2643.77,-11704.34 2086.45,-11704.34 1943.08,-11598.34 2500.4,-11598.34 2643.77,-11704.34"/>
<text text-anchor="middle" x="2293.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2293.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2293.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp5&#45;&gt;ResMOE_s0_l6_tp5 -->
<g id="edge908" class="edge">
<title>ResAttn_s0_l6_tp5&#45;&gt;ResMOE_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M3059.41,-12071.74C2675.47,-12057.83 2046.25,-12029.65 2009.42,-11993.29 1929.4,-11914.31 1937.32,-11829.81 2005.42,-11740.34 2015.9,-11726.58 2040.19,-11714.05 2070.46,-11703.04"/>
<polygon fill="black" stroke="black" points="2071.77,-11706.3 2080.04,-11699.68 2069.45,-11699.69 2071.77,-11706.3"/>
</g>
<!-- Gate_s0_l6_tp6 -->
<g id="node505" class="node">
<title>Gate_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="11892.42,-11993.29 11554.42,-11993.29 11554.42,-11940.29 11892.42,-11940.29 11892.42,-11993.29"/>
<text text-anchor="middle" x="11723.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11723.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11723.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp6&#45;&gt;Gate_s0_l6_tp6 -->
<g id="edge831" class="edge">
<title>ResAttn_s0_l6_tp6&#45;&gt;Gate_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M11536.53,-12029.28C11570.77,-12018.01 11605.76,-12006.5 11636.07,-11996.53"/>
<polygon fill="black" stroke="black" points="11637.34,-11999.8 11645.75,-11993.35 11635.15,-11993.15 11637.34,-11999.8"/>
</g>
<!-- ResMOE_s0_l6_tp6 -->
<g id="node546" class="node">
<title>ResMOE_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="12762.77,-11704.34 12205.45,-11704.34 12062.08,-11598.34 12619.4,-11598.34 12762.77,-11704.34"/>
<text text-anchor="middle" x="12412.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12412.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12412.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp6&#45;&gt;ResMOE_s0_l6_tp6 -->
<g id="edge910" class="edge">
<title>ResAttn_s0_l6_tp6&#45;&gt;ResMOE_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M11656.34,-12081.68C12009.45,-12079.21 12581.32,-12064.14 12647.42,-11993.29 12724.12,-11911.09 12711.48,-11832.73 12647.42,-11740.34 12639.53,-11728.96 12629.98,-11719.05 12619.3,-11710.42"/>
<polygon fill="black" stroke="black" points="12621.41,-11707.63 12611.33,-11704.36 12617.17,-11713.2 12621.41,-11707.63"/>
</g>
<!-- Gate_s0_l6_tp7 -->
<g id="node506" class="node">
<title>Gate_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="10588.42,-11993.29 10250.42,-11993.29 10250.42,-11940.29 10588.42,-11940.29 10588.42,-11993.29"/>
<text text-anchor="middle" x="10419.42" y="-11978.09" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10419.42" y="-11963.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10419.42" y="-11948.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp7&#45;&gt;Gate_s0_l6_tp7 -->
<g id="edge832" class="edge">
<title>ResAttn_s0_l6_tp7&#45;&gt;Gate_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M10344.77,-12029.19C10356.97,-12019.16 10369.41,-12008.93 10380.54,-11999.77"/>
<polygon fill="black" stroke="black" points="10382.9,-12002.36 10388.4,-11993.31 10378.45,-11996.96 10382.9,-12002.36"/>
</g>
<!-- ResMOE_s0_l6_tp7 -->
<g id="node547" class="node">
<title>ResMOE_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="11714.77,-11704.34 11157.45,-11704.34 11014.08,-11598.34 11571.4,-11598.34 11714.77,-11704.34"/>
<text text-anchor="middle" x="11364.42" y="-11662.64" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11364.42" y="-11647.64" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11364.42" y="-11632.64" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l6_tp7&#45;&gt;ResMOE_s0_l6_tp7 -->
<g id="edge912" class="edge">
<title>ResAttn_s0_l6_tp7&#45;&gt;ResMOE_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M10531.47,-12060.9C10674.31,-12049.95 10856.81,-12037.13 11019.42,-12029.29 11173.52,-12021.87 12257.43,-12029.38 12407.42,-11993.29 12496.52,-11971.86 12544.57,-11981.83 12593.42,-11904.29 12605.98,-11884.36 12608.69,-11869.23 12593.42,-11851.29 12535.53,-11783.27 12039.95,-11720.14 11696.07,-11683.95"/>
<polygon fill="black" stroke="black" points="11696.26,-11680.45 11685.95,-11682.88 11695.53,-11687.41 11696.26,-11680.45"/>
</g>
<!-- Expert0_s0_l6_tp0 -->
<g id="node507" class="node">
<title>Expert0_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6987.42,-11904.29 6679.42,-11904.29 6679.42,-11851.29 6987.42,-11851.29 6987.42,-11904.29"/>
<text text-anchor="middle" x="6833.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="6833.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6833.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp0&#45;&gt;Expert0_s0_l6_tp0 -->
<g id="edge833" class="edge">
<title>Gate_s0_l6_tp0&#45;&gt;Expert0_s0_l6_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6603.03,-11940.28C6642.26,-11929.81 6687.8,-11917.65 6727.99,-11906.93"/>
<polygon fill="black" stroke="black" points="6729.06,-11910.27 6737.82,-11904.31 6727.25,-11903.5 6729.06,-11910.27"/>
</g>
<!-- Expert1_s0_l6_tp0 -->
<g id="node508" class="node">
<title>Expert1_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="7313.42,-11904.29 7005.42,-11904.29 7005.42,-11851.29 7313.42,-11851.29 7313.42,-11904.29"/>
<text text-anchor="middle" x="7159.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="7159.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7159.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp0&#45;&gt;Expert1_s0_l6_tp0 -->
<g id="edge834" class="edge">
<title>Gate_s0_l6_tp0&#45;&gt;Expert1_s0_l6_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6676.47,-11945.8C6767.97,-11934.67 6883.22,-11920.16 6994.9,-11904.49"/>
<polygon fill="black" stroke="black" points="6995.59,-11907.93 7005.01,-11903.07 6994.62,-11901 6995.59,-11907.93"/>
</g>
<!-- Expert2_s0_l6_tp0 -->
<g id="node509" class="node">
<title>Expert2_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6335.42,-11904.29 6027.42,-11904.29 6027.42,-11851.29 6335.42,-11851.29 6335.42,-11904.29"/>
<text text-anchor="middle" x="6181.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="6181.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6181.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp0&#45;&gt;Expert2_s0_l6_tp0 -->
<g id="edge835" class="edge">
<title>Gate_s0_l6_tp0&#45;&gt;Expert2_s0_l6_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6411.81,-11940.28C6372.59,-11929.81 6327.04,-11917.65 6286.85,-11906.93"/>
<polygon fill="black" stroke="black" points="6287.59,-11903.5 6277.03,-11904.31 6285.79,-11910.27 6287.59,-11903.5"/>
</g>
<!-- Expert3_s0_l6_tp0 -->
<g id="node510" class="node">
<title>Expert3_s0_l6_tp0</title>
<polygon fill="none" stroke="black" points="6661.42,-11904.29 6353.42,-11904.29 6353.42,-11851.29 6661.42,-11851.29 6661.42,-11904.29"/>
<text text-anchor="middle" x="6507.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="6507.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6507.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp0&#45;&gt;Expert3_s0_l6_tp0 -->
<g id="edge836" class="edge">
<title>Gate_s0_l6_tp0&#45;&gt;Expert3_s0_l6_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6507.42,-11940.16C6507.42,-11932.18 6507.42,-11923.23 6507.42,-11914.68"/>
<polygon fill="black" stroke="black" points="6510.92,-11914.54 6507.42,-11904.54 6503.92,-11914.54 6510.92,-11914.54"/>
</g>
<!-- Expert4_s0_l6_tp1 -->
<g id="node511" class="node">
<title>Expert4_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4379.42,-11904.29 4071.42,-11904.29 4071.42,-11851.29 4379.42,-11851.29 4379.42,-11904.29"/>
<text text-anchor="middle" x="4225.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="4225.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4225.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp1&#45;&gt;Expert4_s0_l6_tp1 -->
<g id="edge837" class="edge">
<title>Gate_s0_l6_tp1&#45;&gt;Expert4_s0_l6_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4225.42,-11940.16C4225.42,-11932.18 4225.42,-11923.23 4225.42,-11914.68"/>
<polygon fill="black" stroke="black" points="4228.92,-11914.54 4225.42,-11904.54 4221.92,-11914.54 4228.92,-11914.54"/>
</g>
<!-- Expert5_s0_l6_tp1 -->
<g id="node512" class="node">
<title>Expert5_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4705.42,-11904.29 4397.42,-11904.29 4397.42,-11851.29 4705.42,-11851.29 4705.42,-11904.29"/>
<text text-anchor="middle" x="4551.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="4551.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4551.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp1&#45;&gt;Expert5_s0_l6_tp1 -->
<g id="edge838" class="edge">
<title>Gate_s0_l6_tp1&#45;&gt;Expert5_s0_l6_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4321.03,-11940.28C4360.26,-11929.81 4405.8,-11917.65 4445.99,-11906.93"/>
<polygon fill="black" stroke="black" points="4447.06,-11910.27 4455.82,-11904.31 4445.25,-11903.5 4447.06,-11910.27"/>
</g>
<!-- Expert6_s0_l6_tp1 -->
<g id="node513" class="node">
<title>Expert6_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="3727.42,-11904.29 3419.42,-11904.29 3419.42,-11851.29 3727.42,-11851.29 3727.42,-11904.29"/>
<text text-anchor="middle" x="3573.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="3573.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3573.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp1&#45;&gt;Expert6_s0_l6_tp1 -->
<g id="edge839" class="edge">
<title>Gate_s0_l6_tp1&#45;&gt;Expert6_s0_l6_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4056.37,-11945.8C3964.87,-11934.67 3849.63,-11920.16 3737.94,-11904.49"/>
<polygon fill="black" stroke="black" points="3738.23,-11901 3727.84,-11903.07 3737.25,-11907.93 3738.23,-11901"/>
</g>
<!-- Expert7_s0_l6_tp1 -->
<g id="node514" class="node">
<title>Expert7_s0_l6_tp1</title>
<polygon fill="none" stroke="black" points="4053.42,-11904.29 3745.42,-11904.29 3745.42,-11851.29 4053.42,-11851.29 4053.42,-11904.29"/>
<text text-anchor="middle" x="3899.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="3899.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3899.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp1&#45;&gt;Expert7_s0_l6_tp1 -->
<g id="edge840" class="edge">
<title>Gate_s0_l6_tp1&#45;&gt;Expert7_s0_l6_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4129.81,-11940.28C4090.59,-11929.81 4045.04,-11917.65 4004.85,-11906.93"/>
<polygon fill="black" stroke="black" points="4005.59,-11903.5 3995.03,-11904.31 4003.79,-11910.27 4005.59,-11903.5"/>
</g>
<!-- Expert8_s0_l6_tp2 -->
<g id="node515" class="node">
<title>Expert8_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="6009.42,-11904.29 5701.42,-11904.29 5701.42,-11851.29 6009.42,-11851.29 6009.42,-11904.29"/>
<text text-anchor="middle" x="5855.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="5855.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5855.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp2&#45;&gt;Expert8_s0_l6_tp2 -->
<g id="edge841" class="edge">
<title>Gate_s0_l6_tp2&#45;&gt;Expert8_s0_l6_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5492.17,-11940.28C5555.84,-11929.5 5630.08,-11916.93 5694.79,-11905.98"/>
<polygon fill="black" stroke="black" points="5695.41,-11909.43 5704.68,-11904.31 5694.24,-11902.53 5695.41,-11909.43"/>
</g>
<!-- Expert9_s0_l6_tp2 -->
<g id="node516" class="node">
<title>Expert9_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="5031.42,-11904.29 4723.42,-11904.29 4723.42,-11851.29 5031.42,-11851.29 5031.42,-11904.29"/>
<text text-anchor="middle" x="4877.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="4877.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4877.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp2&#45;&gt;Expert9_s0_l6_tp2 -->
<g id="edge842" class="edge">
<title>Gate_s0_l6_tp2&#45;&gt;Expert9_s0_l6_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5205.34,-11940.28C5148.21,-11929.57 5081.67,-11917.09 5023.51,-11906.18"/>
<polygon fill="black" stroke="black" points="5023.97,-11902.71 5013.5,-11904.31 5022.68,-11909.59 5023.97,-11902.71"/>
</g>
<!-- Expert10_s0_l6_tp2 -->
<g id="node517" class="node">
<title>Expert10_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="5357.42,-11904.29 5049.42,-11904.29 5049.42,-11851.29 5357.42,-11851.29 5357.42,-11904.29"/>
<text text-anchor="middle" x="5203.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="5203.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5203.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp2&#45;&gt;Expert10_s0_l6_tp2 -->
<g id="edge843" class="edge">
<title>Gate_s0_l6_tp2&#45;&gt;Expert10_s0_l6_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5300.76,-11940.16C5285.74,-11930.69 5268.54,-11919.85 5252.82,-11909.94"/>
<polygon fill="black" stroke="black" points="5254.59,-11906.92 5244.27,-11904.54 5250.86,-11912.84 5254.59,-11906.92"/>
</g>
<!-- Expert11_s0_l6_tp2 -->
<g id="node518" class="node">
<title>Expert11_s0_l6_tp2</title>
<polygon fill="none" stroke="black" points="5683.42,-11904.29 5375.42,-11904.29 5375.42,-11851.29 5683.42,-11851.29 5683.42,-11904.29"/>
<text text-anchor="middle" x="5529.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="5529.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5529.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp2&#45;&gt;Expert11_s0_l6_tp2 -->
<g id="edge844" class="edge">
<title>Gate_s0_l6_tp2&#45;&gt;Expert11_s0_l6_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5396.56,-11940.28C5417.98,-11930.36 5442.68,-11918.93 5464.92,-11908.64"/>
<polygon fill="black" stroke="black" points="5466.68,-11911.68 5474.29,-11904.31 5463.74,-11905.33 5466.68,-11911.68"/>
</g>
<!-- Expert12_s0_l6_tp3 -->
<g id="node519" class="node">
<title>Expert12_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7639.42,-11904.29 7331.42,-11904.29 7331.42,-11851.29 7639.42,-11851.29 7639.42,-11904.29"/>
<text text-anchor="middle" x="7485.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="7485.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7485.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp3&#45;&gt;Expert12_s0_l6_tp3 -->
<g id="edge845" class="edge">
<title>Gate_s0_l6_tp3&#45;&gt;Expert12_s0_l6_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7968.37,-11945.8C7876.87,-11934.67 7761.63,-11920.16 7649.94,-11904.49"/>
<polygon fill="black" stroke="black" points="7650.23,-11901 7639.84,-11903.07 7649.25,-11907.93 7650.23,-11901"/>
</g>
<!-- Expert13_s0_l6_tp3 -->
<g id="node520" class="node">
<title>Expert13_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="7965.42,-11904.29 7657.42,-11904.29 7657.42,-11851.29 7965.42,-11851.29 7965.42,-11904.29"/>
<text text-anchor="middle" x="7811.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="7811.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7811.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp3&#45;&gt;Expert13_s0_l6_tp3 -->
<g id="edge846" class="edge">
<title>Gate_s0_l6_tp3&#45;&gt;Expert13_s0_l6_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8041.81,-11940.28C8002.59,-11929.81 7957.04,-11917.65 7916.85,-11906.93"/>
<polygon fill="black" stroke="black" points="7917.59,-11903.5 7907.03,-11904.31 7915.79,-11910.27 7917.59,-11903.5"/>
</g>
<!-- Expert14_s0_l6_tp3 -->
<g id="node521" class="node">
<title>Expert14_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="8291.42,-11904.29 7983.42,-11904.29 7983.42,-11851.29 8291.42,-11851.29 8291.42,-11904.29"/>
<text text-anchor="middle" x="8137.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="8137.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8137.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp3&#45;&gt;Expert14_s0_l6_tp3 -->
<g id="edge847" class="edge">
<title>Gate_s0_l6_tp3&#45;&gt;Expert14_s0_l6_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8137.42,-11940.16C8137.42,-11932.18 8137.42,-11923.23 8137.42,-11914.68"/>
<polygon fill="black" stroke="black" points="8140.92,-11914.54 8137.42,-11904.54 8133.92,-11914.54 8140.92,-11914.54"/>
</g>
<!-- Expert15_s0_l6_tp3 -->
<g id="node522" class="node">
<title>Expert15_s0_l6_tp3</title>
<polygon fill="none" stroke="black" points="8617.42,-11904.29 8309.42,-11904.29 8309.42,-11851.29 8617.42,-11851.29 8617.42,-11904.29"/>
<text text-anchor="middle" x="8463.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="8463.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8463.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp3&#45;&gt;Expert15_s0_l6_tp3 -->
<g id="edge848" class="edge">
<title>Gate_s0_l6_tp3&#45;&gt;Expert15_s0_l6_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8233.03,-11940.28C8272.26,-11929.81 8317.8,-11917.65 8357.99,-11906.93"/>
<polygon fill="black" stroke="black" points="8359.06,-11910.27 8367.82,-11904.31 8357.25,-11903.5 8359.06,-11910.27"/>
</g>
<!-- Expert16_s0_l6_tp4 -->
<g id="node523" class="node">
<title>Expert16_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="8943.42,-11904.29 8635.42,-11904.29 8635.42,-11851.29 8943.42,-11851.29 8943.42,-11904.29"/>
<text text-anchor="middle" x="8789.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="8789.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8789.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp4&#45;&gt;Expert16_s0_l6_tp4 -->
<g id="edge849" class="edge">
<title>Gate_s0_l6_tp4&#45;&gt;Expert16_s0_l6_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9141.37,-11940.28C9079.8,-11929.52 9008.04,-11916.99 8945.44,-11906.05"/>
<polygon fill="black" stroke="black" points="8945.92,-11902.58 8935.47,-11904.31 8944.72,-11909.48 8945.92,-11902.58"/>
</g>
<!-- Expert17_s0_l6_tp4 -->
<g id="node524" class="node">
<title>Expert17_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="9269.42,-11904.29 8961.42,-11904.29 8961.42,-11851.29 9269.42,-11851.29 9269.42,-11904.29"/>
<text text-anchor="middle" x="9115.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="9115.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9115.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp4&#45;&gt;Expert17_s0_l6_tp4 -->
<g id="edge850" class="edge">
<title>Gate_s0_l6_tp4&#45;&gt;Expert17_s0_l6_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9236.75,-11940.16C9217.41,-11930.38 9195.19,-11919.14 9175.1,-11908.98"/>
<polygon fill="black" stroke="black" points="9176.54,-11905.78 9166.03,-11904.39 9173.38,-11912.03 9176.54,-11905.78"/>
</g>
<!-- Expert18_s0_l6_tp4 -->
<g id="node525" class="node">
<title>Expert18_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="9595.42,-11904.29 9287.42,-11904.29 9287.42,-11851.29 9595.42,-11851.29 9595.42,-11904.29"/>
<text text-anchor="middle" x="9441.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="9441.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9441.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp4&#45;&gt;Expert18_s0_l6_tp4 -->
<g id="edge851" class="edge">
<title>Gate_s0_l6_tp4&#45;&gt;Expert18_s0_l6_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9332.79,-11940.16C9349.79,-11930.56 9369.28,-11919.55 9387.02,-11909.53"/>
<polygon fill="black" stroke="black" points="9389.12,-11912.36 9396.11,-11904.39 9385.68,-11906.26 9389.12,-11912.36"/>
</g>
<!-- Expert19_s0_l6_tp4 -->
<g id="node526" class="node">
<title>Expert19_s0_l6_tp4</title>
<polygon fill="none" stroke="black" points="9921.42,-11904.29 9613.42,-11904.29 9613.42,-11851.29 9921.42,-11851.29 9921.42,-11904.29"/>
<text text-anchor="middle" x="9767.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="9767.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9767.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp4&#45;&gt;Expert19_s0_l6_tp4 -->
<g id="edge852" class="edge">
<title>Gate_s0_l6_tp4&#45;&gt;Expert19_s0_l6_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9428.2,-11940.28C9487.42,-11929.54 9556.42,-11917.04 9616.67,-11906.12"/>
<polygon fill="black" stroke="black" points="9617.44,-11909.53 9626.65,-11904.31 9616.19,-11902.65 9617.44,-11909.53"/>
</g>
<!-- Expert20_s0_l6_tp5 -->
<g id="node527" class="node">
<title>Expert20_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="2423.42,-11904.29 2115.42,-11904.29 2115.42,-11851.29 2423.42,-11851.29 2423.42,-11904.29"/>
<text text-anchor="middle" x="2269.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="2269.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2269.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp5&#45;&gt;Expert20_s0_l6_tp5 -->
<g id="edge853" class="edge">
<title>Gate_s0_l6_tp5&#45;&gt;Expert20_s0_l6_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2752.37,-11945.8C2660.87,-11934.67 2545.63,-11920.16 2433.94,-11904.49"/>
<polygon fill="black" stroke="black" points="2434.23,-11901 2423.84,-11903.07 2433.25,-11907.93 2434.23,-11901"/>
</g>
<!-- Expert21_s0_l6_tp5 -->
<g id="node528" class="node">
<title>Expert21_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="2749.42,-11904.29 2441.42,-11904.29 2441.42,-11851.29 2749.42,-11851.29 2749.42,-11904.29"/>
<text text-anchor="middle" x="2595.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="2595.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2595.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp5&#45;&gt;Expert21_s0_l6_tp5 -->
<g id="edge854" class="edge">
<title>Gate_s0_l6_tp5&#45;&gt;Expert21_s0_l6_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2825.81,-11940.28C2786.59,-11929.81 2741.04,-11917.65 2700.85,-11906.93"/>
<polygon fill="black" stroke="black" points="2701.59,-11903.5 2691.03,-11904.31 2699.79,-11910.27 2701.59,-11903.5"/>
</g>
<!-- Expert22_s0_l6_tp5 -->
<g id="node529" class="node">
<title>Expert22_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="3075.42,-11904.29 2767.42,-11904.29 2767.42,-11851.29 3075.42,-11851.29 3075.42,-11904.29"/>
<text text-anchor="middle" x="2921.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="2921.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2921.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp5&#45;&gt;Expert22_s0_l6_tp5 -->
<g id="edge855" class="edge">
<title>Gate_s0_l6_tp5&#45;&gt;Expert22_s0_l6_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2921.42,-11940.16C2921.42,-11932.18 2921.42,-11923.23 2921.42,-11914.68"/>
<polygon fill="black" stroke="black" points="2924.92,-11914.54 2921.42,-11904.54 2917.92,-11914.54 2924.92,-11914.54"/>
</g>
<!-- Expert23_s0_l6_tp5 -->
<g id="node530" class="node">
<title>Expert23_s0_l6_tp5</title>
<polygon fill="none" stroke="black" points="3401.42,-11904.29 3093.42,-11904.29 3093.42,-11851.29 3401.42,-11851.29 3401.42,-11904.29"/>
<text text-anchor="middle" x="3247.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="3247.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3247.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp5&#45;&gt;Expert23_s0_l6_tp5 -->
<g id="edge856" class="edge">
<title>Gate_s0_l6_tp5&#45;&gt;Expert23_s0_l6_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3017.03,-11940.28C3056.26,-11929.81 3101.8,-11917.65 3141.99,-11906.93"/>
<polygon fill="black" stroke="black" points="3143.06,-11910.27 3151.82,-11904.31 3141.25,-11903.5 3143.06,-11910.27"/>
</g>
<!-- Expert24_s0_l6_tp6 -->
<g id="node531" class="node">
<title>Expert24_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="11551.42,-11904.29 11243.42,-11904.29 11243.42,-11851.29 11551.42,-11851.29 11551.42,-11904.29"/>
<text text-anchor="middle" x="11397.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="11397.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11397.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp6&#45;&gt;Expert24_s0_l6_tp6 -->
<g id="edge857" class="edge">
<title>Gate_s0_l6_tp6&#45;&gt;Expert24_s0_l6_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11627.81,-11940.28C11588.59,-11929.81 11543.04,-11917.65 11502.85,-11906.93"/>
<polygon fill="black" stroke="black" points="11503.59,-11903.5 11493.03,-11904.31 11501.79,-11910.27 11503.59,-11903.5"/>
</g>
<!-- Expert25_s0_l6_tp6 -->
<g id="node532" class="node">
<title>Expert25_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="11877.42,-11904.29 11569.42,-11904.29 11569.42,-11851.29 11877.42,-11851.29 11877.42,-11904.29"/>
<text text-anchor="middle" x="11723.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="11723.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11723.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp6&#45;&gt;Expert25_s0_l6_tp6 -->
<g id="edge858" class="edge">
<title>Gate_s0_l6_tp6&#45;&gt;Expert25_s0_l6_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11723.42,-11940.16C11723.42,-11932.18 11723.42,-11923.23 11723.42,-11914.68"/>
<polygon fill="black" stroke="black" points="11726.92,-11914.54 11723.42,-11904.54 11719.92,-11914.54 11726.92,-11914.54"/>
</g>
<!-- Expert26_s0_l6_tp6 -->
<g id="node533" class="node">
<title>Expert26_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="12203.42,-11904.29 11895.42,-11904.29 11895.42,-11851.29 12203.42,-11851.29 12203.42,-11904.29"/>
<text text-anchor="middle" x="12049.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="12049.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12049.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp6&#45;&gt;Expert26_s0_l6_tp6 -->
<g id="edge859" class="edge">
<title>Gate_s0_l6_tp6&#45;&gt;Expert26_s0_l6_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11819.03,-11940.28C11858.26,-11929.81 11903.8,-11917.65 11943.99,-11906.93"/>
<polygon fill="black" stroke="black" points="11945.06,-11910.27 11953.82,-11904.31 11943.25,-11903.5 11945.06,-11910.27"/>
</g>
<!-- Expert27_s0_l6_tp6 -->
<g id="node534" class="node">
<title>Expert27_s0_l6_tp6</title>
<polygon fill="none" stroke="black" points="12529.42,-11904.29 12221.42,-11904.29 12221.42,-11851.29 12529.42,-11851.29 12529.42,-11904.29"/>
<text text-anchor="middle" x="12375.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="12375.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12375.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp6&#45;&gt;Expert27_s0_l6_tp6 -->
<g id="edge860" class="edge">
<title>Gate_s0_l6_tp6&#45;&gt;Expert27_s0_l6_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11892.47,-11945.8C11983.97,-11934.67 12099.22,-11920.16 12210.9,-11904.49"/>
<polygon fill="black" stroke="black" points="12211.59,-11907.93 12221.01,-11903.07 12210.62,-11901 12211.59,-11907.93"/>
</g>
<!-- Expert28_s0_l6_tp7 -->
<g id="node535" class="node">
<title>Expert28_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="10247.42,-11904.29 9939.42,-11904.29 9939.42,-11851.29 10247.42,-11851.29 10247.42,-11904.29"/>
<text text-anchor="middle" x="10093.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="10093.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10093.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp7&#45;&gt;Expert28_s0_l6_tp7 -->
<g id="edge861" class="edge">
<title>Gate_s0_l6_tp7&#45;&gt;Expert28_s0_l6_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10323.81,-11940.28C10284.59,-11929.81 10239.04,-11917.65 10198.85,-11906.93"/>
<polygon fill="black" stroke="black" points="10199.59,-11903.5 10189.03,-11904.31 10197.79,-11910.27 10199.59,-11903.5"/>
</g>
<!-- Expert29_s0_l6_tp7 -->
<g id="node536" class="node">
<title>Expert29_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="10573.42,-11904.29 10265.42,-11904.29 10265.42,-11851.29 10573.42,-11851.29 10573.42,-11904.29"/>
<text text-anchor="middle" x="10419.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="10419.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10419.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp7&#45;&gt;Expert29_s0_l6_tp7 -->
<g id="edge862" class="edge">
<title>Gate_s0_l6_tp7&#45;&gt;Expert29_s0_l6_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10419.42,-11940.16C10419.42,-11932.18 10419.42,-11923.23 10419.42,-11914.68"/>
<polygon fill="black" stroke="black" points="10422.92,-11914.54 10419.42,-11904.54 10415.92,-11914.54 10422.92,-11914.54"/>
</g>
<!-- Expert30_s0_l6_tp7 -->
<g id="node537" class="node">
<title>Expert30_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="10899.42,-11904.29 10591.42,-11904.29 10591.42,-11851.29 10899.42,-11851.29 10899.42,-11904.29"/>
<text text-anchor="middle" x="10745.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="10745.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10745.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp7&#45;&gt;Expert30_s0_l6_tp7 -->
<g id="edge863" class="edge">
<title>Gate_s0_l6_tp7&#45;&gt;Expert30_s0_l6_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10515.03,-11940.28C10554.26,-11929.81 10599.8,-11917.65 10639.99,-11906.93"/>
<polygon fill="black" stroke="black" points="10641.06,-11910.27 10649.82,-11904.31 10639.25,-11903.5 10641.06,-11910.27"/>
</g>
<!-- Expert31_s0_l6_tp7 -->
<g id="node538" class="node">
<title>Expert31_s0_l6_tp7</title>
<polygon fill="none" stroke="black" points="11225.42,-11904.29 10917.42,-11904.29 10917.42,-11851.29 11225.42,-11851.29 11225.42,-11904.29"/>
<text text-anchor="middle" x="11071.42" y="-11889.09" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="11071.42" y="-11874.09" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11071.42" y="-11859.09" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l6_tp7&#45;&gt;Expert31_s0_l6_tp7 -->
<g id="edge864" class="edge">
<title>Gate_s0_l6_tp7&#45;&gt;Expert31_s0_l6_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10588.47,-11945.8C10679.97,-11934.67 10795.22,-11920.16 10906.9,-11904.49"/>
<polygon fill="black" stroke="black" points="10907.59,-11907.93 10917.01,-11903.07 10906.62,-11901 10907.59,-11907.93"/>
</g>
<!-- AR_exp_s0_l6 -->
<g id="node539" class="node">
<title>AR_exp_s0_l6</title>
<ellipse fill="none" stroke="black" cx="7289.42" cy="-11777.82" rx="239" ry="37.45"/>
<text text-anchor="middle" x="7289.42" y="-11789.12" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="7289.42" y="-11774.12" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7289.42" y="-11759.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l6_tp0&#45;&gt;AR_exp_s0_l6 -->
<g id="edge865" class="edge">
<title>Expert0_s0_l6_tp0&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M6952.34,-11851.24C7010.08,-11838.84 7080.04,-11823.81 7141.22,-11810.66"/>
<polygon fill="black" stroke="black" points="7142.31,-11814 7151.35,-11808.48 7140.84,-11807.16 7142.31,-11814"/>
</g>
<!-- Expert1_s0_l6_tp0&#45;&gt;AR_exp_s0_l6 -->
<g id="edge866" class="edge">
<title>Expert1_s0_l6_tp0&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M7193.58,-11851.05C7205.79,-11841.85 7219.89,-11831.22 7233.46,-11821"/>
<polygon fill="black" stroke="black" points="7235.93,-11823.51 7241.81,-11814.7 7231.72,-11817.92 7235.93,-11823.51"/>
</g>
<!-- Expert2_s0_l6_tp0&#45;&gt;AR_exp_s0_l6 -->
<g id="edge867" class="edge">
<title>Expert2_s0_l6_tp0&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M6335.81,-11852.32C6338.71,-11851.97 6341.58,-11851.62 6344.42,-11851.29 6586.08,-11823.17 6863.82,-11803.35 7055.35,-11791.63"/>
<polygon fill="black" stroke="black" points="7055.78,-11795.11 7065.55,-11791.01 7055.36,-11788.13 7055.78,-11795.11"/>
</g>
<!-- Expert3_s0_l6_tp0&#45;&gt;AR_exp_s0_l6 -->
<g id="edge868" class="edge">
<title>Expert3_s0_l6_tp0&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M6661.83,-11852.48C6664.72,-11852.08 6667.58,-11851.68 6670.42,-11851.29 6808.32,-11832.44 6963.92,-11814.23 7084.62,-11800.79"/>
<polygon fill="black" stroke="black" points="7085.17,-11804.25 7094.72,-11799.66 7084.39,-11797.29 7085.17,-11804.25"/>
</g>
<!-- Expert4_s0_l6_tp1&#45;&gt;AR_exp_s0_l6 -->
<g id="edge869" class="edge">
<title>Expert4_s0_l6_tp1&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M4379.79,-11852.12C4382.69,-11851.83 4385.57,-11851.55 4388.42,-11851.29 4899.84,-11805.1 6436.22,-11786.52 7040.97,-11780.86"/>
<polygon fill="black" stroke="black" points="7041.16,-11784.36 7051.13,-11780.77 7041.09,-11777.36 7041.16,-11784.36"/>
</g>
<!-- Expert5_s0_l6_tp1&#45;&gt;AR_exp_s0_l6 -->
<g id="edge870" class="edge">
<title>Expert5_s0_l6_tp1&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M4705.79,-11852.13C4708.69,-11851.84 4711.57,-11851.56 4714.42,-11851.29 5160.79,-11810.26 6486.95,-11789.05 7041.41,-11781.78"/>
<polygon fill="black" stroke="black" points="7041.58,-11785.28 7051.54,-11781.64 7041.49,-11778.28 7041.58,-11785.28"/>
</g>
<!-- Expert6_s0_l6_tp1&#45;&gt;AR_exp_s0_l6 -->
<g id="edge871" class="edge">
<title>Expert6_s0_l6_tp1&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M3727.79,-11852.1C3730.69,-11851.81 3733.57,-11851.54 3736.42,-11851.29 4379.07,-11794.73 6342.83,-11782.21 7040.37,-11779.53"/>
<polygon fill="black" stroke="black" points="7040.55,-11783.03 7050.54,-11779.49 7040.53,-11776.03 7040.55,-11783.03"/>
</g>
<!-- Expert7_s0_l6_tp1&#45;&gt;AR_exp_s0_l6 -->
<g id="edge872" class="edge">
<title>Expert7_s0_l6_tp1&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M4053.79,-11852.11C4056.69,-11851.82 4059.57,-11851.55 4062.42,-11851.29 4639.2,-11799.93 6387.8,-11784.26 7040.34,-11780.13"/>
<polygon fill="black" stroke="black" points="7040.83,-11783.63 7050.81,-11780.07 7040.79,-11776.63 7040.83,-11783.63"/>
</g>
<!-- Expert8_s0_l6_tp2&#45;&gt;AR_exp_s0_l6 -->
<g id="edge873" class="edge">
<title>Expert8_s0_l6_tp2&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M6009.81,-11852.25C6012.7,-11851.91 6015.57,-11851.6 6018.42,-11851.29 6374.37,-11813.39 6788.66,-11794.44 7045,-11785.63"/>
<polygon fill="black" stroke="black" points="7045.31,-11789.12 7055.19,-11785.28 7045.08,-11782.12 7045.31,-11789.12"/>
</g>
<!-- Expert9_s0_l6_tp2&#45;&gt;AR_exp_s0_l6 -->
<g id="edge874" class="edge">
<title>Expert9_s0_l6_tp2&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M5031.8,-11852.15C5034.69,-11851.85 5037.57,-11851.56 5040.42,-11851.29 5422.24,-11815.41 6541.24,-11791.94 7042.1,-11782.94"/>
<polygon fill="black" stroke="black" points="7042.42,-11786.44 7052.35,-11782.76 7042.29,-11779.44 7042.42,-11786.44"/>
</g>
<!-- Expert10_s0_l6_tp2&#45;&gt;AR_exp_s0_l6 -->
<g id="edge875" class="edge">
<title>Expert10_s0_l6_tp2&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M5357.8,-11852.17C5360.69,-11851.86 5363.57,-11851.57 5366.42,-11851.29 5965.21,-11793.37 6673.03,-11781.08 7040.26,-11778.88"/>
<polygon fill="black" stroke="black" points="7040.51,-11782.37 7050.49,-11778.82 7040.47,-11775.37 7040.51,-11782.37"/>
</g>
<!-- Expert11_s0_l6_tp2&#45;&gt;AR_exp_s0_l6 -->
<g id="edge876" class="edge">
<title>Expert11_s0_l6_tp2&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M5683.8,-11852.2C5686.7,-11851.88 5689.57,-11851.58 5692.42,-11851.29 6168.1,-11803.44 6726.69,-11787.17 7041.24,-11781.65"/>
<polygon fill="black" stroke="black" points="7041.47,-11785.14 7051.4,-11781.47 7041.35,-11778.14 7041.47,-11785.14"/>
</g>
<!-- Expert12_s0_l6_tp3&#45;&gt;AR_exp_s0_l6 -->
<g id="edge877" class="edge">
<title>Expert12_s0_l6_tp3&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M7434.18,-11851.18C7414.04,-11841.11 7390.47,-11829.33 7368.26,-11818.22"/>
<polygon fill="black" stroke="black" points="7369.68,-11815.02 7359.17,-11813.68 7366.55,-11821.28 7369.68,-11815.02"/>
</g>
<!-- Expert13_s0_l6_tp3&#45;&gt;AR_exp_s0_l6 -->
<g id="edge878" class="edge">
<title>Expert13_s0_l6_tp3&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M7675.3,-11851.24C7606.2,-11838.27 7521.82,-11822.44 7449.61,-11808.88"/>
<polygon fill="black" stroke="black" points="7449.98,-11805.39 7439.51,-11806.99 7448.69,-11812.27 7449.98,-11805.39"/>
</g>
<!-- Expert14_s0_l6_tp3&#45;&gt;AR_exp_s0_l6 -->
<g id="edge879" class="edge">
<title>Expert14_s0_l6_tp3&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M7983.02,-11852.44C7980.13,-11852.05 7977.26,-11851.67 7974.42,-11851.29 7816.67,-11830.62 7637.87,-11811.86 7502.51,-11798.61"/>
<polygon fill="black" stroke="black" points="7502.72,-11795.11 7492.43,-11797.62 7502.04,-11802.08 7502.72,-11795.11"/>
</g>
<!-- Expert15_s0_l6_tp3&#45;&gt;AR_exp_s0_l6 -->
<g id="edge880" class="edge">
<title>Expert15_s0_l6_tp3&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M8309.03,-11852.3C8306.14,-11851.95 8303.27,-11851.62 8300.42,-11851.29 8036.15,-11821.2 7731.51,-11801.38 7526.29,-11790.19"/>
<polygon fill="black" stroke="black" points="7526.46,-11786.69 7516.29,-11789.64 7526.08,-11793.68 7526.46,-11786.69"/>
</g>
<!-- Expert16_s0_l6_tp4&#45;&gt;AR_exp_s0_l6 -->
<g id="edge881" class="edge">
<title>Expert16_s0_l6_tp4&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M8635.04,-11852.24C8632.15,-11851.91 8629.27,-11851.59 8626.42,-11851.29 8246.67,-11811.4 7803.79,-11792.86 7535.14,-11784.7"/>
<polygon fill="black" stroke="black" points="7534.97,-11781.19 7524.87,-11784.39 7534.76,-11788.19 7534.97,-11781.19"/>
</g>
<!-- Expert17_s0_l6_tp4&#45;&gt;AR_exp_s0_l6 -->
<g id="edge882" class="edge">
<title>Expert17_s0_l6_tp4&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M8961.04,-11852.19C8958.15,-11851.88 8955.27,-11851.58 8952.42,-11851.29 8452.03,-11801.41 7863.55,-11785.85 7537.92,-11781.01"/>
<polygon fill="black" stroke="black" points="7537.94,-11777.51 7527.89,-11780.86 7537.83,-11784.5 7537.94,-11777.51"/>
</g>
<!-- Expert18_s0_l6_tp4&#45;&gt;AR_exp_s0_l6 -->
<g id="edge883" class="edge">
<title>Expert18_s0_l6_tp4&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M9287.05,-11852.17C9284.15,-11851.86 9281.27,-11851.57 9278.42,-11851.29 8654.45,-11791.33 7916.02,-11779.96 7538.68,-11778.42"/>
<polygon fill="black" stroke="black" points="7538.47,-11774.92 7528.45,-11778.38 7538.44,-11781.92 7538.47,-11774.92"/>
</g>
<!-- Expert19_s0_l6_tp4&#45;&gt;AR_exp_s0_l6 -->
<g id="edge884" class="edge">
<title>Expert19_s0_l6_tp4&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M9613.05,-11852.15C9610.15,-11851.84 9607.27,-11851.56 9604.42,-11851.29 9209.56,-11814.37 8048.77,-11791.32 7536.82,-11782.68"/>
<polygon fill="black" stroke="black" points="7536.77,-11779.18 7526.71,-11782.51 7536.65,-11786.18 7536.77,-11779.18"/>
</g>
<!-- Expert20_s0_l6_tp5&#45;&gt;AR_exp_s0_l6 -->
<g id="edge885" class="edge">
<title>Expert20_s0_l6_tp5&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M2423.79,-11852.08C2426.69,-11851.8 2429.57,-11851.54 2432.42,-11851.29 2892.03,-11812.11 6113.69,-11786.96 7040.54,-11780.48"/>
<polygon fill="black" stroke="black" points="7040.69,-11783.98 7050.66,-11780.41 7040.64,-11776.98 7040.69,-11783.98"/>
</g>
<!-- Expert21_s0_l6_tp5&#45;&gt;AR_exp_s0_l6 -->
<g id="edge886" class="edge">
<title>Expert21_s0_l6_tp5&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M2749.79,-11852.08C2752.69,-11851.8 2755.57,-11851.54 2758.42,-11851.29 3600.13,-11779.08 6218.39,-11777.02 7040.1,-11778.23"/>
<polygon fill="black" stroke="black" points="7040.27,-11781.73 7050.28,-11778.25 7040.28,-11774.73 7040.27,-11781.73"/>
</g>
<!-- Expert22_s0_l6_tp5&#45;&gt;AR_exp_s0_l6 -->
<g id="edge887" class="edge">
<title>Expert22_s0_l6_tp5&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M3075.79,-11852.09C3078.69,-11851.81 3081.57,-11851.54 3084.42,-11851.29 3859.47,-11784.31 6257.74,-11778.62 7039.94,-11778.6"/>
<polygon fill="black" stroke="black" points="7040.2,-11782.1 7050.2,-11778.6 7040.2,-11775.1 7040.2,-11782.1"/>
</g>
<!-- Expert23_s0_l6_tp5&#45;&gt;AR_exp_s0_l6 -->
<g id="edge888" class="edge">
<title>Expert23_s0_l6_tp5&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M3401.79,-11852.1C3404.69,-11851.81 3407.57,-11851.54 3410.42,-11851.29 4119.13,-11789.53 6299.28,-11780.35 7040.08,-11779.02"/>
<polygon fill="black" stroke="black" points="7040.35,-11782.52 7050.34,-11779.01 7040.34,-11775.52 7040.35,-11782.52"/>
</g>
<!-- Expert24_s0_l6_tp6&#45;&gt;AR_exp_s0_l6 -->
<g id="edge889" class="edge">
<title>Expert24_s0_l6_tp6&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M11243.05,-11852.09C11240.16,-11851.81 11237.28,-11851.54 11234.42,-11851.29 10512.29,-11788.47 8288.02,-11779.99 7538.75,-11778.93"/>
<polygon fill="black" stroke="black" points="7538.65,-11775.43 7528.64,-11778.92 7538.64,-11782.43 7538.65,-11775.43"/>
</g>
<!-- Expert25_s0_l6_tp6&#45;&gt;AR_exp_s0_l6 -->
<g id="edge890" class="edge">
<title>Expert25_s0_l6_tp6&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M11569.05,-11852.09C11566.16,-11851.81 11563.28,-11851.54 11560.42,-11851.29 10771.85,-11783.25 8328.87,-11778.29 7538.72,-11778.52"/>
<polygon fill="black" stroke="black" points="7538.64,-11775.02 7528.64,-11778.52 7538.64,-11782.02 7538.64,-11775.02"/>
</g>
<!-- Expert26_s0_l6_tp6&#45;&gt;AR_exp_s0_l6 -->
<g id="edge891" class="edge">
<title>Expert26_s0_l6_tp6&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M11895.05,-11852.08C11892.16,-11851.8 11889.28,-11851.54 11886.42,-11851.29 11031.21,-11778.02 8368.35,-11776.71 7538.77,-11778.16"/>
<polygon fill="black" stroke="black" points="7538.49,-11774.66 7528.49,-11778.18 7538.5,-11781.66 7538.49,-11774.66"/>
</g>
<!-- Expert27_s0_l6_tp6&#45;&gt;AR_exp_s0_l6 -->
<g id="edge892" class="edge">
<title>Expert27_s0_l6_tp6&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M12221.06,-11852.08C12218.16,-11851.8 12215.28,-11851.54 12212.42,-11851.29 11745.97,-11811.57 8472.76,-11786.76 7538.09,-11780.43"/>
<polygon fill="black" stroke="black" points="7537.91,-11776.92 7527.88,-11780.36 7537.86,-11783.92 7537.91,-11776.92"/>
</g>
<!-- Expert28_s0_l6_tp7&#45;&gt;AR_exp_s0_l6 -->
<g id="edge893" class="edge">
<title>Expert28_s0_l6_tp7&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M9939.05,-11852.13C9936.15,-11851.83 9933.27,-11851.55 9930.42,-11851.29 9470.98,-11809.22 8102.75,-11788.52 7537.74,-11781.58"/>
<polygon fill="black" stroke="black" points="7537.47,-11778.07 7527.43,-11781.45 7537.38,-11785.07 7537.47,-11778.07"/>
</g>
<!-- Expert29_s0_l6_tp7&#45;&gt;AR_exp_s0_l6 -->
<g id="edge894" class="edge">
<title>Expert29_s0_l6_tp7&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M10265.05,-11852.12C10262.15,-11851.83 10259.28,-11851.55 10256.42,-11851.29 9731.85,-11804.06 8152.92,-11786.04 7538.18,-11780.7"/>
<polygon fill="black" stroke="black" points="7537.88,-11777.2 7527.85,-11780.61 7537.82,-11784.2 7537.88,-11777.2"/>
</g>
<!-- Expert30_s0_l6_tp7&#45;&gt;AR_exp_s0_l6 -->
<g id="edge895" class="edge">
<title>Expert30_s0_l6_tp7&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M10591.05,-11852.11C10588.15,-11851.82 10585.28,-11851.55 10582.42,-11851.29 9992.28,-11798.87 8200.01,-11783.83 7538.33,-11780"/>
<polygon fill="black" stroke="black" points="7538.21,-11776.5 7528.19,-11779.94 7538.17,-11783.5 7538.21,-11776.5"/>
</g>
<!-- Expert31_s0_l6_tp7&#45;&gt;AR_exp_s0_l6 -->
<g id="edge896" class="edge">
<title>Expert31_s0_l6_tp7&#45;&gt;AR_exp_s0_l6</title>
<path fill="none" stroke="black" d="M10917.05,-11852.1C10914.15,-11851.81 10911.28,-11851.54 10908.42,-11851.29 10252.39,-11793.67 8244.77,-11781.82 7538.43,-11779.42"/>
<polygon fill="black" stroke="black" points="7538.39,-11775.92 7528.38,-11779.38 7538.37,-11782.92 7538.39,-11775.92"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp0 -->
<g id="edge897" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp0</title>
<path fill="none" stroke="black" d="M7235.26,-11741.15C7220.49,-11731.42 7204.11,-11720.63 7187.99,-11710.01"/>
<polygon fill="black" stroke="black" points="7189.87,-11707.06 7179.59,-11704.48 7186.02,-11712.91 7189.87,-11707.06"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp1 -->
<g id="edge899" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp1</title>
<path fill="none" stroke="black" d="M7060.41,-11766.91C6742.44,-11753.13 6149.2,-11727.25 5643.42,-11704.34 5370.53,-11691.98 5060.16,-11677.5 4835.96,-11666.96"/>
<polygon fill="black" stroke="black" points="4835.84,-11663.45 4825.69,-11666.48 4835.51,-11670.44 4835.84,-11663.45"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp2 -->
<g id="edge901" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp2</title>
<path fill="none" stroke="black" d="M7088.68,-11757.4C6887.33,-11737.93 6573.71,-11707.59 6335.11,-11684.52"/>
<polygon fill="black" stroke="black" points="6335.17,-11681.01 6324.88,-11683.53 6334.49,-11687.97 6335.17,-11681.01"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp3 -->
<g id="edge903" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp3</title>
<path fill="none" stroke="black" d="M7439.19,-11748.57C7521.57,-11733.03 7625.57,-11713.42 7718.15,-11695.96"/>
<polygon fill="black" stroke="black" points="7719.04,-11699.35 7728.22,-11694.06 7717.75,-11692.47 7719.04,-11699.35"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp4 -->
<g id="edge905" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp4</title>
<path fill="none" stroke="black" d="M7517.04,-11766.31C8011.78,-11743.48 9183.28,-11689.41 9715.24,-11664.86"/>
<polygon fill="black" stroke="black" points="9715.53,-11668.35 9725.36,-11664.39 9715.21,-11661.35 9715.53,-11668.35"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp5 -->
<g id="edge907" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp5</title>
<path fill="none" stroke="black" d="M7053.45,-11771.7C6532.61,-11760.34 5245.29,-11731.81 4167.42,-11704.34 3612.65,-11690.2 2965.54,-11671.83 2595.21,-11661.13"/>
<polygon fill="black" stroke="black" points="2595.25,-11657.63 2585.15,-11660.84 2595.05,-11664.63 2595.25,-11657.63"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp6 -->
<g id="edge909" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp6</title>
<path fill="none" stroke="black" d="M7527.78,-11774.78C8325.16,-11767.67 10895.69,-11742.31 11723.42,-11704.34 11866.34,-11697.78 12025.64,-11686.05 12155.04,-11675.39"/>
<polygon fill="black" stroke="black" points="12155.41,-11678.87 12165.09,-11674.55 12154.84,-11671.89 12155.41,-11678.87"/>
</g>
<!-- AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp7 -->
<g id="edge911" class="edge">
<title>AR_exp_s0_l6&#45;&gt;ResMOE_s0_l6_tp7</title>
<path fill="none" stroke="black" d="M7526.75,-11773.39C8040.71,-11765.49 9295.03,-11743.59 10345.42,-11704.34 10600.68,-11694.8 10891.69,-11679.51 11097.19,-11667.97"/>
<polygon fill="black" stroke="black" points="11097.43,-11671.46 11107.21,-11667.41 11097.03,-11664.48 11097.43,-11671.46"/>
</g>
<!-- QKV_s0_l7_tp0 -->
<g id="node548" class="node">
<title>QKV_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6311.42,-11562.34 5973.42,-11562.34 5973.42,-11509.34 6311.42,-11509.34 6311.42,-11562.34"/>
<text text-anchor="middle" x="6142.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6142.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6142.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp0 -->
<g id="edge913" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6767.11,-11611.19C6638.18,-11596 6489.42,-11578.42 6354.42,-11562.34 6343.78,-11561.07 6332.84,-11559.77 6321.81,-11558.45"/>
<polygon fill="black" stroke="black" points="6322,-11554.94 6311.65,-11557.23 6321.17,-11561.89 6322,-11554.94"/>
</g>
<!-- QKV_s0_l7_tp1 -->
<g id="node549" class="node">
<title>QKV_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="6701.42,-11562.34 6363.42,-11562.34 6363.42,-11509.34 6701.42,-11509.34 6701.42,-11562.34"/>
<text text-anchor="middle" x="6532.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6532.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6532.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp1 -->
<g id="edge914" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6840.11,-11598.32C6781.55,-11586.62 6721.64,-11574.65 6670.43,-11564.42"/>
<polygon fill="black" stroke="black" points="6670.8,-11560.92 6660.31,-11562.39 6669.43,-11567.79 6670.8,-11560.92"/>
</g>
<!-- QKV_s0_l7_tp2 -->
<g id="node550" class="node">
<title>QKV_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="7082.42,-11562.34 6744.42,-11562.34 6744.42,-11509.34 7082.42,-11509.34 7082.42,-11562.34"/>
<text text-anchor="middle" x="6913.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6913.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6913.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp2 -->
<g id="edge915" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M7014.58,-11598.24C6997.41,-11587.82 6979.89,-11577.18 6964.35,-11567.75"/>
<polygon fill="black" stroke="black" points="6965.82,-11564.55 6955.46,-11562.35 6962.19,-11570.53 6965.82,-11564.55"/>
</g>
<!-- QKV_s0_l7_tp3 -->
<g id="node551" class="node">
<title>QKV_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7455.42,-11562.34 7117.42,-11562.34 7117.42,-11509.34 7455.42,-11509.34 7455.42,-11562.34"/>
<text text-anchor="middle" x="7286.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7286.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7286.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp3 -->
<g id="edge916" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7185.8,-11598.24C7202.89,-11587.82 7220.31,-11577.18 7235.76,-11567.75"/>
<polygon fill="black" stroke="black" points="7237.9,-11570.55 7244.61,-11562.35 7234.25,-11564.57 7237.9,-11570.55"/>
</g>
<!-- QKV_s0_l7_tp4 -->
<g id="node552" class="node">
<title>QKV_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="7836.42,-11562.34 7498.42,-11562.34 7498.42,-11509.34 7836.42,-11509.34 7836.42,-11562.34"/>
<text text-anchor="middle" x="7667.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7667.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7667.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp4 -->
<g id="edge917" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7318.83,-11606.62C7389.75,-11592.42 7466.42,-11577.08 7529.74,-11564.4"/>
<polygon fill="black" stroke="black" points="7530.67,-11567.78 7539.79,-11562.39 7529.3,-11560.92 7530.67,-11567.78"/>
</g>
<!-- QKV_s0_l7_tp5 -->
<g id="node553" class="node">
<title>QKV_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="8222.42,-11562.34 7884.42,-11562.34 7884.42,-11509.34 8222.42,-11509.34 8222.42,-11562.34"/>
<text text-anchor="middle" x="8053.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8053.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8053.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp5 -->
<g id="edge918" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M7339.93,-11622.32C7486.01,-11605.16 7676.52,-11582.67 7845.42,-11562.34 7854.81,-11561.21 7864.43,-11560.05 7874.14,-11558.87"/>
<polygon fill="black" stroke="black" points="7874.78,-11562.32 7884.29,-11557.64 7873.94,-11555.37 7874.78,-11562.32"/>
</g>
<!-- QKV_s0_l7_tp6 -->
<g id="node554" class="node">
<title>QKV_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="8610.42,-11562.34 8272.42,-11562.34 8272.42,-11509.34 8610.42,-11509.34 8610.42,-11562.34"/>
<text text-anchor="middle" x="8441.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8441.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8441.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp6 -->
<g id="edge919" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M7340.39,-11622.47C7419.89,-11613.88 7508.89,-11604.95 7590.42,-11598.34 7874.83,-11575.28 7947.2,-11587.55 8231.42,-11562.34 8241.47,-11561.45 8251.78,-11560.45 8262.18,-11559.39"/>
<polygon fill="black" stroke="black" points="8262.59,-11562.87 8272.18,-11558.35 8261.87,-11555.9 8262.59,-11562.87"/>
</g>
<!-- QKV_s0_l7_tp7 -->
<g id="node555" class="node">
<title>QKV_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="5929.42,-11562.34 5591.42,-11562.34 5591.42,-11509.34 5929.42,-11509.34 5929.42,-11562.34"/>
<text text-anchor="middle" x="5760.42" y="-11547.14" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5760.42" y="-11532.14" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5760.42" y="-11517.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp7 -->
<g id="edge920" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;QKV_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M6793.31,-11630.48C6564.53,-11614.72 6244.63,-11590.69 5964.42,-11562.34 5956.34,-11561.52 5948.09,-11560.65 5939.76,-11559.74"/>
<polygon fill="black" stroke="black" points="5939.88,-11556.23 5929.56,-11558.6 5939.11,-11563.19 5939.88,-11556.23"/>
</g>
<!-- ResAttn_s0_l7_tp0 -->
<g id="node582" class="node">
<title>ResAttn_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6465.77,-10984.43 5908.45,-10984.43 5765.08,-10878.43 6322.4,-10878.43 6465.77,-10984.43"/>
<text text-anchor="middle" x="6115.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6115.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6115.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp0 -->
<g id="edge962" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6788.15,-11626.69C6656.48,-11617.16 6501.54,-11606.51 6361.42,-11598.34 6274.92,-11593.3 5655.66,-11608.64 5582.42,-11562.34 5533.68,-11531.53 5521.42,-11505.5 5521.42,-11447.84 5521.42,-11447.84 5521.42,-11447.84 5521.42,-11145.91 5521.42,-11066.07 5713.89,-11007.95 5879.71,-10972.7"/>
<polygon fill="black" stroke="black" points="5880.52,-10976.1 5889.59,-10970.62 5879.08,-10969.25 5880.52,-10976.1"/>
</g>
<!-- ResAttn_s0_l7_tp1 -->
<g id="node583" class="node">
<title>ResAttn_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="4629.77,-10984.43 4072.45,-10984.43 3929.08,-10878.43 4486.4,-10878.43 4629.77,-10984.43"/>
<text text-anchor="middle" x="4279.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4279.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4279.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp1 -->
<g id="edge964" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6786.4,-11625.4C6655.13,-11615.71 6500.96,-11605.3 6361.42,-11598.34 5817.42,-11571.22 5678.67,-11613.75 5136.42,-11562.34 4977.1,-11547.23 4425.42,-11607.88 4425.42,-11447.84 4425.42,-11447.84 4425.42,-11447.84 4425.42,-11145.91 4425.42,-11086.31 4386.17,-11031.12 4348.37,-10991.8"/>
<polygon fill="black" stroke="black" points="4350.84,-10989.32 4341.34,-10984.64 4345.85,-10994.23 4350.84,-10989.32"/>
</g>
<!-- ResAttn_s0_l7_tp2 -->
<g id="node584" class="node">
<title>ResAttn_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="5477.77,-10984.43 4920.45,-10984.43 4777.08,-10878.43 5334.4,-10878.43 5477.77,-10984.43"/>
<text text-anchor="middle" x="5127.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5127.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5127.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp2 -->
<g id="edge966" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M6787.71,-11626.45C6656.14,-11616.89 6501.39,-11606.29 6361.42,-11598.34 5991.45,-11577.33 5894.22,-11621.62 5528.42,-11562.34 5345.46,-11532.69 5127.42,-11633.18 5127.42,-11447.84 5127.42,-11447.84 5127.42,-11447.84 5127.42,-11145.91 5127.42,-11095.07 5127.42,-11037.41 5127.42,-10994.84"/>
<polygon fill="black" stroke="black" points="5130.92,-10994.63 5127.42,-10984.63 5123.92,-10994.63 5130.92,-10994.63"/>
</g>
<!-- ResAttn_s0_l7_tp3 -->
<g id="node585" class="node">
<title>ResAttn_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="8489.77,-10984.43 7932.45,-10984.43 7789.08,-10878.43 8346.4,-10878.43 8489.77,-10984.43"/>
<text text-anchor="middle" x="8139.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8139.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8139.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp3 -->
<g id="edge968" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7339.07,-11621.59C7418.88,-11612.89 7508.39,-11604.12 7590.42,-11598.34 7647.48,-11594.32 8571.01,-11592.8 8619.42,-11562.34 8668.05,-11531.75 8679.42,-11505.29 8679.42,-11447.84 8679.42,-11447.84 8679.42,-11447.84 8679.42,-11145.91 8679.42,-11079.27 8535.41,-11024.53 8396.13,-10987.17"/>
<polygon fill="black" stroke="black" points="8396.68,-10983.69 8386.11,-10984.51 8394.88,-10990.46 8396.68,-10983.69"/>
</g>
<!-- ResAttn_s0_l7_tp4 -->
<g id="node586" class="node">
<title>ResAttn_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="9423.77,-10984.43 8866.45,-10984.43 8723.08,-10878.43 9280.4,-10878.43 9423.77,-10984.43"/>
<text text-anchor="middle" x="9073.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9073.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9073.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp4 -->
<g id="edge970" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7339.07,-11621.53C7418.88,-11612.83 7508.39,-11604.07 7590.42,-11598.34 7755.64,-11586.8 9073.42,-11613.46 9073.42,-11447.84 9073.42,-11447.84 9073.42,-11447.84 9073.42,-11145.91 9073.42,-11095.07 9073.42,-11037.41 9073.42,-10994.84"/>
<polygon fill="black" stroke="black" points="9076.92,-10994.63 9073.42,-10984.63 9069.92,-10994.63 9076.92,-10994.63"/>
</g>
<!-- ResAttn_s0_l7_tp5 -->
<g id="node587" class="node">
<title>ResAttn_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="3488.77,-10984.43 2931.45,-10984.43 2788.08,-10878.43 3345.4,-10878.43 3488.77,-10984.43"/>
<text text-anchor="middle" x="3138.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3138.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3138.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp5 -->
<g id="edge972" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M6785.53,-11624.61C6654.46,-11614.83 6500.67,-11604.56 6361.42,-11598.34 5941.54,-11579.58 4886.51,-11621.69 4470.42,-11562.34 4277.61,-11534.83 4047.42,-11642.61 4047.42,-11447.84 4047.42,-11447.84 4047.42,-11447.84 4047.42,-11145.91 4047.42,-11019.62 3710.7,-10967.98 3447.14,-10946.9"/>
<polygon fill="black" stroke="black" points="3447.25,-10943.4 3437.01,-10946.1 3446.7,-10950.38 3447.25,-10943.4"/>
</g>
<!-- ResAttn_s0_l7_tp6 -->
<g id="node588" class="node">
<title>ResAttn_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="11566.77,-10984.43 11009.45,-10984.43 10866.08,-10878.43 11423.4,-10878.43 11566.77,-10984.43"/>
<text text-anchor="middle" x="11216.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11216.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11216.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp6 -->
<g id="edge974" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M7338.4,-11621C7418.37,-11612.23 7508.14,-11603.57 7590.42,-11598.34 7738.19,-11588.94 10251.42,-11595.91 10251.42,-11447.84 10251.42,-11447.84 10251.42,-11447.84 10251.42,-11145.91 10251.42,-11004.1 10653.71,-10956.42 10938.81,-10940.43"/>
<polygon fill="black" stroke="black" points="10939.11,-10943.92 10948.9,-10939.88 10938.72,-10936.93 10939.11,-10943.92"/>
</g>
<!-- ResAttn_s0_l7_tp7 -->
<g id="node589" class="node">
<title>ResAttn_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="10417.77,-10984.43 9860.45,-10984.43 9717.08,-10878.43 10274.4,-10878.43 10417.77,-10984.43"/>
<text text-anchor="middle" x="10067.42" y="-10942.73" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10067.42" y="-10927.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10067.42" y="-10912.73" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp7 -->
<g id="edge976" class="edge">
<title>ResMOE_s0_l6_tp0&#45;&gt;ResAttn_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M7338.74,-11621.31C7418.62,-11612.57 7508.27,-11603.85 7590.42,-11598.34 8154.27,-11560.49 8298.17,-11608.17 8861.42,-11562.34 9051.17,-11546.9 9710.42,-11638.21 9710.42,-11447.84 9710.42,-11447.84 9710.42,-11447.84 9710.42,-11145.91 9710.42,-11068 9773.83,-11017.84 9847.19,-10985.88"/>
<polygon fill="black" stroke="black" points="9848.81,-10989 9856.66,-10981.88 9846.08,-10982.55 9848.81,-10989"/>
</g>
<!-- SplitHeads_s0_l7_tp0 -->
<g id="node556" class="node">
<title>SplitHeads_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6311.42,-11473.34 5939.42,-11473.34 5939.42,-11420.34 6311.42,-11420.34 6311.42,-11473.34"/>
<text text-anchor="middle" x="6125.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6125.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6125.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp0&#45;&gt;SplitHeads_s0_l7_tp0 -->
<g id="edge921" class="edge">
<title>QKV_s0_l7_tp0&#45;&gt;SplitHeads_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6137.41,-11509.21C6135.84,-11501.14 6134.07,-11492.07 6132.38,-11483.44"/>
<polygon fill="black" stroke="black" points="6135.81,-11482.73 6130.45,-11473.59 6128.94,-11484.08 6135.81,-11482.73"/>
</g>
<!-- SplitHeads_s0_l7_tp1 -->
<g id="node557" class="node">
<title>SplitHeads_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="6701.42,-11473.34 6329.42,-11473.34 6329.42,-11420.34 6701.42,-11420.34 6701.42,-11473.34"/>
<text text-anchor="middle" x="6515.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6515.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6515.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp1&#45;&gt;SplitHeads_s0_l7_tp1 -->
<g id="edge922" class="edge">
<title>QKV_s0_l7_tp1&#45;&gt;SplitHeads_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6527.41,-11509.21C6525.84,-11501.14 6524.07,-11492.07 6522.38,-11483.44"/>
<polygon fill="black" stroke="black" points="6525.81,-11482.73 6520.45,-11473.59 6518.94,-11484.08 6525.81,-11482.73"/>
</g>
<!-- SplitHeads_s0_l7_tp2 -->
<g id="node558" class="node">
<title>SplitHeads_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="7091.42,-11473.34 6719.42,-11473.34 6719.42,-11420.34 7091.42,-11420.34 7091.42,-11473.34"/>
<text text-anchor="middle" x="6905.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6905.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6905.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp2&#45;&gt;SplitHeads_s0_l7_tp2 -->
<g id="edge923" class="edge">
<title>QKV_s0_l7_tp2&#45;&gt;SplitHeads_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M6911.07,-11509.21C6910.33,-11501.23 6909.51,-11492.27 6908.72,-11483.72"/>
<polygon fill="black" stroke="black" points="6912.19,-11483.23 6907.79,-11473.59 6905.22,-11483.87 6912.19,-11483.23"/>
</g>
<!-- SplitHeads_s0_l7_tp3 -->
<g id="node559" class="node">
<title>SplitHeads_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7481.42,-11473.34 7109.42,-11473.34 7109.42,-11420.34 7481.42,-11420.34 7481.42,-11473.34"/>
<text text-anchor="middle" x="7295.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7295.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7295.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp3&#45;&gt;SplitHeads_s0_l7_tp3 -->
<g id="edge924" class="edge">
<title>QKV_s0_l7_tp3&#45;&gt;SplitHeads_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7289.07,-11509.21C7289.9,-11501.23 7290.83,-11492.27 7291.71,-11483.72"/>
<polygon fill="black" stroke="black" points="7295.21,-11483.9 7292.76,-11473.59 7288.25,-11483.18 7295.21,-11483.9"/>
</g>
<!-- SplitHeads_s0_l7_tp4 -->
<g id="node560" class="node">
<title>SplitHeads_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="7871.42,-11473.34 7499.42,-11473.34 7499.42,-11420.34 7871.42,-11420.34 7871.42,-11473.34"/>
<text text-anchor="middle" x="7685.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7685.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7685.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp4&#45;&gt;SplitHeads_s0_l7_tp4 -->
<g id="edge925" class="edge">
<title>QKV_s0_l7_tp4&#45;&gt;SplitHeads_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7672.73,-11509.21C7674.4,-11501.14 7676.27,-11492.07 7678.06,-11483.44"/>
<polygon fill="black" stroke="black" points="7681.5,-11484.09 7680.1,-11473.59 7674.64,-11482.67 7681.5,-11484.09"/>
</g>
<!-- SplitHeads_s0_l7_tp5 -->
<g id="node561" class="node">
<title>SplitHeads_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="8261.42,-11473.34 7889.42,-11473.34 7889.42,-11420.34 8261.42,-11420.34 8261.42,-11473.34"/>
<text text-anchor="middle" x="8075.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8075.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8075.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp5&#45;&gt;SplitHeads_s0_l7_tp5 -->
<g id="edge926" class="edge">
<title>QKV_s0_l7_tp5&#45;&gt;SplitHeads_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M8059.9,-11509.21C8061.94,-11501.14 8064.24,-11492.07 8066.42,-11483.44"/>
<polygon fill="black" stroke="black" points="8069.85,-11484.14 8068.91,-11473.59 8063.07,-11482.43 8069.85,-11484.14"/>
</g>
<!-- SplitHeads_s0_l7_tp6 -->
<g id="node562" class="node">
<title>SplitHeads_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="8651.42,-11473.34 8279.42,-11473.34 8279.42,-11420.34 8651.42,-11420.34 8651.42,-11473.34"/>
<text text-anchor="middle" x="8465.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8465.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8465.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp6&#45;&gt;SplitHeads_s0_l7_tp6 -->
<g id="edge927" class="edge">
<title>QKV_s0_l7_tp6&#45;&gt;SplitHeads_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M8448.49,-11509.21C8450.72,-11501.14 8453.22,-11492.07 8455.6,-11483.44"/>
<polygon fill="black" stroke="black" points="8459.03,-11484.16 8458.32,-11473.59 8452.29,-11482.3 8459.03,-11484.16"/>
</g>
<!-- SplitHeads_s0_l7_tp7 -->
<g id="node563" class="node">
<title>SplitHeads_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="5921.42,-11473.34 5549.42,-11473.34 5549.42,-11420.34 5921.42,-11420.34 5921.42,-11473.34"/>
<text text-anchor="middle" x="5735.42" y="-11458.14" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5735.42" y="-11443.14" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5735.42" y="-11428.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l7_tp7&#45;&gt;SplitHeads_s0_l7_tp7 -->
<g id="edge928" class="edge">
<title>QKV_s0_l7_tp7&#45;&gt;SplitHeads_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M5753.06,-11509.21C5750.74,-11501.14 5748.13,-11492.07 5745.65,-11483.44"/>
<polygon fill="black" stroke="black" points="5748.95,-11482.23 5742.82,-11473.59 5742.22,-11484.17 5748.95,-11482.23"/>
</g>
<!-- A2A_s0_l7 -->
<g id="node564" class="node">
<title>A2A_s0_l7</title>
<ellipse fill="none" stroke="black" cx="7100.42" cy="-11346.86" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7100.42" y="-11358.16" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="7100.42" y="-11343.16" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7100.42" y="-11328.16" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l7_tp0&#45;&gt;A2A_s0_l7 -->
<g id="edge929" class="edge">
<title>SplitHeads_s0_l7_tp0&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M6311.45,-11421.36C6314.46,-11421.01 6317.45,-11420.67 6320.42,-11420.34 6503.43,-11399.88 6711.05,-11380.79 6866.05,-11367.34"/>
<polygon fill="black" stroke="black" points="6866.53,-11370.81 6876.19,-11366.46 6865.92,-11363.84 6866.53,-11370.81"/>
</g>
<!-- SplitHeads_s0_l7_tp1&#45;&gt;A2A_s0_l7 -->
<g id="edge930" class="edge">
<title>SplitHeads_s0_l7_tp1&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M6667.98,-11420.29C6746.22,-11407.19 6841.93,-11391.16 6923.41,-11377.51"/>
<polygon fill="black" stroke="black" points="6923.99,-11380.96 6933.27,-11375.86 6922.83,-11374.06 6923.99,-11380.96"/>
</g>
<!-- SplitHeads_s0_l7_tp2&#45;&gt;A2A_s0_l7 -->
<g id="edge931" class="edge">
<title>SplitHeads_s0_l7_tp2&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M6956.4,-11420.23C6976.24,-11410.26 6999.43,-11398.61 7021.33,-11387.6"/>
<polygon fill="black" stroke="black" points="7022.94,-11390.71 7030.3,-11383.09 7019.8,-11384.46 7022.94,-11390.71"/>
</g>
<!-- SplitHeads_s0_l7_tp3&#45;&gt;A2A_s0_l7 -->
<g id="edge932" class="edge">
<title>SplitHeads_s0_l7_tp3&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M7244.44,-11420.23C7224.61,-11410.26 7201.42,-11398.61 7179.51,-11387.6"/>
<polygon fill="black" stroke="black" points="7181.05,-11384.46 7170.54,-11383.09 7177.91,-11390.71 7181.05,-11384.46"/>
</g>
<!-- SplitHeads_s0_l7_tp4&#45;&gt;A2A_s0_l7 -->
<g id="edge933" class="edge">
<title>SplitHeads_s0_l7_tp4&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M7532.87,-11420.29C7454.63,-11407.19 7358.91,-11391.16 7277.44,-11377.51"/>
<polygon fill="black" stroke="black" points="7278.02,-11374.06 7267.58,-11375.86 7276.86,-11380.96 7278.02,-11374.06"/>
</g>
<!-- SplitHeads_s0_l7_tp5&#45;&gt;A2A_s0_l7 -->
<g id="edge934" class="edge">
<title>SplitHeads_s0_l7_tp5&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M7889.4,-11421.36C7886.39,-11421.01 7883.39,-11420.67 7880.42,-11420.34 7697.42,-11399.88 7489.79,-11380.79 7334.79,-11367.34"/>
<polygon fill="black" stroke="black" points="7334.92,-11363.84 7324.66,-11366.46 7334.32,-11370.81 7334.92,-11363.84"/>
</g>
<!-- SplitHeads_s0_l7_tp6&#45;&gt;A2A_s0_l7 -->
<g id="edge935" class="edge">
<title>SplitHeads_s0_l7_tp6&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M8279.41,-11421.23C8276.39,-11420.92 8273.4,-11420.63 8270.42,-11420.34 7958.38,-11390.31 7598.25,-11370.18 7360.88,-11358.9"/>
<polygon fill="black" stroke="black" points="7360.88,-11355.4 7350.73,-11358.42 7360.55,-11362.39 7360.88,-11355.4"/>
</g>
<!-- SplitHeads_s0_l7_tp7&#45;&gt;A2A_s0_l7 -->
<g id="edge936" class="edge">
<title>SplitHeads_s0_l7_tp7&#45;&gt;A2A_s0_l7</title>
<path fill="none" stroke="black" d="M5921.43,-11421.23C5924.45,-11420.92 5927.45,-11420.63 5930.42,-11420.34 6242.47,-11390.31 6602.6,-11370.18 6839.96,-11358.9"/>
<polygon fill="black" stroke="black" points="6840.29,-11362.39 6850.12,-11358.42 6839.96,-11355.4 6840.29,-11362.39"/>
</g>
<!-- Attn_s0_l7_tp0 -->
<g id="node565" class="node">
<title>Attn_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6311.42,-11273.39 5939.42,-11273.39 5939.42,-11220.39 6311.42,-11220.39 6311.42,-11273.39"/>
<text text-anchor="middle" x="6125.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6125.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6125.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp0 -->
<g id="edge937" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6876.19,-11327.26C6722.85,-11314.01 6514.7,-11294.96 6321.51,-11273.49"/>
<polygon fill="black" stroke="black" points="6321.77,-11270 6311.45,-11272.37 6321,-11276.96 6321.77,-11270"/>
</g>
<!-- Attn_s0_l7_tp1 -->
<g id="node566" class="node">
<title>Attn_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="6701.42,-11273.39 6329.42,-11273.39 6329.42,-11220.39 6701.42,-11220.39 6701.42,-11273.39"/>
<text text-anchor="middle" x="6515.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6515.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6515.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp1 -->
<g id="edge938" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6933.18,-11317.85C6853.03,-11304.43 6757.42,-11288.42 6677.9,-11275.1"/>
<polygon fill="black" stroke="black" points="6678.23,-11271.6 6667.79,-11273.4 6677.07,-11278.51 6678.23,-11271.6"/>
</g>
<!-- Attn_s0_l7_tp2 -->
<g id="node567" class="node">
<title>Attn_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="7091.42,-11273.39 6719.42,-11273.39 6719.42,-11220.39 7091.42,-11220.39 7091.42,-11273.39"/>
<text text-anchor="middle" x="6905.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6905.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6905.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp2 -->
<g id="edge939" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M7030.3,-11310.63C7008.99,-11299.92 6985.79,-11288.27 6965.23,-11277.94"/>
<polygon fill="black" stroke="black" points="6966.8,-11274.81 6956.29,-11273.44 6963.65,-11281.06 6966.8,-11274.81"/>
</g>
<!-- Attn_s0_l7_tp3 -->
<g id="node568" class="node">
<title>Attn_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7481.42,-11273.39 7109.42,-11273.39 7109.42,-11220.39 7481.42,-11220.39 7481.42,-11273.39"/>
<text text-anchor="middle" x="7295.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7295.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7295.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp3 -->
<g id="edge940" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7170.55,-11310.63C7191.85,-11299.92 7215.06,-11288.27 7235.62,-11277.94"/>
<polygon fill="black" stroke="black" points="7237.19,-11281.06 7244.55,-11273.44 7234.05,-11274.81 7237.19,-11281.06"/>
</g>
<!-- Attn_s0_l7_tp4 -->
<g id="node569" class="node">
<title>Attn_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="7871.42,-11273.39 7499.42,-11273.39 7499.42,-11220.39 7871.42,-11220.39 7871.42,-11273.39"/>
<text text-anchor="middle" x="7685.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7685.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7685.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp4 -->
<g id="edge941" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7267.67,-11317.85C7347.81,-11304.43 7443.43,-11288.42 7522.95,-11275.1"/>
<polygon fill="black" stroke="black" points="7523.77,-11278.51 7533.06,-11273.4 7522.62,-11271.6 7523.77,-11278.51"/>
</g>
<!-- Attn_s0_l7_tp5 -->
<g id="node570" class="node">
<title>Attn_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="8261.42,-11273.39 7889.42,-11273.39 7889.42,-11220.39 8261.42,-11220.39 8261.42,-11273.39"/>
<text text-anchor="middle" x="8075.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8075.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8075.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp5 -->
<g id="edge942" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M7324.66,-11327.26C7478,-11314.01 7686.14,-11294.96 7879.34,-11273.49"/>
<polygon fill="black" stroke="black" points="7879.85,-11276.96 7889.4,-11272.37 7879.07,-11270 7879.85,-11276.96"/>
</g>
<!-- Attn_s0_l7_tp6 -->
<g id="node571" class="node">
<title>Attn_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="8651.42,-11273.39 8279.42,-11273.39 8279.42,-11220.39 8651.42,-11220.39 8651.42,-11273.39"/>
<text text-anchor="middle" x="8465.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8465.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8465.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp6 -->
<g id="edge943" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M7350.73,-11335.3C7585.46,-11324.24 7946.4,-11304.27 8269.39,-11273.46"/>
<polygon fill="black" stroke="black" points="8269.79,-11276.94 8279.41,-11272.5 8269.12,-11269.97 8269.79,-11276.94"/>
</g>
<!-- Attn_s0_l7_tp7 -->
<g id="node572" class="node">
<title>Attn_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="5921.42,-11273.39 5549.42,-11273.39 5549.42,-11220.39 5921.42,-11220.39 5921.42,-11273.39"/>
<text text-anchor="middle" x="5735.42" y="-11258.19" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5735.42" y="-11243.19" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5735.42" y="-11228.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l7&#45;&gt;Attn_s0_l7_tp7 -->
<g id="edge944" class="edge">
<title>A2A_s0_l7&#45;&gt;Attn_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M6850.12,-11335.3C6615.38,-11324.24 6254.44,-11304.27 5931.46,-11273.46"/>
<polygon fill="black" stroke="black" points="5931.72,-11269.97 5921.43,-11272.5 5931.05,-11276.94 5931.72,-11269.97"/>
</g>
<!-- AR_attn_s0_l7 -->
<g id="node573" class="node">
<title>AR_attn_s0_l7</title>
<ellipse fill="none" stroke="black" cx="7058.42" cy="-11146.91" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="7058.42" y="-11158.21" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="7058.42" y="-11143.21" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7058.42" y="-11128.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l7_tp0&#45;&gt;AR_attn_s0_l7 -->
<g id="edge945" class="edge">
<title>Attn_s0_l7_tp0&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M6311.45,-11221.42C6314.46,-11221.07 6317.45,-11220.73 6320.42,-11220.39 6490.62,-11200.91 6683.28,-11182.09 6829.07,-11168.52"/>
<polygon fill="black" stroke="black" points="6829.41,-11172 6839.04,-11167.59 6828.76,-11165.03 6829.41,-11172"/>
</g>
<!-- Attn_s0_l7_tp1&#45;&gt;AR_attn_s0_l7 -->
<g id="edge946" class="edge">
<title>Attn_s0_l7_tp1&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M6657.03,-11220.34C6727.85,-11207.56 6814.1,-11191.99 6888.47,-11178.57"/>
<polygon fill="black" stroke="black" points="6889.2,-11182 6898.41,-11176.78 6887.95,-11175.11 6889.2,-11182"/>
</g>
<!-- Attn_s0_l7_tp2&#45;&gt;AR_attn_s0_l7 -->
<g id="edge947" class="edge">
<title>Attn_s0_l7_tp2&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M6945.62,-11220.14C6960.47,-11210.63 6977.7,-11199.6 6994.16,-11189.06"/>
<polygon fill="black" stroke="black" points="6996.14,-11191.95 7002.68,-11183.61 6992.37,-11186.05 6996.14,-11191.95"/>
</g>
<!-- Attn_s0_l7_tp3&#45;&gt;AR_attn_s0_l7 -->
<g id="edge948" class="edge">
<title>Attn_s0_l7_tp3&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M7233.46,-11220.27C7208.56,-11209.98 7179.3,-11197.88 7151.91,-11186.56"/>
<polygon fill="black" stroke="black" points="7152.89,-11183.18 7142.31,-11182.59 7150.22,-11189.64 7152.89,-11183.18"/>
</g>
<!-- Attn_s0_l7_tp4&#45;&gt;AR_attn_s0_l7 -->
<g id="edge949" class="edge">
<title>Attn_s0_l7_tp4&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M7521.91,-11220.34C7436.14,-11206.93 7330.77,-11190.47 7242.18,-11176.62"/>
<polygon fill="black" stroke="black" points="7242.71,-11173.17 7232.29,-11175.08 7241.63,-11180.08 7242.71,-11173.17"/>
</g>
<!-- Attn_s0_l7_tp5&#45;&gt;AR_attn_s0_l7 -->
<g id="edge950" class="edge">
<title>Attn_s0_l7_tp5&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M7889.4,-11221.38C7886.39,-11221.04 7883.39,-11220.71 7880.42,-11220.39 7684.44,-11198.94 7461.62,-11179.61 7297.45,-11166.31"/>
<polygon fill="black" stroke="black" points="7297.47,-11162.8 7287.22,-11165.49 7296.91,-11169.78 7297.47,-11162.8"/>
</g>
<!-- Attn_s0_l7_tp6&#45;&gt;AR_attn_s0_l7 -->
<g id="edge951" class="edge">
<title>Attn_s0_l7_tp6&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M8279.41,-11221.27C8276.4,-11220.96 8273.4,-11220.67 8270.42,-11220.39 7943.79,-11189.3 7566.29,-11169.22 7320.53,-11158.26"/>
<polygon fill="black" stroke="black" points="7320.53,-11154.76 7310.39,-11157.81 7320.22,-11161.75 7320.53,-11154.76"/>
</g>
<!-- Attn_s0_l7_tp7&#45;&gt;AR_attn_s0_l7 -->
<g id="edge952" class="edge">
<title>Attn_s0_l7_tp7&#45;&gt;AR_attn_s0_l7</title>
<path fill="none" stroke="black" d="M5921.43,-11221.28C5924.45,-11220.98 5927.45,-11220.68 5930.42,-11220.39 6227.88,-11191.41 6570.64,-11171.26 6799.52,-11159.69"/>
<polygon fill="black" stroke="black" points="6799.84,-11163.18 6809.66,-11159.18 6799.49,-11156.19 6799.84,-11163.18"/>
</g>
<!-- O_s0_l7_tp0 -->
<g id="node574" class="node">
<title>O_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6585.42,-11073.43 6247.42,-11073.43 6247.42,-11020.43 6585.42,-11020.43 6585.42,-11073.43"/>
<text text-anchor="middle" x="6416.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6416.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6416.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp0 -->
<g id="edge953" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6882.14,-11119.01C6792.43,-11105.32 6683.63,-11088.71 6593.77,-11075"/>
<polygon fill="black" stroke="black" points="6594.16,-11071.52 6583.74,-11073.47 6593.1,-11078.44 6594.16,-11071.52"/>
</g>
<!-- O_s0_l7_tp1 -->
<g id="node575" class="node">
<title>O_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="5493.42,-11073.43 5155.42,-11073.43 5155.42,-11020.43 5493.42,-11020.43 5493.42,-11073.43"/>
<text text-anchor="middle" x="5324.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5324.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5324.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp1 -->
<g id="edge954" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6815.95,-11132.21C6463.29,-11112.28 5816.88,-11075.76 5503.79,-11058.07"/>
<polygon fill="black" stroke="black" points="5503.89,-11054.57 5493.71,-11057.5 5503.5,-11061.56 5503.89,-11054.57"/>
</g>
<!-- O_s0_l7_tp2 -->
<g id="node576" class="node">
<title>O_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="6140.42,-11073.43 5802.42,-11073.43 5802.42,-11020.43 6140.42,-11020.43 6140.42,-11073.43"/>
<text text-anchor="middle" x="5971.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5971.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5971.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp2 -->
<g id="edge955" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M6836.51,-11126.72C6671.51,-11112.35 6440.87,-11092.05 6238.42,-11073.43 6210.11,-11070.83 6180.12,-11068.02 6150.86,-11065.25"/>
<polygon fill="black" stroke="black" points="6150.83,-11061.73 6140.54,-11064.27 6150.17,-11068.7 6150.83,-11061.73"/>
</g>
<!-- O_s0_l7_tp3 -->
<g id="node577" class="node">
<title>O_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7380.42,-11073.43 7042.42,-11073.43 7042.42,-11020.43 7380.42,-11020.43 7380.42,-11073.43"/>
<text text-anchor="middle" x="7211.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7211.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7211.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp3 -->
<g id="edge956" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7114.09,-11110.26C7130.1,-11100.01 7147.42,-11088.92 7162.95,-11078.97"/>
<polygon fill="black" stroke="black" points="7164.84,-11081.92 7171.38,-11073.58 7161.07,-11076.02 7164.84,-11081.92"/>
</g>
<!-- O_s0_l7_tp4 -->
<g id="node578" class="node">
<title>O_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="8346.42,-11073.43 8008.42,-11073.43 8008.42,-11020.43 8346.42,-11020.43 8346.42,-11073.43"/>
<text text-anchor="middle" x="8177.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8177.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8177.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp4 -->
<g id="edge957" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7279.5,-11126.55C7490.01,-11108.12 7802.9,-11080.73 7998.28,-11063.62"/>
<polygon fill="black" stroke="black" points="7998.7,-11067.09 8008.36,-11062.74 7998.09,-11060.12 7998.7,-11067.09"/>
</g>
<!-- O_s0_l7_tp5 -->
<g id="node579" class="node">
<title>O_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="4937.42,-11073.43 4599.42,-11073.43 4599.42,-11020.43 4937.42,-11020.43 4937.42,-11073.43"/>
<text text-anchor="middle" x="4768.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4768.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4768.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp5 -->
<g id="edge958" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M6801.63,-11138.58C6434.51,-11127.55 5738.55,-11104.62 5146.42,-11073.43 5081.58,-11070.02 5010.54,-11065.44 4947.72,-11061.11"/>
<polygon fill="black" stroke="black" points="4947.93,-11057.62 4937.71,-11060.42 4947.44,-11064.6 4947.93,-11057.62"/>
</g>
<!-- O_s0_l7_tp6 -->
<g id="node580" class="node">
<title>O_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="9601.42,-11073.43 9263.42,-11073.43 9263.42,-11020.43 9601.42,-11020.43 9601.42,-11073.43"/>
<text text-anchor="middle" x="9432.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9432.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9432.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp6 -->
<g id="edge959" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M7315.73,-11139.12C7696,-11128.51 8430.45,-11105.8 9054.42,-11073.43 9119.27,-11070.07 9190.31,-11065.51 9253.13,-11061.17"/>
<polygon fill="black" stroke="black" points="9253.4,-11064.66 9263.14,-11060.48 9252.92,-11057.68 9253.4,-11064.66"/>
</g>
<!-- O_s0_l7_tp7 -->
<g id="node581" class="node">
<title>O_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="9045.42,-11073.43 8707.42,-11073.43 8707.42,-11020.43 9045.42,-11020.43 9045.42,-11073.43"/>
<text text-anchor="middle" x="8876.42" y="-11058.23" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8876.42" y="-11043.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8876.42" y="-11028.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l7&#45;&gt;O_s0_l7_tp7 -->
<g id="edge960" class="edge">
<title>AR_attn_s0_l7&#45;&gt;O_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M7302.19,-11132.77C7672.83,-11112.8 8369.57,-11075.25 8697.35,-11057.58"/>
<polygon fill="black" stroke="black" points="8697.62,-11061.07 8707.42,-11057.04 8697.24,-11054.08 8697.62,-11061.07"/>
</g>
<!-- O_s0_l7_tp0&#45;&gt;ResAttn_s0_l7_tp0 -->
<g id="edge961" class="edge">
<title>O_s0_l7_tp0&#45;&gt;ResAttn_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6348.5,-11020.32C6323.07,-11010.73 6293.09,-10999.43 6263.26,-10988.18"/>
<polygon fill="black" stroke="black" points="6264.17,-10984.78 6253.58,-10984.53 6261.7,-10991.33 6264.17,-10984.78"/>
</g>
<!-- O_s0_l7_tp1&#45;&gt;ResAttn_s0_l7_tp1 -->
<g id="edge963" class="edge">
<title>O_s0_l7_tp1&#45;&gt;ResAttn_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M5155.36,-11027.57C5010.58,-11011.85 4797.64,-10988.72 4617.97,-10969.2"/>
<polygon fill="black" stroke="black" points="4618.14,-10965.7 4607.82,-10968.1 4617.38,-10972.66 4618.14,-10965.7"/>
</g>
<!-- O_s0_l7_tp2&#45;&gt;ResAttn_s0_l7_tp2 -->
<g id="edge965" class="edge">
<title>O_s0_l7_tp2&#45;&gt;ResAttn_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M5802.4,-11023.2C5709.81,-11010.75 5591.47,-10994.84 5479.81,-10979.82"/>
<polygon fill="black" stroke="black" points="5480.1,-10976.33 5469.72,-10978.46 5479.16,-10983.27 5480.1,-10976.33"/>
</g>
<!-- O_s0_l7_tp3&#45;&gt;ResAttn_s0_l7_tp3 -->
<g id="edge967" class="edge">
<title>O_s0_l7_tp3&#45;&gt;ResAttn_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7380.55,-11025.25C7523.29,-11007.79 7729.6,-10982.56 7891.08,-10962.81"/>
<polygon fill="black" stroke="black" points="7891.67,-10966.26 7901.17,-10961.57 7890.82,-10959.31 7891.67,-10966.26"/>
</g>
<!-- O_s0_l7_tp4&#45;&gt;ResAttn_s0_l7_tp4 -->
<g id="edge969" class="edge">
<title>O_s0_l7_tp4&#45;&gt;ResAttn_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M8346.48,-11024.52C8481.95,-11007.36 8673.95,-10983.04 8826.61,-10963.7"/>
<polygon fill="black" stroke="black" points="8827.13,-10967.16 8836.61,-10962.43 8826.25,-10960.22 8827.13,-10967.16"/>
</g>
<!-- O_s0_l7_tp5&#45;&gt;ResAttn_s0_l7_tp5 -->
<g id="edge971" class="edge">
<title>O_s0_l7_tp5&#45;&gt;ResAttn_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M4599.36,-11034.16C4330.31,-11015.43 3800.21,-10978.51 3457.97,-10954.68"/>
<polygon fill="black" stroke="black" points="3458.12,-10951.19 3447.9,-10953.98 3457.63,-10958.17 3458.12,-10951.19"/>
</g>
<!-- O_s0_l7_tp6&#45;&gt;ResAttn_s0_l7_tp6 -->
<g id="edge973" class="edge">
<title>O_s0_l7_tp6&#45;&gt;ResAttn_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M9601.72,-11035.66C9799.55,-11023.61 10136.76,-11002.93 10426.42,-10984.43 10601.58,-10973.25 10798.56,-10960.28 10952.01,-10950.1"/>
<polygon fill="black" stroke="black" points="10952.31,-10953.59 10962.06,-10949.43 10951.85,-10946.6 10952.31,-10953.59"/>
</g>
<!-- O_s0_l7_tp7&#45;&gt;ResAttn_s0_l7_tp7 -->
<g id="edge975" class="edge">
<title>O_s0_l7_tp7&#45;&gt;ResAttn_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M9045.48,-11029.82C9245.29,-11010.78 9579.83,-10978.9 9811.45,-10956.83"/>
<polygon fill="black" stroke="black" points="9812.09,-10960.28 9821.71,-10955.85 9811.42,-10953.31 9812.09,-10960.28"/>
</g>
<!-- Gate_s0_l7_tp0 -->
<g id="node590" class="node">
<title>Gate_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6462.42,-10842.43 6124.42,-10842.43 6124.42,-10789.43 6462.42,-10789.43 6462.42,-10842.43"/>
<text text-anchor="middle" x="6293.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6293.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6293.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp0&#45;&gt;Gate_s0_l7_tp0 -->
<g id="edge977" class="edge">
<title>ResAttn_s0_l7_tp0&#45;&gt;Gate_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M6197.13,-10878.33C6213.48,-10867.91 6230.16,-10857.27 6244.94,-10847.85"/>
<polygon fill="black" stroke="black" points="6246.86,-10850.77 6253.41,-10842.45 6243.1,-10844.87 6246.86,-10850.77"/>
</g>
<!-- ResMOE_s0_l7_tp0 -->
<g id="node631" class="node">
<title>ResMOE_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="7236.77,-10553.48 6679.45,-10553.48 6536.08,-10447.48 7093.4,-10447.48 7236.77,-10553.48"/>
<text text-anchor="middle" x="6886.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6886.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6886.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp0&#45;&gt;ResMOE_s0_l7_tp0 -->
<g id="edge1050" class="edge">
<title>ResAttn_s0_l7_tp0&#45;&gt;ResMOE_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M5793.29,-10899.42C5694.89,-10891.13 5586.3,-10883.16 5486.42,-10878.43 4830,-10847.34 3184.71,-10892 2529.42,-10842.43 2244.38,-10820.87 2080.05,-10969.1 1892.42,-10753.43 1876.96,-10735.66 1876.06,-10717.37 1892.42,-10700.43 2056.76,-10530.32 5911.22,-10565.86 6147.42,-10553.48 6306.25,-10545.15 6484.06,-10532.74 6625.46,-10522.13"/>
<polygon fill="black" stroke="black" points="6625.87,-10525.6 6635.58,-10521.36 6625.35,-10518.62 6625.87,-10525.6"/>
</g>
<!-- Gate_s0_l7_tp1 -->
<g id="node591" class="node">
<title>Gate_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="4180.42,-10842.43 3842.42,-10842.43 3842.42,-10789.43 4180.42,-10789.43 4180.42,-10842.43"/>
<text text-anchor="middle" x="4011.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4011.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4011.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp1&#45;&gt;Gate_s0_l7_tp1 -->
<g id="edge978" class="edge">
<title>ResAttn_s0_l7_tp1&#45;&gt;Gate_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M4156.4,-10878.33C4130.52,-10867.37 4104.09,-10856.18 4081.01,-10846.4"/>
<polygon fill="black" stroke="black" points="4082.24,-10843.12 4071.67,-10842.45 4079.51,-10849.57 4082.24,-10843.12"/>
</g>
<!-- ResMOE_s0_l7_tp1 -->
<g id="node632" class="node">
<title>ResMOE_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="4662.77,-10553.48 4105.45,-10553.48 3962.08,-10447.48 4519.4,-10447.48 4662.77,-10553.48"/>
<text text-anchor="middle" x="4312.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4312.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4312.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp1&#45;&gt;ResMOE_s0_l7_tp1 -->
<g id="edge1052" class="edge">
<title>ResAttn_s0_l7_tp1&#45;&gt;ResMOE_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M3966.62,-10906.41C3823.65,-10896.25 3652.05,-10885.23 3497.42,-10878.43 3450.9,-10876.39 1853.99,-10875.71 1821.42,-10842.43 1782.1,-10802.26 1782.38,-10629.92 1821.42,-10589.48 1840.44,-10569.78 3388.01,-10526.18 4034.01,-10508.82"/>
<polygon fill="black" stroke="black" points="4034.49,-10512.31 4044.4,-10508.54 4034.31,-10505.31 4034.49,-10512.31"/>
</g>
<!-- Gate_s0_l7_tp2 -->
<g id="node592" class="node">
<title>Gate_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="5296.42,-10842.43 4958.42,-10842.43 4958.42,-10789.43 5296.42,-10789.43 5296.42,-10842.43"/>
<text text-anchor="middle" x="5127.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5127.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5127.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp2&#45;&gt;Gate_s0_l7_tp2 -->
<g id="edge979" class="edge">
<title>ResAttn_s0_l7_tp2&#45;&gt;Gate_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M5127.42,-10878.33C5127.42,-10869.66 5127.42,-10860.85 5127.42,-10852.7"/>
<polygon fill="black" stroke="black" points="5130.92,-10852.45 5127.42,-10842.45 5123.92,-10852.45 5130.92,-10852.45"/>
</g>
<!-- ResMOE_s0_l7_tp2 -->
<g id="node633" class="node">
<title>ResMOE_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="6138.77,-10553.48 5581.45,-10553.48 5438.08,-10447.48 5995.4,-10447.48 6138.77,-10553.48"/>
<text text-anchor="middle" x="5788.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5788.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5788.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp2&#45;&gt;ResMOE_s0_l7_tp2 -->
<g id="edge1054" class="edge">
<title>ResAttn_s0_l7_tp2&#45;&gt;ResMOE_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M4793.7,-10890.76C4741.78,-10885.8 4688.7,-10881.43 4638.42,-10878.43 4599.89,-10876.14 1886.54,-10869.9 1859.42,-10842.43 1819.93,-10802.43 1819.93,-10629.48 1859.42,-10589.48 1886.86,-10561.68 4632.38,-10554.64 4671.42,-10553.48 4961.82,-10544.86 5294.4,-10528.55 5520.62,-10516.49"/>
<polygon fill="black" stroke="black" points="5520.84,-10519.98 5530.64,-10515.95 5520.47,-10512.99 5520.84,-10519.98"/>
</g>
<!-- Gate_s0_l7_tp3 -->
<g id="node593" class="node">
<title>Gate_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="8092.42,-10842.43 7754.42,-10842.43 7754.42,-10789.43 8092.42,-10789.43 8092.42,-10842.43"/>
<text text-anchor="middle" x="7923.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7923.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7923.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp3&#45;&gt;Gate_s0_l7_tp3 -->
<g id="edge980" class="edge">
<title>ResAttn_s0_l7_tp3&#45;&gt;Gate_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M8040.27,-10878.33C8020.06,-10867.71 7999.44,-10856.88 7981.25,-10847.32"/>
<polygon fill="black" stroke="black" points="7982.46,-10844 7971.98,-10842.45 7979.2,-10850.2 7982.46,-10844"/>
</g>
<!-- ResMOE_s0_l7_tp3 -->
<g id="node634" class="node">
<title>ResMOE_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="8085.77,-10553.48 7528.45,-10553.48 7385.08,-10447.48 7942.4,-10447.48 8085.77,-10553.48"/>
<text text-anchor="middle" x="7735.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7735.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7735.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp3&#45;&gt;ResMOE_s0_l7_tp3 -->
<g id="edge1056" class="edge">
<title>ResAttn_s0_l7_tp3&#45;&gt;ResMOE_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M8381.48,-10904.31C8484.04,-10894.35 8604.94,-10884.04 8714.42,-10878.43 9374.27,-10844.65 11028.59,-10892.25 11687.42,-10842.43 11976.66,-10820.56 12525.04,-10909.93 12324.42,-10700.43 12287.26,-10661.63 9057.82,-10547.07 8039.44,-10511.88"/>
<polygon fill="black" stroke="black" points="8039.53,-10508.38 8029.41,-10511.53 8039.29,-10515.38 8039.53,-10508.38"/>
</g>
<!-- Gate_s0_l7_tp4 -->
<g id="node594" class="node">
<title>Gate_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="9242.42,-10842.43 8904.42,-10842.43 8904.42,-10789.43 9242.42,-10789.43 9242.42,-10842.43"/>
<text text-anchor="middle" x="9073.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9073.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9073.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp4&#45;&gt;Gate_s0_l7_tp4 -->
<g id="edge981" class="edge">
<title>ResAttn_s0_l7_tp4&#45;&gt;Gate_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M9073.42,-10878.33C9073.42,-10869.66 9073.42,-10860.85 9073.42,-10852.7"/>
<polygon fill="black" stroke="black" points="9076.92,-10852.45 9073.42,-10842.45 9069.92,-10852.45 9076.92,-10852.45"/>
</g>
<!-- ResMOE_s0_l7_tp4 -->
<g id="node635" class="node">
<title>ResMOE_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="10122.77,-10553.48 9565.45,-10553.48 9422.08,-10447.48 9979.4,-10447.48 10122.77,-10553.48"/>
<text text-anchor="middle" x="9772.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9772.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9772.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp4&#45;&gt;ResMOE_s0_l7_tp4 -->
<g id="edge1058" class="edge">
<title>ResAttn_s0_l7_tp4&#45;&gt;ResMOE_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M9318.56,-10906.55C9436.33,-10896.05 9579.57,-10884.7 9708.42,-10878.43 9967.15,-10865.86 11783.09,-10879.75 12039.42,-10842.43 12184.23,-10821.35 12268.03,-10870.06 12356.42,-10753.43 12538.3,-10513.47 11311.64,-10612.52 11011.42,-10589.48 10698.75,-10565.48 10341.5,-10540.35 10091.21,-10523.12"/>
<polygon fill="black" stroke="black" points="10091.08,-10519.6 10080.86,-10522.41 10090.6,-10526.58 10091.08,-10519.6"/>
</g>
<!-- Gate_s0_l7_tp5 -->
<g id="node595" class="node">
<title>Gate_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="2876.42,-10842.43 2538.42,-10842.43 2538.42,-10789.43 2876.42,-10789.43 2876.42,-10842.43"/>
<text text-anchor="middle" x="2707.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2707.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2707.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp5&#45;&gt;Gate_s0_l7_tp5 -->
<g id="edge982" class="edge">
<title>ResAttn_s0_l7_tp5&#45;&gt;Gate_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M2940.9,-10878.42C2897.39,-10866.96 2852.9,-10855.24 2814.58,-10845.15"/>
<polygon fill="black" stroke="black" points="2815.02,-10841.65 2804.46,-10842.49 2813.24,-10848.42 2815.02,-10841.65"/>
</g>
<!-- ResMOE_s0_l7_tp5 -->
<g id="node636" class="node">
<title>ResMOE_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="2429.77,-10553.48 1872.45,-10553.48 1729.08,-10447.48 2286.4,-10447.48 2429.77,-10553.48"/>
<text text-anchor="middle" x="2079.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2079.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2079.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp5&#45;&gt;ResMOE_s0_l7_tp5 -->
<g id="edge1060" class="edge">
<title>ResAttn_s0_l7_tp5&#45;&gt;ResMOE_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M2845.41,-10920.88C2461.47,-10906.97 1832.25,-10878.79 1795.42,-10842.43 1715.4,-10763.45 1723.32,-10678.95 1791.42,-10589.48 1801.9,-10575.72 1826.19,-10563.19 1856.46,-10552.18"/>
<polygon fill="black" stroke="black" points="1857.77,-10555.44 1866.04,-10548.82 1855.45,-10548.83 1857.77,-10555.44"/>
</g>
<!-- Gate_s0_l7_tp6 -->
<g id="node596" class="node">
<title>Gate_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="11678.42,-10842.43 11340.42,-10842.43 11340.42,-10789.43 11678.42,-10789.43 11678.42,-10842.43"/>
<text text-anchor="middle" x="11509.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11509.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11509.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp6&#45;&gt;Gate_s0_l7_tp6 -->
<g id="edge983" class="edge">
<title>ResAttn_s0_l7_tp6&#45;&gt;Gate_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M11350.92,-10878.33C11379.46,-10867.28 11408.62,-10855.98 11434.02,-10846.14"/>
<polygon fill="black" stroke="black" points="11435.5,-10849.32 11443.56,-10842.45 11432.97,-10842.8 11435.5,-10849.32"/>
</g>
<!-- ResMOE_s0_l7_tp6 -->
<g id="node637" class="node">
<title>ResMOE_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="12548.77,-10553.48 11991.45,-10553.48 11848.08,-10447.48 12405.4,-10447.48 12548.77,-10553.48"/>
<text text-anchor="middle" x="12198.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="12198.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12198.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp6&#45;&gt;ResMOE_s0_l7_tp6 -->
<g id="edge1062" class="edge">
<title>ResAttn_s0_l7_tp6&#45;&gt;ResMOE_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M11493.17,-10929.88C11832.54,-10926.26 12370.75,-10909.8 12433.42,-10842.43 12510,-10760.12 12497.48,-10681.87 12433.42,-10589.48 12425.53,-10578.1 12415.98,-10568.19 12405.3,-10559.56"/>
<polygon fill="black" stroke="black" points="12407.41,-10556.77 12397.33,-10553.5 12403.17,-10562.34 12407.41,-10556.77"/>
</g>
<!-- Gate_s0_l7_tp7 -->
<g id="node597" class="node">
<title>Gate_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="10374.42,-10842.43 10036.42,-10842.43 10036.42,-10789.43 10374.42,-10789.43 10374.42,-10842.43"/>
<text text-anchor="middle" x="10205.42" y="-10827.23" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10205.42" y="-10812.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10205.42" y="-10797.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp7&#45;&gt;Gate_s0_l7_tp7 -->
<g id="edge984" class="edge">
<title>ResAttn_s0_l7_tp7&#45;&gt;Gate_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M10130.77,-10878.33C10142.97,-10868.3 10155.41,-10858.07 10166.54,-10848.91"/>
<polygon fill="black" stroke="black" points="10168.9,-10851.5 10174.4,-10842.45 10164.45,-10846.1 10168.9,-10851.5"/>
</g>
<!-- ResMOE_s0_l7_tp7 -->
<g id="node638" class="node">
<title>ResMOE_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="11500.77,-10553.48 10943.45,-10553.48 10800.08,-10447.48 11357.4,-10447.48 11500.77,-10553.48"/>
<text text-anchor="middle" x="11150.42" y="-10511.78" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11150.42" y="-10496.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11150.42" y="-10481.78" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l7_tp7&#45;&gt;ResMOE_s0_l7_tp7 -->
<g id="edge1064" class="edge">
<title>ResAttn_s0_l7_tp7&#45;&gt;ResMOE_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M10319,-10911.38C10474.13,-10900.25 10677.21,-10886.79 10857.42,-10878.43 11005.76,-10871.56 12049.06,-10877.24 12193.42,-10842.43 12282.51,-10820.95 12330.57,-10830.97 12379.42,-10753.43 12391.98,-10733.5 12394.69,-10718.37 12379.42,-10700.43 12321.53,-10632.41 11825.95,-10569.28 11482.07,-10533.09"/>
<polygon fill="black" stroke="black" points="11482.26,-10529.59 11471.95,-10532.02 11481.53,-10536.55 11482.26,-10529.59"/>
</g>
<!-- Expert0_s0_l7_tp0 -->
<g id="node598" class="node">
<title>Expert0_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6773.42,-10753.43 6465.42,-10753.43 6465.42,-10700.43 6773.42,-10700.43 6773.42,-10753.43"/>
<text text-anchor="middle" x="6619.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="6619.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6619.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp0&#45;&gt;Expert0_s0_l7_tp0 -->
<g id="edge985" class="edge">
<title>Gate_s0_l7_tp0&#45;&gt;Expert0_s0_l7_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6389.03,-10789.42C6428.26,-10778.95 6473.8,-10766.79 6513.99,-10756.07"/>
<polygon fill="black" stroke="black" points="6515.06,-10759.41 6523.82,-10753.45 6513.25,-10752.64 6515.06,-10759.41"/>
</g>
<!-- Expert1_s0_l7_tp0 -->
<g id="node599" class="node">
<title>Expert1_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="7099.42,-10753.43 6791.42,-10753.43 6791.42,-10700.43 7099.42,-10700.43 7099.42,-10753.43"/>
<text text-anchor="middle" x="6945.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="6945.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6945.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp0&#45;&gt;Expert1_s0_l7_tp0 -->
<g id="edge986" class="edge">
<title>Gate_s0_l7_tp0&#45;&gt;Expert1_s0_l7_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6462.47,-10794.94C6553.97,-10783.81 6669.22,-10769.3 6780.9,-10753.63"/>
<polygon fill="black" stroke="black" points="6781.59,-10757.07 6791.01,-10752.21 6780.62,-10750.14 6781.59,-10757.07"/>
</g>
<!-- Expert2_s0_l7_tp0 -->
<g id="node600" class="node">
<title>Expert2_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6121.42,-10753.43 5813.42,-10753.43 5813.42,-10700.43 6121.42,-10700.43 6121.42,-10753.43"/>
<text text-anchor="middle" x="5967.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="5967.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5967.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp0&#45;&gt;Expert2_s0_l7_tp0 -->
<g id="edge987" class="edge">
<title>Gate_s0_l7_tp0&#45;&gt;Expert2_s0_l7_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6197.81,-10789.42C6158.59,-10778.95 6113.04,-10766.79 6072.85,-10756.07"/>
<polygon fill="black" stroke="black" points="6073.59,-10752.64 6063.03,-10753.45 6071.79,-10759.41 6073.59,-10752.64"/>
</g>
<!-- Expert3_s0_l7_tp0 -->
<g id="node601" class="node">
<title>Expert3_s0_l7_tp0</title>
<polygon fill="none" stroke="black" points="6447.42,-10753.43 6139.42,-10753.43 6139.42,-10700.43 6447.42,-10700.43 6447.42,-10753.43"/>
<text text-anchor="middle" x="6293.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="6293.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6293.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp0&#45;&gt;Expert3_s0_l7_tp0 -->
<g id="edge988" class="edge">
<title>Gate_s0_l7_tp0&#45;&gt;Expert3_s0_l7_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6293.42,-10789.3C6293.42,-10781.32 6293.42,-10772.37 6293.42,-10763.82"/>
<polygon fill="black" stroke="black" points="6296.92,-10763.68 6293.42,-10753.68 6289.92,-10763.68 6296.92,-10763.68"/>
</g>
<!-- Expert4_s0_l7_tp1 -->
<g id="node602" class="node">
<title>Expert4_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="4165.42,-10753.43 3857.42,-10753.43 3857.42,-10700.43 4165.42,-10700.43 4165.42,-10753.43"/>
<text text-anchor="middle" x="4011.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="4011.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4011.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp1&#45;&gt;Expert4_s0_l7_tp1 -->
<g id="edge989" class="edge">
<title>Gate_s0_l7_tp1&#45;&gt;Expert4_s0_l7_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4011.42,-10789.3C4011.42,-10781.32 4011.42,-10772.37 4011.42,-10763.82"/>
<polygon fill="black" stroke="black" points="4014.92,-10763.68 4011.42,-10753.68 4007.92,-10763.68 4014.92,-10763.68"/>
</g>
<!-- Expert5_s0_l7_tp1 -->
<g id="node603" class="node">
<title>Expert5_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="4491.42,-10753.43 4183.42,-10753.43 4183.42,-10700.43 4491.42,-10700.43 4491.42,-10753.43"/>
<text text-anchor="middle" x="4337.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="4337.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4337.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp1&#45;&gt;Expert5_s0_l7_tp1 -->
<g id="edge990" class="edge">
<title>Gate_s0_l7_tp1&#45;&gt;Expert5_s0_l7_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4107.03,-10789.42C4146.26,-10778.95 4191.8,-10766.79 4231.99,-10756.07"/>
<polygon fill="black" stroke="black" points="4233.06,-10759.41 4241.82,-10753.45 4231.25,-10752.64 4233.06,-10759.41"/>
</g>
<!-- Expert6_s0_l7_tp1 -->
<g id="node604" class="node">
<title>Expert6_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="3513.42,-10753.43 3205.42,-10753.43 3205.42,-10700.43 3513.42,-10700.43 3513.42,-10753.43"/>
<text text-anchor="middle" x="3359.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="3359.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3359.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp1&#45;&gt;Expert6_s0_l7_tp1 -->
<g id="edge991" class="edge">
<title>Gate_s0_l7_tp1&#45;&gt;Expert6_s0_l7_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3842.37,-10794.94C3750.87,-10783.81 3635.63,-10769.3 3523.94,-10753.63"/>
<polygon fill="black" stroke="black" points="3524.23,-10750.14 3513.84,-10752.21 3523.25,-10757.07 3524.23,-10750.14"/>
</g>
<!-- Expert7_s0_l7_tp1 -->
<g id="node605" class="node">
<title>Expert7_s0_l7_tp1</title>
<polygon fill="none" stroke="black" points="3839.42,-10753.43 3531.42,-10753.43 3531.42,-10700.43 3839.42,-10700.43 3839.42,-10753.43"/>
<text text-anchor="middle" x="3685.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="3685.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3685.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp1&#45;&gt;Expert7_s0_l7_tp1 -->
<g id="edge992" class="edge">
<title>Gate_s0_l7_tp1&#45;&gt;Expert7_s0_l7_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3915.81,-10789.42C3876.59,-10778.95 3831.04,-10766.79 3790.85,-10756.07"/>
<polygon fill="black" stroke="black" points="3791.59,-10752.64 3781.03,-10753.45 3789.79,-10759.41 3791.59,-10752.64"/>
</g>
<!-- Expert8_s0_l7_tp2 -->
<g id="node606" class="node">
<title>Expert8_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="5795.42,-10753.43 5487.42,-10753.43 5487.42,-10700.43 5795.42,-10700.43 5795.42,-10753.43"/>
<text text-anchor="middle" x="5641.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="5641.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5641.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp2&#45;&gt;Expert8_s0_l7_tp2 -->
<g id="edge993" class="edge">
<title>Gate_s0_l7_tp2&#45;&gt;Expert8_s0_l7_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5278.17,-10789.42C5341.84,-10778.64 5416.08,-10766.07 5480.79,-10755.12"/>
<polygon fill="black" stroke="black" points="5481.41,-10758.57 5490.68,-10753.45 5480.24,-10751.67 5481.41,-10758.57"/>
</g>
<!-- Expert9_s0_l7_tp2 -->
<g id="node607" class="node">
<title>Expert9_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="4817.42,-10753.43 4509.42,-10753.43 4509.42,-10700.43 4817.42,-10700.43 4817.42,-10753.43"/>
<text text-anchor="middle" x="4663.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="4663.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4663.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp2&#45;&gt;Expert9_s0_l7_tp2 -->
<g id="edge994" class="edge">
<title>Gate_s0_l7_tp2&#45;&gt;Expert9_s0_l7_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4991.34,-10789.42C4934.21,-10778.71 4867.67,-10766.23 4809.51,-10755.32"/>
<polygon fill="black" stroke="black" points="4809.97,-10751.85 4799.5,-10753.45 4808.68,-10758.73 4809.97,-10751.85"/>
</g>
<!-- Expert10_s0_l7_tp2 -->
<g id="node608" class="node">
<title>Expert10_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="5143.42,-10753.43 4835.42,-10753.43 4835.42,-10700.43 5143.42,-10700.43 5143.42,-10753.43"/>
<text text-anchor="middle" x="4989.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="4989.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4989.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp2&#45;&gt;Expert10_s0_l7_tp2 -->
<g id="edge995" class="edge">
<title>Gate_s0_l7_tp2&#45;&gt;Expert10_s0_l7_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5086.76,-10789.3C5071.74,-10779.83 5054.54,-10768.99 5038.82,-10759.08"/>
<polygon fill="black" stroke="black" points="5040.59,-10756.06 5030.27,-10753.68 5036.86,-10761.98 5040.59,-10756.06"/>
</g>
<!-- Expert11_s0_l7_tp2 -->
<g id="node609" class="node">
<title>Expert11_s0_l7_tp2</title>
<polygon fill="none" stroke="black" points="5469.42,-10753.43 5161.42,-10753.43 5161.42,-10700.43 5469.42,-10700.43 5469.42,-10753.43"/>
<text text-anchor="middle" x="5315.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="5315.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5315.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp2&#45;&gt;Expert11_s0_l7_tp2 -->
<g id="edge996" class="edge">
<title>Gate_s0_l7_tp2&#45;&gt;Expert11_s0_l7_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5182.56,-10789.42C5203.98,-10779.5 5228.68,-10768.08 5250.92,-10757.78"/>
<polygon fill="black" stroke="black" points="5252.68,-10760.82 5260.29,-10753.45 5249.74,-10754.47 5252.68,-10760.82"/>
</g>
<!-- Expert12_s0_l7_tp3 -->
<g id="node610" class="node">
<title>Expert12_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7425.42,-10753.43 7117.42,-10753.43 7117.42,-10700.43 7425.42,-10700.43 7425.42,-10753.43"/>
<text text-anchor="middle" x="7271.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="7271.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7271.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp3&#45;&gt;Expert12_s0_l7_tp3 -->
<g id="edge997" class="edge">
<title>Gate_s0_l7_tp3&#45;&gt;Expert12_s0_l7_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7754.37,-10794.94C7662.87,-10783.81 7547.63,-10769.3 7435.94,-10753.63"/>
<polygon fill="black" stroke="black" points="7436.23,-10750.14 7425.84,-10752.21 7435.25,-10757.07 7436.23,-10750.14"/>
</g>
<!-- Expert13_s0_l7_tp3 -->
<g id="node611" class="node">
<title>Expert13_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="7751.42,-10753.43 7443.42,-10753.43 7443.42,-10700.43 7751.42,-10700.43 7751.42,-10753.43"/>
<text text-anchor="middle" x="7597.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="7597.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7597.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp3&#45;&gt;Expert13_s0_l7_tp3 -->
<g id="edge998" class="edge">
<title>Gate_s0_l7_tp3&#45;&gt;Expert13_s0_l7_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7827.81,-10789.42C7788.59,-10778.95 7743.04,-10766.79 7702.85,-10756.07"/>
<polygon fill="black" stroke="black" points="7703.59,-10752.64 7693.03,-10753.45 7701.79,-10759.41 7703.59,-10752.64"/>
</g>
<!-- Expert14_s0_l7_tp3 -->
<g id="node612" class="node">
<title>Expert14_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="8077.42,-10753.43 7769.42,-10753.43 7769.42,-10700.43 8077.42,-10700.43 8077.42,-10753.43"/>
<text text-anchor="middle" x="7923.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="7923.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7923.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp3&#45;&gt;Expert14_s0_l7_tp3 -->
<g id="edge999" class="edge">
<title>Gate_s0_l7_tp3&#45;&gt;Expert14_s0_l7_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7923.42,-10789.3C7923.42,-10781.32 7923.42,-10772.37 7923.42,-10763.82"/>
<polygon fill="black" stroke="black" points="7926.92,-10763.68 7923.42,-10753.68 7919.92,-10763.68 7926.92,-10763.68"/>
</g>
<!-- Expert15_s0_l7_tp3 -->
<g id="node613" class="node">
<title>Expert15_s0_l7_tp3</title>
<polygon fill="none" stroke="black" points="8403.42,-10753.43 8095.42,-10753.43 8095.42,-10700.43 8403.42,-10700.43 8403.42,-10753.43"/>
<text text-anchor="middle" x="8249.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="8249.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8249.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp3&#45;&gt;Expert15_s0_l7_tp3 -->
<g id="edge1000" class="edge">
<title>Gate_s0_l7_tp3&#45;&gt;Expert15_s0_l7_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8019.03,-10789.42C8058.26,-10778.95 8103.8,-10766.79 8143.99,-10756.07"/>
<polygon fill="black" stroke="black" points="8145.06,-10759.41 8153.82,-10753.45 8143.25,-10752.64 8145.06,-10759.41"/>
</g>
<!-- Expert16_s0_l7_tp4 -->
<g id="node614" class="node">
<title>Expert16_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="8729.42,-10753.43 8421.42,-10753.43 8421.42,-10700.43 8729.42,-10700.43 8729.42,-10753.43"/>
<text text-anchor="middle" x="8575.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="8575.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8575.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp4&#45;&gt;Expert16_s0_l7_tp4 -->
<g id="edge1001" class="edge">
<title>Gate_s0_l7_tp4&#45;&gt;Expert16_s0_l7_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8927.37,-10789.42C8865.8,-10778.66 8794.04,-10766.13 8731.44,-10755.19"/>
<polygon fill="black" stroke="black" points="8731.92,-10751.72 8721.47,-10753.45 8730.72,-10758.62 8731.92,-10751.72"/>
</g>
<!-- Expert17_s0_l7_tp4 -->
<g id="node615" class="node">
<title>Expert17_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="9055.42,-10753.43 8747.42,-10753.43 8747.42,-10700.43 9055.42,-10700.43 9055.42,-10753.43"/>
<text text-anchor="middle" x="8901.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="8901.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8901.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp4&#45;&gt;Expert17_s0_l7_tp4 -->
<g id="edge1002" class="edge">
<title>Gate_s0_l7_tp4&#45;&gt;Expert17_s0_l7_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9022.75,-10789.3C9003.41,-10779.52 8981.19,-10768.28 8961.1,-10758.12"/>
<polygon fill="black" stroke="black" points="8962.54,-10754.92 8952.03,-10753.53 8959.38,-10761.17 8962.54,-10754.92"/>
</g>
<!-- Expert18_s0_l7_tp4 -->
<g id="node616" class="node">
<title>Expert18_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="9381.42,-10753.43 9073.42,-10753.43 9073.42,-10700.43 9381.42,-10700.43 9381.42,-10753.43"/>
<text text-anchor="middle" x="9227.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="9227.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9227.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp4&#45;&gt;Expert18_s0_l7_tp4 -->
<g id="edge1003" class="edge">
<title>Gate_s0_l7_tp4&#45;&gt;Expert18_s0_l7_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9118.79,-10789.3C9135.79,-10779.7 9155.28,-10768.69 9173.02,-10758.67"/>
<polygon fill="black" stroke="black" points="9175.12,-10761.5 9182.11,-10753.53 9171.68,-10755.4 9175.12,-10761.5"/>
</g>
<!-- Expert19_s0_l7_tp4 -->
<g id="node617" class="node">
<title>Expert19_s0_l7_tp4</title>
<polygon fill="none" stroke="black" points="9707.42,-10753.43 9399.42,-10753.43 9399.42,-10700.43 9707.42,-10700.43 9707.42,-10753.43"/>
<text text-anchor="middle" x="9553.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="9553.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9553.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp4&#45;&gt;Expert19_s0_l7_tp4 -->
<g id="edge1004" class="edge">
<title>Gate_s0_l7_tp4&#45;&gt;Expert19_s0_l7_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9214.2,-10789.42C9273.42,-10778.68 9342.42,-10766.18 9402.67,-10755.26"/>
<polygon fill="black" stroke="black" points="9403.44,-10758.68 9412.65,-10753.45 9402.19,-10751.79 9403.44,-10758.68"/>
</g>
<!-- Expert20_s0_l7_tp5 -->
<g id="node618" class="node">
<title>Expert20_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="2209.42,-10753.43 1901.42,-10753.43 1901.42,-10700.43 2209.42,-10700.43 2209.42,-10753.43"/>
<text text-anchor="middle" x="2055.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="2055.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2055.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp5&#45;&gt;Expert20_s0_l7_tp5 -->
<g id="edge1005" class="edge">
<title>Gate_s0_l7_tp5&#45;&gt;Expert20_s0_l7_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2538.37,-10794.94C2446.87,-10783.81 2331.63,-10769.3 2219.94,-10753.63"/>
<polygon fill="black" stroke="black" points="2220.23,-10750.14 2209.84,-10752.21 2219.25,-10757.07 2220.23,-10750.14"/>
</g>
<!-- Expert21_s0_l7_tp5 -->
<g id="node619" class="node">
<title>Expert21_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="2535.42,-10753.43 2227.42,-10753.43 2227.42,-10700.43 2535.42,-10700.43 2535.42,-10753.43"/>
<text text-anchor="middle" x="2381.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="2381.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2381.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp5&#45;&gt;Expert21_s0_l7_tp5 -->
<g id="edge1006" class="edge">
<title>Gate_s0_l7_tp5&#45;&gt;Expert21_s0_l7_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2611.81,-10789.42C2572.59,-10778.95 2527.04,-10766.79 2486.85,-10756.07"/>
<polygon fill="black" stroke="black" points="2487.59,-10752.64 2477.03,-10753.45 2485.79,-10759.41 2487.59,-10752.64"/>
</g>
<!-- Expert22_s0_l7_tp5 -->
<g id="node620" class="node">
<title>Expert22_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="2861.42,-10753.43 2553.42,-10753.43 2553.42,-10700.43 2861.42,-10700.43 2861.42,-10753.43"/>
<text text-anchor="middle" x="2707.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="2707.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2707.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp5&#45;&gt;Expert22_s0_l7_tp5 -->
<g id="edge1007" class="edge">
<title>Gate_s0_l7_tp5&#45;&gt;Expert22_s0_l7_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2707.42,-10789.3C2707.42,-10781.32 2707.42,-10772.37 2707.42,-10763.82"/>
<polygon fill="black" stroke="black" points="2710.92,-10763.68 2707.42,-10753.68 2703.92,-10763.68 2710.92,-10763.68"/>
</g>
<!-- Expert23_s0_l7_tp5 -->
<g id="node621" class="node">
<title>Expert23_s0_l7_tp5</title>
<polygon fill="none" stroke="black" points="3187.42,-10753.43 2879.42,-10753.43 2879.42,-10700.43 3187.42,-10700.43 3187.42,-10753.43"/>
<text text-anchor="middle" x="3033.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="3033.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3033.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp5&#45;&gt;Expert23_s0_l7_tp5 -->
<g id="edge1008" class="edge">
<title>Gate_s0_l7_tp5&#45;&gt;Expert23_s0_l7_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2803.03,-10789.42C2842.26,-10778.95 2887.8,-10766.79 2927.99,-10756.07"/>
<polygon fill="black" stroke="black" points="2929.06,-10759.41 2937.82,-10753.45 2927.25,-10752.64 2929.06,-10759.41"/>
</g>
<!-- Expert24_s0_l7_tp6 -->
<g id="node622" class="node">
<title>Expert24_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="11337.42,-10753.43 11029.42,-10753.43 11029.42,-10700.43 11337.42,-10700.43 11337.42,-10753.43"/>
<text text-anchor="middle" x="11183.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="11183.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11183.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp6&#45;&gt;Expert24_s0_l7_tp6 -->
<g id="edge1009" class="edge">
<title>Gate_s0_l7_tp6&#45;&gt;Expert24_s0_l7_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11413.81,-10789.42C11374.59,-10778.95 11329.04,-10766.79 11288.85,-10756.07"/>
<polygon fill="black" stroke="black" points="11289.59,-10752.64 11279.03,-10753.45 11287.79,-10759.41 11289.59,-10752.64"/>
</g>
<!-- Expert25_s0_l7_tp6 -->
<g id="node623" class="node">
<title>Expert25_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="11663.42,-10753.43 11355.42,-10753.43 11355.42,-10700.43 11663.42,-10700.43 11663.42,-10753.43"/>
<text text-anchor="middle" x="11509.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="11509.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11509.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp6&#45;&gt;Expert25_s0_l7_tp6 -->
<g id="edge1010" class="edge">
<title>Gate_s0_l7_tp6&#45;&gt;Expert25_s0_l7_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11509.42,-10789.3C11509.42,-10781.32 11509.42,-10772.37 11509.42,-10763.82"/>
<polygon fill="black" stroke="black" points="11512.92,-10763.68 11509.42,-10753.68 11505.92,-10763.68 11512.92,-10763.68"/>
</g>
<!-- Expert26_s0_l7_tp6 -->
<g id="node624" class="node">
<title>Expert26_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="11989.42,-10753.43 11681.42,-10753.43 11681.42,-10700.43 11989.42,-10700.43 11989.42,-10753.43"/>
<text text-anchor="middle" x="11835.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="11835.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11835.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp6&#45;&gt;Expert26_s0_l7_tp6 -->
<g id="edge1011" class="edge">
<title>Gate_s0_l7_tp6&#45;&gt;Expert26_s0_l7_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11605.03,-10789.42C11644.26,-10778.95 11689.8,-10766.79 11729.99,-10756.07"/>
<polygon fill="black" stroke="black" points="11731.06,-10759.41 11739.82,-10753.45 11729.25,-10752.64 11731.06,-10759.41"/>
</g>
<!-- Expert27_s0_l7_tp6 -->
<g id="node625" class="node">
<title>Expert27_s0_l7_tp6</title>
<polygon fill="none" stroke="black" points="12315.42,-10753.43 12007.42,-10753.43 12007.42,-10700.43 12315.42,-10700.43 12315.42,-10753.43"/>
<text text-anchor="middle" x="12161.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="12161.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12161.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp6&#45;&gt;Expert27_s0_l7_tp6 -->
<g id="edge1012" class="edge">
<title>Gate_s0_l7_tp6&#45;&gt;Expert27_s0_l7_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11678.47,-10794.94C11769.97,-10783.81 11885.22,-10769.3 11996.9,-10753.63"/>
<polygon fill="black" stroke="black" points="11997.59,-10757.07 12007.01,-10752.21 11996.62,-10750.14 11997.59,-10757.07"/>
</g>
<!-- Expert28_s0_l7_tp7 -->
<g id="node626" class="node">
<title>Expert28_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="10033.42,-10753.43 9725.42,-10753.43 9725.42,-10700.43 10033.42,-10700.43 10033.42,-10753.43"/>
<text text-anchor="middle" x="9879.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="9879.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9879.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp7&#45;&gt;Expert28_s0_l7_tp7 -->
<g id="edge1013" class="edge">
<title>Gate_s0_l7_tp7&#45;&gt;Expert28_s0_l7_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10109.81,-10789.42C10070.59,-10778.95 10025.04,-10766.79 9984.85,-10756.07"/>
<polygon fill="black" stroke="black" points="9985.59,-10752.64 9975.03,-10753.45 9983.79,-10759.41 9985.59,-10752.64"/>
</g>
<!-- Expert29_s0_l7_tp7 -->
<g id="node627" class="node">
<title>Expert29_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="10359.42,-10753.43 10051.42,-10753.43 10051.42,-10700.43 10359.42,-10700.43 10359.42,-10753.43"/>
<text text-anchor="middle" x="10205.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="10205.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10205.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp7&#45;&gt;Expert29_s0_l7_tp7 -->
<g id="edge1014" class="edge">
<title>Gate_s0_l7_tp7&#45;&gt;Expert29_s0_l7_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10205.42,-10789.3C10205.42,-10781.32 10205.42,-10772.37 10205.42,-10763.82"/>
<polygon fill="black" stroke="black" points="10208.92,-10763.68 10205.42,-10753.68 10201.92,-10763.68 10208.92,-10763.68"/>
</g>
<!-- Expert30_s0_l7_tp7 -->
<g id="node628" class="node">
<title>Expert30_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="10685.42,-10753.43 10377.42,-10753.43 10377.42,-10700.43 10685.42,-10700.43 10685.42,-10753.43"/>
<text text-anchor="middle" x="10531.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="10531.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10531.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp7&#45;&gt;Expert30_s0_l7_tp7 -->
<g id="edge1015" class="edge">
<title>Gate_s0_l7_tp7&#45;&gt;Expert30_s0_l7_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10301.03,-10789.42C10340.26,-10778.95 10385.8,-10766.79 10425.99,-10756.07"/>
<polygon fill="black" stroke="black" points="10427.06,-10759.41 10435.82,-10753.45 10425.25,-10752.64 10427.06,-10759.41"/>
</g>
<!-- Expert31_s0_l7_tp7 -->
<g id="node629" class="node">
<title>Expert31_s0_l7_tp7</title>
<polygon fill="none" stroke="black" points="11011.42,-10753.43 10703.42,-10753.43 10703.42,-10700.43 11011.42,-10700.43 11011.42,-10753.43"/>
<text text-anchor="middle" x="10857.42" y="-10738.23" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="10857.42" y="-10723.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10857.42" y="-10708.23" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l7_tp7&#45;&gt;Expert31_s0_l7_tp7 -->
<g id="edge1016" class="edge">
<title>Gate_s0_l7_tp7&#45;&gt;Expert31_s0_l7_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10374.47,-10794.94C10465.97,-10783.81 10581.22,-10769.3 10692.9,-10753.63"/>
<polygon fill="black" stroke="black" points="10693.59,-10757.07 10703.01,-10752.21 10692.62,-10750.14 10693.59,-10757.07"/>
</g>
<!-- AR_exp_s0_l7 -->
<g id="node630" class="node">
<title>AR_exp_s0_l7</title>
<ellipse fill="none" stroke="black" cx="7075.42" cy="-10626.96" rx="239" ry="37.45"/>
<text text-anchor="middle" x="7075.42" y="-10638.26" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="7075.42" y="-10623.26" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="7075.42" y="-10608.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l7_tp0&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1017" class="edge">
<title>Expert0_s0_l7_tp0&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M6738.34,-10700.38C6796.08,-10687.98 6866.04,-10672.95 6927.22,-10659.8"/>
<polygon fill="black" stroke="black" points="6928.31,-10663.14 6937.35,-10657.62 6926.84,-10656.3 6928.31,-10663.14"/>
</g>
<!-- Expert1_s0_l7_tp0&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1018" class="edge">
<title>Expert1_s0_l7_tp0&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M6979.58,-10700.19C6991.79,-10690.99 7005.89,-10680.36 7019.46,-10670.14"/>
<polygon fill="black" stroke="black" points="7021.93,-10672.65 7027.81,-10663.84 7017.72,-10667.06 7021.93,-10672.65"/>
</g>
<!-- Expert2_s0_l7_tp0&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1019" class="edge">
<title>Expert2_s0_l7_tp0&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M6121.81,-10701.46C6124.71,-10701.11 6127.58,-10700.76 6130.42,-10700.43 6372.08,-10672.31 6649.82,-10652.49 6841.35,-10640.77"/>
<polygon fill="black" stroke="black" points="6841.78,-10644.25 6851.55,-10640.15 6841.36,-10637.27 6841.78,-10644.25"/>
</g>
<!-- Expert3_s0_l7_tp0&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1020" class="edge">
<title>Expert3_s0_l7_tp0&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M6447.83,-10701.62C6450.72,-10701.22 6453.58,-10700.82 6456.42,-10700.43 6594.32,-10681.58 6749.92,-10663.37 6870.62,-10649.93"/>
<polygon fill="black" stroke="black" points="6871.17,-10653.39 6880.72,-10648.8 6870.39,-10646.43 6871.17,-10653.39"/>
</g>
<!-- Expert4_s0_l7_tp1&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1021" class="edge">
<title>Expert4_s0_l7_tp1&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M4165.79,-10701.26C4168.69,-10700.97 4171.57,-10700.69 4174.42,-10700.43 4685.84,-10654.24 6222.22,-10635.66 6826.97,-10630"/>
<polygon fill="black" stroke="black" points="6827.16,-10633.5 6837.13,-10629.91 6827.09,-10626.5 6827.16,-10633.5"/>
</g>
<!-- Expert5_s0_l7_tp1&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1022" class="edge">
<title>Expert5_s0_l7_tp1&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M4491.79,-10701.27C4494.69,-10700.98 4497.57,-10700.7 4500.42,-10700.43 4946.79,-10659.4 6272.95,-10638.19 6827.41,-10630.92"/>
<polygon fill="black" stroke="black" points="6827.58,-10634.42 6837.54,-10630.78 6827.49,-10627.42 6827.58,-10634.42"/>
</g>
<!-- Expert6_s0_l7_tp1&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1023" class="edge">
<title>Expert6_s0_l7_tp1&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M3513.79,-10701.24C3516.69,-10700.95 3519.57,-10700.68 3522.42,-10700.43 4165.07,-10643.87 6128.83,-10631.35 6826.37,-10628.67"/>
<polygon fill="black" stroke="black" points="6826.55,-10632.17 6836.54,-10628.63 6826.53,-10625.17 6826.55,-10632.17"/>
</g>
<!-- Expert7_s0_l7_tp1&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1024" class="edge">
<title>Expert7_s0_l7_tp1&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M3839.79,-10701.25C3842.69,-10700.96 3845.57,-10700.69 3848.42,-10700.43 4425.2,-10649.07 6173.8,-10633.4 6826.34,-10629.27"/>
<polygon fill="black" stroke="black" points="6826.83,-10632.77 6836.81,-10629.21 6826.79,-10625.77 6826.83,-10632.77"/>
</g>
<!-- Expert8_s0_l7_tp2&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1025" class="edge">
<title>Expert8_s0_l7_tp2&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M5795.81,-10701.39C5798.7,-10701.05 5801.57,-10700.74 5804.42,-10700.43 6160.37,-10662.53 6574.66,-10643.58 6831,-10634.77"/>
<polygon fill="black" stroke="black" points="6831.31,-10638.26 6841.19,-10634.42 6831.08,-10631.26 6831.31,-10638.26"/>
</g>
<!-- Expert9_s0_l7_tp2&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1026" class="edge">
<title>Expert9_s0_l7_tp2&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M4817.8,-10701.29C4820.69,-10700.99 4823.57,-10700.7 4826.42,-10700.43 5208.24,-10664.55 6327.24,-10641.08 6828.1,-10632.08"/>
<polygon fill="black" stroke="black" points="6828.42,-10635.58 6838.35,-10631.9 6828.29,-10628.58 6828.42,-10635.58"/>
</g>
<!-- Expert10_s0_l7_tp2&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1027" class="edge">
<title>Expert10_s0_l7_tp2&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M5143.8,-10701.31C5146.69,-10701 5149.57,-10700.71 5152.42,-10700.43 5751.21,-10642.51 6459.03,-10630.22 6826.26,-10628.02"/>
<polygon fill="black" stroke="black" points="6826.51,-10631.51 6836.49,-10627.96 6826.47,-10624.51 6826.51,-10631.51"/>
</g>
<!-- Expert11_s0_l7_tp2&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1028" class="edge">
<title>Expert11_s0_l7_tp2&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M5469.8,-10701.34C5472.7,-10701.02 5475.57,-10700.72 5478.42,-10700.43 5954.1,-10652.58 6512.69,-10636.31 6827.24,-10630.79"/>
<polygon fill="black" stroke="black" points="6827.47,-10634.28 6837.4,-10630.61 6827.35,-10627.28 6827.47,-10634.28"/>
</g>
<!-- Expert12_s0_l7_tp3&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1029" class="edge">
<title>Expert12_s0_l7_tp3&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M7220.18,-10700.32C7200.04,-10690.25 7176.47,-10678.47 7154.26,-10667.36"/>
<polygon fill="black" stroke="black" points="7155.68,-10664.16 7145.17,-10662.82 7152.55,-10670.42 7155.68,-10664.16"/>
</g>
<!-- Expert13_s0_l7_tp3&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1030" class="edge">
<title>Expert13_s0_l7_tp3&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M7461.3,-10700.38C7392.2,-10687.41 7307.82,-10671.58 7235.61,-10658.02"/>
<polygon fill="black" stroke="black" points="7235.98,-10654.53 7225.51,-10656.13 7234.69,-10661.41 7235.98,-10654.53"/>
</g>
<!-- Expert14_s0_l7_tp3&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1031" class="edge">
<title>Expert14_s0_l7_tp3&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M7769.02,-10701.58C7766.13,-10701.19 7763.26,-10700.81 7760.42,-10700.43 7602.67,-10679.76 7423.87,-10661 7288.51,-10647.75"/>
<polygon fill="black" stroke="black" points="7288.72,-10644.25 7278.43,-10646.76 7288.04,-10651.22 7288.72,-10644.25"/>
</g>
<!-- Expert15_s0_l7_tp3&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1032" class="edge">
<title>Expert15_s0_l7_tp3&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M8095.03,-10701.44C8092.14,-10701.09 8089.27,-10700.76 8086.42,-10700.43 7822.15,-10670.34 7517.51,-10650.52 7312.29,-10639.33"/>
<polygon fill="black" stroke="black" points="7312.46,-10635.83 7302.29,-10638.78 7312.08,-10642.82 7312.46,-10635.83"/>
</g>
<!-- Expert16_s0_l7_tp4&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1033" class="edge">
<title>Expert16_s0_l7_tp4&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M8421.04,-10701.38C8418.15,-10701.05 8415.27,-10700.73 8412.42,-10700.43 8032.67,-10660.54 7589.79,-10642 7321.14,-10633.84"/>
<polygon fill="black" stroke="black" points="7320.97,-10630.33 7310.87,-10633.53 7320.76,-10637.33 7320.97,-10630.33"/>
</g>
<!-- Expert17_s0_l7_tp4&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1034" class="edge">
<title>Expert17_s0_l7_tp4&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M8747.04,-10701.33C8744.15,-10701.02 8741.27,-10700.72 8738.42,-10700.43 8238.03,-10650.55 7649.55,-10634.99 7323.92,-10630.15"/>
<polygon fill="black" stroke="black" points="7323.94,-10626.65 7313.89,-10630 7323.83,-10633.64 7323.94,-10626.65"/>
</g>
<!-- Expert18_s0_l7_tp4&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1035" class="edge">
<title>Expert18_s0_l7_tp4&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M9073.05,-10701.31C9070.15,-10701 9067.27,-10700.71 9064.42,-10700.43 8440.45,-10640.47 7702.02,-10629.1 7324.68,-10627.56"/>
<polygon fill="black" stroke="black" points="7324.47,-10624.06 7314.45,-10627.52 7324.44,-10631.06 7324.47,-10624.06"/>
</g>
<!-- Expert19_s0_l7_tp4&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1036" class="edge">
<title>Expert19_s0_l7_tp4&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M9399.05,-10701.29C9396.15,-10700.98 9393.27,-10700.7 9390.42,-10700.43 8995.56,-10663.51 7834.77,-10640.46 7322.82,-10631.82"/>
<polygon fill="black" stroke="black" points="7322.77,-10628.32 7312.71,-10631.65 7322.65,-10635.32 7322.77,-10628.32"/>
</g>
<!-- Expert20_s0_l7_tp5&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1037" class="edge">
<title>Expert20_s0_l7_tp5&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M2209.79,-10701.22C2212.69,-10700.94 2215.57,-10700.68 2218.42,-10700.43 2678.03,-10661.25 5899.69,-10636.1 6826.54,-10629.62"/>
<polygon fill="black" stroke="black" points="6826.69,-10633.12 6836.66,-10629.55 6826.64,-10626.12 6826.69,-10633.12"/>
</g>
<!-- Expert21_s0_l7_tp5&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1038" class="edge">
<title>Expert21_s0_l7_tp5&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M2535.79,-10701.23C2538.69,-10700.94 2541.57,-10700.68 2544.42,-10700.43 3386.13,-10628.22 6004.39,-10626.16 6826.1,-10627.37"/>
<polygon fill="black" stroke="black" points="6826.27,-10630.87 6836.28,-10627.39 6826.28,-10623.87 6826.27,-10630.87"/>
</g>
<!-- Expert22_s0_l7_tp5&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1039" class="edge">
<title>Expert22_s0_l7_tp5&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M2861.79,-10701.23C2864.69,-10700.95 2867.57,-10700.68 2870.42,-10700.43 3645.47,-10633.45 6043.74,-10627.76 6825.94,-10627.74"/>
<polygon fill="black" stroke="black" points="6826.2,-10631.24 6836.2,-10627.74 6826.2,-10624.24 6826.2,-10631.24"/>
</g>
<!-- Expert23_s0_l7_tp5&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1040" class="edge">
<title>Expert23_s0_l7_tp5&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M3187.79,-10701.24C3190.69,-10700.95 3193.57,-10700.68 3196.42,-10700.43 3905.13,-10638.67 6085.28,-10629.49 6826.08,-10628.16"/>
<polygon fill="black" stroke="black" points="6826.35,-10631.66 6836.34,-10628.15 6826.34,-10624.66 6826.35,-10631.66"/>
</g>
<!-- Expert24_s0_l7_tp6&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1041" class="edge">
<title>Expert24_s0_l7_tp6&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M11029.05,-10701.23C11026.16,-10700.95 11023.28,-10700.68 11020.42,-10700.43 10298.29,-10637.61 8074.02,-10629.13 7324.75,-10628.07"/>
<polygon fill="black" stroke="black" points="7324.65,-10624.57 7314.64,-10628.06 7324.64,-10631.57 7324.65,-10624.57"/>
</g>
<!-- Expert25_s0_l7_tp6&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1042" class="edge">
<title>Expert25_s0_l7_tp6&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M11355.05,-10701.23C11352.16,-10700.95 11349.28,-10700.68 11346.42,-10700.43 10557.85,-10632.39 8114.87,-10627.43 7324.72,-10627.66"/>
<polygon fill="black" stroke="black" points="7324.64,-10624.16 7314.64,-10627.66 7324.64,-10631.16 7324.64,-10624.16"/>
</g>
<!-- Expert26_s0_l7_tp6&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1043" class="edge">
<title>Expert26_s0_l7_tp6&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M11681.05,-10701.22C11678.16,-10700.94 11675.28,-10700.68 11672.42,-10700.43 10817.21,-10627.16 8154.35,-10625.85 7324.77,-10627.3"/>
<polygon fill="black" stroke="black" points="7324.49,-10623.8 7314.49,-10627.32 7324.5,-10630.8 7324.49,-10623.8"/>
</g>
<!-- Expert27_s0_l7_tp6&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1044" class="edge">
<title>Expert27_s0_l7_tp6&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M12007.06,-10701.22C12004.16,-10700.94 12001.28,-10700.68 11998.42,-10700.43 11531.97,-10660.71 8258.76,-10635.9 7324.09,-10629.57"/>
<polygon fill="black" stroke="black" points="7323.91,-10626.06 7313.88,-10629.5 7323.86,-10633.06 7323.91,-10626.06"/>
</g>
<!-- Expert28_s0_l7_tp7&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1045" class="edge">
<title>Expert28_s0_l7_tp7&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M9725.05,-10701.27C9722.15,-10700.97 9719.27,-10700.69 9716.42,-10700.43 9256.98,-10658.36 7888.75,-10637.66 7323.74,-10630.72"/>
<polygon fill="black" stroke="black" points="7323.47,-10627.21 7313.43,-10630.59 7323.38,-10634.21 7323.47,-10627.21"/>
</g>
<!-- Expert29_s0_l7_tp7&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1046" class="edge">
<title>Expert29_s0_l7_tp7&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M10051.05,-10701.26C10048.15,-10700.97 10045.28,-10700.69 10042.42,-10700.43 9517.85,-10653.2 7938.92,-10635.18 7324.18,-10629.84"/>
<polygon fill="black" stroke="black" points="7323.88,-10626.34 7313.85,-10629.75 7323.82,-10633.34 7323.88,-10626.34"/>
</g>
<!-- Expert30_s0_l7_tp7&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1047" class="edge">
<title>Expert30_s0_l7_tp7&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M10377.05,-10701.25C10374.15,-10700.96 10371.28,-10700.69 10368.42,-10700.43 9778.28,-10648.01 7986.01,-10632.97 7324.33,-10629.14"/>
<polygon fill="black" stroke="black" points="7324.21,-10625.64 7314.19,-10629.08 7324.17,-10632.64 7324.21,-10625.64"/>
</g>
<!-- Expert31_s0_l7_tp7&#45;&gt;AR_exp_s0_l7 -->
<g id="edge1048" class="edge">
<title>Expert31_s0_l7_tp7&#45;&gt;AR_exp_s0_l7</title>
<path fill="none" stroke="black" d="M10703.05,-10701.24C10700.15,-10700.95 10697.28,-10700.68 10694.42,-10700.43 10038.39,-10642.81 8030.77,-10630.96 7324.43,-10628.56"/>
<polygon fill="black" stroke="black" points="7324.39,-10625.06 7314.38,-10628.52 7324.37,-10632.06 7324.39,-10625.06"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp0 -->
<g id="edge1049" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp0</title>
<path fill="none" stroke="black" d="M7021.26,-10590.29C7006.49,-10580.56 6990.11,-10569.77 6973.99,-10559.15"/>
<polygon fill="black" stroke="black" points="6975.87,-10556.2 6965.59,-10553.62 6972.02,-10562.05 6975.87,-10556.2"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp1 -->
<g id="edge1051" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp1</title>
<path fill="none" stroke="black" d="M6846.41,-10616.05C6528.44,-10602.27 5935.2,-10576.39 5429.42,-10553.48 5156.53,-10541.12 4846.16,-10526.64 4621.96,-10516.1"/>
<polygon fill="black" stroke="black" points="4621.84,-10512.59 4611.69,-10515.62 4621.51,-10519.58 4621.84,-10512.59"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp2 -->
<g id="edge1053" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp2</title>
<path fill="none" stroke="black" d="M6874.68,-10606.54C6673.33,-10587.07 6359.71,-10556.73 6121.11,-10533.66"/>
<polygon fill="black" stroke="black" points="6121.17,-10530.15 6110.88,-10532.67 6120.49,-10537.11 6121.17,-10530.15"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp3 -->
<g id="edge1055" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp3</title>
<path fill="none" stroke="black" d="M7225.19,-10597.71C7307.57,-10582.17 7411.57,-10562.56 7504.15,-10545.1"/>
<polygon fill="black" stroke="black" points="7505.04,-10548.49 7514.22,-10543.2 7503.75,-10541.61 7505.04,-10548.49"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp4 -->
<g id="edge1057" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp4</title>
<path fill="none" stroke="black" d="M7303.04,-10615.45C7797.78,-10592.62 8969.28,-10538.55 9501.24,-10514"/>
<polygon fill="black" stroke="black" points="9501.53,-10517.49 9511.36,-10513.53 9501.21,-10510.49 9501.53,-10517.49"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp5 -->
<g id="edge1059" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp5</title>
<path fill="none" stroke="black" d="M6839.45,-10620.84C6318.61,-10609.48 5031.29,-10580.95 3953.42,-10553.48 3398.65,-10539.34 2751.54,-10520.97 2381.21,-10510.27"/>
<polygon fill="black" stroke="black" points="2381.25,-10506.77 2371.15,-10509.98 2381.05,-10513.77 2381.25,-10506.77"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp6 -->
<g id="edge1061" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp6</title>
<path fill="none" stroke="black" d="M7313.78,-10623.92C8111.16,-10616.81 10681.69,-10591.45 11509.42,-10553.48 11652.34,-10546.92 11811.64,-10535.19 11941.04,-10524.53"/>
<polygon fill="black" stroke="black" points="11941.41,-10528.01 11951.09,-10523.69 11940.84,-10521.03 11941.41,-10528.01"/>
</g>
<!-- AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp7 -->
<g id="edge1063" class="edge">
<title>AR_exp_s0_l7&#45;&gt;ResMOE_s0_l7_tp7</title>
<path fill="none" stroke="black" d="M7312.75,-10622.53C7826.71,-10614.63 9081.03,-10592.73 10131.42,-10553.48 10386.68,-10543.94 10677.69,-10528.65 10883.19,-10517.11"/>
<polygon fill="black" stroke="black" points="10883.43,-10520.6 10893.21,-10516.55 10883.03,-10513.62 10883.43,-10520.6"/>
</g>
<!-- QKV_s0_l8_tp0 -->
<g id="node639" class="node">
<title>QKV_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6105.42,-10411.48 5767.42,-10411.48 5767.42,-10358.48 6105.42,-10358.48 6105.42,-10411.48"/>
<text text-anchor="middle" x="5936.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5936.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5936.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp0 -->
<g id="edge1065" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6552.56,-10459.74C6425.98,-10444.66 6280.54,-10427.3 6148.42,-10411.48 6137.78,-10410.21 6126.85,-10408.89 6115.81,-10407.57"/>
<polygon fill="black" stroke="black" points="6116,-10404.07 6105.65,-10406.35 6115.17,-10411.02 6116,-10404.07"/>
</g>
<!-- QKV_s0_l8_tp1 -->
<g id="node640" class="node">
<title>QKV_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="6495.42,-10411.48 6157.42,-10411.48 6157.42,-10358.48 6495.42,-10358.48 6495.42,-10411.48"/>
<text text-anchor="middle" x="6326.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6326.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6326.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp1 -->
<g id="edge1066" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6629.78,-10447.46C6572.04,-10435.76 6512.98,-10423.79 6462.49,-10413.56"/>
<polygon fill="black" stroke="black" points="6463,-10410.09 6452.51,-10411.53 6461.61,-10416.95 6463,-10410.09"/>
</g>
<!-- QKV_s0_l8_tp2 -->
<g id="node641" class="node">
<title>QKV_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="6876.42,-10411.48 6538.42,-10411.48 6538.42,-10358.48 6876.42,-10358.48 6876.42,-10411.48"/>
<text text-anchor="middle" x="6707.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6707.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6707.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp2 -->
<g id="edge1067" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6804.26,-10447.38C6787.82,-10436.96 6771.04,-10426.32 6756.18,-10416.89"/>
<polygon fill="black" stroke="black" points="6757.98,-10413.89 6747.66,-10411.49 6754.23,-10419.8 6757.98,-10413.89"/>
</g>
<!-- QKV_s0_l8_tp3 -->
<g id="node642" class="node">
<title>QKV_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7241.42,-10411.48 6903.42,-10411.48 6903.42,-10358.48 7241.42,-10358.48 7241.42,-10411.48"/>
<text text-anchor="middle" x="7072.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7072.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7072.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp3 -->
<g id="edge1068" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M6971.8,-10447.38C6988.89,-10436.96 7006.31,-10426.32 7021.76,-10416.89"/>
<polygon fill="black" stroke="black" points="7023.9,-10419.69 7030.61,-10411.49 7020.25,-10413.71 7023.9,-10419.69"/>
</g>
<!-- QKV_s0_l8_tp4 -->
<g id="node643" class="node">
<title>QKV_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="7622.42,-10411.48 7284.42,-10411.48 7284.42,-10358.48 7622.42,-10358.48 7622.42,-10411.48"/>
<text text-anchor="middle" x="7453.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7453.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7453.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp4 -->
<g id="edge1069" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7104.83,-10455.76C7175.75,-10441.56 7252.42,-10426.22 7315.74,-10413.54"/>
<polygon fill="black" stroke="black" points="7316.67,-10416.92 7325.79,-10411.53 7315.3,-10410.06 7316.67,-10416.92"/>
</g>
<!-- QKV_s0_l8_tp5 -->
<g id="node644" class="node">
<title>QKV_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="8008.42,-10411.48 7670.42,-10411.48 7670.42,-10358.48 8008.42,-10358.48 8008.42,-10411.48"/>
<text text-anchor="middle" x="7839.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7839.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7839.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp5 -->
<g id="edge1070" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M7125.93,-10471.46C7272.01,-10454.3 7462.52,-10431.81 7631.42,-10411.48 7640.81,-10410.35 7650.43,-10409.19 7660.14,-10408.01"/>
<polygon fill="black" stroke="black" points="7660.78,-10411.46 7670.29,-10406.78 7659.94,-10404.51 7660.78,-10411.46"/>
</g>
<!-- QKV_s0_l8_tp6 -->
<g id="node645" class="node">
<title>QKV_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="8396.42,-10411.48 8058.42,-10411.48 8058.42,-10358.48 8396.42,-10358.48 8396.42,-10411.48"/>
<text text-anchor="middle" x="8227.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8227.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8227.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp6 -->
<g id="edge1071" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M7126.39,-10471.61C7205.89,-10463.02 7294.89,-10454.09 7376.42,-10447.48 7660.83,-10424.42 7733.2,-10436.69 8017.42,-10411.48 8027.47,-10410.59 8037.78,-10409.59 8048.18,-10408.53"/>
<polygon fill="black" stroke="black" points="8048.59,-10412.01 8058.18,-10407.49 8047.87,-10405.04 8048.59,-10412.01"/>
</g>
<!-- QKV_s0_l8_tp7 -->
<g id="node646" class="node">
<title>QKV_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="5723.42,-10411.48 5385.42,-10411.48 5385.42,-10358.48 5723.42,-10358.48 5723.42,-10411.48"/>
<text text-anchor="middle" x="5554.42" y="-10396.28" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5554.42" y="-10381.28" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5554.42" y="-10366.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp7 -->
<g id="edge1072" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;QKV_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M6579.07,-10479.38C6352.08,-10463.59 6035.68,-10439.61 5758.42,-10411.48 5750.34,-10410.66 5742.09,-10409.78 5733.76,-10408.87"/>
<polygon fill="black" stroke="black" points="5733.88,-10405.36 5723.56,-10407.74 5733.11,-10412.32 5733.88,-10405.36"/>
</g>
<!-- ResAttn_s0_l8_tp0 -->
<g id="node673" class="node">
<title>ResAttn_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6282.77,-9833.57 5725.45,-9833.57 5582.08,-9727.57 6139.4,-9727.57 6282.77,-9833.57"/>
<text text-anchor="middle" x="5932.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5932.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5932.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp0 -->
<g id="edge1114" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6574.15,-10475.87C6442.48,-10466.34 6287.53,-10455.68 6147.42,-10447.48 6061.81,-10442.47 5448.9,-10457.32 5376.42,-10411.48 5327.69,-10380.66 5315.42,-10354.64 5315.42,-10296.98 5315.42,-10296.98 5315.42,-10296.98 5315.42,-9995.05 5315.42,-9911.59 5519.6,-9853.51 5693.05,-9819.22"/>
<polygon fill="black" stroke="black" points="5693.97,-9822.61 5703.11,-9817.25 5692.63,-9815.74 5693.97,-9822.61"/>
</g>
<!-- ResAttn_s0_l8_tp1 -->
<g id="node674" class="node">
<title>ResAttn_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="4423.77,-9833.57 3866.45,-9833.57 3723.08,-9727.57 4280.4,-9727.57 4423.77,-9833.57"/>
<text text-anchor="middle" x="4073.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4073.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4073.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp1 -->
<g id="edge1116" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6572.4,-10474.55C6441.13,-10464.87 6286.96,-10454.45 6147.42,-10447.48 5606.97,-10420.48 5468.71,-10466.85 4930.42,-10411.48 4785.39,-10396.56 4284.42,-10442.77 4284.42,-10296.98 4284.42,-10296.98 4284.42,-10296.98 4284.42,-9995.05 4284.42,-9929.02 4232.72,-9876.05 4180.5,-9839.39"/>
<polygon fill="black" stroke="black" points="4182.35,-9836.42 4172.13,-9833.65 4178.4,-9842.19 4182.35,-9836.42"/>
</g>
<!-- ResAttn_s0_l8_tp2 -->
<g id="node675" class="node">
<title>ResAttn_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5271.77,-9833.57 4714.45,-9833.57 4571.08,-9727.57 5128.4,-9727.57 5271.77,-9833.57"/>
<text text-anchor="middle" x="4921.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4921.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4921.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp2 -->
<g id="edge1118" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6574.16,-10475.66C6442.49,-10466.09 6287.55,-10455.47 6147.42,-10447.48 5781,-10426.6 5684.7,-10470.27 5322.42,-10411.48 5139.47,-10381.79 4921.42,-10482.32 4921.42,-10296.98 4921.42,-10296.98 4921.42,-10296.98 4921.42,-9995.05 4921.42,-9944.21 4921.42,-9886.55 4921.42,-9843.98"/>
<polygon fill="black" stroke="black" points="4924.92,-9843.77 4921.42,-9833.77 4917.92,-9843.77 4924.92,-9843.77"/>
</g>
<!-- ResAttn_s0_l8_tp3 -->
<g id="node676" class="node">
<title>ResAttn_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="8352.77,-9833.57 7795.45,-9833.57 7652.08,-9727.57 8209.4,-9727.57 8352.77,-9833.57"/>
<text text-anchor="middle" x="8002.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8002.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8002.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp3 -->
<g id="edge1120" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7125.07,-10470.73C7204.88,-10462.03 7294.39,-10453.26 7376.42,-10447.48 7433.48,-10443.46 8356.21,-10440.64 8405.42,-10411.48 8456.34,-10381.31 8473.42,-10356.17 8473.42,-10296.98 8473.42,-10296.98 8473.42,-10296.98 8473.42,-9995.05 8473.42,-9918.58 8421.28,-9869.36 8351.7,-9837.73"/>
<polygon fill="black" stroke="black" points="8352.79,-9834.39 8342.22,-9833.58 8349.98,-9840.8 8352.79,-9834.39"/>
</g>
<!-- ResAttn_s0_l8_tp4 -->
<g id="node677" class="node">
<title>ResAttn_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="9217.77,-9833.57 8660.45,-9833.57 8517.08,-9727.57 9074.4,-9727.57 9217.77,-9833.57"/>
<text text-anchor="middle" x="8867.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8867.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8867.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp4 -->
<g id="edge1122" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7125.07,-10470.67C7204.88,-10461.96 7294.39,-10453.2 7376.42,-10447.48 7542.53,-10435.89 8867.42,-10463.49 8867.42,-10296.98 8867.42,-10296.98 8867.42,-10296.98 8867.42,-9995.05 8867.42,-9944.21 8867.42,-9886.55 8867.42,-9843.98"/>
<polygon fill="black" stroke="black" points="8870.92,-9843.77 8867.42,-9833.77 8863.92,-9843.77 8870.92,-9843.77"/>
</g>
<!-- ResAttn_s0_l8_tp5 -->
<g id="node678" class="node">
<title>ResAttn_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="3282.77,-9833.57 2725.45,-9833.57 2582.08,-9727.57 3139.4,-9727.57 3282.77,-9833.57"/>
<text text-anchor="middle" x="2932.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2932.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2932.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp5 -->
<g id="edge1124" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M6571.52,-10473.8C6440.46,-10464.03 6286.67,-10453.75 6147.42,-10447.48 5337.86,-10411.03 5131.73,-10482.01 4324.42,-10411.48 4159.75,-10397.09 3589.42,-10462.28 3589.42,-10296.98 3589.42,-10296.98 3589.42,-10296.98 3589.42,-9995.05 3589.42,-9921.92 3440.34,-9870.02 3284.21,-9835.72"/>
<polygon fill="black" stroke="black" points="3284.91,-9832.29 3274.39,-9833.59 3283.42,-9839.13 3284.91,-9832.29"/>
</g>
<!-- ResAttn_s0_l8_tp6 -->
<g id="node679" class="node">
<title>ResAttn_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="11360.77,-9833.57 10803.45,-9833.57 10660.08,-9727.57 11217.4,-9727.57 11360.77,-9833.57"/>
<text text-anchor="middle" x="11010.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11010.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11010.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp6 -->
<g id="edge1126" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M7124.09,-10470.17C7204.13,-10461.39 7294.04,-10452.71 7376.42,-10447.48 8130.18,-10399.58 8322.42,-10470.11 9075.42,-10411.48 9265,-10396.72 9923.42,-10487.13 9923.42,-10296.98 9923.42,-10296.98 9923.42,-10296.98 9923.42,-9995.05 9923.42,-9910.71 10433.75,-9841.73 10755.06,-9806.65"/>
<polygon fill="black" stroke="black" points="10755.9,-9810.08 10765.46,-9805.52 10755.14,-9803.12 10755.9,-9810.08"/>
</g>
<!-- ResAttn_s0_l8_tp7 -->
<g id="node680" class="node">
<title>ResAttn_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="10211.77,-9833.57 9654.45,-9833.57 9511.08,-9727.57 10068.4,-9727.57 10211.77,-9833.57"/>
<text text-anchor="middle" x="9861.42" y="-9791.87" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9861.42" y="-9776.87" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9861.42" y="-9761.87" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp7 -->
<g id="edge1128" class="edge">
<title>ResMOE_s0_l7_tp0&#45;&gt;ResAttn_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M7124.74,-10470.44C7204.62,-10461.7 7294.27,-10452.99 7376.42,-10447.48 7943.38,-10409.47 8088.06,-10457.47 8654.42,-10411.48 8844.39,-10396.05 9504.42,-10487.57 9504.42,-10296.98 9504.42,-10296.98 9504.42,-10296.98 9504.42,-9995.05 9504.42,-9917.14 9567.83,-9866.98 9641.19,-9835.02"/>
<polygon fill="black" stroke="black" points="9642.81,-9838.14 9650.66,-9831.02 9640.08,-9831.69 9642.81,-9838.14"/>
</g>
<!-- SplitHeads_s0_l8_tp0 -->
<g id="node647" class="node">
<title>SplitHeads_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6105.42,-10322.48 5733.42,-10322.48 5733.42,-10269.48 6105.42,-10269.48 6105.42,-10322.48"/>
<text text-anchor="middle" x="5919.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5919.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5919.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp0&#45;&gt;SplitHeads_s0_l8_tp0 -->
<g id="edge1073" class="edge">
<title>QKV_s0_l8_tp0&#45;&gt;SplitHeads_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M5931.41,-10358.35C5929.84,-10350.28 5928.07,-10341.21 5926.38,-10332.58"/>
<polygon fill="black" stroke="black" points="5929.81,-10331.87 5924.45,-10322.73 5922.94,-10333.22 5929.81,-10331.87"/>
</g>
<!-- SplitHeads_s0_l8_tp1 -->
<g id="node648" class="node">
<title>SplitHeads_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="6495.42,-10322.48 6123.42,-10322.48 6123.42,-10269.48 6495.42,-10269.48 6495.42,-10322.48"/>
<text text-anchor="middle" x="6309.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6309.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6309.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp1&#45;&gt;SplitHeads_s0_l8_tp1 -->
<g id="edge1074" class="edge">
<title>QKV_s0_l8_tp1&#45;&gt;SplitHeads_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6321.41,-10358.35C6319.84,-10350.28 6318.07,-10341.21 6316.38,-10332.58"/>
<polygon fill="black" stroke="black" points="6319.81,-10331.87 6314.45,-10322.73 6312.94,-10333.22 6319.81,-10331.87"/>
</g>
<!-- SplitHeads_s0_l8_tp2 -->
<g id="node649" class="node">
<title>SplitHeads_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="6885.42,-10322.48 6513.42,-10322.48 6513.42,-10269.48 6885.42,-10269.48 6885.42,-10322.48"/>
<text text-anchor="middle" x="6699.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6699.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6699.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp2&#45;&gt;SplitHeads_s0_l8_tp2 -->
<g id="edge1075" class="edge">
<title>QKV_s0_l8_tp2&#45;&gt;SplitHeads_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6705.07,-10358.35C6704.33,-10350.37 6703.51,-10341.41 6702.72,-10332.86"/>
<polygon fill="black" stroke="black" points="6706.19,-10332.37 6701.79,-10322.73 6699.22,-10333.01 6706.19,-10332.37"/>
</g>
<!-- SplitHeads_s0_l8_tp3 -->
<g id="node650" class="node">
<title>SplitHeads_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7275.42,-10322.48 6903.42,-10322.48 6903.42,-10269.48 7275.42,-10269.48 7275.42,-10322.48"/>
<text text-anchor="middle" x="7089.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7089.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7089.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp3&#45;&gt;SplitHeads_s0_l8_tp3 -->
<g id="edge1076" class="edge">
<title>QKV_s0_l8_tp3&#45;&gt;SplitHeads_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7077.43,-10358.35C7079.01,-10350.28 7080.78,-10341.21 7082.47,-10332.58"/>
<polygon fill="black" stroke="black" points="7085.91,-10333.22 7084.39,-10322.73 7079.04,-10331.87 7085.91,-10333.22"/>
</g>
<!-- SplitHeads_s0_l8_tp4 -->
<g id="node651" class="node">
<title>SplitHeads_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="7665.42,-10322.48 7293.42,-10322.48 7293.42,-10269.48 7665.42,-10269.48 7665.42,-10322.48"/>
<text text-anchor="middle" x="7479.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7479.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7479.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp4&#45;&gt;SplitHeads_s0_l8_tp4 -->
<g id="edge1077" class="edge">
<title>QKV_s0_l8_tp4&#45;&gt;SplitHeads_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7461.08,-10358.35C7463.49,-10350.28 7466.2,-10341.21 7468.78,-10332.58"/>
<polygon fill="black" stroke="black" points="7472.22,-10333.31 7471.73,-10322.73 7465.51,-10331.31 7472.22,-10333.31"/>
</g>
<!-- SplitHeads_s0_l8_tp5 -->
<g id="node652" class="node">
<title>SplitHeads_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="8055.42,-10322.48 7683.42,-10322.48 7683.42,-10269.48 8055.42,-10269.48 8055.42,-10322.48"/>
<text text-anchor="middle" x="7869.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7869.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7869.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp5&#45;&gt;SplitHeads_s0_l8_tp5 -->
<g id="edge1078" class="edge">
<title>QKV_s0_l8_tp5&#45;&gt;SplitHeads_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M7848.26,-10358.35C7851.07,-10350.19 7854.24,-10341.02 7857.24,-10332.3"/>
<polygon fill="black" stroke="black" points="7860.59,-10333.32 7860.54,-10322.73 7853.97,-10331.04 7860.59,-10333.32"/>
</g>
<!-- SplitHeads_s0_l8_tp6 -->
<g id="node653" class="node">
<title>SplitHeads_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="8445.42,-10322.48 8073.42,-10322.48 8073.42,-10269.48 8445.42,-10269.48 8445.42,-10322.48"/>
<text text-anchor="middle" x="8259.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8259.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8259.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp6&#45;&gt;SplitHeads_s0_l8_tp6 -->
<g id="edge1079" class="edge">
<title>QKV_s0_l8_tp6&#45;&gt;SplitHeads_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M8236.85,-10358.35C8239.85,-10350.19 8243.22,-10341.02 8246.43,-10332.3"/>
<polygon fill="black" stroke="black" points="8249.78,-10333.32 8249.95,-10322.73 8243.21,-10330.91 8249.78,-10333.32"/>
</g>
<!-- SplitHeads_s0_l8_tp7 -->
<g id="node654" class="node">
<title>SplitHeads_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="5715.42,-10322.48 5343.42,-10322.48 5343.42,-10269.48 5715.42,-10269.48 5715.42,-10322.48"/>
<text text-anchor="middle" x="5529.42" y="-10307.28" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5529.42" y="-10292.28" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5529.42" y="-10277.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s0_l8_tp7&#45;&gt;SplitHeads_s0_l8_tp7 -->
<g id="edge1080" class="edge">
<title>QKV_s0_l8_tp7&#45;&gt;SplitHeads_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M5547.06,-10358.35C5544.74,-10350.28 5542.13,-10341.21 5539.65,-10332.58"/>
<polygon fill="black" stroke="black" points="5542.95,-10331.37 5536.82,-10322.73 5536.22,-10333.31 5542.95,-10331.37"/>
</g>
<!-- A2A_s0_l8 -->
<g id="node655" class="node">
<title>A2A_s0_l8</title>
<ellipse fill="none" stroke="black" cx="6894.42" cy="-10196" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6894.42" y="-10207.3" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="6894.42" y="-10192.3" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="6894.42" y="-10177.3" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s0_l8_tp0&#45;&gt;A2A_s0_l8 -->
<g id="edge1081" class="edge">
<title>SplitHeads_s0_l8_tp0&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M6105.45,-10270.5C6108.46,-10270.15 6111.45,-10269.81 6114.42,-10269.48 6297.43,-10249.02 6505.05,-10229.93 6660.05,-10216.48"/>
<polygon fill="black" stroke="black" points="6660.53,-10219.95 6670.19,-10215.6 6659.92,-10212.98 6660.53,-10219.95"/>
</g>
<!-- SplitHeads_s0_l8_tp1&#45;&gt;A2A_s0_l8 -->
<g id="edge1082" class="edge">
<title>SplitHeads_s0_l8_tp1&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M6461.98,-10269.43C6540.22,-10256.33 6635.93,-10240.3 6717.41,-10226.65"/>
<polygon fill="black" stroke="black" points="6717.99,-10230.1 6727.27,-10225 6716.83,-10223.2 6717.99,-10230.1"/>
</g>
<!-- SplitHeads_s0_l8_tp2&#45;&gt;A2A_s0_l8 -->
<g id="edge1083" class="edge">
<title>SplitHeads_s0_l8_tp2&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M6750.4,-10269.37C6770.24,-10259.4 6793.43,-10247.75 6815.33,-10236.74"/>
<polygon fill="black" stroke="black" points="6816.94,-10239.85 6824.3,-10232.23 6813.8,-10233.6 6816.94,-10239.85"/>
</g>
<!-- SplitHeads_s0_l8_tp3&#45;&gt;A2A_s0_l8 -->
<g id="edge1084" class="edge">
<title>SplitHeads_s0_l8_tp3&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M7038.44,-10269.37C7018.61,-10259.4 6995.42,-10247.75 6973.51,-10236.74"/>
<polygon fill="black" stroke="black" points="6975.05,-10233.6 6964.54,-10232.23 6971.91,-10239.85 6975.05,-10233.6"/>
</g>
<!-- SplitHeads_s0_l8_tp4&#45;&gt;A2A_s0_l8 -->
<g id="edge1085" class="edge">
<title>SplitHeads_s0_l8_tp4&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M7326.87,-10269.43C7248.63,-10256.33 7152.91,-10240.3 7071.44,-10226.65"/>
<polygon fill="black" stroke="black" points="7072.02,-10223.2 7061.58,-10225 7070.86,-10230.1 7072.02,-10223.2"/>
</g>
<!-- SplitHeads_s0_l8_tp5&#45;&gt;A2A_s0_l8 -->
<g id="edge1086" class="edge">
<title>SplitHeads_s0_l8_tp5&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M7683.4,-10270.5C7680.39,-10270.15 7677.39,-10269.81 7674.42,-10269.48 7491.42,-10249.02 7283.79,-10229.93 7128.79,-10216.48"/>
<polygon fill="black" stroke="black" points="7128.92,-10212.98 7118.66,-10215.6 7128.32,-10219.95 7128.92,-10212.98"/>
</g>
<!-- SplitHeads_s0_l8_tp6&#45;&gt;A2A_s0_l8 -->
<g id="edge1087" class="edge">
<title>SplitHeads_s0_l8_tp6&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M8073.41,-10270.37C8070.39,-10270.06 8067.4,-10269.77 8064.42,-10269.48 7752.38,-10239.45 7392.25,-10219.32 7154.88,-10208.04"/>
<polygon fill="black" stroke="black" points="7154.88,-10204.54 7144.73,-10207.56 7154.55,-10211.53 7154.88,-10204.54"/>
</g>
<!-- SplitHeads_s0_l8_tp7&#45;&gt;A2A_s0_l8 -->
<g id="edge1088" class="edge">
<title>SplitHeads_s0_l8_tp7&#45;&gt;A2A_s0_l8</title>
<path fill="none" stroke="black" d="M5715.43,-10270.37C5718.45,-10270.06 5721.45,-10269.77 5724.42,-10269.48 6036.47,-10239.45 6396.6,-10219.32 6633.96,-10208.04"/>
<polygon fill="black" stroke="black" points="6634.29,-10211.53 6644.12,-10207.56 6633.96,-10204.54 6634.29,-10211.53"/>
</g>
<!-- Attn_s0_l8_tp0 -->
<g id="node656" class="node">
<title>Attn_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6105.42,-10122.53 5733.42,-10122.53 5733.42,-10069.53 6105.42,-10069.53 6105.42,-10122.53"/>
<text text-anchor="middle" x="5919.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5919.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5919.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp0 -->
<g id="edge1089" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6670.19,-10176.4C6516.85,-10163.15 6308.7,-10144.1 6115.51,-10122.63"/>
<polygon fill="black" stroke="black" points="6115.77,-10119.14 6105.45,-10121.51 6115,-10126.1 6115.77,-10119.14"/>
</g>
<!-- Attn_s0_l8_tp1 -->
<g id="node657" class="node">
<title>Attn_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="6495.42,-10122.53 6123.42,-10122.53 6123.42,-10069.53 6495.42,-10069.53 6495.42,-10122.53"/>
<text text-anchor="middle" x="6309.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6309.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6309.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp1 -->
<g id="edge1090" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6727.18,-10166.99C6647.03,-10153.57 6551.42,-10137.56 6471.9,-10124.24"/>
<polygon fill="black" stroke="black" points="6472.23,-10120.74 6461.79,-10122.54 6471.07,-10127.65 6472.23,-10120.74"/>
</g>
<!-- Attn_s0_l8_tp2 -->
<g id="node658" class="node">
<title>Attn_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="6885.42,-10122.53 6513.42,-10122.53 6513.42,-10069.53 6885.42,-10069.53 6885.42,-10122.53"/>
<text text-anchor="middle" x="6699.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6699.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6699.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp2 -->
<g id="edge1091" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6824.3,-10159.77C6802.99,-10149.06 6779.79,-10137.41 6759.23,-10127.08"/>
<polygon fill="black" stroke="black" points="6760.8,-10123.95 6750.29,-10122.58 6757.65,-10130.2 6760.8,-10123.95"/>
</g>
<!-- Attn_s0_l8_tp3 -->
<g id="node659" class="node">
<title>Attn_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7275.42,-10122.53 6903.42,-10122.53 6903.42,-10069.53 7275.42,-10069.53 7275.42,-10122.53"/>
<text text-anchor="middle" x="7089.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7089.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7089.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp3 -->
<g id="edge1092" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M6964.55,-10159.77C6985.85,-10149.06 7009.06,-10137.41 7029.62,-10127.08"/>
<polygon fill="black" stroke="black" points="7031.19,-10130.2 7038.55,-10122.58 7028.05,-10123.95 7031.19,-10130.2"/>
</g>
<!-- Attn_s0_l8_tp4 -->
<g id="node660" class="node">
<title>Attn_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="7665.42,-10122.53 7293.42,-10122.53 7293.42,-10069.53 7665.42,-10069.53 7665.42,-10122.53"/>
<text text-anchor="middle" x="7479.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7479.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7479.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp4 -->
<g id="edge1093" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7061.67,-10166.99C7141.81,-10153.57 7237.43,-10137.56 7316.95,-10124.24"/>
<polygon fill="black" stroke="black" points="7317.77,-10127.65 7327.06,-10122.54 7316.62,-10120.74 7317.77,-10127.65"/>
</g>
<!-- Attn_s0_l8_tp5 -->
<g id="node661" class="node">
<title>Attn_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="8055.42,-10122.53 7683.42,-10122.53 7683.42,-10069.53 8055.42,-10069.53 8055.42,-10122.53"/>
<text text-anchor="middle" x="7869.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7869.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7869.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp5 -->
<g id="edge1094" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M7118.66,-10176.4C7272,-10163.15 7480.14,-10144.1 7673.34,-10122.63"/>
<polygon fill="black" stroke="black" points="7673.85,-10126.1 7683.4,-10121.51 7673.07,-10119.14 7673.85,-10126.1"/>
</g>
<!-- Attn_s0_l8_tp6 -->
<g id="node662" class="node">
<title>Attn_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="8445.42,-10122.53 8073.42,-10122.53 8073.42,-10069.53 8445.42,-10069.53 8445.42,-10122.53"/>
<text text-anchor="middle" x="8259.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8259.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8259.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp6 -->
<g id="edge1095" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M7144.73,-10184.44C7379.46,-10173.38 7740.4,-10153.41 8063.39,-10122.6"/>
<polygon fill="black" stroke="black" points="8063.79,-10126.08 8073.41,-10121.64 8063.12,-10119.11 8063.79,-10126.08"/>
</g>
<!-- Attn_s0_l8_tp7 -->
<g id="node663" class="node">
<title>Attn_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="5715.42,-10122.53 5343.42,-10122.53 5343.42,-10069.53 5715.42,-10069.53 5715.42,-10122.53"/>
<text text-anchor="middle" x="5529.42" y="-10107.33" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5529.42" y="-10092.33" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5529.42" y="-10077.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s0_l8&#45;&gt;Attn_s0_l8_tp7 -->
<g id="edge1096" class="edge">
<title>A2A_s0_l8&#45;&gt;Attn_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M6644.12,-10184.44C6409.38,-10173.38 6048.44,-10153.41 5725.46,-10122.6"/>
<polygon fill="black" stroke="black" points="5725.72,-10119.11 5715.43,-10121.64 5725.05,-10126.08 5725.72,-10119.11"/>
</g>
<!-- AR_attn_s0_l8 -->
<g id="node664" class="node">
<title>AR_attn_s0_l8</title>
<ellipse fill="none" stroke="black" cx="6894.42" cy="-9996.05" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6894.42" y="-10007.35" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="6894.42" y="-9992.35" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="6894.42" y="-9977.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s0_l8_tp0&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1097" class="edge">
<title>Attn_s0_l8_tp0&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M6105.45,-10070.54C6108.46,-10070.2 6111.45,-10069.86 6114.42,-10069.53 6297.43,-10049.07 6505.05,-10029.97 6660.05,-10016.53"/>
<polygon fill="black" stroke="black" points="6660.53,-10020 6670.19,-10015.65 6659.92,-10013.02 6660.53,-10020"/>
</g>
<!-- Attn_s0_l8_tp1&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1098" class="edge">
<title>Attn_s0_l8_tp1&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M6461.98,-10069.48C6540.22,-10056.37 6635.93,-10040.34 6717.41,-10026.7"/>
<polygon fill="black" stroke="black" points="6717.99,-10030.15 6727.27,-10025.04 6716.83,-10023.24 6717.99,-10030.15"/>
</g>
<!-- Attn_s0_l8_tp2&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1099" class="edge">
<title>Attn_s0_l8_tp2&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M6750.4,-10069.41C6770.24,-10059.45 6793.43,-10047.79 6815.33,-10036.79"/>
<polygon fill="black" stroke="black" points="6816.94,-10039.9 6824.3,-10032.28 6813.8,-10033.64 6816.94,-10039.9"/>
</g>
<!-- Attn_s0_l8_tp3&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1100" class="edge">
<title>Attn_s0_l8_tp3&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M7038.44,-10069.41C7018.61,-10059.45 6995.42,-10047.79 6973.51,-10036.79"/>
<polygon fill="black" stroke="black" points="6975.05,-10033.64 6964.54,-10032.28 6971.91,-10039.9 6975.05,-10033.64"/>
</g>
<!-- Attn_s0_l8_tp4&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1101" class="edge">
<title>Attn_s0_l8_tp4&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M7326.87,-10069.48C7248.63,-10056.37 7152.91,-10040.34 7071.44,-10026.7"/>
<polygon fill="black" stroke="black" points="7072.02,-10023.24 7061.58,-10025.04 7070.86,-10030.15 7072.02,-10023.24"/>
</g>
<!-- Attn_s0_l8_tp5&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1102" class="edge">
<title>Attn_s0_l8_tp5&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M7683.4,-10070.54C7680.39,-10070.2 7677.39,-10069.86 7674.42,-10069.53 7491.42,-10049.07 7283.79,-10029.97 7128.79,-10016.53"/>
<polygon fill="black" stroke="black" points="7128.92,-10013.02 7118.66,-10015.65 7128.32,-10020 7128.92,-10013.02"/>
</g>
<!-- Attn_s0_l8_tp6&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1103" class="edge">
<title>Attn_s0_l8_tp6&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M8073.41,-10070.41C8070.39,-10070.11 8067.4,-10069.81 8064.42,-10069.53 7752.38,-10039.49 7392.25,-10019.36 7154.88,-10008.09"/>
<polygon fill="black" stroke="black" points="7154.88,-10004.59 7144.73,-10007.61 7154.55,-10011.58 7154.88,-10004.59"/>
</g>
<!-- Attn_s0_l8_tp7&#45;&gt;AR_attn_s0_l8 -->
<g id="edge1104" class="edge">
<title>Attn_s0_l8_tp7&#45;&gt;AR_attn_s0_l8</title>
<path fill="none" stroke="black" d="M5715.43,-10070.41C5718.45,-10070.11 5721.45,-10069.81 5724.42,-10069.53 6036.47,-10039.49 6396.6,-10019.36 6633.96,-10008.09"/>
<polygon fill="black" stroke="black" points="6634.29,-10011.58 6644.12,-10007.61 6633.96,-10004.59 6634.29,-10011.58"/>
</g>
<!-- O_s0_l8_tp0 -->
<g id="node665" class="node">
<title>O_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6680.42,-9922.57 6342.42,-9922.57 6342.42,-9869.57 6680.42,-9869.57 6680.42,-9922.57"/>
<text text-anchor="middle" x="6511.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6511.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6511.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp0 -->
<g id="edge1105" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6769.28,-9963.04C6721.4,-9950.79 6667.21,-9936.93 6620.9,-9925.08"/>
<polygon fill="black" stroke="black" points="6621.7,-9921.67 6611.15,-9922.58 6619.97,-9928.45 6621.7,-9921.67"/>
</g>
<!-- O_s0_l8_tp1 -->
<g id="node666" class="node">
<title>O_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="5287.42,-9922.57 4949.42,-9922.57 4949.42,-9869.57 5287.42,-9869.57 5287.42,-9922.57"/>
<text text-anchor="middle" x="5118.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5118.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5118.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp1 -->
<g id="edge1106" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6650.31,-9982.08C6382.45,-9967.78 5939.79,-9943.97 5558.42,-9922.57 5472.7,-9917.76 5377.6,-9912.27 5297.81,-9907.62"/>
<polygon fill="black" stroke="black" points="5297.84,-9904.12 5287.66,-9907.03 5297.44,-9911.1 5297.84,-9904.12"/>
</g>
<!-- O_s0_l8_tp2 -->
<g id="node667" class="node">
<title>O_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5905.42,-9922.57 5567.42,-9922.57 5567.42,-9869.57 5905.42,-9869.57 5905.42,-9922.57"/>
<text text-anchor="middle" x="5736.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5736.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5736.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp2 -->
<g id="edge1107" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6671.15,-9976.16C6451.08,-9957.54 6119.06,-9929.45 5915.65,-9912.24"/>
<polygon fill="black" stroke="black" points="5915.72,-9908.73 5905.46,-9911.38 5915.13,-9915.71 5915.72,-9908.73"/>
</g>
<!-- O_s0_l8_tp3 -->
<g id="node668" class="node">
<title>O_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7468.42,-9922.57 7130.42,-9922.57 7130.42,-9869.57 7468.42,-9869.57 7468.42,-9922.57"/>
<text text-anchor="middle" x="7299.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7299.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7299.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp3 -->
<g id="edge1108" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7025.08,-9963.44C7076.22,-9951.07 7134.4,-9937 7183.97,-9925"/>
<polygon fill="black" stroke="black" points="7184.87,-9928.39 7193.77,-9922.63 7183.22,-9921.58 7184.87,-9928.39"/>
</g>
<!-- O_s0_l8_tp4 -->
<g id="node669" class="node">
<title>O_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="8229.42,-9922.57 7891.42,-9922.57 7891.42,-9869.57 8229.42,-9869.57 8229.42,-9922.57"/>
<text text-anchor="middle" x="8060.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8060.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8060.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp4 -->
<g id="edge1109" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7118.2,-9976.25C7340.27,-9957.59 7676.27,-9929.35 7881.28,-9912.13"/>
<polygon fill="black" stroke="black" points="7881.57,-9915.61 7891.25,-9911.29 7880.99,-9908.64 7881.57,-9915.61"/>
</g>
<!-- O_s0_l8_tp5 -->
<g id="node670" class="node">
<title>O_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="4812.42,-9922.57 4474.42,-9922.57 4474.42,-9869.57 4812.42,-9869.57 4812.42,-9922.57"/>
<text text-anchor="middle" x="4643.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4643.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4643.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp5 -->
<g id="edge1110" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M6635.44,-9989.45C6261.1,-9980.44 5547.14,-9959.85 4940.42,-9922.57 4902.37,-9920.24 4861.62,-9917.13 4822.89,-9913.9"/>
<polygon fill="black" stroke="black" points="4822.81,-9910.38 4812.55,-9913.03 4822.22,-9917.35 4822.81,-9910.38"/>
</g>
<!-- O_s0_l8_tp6 -->
<g id="node671" class="node">
<title>O_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="9395.42,-9922.57 9057.42,-9922.57 9057.42,-9869.57 9395.42,-9869.57 9395.42,-9922.57"/>
<text text-anchor="middle" x="9226.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9226.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9226.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp6 -->
<g id="edge1111" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M7151.37,-9988C7525.07,-9977.18 8240.33,-9954.35 8848.42,-9922.57 8913.27,-9919.18 8984.31,-9914.62 9047.13,-9910.28"/>
<polygon fill="black" stroke="black" points="9047.4,-9913.77 9057.14,-9909.59 9046.92,-9906.79 9047.4,-9913.77"/>
</g>
<!-- O_s0_l8_tp7 -->
<g id="node672" class="node">
<title>O_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="8839.42,-9922.57 8501.42,-9922.57 8501.42,-9869.57 8839.42,-9869.57 8839.42,-9922.57"/>
<text text-anchor="middle" x="8670.42" y="-9907.37" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8670.42" y="-9892.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8670.42" y="-9877.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s0_l8&#45;&gt;O_s0_l8_tp7 -->
<g id="edge1112" class="edge">
<title>AR_attn_s0_l8&#45;&gt;O_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M7139.08,-9982.23C7408.46,-9968.03 7854.35,-9944.26 8238.42,-9922.57 8321.34,-9917.89 8413.19,-9912.5 8490.81,-9907.88"/>
<polygon fill="black" stroke="black" points="8491.4,-9911.35 8501.17,-9907.26 8490.98,-9904.36 8491.4,-9911.35"/>
</g>
<!-- O_s0_l8_tp0&#45;&gt;ResAttn_s0_l8_tp0 -->
<g id="edge1113" class="edge">
<title>O_s0_l8_tp0&#45;&gt;ResAttn_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6381.12,-9869.53C6329.63,-9859.44 6268.39,-9847.43 6207.96,-9835.59"/>
<polygon fill="black" stroke="black" points="6208.37,-9832.1 6197.88,-9833.61 6207.02,-9838.97 6208.37,-9832.1"/>
</g>
<!-- O_s0_l8_tp1&#45;&gt;ResAttn_s0_l8_tp1 -->
<g id="edge1115" class="edge">
<title>O_s0_l8_tp1&#45;&gt;ResAttn_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M4949.36,-9876.71C4804.58,-9860.99 4591.64,-9837.86 4411.97,-9818.34"/>
<polygon fill="black" stroke="black" points="4412.14,-9814.84 4401.82,-9817.24 4411.38,-9821.8 4412.14,-9814.84"/>
</g>
<!-- O_s0_l8_tp2&#45;&gt;ResAttn_s0_l8_tp2 -->
<g id="edge1117" class="edge">
<title>O_s0_l8_tp2&#45;&gt;ResAttn_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M5567.06,-9871.49C5482.77,-9859.75 5377.54,-9845.09 5276.65,-9831.04"/>
<polygon fill="black" stroke="black" points="5276.98,-9827.56 5266.59,-9829.64 5276.01,-9834.49 5276.98,-9827.56"/>
</g>
<!-- O_s0_l8_tp3&#45;&gt;ResAttn_s0_l8_tp3 -->
<g id="edge1119" class="edge">
<title>O_s0_l8_tp3&#45;&gt;ResAttn_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7457.63,-9869.53C7548.14,-9854.92 7663.48,-9836.3 7764.7,-9819.95"/>
<polygon fill="black" stroke="black" points="7765.45,-9823.38 7774.77,-9818.33 7764.34,-9816.47 7765.45,-9823.38"/>
</g>
<!-- O_s0_l8_tp4&#45;&gt;ResAttn_s0_l8_tp4 -->
<g id="edge1121" class="edge">
<title>O_s0_l8_tp4&#45;&gt;ResAttn_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M8229.6,-9871.28C8344.01,-9855.19 8496.89,-9833.69 8624.29,-9815.77"/>
<polygon fill="black" stroke="black" points="8624.78,-9819.23 8634.2,-9814.37 8623.81,-9812.3 8624.78,-9819.23"/>
</g>
<!-- O_s0_l8_tp5&#45;&gt;ResAttn_s0_l8_tp5 -->
<g id="edge1123" class="edge">
<title>O_s0_l8_tp5&#45;&gt;ResAttn_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M4474.32,-9883.89C4288.14,-9871.58 3979.93,-9851.19 3714.42,-9833.57 3561.79,-9823.45 3392.39,-9812.18 3250.4,-9802.74"/>
<polygon fill="black" stroke="black" points="3250.43,-9799.23 3240.22,-9802.06 3249.97,-9806.22 3250.43,-9799.23"/>
</g>
<!-- O_s0_l8_tp6&#45;&gt;ResAttn_s0_l8_tp6 -->
<g id="edge1125" class="edge">
<title>O_s0_l8_tp6&#45;&gt;ResAttn_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M9395.72,-9884.8C9593.55,-9872.75 9930.76,-9852.07 10220.42,-9833.57 10395.58,-9822.39 10592.56,-9809.42 10746.01,-9799.24"/>
<polygon fill="black" stroke="black" points="10746.31,-9802.73 10756.06,-9798.57 10745.85,-9795.74 10746.31,-9802.73"/>
</g>
<!-- O_s0_l8_tp7&#45;&gt;ResAttn_s0_l8_tp7 -->
<g id="edge1127" class="edge">
<title>O_s0_l8_tp7&#45;&gt;ResAttn_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M8839.48,-9878.96C9039.29,-9859.92 9373.83,-9828.04 9605.45,-9805.97"/>
<polygon fill="black" stroke="black" points="9606.09,-9809.42 9615.71,-9804.99 9605.42,-9802.45 9606.09,-9809.42"/>
</g>
<!-- Gate_s0_l8_tp0 -->
<g id="node681" class="node">
<title>Gate_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6256.42,-9691.57 5918.42,-9691.57 5918.42,-9638.57 6256.42,-9638.57 6256.42,-9691.57"/>
<text text-anchor="middle" x="6087.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6087.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6087.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp0&#45;&gt;Gate_s0_l8_tp0 -->
<g id="edge1129" class="edge">
<title>ResAttn_s0_l8_tp0&#45;&gt;Gate_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6003.57,-9727.47C6017.54,-9717.24 6031.79,-9706.81 6044.48,-9697.52"/>
<polygon fill="black" stroke="black" points="6046.58,-9700.32 6052.58,-9691.59 6042.44,-9694.67 6046.58,-9700.32"/>
</g>
<!-- ResMOE_s0_l8_tp0 -->
<g id="node722" class="node">
<title>ResMOE_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="7030.77,-9402.62 6473.45,-9402.62 6330.08,-9296.62 6887.4,-9296.62 7030.77,-9402.62"/>
<text text-anchor="middle" x="6680.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6680.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6680.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp0&#45;&gt;ResMOE_s0_l8_tp0 -->
<g id="edge1202" class="edge">
<title>ResAttn_s0_l8_tp0&#45;&gt;ResMOE_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M5611.84,-9749.68C5506.37,-9741 5388.47,-9732.53 5280.42,-9727.57 4623.95,-9697.43 2978.71,-9741.14 2323.42,-9691.57 2038.38,-9670.01 1874.05,-9818.24 1686.42,-9602.57 1670.96,-9584.8 1670.06,-9566.51 1686.42,-9549.57 1850.76,-9379.46 5705.22,-9415.01 5941.42,-9402.62 6100.25,-9394.29 6278.06,-9381.88 6419.46,-9371.27"/>
<polygon fill="black" stroke="black" points="6419.87,-9374.74 6429.58,-9370.5 6419.35,-9367.76 6419.87,-9374.74"/>
</g>
<!-- Gate_s0_l8_tp1 -->
<g id="node682" class="node">
<title>Gate_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="3974.42,-9691.57 3636.42,-9691.57 3636.42,-9638.57 3974.42,-9638.57 3974.42,-9691.57"/>
<text text-anchor="middle" x="3805.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3805.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3805.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp1&#45;&gt;Gate_s0_l8_tp1 -->
<g id="edge1130" class="edge">
<title>ResAttn_s0_l8_tp1&#45;&gt;Gate_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M3950.4,-9727.47C3924.52,-9716.51 3898.09,-9705.32 3875.01,-9695.54"/>
<polygon fill="black" stroke="black" points="3876.24,-9692.26 3865.67,-9691.59 3873.51,-9698.71 3876.24,-9692.26"/>
</g>
<!-- ResMOE_s0_l8_tp1 -->
<g id="node723" class="node">
<title>ResMOE_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="4456.77,-9402.62 3899.45,-9402.62 3756.08,-9296.62 4313.4,-9296.62 4456.77,-9402.62"/>
<text text-anchor="middle" x="4106.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4106.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4106.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp1&#45;&gt;ResMOE_s0_l8_tp1 -->
<g id="edge1204" class="edge">
<title>ResAttn_s0_l8_tp1&#45;&gt;ResMOE_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M3760.62,-9755.55C3617.65,-9745.39 3446.05,-9734.37 3291.42,-9727.57 3244.9,-9725.53 1647.99,-9724.85 1615.42,-9691.57 1576.1,-9651.4 1576.38,-9479.06 1615.42,-9438.62 1634.44,-9418.92 3182.01,-9375.32 3828.01,-9357.96"/>
<polygon fill="black" stroke="black" points="3828.49,-9361.45 3838.4,-9357.68 3828.31,-9354.45 3828.49,-9361.45"/>
</g>
<!-- Gate_s0_l8_tp2 -->
<g id="node683" class="node">
<title>Gate_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5090.42,-9691.57 4752.42,-9691.57 4752.42,-9638.57 5090.42,-9638.57 5090.42,-9691.57"/>
<text text-anchor="middle" x="4921.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4921.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4921.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp2&#45;&gt;Gate_s0_l8_tp2 -->
<g id="edge1131" class="edge">
<title>ResAttn_s0_l8_tp2&#45;&gt;Gate_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M4921.42,-9727.47C4921.42,-9718.8 4921.42,-9709.99 4921.42,-9701.84"/>
<polygon fill="black" stroke="black" points="4924.92,-9701.59 4921.42,-9691.59 4917.92,-9701.59 4924.92,-9701.59"/>
</g>
<!-- ResMOE_s0_l8_tp2 -->
<g id="node724" class="node">
<title>ResMOE_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5932.77,-9402.62 5375.45,-9402.62 5232.08,-9296.62 5789.4,-9296.62 5932.77,-9402.62"/>
<text text-anchor="middle" x="5582.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5582.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5582.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp2&#45;&gt;ResMOE_s0_l8_tp2 -->
<g id="edge1206" class="edge">
<title>ResAttn_s0_l8_tp2&#45;&gt;ResMOE_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M4587.7,-9739.9C4535.78,-9734.94 4482.7,-9730.57 4432.42,-9727.57 4393.89,-9725.28 1680.54,-9719.04 1653.42,-9691.57 1613.93,-9651.57 1613.93,-9478.62 1653.42,-9438.62 1680.86,-9410.82 4426.38,-9403.78 4465.42,-9402.62 4755.82,-9394 5088.4,-9377.69 5314.62,-9365.63"/>
<polygon fill="black" stroke="black" points="5314.84,-9369.12 5324.64,-9365.09 5314.47,-9362.13 5314.84,-9369.12"/>
</g>
<!-- Gate_s0_l8_tp3 -->
<g id="node684" class="node">
<title>Gate_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7886.42,-9691.57 7548.42,-9691.57 7548.42,-9638.57 7886.42,-9638.57 7886.42,-9691.57"/>
<text text-anchor="middle" x="7717.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7717.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7717.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp3&#45;&gt;Gate_s0_l8_tp3 -->
<g id="edge1132" class="edge">
<title>ResAttn_s0_l8_tp3&#45;&gt;Gate_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7871.6,-9727.47C7843.96,-9716.46 7815.72,-9705.22 7791.09,-9695.41"/>
<polygon fill="black" stroke="black" points="7792.07,-9692.03 7781.49,-9691.59 7789.48,-9698.54 7792.07,-9692.03"/>
</g>
<!-- ResMOE_s0_l8_tp3 -->
<g id="node725" class="node">
<title>ResMOE_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7879.77,-9402.62 7322.45,-9402.62 7179.08,-9296.62 7736.4,-9296.62 7879.77,-9402.62"/>
<text text-anchor="middle" x="7529.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7529.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7529.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp3&#45;&gt;ResMOE_s0_l8_tp3 -->
<g id="edge1208" class="edge">
<title>ResAttn_s0_l8_tp3&#45;&gt;ResMOE_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M8240.81,-9750.6C8325.21,-9741.53 8420.92,-9732.59 8508.42,-9727.57 9168.05,-9689.76 10822.59,-9741.39 11481.42,-9691.57 11770.66,-9669.7 12319.04,-9759.07 12118.42,-9549.57 12081.26,-9510.77 8851.82,-9396.21 7833.44,-9361.02"/>
<polygon fill="black" stroke="black" points="7833.53,-9357.52 7823.41,-9360.67 7833.29,-9364.52 7833.53,-9357.52"/>
</g>
<!-- Gate_s0_l8_tp4 -->
<g id="node685" class="node">
<title>Gate_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="9036.42,-9691.57 8698.42,-9691.57 8698.42,-9638.57 9036.42,-9638.57 9036.42,-9691.57"/>
<text text-anchor="middle" x="8867.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8867.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8867.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp4&#45;&gt;Gate_s0_l8_tp4 -->
<g id="edge1133" class="edge">
<title>ResAttn_s0_l8_tp4&#45;&gt;Gate_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M8867.42,-9727.47C8867.42,-9718.8 8867.42,-9709.99 8867.42,-9701.84"/>
<polygon fill="black" stroke="black" points="8870.92,-9701.59 8867.42,-9691.59 8863.92,-9701.59 8870.92,-9701.59"/>
</g>
<!-- ResMOE_s0_l8_tp4 -->
<g id="node726" class="node">
<title>ResMOE_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="9916.77,-9402.62 9359.45,-9402.62 9216.08,-9296.62 9773.4,-9296.62 9916.77,-9402.62"/>
<text text-anchor="middle" x="9566.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9566.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9566.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp4&#45;&gt;ResMOE_s0_l8_tp4 -->
<g id="edge1210" class="edge">
<title>ResAttn_s0_l8_tp4&#45;&gt;ResMOE_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M9112.56,-9755.69C9230.33,-9745.19 9373.57,-9733.84 9502.42,-9727.57 9761.15,-9715 11577.09,-9728.89 11833.42,-9691.57 11978.23,-9670.49 12062.03,-9719.2 12150.42,-9602.57 12332.3,-9362.61 11105.64,-9461.66 10805.42,-9438.62 10492.75,-9414.62 10135.5,-9389.49 9885.21,-9372.26"/>
<polygon fill="black" stroke="black" points="9885.08,-9368.74 9874.86,-9371.55 9884.6,-9375.72 9885.08,-9368.74"/>
</g>
<!-- Gate_s0_l8_tp5 -->
<g id="node686" class="node">
<title>Gate_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2670.42,-9691.57 2332.42,-9691.57 2332.42,-9638.57 2670.42,-9638.57 2670.42,-9691.57"/>
<text text-anchor="middle" x="2501.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2501.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2501.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp5&#45;&gt;Gate_s0_l8_tp5 -->
<g id="edge1134" class="edge">
<title>ResAttn_s0_l8_tp5&#45;&gt;Gate_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M2734.9,-9727.56C2691.39,-9716.1 2646.9,-9704.38 2608.58,-9694.29"/>
<polygon fill="black" stroke="black" points="2609.02,-9690.79 2598.46,-9691.63 2607.24,-9697.56 2609.02,-9690.79"/>
</g>
<!-- ResMOE_s0_l8_tp5 -->
<g id="node727" class="node">
<title>ResMOE_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2223.77,-9402.62 1666.45,-9402.62 1523.08,-9296.62 2080.4,-9296.62 2223.77,-9402.62"/>
<text text-anchor="middle" x="1873.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1873.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1873.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp5&#45;&gt;ResMOE_s0_l8_tp5 -->
<g id="edge1212" class="edge">
<title>ResAttn_s0_l8_tp5&#45;&gt;ResMOE_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M2639.41,-9770.02C2255.47,-9756.11 1626.25,-9727.93 1589.42,-9691.57 1509.4,-9612.59 1517.32,-9528.09 1585.42,-9438.62 1595.9,-9424.86 1620.19,-9412.33 1650.46,-9401.32"/>
<polygon fill="black" stroke="black" points="1651.77,-9404.58 1660.04,-9397.96 1649.45,-9397.97 1651.77,-9404.58"/>
</g>
<!-- Gate_s0_l8_tp6 -->
<g id="node687" class="node">
<title>Gate_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="11472.42,-9691.57 11134.42,-9691.57 11134.42,-9638.57 11472.42,-9638.57 11472.42,-9691.57"/>
<text text-anchor="middle" x="11303.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11303.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11303.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp6&#45;&gt;Gate_s0_l8_tp6 -->
<g id="edge1135" class="edge">
<title>ResAttn_s0_l8_tp6&#45;&gt;Gate_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M11144.92,-9727.47C11173.46,-9716.42 11202.62,-9705.12 11228.02,-9695.28"/>
<polygon fill="black" stroke="black" points="11229.5,-9698.46 11237.56,-9691.59 11226.97,-9691.94 11229.5,-9698.46"/>
</g>
<!-- ResMOE_s0_l8_tp6 -->
<g id="node728" class="node">
<title>ResMOE_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="12342.77,-9402.62 11785.45,-9402.62 11642.08,-9296.62 12199.4,-9296.62 12342.77,-9402.62"/>
<text text-anchor="middle" x="11992.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11992.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11992.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp6&#45;&gt;ResMOE_s0_l8_tp6 -->
<g id="edge1214" class="edge">
<title>ResAttn_s0_l8_tp6&#45;&gt;ResMOE_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M11287.17,-9779.02C11626.54,-9775.4 12164.75,-9758.94 12227.42,-9691.57 12304,-9609.26 12291.48,-9531.01 12227.42,-9438.62 12219.53,-9427.24 12209.98,-9417.33 12199.3,-9408.7"/>
<polygon fill="black" stroke="black" points="12201.41,-9405.91 12191.33,-9402.64 12197.17,-9411.48 12201.41,-9405.91"/>
</g>
<!-- Gate_s0_l8_tp7 -->
<g id="node688" class="node">
<title>Gate_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="10168.42,-9691.57 9830.42,-9691.57 9830.42,-9638.57 10168.42,-9638.57 10168.42,-9691.57"/>
<text text-anchor="middle" x="9999.42" y="-9676.37" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9999.42" y="-9661.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9999.42" y="-9646.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp7&#45;&gt;Gate_s0_l8_tp7 -->
<g id="edge1136" class="edge">
<title>ResAttn_s0_l8_tp7&#45;&gt;Gate_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M9924.77,-9727.47C9936.97,-9717.44 9949.41,-9707.21 9960.54,-9698.05"/>
<polygon fill="black" stroke="black" points="9962.9,-9700.64 9968.4,-9691.59 9958.45,-9695.24 9962.9,-9700.64"/>
</g>
<!-- ResMOE_s0_l8_tp7 -->
<g id="node729" class="node">
<title>ResMOE_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="11294.77,-9402.62 10737.45,-9402.62 10594.08,-9296.62 11151.4,-9296.62 11294.77,-9402.62"/>
<text text-anchor="middle" x="10944.42" y="-9360.92" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10944.42" y="-9345.92" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10944.42" y="-9330.92" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s0_l8_tp7&#45;&gt;ResMOE_s0_l8_tp7 -->
<g id="edge1216" class="edge">
<title>ResAttn_s0_l8_tp7&#45;&gt;ResMOE_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M10113,-9760.52C10268.13,-9749.39 10471.21,-9735.93 10651.42,-9727.57 10799.76,-9720.7 11843.06,-9726.38 11987.42,-9691.57 12076.51,-9670.09 12124.57,-9680.11 12173.42,-9602.57 12185.98,-9582.64 12188.69,-9567.51 12173.42,-9549.57 12115.53,-9481.55 11619.95,-9418.42 11276.07,-9382.23"/>
<polygon fill="black" stroke="black" points="11276.26,-9378.73 11265.95,-9381.16 11275.53,-9385.69 11276.26,-9378.73"/>
</g>
<!-- Expert0_s0_l8_tp0 -->
<g id="node689" class="node">
<title>Expert0_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6567.42,-9602.57 6259.42,-9602.57 6259.42,-9549.57 6567.42,-9549.57 6567.42,-9602.57"/>
<text text-anchor="middle" x="6413.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert0</text>
<text text-anchor="middle" x="6413.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6413.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp0&#45;&gt;Expert0_s0_l8_tp0 -->
<g id="edge1137" class="edge">
<title>Gate_s0_l8_tp0&#45;&gt;Expert0_s0_l8_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6183.03,-9638.56C6222.26,-9628.09 6267.8,-9615.93 6307.99,-9605.21"/>
<polygon fill="black" stroke="black" points="6309.06,-9608.55 6317.82,-9602.59 6307.25,-9601.78 6309.06,-9608.55"/>
</g>
<!-- Expert1_s0_l8_tp0 -->
<g id="node690" class="node">
<title>Expert1_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6893.42,-9602.57 6585.42,-9602.57 6585.42,-9549.57 6893.42,-9549.57 6893.42,-9602.57"/>
<text text-anchor="middle" x="6739.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert1</text>
<text text-anchor="middle" x="6739.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6739.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp0&#45;&gt;Expert1_s0_l8_tp0 -->
<g id="edge1138" class="edge">
<title>Gate_s0_l8_tp0&#45;&gt;Expert1_s0_l8_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6256.47,-9644.08C6347.97,-9632.95 6463.22,-9618.44 6574.9,-9602.77"/>
<polygon fill="black" stroke="black" points="6575.59,-9606.21 6585.01,-9601.35 6574.62,-9599.28 6575.59,-9606.21"/>
</g>
<!-- Expert2_s0_l8_tp0 -->
<g id="node691" class="node">
<title>Expert2_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="5915.42,-9602.57 5607.42,-9602.57 5607.42,-9549.57 5915.42,-9549.57 5915.42,-9602.57"/>
<text text-anchor="middle" x="5761.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert2</text>
<text text-anchor="middle" x="5761.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5761.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp0&#45;&gt;Expert2_s0_l8_tp0 -->
<g id="edge1139" class="edge">
<title>Gate_s0_l8_tp0&#45;&gt;Expert2_s0_l8_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5991.81,-9638.56C5952.59,-9628.09 5907.04,-9615.93 5866.85,-9605.21"/>
<polygon fill="black" stroke="black" points="5867.59,-9601.78 5857.03,-9602.59 5865.79,-9608.55 5867.59,-9601.78"/>
</g>
<!-- Expert3_s0_l8_tp0 -->
<g id="node692" class="node">
<title>Expert3_s0_l8_tp0</title>
<polygon fill="none" stroke="black" points="6241.42,-9602.57 5933.42,-9602.57 5933.42,-9549.57 6241.42,-9549.57 6241.42,-9602.57"/>
<text text-anchor="middle" x="6087.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert3</text>
<text text-anchor="middle" x="6087.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="6087.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp0&#45;&gt;Expert3_s0_l8_tp0 -->
<g id="edge1140" class="edge">
<title>Gate_s0_l8_tp0&#45;&gt;Expert3_s0_l8_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6087.42,-9638.44C6087.42,-9630.46 6087.42,-9621.51 6087.42,-9612.96"/>
<polygon fill="black" stroke="black" points="6090.92,-9612.82 6087.42,-9602.82 6083.92,-9612.82 6090.92,-9612.82"/>
</g>
<!-- Expert4_s0_l8_tp1 -->
<g id="node693" class="node">
<title>Expert4_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="3959.42,-9602.57 3651.42,-9602.57 3651.42,-9549.57 3959.42,-9549.57 3959.42,-9602.57"/>
<text text-anchor="middle" x="3805.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert4</text>
<text text-anchor="middle" x="3805.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3805.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp1&#45;&gt;Expert4_s0_l8_tp1 -->
<g id="edge1141" class="edge">
<title>Gate_s0_l8_tp1&#45;&gt;Expert4_s0_l8_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3805.42,-9638.44C3805.42,-9630.46 3805.42,-9621.51 3805.42,-9612.96"/>
<polygon fill="black" stroke="black" points="3808.92,-9612.82 3805.42,-9602.82 3801.92,-9612.82 3808.92,-9612.82"/>
</g>
<!-- Expert5_s0_l8_tp1 -->
<g id="node694" class="node">
<title>Expert5_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="4285.42,-9602.57 3977.42,-9602.57 3977.42,-9549.57 4285.42,-9549.57 4285.42,-9602.57"/>
<text text-anchor="middle" x="4131.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert5</text>
<text text-anchor="middle" x="4131.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4131.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp1&#45;&gt;Expert5_s0_l8_tp1 -->
<g id="edge1142" class="edge">
<title>Gate_s0_l8_tp1&#45;&gt;Expert5_s0_l8_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3901.03,-9638.56C3940.26,-9628.09 3985.8,-9615.93 4025.99,-9605.21"/>
<polygon fill="black" stroke="black" points="4027.06,-9608.55 4035.82,-9602.59 4025.25,-9601.78 4027.06,-9608.55"/>
</g>
<!-- Expert6_s0_l8_tp1 -->
<g id="node695" class="node">
<title>Expert6_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="3307.42,-9602.57 2999.42,-9602.57 2999.42,-9549.57 3307.42,-9549.57 3307.42,-9602.57"/>
<text text-anchor="middle" x="3153.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert6</text>
<text text-anchor="middle" x="3153.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3153.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp1&#45;&gt;Expert6_s0_l8_tp1 -->
<g id="edge1143" class="edge">
<title>Gate_s0_l8_tp1&#45;&gt;Expert6_s0_l8_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3636.37,-9644.08C3544.87,-9632.95 3429.63,-9618.44 3317.94,-9602.77"/>
<polygon fill="black" stroke="black" points="3318.23,-9599.28 3307.84,-9601.35 3317.25,-9606.21 3318.23,-9599.28"/>
</g>
<!-- Expert7_s0_l8_tp1 -->
<g id="node696" class="node">
<title>Expert7_s0_l8_tp1</title>
<polygon fill="none" stroke="black" points="3633.42,-9602.57 3325.42,-9602.57 3325.42,-9549.57 3633.42,-9549.57 3633.42,-9602.57"/>
<text text-anchor="middle" x="3479.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert7</text>
<text text-anchor="middle" x="3479.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="3479.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp1&#45;&gt;Expert7_s0_l8_tp1 -->
<g id="edge1144" class="edge">
<title>Gate_s0_l8_tp1&#45;&gt;Expert7_s0_l8_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3709.81,-9638.56C3670.59,-9628.09 3625.04,-9615.93 3584.85,-9605.21"/>
<polygon fill="black" stroke="black" points="3585.59,-9601.78 3575.03,-9602.59 3583.79,-9608.55 3585.59,-9601.78"/>
</g>
<!-- Expert8_s0_l8_tp2 -->
<g id="node697" class="node">
<title>Expert8_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5589.42,-9602.57 5281.42,-9602.57 5281.42,-9549.57 5589.42,-9549.57 5589.42,-9602.57"/>
<text text-anchor="middle" x="5435.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert8</text>
<text text-anchor="middle" x="5435.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5435.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp2&#45;&gt;Expert8_s0_l8_tp2 -->
<g id="edge1145" class="edge">
<title>Gate_s0_l8_tp2&#45;&gt;Expert8_s0_l8_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5072.17,-9638.56C5135.84,-9627.78 5210.08,-9615.21 5274.79,-9604.26"/>
<polygon fill="black" stroke="black" points="5275.41,-9607.71 5284.68,-9602.59 5274.24,-9600.81 5275.41,-9607.71"/>
</g>
<!-- Expert9_s0_l8_tp2 -->
<g id="node698" class="node">
<title>Expert9_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="4611.42,-9602.57 4303.42,-9602.57 4303.42,-9549.57 4611.42,-9549.57 4611.42,-9602.57"/>
<text text-anchor="middle" x="4457.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert9</text>
<text text-anchor="middle" x="4457.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4457.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp2&#45;&gt;Expert9_s0_l8_tp2 -->
<g id="edge1146" class="edge">
<title>Gate_s0_l8_tp2&#45;&gt;Expert9_s0_l8_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4785.34,-9638.56C4728.21,-9627.85 4661.67,-9615.37 4603.51,-9604.46"/>
<polygon fill="black" stroke="black" points="4603.97,-9600.99 4593.5,-9602.59 4602.68,-9607.87 4603.97,-9600.99"/>
</g>
<!-- Expert10_s0_l8_tp2 -->
<g id="node699" class="node">
<title>Expert10_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="4937.42,-9602.57 4629.42,-9602.57 4629.42,-9549.57 4937.42,-9549.57 4937.42,-9602.57"/>
<text text-anchor="middle" x="4783.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert10</text>
<text text-anchor="middle" x="4783.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="4783.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp2&#45;&gt;Expert10_s0_l8_tp2 -->
<g id="edge1147" class="edge">
<title>Gate_s0_l8_tp2&#45;&gt;Expert10_s0_l8_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4880.76,-9638.44C4865.74,-9628.97 4848.54,-9618.13 4832.82,-9608.22"/>
<polygon fill="black" stroke="black" points="4834.59,-9605.2 4824.27,-9602.82 4830.86,-9611.12 4834.59,-9605.2"/>
</g>
<!-- Expert11_s0_l8_tp2 -->
<g id="node700" class="node">
<title>Expert11_s0_l8_tp2</title>
<polygon fill="none" stroke="black" points="5263.42,-9602.57 4955.42,-9602.57 4955.42,-9549.57 5263.42,-9549.57 5263.42,-9602.57"/>
<text text-anchor="middle" x="5109.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert11</text>
<text text-anchor="middle" x="5109.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="5109.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp2&#45;&gt;Expert11_s0_l8_tp2 -->
<g id="edge1148" class="edge">
<title>Gate_s0_l8_tp2&#45;&gt;Expert11_s0_l8_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4976.56,-9638.56C4997.98,-9628.64 5022.68,-9617.22 5044.92,-9606.92"/>
<polygon fill="black" stroke="black" points="5046.68,-9609.96 5054.29,-9602.59 5043.74,-9603.61 5046.68,-9609.96"/>
</g>
<!-- Expert12_s0_l8_tp3 -->
<g id="node701" class="node">
<title>Expert12_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7219.42,-9602.57 6911.42,-9602.57 6911.42,-9549.57 7219.42,-9549.57 7219.42,-9602.57"/>
<text text-anchor="middle" x="7065.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert12</text>
<text text-anchor="middle" x="7065.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7065.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp3&#45;&gt;Expert12_s0_l8_tp3 -->
<g id="edge1149" class="edge">
<title>Gate_s0_l8_tp3&#45;&gt;Expert12_s0_l8_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7548.37,-9644.08C7456.87,-9632.95 7341.63,-9618.44 7229.94,-9602.77"/>
<polygon fill="black" stroke="black" points="7230.23,-9599.28 7219.84,-9601.35 7229.25,-9606.21 7230.23,-9599.28"/>
</g>
<!-- Expert13_s0_l8_tp3 -->
<g id="node702" class="node">
<title>Expert13_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7545.42,-9602.57 7237.42,-9602.57 7237.42,-9549.57 7545.42,-9549.57 7545.42,-9602.57"/>
<text text-anchor="middle" x="7391.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert13</text>
<text text-anchor="middle" x="7391.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7391.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp3&#45;&gt;Expert13_s0_l8_tp3 -->
<g id="edge1150" class="edge">
<title>Gate_s0_l8_tp3&#45;&gt;Expert13_s0_l8_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7621.81,-9638.56C7582.59,-9628.09 7537.04,-9615.93 7496.85,-9605.21"/>
<polygon fill="black" stroke="black" points="7497.59,-9601.78 7487.03,-9602.59 7495.79,-9608.55 7497.59,-9601.78"/>
</g>
<!-- Expert14_s0_l8_tp3 -->
<g id="node703" class="node">
<title>Expert14_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="7871.42,-9602.57 7563.42,-9602.57 7563.42,-9549.57 7871.42,-9549.57 7871.42,-9602.57"/>
<text text-anchor="middle" x="7717.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert14</text>
<text text-anchor="middle" x="7717.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="7717.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp3&#45;&gt;Expert14_s0_l8_tp3 -->
<g id="edge1151" class="edge">
<title>Gate_s0_l8_tp3&#45;&gt;Expert14_s0_l8_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7717.42,-9638.44C7717.42,-9630.46 7717.42,-9621.51 7717.42,-9612.96"/>
<polygon fill="black" stroke="black" points="7720.92,-9612.82 7717.42,-9602.82 7713.92,-9612.82 7720.92,-9612.82"/>
</g>
<!-- Expert15_s0_l8_tp3 -->
<g id="node704" class="node">
<title>Expert15_s0_l8_tp3</title>
<polygon fill="none" stroke="black" points="8197.42,-9602.57 7889.42,-9602.57 7889.42,-9549.57 8197.42,-9549.57 8197.42,-9602.57"/>
<text text-anchor="middle" x="8043.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert15</text>
<text text-anchor="middle" x="8043.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8043.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp3&#45;&gt;Expert15_s0_l8_tp3 -->
<g id="edge1152" class="edge">
<title>Gate_s0_l8_tp3&#45;&gt;Expert15_s0_l8_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7813.03,-9638.56C7852.26,-9628.09 7897.8,-9615.93 7937.99,-9605.21"/>
<polygon fill="black" stroke="black" points="7939.06,-9608.55 7947.82,-9602.59 7937.25,-9601.78 7939.06,-9608.55"/>
</g>
<!-- Expert16_s0_l8_tp4 -->
<g id="node705" class="node">
<title>Expert16_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="8523.42,-9602.57 8215.42,-9602.57 8215.42,-9549.57 8523.42,-9549.57 8523.42,-9602.57"/>
<text text-anchor="middle" x="8369.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert16</text>
<text text-anchor="middle" x="8369.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8369.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp4&#45;&gt;Expert16_s0_l8_tp4 -->
<g id="edge1153" class="edge">
<title>Gate_s0_l8_tp4&#45;&gt;Expert16_s0_l8_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8721.37,-9638.56C8659.8,-9627.8 8588.04,-9615.27 8525.44,-9604.33"/>
<polygon fill="black" stroke="black" points="8525.92,-9600.86 8515.47,-9602.59 8524.72,-9607.76 8525.92,-9600.86"/>
</g>
<!-- Expert17_s0_l8_tp4 -->
<g id="node706" class="node">
<title>Expert17_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="8849.42,-9602.57 8541.42,-9602.57 8541.42,-9549.57 8849.42,-9549.57 8849.42,-9602.57"/>
<text text-anchor="middle" x="8695.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert17</text>
<text text-anchor="middle" x="8695.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8695.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp4&#45;&gt;Expert17_s0_l8_tp4 -->
<g id="edge1154" class="edge">
<title>Gate_s0_l8_tp4&#45;&gt;Expert17_s0_l8_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8816.75,-9638.44C8797.41,-9628.66 8775.19,-9617.42 8755.1,-9607.26"/>
<polygon fill="black" stroke="black" points="8756.54,-9604.06 8746.03,-9602.67 8753.38,-9610.31 8756.54,-9604.06"/>
</g>
<!-- Expert18_s0_l8_tp4 -->
<g id="node707" class="node">
<title>Expert18_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="9175.42,-9602.57 8867.42,-9602.57 8867.42,-9549.57 9175.42,-9549.57 9175.42,-9602.57"/>
<text text-anchor="middle" x="9021.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert18</text>
<text text-anchor="middle" x="9021.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9021.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp4&#45;&gt;Expert18_s0_l8_tp4 -->
<g id="edge1155" class="edge">
<title>Gate_s0_l8_tp4&#45;&gt;Expert18_s0_l8_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8912.79,-9638.44C8929.79,-9628.84 8949.28,-9617.83 8967.02,-9607.81"/>
<polygon fill="black" stroke="black" points="8969.12,-9610.64 8976.11,-9602.67 8965.68,-9604.54 8969.12,-9610.64"/>
</g>
<!-- Expert19_s0_l8_tp4 -->
<g id="node708" class="node">
<title>Expert19_s0_l8_tp4</title>
<polygon fill="none" stroke="black" points="9501.42,-9602.57 9193.42,-9602.57 9193.42,-9549.57 9501.42,-9549.57 9501.42,-9602.57"/>
<text text-anchor="middle" x="9347.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert19</text>
<text text-anchor="middle" x="9347.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9347.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp4&#45;&gt;Expert19_s0_l8_tp4 -->
<g id="edge1156" class="edge">
<title>Gate_s0_l8_tp4&#45;&gt;Expert19_s0_l8_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9008.2,-9638.56C9067.42,-9627.82 9136.42,-9615.32 9196.67,-9604.4"/>
<polygon fill="black" stroke="black" points="9197.44,-9607.82 9206.65,-9602.59 9196.19,-9600.93 9197.44,-9607.82"/>
</g>
<!-- Expert20_s0_l8_tp5 -->
<g id="node709" class="node">
<title>Expert20_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2003.42,-9602.57 1695.42,-9602.57 1695.42,-9549.57 2003.42,-9549.57 2003.42,-9602.57"/>
<text text-anchor="middle" x="1849.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert20</text>
<text text-anchor="middle" x="1849.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1849.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp5&#45;&gt;Expert20_s0_l8_tp5 -->
<g id="edge1157" class="edge">
<title>Gate_s0_l8_tp5&#45;&gt;Expert20_s0_l8_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2332.37,-9644.08C2240.87,-9632.95 2125.63,-9618.44 2013.94,-9602.77"/>
<polygon fill="black" stroke="black" points="2014.23,-9599.28 2003.84,-9601.35 2013.25,-9606.21 2014.23,-9599.28"/>
</g>
<!-- Expert21_s0_l8_tp5 -->
<g id="node710" class="node">
<title>Expert21_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2329.42,-9602.57 2021.42,-9602.57 2021.42,-9549.57 2329.42,-9549.57 2329.42,-9602.57"/>
<text text-anchor="middle" x="2175.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert21</text>
<text text-anchor="middle" x="2175.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2175.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp5&#45;&gt;Expert21_s0_l8_tp5 -->
<g id="edge1158" class="edge">
<title>Gate_s0_l8_tp5&#45;&gt;Expert21_s0_l8_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2405.81,-9638.56C2366.59,-9628.09 2321.04,-9615.93 2280.85,-9605.21"/>
<polygon fill="black" stroke="black" points="2281.59,-9601.78 2271.03,-9602.59 2279.79,-9608.55 2281.59,-9601.78"/>
</g>
<!-- Expert22_s0_l8_tp5 -->
<g id="node711" class="node">
<title>Expert22_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2655.42,-9602.57 2347.42,-9602.57 2347.42,-9549.57 2655.42,-9549.57 2655.42,-9602.57"/>
<text text-anchor="middle" x="2501.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert22</text>
<text text-anchor="middle" x="2501.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2501.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp5&#45;&gt;Expert22_s0_l8_tp5 -->
<g id="edge1159" class="edge">
<title>Gate_s0_l8_tp5&#45;&gt;Expert22_s0_l8_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2501.42,-9638.44C2501.42,-9630.46 2501.42,-9621.51 2501.42,-9612.96"/>
<polygon fill="black" stroke="black" points="2504.92,-9612.82 2501.42,-9602.82 2497.92,-9612.82 2504.92,-9612.82"/>
</g>
<!-- Expert23_s0_l8_tp5 -->
<g id="node712" class="node">
<title>Expert23_s0_l8_tp5</title>
<polygon fill="none" stroke="black" points="2981.42,-9602.57 2673.42,-9602.57 2673.42,-9549.57 2981.42,-9549.57 2981.42,-9602.57"/>
<text text-anchor="middle" x="2827.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert23</text>
<text text-anchor="middle" x="2827.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2827.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp5&#45;&gt;Expert23_s0_l8_tp5 -->
<g id="edge1160" class="edge">
<title>Gate_s0_l8_tp5&#45;&gt;Expert23_s0_l8_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2597.03,-9638.56C2636.26,-9628.09 2681.8,-9615.93 2721.99,-9605.21"/>
<polygon fill="black" stroke="black" points="2723.06,-9608.55 2731.82,-9602.59 2721.25,-9601.78 2723.06,-9608.55"/>
</g>
<!-- Expert24_s0_l8_tp6 -->
<g id="node713" class="node">
<title>Expert24_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="11131.42,-9602.57 10823.42,-9602.57 10823.42,-9549.57 11131.42,-9549.57 11131.42,-9602.57"/>
<text text-anchor="middle" x="10977.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert24</text>
<text text-anchor="middle" x="10977.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10977.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp6&#45;&gt;Expert24_s0_l8_tp6 -->
<g id="edge1161" class="edge">
<title>Gate_s0_l8_tp6&#45;&gt;Expert24_s0_l8_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11207.81,-9638.56C11168.59,-9628.09 11123.04,-9615.93 11082.85,-9605.21"/>
<polygon fill="black" stroke="black" points="11083.59,-9601.78 11073.03,-9602.59 11081.79,-9608.55 11083.59,-9601.78"/>
</g>
<!-- Expert25_s0_l8_tp6 -->
<g id="node714" class="node">
<title>Expert25_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="11457.42,-9602.57 11149.42,-9602.57 11149.42,-9549.57 11457.42,-9549.57 11457.42,-9602.57"/>
<text text-anchor="middle" x="11303.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert25</text>
<text text-anchor="middle" x="11303.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11303.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp6&#45;&gt;Expert25_s0_l8_tp6 -->
<g id="edge1162" class="edge">
<title>Gate_s0_l8_tp6&#45;&gt;Expert25_s0_l8_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11303.42,-9638.44C11303.42,-9630.46 11303.42,-9621.51 11303.42,-9612.96"/>
<polygon fill="black" stroke="black" points="11306.92,-9612.82 11303.42,-9602.82 11299.92,-9612.82 11306.92,-9612.82"/>
</g>
<!-- Expert26_s0_l8_tp6 -->
<g id="node715" class="node">
<title>Expert26_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="11783.42,-9602.57 11475.42,-9602.57 11475.42,-9549.57 11783.42,-9549.57 11783.42,-9602.57"/>
<text text-anchor="middle" x="11629.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert26</text>
<text text-anchor="middle" x="11629.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11629.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp6&#45;&gt;Expert26_s0_l8_tp6 -->
<g id="edge1163" class="edge">
<title>Gate_s0_l8_tp6&#45;&gt;Expert26_s0_l8_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11399.03,-9638.56C11438.26,-9628.09 11483.8,-9615.93 11523.99,-9605.21"/>
<polygon fill="black" stroke="black" points="11525.06,-9608.55 11533.82,-9602.59 11523.25,-9601.78 11525.06,-9608.55"/>
</g>
<!-- Expert27_s0_l8_tp6 -->
<g id="node716" class="node">
<title>Expert27_s0_l8_tp6</title>
<polygon fill="none" stroke="black" points="12109.42,-9602.57 11801.42,-9602.57 11801.42,-9549.57 12109.42,-9549.57 12109.42,-9602.57"/>
<text text-anchor="middle" x="11955.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert27</text>
<text text-anchor="middle" x="11955.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11955.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp6&#45;&gt;Expert27_s0_l8_tp6 -->
<g id="edge1164" class="edge">
<title>Gate_s0_l8_tp6&#45;&gt;Expert27_s0_l8_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11472.47,-9644.08C11563.97,-9632.95 11679.22,-9618.44 11790.9,-9602.77"/>
<polygon fill="black" stroke="black" points="11791.59,-9606.21 11801.01,-9601.35 11790.62,-9599.28 11791.59,-9606.21"/>
</g>
<!-- Expert28_s0_l8_tp7 -->
<g id="node717" class="node">
<title>Expert28_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="9827.42,-9602.57 9519.42,-9602.57 9519.42,-9549.57 9827.42,-9549.57 9827.42,-9602.57"/>
<text text-anchor="middle" x="9673.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert28</text>
<text text-anchor="middle" x="9673.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9673.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp7&#45;&gt;Expert28_s0_l8_tp7 -->
<g id="edge1165" class="edge">
<title>Gate_s0_l8_tp7&#45;&gt;Expert28_s0_l8_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9903.81,-9638.56C9864.59,-9628.09 9819.04,-9615.93 9778.85,-9605.21"/>
<polygon fill="black" stroke="black" points="9779.59,-9601.78 9769.03,-9602.59 9777.79,-9608.55 9779.59,-9601.78"/>
</g>
<!-- Expert29_s0_l8_tp7 -->
<g id="node718" class="node">
<title>Expert29_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="10153.42,-9602.57 9845.42,-9602.57 9845.42,-9549.57 10153.42,-9549.57 10153.42,-9602.57"/>
<text text-anchor="middle" x="9999.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert29</text>
<text text-anchor="middle" x="9999.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9999.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp7&#45;&gt;Expert29_s0_l8_tp7 -->
<g id="edge1166" class="edge">
<title>Gate_s0_l8_tp7&#45;&gt;Expert29_s0_l8_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9999.42,-9638.44C9999.42,-9630.46 9999.42,-9621.51 9999.42,-9612.96"/>
<polygon fill="black" stroke="black" points="10002.92,-9612.82 9999.42,-9602.82 9995.92,-9612.82 10002.92,-9612.82"/>
</g>
<!-- Expert30_s0_l8_tp7 -->
<g id="node719" class="node">
<title>Expert30_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="10479.42,-9602.57 10171.42,-9602.57 10171.42,-9549.57 10479.42,-9549.57 10479.42,-9602.57"/>
<text text-anchor="middle" x="10325.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert30</text>
<text text-anchor="middle" x="10325.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10325.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp7&#45;&gt;Expert30_s0_l8_tp7 -->
<g id="edge1167" class="edge">
<title>Gate_s0_l8_tp7&#45;&gt;Expert30_s0_l8_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10095.03,-9638.56C10134.26,-9628.09 10179.8,-9615.93 10219.99,-9605.21"/>
<polygon fill="black" stroke="black" points="10221.06,-9608.55 10229.82,-9602.59 10219.25,-9601.78 10221.06,-9608.55"/>
</g>
<!-- Expert31_s0_l8_tp7 -->
<g id="node720" class="node">
<title>Expert31_s0_l8_tp7</title>
<polygon fill="none" stroke="black" points="10805.42,-9602.57 10497.42,-9602.57 10497.42,-9549.57 10805.42,-9549.57 10805.42,-9602.57"/>
<text text-anchor="middle" x="10651.42" y="-9587.37" font-family="Times,serif" font-size="14.00">Expert31</text>
<text text-anchor="middle" x="10651.42" y="-9572.37" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10651.42" y="-9557.37" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s0_l8_tp7&#45;&gt;Expert31_s0_l8_tp7 -->
<g id="edge1168" class="edge">
<title>Gate_s0_l8_tp7&#45;&gt;Expert31_s0_l8_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10168.47,-9644.08C10259.97,-9632.95 10375.22,-9618.44 10486.9,-9602.77"/>
<polygon fill="black" stroke="black" points="10487.59,-9606.21 10497.01,-9601.35 10486.62,-9599.28 10487.59,-9606.21"/>
</g>
<!-- AR_exp_s0_l8 -->
<g id="node721" class="node">
<title>AR_exp_s0_l8</title>
<ellipse fill="none" stroke="black" cx="6869.42" cy="-9476.1" rx="239" ry="37.45"/>
<text text-anchor="middle" x="6869.42" y="-9487.4" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="6869.42" y="-9472.4" font-family="Times,serif" font-size="14.00">stage0</text>
<text text-anchor="middle" x="6869.42" y="-9457.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert0_s0_l8_tp0&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1169" class="edge">
<title>Expert0_s0_l8_tp0&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M6532.34,-9549.52C6590.08,-9537.12 6660.04,-9522.09 6721.22,-9508.94"/>
<polygon fill="black" stroke="black" points="6722.31,-9512.28 6731.35,-9506.76 6720.84,-9505.44 6722.31,-9512.28"/>
</g>
<!-- Expert1_s0_l8_tp0&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1170" class="edge">
<title>Expert1_s0_l8_tp0&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M6773.58,-9549.33C6785.79,-9540.13 6799.89,-9529.5 6813.46,-9519.28"/>
<polygon fill="black" stroke="black" points="6815.93,-9521.79 6821.81,-9512.98 6811.72,-9516.2 6815.93,-9521.79"/>
</g>
<!-- Expert2_s0_l8_tp0&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1171" class="edge">
<title>Expert2_s0_l8_tp0&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M5915.81,-9550.6C5918.71,-9550.25 5921.58,-9549.9 5924.42,-9549.57 6166.08,-9521.45 6443.82,-9501.63 6635.35,-9489.91"/>
<polygon fill="black" stroke="black" points="6635.78,-9493.39 6645.55,-9489.29 6635.36,-9486.41 6635.78,-9493.39"/>
</g>
<!-- Expert3_s0_l8_tp0&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1172" class="edge">
<title>Expert3_s0_l8_tp0&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M6241.83,-9550.76C6244.72,-9550.36 6247.58,-9549.96 6250.42,-9549.57 6388.32,-9530.72 6543.92,-9512.52 6664.62,-9499.07"/>
<polygon fill="black" stroke="black" points="6665.17,-9502.53 6674.72,-9497.94 6664.39,-9495.57 6665.17,-9502.53"/>
</g>
<!-- Expert4_s0_l8_tp1&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1173" class="edge">
<title>Expert4_s0_l8_tp1&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M3959.79,-9550.4C3962.69,-9550.11 3965.57,-9549.83 3968.42,-9549.57 4479.84,-9503.38 6016.22,-9484.8 6620.97,-9479.14"/>
<polygon fill="black" stroke="black" points="6621.16,-9482.64 6631.13,-9479.05 6621.09,-9475.64 6621.16,-9482.64"/>
</g>
<!-- Expert5_s0_l8_tp1&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1174" class="edge">
<title>Expert5_s0_l8_tp1&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M4285.79,-9550.41C4288.69,-9550.12 4291.57,-9549.84 4294.42,-9549.57 4740.79,-9508.54 6066.95,-9487.33 6621.41,-9480.06"/>
<polygon fill="black" stroke="black" points="6621.58,-9483.56 6631.54,-9479.92 6621.49,-9476.56 6621.58,-9483.56"/>
</g>
<!-- Expert6_s0_l8_tp1&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1175" class="edge">
<title>Expert6_s0_l8_tp1&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M3307.79,-9550.38C3310.69,-9550.09 3313.57,-9549.82 3316.42,-9549.57 3959.07,-9493.01 5922.83,-9480.49 6620.37,-9477.81"/>
<polygon fill="black" stroke="black" points="6620.55,-9481.31 6630.54,-9477.77 6620.53,-9474.31 6620.55,-9481.31"/>
</g>
<!-- Expert7_s0_l8_tp1&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1176" class="edge">
<title>Expert7_s0_l8_tp1&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M3633.79,-9550.39C3636.69,-9550.1 3639.57,-9549.83 3642.42,-9549.57 4219.2,-9498.21 5967.8,-9482.54 6620.34,-9478.41"/>
<polygon fill="black" stroke="black" points="6620.83,-9481.91 6630.81,-9478.35 6620.79,-9474.91 6620.83,-9481.91"/>
</g>
<!-- Expert8_s0_l8_tp2&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1177" class="edge">
<title>Expert8_s0_l8_tp2&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M5589.81,-9550.53C5592.7,-9550.19 5595.57,-9549.88 5598.42,-9549.57 5954.37,-9511.67 6368.66,-9492.72 6625,-9483.91"/>
<polygon fill="black" stroke="black" points="6625.31,-9487.4 6635.19,-9483.56 6625.08,-9480.4 6625.31,-9487.4"/>
</g>
<!-- Expert9_s0_l8_tp2&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1178" class="edge">
<title>Expert9_s0_l8_tp2&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M4611.8,-9550.43C4614.69,-9550.13 4617.57,-9549.84 4620.42,-9549.57 5002.24,-9513.69 6121.24,-9490.22 6622.1,-9481.22"/>
<polygon fill="black" stroke="black" points="6622.42,-9484.72 6632.35,-9481.04 6622.29,-9477.72 6622.42,-9484.72"/>
</g>
<!-- Expert10_s0_l8_tp2&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1179" class="edge">
<title>Expert10_s0_l8_tp2&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M4937.8,-9550.45C4940.69,-9550.14 4943.57,-9549.85 4946.42,-9549.57 5545.21,-9491.65 6253.03,-9479.36 6620.26,-9477.16"/>
<polygon fill="black" stroke="black" points="6620.51,-9480.65 6630.49,-9477.1 6620.47,-9473.65 6620.51,-9480.65"/>
</g>
<!-- Expert11_s0_l8_tp2&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1180" class="edge">
<title>Expert11_s0_l8_tp2&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M5263.8,-9550.48C5266.7,-9550.16 5269.57,-9549.86 5272.42,-9549.57 5748.1,-9501.72 6306.69,-9485.45 6621.24,-9479.93"/>
<polygon fill="black" stroke="black" points="6621.47,-9483.42 6631.4,-9479.75 6621.35,-9476.42 6621.47,-9483.42"/>
</g>
<!-- Expert12_s0_l8_tp3&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1181" class="edge">
<title>Expert12_s0_l8_tp3&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M7014.18,-9549.46C6994.04,-9539.39 6970.47,-9527.61 6948.26,-9516.5"/>
<polygon fill="black" stroke="black" points="6949.68,-9513.3 6939.17,-9511.96 6946.55,-9519.56 6949.68,-9513.3"/>
</g>
<!-- Expert13_s0_l8_tp3&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1182" class="edge">
<title>Expert13_s0_l8_tp3&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M7255.3,-9549.52C7186.2,-9536.55 7101.82,-9520.72 7029.61,-9507.16"/>
<polygon fill="black" stroke="black" points="7029.98,-9503.67 7019.51,-9505.27 7028.69,-9510.55 7029.98,-9503.67"/>
</g>
<!-- Expert14_s0_l8_tp3&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1183" class="edge">
<title>Expert14_s0_l8_tp3&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M7563.02,-9550.72C7560.13,-9550.33 7557.26,-9549.95 7554.42,-9549.57 7396.67,-9528.9 7217.87,-9510.14 7082.51,-9496.89"/>
<polygon fill="black" stroke="black" points="7082.72,-9493.39 7072.43,-9495.9 7082.04,-9500.36 7082.72,-9493.39"/>
</g>
<!-- Expert15_s0_l8_tp3&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1184" class="edge">
<title>Expert15_s0_l8_tp3&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M7889.03,-9550.58C7886.14,-9550.23 7883.27,-9549.9 7880.42,-9549.57 7616.15,-9519.48 7311.51,-9499.66 7106.29,-9488.47"/>
<polygon fill="black" stroke="black" points="7106.46,-9484.97 7096.29,-9487.93 7106.08,-9491.96 7106.46,-9484.97"/>
</g>
<!-- Expert16_s0_l8_tp4&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1185" class="edge">
<title>Expert16_s0_l8_tp4&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M8215.04,-9550.52C8212.15,-9550.19 8209.27,-9549.87 8206.42,-9549.57 7826.67,-9509.68 7383.79,-9491.14 7115.14,-9482.98"/>
<polygon fill="black" stroke="black" points="7114.97,-9479.47 7104.87,-9482.67 7114.76,-9486.47 7114.97,-9479.47"/>
</g>
<!-- Expert17_s0_l8_tp4&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1186" class="edge">
<title>Expert17_s0_l8_tp4&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M8541.04,-9550.47C8538.15,-9550.16 8535.27,-9549.86 8532.42,-9549.57 8032.03,-9499.69 7443.55,-9484.13 7117.92,-9479.29"/>
<polygon fill="black" stroke="black" points="7117.94,-9475.79 7107.89,-9479.14 7117.83,-9482.78 7117.94,-9475.79"/>
</g>
<!-- Expert18_s0_l8_tp4&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1187" class="edge">
<title>Expert18_s0_l8_tp4&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M8867.05,-9550.45C8864.15,-9550.14 8861.27,-9549.85 8858.42,-9549.57 8234.45,-9489.61 7496.02,-9478.24 7118.68,-9476.7"/>
<polygon fill="black" stroke="black" points="7118.47,-9473.2 7108.45,-9476.66 7118.44,-9480.2 7118.47,-9473.2"/>
</g>
<!-- Expert19_s0_l8_tp4&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1188" class="edge">
<title>Expert19_s0_l8_tp4&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M9193.05,-9550.43C9190.15,-9550.12 9187.27,-9549.84 9184.42,-9549.57 8789.56,-9512.65 7628.77,-9489.6 7116.82,-9480.96"/>
<polygon fill="black" stroke="black" points="7116.77,-9477.46 7106.71,-9480.79 7116.65,-9484.46 7116.77,-9477.46"/>
</g>
<!-- Expert20_s0_l8_tp5&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1189" class="edge">
<title>Expert20_s0_l8_tp5&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M2003.79,-9550.36C2006.69,-9550.08 2009.57,-9549.82 2012.42,-9549.57 2472.03,-9510.39 5693.69,-9485.24 6620.54,-9478.76"/>
<polygon fill="black" stroke="black" points="6620.69,-9482.26 6630.66,-9478.69 6620.64,-9475.26 6620.69,-9482.26"/>
</g>
<!-- Expert21_s0_l8_tp5&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1190" class="edge">
<title>Expert21_s0_l8_tp5&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M2329.79,-9550.37C2332.69,-9550.08 2335.57,-9549.82 2338.42,-9549.57 3180.13,-9477.36 5798.39,-9475.3 6620.1,-9476.51"/>
<polygon fill="black" stroke="black" points="6620.27,-9480.01 6630.28,-9476.53 6620.28,-9473.01 6620.27,-9480.01"/>
</g>
<!-- Expert22_s0_l8_tp5&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1191" class="edge">
<title>Expert22_s0_l8_tp5&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M2655.79,-9550.37C2658.69,-9550.09 2661.57,-9549.82 2664.42,-9549.57 3439.47,-9482.59 5837.74,-9476.9 6619.94,-9476.88"/>
<polygon fill="black" stroke="black" points="6620.2,-9480.38 6630.2,-9476.88 6620.2,-9473.38 6620.2,-9480.38"/>
</g>
<!-- Expert23_s0_l8_tp5&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1192" class="edge">
<title>Expert23_s0_l8_tp5&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M2981.79,-9550.38C2984.69,-9550.09 2987.57,-9549.82 2990.42,-9549.57 3699.13,-9487.81 5879.28,-9478.63 6620.08,-9477.3"/>
<polygon fill="black" stroke="black" points="6620.35,-9480.8 6630.34,-9477.29 6620.34,-9473.8 6620.35,-9480.8"/>
</g>
<!-- Expert24_s0_l8_tp6&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1193" class="edge">
<title>Expert24_s0_l8_tp6&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M10823.05,-9550.37C10820.16,-9550.09 10817.28,-9549.82 10814.42,-9549.57 10092.29,-9486.75 7868.02,-9478.27 7118.75,-9477.21"/>
<polygon fill="black" stroke="black" points="7118.65,-9473.71 7108.64,-9477.2 7118.64,-9480.71 7118.65,-9473.71"/>
</g>
<!-- Expert25_s0_l8_tp6&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1194" class="edge">
<title>Expert25_s0_l8_tp6&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M11149.05,-9550.37C11146.16,-9550.09 11143.28,-9549.82 11140.42,-9549.57 10351.85,-9481.53 7908.87,-9476.57 7118.72,-9476.8"/>
<polygon fill="black" stroke="black" points="7118.64,-9473.3 7108.64,-9476.8 7118.64,-9480.3 7118.64,-9473.3"/>
</g>
<!-- Expert26_s0_l8_tp6&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1195" class="edge">
<title>Expert26_s0_l8_tp6&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M11475.05,-9550.36C11472.16,-9550.08 11469.28,-9549.82 11466.42,-9549.57 10611.21,-9476.3 7948.35,-9474.99 7118.77,-9476.44"/>
<polygon fill="black" stroke="black" points="7118.49,-9472.94 7108.49,-9476.46 7118.5,-9479.94 7118.49,-9472.94"/>
</g>
<!-- Expert27_s0_l8_tp6&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1196" class="edge">
<title>Expert27_s0_l8_tp6&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M11801.06,-9550.36C11798.16,-9550.08 11795.28,-9549.82 11792.42,-9549.57 11325.97,-9509.85 8052.76,-9485.04 7118.09,-9478.71"/>
<polygon fill="black" stroke="black" points="7117.91,-9475.2 7107.88,-9478.64 7117.86,-9482.2 7117.91,-9475.2"/>
</g>
<!-- Expert28_s0_l8_tp7&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1197" class="edge">
<title>Expert28_s0_l8_tp7&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M9519.05,-9550.41C9516.15,-9550.11 9513.27,-9549.83 9510.42,-9549.57 9050.98,-9507.5 7682.75,-9486.8 7117.74,-9479.86"/>
<polygon fill="black" stroke="black" points="7117.47,-9476.35 7107.43,-9479.73 7117.38,-9483.35 7117.47,-9476.35"/>
</g>
<!-- Expert29_s0_l8_tp7&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1198" class="edge">
<title>Expert29_s0_l8_tp7&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M9845.05,-9550.4C9842.15,-9550.11 9839.28,-9549.83 9836.42,-9549.57 9311.85,-9502.34 7732.92,-9484.32 7118.18,-9478.98"/>
<polygon fill="black" stroke="black" points="7117.88,-9475.48 7107.85,-9478.89 7117.82,-9482.48 7117.88,-9475.48"/>
</g>
<!-- Expert30_s0_l8_tp7&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1199" class="edge">
<title>Expert30_s0_l8_tp7&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M10171.05,-9550.39C10168.15,-9550.1 10165.28,-9549.83 10162.42,-9549.57 9572.28,-9497.15 7780.01,-9482.11 7118.33,-9478.28"/>
<polygon fill="black" stroke="black" points="7118.21,-9474.78 7108.19,-9478.22 7118.17,-9481.78 7118.21,-9474.78"/>
</g>
<!-- Expert31_s0_l8_tp7&#45;&gt;AR_exp_s0_l8 -->
<g id="edge1200" class="edge">
<title>Expert31_s0_l8_tp7&#45;&gt;AR_exp_s0_l8</title>
<path fill="none" stroke="black" d="M10497.05,-9550.38C10494.15,-9550.09 10491.28,-9549.82 10488.42,-9549.57 9832.39,-9491.95 7824.77,-9480.1 7118.43,-9477.7"/>
<polygon fill="black" stroke="black" points="7118.39,-9474.2 7108.38,-9477.66 7118.37,-9481.2 7118.39,-9474.2"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp0 -->
<g id="edge1201" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp0</title>
<path fill="none" stroke="black" d="M6815.26,-9439.43C6800.49,-9429.7 6784.11,-9418.91 6767.99,-9408.29"/>
<polygon fill="black" stroke="black" points="6769.87,-9405.34 6759.59,-9402.76 6766.02,-9411.19 6769.87,-9405.34"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp1 -->
<g id="edge1203" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp1</title>
<path fill="none" stroke="black" d="M6640.41,-9465.19C6322.44,-9451.41 5729.2,-9425.53 5223.42,-9402.62 4950.53,-9390.26 4640.16,-9375.78 4415.96,-9365.24"/>
<polygon fill="black" stroke="black" points="4415.84,-9361.73 4405.69,-9364.76 4415.51,-9368.72 4415.84,-9361.73"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp2 -->
<g id="edge1205" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp2</title>
<path fill="none" stroke="black" d="M6668.68,-9455.68C6467.33,-9436.21 6153.71,-9405.87 5915.11,-9382.8"/>
<polygon fill="black" stroke="black" points="5915.17,-9379.29 5904.88,-9381.81 5914.49,-9386.25 5915.17,-9379.29"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp3 -->
<g id="edge1207" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp3</title>
<path fill="none" stroke="black" d="M7019.19,-9446.85C7101.57,-9431.31 7205.57,-9411.7 7298.15,-9394.24"/>
<polygon fill="black" stroke="black" points="7299.04,-9397.63 7308.22,-9392.34 7297.75,-9390.75 7299.04,-9397.63"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp4 -->
<g id="edge1209" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp4</title>
<path fill="none" stroke="black" d="M7097.04,-9464.59C7591.78,-9441.76 8763.28,-9387.69 9295.24,-9363.14"/>
<polygon fill="black" stroke="black" points="9295.53,-9366.63 9305.36,-9362.67 9295.21,-9359.63 9295.53,-9366.63"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp5 -->
<g id="edge1211" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp5</title>
<path fill="none" stroke="black" d="M6633.45,-9469.98C6112.61,-9458.62 4825.29,-9430.09 3747.42,-9402.62 3192.65,-9388.48 2545.54,-9370.11 2175.21,-9359.41"/>
<polygon fill="black" stroke="black" points="2175.25,-9355.91 2165.15,-9359.12 2175.05,-9362.91 2175.25,-9355.91"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp6 -->
<g id="edge1213" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp6</title>
<path fill="none" stroke="black" d="M7107.78,-9473.06C7905.16,-9465.95 10475.69,-9440.59 11303.42,-9402.62 11446.34,-9396.06 11605.64,-9384.33 11735.04,-9373.67"/>
<polygon fill="black" stroke="black" points="11735.41,-9377.15 11745.09,-9372.83 11734.84,-9370.17 11735.41,-9377.15"/>
</g>
<!-- AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp7 -->
<g id="edge1215" class="edge">
<title>AR_exp_s0_l8&#45;&gt;ResMOE_s0_l8_tp7</title>
<path fill="none" stroke="black" d="M7106.75,-9471.67C7620.71,-9463.77 8875.03,-9441.87 9925.42,-9402.62 10180.68,-9393.08 10471.69,-9377.79 10677.19,-9366.25"/>
<polygon fill="black" stroke="black" points="10677.43,-9369.74 10687.21,-9365.69 10677.03,-9362.76 10677.43,-9369.74"/>
</g>
<!-- QKV_s1_l9_tp0 -->
<g id="node730" class="node">
<title>QKV_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="5899.42,-9260.62 5561.42,-9260.62 5561.42,-9207.62 5899.42,-9207.62 5899.42,-9260.62"/>
<text text-anchor="middle" x="5730.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5730.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5730.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp0 -->
<g id="edge1217" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6346.56,-9308.88C6219.98,-9293.8 6074.54,-9276.44 5942.42,-9260.62 5931.78,-9259.35 5920.85,-9258.03 5909.81,-9256.71"/>
<polygon fill="black" stroke="black" points="5910,-9253.21 5899.65,-9255.49 5909.17,-9260.16 5910,-9253.21"/>
</g>
<!-- QKV_s1_l9_tp1 -->
<g id="node731" class="node">
<title>QKV_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="6289.42,-9260.62 5951.42,-9260.62 5951.42,-9207.62 6289.42,-9207.62 6289.42,-9260.62"/>
<text text-anchor="middle" x="6120.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6120.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6120.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp1 -->
<g id="edge1218" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6423.78,-9296.6C6366.04,-9284.9 6306.98,-9272.93 6256.49,-9262.7"/>
<polygon fill="black" stroke="black" points="6257,-9259.23 6246.51,-9260.67 6255.61,-9266.09 6257,-9259.23"/>
</g>
<!-- QKV_s1_l9_tp2 -->
<g id="node732" class="node">
<title>QKV_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="6670.42,-9260.62 6332.42,-9260.62 6332.42,-9207.62 6670.42,-9207.62 6670.42,-9260.62"/>
<text text-anchor="middle" x="6501.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6501.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6501.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp2 -->
<g id="edge1219" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6598.26,-9296.52C6581.82,-9286.1 6565.04,-9275.46 6550.18,-9266.03"/>
<polygon fill="black" stroke="black" points="6551.98,-9263.03 6541.66,-9260.63 6548.23,-9268.94 6551.98,-9263.03"/>
</g>
<!-- QKV_s1_l9_tp3 -->
<g id="node733" class="node">
<title>QKV_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7035.42,-9260.62 6697.42,-9260.62 6697.42,-9207.62 7035.42,-9207.62 7035.42,-9260.62"/>
<text text-anchor="middle" x="6866.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6866.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6866.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp3 -->
<g id="edge1220" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6765.8,-9296.52C6782.89,-9286.1 6800.31,-9275.46 6815.76,-9266.03"/>
<polygon fill="black" stroke="black" points="6817.9,-9268.83 6824.61,-9260.63 6814.25,-9262.85 6817.9,-9268.83"/>
</g>
<!-- QKV_s1_l9_tp4 -->
<g id="node734" class="node">
<title>QKV_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="7416.42,-9260.62 7078.42,-9260.62 7078.42,-9207.62 7416.42,-9207.62 7416.42,-9260.62"/>
<text text-anchor="middle" x="7247.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7247.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7247.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp4 -->
<g id="edge1221" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M6898.83,-9304.9C6969.75,-9290.7 7046.42,-9275.36 7109.74,-9262.68"/>
<polygon fill="black" stroke="black" points="7110.67,-9266.06 7119.79,-9260.67 7109.3,-9259.2 7110.67,-9266.06"/>
</g>
<!-- QKV_s1_l9_tp5 -->
<g id="node735" class="node">
<title>QKV_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="7802.42,-9260.62 7464.42,-9260.62 7464.42,-9207.62 7802.42,-9207.62 7802.42,-9260.62"/>
<text text-anchor="middle" x="7633.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7633.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7633.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp5 -->
<g id="edge1222" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M6919.93,-9320.6C7066.01,-9303.44 7256.52,-9280.95 7425.42,-9260.62 7434.81,-9259.49 7444.43,-9258.33 7454.14,-9257.15"/>
<polygon fill="black" stroke="black" points="7454.78,-9260.6 7464.29,-9255.92 7453.94,-9253.65 7454.78,-9260.6"/>
</g>
<!-- QKV_s1_l9_tp6 -->
<g id="node736" class="node">
<title>QKV_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="8190.42,-9260.62 7852.42,-9260.62 7852.42,-9207.62 8190.42,-9207.62 8190.42,-9260.62"/>
<text text-anchor="middle" x="8021.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="8021.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8021.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp6 -->
<g id="edge1223" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M6920.39,-9320.75C6999.89,-9312.16 7088.89,-9303.23 7170.42,-9296.62 7454.83,-9273.56 7527.2,-9285.83 7811.42,-9260.62 7821.47,-9259.73 7831.78,-9258.73 7842.18,-9257.67"/>
<polygon fill="black" stroke="black" points="7842.59,-9261.15 7852.18,-9256.63 7841.87,-9254.18 7842.59,-9261.15"/>
</g>
<!-- QKV_s1_l9_tp7 -->
<g id="node737" class="node">
<title>QKV_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="5517.42,-9260.62 5179.42,-9260.62 5179.42,-9207.62 5517.42,-9207.62 5517.42,-9260.62"/>
<text text-anchor="middle" x="5348.42" y="-9245.42" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5348.42" y="-9230.42" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5348.42" y="-9215.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp7 -->
<g id="edge1224" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;QKV_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M6373.07,-9328.52C6146.08,-9312.73 5829.68,-9288.75 5552.42,-9260.62 5544.34,-9259.8 5536.09,-9258.92 5527.76,-9258.01"/>
<polygon fill="black" stroke="black" points="5527.88,-9254.5 5517.56,-9256.88 5527.11,-9261.46 5527.88,-9254.5"/>
</g>
<!-- ResAttn_s1_l9_tp0 -->
<g id="node764" class="node">
<title>ResAttn_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6076.77,-8682.71 5519.45,-8682.71 5376.08,-8576.71 5933.4,-8576.71 6076.77,-8682.71"/>
<text text-anchor="middle" x="5726.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5726.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5726.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp0 -->
<g id="edge1266" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6368.15,-9325.01C6236.48,-9315.48 6081.53,-9304.82 5941.42,-9296.62 5855.81,-9291.61 5242.9,-9306.46 5170.42,-9260.62 5121.69,-9229.8 5109.42,-9203.78 5109.42,-9146.12 5109.42,-9146.12 5109.42,-9146.12 5109.42,-8844.19 5109.42,-8760.73 5313.6,-8702.65 5487.05,-8668.36"/>
<polygon fill="black" stroke="black" points="5487.97,-8671.75 5497.11,-8666.39 5486.63,-8664.88 5487.97,-8671.75"/>
</g>
<!-- ResAttn_s1_l9_tp1 -->
<g id="node765" class="node">
<title>ResAttn_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="4217.77,-8682.71 3660.45,-8682.71 3517.08,-8576.71 4074.4,-8576.71 4217.77,-8682.71"/>
<text text-anchor="middle" x="3867.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3867.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3867.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp1 -->
<g id="edge1268" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6366.4,-9323.69C6235.13,-9314.01 6080.96,-9303.59 5941.42,-9296.62 5400.97,-9269.62 5262.71,-9315.99 4724.42,-9260.62 4579.39,-9245.7 4078.42,-9291.91 4078.42,-9146.12 4078.42,-9146.12 4078.42,-9146.12 4078.42,-8844.19 4078.42,-8778.16 4026.72,-8725.19 3974.5,-8688.53"/>
<polygon fill="black" stroke="black" points="3976.35,-8685.56 3966.13,-8682.79 3972.4,-8691.33 3976.35,-8685.56"/>
</g>
<!-- ResAttn_s1_l9_tp2 -->
<g id="node766" class="node">
<title>ResAttn_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="5065.77,-8682.71 4508.45,-8682.71 4365.08,-8576.71 4922.4,-8576.71 5065.77,-8682.71"/>
<text text-anchor="middle" x="4715.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4715.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4715.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp2 -->
<g id="edge1270" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6368.16,-9324.8C6236.49,-9315.23 6081.55,-9304.61 5941.42,-9296.62 5575,-9275.74 5478.7,-9319.41 5116.42,-9260.62 4933.47,-9230.93 4715.42,-9331.46 4715.42,-9146.12 4715.42,-9146.12 4715.42,-9146.12 4715.42,-8844.19 4715.42,-8793.35 4715.42,-8735.69 4715.42,-8693.12"/>
<polygon fill="black" stroke="black" points="4718.92,-8692.91 4715.42,-8682.91 4711.92,-8692.91 4718.92,-8692.91"/>
</g>
<!-- ResAttn_s1_l9_tp3 -->
<g id="node767" class="node">
<title>ResAttn_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="8146.77,-8682.71 7589.45,-8682.71 7446.08,-8576.71 8003.4,-8576.71 8146.77,-8682.71"/>
<text text-anchor="middle" x="7796.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7796.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7796.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp3 -->
<g id="edge1272" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6919.07,-9319.87C6998.88,-9311.17 7088.39,-9302.4 7170.42,-9296.62 7227.48,-9292.6 8150.21,-9289.78 8199.42,-9260.62 8250.34,-9230.45 8267.42,-9205.31 8267.42,-9146.12 8267.42,-9146.12 8267.42,-9146.12 8267.42,-8844.19 8267.42,-8767.72 8215.28,-8718.5 8145.7,-8686.87"/>
<polygon fill="black" stroke="black" points="8146.79,-8683.53 8136.22,-8682.72 8143.98,-8689.94 8146.79,-8683.53"/>
</g>
<!-- ResAttn_s1_l9_tp4 -->
<g id="node768" class="node">
<title>ResAttn_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="9011.77,-8682.71 8454.45,-8682.71 8311.08,-8576.71 8868.4,-8576.71 9011.77,-8682.71"/>
<text text-anchor="middle" x="8661.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8661.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8661.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp4 -->
<g id="edge1274" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M6919.07,-9319.81C6998.88,-9311.1 7088.39,-9302.34 7170.42,-9296.62 7336.53,-9285.03 8661.42,-9312.63 8661.42,-9146.12 8661.42,-9146.12 8661.42,-9146.12 8661.42,-8844.19 8661.42,-8793.35 8661.42,-8735.69 8661.42,-8693.12"/>
<polygon fill="black" stroke="black" points="8664.92,-8692.91 8661.42,-8682.91 8657.92,-8692.91 8664.92,-8692.91"/>
</g>
<!-- ResAttn_s1_l9_tp5 -->
<g id="node769" class="node">
<title>ResAttn_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="3076.77,-8682.71 2519.45,-8682.71 2376.08,-8576.71 2933.4,-8576.71 3076.77,-8682.71"/>
<text text-anchor="middle" x="2726.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2726.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2726.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp5 -->
<g id="edge1276" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M6365.52,-9322.94C6234.46,-9313.17 6080.67,-9302.89 5941.42,-9296.62 5536.64,-9278.39 4521.29,-9303.96 4118.42,-9260.62 3856.74,-9232.47 3537.42,-9409.31 3537.42,-9146.12 3537.42,-9146.12 3537.42,-9146.12 3537.42,-8844.19 3537.42,-8738.39 3276.02,-8683.91 3050.03,-8656.59"/>
<polygon fill="black" stroke="black" points="3050.32,-8653.1 3039.98,-8655.38 3049.49,-8660.05 3050.32,-8653.1"/>
</g>
<!-- ResAttn_s1_l9_tp6 -->
<g id="node770" class="node">
<title>ResAttn_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="11102.77,-8682.71 10545.45,-8682.71 10402.08,-8576.71 10959.4,-8576.71 11102.77,-8682.71"/>
<text text-anchor="middle" x="10752.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10752.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10752.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp6 -->
<g id="edge1278" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M6918.09,-9319.31C6998.13,-9310.53 7088.04,-9301.85 7170.42,-9296.62 7350.09,-9285.2 10407.42,-9326.15 10407.42,-9146.12 10407.42,-9146.12 10407.42,-9146.12 10407.42,-8844.19 10407.42,-8769.03 10467.37,-8719.44 10537.28,-8687.15"/>
<polygon fill="black" stroke="black" points="10539.06,-8690.19 10546.75,-8682.91 10536.2,-8683.81 10539.06,-8690.19"/>
</g>
<!-- ResAttn_s1_l9_tp7 -->
<g id="node771" class="node">
<title>ResAttn_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="10005.77,-8682.71 9448.45,-8682.71 9305.08,-8576.71 9862.4,-8576.71 10005.77,-8682.71"/>
<text text-anchor="middle" x="9655.42" y="-8641.01" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9655.42" y="-8626.01" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9655.42" y="-8611.01" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp7 -->
<g id="edge1280" class="edge">
<title>ResMOE_s0_l8_tp0&#45;&gt;ResAttn_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M6918.74,-9319.58C6998.62,-9310.84 7088.27,-9302.13 7170.42,-9296.62 7737.38,-9258.61 7882.06,-9306.61 8448.42,-9260.62 8638.39,-9245.19 9298.42,-9336.71 9298.42,-9146.12 9298.42,-9146.12 9298.42,-9146.12 9298.42,-8844.19 9298.42,-8766.28 9361.83,-8716.12 9435.19,-8684.16"/>
<polygon fill="black" stroke="black" points="9436.81,-8687.28 9444.66,-8680.16 9434.08,-8680.83 9436.81,-8687.28"/>
</g>
<!-- SplitHeads_s1_l9_tp0 -->
<g id="node738" class="node">
<title>SplitHeads_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="5899.42,-9171.62 5527.42,-9171.62 5527.42,-9118.62 5899.42,-9118.62 5899.42,-9171.62"/>
<text text-anchor="middle" x="5713.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5713.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5713.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp0&#45;&gt;SplitHeads_s1_l9_tp0 -->
<g id="edge1225" class="edge">
<title>QKV_s1_l9_tp0&#45;&gt;SplitHeads_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M5725.41,-9207.49C5723.84,-9199.42 5722.07,-9190.35 5720.38,-9181.72"/>
<polygon fill="black" stroke="black" points="5723.81,-9181.01 5718.45,-9171.87 5716.94,-9182.36 5723.81,-9181.01"/>
</g>
<!-- SplitHeads_s1_l9_tp1 -->
<g id="node739" class="node">
<title>SplitHeads_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="6289.42,-9171.62 5917.42,-9171.62 5917.42,-9118.62 6289.42,-9118.62 6289.42,-9171.62"/>
<text text-anchor="middle" x="6103.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6103.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6103.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp1&#45;&gt;SplitHeads_s1_l9_tp1 -->
<g id="edge1226" class="edge">
<title>QKV_s1_l9_tp1&#45;&gt;SplitHeads_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6115.41,-9207.49C6113.84,-9199.42 6112.07,-9190.35 6110.38,-9181.72"/>
<polygon fill="black" stroke="black" points="6113.81,-9181.01 6108.45,-9171.87 6106.94,-9182.36 6113.81,-9181.01"/>
</g>
<!-- SplitHeads_s1_l9_tp2 -->
<g id="node740" class="node">
<title>SplitHeads_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="6679.42,-9171.62 6307.42,-9171.62 6307.42,-9118.62 6679.42,-9118.62 6679.42,-9171.62"/>
<text text-anchor="middle" x="6493.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6493.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6493.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp2&#45;&gt;SplitHeads_s1_l9_tp2 -->
<g id="edge1227" class="edge">
<title>QKV_s1_l9_tp2&#45;&gt;SplitHeads_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6499.07,-9207.49C6498.33,-9199.51 6497.51,-9190.55 6496.72,-9182"/>
<polygon fill="black" stroke="black" points="6500.19,-9181.51 6495.79,-9171.87 6493.22,-9182.15 6500.19,-9181.51"/>
</g>
<!-- SplitHeads_s1_l9_tp3 -->
<g id="node741" class="node">
<title>SplitHeads_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7069.42,-9171.62 6697.42,-9171.62 6697.42,-9118.62 7069.42,-9118.62 7069.42,-9171.62"/>
<text text-anchor="middle" x="6883.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6883.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6883.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp3&#45;&gt;SplitHeads_s1_l9_tp3 -->
<g id="edge1228" class="edge">
<title>QKV_s1_l9_tp3&#45;&gt;SplitHeads_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6871.43,-9207.49C6873.01,-9199.42 6874.78,-9190.35 6876.47,-9181.72"/>
<polygon fill="black" stroke="black" points="6879.91,-9182.36 6878.39,-9171.87 6873.04,-9181.01 6879.91,-9182.36"/>
</g>
<!-- SplitHeads_s1_l9_tp4 -->
<g id="node742" class="node">
<title>SplitHeads_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="7459.42,-9171.62 7087.42,-9171.62 7087.42,-9118.62 7459.42,-9118.62 7459.42,-9171.62"/>
<text text-anchor="middle" x="7273.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7273.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7273.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp4&#45;&gt;SplitHeads_s1_l9_tp4 -->
<g id="edge1229" class="edge">
<title>QKV_s1_l9_tp4&#45;&gt;SplitHeads_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M7255.08,-9207.49C7257.49,-9199.42 7260.2,-9190.35 7262.78,-9181.72"/>
<polygon fill="black" stroke="black" points="7266.22,-9182.45 7265.73,-9171.87 7259.51,-9180.45 7266.22,-9182.45"/>
</g>
<!-- SplitHeads_s1_l9_tp5 -->
<g id="node743" class="node">
<title>SplitHeads_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="7849.42,-9171.62 7477.42,-9171.62 7477.42,-9118.62 7849.42,-9118.62 7849.42,-9171.62"/>
<text text-anchor="middle" x="7663.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7663.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7663.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp5&#45;&gt;SplitHeads_s1_l9_tp5 -->
<g id="edge1230" class="edge">
<title>QKV_s1_l9_tp5&#45;&gt;SplitHeads_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M7642.26,-9207.49C7645.07,-9199.33 7648.24,-9190.16 7651.24,-9181.44"/>
<polygon fill="black" stroke="black" points="7654.59,-9182.46 7654.54,-9171.87 7647.97,-9180.18 7654.59,-9182.46"/>
</g>
<!-- SplitHeads_s1_l9_tp6 -->
<g id="node744" class="node">
<title>SplitHeads_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="8239.42,-9171.62 7867.42,-9171.62 7867.42,-9118.62 8239.42,-9118.62 8239.42,-9171.62"/>
<text text-anchor="middle" x="8053.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="8053.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8053.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp6&#45;&gt;SplitHeads_s1_l9_tp6 -->
<g id="edge1231" class="edge">
<title>QKV_s1_l9_tp6&#45;&gt;SplitHeads_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M8030.85,-9207.49C8033.85,-9199.33 8037.22,-9190.16 8040.43,-9181.44"/>
<polygon fill="black" stroke="black" points="8043.78,-9182.46 8043.95,-9171.87 8037.21,-9180.05 8043.78,-9182.46"/>
</g>
<!-- SplitHeads_s1_l9_tp7 -->
<g id="node745" class="node">
<title>SplitHeads_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="5509.42,-9171.62 5137.42,-9171.62 5137.42,-9118.62 5509.42,-9118.62 5509.42,-9171.62"/>
<text text-anchor="middle" x="5323.42" y="-9156.42" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5323.42" y="-9141.42" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5323.42" y="-9126.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l9_tp7&#45;&gt;SplitHeads_s1_l9_tp7 -->
<g id="edge1232" class="edge">
<title>QKV_s1_l9_tp7&#45;&gt;SplitHeads_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M5341.06,-9207.49C5338.74,-9199.42 5336.13,-9190.35 5333.65,-9181.72"/>
<polygon fill="black" stroke="black" points="5336.95,-9180.51 5330.82,-9171.87 5330.22,-9182.45 5336.95,-9180.51"/>
</g>
<!-- A2A_s1_l9 -->
<g id="node746" class="node">
<title>A2A_s1_l9</title>
<ellipse fill="none" stroke="black" cx="6688.42" cy="-9045.14" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6688.42" y="-9056.44" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="6688.42" y="-9041.44" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6688.42" y="-9026.44" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l9_tp0&#45;&gt;A2A_s1_l9 -->
<g id="edge1233" class="edge">
<title>SplitHeads_s1_l9_tp0&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M5899.45,-9119.64C5902.46,-9119.29 5905.45,-9118.95 5908.42,-9118.62 6091.43,-9098.16 6299.05,-9079.07 6454.05,-9065.62"/>
<polygon fill="black" stroke="black" points="6454.53,-9069.09 6464.19,-9064.74 6453.92,-9062.12 6454.53,-9069.09"/>
</g>
<!-- SplitHeads_s1_l9_tp1&#45;&gt;A2A_s1_l9 -->
<g id="edge1234" class="edge">
<title>SplitHeads_s1_l9_tp1&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M6255.98,-9118.57C6334.22,-9105.47 6429.93,-9089.44 6511.41,-9075.79"/>
<polygon fill="black" stroke="black" points="6511.99,-9079.24 6521.27,-9074.14 6510.83,-9072.34 6511.99,-9079.24"/>
</g>
<!-- SplitHeads_s1_l9_tp2&#45;&gt;A2A_s1_l9 -->
<g id="edge1235" class="edge">
<title>SplitHeads_s1_l9_tp2&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M6544.4,-9118.51C6564.24,-9108.54 6587.43,-9096.89 6609.33,-9085.88"/>
<polygon fill="black" stroke="black" points="6610.94,-9088.99 6618.3,-9081.37 6607.8,-9082.74 6610.94,-9088.99"/>
</g>
<!-- SplitHeads_s1_l9_tp3&#45;&gt;A2A_s1_l9 -->
<g id="edge1236" class="edge">
<title>SplitHeads_s1_l9_tp3&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M6832.44,-9118.51C6812.61,-9108.54 6789.42,-9096.89 6767.51,-9085.88"/>
<polygon fill="black" stroke="black" points="6769.05,-9082.74 6758.54,-9081.37 6765.91,-9088.99 6769.05,-9082.74"/>
</g>
<!-- SplitHeads_s1_l9_tp4&#45;&gt;A2A_s1_l9 -->
<g id="edge1237" class="edge">
<title>SplitHeads_s1_l9_tp4&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M7120.87,-9118.57C7042.63,-9105.47 6946.91,-9089.44 6865.44,-9075.79"/>
<polygon fill="black" stroke="black" points="6866.02,-9072.34 6855.58,-9074.14 6864.86,-9079.24 6866.02,-9072.34"/>
</g>
<!-- SplitHeads_s1_l9_tp5&#45;&gt;A2A_s1_l9 -->
<g id="edge1238" class="edge">
<title>SplitHeads_s1_l9_tp5&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M7477.4,-9119.64C7474.39,-9119.29 7471.39,-9118.95 7468.42,-9118.62 7285.42,-9098.16 7077.79,-9079.07 6922.79,-9065.62"/>
<polygon fill="black" stroke="black" points="6922.92,-9062.12 6912.66,-9064.74 6922.32,-9069.09 6922.92,-9062.12"/>
</g>
<!-- SplitHeads_s1_l9_tp6&#45;&gt;A2A_s1_l9 -->
<g id="edge1239" class="edge">
<title>SplitHeads_s1_l9_tp6&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M7867.41,-9119.51C7864.39,-9119.2 7861.4,-9118.91 7858.42,-9118.62 7546.38,-9088.59 7186.25,-9068.46 6948.88,-9057.18"/>
<polygon fill="black" stroke="black" points="6948.88,-9053.68 6938.73,-9056.7 6948.55,-9060.67 6948.88,-9053.68"/>
</g>
<!-- SplitHeads_s1_l9_tp7&#45;&gt;A2A_s1_l9 -->
<g id="edge1240" class="edge">
<title>SplitHeads_s1_l9_tp7&#45;&gt;A2A_s1_l9</title>
<path fill="none" stroke="black" d="M5509.43,-9119.51C5512.45,-9119.2 5515.45,-9118.91 5518.42,-9118.62 5830.47,-9088.59 6190.6,-9068.46 6427.96,-9057.18"/>
<polygon fill="black" stroke="black" points="6428.29,-9060.67 6438.12,-9056.7 6427.96,-9053.68 6428.29,-9060.67"/>
</g>
<!-- Attn_s1_l9_tp0 -->
<g id="node747" class="node">
<title>Attn_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="5899.42,-8971.67 5527.42,-8971.67 5527.42,-8918.67 5899.42,-8918.67 5899.42,-8971.67"/>
<text text-anchor="middle" x="5713.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5713.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5713.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp0 -->
<g id="edge1241" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6464.19,-9025.54C6310.85,-9012.29 6102.7,-8993.24 5909.51,-8971.77"/>
<polygon fill="black" stroke="black" points="5909.77,-8968.28 5899.45,-8970.65 5909,-8975.24 5909.77,-8968.28"/>
</g>
<!-- Attn_s1_l9_tp1 -->
<g id="node748" class="node">
<title>Attn_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="6289.42,-8971.67 5917.42,-8971.67 5917.42,-8918.67 6289.42,-8918.67 6289.42,-8971.67"/>
<text text-anchor="middle" x="6103.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6103.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6103.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp1 -->
<g id="edge1242" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6521.18,-9016.13C6441.03,-9002.71 6345.42,-8986.7 6265.9,-8973.38"/>
<polygon fill="black" stroke="black" points="6266.23,-8969.88 6255.79,-8971.68 6265.07,-8976.79 6266.23,-8969.88"/>
</g>
<!-- Attn_s1_l9_tp2 -->
<g id="node749" class="node">
<title>Attn_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="6679.42,-8971.67 6307.42,-8971.67 6307.42,-8918.67 6679.42,-8918.67 6679.42,-8971.67"/>
<text text-anchor="middle" x="6493.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6493.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6493.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp2 -->
<g id="edge1243" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6618.3,-9008.91C6596.99,-8998.2 6573.79,-8986.55 6553.23,-8976.22"/>
<polygon fill="black" stroke="black" points="6554.8,-8973.09 6544.29,-8971.72 6551.65,-8979.34 6554.8,-8973.09"/>
</g>
<!-- Attn_s1_l9_tp3 -->
<g id="node750" class="node">
<title>Attn_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7069.42,-8971.67 6697.42,-8971.67 6697.42,-8918.67 7069.42,-8918.67 7069.42,-8971.67"/>
<text text-anchor="middle" x="6883.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6883.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6883.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp3 -->
<g id="edge1244" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6758.55,-9008.91C6779.85,-8998.2 6803.06,-8986.55 6823.62,-8976.22"/>
<polygon fill="black" stroke="black" points="6825.19,-8979.34 6832.55,-8971.72 6822.05,-8973.09 6825.19,-8979.34"/>
</g>
<!-- Attn_s1_l9_tp4 -->
<g id="node751" class="node">
<title>Attn_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="7459.42,-8971.67 7087.42,-8971.67 7087.42,-8918.67 7459.42,-8918.67 7459.42,-8971.67"/>
<text text-anchor="middle" x="7273.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7273.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7273.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp4 -->
<g id="edge1245" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M6855.67,-9016.13C6935.81,-9002.71 7031.43,-8986.7 7110.95,-8973.38"/>
<polygon fill="black" stroke="black" points="7111.77,-8976.79 7121.06,-8971.68 7110.62,-8969.88 7111.77,-8976.79"/>
</g>
<!-- Attn_s1_l9_tp5 -->
<g id="node752" class="node">
<title>Attn_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="7849.42,-8971.67 7477.42,-8971.67 7477.42,-8918.67 7849.42,-8918.67 7849.42,-8971.67"/>
<text text-anchor="middle" x="7663.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7663.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7663.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp5 -->
<g id="edge1246" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M6912.66,-9025.54C7066,-9012.29 7274.14,-8993.24 7467.34,-8971.77"/>
<polygon fill="black" stroke="black" points="7467.85,-8975.24 7477.4,-8970.65 7467.07,-8968.28 7467.85,-8975.24"/>
</g>
<!-- Attn_s1_l9_tp6 -->
<g id="node753" class="node">
<title>Attn_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="8239.42,-8971.67 7867.42,-8971.67 7867.42,-8918.67 8239.42,-8918.67 8239.42,-8971.67"/>
<text text-anchor="middle" x="8053.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8053.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8053.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp6 -->
<g id="edge1247" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M6938.73,-9033.58C7173.46,-9022.52 7534.4,-9002.55 7857.39,-8971.74"/>
<polygon fill="black" stroke="black" points="7857.79,-8975.22 7867.41,-8970.78 7857.12,-8968.25 7857.79,-8975.22"/>
</g>
<!-- Attn_s1_l9_tp7 -->
<g id="node754" class="node">
<title>Attn_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="5509.42,-8971.67 5137.42,-8971.67 5137.42,-8918.67 5509.42,-8918.67 5509.42,-8971.67"/>
<text text-anchor="middle" x="5323.42" y="-8956.47" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5323.42" y="-8941.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5323.42" y="-8926.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l9&#45;&gt;Attn_s1_l9_tp7 -->
<g id="edge1248" class="edge">
<title>A2A_s1_l9&#45;&gt;Attn_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M6438.12,-9033.58C6203.38,-9022.52 5842.44,-9002.55 5519.46,-8971.74"/>
<polygon fill="black" stroke="black" points="5519.72,-8968.25 5509.43,-8970.78 5519.05,-8975.22 5519.72,-8968.25"/>
</g>
<!-- AR_attn_s1_l9 -->
<g id="node755" class="node">
<title>AR_attn_s1_l9</title>
<ellipse fill="none" stroke="black" cx="6688.42" cy="-8845.19" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6688.42" y="-8856.49" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="6688.42" y="-8841.49" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6688.42" y="-8826.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l9_tp0&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1249" class="edge">
<title>Attn_s1_l9_tp0&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M5899.45,-8919.68C5902.46,-8919.34 5905.45,-8919 5908.42,-8918.67 6091.43,-8898.21 6299.05,-8879.11 6454.05,-8865.67"/>
<polygon fill="black" stroke="black" points="6454.53,-8869.14 6464.19,-8864.79 6453.92,-8862.16 6454.53,-8869.14"/>
</g>
<!-- Attn_s1_l9_tp1&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1250" class="edge">
<title>Attn_s1_l9_tp1&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M6255.98,-8918.62C6334.22,-8905.51 6429.93,-8889.48 6511.41,-8875.84"/>
<polygon fill="black" stroke="black" points="6511.99,-8879.29 6521.27,-8874.18 6510.83,-8872.38 6511.99,-8879.29"/>
</g>
<!-- Attn_s1_l9_tp2&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1251" class="edge">
<title>Attn_s1_l9_tp2&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M6544.4,-8918.55C6564.24,-8908.59 6587.43,-8896.93 6609.33,-8885.93"/>
<polygon fill="black" stroke="black" points="6610.94,-8889.04 6618.3,-8881.42 6607.8,-8882.78 6610.94,-8889.04"/>
</g>
<!-- Attn_s1_l9_tp3&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1252" class="edge">
<title>Attn_s1_l9_tp3&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M6832.44,-8918.55C6812.61,-8908.59 6789.42,-8896.93 6767.51,-8885.93"/>
<polygon fill="black" stroke="black" points="6769.05,-8882.78 6758.54,-8881.42 6765.91,-8889.04 6769.05,-8882.78"/>
</g>
<!-- Attn_s1_l9_tp4&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1253" class="edge">
<title>Attn_s1_l9_tp4&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M7120.87,-8918.62C7042.63,-8905.51 6946.91,-8889.48 6865.44,-8875.84"/>
<polygon fill="black" stroke="black" points="6866.02,-8872.38 6855.58,-8874.18 6864.86,-8879.29 6866.02,-8872.38"/>
</g>
<!-- Attn_s1_l9_tp5&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1254" class="edge">
<title>Attn_s1_l9_tp5&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M7477.4,-8919.68C7474.39,-8919.34 7471.39,-8919 7468.42,-8918.67 7285.42,-8898.21 7077.79,-8879.11 6922.79,-8865.67"/>
<polygon fill="black" stroke="black" points="6922.92,-8862.16 6912.66,-8864.79 6922.32,-8869.14 6922.92,-8862.16"/>
</g>
<!-- Attn_s1_l9_tp6&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1255" class="edge">
<title>Attn_s1_l9_tp6&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M7867.41,-8919.55C7864.39,-8919.25 7861.4,-8918.95 7858.42,-8918.67 7546.38,-8888.63 7186.25,-8868.5 6948.88,-8857.23"/>
<polygon fill="black" stroke="black" points="6948.88,-8853.73 6938.73,-8856.75 6948.55,-8860.72 6948.88,-8853.73"/>
</g>
<!-- Attn_s1_l9_tp7&#45;&gt;AR_attn_s1_l9 -->
<g id="edge1256" class="edge">
<title>Attn_s1_l9_tp7&#45;&gt;AR_attn_s1_l9</title>
<path fill="none" stroke="black" d="M5509.43,-8919.55C5512.45,-8919.25 5515.45,-8918.95 5518.42,-8918.67 5830.47,-8888.63 6190.6,-8868.5 6427.96,-8857.23"/>
<polygon fill="black" stroke="black" points="6428.29,-8860.72 6438.12,-8856.75 6427.96,-8853.73 6428.29,-8860.72"/>
</g>
<!-- O_s1_l9_tp0 -->
<g id="node756" class="node">
<title>O_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6649.42,-8771.71 6311.42,-8771.71 6311.42,-8718.71 6649.42,-8718.71 6649.42,-8771.71"/>
<text text-anchor="middle" x="6480.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6480.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6480.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp0 -->
<g id="edge1257" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6614.21,-8809.23C6591.24,-8798.41 6566.16,-8786.6 6543.98,-8776.15"/>
<polygon fill="black" stroke="black" points="6545.2,-8772.86 6534.66,-8771.76 6542.22,-8779.19 6545.2,-8772.86"/>
</g>
<!-- O_s1_l9_tp1 -->
<g id="node757" class="node">
<title>O_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="5081.42,-8771.71 4743.42,-8771.71 4743.42,-8718.71 5081.42,-8718.71 5081.42,-8771.71"/>
<text text-anchor="middle" x="4912.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4912.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4912.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp1 -->
<g id="edge1258" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6445.2,-8830.77C6083.61,-8810.82 5412.57,-8773.8 5091.98,-8756.12"/>
<polygon fill="black" stroke="black" points="5091.84,-8752.61 5081.67,-8755.55 5091.46,-8759.6 5091.84,-8752.61"/>
</g>
<!-- O_s1_l9_tp2 -->
<g id="node758" class="node">
<title>O_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="5878.42,-8771.71 5540.42,-8771.71 5540.42,-8718.71 5878.42,-8718.71 5878.42,-8771.71"/>
<text text-anchor="middle" x="5709.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5709.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5709.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp2 -->
<g id="edge1259" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6476.3,-8822.96C6300.88,-8805.4 6054.52,-8780.75 5888.79,-8764.16"/>
<polygon fill="black" stroke="black" points="5888.79,-8760.65 5878.49,-8763.13 5888.09,-8767.61 5888.79,-8760.65"/>
</g>
<!-- O_s1_l9_tp3 -->
<g id="node759" class="node">
<title>O_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7235.42,-8771.71 6897.42,-8771.71 6897.42,-8718.71 7235.42,-8718.71 7235.42,-8771.71"/>
<text text-anchor="middle" x="7066.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7066.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7066.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp3 -->
<g id="edge1260" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6812.19,-8812.11C6859.23,-8799.92 6912.42,-8786.13 6957.94,-8774.33"/>
<polygon fill="black" stroke="black" points="6959.03,-8777.67 6967.83,-8771.77 6957.27,-8770.89 6959.03,-8777.67"/>
</g>
<!-- O_s1_l9_tp4 -->
<g id="node760" class="node">
<title>O_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="8023.42,-8771.71 7685.42,-8771.71 7685.42,-8718.71 8023.42,-8718.71 8023.42,-8771.71"/>
<text text-anchor="middle" x="7854.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7854.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7854.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp4 -->
<g id="edge1261" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M6912.2,-8825.39C7134.27,-8806.73 7470.27,-8778.49 7675.28,-8761.27"/>
<polygon fill="black" stroke="black" points="7675.57,-8764.75 7685.25,-8760.43 7674.99,-8757.78 7675.57,-8764.75"/>
</g>
<!-- O_s1_l9_tp5 -->
<g id="node761" class="node">
<title>O_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="4606.42,-8771.71 4268.42,-8771.71 4268.42,-8718.71 4606.42,-8718.71 4606.42,-8771.71"/>
<text text-anchor="middle" x="4437.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4437.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4437.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp5 -->
<g id="edge1262" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M6429.44,-8838.59C6055.1,-8829.58 5341.14,-8808.99 4734.42,-8771.71 4696.37,-8769.38 4655.62,-8766.27 4616.89,-8763.04"/>
<polygon fill="black" stroke="black" points="4616.81,-8759.52 4606.55,-8762.17 4616.22,-8766.49 4616.81,-8759.52"/>
</g>
<!-- O_s1_l9_tp6 -->
<g id="node762" class="node">
<title>O_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="9189.42,-8771.71 8851.42,-8771.71 8851.42,-8718.71 9189.42,-8718.71 9189.42,-8771.71"/>
<text text-anchor="middle" x="9020.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="9020.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9020.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp6 -->
<g id="edge1263" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M6945.37,-8837.14C7319.07,-8826.32 8034.33,-8803.49 8642.42,-8771.71 8707.27,-8768.32 8778.31,-8763.76 8841.13,-8759.42"/>
<polygon fill="black" stroke="black" points="8841.4,-8762.91 8851.14,-8758.73 8840.92,-8755.93 8841.4,-8762.91"/>
</g>
<!-- O_s1_l9_tp7 -->
<g id="node763" class="node">
<title>O_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="8633.42,-8771.71 8295.42,-8771.71 8295.42,-8718.71 8633.42,-8718.71 8633.42,-8771.71"/>
<text text-anchor="middle" x="8464.42" y="-8756.51" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8464.42" y="-8741.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8464.42" y="-8726.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l9&#45;&gt;O_s1_l9_tp7 -->
<g id="edge1264" class="edge">
<title>AR_attn_s1_l9&#45;&gt;O_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M6933.08,-8831.37C7202.46,-8817.17 7648.35,-8793.4 8032.42,-8771.71 8115.34,-8767.03 8207.19,-8761.64 8284.81,-8757.02"/>
<polygon fill="black" stroke="black" points="8285.4,-8760.49 8295.17,-8756.4 8284.98,-8753.5 8285.4,-8760.49"/>
</g>
<!-- O_s1_l9_tp0&#45;&gt;ResAttn_s1_l9_tp0 -->
<g id="edge1265" class="edge">
<title>O_s1_l9_tp0&#45;&gt;ResAttn_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6311.21,-8718.74C6243.24,-8708.51 6162.16,-8696.3 6082.34,-8684.29"/>
<polygon fill="black" stroke="black" points="6082.52,-8680.78 6072.11,-8682.75 6081.47,-8687.7 6082.52,-8680.78"/>
</g>
<!-- O_s1_l9_tp1&#45;&gt;ResAttn_s1_l9_tp1 -->
<g id="edge1267" class="edge">
<title>O_s1_l9_tp1&#45;&gt;ResAttn_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M4743.36,-8725.85C4598.58,-8710.13 4385.64,-8687 4205.97,-8667.48"/>
<polygon fill="black" stroke="black" points="4206.14,-8663.98 4195.82,-8666.38 4205.38,-8670.94 4206.14,-8663.98"/>
</g>
<!-- O_s1_l9_tp2&#45;&gt;ResAttn_s1_l9_tp2 -->
<g id="edge1269" class="edge">
<title>O_s1_l9_tp2&#45;&gt;ResAttn_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M5540.24,-8724.9C5408.06,-8709.8 5220.04,-8688.33 5056.89,-8669.7"/>
<polygon fill="black" stroke="black" points="5057.01,-8666.19 5046.68,-8668.54 5056.22,-8673.15 5057.01,-8666.19"/>
</g>
<!-- O_s1_l9_tp3&#45;&gt;ResAttn_s1_l9_tp3 -->
<g id="edge1271" class="edge">
<title>O_s1_l9_tp3&#45;&gt;ResAttn_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M7230.7,-8718.67C7326.92,-8703.71 7450.15,-8684.55 7557.02,-8667.93"/>
<polygon fill="black" stroke="black" points="7557.64,-8671.38 7566.98,-8666.39 7556.56,-8664.46 7557.64,-8671.38"/>
</g>
<!-- O_s1_l9_tp4&#45;&gt;ResAttn_s1_l9_tp4 -->
<g id="edge1273" class="edge">
<title>O_s1_l9_tp4&#45;&gt;ResAttn_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M8023.6,-8720.42C8138.01,-8704.33 8290.89,-8682.83 8418.29,-8664.91"/>
<polygon fill="black" stroke="black" points="8418.78,-8668.37 8428.2,-8663.51 8417.81,-8661.44 8418.78,-8668.37"/>
</g>
<!-- O_s1_l9_tp5&#45;&gt;ResAttn_s1_l9_tp5 -->
<g id="edge1275" class="edge">
<title>O_s1_l9_tp5&#45;&gt;ResAttn_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M4268.32,-8733.03C4082.14,-8720.72 3773.93,-8700.33 3508.42,-8682.71 3355.79,-8672.59 3186.39,-8661.32 3044.4,-8651.88"/>
<polygon fill="black" stroke="black" points="3044.43,-8648.37 3034.22,-8651.2 3043.97,-8655.36 3044.43,-8648.37"/>
</g>
<!-- O_s1_l9_tp6&#45;&gt;ResAttn_s1_l9_tp6 -->
<g id="edge1277" class="edge">
<title>O_s1_l9_tp6&#45;&gt;ResAttn_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M9189.73,-8734.18C9387.58,-8722.35 9724.8,-8701.88 10014.42,-8682.71 10172.12,-8672.28 10348.72,-8659.86 10489.62,-8649.78"/>
<polygon fill="black" stroke="black" points="10489.98,-8653.26 10499.7,-8649.06 10489.48,-8646.28 10489.98,-8653.26"/>
</g>
<!-- O_s1_l9_tp7&#45;&gt;ResAttn_s1_l9_tp7 -->
<g id="edge1279" class="edge">
<title>O_s1_l9_tp7&#45;&gt;ResAttn_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M8633.48,-8728.1C8833.29,-8709.06 9167.83,-8677.18 9399.45,-8655.11"/>
<polygon fill="black" stroke="black" points="9400.09,-8658.56 9409.71,-8654.13 9399.42,-8651.59 9400.09,-8658.56"/>
</g>
<!-- Gate_s1_l9_tp0 -->
<g id="node772" class="node">
<title>Gate_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6050.42,-8540.71 5712.42,-8540.71 5712.42,-8487.71 6050.42,-8487.71 6050.42,-8540.71"/>
<text text-anchor="middle" x="5881.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5881.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5881.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp0&#45;&gt;Gate_s1_l9_tp0 -->
<g id="edge1281" class="edge">
<title>ResAttn_s1_l9_tp0&#45;&gt;Gate_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M5797.57,-8576.61C5811.54,-8566.38 5825.79,-8555.95 5838.48,-8546.66"/>
<polygon fill="black" stroke="black" points="5840.58,-8549.46 5846.58,-8540.73 5836.44,-8543.81 5840.58,-8549.46"/>
</g>
<!-- ResMOE_s1_l9_tp0 -->
<g id="node813" class="node">
<title>ResMOE_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6824.77,-8251.76 6267.45,-8251.76 6124.08,-8145.76 6681.4,-8145.76 6824.77,-8251.76"/>
<text text-anchor="middle" x="6474.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6474.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6474.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp0&#45;&gt;ResMOE_s1_l9_tp0 -->
<g id="edge1354" class="edge">
<title>ResAttn_s1_l9_tp0&#45;&gt;ResMOE_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M5405.84,-8598.82C5300.37,-8590.14 5182.47,-8581.67 5074.42,-8576.71 4417.95,-8546.57 2772.71,-8590.28 2117.42,-8540.71 1832.38,-8519.15 1668.05,-8667.38 1480.42,-8451.71 1464.96,-8433.94 1464.06,-8415.65 1480.42,-8398.71 1644.76,-8228.6 5499.22,-8264.15 5735.42,-8251.76 5894.25,-8243.43 6072.06,-8231.02 6213.46,-8220.41"/>
<polygon fill="black" stroke="black" points="6213.87,-8223.88 6223.58,-8219.64 6213.35,-8216.9 6213.87,-8223.88"/>
</g>
<!-- Gate_s1_l9_tp1 -->
<g id="node773" class="node">
<title>Gate_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="3768.42,-8540.71 3430.42,-8540.71 3430.42,-8487.71 3768.42,-8487.71 3768.42,-8540.71"/>
<text text-anchor="middle" x="3599.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3599.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3599.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp1&#45;&gt;Gate_s1_l9_tp1 -->
<g id="edge1282" class="edge">
<title>ResAttn_s1_l9_tp1&#45;&gt;Gate_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M3744.4,-8576.61C3718.52,-8565.65 3692.09,-8554.46 3669.01,-8544.68"/>
<polygon fill="black" stroke="black" points="3670.24,-8541.4 3659.67,-8540.73 3667.51,-8547.85 3670.24,-8541.4"/>
</g>
<!-- ResMOE_s1_l9_tp1 -->
<g id="node814" class="node">
<title>ResMOE_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="4250.77,-8251.76 3693.45,-8251.76 3550.08,-8145.76 4107.4,-8145.76 4250.77,-8251.76"/>
<text text-anchor="middle" x="3900.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3900.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3900.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp1&#45;&gt;ResMOE_s1_l9_tp1 -->
<g id="edge1356" class="edge">
<title>ResAttn_s1_l9_tp1&#45;&gt;ResMOE_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M3554.62,-8604.69C3411.65,-8594.53 3240.05,-8583.51 3085.42,-8576.71 3038.9,-8574.67 1441.99,-8573.99 1409.42,-8540.71 1370.1,-8500.54 1370.38,-8328.2 1409.42,-8287.76 1428.44,-8268.06 2976.01,-8224.46 3622.01,-8207.1"/>
<polygon fill="black" stroke="black" points="3622.49,-8210.59 3632.4,-8206.82 3622.31,-8203.59 3622.49,-8210.59"/>
</g>
<!-- Gate_s1_l9_tp2 -->
<g id="node774" class="node">
<title>Gate_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="4884.42,-8540.71 4546.42,-8540.71 4546.42,-8487.71 4884.42,-8487.71 4884.42,-8540.71"/>
<text text-anchor="middle" x="4715.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4715.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4715.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp2&#45;&gt;Gate_s1_l9_tp2 -->
<g id="edge1283" class="edge">
<title>ResAttn_s1_l9_tp2&#45;&gt;Gate_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M4715.42,-8576.61C4715.42,-8567.94 4715.42,-8559.13 4715.42,-8550.98"/>
<polygon fill="black" stroke="black" points="4718.92,-8550.73 4715.42,-8540.73 4711.92,-8550.73 4718.92,-8550.73"/>
</g>
<!-- ResMOE_s1_l9_tp2 -->
<g id="node815" class="node">
<title>ResMOE_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="5726.77,-8251.76 5169.45,-8251.76 5026.08,-8145.76 5583.4,-8145.76 5726.77,-8251.76"/>
<text text-anchor="middle" x="5376.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5376.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5376.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp2&#45;&gt;ResMOE_s1_l9_tp2 -->
<g id="edge1358" class="edge">
<title>ResAttn_s1_l9_tp2&#45;&gt;ResMOE_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M4381.7,-8589.04C4329.78,-8584.08 4276.7,-8579.71 4226.42,-8576.71 4187.89,-8574.42 1474.54,-8568.18 1447.42,-8540.71 1407.93,-8500.71 1407.93,-8327.76 1447.42,-8287.76 1474.86,-8259.96 4220.38,-8252.92 4259.42,-8251.76 4549.82,-8243.14 4882.4,-8226.83 5108.62,-8214.77"/>
<polygon fill="black" stroke="black" points="5108.84,-8218.26 5118.64,-8214.23 5108.47,-8211.27 5108.84,-8218.26"/>
</g>
<!-- Gate_s1_l9_tp3 -->
<g id="node775" class="node">
<title>Gate_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7680.42,-8540.71 7342.42,-8540.71 7342.42,-8487.71 7680.42,-8487.71 7680.42,-8540.71"/>
<text text-anchor="middle" x="7511.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7511.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7511.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp3&#45;&gt;Gate_s1_l9_tp3 -->
<g id="edge1284" class="edge">
<title>ResAttn_s1_l9_tp3&#45;&gt;Gate_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M7665.6,-8576.61C7637.96,-8565.6 7609.72,-8554.36 7585.09,-8544.55"/>
<polygon fill="black" stroke="black" points="7586.07,-8541.18 7575.49,-8540.73 7583.48,-8547.68 7586.07,-8541.18"/>
</g>
<!-- ResMOE_s1_l9_tp3 -->
<g id="node816" class="node">
<title>ResMOE_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7673.77,-8251.76 7116.45,-8251.76 6973.08,-8145.76 7530.4,-8145.76 7673.77,-8251.76"/>
<text text-anchor="middle" x="7323.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7323.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7323.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp3&#45;&gt;ResMOE_s1_l9_tp3 -->
<g id="edge1360" class="edge">
<title>ResAttn_s1_l9_tp3&#45;&gt;ResMOE_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M8034.81,-8599.74C8119.21,-8590.67 8214.92,-8581.73 8302.42,-8576.71 8962.05,-8538.9 10616.59,-8590.53 11275.42,-8540.71 11564.66,-8518.84 12113.04,-8608.21 11912.42,-8398.71 11875.26,-8359.91 8645.82,-8245.35 7627.44,-8210.16"/>
<polygon fill="black" stroke="black" points="7627.53,-8206.66 7617.41,-8209.81 7627.29,-8213.66 7627.53,-8206.66"/>
</g>
<!-- Gate_s1_l9_tp4 -->
<g id="node776" class="node">
<title>Gate_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="8830.42,-8540.71 8492.42,-8540.71 8492.42,-8487.71 8830.42,-8487.71 8830.42,-8540.71"/>
<text text-anchor="middle" x="8661.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8661.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8661.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp4&#45;&gt;Gate_s1_l9_tp4 -->
<g id="edge1285" class="edge">
<title>ResAttn_s1_l9_tp4&#45;&gt;Gate_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M8661.42,-8576.61C8661.42,-8567.94 8661.42,-8559.13 8661.42,-8550.98"/>
<polygon fill="black" stroke="black" points="8664.92,-8550.73 8661.42,-8540.73 8657.92,-8550.73 8664.92,-8550.73"/>
</g>
<!-- ResMOE_s1_l9_tp4 -->
<g id="node817" class="node">
<title>ResMOE_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="9710.77,-8251.76 9153.45,-8251.76 9010.08,-8145.76 9567.4,-8145.76 9710.77,-8251.76"/>
<text text-anchor="middle" x="9360.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9360.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="9360.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp4&#45;&gt;ResMOE_s1_l9_tp4 -->
<g id="edge1362" class="edge">
<title>ResAttn_s1_l9_tp4&#45;&gt;ResMOE_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M8906.56,-8604.83C9024.33,-8594.33 9167.57,-8582.98 9296.42,-8576.71 9555.15,-8564.14 11371.09,-8578.03 11627.42,-8540.71 11772.23,-8519.63 11856.03,-8568.34 11944.42,-8451.71 12126.3,-8211.75 10899.64,-8310.8 10599.42,-8287.76 10286.75,-8263.76 9929.5,-8238.63 9679.21,-8221.4"/>
<polygon fill="black" stroke="black" points="9679.08,-8217.88 9668.86,-8220.69 9678.6,-8224.87 9679.08,-8217.88"/>
</g>
<!-- Gate_s1_l9_tp5 -->
<g id="node777" class="node">
<title>Gate_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="2464.42,-8540.71 2126.42,-8540.71 2126.42,-8487.71 2464.42,-8487.71 2464.42,-8540.71"/>
<text text-anchor="middle" x="2295.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2295.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2295.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp5&#45;&gt;Gate_s1_l9_tp5 -->
<g id="edge1286" class="edge">
<title>ResAttn_s1_l9_tp5&#45;&gt;Gate_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M2528.9,-8576.7C2485.39,-8565.24 2440.9,-8553.52 2402.58,-8543.43"/>
<polygon fill="black" stroke="black" points="2403.02,-8539.93 2392.46,-8540.77 2401.24,-8546.7 2403.02,-8539.93"/>
</g>
<!-- ResMOE_s1_l9_tp5 -->
<g id="node818" class="node">
<title>ResMOE_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="2017.77,-8251.76 1460.45,-8251.76 1317.08,-8145.76 1874.4,-8145.76 2017.77,-8251.76"/>
<text text-anchor="middle" x="1667.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1667.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1667.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp5&#45;&gt;ResMOE_s1_l9_tp5 -->
<g id="edge1364" class="edge">
<title>ResAttn_s1_l9_tp5&#45;&gt;ResMOE_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M2433.41,-8619.16C2049.47,-8605.25 1420.25,-8577.07 1383.42,-8540.71 1303.4,-8461.73 1311.32,-8377.23 1379.42,-8287.76 1389.9,-8274 1414.19,-8261.47 1444.46,-8250.46"/>
<polygon fill="black" stroke="black" points="1445.77,-8253.72 1454.04,-8247.1 1443.45,-8247.11 1445.77,-8253.72"/>
</g>
<!-- Gate_s1_l9_tp6 -->
<g id="node778" class="node">
<title>Gate_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="11266.42,-8540.71 10928.42,-8540.71 10928.42,-8487.71 11266.42,-8487.71 11266.42,-8540.71"/>
<text text-anchor="middle" x="11097.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11097.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11097.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp6&#45;&gt;Gate_s1_l9_tp6 -->
<g id="edge1287" class="edge">
<title>ResAttn_s1_l9_tp6&#45;&gt;Gate_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M10910.53,-8576.7C10944.77,-8565.43 10979.76,-8553.92 11010.07,-8543.95"/>
<polygon fill="black" stroke="black" points="11011.34,-8547.22 11019.75,-8540.77 11009.15,-8540.57 11011.34,-8547.22"/>
</g>
<!-- ResMOE_s1_l9_tp6 -->
<g id="node819" class="node">
<title>ResMOE_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="12136.77,-8251.76 11579.45,-8251.76 11436.08,-8145.76 11993.4,-8145.76 12136.77,-8251.76"/>
<text text-anchor="middle" x="11786.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11786.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11786.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp6&#45;&gt;ResMOE_s1_l9_tp6 -->
<g id="edge1366" class="edge">
<title>ResAttn_s1_l9_tp6&#45;&gt;ResMOE_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M11030.34,-8629.1C11383.45,-8626.63 11955.32,-8611.56 12021.42,-8540.71 12098.12,-8458.51 12085.48,-8380.15 12021.42,-8287.76 12013.53,-8276.38 12003.98,-8266.47 11993.3,-8257.84"/>
<polygon fill="black" stroke="black" points="11995.41,-8255.05 11985.33,-8251.78 11991.17,-8260.62 11995.41,-8255.05"/>
</g>
<!-- Gate_s1_l9_tp7 -->
<g id="node779" class="node">
<title>Gate_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="9962.42,-8540.71 9624.42,-8540.71 9624.42,-8487.71 9962.42,-8487.71 9962.42,-8540.71"/>
<text text-anchor="middle" x="9793.42" y="-8525.51" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9793.42" y="-8510.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9793.42" y="-8495.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp7&#45;&gt;Gate_s1_l9_tp7 -->
<g id="edge1288" class="edge">
<title>ResAttn_s1_l9_tp7&#45;&gt;Gate_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M9718.77,-8576.61C9730.97,-8566.58 9743.41,-8556.35 9754.54,-8547.19"/>
<polygon fill="black" stroke="black" points="9756.9,-8549.78 9762.4,-8540.73 9752.45,-8544.38 9756.9,-8549.78"/>
</g>
<!-- ResMOE_s1_l9_tp7 -->
<g id="node820" class="node">
<title>ResMOE_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="11088.77,-8251.76 10531.45,-8251.76 10388.08,-8145.76 10945.4,-8145.76 11088.77,-8251.76"/>
<text text-anchor="middle" x="10738.42" y="-8210.06" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10738.42" y="-8195.06" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10738.42" y="-8180.06" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l9_tp7&#45;&gt;ResMOE_s1_l9_tp7 -->
<g id="edge1368" class="edge">
<title>ResAttn_s1_l9_tp7&#45;&gt;ResMOE_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M9905.47,-8608.32C10048.31,-8597.37 10230.81,-8584.55 10393.42,-8576.71 10547.52,-8569.29 11631.43,-8576.8 11781.42,-8540.71 11870.52,-8519.28 11918.57,-8529.25 11967.42,-8451.71 11979.98,-8431.78 11982.69,-8416.65 11967.42,-8398.71 11909.53,-8330.69 11413.95,-8267.56 11070.07,-8231.37"/>
<polygon fill="black" stroke="black" points="11070.26,-8227.87 11059.95,-8230.3 11069.53,-8234.83 11070.26,-8227.87"/>
</g>
<!-- Expert32_s1_l9_tp0 -->
<g id="node780" class="node">
<title>Expert32_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6361.42,-8451.71 6053.42,-8451.71 6053.42,-8398.71 6361.42,-8398.71 6361.42,-8451.71"/>
<text text-anchor="middle" x="6207.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="6207.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6207.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp0&#45;&gt;Expert32_s1_l9_tp0 -->
<g id="edge1289" class="edge">
<title>Gate_s1_l9_tp0&#45;&gt;Expert32_s1_l9_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5977.03,-8487.7C6016.26,-8477.23 6061.8,-8465.07 6101.99,-8454.35"/>
<polygon fill="black" stroke="black" points="6103.06,-8457.69 6111.82,-8451.73 6101.25,-8450.92 6103.06,-8457.69"/>
</g>
<!-- Expert33_s1_l9_tp0 -->
<g id="node781" class="node">
<title>Expert33_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6687.42,-8451.71 6379.42,-8451.71 6379.42,-8398.71 6687.42,-8398.71 6687.42,-8451.71"/>
<text text-anchor="middle" x="6533.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="6533.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6533.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp0&#45;&gt;Expert33_s1_l9_tp0 -->
<g id="edge1290" class="edge">
<title>Gate_s1_l9_tp0&#45;&gt;Expert33_s1_l9_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6050.47,-8493.22C6141.97,-8482.09 6257.22,-8467.58 6368.9,-8451.91"/>
<polygon fill="black" stroke="black" points="6369.59,-8455.35 6379.01,-8450.49 6368.62,-8448.42 6369.59,-8455.35"/>
</g>
<!-- Expert34_s1_l9_tp0 -->
<g id="node782" class="node">
<title>Expert34_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="5709.42,-8451.71 5401.42,-8451.71 5401.42,-8398.71 5709.42,-8398.71 5709.42,-8451.71"/>
<text text-anchor="middle" x="5555.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="5555.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5555.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp0&#45;&gt;Expert34_s1_l9_tp0 -->
<g id="edge1291" class="edge">
<title>Gate_s1_l9_tp0&#45;&gt;Expert34_s1_l9_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5785.81,-8487.7C5746.59,-8477.23 5701.04,-8465.07 5660.85,-8454.35"/>
<polygon fill="black" stroke="black" points="5661.59,-8450.92 5651.03,-8451.73 5659.79,-8457.69 5661.59,-8450.92"/>
</g>
<!-- Expert35_s1_l9_tp0 -->
<g id="node783" class="node">
<title>Expert35_s1_l9_tp0</title>
<polygon fill="none" stroke="black" points="6035.42,-8451.71 5727.42,-8451.71 5727.42,-8398.71 6035.42,-8398.71 6035.42,-8451.71"/>
<text text-anchor="middle" x="5881.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="5881.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5881.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp0&#45;&gt;Expert35_s1_l9_tp0 -->
<g id="edge1292" class="edge">
<title>Gate_s1_l9_tp0&#45;&gt;Expert35_s1_l9_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5881.42,-8487.58C5881.42,-8479.6 5881.42,-8470.65 5881.42,-8462.1"/>
<polygon fill="black" stroke="black" points="5884.92,-8461.96 5881.42,-8451.96 5877.92,-8461.96 5884.92,-8461.96"/>
</g>
<!-- Expert36_s1_l9_tp1 -->
<g id="node784" class="node">
<title>Expert36_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="3753.42,-8451.71 3445.42,-8451.71 3445.42,-8398.71 3753.42,-8398.71 3753.42,-8451.71"/>
<text text-anchor="middle" x="3599.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="3599.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3599.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp1&#45;&gt;Expert36_s1_l9_tp1 -->
<g id="edge1293" class="edge">
<title>Gate_s1_l9_tp1&#45;&gt;Expert36_s1_l9_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3599.42,-8487.58C3599.42,-8479.6 3599.42,-8470.65 3599.42,-8462.1"/>
<polygon fill="black" stroke="black" points="3602.92,-8461.96 3599.42,-8451.96 3595.92,-8461.96 3602.92,-8461.96"/>
</g>
<!-- Expert37_s1_l9_tp1 -->
<g id="node785" class="node">
<title>Expert37_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="4079.42,-8451.71 3771.42,-8451.71 3771.42,-8398.71 4079.42,-8398.71 4079.42,-8451.71"/>
<text text-anchor="middle" x="3925.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="3925.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3925.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp1&#45;&gt;Expert37_s1_l9_tp1 -->
<g id="edge1294" class="edge">
<title>Gate_s1_l9_tp1&#45;&gt;Expert37_s1_l9_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3695.03,-8487.7C3734.26,-8477.23 3779.8,-8465.07 3819.99,-8454.35"/>
<polygon fill="black" stroke="black" points="3821.06,-8457.69 3829.82,-8451.73 3819.25,-8450.92 3821.06,-8457.69"/>
</g>
<!-- Expert38_s1_l9_tp1 -->
<g id="node786" class="node">
<title>Expert38_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="3101.42,-8451.71 2793.42,-8451.71 2793.42,-8398.71 3101.42,-8398.71 3101.42,-8451.71"/>
<text text-anchor="middle" x="2947.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2947.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2947.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp1&#45;&gt;Expert38_s1_l9_tp1 -->
<g id="edge1295" class="edge">
<title>Gate_s1_l9_tp1&#45;&gt;Expert38_s1_l9_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3430.37,-8493.22C3338.87,-8482.09 3223.63,-8467.58 3111.94,-8451.91"/>
<polygon fill="black" stroke="black" points="3112.23,-8448.42 3101.84,-8450.49 3111.25,-8455.35 3112.23,-8448.42"/>
</g>
<!-- Expert39_s1_l9_tp1 -->
<g id="node787" class="node">
<title>Expert39_s1_l9_tp1</title>
<polygon fill="none" stroke="black" points="3427.42,-8451.71 3119.42,-8451.71 3119.42,-8398.71 3427.42,-8398.71 3427.42,-8451.71"/>
<text text-anchor="middle" x="3273.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="3273.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3273.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp1&#45;&gt;Expert39_s1_l9_tp1 -->
<g id="edge1296" class="edge">
<title>Gate_s1_l9_tp1&#45;&gt;Expert39_s1_l9_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3503.81,-8487.7C3464.59,-8477.23 3419.04,-8465.07 3378.85,-8454.35"/>
<polygon fill="black" stroke="black" points="3379.59,-8450.92 3369.03,-8451.73 3377.79,-8457.69 3379.59,-8450.92"/>
</g>
<!-- Expert40_s1_l9_tp2 -->
<g id="node788" class="node">
<title>Expert40_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="5383.42,-8451.71 5075.42,-8451.71 5075.42,-8398.71 5383.42,-8398.71 5383.42,-8451.71"/>
<text text-anchor="middle" x="5229.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="5229.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5229.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp2&#45;&gt;Expert40_s1_l9_tp2 -->
<g id="edge1297" class="edge">
<title>Gate_s1_l9_tp2&#45;&gt;Expert40_s1_l9_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4866.17,-8487.7C4929.84,-8476.92 5004.08,-8464.35 5068.79,-8453.4"/>
<polygon fill="black" stroke="black" points="5069.41,-8456.85 5078.68,-8451.73 5068.24,-8449.95 5069.41,-8456.85"/>
</g>
<!-- Expert41_s1_l9_tp2 -->
<g id="node789" class="node">
<title>Expert41_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="4405.42,-8451.71 4097.42,-8451.71 4097.42,-8398.71 4405.42,-8398.71 4405.42,-8451.71"/>
<text text-anchor="middle" x="4251.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="4251.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4251.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp2&#45;&gt;Expert41_s1_l9_tp2 -->
<g id="edge1298" class="edge">
<title>Gate_s1_l9_tp2&#45;&gt;Expert41_s1_l9_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4579.34,-8487.7C4522.21,-8476.99 4455.67,-8464.51 4397.51,-8453.6"/>
<polygon fill="black" stroke="black" points="4397.97,-8450.13 4387.5,-8451.73 4396.68,-8457.01 4397.97,-8450.13"/>
</g>
<!-- Expert42_s1_l9_tp2 -->
<g id="node790" class="node">
<title>Expert42_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="4731.42,-8451.71 4423.42,-8451.71 4423.42,-8398.71 4731.42,-8398.71 4731.42,-8451.71"/>
<text text-anchor="middle" x="4577.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="4577.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4577.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp2&#45;&gt;Expert42_s1_l9_tp2 -->
<g id="edge1299" class="edge">
<title>Gate_s1_l9_tp2&#45;&gt;Expert42_s1_l9_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4674.76,-8487.58C4659.74,-8478.11 4642.54,-8467.27 4626.82,-8457.36"/>
<polygon fill="black" stroke="black" points="4628.59,-8454.34 4618.27,-8451.96 4624.86,-8460.26 4628.59,-8454.34"/>
</g>
<!-- Expert43_s1_l9_tp2 -->
<g id="node791" class="node">
<title>Expert43_s1_l9_tp2</title>
<polygon fill="none" stroke="black" points="5057.42,-8451.71 4749.42,-8451.71 4749.42,-8398.71 5057.42,-8398.71 5057.42,-8451.71"/>
<text text-anchor="middle" x="4903.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="4903.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4903.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp2&#45;&gt;Expert43_s1_l9_tp2 -->
<g id="edge1300" class="edge">
<title>Gate_s1_l9_tp2&#45;&gt;Expert43_s1_l9_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4770.56,-8487.7C4791.98,-8477.78 4816.68,-8466.36 4838.92,-8456.06"/>
<polygon fill="black" stroke="black" points="4840.68,-8459.1 4848.29,-8451.73 4837.74,-8452.75 4840.68,-8459.1"/>
</g>
<!-- Expert44_s1_l9_tp3 -->
<g id="node792" class="node">
<title>Expert44_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7013.42,-8451.71 6705.42,-8451.71 6705.42,-8398.71 7013.42,-8398.71 7013.42,-8451.71"/>
<text text-anchor="middle" x="6859.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="6859.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6859.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp3&#45;&gt;Expert44_s1_l9_tp3 -->
<g id="edge1301" class="edge">
<title>Gate_s1_l9_tp3&#45;&gt;Expert44_s1_l9_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7342.37,-8493.22C7250.87,-8482.09 7135.63,-8467.58 7023.94,-8451.91"/>
<polygon fill="black" stroke="black" points="7024.23,-8448.42 7013.84,-8450.49 7023.25,-8455.35 7024.23,-8448.42"/>
</g>
<!-- Expert45_s1_l9_tp3 -->
<g id="node793" class="node">
<title>Expert45_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7339.42,-8451.71 7031.42,-8451.71 7031.42,-8398.71 7339.42,-8398.71 7339.42,-8451.71"/>
<text text-anchor="middle" x="7185.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="7185.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7185.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp3&#45;&gt;Expert45_s1_l9_tp3 -->
<g id="edge1302" class="edge">
<title>Gate_s1_l9_tp3&#45;&gt;Expert45_s1_l9_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7415.81,-8487.7C7376.59,-8477.23 7331.04,-8465.07 7290.85,-8454.35"/>
<polygon fill="black" stroke="black" points="7291.59,-8450.92 7281.03,-8451.73 7289.79,-8457.69 7291.59,-8450.92"/>
</g>
<!-- Expert46_s1_l9_tp3 -->
<g id="node794" class="node">
<title>Expert46_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7665.42,-8451.71 7357.42,-8451.71 7357.42,-8398.71 7665.42,-8398.71 7665.42,-8451.71"/>
<text text-anchor="middle" x="7511.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="7511.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7511.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp3&#45;&gt;Expert46_s1_l9_tp3 -->
<g id="edge1303" class="edge">
<title>Gate_s1_l9_tp3&#45;&gt;Expert46_s1_l9_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7511.42,-8487.58C7511.42,-8479.6 7511.42,-8470.65 7511.42,-8462.1"/>
<polygon fill="black" stroke="black" points="7514.92,-8461.96 7511.42,-8451.96 7507.92,-8461.96 7514.92,-8461.96"/>
</g>
<!-- Expert47_s1_l9_tp3 -->
<g id="node795" class="node">
<title>Expert47_s1_l9_tp3</title>
<polygon fill="none" stroke="black" points="7991.42,-8451.71 7683.42,-8451.71 7683.42,-8398.71 7991.42,-8398.71 7991.42,-8451.71"/>
<text text-anchor="middle" x="7837.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="7837.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7837.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp3&#45;&gt;Expert47_s1_l9_tp3 -->
<g id="edge1304" class="edge">
<title>Gate_s1_l9_tp3&#45;&gt;Expert47_s1_l9_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7607.03,-8487.7C7646.26,-8477.23 7691.8,-8465.07 7731.99,-8454.35"/>
<polygon fill="black" stroke="black" points="7733.06,-8457.69 7741.82,-8451.73 7731.25,-8450.92 7733.06,-8457.69"/>
</g>
<!-- Expert48_s1_l9_tp4 -->
<g id="node796" class="node">
<title>Expert48_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="8317.42,-8451.71 8009.42,-8451.71 8009.42,-8398.71 8317.42,-8398.71 8317.42,-8451.71"/>
<text text-anchor="middle" x="8163.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="8163.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8163.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp4&#45;&gt;Expert48_s1_l9_tp4 -->
<g id="edge1305" class="edge">
<title>Gate_s1_l9_tp4&#45;&gt;Expert48_s1_l9_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8515.37,-8487.7C8453.8,-8476.94 8382.04,-8464.41 8319.44,-8453.47"/>
<polygon fill="black" stroke="black" points="8319.92,-8450 8309.47,-8451.73 8318.72,-8456.9 8319.92,-8450"/>
</g>
<!-- Expert49_s1_l9_tp4 -->
<g id="node797" class="node">
<title>Expert49_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="8643.42,-8451.71 8335.42,-8451.71 8335.42,-8398.71 8643.42,-8398.71 8643.42,-8451.71"/>
<text text-anchor="middle" x="8489.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="8489.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8489.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp4&#45;&gt;Expert49_s1_l9_tp4 -->
<g id="edge1306" class="edge">
<title>Gate_s1_l9_tp4&#45;&gt;Expert49_s1_l9_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8610.75,-8487.58C8591.41,-8477.8 8569.19,-8466.56 8549.1,-8456.4"/>
<polygon fill="black" stroke="black" points="8550.54,-8453.2 8540.03,-8451.81 8547.38,-8459.45 8550.54,-8453.2"/>
</g>
<!-- Expert50_s1_l9_tp4 -->
<g id="node798" class="node">
<title>Expert50_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="8969.42,-8451.71 8661.42,-8451.71 8661.42,-8398.71 8969.42,-8398.71 8969.42,-8451.71"/>
<text text-anchor="middle" x="8815.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="8815.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8815.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp4&#45;&gt;Expert50_s1_l9_tp4 -->
<g id="edge1307" class="edge">
<title>Gate_s1_l9_tp4&#45;&gt;Expert50_s1_l9_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8706.79,-8487.58C8723.79,-8477.98 8743.28,-8466.97 8761.02,-8456.95"/>
<polygon fill="black" stroke="black" points="8763.12,-8459.78 8770.11,-8451.81 8759.68,-8453.68 8763.12,-8459.78"/>
</g>
<!-- Expert51_s1_l9_tp4 -->
<g id="node799" class="node">
<title>Expert51_s1_l9_tp4</title>
<polygon fill="none" stroke="black" points="9295.42,-8451.71 8987.42,-8451.71 8987.42,-8398.71 9295.42,-8398.71 9295.42,-8451.71"/>
<text text-anchor="middle" x="9141.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="9141.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="9141.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp4&#45;&gt;Expert51_s1_l9_tp4 -->
<g id="edge1308" class="edge">
<title>Gate_s1_l9_tp4&#45;&gt;Expert51_s1_l9_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8802.2,-8487.7C8861.42,-8476.96 8930.42,-8464.46 8990.67,-8453.54"/>
<polygon fill="black" stroke="black" points="8991.44,-8456.96 9000.65,-8451.73 8990.19,-8450.07 8991.44,-8456.96"/>
</g>
<!-- Expert52_s1_l9_tp5 -->
<g id="node800" class="node">
<title>Expert52_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="1797.42,-8451.71 1489.42,-8451.71 1489.42,-8398.71 1797.42,-8398.71 1797.42,-8451.71"/>
<text text-anchor="middle" x="1643.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="1643.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1643.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp5&#45;&gt;Expert52_s1_l9_tp5 -->
<g id="edge1309" class="edge">
<title>Gate_s1_l9_tp5&#45;&gt;Expert52_s1_l9_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2126.37,-8493.22C2034.87,-8482.09 1919.63,-8467.58 1807.94,-8451.91"/>
<polygon fill="black" stroke="black" points="1808.23,-8448.42 1797.84,-8450.49 1807.25,-8455.35 1808.23,-8448.42"/>
</g>
<!-- Expert53_s1_l9_tp5 -->
<g id="node801" class="node">
<title>Expert53_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="2123.42,-8451.71 1815.42,-8451.71 1815.42,-8398.71 2123.42,-8398.71 2123.42,-8451.71"/>
<text text-anchor="middle" x="1969.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1969.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1969.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp5&#45;&gt;Expert53_s1_l9_tp5 -->
<g id="edge1310" class="edge">
<title>Gate_s1_l9_tp5&#45;&gt;Expert53_s1_l9_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2199.81,-8487.7C2160.59,-8477.23 2115.04,-8465.07 2074.85,-8454.35"/>
<polygon fill="black" stroke="black" points="2075.59,-8450.92 2065.03,-8451.73 2073.79,-8457.69 2075.59,-8450.92"/>
</g>
<!-- Expert54_s1_l9_tp5 -->
<g id="node802" class="node">
<title>Expert54_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="2449.42,-8451.71 2141.42,-8451.71 2141.42,-8398.71 2449.42,-8398.71 2449.42,-8451.71"/>
<text text-anchor="middle" x="2295.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="2295.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2295.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp5&#45;&gt;Expert54_s1_l9_tp5 -->
<g id="edge1311" class="edge">
<title>Gate_s1_l9_tp5&#45;&gt;Expert54_s1_l9_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2295.42,-8487.58C2295.42,-8479.6 2295.42,-8470.65 2295.42,-8462.1"/>
<polygon fill="black" stroke="black" points="2298.92,-8461.96 2295.42,-8451.96 2291.92,-8461.96 2298.92,-8461.96"/>
</g>
<!-- Expert55_s1_l9_tp5 -->
<g id="node803" class="node">
<title>Expert55_s1_l9_tp5</title>
<polygon fill="none" stroke="black" points="2775.42,-8451.71 2467.42,-8451.71 2467.42,-8398.71 2775.42,-8398.71 2775.42,-8451.71"/>
<text text-anchor="middle" x="2621.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="2621.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2621.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp5&#45;&gt;Expert55_s1_l9_tp5 -->
<g id="edge1312" class="edge">
<title>Gate_s1_l9_tp5&#45;&gt;Expert55_s1_l9_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2391.03,-8487.7C2430.26,-8477.23 2475.8,-8465.07 2515.99,-8454.35"/>
<polygon fill="black" stroke="black" points="2517.06,-8457.69 2525.82,-8451.73 2515.25,-8450.92 2517.06,-8457.69"/>
</g>
<!-- Expert56_s1_l9_tp6 -->
<g id="node804" class="node">
<title>Expert56_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="10925.42,-8451.71 10617.42,-8451.71 10617.42,-8398.71 10925.42,-8398.71 10925.42,-8451.71"/>
<text text-anchor="middle" x="10771.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="10771.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10771.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp6&#45;&gt;Expert56_s1_l9_tp6 -->
<g id="edge1313" class="edge">
<title>Gate_s1_l9_tp6&#45;&gt;Expert56_s1_l9_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11001.81,-8487.7C10962.59,-8477.23 10917.04,-8465.07 10876.85,-8454.35"/>
<polygon fill="black" stroke="black" points="10877.59,-8450.92 10867.03,-8451.73 10875.79,-8457.69 10877.59,-8450.92"/>
</g>
<!-- Expert57_s1_l9_tp6 -->
<g id="node805" class="node">
<title>Expert57_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="11251.42,-8451.71 10943.42,-8451.71 10943.42,-8398.71 11251.42,-8398.71 11251.42,-8451.71"/>
<text text-anchor="middle" x="11097.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="11097.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11097.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp6&#45;&gt;Expert57_s1_l9_tp6 -->
<g id="edge1314" class="edge">
<title>Gate_s1_l9_tp6&#45;&gt;Expert57_s1_l9_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11097.42,-8487.58C11097.42,-8479.6 11097.42,-8470.65 11097.42,-8462.1"/>
<polygon fill="black" stroke="black" points="11100.92,-8461.96 11097.42,-8451.96 11093.92,-8461.96 11100.92,-8461.96"/>
</g>
<!-- Expert58_s1_l9_tp6 -->
<g id="node806" class="node">
<title>Expert58_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="11577.42,-8451.71 11269.42,-8451.71 11269.42,-8398.71 11577.42,-8398.71 11577.42,-8451.71"/>
<text text-anchor="middle" x="11423.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="11423.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11423.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp6&#45;&gt;Expert58_s1_l9_tp6 -->
<g id="edge1315" class="edge">
<title>Gate_s1_l9_tp6&#45;&gt;Expert58_s1_l9_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11193.03,-8487.7C11232.26,-8477.23 11277.8,-8465.07 11317.99,-8454.35"/>
<polygon fill="black" stroke="black" points="11319.06,-8457.69 11327.82,-8451.73 11317.25,-8450.92 11319.06,-8457.69"/>
</g>
<!-- Expert59_s1_l9_tp6 -->
<g id="node807" class="node">
<title>Expert59_s1_l9_tp6</title>
<polygon fill="none" stroke="black" points="11903.42,-8451.71 11595.42,-8451.71 11595.42,-8398.71 11903.42,-8398.71 11903.42,-8451.71"/>
<text text-anchor="middle" x="11749.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="11749.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11749.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp6&#45;&gt;Expert59_s1_l9_tp6 -->
<g id="edge1316" class="edge">
<title>Gate_s1_l9_tp6&#45;&gt;Expert59_s1_l9_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11266.47,-8493.22C11357.97,-8482.09 11473.22,-8467.58 11584.9,-8451.91"/>
<polygon fill="black" stroke="black" points="11585.59,-8455.35 11595.01,-8450.49 11584.62,-8448.42 11585.59,-8455.35"/>
</g>
<!-- Expert60_s1_l9_tp7 -->
<g id="node808" class="node">
<title>Expert60_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="9621.42,-8451.71 9313.42,-8451.71 9313.42,-8398.71 9621.42,-8398.71 9621.42,-8451.71"/>
<text text-anchor="middle" x="9467.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="9467.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9467.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp7&#45;&gt;Expert60_s1_l9_tp7 -->
<g id="edge1317" class="edge">
<title>Gate_s1_l9_tp7&#45;&gt;Expert60_s1_l9_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9697.81,-8487.7C9658.59,-8477.23 9613.04,-8465.07 9572.85,-8454.35"/>
<polygon fill="black" stroke="black" points="9573.59,-8450.92 9563.03,-8451.73 9571.79,-8457.69 9573.59,-8450.92"/>
</g>
<!-- Expert61_s1_l9_tp7 -->
<g id="node809" class="node">
<title>Expert61_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="9947.42,-8451.71 9639.42,-8451.71 9639.42,-8398.71 9947.42,-8398.71 9947.42,-8451.71"/>
<text text-anchor="middle" x="9793.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="9793.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9793.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp7&#45;&gt;Expert61_s1_l9_tp7 -->
<g id="edge1318" class="edge">
<title>Gate_s1_l9_tp7&#45;&gt;Expert61_s1_l9_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9793.42,-8487.58C9793.42,-8479.6 9793.42,-8470.65 9793.42,-8462.1"/>
<polygon fill="black" stroke="black" points="9796.92,-8461.96 9793.42,-8451.96 9789.92,-8461.96 9796.92,-8461.96"/>
</g>
<!-- Expert62_s1_l9_tp7 -->
<g id="node810" class="node">
<title>Expert62_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="10273.42,-8451.71 9965.42,-8451.71 9965.42,-8398.71 10273.42,-8398.71 10273.42,-8451.71"/>
<text text-anchor="middle" x="10119.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="10119.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10119.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp7&#45;&gt;Expert62_s1_l9_tp7 -->
<g id="edge1319" class="edge">
<title>Gate_s1_l9_tp7&#45;&gt;Expert62_s1_l9_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9889.03,-8487.7C9928.26,-8477.23 9973.8,-8465.07 10013.99,-8454.35"/>
<polygon fill="black" stroke="black" points="10015.06,-8457.69 10023.82,-8451.73 10013.25,-8450.92 10015.06,-8457.69"/>
</g>
<!-- Expert63_s1_l9_tp7 -->
<g id="node811" class="node">
<title>Expert63_s1_l9_tp7</title>
<polygon fill="none" stroke="black" points="10599.42,-8451.71 10291.42,-8451.71 10291.42,-8398.71 10599.42,-8398.71 10599.42,-8451.71"/>
<text text-anchor="middle" x="10445.42" y="-8436.51" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="10445.42" y="-8421.51" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10445.42" y="-8406.51" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l9_tp7&#45;&gt;Expert63_s1_l9_tp7 -->
<g id="edge1320" class="edge">
<title>Gate_s1_l9_tp7&#45;&gt;Expert63_s1_l9_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9962.47,-8493.22C10053.97,-8482.09 10169.22,-8467.58 10280.9,-8451.91"/>
<polygon fill="black" stroke="black" points="10281.59,-8455.35 10291.01,-8450.49 10280.62,-8448.42 10281.59,-8455.35"/>
</g>
<!-- AR_exp_s1_l9 -->
<g id="node812" class="node">
<title>AR_exp_s1_l9</title>
<ellipse fill="none" stroke="black" cx="6663.42" cy="-8325.24" rx="239" ry="37.45"/>
<text text-anchor="middle" x="6663.42" y="-8336.54" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="6663.42" y="-8321.54" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6663.42" y="-8306.54" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l9_tp0&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1321" class="edge">
<title>Expert32_s1_l9_tp0&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M6326.34,-8398.66C6384.08,-8386.26 6454.04,-8371.23 6515.22,-8358.08"/>
<polygon fill="black" stroke="black" points="6516.31,-8361.42 6525.35,-8355.9 6514.84,-8354.58 6516.31,-8361.42"/>
</g>
<!-- Expert33_s1_l9_tp0&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1322" class="edge">
<title>Expert33_s1_l9_tp0&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M6567.58,-8398.47C6579.79,-8389.27 6593.89,-8378.64 6607.46,-8368.42"/>
<polygon fill="black" stroke="black" points="6609.93,-8370.93 6615.81,-8362.12 6605.72,-8365.34 6609.93,-8370.93"/>
</g>
<!-- Expert34_s1_l9_tp0&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1323" class="edge">
<title>Expert34_s1_l9_tp0&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M5709.81,-8399.74C5712.71,-8399.39 5715.58,-8399.04 5718.42,-8398.71 5960.08,-8370.59 6237.82,-8350.77 6429.35,-8339.05"/>
<polygon fill="black" stroke="black" points="6429.78,-8342.53 6439.55,-8338.43 6429.36,-8335.55 6429.78,-8342.53"/>
</g>
<!-- Expert35_s1_l9_tp0&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1324" class="edge">
<title>Expert35_s1_l9_tp0&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M6035.83,-8399.9C6038.72,-8399.5 6041.58,-8399.1 6044.42,-8398.71 6182.32,-8379.86 6337.92,-8361.66 6458.62,-8348.21"/>
<polygon fill="black" stroke="black" points="6459.17,-8351.67 6468.72,-8347.08 6458.39,-8344.71 6459.17,-8351.67"/>
</g>
<!-- Expert36_s1_l9_tp1&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1325" class="edge">
<title>Expert36_s1_l9_tp1&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M3753.79,-8399.54C3756.69,-8399.25 3759.57,-8398.97 3762.42,-8398.71 4273.84,-8352.52 5810.22,-8333.94 6414.97,-8328.28"/>
<polygon fill="black" stroke="black" points="6415.16,-8331.78 6425.13,-8328.19 6415.09,-8324.78 6415.16,-8331.78"/>
</g>
<!-- Expert37_s1_l9_tp1&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1326" class="edge">
<title>Expert37_s1_l9_tp1&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M4079.79,-8399.55C4082.69,-8399.26 4085.57,-8398.98 4088.42,-8398.71 4534.79,-8357.68 5860.95,-8336.47 6415.41,-8329.2"/>
<polygon fill="black" stroke="black" points="6415.58,-8332.7 6425.54,-8329.06 6415.49,-8325.7 6415.58,-8332.7"/>
</g>
<!-- Expert38_s1_l9_tp1&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1327" class="edge">
<title>Expert38_s1_l9_tp1&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M3101.79,-8399.52C3104.69,-8399.23 3107.57,-8398.96 3110.42,-8398.71 3753.07,-8342.15 5716.83,-8329.63 6414.37,-8326.95"/>
<polygon fill="black" stroke="black" points="6414.55,-8330.45 6424.54,-8326.91 6414.53,-8323.45 6414.55,-8330.45"/>
</g>
<!-- Expert39_s1_l9_tp1&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1328" class="edge">
<title>Expert39_s1_l9_tp1&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M3427.79,-8399.53C3430.69,-8399.24 3433.57,-8398.97 3436.42,-8398.71 4013.2,-8347.35 5761.8,-8331.68 6414.34,-8327.55"/>
<polygon fill="black" stroke="black" points="6414.83,-8331.05 6424.81,-8327.49 6414.79,-8324.05 6414.83,-8331.05"/>
</g>
<!-- Expert40_s1_l9_tp2&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1329" class="edge">
<title>Expert40_s1_l9_tp2&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M5383.81,-8399.67C5386.7,-8399.33 5389.57,-8399.02 5392.42,-8398.71 5748.37,-8360.81 6162.66,-8341.86 6419,-8333.05"/>
<polygon fill="black" stroke="black" points="6419.31,-8336.54 6429.19,-8332.7 6419.08,-8329.54 6419.31,-8336.54"/>
</g>
<!-- Expert41_s1_l9_tp2&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1330" class="edge">
<title>Expert41_s1_l9_tp2&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M4405.8,-8399.57C4408.69,-8399.27 4411.57,-8398.98 4414.42,-8398.71 4796.24,-8362.83 5915.24,-8339.36 6416.1,-8330.36"/>
<polygon fill="black" stroke="black" points="6416.42,-8333.86 6426.35,-8330.18 6416.29,-8326.86 6416.42,-8333.86"/>
</g>
<!-- Expert42_s1_l9_tp2&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1331" class="edge">
<title>Expert42_s1_l9_tp2&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M4731.8,-8399.59C4734.69,-8399.28 4737.57,-8398.99 4740.42,-8398.71 5339.21,-8340.79 6047.03,-8328.5 6414.26,-8326.3"/>
<polygon fill="black" stroke="black" points="6414.51,-8329.79 6424.49,-8326.24 6414.47,-8322.79 6414.51,-8329.79"/>
</g>
<!-- Expert43_s1_l9_tp2&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1332" class="edge">
<title>Expert43_s1_l9_tp2&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M5057.8,-8399.62C5060.7,-8399.3 5063.57,-8399 5066.42,-8398.71 5542.1,-8350.86 6100.69,-8334.59 6415.24,-8329.07"/>
<polygon fill="black" stroke="black" points="6415.47,-8332.56 6425.4,-8328.89 6415.35,-8325.56 6415.47,-8332.56"/>
</g>
<!-- Expert44_s1_l9_tp3&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1333" class="edge">
<title>Expert44_s1_l9_tp3&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M6808.18,-8398.6C6788.04,-8388.53 6764.47,-8376.75 6742.26,-8365.64"/>
<polygon fill="black" stroke="black" points="6743.68,-8362.44 6733.17,-8361.1 6740.55,-8368.7 6743.68,-8362.44"/>
</g>
<!-- Expert45_s1_l9_tp3&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1334" class="edge">
<title>Expert45_s1_l9_tp3&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M7049.3,-8398.66C6980.2,-8385.69 6895.82,-8369.86 6823.61,-8356.3"/>
<polygon fill="black" stroke="black" points="6823.98,-8352.81 6813.51,-8354.41 6822.69,-8359.69 6823.98,-8352.81"/>
</g>
<!-- Expert46_s1_l9_tp3&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1335" class="edge">
<title>Expert46_s1_l9_tp3&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M7357.02,-8399.86C7354.13,-8399.47 7351.26,-8399.09 7348.42,-8398.71 7190.67,-8378.04 7011.87,-8359.28 6876.51,-8346.03"/>
<polygon fill="black" stroke="black" points="6876.72,-8342.53 6866.43,-8345.04 6876.04,-8349.5 6876.72,-8342.53"/>
</g>
<!-- Expert47_s1_l9_tp3&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1336" class="edge">
<title>Expert47_s1_l9_tp3&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M7683.03,-8399.72C7680.14,-8399.37 7677.27,-8399.04 7674.42,-8398.71 7410.15,-8368.62 7105.51,-8348.8 6900.29,-8337.61"/>
<polygon fill="black" stroke="black" points="6900.46,-8334.11 6890.29,-8337.07 6900.08,-8341.1 6900.46,-8334.11"/>
</g>
<!-- Expert48_s1_l9_tp4&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1337" class="edge">
<title>Expert48_s1_l9_tp4&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M8009.04,-8399.66C8006.15,-8399.33 8003.27,-8399.01 8000.42,-8398.71 7620.67,-8358.82 7177.79,-8340.28 6909.14,-8332.12"/>
<polygon fill="black" stroke="black" points="6908.97,-8328.61 6898.87,-8331.81 6908.76,-8335.61 6908.97,-8328.61"/>
</g>
<!-- Expert49_s1_l9_tp4&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1338" class="edge">
<title>Expert49_s1_l9_tp4&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M8335.04,-8399.61C8332.15,-8399.3 8329.27,-8399 8326.42,-8398.71 7826.03,-8348.83 7237.55,-8333.27 6911.92,-8328.43"/>
<polygon fill="black" stroke="black" points="6911.94,-8324.93 6901.89,-8328.28 6911.83,-8331.92 6911.94,-8324.93"/>
</g>
<!-- Expert50_s1_l9_tp4&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1339" class="edge">
<title>Expert50_s1_l9_tp4&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M8661.05,-8399.59C8658.15,-8399.28 8655.27,-8398.99 8652.42,-8398.71 8028.45,-8338.75 7290.02,-8327.38 6912.68,-8325.84"/>
<polygon fill="black" stroke="black" points="6912.47,-8322.34 6902.45,-8325.8 6912.44,-8329.34 6912.47,-8322.34"/>
</g>
<!-- Expert51_s1_l9_tp4&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1340" class="edge">
<title>Expert51_s1_l9_tp4&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M8987.05,-8399.57C8984.15,-8399.26 8981.27,-8398.98 8978.42,-8398.71 8583.56,-8361.79 7422.77,-8338.74 6910.82,-8330.1"/>
<polygon fill="black" stroke="black" points="6910.77,-8326.6 6900.71,-8329.93 6910.65,-8333.6 6910.77,-8326.6"/>
</g>
<!-- Expert52_s1_l9_tp5&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1341" class="edge">
<title>Expert52_s1_l9_tp5&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M1797.79,-8399.5C1800.69,-8399.22 1803.57,-8398.96 1806.42,-8398.71 2266.03,-8359.53 5487.69,-8334.38 6414.54,-8327.9"/>
<polygon fill="black" stroke="black" points="6414.69,-8331.4 6424.66,-8327.83 6414.64,-8324.4 6414.69,-8331.4"/>
</g>
<!-- Expert53_s1_l9_tp5&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1342" class="edge">
<title>Expert53_s1_l9_tp5&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M2123.79,-8399.51C2126.69,-8399.22 2129.57,-8398.96 2132.42,-8398.71 2974.13,-8326.5 5592.39,-8324.44 6414.1,-8325.65"/>
<polygon fill="black" stroke="black" points="6414.27,-8329.15 6424.28,-8325.67 6414.28,-8322.15 6414.27,-8329.15"/>
</g>
<!-- Expert54_s1_l9_tp5&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1343" class="edge">
<title>Expert54_s1_l9_tp5&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M2449.79,-8399.51C2452.69,-8399.23 2455.57,-8398.96 2458.42,-8398.71 3233.47,-8331.73 5631.74,-8326.04 6413.94,-8326.02"/>
<polygon fill="black" stroke="black" points="6414.2,-8329.52 6424.2,-8326.02 6414.2,-8322.52 6414.2,-8329.52"/>
</g>
<!-- Expert55_s1_l9_tp5&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1344" class="edge">
<title>Expert55_s1_l9_tp5&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M2775.79,-8399.52C2778.69,-8399.23 2781.57,-8398.96 2784.42,-8398.71 3493.13,-8336.95 5673.28,-8327.77 6414.08,-8326.44"/>
<polygon fill="black" stroke="black" points="6414.35,-8329.94 6424.34,-8326.43 6414.34,-8322.94 6414.35,-8329.94"/>
</g>
<!-- Expert56_s1_l9_tp6&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1345" class="edge">
<title>Expert56_s1_l9_tp6&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M10617.05,-8399.51C10614.16,-8399.23 10611.28,-8398.96 10608.42,-8398.71 9886.29,-8335.89 7662.02,-8327.41 6912.75,-8326.35"/>
<polygon fill="black" stroke="black" points="6912.65,-8322.85 6902.64,-8326.34 6912.64,-8329.85 6912.65,-8322.85"/>
</g>
<!-- Expert57_s1_l9_tp6&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1346" class="edge">
<title>Expert57_s1_l9_tp6&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M10943.05,-8399.51C10940.16,-8399.23 10937.28,-8398.96 10934.42,-8398.71 10145.85,-8330.67 7702.87,-8325.71 6912.72,-8325.94"/>
<polygon fill="black" stroke="black" points="6912.64,-8322.44 6902.64,-8325.94 6912.64,-8329.44 6912.64,-8322.44"/>
</g>
<!-- Expert58_s1_l9_tp6&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1347" class="edge">
<title>Expert58_s1_l9_tp6&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M11269.05,-8399.5C11266.16,-8399.22 11263.28,-8398.96 11260.42,-8398.71 10405.21,-8325.44 7742.35,-8324.13 6912.77,-8325.58"/>
<polygon fill="black" stroke="black" points="6912.49,-8322.08 6902.49,-8325.6 6912.5,-8329.08 6912.49,-8322.08"/>
</g>
<!-- Expert59_s1_l9_tp6&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1348" class="edge">
<title>Expert59_s1_l9_tp6&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M11595.06,-8399.5C11592.16,-8399.22 11589.28,-8398.96 11586.42,-8398.71 11119.97,-8358.99 7846.76,-8334.18 6912.09,-8327.85"/>
<polygon fill="black" stroke="black" points="6911.91,-8324.34 6901.88,-8327.78 6911.86,-8331.34 6911.91,-8324.34"/>
</g>
<!-- Expert60_s1_l9_tp7&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1349" class="edge">
<title>Expert60_s1_l9_tp7&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M9313.05,-8399.55C9310.15,-8399.25 9307.27,-8398.97 9304.42,-8398.71 8844.98,-8356.64 7476.75,-8335.94 6911.74,-8329"/>
<polygon fill="black" stroke="black" points="6911.47,-8325.49 6901.43,-8328.87 6911.38,-8332.49 6911.47,-8325.49"/>
</g>
<!-- Expert61_s1_l9_tp7&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1350" class="edge">
<title>Expert61_s1_l9_tp7&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M9639.05,-8399.54C9636.15,-8399.25 9633.28,-8398.97 9630.42,-8398.71 9105.85,-8351.48 7526.92,-8333.46 6912.18,-8328.12"/>
<polygon fill="black" stroke="black" points="6911.88,-8324.62 6901.85,-8328.03 6911.82,-8331.62 6911.88,-8324.62"/>
</g>
<!-- Expert62_s1_l9_tp7&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1351" class="edge">
<title>Expert62_s1_l9_tp7&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M9965.05,-8399.53C9962.15,-8399.24 9959.28,-8398.97 9956.42,-8398.71 9366.28,-8346.29 7574.01,-8331.25 6912.33,-8327.42"/>
<polygon fill="black" stroke="black" points="6912.21,-8323.92 6902.19,-8327.36 6912.17,-8330.92 6912.21,-8323.92"/>
</g>
<!-- Expert63_s1_l9_tp7&#45;&gt;AR_exp_s1_l9 -->
<g id="edge1352" class="edge">
<title>Expert63_s1_l9_tp7&#45;&gt;AR_exp_s1_l9</title>
<path fill="none" stroke="black" d="M10291.05,-8399.52C10288.15,-8399.23 10285.28,-8398.96 10282.42,-8398.71 9626.39,-8341.09 7618.77,-8329.24 6912.43,-8326.84"/>
<polygon fill="black" stroke="black" points="6912.39,-8323.34 6902.38,-8326.8 6912.37,-8330.34 6912.39,-8323.34"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp0 -->
<g id="edge1353" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp0</title>
<path fill="none" stroke="black" d="M6609.26,-8288.57C6594.49,-8278.84 6578.11,-8268.05 6561.99,-8257.43"/>
<polygon fill="black" stroke="black" points="6563.87,-8254.48 6553.59,-8251.9 6560.02,-8260.33 6563.87,-8254.48"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp1 -->
<g id="edge1355" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp1</title>
<path fill="none" stroke="black" d="M6434.41,-8314.33C6116.44,-8300.55 5523.2,-8274.67 5017.42,-8251.76 4744.53,-8239.4 4434.16,-8224.92 4209.96,-8214.38"/>
<polygon fill="black" stroke="black" points="4209.84,-8210.87 4199.69,-8213.9 4209.51,-8217.86 4209.84,-8210.87"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp2 -->
<g id="edge1357" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp2</title>
<path fill="none" stroke="black" d="M6462.68,-8304.82C6261.33,-8285.35 5947.71,-8255.01 5709.11,-8231.94"/>
<polygon fill="black" stroke="black" points="5709.17,-8228.43 5698.88,-8230.95 5708.49,-8235.39 5709.17,-8228.43"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp3 -->
<g id="edge1359" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp3</title>
<path fill="none" stroke="black" d="M6813.19,-8295.99C6895.57,-8280.45 6999.57,-8260.84 7092.15,-8243.38"/>
<polygon fill="black" stroke="black" points="7093.04,-8246.77 7102.22,-8241.48 7091.75,-8239.89 7093.04,-8246.77"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp4 -->
<g id="edge1361" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp4</title>
<path fill="none" stroke="black" d="M6891.04,-8313.73C7385.78,-8290.9 8557.28,-8236.83 9089.24,-8212.28"/>
<polygon fill="black" stroke="black" points="9089.53,-8215.77 9099.36,-8211.81 9089.21,-8208.77 9089.53,-8215.77"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp5 -->
<g id="edge1363" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp5</title>
<path fill="none" stroke="black" d="M6427.45,-8319.12C5906.61,-8307.76 4619.29,-8279.23 3541.42,-8251.76 2986.65,-8237.62 2339.54,-8219.25 1969.21,-8208.55"/>
<polygon fill="black" stroke="black" points="1969.25,-8205.05 1959.15,-8208.26 1969.05,-8212.05 1969.25,-8205.05"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp6 -->
<g id="edge1365" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp6</title>
<path fill="none" stroke="black" d="M6901.78,-8322.2C7699.16,-8315.09 10269.69,-8289.73 11097.42,-8251.76 11240.34,-8245.2 11399.64,-8233.47 11529.04,-8222.81"/>
<polygon fill="black" stroke="black" points="11529.41,-8226.29 11539.09,-8221.97 11528.84,-8219.31 11529.41,-8226.29"/>
</g>
<!-- AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp7 -->
<g id="edge1367" class="edge">
<title>AR_exp_s1_l9&#45;&gt;ResMOE_s1_l9_tp7</title>
<path fill="none" stroke="black" d="M6900.75,-8320.81C7414.71,-8312.91 8669.03,-8291.01 9719.42,-8251.76 9974.68,-8242.22 10265.69,-8226.93 10471.19,-8215.39"/>
<polygon fill="black" stroke="black" points="10471.43,-8218.88 10481.21,-8214.83 10471.03,-8211.9 10471.43,-8218.88"/>
</g>
<!-- QKV_s1_l10_tp0 -->
<g id="node821" class="node">
<title>QKV_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5710.42,-8109.76 5372.42,-8109.76 5372.42,-8056.76 5710.42,-8056.76 5710.42,-8109.76"/>
<text text-anchor="middle" x="5541.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5541.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5541.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp0 -->
<g id="edge1369" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M6141.85,-8158.92C6014.94,-8143.88 5868.94,-8126.32 5736.42,-8109.76 5731.26,-8109.11 5726.02,-8108.46 5720.74,-8107.79"/>
<polygon fill="black" stroke="black" points="5720.88,-8104.28 5710.52,-8106.49 5720,-8111.22 5720.88,-8104.28"/>
</g>
<!-- QKV_s1_l10_tp1 -->
<g id="node822" class="node">
<title>QKV_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="6083.42,-8109.76 5745.42,-8109.76 5745.42,-8056.76 6083.42,-8056.76 6083.42,-8109.76"/>
<text text-anchor="middle" x="5914.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5914.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5914.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp1 -->
<g id="edge1370" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M6217.78,-8145.74C6160.04,-8134.04 6100.98,-8122.07 6050.49,-8111.84"/>
<polygon fill="black" stroke="black" points="6051,-8108.37 6040.51,-8109.81 6049.61,-8115.23 6051,-8108.37"/>
</g>
<!-- QKV_s1_l10_tp2 -->
<g id="node823" class="node">
<title>QKV_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="6464.42,-8109.76 6126.42,-8109.76 6126.42,-8056.76 6464.42,-8056.76 6464.42,-8109.76"/>
<text text-anchor="middle" x="6295.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6295.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6295.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp2 -->
<g id="edge1371" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6392.26,-8145.66C6375.82,-8135.24 6359.04,-8124.6 6344.18,-8115.17"/>
<polygon fill="black" stroke="black" points="6345.98,-8112.17 6335.66,-8109.77 6342.23,-8118.08 6345.98,-8112.17"/>
</g>
<!-- QKV_s1_l10_tp3 -->
<g id="node824" class="node">
<title>QKV_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="6829.42,-8109.76 6491.42,-8109.76 6491.42,-8056.76 6829.42,-8056.76 6829.42,-8109.76"/>
<text text-anchor="middle" x="6660.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6660.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6660.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp3 -->
<g id="edge1372" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6559.8,-8145.66C6576.89,-8135.24 6594.31,-8124.6 6609.76,-8115.17"/>
<polygon fill="black" stroke="black" points="6611.9,-8117.97 6618.61,-8109.77 6608.25,-8111.99 6611.9,-8117.97"/>
</g>
<!-- QKV_s1_l10_tp4 -->
<g id="node825" class="node">
<title>QKV_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="7210.42,-8109.76 6872.42,-8109.76 6872.42,-8056.76 7210.42,-8056.76 7210.42,-8109.76"/>
<text text-anchor="middle" x="7041.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7041.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7041.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp4 -->
<g id="edge1373" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M6692.83,-8154.04C6763.75,-8139.84 6840.42,-8124.5 6903.74,-8111.82"/>
<polygon fill="black" stroke="black" points="6904.67,-8115.2 6913.79,-8109.81 6903.3,-8108.34 6904.67,-8115.2"/>
</g>
<!-- QKV_s1_l10_tp5 -->
<g id="node826" class="node">
<title>QKV_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="7596.42,-8109.76 7258.42,-8109.76 7258.42,-8056.76 7596.42,-8056.76 7596.42,-8109.76"/>
<text text-anchor="middle" x="7427.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7427.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7427.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp5 -->
<g id="edge1374" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M6713.93,-8169.74C6860.01,-8152.58 7050.52,-8130.09 7219.42,-8109.76 7228.81,-8108.63 7238.43,-8107.47 7248.14,-8106.29"/>
<polygon fill="black" stroke="black" points="7248.78,-8109.74 7258.29,-8105.06 7247.94,-8102.79 7248.78,-8109.74"/>
</g>
<!-- QKV_s1_l10_tp6 -->
<g id="node827" class="node">
<title>QKV_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="7984.42,-8109.76 7646.42,-8109.76 7646.42,-8056.76 7984.42,-8056.76 7984.42,-8109.76"/>
<text text-anchor="middle" x="7815.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7815.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7815.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp6 -->
<g id="edge1375" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M6714.39,-8169.89C6793.89,-8161.3 6882.89,-8152.37 6964.42,-8145.76 7248.83,-8122.7 7321.2,-8134.97 7605.42,-8109.76 7615.47,-8108.87 7625.78,-8107.87 7636.18,-8106.81"/>
<polygon fill="black" stroke="black" points="7636.59,-8110.29 7646.18,-8105.77 7635.87,-8103.32 7636.59,-8110.29"/>
</g>
<!-- QKV_s1_l10_tp7 -->
<g id="node828" class="node">
<title>QKV_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="5320.42,-8109.76 4982.42,-8109.76 4982.42,-8056.76 5320.42,-8056.76 5320.42,-8109.76"/>
<text text-anchor="middle" x="5151.42" y="-8094.56" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5151.42" y="-8079.56" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5151.42" y="-8064.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp7 -->
<g id="edge1376" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;QKV_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M6165.82,-8176.7C5942.71,-8160.65 5634.17,-8136.75 5363.42,-8109.76 5352.76,-8108.7 5341.8,-8107.55 5330.76,-8106.35"/>
<polygon fill="black" stroke="black" points="5330.91,-8102.84 5320.59,-8105.23 5330.15,-8109.8 5330.91,-8102.84"/>
</g>
<!-- ResAttn_s1_l10_tp0 -->
<g id="node855" class="node">
<title>ResAttn_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5741.77,-7531.85 5184.45,-7531.85 5041.08,-7425.85 5598.4,-7425.85 5741.77,-7531.85"/>
<text text-anchor="middle" x="5391.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5391.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5391.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp0 -->
<g id="edge1418" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M6162.14,-8174.19C6030.47,-8164.66 5875.53,-8154 5735.42,-8145.76 5650.81,-8140.78 5046.36,-8152.95 4973.42,-8109.76 4922.1,-8079.37 4903.42,-8054.91 4903.42,-7995.26 4903.42,-7995.26 4903.42,-7995.26 4903.42,-7693.33 4903.42,-7580.45 5014.38,-7526.68 5130.47,-7501.32"/>
<polygon fill="black" stroke="black" points="5131.22,-7504.74 5140.28,-7499.24 5129.77,-7497.89 5131.22,-7504.74"/>
</g>
<!-- ResAttn_s1_l10_tp1 -->
<g id="node856" class="node">
<title>ResAttn_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="4011.77,-7531.85 3454.45,-7531.85 3311.08,-7425.85 3868.4,-7425.85 4011.77,-7531.85"/>
<text text-anchor="middle" x="3661.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3661.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3661.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp1 -->
<g id="edge1420" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M6160.4,-8172.83C6029.13,-8163.15 5874.96,-8152.73 5735.42,-8145.76 5194.97,-8118.76 5056.71,-8165.13 4518.42,-8109.76 4373.39,-8094.84 3872.42,-8141.05 3872.42,-7995.26 3872.42,-7995.26 3872.42,-7995.26 3872.42,-7693.33 3872.42,-7627.3 3820.72,-7574.33 3768.5,-7537.67"/>
<polygon fill="black" stroke="black" points="3770.35,-7534.7 3760.13,-7531.93 3766.4,-7540.47 3770.35,-7534.7"/>
</g>
<!-- ResAttn_s1_l10_tp2 -->
<g id="node857" class="node">
<title>ResAttn_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="4859.77,-7531.85 4302.45,-7531.85 4159.08,-7425.85 4716.4,-7425.85 4859.77,-7531.85"/>
<text text-anchor="middle" x="4509.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4509.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4509.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp2 -->
<g id="edge1422" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6162.16,-8173.94C6030.49,-8164.38 5875.55,-8153.75 5735.42,-8145.76 5369.89,-8124.91 5273.86,-8168.19 4912.42,-8109.76 4728.61,-8080.05 4509.42,-8181.46 4509.42,-7995.26 4509.42,-7995.26 4509.42,-7995.26 4509.42,-7693.33 4509.42,-7642.49 4509.42,-7584.83 4509.42,-7542.26"/>
<polygon fill="black" stroke="black" points="4512.92,-7542.05 4509.42,-7532.05 4505.92,-7542.05 4512.92,-7542.05"/>
</g>
<!-- ResAttn_s1_l10_tp3 -->
<g id="node858" class="node">
<title>ResAttn_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7871.77,-7531.85 7314.45,-7531.85 7171.08,-7425.85 7728.4,-7425.85 7871.77,-7531.85"/>
<text text-anchor="middle" x="7521.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7521.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7521.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp3 -->
<g id="edge1424" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6713.07,-8169.01C6792.88,-8160.31 6882.39,-8151.54 6964.42,-8145.76 7021.48,-8141.74 7944.21,-8138.92 7993.42,-8109.76 8044.34,-8079.59 8061.42,-8054.45 8061.42,-7995.26 8061.42,-7995.26 8061.42,-7995.26 8061.42,-7693.33 8061.42,-7626.69 7917.41,-7571.95 7778.13,-7534.59"/>
<polygon fill="black" stroke="black" points="7778.68,-7531.11 7768.11,-7531.93 7776.88,-7537.88 7778.68,-7531.11"/>
</g>
<!-- ResAttn_s1_l10_tp4 -->
<g id="node859" class="node">
<title>ResAttn_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="8805.77,-7531.85 8248.45,-7531.85 8105.08,-7425.85 8662.4,-7425.85 8805.77,-7531.85"/>
<text text-anchor="middle" x="8455.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8455.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8455.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp4 -->
<g id="edge1426" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M6713.07,-8168.95C6792.88,-8160.24 6882.39,-8151.48 6964.42,-8145.76 7130.53,-8134.17 8455.42,-8161.77 8455.42,-7995.26 8455.42,-7995.26 8455.42,-7995.26 8455.42,-7693.33 8455.42,-7642.49 8455.42,-7584.83 8455.42,-7542.26"/>
<polygon fill="black" stroke="black" points="8458.92,-7542.05 8455.42,-7532.05 8451.92,-7542.05 8458.92,-7542.05"/>
</g>
<!-- ResAttn_s1_l10_tp5 -->
<g id="node860" class="node">
<title>ResAttn_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="2870.77,-7531.85 2313.45,-7531.85 2170.08,-7425.85 2727.4,-7425.85 2870.77,-7531.85"/>
<text text-anchor="middle" x="2520.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2520.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2520.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp5 -->
<g id="edge1428" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M6159.52,-8172.08C6028.46,-8162.31 5874.67,-8152.03 5735.42,-8145.76 5584.68,-8138.97 3023.42,-8146.16 3023.42,-7995.26 3023.42,-7995.26 3023.42,-7995.26 3023.42,-7693.33 3023.42,-7629.18 2883.04,-7573.23 2750.61,-7534.72"/>
<polygon fill="black" stroke="black" points="2751.26,-7531.27 2740.68,-7531.86 2749.32,-7537.99 2751.26,-7531.27"/>
</g>
<!-- ResAttn_s1_l10_tp6 -->
<g id="node861" class="node">
<title>ResAttn_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="10948.77,-7531.85 10391.45,-7531.85 10248.08,-7425.85 10805.4,-7425.85 10948.77,-7531.85"/>
<text text-anchor="middle" x="10598.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10598.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10598.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp6 -->
<g id="edge1430" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M6712.09,-8168.45C6792.13,-8159.67 6882.04,-8150.99 6964.42,-8145.76 7112.64,-8136.34 9633.42,-8143.77 9633.42,-7995.26 9633.42,-7995.26 9633.42,-7995.26 9633.42,-7693.33 9633.42,-7551.52 10035.71,-7503.84 10320.81,-7487.85"/>
<polygon fill="black" stroke="black" points="10321.11,-7491.34 10330.9,-7487.3 10320.72,-7484.35 10321.11,-7491.34"/>
</g>
<!-- ResAttn_s1_l10_tp7 -->
<g id="node862" class="node">
<title>ResAttn_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="9799.77,-7531.85 9242.45,-7531.85 9099.08,-7425.85 9656.4,-7425.85 9799.77,-7531.85"/>
<text text-anchor="middle" x="9449.42" y="-7490.15" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9449.42" y="-7475.15" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9449.42" y="-7460.15" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp7 -->
<g id="edge1432" class="edge">
<title>ResMOE_s1_l9_tp0&#45;&gt;ResAttn_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M6712.74,-8168.72C6792.62,-8159.98 6882.27,-8151.27 6964.42,-8145.76 7531.38,-8107.75 7676.06,-8155.75 8242.42,-8109.76 8432.39,-8094.33 9092.42,-8185.85 9092.42,-7995.26 9092.42,-7995.26 9092.42,-7995.26 9092.42,-7693.33 9092.42,-7615.42 9155.83,-7565.26 9229.19,-7533.3"/>
<polygon fill="black" stroke="black" points="9230.81,-7536.42 9238.66,-7529.3 9228.08,-7529.97 9230.81,-7536.42"/>
</g>
<!-- SplitHeads_s1_l10_tp0 -->
<g id="node829" class="node">
<title>SplitHeads_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5693.42,-8020.76 5321.42,-8020.76 5321.42,-7967.76 5693.42,-7967.76 5693.42,-8020.76"/>
<text text-anchor="middle" x="5507.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5507.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5507.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp0&#45;&gt;SplitHeads_s1_l10_tp0 -->
<g id="edge1377" class="edge">
<title>QKV_s1_l10_tp0&#45;&gt;SplitHeads_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M5531.41,-8056.63C5528.22,-8048.47 5524.63,-8039.3 5521.23,-8030.58"/>
<polygon fill="black" stroke="black" points="5524.39,-8029.05 5517.49,-8021.01 5517.87,-8031.6 5524.39,-8029.05"/>
</g>
<!-- SplitHeads_s1_l10_tp1 -->
<g id="node830" class="node">
<title>SplitHeads_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="6083.42,-8020.76 5711.42,-8020.76 5711.42,-7967.76 6083.42,-7967.76 6083.42,-8020.76"/>
<text text-anchor="middle" x="5897.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5897.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5897.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp1&#45;&gt;SplitHeads_s1_l10_tp1 -->
<g id="edge1378" class="edge">
<title>QKV_s1_l10_tp1&#45;&gt;SplitHeads_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M5909.41,-8056.63C5907.84,-8048.56 5906.07,-8039.5 5904.38,-8030.86"/>
<polygon fill="black" stroke="black" points="5907.81,-8030.15 5902.45,-8021.01 5900.94,-8031.5 5907.81,-8030.15"/>
</g>
<!-- SplitHeads_s1_l10_tp2 -->
<g id="node831" class="node">
<title>SplitHeads_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="6473.42,-8020.76 6101.42,-8020.76 6101.42,-7967.76 6473.42,-7967.76 6473.42,-8020.76"/>
<text text-anchor="middle" x="6287.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6287.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6287.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp2&#45;&gt;SplitHeads_s1_l10_tp2 -->
<g id="edge1379" class="edge">
<title>QKV_s1_l10_tp2&#45;&gt;SplitHeads_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6293.07,-8056.63C6292.33,-8048.65 6291.51,-8039.69 6290.72,-8031.14"/>
<polygon fill="black" stroke="black" points="6294.19,-8030.65 6289.79,-8021.01 6287.22,-8031.29 6294.19,-8030.65"/>
</g>
<!-- SplitHeads_s1_l10_tp3 -->
<g id="node832" class="node">
<title>SplitHeads_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="6863.42,-8020.76 6491.42,-8020.76 6491.42,-7967.76 6863.42,-7967.76 6863.42,-8020.76"/>
<text text-anchor="middle" x="6677.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6677.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6677.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp3&#45;&gt;SplitHeads_s1_l10_tp3 -->
<g id="edge1380" class="edge">
<title>QKV_s1_l10_tp3&#45;&gt;SplitHeads_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6665.43,-8056.63C6667.01,-8048.56 6668.78,-8039.5 6670.47,-8030.86"/>
<polygon fill="black" stroke="black" points="6673.91,-8031.5 6672.39,-8021.01 6667.04,-8030.15 6673.91,-8031.5"/>
</g>
<!-- SplitHeads_s1_l10_tp4 -->
<g id="node833" class="node">
<title>SplitHeads_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="7253.42,-8020.76 6881.42,-8020.76 6881.42,-7967.76 7253.42,-7967.76 7253.42,-8020.76"/>
<text text-anchor="middle" x="7067.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7067.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7067.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp4&#45;&gt;SplitHeads_s1_l10_tp4 -->
<g id="edge1381" class="edge">
<title>QKV_s1_l10_tp4&#45;&gt;SplitHeads_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M7049.08,-8056.63C7051.49,-8048.56 7054.2,-8039.5 7056.78,-8030.86"/>
<polygon fill="black" stroke="black" points="7060.22,-8031.59 7059.73,-8021.01 7053.51,-8029.59 7060.22,-8031.59"/>
</g>
<!-- SplitHeads_s1_l10_tp5 -->
<g id="node834" class="node">
<title>SplitHeads_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="7643.42,-8020.76 7271.42,-8020.76 7271.42,-7967.76 7643.42,-7967.76 7643.42,-8020.76"/>
<text text-anchor="middle" x="7457.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7457.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7457.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp5&#45;&gt;SplitHeads_s1_l10_tp5 -->
<g id="edge1382" class="edge">
<title>QKV_s1_l10_tp5&#45;&gt;SplitHeads_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M7436.26,-8056.63C7439.07,-8048.47 7442.24,-8039.3 7445.24,-8030.58"/>
<polygon fill="black" stroke="black" points="7448.59,-8031.6 7448.54,-8021.01 7441.97,-8029.32 7448.59,-8031.6"/>
</g>
<!-- SplitHeads_s1_l10_tp6 -->
<g id="node835" class="node">
<title>SplitHeads_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="8033.42,-8020.76 7661.42,-8020.76 7661.42,-7967.76 8033.42,-7967.76 8033.42,-8020.76"/>
<text text-anchor="middle" x="7847.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7847.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7847.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp6&#45;&gt;SplitHeads_s1_l10_tp6 -->
<g id="edge1383" class="edge">
<title>QKV_s1_l10_tp6&#45;&gt;SplitHeads_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M7824.85,-8056.63C7827.85,-8048.47 7831.22,-8039.3 7834.43,-8030.58"/>
<polygon fill="black" stroke="black" points="7837.78,-8031.6 7837.95,-8021.01 7831.21,-8029.19 7837.78,-8031.6"/>
</g>
<!-- SplitHeads_s1_l10_tp7 -->
<g id="node836" class="node">
<title>SplitHeads_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="5303.42,-8020.76 4931.42,-8020.76 4931.42,-7967.76 5303.42,-7967.76 5303.42,-8020.76"/>
<text text-anchor="middle" x="5117.42" y="-8005.56" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5117.42" y="-7990.56" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5117.42" y="-7975.56" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l10_tp7&#45;&gt;SplitHeads_s1_l10_tp7 -->
<g id="edge1384" class="edge">
<title>QKV_s1_l10_tp7&#45;&gt;SplitHeads_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M5141.41,-8056.63C5138.22,-8048.47 5134.63,-8039.3 5131.23,-8030.58"/>
<polygon fill="black" stroke="black" points="5134.39,-8029.05 5127.49,-8021.01 5127.87,-8031.6 5134.39,-8029.05"/>
</g>
<!-- A2A_s1_l10 -->
<g id="node837" class="node">
<title>A2A_s1_l10</title>
<ellipse fill="none" stroke="black" cx="6482.42" cy="-7894.28" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6482.42" y="-7905.58" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="6482.42" y="-7890.58" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6482.42" y="-7875.58" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l10_tp0&#45;&gt;A2A_s1_l10 -->
<g id="edge1385" class="edge">
<title>SplitHeads_s1_l10_tp0&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M5693.45,-7968.78C5696.46,-7968.43 5699.45,-7968.09 5702.42,-7967.76 5885.43,-7947.3 6093.05,-7928.21 6248.05,-7914.76"/>
<polygon fill="black" stroke="black" points="6248.53,-7918.23 6258.19,-7913.88 6247.92,-7911.26 6248.53,-7918.23"/>
</g>
<!-- SplitHeads_s1_l10_tp1&#45;&gt;A2A_s1_l10 -->
<g id="edge1386" class="edge">
<title>SplitHeads_s1_l10_tp1&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M6049.98,-7967.71C6128.22,-7954.61 6223.93,-7938.58 6305.41,-7924.93"/>
<polygon fill="black" stroke="black" points="6305.99,-7928.38 6315.27,-7923.28 6304.83,-7921.48 6305.99,-7928.38"/>
</g>
<!-- SplitHeads_s1_l10_tp2&#45;&gt;A2A_s1_l10 -->
<g id="edge1387" class="edge">
<title>SplitHeads_s1_l10_tp2&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M6338.4,-7967.65C6358.24,-7957.68 6381.43,-7946.03 6403.33,-7935.02"/>
<polygon fill="black" stroke="black" points="6404.94,-7938.13 6412.3,-7930.51 6401.8,-7931.88 6404.94,-7938.13"/>
</g>
<!-- SplitHeads_s1_l10_tp3&#45;&gt;A2A_s1_l10 -->
<g id="edge1388" class="edge">
<title>SplitHeads_s1_l10_tp3&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M6626.44,-7967.65C6606.61,-7957.68 6583.42,-7946.03 6561.51,-7935.02"/>
<polygon fill="black" stroke="black" points="6563.05,-7931.88 6552.54,-7930.51 6559.91,-7938.13 6563.05,-7931.88"/>
</g>
<!-- SplitHeads_s1_l10_tp4&#45;&gt;A2A_s1_l10 -->
<g id="edge1389" class="edge">
<title>SplitHeads_s1_l10_tp4&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M6914.87,-7967.71C6836.63,-7954.61 6740.91,-7938.58 6659.44,-7924.93"/>
<polygon fill="black" stroke="black" points="6660.02,-7921.48 6649.58,-7923.28 6658.86,-7928.38 6660.02,-7921.48"/>
</g>
<!-- SplitHeads_s1_l10_tp5&#45;&gt;A2A_s1_l10 -->
<g id="edge1390" class="edge">
<title>SplitHeads_s1_l10_tp5&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M7271.4,-7968.78C7268.39,-7968.43 7265.39,-7968.09 7262.42,-7967.76 7079.42,-7947.3 6871.79,-7928.21 6716.79,-7914.76"/>
<polygon fill="black" stroke="black" points="6716.92,-7911.26 6706.66,-7913.88 6716.32,-7918.23 6716.92,-7911.26"/>
</g>
<!-- SplitHeads_s1_l10_tp6&#45;&gt;A2A_s1_l10 -->
<g id="edge1391" class="edge">
<title>SplitHeads_s1_l10_tp6&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M7661.41,-7968.65C7658.39,-7968.34 7655.4,-7968.05 7652.42,-7967.76 7340.38,-7937.73 6980.25,-7917.6 6742.88,-7906.32"/>
<polygon fill="black" stroke="black" points="6742.88,-7902.82 6732.73,-7905.84 6742.55,-7909.81 6742.88,-7902.82"/>
</g>
<!-- SplitHeads_s1_l10_tp7&#45;&gt;A2A_s1_l10 -->
<g id="edge1392" class="edge">
<title>SplitHeads_s1_l10_tp7&#45;&gt;A2A_s1_l10</title>
<path fill="none" stroke="black" d="M5303.43,-7968.65C5306.45,-7968.34 5309.45,-7968.05 5312.42,-7967.76 5624.47,-7937.73 5984.6,-7917.6 6221.96,-7906.32"/>
<polygon fill="black" stroke="black" points="6222.29,-7909.81 6232.12,-7905.84 6221.96,-7902.82 6222.29,-7909.81"/>
</g>
<!-- Attn_s1_l10_tp0 -->
<g id="node838" class="node">
<title>Attn_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5693.42,-7820.81 5321.42,-7820.81 5321.42,-7767.81 5693.42,-7767.81 5693.42,-7820.81"/>
<text text-anchor="middle" x="5507.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5507.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5507.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp0 -->
<g id="edge1393" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M6258.19,-7874.68C6104.85,-7861.43 5896.7,-7842.38 5703.51,-7820.91"/>
<polygon fill="black" stroke="black" points="5703.77,-7817.42 5693.45,-7819.79 5703,-7824.38 5703.77,-7817.42"/>
</g>
<!-- Attn_s1_l10_tp1 -->
<g id="node839" class="node">
<title>Attn_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="6083.42,-7820.81 5711.42,-7820.81 5711.42,-7767.81 6083.42,-7767.81 6083.42,-7820.81"/>
<text text-anchor="middle" x="5897.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5897.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5897.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp1 -->
<g id="edge1394" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M6315.18,-7865.27C6235.03,-7851.85 6139.42,-7835.84 6059.9,-7822.52"/>
<polygon fill="black" stroke="black" points="6060.23,-7819.02 6049.79,-7820.82 6059.07,-7825.93 6060.23,-7819.02"/>
</g>
<!-- Attn_s1_l10_tp2 -->
<g id="node840" class="node">
<title>Attn_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="6473.42,-7820.81 6101.42,-7820.81 6101.42,-7767.81 6473.42,-7767.81 6473.42,-7820.81"/>
<text text-anchor="middle" x="6287.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6287.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6287.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp2 -->
<g id="edge1395" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6412.3,-7858.05C6390.99,-7847.34 6367.79,-7835.69 6347.23,-7825.36"/>
<polygon fill="black" stroke="black" points="6348.8,-7822.23 6338.29,-7820.86 6345.65,-7828.48 6348.8,-7822.23"/>
</g>
<!-- Attn_s1_l10_tp3 -->
<g id="node841" class="node">
<title>Attn_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="6863.42,-7820.81 6491.42,-7820.81 6491.42,-7767.81 6863.42,-7767.81 6863.42,-7820.81"/>
<text text-anchor="middle" x="6677.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6677.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6677.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp3 -->
<g id="edge1396" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6552.55,-7858.05C6573.85,-7847.34 6597.06,-7835.69 6617.62,-7825.36"/>
<polygon fill="black" stroke="black" points="6619.19,-7828.48 6626.55,-7820.86 6616.05,-7822.23 6619.19,-7828.48"/>
</g>
<!-- Attn_s1_l10_tp4 -->
<g id="node842" class="node">
<title>Attn_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="7253.42,-7820.81 6881.42,-7820.81 6881.42,-7767.81 7253.42,-7767.81 7253.42,-7820.81"/>
<text text-anchor="middle" x="7067.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7067.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7067.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp4 -->
<g id="edge1397" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M6649.67,-7865.27C6729.81,-7851.85 6825.43,-7835.84 6904.95,-7822.52"/>
<polygon fill="black" stroke="black" points="6905.77,-7825.93 6915.06,-7820.82 6904.62,-7819.02 6905.77,-7825.93"/>
</g>
<!-- Attn_s1_l10_tp5 -->
<g id="node843" class="node">
<title>Attn_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="7643.42,-7820.81 7271.42,-7820.81 7271.42,-7767.81 7643.42,-7767.81 7643.42,-7820.81"/>
<text text-anchor="middle" x="7457.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7457.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7457.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp5 -->
<g id="edge1398" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M6706.66,-7874.68C6860,-7861.43 7068.14,-7842.38 7261.34,-7820.91"/>
<polygon fill="black" stroke="black" points="7261.85,-7824.38 7271.4,-7819.79 7261.07,-7817.42 7261.85,-7824.38"/>
</g>
<!-- Attn_s1_l10_tp6 -->
<g id="node844" class="node">
<title>Attn_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="8033.42,-7820.81 7661.42,-7820.81 7661.42,-7767.81 8033.42,-7767.81 8033.42,-7820.81"/>
<text text-anchor="middle" x="7847.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7847.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7847.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp6 -->
<g id="edge1399" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M6732.73,-7882.72C6967.46,-7871.66 7328.4,-7851.69 7651.39,-7820.88"/>
<polygon fill="black" stroke="black" points="7651.79,-7824.36 7661.41,-7819.92 7651.12,-7817.39 7651.79,-7824.36"/>
</g>
<!-- Attn_s1_l10_tp7 -->
<g id="node845" class="node">
<title>Attn_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="5303.42,-7820.81 4931.42,-7820.81 4931.42,-7767.81 5303.42,-7767.81 5303.42,-7820.81"/>
<text text-anchor="middle" x="5117.42" y="-7805.61" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5117.42" y="-7790.61" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5117.42" y="-7775.61" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l10&#45;&gt;Attn_s1_l10_tp7 -->
<g id="edge1400" class="edge">
<title>A2A_s1_l10&#45;&gt;Attn_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M6232.12,-7882.72C5997.38,-7871.66 5636.44,-7851.69 5313.46,-7820.88"/>
<polygon fill="black" stroke="black" points="5313.72,-7817.39 5303.43,-7819.92 5313.05,-7824.36 5313.72,-7817.39"/>
</g>
<!-- AR_attn_s1_l10 -->
<g id="node846" class="node">
<title>AR_attn_s1_l10</title>
<ellipse fill="none" stroke="black" cx="6440.42" cy="-7694.33" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6440.42" y="-7705.63" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="6440.42" y="-7690.63" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6440.42" y="-7675.63" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l10_tp0&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1401" class="edge">
<title>Attn_s1_l10_tp0&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M5693.45,-7768.84C5696.46,-7768.49 5699.45,-7768.15 5702.42,-7767.81 5872.62,-7748.33 6065.28,-7729.51 6211.07,-7715.94"/>
<polygon fill="black" stroke="black" points="6211.41,-7719.42 6221.04,-7715.01 6210.76,-7712.45 6211.41,-7719.42"/>
</g>
<!-- Attn_s1_l10_tp1&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1402" class="edge">
<title>Attn_s1_l10_tp1&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M6039.03,-7767.76C6109.85,-7754.98 6196.1,-7739.41 6270.47,-7726"/>
<polygon fill="black" stroke="black" points="6271.2,-7729.42 6280.41,-7724.2 6269.95,-7722.53 6271.2,-7729.42"/>
</g>
<!-- Attn_s1_l10_tp2&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1403" class="edge">
<title>Attn_s1_l10_tp2&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M6327.62,-7767.56C6342.47,-7758.05 6359.7,-7747.02 6376.16,-7736.48"/>
<polygon fill="black" stroke="black" points="6378.14,-7739.37 6384.68,-7731.03 6374.37,-7733.47 6378.14,-7739.37"/>
</g>
<!-- Attn_s1_l10_tp3&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1404" class="edge">
<title>Attn_s1_l10_tp3&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M6615.46,-7767.69C6590.56,-7757.4 6561.3,-7745.3 6533.91,-7733.98"/>
<polygon fill="black" stroke="black" points="6534.89,-7730.6 6524.31,-7730.01 6532.22,-7737.06 6534.89,-7730.6"/>
</g>
<!-- Attn_s1_l10_tp4&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1405" class="edge">
<title>Attn_s1_l10_tp4&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M6903.91,-7767.76C6818.14,-7754.35 6712.77,-7737.89 6624.18,-7724.04"/>
<polygon fill="black" stroke="black" points="6624.71,-7720.59 6614.29,-7722.5 6623.63,-7727.5 6624.71,-7720.59"/>
</g>
<!-- Attn_s1_l10_tp5&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1406" class="edge">
<title>Attn_s1_l10_tp5&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M7271.4,-7768.8C7268.39,-7768.46 7265.39,-7768.13 7262.42,-7767.81 7066.44,-7746.36 6843.62,-7727.03 6679.45,-7713.73"/>
<polygon fill="black" stroke="black" points="6679.47,-7710.22 6669.22,-7712.91 6678.91,-7717.2 6679.47,-7710.22"/>
</g>
<!-- Attn_s1_l10_tp6&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1407" class="edge">
<title>Attn_s1_l10_tp6&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M7661.41,-7768.69C7658.4,-7768.38 7655.4,-7768.09 7652.42,-7767.81 7325.79,-7736.72 6948.29,-7716.64 6702.53,-7705.68"/>
<polygon fill="black" stroke="black" points="6702.53,-7702.18 6692.39,-7705.23 6702.22,-7709.17 6702.53,-7702.18"/>
</g>
<!-- Attn_s1_l10_tp7&#45;&gt;AR_attn_s1_l10 -->
<g id="edge1408" class="edge">
<title>Attn_s1_l10_tp7&#45;&gt;AR_attn_s1_l10</title>
<path fill="none" stroke="black" d="M5303.43,-7768.7C5306.45,-7768.4 5309.45,-7768.1 5312.42,-7767.81 5609.88,-7738.83 5952.64,-7718.68 6181.52,-7707.11"/>
<polygon fill="black" stroke="black" points="6181.84,-7710.6 6191.66,-7706.6 6181.49,-7703.61 6181.84,-7710.6"/>
</g>
<!-- O_s1_l10_tp0 -->
<g id="node847" class="node">
<title>O_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5772.42,-7620.85 5434.42,-7620.85 5434.42,-7567.85 5772.42,-7567.85 5772.42,-7620.85"/>
<text text-anchor="middle" x="5603.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5603.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5603.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp0 -->
<g id="edge1409" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M6240.47,-7669.92C6101.18,-7653.62 5916.99,-7632.06 5782.5,-7616.32"/>
<polygon fill="black" stroke="black" points="5782.84,-7612.83 5772.5,-7615.15 5782.03,-7619.78 5782.84,-7612.83"/>
</g>
<!-- O_s1_l10_tp1 -->
<g id="node848" class="node">
<title>O_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="4875.42,-7620.85 4537.42,-7620.85 4537.42,-7567.85 4875.42,-7567.85 4875.42,-7620.85"/>
<text text-anchor="middle" x="4706.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4706.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4706.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp1 -->
<g id="edge1410" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M6188.2,-7683.54C5899.87,-7671.69 5413.83,-7649.67 4996.42,-7620.85 4960.7,-7618.39 4922.55,-7615.33 4886.04,-7612.21"/>
<polygon fill="black" stroke="black" points="4886.05,-7608.69 4875.79,-7611.32 4885.45,-7615.67 4886.05,-7608.69"/>
</g>
<!-- O_s1_l10_tp2 -->
<g id="node849" class="node">
<title>O_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="5343.42,-7620.85 5005.42,-7620.85 5005.42,-7567.85 5343.42,-7567.85 5343.42,-7620.85"/>
<text text-anchor="middle" x="5174.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5174.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5174.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp2 -->
<g id="edge1411" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6202.37,-7678.35C5996.57,-7664.92 5691.19,-7643.84 5425.42,-7620.85 5402.12,-7618.84 5377.62,-7616.55 5353.44,-7614.2"/>
<polygon fill="black" stroke="black" points="5353.76,-7610.72 5343.46,-7613.23 5353.08,-7617.68 5353.76,-7610.72"/>
</g>
<!-- O_s1_l10_tp3 -->
<g id="node850" class="node">
<title>O_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="6762.42,-7620.85 6424.42,-7620.85 6424.42,-7567.85 6762.42,-7567.85 6762.42,-7620.85"/>
<text text-anchor="middle" x="6593.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6593.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6593.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp3 -->
<g id="edge1412" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6496.09,-7657.68C6512.1,-7647.43 6529.42,-7636.34 6544.95,-7626.39"/>
<polygon fill="black" stroke="black" points="6546.84,-7629.34 6553.38,-7621 6543.07,-7623.44 6546.84,-7629.34"/>
</g>
<!-- O_s1_l10_tp4 -->
<g id="node851" class="node">
<title>O_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="7728.42,-7620.85 7390.42,-7620.85 7390.42,-7567.85 7728.42,-7567.85 7728.42,-7620.85"/>
<text text-anchor="middle" x="7559.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7559.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7559.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp4 -->
<g id="edge1413" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M6661.5,-7673.97C6872.01,-7655.54 7184.9,-7628.15 7380.28,-7611.04"/>
<polygon fill="black" stroke="black" points="7380.7,-7614.51 7390.36,-7610.16 7380.09,-7607.54 7380.7,-7614.51"/>
</g>
<!-- O_s1_l10_tp5 -->
<g id="node852" class="node">
<title>O_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="4400.42,-7620.85 4062.42,-7620.85 4062.42,-7567.85 4400.42,-7567.85 4400.42,-7620.85"/>
<text text-anchor="middle" x="4231.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4231.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4231.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp5 -->
<g id="edge1414" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M6181.61,-7687.44C5813.89,-7678.18 5119.2,-7657.39 4528.42,-7620.85 4490.37,-7618.5 4449.63,-7615.39 4410.89,-7612.15"/>
<polygon fill="black" stroke="black" points="4410.81,-7608.63 4400.55,-7611.28 4410.22,-7615.61 4410.81,-7608.63"/>
</g>
<!-- O_s1_l10_tp6 -->
<g id="node853" class="node">
<title>O_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="8983.42,-7620.85 8645.42,-7620.85 8645.42,-7567.85 8983.42,-7567.85 8983.42,-7620.85"/>
<text text-anchor="middle" x="8814.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8814.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8814.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp6 -->
<g id="edge1415" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M6697.73,-7686.54C7078,-7675.93 7812.45,-7653.22 8436.42,-7620.85 8501.27,-7617.49 8572.31,-7612.93 8635.13,-7608.59"/>
<polygon fill="black" stroke="black" points="8635.4,-7612.08 8645.14,-7607.9 8634.92,-7605.1 8635.4,-7612.08"/>
</g>
<!-- O_s1_l10_tp7 -->
<g id="node854" class="node">
<title>O_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="8427.42,-7620.85 8089.42,-7620.85 8089.42,-7567.85 8427.42,-7567.85 8427.42,-7620.85"/>
<text text-anchor="middle" x="8258.42" y="-7605.65" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8258.42" y="-7590.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8258.42" y="-7575.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l10&#45;&gt;O_s1_l10_tp7 -->
<g id="edge1416" class="edge">
<title>AR_attn_s1_l10&#45;&gt;O_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M6684.19,-7680.19C7054.83,-7660.22 7751.57,-7622.67 8079.35,-7605"/>
<polygon fill="black" stroke="black" points="8079.62,-7608.49 8089.42,-7604.46 8079.24,-7601.5 8079.62,-7608.49"/>
</g>
<!-- O_s1_l10_tp0&#45;&gt;ResAttn_s1_l10_tp0 -->
<g id="edge1417" class="edge">
<title>O_s1_l10_tp0&#45;&gt;ResAttn_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M5555.58,-7567.74C5538.35,-7558.51 5518.14,-7547.7 5497.92,-7536.87"/>
<polygon fill="black" stroke="black" points="5499.41,-7533.7 5488.94,-7532.06 5496.11,-7539.87 5499.41,-7533.7"/>
</g>
<!-- O_s1_l10_tp1&#45;&gt;ResAttn_s1_l10_tp1 -->
<g id="edge1419" class="edge">
<title>O_s1_l10_tp1&#45;&gt;ResAttn_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M4537.36,-7574.99C4392.58,-7559.27 4179.64,-7536.14 3999.97,-7516.62"/>
<polygon fill="black" stroke="black" points="4000.14,-7513.12 3989.82,-7515.52 3999.38,-7520.08 4000.14,-7513.12"/>
</g>
<!-- O_s1_l10_tp2&#45;&gt;ResAttn_s1_l10_tp2 -->
<g id="edge1421" class="edge">
<title>O_s1_l10_tp2&#45;&gt;ResAttn_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M5024.77,-7567.81C4965.14,-7557.63 4894.13,-7545.51 4824.17,-7533.57"/>
<polygon fill="black" stroke="black" points="4824.76,-7530.12 4814.31,-7531.89 4823.58,-7537.02 4824.76,-7530.12"/>
</g>
<!-- O_s1_l10_tp3&#45;&gt;ResAttn_s1_l10_tp3 -->
<g id="edge1423" class="edge">
<title>O_s1_l10_tp3&#45;&gt;ResAttn_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6762.55,-7572.67C6905.29,-7555.21 7111.6,-7529.98 7273.08,-7510.23"/>
<polygon fill="black" stroke="black" points="7273.67,-7513.68 7283.17,-7508.99 7272.82,-7506.73 7273.67,-7513.68"/>
</g>
<!-- O_s1_l10_tp4&#45;&gt;ResAttn_s1_l10_tp4 -->
<g id="edge1425" class="edge">
<title>O_s1_l10_tp4&#45;&gt;ResAttn_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M7728.48,-7571.94C7863.95,-7554.78 8055.95,-7530.46 8208.61,-7511.12"/>
<polygon fill="black" stroke="black" points="8209.13,-7514.58 8218.61,-7509.85 8208.25,-7507.64 8209.13,-7514.58"/>
</g>
<!-- O_s1_l10_tp5&#45;&gt;ResAttn_s1_l10_tp5 -->
<g id="edge1427" class="edge">
<title>O_s1_l10_tp5&#45;&gt;ResAttn_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M4062.32,-7582.17C3876.14,-7569.86 3567.93,-7549.47 3302.42,-7531.85 3149.79,-7521.73 2980.39,-7510.46 2838.4,-7501.02"/>
<polygon fill="black" stroke="black" points="2838.43,-7497.51 2828.22,-7500.34 2837.97,-7504.5 2838.43,-7497.51"/>
</g>
<!-- O_s1_l10_tp6&#45;&gt;ResAttn_s1_l10_tp6 -->
<g id="edge1429" class="edge">
<title>O_s1_l10_tp6&#45;&gt;ResAttn_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M8983.72,-7583.08C9181.55,-7571.03 9518.76,-7550.35 9808.42,-7531.85 9983.58,-7520.67 10180.56,-7507.7 10334.01,-7497.52"/>
<polygon fill="black" stroke="black" points="10334.31,-7501.01 10344.06,-7496.85 10333.85,-7494.02 10334.31,-7501.01"/>
</g>
<!-- O_s1_l10_tp7&#45;&gt;ResAttn_s1_l10_tp7 -->
<g id="edge1431" class="edge">
<title>O_s1_l10_tp7&#45;&gt;ResAttn_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M8427.48,-7577.24C8627.29,-7558.2 8961.83,-7526.32 9193.45,-7504.25"/>
<polygon fill="black" stroke="black" points="9194.09,-7507.7 9203.71,-7503.27 9193.42,-7500.73 9194.09,-7507.7"/>
</g>
<!-- Gate_s1_l10_tp0 -->
<g id="node863" class="node">
<title>Gate_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5844.42,-7389.85 5506.42,-7389.85 5506.42,-7336.85 5844.42,-7336.85 5844.42,-7389.85"/>
<text text-anchor="middle" x="5675.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5675.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5675.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp0&#45;&gt;Gate_s1_l10_tp0 -->
<g id="edge1433" class="edge">
<title>ResAttn_s1_l10_tp0&#45;&gt;Gate_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M5521.79,-7425.75C5549.33,-7414.74 5577.47,-7403.5 5602.01,-7393.69"/>
<polygon fill="black" stroke="black" points="5603.6,-7396.83 5611.58,-7389.87 5601,-7390.33 5603.6,-7396.83"/>
</g>
<!-- ResMOE_s1_l10_tp0 -->
<g id="node904" class="node">
<title>ResMOE_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="6618.77,-7100.9 6061.45,-7100.9 5918.08,-6994.9 6475.4,-6994.9 6618.77,-7100.9"/>
<text text-anchor="middle" x="6268.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6268.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6268.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp0&#45;&gt;ResMOE_s1_l10_tp0 -->
<g id="edge1506" class="edge">
<title>ResAttn_s1_l10_tp0&#45;&gt;ResMOE_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M5060.8,-7440.59C4997.04,-7434.65 4930.72,-7429.32 4868.42,-7425.85 4212.28,-7389.31 2566.71,-7439.42 1911.42,-7389.85 1626.38,-7368.29 1462.05,-7516.52 1274.42,-7300.85 1258.96,-7283.08 1258.06,-7264.79 1274.42,-7247.85 1438.76,-7077.74 5293.22,-7113.29 5529.42,-7100.9 5688.25,-7092.57 5866.06,-7080.16 6007.46,-7069.55"/>
<polygon fill="black" stroke="black" points="6007.87,-7073.02 6017.58,-7068.78 6007.35,-7066.04 6007.87,-7073.02"/>
</g>
<!-- Gate_s1_l10_tp1 -->
<g id="node864" class="node">
<title>Gate_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="3562.42,-7389.85 3224.42,-7389.85 3224.42,-7336.85 3562.42,-7336.85 3562.42,-7389.85"/>
<text text-anchor="middle" x="3393.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3393.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3393.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp1&#45;&gt;Gate_s1_l10_tp1 -->
<g id="edge1434" class="edge">
<title>ResAttn_s1_l10_tp1&#45;&gt;Gate_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M3538.4,-7425.75C3512.52,-7414.79 3486.09,-7403.6 3463.01,-7393.82"/>
<polygon fill="black" stroke="black" points="3464.24,-7390.54 3453.67,-7389.87 3461.51,-7396.99 3464.24,-7390.54"/>
</g>
<!-- ResMOE_s1_l10_tp1 -->
<g id="node905" class="node">
<title>ResMOE_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="4044.77,-7100.9 3487.45,-7100.9 3344.08,-6994.9 3901.4,-6994.9 4044.77,-7100.9"/>
<text text-anchor="middle" x="3694.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3694.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3694.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp1&#45;&gt;ResMOE_s1_l10_tp1 -->
<g id="edge1508" class="edge">
<title>ResAttn_s1_l10_tp1&#45;&gt;ResMOE_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M3348.62,-7453.83C3205.65,-7443.67 3034.05,-7432.65 2879.42,-7425.85 2832.9,-7423.81 1235.99,-7423.13 1203.42,-7389.85 1164.1,-7349.68 1164.38,-7177.34 1203.42,-7136.9 1222.44,-7117.2 2770.01,-7073.6 3416.01,-7056.24"/>
<polygon fill="black" stroke="black" points="3416.49,-7059.73 3426.4,-7055.96 3416.31,-7052.73 3416.49,-7059.73"/>
</g>
<!-- Gate_s1_l10_tp2 -->
<g id="node865" class="node">
<title>Gate_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="4678.42,-7389.85 4340.42,-7389.85 4340.42,-7336.85 4678.42,-7336.85 4678.42,-7389.85"/>
<text text-anchor="middle" x="4509.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4509.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4509.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp2&#45;&gt;Gate_s1_l10_tp2 -->
<g id="edge1435" class="edge">
<title>ResAttn_s1_l10_tp2&#45;&gt;Gate_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M4509.42,-7425.75C4509.42,-7417.08 4509.42,-7408.27 4509.42,-7400.12"/>
<polygon fill="black" stroke="black" points="4512.92,-7399.87 4509.42,-7389.87 4505.92,-7399.87 4512.92,-7399.87"/>
</g>
<!-- ResMOE_s1_l10_tp2 -->
<g id="node906" class="node">
<title>ResMOE_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="5520.77,-7100.9 4963.45,-7100.9 4820.08,-6994.9 5377.4,-6994.9 5520.77,-7100.9"/>
<text text-anchor="middle" x="5170.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5170.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5170.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp2&#45;&gt;ResMOE_s1_l10_tp2 -->
<g id="edge1510" class="edge">
<title>ResAttn_s1_l10_tp2&#45;&gt;ResMOE_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M4175.7,-7438.18C4123.78,-7433.22 4070.7,-7428.85 4020.42,-7425.85 3981.89,-7423.56 1268.54,-7417.32 1241.42,-7389.85 1201.93,-7349.85 1201.93,-7176.9 1241.42,-7136.9 1268.86,-7109.1 4014.38,-7102.06 4053.42,-7100.9 4343.82,-7092.28 4676.4,-7075.97 4902.62,-7063.91"/>
<polygon fill="black" stroke="black" points="4902.84,-7067.4 4912.64,-7063.37 4902.47,-7060.41 4902.84,-7067.4"/>
</g>
<!-- Gate_s1_l10_tp3 -->
<g id="node866" class="node">
<title>Gate_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7474.42,-7389.85 7136.42,-7389.85 7136.42,-7336.85 7474.42,-7336.85 7474.42,-7389.85"/>
<text text-anchor="middle" x="7305.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7305.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7305.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp3&#45;&gt;Gate_s1_l10_tp3 -->
<g id="edge1436" class="edge">
<title>ResAttn_s1_l10_tp3&#45;&gt;Gate_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M7422.27,-7425.75C7402.06,-7415.13 7381.44,-7404.3 7363.25,-7394.74"/>
<polygon fill="black" stroke="black" points="7364.46,-7391.42 7353.98,-7389.87 7361.2,-7397.62 7364.46,-7391.42"/>
</g>
<!-- ResMOE_s1_l10_tp3 -->
<g id="node907" class="node">
<title>ResMOE_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7467.77,-7100.9 6910.45,-7100.9 6767.08,-6994.9 7324.4,-6994.9 7467.77,-7100.9"/>
<text text-anchor="middle" x="7117.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7117.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7117.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp3&#45;&gt;ResMOE_s1_l10_tp3 -->
<g id="edge1512" class="edge">
<title>ResAttn_s1_l10_tp3&#45;&gt;ResMOE_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M7763.48,-7451.73C7866.04,-7441.77 7986.94,-7431.46 8096.42,-7425.85 8756.27,-7392.07 10410.59,-7439.67 11069.42,-7389.85 11358.66,-7367.98 11907.04,-7457.35 11706.42,-7247.85 11669.26,-7209.05 8439.82,-7094.49 7421.44,-7059.3"/>
<polygon fill="black" stroke="black" points="7421.53,-7055.8 7411.41,-7058.96 7421.29,-7062.8 7421.53,-7055.8"/>
</g>
<!-- Gate_s1_l10_tp4 -->
<g id="node867" class="node">
<title>Gate_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="8624.42,-7389.85 8286.42,-7389.85 8286.42,-7336.85 8624.42,-7336.85 8624.42,-7389.85"/>
<text text-anchor="middle" x="8455.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8455.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8455.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp4&#45;&gt;Gate_s1_l10_tp4 -->
<g id="edge1437" class="edge">
<title>ResAttn_s1_l10_tp4&#45;&gt;Gate_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M8455.42,-7425.75C8455.42,-7417.08 8455.42,-7408.27 8455.42,-7400.12"/>
<polygon fill="black" stroke="black" points="8458.92,-7399.87 8455.42,-7389.87 8451.92,-7399.87 8458.92,-7399.87"/>
</g>
<!-- ResMOE_s1_l10_tp4 -->
<g id="node908" class="node">
<title>ResMOE_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="9504.77,-7100.9 8947.45,-7100.9 8804.08,-6994.9 9361.4,-6994.9 9504.77,-7100.9"/>
<text text-anchor="middle" x="9154.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9154.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="9154.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp4&#45;&gt;ResMOE_s1_l10_tp4 -->
<g id="edge1514" class="edge">
<title>ResAttn_s1_l10_tp4&#45;&gt;ResMOE_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M8700.56,-7453.97C8818.33,-7443.47 8961.57,-7432.12 9090.42,-7425.85 9349.15,-7413.28 11165.09,-7427.17 11421.42,-7389.85 11566.23,-7368.77 11650.03,-7417.48 11738.42,-7300.85 11920.3,-7060.89 10693.64,-7159.94 10393.42,-7136.9 10080.75,-7112.9 9723.5,-7087.77 9473.21,-7070.54"/>
<polygon fill="black" stroke="black" points="9473.08,-7067.02 9462.86,-7069.83 9472.6,-7074.01 9473.08,-7067.02"/>
</g>
<!-- Gate_s1_l10_tp5 -->
<g id="node868" class="node">
<title>Gate_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="2258.42,-7389.85 1920.42,-7389.85 1920.42,-7336.85 2258.42,-7336.85 2258.42,-7389.85"/>
<text text-anchor="middle" x="2089.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2089.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2089.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp5&#45;&gt;Gate_s1_l10_tp5 -->
<g id="edge1438" class="edge">
<title>ResAttn_s1_l10_tp5&#45;&gt;Gate_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M2322.9,-7425.84C2279.39,-7414.38 2234.9,-7402.66 2196.58,-7392.57"/>
<polygon fill="black" stroke="black" points="2197.02,-7389.07 2186.46,-7389.91 2195.24,-7395.84 2197.02,-7389.07"/>
</g>
<!-- ResMOE_s1_l10_tp5 -->
<g id="node909" class="node">
<title>ResMOE_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="1811.77,-7100.9 1254.45,-7100.9 1111.08,-6994.9 1668.4,-6994.9 1811.77,-7100.9"/>
<text text-anchor="middle" x="1461.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1461.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1461.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp5&#45;&gt;ResMOE_s1_l10_tp5 -->
<g id="edge1516" class="edge">
<title>ResAttn_s1_l10_tp5&#45;&gt;ResMOE_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M2227.41,-7468.3C1843.47,-7454.39 1214.25,-7426.21 1177.42,-7389.85 1097.4,-7310.87 1105.32,-7226.37 1173.42,-7136.9 1183.9,-7123.14 1208.19,-7110.61 1238.46,-7099.6"/>
<polygon fill="black" stroke="black" points="1239.77,-7102.86 1248.04,-7096.24 1237.45,-7096.25 1239.77,-7102.86"/>
</g>
<!-- Gate_s1_l10_tp6 -->
<g id="node869" class="node">
<title>Gate_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="11060.42,-7389.85 10722.42,-7389.85 10722.42,-7336.85 11060.42,-7336.85 11060.42,-7389.85"/>
<text text-anchor="middle" x="10891.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10891.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10891.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp6&#45;&gt;Gate_s1_l10_tp6 -->
<g id="edge1439" class="edge">
<title>ResAttn_s1_l10_tp6&#45;&gt;Gate_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M10732.92,-7425.75C10761.46,-7414.7 10790.62,-7403.4 10816.02,-7393.56"/>
<polygon fill="black" stroke="black" points="10817.5,-7396.74 10825.56,-7389.87 10814.97,-7390.22 10817.5,-7396.74"/>
</g>
<!-- ResMOE_s1_l10_tp6 -->
<g id="node910" class="node">
<title>ResMOE_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="11930.77,-7100.9 11373.45,-7100.9 11230.08,-6994.9 11787.4,-6994.9 11930.77,-7100.9"/>
<text text-anchor="middle" x="11580.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11580.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11580.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp6&#45;&gt;ResMOE_s1_l10_tp6 -->
<g id="edge1518" class="edge">
<title>ResAttn_s1_l10_tp6&#45;&gt;ResMOE_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M10875.17,-7477.3C11214.54,-7473.68 11752.75,-7457.22 11815.42,-7389.85 11892,-7307.54 11879.48,-7229.29 11815.42,-7136.9 11807.53,-7125.52 11797.98,-7115.61 11787.3,-7106.98"/>
<polygon fill="black" stroke="black" points="11789.41,-7104.19 11779.33,-7100.92 11785.17,-7109.76 11789.41,-7104.19"/>
</g>
<!-- Gate_s1_l10_tp7 -->
<g id="node870" class="node">
<title>Gate_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="9756.42,-7389.85 9418.42,-7389.85 9418.42,-7336.85 9756.42,-7336.85 9756.42,-7389.85"/>
<text text-anchor="middle" x="9587.42" y="-7374.65" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9587.42" y="-7359.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9587.42" y="-7344.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp7&#45;&gt;Gate_s1_l10_tp7 -->
<g id="edge1440" class="edge">
<title>ResAttn_s1_l10_tp7&#45;&gt;Gate_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M9512.77,-7425.75C9524.97,-7415.72 9537.41,-7405.49 9548.54,-7396.33"/>
<polygon fill="black" stroke="black" points="9550.9,-7398.92 9556.4,-7389.87 9546.45,-7393.52 9550.9,-7398.92"/>
</g>
<!-- ResMOE_s1_l10_tp7 -->
<g id="node911" class="node">
<title>ResMOE_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="10882.77,-7100.9 10325.45,-7100.9 10182.08,-6994.9 10739.4,-6994.9 10882.77,-7100.9"/>
<text text-anchor="middle" x="10532.42" y="-7059.2" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10532.42" y="-7044.2" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10532.42" y="-7029.2" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l10_tp7&#45;&gt;ResMOE_s1_l10_tp7 -->
<g id="edge1520" class="edge">
<title>ResAttn_s1_l10_tp7&#45;&gt;ResMOE_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M9701,-7458.8C9856.13,-7447.67 10059.21,-7434.21 10239.42,-7425.85 10387.76,-7418.98 11431.06,-7424.66 11575.42,-7389.85 11664.51,-7368.37 11712.57,-7378.39 11761.42,-7300.85 11773.98,-7280.92 11776.69,-7265.79 11761.42,-7247.85 11703.53,-7179.83 11207.95,-7116.7 10864.07,-7080.51"/>
<polygon fill="black" stroke="black" points="10864.26,-7077.01 10853.95,-7079.44 10863.53,-7083.97 10864.26,-7077.01"/>
</g>
<!-- Expert32_s1_l10_tp0 -->
<g id="node871" class="node">
<title>Expert32_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="6155.42,-7300.85 5847.42,-7300.85 5847.42,-7247.85 6155.42,-7247.85 6155.42,-7300.85"/>
<text text-anchor="middle" x="6001.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="6001.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6001.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp0&#45;&gt;Expert32_s1_l10_tp0 -->
<g id="edge1441" class="edge">
<title>Gate_s1_l10_tp0&#45;&gt;Expert32_s1_l10_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5771.03,-7336.84C5810.26,-7326.37 5855.8,-7314.21 5895.99,-7303.49"/>
<polygon fill="black" stroke="black" points="5897.06,-7306.83 5905.82,-7300.87 5895.25,-7300.06 5897.06,-7306.83"/>
</g>
<!-- Expert33_s1_l10_tp0 -->
<g id="node872" class="node">
<title>Expert33_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="6481.42,-7300.85 6173.42,-7300.85 6173.42,-7247.85 6481.42,-7247.85 6481.42,-7300.85"/>
<text text-anchor="middle" x="6327.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="6327.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6327.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp0&#45;&gt;Expert33_s1_l10_tp0 -->
<g id="edge1442" class="edge">
<title>Gate_s1_l10_tp0&#45;&gt;Expert33_s1_l10_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5844.47,-7342.36C5935.97,-7331.23 6051.22,-7316.72 6162.9,-7301.05"/>
<polygon fill="black" stroke="black" points="6163.59,-7304.49 6173.01,-7299.63 6162.62,-7297.56 6163.59,-7304.49"/>
</g>
<!-- Expert34_s1_l10_tp0 -->
<g id="node873" class="node">
<title>Expert34_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5503.42,-7300.85 5195.42,-7300.85 5195.42,-7247.85 5503.42,-7247.85 5503.42,-7300.85"/>
<text text-anchor="middle" x="5349.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="5349.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5349.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp0&#45;&gt;Expert34_s1_l10_tp0 -->
<g id="edge1443" class="edge">
<title>Gate_s1_l10_tp0&#45;&gt;Expert34_s1_l10_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5579.81,-7336.84C5540.59,-7326.37 5495.04,-7314.21 5454.85,-7303.49"/>
<polygon fill="black" stroke="black" points="5455.59,-7300.06 5445.03,-7300.87 5453.79,-7306.83 5455.59,-7300.06"/>
</g>
<!-- Expert35_s1_l10_tp0 -->
<g id="node874" class="node">
<title>Expert35_s1_l10_tp0</title>
<polygon fill="none" stroke="black" points="5829.42,-7300.85 5521.42,-7300.85 5521.42,-7247.85 5829.42,-7247.85 5829.42,-7300.85"/>
<text text-anchor="middle" x="5675.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="5675.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5675.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp0&#45;&gt;Expert35_s1_l10_tp0 -->
<g id="edge1444" class="edge">
<title>Gate_s1_l10_tp0&#45;&gt;Expert35_s1_l10_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5675.42,-7336.72C5675.42,-7328.74 5675.42,-7319.79 5675.42,-7311.24"/>
<polygon fill="black" stroke="black" points="5678.92,-7311.1 5675.42,-7301.1 5671.92,-7311.1 5678.92,-7311.1"/>
</g>
<!-- Expert36_s1_l10_tp1 -->
<g id="node875" class="node">
<title>Expert36_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="3547.42,-7300.85 3239.42,-7300.85 3239.42,-7247.85 3547.42,-7247.85 3547.42,-7300.85"/>
<text text-anchor="middle" x="3393.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="3393.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3393.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp1&#45;&gt;Expert36_s1_l10_tp1 -->
<g id="edge1445" class="edge">
<title>Gate_s1_l10_tp1&#45;&gt;Expert36_s1_l10_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3393.42,-7336.72C3393.42,-7328.74 3393.42,-7319.79 3393.42,-7311.24"/>
<polygon fill="black" stroke="black" points="3396.92,-7311.1 3393.42,-7301.1 3389.92,-7311.1 3396.92,-7311.1"/>
</g>
<!-- Expert37_s1_l10_tp1 -->
<g id="node876" class="node">
<title>Expert37_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="3873.42,-7300.85 3565.42,-7300.85 3565.42,-7247.85 3873.42,-7247.85 3873.42,-7300.85"/>
<text text-anchor="middle" x="3719.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="3719.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3719.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp1&#45;&gt;Expert37_s1_l10_tp1 -->
<g id="edge1446" class="edge">
<title>Gate_s1_l10_tp1&#45;&gt;Expert37_s1_l10_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3489.03,-7336.84C3528.26,-7326.37 3573.8,-7314.21 3613.99,-7303.49"/>
<polygon fill="black" stroke="black" points="3615.06,-7306.83 3623.82,-7300.87 3613.25,-7300.06 3615.06,-7306.83"/>
</g>
<!-- Expert38_s1_l10_tp1 -->
<g id="node877" class="node">
<title>Expert38_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="2895.42,-7300.85 2587.42,-7300.85 2587.42,-7247.85 2895.42,-7247.85 2895.42,-7300.85"/>
<text text-anchor="middle" x="2741.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2741.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2741.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp1&#45;&gt;Expert38_s1_l10_tp1 -->
<g id="edge1447" class="edge">
<title>Gate_s1_l10_tp1&#45;&gt;Expert38_s1_l10_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3224.37,-7342.36C3132.87,-7331.23 3017.63,-7316.72 2905.94,-7301.05"/>
<polygon fill="black" stroke="black" points="2906.23,-7297.56 2895.84,-7299.63 2905.25,-7304.49 2906.23,-7297.56"/>
</g>
<!-- Expert39_s1_l10_tp1 -->
<g id="node878" class="node">
<title>Expert39_s1_l10_tp1</title>
<polygon fill="none" stroke="black" points="3221.42,-7300.85 2913.42,-7300.85 2913.42,-7247.85 3221.42,-7247.85 3221.42,-7300.85"/>
<text text-anchor="middle" x="3067.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="3067.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3067.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp1&#45;&gt;Expert39_s1_l10_tp1 -->
<g id="edge1448" class="edge">
<title>Gate_s1_l10_tp1&#45;&gt;Expert39_s1_l10_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3297.81,-7336.84C3258.59,-7326.37 3213.04,-7314.21 3172.85,-7303.49"/>
<polygon fill="black" stroke="black" points="3173.59,-7300.06 3163.03,-7300.87 3171.79,-7306.83 3173.59,-7300.06"/>
</g>
<!-- Expert40_s1_l10_tp2 -->
<g id="node879" class="node">
<title>Expert40_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="5177.42,-7300.85 4869.42,-7300.85 4869.42,-7247.85 5177.42,-7247.85 5177.42,-7300.85"/>
<text text-anchor="middle" x="5023.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="5023.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5023.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp2&#45;&gt;Expert40_s1_l10_tp2 -->
<g id="edge1449" class="edge">
<title>Gate_s1_l10_tp2&#45;&gt;Expert40_s1_l10_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4660.17,-7336.84C4723.84,-7326.06 4798.08,-7313.49 4862.79,-7302.54"/>
<polygon fill="black" stroke="black" points="4863.41,-7305.99 4872.68,-7300.87 4862.24,-7299.09 4863.41,-7305.99"/>
</g>
<!-- Expert41_s1_l10_tp2 -->
<g id="node880" class="node">
<title>Expert41_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="4199.42,-7300.85 3891.42,-7300.85 3891.42,-7247.85 4199.42,-7247.85 4199.42,-7300.85"/>
<text text-anchor="middle" x="4045.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="4045.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4045.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp2&#45;&gt;Expert41_s1_l10_tp2 -->
<g id="edge1450" class="edge">
<title>Gate_s1_l10_tp2&#45;&gt;Expert41_s1_l10_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4373.34,-7336.84C4316.21,-7326.13 4249.67,-7313.65 4191.51,-7302.74"/>
<polygon fill="black" stroke="black" points="4191.97,-7299.27 4181.5,-7300.87 4190.68,-7306.15 4191.97,-7299.27"/>
</g>
<!-- Expert42_s1_l10_tp2 -->
<g id="node881" class="node">
<title>Expert42_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="4525.42,-7300.85 4217.42,-7300.85 4217.42,-7247.85 4525.42,-7247.85 4525.42,-7300.85"/>
<text text-anchor="middle" x="4371.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="4371.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4371.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp2&#45;&gt;Expert42_s1_l10_tp2 -->
<g id="edge1451" class="edge">
<title>Gate_s1_l10_tp2&#45;&gt;Expert42_s1_l10_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4468.76,-7336.72C4453.74,-7327.25 4436.54,-7316.41 4420.82,-7306.5"/>
<polygon fill="black" stroke="black" points="4422.59,-7303.48 4412.27,-7301.1 4418.86,-7309.4 4422.59,-7303.48"/>
</g>
<!-- Expert43_s1_l10_tp2 -->
<g id="node882" class="node">
<title>Expert43_s1_l10_tp2</title>
<polygon fill="none" stroke="black" points="4851.42,-7300.85 4543.42,-7300.85 4543.42,-7247.85 4851.42,-7247.85 4851.42,-7300.85"/>
<text text-anchor="middle" x="4697.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="4697.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4697.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp2&#45;&gt;Expert43_s1_l10_tp2 -->
<g id="edge1452" class="edge">
<title>Gate_s1_l10_tp2&#45;&gt;Expert43_s1_l10_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4564.56,-7336.84C4585.98,-7326.92 4610.68,-7315.5 4632.92,-7305.2"/>
<polygon fill="black" stroke="black" points="4634.68,-7308.24 4642.29,-7300.87 4631.74,-7301.89 4634.68,-7308.24"/>
</g>
<!-- Expert44_s1_l10_tp3 -->
<g id="node883" class="node">
<title>Expert44_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="6807.42,-7300.85 6499.42,-7300.85 6499.42,-7247.85 6807.42,-7247.85 6807.42,-7300.85"/>
<text text-anchor="middle" x="6653.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="6653.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6653.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp3&#45;&gt;Expert44_s1_l10_tp3 -->
<g id="edge1453" class="edge">
<title>Gate_s1_l10_tp3&#45;&gt;Expert44_s1_l10_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7136.37,-7342.36C7044.87,-7331.23 6929.63,-7316.72 6817.94,-7301.05"/>
<polygon fill="black" stroke="black" points="6818.23,-7297.56 6807.84,-7299.63 6817.25,-7304.49 6818.23,-7297.56"/>
</g>
<!-- Expert45_s1_l10_tp3 -->
<g id="node884" class="node">
<title>Expert45_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7133.42,-7300.85 6825.42,-7300.85 6825.42,-7247.85 7133.42,-7247.85 7133.42,-7300.85"/>
<text text-anchor="middle" x="6979.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6979.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6979.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp3&#45;&gt;Expert45_s1_l10_tp3 -->
<g id="edge1454" class="edge">
<title>Gate_s1_l10_tp3&#45;&gt;Expert45_s1_l10_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7209.81,-7336.84C7170.59,-7326.37 7125.04,-7314.21 7084.85,-7303.49"/>
<polygon fill="black" stroke="black" points="7085.59,-7300.06 7075.03,-7300.87 7083.79,-7306.83 7085.59,-7300.06"/>
</g>
<!-- Expert46_s1_l10_tp3 -->
<g id="node885" class="node">
<title>Expert46_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7459.42,-7300.85 7151.42,-7300.85 7151.42,-7247.85 7459.42,-7247.85 7459.42,-7300.85"/>
<text text-anchor="middle" x="7305.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="7305.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7305.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp3&#45;&gt;Expert46_s1_l10_tp3 -->
<g id="edge1455" class="edge">
<title>Gate_s1_l10_tp3&#45;&gt;Expert46_s1_l10_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7305.42,-7336.72C7305.42,-7328.74 7305.42,-7319.79 7305.42,-7311.24"/>
<polygon fill="black" stroke="black" points="7308.92,-7311.1 7305.42,-7301.1 7301.92,-7311.1 7308.92,-7311.1"/>
</g>
<!-- Expert47_s1_l10_tp3 -->
<g id="node886" class="node">
<title>Expert47_s1_l10_tp3</title>
<polygon fill="none" stroke="black" points="7785.42,-7300.85 7477.42,-7300.85 7477.42,-7247.85 7785.42,-7247.85 7785.42,-7300.85"/>
<text text-anchor="middle" x="7631.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="7631.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7631.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp3&#45;&gt;Expert47_s1_l10_tp3 -->
<g id="edge1456" class="edge">
<title>Gate_s1_l10_tp3&#45;&gt;Expert47_s1_l10_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7401.03,-7336.84C7440.26,-7326.37 7485.8,-7314.21 7525.99,-7303.49"/>
<polygon fill="black" stroke="black" points="7527.06,-7306.83 7535.82,-7300.87 7525.25,-7300.06 7527.06,-7306.83"/>
</g>
<!-- Expert48_s1_l10_tp4 -->
<g id="node887" class="node">
<title>Expert48_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="8111.42,-7300.85 7803.42,-7300.85 7803.42,-7247.85 8111.42,-7247.85 8111.42,-7300.85"/>
<text text-anchor="middle" x="7957.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7957.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7957.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp4&#45;&gt;Expert48_s1_l10_tp4 -->
<g id="edge1457" class="edge">
<title>Gate_s1_l10_tp4&#45;&gt;Expert48_s1_l10_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8309.37,-7336.84C8247.8,-7326.08 8176.04,-7313.55 8113.44,-7302.61"/>
<polygon fill="black" stroke="black" points="8113.92,-7299.14 8103.47,-7300.87 8112.72,-7306.04 8113.92,-7299.14"/>
</g>
<!-- Expert49_s1_l10_tp4 -->
<g id="node888" class="node">
<title>Expert49_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="8437.42,-7300.85 8129.42,-7300.85 8129.42,-7247.85 8437.42,-7247.85 8437.42,-7300.85"/>
<text text-anchor="middle" x="8283.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="8283.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8283.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp4&#45;&gt;Expert49_s1_l10_tp4 -->
<g id="edge1458" class="edge">
<title>Gate_s1_l10_tp4&#45;&gt;Expert49_s1_l10_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8404.75,-7336.72C8385.41,-7326.94 8363.19,-7315.7 8343.1,-7305.54"/>
<polygon fill="black" stroke="black" points="8344.54,-7302.34 8334.03,-7300.95 8341.38,-7308.59 8344.54,-7302.34"/>
</g>
<!-- Expert50_s1_l10_tp4 -->
<g id="node889" class="node">
<title>Expert50_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="8763.42,-7300.85 8455.42,-7300.85 8455.42,-7247.85 8763.42,-7247.85 8763.42,-7300.85"/>
<text text-anchor="middle" x="8609.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="8609.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8609.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp4&#45;&gt;Expert50_s1_l10_tp4 -->
<g id="edge1459" class="edge">
<title>Gate_s1_l10_tp4&#45;&gt;Expert50_s1_l10_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8500.79,-7336.72C8517.79,-7327.12 8537.28,-7316.11 8555.02,-7306.09"/>
<polygon fill="black" stroke="black" points="8557.12,-7308.92 8564.11,-7300.95 8553.68,-7302.82 8557.12,-7308.92"/>
</g>
<!-- Expert51_s1_l10_tp4 -->
<g id="node890" class="node">
<title>Expert51_s1_l10_tp4</title>
<polygon fill="none" stroke="black" points="9089.42,-7300.85 8781.42,-7300.85 8781.42,-7247.85 9089.42,-7247.85 9089.42,-7300.85"/>
<text text-anchor="middle" x="8935.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="8935.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8935.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp4&#45;&gt;Expert51_s1_l10_tp4 -->
<g id="edge1460" class="edge">
<title>Gate_s1_l10_tp4&#45;&gt;Expert51_s1_l10_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8596.2,-7336.84C8655.42,-7326.1 8724.42,-7313.6 8784.67,-7302.68"/>
<polygon fill="black" stroke="black" points="8785.44,-7306.1 8794.65,-7300.87 8784.19,-7299.21 8785.44,-7306.1"/>
</g>
<!-- Expert52_s1_l10_tp5 -->
<g id="node891" class="node">
<title>Expert52_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="1591.42,-7300.85 1283.42,-7300.85 1283.42,-7247.85 1591.42,-7247.85 1591.42,-7300.85"/>
<text text-anchor="middle" x="1437.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="1437.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1437.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp5&#45;&gt;Expert52_s1_l10_tp5 -->
<g id="edge1461" class="edge">
<title>Gate_s1_l10_tp5&#45;&gt;Expert52_s1_l10_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1920.37,-7342.36C1828.87,-7331.23 1713.63,-7316.72 1601.94,-7301.05"/>
<polygon fill="black" stroke="black" points="1602.23,-7297.56 1591.84,-7299.63 1601.25,-7304.49 1602.23,-7297.56"/>
</g>
<!-- Expert53_s1_l10_tp5 -->
<g id="node892" class="node">
<title>Expert53_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="1917.42,-7300.85 1609.42,-7300.85 1609.42,-7247.85 1917.42,-7247.85 1917.42,-7300.85"/>
<text text-anchor="middle" x="1763.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1763.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1763.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp5&#45;&gt;Expert53_s1_l10_tp5 -->
<g id="edge1462" class="edge">
<title>Gate_s1_l10_tp5&#45;&gt;Expert53_s1_l10_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1993.81,-7336.84C1954.59,-7326.37 1909.04,-7314.21 1868.85,-7303.49"/>
<polygon fill="black" stroke="black" points="1869.59,-7300.06 1859.03,-7300.87 1867.79,-7306.83 1869.59,-7300.06"/>
</g>
<!-- Expert54_s1_l10_tp5 -->
<g id="node893" class="node">
<title>Expert54_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="2243.42,-7300.85 1935.42,-7300.85 1935.42,-7247.85 2243.42,-7247.85 2243.42,-7300.85"/>
<text text-anchor="middle" x="2089.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="2089.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2089.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp5&#45;&gt;Expert54_s1_l10_tp5 -->
<g id="edge1463" class="edge">
<title>Gate_s1_l10_tp5&#45;&gt;Expert54_s1_l10_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2089.42,-7336.72C2089.42,-7328.74 2089.42,-7319.79 2089.42,-7311.24"/>
<polygon fill="black" stroke="black" points="2092.92,-7311.1 2089.42,-7301.1 2085.92,-7311.1 2092.92,-7311.1"/>
</g>
<!-- Expert55_s1_l10_tp5 -->
<g id="node894" class="node">
<title>Expert55_s1_l10_tp5</title>
<polygon fill="none" stroke="black" points="2569.42,-7300.85 2261.42,-7300.85 2261.42,-7247.85 2569.42,-7247.85 2569.42,-7300.85"/>
<text text-anchor="middle" x="2415.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="2415.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2415.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp5&#45;&gt;Expert55_s1_l10_tp5 -->
<g id="edge1464" class="edge">
<title>Gate_s1_l10_tp5&#45;&gt;Expert55_s1_l10_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2185.03,-7336.84C2224.26,-7326.37 2269.8,-7314.21 2309.99,-7303.49"/>
<polygon fill="black" stroke="black" points="2311.06,-7306.83 2319.82,-7300.87 2309.25,-7300.06 2311.06,-7306.83"/>
</g>
<!-- Expert56_s1_l10_tp6 -->
<g id="node895" class="node">
<title>Expert56_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="10719.42,-7300.85 10411.42,-7300.85 10411.42,-7247.85 10719.42,-7247.85 10719.42,-7300.85"/>
<text text-anchor="middle" x="10565.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="10565.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10565.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp6&#45;&gt;Expert56_s1_l10_tp6 -->
<g id="edge1465" class="edge">
<title>Gate_s1_l10_tp6&#45;&gt;Expert56_s1_l10_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10795.81,-7336.84C10756.59,-7326.37 10711.04,-7314.21 10670.85,-7303.49"/>
<polygon fill="black" stroke="black" points="10671.59,-7300.06 10661.03,-7300.87 10669.79,-7306.83 10671.59,-7300.06"/>
</g>
<!-- Expert57_s1_l10_tp6 -->
<g id="node896" class="node">
<title>Expert57_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="11045.42,-7300.85 10737.42,-7300.85 10737.42,-7247.85 11045.42,-7247.85 11045.42,-7300.85"/>
<text text-anchor="middle" x="10891.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="10891.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10891.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp6&#45;&gt;Expert57_s1_l10_tp6 -->
<g id="edge1466" class="edge">
<title>Gate_s1_l10_tp6&#45;&gt;Expert57_s1_l10_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10891.42,-7336.72C10891.42,-7328.74 10891.42,-7319.79 10891.42,-7311.24"/>
<polygon fill="black" stroke="black" points="10894.92,-7311.1 10891.42,-7301.1 10887.92,-7311.1 10894.92,-7311.1"/>
</g>
<!-- Expert58_s1_l10_tp6 -->
<g id="node897" class="node">
<title>Expert58_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="11371.42,-7300.85 11063.42,-7300.85 11063.42,-7247.85 11371.42,-7247.85 11371.42,-7300.85"/>
<text text-anchor="middle" x="11217.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="11217.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11217.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp6&#45;&gt;Expert58_s1_l10_tp6 -->
<g id="edge1467" class="edge">
<title>Gate_s1_l10_tp6&#45;&gt;Expert58_s1_l10_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10987.03,-7336.84C11026.26,-7326.37 11071.8,-7314.21 11111.99,-7303.49"/>
<polygon fill="black" stroke="black" points="11113.06,-7306.83 11121.82,-7300.87 11111.25,-7300.06 11113.06,-7306.83"/>
</g>
<!-- Expert59_s1_l10_tp6 -->
<g id="node898" class="node">
<title>Expert59_s1_l10_tp6</title>
<polygon fill="none" stroke="black" points="11697.42,-7300.85 11389.42,-7300.85 11389.42,-7247.85 11697.42,-7247.85 11697.42,-7300.85"/>
<text text-anchor="middle" x="11543.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="11543.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11543.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp6&#45;&gt;Expert59_s1_l10_tp6 -->
<g id="edge1468" class="edge">
<title>Gate_s1_l10_tp6&#45;&gt;Expert59_s1_l10_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11060.47,-7342.36C11151.97,-7331.23 11267.22,-7316.72 11378.9,-7301.05"/>
<polygon fill="black" stroke="black" points="11379.59,-7304.49 11389.01,-7299.63 11378.62,-7297.56 11379.59,-7304.49"/>
</g>
<!-- Expert60_s1_l10_tp7 -->
<g id="node899" class="node">
<title>Expert60_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="9415.42,-7300.85 9107.42,-7300.85 9107.42,-7247.85 9415.42,-7247.85 9415.42,-7300.85"/>
<text text-anchor="middle" x="9261.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="9261.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9261.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp7&#45;&gt;Expert60_s1_l10_tp7 -->
<g id="edge1469" class="edge">
<title>Gate_s1_l10_tp7&#45;&gt;Expert60_s1_l10_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9491.81,-7336.84C9452.59,-7326.37 9407.04,-7314.21 9366.85,-7303.49"/>
<polygon fill="black" stroke="black" points="9367.59,-7300.06 9357.03,-7300.87 9365.79,-7306.83 9367.59,-7300.06"/>
</g>
<!-- Expert61_s1_l10_tp7 -->
<g id="node900" class="node">
<title>Expert61_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="9741.42,-7300.85 9433.42,-7300.85 9433.42,-7247.85 9741.42,-7247.85 9741.42,-7300.85"/>
<text text-anchor="middle" x="9587.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="9587.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9587.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp7&#45;&gt;Expert61_s1_l10_tp7 -->
<g id="edge1470" class="edge">
<title>Gate_s1_l10_tp7&#45;&gt;Expert61_s1_l10_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9587.42,-7336.72C9587.42,-7328.74 9587.42,-7319.79 9587.42,-7311.24"/>
<polygon fill="black" stroke="black" points="9590.92,-7311.1 9587.42,-7301.1 9583.92,-7311.1 9590.92,-7311.1"/>
</g>
<!-- Expert62_s1_l10_tp7 -->
<g id="node901" class="node">
<title>Expert62_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="10067.42,-7300.85 9759.42,-7300.85 9759.42,-7247.85 10067.42,-7247.85 10067.42,-7300.85"/>
<text text-anchor="middle" x="9913.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="9913.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9913.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp7&#45;&gt;Expert62_s1_l10_tp7 -->
<g id="edge1471" class="edge">
<title>Gate_s1_l10_tp7&#45;&gt;Expert62_s1_l10_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.03,-7336.84C9722.26,-7326.37 9767.8,-7314.21 9807.99,-7303.49"/>
<polygon fill="black" stroke="black" points="9809.06,-7306.83 9817.82,-7300.87 9807.25,-7300.06 9809.06,-7306.83"/>
</g>
<!-- Expert63_s1_l10_tp7 -->
<g id="node902" class="node">
<title>Expert63_s1_l10_tp7</title>
<polygon fill="none" stroke="black" points="10393.42,-7300.85 10085.42,-7300.85 10085.42,-7247.85 10393.42,-7247.85 10393.42,-7300.85"/>
<text text-anchor="middle" x="10239.42" y="-7285.65" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="10239.42" y="-7270.65" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10239.42" y="-7255.65" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l10_tp7&#45;&gt;Expert63_s1_l10_tp7 -->
<g id="edge1472" class="edge">
<title>Gate_s1_l10_tp7&#45;&gt;Expert63_s1_l10_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9756.47,-7342.36C9847.97,-7331.23 9963.22,-7316.72 10074.9,-7301.05"/>
<polygon fill="black" stroke="black" points="10075.59,-7304.49 10085.01,-7299.63 10074.62,-7297.56 10075.59,-7304.49"/>
</g>
<!-- AR_exp_s1_l10 -->
<g id="node903" class="node">
<title>AR_exp_s1_l10</title>
<ellipse fill="none" stroke="black" cx="6457.42" cy="-7174.38" rx="239" ry="37.45"/>
<text text-anchor="middle" x="6457.42" y="-7185.68" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="6457.42" y="-7170.68" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6457.42" y="-7155.68" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l10_tp0&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1473" class="edge">
<title>Expert32_s1_l10_tp0&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M6120.34,-7247.8C6178.08,-7235.4 6248.04,-7220.37 6309.22,-7207.22"/>
<polygon fill="black" stroke="black" points="6310.31,-7210.56 6319.35,-7205.04 6308.84,-7203.72 6310.31,-7210.56"/>
</g>
<!-- Expert33_s1_l10_tp0&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1474" class="edge">
<title>Expert33_s1_l10_tp0&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M6361.58,-7247.61C6373.79,-7238.41 6387.89,-7227.78 6401.46,-7217.56"/>
<polygon fill="black" stroke="black" points="6403.93,-7220.07 6409.81,-7211.26 6399.72,-7214.48 6403.93,-7220.07"/>
</g>
<!-- Expert34_s1_l10_tp0&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1475" class="edge">
<title>Expert34_s1_l10_tp0&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M5503.81,-7248.88C5506.71,-7248.53 5509.58,-7248.18 5512.42,-7247.85 5754.08,-7219.73 6031.82,-7199.91 6223.35,-7188.19"/>
<polygon fill="black" stroke="black" points="6223.78,-7191.67 6233.55,-7187.57 6223.36,-7184.69 6223.78,-7191.67"/>
</g>
<!-- Expert35_s1_l10_tp0&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1476" class="edge">
<title>Expert35_s1_l10_tp0&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M5829.83,-7249.04C5832.72,-7248.64 5835.58,-7248.24 5838.42,-7247.85 5976.32,-7229 6131.92,-7210.8 6252.62,-7197.35"/>
<polygon fill="black" stroke="black" points="6253.17,-7200.81 6262.72,-7196.22 6252.39,-7193.85 6253.17,-7200.81"/>
</g>
<!-- Expert36_s1_l10_tp1&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1477" class="edge">
<title>Expert36_s1_l10_tp1&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M3547.79,-7248.68C3550.69,-7248.39 3553.57,-7248.11 3556.42,-7247.85 4067.84,-7201.66 5604.22,-7183.08 6208.97,-7177.42"/>
<polygon fill="black" stroke="black" points="6209.16,-7180.92 6219.13,-7177.33 6209.09,-7173.92 6209.16,-7180.92"/>
</g>
<!-- Expert37_s1_l10_tp1&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1478" class="edge">
<title>Expert37_s1_l10_tp1&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M3873.79,-7248.69C3876.69,-7248.4 3879.57,-7248.12 3882.42,-7247.85 4328.79,-7206.82 5654.95,-7185.61 6209.41,-7178.34"/>
<polygon fill="black" stroke="black" points="6209.58,-7181.84 6219.54,-7178.2 6209.49,-7174.84 6209.58,-7181.84"/>
</g>
<!-- Expert38_s1_l10_tp1&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1479" class="edge">
<title>Expert38_s1_l10_tp1&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M2895.79,-7248.66C2898.69,-7248.37 2901.57,-7248.1 2904.42,-7247.85 3547.07,-7191.29 5510.83,-7178.77 6208.37,-7176.09"/>
<polygon fill="black" stroke="black" points="6208.55,-7179.59 6218.54,-7176.05 6208.53,-7172.59 6208.55,-7179.59"/>
</g>
<!-- Expert39_s1_l10_tp1&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1480" class="edge">
<title>Expert39_s1_l10_tp1&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M3221.79,-7248.67C3224.69,-7248.38 3227.57,-7248.11 3230.42,-7247.85 3807.2,-7196.49 5555.8,-7180.82 6208.34,-7176.69"/>
<polygon fill="black" stroke="black" points="6208.83,-7180.19 6218.81,-7176.63 6208.79,-7173.19 6208.83,-7180.19"/>
</g>
<!-- Expert40_s1_l10_tp2&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1481" class="edge">
<title>Expert40_s1_l10_tp2&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M5177.81,-7248.81C5180.7,-7248.47 5183.57,-7248.16 5186.42,-7247.85 5542.37,-7209.95 5956.66,-7191 6213,-7182.19"/>
<polygon fill="black" stroke="black" points="6213.31,-7185.68 6223.19,-7181.84 6213.08,-7178.68 6213.31,-7185.68"/>
</g>
<!-- Expert41_s1_l10_tp2&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1482" class="edge">
<title>Expert41_s1_l10_tp2&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M4199.8,-7248.71C4202.69,-7248.41 4205.57,-7248.12 4208.42,-7247.85 4590.24,-7211.97 5709.24,-7188.5 6210.1,-7179.5"/>
<polygon fill="black" stroke="black" points="6210.42,-7183 6220.35,-7179.32 6210.29,-7176 6210.42,-7183"/>
</g>
<!-- Expert42_s1_l10_tp2&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1483" class="edge">
<title>Expert42_s1_l10_tp2&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M4525.8,-7248.73C4528.69,-7248.42 4531.57,-7248.13 4534.42,-7247.85 5133.21,-7189.93 5841.03,-7177.64 6208.26,-7175.44"/>
<polygon fill="black" stroke="black" points="6208.51,-7178.93 6218.49,-7175.38 6208.47,-7171.93 6208.51,-7178.93"/>
</g>
<!-- Expert43_s1_l10_tp2&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1484" class="edge">
<title>Expert43_s1_l10_tp2&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M4851.8,-7248.76C4854.7,-7248.44 4857.57,-7248.14 4860.42,-7247.85 5336.1,-7200 5894.69,-7183.73 6209.24,-7178.21"/>
<polygon fill="black" stroke="black" points="6209.47,-7181.7 6219.4,-7178.03 6209.35,-7174.7 6209.47,-7181.7"/>
</g>
<!-- Expert44_s1_l10_tp3&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1485" class="edge">
<title>Expert44_s1_l10_tp3&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M6602.18,-7247.74C6582.04,-7237.67 6558.47,-7225.89 6536.26,-7214.78"/>
<polygon fill="black" stroke="black" points="6537.68,-7211.58 6527.17,-7210.24 6534.55,-7217.84 6537.68,-7211.58"/>
</g>
<!-- Expert45_s1_l10_tp3&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1486" class="edge">
<title>Expert45_s1_l10_tp3&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M6843.3,-7247.8C6774.2,-7234.83 6689.82,-7219 6617.61,-7205.44"/>
<polygon fill="black" stroke="black" points="6617.98,-7201.95 6607.51,-7203.55 6616.69,-7208.83 6617.98,-7201.95"/>
</g>
<!-- Expert46_s1_l10_tp3&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1487" class="edge">
<title>Expert46_s1_l10_tp3&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M7151.02,-7249C7148.13,-7248.61 7145.26,-7248.23 7142.42,-7247.85 6984.67,-7227.18 6805.87,-7208.42 6670.51,-7195.17"/>
<polygon fill="black" stroke="black" points="6670.72,-7191.67 6660.43,-7194.18 6670.04,-7198.64 6670.72,-7191.67"/>
</g>
<!-- Expert47_s1_l10_tp3&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1488" class="edge">
<title>Expert47_s1_l10_tp3&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M7477.03,-7248.86C7474.14,-7248.51 7471.27,-7248.18 7468.42,-7247.85 7204.15,-7217.76 6899.51,-7197.94 6694.29,-7186.75"/>
<polygon fill="black" stroke="black" points="6694.46,-7183.25 6684.29,-7186.21 6694.08,-7190.24 6694.46,-7183.25"/>
</g>
<!-- Expert48_s1_l10_tp4&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1489" class="edge">
<title>Expert48_s1_l10_tp4&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M7803.04,-7248.8C7800.15,-7248.47 7797.27,-7248.15 7794.42,-7247.85 7414.67,-7207.96 6971.79,-7189.42 6703.14,-7181.26"/>
<polygon fill="black" stroke="black" points="6702.97,-7177.75 6692.87,-7180.95 6702.76,-7184.75 6702.97,-7177.75"/>
</g>
<!-- Expert49_s1_l10_tp4&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1490" class="edge">
<title>Expert49_s1_l10_tp4&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M8129.04,-7248.75C8126.15,-7248.44 8123.27,-7248.14 8120.42,-7247.85 7620.03,-7197.97 7031.55,-7182.41 6705.92,-7177.57"/>
<polygon fill="black" stroke="black" points="6705.94,-7174.07 6695.89,-7177.42 6705.83,-7181.06 6705.94,-7174.07"/>
</g>
<!-- Expert50_s1_l10_tp4&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1491" class="edge">
<title>Expert50_s1_l10_tp4&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M8455.05,-7248.73C8452.15,-7248.42 8449.27,-7248.13 8446.42,-7247.85 7822.45,-7187.89 7084.02,-7176.52 6706.68,-7174.98"/>
<polygon fill="black" stroke="black" points="6706.47,-7171.48 6696.45,-7174.94 6706.44,-7178.48 6706.47,-7171.48"/>
</g>
<!-- Expert51_s1_l10_tp4&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1492" class="edge">
<title>Expert51_s1_l10_tp4&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M8781.05,-7248.71C8778.15,-7248.4 8775.27,-7248.12 8772.42,-7247.85 8377.56,-7210.93 7216.77,-7187.88 6704.82,-7179.24"/>
<polygon fill="black" stroke="black" points="6704.77,-7175.74 6694.71,-7179.07 6704.65,-7182.74 6704.77,-7175.74"/>
</g>
<!-- Expert52_s1_l10_tp5&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1493" class="edge">
<title>Expert52_s1_l10_tp5&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M1591.79,-7248.64C1594.69,-7248.36 1597.57,-7248.1 1600.42,-7247.85 2060.03,-7208.67 5281.69,-7183.52 6208.54,-7177.04"/>
<polygon fill="black" stroke="black" points="6208.69,-7180.54 6218.66,-7176.97 6208.64,-7173.54 6208.69,-7180.54"/>
</g>
<!-- Expert53_s1_l10_tp5&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1494" class="edge">
<title>Expert53_s1_l10_tp5&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M1917.79,-7248.65C1920.69,-7248.36 1923.57,-7248.1 1926.42,-7247.85 2768.13,-7175.64 5386.39,-7173.58 6208.1,-7174.79"/>
<polygon fill="black" stroke="black" points="6208.27,-7178.29 6218.28,-7174.81 6208.28,-7171.29 6208.27,-7178.29"/>
</g>
<!-- Expert54_s1_l10_tp5&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1495" class="edge">
<title>Expert54_s1_l10_tp5&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M2243.79,-7248.65C2246.69,-7248.37 2249.57,-7248.1 2252.42,-7247.85 3027.47,-7180.87 5425.74,-7175.18 6207.94,-7175.16"/>
<polygon fill="black" stroke="black" points="6208.2,-7178.66 6218.2,-7175.16 6208.2,-7171.66 6208.2,-7178.66"/>
</g>
<!-- Expert55_s1_l10_tp5&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1496" class="edge">
<title>Expert55_s1_l10_tp5&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M2569.79,-7248.66C2572.69,-7248.37 2575.57,-7248.1 2578.42,-7247.85 3287.13,-7186.09 5467.28,-7176.91 6208.08,-7175.58"/>
<polygon fill="black" stroke="black" points="6208.35,-7179.08 6218.34,-7175.57 6208.34,-7172.08 6208.35,-7179.08"/>
</g>
<!-- Expert56_s1_l10_tp6&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1497" class="edge">
<title>Expert56_s1_l10_tp6&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M10411.05,-7248.65C10408.16,-7248.37 10405.28,-7248.1 10402.42,-7247.85 9680.29,-7185.03 7456.02,-7176.55 6706.75,-7175.49"/>
<polygon fill="black" stroke="black" points="6706.65,-7171.99 6696.64,-7175.48 6706.64,-7178.99 6706.65,-7171.99"/>
</g>
<!-- Expert57_s1_l10_tp6&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1498" class="edge">
<title>Expert57_s1_l10_tp6&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M10737.05,-7248.65C10734.16,-7248.37 10731.28,-7248.1 10728.42,-7247.85 9939.85,-7179.81 7496.87,-7174.85 6706.72,-7175.08"/>
<polygon fill="black" stroke="black" points="6706.64,-7171.58 6696.64,-7175.08 6706.64,-7178.58 6706.64,-7171.58"/>
</g>
<!-- Expert58_s1_l10_tp6&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1499" class="edge">
<title>Expert58_s1_l10_tp6&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M11063.05,-7248.64C11060.16,-7248.36 11057.28,-7248.1 11054.42,-7247.85 10199.21,-7174.58 7536.35,-7173.27 6706.77,-7174.72"/>
<polygon fill="black" stroke="black" points="6706.49,-7171.22 6696.49,-7174.74 6706.5,-7178.22 6706.49,-7171.22"/>
</g>
<!-- Expert59_s1_l10_tp6&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1500" class="edge">
<title>Expert59_s1_l10_tp6&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M11389.06,-7248.64C11386.16,-7248.36 11383.28,-7248.1 11380.42,-7247.85 10913.97,-7208.13 7640.76,-7183.32 6706.09,-7176.99"/>
<polygon fill="black" stroke="black" points="6705.91,-7173.49 6695.88,-7176.92 6705.86,-7180.48 6705.91,-7173.49"/>
</g>
<!-- Expert60_s1_l10_tp7&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1501" class="edge">
<title>Expert60_s1_l10_tp7&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M9107.05,-7248.69C9104.15,-7248.39 9101.27,-7248.11 9098.42,-7247.85 8638.98,-7205.78 7270.75,-7185.08 6705.74,-7178.14"/>
<polygon fill="black" stroke="black" points="6705.47,-7174.63 6695.43,-7178.01 6705.38,-7181.63 6705.47,-7174.63"/>
</g>
<!-- Expert61_s1_l10_tp7&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1502" class="edge">
<title>Expert61_s1_l10_tp7&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M9433.05,-7248.68C9430.15,-7248.39 9427.28,-7248.11 9424.42,-7247.85 8899.85,-7200.62 7320.92,-7182.6 6706.18,-7177.26"/>
<polygon fill="black" stroke="black" points="6705.88,-7173.76 6695.85,-7177.17 6705.82,-7180.76 6705.88,-7173.76"/>
</g>
<!-- Expert62_s1_l10_tp7&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1503" class="edge">
<title>Expert62_s1_l10_tp7&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M9759.05,-7248.67C9756.15,-7248.38 9753.28,-7248.11 9750.42,-7247.85 9160.28,-7195.43 7368.01,-7180.39 6706.33,-7176.56"/>
<polygon fill="black" stroke="black" points="6706.21,-7173.06 6696.19,-7176.5 6706.17,-7180.06 6706.21,-7173.06"/>
</g>
<!-- Expert63_s1_l10_tp7&#45;&gt;AR_exp_s1_l10 -->
<g id="edge1504" class="edge">
<title>Expert63_s1_l10_tp7&#45;&gt;AR_exp_s1_l10</title>
<path fill="none" stroke="black" d="M10085.05,-7248.66C10082.15,-7248.37 10079.28,-7248.1 10076.42,-7247.85 9420.39,-7190.23 7412.77,-7178.38 6706.43,-7175.98"/>
<polygon fill="black" stroke="black" points="6706.39,-7172.48 6696.38,-7175.94 6706.37,-7179.48 6706.39,-7172.48"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp0 -->
<g id="edge1505" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp0</title>
<path fill="none" stroke="black" d="M6403.26,-7137.71C6388.49,-7127.98 6372.11,-7117.19 6355.99,-7106.57"/>
<polygon fill="black" stroke="black" points="6357.87,-7103.62 6347.59,-7101.04 6354.02,-7109.47 6357.87,-7103.62"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp1 -->
<g id="edge1507" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp1</title>
<path fill="none" stroke="black" d="M6228.41,-7163.47C5910.44,-7149.69 5317.2,-7123.81 4811.42,-7100.9 4538.53,-7088.54 4228.16,-7074.06 4003.96,-7063.52"/>
<polygon fill="black" stroke="black" points="4003.84,-7060.01 3993.69,-7063.04 4003.51,-7067 4003.84,-7060.01"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp2 -->
<g id="edge1509" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp2</title>
<path fill="none" stroke="black" d="M6256.68,-7153.96C6055.33,-7134.49 5741.71,-7104.15 5503.11,-7081.08"/>
<polygon fill="black" stroke="black" points="5503.17,-7077.57 5492.88,-7080.09 5502.49,-7084.53 5503.17,-7077.57"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp3 -->
<g id="edge1511" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp3</title>
<path fill="none" stroke="black" d="M6607.19,-7145.13C6689.57,-7129.59 6793.57,-7109.98 6886.15,-7092.52"/>
<polygon fill="black" stroke="black" points="6887.04,-7095.91 6896.22,-7090.62 6885.75,-7089.03 6887.04,-7095.91"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp4 -->
<g id="edge1513" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp4</title>
<path fill="none" stroke="black" d="M6685.04,-7162.87C7179.78,-7140.04 8351.28,-7085.97 8883.24,-7061.42"/>
<polygon fill="black" stroke="black" points="8883.53,-7064.91 8893.36,-7060.95 8883.21,-7057.91 8883.53,-7064.91"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp5 -->
<g id="edge1515" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp5</title>
<path fill="none" stroke="black" d="M6221.45,-7168.26C5700.61,-7156.9 4413.29,-7128.37 3335.42,-7100.9 2780.65,-7086.76 2133.54,-7068.39 1763.21,-7057.69"/>
<polygon fill="black" stroke="black" points="1763.25,-7054.19 1753.15,-7057.4 1763.05,-7061.19 1763.25,-7054.19"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp6 -->
<g id="edge1517" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp6</title>
<path fill="none" stroke="black" d="M6695.78,-7171.34C7493.16,-7164.23 10063.69,-7138.87 10891.42,-7100.9 11034.34,-7094.34 11193.64,-7082.61 11323.04,-7071.95"/>
<polygon fill="black" stroke="black" points="11323.41,-7075.43 11333.09,-7071.11 11322.84,-7068.45 11323.41,-7075.43"/>
</g>
<!-- AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp7 -->
<g id="edge1519" class="edge">
<title>AR_exp_s1_l10&#45;&gt;ResMOE_s1_l10_tp7</title>
<path fill="none" stroke="black" d="M6694.75,-7169.95C7208.71,-7162.05 8463.03,-7140.15 9513.42,-7100.9 9768.68,-7091.36 10059.69,-7076.07 10265.19,-7064.53"/>
<polygon fill="black" stroke="black" points="10265.43,-7068.02 10275.21,-7063.97 10265.03,-7061.04 10265.43,-7068.02"/>
</g>
<!-- QKV_s1_l11_tp0 -->
<g id="node912" class="node">
<title>QKV_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5479.42,-6958.9 5141.42,-6958.9 5141.42,-6905.9 5479.42,-6905.9 5479.42,-6958.9"/>
<text text-anchor="middle" x="5310.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5310.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5310.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp0 -->
<g id="edge1521" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M5935.11,-7007.75C5806.18,-6992.56 5657.42,-6974.98 5522.42,-6958.9 5511.78,-6957.63 5500.84,-6956.33 5489.81,-6955.01"/>
<polygon fill="black" stroke="black" points="5490,-6951.5 5479.65,-6953.79 5489.17,-6958.45 5490,-6951.5"/>
</g>
<!-- QKV_s1_l11_tp1 -->
<g id="node913" class="node">
<title>QKV_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="5869.42,-6958.9 5531.42,-6958.9 5531.42,-6905.9 5869.42,-6905.9 5869.42,-6958.9"/>
<text text-anchor="middle" x="5700.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5700.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5700.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp1 -->
<g id="edge1522" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M6008.11,-6994.88C5949.55,-6983.18 5889.64,-6971.21 5838.43,-6960.98"/>
<polygon fill="black" stroke="black" points="5838.8,-6957.48 5828.31,-6958.95 5837.43,-6964.35 5838.8,-6957.48"/>
</g>
<!-- QKV_s1_l11_tp2 -->
<g id="node914" class="node">
<title>QKV_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="6250.42,-6958.9 5912.42,-6958.9 5912.42,-6905.9 6250.42,-6905.9 6250.42,-6958.9"/>
<text text-anchor="middle" x="6081.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6081.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6081.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp2 -->
<g id="edge1523" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M6182.58,-6994.8C6165.41,-6984.38 6147.89,-6973.74 6132.35,-6964.31"/>
<polygon fill="black" stroke="black" points="6133.82,-6961.11 6123.46,-6958.91 6130.19,-6967.09 6133.82,-6961.11"/>
</g>
<!-- QKV_s1_l11_tp3 -->
<g id="node915" class="node">
<title>QKV_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6623.42,-6958.9 6285.42,-6958.9 6285.42,-6905.9 6623.42,-6905.9 6623.42,-6958.9"/>
<text text-anchor="middle" x="6454.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6454.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6454.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp3 -->
<g id="edge1524" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6353.8,-6994.8C6370.89,-6984.38 6388.31,-6973.74 6403.76,-6964.31"/>
<polygon fill="black" stroke="black" points="6405.9,-6967.11 6412.61,-6958.91 6402.25,-6961.13 6405.9,-6967.11"/>
</g>
<!-- QKV_s1_l11_tp4 -->
<g id="node916" class="node">
<title>QKV_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="7004.42,-6958.9 6666.42,-6958.9 6666.42,-6905.9 7004.42,-6905.9 7004.42,-6958.9"/>
<text text-anchor="middle" x="6835.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6835.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6835.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp4 -->
<g id="edge1525" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6486.83,-7003.18C6557.75,-6988.98 6634.42,-6973.64 6697.74,-6960.96"/>
<polygon fill="black" stroke="black" points="6698.67,-6964.34 6707.79,-6958.95 6697.3,-6957.48 6698.67,-6964.34"/>
</g>
<!-- QKV_s1_l11_tp5 -->
<g id="node917" class="node">
<title>QKV_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="7390.42,-6958.9 7052.42,-6958.9 7052.42,-6905.9 7390.42,-6905.9 7390.42,-6958.9"/>
<text text-anchor="middle" x="7221.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7221.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7221.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp5 -->
<g id="edge1526" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M6507.93,-7018.88C6654.01,-7001.72 6844.52,-6979.23 7013.42,-6958.9 7022.81,-6957.77 7032.43,-6956.61 7042.14,-6955.43"/>
<polygon fill="black" stroke="black" points="7042.78,-6958.88 7052.29,-6954.2 7041.94,-6951.93 7042.78,-6958.88"/>
</g>
<!-- QKV_s1_l11_tp6 -->
<g id="node918" class="node">
<title>QKV_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="7778.42,-6958.9 7440.42,-6958.9 7440.42,-6905.9 7778.42,-6905.9 7778.42,-6958.9"/>
<text text-anchor="middle" x="7609.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7609.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7609.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp6 -->
<g id="edge1527" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M6508.39,-7019.03C6587.89,-7010.44 6676.89,-7001.51 6758.42,-6994.9 7042.83,-6971.84 7115.2,-6984.11 7399.42,-6958.9 7409.47,-6958.01 7419.78,-6957.01 7430.18,-6955.95"/>
<polygon fill="black" stroke="black" points="7430.59,-6959.43 7440.18,-6954.91 7429.87,-6952.46 7430.59,-6959.43"/>
</g>
<!-- QKV_s1_l11_tp7 -->
<g id="node919" class="node">
<title>QKV_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="5097.42,-6958.9 4759.42,-6958.9 4759.42,-6905.9 5097.42,-6905.9 5097.42,-6958.9"/>
<text text-anchor="middle" x="4928.42" y="-6943.7" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4928.42" y="-6928.7" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4928.42" y="-6913.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp7 -->
<g id="edge1528" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;QKV_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M5961.31,-7027.04C5732.53,-7011.28 5412.63,-6987.25 5132.42,-6958.9 5124.34,-6958.08 5116.09,-6957.21 5107.76,-6956.3"/>
<polygon fill="black" stroke="black" points="5107.88,-6952.79 5097.56,-6955.16 5107.11,-6959.75 5107.88,-6952.79"/>
</g>
<!-- ResAttn_s1_l11_tp0 -->
<g id="node946" class="node">
<title>ResAttn_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5656.77,-6380.99 5099.45,-6380.99 4956.08,-6274.99 5513.4,-6274.99 5656.77,-6380.99"/>
<text text-anchor="middle" x="5306.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5306.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5306.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp0 -->
<g id="edge1570" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M5956.15,-7023.25C5824.48,-7013.72 5669.54,-7003.07 5529.42,-6994.9 5442.92,-6989.86 4823.66,-7005.2 4750.42,-6958.9 4701.68,-6928.09 4689.42,-6902.06 4689.42,-6844.4 4689.42,-6844.4 4689.42,-6844.4 4689.42,-6542.47 4689.42,-6466.22 4739.41,-6453.37 4806.42,-6416.99 4850.56,-6393.04 4954.48,-6372.97 5056.21,-6358.08"/>
<polygon fill="black" stroke="black" points="5056.97,-6361.51 5066.36,-6356.61 5055.96,-6354.58 5056.97,-6361.51"/>
</g>
<!-- ResAttn_s1_l11_tp1 -->
<g id="node947" class="node">
<title>ResAttn_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3797.77,-6380.99 3240.45,-6380.99 3097.08,-6274.99 3654.4,-6274.99 3797.77,-6380.99"/>
<text text-anchor="middle" x="3447.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3447.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3447.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp1 -->
<g id="edge1572" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M5954.4,-7021.96C5823.13,-7012.27 5668.96,-7001.86 5529.42,-6994.9 4985.42,-6967.78 4846.25,-7014.58 4304.42,-6958.9 4159.39,-6944 3658.42,-6990.19 3658.42,-6844.4 3658.42,-6844.4 3658.42,-6844.4 3658.42,-6542.47 3658.42,-6476.44 3606.72,-6423.47 3554.5,-6386.81"/>
<polygon fill="black" stroke="black" points="3556.35,-6383.84 3546.13,-6381.07 3552.4,-6389.61 3556.35,-6383.84"/>
</g>
<!-- ResAttn_s1_l11_tp2 -->
<g id="node948" class="node">
<title>ResAttn_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="4645.77,-6380.99 4088.45,-6380.99 3945.08,-6274.99 4502.4,-6274.99 4645.77,-6380.99"/>
<text text-anchor="middle" x="4295.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4295.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4295.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp2 -->
<g id="edge1574" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M5955.71,-7023.01C5824.14,-7013.45 5669.39,-7002.85 5529.42,-6994.9 5159.45,-6973.89 5062.22,-7018.18 4696.42,-6958.9 4513.46,-6929.25 4295.42,-7029.75 4295.42,-6844.4 4295.42,-6844.4 4295.42,-6844.4 4295.42,-6542.47 4295.42,-6491.63 4295.42,-6433.97 4295.42,-6391.4"/>
<polygon fill="black" stroke="black" points="4298.92,-6391.19 4295.42,-6381.19 4291.92,-6391.19 4298.92,-6391.19"/>
</g>
<!-- ResAttn_s1_l11_tp3 -->
<g id="node949" class="node">
<title>ResAttn_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="7677.77,-6380.99 7120.45,-6380.99 6977.08,-6274.99 7534.4,-6274.99 7677.77,-6380.99"/>
<text text-anchor="middle" x="7327.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7327.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7327.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp3 -->
<g id="edge1576" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6507.07,-7018.15C6586.88,-7009.45 6676.39,-7000.68 6758.42,-6994.9 6815.48,-6990.88 7739.01,-6989.36 7787.42,-6958.9 7836.05,-6928.31 7847.42,-6901.85 7847.42,-6844.4 7847.42,-6844.4 7847.42,-6844.4 7847.42,-6542.47 7847.42,-6477.13 7705.14,-6421.73 7569.42,-6383.76"/>
<polygon fill="black" stroke="black" points="7570.24,-6380.35 7559.67,-6381.05 7568.37,-6387.1 7570.24,-6380.35"/>
</g>
<!-- ResAttn_s1_l11_tp4 -->
<g id="node950" class="node">
<title>ResAttn_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="8591.77,-6380.99 8034.45,-6380.99 7891.08,-6274.99 8448.4,-6274.99 8591.77,-6380.99"/>
<text text-anchor="middle" x="8241.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8241.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8241.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp4 -->
<g id="edge1578" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6507.07,-7018.09C6586.88,-7009.39 6676.39,-7000.63 6758.42,-6994.9 6923.64,-6983.36 8241.42,-7010.02 8241.42,-6844.4 8241.42,-6844.4 8241.42,-6844.4 8241.42,-6542.47 8241.42,-6491.63 8241.42,-6433.97 8241.42,-6391.4"/>
<polygon fill="black" stroke="black" points="8244.92,-6391.19 8241.42,-6381.19 8237.92,-6391.19 8244.92,-6391.19"/>
</g>
<!-- ResAttn_s1_l11_tp5 -->
<g id="node951" class="node">
<title>ResAttn_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="2656.77,-6380.99 2099.45,-6380.99 1956.08,-6274.99 2513.4,-6274.99 2656.77,-6380.99"/>
<text text-anchor="middle" x="2306.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2306.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2306.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp5 -->
<g id="edge1580" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M5953.52,-7021.22C5822.46,-7011.44 5668.67,-7001.16 5529.42,-6994.9 5122.87,-6976.61 4103.06,-7002.41 3698.42,-6958.9 3436.74,-6930.76 3117.42,-7107.59 3117.42,-6844.4 3117.42,-6844.4 3117.42,-6844.4 3117.42,-6542.47 3117.42,-6436.67 2856.02,-6382.19 2630.03,-6354.87"/>
<polygon fill="black" stroke="black" points="2630.32,-6351.38 2619.98,-6353.66 2629.49,-6358.33 2630.32,-6351.38"/>
</g>
<!-- ResAttn_s1_l11_tp6 -->
<g id="node952" class="node">
<title>ResAttn_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="10734.77,-6380.99 10177.45,-6380.99 10034.08,-6274.99 10591.4,-6274.99 10734.77,-6380.99"/>
<text text-anchor="middle" x="10384.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10384.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10384.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp6 -->
<g id="edge1582" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M6506.4,-7017.56C6586.37,-7008.79 6676.14,-7000.13 6758.42,-6994.9 6906.19,-6985.5 9419.42,-6992.47 9419.42,-6844.4 9419.42,-6844.4 9419.42,-6844.4 9419.42,-6542.47 9419.42,-6400.66 9821.71,-6352.98 10106.81,-6336.99"/>
<polygon fill="black" stroke="black" points="10107.11,-6340.48 10116.9,-6336.44 10106.72,-6333.49 10107.11,-6340.48"/>
</g>
<!-- ResAttn_s1_l11_tp7 -->
<g id="node953" class="node">
<title>ResAttn_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="9585.77,-6380.99 9028.45,-6380.99 8885.08,-6274.99 9442.4,-6274.99 9585.77,-6380.99"/>
<text text-anchor="middle" x="9235.42" y="-6339.29" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9235.42" y="-6324.29" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9235.42" y="-6309.29" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp7 -->
<g id="edge1584" class="edge">
<title>ResMOE_s1_l10_tp0&#45;&gt;ResAttn_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M6506.74,-7017.87C6586.62,-7009.13 6676.27,-7000.41 6758.42,-6994.9 7322.27,-6957.05 7466.17,-7004.73 8029.42,-6958.9 8219.17,-6943.46 8878.42,-7034.77 8878.42,-6844.4 8878.42,-6844.4 8878.42,-6844.4 8878.42,-6542.47 8878.42,-6464.56 8941.83,-6414.4 9015.19,-6382.44"/>
<polygon fill="black" stroke="black" points="9016.81,-6385.56 9024.66,-6378.44 9014.08,-6379.11 9016.81,-6385.56"/>
</g>
<!-- SplitHeads_s1_l11_tp0 -->
<g id="node920" class="node">
<title>SplitHeads_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5479.42,-6869.9 5107.42,-6869.9 5107.42,-6816.9 5479.42,-6816.9 5479.42,-6869.9"/>
<text text-anchor="middle" x="5293.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5293.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5293.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp0&#45;&gt;SplitHeads_s1_l11_tp0 -->
<g id="edge1529" class="edge">
<title>QKV_s1_l11_tp0&#45;&gt;SplitHeads_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M5305.41,-6905.77C5303.84,-6897.7 5302.07,-6888.64 5300.38,-6880"/>
<polygon fill="black" stroke="black" points="5303.81,-6879.29 5298.45,-6870.15 5296.94,-6880.64 5303.81,-6879.29"/>
</g>
<!-- SplitHeads_s1_l11_tp1 -->
<g id="node921" class="node">
<title>SplitHeads_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="5869.42,-6869.9 5497.42,-6869.9 5497.42,-6816.9 5869.42,-6816.9 5869.42,-6869.9"/>
<text text-anchor="middle" x="5683.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5683.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5683.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp1&#45;&gt;SplitHeads_s1_l11_tp1 -->
<g id="edge1530" class="edge">
<title>QKV_s1_l11_tp1&#45;&gt;SplitHeads_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M5695.41,-6905.77C5693.84,-6897.7 5692.07,-6888.64 5690.38,-6880"/>
<polygon fill="black" stroke="black" points="5693.81,-6879.29 5688.45,-6870.15 5686.94,-6880.64 5693.81,-6879.29"/>
</g>
<!-- SplitHeads_s1_l11_tp2 -->
<g id="node922" class="node">
<title>SplitHeads_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="6259.42,-6869.9 5887.42,-6869.9 5887.42,-6816.9 6259.42,-6816.9 6259.42,-6869.9"/>
<text text-anchor="middle" x="6073.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6073.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6073.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp2&#45;&gt;SplitHeads_s1_l11_tp2 -->
<g id="edge1531" class="edge">
<title>QKV_s1_l11_tp2&#45;&gt;SplitHeads_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M6079.07,-6905.77C6078.33,-6897.79 6077.51,-6888.83 6076.72,-6880.28"/>
<polygon fill="black" stroke="black" points="6080.19,-6879.79 6075.79,-6870.15 6073.22,-6880.43 6080.19,-6879.79"/>
</g>
<!-- SplitHeads_s1_l11_tp3 -->
<g id="node923" class="node">
<title>SplitHeads_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6649.42,-6869.9 6277.42,-6869.9 6277.42,-6816.9 6649.42,-6816.9 6649.42,-6869.9"/>
<text text-anchor="middle" x="6463.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6463.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6463.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp3&#45;&gt;SplitHeads_s1_l11_tp3 -->
<g id="edge1532" class="edge">
<title>QKV_s1_l11_tp3&#45;&gt;SplitHeads_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6457.07,-6905.77C6457.9,-6897.79 6458.83,-6888.83 6459.71,-6880.28"/>
<polygon fill="black" stroke="black" points="6463.21,-6880.46 6460.76,-6870.15 6456.25,-6879.74 6463.21,-6880.46"/>
</g>
<!-- SplitHeads_s1_l11_tp4 -->
<g id="node924" class="node">
<title>SplitHeads_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="7039.42,-6869.9 6667.42,-6869.9 6667.42,-6816.9 7039.42,-6816.9 7039.42,-6869.9"/>
<text text-anchor="middle" x="6853.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6853.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6853.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp4&#45;&gt;SplitHeads_s1_l11_tp4 -->
<g id="edge1533" class="edge">
<title>QKV_s1_l11_tp4&#45;&gt;SplitHeads_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6840.73,-6905.77C6842.4,-6897.7 6844.27,-6888.64 6846.06,-6880"/>
<polygon fill="black" stroke="black" points="6849.5,-6880.65 6848.1,-6870.15 6842.64,-6879.23 6849.5,-6880.65"/>
</g>
<!-- SplitHeads_s1_l11_tp5 -->
<g id="node925" class="node">
<title>SplitHeads_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="7429.42,-6869.9 7057.42,-6869.9 7057.42,-6816.9 7429.42,-6816.9 7429.42,-6869.9"/>
<text text-anchor="middle" x="7243.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7243.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7243.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp5&#45;&gt;SplitHeads_s1_l11_tp5 -->
<g id="edge1534" class="edge">
<title>QKV_s1_l11_tp5&#45;&gt;SplitHeads_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M7227.9,-6905.77C7229.94,-6897.7 7232.24,-6888.64 7234.42,-6880"/>
<polygon fill="black" stroke="black" points="7237.85,-6880.7 7236.91,-6870.15 7231.07,-6878.99 7237.85,-6880.7"/>
</g>
<!-- SplitHeads_s1_l11_tp6 -->
<g id="node926" class="node">
<title>SplitHeads_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="7819.42,-6869.9 7447.42,-6869.9 7447.42,-6816.9 7819.42,-6816.9 7819.42,-6869.9"/>
<text text-anchor="middle" x="7633.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7633.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7633.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp6&#45;&gt;SplitHeads_s1_l11_tp6 -->
<g id="edge1535" class="edge">
<title>QKV_s1_l11_tp6&#45;&gt;SplitHeads_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M7616.49,-6905.77C7618.72,-6897.7 7621.22,-6888.64 7623.6,-6880"/>
<polygon fill="black" stroke="black" points="7627.03,-6880.72 7626.32,-6870.15 7620.29,-6878.86 7627.03,-6880.72"/>
</g>
<!-- SplitHeads_s1_l11_tp7 -->
<g id="node927" class="node">
<title>SplitHeads_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="5089.42,-6869.9 4717.42,-6869.9 4717.42,-6816.9 5089.42,-6816.9 5089.42,-6869.9"/>
<text text-anchor="middle" x="4903.42" y="-6854.7" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4903.42" y="-6839.7" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4903.42" y="-6824.7" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l11_tp7&#45;&gt;SplitHeads_s1_l11_tp7 -->
<g id="edge1536" class="edge">
<title>QKV_s1_l11_tp7&#45;&gt;SplitHeads_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M4921.06,-6905.77C4918.74,-6897.7 4916.13,-6888.64 4913.65,-6880"/>
<polygon fill="black" stroke="black" points="4916.95,-6878.79 4910.82,-6870.15 4910.22,-6880.73 4916.95,-6878.79"/>
</g>
<!-- A2A_s1_l11 -->
<g id="node928" class="node">
<title>A2A_s1_l11</title>
<ellipse fill="none" stroke="black" cx="6268.42" cy="-6743.42" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6268.42" y="-6754.72" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="6268.42" y="-6739.72" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6268.42" y="-6724.72" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l11_tp0&#45;&gt;A2A_s1_l11 -->
<g id="edge1537" class="edge">
<title>SplitHeads_s1_l11_tp0&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M5479.45,-6817.92C5482.46,-6817.57 5485.45,-6817.23 5488.42,-6816.9 5671.43,-6796.44 5879.05,-6777.35 6034.05,-6763.9"/>
<polygon fill="black" stroke="black" points="6034.53,-6767.37 6044.19,-6763.02 6033.92,-6760.4 6034.53,-6767.37"/>
</g>
<!-- SplitHeads_s1_l11_tp1&#45;&gt;A2A_s1_l11 -->
<g id="edge1538" class="edge">
<title>SplitHeads_s1_l11_tp1&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M5835.98,-6816.85C5914.22,-6803.75 6009.93,-6787.72 6091.41,-6774.07"/>
<polygon fill="black" stroke="black" points="6091.99,-6777.52 6101.27,-6772.42 6090.83,-6770.62 6091.99,-6777.52"/>
</g>
<!-- SplitHeads_s1_l11_tp2&#45;&gt;A2A_s1_l11 -->
<g id="edge1539" class="edge">
<title>SplitHeads_s1_l11_tp2&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M6124.4,-6816.79C6144.24,-6806.82 6167.43,-6795.17 6189.33,-6784.16"/>
<polygon fill="black" stroke="black" points="6190.94,-6787.27 6198.3,-6779.65 6187.8,-6781.02 6190.94,-6787.27"/>
</g>
<!-- SplitHeads_s1_l11_tp3&#45;&gt;A2A_s1_l11 -->
<g id="edge1540" class="edge">
<title>SplitHeads_s1_l11_tp3&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M6412.44,-6816.79C6392.61,-6806.82 6369.42,-6795.17 6347.51,-6784.16"/>
<polygon fill="black" stroke="black" points="6349.05,-6781.02 6338.54,-6779.65 6345.91,-6787.27 6349.05,-6781.02"/>
</g>
<!-- SplitHeads_s1_l11_tp4&#45;&gt;A2A_s1_l11 -->
<g id="edge1541" class="edge">
<title>SplitHeads_s1_l11_tp4&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M6700.87,-6816.85C6622.63,-6803.75 6526.91,-6787.72 6445.44,-6774.07"/>
<polygon fill="black" stroke="black" points="6446.02,-6770.62 6435.58,-6772.42 6444.86,-6777.52 6446.02,-6770.62"/>
</g>
<!-- SplitHeads_s1_l11_tp5&#45;&gt;A2A_s1_l11 -->
<g id="edge1542" class="edge">
<title>SplitHeads_s1_l11_tp5&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M7057.4,-6817.92C7054.39,-6817.57 7051.39,-6817.23 7048.42,-6816.9 6865.42,-6796.44 6657.79,-6777.35 6502.79,-6763.9"/>
<polygon fill="black" stroke="black" points="6502.92,-6760.4 6492.66,-6763.02 6502.32,-6767.37 6502.92,-6760.4"/>
</g>
<!-- SplitHeads_s1_l11_tp6&#45;&gt;A2A_s1_l11 -->
<g id="edge1543" class="edge">
<title>SplitHeads_s1_l11_tp6&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M7447.41,-6817.79C7444.39,-6817.48 7441.4,-6817.19 7438.42,-6816.9 7126.38,-6786.87 6766.25,-6766.74 6528.88,-6755.46"/>
<polygon fill="black" stroke="black" points="6528.88,-6751.96 6518.73,-6754.98 6528.55,-6758.95 6528.88,-6751.96"/>
</g>
<!-- SplitHeads_s1_l11_tp7&#45;&gt;A2A_s1_l11 -->
<g id="edge1544" class="edge">
<title>SplitHeads_s1_l11_tp7&#45;&gt;A2A_s1_l11</title>
<path fill="none" stroke="black" d="M5089.43,-6817.79C5092.45,-6817.48 5095.45,-6817.19 5098.42,-6816.9 5410.47,-6786.87 5770.6,-6766.74 6007.96,-6755.46"/>
<polygon fill="black" stroke="black" points="6008.29,-6758.95 6018.12,-6754.98 6007.96,-6751.96 6008.29,-6758.95"/>
</g>
<!-- Attn_s1_l11_tp0 -->
<g id="node929" class="node">
<title>Attn_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5479.42,-6669.95 5107.42,-6669.95 5107.42,-6616.95 5479.42,-6616.95 5479.42,-6669.95"/>
<text text-anchor="middle" x="5293.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5293.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5293.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp0 -->
<g id="edge1545" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M6044.19,-6723.82C5890.85,-6710.57 5682.7,-6691.52 5489.51,-6670.05"/>
<polygon fill="black" stroke="black" points="5489.77,-6666.56 5479.45,-6668.93 5489,-6673.52 5489.77,-6666.56"/>
</g>
<!-- Attn_s1_l11_tp1 -->
<g id="node930" class="node">
<title>Attn_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="5869.42,-6669.95 5497.42,-6669.95 5497.42,-6616.95 5869.42,-6616.95 5869.42,-6669.95"/>
<text text-anchor="middle" x="5683.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5683.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5683.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp1 -->
<g id="edge1546" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M6101.18,-6714.41C6021.03,-6700.99 5925.42,-6684.98 5845.9,-6671.66"/>
<polygon fill="black" stroke="black" points="5846.23,-6668.16 5835.79,-6669.96 5845.07,-6675.07 5846.23,-6668.16"/>
</g>
<!-- Attn_s1_l11_tp2 -->
<g id="node931" class="node">
<title>Attn_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="6259.42,-6669.95 5887.42,-6669.95 5887.42,-6616.95 6259.42,-6616.95 6259.42,-6669.95"/>
<text text-anchor="middle" x="6073.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6073.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6073.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp2 -->
<g id="edge1547" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M6198.3,-6707.19C6176.99,-6696.48 6153.79,-6684.83 6133.23,-6674.5"/>
<polygon fill="black" stroke="black" points="6134.8,-6671.37 6124.29,-6670 6131.65,-6677.62 6134.8,-6671.37"/>
</g>
<!-- Attn_s1_l11_tp3 -->
<g id="node932" class="node">
<title>Attn_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6649.42,-6669.95 6277.42,-6669.95 6277.42,-6616.95 6649.42,-6616.95 6649.42,-6669.95"/>
<text text-anchor="middle" x="6463.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6463.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6463.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp3 -->
<g id="edge1548" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6338.55,-6707.19C6359.85,-6696.48 6383.06,-6684.83 6403.62,-6674.5"/>
<polygon fill="black" stroke="black" points="6405.19,-6677.62 6412.55,-6670 6402.05,-6671.37 6405.19,-6677.62"/>
</g>
<!-- Attn_s1_l11_tp4 -->
<g id="node933" class="node">
<title>Attn_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="7039.42,-6669.95 6667.42,-6669.95 6667.42,-6616.95 7039.42,-6616.95 7039.42,-6669.95"/>
<text text-anchor="middle" x="6853.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6853.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6853.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp4 -->
<g id="edge1549" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6435.67,-6714.41C6515.81,-6700.99 6611.43,-6684.98 6690.95,-6671.66"/>
<polygon fill="black" stroke="black" points="6691.77,-6675.07 6701.06,-6669.96 6690.62,-6668.16 6691.77,-6675.07"/>
</g>
<!-- Attn_s1_l11_tp5 -->
<g id="node934" class="node">
<title>Attn_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="7429.42,-6669.95 7057.42,-6669.95 7057.42,-6616.95 7429.42,-6616.95 7429.42,-6669.95"/>
<text text-anchor="middle" x="7243.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7243.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7243.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp5 -->
<g id="edge1550" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M6492.66,-6723.82C6646,-6710.57 6854.14,-6691.52 7047.34,-6670.05"/>
<polygon fill="black" stroke="black" points="7047.85,-6673.52 7057.4,-6668.93 7047.07,-6666.56 7047.85,-6673.52"/>
</g>
<!-- Attn_s1_l11_tp6 -->
<g id="node935" class="node">
<title>Attn_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="7819.42,-6669.95 7447.42,-6669.95 7447.42,-6616.95 7819.42,-6616.95 7819.42,-6669.95"/>
<text text-anchor="middle" x="7633.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7633.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7633.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp6 -->
<g id="edge1551" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M6518.73,-6731.86C6753.46,-6720.8 7114.4,-6700.83 7437.39,-6670.02"/>
<polygon fill="black" stroke="black" points="7437.79,-6673.5 7447.41,-6669.06 7437.12,-6666.53 7437.79,-6673.5"/>
</g>
<!-- Attn_s1_l11_tp7 -->
<g id="node936" class="node">
<title>Attn_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="5089.42,-6669.95 4717.42,-6669.95 4717.42,-6616.95 5089.42,-6616.95 5089.42,-6669.95"/>
<text text-anchor="middle" x="4903.42" y="-6654.75" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4903.42" y="-6639.75" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4903.42" y="-6624.75" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l11&#45;&gt;Attn_s1_l11_tp7 -->
<g id="edge1552" class="edge">
<title>A2A_s1_l11&#45;&gt;Attn_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M6018.12,-6731.86C5783.38,-6720.8 5422.44,-6700.83 5099.46,-6670.02"/>
<polygon fill="black" stroke="black" points="5099.72,-6666.53 5089.43,-6669.06 5099.05,-6673.5 5099.72,-6666.53"/>
</g>
<!-- AR_attn_s1_l11 -->
<g id="node937" class="node">
<title>AR_attn_s1_l11</title>
<ellipse fill="none" stroke="black" cx="6226.42" cy="-6543.47" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6226.42" y="-6554.77" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="6226.42" y="-6539.77" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6226.42" y="-6524.77" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l11_tp0&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1553" class="edge">
<title>Attn_s1_l11_tp0&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M5479.45,-6617.98C5482.46,-6617.63 5485.45,-6617.29 5488.42,-6616.95 5658.62,-6597.47 5851.28,-6578.65 5997.07,-6565.08"/>
<polygon fill="black" stroke="black" points="5997.41,-6568.56 6007.04,-6564.15 5996.76,-6561.59 5997.41,-6568.56"/>
</g>
<!-- Attn_s1_l11_tp1&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1554" class="edge">
<title>Attn_s1_l11_tp1&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M5825.03,-6616.9C5895.85,-6604.12 5982.1,-6588.55 6056.47,-6575.14"/>
<polygon fill="black" stroke="black" points="6057.2,-6578.56 6066.41,-6573.34 6055.95,-6571.67 6057.2,-6578.56"/>
</g>
<!-- Attn_s1_l11_tp2&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1555" class="edge">
<title>Attn_s1_l11_tp2&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M6113.62,-6616.7C6128.47,-6607.19 6145.7,-6596.16 6162.16,-6585.62"/>
<polygon fill="black" stroke="black" points="6164.14,-6588.51 6170.68,-6580.17 6160.37,-6582.61 6164.14,-6588.51"/>
</g>
<!-- Attn_s1_l11_tp3&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1556" class="edge">
<title>Attn_s1_l11_tp3&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M6401.46,-6616.83C6376.56,-6606.54 6347.3,-6594.44 6319.91,-6583.12"/>
<polygon fill="black" stroke="black" points="6320.89,-6579.74 6310.31,-6579.15 6318.22,-6586.2 6320.89,-6579.74"/>
</g>
<!-- Attn_s1_l11_tp4&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1557" class="edge">
<title>Attn_s1_l11_tp4&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M6689.91,-6616.9C6604.14,-6603.49 6498.77,-6587.03 6410.18,-6573.18"/>
<polygon fill="black" stroke="black" points="6410.71,-6569.73 6400.29,-6571.64 6409.63,-6576.64 6410.71,-6569.73"/>
</g>
<!-- Attn_s1_l11_tp5&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1558" class="edge">
<title>Attn_s1_l11_tp5&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M7057.4,-6617.94C7054.39,-6617.6 7051.39,-6617.27 7048.42,-6616.95 6852.44,-6595.5 6629.62,-6576.17 6465.45,-6562.87"/>
<polygon fill="black" stroke="black" points="6465.47,-6559.36 6455.22,-6562.05 6464.91,-6566.34 6465.47,-6559.36"/>
</g>
<!-- Attn_s1_l11_tp6&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1559" class="edge">
<title>Attn_s1_l11_tp6&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M7447.41,-6617.83C7444.4,-6617.52 7441.4,-6617.23 7438.42,-6616.95 7111.79,-6585.86 6734.29,-6565.78 6488.53,-6554.82"/>
<polygon fill="black" stroke="black" points="6488.53,-6551.32 6478.39,-6554.37 6488.22,-6558.31 6488.53,-6551.32"/>
</g>
<!-- Attn_s1_l11_tp7&#45;&gt;AR_attn_s1_l11 -->
<g id="edge1560" class="edge">
<title>Attn_s1_l11_tp7&#45;&gt;AR_attn_s1_l11</title>
<path fill="none" stroke="black" d="M5089.43,-6617.84C5092.45,-6617.54 5095.45,-6617.24 5098.42,-6616.95 5395.88,-6587.97 5738.64,-6567.82 5967.52,-6556.25"/>
<polygon fill="black" stroke="black" points="5967.84,-6559.74 5977.66,-6555.74 5967.49,-6552.75 5967.84,-6559.74"/>
</g>
<!-- O_s1_l11_tp0 -->
<g id="node938" class="node">
<title>O_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5687.42,-6469.99 5349.42,-6469.99 5349.42,-6416.99 5687.42,-6416.99 5687.42,-6469.99"/>
<text text-anchor="middle" x="5518.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5518.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5518.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp0 -->
<g id="edge1561" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M6040.87,-6516.79C5934.89,-6502.13 5802.66,-6483.83 5697.74,-6469.31"/>
<polygon fill="black" stroke="black" points="5698.06,-6465.82 5687.67,-6467.91 5697.1,-6472.75 5698.06,-6465.82"/>
</g>
<!-- O_s1_l11_tp1 -->
<g id="node939" class="node">
<title>O_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="4661.42,-6469.99 4323.42,-6469.99 4323.42,-6416.99 4661.42,-6416.99 4661.42,-6469.99"/>
<text text-anchor="middle" x="4492.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4492.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4492.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp1 -->
<g id="edge1562" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M5975.87,-6531.96C5692.06,-6519.52 5215.76,-6497.05 4806.42,-6469.99 4762.75,-6467.11 4715.71,-6463.53 4671.66,-6459.98"/>
<polygon fill="black" stroke="black" points="4671.67,-6456.47 4661.42,-6459.16 4671.11,-6463.45 4671.67,-6456.47"/>
</g>
<!-- O_s1_l11_tp2 -->
<g id="node940" class="node">
<title>O_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="5153.42,-6469.99 4815.42,-6469.99 4815.42,-6416.99 5153.42,-6416.99 5153.42,-6469.99"/>
<text text-anchor="middle" x="4984.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4984.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4984.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp2 -->
<g id="edge1563" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M5998.98,-6524.53C5758.5,-6505.56 5384.09,-6476.02 5163.66,-6458.63"/>
<polygon fill="black" stroke="black" points="5163.85,-6455.14 5153.61,-6457.84 5163.3,-6462.12 5163.85,-6455.14"/>
</g>
<!-- O_s1_l11_tp3 -->
<g id="node941" class="node">
<title>O_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6548.42,-6469.99 6210.42,-6469.99 6210.42,-6416.99 6548.42,-6416.99 6548.42,-6469.99"/>
<text text-anchor="middle" x="6379.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6379.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6379.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp3 -->
<g id="edge1564" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6282.09,-6506.82C6298.1,-6496.57 6315.42,-6485.48 6330.95,-6475.53"/>
<polygon fill="black" stroke="black" points="6332.84,-6478.48 6339.38,-6470.14 6329.07,-6472.58 6332.84,-6478.48"/>
</g>
<!-- O_s1_l11_tp4 -->
<g id="node942" class="node">
<title>O_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="7514.42,-6469.99 7176.42,-6469.99 7176.42,-6416.99 7514.42,-6416.99 7514.42,-6469.99"/>
<text text-anchor="middle" x="7345.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7345.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7345.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp4 -->
<g id="edge1565" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6447.5,-6523.11C6658.01,-6504.68 6970.9,-6477.29 7166.28,-6460.18"/>
<polygon fill="black" stroke="black" points="7166.7,-6463.65 7176.36,-6459.3 7166.09,-6456.68 7166.7,-6463.65"/>
</g>
<!-- O_s1_l11_tp5 -->
<g id="node943" class="node">
<title>O_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="4186.42,-6469.99 3848.42,-6469.99 3848.42,-6416.99 4186.42,-6416.99 4186.42,-6469.99"/>
<text text-anchor="middle" x="4017.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4017.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4017.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp5 -->
<g id="edge1566" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M5967.61,-6536.58C5599.89,-6527.32 4905.2,-6506.53 4314.42,-6469.99 4276.37,-6467.64 4235.63,-6464.53 4196.89,-6461.29"/>
<polygon fill="black" stroke="black" points="4196.81,-6457.77 4186.55,-6460.42 4196.22,-6464.75 4196.81,-6457.77"/>
</g>
<!-- O_s1_l11_tp6 -->
<g id="node944" class="node">
<title>O_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="8769.42,-6469.99 8431.42,-6469.99 8431.42,-6416.99 8769.42,-6416.99 8769.42,-6469.99"/>
<text text-anchor="middle" x="8600.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8600.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8600.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp6 -->
<g id="edge1567" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M6483.73,-6535.68C6864,-6525.07 7598.45,-6502.36 8222.42,-6469.99 8287.27,-6466.63 8358.31,-6462.07 8421.13,-6457.73"/>
<polygon fill="black" stroke="black" points="8421.4,-6461.22 8431.14,-6457.04 8420.92,-6454.24 8421.4,-6461.22"/>
</g>
<!-- O_s1_l11_tp7 -->
<g id="node945" class="node">
<title>O_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="8213.42,-6469.99 7875.42,-6469.99 7875.42,-6416.99 8213.42,-6416.99 8213.42,-6469.99"/>
<text text-anchor="middle" x="8044.42" y="-6454.79" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8044.42" y="-6439.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8044.42" y="-6424.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l11&#45;&gt;O_s1_l11_tp7 -->
<g id="edge1568" class="edge">
<title>AR_attn_s1_l11&#45;&gt;O_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M6470.19,-6529.33C6840.83,-6509.36 7537.57,-6471.81 7865.35,-6454.14"/>
<polygon fill="black" stroke="black" points="7865.62,-6457.63 7875.42,-6453.6 7865.24,-6450.64 7865.62,-6457.63"/>
</g>
<!-- O_s1_l11_tp0&#45;&gt;ResAttn_s1_l11_tp0 -->
<g id="edge1569" class="edge">
<title>O_s1_l11_tp0&#45;&gt;ResAttn_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M5470.58,-6416.88C5453.35,-6407.65 5433.14,-6396.84 5412.92,-6386.01"/>
<polygon fill="black" stroke="black" points="5414.41,-6382.84 5403.94,-6381.2 5411.11,-6389.01 5414.41,-6382.84"/>
</g>
<!-- O_s1_l11_tp1&#45;&gt;ResAttn_s1_l11_tp1 -->
<g id="edge1571" class="edge">
<title>O_s1_l11_tp1&#45;&gt;ResAttn_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M4323.36,-6424.13C4178.58,-6408.41 3965.64,-6385.28 3785.97,-6365.76"/>
<polygon fill="black" stroke="black" points="3786.14,-6362.26 3775.82,-6364.66 3785.38,-6369.22 3786.14,-6362.26"/>
</g>
<!-- O_s1_l11_tp2&#45;&gt;ResAttn_s1_l11_tp2 -->
<g id="edge1573" class="edge">
<title>O_s1_l11_tp2&#45;&gt;ResAttn_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M4829.37,-6416.95C4767.59,-6406.77 4694.02,-6394.65 4621.53,-6382.71"/>
<polygon fill="black" stroke="black" points="4621.75,-6379.2 4611.31,-6381.03 4620.61,-6386.11 4621.75,-6379.2"/>
</g>
<!-- O_s1_l11_tp3&#45;&gt;ResAttn_s1_l11_tp3 -->
<g id="edge1575" class="edge">
<title>O_s1_l11_tp3&#45;&gt;ResAttn_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6548.63,-6422.23C6695.83,-6404.61 6911.13,-6378.83 7078.07,-6358.85"/>
<polygon fill="black" stroke="black" points="7078.98,-6362.26 7088.49,-6357.6 7078.15,-6355.31 7078.98,-6362.26"/>
</g>
<!-- O_s1_l11_tp4&#45;&gt;ResAttn_s1_l11_tp4 -->
<g id="edge1577" class="edge">
<title>O_s1_l11_tp4&#45;&gt;ResAttn_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M7514.48,-6421.08C7649.95,-6403.92 7841.95,-6379.6 7994.61,-6360.26"/>
<polygon fill="black" stroke="black" points="7995.13,-6363.72 8004.61,-6358.99 7994.25,-6356.78 7995.13,-6363.72"/>
</g>
<!-- O_s1_l11_tp5&#45;&gt;ResAttn_s1_l11_tp5 -->
<g id="edge1579" class="edge">
<title>O_s1_l11_tp5&#45;&gt;ResAttn_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M3848.32,-6431.31C3662.14,-6419 3353.93,-6398.61 3088.42,-6380.99 2935.79,-6370.87 2766.39,-6359.6 2624.4,-6350.16"/>
<polygon fill="black" stroke="black" points="2624.43,-6346.65 2614.22,-6349.48 2623.97,-6353.64 2624.43,-6346.65"/>
</g>
<!-- O_s1_l11_tp6&#45;&gt;ResAttn_s1_l11_tp6 -->
<g id="edge1581" class="edge">
<title>O_s1_l11_tp6&#45;&gt;ResAttn_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M8769.72,-6432.22C8967.55,-6420.17 9304.76,-6399.49 9594.42,-6380.99 9769.58,-6369.81 9966.56,-6356.84 10120.01,-6346.66"/>
<polygon fill="black" stroke="black" points="10120.31,-6350.15 10130.06,-6345.99 10119.85,-6343.16 10120.31,-6350.15"/>
</g>
<!-- O_s1_l11_tp7&#45;&gt;ResAttn_s1_l11_tp7 -->
<g id="edge1583" class="edge">
<title>O_s1_l11_tp7&#45;&gt;ResAttn_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M8213.48,-6426.38C8413.29,-6407.34 8747.83,-6375.46 8979.45,-6353.39"/>
<polygon fill="black" stroke="black" points="8980.09,-6356.84 8989.71,-6352.41 8979.42,-6349.87 8980.09,-6356.84"/>
</g>
<!-- Gate_s1_l11_tp0 -->
<g id="node954" class="node">
<title>Gate_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5670.42,-6238.99 5332.42,-6238.99 5332.42,-6185.99 5670.42,-6185.99 5670.42,-6238.99"/>
<text text-anchor="middle" x="5501.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5501.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5501.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp0&#45;&gt;Gate_s1_l11_tp0 -->
<g id="edge1585" class="edge">
<title>ResAttn_s1_l11_tp0&#45;&gt;Gate_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M5395.93,-6274.89C5414.01,-6264.37 5432.46,-6253.63 5448.77,-6244.14"/>
<polygon fill="black" stroke="black" points="5450.71,-6247.06 5457.59,-6239.01 5447.19,-6241.01 5450.71,-6247.06"/>
</g>
<!-- ResMOE_s1_l11_tp0 -->
<g id="node995" class="node">
<title>ResMOE_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="6444.77,-5950.04 5887.45,-5950.04 5744.08,-5844.04 6301.4,-5844.04 6444.77,-5950.04"/>
<text text-anchor="middle" x="6094.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6094.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6094.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp0&#45;&gt;ResMOE_s1_l11_tp0 -->
<g id="edge1658" class="edge">
<title>ResAttn_s1_l11_tp0&#45;&gt;ResMOE_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M4985.84,-6297.11C4880.37,-6288.43 4762.47,-6279.96 4654.42,-6274.99 4006.84,-6245.21 2383.84,-6287.94 1737.42,-6238.99 1452.38,-6217.41 1288.05,-6365.66 1100.42,-6149.99 1084.96,-6132.22 1084.06,-6113.93 1100.42,-6096.99 1264.76,-5926.88 5119.22,-5962.43 5355.42,-5950.04 5514.25,-5941.71 5692.06,-5929.3 5833.46,-5918.69"/>
<polygon fill="black" stroke="black" points="5833.87,-5922.16 5843.58,-5917.92 5833.35,-5915.18 5833.87,-5922.16"/>
</g>
<!-- Gate_s1_l11_tp1 -->
<g id="node955" class="node">
<title>Gate_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3388.42,-6238.99 3050.42,-6238.99 3050.42,-6185.99 3388.42,-6185.99 3388.42,-6238.99"/>
<text text-anchor="middle" x="3219.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3219.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3219.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp1&#45;&gt;Gate_s1_l11_tp1 -->
<g id="edge1586" class="edge">
<title>ResAttn_s1_l11_tp1&#45;&gt;Gate_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M3342.76,-6274.89C3321.14,-6264.13 3299.06,-6253.14 3279.67,-6243.49"/>
<polygon fill="black" stroke="black" points="3281.19,-6240.33 3270.67,-6239.01 3278.07,-6246.6 3281.19,-6240.33"/>
</g>
<!-- ResMOE_s1_l11_tp1 -->
<g id="node996" class="node">
<title>ResMOE_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3870.77,-5950.04 3313.45,-5950.04 3170.08,-5844.04 3727.4,-5844.04 3870.77,-5950.04"/>
<text text-anchor="middle" x="3520.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3520.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3520.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp1&#45;&gt;ResMOE_s1_l11_tp1 -->
<g id="edge1660" class="edge">
<title>ResAttn_s1_l11_tp1&#45;&gt;ResMOE_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M3134.62,-6303C2991.65,-6292.86 2820.04,-6281.83 2665.42,-6274.99 2620.01,-6272.98 1061.21,-6271.49 1029.42,-6238.99 990.11,-6198.81 990.38,-6026.48 1029.42,-5986.04 1048.44,-5966.34 2596.01,-5922.74 3242.01,-5905.38"/>
<polygon fill="black" stroke="black" points="3242.49,-5908.87 3252.4,-5905.1 3242.31,-5901.87 3242.49,-5908.87"/>
</g>
<!-- Gate_s1_l11_tp2 -->
<g id="node956" class="node">
<title>Gate_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="4464.42,-6238.99 4126.42,-6238.99 4126.42,-6185.99 4464.42,-6185.99 4464.42,-6238.99"/>
<text text-anchor="middle" x="4295.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4295.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4295.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp2&#45;&gt;Gate_s1_l11_tp2 -->
<g id="edge1587" class="edge">
<title>ResAttn_s1_l11_tp2&#45;&gt;Gate_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M4295.42,-6274.89C4295.42,-6266.22 4295.42,-6257.41 4295.42,-6249.26"/>
<polygon fill="black" stroke="black" points="4298.92,-6249.01 4295.42,-6239.01 4291.92,-6249.01 4298.92,-6249.01"/>
</g>
<!-- ResMOE_s1_l11_tp2 -->
<g id="node997" class="node">
<title>ResMOE_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="5346.77,-5950.04 4789.45,-5950.04 4646.08,-5844.04 5203.4,-5844.04 5346.77,-5950.04"/>
<text text-anchor="middle" x="4996.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4996.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4996.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp2&#45;&gt;ResMOE_s1_l11_tp2 -->
<g id="edge1662" class="edge">
<title>ResAttn_s1_l11_tp2&#45;&gt;ResMOE_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M3961.7,-6287.33C3909.78,-6282.37 3856.7,-6277.99 3806.42,-6274.99 3768.45,-6272.73 1094.15,-6266.07 1067.42,-6238.99 1027.94,-6198.99 1027.93,-6026.04 1067.42,-5986.04 1094.86,-5958.24 3840.38,-5951.2 3879.42,-5950.04 4169.82,-5941.42 4502.4,-5925.11 4728.62,-5913.05"/>
<polygon fill="black" stroke="black" points="4728.84,-5916.54 4738.64,-5912.51 4728.47,-5909.55 4728.84,-5916.54"/>
</g>
<!-- Gate_s1_l11_tp3 -->
<g id="node957" class="node">
<title>Gate_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="7300.42,-6238.99 6962.42,-6238.99 6962.42,-6185.99 7300.42,-6185.99 7300.42,-6238.99"/>
<text text-anchor="middle" x="7131.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7131.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7131.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp3&#45;&gt;Gate_s1_l11_tp3 -->
<g id="edge1588" class="edge">
<title>ResAttn_s1_l11_tp3&#45;&gt;Gate_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M7237.45,-6274.89C7219.28,-6264.37 7200.74,-6253.63 7184.35,-6244.14"/>
<polygon fill="black" stroke="black" points="7185.89,-6240.99 7175.48,-6239.01 7182.38,-6247.05 7185.89,-6240.99"/>
</g>
<!-- ResMOE_s1_l11_tp3 -->
<g id="node998" class="node">
<title>ResMOE_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="7293.77,-5950.04 6736.45,-5950.04 6593.08,-5844.04 7150.4,-5844.04 7293.77,-5950.04"/>
<text text-anchor="middle" x="6943.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6943.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6943.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp3&#45;&gt;ResMOE_s1_l11_tp3 -->
<g id="edge1664" class="edge">
<title>ResAttn_s1_l11_tp3&#45;&gt;ResMOE_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M7568.54,-6300.09C7665.89,-6290.36 7779.38,-6280.43 7882.42,-6274.99 8551.1,-6239.73 10227.72,-6289.42 10895.42,-6238.99 11184.66,-6217.15 11733.04,-6306.49 11532.42,-6096.99 11495.26,-6058.19 8265.82,-5943.63 7247.44,-5908.44"/>
<polygon fill="black" stroke="black" points="7247.53,-5904.94 7237.41,-5908.1 7247.29,-5911.94 7247.53,-5904.94"/>
</g>
<!-- Gate_s1_l11_tp4 -->
<g id="node958" class="node">
<title>Gate_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="8410.42,-6238.99 8072.42,-6238.99 8072.42,-6185.99 8410.42,-6185.99 8410.42,-6238.99"/>
<text text-anchor="middle" x="8241.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8241.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8241.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp4&#45;&gt;Gate_s1_l11_tp4 -->
<g id="edge1589" class="edge">
<title>ResAttn_s1_l11_tp4&#45;&gt;Gate_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M8241.42,-6274.89C8241.42,-6266.22 8241.42,-6257.41 8241.42,-6249.26"/>
<polygon fill="black" stroke="black" points="8244.92,-6249.01 8241.42,-6239.01 8237.92,-6249.01 8244.92,-6249.01"/>
</g>
<!-- ResMOE_s1_l11_tp4 -->
<g id="node999" class="node">
<title>ResMOE_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="9330.77,-5950.04 8773.45,-5950.04 8630.08,-5844.04 9187.4,-5844.04 9330.77,-5950.04"/>
<text text-anchor="middle" x="8980.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8980.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8980.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp4&#45;&gt;ResMOE_s1_l11_tp4 -->
<g id="edge1666" class="edge">
<title>ResAttn_s1_l11_tp4&#45;&gt;ResMOE_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M8486.56,-6303.09C8604.33,-6292.59 8747.57,-6281.24 8876.42,-6274.99 9139.59,-6262.23 10986.69,-6276.92 11247.42,-6238.99 11392.23,-6217.93 11476.03,-6266.62 11564.42,-6149.99 11746.3,-5910.03 10519.64,-6009.08 10219.42,-5986.04 9906.75,-5962.04 9549.5,-5936.91 9299.21,-5919.68"/>
<polygon fill="black" stroke="black" points="9299.08,-5916.16 9288.86,-5918.97 9298.6,-5923.15 9299.08,-5916.16"/>
</g>
<!-- Gate_s1_l11_tp5 -->
<g id="node959" class="node">
<title>Gate_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="2084.42,-6238.99 1746.42,-6238.99 1746.42,-6185.99 2084.42,-6185.99 2084.42,-6238.99"/>
<text text-anchor="middle" x="1915.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1915.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1915.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp5&#45;&gt;Gate_s1_l11_tp5 -->
<g id="edge1590" class="edge">
<title>ResAttn_s1_l11_tp5&#45;&gt;Gate_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M2127.23,-6274.98C2087.93,-6263.57 2047.74,-6251.9 2013.08,-6241.84"/>
<polygon fill="black" stroke="black" points="2014.04,-6238.47 2003.46,-6239.05 2012.08,-6245.2 2014.04,-6238.47"/>
</g>
<!-- ResMOE_s1_l11_tp5 -->
<g id="node1000" class="node">
<title>ResMOE_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="1637.77,-5950.04 1080.45,-5950.04 937.08,-5844.04 1494.4,-5844.04 1637.77,-5950.04"/>
<text text-anchor="middle" x="1287.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1287.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1287.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp5&#45;&gt;ResMOE_s1_l11_tp5 -->
<g id="edge1668" class="edge">
<title>ResAttn_s1_l11_tp5&#45;&gt;ResMOE_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M2026.53,-6327.15C1665.3,-6324.47 1074.45,-6309.24 1003.42,-6238.99 923.48,-6159.93 931.32,-6075.51 999.42,-5986.04 1009.9,-5972.28 1034.19,-5959.75 1064.46,-5948.74"/>
<polygon fill="black" stroke="black" points="1065.77,-5952 1074.04,-5945.38 1063.45,-5945.39 1065.77,-5952"/>
</g>
<!-- Gate_s1_l11_tp6 -->
<g id="node960" class="node">
<title>Gate_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="10886.42,-6238.99 10548.42,-6238.99 10548.42,-6185.99 10886.42,-6185.99 10886.42,-6238.99"/>
<text text-anchor="middle" x="10717.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10717.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10717.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp6&#45;&gt;Gate_s1_l11_tp6 -->
<g id="edge1591" class="edge">
<title>ResAttn_s1_l11_tp6&#45;&gt;Gate_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M10537.28,-6274.89C10570.15,-6263.69 10603.74,-6252.24 10632.87,-6242.31"/>
<polygon fill="black" stroke="black" points="10634.23,-6245.55 10642.57,-6239.01 10631.97,-6238.92 10634.23,-6245.55"/>
</g>
<!-- ResMOE_s1_l11_tp6 -->
<g id="node1001" class="node">
<title>ResMOE_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="11756.77,-5950.04 11199.45,-5950.04 11056.08,-5844.04 11613.4,-5844.04 11756.77,-5950.04"/>
<text text-anchor="middle" x="11406.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11406.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11406.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp6&#45;&gt;ResMOE_s1_l11_tp6 -->
<g id="edge1670" class="edge">
<title>ResAttn_s1_l11_tp6&#45;&gt;ResMOE_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M10662.34,-6327.17C11012.32,-6324.42 11576.13,-6309.02 11641.42,-6238.99 11718.09,-6156.77 11705.48,-6078.43 11641.42,-5986.04 11633.53,-5974.66 11623.98,-5964.75 11613.3,-5956.12"/>
<polygon fill="black" stroke="black" points="11615.41,-5953.33 11605.33,-5950.06 11611.17,-5958.9 11615.41,-5953.33"/>
</g>
<!-- Gate_s1_l11_tp7 -->
<g id="node961" class="node">
<title>Gate_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="9582.42,-6238.99 9244.42,-6238.99 9244.42,-6185.99 9582.42,-6185.99 9582.42,-6238.99"/>
<text text-anchor="middle" x="9413.42" y="-6223.79" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9413.42" y="-6208.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9413.42" y="-6193.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp7&#45;&gt;Gate_s1_l11_tp7 -->
<g id="edge1592" class="edge">
<title>ResAttn_s1_l11_tp7&#45;&gt;Gate_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M9317.13,-6274.89C9333.48,-6264.47 9350.16,-6253.83 9364.94,-6244.41"/>
<polygon fill="black" stroke="black" points="9366.86,-6247.33 9373.41,-6239.01 9363.1,-6241.43 9366.86,-6247.33"/>
</g>
<!-- ResMOE_s1_l11_tp7 -->
<g id="node1002" class="node">
<title>ResMOE_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="10708.77,-5950.04 10151.45,-5950.04 10008.08,-5844.04 10565.4,-5844.04 10708.77,-5950.04"/>
<text text-anchor="middle" x="10358.42" y="-5908.34" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10358.42" y="-5893.34" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10358.42" y="-5878.34" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l11_tp7&#45;&gt;ResMOE_s1_l11_tp7 -->
<g id="edge1672" class="edge">
<title>ResAttn_s1_l11_tp7&#45;&gt;ResMOE_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M9487,-6307.89C9642.13,-6296.74 9845.21,-6283.28 10025.42,-6274.99 10178.2,-6267.97 11252.73,-6274.79 11401.42,-6238.99 11490.52,-6217.55 11538.57,-6227.53 11587.42,-6149.99 11599.98,-6130.06 11602.69,-6114.93 11587.42,-6096.99 11529.53,-6028.97 11033.95,-5965.84 10690.07,-5929.65"/>
<polygon fill="black" stroke="black" points="10690.26,-5926.15 10679.95,-5928.58 10689.53,-5933.11 10690.26,-5926.15"/>
</g>
<!-- Expert32_s1_l11_tp0 -->
<g id="node962" class="node">
<title>Expert32_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5981.42,-6149.99 5673.42,-6149.99 5673.42,-6096.99 5981.42,-6096.99 5981.42,-6149.99"/>
<text text-anchor="middle" x="5827.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="5827.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5827.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp0&#45;&gt;Expert32_s1_l11_tp0 -->
<g id="edge1593" class="edge">
<title>Gate_s1_l11_tp0&#45;&gt;Expert32_s1_l11_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5597.03,-6185.98C5636.26,-6175.51 5681.8,-6163.36 5721.99,-6152.63"/>
<polygon fill="black" stroke="black" points="5723.06,-6155.97 5731.82,-6150.01 5721.25,-6149.2 5723.06,-6155.97"/>
</g>
<!-- Expert33_s1_l11_tp0 -->
<g id="node963" class="node">
<title>Expert33_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="6307.42,-6149.99 5999.42,-6149.99 5999.42,-6096.99 6307.42,-6096.99 6307.42,-6149.99"/>
<text text-anchor="middle" x="6153.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="6153.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6153.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp0&#45;&gt;Expert33_s1_l11_tp0 -->
<g id="edge1594" class="edge">
<title>Gate_s1_l11_tp0&#45;&gt;Expert33_s1_l11_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5670.47,-6191.5C5761.97,-6180.37 5877.22,-6165.86 5988.9,-6150.19"/>
<polygon fill="black" stroke="black" points="5989.59,-6153.63 5999.01,-6148.77 5988.62,-6146.7 5989.59,-6153.63"/>
</g>
<!-- Expert34_s1_l11_tp0 -->
<g id="node964" class="node">
<title>Expert34_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5329.42,-6149.99 5021.42,-6149.99 5021.42,-6096.99 5329.42,-6096.99 5329.42,-6149.99"/>
<text text-anchor="middle" x="5175.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="5175.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5175.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp0&#45;&gt;Expert34_s1_l11_tp0 -->
<g id="edge1595" class="edge">
<title>Gate_s1_l11_tp0&#45;&gt;Expert34_s1_l11_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5405.81,-6185.98C5366.59,-6175.51 5321.04,-6163.36 5280.85,-6152.63"/>
<polygon fill="black" stroke="black" points="5281.59,-6149.2 5271.03,-6150.01 5279.79,-6155.97 5281.59,-6149.2"/>
</g>
<!-- Expert35_s1_l11_tp0 -->
<g id="node965" class="node">
<title>Expert35_s1_l11_tp0</title>
<polygon fill="none" stroke="black" points="5655.42,-6149.99 5347.42,-6149.99 5347.42,-6096.99 5655.42,-6096.99 5655.42,-6149.99"/>
<text text-anchor="middle" x="5501.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="5501.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5501.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp0&#45;&gt;Expert35_s1_l11_tp0 -->
<g id="edge1596" class="edge">
<title>Gate_s1_l11_tp0&#45;&gt;Expert35_s1_l11_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5501.42,-6185.86C5501.42,-6177.88 5501.42,-6168.93 5501.42,-6160.38"/>
<polygon fill="black" stroke="black" points="5504.92,-6160.24 5501.42,-6150.24 5497.92,-6160.24 5504.92,-6160.24"/>
</g>
<!-- Expert36_s1_l11_tp1 -->
<g id="node966" class="node">
<title>Expert36_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3373.42,-6149.99 3065.42,-6149.99 3065.42,-6096.99 3373.42,-6096.99 3373.42,-6149.99"/>
<text text-anchor="middle" x="3219.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="3219.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3219.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp1&#45;&gt;Expert36_s1_l11_tp1 -->
<g id="edge1597" class="edge">
<title>Gate_s1_l11_tp1&#45;&gt;Expert36_s1_l11_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3219.42,-6185.86C3219.42,-6177.88 3219.42,-6168.93 3219.42,-6160.38"/>
<polygon fill="black" stroke="black" points="3222.92,-6160.24 3219.42,-6150.24 3215.92,-6160.24 3222.92,-6160.24"/>
</g>
<!-- Expert37_s1_l11_tp1 -->
<g id="node967" class="node">
<title>Expert37_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3699.42,-6149.99 3391.42,-6149.99 3391.42,-6096.99 3699.42,-6096.99 3699.42,-6149.99"/>
<text text-anchor="middle" x="3545.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="3545.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3545.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp1&#45;&gt;Expert37_s1_l11_tp1 -->
<g id="edge1598" class="edge">
<title>Gate_s1_l11_tp1&#45;&gt;Expert37_s1_l11_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3315.03,-6185.98C3354.26,-6175.51 3399.8,-6163.36 3439.99,-6152.63"/>
<polygon fill="black" stroke="black" points="3441.06,-6155.97 3449.82,-6150.01 3439.25,-6149.2 3441.06,-6155.97"/>
</g>
<!-- Expert38_s1_l11_tp1 -->
<g id="node968" class="node">
<title>Expert38_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="2721.42,-6149.99 2413.42,-6149.99 2413.42,-6096.99 2721.42,-6096.99 2721.42,-6149.99"/>
<text text-anchor="middle" x="2567.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2567.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2567.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp1&#45;&gt;Expert38_s1_l11_tp1 -->
<g id="edge1599" class="edge">
<title>Gate_s1_l11_tp1&#45;&gt;Expert38_s1_l11_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3050.37,-6191.5C2958.87,-6180.37 2843.63,-6165.86 2731.94,-6150.19"/>
<polygon fill="black" stroke="black" points="2732.23,-6146.7 2721.84,-6148.77 2731.25,-6153.63 2732.23,-6146.7"/>
</g>
<!-- Expert39_s1_l11_tp1 -->
<g id="node969" class="node">
<title>Expert39_s1_l11_tp1</title>
<polygon fill="none" stroke="black" points="3047.42,-6149.99 2739.42,-6149.99 2739.42,-6096.99 3047.42,-6096.99 3047.42,-6149.99"/>
<text text-anchor="middle" x="2893.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="2893.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2893.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp1&#45;&gt;Expert39_s1_l11_tp1 -->
<g id="edge1600" class="edge">
<title>Gate_s1_l11_tp1&#45;&gt;Expert39_s1_l11_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3123.81,-6185.98C3084.59,-6175.51 3039.04,-6163.36 2998.85,-6152.63"/>
<polygon fill="black" stroke="black" points="2999.59,-6149.2 2989.03,-6150.01 2997.79,-6155.97 2999.59,-6149.2"/>
</g>
<!-- Expert40_s1_l11_tp2 -->
<g id="node970" class="node">
<title>Expert40_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="5003.42,-6149.99 4695.42,-6149.99 4695.42,-6096.99 5003.42,-6096.99 5003.42,-6149.99"/>
<text text-anchor="middle" x="4849.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="4849.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4849.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp2&#45;&gt;Expert40_s1_l11_tp2 -->
<g id="edge1601" class="edge">
<title>Gate_s1_l11_tp2&#45;&gt;Expert40_s1_l11_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4457.9,-6185.98C4529.4,-6174.75 4613.27,-6161.58 4685,-6150.31"/>
<polygon fill="black" stroke="black" points="4685.7,-6153.75 4695.04,-6148.74 4684.62,-6146.83 4685.7,-6153.75"/>
</g>
<!-- Expert41_s1_l11_tp2 -->
<g id="node971" class="node">
<title>Expert41_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="4025.42,-6149.99 3717.42,-6149.99 3717.42,-6096.99 4025.42,-6096.99 4025.42,-6149.99"/>
<text text-anchor="middle" x="3871.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="3871.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3871.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp2&#45;&gt;Expert41_s1_l11_tp2 -->
<g id="edge1602" class="edge">
<title>Gate_s1_l11_tp2&#45;&gt;Expert41_s1_l11_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4171.07,-6185.98C4119.08,-6175.31 4058.56,-6162.89 4005.57,-6152.02"/>
<polygon fill="black" stroke="black" points="4006.27,-6148.59 3995.77,-6150.01 4004.86,-6155.45 4006.27,-6148.59"/>
</g>
<!-- Expert42_s1_l11_tp2 -->
<g id="node972" class="node">
<title>Expert42_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="4351.42,-6149.99 4043.42,-6149.99 4043.42,-6096.99 4351.42,-6096.99 4351.42,-6149.99"/>
<text text-anchor="middle" x="4197.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="4197.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4197.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp2&#45;&gt;Expert42_s1_l11_tp2 -->
<g id="edge1603" class="edge">
<title>Gate_s1_l11_tp2&#45;&gt;Expert42_s1_l11_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4266.55,-6185.86C4256.37,-6176.83 4244.79,-6166.55 4234.06,-6157.02"/>
<polygon fill="black" stroke="black" points="4236.23,-6154.26 4226.43,-6150.24 4231.58,-6159.5 4236.23,-6154.26"/>
</g>
<!-- Expert43_s1_l11_tp2 -->
<g id="node973" class="node">
<title>Expert43_s1_l11_tp2</title>
<polygon fill="none" stroke="black" points="4677.42,-6149.99 4369.42,-6149.99 4369.42,-6096.99 4677.42,-6096.99 4677.42,-6149.99"/>
<text text-anchor="middle" x="4523.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="4523.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4523.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp2&#45;&gt;Expert43_s1_l11_tp2 -->
<g id="edge1604" class="edge">
<title>Gate_s1_l11_tp2&#45;&gt;Expert43_s1_l11_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4362.29,-6185.98C4388.85,-6175.84 4419.56,-6164.12 4447,-6153.65"/>
<polygon fill="black" stroke="black" points="4448.46,-6156.84 4456.56,-6150.01 4445.97,-6150.3 4448.46,-6156.84"/>
</g>
<!-- Expert44_s1_l11_tp3 -->
<g id="node974" class="node">
<title>Expert44_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6633.42,-6149.99 6325.42,-6149.99 6325.42,-6096.99 6633.42,-6096.99 6633.42,-6149.99"/>
<text text-anchor="middle" x="6479.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="6479.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6479.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp3&#45;&gt;Expert44_s1_l11_tp3 -->
<g id="edge1605" class="edge">
<title>Gate_s1_l11_tp3&#45;&gt;Expert44_s1_l11_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6962.37,-6191.5C6870.87,-6180.37 6755.63,-6165.86 6643.94,-6150.19"/>
<polygon fill="black" stroke="black" points="6644.23,-6146.7 6633.84,-6148.77 6643.25,-6153.63 6644.23,-6146.7"/>
</g>
<!-- Expert45_s1_l11_tp3 -->
<g id="node975" class="node">
<title>Expert45_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="6959.42,-6149.99 6651.42,-6149.99 6651.42,-6096.99 6959.42,-6096.99 6959.42,-6149.99"/>
<text text-anchor="middle" x="6805.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6805.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6805.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp3&#45;&gt;Expert45_s1_l11_tp3 -->
<g id="edge1606" class="edge">
<title>Gate_s1_l11_tp3&#45;&gt;Expert45_s1_l11_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7035.81,-6185.98C6996.59,-6175.51 6951.04,-6163.36 6910.85,-6152.63"/>
<polygon fill="black" stroke="black" points="6911.59,-6149.2 6901.03,-6150.01 6909.79,-6155.97 6911.59,-6149.2"/>
</g>
<!-- Expert46_s1_l11_tp3 -->
<g id="node976" class="node">
<title>Expert46_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="7285.42,-6149.99 6977.42,-6149.99 6977.42,-6096.99 7285.42,-6096.99 7285.42,-6149.99"/>
<text text-anchor="middle" x="7131.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="7131.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7131.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp3&#45;&gt;Expert46_s1_l11_tp3 -->
<g id="edge1607" class="edge">
<title>Gate_s1_l11_tp3&#45;&gt;Expert46_s1_l11_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7131.42,-6185.86C7131.42,-6177.88 7131.42,-6168.93 7131.42,-6160.38"/>
<polygon fill="black" stroke="black" points="7134.92,-6160.24 7131.42,-6150.24 7127.92,-6160.24 7134.92,-6160.24"/>
</g>
<!-- Expert47_s1_l11_tp3 -->
<g id="node977" class="node">
<title>Expert47_s1_l11_tp3</title>
<polygon fill="none" stroke="black" points="7611.42,-6149.99 7303.42,-6149.99 7303.42,-6096.99 7611.42,-6096.99 7611.42,-6149.99"/>
<text text-anchor="middle" x="7457.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="7457.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7457.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp3&#45;&gt;Expert47_s1_l11_tp3 -->
<g id="edge1608" class="edge">
<title>Gate_s1_l11_tp3&#45;&gt;Expert47_s1_l11_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7227.03,-6185.98C7266.26,-6175.51 7311.8,-6163.36 7351.99,-6152.63"/>
<polygon fill="black" stroke="black" points="7353.06,-6155.97 7361.82,-6150.01 7351.25,-6149.2 7353.06,-6155.97"/>
</g>
<!-- Expert48_s1_l11_tp4 -->
<g id="node978" class="node">
<title>Expert48_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="7937.42,-6149.99 7629.42,-6149.99 7629.42,-6096.99 7937.42,-6096.99 7937.42,-6149.99"/>
<text text-anchor="middle" x="7783.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7783.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7783.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp4&#45;&gt;Expert48_s1_l11_tp4 -->
<g id="edge1609" class="edge">
<title>Gate_s1_l11_tp4&#45;&gt;Expert48_s1_l11_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8107.1,-6185.98C8050.71,-6175.27 7985.02,-6162.79 7927.62,-6151.88"/>
<polygon fill="black" stroke="black" points="7928.22,-6148.44 7917.74,-6150.01 7926.91,-6155.31 7928.22,-6148.44"/>
</g>
<!-- Expert49_s1_l11_tp4 -->
<g id="node979" class="node">
<title>Expert49_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="8263.42,-6149.99 7955.42,-6149.99 7955.42,-6096.99 8263.42,-6096.99 8263.42,-6149.99"/>
<text text-anchor="middle" x="8109.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="8109.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8109.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp4&#45;&gt;Expert49_s1_l11_tp4 -->
<g id="edge1610" class="edge">
<title>Gate_s1_l11_tp4&#45;&gt;Expert49_s1_l11_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8202.53,-6185.86C8188.29,-6176.48 8172.01,-6165.75 8157.09,-6155.91"/>
<polygon fill="black" stroke="black" points="8158.77,-6152.82 8148.49,-6150.24 8154.91,-6158.67 8158.77,-6152.82"/>
</g>
<!-- Expert50_s1_l11_tp4 -->
<g id="node980" class="node">
<title>Expert50_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="8589.42,-6149.99 8281.42,-6149.99 8281.42,-6096.99 8589.42,-6096.99 8589.42,-6149.99"/>
<text text-anchor="middle" x="8435.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="8435.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8435.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp4&#45;&gt;Expert50_s1_l11_tp4 -->
<g id="edge1611" class="edge">
<title>Gate_s1_l11_tp4&#45;&gt;Expert50_s1_l11_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8298.32,-6185.98C8320.53,-6176.02 8346.14,-6164.53 8369.17,-6154.2"/>
<polygon fill="black" stroke="black" points="8370.84,-6157.29 8378.53,-6150.01 8367.97,-6150.91 8370.84,-6157.29"/>
</g>
<!-- Expert51_s1_l11_tp4 -->
<g id="node981" class="node">
<title>Expert51_s1_l11_tp4</title>
<polygon fill="none" stroke="black" points="8915.42,-6149.99 8607.42,-6149.99 8607.42,-6096.99 8915.42,-6096.99 8915.42,-6149.99"/>
<text text-anchor="middle" x="8761.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="8761.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8761.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp4&#45;&gt;Expert51_s1_l11_tp4 -->
<g id="edge1612" class="edge">
<title>Gate_s1_l11_tp4&#45;&gt;Expert51_s1_l11_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8393.93,-6185.98C8458.35,-6175.2 8533.45,-6162.63 8598.92,-6151.68"/>
<polygon fill="black" stroke="black" points="8599.64,-6155.11 8608.92,-6150.01 8598.48,-6148.21 8599.64,-6155.11"/>
</g>
<!-- Expert52_s1_l11_tp5 -->
<g id="node982" class="node">
<title>Expert52_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="1417.42,-6149.99 1109.42,-6149.99 1109.42,-6096.99 1417.42,-6096.99 1417.42,-6149.99"/>
<text text-anchor="middle" x="1263.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="1263.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1263.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp5&#45;&gt;Expert52_s1_l11_tp5 -->
<g id="edge1613" class="edge">
<title>Gate_s1_l11_tp5&#45;&gt;Expert52_s1_l11_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1746.37,-6191.5C1654.87,-6180.37 1539.63,-6165.86 1427.94,-6150.19"/>
<polygon fill="black" stroke="black" points="1428.23,-6146.7 1417.84,-6148.77 1427.25,-6153.63 1428.23,-6146.7"/>
</g>
<!-- Expert53_s1_l11_tp5 -->
<g id="node983" class="node">
<title>Expert53_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="1743.42,-6149.99 1435.42,-6149.99 1435.42,-6096.99 1743.42,-6096.99 1743.42,-6149.99"/>
<text text-anchor="middle" x="1589.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1589.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1589.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp5&#45;&gt;Expert53_s1_l11_tp5 -->
<g id="edge1614" class="edge">
<title>Gate_s1_l11_tp5&#45;&gt;Expert53_s1_l11_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1819.81,-6185.98C1780.59,-6175.51 1735.04,-6163.36 1694.85,-6152.63"/>
<polygon fill="black" stroke="black" points="1695.59,-6149.2 1685.03,-6150.01 1693.79,-6155.97 1695.59,-6149.2"/>
</g>
<!-- Expert54_s1_l11_tp5 -->
<g id="node984" class="node">
<title>Expert54_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="2069.42,-6149.99 1761.42,-6149.99 1761.42,-6096.99 2069.42,-6096.99 2069.42,-6149.99"/>
<text text-anchor="middle" x="1915.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="1915.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1915.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp5&#45;&gt;Expert54_s1_l11_tp5 -->
<g id="edge1615" class="edge">
<title>Gate_s1_l11_tp5&#45;&gt;Expert54_s1_l11_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1915.42,-6185.86C1915.42,-6177.88 1915.42,-6168.93 1915.42,-6160.38"/>
<polygon fill="black" stroke="black" points="1918.92,-6160.24 1915.42,-6150.24 1911.92,-6160.24 1918.92,-6160.24"/>
</g>
<!-- Expert55_s1_l11_tp5 -->
<g id="node985" class="node">
<title>Expert55_s1_l11_tp5</title>
<polygon fill="none" stroke="black" points="2395.42,-6149.99 2087.42,-6149.99 2087.42,-6096.99 2395.42,-6096.99 2395.42,-6149.99"/>
<text text-anchor="middle" x="2241.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="2241.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2241.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp5&#45;&gt;Expert55_s1_l11_tp5 -->
<g id="edge1616" class="edge">
<title>Gate_s1_l11_tp5&#45;&gt;Expert55_s1_l11_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2011.03,-6185.98C2050.26,-6175.51 2095.8,-6163.36 2135.99,-6152.63"/>
<polygon fill="black" stroke="black" points="2137.06,-6155.97 2145.82,-6150.01 2135.25,-6149.2 2137.06,-6155.97"/>
</g>
<!-- Expert56_s1_l11_tp6 -->
<g id="node986" class="node">
<title>Expert56_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="10545.42,-6149.99 10237.42,-6149.99 10237.42,-6096.99 10545.42,-6096.99 10545.42,-6149.99"/>
<text text-anchor="middle" x="10391.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="10391.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10391.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp6&#45;&gt;Expert56_s1_l11_tp6 -->
<g id="edge1617" class="edge">
<title>Gate_s1_l11_tp6&#45;&gt;Expert56_s1_l11_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10621.81,-6185.98C10582.59,-6175.51 10537.04,-6163.36 10496.85,-6152.63"/>
<polygon fill="black" stroke="black" points="10497.59,-6149.2 10487.03,-6150.01 10495.79,-6155.97 10497.59,-6149.2"/>
</g>
<!-- Expert57_s1_l11_tp6 -->
<g id="node987" class="node">
<title>Expert57_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="10871.42,-6149.99 10563.42,-6149.99 10563.42,-6096.99 10871.42,-6096.99 10871.42,-6149.99"/>
<text text-anchor="middle" x="10717.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="10717.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10717.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp6&#45;&gt;Expert57_s1_l11_tp6 -->
<g id="edge1618" class="edge">
<title>Gate_s1_l11_tp6&#45;&gt;Expert57_s1_l11_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10717.42,-6185.86C10717.42,-6177.88 10717.42,-6168.93 10717.42,-6160.38"/>
<polygon fill="black" stroke="black" points="10720.92,-6160.24 10717.42,-6150.24 10713.92,-6160.24 10720.92,-6160.24"/>
</g>
<!-- Expert58_s1_l11_tp6 -->
<g id="node988" class="node">
<title>Expert58_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="11197.42,-6149.99 10889.42,-6149.99 10889.42,-6096.99 11197.42,-6096.99 11197.42,-6149.99"/>
<text text-anchor="middle" x="11043.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="11043.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11043.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp6&#45;&gt;Expert58_s1_l11_tp6 -->
<g id="edge1619" class="edge">
<title>Gate_s1_l11_tp6&#45;&gt;Expert58_s1_l11_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10813.03,-6185.98C10852.26,-6175.51 10897.8,-6163.36 10937.99,-6152.63"/>
<polygon fill="black" stroke="black" points="10939.06,-6155.97 10947.82,-6150.01 10937.25,-6149.2 10939.06,-6155.97"/>
</g>
<!-- Expert59_s1_l11_tp6 -->
<g id="node989" class="node">
<title>Expert59_s1_l11_tp6</title>
<polygon fill="none" stroke="black" points="11523.42,-6149.99 11215.42,-6149.99 11215.42,-6096.99 11523.42,-6096.99 11523.42,-6149.99"/>
<text text-anchor="middle" x="11369.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="11369.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11369.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp6&#45;&gt;Expert59_s1_l11_tp6 -->
<g id="edge1620" class="edge">
<title>Gate_s1_l11_tp6&#45;&gt;Expert59_s1_l11_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10886.47,-6191.5C10977.97,-6180.37 11093.22,-6165.86 11204.9,-6150.19"/>
<polygon fill="black" stroke="black" points="11205.59,-6153.63 11215.01,-6148.77 11204.62,-6146.7 11205.59,-6153.63"/>
</g>
<!-- Expert60_s1_l11_tp7 -->
<g id="node990" class="node">
<title>Expert60_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="9241.42,-6149.99 8933.42,-6149.99 8933.42,-6096.99 9241.42,-6096.99 9241.42,-6149.99"/>
<text text-anchor="middle" x="9087.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="9087.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9087.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp7&#45;&gt;Expert60_s1_l11_tp7 -->
<g id="edge1621" class="edge">
<title>Gate_s1_l11_tp7&#45;&gt;Expert60_s1_l11_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9317.81,-6185.98C9278.59,-6175.51 9233.04,-6163.36 9192.85,-6152.63"/>
<polygon fill="black" stroke="black" points="9193.59,-6149.2 9183.03,-6150.01 9191.79,-6155.97 9193.59,-6149.2"/>
</g>
<!-- Expert61_s1_l11_tp7 -->
<g id="node991" class="node">
<title>Expert61_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="9567.42,-6149.99 9259.42,-6149.99 9259.42,-6096.99 9567.42,-6096.99 9567.42,-6149.99"/>
<text text-anchor="middle" x="9413.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="9413.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9413.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp7&#45;&gt;Expert61_s1_l11_tp7 -->
<g id="edge1622" class="edge">
<title>Gate_s1_l11_tp7&#45;&gt;Expert61_s1_l11_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9413.42,-6185.86C9413.42,-6177.88 9413.42,-6168.93 9413.42,-6160.38"/>
<polygon fill="black" stroke="black" points="9416.92,-6160.24 9413.42,-6150.24 9409.92,-6160.24 9416.92,-6160.24"/>
</g>
<!-- Expert62_s1_l11_tp7 -->
<g id="node992" class="node">
<title>Expert62_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="9893.42,-6149.99 9585.42,-6149.99 9585.42,-6096.99 9893.42,-6096.99 9893.42,-6149.99"/>
<text text-anchor="middle" x="9739.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="9739.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9739.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp7&#45;&gt;Expert62_s1_l11_tp7 -->
<g id="edge1623" class="edge">
<title>Gate_s1_l11_tp7&#45;&gt;Expert62_s1_l11_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9509.03,-6185.98C9548.26,-6175.51 9593.8,-6163.36 9633.99,-6152.63"/>
<polygon fill="black" stroke="black" points="9635.06,-6155.97 9643.82,-6150.01 9633.25,-6149.2 9635.06,-6155.97"/>
</g>
<!-- Expert63_s1_l11_tp7 -->
<g id="node993" class="node">
<title>Expert63_s1_l11_tp7</title>
<polygon fill="none" stroke="black" points="10219.42,-6149.99 9911.42,-6149.99 9911.42,-6096.99 10219.42,-6096.99 10219.42,-6149.99"/>
<text text-anchor="middle" x="10065.42" y="-6134.79" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="10065.42" y="-6119.79" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10065.42" y="-6104.79" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l11_tp7&#45;&gt;Expert63_s1_l11_tp7 -->
<g id="edge1624" class="edge">
<title>Gate_s1_l11_tp7&#45;&gt;Expert63_s1_l11_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9582.47,-6191.5C9673.97,-6180.37 9789.22,-6165.86 9900.9,-6150.19"/>
<polygon fill="black" stroke="black" points="9901.59,-6153.63 9911.01,-6148.77 9900.62,-6146.7 9901.59,-6153.63"/>
</g>
<!-- AR_exp_s1_l11 -->
<g id="node994" class="node">
<title>AR_exp_s1_l11</title>
<ellipse fill="none" stroke="black" cx="6283.42" cy="-6023.52" rx="239" ry="37.45"/>
<text text-anchor="middle" x="6283.42" y="-6034.82" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="6283.42" y="-6019.82" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6283.42" y="-6004.82" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l11_tp0&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1625" class="edge">
<title>Expert32_s1_l11_tp0&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M5946.34,-6096.94C6004.08,-6084.54 6074.04,-6069.51 6135.22,-6056.36"/>
<polygon fill="black" stroke="black" points="6136.31,-6059.7 6145.35,-6054.18 6134.84,-6052.86 6136.31,-6059.7"/>
</g>
<!-- Expert33_s1_l11_tp0&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1626" class="edge">
<title>Expert33_s1_l11_tp0&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M6187.58,-6096.75C6199.79,-6087.55 6213.89,-6076.92 6227.46,-6066.7"/>
<polygon fill="black" stroke="black" points="6229.93,-6069.21 6235.81,-6060.4 6225.72,-6063.62 6229.93,-6069.21"/>
</g>
<!-- Expert34_s1_l11_tp0&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1627" class="edge">
<title>Expert34_s1_l11_tp0&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M5329.81,-6098.02C5332.71,-6097.67 5335.58,-6097.32 5338.42,-6096.99 5580.08,-6068.87 5857.82,-6049.05 6049.35,-6037.33"/>
<polygon fill="black" stroke="black" points="6049.78,-6040.81 6059.55,-6036.71 6049.36,-6033.83 6049.78,-6040.81"/>
</g>
<!-- Expert35_s1_l11_tp0&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1628" class="edge">
<title>Expert35_s1_l11_tp0&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M5655.83,-6098.18C5658.72,-6097.78 5661.58,-6097.38 5664.42,-6096.99 5802.32,-6078.14 5957.92,-6059.94 6078.62,-6046.49"/>
<polygon fill="black" stroke="black" points="6079.17,-6049.95 6088.72,-6045.36 6078.39,-6042.99 6079.17,-6049.95"/>
</g>
<!-- Expert36_s1_l11_tp1&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1629" class="edge">
<title>Expert36_s1_l11_tp1&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M3373.79,-6097.82C3376.69,-6097.53 3379.57,-6097.25 3382.42,-6096.99 3893.84,-6050.8 5430.22,-6032.22 6034.97,-6026.56"/>
<polygon fill="black" stroke="black" points="6035.16,-6030.06 6045.13,-6026.47 6035.09,-6023.06 6035.16,-6030.06"/>
</g>
<!-- Expert37_s1_l11_tp1&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1630" class="edge">
<title>Expert37_s1_l11_tp1&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M3699.79,-6097.83C3702.69,-6097.54 3705.57,-6097.26 3708.42,-6096.99 4154.79,-6055.96 5480.95,-6034.75 6035.41,-6027.48"/>
<polygon fill="black" stroke="black" points="6035.58,-6030.98 6045.54,-6027.34 6035.49,-6023.98 6035.58,-6030.98"/>
</g>
<!-- Expert38_s1_l11_tp1&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1631" class="edge">
<title>Expert38_s1_l11_tp1&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M2721.79,-6097.8C2724.69,-6097.51 2727.57,-6097.24 2730.42,-6096.99 3373.07,-6040.43 5336.83,-6027.91 6034.37,-6025.23"/>
<polygon fill="black" stroke="black" points="6034.55,-6028.73 6044.54,-6025.19 6034.53,-6021.73 6034.55,-6028.73"/>
</g>
<!-- Expert39_s1_l11_tp1&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1632" class="edge">
<title>Expert39_s1_l11_tp1&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M3047.79,-6097.81C3050.69,-6097.52 3053.57,-6097.25 3056.42,-6096.99 3633.2,-6045.63 5381.8,-6029.96 6034.34,-6025.83"/>
<polygon fill="black" stroke="black" points="6034.83,-6029.33 6044.81,-6025.77 6034.79,-6022.33 6034.83,-6029.33"/>
</g>
<!-- Expert40_s1_l11_tp2&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1633" class="edge">
<title>Expert40_s1_l11_tp2&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M5003.81,-6097.95C5006.7,-6097.61 5009.57,-6097.3 5012.42,-6096.99 5368.37,-6059.09 5782.66,-6040.14 6039,-6031.33"/>
<polygon fill="black" stroke="black" points="6039.31,-6034.82 6049.19,-6030.98 6039.08,-6027.82 6039.31,-6034.82"/>
</g>
<!-- Expert41_s1_l11_tp2&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1634" class="edge">
<title>Expert41_s1_l11_tp2&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M4025.8,-6097.85C4028.69,-6097.55 4031.57,-6097.26 4034.42,-6096.99 4416.24,-6061.11 5535.24,-6037.64 6036.1,-6028.64"/>
<polygon fill="black" stroke="black" points="6036.42,-6032.14 6046.35,-6028.46 6036.29,-6025.14 6036.42,-6032.14"/>
</g>
<!-- Expert42_s1_l11_tp2&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1635" class="edge">
<title>Expert42_s1_l11_tp2&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M4351.8,-6097.87C4354.69,-6097.56 4357.57,-6097.27 4360.42,-6096.99 4959.21,-6039.07 5667.03,-6026.78 6034.26,-6024.58"/>
<polygon fill="black" stroke="black" points="6034.51,-6028.07 6044.49,-6024.52 6034.47,-6021.07 6034.51,-6028.07"/>
</g>
<!-- Expert43_s1_l11_tp2&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1636" class="edge">
<title>Expert43_s1_l11_tp2&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M4677.8,-6097.9C4680.7,-6097.58 4683.57,-6097.28 4686.42,-6096.99 5162.1,-6049.14 5720.69,-6032.87 6035.24,-6027.35"/>
<polygon fill="black" stroke="black" points="6035.47,-6030.84 6045.4,-6027.17 6035.35,-6023.84 6035.47,-6030.84"/>
</g>
<!-- Expert44_s1_l11_tp3&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1637" class="edge">
<title>Expert44_s1_l11_tp3&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M6428.18,-6096.88C6408.04,-6086.81 6384.47,-6075.03 6362.26,-6063.92"/>
<polygon fill="black" stroke="black" points="6363.68,-6060.72 6353.17,-6059.38 6360.55,-6066.98 6363.68,-6060.72"/>
</g>
<!-- Expert45_s1_l11_tp3&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1638" class="edge">
<title>Expert45_s1_l11_tp3&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M6669.3,-6096.94C6600.2,-6083.97 6515.82,-6068.14 6443.61,-6054.58"/>
<polygon fill="black" stroke="black" points="6443.98,-6051.09 6433.51,-6052.69 6442.69,-6057.97 6443.98,-6051.09"/>
</g>
<!-- Expert46_s1_l11_tp3&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1639" class="edge">
<title>Expert46_s1_l11_tp3&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M6977.02,-6098.14C6974.13,-6097.75 6971.26,-6097.37 6968.42,-6096.99 6810.67,-6076.32 6631.87,-6057.56 6496.51,-6044.31"/>
<polygon fill="black" stroke="black" points="6496.72,-6040.81 6486.43,-6043.32 6496.04,-6047.78 6496.72,-6040.81"/>
</g>
<!-- Expert47_s1_l11_tp3&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1640" class="edge">
<title>Expert47_s1_l11_tp3&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M7303.03,-6098C7300.14,-6097.65 7297.27,-6097.32 7294.42,-6096.99 7030.15,-6066.9 6725.51,-6047.08 6520.29,-6035.89"/>
<polygon fill="black" stroke="black" points="6520.46,-6032.39 6510.29,-6035.35 6520.08,-6039.38 6520.46,-6032.39"/>
</g>
<!-- Expert48_s1_l11_tp4&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1641" class="edge">
<title>Expert48_s1_l11_tp4&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M7629.04,-6097.94C7626.15,-6097.61 7623.27,-6097.29 7620.42,-6096.99 7240.67,-6057.1 6797.79,-6038.56 6529.14,-6030.4"/>
<polygon fill="black" stroke="black" points="6528.97,-6026.89 6518.87,-6030.09 6528.76,-6033.89 6528.97,-6026.89"/>
</g>
<!-- Expert49_s1_l11_tp4&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1642" class="edge">
<title>Expert49_s1_l11_tp4&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M7955.04,-6097.89C7952.15,-6097.58 7949.27,-6097.28 7946.42,-6096.99 7446.03,-6047.11 6857.55,-6031.55 6531.92,-6026.71"/>
<polygon fill="black" stroke="black" points="6531.94,-6023.21 6521.89,-6026.56 6531.83,-6030.2 6531.94,-6023.21"/>
</g>
<!-- Expert50_s1_l11_tp4&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1643" class="edge">
<title>Expert50_s1_l11_tp4&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M8281.05,-6097.87C8278.15,-6097.56 8275.27,-6097.27 8272.42,-6096.99 7648.45,-6037.03 6910.02,-6025.66 6532.68,-6024.12"/>
<polygon fill="black" stroke="black" points="6532.47,-6020.62 6522.45,-6024.08 6532.44,-6027.62 6532.47,-6020.62"/>
</g>
<!-- Expert51_s1_l11_tp4&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1644" class="edge">
<title>Expert51_s1_l11_tp4&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M8607.05,-6097.85C8604.15,-6097.54 8601.27,-6097.26 8598.42,-6096.99 8203.56,-6060.07 7042.77,-6037.02 6530.82,-6028.38"/>
<polygon fill="black" stroke="black" points="6530.77,-6024.88 6520.71,-6028.21 6530.65,-6031.88 6530.77,-6024.88"/>
</g>
<!-- Expert52_s1_l11_tp5&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1645" class="edge">
<title>Expert52_s1_l11_tp5&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M1417.79,-6097.78C1420.69,-6097.5 1423.57,-6097.24 1426.42,-6096.99 1886.03,-6057.81 5107.69,-6032.66 6034.54,-6026.18"/>
<polygon fill="black" stroke="black" points="6034.69,-6029.68 6044.66,-6026.11 6034.64,-6022.68 6034.69,-6029.68"/>
</g>
<!-- Expert53_s1_l11_tp5&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1646" class="edge">
<title>Expert53_s1_l11_tp5&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M1743.79,-6097.79C1746.69,-6097.5 1749.57,-6097.24 1752.42,-6096.99 2594.13,-6024.78 5212.39,-6022.72 6034.1,-6023.93"/>
<polygon fill="black" stroke="black" points="6034.27,-6027.43 6044.28,-6023.95 6034.28,-6020.43 6034.27,-6027.43"/>
</g>
<!-- Expert54_s1_l11_tp5&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1647" class="edge">
<title>Expert54_s1_l11_tp5&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M2069.79,-6097.79C2072.69,-6097.51 2075.57,-6097.24 2078.42,-6096.99 2853.47,-6030.01 5251.74,-6024.32 6033.94,-6024.3"/>
<polygon fill="black" stroke="black" points="6034.2,-6027.8 6044.2,-6024.3 6034.2,-6020.8 6034.2,-6027.8"/>
</g>
<!-- Expert55_s1_l11_tp5&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1648" class="edge">
<title>Expert55_s1_l11_tp5&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M2395.79,-6097.8C2398.69,-6097.51 2401.57,-6097.24 2404.42,-6096.99 3113.13,-6035.23 5293.28,-6026.05 6034.08,-6024.72"/>
<polygon fill="black" stroke="black" points="6034.35,-6028.22 6044.34,-6024.71 6034.34,-6021.22 6034.35,-6028.22"/>
</g>
<!-- Expert56_s1_l11_tp6&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1649" class="edge">
<title>Expert56_s1_l11_tp6&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M10237.05,-6097.79C10234.16,-6097.51 10231.28,-6097.24 10228.42,-6096.99 9506.29,-6034.17 7282.02,-6025.69 6532.75,-6024.63"/>
<polygon fill="black" stroke="black" points="6532.65,-6021.13 6522.64,-6024.62 6532.64,-6028.13 6532.65,-6021.13"/>
</g>
<!-- Expert57_s1_l11_tp6&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1650" class="edge">
<title>Expert57_s1_l11_tp6&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M10563.05,-6097.79C10560.16,-6097.51 10557.28,-6097.24 10554.42,-6096.99 9765.85,-6028.95 7322.87,-6023.99 6532.72,-6024.22"/>
<polygon fill="black" stroke="black" points="6532.64,-6020.72 6522.64,-6024.22 6532.64,-6027.72 6532.64,-6020.72"/>
</g>
<!-- Expert58_s1_l11_tp6&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1651" class="edge">
<title>Expert58_s1_l11_tp6&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M10889.05,-6097.78C10886.16,-6097.5 10883.28,-6097.24 10880.42,-6096.99 10025.21,-6023.72 7362.35,-6022.41 6532.77,-6023.86"/>
<polygon fill="black" stroke="black" points="6532.49,-6020.36 6522.49,-6023.88 6532.5,-6027.36 6532.49,-6020.36"/>
</g>
<!-- Expert59_s1_l11_tp6&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1652" class="edge">
<title>Expert59_s1_l11_tp6&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M11215.06,-6097.78C11212.16,-6097.5 11209.28,-6097.24 11206.42,-6096.99 10739.97,-6057.27 7466.76,-6032.46 6532.09,-6026.13"/>
<polygon fill="black" stroke="black" points="6531.91,-6022.63 6521.88,-6026.06 6531.86,-6029.62 6531.91,-6022.63"/>
</g>
<!-- Expert60_s1_l11_tp7&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1653" class="edge">
<title>Expert60_s1_l11_tp7&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M8933.05,-6097.83C8930.15,-6097.53 8927.27,-6097.25 8924.42,-6096.99 8464.98,-6054.92 7096.75,-6034.22 6531.74,-6027.28"/>
<polygon fill="black" stroke="black" points="6531.47,-6023.77 6521.43,-6027.15 6531.38,-6030.77 6531.47,-6023.77"/>
</g>
<!-- Expert61_s1_l11_tp7&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1654" class="edge">
<title>Expert61_s1_l11_tp7&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M9259.05,-6097.82C9256.15,-6097.53 9253.28,-6097.25 9250.42,-6096.99 8725.85,-6049.76 7146.92,-6031.74 6532.18,-6026.4"/>
<polygon fill="black" stroke="black" points="6531.88,-6022.9 6521.85,-6026.31 6531.82,-6029.9 6531.88,-6022.9"/>
</g>
<!-- Expert62_s1_l11_tp7&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1655" class="edge">
<title>Expert62_s1_l11_tp7&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M9585.05,-6097.81C9582.15,-6097.52 9579.28,-6097.25 9576.42,-6096.99 8986.28,-6044.57 7194.01,-6029.53 6532.33,-6025.7"/>
<polygon fill="black" stroke="black" points="6532.21,-6022.2 6522.19,-6025.64 6532.17,-6029.2 6532.21,-6022.2"/>
</g>
<!-- Expert63_s1_l11_tp7&#45;&gt;AR_exp_s1_l11 -->
<g id="edge1656" class="edge">
<title>Expert63_s1_l11_tp7&#45;&gt;AR_exp_s1_l11</title>
<path fill="none" stroke="black" d="M9911.05,-6097.8C9908.15,-6097.51 9905.28,-6097.24 9902.42,-6096.99 9246.39,-6039.37 7238.77,-6027.52 6532.43,-6025.12"/>
<polygon fill="black" stroke="black" points="6532.39,-6021.62 6522.38,-6025.08 6532.37,-6028.62 6532.39,-6021.62"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp0 -->
<g id="edge1657" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp0</title>
<path fill="none" stroke="black" d="M6229.26,-5986.85C6214.49,-5977.12 6198.11,-5966.33 6181.99,-5955.71"/>
<polygon fill="black" stroke="black" points="6183.87,-5952.76 6173.59,-5950.18 6180.02,-5958.61 6183.87,-5952.76"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp1 -->
<g id="edge1659" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp1</title>
<path fill="none" stroke="black" d="M6054.41,-6012.62C5736.44,-5998.83 5143.2,-5972.95 4637.42,-5950.04 4364.53,-5937.68 4054.16,-5923.2 3829.96,-5912.66"/>
<polygon fill="black" stroke="black" points="3829.84,-5909.15 3819.69,-5912.18 3829.51,-5916.14 3829.84,-5909.15"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp2 -->
<g id="edge1661" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp2</title>
<path fill="none" stroke="black" d="M6082.68,-6003.1C5881.33,-5983.63 5567.71,-5953.29 5329.11,-5930.22"/>
<polygon fill="black" stroke="black" points="5329.17,-5926.71 5318.88,-5929.23 5328.49,-5933.67 5329.17,-5926.71"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp3 -->
<g id="edge1663" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp3</title>
<path fill="none" stroke="black" d="M6433.19,-5994.27C6515.57,-5978.73 6619.57,-5959.12 6712.15,-5941.66"/>
<polygon fill="black" stroke="black" points="6713.04,-5945.05 6722.22,-5939.76 6711.75,-5938.17 6713.04,-5945.05"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp4 -->
<g id="edge1665" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp4</title>
<path fill="none" stroke="black" d="M6511.04,-6012.01C7005.78,-5989.18 8177.28,-5935.11 8709.24,-5910.56"/>
<polygon fill="black" stroke="black" points="8709.53,-5914.05 8719.36,-5910.09 8709.21,-5907.05 8709.53,-5914.05"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp5 -->
<g id="edge1667" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp5</title>
<path fill="none" stroke="black" d="M6047.45,-6017.4C5526.61,-6006.04 4239.29,-5977.51 3161.42,-5950.04 2606.65,-5935.9 1959.54,-5917.53 1589.21,-5906.83"/>
<polygon fill="black" stroke="black" points="1589.25,-5903.33 1579.15,-5906.54 1589.05,-5910.33 1589.25,-5903.33"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp6 -->
<g id="edge1669" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp6</title>
<path fill="none" stroke="black" d="M6521.78,-6020.48C7319.16,-6013.37 9889.69,-5988.01 10717.42,-5950.04 10860.34,-5943.48 11019.64,-5931.75 11149.04,-5921.09"/>
<polygon fill="black" stroke="black" points="11149.41,-5924.57 11159.09,-5920.25 11148.84,-5917.59 11149.41,-5924.57"/>
</g>
<!-- AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp7 -->
<g id="edge1671" class="edge">
<title>AR_exp_s1_l11&#45;&gt;ResMOE_s1_l11_tp7</title>
<path fill="none" stroke="black" d="M6520.75,-6019.09C7034.71,-6011.19 8289.03,-5989.29 9339.42,-5950.04 9594.68,-5940.5 9885.69,-5925.21 10091.19,-5913.67"/>
<polygon fill="black" stroke="black" points="10091.43,-5917.16 10101.21,-5913.11 10091.03,-5910.18 10091.43,-5917.16"/>
</g>
<!-- QKV_s1_l12_tp0 -->
<g id="node1003" class="node">
<title>QKV_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5313.42,-5808.04 4975.42,-5808.04 4975.42,-5755.04 5313.42,-5755.04 5313.42,-5808.04"/>
<text text-anchor="middle" x="5144.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5144.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5144.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp0 -->
<g id="edge1673" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5760.56,-5856.3C5633.98,-5841.22 5488.54,-5823.86 5356.42,-5808.04 5345.78,-5806.77 5334.85,-5805.45 5323.81,-5804.13"/>
<polygon fill="black" stroke="black" points="5324,-5800.63 5313.65,-5802.91 5323.17,-5807.58 5324,-5800.63"/>
</g>
<!-- QKV_s1_l12_tp1 -->
<g id="node1004" class="node">
<title>QKV_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="5703.42,-5808.04 5365.42,-5808.04 5365.42,-5755.04 5703.42,-5755.04 5703.42,-5808.04"/>
<text text-anchor="middle" x="5534.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5534.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5534.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp1 -->
<g id="edge1674" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5837.78,-5844.02C5780.04,-5832.32 5720.98,-5820.35 5670.49,-5810.12"/>
<polygon fill="black" stroke="black" points="5671,-5806.65 5660.51,-5808.09 5669.61,-5813.51 5671,-5806.65"/>
</g>
<!-- QKV_s1_l12_tp2 -->
<g id="node1005" class="node">
<title>QKV_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="6084.42,-5808.04 5746.42,-5808.04 5746.42,-5755.04 6084.42,-5755.04 6084.42,-5808.04"/>
<text text-anchor="middle" x="5915.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5915.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5915.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp2 -->
<g id="edge1675" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M6012.26,-5843.94C5995.82,-5833.52 5979.04,-5822.88 5964.18,-5813.45"/>
<polygon fill="black" stroke="black" points="5965.98,-5810.45 5955.66,-5808.05 5962.23,-5816.36 5965.98,-5810.45"/>
</g>
<!-- QKV_s1_l12_tp3 -->
<g id="node1006" class="node">
<title>QKV_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6449.42,-5808.04 6111.42,-5808.04 6111.42,-5755.04 6449.42,-5755.04 6449.42,-5808.04"/>
<text text-anchor="middle" x="6280.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6280.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6280.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp3 -->
<g id="edge1676" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6179.8,-5843.94C6196.89,-5833.52 6214.31,-5822.88 6229.76,-5813.45"/>
<polygon fill="black" stroke="black" points="6231.9,-5816.25 6238.61,-5808.05 6228.25,-5810.27 6231.9,-5816.25"/>
</g>
<!-- QKV_s1_l12_tp4 -->
<g id="node1007" class="node">
<title>QKV_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="6830.42,-5808.04 6492.42,-5808.04 6492.42,-5755.04 6830.42,-5755.04 6830.42,-5808.04"/>
<text text-anchor="middle" x="6661.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6661.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6661.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp4 -->
<g id="edge1677" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6312.83,-5852.32C6383.75,-5838.12 6460.42,-5822.78 6523.74,-5810.1"/>
<polygon fill="black" stroke="black" points="6524.67,-5813.48 6533.79,-5808.09 6523.3,-5806.62 6524.67,-5813.48"/>
</g>
<!-- QKV_s1_l12_tp5 -->
<g id="node1008" class="node">
<title>QKV_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="7216.42,-5808.04 6878.42,-5808.04 6878.42,-5755.04 7216.42,-5755.04 7216.42,-5808.04"/>
<text text-anchor="middle" x="7047.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7047.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7047.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp5 -->
<g id="edge1678" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M6333.93,-5868.02C6480.01,-5850.86 6670.52,-5828.37 6839.42,-5808.04 6848.81,-5806.91 6858.43,-5805.75 6868.14,-5804.57"/>
<polygon fill="black" stroke="black" points="6868.78,-5808.02 6878.29,-5803.34 6867.94,-5801.07 6868.78,-5808.02"/>
</g>
<!-- QKV_s1_l12_tp6 -->
<g id="node1009" class="node">
<title>QKV_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="7604.42,-5808.04 7266.42,-5808.04 7266.42,-5755.04 7604.42,-5755.04 7604.42,-5808.04"/>
<text text-anchor="middle" x="7435.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7435.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7435.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp6 -->
<g id="edge1679" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M6334.39,-5868.17C6413.89,-5859.58 6502.89,-5850.65 6584.42,-5844.04 6868.83,-5820.98 6941.2,-5833.25 7225.42,-5808.04 7235.47,-5807.15 7245.78,-5806.15 7256.18,-5805.09"/>
<polygon fill="black" stroke="black" points="7256.59,-5808.57 7266.18,-5804.05 7255.87,-5801.6 7256.59,-5808.57"/>
</g>
<!-- QKV_s1_l12_tp7 -->
<g id="node1010" class="node">
<title>QKV_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="4931.42,-5808.04 4593.42,-5808.04 4593.42,-5755.04 4931.42,-5755.04 4931.42,-5808.04"/>
<text text-anchor="middle" x="4762.42" y="-5792.84" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4762.42" y="-5777.84" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4762.42" y="-5762.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp7 -->
<g id="edge1680" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;QKV_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M5787.07,-5875.94C5560.08,-5860.15 5243.68,-5836.17 4966.42,-5808.04 4958.34,-5807.22 4950.09,-5806.35 4941.76,-5805.43"/>
<polygon fill="black" stroke="black" points="4941.88,-5801.92 4931.56,-5804.3 4941.11,-5808.88 4941.88,-5801.92"/>
</g>
<!-- ResAttn_s1_l12_tp0 -->
<g id="node1037" class="node">
<title>ResAttn_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5345.77,-5230.13 4788.45,-5230.13 4645.08,-5124.13 5202.4,-5124.13 5345.77,-5230.13"/>
<text text-anchor="middle" x="4995.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4995.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4995.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp0 -->
<g id="edge1722" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5782.15,-5872.43C5650.48,-5862.9 5495.53,-5852.24 5355.42,-5844.04 5269.81,-5839.03 4656.9,-5853.88 4584.42,-5808.04 4535.69,-5777.22 4523.42,-5751.2 4523.42,-5693.54 4523.42,-5693.54 4523.42,-5693.54 4523.42,-5391.61 4523.42,-5283.25 4627.98,-5229.6 4738.67,-5203.17"/>
<polygon fill="black" stroke="black" points="4739.75,-5206.51 4748.71,-5200.85 4738.18,-5199.69 4739.75,-5206.51"/>
</g>
<!-- ResAttn_s1_l12_tp1 -->
<g id="node1038" class="node">
<title>ResAttn_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="3631.77,-5230.13 3074.45,-5230.13 2931.08,-5124.13 3488.4,-5124.13 3631.77,-5230.13"/>
<text text-anchor="middle" x="3281.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3281.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3281.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp1 -->
<g id="edge1724" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5780.4,-5871.11C5649.13,-5861.43 5494.96,-5851.01 5355.42,-5844.04 4814.97,-5817.04 4676.71,-5863.41 4138.42,-5808.04 3993.39,-5793.12 3492.42,-5839.33 3492.42,-5693.54 3492.42,-5693.54 3492.42,-5693.54 3492.42,-5391.61 3492.42,-5325.58 3440.72,-5272.61 3388.5,-5235.95"/>
<polygon fill="black" stroke="black" points="3390.35,-5232.98 3380.13,-5230.21 3386.4,-5238.75 3390.35,-5232.98"/>
</g>
<!-- ResAttn_s1_l12_tp2 -->
<g id="node1039" class="node">
<title>ResAttn_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="4479.77,-5230.13 3922.45,-5230.13 3779.08,-5124.13 4336.4,-5124.13 4479.77,-5230.13"/>
<text text-anchor="middle" x="4129.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4129.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4129.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp2 -->
<g id="edge1726" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M5782.16,-5872.22C5650.49,-5862.65 5495.55,-5852.03 5355.42,-5844.04 4989,-5823.16 4892.7,-5866.83 4530.42,-5808.04 4347.47,-5778.35 4129.42,-5878.89 4129.42,-5693.54 4129.42,-5693.54 4129.42,-5693.54 4129.42,-5391.61 4129.42,-5340.77 4129.42,-5283.11 4129.42,-5240.54"/>
<polygon fill="black" stroke="black" points="4132.92,-5240.33 4129.42,-5230.33 4125.92,-5240.33 4132.92,-5240.33"/>
</g>
<!-- ResAttn_s1_l12_tp3 -->
<g id="node1040" class="node">
<title>ResAttn_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="7560.77,-5230.13 7003.45,-5230.13 6860.08,-5124.13 7417.4,-5124.13 7560.77,-5230.13"/>
<text text-anchor="middle" x="7210.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7210.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7210.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp3 -->
<g id="edge1728" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6333.07,-5867.29C6412.88,-5858.59 6502.39,-5849.82 6584.42,-5844.04 6641.48,-5840.02 7564.21,-5837.2 7613.42,-5808.04 7664.34,-5777.87 7681.42,-5752.73 7681.42,-5693.54 7681.42,-5693.54 7681.42,-5693.54 7681.42,-5391.61 7681.42,-5315.14 7629.28,-5265.93 7559.7,-5234.29"/>
<polygon fill="black" stroke="black" points="7560.79,-5230.95 7550.22,-5230.14 7557.98,-5237.36 7560.79,-5230.95"/>
</g>
<!-- ResAttn_s1_l12_tp4 -->
<g id="node1041" class="node">
<title>ResAttn_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="8425.77,-5230.13 7868.45,-5230.13 7725.08,-5124.13 8282.4,-5124.13 8425.77,-5230.13"/>
<text text-anchor="middle" x="8075.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8075.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8075.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp4 -->
<g id="edge1730" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6333.07,-5867.23C6412.88,-5858.52 6502.39,-5849.76 6584.42,-5844.04 6750.53,-5832.45 8075.42,-5860.05 8075.42,-5693.54 8075.42,-5693.54 8075.42,-5693.54 8075.42,-5391.61 8075.42,-5340.77 8075.42,-5283.11 8075.42,-5240.54"/>
<polygon fill="black" stroke="black" points="8078.92,-5240.33 8075.42,-5230.33 8071.92,-5240.33 8078.92,-5240.33"/>
</g>
<!-- ResAttn_s1_l12_tp5 -->
<g id="node1042" class="node">
<title>ResAttn_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="2490.77,-5230.13 1933.45,-5230.13 1790.08,-5124.13 2347.4,-5124.13 2490.77,-5230.13"/>
<text text-anchor="middle" x="2140.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2140.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2140.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp5 -->
<g id="edge1732" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M5779.52,-5870.36C5648.46,-5860.59 5494.67,-5850.31 5355.42,-5844.04 4950.64,-5825.81 3935.29,-5851.38 3532.42,-5808.04 3270.74,-5779.89 2951.42,-5956.73 2951.42,-5693.54 2951.42,-5693.54 2951.42,-5693.54 2951.42,-5391.61 2951.42,-5285.81 2690.02,-5231.33 2464.03,-5204.01"/>
<polygon fill="black" stroke="black" points="2464.32,-5200.52 2453.98,-5202.8 2463.49,-5207.47 2464.32,-5200.52"/>
</g>
<!-- ResAttn_s1_l12_tp6 -->
<g id="node1043" class="node">
<title>ResAttn_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="10487.77,-5230.13 9930.45,-5230.13 9787.08,-5124.13 10344.4,-5124.13 10487.77,-5230.13"/>
<text text-anchor="middle" x="10137.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10137.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10137.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp6 -->
<g id="edge1734" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M6332.08,-5866.61C6412.13,-5857.82 6502.03,-5849.17 6584.42,-5844.04 6766.76,-5832.69 9869.42,-5876.23 9869.42,-5693.54 9869.42,-5693.54 9869.42,-5693.54 9869.42,-5391.61 9869.42,-5320.74 9927.47,-5269.6 9989.53,-5235.17"/>
<polygon fill="black" stroke="black" points="9991.58,-5238.04 9998.71,-5230.21 9988.25,-5231.89 9991.58,-5238.04"/>
</g>
<!-- ResAttn_s1_l12_tp7 -->
<g id="node1044" class="node">
<title>ResAttn_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="9476.77,-5230.13 8919.45,-5230.13 8776.08,-5124.13 9333.4,-5124.13 9476.77,-5230.13"/>
<text text-anchor="middle" x="9126.42" y="-5188.43" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9126.42" y="-5173.43" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9126.42" y="-5158.43" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp7 -->
<g id="edge1736" class="edge">
<title>ResMOE_s1_l11_tp0&#45;&gt;ResAttn_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M6332.74,-5867C6412.62,-5858.26 6502.27,-5849.55 6584.42,-5844.04 6721.54,-5834.85 9053.42,-5830.96 9053.42,-5693.54 9053.42,-5693.54 9053.42,-5693.54 9053.42,-5391.61 9053.42,-5338.26 9074.09,-5281.25 9093.42,-5239.58"/>
<polygon fill="black" stroke="black" points="9096.66,-5240.93 9097.78,-5230.4 9090.33,-5237.93 9096.66,-5240.93"/>
</g>
<!-- SplitHeads_s1_l12_tp0 -->
<g id="node1011" class="node">
<title>SplitHeads_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5313.42,-5719.04 4941.42,-5719.04 4941.42,-5666.04 5313.42,-5666.04 5313.42,-5719.04"/>
<text text-anchor="middle" x="5127.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5127.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5127.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp0&#45;&gt;SplitHeads_s1_l12_tp0 -->
<g id="edge1681" class="edge">
<title>QKV_s1_l12_tp0&#45;&gt;SplitHeads_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5139.41,-5754.91C5137.84,-5746.84 5136.07,-5737.78 5134.38,-5729.14"/>
<polygon fill="black" stroke="black" points="5137.81,-5728.43 5132.45,-5719.29 5130.94,-5729.78 5137.81,-5728.43"/>
</g>
<!-- SplitHeads_s1_l12_tp1 -->
<g id="node1012" class="node">
<title>SplitHeads_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="5703.42,-5719.04 5331.42,-5719.04 5331.42,-5666.04 5703.42,-5666.04 5703.42,-5719.04"/>
<text text-anchor="middle" x="5517.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5517.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5517.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp1&#45;&gt;SplitHeads_s1_l12_tp1 -->
<g id="edge1682" class="edge">
<title>QKV_s1_l12_tp1&#45;&gt;SplitHeads_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5529.41,-5754.91C5527.84,-5746.84 5526.07,-5737.78 5524.38,-5729.14"/>
<polygon fill="black" stroke="black" points="5527.81,-5728.43 5522.45,-5719.29 5520.94,-5729.78 5527.81,-5728.43"/>
</g>
<!-- SplitHeads_s1_l12_tp2 -->
<g id="node1013" class="node">
<title>SplitHeads_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="6093.42,-5719.04 5721.42,-5719.04 5721.42,-5666.04 6093.42,-5666.04 6093.42,-5719.04"/>
<text text-anchor="middle" x="5907.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5907.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5907.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp2&#45;&gt;SplitHeads_s1_l12_tp2 -->
<g id="edge1683" class="edge">
<title>QKV_s1_l12_tp2&#45;&gt;SplitHeads_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M5913.07,-5754.91C5912.33,-5746.93 5911.51,-5737.97 5910.72,-5729.42"/>
<polygon fill="black" stroke="black" points="5914.19,-5728.93 5909.79,-5719.29 5907.22,-5729.57 5914.19,-5728.93"/>
</g>
<!-- SplitHeads_s1_l12_tp3 -->
<g id="node1014" class="node">
<title>SplitHeads_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6483.42,-5719.04 6111.42,-5719.04 6111.42,-5666.04 6483.42,-5666.04 6483.42,-5719.04"/>
<text text-anchor="middle" x="6297.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6297.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6297.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp3&#45;&gt;SplitHeads_s1_l12_tp3 -->
<g id="edge1684" class="edge">
<title>QKV_s1_l12_tp3&#45;&gt;SplitHeads_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6285.43,-5754.91C6287.01,-5746.84 6288.78,-5737.78 6290.47,-5729.14"/>
<polygon fill="black" stroke="black" points="6293.91,-5729.78 6292.39,-5719.29 6287.04,-5728.43 6293.91,-5729.78"/>
</g>
<!-- SplitHeads_s1_l12_tp4 -->
<g id="node1015" class="node">
<title>SplitHeads_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="6873.42,-5719.04 6501.42,-5719.04 6501.42,-5666.04 6873.42,-5666.04 6873.42,-5719.04"/>
<text text-anchor="middle" x="6687.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6687.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6687.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp4&#45;&gt;SplitHeads_s1_l12_tp4 -->
<g id="edge1685" class="edge">
<title>QKV_s1_l12_tp4&#45;&gt;SplitHeads_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6669.08,-5754.91C6671.49,-5746.84 6674.2,-5737.78 6676.78,-5729.14"/>
<polygon fill="black" stroke="black" points="6680.22,-5729.87 6679.73,-5719.29 6673.51,-5727.87 6680.22,-5729.87"/>
</g>
<!-- SplitHeads_s1_l12_tp5 -->
<g id="node1016" class="node">
<title>SplitHeads_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="7263.42,-5719.04 6891.42,-5719.04 6891.42,-5666.04 7263.42,-5666.04 7263.42,-5719.04"/>
<text text-anchor="middle" x="7077.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7077.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7077.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp5&#45;&gt;SplitHeads_s1_l12_tp5 -->
<g id="edge1686" class="edge">
<title>QKV_s1_l12_tp5&#45;&gt;SplitHeads_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M7056.26,-5754.91C7059.07,-5746.75 7062.24,-5737.58 7065.24,-5728.86"/>
<polygon fill="black" stroke="black" points="7068.59,-5729.88 7068.54,-5719.29 7061.97,-5727.6 7068.59,-5729.88"/>
</g>
<!-- SplitHeads_s1_l12_tp6 -->
<g id="node1017" class="node">
<title>SplitHeads_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="7653.42,-5719.04 7281.42,-5719.04 7281.42,-5666.04 7653.42,-5666.04 7653.42,-5719.04"/>
<text text-anchor="middle" x="7467.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7467.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7467.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp6&#45;&gt;SplitHeads_s1_l12_tp6 -->
<g id="edge1687" class="edge">
<title>QKV_s1_l12_tp6&#45;&gt;SplitHeads_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M7444.85,-5754.91C7447.85,-5746.75 7451.22,-5737.58 7454.43,-5728.86"/>
<polygon fill="black" stroke="black" points="7457.78,-5729.88 7457.95,-5719.29 7451.21,-5727.47 7457.78,-5729.88"/>
</g>
<!-- SplitHeads_s1_l12_tp7 -->
<g id="node1018" class="node">
<title>SplitHeads_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="4923.42,-5719.04 4551.42,-5719.04 4551.42,-5666.04 4923.42,-5666.04 4923.42,-5719.04"/>
<text text-anchor="middle" x="4737.42" y="-5703.84" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4737.42" y="-5688.84" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4737.42" y="-5673.84" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l12_tp7&#45;&gt;SplitHeads_s1_l12_tp7 -->
<g id="edge1688" class="edge">
<title>QKV_s1_l12_tp7&#45;&gt;SplitHeads_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M4755.06,-5754.91C4752.74,-5746.84 4750.13,-5737.78 4747.65,-5729.14"/>
<polygon fill="black" stroke="black" points="4750.95,-5727.93 4744.82,-5719.29 4744.22,-5729.87 4750.95,-5727.93"/>
</g>
<!-- A2A_s1_l12 -->
<g id="node1019" class="node">
<title>A2A_s1_l12</title>
<ellipse fill="none" stroke="black" cx="6102.42" cy="-5592.56" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6102.42" y="-5603.86" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="6102.42" y="-5588.86" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6102.42" y="-5573.86" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l12_tp0&#45;&gt;A2A_s1_l12 -->
<g id="edge1689" class="edge">
<title>SplitHeads_s1_l12_tp0&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M5313.45,-5667.06C5316.46,-5666.71 5319.45,-5666.37 5322.42,-5666.04 5505.43,-5645.58 5713.05,-5626.49 5868.05,-5613.04"/>
<polygon fill="black" stroke="black" points="5868.53,-5616.51 5878.19,-5612.16 5867.92,-5609.54 5868.53,-5616.51"/>
</g>
<!-- SplitHeads_s1_l12_tp1&#45;&gt;A2A_s1_l12 -->
<g id="edge1690" class="edge">
<title>SplitHeads_s1_l12_tp1&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M5669.98,-5665.99C5748.22,-5652.89 5843.93,-5636.86 5925.41,-5623.21"/>
<polygon fill="black" stroke="black" points="5925.99,-5626.66 5935.27,-5621.56 5924.83,-5619.76 5925.99,-5626.66"/>
</g>
<!-- SplitHeads_s1_l12_tp2&#45;&gt;A2A_s1_l12 -->
<g id="edge1691" class="edge">
<title>SplitHeads_s1_l12_tp2&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M5958.4,-5665.93C5978.24,-5655.96 6001.43,-5644.31 6023.33,-5633.3"/>
<polygon fill="black" stroke="black" points="6024.94,-5636.41 6032.3,-5628.79 6021.8,-5630.16 6024.94,-5636.41"/>
</g>
<!-- SplitHeads_s1_l12_tp3&#45;&gt;A2A_s1_l12 -->
<g id="edge1692" class="edge">
<title>SplitHeads_s1_l12_tp3&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M6246.44,-5665.93C6226.61,-5655.96 6203.42,-5644.31 6181.51,-5633.3"/>
<polygon fill="black" stroke="black" points="6183.05,-5630.16 6172.54,-5628.79 6179.91,-5636.41 6183.05,-5630.16"/>
</g>
<!-- SplitHeads_s1_l12_tp4&#45;&gt;A2A_s1_l12 -->
<g id="edge1693" class="edge">
<title>SplitHeads_s1_l12_tp4&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M6534.87,-5665.99C6456.63,-5652.89 6360.91,-5636.86 6279.44,-5623.21"/>
<polygon fill="black" stroke="black" points="6280.02,-5619.76 6269.58,-5621.56 6278.86,-5626.66 6280.02,-5619.76"/>
</g>
<!-- SplitHeads_s1_l12_tp5&#45;&gt;A2A_s1_l12 -->
<g id="edge1694" class="edge">
<title>SplitHeads_s1_l12_tp5&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M6891.4,-5667.06C6888.39,-5666.71 6885.39,-5666.37 6882.42,-5666.04 6699.42,-5645.58 6491.79,-5626.49 6336.79,-5613.04"/>
<polygon fill="black" stroke="black" points="6336.92,-5609.54 6326.66,-5612.16 6336.32,-5616.51 6336.92,-5609.54"/>
</g>
<!-- SplitHeads_s1_l12_tp6&#45;&gt;A2A_s1_l12 -->
<g id="edge1695" class="edge">
<title>SplitHeads_s1_l12_tp6&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M7281.41,-5666.93C7278.39,-5666.62 7275.4,-5666.33 7272.42,-5666.04 6960.38,-5636.01 6600.25,-5615.88 6362.88,-5604.6"/>
<polygon fill="black" stroke="black" points="6362.88,-5601.1 6352.73,-5604.12 6362.55,-5608.09 6362.88,-5601.1"/>
</g>
<!-- SplitHeads_s1_l12_tp7&#45;&gt;A2A_s1_l12 -->
<g id="edge1696" class="edge">
<title>SplitHeads_s1_l12_tp7&#45;&gt;A2A_s1_l12</title>
<path fill="none" stroke="black" d="M4923.43,-5666.93C4926.45,-5666.62 4929.45,-5666.33 4932.42,-5666.04 5244.47,-5636.01 5604.6,-5615.88 5841.96,-5604.6"/>
<polygon fill="black" stroke="black" points="5842.29,-5608.09 5852.12,-5604.12 5841.96,-5601.1 5842.29,-5608.09"/>
</g>
<!-- Attn_s1_l12_tp0 -->
<g id="node1020" class="node">
<title>Attn_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5313.42,-5519.09 4941.42,-5519.09 4941.42,-5466.09 5313.42,-5466.09 5313.42,-5519.09"/>
<text text-anchor="middle" x="5127.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5127.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5127.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp0 -->
<g id="edge1697" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5878.19,-5572.96C5724.85,-5559.71 5516.7,-5540.66 5323.51,-5519.19"/>
<polygon fill="black" stroke="black" points="5323.77,-5515.7 5313.45,-5518.07 5323,-5522.66 5323.77,-5515.7"/>
</g>
<!-- Attn_s1_l12_tp1 -->
<g id="node1021" class="node">
<title>Attn_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="5703.42,-5519.09 5331.42,-5519.09 5331.42,-5466.09 5703.42,-5466.09 5703.42,-5519.09"/>
<text text-anchor="middle" x="5517.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5517.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5517.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp1 -->
<g id="edge1698" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5935.18,-5563.55C5855.03,-5550.13 5759.42,-5534.12 5679.9,-5520.8"/>
<polygon fill="black" stroke="black" points="5680.23,-5517.3 5669.79,-5519.1 5679.07,-5524.21 5680.23,-5517.3"/>
</g>
<!-- Attn_s1_l12_tp2 -->
<g id="node1022" class="node">
<title>Attn_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="6093.42,-5519.09 5721.42,-5519.09 5721.42,-5466.09 6093.42,-5466.09 6093.42,-5519.09"/>
<text text-anchor="middle" x="5907.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5907.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5907.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp2 -->
<g id="edge1699" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M6032.3,-5556.33C6010.99,-5545.63 5987.79,-5533.97 5967.23,-5523.64"/>
<polygon fill="black" stroke="black" points="5968.8,-5520.51 5958.29,-5519.14 5965.65,-5526.76 5968.8,-5520.51"/>
</g>
<!-- Attn_s1_l12_tp3 -->
<g id="node1023" class="node">
<title>Attn_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6483.42,-5519.09 6111.42,-5519.09 6111.42,-5466.09 6483.42,-5466.09 6483.42,-5519.09"/>
<text text-anchor="middle" x="6297.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6297.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6297.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp3 -->
<g id="edge1700" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6172.55,-5556.33C6193.85,-5545.63 6217.06,-5533.97 6237.62,-5523.64"/>
<polygon fill="black" stroke="black" points="6239.19,-5526.76 6246.55,-5519.14 6236.05,-5520.51 6239.19,-5526.76"/>
</g>
<!-- Attn_s1_l12_tp4 -->
<g id="node1024" class="node">
<title>Attn_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="6873.42,-5519.09 6501.42,-5519.09 6501.42,-5466.09 6873.42,-5466.09 6873.42,-5519.09"/>
<text text-anchor="middle" x="6687.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6687.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6687.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp4 -->
<g id="edge1701" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6269.67,-5563.55C6349.81,-5550.13 6445.43,-5534.12 6524.95,-5520.8"/>
<polygon fill="black" stroke="black" points="6525.77,-5524.21 6535.06,-5519.1 6524.62,-5517.3 6525.77,-5524.21"/>
</g>
<!-- Attn_s1_l12_tp5 -->
<g id="node1025" class="node">
<title>Attn_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="7263.42,-5519.09 6891.42,-5519.09 6891.42,-5466.09 7263.42,-5466.09 7263.42,-5519.09"/>
<text text-anchor="middle" x="7077.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7077.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7077.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp5 -->
<g id="edge1702" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M6326.66,-5572.96C6480,-5559.71 6688.14,-5540.66 6881.34,-5519.19"/>
<polygon fill="black" stroke="black" points="6881.85,-5522.66 6891.4,-5518.07 6881.07,-5515.7 6881.85,-5522.66"/>
</g>
<!-- Attn_s1_l12_tp6 -->
<g id="node1026" class="node">
<title>Attn_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="7653.42,-5519.09 7281.42,-5519.09 7281.42,-5466.09 7653.42,-5466.09 7653.42,-5519.09"/>
<text text-anchor="middle" x="7467.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7467.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7467.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp6 -->
<g id="edge1703" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M6352.73,-5581C6587.46,-5569.94 6948.4,-5549.97 7271.39,-5519.16"/>
<polygon fill="black" stroke="black" points="7271.79,-5522.64 7281.41,-5518.2 7271.12,-5515.67 7271.79,-5522.64"/>
</g>
<!-- Attn_s1_l12_tp7 -->
<g id="node1027" class="node">
<title>Attn_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="4923.42,-5519.09 4551.42,-5519.09 4551.42,-5466.09 4923.42,-5466.09 4923.42,-5519.09"/>
<text text-anchor="middle" x="4737.42" y="-5503.89" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4737.42" y="-5488.89" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4737.42" y="-5473.89" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l12&#45;&gt;Attn_s1_l12_tp7 -->
<g id="edge1704" class="edge">
<title>A2A_s1_l12&#45;&gt;Attn_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M5852.12,-5581C5617.38,-5569.94 5256.44,-5549.97 4933.46,-5519.16"/>
<polygon fill="black" stroke="black" points="4933.72,-5515.67 4923.43,-5518.2 4933.05,-5522.64 4933.72,-5515.67"/>
</g>
<!-- AR_attn_s1_l12 -->
<g id="node1028" class="node">
<title>AR_attn_s1_l12</title>
<ellipse fill="none" stroke="black" cx="6102.42" cy="-5392.61" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="6102.42" y="-5403.91" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="6102.42" y="-5388.91" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6102.42" y="-5373.91" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l12_tp0&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1705" class="edge">
<title>Attn_s1_l12_tp0&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M5313.45,-5467.1C5316.46,-5466.76 5319.45,-5466.42 5322.42,-5466.09 5505.43,-5445.63 5713.05,-5426.53 5868.05,-5413.09"/>
<polygon fill="black" stroke="black" points="5868.53,-5416.56 5878.19,-5412.21 5867.92,-5409.58 5868.53,-5416.56"/>
</g>
<!-- Attn_s1_l12_tp1&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1706" class="edge">
<title>Attn_s1_l12_tp1&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M5669.98,-5466.04C5748.22,-5452.93 5843.93,-5436.9 5925.41,-5423.26"/>
<polygon fill="black" stroke="black" points="5925.99,-5426.71 5935.27,-5421.6 5924.83,-5419.8 5925.99,-5426.71"/>
</g>
<!-- Attn_s1_l12_tp2&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1707" class="edge">
<title>Attn_s1_l12_tp2&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M5958.4,-5465.97C5978.24,-5456.01 6001.43,-5444.35 6023.33,-5433.35"/>
<polygon fill="black" stroke="black" points="6024.94,-5436.46 6032.3,-5428.84 6021.8,-5430.2 6024.94,-5436.46"/>
</g>
<!-- Attn_s1_l12_tp3&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1708" class="edge">
<title>Attn_s1_l12_tp3&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M6246.44,-5465.97C6226.61,-5456.01 6203.42,-5444.35 6181.51,-5433.35"/>
<polygon fill="black" stroke="black" points="6183.05,-5430.2 6172.54,-5428.84 6179.91,-5436.46 6183.05,-5430.2"/>
</g>
<!-- Attn_s1_l12_tp4&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1709" class="edge">
<title>Attn_s1_l12_tp4&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M6534.87,-5466.04C6456.63,-5452.93 6360.91,-5436.9 6279.44,-5423.26"/>
<polygon fill="black" stroke="black" points="6280.02,-5419.8 6269.58,-5421.6 6278.86,-5426.71 6280.02,-5419.8"/>
</g>
<!-- Attn_s1_l12_tp5&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1710" class="edge">
<title>Attn_s1_l12_tp5&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M6891.4,-5467.1C6888.39,-5466.76 6885.39,-5466.42 6882.42,-5466.09 6699.42,-5445.63 6491.79,-5426.53 6336.79,-5413.09"/>
<polygon fill="black" stroke="black" points="6336.92,-5409.58 6326.66,-5412.21 6336.32,-5416.56 6336.92,-5409.58"/>
</g>
<!-- Attn_s1_l12_tp6&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1711" class="edge">
<title>Attn_s1_l12_tp6&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M7281.41,-5466.97C7278.39,-5466.67 7275.4,-5466.37 7272.42,-5466.09 6960.38,-5436.05 6600.25,-5415.92 6362.88,-5404.65"/>
<polygon fill="black" stroke="black" points="6362.88,-5401.15 6352.73,-5404.17 6362.55,-5408.14 6362.88,-5401.15"/>
</g>
<!-- Attn_s1_l12_tp7&#45;&gt;AR_attn_s1_l12 -->
<g id="edge1712" class="edge">
<title>Attn_s1_l12_tp7&#45;&gt;AR_attn_s1_l12</title>
<path fill="none" stroke="black" d="M4923.43,-5466.97C4926.45,-5466.67 4929.45,-5466.37 4932.42,-5466.09 5244.47,-5436.05 5604.6,-5415.92 5841.96,-5404.65"/>
<polygon fill="black" stroke="black" points="5842.29,-5408.14 5852.12,-5404.17 5841.96,-5401.15 5842.29,-5408.14"/>
</g>
<!-- O_s1_l12_tp0 -->
<g id="node1029" class="node">
<title>O_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5937.42,-5319.13 5599.42,-5319.13 5599.42,-5266.13 5937.42,-5266.13 5937.42,-5319.13"/>
<text text-anchor="middle" x="5768.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5768.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5768.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp0 -->
<g id="edge1713" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5989.81,-5358.58C5949.39,-5346.72 5904.21,-5333.46 5865.25,-5322.04"/>
<polygon fill="black" stroke="black" points="5866.06,-5318.63 5855.48,-5319.17 5864.09,-5325.35 5866.06,-5318.63"/>
</g>
<!-- O_s1_l12_tp1 -->
<g id="node1030" class="node">
<title>O_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="4495.42,-5319.13 4157.42,-5319.13 4157.42,-5266.13 4495.42,-5266.13 4495.42,-5319.13"/>
<text text-anchor="middle" x="4326.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4326.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4326.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp1 -->
<g id="edge1714" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5859.2,-5378.19C5497.61,-5358.24 4826.57,-5321.22 4505.98,-5303.54"/>
<polygon fill="black" stroke="black" points="4505.84,-5300.03 4495.67,-5302.97 4505.46,-5307.02 4505.84,-5300.03"/>
</g>
<!-- O_s1_l12_tp2 -->
<g id="node1031" class="node">
<title>O_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="5235.42,-5319.13 4897.42,-5319.13 4897.42,-5266.13 5235.42,-5266.13 5235.42,-5319.13"/>
<text text-anchor="middle" x="5066.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5066.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5066.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp2 -->
<g id="edge1715" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M5886.5,-5371.19C5696.62,-5353.23 5423.5,-5327.4 5245.52,-5310.57"/>
<polygon fill="black" stroke="black" points="5245.81,-5307.08 5235.53,-5309.63 5245.15,-5314.05 5245.81,-5307.08"/>
</g>
<!-- O_s1_l12_tp3 -->
<g id="node1032" class="node">
<title>O_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6795.42,-5319.13 6457.42,-5319.13 6457.42,-5266.13 6795.42,-5266.13 6795.42,-5319.13"/>
<text text-anchor="middle" x="6626.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6626.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6626.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp3 -->
<g id="edge1716" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6258.58,-5362.41C6328.58,-5349.32 6410.7,-5333.97 6479.57,-5321.09"/>
<polygon fill="black" stroke="black" points="6480.45,-5324.49 6489.63,-5319.21 6479.16,-5317.61 6480.45,-5324.49"/>
</g>
<!-- O_s1_l12_tp4 -->
<g id="node1033" class="node">
<title>O_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="7486.42,-5319.13 7148.42,-5319.13 7148.42,-5266.13 7486.42,-5266.13 7486.42,-5319.13"/>
<text text-anchor="middle" x="7317.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7317.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7317.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp4 -->
<g id="edge1717" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6328.46,-5373.38C6562.42,-5354.52 6923.15,-5325.43 7138.19,-5308.09"/>
<polygon fill="black" stroke="black" points="7138.63,-5311.56 7148.32,-5307.27 7138.07,-5304.58 7138.63,-5311.56"/>
</g>
<!-- O_s1_l12_tp5 -->
<g id="node1034" class="node">
<title>O_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="4020.42,-5319.13 3682.42,-5319.13 3682.42,-5266.13 4020.42,-5266.13 4020.42,-5319.13"/>
<text text-anchor="middle" x="3851.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3851.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3851.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp5 -->
<g id="edge1718" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M5843.44,-5386.01C5469.1,-5377 4755.14,-5356.41 4148.42,-5319.13 4110.37,-5316.8 4069.62,-5313.69 4030.89,-5310.46"/>
<polygon fill="black" stroke="black" points="4030.81,-5306.94 4020.55,-5309.59 4030.22,-5313.91 4030.81,-5306.94"/>
</g>
<!-- O_s1_l12_tp6 -->
<g id="node1035" class="node">
<title>O_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="8830.42,-5319.13 8492.42,-5319.13 8492.42,-5266.13 8830.42,-5266.13 8830.42,-5319.13"/>
<text text-anchor="middle" x="8661.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8661.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8661.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp6 -->
<g id="edge1719" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M6356.16,-5382.61C6728.87,-5369.29 7446.28,-5343.31 8056.42,-5319.13 8199.59,-5313.46 8361.8,-5306.6 8482.19,-5301.42"/>
<polygon fill="black" stroke="black" points="8482.41,-5304.92 8492.25,-5300.99 8482.11,-5297.93 8482.41,-5304.92"/>
</g>
<!-- O_s1_l12_tp7 -->
<g id="node1036" class="node">
<title>O_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="8047.42,-5319.13 7709.42,-5319.13 7709.42,-5266.13 8047.42,-5266.13 8047.42,-5319.13"/>
<text text-anchor="middle" x="7878.42" y="-5303.93" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7878.42" y="-5288.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="7878.42" y="-5273.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l12&#45;&gt;O_s1_l12_tp7 -->
<g id="edge1720" class="edge">
<title>AR_attn_s1_l12&#45;&gt;O_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M6349.71,-5379.83C6628.25,-5366.3 7094.43,-5342.91 7495.42,-5319.13 7561.88,-5315.19 7634.8,-5310.44 7699.01,-5306.12"/>
<polygon fill="black" stroke="black" points="7699.5,-5309.59 7709.24,-5305.43 7699.03,-5302.61 7699.5,-5309.59"/>
</g>
<!-- O_s1_l12_tp0&#45;&gt;ResAttn_s1_l12_tp0 -->
<g id="edge1721" class="edge">
<title>O_s1_l12_tp0&#45;&gt;ResAttn_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5599.26,-5266.8C5527.24,-5256.22 5440.31,-5243.46 5355.12,-5230.95"/>
<polygon fill="black" stroke="black" points="5355.41,-5227.45 5345.01,-5229.46 5354.4,-5234.38 5355.41,-5227.45"/>
</g>
<!-- O_s1_l12_tp1&#45;&gt;ResAttn_s1_l12_tp1 -->
<g id="edge1723" class="edge">
<title>O_s1_l12_tp1&#45;&gt;ResAttn_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M4157.36,-5273.27C4012.58,-5257.55 3799.64,-5234.42 3619.97,-5214.9"/>
<polygon fill="black" stroke="black" points="3620.14,-5211.4 3609.82,-5213.8 3619.38,-5218.36 3620.14,-5211.4"/>
</g>
<!-- O_s1_l12_tp2&#45;&gt;ResAttn_s1_l12_tp2 -->
<g id="edge1725" class="edge">
<title>O_s1_l12_tp2&#45;&gt;ResAttn_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M4897.28,-5271.14C4779.78,-5256.91 4619.06,-5237.44 4475.01,-5219.99"/>
<polygon fill="black" stroke="black" points="4475.02,-5216.47 4464.67,-5218.74 4474.18,-5223.42 4475.02,-5216.47"/>
</g>
<!-- O_s1_l12_tp3&#45;&gt;ResAttn_s1_l12_tp3 -->
<g id="edge1727" class="edge">
<title>O_s1_l12_tp3&#45;&gt;ResAttn_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6757.85,-5266.09C6823.52,-5253.33 6904.91,-5237.51 6980.49,-5222.82"/>
<polygon fill="black" stroke="black" points="6981.48,-5226.19 6990.63,-5220.85 6980.14,-5219.32 6981.48,-5226.19"/>
</g>
<!-- O_s1_l12_tp4&#45;&gt;ResAttn_s1_l12_tp4 -->
<g id="edge1729" class="edge">
<title>O_s1_l12_tp4&#45;&gt;ResAttn_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M7486.59,-5266.3C7588.98,-5250.97 7721.21,-5231.17 7834.42,-5214.22"/>
<polygon fill="black" stroke="black" points="7835.24,-5217.64 7844.61,-5212.69 7834.2,-5210.71 7835.24,-5217.64"/>
</g>
<!-- O_s1_l12_tp5&#45;&gt;ResAttn_s1_l12_tp5 -->
<g id="edge1731" class="edge">
<title>O_s1_l12_tp5&#45;&gt;ResAttn_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M3682.32,-5280.45C3496.14,-5268.14 3187.93,-5247.75 2922.42,-5230.13 2769.79,-5220.01 2600.39,-5208.74 2458.4,-5199.3"/>
<polygon fill="black" stroke="black" points="2458.43,-5195.79 2448.22,-5198.62 2457.97,-5202.78 2458.43,-5195.79"/>
</g>
<!-- O_s1_l12_tp6&#45;&gt;ResAttn_s1_l12_tp6 -->
<g id="edge1733" class="edge">
<title>O_s1_l12_tp6&#45;&gt;ResAttn_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M8830.7,-5279.25C8997.29,-5267.01 9258.9,-5247.62 9485.42,-5230.13 9614.54,-5220.17 9758.01,-5208.76 9877.42,-5199.17"/>
<polygon fill="black" stroke="black" points="9877.75,-5202.66 9887.44,-5198.37 9877.19,-5195.68 9877.75,-5202.66"/>
</g>
<!-- O_s1_l12_tp7&#45;&gt;ResAttn_s1_l12_tp7 -->
<g id="edge1735" class="edge">
<title>O_s1_l12_tp7&#45;&gt;ResAttn_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M8047.71,-5276.24C8259.2,-5257 8623.16,-5223.9 8869.19,-5201.53"/>
<polygon fill="black" stroke="black" points="8869.72,-5204.99 8879.36,-5200.6 8869.08,-5198.02 8869.72,-5204.99"/>
</g>
<!-- Gate_s1_l12_tp0 -->
<g id="node1045" class="node">
<title>Gate_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5456.42,-5088.13 5118.42,-5088.13 5118.42,-5035.13 5456.42,-5035.13 5456.42,-5088.13"/>
<text text-anchor="middle" x="5287.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5287.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5287.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp0&#45;&gt;Gate_s1_l12_tp0 -->
<g id="edge1737" class="edge">
<title>ResAttn_s1_l12_tp0&#45;&gt;Gate_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M5129.46,-5124.03C5157.91,-5112.98 5186.97,-5101.68 5212.28,-5091.84"/>
<polygon fill="black" stroke="black" points="5213.73,-5095.03 5221.78,-5088.15 5211.2,-5088.51 5213.73,-5095.03"/>
</g>
<!-- ResMOE_s1_l12_tp0 -->
<g id="node1086" class="node">
<title>ResMOE_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="6230.77,-4799.18 5673.45,-4799.18 5530.08,-4693.18 6087.4,-4693.18 6230.77,-4799.18"/>
<text text-anchor="middle" x="5880.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5880.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5880.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp0&#45;&gt;ResMOE_s1_l12_tp0 -->
<g id="edge1810" class="edge">
<title>ResAttn_s1_l12_tp0&#45;&gt;ResMOE_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M4663.39,-5137.75C4605.15,-5132.26 4545.07,-5127.38 4488.42,-5124.13 3830.56,-5086.48 2180.48,-5137.82 1523.42,-5088.13 1238.38,-5066.58 1074.05,-5214.8 886.42,-4999.13 870.96,-4981.36 870.06,-4963.07 886.42,-4946.13 1050.76,-4776.02 4905.22,-4811.57 5141.42,-4799.18 5300.25,-4790.85 5478.06,-4778.44 5619.46,-4767.83"/>
<polygon fill="black" stroke="black" points="5619.87,-4771.31 5629.58,-4767.06 5619.35,-4764.32 5619.87,-4771.31"/>
</g>
<!-- Gate_s1_l12_tp1 -->
<g id="node1046" class="node">
<title>Gate_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="3174.42,-5088.13 2836.42,-5088.13 2836.42,-5035.13 3174.42,-5035.13 3174.42,-5088.13"/>
<text text-anchor="middle" x="3005.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3005.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3005.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp1&#45;&gt;Gate_s1_l12_tp1 -->
<g id="edge1738" class="edge">
<title>ResAttn_s1_l12_tp1&#45;&gt;Gate_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M3154.73,-5124.03C3127.96,-5113.02 3100.62,-5101.78 3076.77,-5091.97"/>
<polygon fill="black" stroke="black" points="3078.04,-5088.71 3067.46,-5088.15 3075.38,-5095.19 3078.04,-5088.71"/>
</g>
<!-- ResMOE_s1_l12_tp1 -->
<g id="node1087" class="node">
<title>ResMOE_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="3656.77,-4799.18 3099.45,-4799.18 2956.08,-4693.18 3513.4,-4693.18 3656.77,-4799.18"/>
<text text-anchor="middle" x="3306.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3306.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3306.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp1&#45;&gt;ResMOE_s1_l12_tp1 -->
<g id="edge1812" class="edge">
<title>ResAttn_s1_l12_tp1&#45;&gt;ResMOE_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M2968.62,-5152.1C2825.65,-5141.95 2654.05,-5130.92 2499.42,-5124.13 2452.68,-5122.08 848.15,-5121.57 815.42,-5088.13 776.1,-5047.96 776.38,-4875.62 815.42,-4835.18 834.44,-4815.48 2382.01,-4771.88 3028.01,-4754.52"/>
<polygon fill="black" stroke="black" points="3028.49,-4758.01 3038.4,-4754.24 3028.31,-4751.01 3028.49,-4758.01"/>
</g>
<!-- Gate_s1_l12_tp2 -->
<g id="node1047" class="node">
<title>Gate_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="4298.42,-5088.13 3960.42,-5088.13 3960.42,-5035.13 4298.42,-5035.13 4298.42,-5088.13"/>
<text text-anchor="middle" x="4129.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4129.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4129.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp2&#45;&gt;Gate_s1_l12_tp2 -->
<g id="edge1739" class="edge">
<title>ResAttn_s1_l12_tp2&#45;&gt;Gate_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M4129.42,-5124.03C4129.42,-5115.36 4129.42,-5106.55 4129.42,-5098.4"/>
<polygon fill="black" stroke="black" points="4132.92,-5098.15 4129.42,-5088.15 4125.92,-5098.15 4132.92,-5098.15"/>
</g>
<!-- ResMOE_s1_l12_tp2 -->
<g id="node1088" class="node">
<title>ResMOE_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="5132.77,-4799.18 4575.45,-4799.18 4432.08,-4693.18 4989.4,-4693.18 5132.77,-4799.18"/>
<text text-anchor="middle" x="4782.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4782.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4782.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp2&#45;&gt;ResMOE_s1_l12_tp2 -->
<g id="edge1814" class="edge">
<title>ResAttn_s1_l12_tp2&#45;&gt;ResMOE_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M3795.7,-5136.46C3743.78,-5131.5 3690.7,-5127.12 3640.42,-5124.13 3601.78,-5121.83 880.62,-5115.68 853.42,-5088.13 813.93,-5048.13 813.93,-4875.18 853.42,-4835.18 880.86,-4807.39 3626.38,-4800.34 3665.42,-4799.18 3955.82,-4790.56 4288.4,-4774.25 4514.62,-4762.19"/>
<polygon fill="black" stroke="black" points="4514.84,-4765.68 4524.64,-4761.65 4514.47,-4758.69 4514.84,-4765.68"/>
</g>
<!-- Gate_s1_l12_tp3 -->
<g id="node1048" class="node">
<title>Gate_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="7086.42,-5088.13 6748.42,-5088.13 6748.42,-5035.13 7086.42,-5035.13 7086.42,-5088.13"/>
<text text-anchor="middle" x="6917.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6917.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6917.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp3&#45;&gt;Gate_s1_l12_tp3 -->
<g id="edge1740" class="edge">
<title>ResAttn_s1_l12_tp3&#45;&gt;Gate_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M7075.93,-5124.03C7047.38,-5112.98 7018.22,-5101.68 6992.83,-5091.84"/>
<polygon fill="black" stroke="black" points="6993.87,-5088.5 6983.29,-5088.15 6991.35,-5095.02 6993.87,-5088.5"/>
</g>
<!-- ResMOE_s1_l12_tp3 -->
<g id="node1089" class="node">
<title>ResMOE_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="7079.77,-4799.18 6522.45,-4799.18 6379.08,-4693.18 6936.4,-4693.18 7079.77,-4799.18"/>
<text text-anchor="middle" x="6729.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6729.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6729.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp3&#45;&gt;ResMOE_s1_l12_tp3 -->
<g id="edge1816" class="edge">
<title>ResAttn_s1_l12_tp3&#45;&gt;ResMOE_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M7448.81,-5147.16C7533.21,-5138.09 7628.92,-5129.15 7716.42,-5124.13 8374.28,-5086.41 10024.36,-5137.82 10681.42,-5088.13 10970.66,-5066.26 11519.04,-5155.63 11318.42,-4946.13 11281.26,-4907.33 8051.82,-4792.77 7033.44,-4757.58"/>
<polygon fill="black" stroke="black" points="7033.53,-4754.08 7023.41,-4757.24 7033.29,-4761.08 7033.53,-4754.08"/>
</g>
<!-- Gate_s1_l12_tp4 -->
<g id="node1049" class="node">
<title>Gate_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="8244.42,-5088.13 7906.42,-5088.13 7906.42,-5035.13 8244.42,-5035.13 8244.42,-5088.13"/>
<text text-anchor="middle" x="8075.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8075.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8075.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp4&#45;&gt;Gate_s1_l12_tp4 -->
<g id="edge1741" class="edge">
<title>ResAttn_s1_l12_tp4&#45;&gt;Gate_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M8075.42,-5124.03C8075.42,-5115.36 8075.42,-5106.55 8075.42,-5098.4"/>
<polygon fill="black" stroke="black" points="8078.92,-5098.15 8075.42,-5088.15 8071.92,-5098.15 8078.92,-5098.15"/>
</g>
<!-- ResMOE_s1_l12_tp4 -->
<g id="node1090" class="node">
<title>ResMOE_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="9116.77,-4799.18 8559.45,-4799.18 8416.08,-4693.18 8973.4,-4693.18 9116.77,-4799.18"/>
<text text-anchor="middle" x="8766.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8766.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8766.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp4&#45;&gt;ResMOE_s1_l12_tp4 -->
<g id="edge1818" class="edge">
<title>ResAttn_s1_l12_tp4&#45;&gt;ResMOE_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M8323.03,-5153.96C8454.87,-5143.06 8619.84,-5130.84 8767.42,-5124.13 9018.97,-5112.69 10784.25,-5124.47 11033.42,-5088.13 11178.23,-5067.02 11262.03,-5115.76 11350.42,-4999.13 11532.3,-4759.17 10305.64,-4858.22 10005.42,-4835.18 9692.75,-4811.18 9335.5,-4786.05 9085.21,-4768.82"/>
<polygon fill="black" stroke="black" points="9085.08,-4765.3 9074.86,-4768.11 9084.6,-4772.29 9085.08,-4765.3"/>
</g>
<!-- Gate_s1_l12_tp5 -->
<g id="node1050" class="node">
<title>Gate_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="1870.42,-5088.13 1532.42,-5088.13 1532.42,-5035.13 1870.42,-5035.13 1870.42,-5088.13"/>
<text text-anchor="middle" x="1701.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1701.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1701.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp5&#45;&gt;Gate_s1_l12_tp5 -->
<g id="edge1742" class="edge">
<title>ResAttn_s1_l12_tp5&#45;&gt;Gate_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M1939.23,-5124.12C1894.73,-5112.61 1849.21,-5100.84 1810.07,-5090.72"/>
<polygon fill="black" stroke="black" points="1810.82,-5087.3 1800.26,-5088.19 1809.07,-5094.08 1810.82,-5087.3"/>
</g>
<!-- ResMOE_s1_l12_tp5 -->
<g id="node1091" class="node">
<title>ResMOE_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="1423.77,-4799.18 866.45,-4799.18 723.08,-4693.18 1280.4,-4693.18 1423.77,-4799.18"/>
<text text-anchor="middle" x="1073.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1073.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1073.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp5&#45;&gt;ResMOE_s1_l12_tp5 -->
<g id="edge1820" class="edge">
<title>ResAttn_s1_l12_tp5&#45;&gt;ResMOE_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M1847.3,-5166.7C1461.23,-5152.88 826.53,-5124.75 789.42,-5088.13 709.38,-5009.16 717.32,-4924.65 785.42,-4835.18 795.9,-4821.42 820.19,-4808.89 850.46,-4797.88"/>
<polygon fill="black" stroke="black" points="851.77,-4801.14 860.04,-4794.52 849.45,-4794.53 851.77,-4801.14"/>
</g>
<!-- Gate_s1_l12_tp6 -->
<g id="node1051" class="node">
<title>Gate_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="10672.42,-5088.13 10334.42,-5088.13 10334.42,-5035.13 10672.42,-5035.13 10672.42,-5088.13"/>
<text text-anchor="middle" x="10503.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10503.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10503.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp6&#45;&gt;Gate_s1_l12_tp6 -->
<g id="edge1743" class="edge">
<title>ResAttn_s1_l12_tp6&#45;&gt;Gate_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M10305.16,-5124.12C10341.63,-5112.81 10378.92,-5101.24 10411.18,-5091.24"/>
<polygon fill="black" stroke="black" points="10412.5,-5094.49 10421.02,-5088.19 10410.43,-5087.81 10412.5,-5094.49"/>
</g>
<!-- ResMOE_s1_l12_tp6 -->
<g id="node1092" class="node">
<title>ResMOE_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="11542.77,-4799.18 10985.45,-4799.18 10842.08,-4693.18 11399.4,-4693.18 11542.77,-4799.18"/>
<text text-anchor="middle" x="11192.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="11192.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11192.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp6&#45;&gt;ResMOE_s1_l12_tp6 -->
<g id="edge1822" class="edge">
<title>ResAttn_s1_l12_tp6&#45;&gt;ResMOE_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M10411.11,-5173.26C10697.66,-5167.03 11126.82,-5147.68 11279.42,-5088.13 11354.56,-5058.81 11423.39,-5020.61 11392.42,-4946.13 11368.93,-4889.62 11320.71,-4840.87 11277.5,-4805.77"/>
<polygon fill="black" stroke="black" points="11279.5,-4802.88 11269.5,-4799.38 11275.13,-4808.35 11279.5,-4802.88"/>
</g>
<!-- Gate_s1_l12_tp7 -->
<g id="node1052" class="node">
<title>Gate_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="9368.42,-5088.13 9030.42,-5088.13 9030.42,-5035.13 9368.42,-5035.13 9368.42,-5088.13"/>
<text text-anchor="middle" x="9199.42" y="-5072.93" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9199.42" y="-5057.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9199.42" y="-5042.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp7&#45;&gt;Gate_s1_l12_tp7 -->
<g id="edge1744" class="edge">
<title>ResAttn_s1_l12_tp7&#45;&gt;Gate_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M9159.93,-5124.03C9165.88,-5114.78 9171.94,-5105.36 9177.47,-5096.76"/>
<polygon fill="black" stroke="black" points="9180.55,-5098.45 9183.01,-5088.15 9174.66,-5094.66 9180.55,-5098.45"/>
</g>
<!-- ResMOE_s1_l12_tp7 -->
<g id="node1093" class="node">
<title>ResMOE_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="10494.77,-4799.18 9937.45,-4799.18 9794.08,-4693.18 10351.4,-4693.18 10494.77,-4799.18"/>
<text text-anchor="middle" x="10144.42" y="-4757.48" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10144.42" y="-4742.48" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10144.42" y="-4727.48" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l12_tp7&#45;&gt;ResMOE_s1_l12_tp7 -->
<g id="edge1824" class="edge">
<title>ResAttn_s1_l12_tp7&#45;&gt;ResMOE_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M9373.13,-5153.3C9495,-5142.82 9644.33,-5131.19 9778.42,-5124.13 9934.81,-5115.9 11035.15,-5124.74 11187.42,-5088.13 11276.53,-5066.71 11324.57,-5076.67 11373.42,-4999.13 11385.98,-4979.2 11388.69,-4964.07 11373.42,-4946.13 11315.53,-4878.11 10819.95,-4814.98 10476.07,-4778.79"/>
<polygon fill="black" stroke="black" points="10476.26,-4775.29 10465.95,-4777.72 10475.53,-4782.25 10476.26,-4775.29"/>
</g>
<!-- Expert32_s1_l12_tp0 -->
<g id="node1053" class="node">
<title>Expert32_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5767.42,-4999.13 5459.42,-4999.13 5459.42,-4946.13 5767.42,-4946.13 5767.42,-4999.13"/>
<text text-anchor="middle" x="5613.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="5613.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5613.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp0&#45;&gt;Expert32_s1_l12_tp0 -->
<g id="edge1745" class="edge">
<title>Gate_s1_l12_tp0&#45;&gt;Expert32_s1_l12_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5383.03,-5035.12C5422.26,-5024.65 5467.8,-5012.5 5507.99,-5001.77"/>
<polygon fill="black" stroke="black" points="5509.06,-5005.11 5517.82,-4999.15 5507.25,-4998.34 5509.06,-5005.11"/>
</g>
<!-- Expert33_s1_l12_tp0 -->
<g id="node1054" class="node">
<title>Expert33_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="6093.42,-4999.13 5785.42,-4999.13 5785.42,-4946.13 6093.42,-4946.13 6093.42,-4999.13"/>
<text text-anchor="middle" x="5939.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="5939.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5939.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp0&#45;&gt;Expert33_s1_l12_tp0 -->
<g id="edge1746" class="edge">
<title>Gate_s1_l12_tp0&#45;&gt;Expert33_s1_l12_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5456.47,-5040.64C5547.97,-5029.51 5663.22,-5015 5774.9,-4999.33"/>
<polygon fill="black" stroke="black" points="5775.59,-5002.77 5785.01,-4997.91 5774.62,-4995.84 5775.59,-5002.77"/>
</g>
<!-- Expert34_s1_l12_tp0 -->
<g id="node1055" class="node">
<title>Expert34_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5115.42,-4999.13 4807.42,-4999.13 4807.42,-4946.13 5115.42,-4946.13 5115.42,-4999.13"/>
<text text-anchor="middle" x="4961.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="4961.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4961.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp0&#45;&gt;Expert34_s1_l12_tp0 -->
<g id="edge1747" class="edge">
<title>Gate_s1_l12_tp0&#45;&gt;Expert34_s1_l12_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5191.81,-5035.12C5152.59,-5024.65 5107.04,-5012.5 5066.85,-5001.77"/>
<polygon fill="black" stroke="black" points="5067.59,-4998.34 5057.03,-4999.15 5065.79,-5005.11 5067.59,-4998.34"/>
</g>
<!-- Expert35_s1_l12_tp0 -->
<g id="node1056" class="node">
<title>Expert35_s1_l12_tp0</title>
<polygon fill="none" stroke="black" points="5441.42,-4999.13 5133.42,-4999.13 5133.42,-4946.13 5441.42,-4946.13 5441.42,-4999.13"/>
<text text-anchor="middle" x="5287.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="5287.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5287.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp0&#45;&gt;Expert35_s1_l12_tp0 -->
<g id="edge1748" class="edge">
<title>Gate_s1_l12_tp0&#45;&gt;Expert35_s1_l12_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5287.42,-5035C5287.42,-5027.02 5287.42,-5018.07 5287.42,-5009.52"/>
<polygon fill="black" stroke="black" points="5290.92,-5009.38 5287.42,-4999.38 5283.92,-5009.38 5290.92,-5009.38"/>
</g>
<!-- Expert36_s1_l12_tp1 -->
<g id="node1057" class="node">
<title>Expert36_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="3159.42,-4999.13 2851.42,-4999.13 2851.42,-4946.13 3159.42,-4946.13 3159.42,-4999.13"/>
<text text-anchor="middle" x="3005.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="3005.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3005.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp1&#45;&gt;Expert36_s1_l12_tp1 -->
<g id="edge1749" class="edge">
<title>Gate_s1_l12_tp1&#45;&gt;Expert36_s1_l12_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3005.42,-5035C3005.42,-5027.02 3005.42,-5018.07 3005.42,-5009.52"/>
<polygon fill="black" stroke="black" points="3008.92,-5009.38 3005.42,-4999.38 3001.92,-5009.38 3008.92,-5009.38"/>
</g>
<!-- Expert37_s1_l12_tp1 -->
<g id="node1058" class="node">
<title>Expert37_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="3485.42,-4999.13 3177.42,-4999.13 3177.42,-4946.13 3485.42,-4946.13 3485.42,-4999.13"/>
<text text-anchor="middle" x="3331.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="3331.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3331.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp1&#45;&gt;Expert37_s1_l12_tp1 -->
<g id="edge1750" class="edge">
<title>Gate_s1_l12_tp1&#45;&gt;Expert37_s1_l12_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3101.03,-5035.12C3140.26,-5024.65 3185.8,-5012.5 3225.99,-5001.77"/>
<polygon fill="black" stroke="black" points="3227.06,-5005.11 3235.82,-4999.15 3225.25,-4998.34 3227.06,-5005.11"/>
</g>
<!-- Expert38_s1_l12_tp1 -->
<g id="node1059" class="node">
<title>Expert38_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="2507.42,-4999.13 2199.42,-4999.13 2199.42,-4946.13 2507.42,-4946.13 2507.42,-4999.13"/>
<text text-anchor="middle" x="2353.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2353.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2353.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp1&#45;&gt;Expert38_s1_l12_tp1 -->
<g id="edge1751" class="edge">
<title>Gate_s1_l12_tp1&#45;&gt;Expert38_s1_l12_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2836.37,-5040.64C2744.87,-5029.51 2629.63,-5015 2517.94,-4999.33"/>
<polygon fill="black" stroke="black" points="2518.23,-4995.84 2507.84,-4997.91 2517.25,-5002.77 2518.23,-4995.84"/>
</g>
<!-- Expert39_s1_l12_tp1 -->
<g id="node1060" class="node">
<title>Expert39_s1_l12_tp1</title>
<polygon fill="none" stroke="black" points="2833.42,-4999.13 2525.42,-4999.13 2525.42,-4946.13 2833.42,-4946.13 2833.42,-4999.13"/>
<text text-anchor="middle" x="2679.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="2679.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2679.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp1&#45;&gt;Expert39_s1_l12_tp1 -->
<g id="edge1752" class="edge">
<title>Gate_s1_l12_tp1&#45;&gt;Expert39_s1_l12_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2909.81,-5035.12C2870.59,-5024.65 2825.04,-5012.5 2784.85,-5001.77"/>
<polygon fill="black" stroke="black" points="2785.59,-4998.34 2775.03,-4999.15 2783.79,-5005.11 2785.59,-4998.34"/>
</g>
<!-- Expert40_s1_l12_tp2 -->
<g id="node1061" class="node">
<title>Expert40_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="4789.42,-4999.13 4481.42,-4999.13 4481.42,-4946.13 4789.42,-4946.13 4789.42,-4999.13"/>
<text text-anchor="middle" x="4635.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="4635.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4635.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp2&#45;&gt;Expert40_s1_l12_tp2 -->
<g id="edge1753" class="edge">
<title>Gate_s1_l12_tp2&#45;&gt;Expert40_s1_l12_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4277.82,-5035.12C4340.38,-5024.36 4413.29,-5011.83 4476.9,-5000.89"/>
<polygon fill="black" stroke="black" points="4477.77,-5004.29 4487.03,-4999.15 4476.58,-4997.39 4477.77,-5004.29"/>
</g>
<!-- Expert41_s1_l12_tp2 -->
<g id="node1062" class="node">
<title>Expert41_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="3811.42,-4999.13 3503.42,-4999.13 3503.42,-4946.13 3811.42,-4946.13 3811.42,-4999.13"/>
<text text-anchor="middle" x="3657.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="3657.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3657.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp2&#45;&gt;Expert41_s1_l12_tp2 -->
<g id="edge1754" class="edge">
<title>Gate_s1_l12_tp2&#45;&gt;Expert41_s1_l12_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3991,-5035.12C3932.88,-5024.41 3865.19,-5011.93 3806.03,-5001.02"/>
<polygon fill="black" stroke="black" points="3806.32,-4997.52 3795.85,-4999.15 3805.05,-5004.4 3806.32,-4997.52"/>
</g>
<!-- Expert42_s1_l12_tp2 -->
<g id="node1063" class="node">
<title>Expert42_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="4137.42,-4999.13 3829.42,-4999.13 3829.42,-4946.13 4137.42,-4946.13 4137.42,-4999.13"/>
<text text-anchor="middle" x="3983.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="3983.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3983.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp2&#45;&gt;Expert42_s1_l12_tp2 -->
<g id="edge1755" class="edge">
<title>Gate_s1_l12_tp2&#45;&gt;Expert42_s1_l12_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4086.41,-5035C4070.29,-5025.4 4051.81,-5014.39 4035,-5004.37"/>
<polygon fill="black" stroke="black" points="4036.76,-5001.34 4026.38,-4999.23 4033.18,-5007.36 4036.76,-5001.34"/>
</g>
<!-- Expert43_s1_l12_tp2 -->
<g id="node1064" class="node">
<title>Expert43_s1_l12_tp2</title>
<polygon fill="none" stroke="black" points="4463.42,-4999.13 4155.42,-4999.13 4155.42,-4946.13 4463.42,-4946.13 4463.42,-4999.13"/>
<text text-anchor="middle" x="4309.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="4309.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4309.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp2&#45;&gt;Expert43_s1_l12_tp2 -->
<g id="edge1756" class="edge">
<title>Gate_s1_l12_tp2&#45;&gt;Expert43_s1_l12_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4182.45,-5035C4202.78,-5025.18 4226.15,-5013.88 4247.25,-5003.68"/>
<polygon fill="black" stroke="black" points="4248.98,-5006.74 4256.46,-4999.23 4245.93,-5000.43 4248.98,-5006.74"/>
</g>
<!-- Expert44_s1_l12_tp3 -->
<g id="node1065" class="node">
<title>Expert44_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6419.42,-4999.13 6111.42,-4999.13 6111.42,-4946.13 6419.42,-4946.13 6419.42,-4999.13"/>
<text text-anchor="middle" x="6265.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="6265.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6265.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp3&#45;&gt;Expert44_s1_l12_tp3 -->
<g id="edge1757" class="edge">
<title>Gate_s1_l12_tp3&#45;&gt;Expert44_s1_l12_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6748.37,-5040.64C6656.87,-5029.51 6541.63,-5015 6429.94,-4999.33"/>
<polygon fill="black" stroke="black" points="6430.23,-4995.84 6419.84,-4997.91 6429.25,-5002.77 6430.23,-4995.84"/>
</g>
<!-- Expert45_s1_l12_tp3 -->
<g id="node1066" class="node">
<title>Expert45_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="6745.42,-4999.13 6437.42,-4999.13 6437.42,-4946.13 6745.42,-4946.13 6745.42,-4999.13"/>
<text text-anchor="middle" x="6591.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6591.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6591.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp3&#45;&gt;Expert45_s1_l12_tp3 -->
<g id="edge1758" class="edge">
<title>Gate_s1_l12_tp3&#45;&gt;Expert45_s1_l12_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6821.81,-5035.12C6782.59,-5024.65 6737.04,-5012.5 6696.85,-5001.77"/>
<polygon fill="black" stroke="black" points="6697.59,-4998.34 6687.03,-4999.15 6695.79,-5005.11 6697.59,-4998.34"/>
</g>
<!-- Expert46_s1_l12_tp3 -->
<g id="node1067" class="node">
<title>Expert46_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="7071.42,-4999.13 6763.42,-4999.13 6763.42,-4946.13 7071.42,-4946.13 7071.42,-4999.13"/>
<text text-anchor="middle" x="6917.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="6917.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6917.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp3&#45;&gt;Expert46_s1_l12_tp3 -->
<g id="edge1759" class="edge">
<title>Gate_s1_l12_tp3&#45;&gt;Expert46_s1_l12_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6917.42,-5035C6917.42,-5027.02 6917.42,-5018.07 6917.42,-5009.52"/>
<polygon fill="black" stroke="black" points="6920.92,-5009.38 6917.42,-4999.38 6913.92,-5009.38 6920.92,-5009.38"/>
</g>
<!-- Expert47_s1_l12_tp3 -->
<g id="node1068" class="node">
<title>Expert47_s1_l12_tp3</title>
<polygon fill="none" stroke="black" points="7397.42,-4999.13 7089.42,-4999.13 7089.42,-4946.13 7397.42,-4946.13 7397.42,-4999.13"/>
<text text-anchor="middle" x="7243.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="7243.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7243.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp3&#45;&gt;Expert47_s1_l12_tp3 -->
<g id="edge1760" class="edge">
<title>Gate_s1_l12_tp3&#45;&gt;Expert47_s1_l12_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7013.03,-5035.12C7052.26,-5024.65 7097.8,-5012.5 7137.99,-5001.77"/>
<polygon fill="black" stroke="black" points="7139.06,-5005.11 7147.82,-4999.15 7137.25,-4998.34 7139.06,-5005.11"/>
</g>
<!-- Expert48_s1_l12_tp4 -->
<g id="node1069" class="node">
<title>Expert48_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="7723.42,-4999.13 7415.42,-4999.13 7415.42,-4946.13 7723.42,-4946.13 7723.42,-4999.13"/>
<text text-anchor="middle" x="7569.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7569.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7569.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp4&#45;&gt;Expert48_s1_l12_tp4 -->
<g id="edge1761" class="edge">
<title>Gate_s1_l12_tp4&#45;&gt;Expert48_s1_l12_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7927.02,-5035.12C7864.47,-5024.36 7791.55,-5011.83 7727.94,-5000.89"/>
<polygon fill="black" stroke="black" points="7728.27,-4997.39 7717.82,-4999.15 7727.08,-5004.29 7728.27,-4997.39"/>
</g>
<!-- Expert49_s1_l12_tp4 -->
<g id="node1070" class="node">
<title>Expert49_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="8049.42,-4999.13 7741.42,-4999.13 7741.42,-4946.13 8049.42,-4946.13 8049.42,-4999.13"/>
<text text-anchor="middle" x="7895.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="7895.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7895.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp4&#45;&gt;Expert49_s1_l12_tp4 -->
<g id="edge1762" class="edge">
<title>Gate_s1_l12_tp4&#45;&gt;Expert49_s1_l12_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8022.39,-5035C8002.06,-5025.18 7978.7,-5013.88 7957.59,-5003.68"/>
<polygon fill="black" stroke="black" points="7958.91,-5000.43 7948.39,-4999.23 7955.87,-5006.74 7958.91,-5000.43"/>
</g>
<!-- Expert50_s1_l12_tp4 -->
<g id="node1071" class="node">
<title>Expert50_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="8375.42,-4999.13 8067.42,-4999.13 8067.42,-4946.13 8375.42,-4946.13 8375.42,-4999.13"/>
<text text-anchor="middle" x="8221.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="8221.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8221.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp4&#45;&gt;Expert50_s1_l12_tp4 -->
<g id="edge1763" class="edge">
<title>Gate_s1_l12_tp4&#45;&gt;Expert50_s1_l12_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8118.44,-5035C8134.55,-5025.4 8153.03,-5014.39 8169.84,-5004.37"/>
<polygon fill="black" stroke="black" points="8171.66,-5007.36 8178.46,-4999.23 8168.08,-5001.34 8171.66,-5007.36"/>
</g>
<!-- Expert51_s1_l12_tp4 -->
<g id="node1072" class="node">
<title>Expert51_s1_l12_tp4</title>
<polygon fill="none" stroke="black" points="8701.42,-4999.13 8393.42,-4999.13 8393.42,-4946.13 8701.42,-4946.13 8701.42,-4999.13"/>
<text text-anchor="middle" x="8547.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="8547.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8547.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp4&#45;&gt;Expert51_s1_l12_tp4 -->
<g id="edge1764" class="edge">
<title>Gate_s1_l12_tp4&#45;&gt;Expert51_s1_l12_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8213.85,-5035.12C8271.96,-5024.41 8339.66,-5011.93 8398.82,-5001.02"/>
<polygon fill="black" stroke="black" points="8399.8,-5004.4 8409,-4999.15 8398.53,-4997.52 8399.8,-5004.4"/>
</g>
<!-- Expert52_s1_l12_tp5 -->
<g id="node1073" class="node">
<title>Expert52_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="1203.42,-4999.13 895.42,-4999.13 895.42,-4946.13 1203.42,-4946.13 1203.42,-4999.13"/>
<text text-anchor="middle" x="1049.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="1049.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1049.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp5&#45;&gt;Expert52_s1_l12_tp5 -->
<g id="edge1765" class="edge">
<title>Gate_s1_l12_tp5&#45;&gt;Expert52_s1_l12_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1532.37,-5040.64C1440.87,-5029.51 1325.63,-5015 1213.94,-4999.33"/>
<polygon fill="black" stroke="black" points="1214.23,-4995.84 1203.84,-4997.91 1213.25,-5002.77 1214.23,-4995.84"/>
</g>
<!-- Expert53_s1_l12_tp5 -->
<g id="node1074" class="node">
<title>Expert53_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="1529.42,-4999.13 1221.42,-4999.13 1221.42,-4946.13 1529.42,-4946.13 1529.42,-4999.13"/>
<text text-anchor="middle" x="1375.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1375.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1375.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp5&#45;&gt;Expert53_s1_l12_tp5 -->
<g id="edge1766" class="edge">
<title>Gate_s1_l12_tp5&#45;&gt;Expert53_s1_l12_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1605.81,-5035.12C1566.59,-5024.65 1521.04,-5012.5 1480.85,-5001.77"/>
<polygon fill="black" stroke="black" points="1481.59,-4998.34 1471.03,-4999.15 1479.79,-5005.11 1481.59,-4998.34"/>
</g>
<!-- Expert54_s1_l12_tp5 -->
<g id="node1075" class="node">
<title>Expert54_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="1855.42,-4999.13 1547.42,-4999.13 1547.42,-4946.13 1855.42,-4946.13 1855.42,-4999.13"/>
<text text-anchor="middle" x="1701.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="1701.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1701.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp5&#45;&gt;Expert54_s1_l12_tp5 -->
<g id="edge1767" class="edge">
<title>Gate_s1_l12_tp5&#45;&gt;Expert54_s1_l12_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1701.42,-5035C1701.42,-5027.02 1701.42,-5018.07 1701.42,-5009.52"/>
<polygon fill="black" stroke="black" points="1704.92,-5009.38 1701.42,-4999.38 1697.92,-5009.38 1704.92,-5009.38"/>
</g>
<!-- Expert55_s1_l12_tp5 -->
<g id="node1076" class="node">
<title>Expert55_s1_l12_tp5</title>
<polygon fill="none" stroke="black" points="2181.42,-4999.13 1873.42,-4999.13 1873.42,-4946.13 2181.42,-4946.13 2181.42,-4999.13"/>
<text text-anchor="middle" x="2027.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="2027.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2027.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp5&#45;&gt;Expert55_s1_l12_tp5 -->
<g id="edge1768" class="edge">
<title>Gate_s1_l12_tp5&#45;&gt;Expert55_s1_l12_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1797.03,-5035.12C1836.26,-5024.65 1881.8,-5012.5 1921.99,-5001.77"/>
<polygon fill="black" stroke="black" points="1923.06,-5005.11 1931.82,-4999.15 1921.25,-4998.34 1923.06,-5005.11"/>
</g>
<!-- Expert56_s1_l12_tp6 -->
<g id="node1077" class="node">
<title>Expert56_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="10331.42,-4999.13 10023.42,-4999.13 10023.42,-4946.13 10331.42,-4946.13 10331.42,-4999.13"/>
<text text-anchor="middle" x="10177.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="10177.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10177.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp6&#45;&gt;Expert56_s1_l12_tp6 -->
<g id="edge1769" class="edge">
<title>Gate_s1_l12_tp6&#45;&gt;Expert56_s1_l12_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10407.81,-5035.12C10368.59,-5024.65 10323.04,-5012.5 10282.85,-5001.77"/>
<polygon fill="black" stroke="black" points="10283.59,-4998.34 10273.03,-4999.15 10281.79,-5005.11 10283.59,-4998.34"/>
</g>
<!-- Expert57_s1_l12_tp6 -->
<g id="node1078" class="node">
<title>Expert57_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="10657.42,-4999.13 10349.42,-4999.13 10349.42,-4946.13 10657.42,-4946.13 10657.42,-4999.13"/>
<text text-anchor="middle" x="10503.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="10503.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10503.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp6&#45;&gt;Expert57_s1_l12_tp6 -->
<g id="edge1770" class="edge">
<title>Gate_s1_l12_tp6&#45;&gt;Expert57_s1_l12_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10503.42,-5035C10503.42,-5027.02 10503.42,-5018.07 10503.42,-5009.52"/>
<polygon fill="black" stroke="black" points="10506.92,-5009.38 10503.42,-4999.38 10499.92,-5009.38 10506.92,-5009.38"/>
</g>
<!-- Expert58_s1_l12_tp6 -->
<g id="node1079" class="node">
<title>Expert58_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="10983.42,-4999.13 10675.42,-4999.13 10675.42,-4946.13 10983.42,-4946.13 10983.42,-4999.13"/>
<text text-anchor="middle" x="10829.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="10829.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10829.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp6&#45;&gt;Expert58_s1_l12_tp6 -->
<g id="edge1771" class="edge">
<title>Gate_s1_l12_tp6&#45;&gt;Expert58_s1_l12_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10599.03,-5035.12C10638.26,-5024.65 10683.8,-5012.5 10723.99,-5001.77"/>
<polygon fill="black" stroke="black" points="10725.06,-5005.11 10733.82,-4999.15 10723.25,-4998.34 10725.06,-5005.11"/>
</g>
<!-- Expert59_s1_l12_tp6 -->
<g id="node1080" class="node">
<title>Expert59_s1_l12_tp6</title>
<polygon fill="none" stroke="black" points="11309.42,-4999.13 11001.42,-4999.13 11001.42,-4946.13 11309.42,-4946.13 11309.42,-4999.13"/>
<text text-anchor="middle" x="11155.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="11155.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="11155.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp6&#45;&gt;Expert59_s1_l12_tp6 -->
<g id="edge1772" class="edge">
<title>Gate_s1_l12_tp6&#45;&gt;Expert59_s1_l12_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10672.47,-5040.64C10763.97,-5029.51 10879.22,-5015 10990.9,-4999.33"/>
<polygon fill="black" stroke="black" points="10991.59,-5002.77 11001.01,-4997.91 10990.62,-4995.84 10991.59,-5002.77"/>
</g>
<!-- Expert60_s1_l12_tp7 -->
<g id="node1081" class="node">
<title>Expert60_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="9027.42,-4999.13 8719.42,-4999.13 8719.42,-4946.13 9027.42,-4946.13 9027.42,-4999.13"/>
<text text-anchor="middle" x="8873.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="8873.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8873.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp7&#45;&gt;Expert60_s1_l12_tp7 -->
<g id="edge1773" class="edge">
<title>Gate_s1_l12_tp7&#45;&gt;Expert60_s1_l12_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.81,-5035.12C9064.59,-5024.65 9019.04,-5012.5 8978.85,-5001.77"/>
<polygon fill="black" stroke="black" points="8979.59,-4998.34 8969.03,-4999.15 8977.79,-5005.11 8979.59,-4998.34"/>
</g>
<!-- Expert61_s1_l12_tp7 -->
<g id="node1082" class="node">
<title>Expert61_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="9353.42,-4999.13 9045.42,-4999.13 9045.42,-4946.13 9353.42,-4946.13 9353.42,-4999.13"/>
<text text-anchor="middle" x="9199.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="9199.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9199.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp7&#45;&gt;Expert61_s1_l12_tp7 -->
<g id="edge1774" class="edge">
<title>Gate_s1_l12_tp7&#45;&gt;Expert61_s1_l12_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9199.42,-5035C9199.42,-5027.02 9199.42,-5018.07 9199.42,-5009.52"/>
<polygon fill="black" stroke="black" points="9202.92,-5009.38 9199.42,-4999.38 9195.92,-5009.38 9202.92,-5009.38"/>
</g>
<!-- Expert62_s1_l12_tp7 -->
<g id="node1083" class="node">
<title>Expert62_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="9679.42,-4999.13 9371.42,-4999.13 9371.42,-4946.13 9679.42,-4946.13 9679.42,-4999.13"/>
<text text-anchor="middle" x="9525.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="9525.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9525.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp7&#45;&gt;Expert62_s1_l12_tp7 -->
<g id="edge1775" class="edge">
<title>Gate_s1_l12_tp7&#45;&gt;Expert62_s1_l12_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9295.03,-5035.12C9334.26,-5024.65 9379.8,-5012.5 9419.99,-5001.77"/>
<polygon fill="black" stroke="black" points="9421.06,-5005.11 9429.82,-4999.15 9419.25,-4998.34 9421.06,-5005.11"/>
</g>
<!-- Expert63_s1_l12_tp7 -->
<g id="node1084" class="node">
<title>Expert63_s1_l12_tp7</title>
<polygon fill="none" stroke="black" points="10005.42,-4999.13 9697.42,-4999.13 9697.42,-4946.13 10005.42,-4946.13 10005.42,-4999.13"/>
<text text-anchor="middle" x="9851.42" y="-4983.93" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="9851.42" y="-4968.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9851.42" y="-4953.93" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l12_tp7&#45;&gt;Expert63_s1_l12_tp7 -->
<g id="edge1776" class="edge">
<title>Gate_s1_l12_tp7&#45;&gt;Expert63_s1_l12_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9368.47,-5040.64C9459.97,-5029.51 9575.22,-5015 9686.9,-4999.33"/>
<polygon fill="black" stroke="black" points="9687.59,-5002.77 9697.01,-4997.91 9686.62,-4995.84 9687.59,-5002.77"/>
</g>
<!-- AR_exp_s1_l12 -->
<g id="node1085" class="node">
<title>AR_exp_s1_l12</title>
<ellipse fill="none" stroke="black" cx="6069.42" cy="-4872.66" rx="239" ry="37.45"/>
<text text-anchor="middle" x="6069.42" y="-4883.96" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="6069.42" y="-4868.96" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="6069.42" y="-4853.96" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l12_tp0&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1777" class="edge">
<title>Expert32_s1_l12_tp0&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M5732.34,-4946.08C5790.08,-4933.68 5860.04,-4918.65 5921.22,-4905.5"/>
<polygon fill="black" stroke="black" points="5922.31,-4908.84 5931.35,-4903.32 5920.84,-4902 5922.31,-4908.84"/>
</g>
<!-- Expert33_s1_l12_tp0&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1778" class="edge">
<title>Expert33_s1_l12_tp0&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M5973.58,-4945.89C5985.79,-4936.69 5999.89,-4926.06 6013.46,-4915.84"/>
<polygon fill="black" stroke="black" points="6015.93,-4918.35 6021.81,-4909.54 6011.72,-4912.76 6015.93,-4918.35"/>
</g>
<!-- Expert34_s1_l12_tp0&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1779" class="edge">
<title>Expert34_s1_l12_tp0&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M5115.81,-4947.16C5118.71,-4946.81 5121.58,-4946.46 5124.42,-4946.13 5366.08,-4918.01 5643.82,-4898.19 5835.35,-4886.47"/>
<polygon fill="black" stroke="black" points="5835.78,-4889.95 5845.55,-4885.85 5835.36,-4882.97 5835.78,-4889.95"/>
</g>
<!-- Expert35_s1_l12_tp0&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1780" class="edge">
<title>Expert35_s1_l12_tp0&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M5441.83,-4947.32C5444.72,-4946.92 5447.58,-4946.52 5450.42,-4946.13 5588.32,-4927.28 5743.92,-4909.08 5864.62,-4895.63"/>
<polygon fill="black" stroke="black" points="5865.17,-4899.09 5874.72,-4894.5 5864.39,-4892.13 5865.17,-4899.09"/>
</g>
<!-- Expert36_s1_l12_tp1&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1781" class="edge">
<title>Expert36_s1_l12_tp1&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M3159.79,-4946.96C3162.69,-4946.67 3165.57,-4946.39 3168.42,-4946.13 3679.84,-4899.94 5216.22,-4881.36 5820.97,-4875.7"/>
<polygon fill="black" stroke="black" points="5821.16,-4879.2 5831.13,-4875.61 5821.09,-4872.2 5821.16,-4879.2"/>
</g>
<!-- Expert37_s1_l12_tp1&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1782" class="edge">
<title>Expert37_s1_l12_tp1&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M3485.79,-4946.97C3488.69,-4946.68 3491.57,-4946.4 3494.42,-4946.13 3940.79,-4905.1 5266.95,-4883.89 5821.41,-4876.62"/>
<polygon fill="black" stroke="black" points="5821.58,-4880.12 5831.54,-4876.48 5821.49,-4873.12 5821.58,-4880.12"/>
</g>
<!-- Expert38_s1_l12_tp1&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1783" class="edge">
<title>Expert38_s1_l12_tp1&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M2507.79,-4946.94C2510.69,-4946.65 2513.57,-4946.38 2516.42,-4946.13 3159.07,-4889.57 5122.83,-4877.05 5820.37,-4874.37"/>
<polygon fill="black" stroke="black" points="5820.55,-4877.87 5830.54,-4874.33 5820.53,-4870.87 5820.55,-4877.87"/>
</g>
<!-- Expert39_s1_l12_tp1&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1784" class="edge">
<title>Expert39_s1_l12_tp1&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M2833.79,-4946.95C2836.69,-4946.66 2839.57,-4946.39 2842.42,-4946.13 3419.2,-4894.77 5167.8,-4879.1 5820.34,-4874.97"/>
<polygon fill="black" stroke="black" points="5820.83,-4878.47 5830.81,-4874.91 5820.79,-4871.47 5820.83,-4878.47"/>
</g>
<!-- Expert40_s1_l12_tp2&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1785" class="edge">
<title>Expert40_s1_l12_tp2&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M4789.81,-4947.09C4792.7,-4946.75 4795.57,-4946.44 4798.42,-4946.13 5154.37,-4908.23 5568.66,-4889.28 5825,-4880.47"/>
<polygon fill="black" stroke="black" points="5825.31,-4883.96 5835.19,-4880.12 5825.08,-4876.96 5825.31,-4883.96"/>
</g>
<!-- Expert41_s1_l12_tp2&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1786" class="edge">
<title>Expert41_s1_l12_tp2&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M3811.8,-4946.99C3814.69,-4946.69 3817.57,-4946.4 3820.42,-4946.13 4202.24,-4910.25 5321.24,-4886.78 5822.1,-4877.78"/>
<polygon fill="black" stroke="black" points="5822.42,-4881.28 5832.35,-4877.6 5822.29,-4874.28 5822.42,-4881.28"/>
</g>
<!-- Expert42_s1_l12_tp2&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1787" class="edge">
<title>Expert42_s1_l12_tp2&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M4137.8,-4947.01C4140.69,-4946.7 4143.57,-4946.41 4146.42,-4946.13 4745.21,-4888.21 5453.03,-4875.92 5820.26,-4873.72"/>
<polygon fill="black" stroke="black" points="5820.51,-4877.21 5830.49,-4873.66 5820.47,-4870.21 5820.51,-4877.21"/>
</g>
<!-- Expert43_s1_l12_tp2&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1788" class="edge">
<title>Expert43_s1_l12_tp2&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M4463.8,-4947.04C4466.7,-4946.72 4469.57,-4946.42 4472.42,-4946.13 4948.1,-4898.28 5506.69,-4882.01 5821.24,-4876.49"/>
<polygon fill="black" stroke="black" points="5821.47,-4879.98 5831.4,-4876.31 5821.35,-4872.98 5821.47,-4879.98"/>
</g>
<!-- Expert44_s1_l12_tp3&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1789" class="edge">
<title>Expert44_s1_l12_tp3&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M6214.18,-4946.02C6194.04,-4935.95 6170.47,-4924.17 6148.26,-4913.06"/>
<polygon fill="black" stroke="black" points="6149.68,-4909.86 6139.17,-4908.52 6146.55,-4916.12 6149.68,-4909.86"/>
</g>
<!-- Expert45_s1_l12_tp3&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1790" class="edge">
<title>Expert45_s1_l12_tp3&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M6455.3,-4946.08C6386.2,-4933.11 6301.82,-4917.28 6229.61,-4903.72"/>
<polygon fill="black" stroke="black" points="6229.98,-4900.23 6219.51,-4901.83 6228.69,-4907.11 6229.98,-4900.23"/>
</g>
<!-- Expert46_s1_l12_tp3&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1791" class="edge">
<title>Expert46_s1_l12_tp3&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M6763.02,-4947.28C6760.13,-4946.89 6757.26,-4946.51 6754.42,-4946.13 6596.67,-4925.46 6417.87,-4906.7 6282.51,-4893.45"/>
<polygon fill="black" stroke="black" points="6282.72,-4889.95 6272.43,-4892.46 6282.04,-4896.92 6282.72,-4889.95"/>
</g>
<!-- Expert47_s1_l12_tp3&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1792" class="edge">
<title>Expert47_s1_l12_tp3&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M7089.03,-4947.14C7086.14,-4946.79 7083.27,-4946.46 7080.42,-4946.13 6816.15,-4916.04 6511.51,-4896.22 6306.29,-4885.03"/>
<polygon fill="black" stroke="black" points="6306.46,-4881.53 6296.29,-4884.49 6306.08,-4888.52 6306.46,-4881.53"/>
</g>
<!-- Expert48_s1_l12_tp4&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1793" class="edge">
<title>Expert48_s1_l12_tp4&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M7415.04,-4947.08C7412.15,-4946.75 7409.27,-4946.43 7406.42,-4946.13 7026.67,-4906.24 6583.79,-4887.7 6315.14,-4879.54"/>
<polygon fill="black" stroke="black" points="6314.97,-4876.03 6304.87,-4879.23 6314.76,-4883.03 6314.97,-4876.03"/>
</g>
<!-- Expert49_s1_l12_tp4&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1794" class="edge">
<title>Expert49_s1_l12_tp4&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M7741.04,-4947.03C7738.15,-4946.72 7735.27,-4946.42 7732.42,-4946.13 7232.03,-4896.25 6643.55,-4880.69 6317.92,-4875.85"/>
<polygon fill="black" stroke="black" points="6317.94,-4872.35 6307.89,-4875.7 6317.83,-4879.35 6317.94,-4872.35"/>
</g>
<!-- Expert50_s1_l12_tp4&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1795" class="edge">
<title>Expert50_s1_l12_tp4&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M8067.05,-4947.01C8064.15,-4946.7 8061.27,-4946.41 8058.42,-4946.13 7434.45,-4886.17 6696.02,-4874.8 6318.68,-4873.26"/>
<polygon fill="black" stroke="black" points="6318.47,-4869.76 6308.45,-4873.22 6318.44,-4876.76 6318.47,-4869.76"/>
</g>
<!-- Expert51_s1_l12_tp4&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1796" class="edge">
<title>Expert51_s1_l12_tp4&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M8393.05,-4946.99C8390.15,-4946.68 8387.27,-4946.4 8384.42,-4946.13 7989.56,-4909.21 6828.77,-4886.16 6316.82,-4877.52"/>
<polygon fill="black" stroke="black" points="6316.77,-4874.02 6306.71,-4877.35 6316.65,-4881.02 6316.77,-4874.02"/>
</g>
<!-- Expert52_s1_l12_tp5&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1797" class="edge">
<title>Expert52_s1_l12_tp5&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M1203.79,-4946.92C1206.69,-4946.64 1209.57,-4946.38 1212.42,-4946.13 1672.03,-4906.95 4893.69,-4881.8 5820.54,-4875.32"/>
<polygon fill="black" stroke="black" points="5820.69,-4878.82 5830.66,-4875.25 5820.64,-4871.82 5820.69,-4878.82"/>
</g>
<!-- Expert53_s1_l12_tp5&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1798" class="edge">
<title>Expert53_s1_l12_tp5&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M1529.79,-4946.93C1532.69,-4946.64 1535.57,-4946.38 1538.42,-4946.13 2380.13,-4873.92 4998.39,-4871.86 5820.1,-4873.07"/>
<polygon fill="black" stroke="black" points="5820.27,-4876.57 5830.28,-4873.09 5820.28,-4869.57 5820.27,-4876.57"/>
</g>
<!-- Expert54_s1_l12_tp5&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1799" class="edge">
<title>Expert54_s1_l12_tp5&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M1855.79,-4946.93C1858.69,-4946.65 1861.57,-4946.38 1864.42,-4946.13 2639.47,-4879.15 5037.74,-4873.46 5819.94,-4873.44"/>
<polygon fill="black" stroke="black" points="5820.2,-4876.94 5830.2,-4873.44 5820.2,-4869.94 5820.2,-4876.94"/>
</g>
<!-- Expert55_s1_l12_tp5&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1800" class="edge">
<title>Expert55_s1_l12_tp5&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M2181.79,-4946.94C2184.69,-4946.65 2187.57,-4946.38 2190.42,-4946.13 2899.13,-4884.37 5079.28,-4875.19 5820.08,-4873.86"/>
<polygon fill="black" stroke="black" points="5820.35,-4877.36 5830.34,-4873.85 5820.34,-4870.36 5820.35,-4877.36"/>
</g>
<!-- Expert56_s1_l12_tp6&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1801" class="edge">
<title>Expert56_s1_l12_tp6&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M10023.05,-4946.93C10020.16,-4946.65 10017.28,-4946.38 10014.42,-4946.13 9292.29,-4883.31 7068.02,-4874.83 6318.75,-4873.77"/>
<polygon fill="black" stroke="black" points="6318.65,-4870.27 6308.64,-4873.76 6318.64,-4877.27 6318.65,-4870.27"/>
</g>
<!-- Expert57_s1_l12_tp6&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1802" class="edge">
<title>Expert57_s1_l12_tp6&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M10349.05,-4946.93C10346.16,-4946.65 10343.28,-4946.38 10340.42,-4946.13 9551.85,-4878.09 7108.87,-4873.13 6318.72,-4873.36"/>
<polygon fill="black" stroke="black" points="6318.64,-4869.86 6308.64,-4873.36 6318.64,-4876.86 6318.64,-4869.86"/>
</g>
<!-- Expert58_s1_l12_tp6&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1803" class="edge">
<title>Expert58_s1_l12_tp6&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M10675.05,-4946.92C10672.16,-4946.64 10669.28,-4946.38 10666.42,-4946.13 9811.21,-4872.86 7148.35,-4871.55 6318.77,-4873"/>
<polygon fill="black" stroke="black" points="6318.49,-4869.5 6308.49,-4873.02 6318.5,-4876.5 6318.49,-4869.5"/>
</g>
<!-- Expert59_s1_l12_tp6&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1804" class="edge">
<title>Expert59_s1_l12_tp6&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M11001.06,-4946.92C10998.16,-4946.64 10995.28,-4946.38 10992.42,-4946.13 10525.97,-4906.41 7252.76,-4881.6 6318.09,-4875.27"/>
<polygon fill="black" stroke="black" points="6317.91,-4871.77 6307.88,-4875.2 6317.86,-4878.76 6317.91,-4871.77"/>
</g>
<!-- Expert60_s1_l12_tp7&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1805" class="edge">
<title>Expert60_s1_l12_tp7&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M8719.05,-4946.97C8716.15,-4946.67 8713.27,-4946.39 8710.42,-4946.13 8250.98,-4904.06 6882.75,-4883.36 6317.74,-4876.42"/>
<polygon fill="black" stroke="black" points="6317.47,-4872.91 6307.43,-4876.29 6317.38,-4879.91 6317.47,-4872.91"/>
</g>
<!-- Expert61_s1_l12_tp7&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1806" class="edge">
<title>Expert61_s1_l12_tp7&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M9045.05,-4946.96C9042.15,-4946.67 9039.28,-4946.39 9036.42,-4946.13 8511.85,-4898.9 6932.92,-4880.88 6318.18,-4875.54"/>
<polygon fill="black" stroke="black" points="6317.88,-4872.04 6307.85,-4875.45 6317.82,-4879.04 6317.88,-4872.04"/>
</g>
<!-- Expert62_s1_l12_tp7&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1807" class="edge">
<title>Expert62_s1_l12_tp7&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M9371.05,-4946.95C9368.15,-4946.66 9365.28,-4946.39 9362.42,-4946.13 8772.28,-4893.71 6980.01,-4878.67 6318.33,-4874.84"/>
<polygon fill="black" stroke="black" points="6318.21,-4871.34 6308.19,-4874.78 6318.17,-4878.34 6318.21,-4871.34"/>
</g>
<!-- Expert63_s1_l12_tp7&#45;&gt;AR_exp_s1_l12 -->
<g id="edge1808" class="edge">
<title>Expert63_s1_l12_tp7&#45;&gt;AR_exp_s1_l12</title>
<path fill="none" stroke="black" d="M9697.05,-4946.94C9694.15,-4946.65 9691.28,-4946.38 9688.42,-4946.13 9032.39,-4888.51 7024.77,-4876.66 6318.43,-4874.26"/>
<polygon fill="black" stroke="black" points="6318.39,-4870.76 6308.38,-4874.22 6318.37,-4877.76 6318.39,-4870.76"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp0 -->
<g id="edge1809" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp0</title>
<path fill="none" stroke="black" d="M6015.26,-4835.99C6000.49,-4826.26 5984.11,-4815.47 5967.99,-4804.85"/>
<polygon fill="black" stroke="black" points="5969.87,-4801.9 5959.59,-4799.32 5966.02,-4807.75 5969.87,-4801.9"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp1 -->
<g id="edge1811" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp1</title>
<path fill="none" stroke="black" d="M5840.41,-4861.76C5522.44,-4847.97 4929.2,-4822.09 4423.42,-4799.18 4150.53,-4786.82 3840.16,-4772.34 3615.96,-4761.8"/>
<polygon fill="black" stroke="black" points="3615.84,-4758.29 3605.69,-4761.32 3615.51,-4765.28 3615.84,-4758.29"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp2 -->
<g id="edge1813" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp2</title>
<path fill="none" stroke="black" d="M5868.68,-4852.24C5667.33,-4832.77 5353.71,-4802.43 5115.11,-4779.36"/>
<polygon fill="black" stroke="black" points="5115.17,-4775.85 5104.88,-4778.37 5114.49,-4782.81 5115.17,-4775.85"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp3 -->
<g id="edge1815" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp3</title>
<path fill="none" stroke="black" d="M6219.19,-4843.41C6301.57,-4827.87 6405.57,-4808.26 6498.15,-4790.8"/>
<polygon fill="black" stroke="black" points="6499.04,-4794.19 6508.22,-4788.9 6497.75,-4787.31 6499.04,-4794.19"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp4 -->
<g id="edge1817" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp4</title>
<path fill="none" stroke="black" d="M6297.04,-4861.15C6791.78,-4838.32 7963.28,-4784.25 8495.24,-4759.7"/>
<polygon fill="black" stroke="black" points="8495.53,-4763.19 8505.36,-4759.23 8495.21,-4756.19 8495.53,-4763.19"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp5 -->
<g id="edge1819" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp5</title>
<path fill="none" stroke="black" d="M5833.45,-4866.54C5312.61,-4855.18 4025.29,-4826.65 2947.42,-4799.18 2392.65,-4785.04 1745.54,-4766.67 1375.21,-4755.97"/>
<polygon fill="black" stroke="black" points="1375.25,-4752.47 1365.15,-4755.68 1375.05,-4759.47 1375.25,-4752.47"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp6 -->
<g id="edge1821" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp6</title>
<path fill="none" stroke="black" d="M6307.78,-4869.62C7105.16,-4862.51 9675.69,-4837.15 10503.42,-4799.18 10646.34,-4792.62 10805.64,-4780.89 10935.04,-4770.23"/>
<polygon fill="black" stroke="black" points="10935.41,-4773.71 10945.09,-4769.39 10934.84,-4766.73 10935.41,-4773.71"/>
</g>
<!-- AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp7 -->
<g id="edge1823" class="edge">
<title>AR_exp_s1_l12&#45;&gt;ResMOE_s1_l12_tp7</title>
<path fill="none" stroke="black" d="M6306.75,-4868.23C6820.71,-4860.33 8075.03,-4838.43 9125.42,-4799.18 9380.68,-4789.64 9671.69,-4774.35 9877.19,-4762.81"/>
<polygon fill="black" stroke="black" points="9877.43,-4766.3 9887.21,-4762.25 9877.03,-4759.32 9877.43,-4766.3"/>
</g>
<!-- QKV_s1_l13_tp0 -->
<g id="node1094" class="node">
<title>QKV_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5099.42,-4657.18 4761.42,-4657.18 4761.42,-4604.18 5099.42,-4604.18 5099.42,-4657.18"/>
<text text-anchor="middle" x="4930.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4930.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4930.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp0 -->
<g id="edge1825" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5546.56,-4705.44C5419.98,-4690.36 5274.54,-4673 5142.42,-4657.18 5131.78,-4655.91 5120.85,-4654.59 5109.81,-4653.27"/>
<polygon fill="black" stroke="black" points="5110,-4649.77 5099.65,-4652.05 5109.17,-4656.72 5110,-4649.77"/>
</g>
<!-- QKV_s1_l13_tp1 -->
<g id="node1095" class="node">
<title>QKV_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="5489.42,-4657.18 5151.42,-4657.18 5151.42,-4604.18 5489.42,-4604.18 5489.42,-4657.18"/>
<text text-anchor="middle" x="5320.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5320.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5320.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp1 -->
<g id="edge1826" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5623.78,-4693.16C5566.04,-4681.46 5506.98,-4669.49 5456.49,-4659.26"/>
<polygon fill="black" stroke="black" points="5457,-4655.79 5446.51,-4657.23 5455.61,-4662.65 5457,-4655.79"/>
</g>
<!-- QKV_s1_l13_tp2 -->
<g id="node1096" class="node">
<title>QKV_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="5870.42,-4657.18 5532.42,-4657.18 5532.42,-4604.18 5870.42,-4604.18 5870.42,-4657.18"/>
<text text-anchor="middle" x="5701.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5701.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5701.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp2 -->
<g id="edge1827" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5798.26,-4693.08C5781.82,-4682.66 5765.04,-4672.02 5750.18,-4662.59"/>
<polygon fill="black" stroke="black" points="5751.98,-4659.59 5741.66,-4657.19 5748.23,-4665.5 5751.98,-4659.59"/>
</g>
<!-- QKV_s1_l13_tp3 -->
<g id="node1097" class="node">
<title>QKV_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6235.42,-4657.18 5897.42,-4657.18 5897.42,-4604.18 6235.42,-4604.18 6235.42,-4657.18"/>
<text text-anchor="middle" x="6066.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6066.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6066.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp3 -->
<g id="edge1828" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M5965.8,-4693.08C5982.89,-4682.66 6000.31,-4672.02 6015.76,-4662.59"/>
<polygon fill="black" stroke="black" points="6017.9,-4665.39 6024.61,-4657.19 6014.25,-4659.41 6017.9,-4665.39"/>
</g>
<!-- QKV_s1_l13_tp4 -->
<g id="node1098" class="node">
<title>QKV_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="6616.42,-4657.18 6278.42,-4657.18 6278.42,-4604.18 6616.42,-4604.18 6616.42,-4657.18"/>
<text text-anchor="middle" x="6447.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6447.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6447.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp4 -->
<g id="edge1829" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6098.83,-4701.46C6169.75,-4687.26 6246.42,-4671.92 6309.74,-4659.24"/>
<polygon fill="black" stroke="black" points="6310.67,-4662.62 6319.79,-4657.23 6309.3,-4655.76 6310.67,-4662.62"/>
</g>
<!-- QKV_s1_l13_tp5 -->
<g id="node1099" class="node">
<title>QKV_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="7002.42,-4657.18 6664.42,-4657.18 6664.42,-4604.18 7002.42,-4604.18 7002.42,-4657.18"/>
<text text-anchor="middle" x="6833.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6833.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6833.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp5 -->
<g id="edge1830" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M6119.93,-4717.16C6266.01,-4700 6456.52,-4677.51 6625.42,-4657.18 6634.81,-4656.05 6644.43,-4654.89 6654.14,-4653.71"/>
<polygon fill="black" stroke="black" points="6654.78,-4657.16 6664.29,-4652.48 6653.94,-4650.21 6654.78,-4657.16"/>
</g>
<!-- QKV_s1_l13_tp6 -->
<g id="node1100" class="node">
<title>QKV_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="7390.42,-4657.18 7052.42,-4657.18 7052.42,-4604.18 7390.42,-4604.18 7390.42,-4657.18"/>
<text text-anchor="middle" x="7221.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7221.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7221.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp6 -->
<g id="edge1831" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M6120.39,-4717.31C6199.89,-4708.72 6288.89,-4699.79 6370.42,-4693.18 6654.83,-4670.12 6727.2,-4682.39 7011.42,-4657.18 7021.47,-4656.29 7031.78,-4655.29 7042.18,-4654.23"/>
<polygon fill="black" stroke="black" points="7042.59,-4657.71 7052.18,-4653.19 7041.87,-4650.74 7042.59,-4657.71"/>
</g>
<!-- QKV_s1_l13_tp7 -->
<g id="node1101" class="node">
<title>QKV_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="4717.42,-4657.18 4379.42,-4657.18 4379.42,-4604.18 4717.42,-4604.18 4717.42,-4657.18"/>
<text text-anchor="middle" x="4548.42" y="-4641.98" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4548.42" y="-4626.98" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4548.42" y="-4611.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp7 -->
<g id="edge1832" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;QKV_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M5573.07,-4725.08C5346.08,-4709.29 5029.68,-4685.31 4752.42,-4657.18 4744.34,-4656.36 4736.09,-4655.49 4727.76,-4654.57"/>
<polygon fill="black" stroke="black" points="4727.88,-4651.06 4717.56,-4653.44 4727.11,-4658.02 4727.88,-4651.06"/>
</g>
<!-- ResAttn_s1_l13_tp0 -->
<g id="node1128" class="node">
<title>ResAttn_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5276.77,-4079.27 4719.45,-4079.27 4576.08,-3973.27 5133.4,-3973.27 5276.77,-4079.27"/>
<text text-anchor="middle" x="4926.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4926.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4926.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp0 -->
<g id="edge1874" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5568.15,-4721.57C5436.48,-4712.04 5281.53,-4701.38 5141.42,-4693.18 5055.81,-4688.17 4442.9,-4703.02 4370.42,-4657.18 4321.69,-4626.36 4309.42,-4600.34 4309.42,-4542.68 4309.42,-4542.68 4309.42,-4542.68 4309.42,-4240.75 4309.42,-4157.29 4513.6,-4099.21 4687.05,-4064.92"/>
<polygon fill="black" stroke="black" points="4687.97,-4068.31 4697.11,-4062.95 4686.63,-4061.44 4687.97,-4068.31"/>
</g>
<!-- ResAttn_s1_l13_tp1 -->
<g id="node1129" class="node">
<title>ResAttn_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="3417.77,-4079.27 2860.45,-4079.27 2717.08,-3973.27 3274.4,-3973.27 3417.77,-4079.27"/>
<text text-anchor="middle" x="3067.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3067.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3067.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp1 -->
<g id="edge1876" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5566.4,-4720.25C5435.13,-4710.57 5280.96,-4700.15 5141.42,-4693.18 4600.97,-4666.18 4462.71,-4712.55 3924.42,-4657.18 3779.39,-4642.26 3278.42,-4688.47 3278.42,-4542.68 3278.42,-4542.68 3278.42,-4542.68 3278.42,-4240.75 3278.42,-4174.72 3226.72,-4121.75 3174.5,-4085.09"/>
<polygon fill="black" stroke="black" points="3176.35,-4082.12 3166.13,-4079.35 3172.4,-4087.89 3176.35,-4082.12"/>
</g>
<!-- ResAttn_s1_l13_tp2 -->
<g id="node1130" class="node">
<title>ResAttn_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4265.77,-4079.27 3708.45,-4079.27 3565.08,-3973.27 4122.4,-3973.27 4265.77,-4079.27"/>
<text text-anchor="middle" x="3915.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3915.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3915.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp2 -->
<g id="edge1878" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5568.16,-4721.36C5436.49,-4711.79 5281.55,-4701.17 5141.42,-4693.18 4775,-4672.3 4678.7,-4715.97 4316.42,-4657.18 4133.47,-4627.49 3915.42,-4728.03 3915.42,-4542.68 3915.42,-4542.68 3915.42,-4542.68 3915.42,-4240.75 3915.42,-4189.91 3915.42,-4132.25 3915.42,-4089.68"/>
<polygon fill="black" stroke="black" points="3918.92,-4089.47 3915.42,-4079.47 3911.92,-4089.47 3918.92,-4089.47"/>
</g>
<!-- ResAttn_s1_l13_tp3 -->
<g id="node1131" class="node">
<title>ResAttn_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="7244.77,-4079.27 6687.45,-4079.27 6544.08,-3973.27 7101.4,-3973.27 7244.77,-4079.27"/>
<text text-anchor="middle" x="6894.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6894.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6894.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp3 -->
<g id="edge1880" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6119.07,-4716.43C6198.88,-4707.73 6288.39,-4698.96 6370.42,-4693.18 6427.48,-4689.16 7350.21,-4686.34 7399.42,-4657.18 7450.34,-4627.01 7467.42,-4601.87 7467.42,-4542.68 7467.42,-4542.68 7467.42,-4542.68 7467.42,-4240.75 7467.42,-4178.15 7453.82,-4152.42 7403.42,-4115.27 7372.51,-4092.49 7305.3,-4075.1 7229.54,-4062.04"/>
<polygon fill="black" stroke="black" points="7229.73,-4058.53 7219.29,-4060.31 7228.57,-4065.43 7229.73,-4058.53"/>
</g>
<!-- ResAttn_s1_l13_tp4 -->
<g id="node1132" class="node">
<title>ResAttn_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="8211.77,-4079.27 7654.45,-4079.27 7511.08,-3973.27 8068.4,-3973.27 8211.77,-4079.27"/>
<text text-anchor="middle" x="7861.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7861.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7861.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp4 -->
<g id="edge1882" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6119.07,-4716.37C6198.88,-4707.66 6288.39,-4698.9 6370.42,-4693.18 6536.53,-4681.59 7861.42,-4709.19 7861.42,-4542.68 7861.42,-4542.68 7861.42,-4542.68 7861.42,-4240.75 7861.42,-4189.91 7861.42,-4132.25 7861.42,-4089.68"/>
<polygon fill="black" stroke="black" points="7864.92,-4089.47 7861.42,-4079.47 7857.92,-4089.47 7864.92,-4089.47"/>
</g>
<!-- ResAttn_s1_l13_tp5 -->
<g id="node1133" class="node">
<title>ResAttn_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="2276.77,-4079.27 1719.45,-4079.27 1576.08,-3973.27 2133.4,-3973.27 2276.77,-4079.27"/>
<text text-anchor="middle" x="1926.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1926.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1926.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp5 -->
<g id="edge1884" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M5565.52,-4719.5C5434.46,-4709.73 5280.67,-4699.45 5141.42,-4693.18 4990.68,-4686.39 2429.42,-4693.58 2429.42,-4542.68 2429.42,-4542.68 2429.42,-4542.68 2429.42,-4240.75 2429.42,-4176.6 2289.04,-4120.65 2156.61,-4082.14"/>
<polygon fill="black" stroke="black" points="2157.26,-4078.69 2146.68,-4079.28 2155.32,-4085.41 2157.26,-4078.69"/>
</g>
<!-- ResAttn_s1_l13_tp6 -->
<g id="node1134" class="node">
<title>ResAttn_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="10354.77,-4079.27 9797.45,-4079.27 9654.08,-3973.27 10211.4,-3973.27 10354.77,-4079.27"/>
<text text-anchor="middle" x="10004.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10004.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10004.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp6 -->
<g id="edge1886" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M6118.09,-4715.87C6198.13,-4707.09 6288.04,-4698.41 6370.42,-4693.18 6518.64,-4683.76 9039.42,-4691.19 9039.42,-4542.68 9039.42,-4542.68 9039.42,-4542.68 9039.42,-4240.75 9039.42,-4098.94 9441.71,-4051.26 9726.81,-4035.27"/>
<polygon fill="black" stroke="black" points="9727.11,-4038.76 9736.9,-4034.72 9726.72,-4031.77 9727.11,-4038.76"/>
</g>
<!-- ResAttn_s1_l13_tp7 -->
<g id="node1135" class="node">
<title>ResAttn_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="9205.77,-4079.27 8648.45,-4079.27 8505.08,-3973.27 9062.4,-3973.27 9205.77,-4079.27"/>
<text text-anchor="middle" x="8855.42" y="-4037.57" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8855.42" y="-4022.57" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8855.42" y="-4007.57" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp7 -->
<g id="edge1888" class="edge">
<title>ResMOE_s1_l12_tp0&#45;&gt;ResAttn_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M6118.74,-4716.14C6198.62,-4707.4 6288.27,-4698.69 6370.42,-4693.18 6937.38,-4655.17 7082.06,-4703.17 7648.42,-4657.18 7838.39,-4641.75 8498.42,-4733.27 8498.42,-4542.68 8498.42,-4542.68 8498.42,-4542.68 8498.42,-4240.75 8498.42,-4162.84 8561.83,-4112.68 8635.19,-4080.72"/>
<polygon fill="black" stroke="black" points="8636.81,-4083.84 8644.66,-4076.72 8634.08,-4077.39 8636.81,-4083.84"/>
</g>
<!-- SplitHeads_s1_l13_tp0 -->
<g id="node1102" class="node">
<title>SplitHeads_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5099.42,-4568.18 4727.42,-4568.18 4727.42,-4515.18 5099.42,-4515.18 5099.42,-4568.18"/>
<text text-anchor="middle" x="4913.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4913.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4913.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp0&#45;&gt;SplitHeads_s1_l13_tp0 -->
<g id="edge1833" class="edge">
<title>QKV_s1_l13_tp0&#45;&gt;SplitHeads_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M4925.41,-4604.05C4923.84,-4595.98 4922.07,-4586.92 4920.38,-4578.28"/>
<polygon fill="black" stroke="black" points="4923.81,-4577.57 4918.45,-4568.43 4916.94,-4578.92 4923.81,-4577.57"/>
</g>
<!-- SplitHeads_s1_l13_tp1 -->
<g id="node1103" class="node">
<title>SplitHeads_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="5489.42,-4568.18 5117.42,-4568.18 5117.42,-4515.18 5489.42,-4515.18 5489.42,-4568.18"/>
<text text-anchor="middle" x="5303.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5303.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5303.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp1&#45;&gt;SplitHeads_s1_l13_tp1 -->
<g id="edge1834" class="edge">
<title>QKV_s1_l13_tp1&#45;&gt;SplitHeads_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5315.41,-4604.05C5313.84,-4595.98 5312.07,-4586.92 5310.38,-4578.28"/>
<polygon fill="black" stroke="black" points="5313.81,-4577.57 5308.45,-4568.43 5306.94,-4578.92 5313.81,-4577.57"/>
</g>
<!-- SplitHeads_s1_l13_tp2 -->
<g id="node1104" class="node">
<title>SplitHeads_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="5879.42,-4568.18 5507.42,-4568.18 5507.42,-4515.18 5879.42,-4515.18 5879.42,-4568.18"/>
<text text-anchor="middle" x="5693.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5693.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5693.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp2&#45;&gt;SplitHeads_s1_l13_tp2 -->
<g id="edge1835" class="edge">
<title>QKV_s1_l13_tp2&#45;&gt;SplitHeads_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5699.07,-4604.05C5698.33,-4596.07 5697.51,-4587.11 5696.72,-4578.56"/>
<polygon fill="black" stroke="black" points="5700.19,-4578.07 5695.79,-4568.43 5693.22,-4578.71 5700.19,-4578.07"/>
</g>
<!-- SplitHeads_s1_l13_tp3 -->
<g id="node1105" class="node">
<title>SplitHeads_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6269.42,-4568.18 5897.42,-4568.18 5897.42,-4515.18 6269.42,-4515.18 6269.42,-4568.18"/>
<text text-anchor="middle" x="6083.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6083.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6083.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp3&#45;&gt;SplitHeads_s1_l13_tp3 -->
<g id="edge1836" class="edge">
<title>QKV_s1_l13_tp3&#45;&gt;SplitHeads_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6071.43,-4604.05C6073.01,-4595.98 6074.78,-4586.92 6076.47,-4578.28"/>
<polygon fill="black" stroke="black" points="6079.91,-4578.92 6078.39,-4568.43 6073.04,-4577.57 6079.91,-4578.92"/>
</g>
<!-- SplitHeads_s1_l13_tp4 -->
<g id="node1106" class="node">
<title>SplitHeads_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="6659.42,-4568.18 6287.42,-4568.18 6287.42,-4515.18 6659.42,-4515.18 6659.42,-4568.18"/>
<text text-anchor="middle" x="6473.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6473.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6473.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp4&#45;&gt;SplitHeads_s1_l13_tp4 -->
<g id="edge1837" class="edge">
<title>QKV_s1_l13_tp4&#45;&gt;SplitHeads_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6455.08,-4604.05C6457.49,-4595.98 6460.2,-4586.92 6462.78,-4578.28"/>
<polygon fill="black" stroke="black" points="6466.22,-4579.01 6465.73,-4568.43 6459.51,-4577.01 6466.22,-4579.01"/>
</g>
<!-- SplitHeads_s1_l13_tp5 -->
<g id="node1107" class="node">
<title>SplitHeads_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="7049.42,-4568.18 6677.42,-4568.18 6677.42,-4515.18 7049.42,-4515.18 7049.42,-4568.18"/>
<text text-anchor="middle" x="6863.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6863.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6863.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp5&#45;&gt;SplitHeads_s1_l13_tp5 -->
<g id="edge1838" class="edge">
<title>QKV_s1_l13_tp5&#45;&gt;SplitHeads_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M6842.26,-4604.05C6845.07,-4595.89 6848.24,-4586.72 6851.24,-4578"/>
<polygon fill="black" stroke="black" points="6854.59,-4579.02 6854.54,-4568.43 6847.97,-4576.74 6854.59,-4579.02"/>
</g>
<!-- SplitHeads_s1_l13_tp6 -->
<g id="node1108" class="node">
<title>SplitHeads_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="7439.42,-4568.18 7067.42,-4568.18 7067.42,-4515.18 7439.42,-4515.18 7439.42,-4568.18"/>
<text text-anchor="middle" x="7253.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7253.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7253.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp6&#45;&gt;SplitHeads_s1_l13_tp6 -->
<g id="edge1839" class="edge">
<title>QKV_s1_l13_tp6&#45;&gt;SplitHeads_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M7230.85,-4604.05C7233.85,-4595.89 7237.22,-4586.72 7240.43,-4578"/>
<polygon fill="black" stroke="black" points="7243.78,-4579.02 7243.95,-4568.43 7237.21,-4576.61 7243.78,-4579.02"/>
</g>
<!-- SplitHeads_s1_l13_tp7 -->
<g id="node1109" class="node">
<title>SplitHeads_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="4709.42,-4568.18 4337.42,-4568.18 4337.42,-4515.18 4709.42,-4515.18 4709.42,-4568.18"/>
<text text-anchor="middle" x="4523.42" y="-4552.98" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4523.42" y="-4537.98" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4523.42" y="-4522.98" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l13_tp7&#45;&gt;SplitHeads_s1_l13_tp7 -->
<g id="edge1840" class="edge">
<title>QKV_s1_l13_tp7&#45;&gt;SplitHeads_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M4541.06,-4604.05C4538.74,-4595.98 4536.13,-4586.92 4533.65,-4578.28"/>
<polygon fill="black" stroke="black" points="4536.95,-4577.07 4530.82,-4568.43 4530.22,-4579.01 4536.95,-4577.07"/>
</g>
<!-- A2A_s1_l13 -->
<g id="node1110" class="node">
<title>A2A_s1_l13</title>
<ellipse fill="none" stroke="black" cx="5888.42" cy="-4441.7" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5888.42" y="-4453" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="5888.42" y="-4438" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5888.42" y="-4423" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l13_tp0&#45;&gt;A2A_s1_l13 -->
<g id="edge1841" class="edge">
<title>SplitHeads_s1_l13_tp0&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M5099.45,-4516.2C5102.46,-4515.85 5105.45,-4515.51 5108.42,-4515.18 5291.43,-4494.72 5499.05,-4475.63 5654.05,-4462.18"/>
<polygon fill="black" stroke="black" points="5654.53,-4465.65 5664.19,-4461.3 5653.92,-4458.68 5654.53,-4465.65"/>
</g>
<!-- SplitHeads_s1_l13_tp1&#45;&gt;A2A_s1_l13 -->
<g id="edge1842" class="edge">
<title>SplitHeads_s1_l13_tp1&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M5455.98,-4515.13C5534.22,-4502.03 5629.93,-4486 5711.41,-4472.35"/>
<polygon fill="black" stroke="black" points="5711.99,-4475.8 5721.27,-4470.7 5710.83,-4468.9 5711.99,-4475.8"/>
</g>
<!-- SplitHeads_s1_l13_tp2&#45;&gt;A2A_s1_l13 -->
<g id="edge1843" class="edge">
<title>SplitHeads_s1_l13_tp2&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M5744.4,-4515.07C5764.24,-4505.1 5787.43,-4493.45 5809.33,-4482.44"/>
<polygon fill="black" stroke="black" points="5810.94,-4485.55 5818.3,-4477.93 5807.8,-4479.3 5810.94,-4485.55"/>
</g>
<!-- SplitHeads_s1_l13_tp3&#45;&gt;A2A_s1_l13 -->
<g id="edge1844" class="edge">
<title>SplitHeads_s1_l13_tp3&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M6032.44,-4515.07C6012.61,-4505.1 5989.42,-4493.45 5967.51,-4482.44"/>
<polygon fill="black" stroke="black" points="5969.05,-4479.3 5958.54,-4477.93 5965.91,-4485.55 5969.05,-4479.3"/>
</g>
<!-- SplitHeads_s1_l13_tp4&#45;&gt;A2A_s1_l13 -->
<g id="edge1845" class="edge">
<title>SplitHeads_s1_l13_tp4&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M6320.87,-4515.13C6242.63,-4502.03 6146.91,-4486 6065.44,-4472.35"/>
<polygon fill="black" stroke="black" points="6066.02,-4468.9 6055.58,-4470.7 6064.86,-4475.8 6066.02,-4468.9"/>
</g>
<!-- SplitHeads_s1_l13_tp5&#45;&gt;A2A_s1_l13 -->
<g id="edge1846" class="edge">
<title>SplitHeads_s1_l13_tp5&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M6677.4,-4516.2C6674.39,-4515.85 6671.39,-4515.51 6668.42,-4515.18 6485.42,-4494.72 6277.79,-4475.63 6122.79,-4462.18"/>
<polygon fill="black" stroke="black" points="6122.92,-4458.68 6112.66,-4461.3 6122.32,-4465.65 6122.92,-4458.68"/>
</g>
<!-- SplitHeads_s1_l13_tp6&#45;&gt;A2A_s1_l13 -->
<g id="edge1847" class="edge">
<title>SplitHeads_s1_l13_tp6&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M7067.41,-4516.07C7064.39,-4515.76 7061.4,-4515.47 7058.42,-4515.18 6746.38,-4485.15 6386.25,-4465.02 6148.88,-4453.74"/>
<polygon fill="black" stroke="black" points="6148.88,-4450.24 6138.73,-4453.26 6148.55,-4457.23 6148.88,-4450.24"/>
</g>
<!-- SplitHeads_s1_l13_tp7&#45;&gt;A2A_s1_l13 -->
<g id="edge1848" class="edge">
<title>SplitHeads_s1_l13_tp7&#45;&gt;A2A_s1_l13</title>
<path fill="none" stroke="black" d="M4709.43,-4516.07C4712.45,-4515.76 4715.45,-4515.47 4718.42,-4515.18 5030.47,-4485.15 5390.6,-4465.02 5627.96,-4453.74"/>
<polygon fill="black" stroke="black" points="5628.29,-4457.23 5638.12,-4453.26 5627.96,-4450.24 5628.29,-4457.23"/>
</g>
<!-- Attn_s1_l13_tp0 -->
<g id="node1111" class="node">
<title>Attn_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5099.42,-4368.23 4727.42,-4368.23 4727.42,-4315.23 5099.42,-4315.23 5099.42,-4368.23"/>
<text text-anchor="middle" x="4913.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4913.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4913.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp0 -->
<g id="edge1849" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5664.19,-4422.1C5510.85,-4408.85 5302.7,-4389.8 5109.51,-4368.33"/>
<polygon fill="black" stroke="black" points="5109.77,-4364.84 5099.45,-4367.21 5109,-4371.8 5109.77,-4364.84"/>
</g>
<!-- Attn_s1_l13_tp1 -->
<g id="node1112" class="node">
<title>Attn_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="5489.42,-4368.23 5117.42,-4368.23 5117.42,-4315.23 5489.42,-4315.23 5489.42,-4368.23"/>
<text text-anchor="middle" x="5303.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5303.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5303.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp1 -->
<g id="edge1850" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5721.18,-4412.69C5641.03,-4399.27 5545.42,-4383.26 5465.9,-4369.94"/>
<polygon fill="black" stroke="black" points="5466.23,-4366.44 5455.79,-4368.24 5465.07,-4373.35 5466.23,-4366.44"/>
</g>
<!-- Attn_s1_l13_tp2 -->
<g id="node1113" class="node">
<title>Attn_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="5879.42,-4368.23 5507.42,-4368.23 5507.42,-4315.23 5879.42,-4315.23 5879.42,-4368.23"/>
<text text-anchor="middle" x="5693.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5693.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5693.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp2 -->
<g id="edge1851" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5818.3,-4405.47C5796.99,-4394.77 5773.79,-4383.11 5753.23,-4372.78"/>
<polygon fill="black" stroke="black" points="5754.8,-4369.65 5744.29,-4368.28 5751.65,-4375.9 5754.8,-4369.65"/>
</g>
<!-- Attn_s1_l13_tp3 -->
<g id="node1114" class="node">
<title>Attn_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6269.42,-4368.23 5897.42,-4368.23 5897.42,-4315.23 6269.42,-4315.23 6269.42,-4368.23"/>
<text text-anchor="middle" x="6083.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6083.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6083.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp3 -->
<g id="edge1852" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M5958.55,-4405.47C5979.85,-4394.77 6003.06,-4383.11 6023.62,-4372.78"/>
<polygon fill="black" stroke="black" points="6025.19,-4375.9 6032.55,-4368.28 6022.05,-4369.65 6025.19,-4375.9"/>
</g>
<!-- Attn_s1_l13_tp4 -->
<g id="node1115" class="node">
<title>Attn_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="6659.42,-4368.23 6287.42,-4368.23 6287.42,-4315.23 6659.42,-4315.23 6659.42,-4368.23"/>
<text text-anchor="middle" x="6473.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6473.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6473.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp4 -->
<g id="edge1853" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6055.67,-4412.69C6135.81,-4399.27 6231.43,-4383.26 6310.95,-4369.94"/>
<polygon fill="black" stroke="black" points="6311.77,-4373.35 6321.06,-4368.24 6310.62,-4366.44 6311.77,-4373.35"/>
</g>
<!-- Attn_s1_l13_tp5 -->
<g id="node1116" class="node">
<title>Attn_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="7049.42,-4368.23 6677.42,-4368.23 6677.42,-4315.23 7049.42,-4315.23 7049.42,-4368.23"/>
<text text-anchor="middle" x="6863.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6863.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6863.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp5 -->
<g id="edge1854" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M6112.66,-4422.1C6266,-4408.85 6474.14,-4389.8 6667.34,-4368.33"/>
<polygon fill="black" stroke="black" points="6667.85,-4371.8 6677.4,-4367.21 6667.07,-4364.84 6667.85,-4371.8"/>
</g>
<!-- Attn_s1_l13_tp6 -->
<g id="node1117" class="node">
<title>Attn_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="7439.42,-4368.23 7067.42,-4368.23 7067.42,-4315.23 7439.42,-4315.23 7439.42,-4368.23"/>
<text text-anchor="middle" x="7253.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7253.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7253.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp6 -->
<g id="edge1855" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M6138.73,-4430.14C6373.46,-4419.08 6734.4,-4399.11 7057.39,-4368.3"/>
<polygon fill="black" stroke="black" points="7057.79,-4371.78 7067.41,-4367.34 7057.12,-4364.81 7057.79,-4371.78"/>
</g>
<!-- Attn_s1_l13_tp7 -->
<g id="node1118" class="node">
<title>Attn_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="4709.42,-4368.23 4337.42,-4368.23 4337.42,-4315.23 4709.42,-4315.23 4709.42,-4368.23"/>
<text text-anchor="middle" x="4523.42" y="-4353.03" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4523.42" y="-4338.03" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4523.42" y="-4323.03" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l13&#45;&gt;Attn_s1_l13_tp7 -->
<g id="edge1856" class="edge">
<title>A2A_s1_l13&#45;&gt;Attn_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M5638.12,-4430.14C5403.38,-4419.08 5042.44,-4399.11 4719.46,-4368.3"/>
<polygon fill="black" stroke="black" points="4719.72,-4364.81 4709.43,-4367.34 4719.05,-4371.78 4719.72,-4364.81"/>
</g>
<!-- AR_attn_s1_l13 -->
<g id="node1119" class="node">
<title>AR_attn_s1_l13</title>
<ellipse fill="none" stroke="black" cx="5922.42" cy="-4241.75" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5922.42" y="-4253.05" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="5922.42" y="-4238.05" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5922.42" y="-4223.05" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l13_tp0&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1857" class="edge">
<title>Attn_s1_l13_tp0&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M5099.44,-4316.23C5102.46,-4315.89 5105.45,-4315.55 5108.42,-4315.23 5301.99,-4293.96 5521.98,-4274.67 5684.42,-4261.34"/>
<polygon fill="black" stroke="black" points="5684.86,-4264.82 5694.54,-4260.51 5684.29,-4257.84 5684.86,-4264.82"/>
</g>
<!-- Attn_s1_l13_tp1&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1858" class="edge">
<title>Attn_s1_l13_tp1&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M5464.85,-4315.18C5549.18,-4301.83 5652.7,-4285.44 5739.94,-4271.63"/>
<polygon fill="black" stroke="black" points="5740.62,-4275.07 5749.95,-4270.05 5739.53,-4268.16 5740.62,-4275.07"/>
</g>
<!-- Attn_s1_l13_tp2&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1859" class="edge">
<title>Attn_s1_l13_tp2&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M5753.29,-4315.11C5777.35,-4304.82 5805.62,-4292.72 5832.09,-4281.4"/>
<polygon fill="black" stroke="black" points="5833.55,-4284.58 5841.37,-4277.43 5830.79,-4278.15 5833.55,-4284.58"/>
</g>
<!-- Attn_s1_l13_tp3&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1860" class="edge">
<title>Attn_s1_l13_tp3&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M6041.12,-4314.98C6025.49,-4305.47 6007.36,-4294.44 5990.05,-4283.9"/>
<polygon fill="black" stroke="black" points="5991.45,-4280.66 5981.08,-4278.45 5987.81,-4286.64 5991.45,-4280.66"/>
</g>
<!-- Attn_s1_l13_tp4&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1861" class="edge">
<title>Attn_s1_l13_tp4&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M6329.73,-4315.18C6257.56,-4302.34 6169.6,-4286.7 6093.92,-4273.24"/>
<polygon fill="black" stroke="black" points="6094.26,-4269.75 6083.8,-4271.45 6093.03,-4276.64 6094.26,-4269.75"/>
</g>
<!-- Attn_s1_l13_tp5&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1862" class="edge">
<title>Attn_s1_l13_tp5&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M6677.4,-4316.26C6674.38,-4315.91 6671.39,-4315.56 6668.42,-4315.23 6495.91,-4295.57 6300.56,-4276.72 6153.05,-4263.17"/>
<polygon fill="black" stroke="black" points="6153.24,-4259.67 6142.96,-4262.24 6152.6,-4266.64 6153.24,-4259.67"/>
</g>
<!-- Attn_s1_l13_tp6&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1863" class="edge">
<title>Attn_s1_l13_tp6&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M7067.41,-4316.12C7064.39,-4315.81 7061.4,-4315.52 7058.42,-4315.23 6758.25,-4286.06 6412.27,-4265.91 6181.76,-4254.39"/>
<polygon fill="black" stroke="black" points="6181.72,-4250.89 6171.56,-4253.89 6181.37,-4257.88 6181.72,-4250.89"/>
</g>
<!-- Attn_s1_l13_tp7&#45;&gt;AR_attn_s1_l13 -->
<g id="edge1864" class="edge">
<title>Attn_s1_l13_tp7&#45;&gt;AR_attn_s1_l13</title>
<path fill="none" stroke="black" d="M4709.43,-4316.11C4712.45,-4315.8 4715.45,-4315.51 4718.42,-4315.23 5042.39,-4284.33 5416.72,-4264.24 5660.88,-4253.22"/>
<polygon fill="black" stroke="black" points="5661.13,-4256.71 5670.96,-4252.76 5660.81,-4249.72 5661.13,-4256.71"/>
</g>
<!-- O_s1_l13_tp0 -->
<g id="node1120" class="node">
<title>O_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5513.42,-4168.27 5175.42,-4168.27 5175.42,-4115.27 5513.42,-4115.27 5513.42,-4168.27"/>
<text text-anchor="middle" x="5344.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5344.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5344.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp0 -->
<g id="edge1865" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5756.4,-4212.61C5677.4,-4199.22 5583.32,-4183.27 5505.02,-4170"/>
<polygon fill="black" stroke="black" points="5505.51,-4166.53 5495.06,-4168.31 5504.34,-4173.43 5505.51,-4166.53"/>
</g>
<!-- O_s1_l13_tp1 -->
<g id="node1121" class="node">
<title>O_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="4281.42,-4168.27 3943.42,-4168.27 3943.42,-4115.27 4281.42,-4115.27 4281.42,-4168.27"/>
<text text-anchor="middle" x="4112.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4112.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4112.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp1 -->
<g id="edge1866" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5678.79,-4227.56C5309.82,-4207.59 4617.81,-4170.13 4291.45,-4152.46"/>
<polygon fill="black" stroke="black" points="4291.6,-4148.97 4281.42,-4151.92 4291.22,-4155.96 4291.6,-4148.97"/>
</g>
<!-- O_s1_l13_tp2 -->
<g id="node1122" class="node">
<title>O_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4996.42,-4168.27 4658.42,-4168.27 4658.42,-4115.27 4996.42,-4115.27 4996.42,-4168.27"/>
<text text-anchor="middle" x="4827.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4827.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4827.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp2 -->
<g id="edge1867" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5702.81,-4221.1C5498.26,-4202.8 5197.03,-4175.84 5006.62,-4158.81"/>
<polygon fill="black" stroke="black" points="5006.78,-4155.31 4996.51,-4157.9 5006.16,-4162.28 5006.78,-4155.31"/>
</g>
<!-- O_s1_l13_tp3 -->
<g id="node1123" class="node">
<title>O_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6949.42,-4168.27 6611.42,-4168.27 6611.42,-4115.27 6949.42,-4115.27 6949.42,-4168.27"/>
<text text-anchor="middle" x="6780.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6780.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6780.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp3 -->
<g id="edge1868" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6124.4,-4217.69C6268.91,-4201.18 6461.69,-4179.17 6600.84,-4163.28"/>
<polygon fill="black" stroke="black" points="6601.65,-4166.71 6611.19,-4162.1 6600.85,-4159.76 6601.65,-4166.71"/>
</g>
<!-- O_s1_l13_tp4 -->
<g id="node1124" class="node">
<title>O_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="7394.42,-4168.27 7056.42,-4168.27 7056.42,-4115.27 7394.42,-4115.27 7394.42,-4168.27"/>
<text text-anchor="middle" x="7225.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7225.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7225.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp4 -->
<g id="edge1869" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6160.7,-4225.8C6370.76,-4212.22 6685.07,-4190.88 6958.42,-4168.27 6986.75,-4165.93 7016.76,-4163.25 7046.03,-4160.54"/>
<polygon fill="black" stroke="black" points="7046.71,-4163.99 7056.34,-4159.57 7046.06,-4157.02 7046.71,-4163.99"/>
</g>
<!-- O_s1_l13_tp5 -->
<g id="node1125" class="node">
<title>O_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="3806.42,-4168.27 3468.42,-4168.27 3468.42,-4115.27 3806.42,-4115.27 3806.42,-4168.27"/>
<text text-anchor="middle" x="3637.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3637.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3637.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp5 -->
<g id="edge1870" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M5662.9,-4235.36C5283.15,-4226.55 4553.85,-4206.13 3934.42,-4168.27 3896.37,-4165.95 3855.62,-4162.85 3816.88,-4159.61"/>
<polygon fill="black" stroke="black" points="3816.81,-4156.1 3806.55,-4158.74 3816.22,-4163.07 3816.81,-4156.1"/>
</g>
<!-- O_s1_l13_tp6 -->
<g id="node1126" class="node">
<title>O_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="8389.42,-4168.27 8051.42,-4168.27 8051.42,-4115.27 8389.42,-4115.27 8389.42,-4168.27"/>
<text text-anchor="middle" x="8220.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8220.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8220.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp6 -->
<g id="edge1871" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M6179.13,-4233.48C6547.48,-4222.49 7247.2,-4199.58 7842.42,-4168.27 7907.26,-4164.86 7978.31,-4160.29 8041.13,-4155.96"/>
<polygon fill="black" stroke="black" points="8041.4,-4159.45 8051.14,-4155.27 8040.92,-4152.47 8041.4,-4159.45"/>
</g>
<!-- O_s1_l13_tp7 -->
<g id="node1127" class="node">
<title>O_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="7833.42,-4168.27 7495.42,-4168.27 7495.42,-4115.27 7833.42,-4115.27 7833.42,-4168.27"/>
<text text-anchor="middle" x="7664.42" y="-4153.07" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7664.42" y="-4138.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="7664.42" y="-4123.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l13&#45;&gt;O_s1_l13_tp7 -->
<g id="edge1872" class="edge">
<title>AR_attn_s1_l13&#45;&gt;O_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M6176.85,-4232.05C6472.07,-4221.09 6973.39,-4199.78 7403.42,-4168.27 7429.91,-4166.33 7457.88,-4163.95 7485.28,-4161.43"/>
<polygon fill="black" stroke="black" points="7485.71,-4164.91 7495.34,-4160.5 7485.06,-4157.94 7485.71,-4164.91"/>
</g>
<!-- O_s1_l13_tp0&#45;&gt;ResAttn_s1_l13_tp0 -->
<g id="edge1873" class="edge">
<title>O_s1_l13_tp0&#45;&gt;ResAttn_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5250.35,-4115.23C5213.87,-4105.32 5170.61,-4093.58 5127.77,-4081.95"/>
<polygon fill="black" stroke="black" points="5128.63,-4078.55 5118.07,-4079.31 5126.8,-4085.31 5128.63,-4078.55"/>
</g>
<!-- O_s1_l13_tp1&#45;&gt;ResAttn_s1_l13_tp1 -->
<g id="edge1875" class="edge">
<title>O_s1_l13_tp1&#45;&gt;ResAttn_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M3943.36,-4122.41C3798.58,-4106.69 3585.64,-4083.56 3405.97,-4064.04"/>
<polygon fill="black" stroke="black" points="3406.14,-4060.54 3395.82,-4062.94 3405.38,-4067.5 3406.14,-4060.54"/>
</g>
<!-- O_s1_l13_tp2&#45;&gt;ResAttn_s1_l13_tp2 -->
<g id="edge1877" class="edge">
<title>O_s1_l13_tp2&#45;&gt;ResAttn_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M4658.29,-4119.72C4547.25,-4105.9 4398,-4087.33 4262.4,-4070.46"/>
<polygon fill="black" stroke="black" points="4262.61,-4066.95 4252.25,-4069.19 4261.74,-4073.9 4262.61,-4066.95"/>
</g>
<!-- O_s1_l13_tp3&#45;&gt;ResAttn_s1_l13_tp3 -->
<g id="edge1879" class="edge">
<title>O_s1_l13_tp3&#45;&gt;ResAttn_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6806.29,-4115.02C6814.85,-4106.49 6824.77,-4096.62 6834.8,-4086.64"/>
<polygon fill="black" stroke="black" points="6837.48,-4088.91 6842.1,-4079.37 6832.54,-4083.95 6837.48,-4088.91"/>
</g>
<!-- O_s1_l13_tp4&#45;&gt;ResAttn_s1_l13_tp4 -->
<g id="edge1881" class="edge">
<title>O_s1_l13_tp4&#45;&gt;ResAttn_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M7368.55,-4115.23C7445,-4101.59 7541.02,-4084.45 7627.95,-4068.94"/>
<polygon fill="black" stroke="black" points="7628.73,-4072.35 7637.96,-4067.15 7627.5,-4065.46 7628.73,-4072.35"/>
</g>
<!-- O_s1_l13_tp5&#45;&gt;ResAttn_s1_l13_tp5 -->
<g id="edge1883" class="edge">
<title>O_s1_l13_tp5&#45;&gt;ResAttn_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M3468.32,-4129.59C3282.14,-4117.28 2973.93,-4096.89 2708.42,-4079.27 2555.79,-4069.15 2386.39,-4057.88 2244.4,-4048.44"/>
<polygon fill="black" stroke="black" points="2244.43,-4044.93 2234.22,-4047.76 2243.97,-4051.92 2244.43,-4044.93"/>
</g>
<!-- O_s1_l13_tp6&#45;&gt;ResAttn_s1_l13_tp6 -->
<g id="edge1885" class="edge">
<title>O_s1_l13_tp6&#45;&gt;ResAttn_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M8389.72,-4130.5C8587.55,-4118.45 8924.76,-4097.77 9214.42,-4079.27 9389.58,-4068.09 9586.56,-4055.12 9740.01,-4044.94"/>
<polygon fill="black" stroke="black" points="9740.31,-4048.43 9750.06,-4044.27 9739.85,-4041.44 9740.31,-4048.43"/>
</g>
<!-- O_s1_l13_tp7&#45;&gt;ResAttn_s1_l13_tp7 -->
<g id="edge1887" class="edge">
<title>O_s1_l13_tp7&#45;&gt;ResAttn_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M7833.48,-4124.66C8033.29,-4105.62 8367.83,-4073.74 8599.45,-4051.67"/>
<polygon fill="black" stroke="black" points="8600.09,-4055.12 8609.71,-4050.69 8599.42,-4048.15 8600.09,-4055.12"/>
</g>
<!-- Gate_s1_l13_tp0 -->
<g id="node1136" class="node">
<title>Gate_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5250.42,-3937.27 4912.42,-3937.27 4912.42,-3884.27 5250.42,-3884.27 5250.42,-3937.27"/>
<text text-anchor="middle" x="5081.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5081.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5081.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp0&#45;&gt;Gate_s1_l13_tp0 -->
<g id="edge1889" class="edge">
<title>ResAttn_s1_l13_tp0&#45;&gt;Gate_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M4997.57,-3973.17C5011.54,-3962.94 5025.79,-3952.51 5038.48,-3943.22"/>
<polygon fill="black" stroke="black" points="5040.58,-3946.02 5046.58,-3937.29 5036.44,-3940.37 5040.58,-3946.02"/>
</g>
<!-- ResMOE_s1_l13_tp0 -->
<g id="node1177" class="node">
<title>ResMOE_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="6024.77,-3648.32 5467.45,-3648.32 5324.08,-3542.32 5881.4,-3542.32 6024.77,-3648.32"/>
<text text-anchor="middle" x="5674.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5674.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5674.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp0&#45;&gt;ResMOE_s1_l13_tp0 -->
<g id="edge1962" class="edge">
<title>ResAttn_s1_l13_tp0&#45;&gt;ResMOE_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M4605.84,-3995.38C4500.37,-3986.7 4382.47,-3978.23 4274.42,-3973.27 3617.95,-3943.13 1972.71,-3986.84 1317.42,-3937.27 1032.38,-3915.71 868.05,-4063.94 680.42,-3848.27 664.96,-3830.5 664.06,-3812.21 680.42,-3795.27 844.76,-3625.16 4699.22,-3660.71 4935.42,-3648.32 5094.25,-3639.99 5272.06,-3627.58 5413.46,-3616.97"/>
<polygon fill="black" stroke="black" points="5413.87,-3620.45 5423.58,-3616.2 5413.35,-3613.46 5413.87,-3620.45"/>
</g>
<!-- Gate_s1_l13_tp1 -->
<g id="node1137" class="node">
<title>Gate_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="2968.42,-3937.27 2630.42,-3937.27 2630.42,-3884.27 2968.42,-3884.27 2968.42,-3937.27"/>
<text text-anchor="middle" x="2799.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2799.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2799.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp1&#45;&gt;Gate_s1_l13_tp1 -->
<g id="edge1890" class="edge">
<title>ResAttn_s1_l13_tp1&#45;&gt;Gate_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M2944.4,-3973.17C2918.52,-3962.21 2892.09,-3951.02 2869.01,-3941.24"/>
<polygon fill="black" stroke="black" points="2870.24,-3937.96 2859.67,-3937.29 2867.51,-3944.41 2870.24,-3937.96"/>
</g>
<!-- ResMOE_s1_l13_tp1 -->
<g id="node1178" class="node">
<title>ResMOE_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="3450.77,-3648.32 2893.45,-3648.32 2750.08,-3542.32 3307.4,-3542.32 3450.77,-3648.32"/>
<text text-anchor="middle" x="3100.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3100.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3100.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp1&#45;&gt;ResMOE_s1_l13_tp1 -->
<g id="edge1964" class="edge">
<title>ResAttn_s1_l13_tp1&#45;&gt;ResMOE_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M2754.62,-4001.25C2611.65,-3991.09 2440.05,-3980.07 2285.42,-3973.27 2238.9,-3971.23 641.99,-3970.55 609.42,-3937.27 570.1,-3897.1 570.38,-3724.76 609.42,-3684.32 628.44,-3664.62 2176.01,-3621.02 2822.01,-3603.66"/>
<polygon fill="black" stroke="black" points="2822.49,-3607.15 2832.4,-3603.38 2822.31,-3600.15 2822.49,-3607.15"/>
</g>
<!-- Gate_s1_l13_tp2 -->
<g id="node1138" class="node">
<title>Gate_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4084.42,-3937.27 3746.42,-3937.27 3746.42,-3884.27 4084.42,-3884.27 4084.42,-3937.27"/>
<text text-anchor="middle" x="3915.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3915.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3915.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp2&#45;&gt;Gate_s1_l13_tp2 -->
<g id="edge1891" class="edge">
<title>ResAttn_s1_l13_tp2&#45;&gt;Gate_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M3915.42,-3973.17C3915.42,-3964.5 3915.42,-3955.69 3915.42,-3947.54"/>
<polygon fill="black" stroke="black" points="3918.92,-3947.29 3915.42,-3937.29 3911.92,-3947.29 3918.92,-3947.29"/>
</g>
<!-- ResMOE_s1_l13_tp2 -->
<g id="node1179" class="node">
<title>ResMOE_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4926.77,-3648.32 4369.45,-3648.32 4226.08,-3542.32 4783.4,-3542.32 4926.77,-3648.32"/>
<text text-anchor="middle" x="4576.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4576.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4576.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp2&#45;&gt;ResMOE_s1_l13_tp2 -->
<g id="edge1966" class="edge">
<title>ResAttn_s1_l13_tp2&#45;&gt;ResMOE_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M3581.7,-3985.6C3529.78,-3980.64 3476.7,-3976.27 3426.42,-3973.27 3387.89,-3970.98 674.54,-3964.74 647.42,-3937.27 607.93,-3897.27 607.93,-3724.32 647.42,-3684.32 674.86,-3656.53 3420.38,-3649.48 3459.42,-3648.32 3749.82,-3639.7 4082.4,-3623.39 4308.62,-3611.33"/>
<polygon fill="black" stroke="black" points="4308.84,-3614.82 4318.64,-3610.79 4308.47,-3607.83 4308.84,-3614.82"/>
</g>
<!-- Gate_s1_l13_tp3 -->
<g id="node1139" class="node">
<title>Gate_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6880.42,-3937.27 6542.42,-3937.27 6542.42,-3884.27 6880.42,-3884.27 6880.42,-3937.27"/>
<text text-anchor="middle" x="6711.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6711.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6711.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp3&#45;&gt;Gate_s1_l13_tp3 -->
<g id="edge1892" class="edge">
<title>ResAttn_s1_l13_tp3&#45;&gt;Gate_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6810.42,-3973.17C6793.61,-3962.75 6776.46,-3952.11 6761.27,-3942.69"/>
<polygon fill="black" stroke="black" points="6762.9,-3939.58 6752.56,-3937.29 6759.21,-3945.53 6762.9,-3939.58"/>
</g>
<!-- ResMOE_s1_l13_tp3 -->
<g id="node1180" class="node">
<title>ResMOE_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6873.77,-3648.32 6316.45,-3648.32 6173.08,-3542.32 6730.4,-3542.32 6873.77,-3648.32"/>
<text text-anchor="middle" x="6523.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6523.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6523.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp3&#45;&gt;ResMOE_s1_l13_tp3 -->
<g id="edge1968" class="edge">
<title>ResAttn_s1_l13_tp3&#45;&gt;ResMOE_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M7138.22,-4000.32C7249.2,-3990.01 7382.32,-3979.13 7502.42,-3973.27 8162.35,-3941.1 9816.59,-3987.09 10475.42,-3937.27 10764.66,-3915.41 11313.04,-4004.77 11112.42,-3795.27 11075.26,-3756.47 7845.82,-3641.91 6827.44,-3606.72"/>
<polygon fill="black" stroke="black" points="6827.53,-3603.22 6817.41,-3606.38 6827.29,-3610.22 6827.53,-3603.22"/>
</g>
<!-- Gate_s1_l13_tp4 -->
<g id="node1140" class="node">
<title>Gate_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="8030.42,-3937.27 7692.42,-3937.27 7692.42,-3884.27 8030.42,-3884.27 8030.42,-3937.27"/>
<text text-anchor="middle" x="7861.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7861.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7861.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp4&#45;&gt;Gate_s1_l13_tp4 -->
<g id="edge1893" class="edge">
<title>ResAttn_s1_l13_tp4&#45;&gt;Gate_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M7861.42,-3973.17C7861.42,-3964.5 7861.42,-3955.69 7861.42,-3947.54"/>
<polygon fill="black" stroke="black" points="7864.92,-3947.29 7861.42,-3937.29 7857.92,-3947.29 7864.92,-3947.29"/>
</g>
<!-- ResMOE_s1_l13_tp4 -->
<g id="node1181" class="node">
<title>ResMOE_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="8910.77,-3648.32 8353.45,-3648.32 8210.08,-3542.32 8767.4,-3542.32 8910.77,-3648.32"/>
<text text-anchor="middle" x="8560.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8560.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8560.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp4&#45;&gt;ResMOE_s1_l13_tp4 -->
<g id="edge1970" class="edge">
<title>ResAttn_s1_l13_tp4&#45;&gt;ResMOE_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M8106.56,-4001.39C8224.33,-3990.89 8367.57,-3979.54 8496.42,-3973.27 8755.15,-3960.7 10571.09,-3974.59 10827.42,-3937.27 10972.23,-3916.19 11056.03,-3964.9 11144.42,-3848.27 11326.3,-3608.31 10099.64,-3707.36 9799.42,-3684.32 9486.75,-3660.32 9129.5,-3635.19 8879.21,-3617.96"/>
<polygon fill="black" stroke="black" points="8879.08,-3614.44 8868.86,-3617.25 8878.6,-3621.43 8879.08,-3614.44"/>
</g>
<!-- Gate_s1_l13_tp5 -->
<g id="node1141" class="node">
<title>Gate_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="1664.42,-3937.27 1326.42,-3937.27 1326.42,-3884.27 1664.42,-3884.27 1664.42,-3937.27"/>
<text text-anchor="middle" x="1495.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1495.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1495.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp5&#45;&gt;Gate_s1_l13_tp5 -->
<g id="edge1894" class="edge">
<title>ResAttn_s1_l13_tp5&#45;&gt;Gate_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M1728.9,-3973.26C1685.39,-3961.8 1640.9,-3950.08 1602.58,-3939.99"/>
<polygon fill="black" stroke="black" points="1603.02,-3936.49 1592.46,-3937.33 1601.24,-3943.26 1603.02,-3936.49"/>
</g>
<!-- ResMOE_s1_l13_tp5 -->
<g id="node1182" class="node">
<title>ResMOE_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="1217.77,-3648.32 660.45,-3648.32 517.08,-3542.32 1074.4,-3542.32 1217.77,-3648.32"/>
<text text-anchor="middle" x="867.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="867.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="867.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp5&#45;&gt;ResMOE_s1_l13_tp5 -->
<g id="edge1972" class="edge">
<title>ResAttn_s1_l13_tp5&#45;&gt;ResMOE_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M1633.41,-4015.72C1249.47,-4001.81 620.25,-3973.63 583.42,-3937.27 503.4,-3858.29 511.32,-3773.79 579.42,-3684.32 589.9,-3670.56 614.19,-3658.03 644.46,-3647.02"/>
<polygon fill="black" stroke="black" points="645.77,-3650.28 654.04,-3643.66 643.45,-3643.67 645.77,-3650.28"/>
</g>
<!-- Gate_s1_l13_tp6 -->
<g id="node1142" class="node">
<title>Gate_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="10466.42,-3937.27 10128.42,-3937.27 10128.42,-3884.27 10466.42,-3884.27 10466.42,-3937.27"/>
<text text-anchor="middle" x="10297.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10297.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10297.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp6&#45;&gt;Gate_s1_l13_tp6 -->
<g id="edge1895" class="edge">
<title>ResAttn_s1_l13_tp6&#45;&gt;Gate_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M10138.92,-3973.17C10167.46,-3962.12 10196.62,-3950.82 10222.02,-3940.98"/>
<polygon fill="black" stroke="black" points="10223.5,-3944.16 10231.56,-3937.29 10220.97,-3937.64 10223.5,-3944.16"/>
</g>
<!-- ResMOE_s1_l13_tp6 -->
<g id="node1183" class="node">
<title>ResMOE_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="11336.77,-3648.32 10779.45,-3648.32 10636.08,-3542.32 11193.4,-3542.32 11336.77,-3648.32"/>
<text text-anchor="middle" x="10986.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10986.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10986.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp6&#45;&gt;ResMOE_s1_l13_tp6 -->
<g id="edge1974" class="edge">
<title>ResAttn_s1_l13_tp6&#45;&gt;ResMOE_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M10281.17,-4024.72C10620.54,-4021.1 11158.75,-4004.64 11221.42,-3937.27 11298,-3854.96 11285.48,-3776.71 11221.42,-3684.32 11213.53,-3672.94 11203.98,-3663.03 11193.3,-3654.4"/>
<polygon fill="black" stroke="black" points="11195.41,-3651.61 11185.33,-3648.34 11191.17,-3657.18 11195.41,-3651.61"/>
</g>
<!-- Gate_s1_l13_tp7 -->
<g id="node1143" class="node">
<title>Gate_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="9162.42,-3937.27 8824.42,-3937.27 8824.42,-3884.27 9162.42,-3884.27 9162.42,-3937.27"/>
<text text-anchor="middle" x="8993.42" y="-3922.07" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8993.42" y="-3907.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8993.42" y="-3892.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp7&#45;&gt;Gate_s1_l13_tp7 -->
<g id="edge1896" class="edge">
<title>ResAttn_s1_l13_tp7&#45;&gt;Gate_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M8918.77,-3973.17C8930.97,-3963.14 8943.41,-3952.91 8954.54,-3943.75"/>
<polygon fill="black" stroke="black" points="8956.9,-3946.34 8962.4,-3937.29 8952.45,-3940.94 8956.9,-3946.34"/>
</g>
<!-- ResMOE_s1_l13_tp7 -->
<g id="node1184" class="node">
<title>ResMOE_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="10288.77,-3648.32 9731.45,-3648.32 9588.08,-3542.32 10145.4,-3542.32 10288.77,-3648.32"/>
<text text-anchor="middle" x="9938.42" y="-3606.62" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9938.42" y="-3591.62" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9938.42" y="-3576.62" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l13_tp7&#45;&gt;ResMOE_s1_l13_tp7 -->
<g id="edge1976" class="edge">
<title>ResAttn_s1_l13_tp7&#45;&gt;ResMOE_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M9107,-4006.22C9262.13,-3995.09 9465.21,-3981.63 9645.42,-3973.27 9793.76,-3966.4 10837.06,-3972.08 10981.42,-3937.27 11070.51,-3915.79 11118.57,-3925.81 11167.42,-3848.27 11179.98,-3828.34 11182.69,-3813.21 11167.42,-3795.27 11109.53,-3727.25 10613.95,-3664.12 10270.07,-3627.93"/>
<polygon fill="black" stroke="black" points="10270.26,-3624.43 10259.95,-3626.86 10269.53,-3631.39 10270.26,-3624.43"/>
</g>
<!-- Expert32_s1_l13_tp0 -->
<g id="node1144" class="node">
<title>Expert32_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5561.42,-3848.27 5253.42,-3848.27 5253.42,-3795.27 5561.42,-3795.27 5561.42,-3848.27"/>
<text text-anchor="middle" x="5407.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="5407.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5407.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp0&#45;&gt;Expert32_s1_l13_tp0 -->
<g id="edge1897" class="edge">
<title>Gate_s1_l13_tp0&#45;&gt;Expert32_s1_l13_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5177.03,-3884.26C5216.26,-3873.79 5261.8,-3861.64 5301.99,-3850.91"/>
<polygon fill="black" stroke="black" points="5303.06,-3854.25 5311.82,-3848.29 5301.25,-3847.48 5303.06,-3854.25"/>
</g>
<!-- Expert33_s1_l13_tp0 -->
<g id="node1145" class="node">
<title>Expert33_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5887.42,-3848.27 5579.42,-3848.27 5579.42,-3795.27 5887.42,-3795.27 5887.42,-3848.27"/>
<text text-anchor="middle" x="5733.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="5733.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5733.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp0&#45;&gt;Expert33_s1_l13_tp0 -->
<g id="edge1898" class="edge">
<title>Gate_s1_l13_tp0&#45;&gt;Expert33_s1_l13_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5250.47,-3889.78C5341.97,-3878.65 5457.22,-3864.14 5568.9,-3848.47"/>
<polygon fill="black" stroke="black" points="5569.59,-3851.91 5579.01,-3847.05 5568.62,-3844.98 5569.59,-3851.91"/>
</g>
<!-- Expert34_s1_l13_tp0 -->
<g id="node1146" class="node">
<title>Expert34_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="4909.42,-3848.27 4601.42,-3848.27 4601.42,-3795.27 4909.42,-3795.27 4909.42,-3848.27"/>
<text text-anchor="middle" x="4755.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="4755.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4755.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp0&#45;&gt;Expert34_s1_l13_tp0 -->
<g id="edge1899" class="edge">
<title>Gate_s1_l13_tp0&#45;&gt;Expert34_s1_l13_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4985.81,-3884.26C4946.59,-3873.79 4901.04,-3861.64 4860.85,-3850.91"/>
<polygon fill="black" stroke="black" points="4861.59,-3847.48 4851.03,-3848.29 4859.79,-3854.25 4861.59,-3847.48"/>
</g>
<!-- Expert35_s1_l13_tp0 -->
<g id="node1147" class="node">
<title>Expert35_s1_l13_tp0</title>
<polygon fill="none" stroke="black" points="5235.42,-3848.27 4927.42,-3848.27 4927.42,-3795.27 5235.42,-3795.27 5235.42,-3848.27"/>
<text text-anchor="middle" x="5081.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="5081.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5081.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp0&#45;&gt;Expert35_s1_l13_tp0 -->
<g id="edge1900" class="edge">
<title>Gate_s1_l13_tp0&#45;&gt;Expert35_s1_l13_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5081.42,-3884.14C5081.42,-3876.16 5081.42,-3867.21 5081.42,-3858.66"/>
<polygon fill="black" stroke="black" points="5084.92,-3858.52 5081.42,-3848.52 5077.92,-3858.52 5084.92,-3858.52"/>
</g>
<!-- Expert36_s1_l13_tp1 -->
<g id="node1148" class="node">
<title>Expert36_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="2953.42,-3848.27 2645.42,-3848.27 2645.42,-3795.27 2953.42,-3795.27 2953.42,-3848.27"/>
<text text-anchor="middle" x="2799.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="2799.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2799.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp1&#45;&gt;Expert36_s1_l13_tp1 -->
<g id="edge1901" class="edge">
<title>Gate_s1_l13_tp1&#45;&gt;Expert36_s1_l13_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2799.42,-3884.14C2799.42,-3876.16 2799.42,-3867.21 2799.42,-3858.66"/>
<polygon fill="black" stroke="black" points="2802.92,-3858.52 2799.42,-3848.52 2795.92,-3858.52 2802.92,-3858.52"/>
</g>
<!-- Expert37_s1_l13_tp1 -->
<g id="node1149" class="node">
<title>Expert37_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="3279.42,-3848.27 2971.42,-3848.27 2971.42,-3795.27 3279.42,-3795.27 3279.42,-3848.27"/>
<text text-anchor="middle" x="3125.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="3125.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3125.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp1&#45;&gt;Expert37_s1_l13_tp1 -->
<g id="edge1902" class="edge">
<title>Gate_s1_l13_tp1&#45;&gt;Expert37_s1_l13_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2895.03,-3884.26C2934.26,-3873.79 2979.8,-3861.64 3019.99,-3850.91"/>
<polygon fill="black" stroke="black" points="3021.06,-3854.25 3029.82,-3848.29 3019.25,-3847.48 3021.06,-3854.25"/>
</g>
<!-- Expert38_s1_l13_tp1 -->
<g id="node1150" class="node">
<title>Expert38_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="2301.42,-3848.27 1993.42,-3848.27 1993.42,-3795.27 2301.42,-3795.27 2301.42,-3848.27"/>
<text text-anchor="middle" x="2147.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2147.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2147.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp1&#45;&gt;Expert38_s1_l13_tp1 -->
<g id="edge1903" class="edge">
<title>Gate_s1_l13_tp1&#45;&gt;Expert38_s1_l13_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2630.37,-3889.78C2538.87,-3878.65 2423.63,-3864.14 2311.94,-3848.47"/>
<polygon fill="black" stroke="black" points="2312.23,-3844.98 2301.84,-3847.05 2311.25,-3851.91 2312.23,-3844.98"/>
</g>
<!-- Expert39_s1_l13_tp1 -->
<g id="node1151" class="node">
<title>Expert39_s1_l13_tp1</title>
<polygon fill="none" stroke="black" points="2627.42,-3848.27 2319.42,-3848.27 2319.42,-3795.27 2627.42,-3795.27 2627.42,-3848.27"/>
<text text-anchor="middle" x="2473.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="2473.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2473.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp1&#45;&gt;Expert39_s1_l13_tp1 -->
<g id="edge1904" class="edge">
<title>Gate_s1_l13_tp1&#45;&gt;Expert39_s1_l13_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2703.81,-3884.26C2664.59,-3873.79 2619.04,-3861.64 2578.85,-3850.91"/>
<polygon fill="black" stroke="black" points="2579.59,-3847.48 2569.03,-3848.29 2577.79,-3854.25 2579.59,-3847.48"/>
</g>
<!-- Expert40_s1_l13_tp2 -->
<g id="node1152" class="node">
<title>Expert40_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4583.42,-3848.27 4275.42,-3848.27 4275.42,-3795.27 4583.42,-3795.27 4583.42,-3848.27"/>
<text text-anchor="middle" x="4429.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="4429.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4429.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp2&#45;&gt;Expert40_s1_l13_tp2 -->
<g id="edge1905" class="edge">
<title>Gate_s1_l13_tp2&#45;&gt;Expert40_s1_l13_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4066.17,-3884.26C4129.84,-3873.48 4204.08,-3860.91 4268.79,-3849.96"/>
<polygon fill="black" stroke="black" points="4269.41,-3853.41 4278.68,-3848.29 4268.24,-3846.51 4269.41,-3853.41"/>
</g>
<!-- Expert41_s1_l13_tp2 -->
<g id="node1153" class="node">
<title>Expert41_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="3605.42,-3848.27 3297.42,-3848.27 3297.42,-3795.27 3605.42,-3795.27 3605.42,-3848.27"/>
<text text-anchor="middle" x="3451.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="3451.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3451.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp2&#45;&gt;Expert41_s1_l13_tp2 -->
<g id="edge1906" class="edge">
<title>Gate_s1_l13_tp2&#45;&gt;Expert41_s1_l13_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3779.34,-3884.26C3722.21,-3873.55 3655.67,-3861.07 3597.51,-3850.16"/>
<polygon fill="black" stroke="black" points="3597.97,-3846.69 3587.5,-3848.29 3596.68,-3853.57 3597.97,-3846.69"/>
</g>
<!-- Expert42_s1_l13_tp2 -->
<g id="node1154" class="node">
<title>Expert42_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="3931.42,-3848.27 3623.42,-3848.27 3623.42,-3795.27 3931.42,-3795.27 3931.42,-3848.27"/>
<text text-anchor="middle" x="3777.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="3777.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3777.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp2&#45;&gt;Expert42_s1_l13_tp2 -->
<g id="edge1907" class="edge">
<title>Gate_s1_l13_tp2&#45;&gt;Expert42_s1_l13_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3874.76,-3884.14C3859.74,-3874.67 3842.54,-3863.83 3826.82,-3853.92"/>
<polygon fill="black" stroke="black" points="3828.59,-3850.9 3818.27,-3848.52 3824.86,-3856.82 3828.59,-3850.9"/>
</g>
<!-- Expert43_s1_l13_tp2 -->
<g id="node1155" class="node">
<title>Expert43_s1_l13_tp2</title>
<polygon fill="none" stroke="black" points="4257.42,-3848.27 3949.42,-3848.27 3949.42,-3795.27 4257.42,-3795.27 4257.42,-3848.27"/>
<text text-anchor="middle" x="4103.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="4103.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4103.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp2&#45;&gt;Expert43_s1_l13_tp2 -->
<g id="edge1908" class="edge">
<title>Gate_s1_l13_tp2&#45;&gt;Expert43_s1_l13_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3970.56,-3884.26C3991.98,-3874.34 4016.68,-3862.92 4038.92,-3852.62"/>
<polygon fill="black" stroke="black" points="4040.68,-3855.66 4048.29,-3848.29 4037.74,-3849.31 4040.68,-3855.66"/>
</g>
<!-- Expert44_s1_l13_tp3 -->
<g id="node1156" class="node">
<title>Expert44_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6213.42,-3848.27 5905.42,-3848.27 5905.42,-3795.27 6213.42,-3795.27 6213.42,-3848.27"/>
<text text-anchor="middle" x="6059.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="6059.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6059.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp3&#45;&gt;Expert44_s1_l13_tp3 -->
<g id="edge1909" class="edge">
<title>Gate_s1_l13_tp3&#45;&gt;Expert44_s1_l13_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6542.37,-3889.78C6450.87,-3878.65 6335.63,-3864.14 6223.94,-3848.47"/>
<polygon fill="black" stroke="black" points="6224.23,-3844.98 6213.84,-3847.05 6223.25,-3851.91 6224.23,-3844.98"/>
</g>
<!-- Expert45_s1_l13_tp3 -->
<g id="node1157" class="node">
<title>Expert45_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6539.42,-3848.27 6231.42,-3848.27 6231.42,-3795.27 6539.42,-3795.27 6539.42,-3848.27"/>
<text text-anchor="middle" x="6385.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6385.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6385.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp3&#45;&gt;Expert45_s1_l13_tp3 -->
<g id="edge1910" class="edge">
<title>Gate_s1_l13_tp3&#45;&gt;Expert45_s1_l13_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6615.81,-3884.26C6576.59,-3873.79 6531.04,-3861.64 6490.85,-3850.91"/>
<polygon fill="black" stroke="black" points="6491.59,-3847.48 6481.03,-3848.29 6489.79,-3854.25 6491.59,-3847.48"/>
</g>
<!-- Expert46_s1_l13_tp3 -->
<g id="node1158" class="node">
<title>Expert46_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="6865.42,-3848.27 6557.42,-3848.27 6557.42,-3795.27 6865.42,-3795.27 6865.42,-3848.27"/>
<text text-anchor="middle" x="6711.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="6711.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6711.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp3&#45;&gt;Expert46_s1_l13_tp3 -->
<g id="edge1911" class="edge">
<title>Gate_s1_l13_tp3&#45;&gt;Expert46_s1_l13_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6711.42,-3884.14C6711.42,-3876.16 6711.42,-3867.21 6711.42,-3858.66"/>
<polygon fill="black" stroke="black" points="6714.92,-3858.52 6711.42,-3848.52 6707.92,-3858.52 6714.92,-3858.52"/>
</g>
<!-- Expert47_s1_l13_tp3 -->
<g id="node1159" class="node">
<title>Expert47_s1_l13_tp3</title>
<polygon fill="none" stroke="black" points="7191.42,-3848.27 6883.42,-3848.27 6883.42,-3795.27 7191.42,-3795.27 7191.42,-3848.27"/>
<text text-anchor="middle" x="7037.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="7037.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7037.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp3&#45;&gt;Expert47_s1_l13_tp3 -->
<g id="edge1912" class="edge">
<title>Gate_s1_l13_tp3&#45;&gt;Expert47_s1_l13_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6807.03,-3884.26C6846.26,-3873.79 6891.8,-3861.64 6931.99,-3850.91"/>
<polygon fill="black" stroke="black" points="6933.06,-3854.25 6941.82,-3848.29 6931.25,-3847.48 6933.06,-3854.25"/>
</g>
<!-- Expert48_s1_l13_tp4 -->
<g id="node1160" class="node">
<title>Expert48_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="7517.42,-3848.27 7209.42,-3848.27 7209.42,-3795.27 7517.42,-3795.27 7517.42,-3848.27"/>
<text text-anchor="middle" x="7363.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7363.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7363.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp4&#45;&gt;Expert48_s1_l13_tp4 -->
<g id="edge1913" class="edge">
<title>Gate_s1_l13_tp4&#45;&gt;Expert48_s1_l13_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7715.37,-3884.26C7653.8,-3873.5 7582.04,-3860.97 7519.44,-3850.03"/>
<polygon fill="black" stroke="black" points="7519.92,-3846.56 7509.47,-3848.29 7518.72,-3853.46 7519.92,-3846.56"/>
</g>
<!-- Expert49_s1_l13_tp4 -->
<g id="node1161" class="node">
<title>Expert49_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="7843.42,-3848.27 7535.42,-3848.27 7535.42,-3795.27 7843.42,-3795.27 7843.42,-3848.27"/>
<text text-anchor="middle" x="7689.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="7689.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7689.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp4&#45;&gt;Expert49_s1_l13_tp4 -->
<g id="edge1914" class="edge">
<title>Gate_s1_l13_tp4&#45;&gt;Expert49_s1_l13_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7810.75,-3884.14C7791.41,-3874.36 7769.19,-3863.12 7749.1,-3852.96"/>
<polygon fill="black" stroke="black" points="7750.54,-3849.76 7740.03,-3848.37 7747.38,-3856.01 7750.54,-3849.76"/>
</g>
<!-- Expert50_s1_l13_tp4 -->
<g id="node1162" class="node">
<title>Expert50_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="8169.42,-3848.27 7861.42,-3848.27 7861.42,-3795.27 8169.42,-3795.27 8169.42,-3848.27"/>
<text text-anchor="middle" x="8015.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="8015.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8015.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp4&#45;&gt;Expert50_s1_l13_tp4 -->
<g id="edge1915" class="edge">
<title>Gate_s1_l13_tp4&#45;&gt;Expert50_s1_l13_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7906.79,-3884.14C7923.79,-3874.54 7943.28,-3863.53 7961.02,-3853.51"/>
<polygon fill="black" stroke="black" points="7963.12,-3856.34 7970.11,-3848.37 7959.68,-3850.24 7963.12,-3856.34"/>
</g>
<!-- Expert51_s1_l13_tp4 -->
<g id="node1163" class="node">
<title>Expert51_s1_l13_tp4</title>
<polygon fill="none" stroke="black" points="8495.42,-3848.27 8187.42,-3848.27 8187.42,-3795.27 8495.42,-3795.27 8495.42,-3848.27"/>
<text text-anchor="middle" x="8341.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="8341.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8341.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp4&#45;&gt;Expert51_s1_l13_tp4 -->
<g id="edge1916" class="edge">
<title>Gate_s1_l13_tp4&#45;&gt;Expert51_s1_l13_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8002.2,-3884.26C8061.42,-3873.52 8130.42,-3861.02 8190.67,-3850.1"/>
<polygon fill="black" stroke="black" points="8191.44,-3853.52 8200.65,-3848.29 8190.19,-3846.63 8191.44,-3853.52"/>
</g>
<!-- Expert52_s1_l13_tp5 -->
<g id="node1164" class="node">
<title>Expert52_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="997.42,-3848.27 689.42,-3848.27 689.42,-3795.27 997.42,-3795.27 997.42,-3848.27"/>
<text text-anchor="middle" x="843.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="843.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="843.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp5&#45;&gt;Expert52_s1_l13_tp5 -->
<g id="edge1917" class="edge">
<title>Gate_s1_l13_tp5&#45;&gt;Expert52_s1_l13_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1326.37,-3889.78C1234.87,-3878.65 1119.63,-3864.14 1007.94,-3848.47"/>
<polygon fill="black" stroke="black" points="1008.23,-3844.98 997.84,-3847.05 1007.25,-3851.91 1008.23,-3844.98"/>
</g>
<!-- Expert53_s1_l13_tp5 -->
<g id="node1165" class="node">
<title>Expert53_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="1323.42,-3848.27 1015.42,-3848.27 1015.42,-3795.27 1323.42,-3795.27 1323.42,-3848.27"/>
<text text-anchor="middle" x="1169.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1169.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1169.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp5&#45;&gt;Expert53_s1_l13_tp5 -->
<g id="edge1918" class="edge">
<title>Gate_s1_l13_tp5&#45;&gt;Expert53_s1_l13_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1399.81,-3884.26C1360.59,-3873.79 1315.04,-3861.64 1274.85,-3850.91"/>
<polygon fill="black" stroke="black" points="1275.59,-3847.48 1265.03,-3848.29 1273.79,-3854.25 1275.59,-3847.48"/>
</g>
<!-- Expert54_s1_l13_tp5 -->
<g id="node1166" class="node">
<title>Expert54_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="1649.42,-3848.27 1341.42,-3848.27 1341.42,-3795.27 1649.42,-3795.27 1649.42,-3848.27"/>
<text text-anchor="middle" x="1495.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="1495.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1495.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp5&#45;&gt;Expert54_s1_l13_tp5 -->
<g id="edge1919" class="edge">
<title>Gate_s1_l13_tp5&#45;&gt;Expert54_s1_l13_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1495.42,-3884.14C1495.42,-3876.16 1495.42,-3867.21 1495.42,-3858.66"/>
<polygon fill="black" stroke="black" points="1498.92,-3858.52 1495.42,-3848.52 1491.92,-3858.52 1498.92,-3858.52"/>
</g>
<!-- Expert55_s1_l13_tp5 -->
<g id="node1167" class="node">
<title>Expert55_s1_l13_tp5</title>
<polygon fill="none" stroke="black" points="1975.42,-3848.27 1667.42,-3848.27 1667.42,-3795.27 1975.42,-3795.27 1975.42,-3848.27"/>
<text text-anchor="middle" x="1821.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="1821.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1821.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp5&#45;&gt;Expert55_s1_l13_tp5 -->
<g id="edge1920" class="edge">
<title>Gate_s1_l13_tp5&#45;&gt;Expert55_s1_l13_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1591.03,-3884.26C1630.26,-3873.79 1675.8,-3861.64 1715.99,-3850.91"/>
<polygon fill="black" stroke="black" points="1717.06,-3854.25 1725.82,-3848.29 1715.25,-3847.48 1717.06,-3854.25"/>
</g>
<!-- Expert56_s1_l13_tp6 -->
<g id="node1168" class="node">
<title>Expert56_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="10125.42,-3848.27 9817.42,-3848.27 9817.42,-3795.27 10125.42,-3795.27 10125.42,-3848.27"/>
<text text-anchor="middle" x="9971.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="9971.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9971.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp6&#45;&gt;Expert56_s1_l13_tp6 -->
<g id="edge1921" class="edge">
<title>Gate_s1_l13_tp6&#45;&gt;Expert56_s1_l13_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10201.81,-3884.26C10162.59,-3873.79 10117.04,-3861.64 10076.85,-3850.91"/>
<polygon fill="black" stroke="black" points="10077.59,-3847.48 10067.03,-3848.29 10075.79,-3854.25 10077.59,-3847.48"/>
</g>
<!-- Expert57_s1_l13_tp6 -->
<g id="node1169" class="node">
<title>Expert57_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="10451.42,-3848.27 10143.42,-3848.27 10143.42,-3795.27 10451.42,-3795.27 10451.42,-3848.27"/>
<text text-anchor="middle" x="10297.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="10297.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10297.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp6&#45;&gt;Expert57_s1_l13_tp6 -->
<g id="edge1922" class="edge">
<title>Gate_s1_l13_tp6&#45;&gt;Expert57_s1_l13_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10297.42,-3884.14C10297.42,-3876.16 10297.42,-3867.21 10297.42,-3858.66"/>
<polygon fill="black" stroke="black" points="10300.92,-3858.52 10297.42,-3848.52 10293.92,-3858.52 10300.92,-3858.52"/>
</g>
<!-- Expert58_s1_l13_tp6 -->
<g id="node1170" class="node">
<title>Expert58_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="10777.42,-3848.27 10469.42,-3848.27 10469.42,-3795.27 10777.42,-3795.27 10777.42,-3848.27"/>
<text text-anchor="middle" x="10623.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="10623.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10623.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp6&#45;&gt;Expert58_s1_l13_tp6 -->
<g id="edge1923" class="edge">
<title>Gate_s1_l13_tp6&#45;&gt;Expert58_s1_l13_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10393.03,-3884.26C10432.26,-3873.79 10477.8,-3861.64 10517.99,-3850.91"/>
<polygon fill="black" stroke="black" points="10519.06,-3854.25 10527.82,-3848.29 10517.25,-3847.48 10519.06,-3854.25"/>
</g>
<!-- Expert59_s1_l13_tp6 -->
<g id="node1171" class="node">
<title>Expert59_s1_l13_tp6</title>
<polygon fill="none" stroke="black" points="11103.42,-3848.27 10795.42,-3848.27 10795.42,-3795.27 11103.42,-3795.27 11103.42,-3848.27"/>
<text text-anchor="middle" x="10949.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="10949.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10949.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp6&#45;&gt;Expert59_s1_l13_tp6 -->
<g id="edge1924" class="edge">
<title>Gate_s1_l13_tp6&#45;&gt;Expert59_s1_l13_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10466.47,-3889.78C10557.97,-3878.65 10673.22,-3864.14 10784.9,-3848.47"/>
<polygon fill="black" stroke="black" points="10785.59,-3851.91 10795.01,-3847.05 10784.62,-3844.98 10785.59,-3851.91"/>
</g>
<!-- Expert60_s1_l13_tp7 -->
<g id="node1172" class="node">
<title>Expert60_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="8821.42,-3848.27 8513.42,-3848.27 8513.42,-3795.27 8821.42,-3795.27 8821.42,-3848.27"/>
<text text-anchor="middle" x="8667.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="8667.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8667.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp7&#45;&gt;Expert60_s1_l13_tp7 -->
<g id="edge1925" class="edge">
<title>Gate_s1_l13_tp7&#45;&gt;Expert60_s1_l13_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8897.81,-3884.26C8858.59,-3873.79 8813.04,-3861.64 8772.85,-3850.91"/>
<polygon fill="black" stroke="black" points="8773.59,-3847.48 8763.03,-3848.29 8771.79,-3854.25 8773.59,-3847.48"/>
</g>
<!-- Expert61_s1_l13_tp7 -->
<g id="node1173" class="node">
<title>Expert61_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="9147.42,-3848.27 8839.42,-3848.27 8839.42,-3795.27 9147.42,-3795.27 9147.42,-3848.27"/>
<text text-anchor="middle" x="8993.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="8993.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8993.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp7&#45;&gt;Expert61_s1_l13_tp7 -->
<g id="edge1926" class="edge">
<title>Gate_s1_l13_tp7&#45;&gt;Expert61_s1_l13_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8993.42,-3884.14C8993.42,-3876.16 8993.42,-3867.21 8993.42,-3858.66"/>
<polygon fill="black" stroke="black" points="8996.92,-3858.52 8993.42,-3848.52 8989.92,-3858.52 8996.92,-3858.52"/>
</g>
<!-- Expert62_s1_l13_tp7 -->
<g id="node1174" class="node">
<title>Expert62_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="9473.42,-3848.27 9165.42,-3848.27 9165.42,-3795.27 9473.42,-3795.27 9473.42,-3848.27"/>
<text text-anchor="middle" x="9319.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="9319.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9319.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp7&#45;&gt;Expert62_s1_l13_tp7 -->
<g id="edge1927" class="edge">
<title>Gate_s1_l13_tp7&#45;&gt;Expert62_s1_l13_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9089.03,-3884.26C9128.26,-3873.79 9173.8,-3861.64 9213.99,-3850.91"/>
<polygon fill="black" stroke="black" points="9215.06,-3854.25 9223.82,-3848.29 9213.25,-3847.48 9215.06,-3854.25"/>
</g>
<!-- Expert63_s1_l13_tp7 -->
<g id="node1175" class="node">
<title>Expert63_s1_l13_tp7</title>
<polygon fill="none" stroke="black" points="9799.42,-3848.27 9491.42,-3848.27 9491.42,-3795.27 9799.42,-3795.27 9799.42,-3848.27"/>
<text text-anchor="middle" x="9645.42" y="-3833.07" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="9645.42" y="-3818.07" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9645.42" y="-3803.07" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l13_tp7&#45;&gt;Expert63_s1_l13_tp7 -->
<g id="edge1928" class="edge">
<title>Gate_s1_l13_tp7&#45;&gt;Expert63_s1_l13_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9162.47,-3889.78C9253.97,-3878.65 9369.22,-3864.14 9480.9,-3848.47"/>
<polygon fill="black" stroke="black" points="9481.59,-3851.91 9491.01,-3847.05 9480.62,-3844.98 9481.59,-3851.91"/>
</g>
<!-- AR_exp_s1_l13 -->
<g id="node1176" class="node">
<title>AR_exp_s1_l13</title>
<ellipse fill="none" stroke="black" cx="5863.42" cy="-3721.8" rx="239" ry="37.45"/>
<text text-anchor="middle" x="5863.42" y="-3733.1" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="5863.42" y="-3718.1" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5863.42" y="-3703.1" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l13_tp0&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1929" class="edge">
<title>Expert32_s1_l13_tp0&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M5526.34,-3795.22C5584.08,-3782.82 5654.04,-3767.79 5715.22,-3754.64"/>
<polygon fill="black" stroke="black" points="5716.31,-3757.98 5725.35,-3752.46 5714.84,-3751.14 5716.31,-3757.98"/>
</g>
<!-- Expert33_s1_l13_tp0&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1930" class="edge">
<title>Expert33_s1_l13_tp0&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M5767.58,-3795.03C5779.79,-3785.83 5793.89,-3775.2 5807.46,-3764.98"/>
<polygon fill="black" stroke="black" points="5809.93,-3767.49 5815.81,-3758.68 5805.72,-3761.9 5809.93,-3767.49"/>
</g>
<!-- Expert34_s1_l13_tp0&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1931" class="edge">
<title>Expert34_s1_l13_tp0&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M4909.81,-3796.3C4912.71,-3795.95 4915.58,-3795.6 4918.42,-3795.27 5160.08,-3767.15 5437.82,-3747.33 5629.35,-3735.61"/>
<polygon fill="black" stroke="black" points="5629.78,-3739.09 5639.55,-3734.99 5629.36,-3732.11 5629.78,-3739.09"/>
</g>
<!-- Expert35_s1_l13_tp0&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1932" class="edge">
<title>Expert35_s1_l13_tp0&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M5235.83,-3796.46C5238.72,-3796.06 5241.58,-3795.66 5244.42,-3795.27 5382.32,-3776.42 5537.92,-3758.22 5658.62,-3744.77"/>
<polygon fill="black" stroke="black" points="5659.17,-3748.23 5668.72,-3743.64 5658.39,-3741.27 5659.17,-3748.23"/>
</g>
<!-- Expert36_s1_l13_tp1&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1933" class="edge">
<title>Expert36_s1_l13_tp1&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M2953.79,-3796.1C2956.69,-3795.81 2959.57,-3795.53 2962.42,-3795.27 3473.84,-3749.08 5010.22,-3730.5 5614.97,-3724.84"/>
<polygon fill="black" stroke="black" points="5615.16,-3728.34 5625.13,-3724.75 5615.09,-3721.34 5615.16,-3728.34"/>
</g>
<!-- Expert37_s1_l13_tp1&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1934" class="edge">
<title>Expert37_s1_l13_tp1&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M3279.79,-3796.11C3282.69,-3795.82 3285.57,-3795.54 3288.42,-3795.27 3734.79,-3754.24 5060.95,-3733.03 5615.41,-3725.76"/>
<polygon fill="black" stroke="black" points="5615.58,-3729.26 5625.54,-3725.62 5615.49,-3722.26 5615.58,-3729.26"/>
</g>
<!-- Expert38_s1_l13_tp1&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1935" class="edge">
<title>Expert38_s1_l13_tp1&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M2301.79,-3796.08C2304.69,-3795.79 2307.57,-3795.52 2310.42,-3795.27 2953.07,-3738.71 4916.83,-3726.19 5614.37,-3723.51"/>
<polygon fill="black" stroke="black" points="5614.55,-3727.01 5624.54,-3723.47 5614.53,-3720.01 5614.55,-3727.01"/>
</g>
<!-- Expert39_s1_l13_tp1&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1936" class="edge">
<title>Expert39_s1_l13_tp1&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M2627.79,-3796.09C2630.69,-3795.8 2633.57,-3795.53 2636.42,-3795.27 3213.2,-3743.91 4961.8,-3728.24 5614.34,-3724.11"/>
<polygon fill="black" stroke="black" points="5614.83,-3727.61 5624.81,-3724.05 5614.79,-3720.61 5614.83,-3727.61"/>
</g>
<!-- Expert40_s1_l13_tp2&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1937" class="edge">
<title>Expert40_s1_l13_tp2&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M4583.81,-3796.23C4586.7,-3795.9 4589.57,-3795.58 4592.42,-3795.27 4948.37,-3757.37 5362.66,-3738.42 5619,-3729.61"/>
<polygon fill="black" stroke="black" points="5619.31,-3733.1 5629.19,-3729.26 5619.08,-3726.1 5619.31,-3733.1"/>
</g>
<!-- Expert41_s1_l13_tp2&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1938" class="edge">
<title>Expert41_s1_l13_tp2&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M3605.8,-3796.13C3608.69,-3795.83 3611.57,-3795.54 3614.42,-3795.27 3996.24,-3759.39 5115.24,-3735.92 5616.1,-3726.93"/>
<polygon fill="black" stroke="black" points="5616.42,-3730.42 5626.35,-3726.74 5616.29,-3723.42 5616.42,-3730.42"/>
</g>
<!-- Expert42_s1_l13_tp2&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1939" class="edge">
<title>Expert42_s1_l13_tp2&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M3931.8,-3796.15C3934.69,-3795.84 3937.57,-3795.55 3940.42,-3795.27 4539.21,-3737.35 5247.03,-3725.06 5614.26,-3722.86"/>
<polygon fill="black" stroke="black" points="5614.51,-3726.35 5624.49,-3722.8 5614.47,-3719.36 5614.51,-3726.35"/>
</g>
<!-- Expert43_s1_l13_tp2&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1940" class="edge">
<title>Expert43_s1_l13_tp2&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M4257.8,-3796.18C4260.7,-3795.86 4263.57,-3795.56 4266.42,-3795.27 4742.1,-3747.42 5300.69,-3731.15 5615.24,-3725.63"/>
<polygon fill="black" stroke="black" points="5615.47,-3729.12 5625.4,-3725.45 5615.35,-3722.12 5615.47,-3729.12"/>
</g>
<!-- Expert44_s1_l13_tp3&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1941" class="edge">
<title>Expert44_s1_l13_tp3&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M6008.18,-3795.16C5988.04,-3785.09 5964.47,-3773.31 5942.26,-3762.2"/>
<polygon fill="black" stroke="black" points="5943.68,-3759 5933.17,-3757.66 5940.55,-3765.26 5943.68,-3759"/>
</g>
<!-- Expert45_s1_l13_tp3&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1942" class="edge">
<title>Expert45_s1_l13_tp3&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M6249.3,-3795.22C6180.2,-3782.25 6095.82,-3766.42 6023.61,-3752.86"/>
<polygon fill="black" stroke="black" points="6023.98,-3749.37 6013.51,-3750.97 6022.69,-3756.25 6023.98,-3749.37"/>
</g>
<!-- Expert46_s1_l13_tp3&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1943" class="edge">
<title>Expert46_s1_l13_tp3&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M6557.02,-3796.42C6554.13,-3796.03 6551.26,-3795.65 6548.42,-3795.27 6390.67,-3774.6 6211.87,-3755.84 6076.51,-3742.59"/>
<polygon fill="black" stroke="black" points="6076.72,-3739.09 6066.43,-3741.6 6076.04,-3746.06 6076.72,-3739.09"/>
</g>
<!-- Expert47_s1_l13_tp3&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1944" class="edge">
<title>Expert47_s1_l13_tp3&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M6883.03,-3796.28C6880.14,-3795.93 6877.27,-3795.6 6874.42,-3795.27 6610.15,-3765.18 6305.51,-3745.36 6100.29,-3734.17"/>
<polygon fill="black" stroke="black" points="6100.46,-3730.67 6090.29,-3733.63 6100.08,-3737.66 6100.46,-3730.67"/>
</g>
<!-- Expert48_s1_l13_tp4&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1945" class="edge">
<title>Expert48_s1_l13_tp4&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M7209.04,-3796.22C7206.15,-3795.89 7203.27,-3795.57 7200.42,-3795.27 6820.67,-3755.38 6377.79,-3736.84 6109.14,-3728.68"/>
<polygon fill="black" stroke="black" points="6108.97,-3725.17 6098.87,-3728.37 6108.76,-3732.17 6108.97,-3725.17"/>
</g>
<!-- Expert49_s1_l13_tp4&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1946" class="edge">
<title>Expert49_s1_l13_tp4&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M7535.04,-3796.17C7532.15,-3795.86 7529.27,-3795.56 7526.42,-3795.27 7026.03,-3745.39 6437.55,-3729.83 6111.92,-3724.99"/>
<polygon fill="black" stroke="black" points="6111.94,-3721.49 6101.89,-3724.84 6111.83,-3728.49 6111.94,-3721.49"/>
</g>
<!-- Expert50_s1_l13_tp4&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1947" class="edge">
<title>Expert50_s1_l13_tp4&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M7861.05,-3796.15C7858.15,-3795.84 7855.27,-3795.55 7852.42,-3795.27 7228.45,-3735.31 6490.02,-3723.94 6112.68,-3722.4"/>
<polygon fill="black" stroke="black" points="6112.47,-3718.9 6102.45,-3722.36 6112.44,-3725.9 6112.47,-3718.9"/>
</g>
<!-- Expert51_s1_l13_tp4&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1948" class="edge">
<title>Expert51_s1_l13_tp4&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M8187.05,-3796.13C8184.15,-3795.82 8181.27,-3795.54 8178.42,-3795.27 7783.56,-3758.35 6622.77,-3735.3 6110.82,-3726.66"/>
<polygon fill="black" stroke="black" points="6110.77,-3723.16 6100.71,-3726.49 6110.65,-3730.16 6110.77,-3723.16"/>
</g>
<!-- Expert52_s1_l13_tp5&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1949" class="edge">
<title>Expert52_s1_l13_tp5&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M997.79,-3796.06C1000.69,-3795.78 1003.57,-3795.52 1006.42,-3795.27 1466.03,-3756.09 4687.69,-3730.94 5614.54,-3724.46"/>
<polygon fill="black" stroke="black" points="5614.69,-3727.96 5624.66,-3724.39 5614.64,-3720.96 5614.69,-3727.96"/>
</g>
<!-- Expert53_s1_l13_tp5&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1950" class="edge">
<title>Expert53_s1_l13_tp5&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M1323.79,-3796.07C1326.69,-3795.78 1329.57,-3795.52 1332.42,-3795.27 2174.13,-3723.06 4792.39,-3721 5614.1,-3722.21"/>
<polygon fill="black" stroke="black" points="5614.27,-3725.71 5624.28,-3722.23 5614.28,-3718.71 5614.27,-3725.71"/>
</g>
<!-- Expert54_s1_l13_tp5&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1951" class="edge">
<title>Expert54_s1_l13_tp5&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M1649.79,-3796.07C1652.69,-3795.79 1655.57,-3795.52 1658.42,-3795.27 2433.47,-3728.29 4831.74,-3722.6 5613.94,-3722.58"/>
<polygon fill="black" stroke="black" points="5614.2,-3726.08 5624.2,-3722.58 5614.2,-3719.08 5614.2,-3726.08"/>
</g>
<!-- Expert55_s1_l13_tp5&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1952" class="edge">
<title>Expert55_s1_l13_tp5&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M1975.79,-3796.08C1978.69,-3795.79 1981.57,-3795.52 1984.42,-3795.27 2693.13,-3733.51 4873.28,-3724.33 5614.08,-3723"/>
<polygon fill="black" stroke="black" points="5614.35,-3726.5 5624.34,-3722.99 5614.34,-3719.5 5614.35,-3726.5"/>
</g>
<!-- Expert56_s1_l13_tp6&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1953" class="edge">
<title>Expert56_s1_l13_tp6&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M9817.05,-3796.07C9814.16,-3795.79 9811.28,-3795.52 9808.42,-3795.27 9086.29,-3732.45 6862.02,-3723.97 6112.75,-3722.91"/>
<polygon fill="black" stroke="black" points="6112.65,-3719.41 6102.64,-3722.9 6112.64,-3726.41 6112.65,-3719.41"/>
</g>
<!-- Expert57_s1_l13_tp6&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1954" class="edge">
<title>Expert57_s1_l13_tp6&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M10143.05,-3796.07C10140.16,-3795.79 10137.28,-3795.52 10134.42,-3795.27 9345.85,-3727.23 6902.87,-3722.27 6112.72,-3722.5"/>
<polygon fill="black" stroke="black" points="6112.64,-3719 6102.64,-3722.5 6112.64,-3726 6112.64,-3719"/>
</g>
<!-- Expert58_s1_l13_tp6&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1955" class="edge">
<title>Expert58_s1_l13_tp6&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M10469.05,-3796.06C10466.16,-3795.78 10463.28,-3795.52 10460.42,-3795.27 9605.21,-3722 6942.35,-3720.69 6112.77,-3722.14"/>
<polygon fill="black" stroke="black" points="6112.49,-3718.64 6102.49,-3722.16 6112.5,-3725.64 6112.49,-3718.64"/>
</g>
<!-- Expert59_s1_l13_tp6&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1956" class="edge">
<title>Expert59_s1_l13_tp6&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M10795.06,-3796.06C10792.16,-3795.78 10789.28,-3795.52 10786.42,-3795.27 10319.97,-3755.55 7046.76,-3730.74 6112.09,-3724.41"/>
<polygon fill="black" stroke="black" points="6111.91,-3720.91 6101.88,-3724.34 6111.86,-3727.9 6111.91,-3720.91"/>
</g>
<!-- Expert60_s1_l13_tp7&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1957" class="edge">
<title>Expert60_s1_l13_tp7&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M8513.05,-3796.11C8510.15,-3795.81 8507.27,-3795.53 8504.42,-3795.27 8044.98,-3753.2 6676.75,-3732.5 6111.74,-3725.56"/>
<polygon fill="black" stroke="black" points="6111.47,-3722.05 6101.43,-3725.43 6111.38,-3729.05 6111.47,-3722.05"/>
</g>
<!-- Expert61_s1_l13_tp7&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1958" class="edge">
<title>Expert61_s1_l13_tp7&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M8839.05,-3796.1C8836.15,-3795.81 8833.28,-3795.53 8830.42,-3795.27 8305.85,-3748.04 6726.92,-3730.02 6112.18,-3724.68"/>
<polygon fill="black" stroke="black" points="6111.88,-3721.18 6101.85,-3724.59 6111.82,-3728.18 6111.88,-3721.18"/>
</g>
<!-- Expert62_s1_l13_tp7&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1959" class="edge">
<title>Expert62_s1_l13_tp7&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M9165.05,-3796.09C9162.15,-3795.8 9159.28,-3795.53 9156.42,-3795.27 8566.28,-3742.85 6774.01,-3727.81 6112.33,-3723.98"/>
<polygon fill="black" stroke="black" points="6112.21,-3720.48 6102.19,-3723.92 6112.17,-3727.48 6112.21,-3720.48"/>
</g>
<!-- Expert63_s1_l13_tp7&#45;&gt;AR_exp_s1_l13 -->
<g id="edge1960" class="edge">
<title>Expert63_s1_l13_tp7&#45;&gt;AR_exp_s1_l13</title>
<path fill="none" stroke="black" d="M9491.05,-3796.08C9488.15,-3795.79 9485.28,-3795.52 9482.42,-3795.27 8826.39,-3737.65 6818.77,-3725.8 6112.43,-3723.4"/>
<polygon fill="black" stroke="black" points="6112.39,-3719.9 6102.38,-3723.36 6112.37,-3726.9 6112.39,-3719.9"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp0 -->
<g id="edge1961" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp0</title>
<path fill="none" stroke="black" d="M5809.26,-3685.13C5794.49,-3675.4 5778.11,-3664.61 5761.99,-3653.99"/>
<polygon fill="black" stroke="black" points="5763.87,-3651.04 5753.59,-3648.46 5760.02,-3656.89 5763.87,-3651.04"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp1 -->
<g id="edge1963" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp1</title>
<path fill="none" stroke="black" d="M5634.41,-3710.9C5316.44,-3697.11 4723.2,-3671.23 4217.42,-3648.32 3944.53,-3635.96 3634.16,-3621.48 3409.96,-3610.94"/>
<polygon fill="black" stroke="black" points="3409.84,-3607.43 3399.69,-3610.46 3409.51,-3614.42 3409.84,-3607.43"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp2 -->
<g id="edge1965" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp2</title>
<path fill="none" stroke="black" d="M5662.68,-3701.38C5461.33,-3681.91 5147.71,-3651.57 4909.11,-3628.5"/>
<polygon fill="black" stroke="black" points="4909.17,-3624.99 4898.88,-3627.51 4908.49,-3631.95 4909.17,-3624.99"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp3 -->
<g id="edge1967" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp3</title>
<path fill="none" stroke="black" d="M6013.19,-3692.55C6095.57,-3677.01 6199.57,-3657.4 6292.15,-3639.94"/>
<polygon fill="black" stroke="black" points="6293.04,-3643.33 6302.22,-3638.04 6291.75,-3636.45 6293.04,-3643.33"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp4 -->
<g id="edge1969" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp4</title>
<path fill="none" stroke="black" d="M6091.04,-3710.29C6585.78,-3687.46 7757.28,-3633.39 8289.24,-3608.84"/>
<polygon fill="black" stroke="black" points="8289.53,-3612.33 8299.36,-3608.37 8289.21,-3605.33 8289.53,-3612.33"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp5 -->
<g id="edge1971" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp5</title>
<path fill="none" stroke="black" d="M5627.45,-3715.68C5106.61,-3704.32 3819.29,-3675.79 2741.42,-3648.32 2186.65,-3634.18 1539.54,-3615.81 1169.21,-3605.11"/>
<polygon fill="black" stroke="black" points="1169.25,-3601.61 1159.15,-3604.82 1169.05,-3608.61 1169.25,-3601.61"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp6 -->
<g id="edge1973" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp6</title>
<path fill="none" stroke="black" d="M6101.78,-3718.76C6899.16,-3711.65 9469.69,-3686.29 10297.42,-3648.32 10440.34,-3641.76 10599.64,-3630.03 10729.04,-3619.37"/>
<polygon fill="black" stroke="black" points="10729.41,-3622.85 10739.09,-3618.53 10728.84,-3615.87 10729.41,-3622.85"/>
</g>
<!-- AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp7 -->
<g id="edge1975" class="edge">
<title>AR_exp_s1_l13&#45;&gt;ResMOE_s1_l13_tp7</title>
<path fill="none" stroke="black" d="M6100.75,-3717.37C6614.71,-3709.47 7869.03,-3687.57 8919.42,-3648.32 9174.68,-3638.78 9465.69,-3623.49 9671.19,-3611.95"/>
<polygon fill="black" stroke="black" points="9671.43,-3615.44 9681.21,-3611.39 9671.03,-3608.46 9671.43,-3615.44"/>
</g>
<!-- QKV_s1_l14_tp0 -->
<g id="node1185" class="node">
<title>QKV_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="4893.42,-3506.32 4555.42,-3506.32 4555.42,-3453.32 4893.42,-3453.32 4893.42,-3506.32"/>
<text text-anchor="middle" x="4724.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4724.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4724.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp0 -->
<g id="edge1977" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M5340.56,-3554.58C5213.98,-3539.5 5068.54,-3522.14 4936.42,-3506.32 4925.78,-3505.05 4914.85,-3503.73 4903.81,-3502.41"/>
<polygon fill="black" stroke="black" points="4904,-3498.91 4893.65,-3501.19 4903.17,-3505.86 4904,-3498.91"/>
</g>
<!-- QKV_s1_l14_tp1 -->
<g id="node1186" class="node">
<title>QKV_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="5283.42,-3506.32 4945.42,-3506.32 4945.42,-3453.32 5283.42,-3453.32 5283.42,-3506.32"/>
<text text-anchor="middle" x="5114.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5114.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5114.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp1 -->
<g id="edge1978" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5417.78,-3542.3C5360.04,-3530.6 5300.98,-3518.63 5250.49,-3508.4"/>
<polygon fill="black" stroke="black" points="5251,-3504.93 5240.51,-3506.37 5249.61,-3511.79 5251,-3504.93"/>
</g>
<!-- QKV_s1_l14_tp2 -->
<g id="node1187" class="node">
<title>QKV_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="5664.42,-3506.32 5326.42,-3506.32 5326.42,-3453.32 5664.42,-3453.32 5664.42,-3506.32"/>
<text text-anchor="middle" x="5495.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5495.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5495.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp2 -->
<g id="edge1979" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5592.26,-3542.22C5575.82,-3531.8 5559.04,-3521.16 5544.18,-3511.73"/>
<polygon fill="black" stroke="black" points="5545.98,-3508.73 5535.66,-3506.33 5542.23,-3514.64 5545.98,-3508.73"/>
</g>
<!-- QKV_s1_l14_tp3 -->
<g id="node1188" class="node">
<title>QKV_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6029.42,-3506.32 5691.42,-3506.32 5691.42,-3453.32 6029.42,-3453.32 6029.42,-3506.32"/>
<text text-anchor="middle" x="5860.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5860.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5860.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp3 -->
<g id="edge1980" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5759.8,-3542.22C5776.89,-3531.8 5794.31,-3521.16 5809.76,-3511.73"/>
<polygon fill="black" stroke="black" points="5811.9,-3514.53 5818.61,-3506.33 5808.25,-3508.55 5811.9,-3514.53"/>
</g>
<!-- QKV_s1_l14_tp4 -->
<g id="node1189" class="node">
<title>QKV_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="6410.42,-3506.32 6072.42,-3506.32 6072.42,-3453.32 6410.42,-3453.32 6410.42,-3506.32"/>
<text text-anchor="middle" x="6241.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6241.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6241.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp4 -->
<g id="edge1981" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M5892.83,-3550.6C5963.75,-3536.4 6040.42,-3521.06 6103.74,-3508.38"/>
<polygon fill="black" stroke="black" points="6104.67,-3511.76 6113.79,-3506.37 6103.3,-3504.9 6104.67,-3511.76"/>
</g>
<!-- QKV_s1_l14_tp5 -->
<g id="node1190" class="node">
<title>QKV_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="6796.42,-3506.32 6458.42,-3506.32 6458.42,-3453.32 6796.42,-3453.32 6796.42,-3506.32"/>
<text text-anchor="middle" x="6627.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6627.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6627.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp5 -->
<g id="edge1982" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M5913.93,-3566.3C6060.01,-3549.14 6250.52,-3526.65 6419.42,-3506.32 6428.81,-3505.19 6438.43,-3504.03 6448.14,-3502.85"/>
<polygon fill="black" stroke="black" points="6448.78,-3506.3 6458.29,-3501.62 6447.94,-3499.35 6448.78,-3506.3"/>
</g>
<!-- QKV_s1_l14_tp6 -->
<g id="node1191" class="node">
<title>QKV_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="7184.42,-3506.32 6846.42,-3506.32 6846.42,-3453.32 7184.42,-3453.32 7184.42,-3506.32"/>
<text text-anchor="middle" x="7015.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="7015.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7015.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp6 -->
<g id="edge1983" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M5914.39,-3566.45C5993.89,-3557.86 6082.89,-3548.93 6164.42,-3542.32 6448.83,-3519.26 6521.2,-3531.53 6805.42,-3506.32 6815.47,-3505.43 6825.78,-3504.43 6836.18,-3503.37"/>
<polygon fill="black" stroke="black" points="6836.59,-3506.85 6846.18,-3502.33 6835.87,-3499.89 6836.59,-3506.85"/>
</g>
<!-- QKV_s1_l14_tp7 -->
<g id="node1192" class="node">
<title>QKV_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="4511.42,-3506.32 4173.42,-3506.32 4173.42,-3453.32 4511.42,-3453.32 4511.42,-3506.32"/>
<text text-anchor="middle" x="4342.42" y="-3491.12" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4342.42" y="-3476.12" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4342.42" y="-3461.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp7 -->
<g id="edge1984" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;QKV_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M5367.07,-3574.22C5140.08,-3558.43 4823.68,-3534.45 4546.42,-3506.32 4538.34,-3505.5 4530.09,-3504.63 4521.76,-3503.71"/>
<polygon fill="black" stroke="black" points="4521.88,-3500.2 4511.56,-3502.58 4521.11,-3507.16 4521.88,-3500.2"/>
</g>
<!-- ResAttn_s1_l14_tp0 -->
<g id="node1219" class="node">
<title>ResAttn_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5008.77,-2928.41 4451.45,-2928.41 4308.08,-2822.41 4865.4,-2822.41 5008.77,-2928.41"/>
<text text-anchor="middle" x="4658.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4658.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4658.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp0 -->
<g id="edge2026" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M5362.15,-3570.71C5230.48,-3561.18 5075.53,-3550.52 4935.42,-3542.32 4849.81,-3537.31 4236.9,-3552.16 4164.42,-3506.32 4115.69,-3475.5 4103.42,-3449.48 4103.42,-3391.82 4103.42,-3391.82 4103.42,-3391.82 4103.42,-3089.89 4103.42,-2999.17 4182.38,-3003.13 4264.42,-2964.41 4311.76,-2942.08 4365.02,-2925.28 4416.7,-2912.7"/>
<polygon fill="black" stroke="black" points="4417.76,-2916.04 4426.67,-2910.32 4416.14,-2909.23 4417.76,-2916.04"/>
</g>
<!-- ResAttn_s1_l14_tp1 -->
<g id="node1220" class="node">
<title>ResAttn_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="3211.77,-2928.41 2654.45,-2928.41 2511.08,-2822.41 3068.4,-2822.41 3211.77,-2928.41"/>
<text text-anchor="middle" x="2861.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2861.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2861.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp1 -->
<g id="edge2028" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5360.4,-3569.39C5229.13,-3559.71 5074.96,-3549.29 4935.42,-3542.32 4394.97,-3515.32 4256.71,-3561.69 3718.42,-3506.32 3573.39,-3491.4 3072.42,-3537.61 3072.42,-3391.82 3072.42,-3391.82 3072.42,-3391.82 3072.42,-3089.89 3072.42,-3023.86 3020.72,-2970.89 2968.5,-2934.23"/>
<polygon fill="black" stroke="black" points="2970.35,-2931.26 2960.13,-2928.49 2966.4,-2937.03 2970.35,-2931.26"/>
</g>
<!-- ResAttn_s1_l14_tp2 -->
<g id="node1221" class="node">
<title>ResAttn_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="4059.77,-2928.41 3502.45,-2928.41 3359.08,-2822.41 3916.4,-2822.41 4059.77,-2928.41"/>
<text text-anchor="middle" x="3709.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3709.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3709.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp2 -->
<g id="edge2030" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5362.16,-3570.5C5230.49,-3560.93 5075.55,-3550.31 4935.42,-3542.32 4569,-3521.44 4472.7,-3565.11 4110.42,-3506.32 3927.47,-3476.63 3709.42,-3577.17 3709.42,-3391.82 3709.42,-3391.82 3709.42,-3391.82 3709.42,-3089.89 3709.42,-3039.05 3709.42,-2981.39 3709.42,-2938.82"/>
<polygon fill="black" stroke="black" points="3712.92,-2938.61 3709.42,-2928.61 3705.92,-2938.61 3712.92,-2938.61"/>
</g>
<!-- ResAttn_s1_l14_tp3 -->
<g id="node1222" class="node">
<title>ResAttn_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="7172.77,-2928.41 6615.45,-2928.41 6472.08,-2822.41 7029.4,-2822.41 7172.77,-2928.41"/>
<text text-anchor="middle" x="6822.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6822.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6822.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp3 -->
<g id="edge2032" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5913.07,-3565.57C5992.88,-3556.87 6082.39,-3548.1 6164.42,-3542.32 6221.48,-3538.3 7144.21,-3535.48 7193.42,-3506.32 7244.34,-3476.15 7261.42,-3451.01 7261.42,-3391.82 7261.42,-3391.82 7261.42,-3391.82 7261.42,-3089.89 7261.42,-3013.09 7206.41,-2963.91 7135.33,-2932.42"/>
<polygon fill="black" stroke="black" points="7136.7,-2929.2 7126.13,-2928.48 7133.94,-2935.63 7136.7,-2929.2"/>
</g>
<!-- ResAttn_s1_l14_tp4 -->
<g id="node1223" class="node">
<title>ResAttn_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="8005.77,-2928.41 7448.45,-2928.41 7305.08,-2822.41 7862.4,-2822.41 8005.77,-2928.41"/>
<text text-anchor="middle" x="7655.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7655.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7655.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp4 -->
<g id="edge2034" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M5913.07,-3565.51C5992.88,-3556.8 6082.39,-3548.04 6164.42,-3542.32 6330.53,-3530.73 7655.42,-3558.33 7655.42,-3391.82 7655.42,-3391.82 7655.42,-3391.82 7655.42,-3089.89 7655.42,-3039.05 7655.42,-2981.39 7655.42,-2938.82"/>
<polygon fill="black" stroke="black" points="7658.92,-2938.61 7655.42,-2928.61 7651.92,-2938.61 7658.92,-2938.61"/>
</g>
<!-- ResAttn_s1_l14_tp5 -->
<g id="node1224" class="node">
<title>ResAttn_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="2070.77,-2928.41 1513.45,-2928.41 1370.08,-2822.41 1927.4,-2822.41 2070.77,-2928.41"/>
<text text-anchor="middle" x="1720.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1720.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1720.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp5 -->
<g id="edge2036" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M5359.52,-3568.64C5228.46,-3558.87 5074.67,-3548.59 4935.42,-3542.32 4125.86,-3505.87 3919.73,-3576.85 3112.42,-3506.32 2947.75,-3491.93 2377.42,-3557.12 2377.42,-3391.82 2377.42,-3391.82 2377.42,-3391.82 2377.42,-3089.89 2377.42,-3016.76 2228.34,-2964.86 2072.21,-2930.56"/>
<polygon fill="black" stroke="black" points="2072.91,-2927.13 2062.39,-2928.43 2071.42,-2933.97 2072.91,-2927.13"/>
</g>
<!-- ResAttn_s1_l14_tp6 -->
<g id="node1225" class="node">
<title>ResAttn_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="10337.77,-2928.41 9780.45,-2928.41 9637.08,-2822.41 10194.4,-2822.41 10337.77,-2928.41"/>
<text text-anchor="middle" x="9987.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9987.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9987.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp6 -->
<g id="edge2038" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M5912.08,-3564.86C5992.12,-3556.07 6082.03,-3547.43 6164.42,-3542.32 7047.32,-3487.59 7270.67,-3544.75 8154.42,-3506.32 8339.24,-3498.28 9815.42,-3576.81 9815.42,-3391.82 9815.42,-3391.82 9815.42,-3391.82 9815.42,-3089.89 9815.42,-3027.82 9860.06,-2973.58 9903.86,-2935.31"/>
<polygon fill="black" stroke="black" points="9906.4,-2937.75 9911.73,-2928.6 9901.85,-2932.43 9906.4,-2937.75"/>
</g>
<!-- ResAttn_s1_l14_tp7 -->
<g id="node1226" class="node">
<title>ResAttn_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="9130.77,-2928.41 8573.45,-2928.41 8430.08,-2822.41 8987.4,-2822.41 9130.77,-2928.41"/>
<text text-anchor="middle" x="8780.42" y="-2886.71" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8780.42" y="-2871.71" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8780.42" y="-2856.71" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp7 -->
<g id="edge2040" class="edge">
<title>ResMOE_s1_l13_tp0&#45;&gt;ResAttn_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M5912.74,-3565.28C5992.62,-3556.54 6082.27,-3547.83 6164.42,-3542.32 6305.58,-3532.86 8706.42,-3533.29 8706.42,-3391.82 8706.42,-3391.82 8706.42,-3391.82 8706.42,-3089.89 8706.42,-3036.47 8727.37,-2979.46 8746.97,-2937.81"/>
<polygon fill="black" stroke="black" points="8750.21,-2939.16 8751.39,-2928.63 8743.9,-2936.13 8750.21,-2939.16"/>
</g>
<!-- SplitHeads_s1_l14_tp0 -->
<g id="node1193" class="node">
<title>SplitHeads_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="4893.42,-3417.32 4521.42,-3417.32 4521.42,-3364.32 4893.42,-3364.32 4893.42,-3417.32"/>
<text text-anchor="middle" x="4707.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4707.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4707.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp0&#45;&gt;SplitHeads_s1_l14_tp0 -->
<g id="edge1985" class="edge">
<title>QKV_s1_l14_tp0&#45;&gt;SplitHeads_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M4719.41,-3453.19C4717.84,-3445.12 4716.07,-3436.06 4714.38,-3427.42"/>
<polygon fill="black" stroke="black" points="4717.81,-3426.71 4712.45,-3417.57 4710.94,-3428.06 4717.81,-3426.71"/>
</g>
<!-- SplitHeads_s1_l14_tp1 -->
<g id="node1194" class="node">
<title>SplitHeads_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="5283.42,-3417.32 4911.42,-3417.32 4911.42,-3364.32 5283.42,-3364.32 5283.42,-3417.32"/>
<text text-anchor="middle" x="5097.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5097.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5097.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp1&#45;&gt;SplitHeads_s1_l14_tp1 -->
<g id="edge1986" class="edge">
<title>QKV_s1_l14_tp1&#45;&gt;SplitHeads_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5109.41,-3453.19C5107.84,-3445.12 5106.07,-3436.06 5104.38,-3427.42"/>
<polygon fill="black" stroke="black" points="5107.81,-3426.71 5102.45,-3417.57 5100.94,-3428.06 5107.81,-3426.71"/>
</g>
<!-- SplitHeads_s1_l14_tp2 -->
<g id="node1195" class="node">
<title>SplitHeads_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="5673.42,-3417.32 5301.42,-3417.32 5301.42,-3364.32 5673.42,-3364.32 5673.42,-3417.32"/>
<text text-anchor="middle" x="5487.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5487.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5487.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp2&#45;&gt;SplitHeads_s1_l14_tp2 -->
<g id="edge1987" class="edge">
<title>QKV_s1_l14_tp2&#45;&gt;SplitHeads_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5493.07,-3453.19C5492.33,-3445.21 5491.51,-3436.25 5490.72,-3427.7"/>
<polygon fill="black" stroke="black" points="5494.19,-3427.21 5489.79,-3417.57 5487.22,-3427.85 5494.19,-3427.21"/>
</g>
<!-- SplitHeads_s1_l14_tp3 -->
<g id="node1196" class="node">
<title>SplitHeads_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6063.42,-3417.32 5691.42,-3417.32 5691.42,-3364.32 6063.42,-3364.32 6063.42,-3417.32"/>
<text text-anchor="middle" x="5877.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5877.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5877.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp3&#45;&gt;SplitHeads_s1_l14_tp3 -->
<g id="edge1988" class="edge">
<title>QKV_s1_l14_tp3&#45;&gt;SplitHeads_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5865.43,-3453.19C5867.01,-3445.12 5868.78,-3436.06 5870.47,-3427.42"/>
<polygon fill="black" stroke="black" points="5873.91,-3428.06 5872.39,-3417.57 5867.04,-3426.71 5873.91,-3428.06"/>
</g>
<!-- SplitHeads_s1_l14_tp4 -->
<g id="node1197" class="node">
<title>SplitHeads_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="6453.42,-3417.32 6081.42,-3417.32 6081.42,-3364.32 6453.42,-3364.32 6453.42,-3417.32"/>
<text text-anchor="middle" x="6267.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6267.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6267.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp4&#45;&gt;SplitHeads_s1_l14_tp4 -->
<g id="edge1989" class="edge">
<title>QKV_s1_l14_tp4&#45;&gt;SplitHeads_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M6249.08,-3453.19C6251.49,-3445.12 6254.2,-3436.06 6256.78,-3427.42"/>
<polygon fill="black" stroke="black" points="6260.22,-3428.15 6259.73,-3417.57 6253.51,-3426.15 6260.22,-3428.15"/>
</g>
<!-- SplitHeads_s1_l14_tp5 -->
<g id="node1198" class="node">
<title>SplitHeads_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="6843.42,-3417.32 6471.42,-3417.32 6471.42,-3364.32 6843.42,-3364.32 6843.42,-3417.32"/>
<text text-anchor="middle" x="6657.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6657.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6657.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp5&#45;&gt;SplitHeads_s1_l14_tp5 -->
<g id="edge1990" class="edge">
<title>QKV_s1_l14_tp5&#45;&gt;SplitHeads_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M6636.26,-3453.19C6639.07,-3445.03 6642.24,-3435.86 6645.24,-3427.14"/>
<polygon fill="black" stroke="black" points="6648.59,-3428.16 6648.54,-3417.57 6641.97,-3425.88 6648.59,-3428.16"/>
</g>
<!-- SplitHeads_s1_l14_tp6 -->
<g id="node1199" class="node">
<title>SplitHeads_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="7233.42,-3417.32 6861.42,-3417.32 6861.42,-3364.32 7233.42,-3364.32 7233.42,-3417.32"/>
<text text-anchor="middle" x="7047.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="7047.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7047.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp6&#45;&gt;SplitHeads_s1_l14_tp6 -->
<g id="edge1991" class="edge">
<title>QKV_s1_l14_tp6&#45;&gt;SplitHeads_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M7024.85,-3453.19C7027.85,-3445.03 7031.22,-3435.86 7034.43,-3427.14"/>
<polygon fill="black" stroke="black" points="7037.78,-3428.16 7037.95,-3417.57 7031.21,-3425.75 7037.78,-3428.16"/>
</g>
<!-- SplitHeads_s1_l14_tp7 -->
<g id="node1200" class="node">
<title>SplitHeads_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="4503.42,-3417.32 4131.42,-3417.32 4131.42,-3364.32 4503.42,-3364.32 4503.42,-3417.32"/>
<text text-anchor="middle" x="4317.42" y="-3402.12" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4317.42" y="-3387.12" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4317.42" y="-3372.12" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l14_tp7&#45;&gt;SplitHeads_s1_l14_tp7 -->
<g id="edge1992" class="edge">
<title>QKV_s1_l14_tp7&#45;&gt;SplitHeads_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M4335.06,-3453.19C4332.74,-3445.12 4330.13,-3436.06 4327.65,-3427.42"/>
<polygon fill="black" stroke="black" points="4330.95,-3426.21 4324.82,-3417.57 4324.22,-3428.15 4330.95,-3426.21"/>
</g>
<!-- A2A_s1_l14 -->
<g id="node1201" class="node">
<title>A2A_s1_l14</title>
<ellipse fill="none" stroke="black" cx="5682.42" cy="-3290.84" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5682.42" y="-3302.14" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="5682.42" y="-3287.14" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5682.42" y="-3272.14" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l14_tp0&#45;&gt;A2A_s1_l14 -->
<g id="edge1993" class="edge">
<title>SplitHeads_s1_l14_tp0&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M4893.45,-3365.34C4896.46,-3364.99 4899.45,-3364.65 4902.42,-3364.32 5085.43,-3343.86 5293.05,-3324.77 5448.05,-3311.32"/>
<polygon fill="black" stroke="black" points="5448.53,-3314.79 5458.19,-3310.44 5447.92,-3307.82 5448.53,-3314.79"/>
</g>
<!-- SplitHeads_s1_l14_tp1&#45;&gt;A2A_s1_l14 -->
<g id="edge1994" class="edge">
<title>SplitHeads_s1_l14_tp1&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M5249.98,-3364.27C5328.22,-3351.17 5423.93,-3335.14 5505.41,-3321.49"/>
<polygon fill="black" stroke="black" points="5505.99,-3324.94 5515.27,-3319.84 5504.83,-3318.04 5505.99,-3324.94"/>
</g>
<!-- SplitHeads_s1_l14_tp2&#45;&gt;A2A_s1_l14 -->
<g id="edge1995" class="edge">
<title>SplitHeads_s1_l14_tp2&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M5538.4,-3364.21C5558.24,-3354.24 5581.43,-3342.59 5603.33,-3331.58"/>
<polygon fill="black" stroke="black" points="5604.94,-3334.69 5612.3,-3327.07 5601.8,-3328.44 5604.94,-3334.69"/>
</g>
<!-- SplitHeads_s1_l14_tp3&#45;&gt;A2A_s1_l14 -->
<g id="edge1996" class="edge">
<title>SplitHeads_s1_l14_tp3&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M5826.44,-3364.21C5806.61,-3354.24 5783.42,-3342.59 5761.51,-3331.58"/>
<polygon fill="black" stroke="black" points="5763.05,-3328.44 5752.54,-3327.07 5759.91,-3334.69 5763.05,-3328.44"/>
</g>
<!-- SplitHeads_s1_l14_tp4&#45;&gt;A2A_s1_l14 -->
<g id="edge1997" class="edge">
<title>SplitHeads_s1_l14_tp4&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M6114.87,-3364.27C6036.63,-3351.17 5940.91,-3335.14 5859.44,-3321.49"/>
<polygon fill="black" stroke="black" points="5860.02,-3318.04 5849.58,-3319.84 5858.86,-3324.94 5860.02,-3318.04"/>
</g>
<!-- SplitHeads_s1_l14_tp5&#45;&gt;A2A_s1_l14 -->
<g id="edge1998" class="edge">
<title>SplitHeads_s1_l14_tp5&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M6471.4,-3365.34C6468.39,-3364.99 6465.39,-3364.65 6462.42,-3364.32 6279.42,-3343.86 6071.79,-3324.77 5916.79,-3311.32"/>
<polygon fill="black" stroke="black" points="5916.92,-3307.82 5906.66,-3310.44 5916.32,-3314.79 5916.92,-3307.82"/>
</g>
<!-- SplitHeads_s1_l14_tp6&#45;&gt;A2A_s1_l14 -->
<g id="edge1999" class="edge">
<title>SplitHeads_s1_l14_tp6&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M6861.41,-3365.21C6858.39,-3364.9 6855.4,-3364.61 6852.42,-3364.32 6540.38,-3334.29 6180.25,-3314.16 5942.88,-3302.88"/>
<polygon fill="black" stroke="black" points="5942.88,-3299.38 5932.73,-3302.4 5942.55,-3306.37 5942.88,-3299.38"/>
</g>
<!-- SplitHeads_s1_l14_tp7&#45;&gt;A2A_s1_l14 -->
<g id="edge2000" class="edge">
<title>SplitHeads_s1_l14_tp7&#45;&gt;A2A_s1_l14</title>
<path fill="none" stroke="black" d="M4503.43,-3365.21C4506.45,-3364.9 4509.45,-3364.61 4512.42,-3364.32 4824.47,-3334.29 5184.6,-3314.16 5421.96,-3302.88"/>
<polygon fill="black" stroke="black" points="5422.29,-3306.37 5432.12,-3302.4 5421.96,-3299.38 5422.29,-3306.37"/>
</g>
<!-- Attn_s1_l14_tp0 -->
<g id="node1202" class="node">
<title>Attn_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="4893.42,-3217.37 4521.42,-3217.37 4521.42,-3164.37 4893.42,-3164.37 4893.42,-3217.37"/>
<text text-anchor="middle" x="4707.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4707.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4707.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp0 -->
<g id="edge2001" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M5458.19,-3271.24C5304.85,-3257.99 5096.7,-3238.94 4903.51,-3217.47"/>
<polygon fill="black" stroke="black" points="4903.77,-3213.98 4893.45,-3216.35 4903,-3220.94 4903.77,-3213.98"/>
</g>
<!-- Attn_s1_l14_tp1 -->
<g id="node1203" class="node">
<title>Attn_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="5283.42,-3217.37 4911.42,-3217.37 4911.42,-3164.37 5283.42,-3164.37 5283.42,-3217.37"/>
<text text-anchor="middle" x="5097.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5097.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5097.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp1 -->
<g id="edge2002" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5515.18,-3261.83C5435.03,-3248.41 5339.42,-3232.4 5259.9,-3219.08"/>
<polygon fill="black" stroke="black" points="5260.23,-3215.58 5249.79,-3217.38 5259.07,-3222.49 5260.23,-3215.58"/>
</g>
<!-- Attn_s1_l14_tp2 -->
<g id="node1204" class="node">
<title>Attn_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="5673.42,-3217.37 5301.42,-3217.37 5301.42,-3164.37 5673.42,-3164.37 5673.42,-3217.37"/>
<text text-anchor="middle" x="5487.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5487.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5487.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp2 -->
<g id="edge2003" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5612.3,-3254.61C5590.99,-3243.91 5567.79,-3232.25 5547.23,-3221.92"/>
<polygon fill="black" stroke="black" points="5548.8,-3218.79 5538.29,-3217.42 5545.65,-3225.04 5548.8,-3218.79"/>
</g>
<!-- Attn_s1_l14_tp3 -->
<g id="node1205" class="node">
<title>Attn_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6063.42,-3217.37 5691.42,-3217.37 5691.42,-3164.37 6063.42,-3164.37 6063.42,-3217.37"/>
<text text-anchor="middle" x="5877.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5877.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5877.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp3 -->
<g id="edge2004" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5752.55,-3254.61C5773.85,-3243.91 5797.06,-3232.25 5817.62,-3221.92"/>
<polygon fill="black" stroke="black" points="5819.19,-3225.04 5826.55,-3217.42 5816.05,-3218.79 5819.19,-3225.04"/>
</g>
<!-- Attn_s1_l14_tp4 -->
<g id="node1206" class="node">
<title>Attn_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="6453.42,-3217.37 6081.42,-3217.37 6081.42,-3164.37 6453.42,-3164.37 6453.42,-3217.37"/>
<text text-anchor="middle" x="6267.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6267.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6267.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp4 -->
<g id="edge2005" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M5849.67,-3261.83C5929.81,-3248.41 6025.43,-3232.4 6104.95,-3219.08"/>
<polygon fill="black" stroke="black" points="6105.77,-3222.49 6115.06,-3217.38 6104.62,-3215.58 6105.77,-3222.49"/>
</g>
<!-- Attn_s1_l14_tp5 -->
<g id="node1207" class="node">
<title>Attn_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="6843.42,-3217.37 6471.42,-3217.37 6471.42,-3164.37 6843.42,-3164.37 6843.42,-3217.37"/>
<text text-anchor="middle" x="6657.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6657.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6657.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp5 -->
<g id="edge2006" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M5906.66,-3271.24C6060,-3257.99 6268.14,-3238.94 6461.34,-3217.47"/>
<polygon fill="black" stroke="black" points="6461.85,-3220.94 6471.4,-3216.35 6461.07,-3213.98 6461.85,-3220.94"/>
</g>
<!-- Attn_s1_l14_tp6 -->
<g id="node1208" class="node">
<title>Attn_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="7233.42,-3217.37 6861.42,-3217.37 6861.42,-3164.37 7233.42,-3164.37 7233.42,-3217.37"/>
<text text-anchor="middle" x="7047.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7047.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7047.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp6 -->
<g id="edge2007" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M5932.73,-3279.28C6167.46,-3268.22 6528.4,-3248.25 6851.39,-3217.44"/>
<polygon fill="black" stroke="black" points="6851.79,-3220.92 6861.41,-3216.48 6851.12,-3213.95 6851.79,-3220.92"/>
</g>
<!-- Attn_s1_l14_tp7 -->
<g id="node1209" class="node">
<title>Attn_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="4503.42,-3217.37 4131.42,-3217.37 4131.42,-3164.37 4503.42,-3164.37 4503.42,-3217.37"/>
<text text-anchor="middle" x="4317.42" y="-3202.17" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4317.42" y="-3187.17" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4317.42" y="-3172.17" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l14&#45;&gt;Attn_s1_l14_tp7 -->
<g id="edge2008" class="edge">
<title>A2A_s1_l14&#45;&gt;Attn_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M5432.12,-3279.28C5197.38,-3268.22 4836.44,-3248.25 4513.46,-3217.44"/>
<polygon fill="black" stroke="black" points="4513.72,-3213.95 4503.43,-3216.48 4513.05,-3220.92 4513.72,-3213.95"/>
</g>
<!-- AR_attn_s1_l14 -->
<g id="node1210" class="node">
<title>AR_attn_s1_l14</title>
<ellipse fill="none" stroke="black" cx="5640.42" cy="-3090.89" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5640.42" y="-3102.19" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="5640.42" y="-3087.19" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5640.42" y="-3072.19" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l14_tp0&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2009" class="edge">
<title>Attn_s1_l14_tp0&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M4893.45,-3165.4C4896.46,-3165.05 4899.45,-3164.71 4902.42,-3164.37 5072.62,-3144.89 5265.28,-3126.07 5411.07,-3112.5"/>
<polygon fill="black" stroke="black" points="5411.41,-3115.98 5421.04,-3111.57 5410.76,-3109.01 5411.41,-3115.98"/>
</g>
<!-- Attn_s1_l14_tp1&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2010" class="edge">
<title>Attn_s1_l14_tp1&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M5239.03,-3164.32C5309.85,-3151.54 5396.1,-3135.97 5470.47,-3122.56"/>
<polygon fill="black" stroke="black" points="5471.2,-3125.98 5480.41,-3120.76 5469.95,-3119.09 5471.2,-3125.98"/>
</g>
<!-- Attn_s1_l14_tp2&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2011" class="edge">
<title>Attn_s1_l14_tp2&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M5527.62,-3164.12C5542.47,-3154.61 5559.7,-3143.58 5576.16,-3133.04"/>
<polygon fill="black" stroke="black" points="5578.14,-3135.93 5584.68,-3127.59 5574.37,-3130.03 5578.14,-3135.93"/>
</g>
<!-- Attn_s1_l14_tp3&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2012" class="edge">
<title>Attn_s1_l14_tp3&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M5815.46,-3164.25C5790.56,-3153.96 5761.3,-3141.86 5733.91,-3130.54"/>
<polygon fill="black" stroke="black" points="5734.89,-3127.16 5724.31,-3126.57 5732.22,-3133.62 5734.89,-3127.16"/>
</g>
<!-- Attn_s1_l14_tp4&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2013" class="edge">
<title>Attn_s1_l14_tp4&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M6103.91,-3164.32C6018.14,-3150.91 5912.77,-3134.45 5824.18,-3120.6"/>
<polygon fill="black" stroke="black" points="5824.71,-3117.15 5814.29,-3119.06 5823.63,-3124.06 5824.71,-3117.15"/>
</g>
<!-- Attn_s1_l14_tp5&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2014" class="edge">
<title>Attn_s1_l14_tp5&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M6471.4,-3165.36C6468.39,-3165.02 6465.39,-3164.69 6462.42,-3164.37 6266.44,-3142.92 6043.62,-3123.59 5879.45,-3110.29"/>
<polygon fill="black" stroke="black" points="5879.47,-3106.78 5869.22,-3109.47 5878.91,-3113.76 5879.47,-3106.78"/>
</g>
<!-- Attn_s1_l14_tp6&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2015" class="edge">
<title>Attn_s1_l14_tp6&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M6861.41,-3165.25C6858.4,-3164.94 6855.4,-3164.65 6852.42,-3164.37 6525.79,-3133.28 6148.29,-3113.2 5902.53,-3102.24"/>
<polygon fill="black" stroke="black" points="5902.53,-3098.74 5892.39,-3101.79 5902.22,-3105.73 5902.53,-3098.74"/>
</g>
<!-- Attn_s1_l14_tp7&#45;&gt;AR_attn_s1_l14 -->
<g id="edge2016" class="edge">
<title>Attn_s1_l14_tp7&#45;&gt;AR_attn_s1_l14</title>
<path fill="none" stroke="black" d="M4503.43,-3165.26C4506.45,-3164.96 4509.45,-3164.66 4512.42,-3164.37 4809.88,-3135.39 5152.64,-3115.24 5381.52,-3103.67"/>
<polygon fill="black" stroke="black" points="5381.84,-3107.16 5391.66,-3103.16 5381.49,-3100.17 5381.84,-3107.16"/>
</g>
<!-- O_s1_l14_tp0 -->
<g id="node1211" class="node">
<title>O_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5039.42,-3017.41 4701.42,-3017.41 4701.42,-2964.41 5039.42,-2964.41 5039.42,-3017.41"/>
<text text-anchor="middle" x="4870.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4870.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4870.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp0 -->
<g id="edge2017" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M5447.61,-3065.36C5325.53,-3049.82 5168.78,-3029.88 5049.45,-3014.69"/>
<polygon fill="black" stroke="black" points="5049.83,-3011.21 5039.47,-3013.42 5048.95,-3018.16 5049.83,-3011.21"/>
</g>
<!-- O_s1_l14_tp1 -->
<g id="node1212" class="node">
<title>O_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="4075.42,-3017.41 3737.42,-3017.41 3737.42,-2964.41 4075.42,-2964.41 4075.42,-3017.41"/>
<text text-anchor="middle" x="3906.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3906.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3906.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp1 -->
<g id="edge2018" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5392.7,-3078.22C5117.16,-3064.92 4658.83,-3041.84 4264.42,-3017.41 4206.34,-3013.82 4142.99,-3009.45 4085.95,-3005.35"/>
<polygon fill="black" stroke="black" points="4085.97,-3001.85 4075.74,-3004.62 4085.47,-3008.83 4085.97,-3001.85"/>
</g>
<!-- O_s1_l14_tp2 -->
<g id="node1213" class="node">
<title>O_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="4611.42,-3017.41 4273.42,-3017.41 4273.42,-2964.41 4611.42,-2964.41 4611.42,-3017.41"/>
<text text-anchor="middle" x="4442.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4442.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4442.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp2 -->
<g id="edge2019" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5406.53,-3073.67C5214.58,-3059.95 4935.75,-3039.12 4692.42,-3017.41 4669.51,-3015.37 4645.44,-3013.09 4621.65,-3010.75"/>
<polygon fill="black" stroke="black" points="4621.77,-3007.24 4611.47,-3009.74 4621.08,-3014.21 4621.77,-3007.24"/>
</g>
<!-- O_s1_l14_tp3 -->
<g id="node1214" class="node">
<title>O_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="5962.42,-3017.41 5624.42,-3017.41 5624.42,-2964.41 5962.42,-2964.41 5962.42,-3017.41"/>
<text text-anchor="middle" x="5793.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5793.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5793.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp3 -->
<g id="edge2020" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5696.09,-3054.24C5712.1,-3043.99 5729.42,-3032.9 5744.95,-3022.95"/>
<polygon fill="black" stroke="black" points="5746.84,-3025.9 5753.38,-3017.56 5743.07,-3020 5746.84,-3025.9"/>
</g>
<!-- O_s1_l14_tp4 -->
<g id="node1215" class="node">
<title>O_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="6928.42,-3017.41 6590.42,-3017.41 6590.42,-2964.41 6928.42,-2964.41 6928.42,-3017.41"/>
<text text-anchor="middle" x="6759.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6759.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6759.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp4 -->
<g id="edge2021" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M5861.5,-3070.53C6072.01,-3052.1 6384.9,-3024.71 6580.28,-3007.6"/>
<polygon fill="black" stroke="black" points="6580.7,-3011.07 6590.36,-3006.72 6580.09,-3004.1 6580.7,-3011.07"/>
</g>
<!-- O_s1_l14_tp5 -->
<g id="node1216" class="node">
<title>O_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="3600.42,-3017.41 3262.42,-3017.41 3262.42,-2964.41 3600.42,-2964.41 3600.42,-3017.41"/>
<text text-anchor="middle" x="3431.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3431.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3431.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp5 -->
<g id="edge2022" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M5381.61,-3084C5013.89,-3074.74 4319.2,-3053.95 3728.42,-3017.41 3690.37,-3015.06 3649.63,-3011.95 3610.89,-3008.71"/>
<polygon fill="black" stroke="black" points="3610.81,-3005.19 3600.55,-3007.84 3610.22,-3012.17 3610.81,-3005.19"/>
</g>
<!-- O_s1_l14_tp6 -->
<g id="node1217" class="node">
<title>O_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="8459.42,-3017.41 8121.42,-3017.41 8121.42,-2964.41 8459.42,-2964.41 8459.42,-3017.41"/>
<text text-anchor="middle" x="8290.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="8290.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8290.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp6 -->
<g id="edge2023" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M5894.07,-3080.9C6273.18,-3067.41 7010.1,-3040.99 7636.42,-3017.41 7797.02,-3011.37 7979.8,-3004.22 8111.22,-2999.03"/>
<polygon fill="black" stroke="black" points="8111.53,-3002.52 8121.39,-2998.63 8111.26,-2995.53 8111.53,-3002.52"/>
</g>
<!-- O_s1_l14_tp7 -->
<g id="node1218" class="node">
<title>O_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="7627.42,-3017.41 7289.42,-3017.41 7289.42,-2964.41 7627.42,-2964.41 7627.42,-3017.41"/>
<text text-anchor="middle" x="7458.42" y="-3002.21" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7458.42" y="-2987.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="7458.42" y="-2972.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l14&#45;&gt;O_s1_l14_tp7 -->
<g id="edge2024" class="edge">
<title>AR_attn_s1_l14&#45;&gt;O_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M5884.19,-3076.75C6254.83,-3056.78 6951.57,-3019.23 7279.35,-3001.56"/>
<polygon fill="black" stroke="black" points="7279.62,-3005.05 7289.42,-3001.02 7279.24,-2998.06 7279.62,-3005.05"/>
</g>
<!-- O_s1_l14_tp0&#45;&gt;ResAttn_s1_l14_tp0 -->
<g id="edge2025" class="edge">
<title>O_s1_l14_tp0&#45;&gt;ResAttn_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M4822.58,-2964.3C4805.35,-2955.07 4785.14,-2944.26 4764.92,-2933.43"/>
<polygon fill="black" stroke="black" points="4766.41,-2930.26 4755.94,-2928.62 4763.11,-2936.43 4766.41,-2930.26"/>
</g>
<!-- O_s1_l14_tp1&#45;&gt;ResAttn_s1_l14_tp1 -->
<g id="edge2027" class="edge">
<title>O_s1_l14_tp1&#45;&gt;ResAttn_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M3737.36,-2971.55C3592.58,-2955.83 3379.64,-2932.7 3199.97,-2913.18"/>
<polygon fill="black" stroke="black" points="3200.14,-2909.68 3189.82,-2912.08 3199.38,-2916.64 3200.14,-2909.68"/>
</g>
<!-- O_s1_l14_tp2&#45;&gt;ResAttn_s1_l14_tp2 -->
<g id="edge2029" class="edge">
<title>O_s1_l14_tp2&#45;&gt;ResAttn_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M4277.47,-2964.37C4211.47,-2954.15 4132.83,-2941.98 4055.41,-2929.99"/>
<polygon fill="black" stroke="black" points="4055.9,-2926.52 4045.49,-2928.45 4054.83,-2933.44 4055.9,-2926.52"/>
</g>
<!-- O_s1_l14_tp3&#45;&gt;ResAttn_s1_l14_tp3 -->
<g id="edge2031" class="edge">
<title>O_s1_l14_tp3&#45;&gt;ResAttn_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5962.48,-2971.27C6127.91,-2953.02 6381.9,-2925 6571.01,-2904.14"/>
<polygon fill="black" stroke="black" points="6571.54,-2907.61 6581.1,-2903.03 6570.77,-2900.65 6571.54,-2907.61"/>
</g>
<!-- O_s1_l14_tp4&#45;&gt;ResAttn_s1_l14_tp4 -->
<g id="edge2033" class="edge">
<title>O_s1_l14_tp4&#45;&gt;ResAttn_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M6928.48,-2968.5C7063.95,-2951.34 7255.95,-2927.02 7408.61,-2907.68"/>
<polygon fill="black" stroke="black" points="7409.13,-2911.14 7418.61,-2906.41 7408.25,-2904.2 7409.13,-2911.14"/>
</g>
<!-- O_s1_l14_tp5&#45;&gt;ResAttn_s1_l14_tp5 -->
<g id="edge2035" class="edge">
<title>O_s1_l14_tp5&#45;&gt;ResAttn_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M3262.32,-2978.73C3076.14,-2966.42 2767.93,-2946.03 2502.42,-2928.41 2349.79,-2918.29 2180.39,-2907.02 2038.4,-2897.58"/>
<polygon fill="black" stroke="black" points="2038.43,-2894.07 2028.22,-2896.9 2037.97,-2901.06 2038.43,-2894.07"/>
</g>
<!-- O_s1_l14_tp6&#45;&gt;ResAttn_s1_l14_tp6 -->
<g id="edge2037" class="edge">
<title>O_s1_l14_tp6&#45;&gt;ResAttn_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M8459.73,-2978.59C8755.95,-2958.78 9370.2,-2917.69 9722.93,-2894.1"/>
<polygon fill="black" stroke="black" points="9723.29,-2897.59 9733.03,-2893.43 9722.82,-2890.6 9723.29,-2897.59"/>
</g>
<!-- O_s1_l14_tp7&#45;&gt;ResAttn_s1_l14_tp7 -->
<g id="edge2039" class="edge">
<title>O_s1_l14_tp7&#45;&gt;ResAttn_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M7627.53,-2975.39C7853.74,-2955.97 8256.95,-2921.36 8521.53,-2898.64"/>
<polygon fill="black" stroke="black" points="8522.01,-2902.11 8531.67,-2897.77 8521.41,-2895.14 8522.01,-2902.11"/>
</g>
<!-- Gate_s1_l14_tp0 -->
<g id="node1227" class="node">
<title>Gate_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5111.42,-2786.41 4773.42,-2786.41 4773.42,-2733.41 5111.42,-2733.41 5111.42,-2786.41"/>
<text text-anchor="middle" x="4942.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4942.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4942.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp0&#45;&gt;Gate_s1_l14_tp0 -->
<g id="edge2041" class="edge">
<title>ResAttn_s1_l14_tp0&#45;&gt;Gate_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M4788.79,-2822.31C4816.33,-2811.3 4844.47,-2800.06 4869.01,-2790.25"/>
<polygon fill="black" stroke="black" points="4870.6,-2793.39 4878.58,-2786.43 4868,-2786.89 4870.6,-2793.39"/>
</g>
<!-- ResMOE_s1_l14_tp0 -->
<g id="node1268" class="node">
<title>ResMOE_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5885.77,-2497.46 5328.45,-2497.46 5185.08,-2391.46 5742.4,-2391.46 5885.77,-2497.46"/>
<text text-anchor="middle" x="5535.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5535.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5535.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp0&#45;&gt;ResMOE_s1_l14_tp0 -->
<g id="edge2114" class="edge">
<title>ResAttn_s1_l14_tp0&#45;&gt;ResMOE_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M4333.36,-2841.34C4247.31,-2833.79 4154.43,-2826.73 4068.42,-2822.41 3426.96,-2790.2 1818.86,-2834.95 1178.42,-2786.41 893.38,-2764.81 729.05,-2913.08 541.42,-2697.41 525.96,-2679.64 525.06,-2661.35 541.42,-2644.41 705.76,-2474.3 4560.22,-2509.85 4796.42,-2497.46 4955.25,-2489.13 5133.06,-2476.72 5274.46,-2466.11"/>
<polygon fill="black" stroke="black" points="5274.87,-2469.59 5284.58,-2465.35 5274.35,-2462.6 5274.87,-2469.59"/>
</g>
<!-- Gate_s1_l14_tp1 -->
<g id="node1228" class="node">
<title>Gate_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="2829.42,-2786.41 2491.42,-2786.41 2491.42,-2733.41 2829.42,-2733.41 2829.42,-2786.41"/>
<text text-anchor="middle" x="2660.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2660.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2660.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp1&#45;&gt;Gate_s1_l14_tp1 -->
<g id="edge2042" class="edge">
<title>ResAttn_s1_l14_tp1&#45;&gt;Gate_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M2769.16,-2822.31C2750.52,-2811.79 2731.51,-2801.05 2714.7,-2791.56"/>
<polygon fill="black" stroke="black" points="2716.03,-2788.3 2705.61,-2786.43 2712.59,-2794.39 2716.03,-2788.3"/>
</g>
<!-- ResMOE_s1_l14_tp1 -->
<g id="node1269" class="node">
<title>ResMOE_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="3311.77,-2497.46 2754.45,-2497.46 2611.08,-2391.46 3168.4,-2391.46 3311.77,-2497.46"/>
<text text-anchor="middle" x="2961.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2961.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2961.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp1&#45;&gt;ResMOE_s1_l14_tp1 -->
<g id="edge2116" class="edge">
<title>ResAttn_s1_l14_tp1&#45;&gt;ResMOE_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M2548.62,-2850.45C2405.65,-2840.31 2234.04,-2829.28 2079.42,-2822.41 2034.76,-2820.43 501.68,-2818.38 470.42,-2786.41 431.12,-2746.22 431.38,-2573.9 470.42,-2533.46 489.44,-2513.76 2037.01,-2470.16 2683.01,-2452.8"/>
<polygon fill="black" stroke="black" points="2683.49,-2456.29 2693.4,-2452.52 2683.31,-2449.29 2683.49,-2456.29"/>
</g>
<!-- Gate_s1_l14_tp2 -->
<g id="node1229" class="node">
<title>Gate_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="3878.42,-2786.41 3540.42,-2786.41 3540.42,-2733.41 3878.42,-2733.41 3878.42,-2786.41"/>
<text text-anchor="middle" x="3709.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3709.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3709.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp2&#45;&gt;Gate_s1_l14_tp2 -->
<g id="edge2043" class="edge">
<title>ResAttn_s1_l14_tp2&#45;&gt;Gate_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M3709.42,-2822.31C3709.42,-2813.64 3709.42,-2804.83 3709.42,-2796.68"/>
<polygon fill="black" stroke="black" points="3712.92,-2796.43 3709.42,-2786.43 3705.92,-2796.43 3712.92,-2796.43"/>
</g>
<!-- ResMOE_s1_l14_tp2 -->
<g id="node1270" class="node">
<title>ResMOE_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="4787.77,-2497.46 4230.45,-2497.46 4087.08,-2391.46 4644.4,-2391.46 4787.77,-2497.46"/>
<text text-anchor="middle" x="4437.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4437.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4437.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp2&#45;&gt;ResMOE_s1_l14_tp2 -->
<g id="edge2118" class="edge">
<title>ResAttn_s1_l14_tp2&#45;&gt;ResMOE_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M3375.7,-2834.76C3323.78,-2829.79 3270.7,-2825.41 3220.42,-2822.41 3182.82,-2820.17 534.88,-2813.23 508.42,-2786.41 468.94,-2746.4 468.93,-2573.46 508.42,-2533.46 535.86,-2505.67 3281.38,-2498.62 3320.42,-2497.46 3610.82,-2488.84 3943.4,-2472.53 4169.62,-2460.47"/>
<polygon fill="black" stroke="black" points="4169.84,-2463.96 4179.64,-2459.93 4169.47,-2456.97 4169.84,-2463.96"/>
</g>
<!-- Gate_s1_l14_tp3 -->
<g id="node1230" class="node">
<title>Gate_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6741.42,-2786.41 6403.42,-2786.41 6403.42,-2733.41 6741.42,-2733.41 6741.42,-2786.41"/>
<text text-anchor="middle" x="6572.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6572.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6572.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp3&#45;&gt;Gate_s1_l14_tp3 -->
<g id="edge2044" class="edge">
<title>ResAttn_s1_l14_tp3&#45;&gt;Gate_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M6707.67,-2822.31C6683.74,-2811.45 6659.31,-2800.36 6637.91,-2790.64"/>
<polygon fill="black" stroke="black" points="6639.17,-2787.37 6628.62,-2786.43 6636.28,-2793.75 6639.17,-2787.37"/>
</g>
<!-- ResMOE_s1_l14_tp3 -->
<g id="node1271" class="node">
<title>ResMOE_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6734.77,-2497.46 6177.45,-2497.46 6034.08,-2391.46 6591.4,-2391.46 6734.77,-2497.46"/>
<text text-anchor="middle" x="6384.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6384.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6384.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp3&#45;&gt;ResMOE_s1_l14_tp3 -->
<g id="edge2120" class="edge">
<title>ResAttn_s1_l14_tp3&#45;&gt;ResMOE_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M7058.62,-2843.92C7134.43,-2835.36 7218.85,-2827.12 7296.42,-2822.41 7970.79,-2781.53 9662.74,-2837.26 10336.42,-2786.41 10625.66,-2764.58 11174.04,-2853.91 10973.42,-2644.41 10936.26,-2605.61 7706.82,-2491.05 6688.44,-2455.86"/>
<polygon fill="black" stroke="black" points="6688.53,-2452.36 6678.41,-2455.52 6688.29,-2459.36 6688.53,-2452.36"/>
</g>
<!-- Gate_s1_l14_tp4 -->
<g id="node1231" class="node">
<title>Gate_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="7824.42,-2786.41 7486.42,-2786.41 7486.42,-2733.41 7824.42,-2733.41 7824.42,-2786.41"/>
<text text-anchor="middle" x="7655.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7655.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7655.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp4&#45;&gt;Gate_s1_l14_tp4 -->
<g id="edge2045" class="edge">
<title>ResAttn_s1_l14_tp4&#45;&gt;Gate_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M7655.42,-2822.31C7655.42,-2813.64 7655.42,-2804.83 7655.42,-2796.68"/>
<polygon fill="black" stroke="black" points="7658.92,-2796.43 7655.42,-2786.43 7651.92,-2796.43 7658.92,-2796.43"/>
</g>
<!-- ResMOE_s1_l14_tp4 -->
<g id="node1272" class="node">
<title>ResMOE_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="8771.77,-2497.46 8214.45,-2497.46 8071.08,-2391.46 8628.4,-2391.46 8771.77,-2497.46"/>
<text text-anchor="middle" x="8421.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8421.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8421.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp4&#45;&gt;ResMOE_s1_l14_tp4 -->
<g id="edge2122" class="edge">
<title>ResAttn_s1_l14_tp4&#45;&gt;ResMOE_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M7905.36,-2854.16C8054.97,-2842.85 8248.96,-2829.63 8421.42,-2822.41 8673.12,-2811.88 10439.14,-2822.76 10688.42,-2786.41 10833.23,-2765.3 10917.03,-2814.04 11005.42,-2697.41 11187.3,-2457.45 9960.64,-2556.5 9660.42,-2533.46 9347.75,-2509.46 8990.5,-2484.33 8740.21,-2467.1"/>
<polygon fill="black" stroke="black" points="8740.08,-2463.58 8729.86,-2466.39 8739.6,-2470.57 8740.08,-2463.58"/>
</g>
<!-- Gate_s1_l14_tp5 -->
<g id="node1232" class="node">
<title>Gate_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="1525.42,-2786.41 1187.42,-2786.41 1187.42,-2733.41 1525.42,-2733.41 1525.42,-2786.41"/>
<text text-anchor="middle" x="1356.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1356.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1356.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp5&#45;&gt;Gate_s1_l14_tp5 -->
<g id="edge2046" class="edge">
<title>ResAttn_s1_l14_tp5&#45;&gt;Gate_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M1553.6,-2822.4C1517.33,-2811.09 1480.24,-2799.52 1448.17,-2789.52"/>
<polygon fill="black" stroke="black" points="1448.97,-2786.1 1438.38,-2786.47 1446.88,-2792.79 1448.97,-2786.1"/>
</g>
<!-- ResMOE_s1_l14_tp5 -->
<g id="node1273" class="node">
<title>ResMOE_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="1078.77,-2497.46 521.45,-2497.46 378.08,-2391.46 935.4,-2391.46 1078.77,-2497.46"/>
<text text-anchor="middle" x="728.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="728.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="728.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp5&#45;&gt;ResMOE_s1_l14_tp5 -->
<g id="edge2124" class="edge">
<title>ResAttn_s1_l14_tp5&#45;&gt;ResMOE_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M1439.9,-2874.1C1085.6,-2870.83 513.52,-2854.85 444.42,-2786.41 364.54,-2707.29 372.32,-2622.93 440.42,-2533.46 450.9,-2519.7 475.19,-2507.17 505.46,-2496.16"/>
<polygon fill="black" stroke="black" points="506.77,-2499.42 515.04,-2492.8 504.45,-2492.81 506.77,-2499.42"/>
</g>
<!-- Gate_s1_l14_tp6 -->
<g id="node1233" class="node">
<title>Gate_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="10327.42,-2786.41 9989.42,-2786.41 9989.42,-2733.41 10327.42,-2733.41 10327.42,-2786.41"/>
<text text-anchor="middle" x="10158.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10158.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10158.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp6&#45;&gt;Gate_s1_l14_tp6 -->
<g id="edge2047" class="edge">
<title>ResAttn_s1_l14_tp6&#45;&gt;Gate_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M10065.92,-2822.31C10081.48,-2811.99 10097.35,-2801.45 10111.45,-2792.09"/>
<polygon fill="black" stroke="black" points="10113.59,-2794.87 10119.98,-2786.43 10109.72,-2789.04 10113.59,-2794.87"/>
</g>
<!-- ResMOE_s1_l14_tp6 -->
<g id="node1274" class="node">
<title>ResMOE_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="11197.77,-2497.46 10640.45,-2497.46 10497.08,-2391.46 11054.4,-2391.46 11197.77,-2497.46"/>
<text text-anchor="middle" x="10847.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10847.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10847.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp6&#45;&gt;ResMOE_s1_l14_tp6 -->
<g id="edge2126" class="edge">
<title>ResAttn_s1_l14_tp6&#45;&gt;ResMOE_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M10260.91,-2871.37C10567.05,-2865.06 11027.71,-2845.69 11082.42,-2786.41 11158.67,-2703.8 11146.48,-2625.85 11082.42,-2533.46 11074.53,-2522.08 11064.98,-2512.17 11054.3,-2503.54"/>
<polygon fill="black" stroke="black" points="11056.41,-2500.75 11046.33,-2497.48 11052.17,-2506.32 11056.41,-2500.75"/>
</g>
<!-- Gate_s1_l14_tp7 -->
<g id="node1234" class="node">
<title>Gate_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="9023.42,-2786.41 8685.42,-2786.41 8685.42,-2733.41 9023.42,-2733.41 9023.42,-2786.41"/>
<text text-anchor="middle" x="8854.42" y="-2771.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8854.42" y="-2756.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8854.42" y="-2741.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp7&#45;&gt;Gate_s1_l14_tp7 -->
<g id="edge2048" class="edge">
<title>ResAttn_s1_l14_tp7&#45;&gt;Gate_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M8814.39,-2822.31C8820.43,-2813.06 8826.57,-2803.64 8832.17,-2795.04"/>
<polygon fill="black" stroke="black" points="8835.26,-2796.72 8837.79,-2786.43 8829.39,-2792.89 8835.26,-2796.72"/>
</g>
<!-- ResMOE_s1_l14_tp7 -->
<g id="node1275" class="node">
<title>ResMOE_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="10149.77,-2497.46 9592.45,-2497.46 9449.08,-2391.46 10006.4,-2391.46 10149.77,-2497.46"/>
<text text-anchor="middle" x="9799.42" y="-2455.76" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9799.42" y="-2440.76" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9799.42" y="-2425.76" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l14_tp7&#45;&gt;ResMOE_s1_l14_tp7 -->
<g id="edge2128" class="edge">
<title>ResAttn_s1_l14_tp7&#45;&gt;ResMOE_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M9034.03,-2856.76C9202.48,-2845.55 9428.58,-2831.5 9628.42,-2822.41 9763.23,-2816.28 10711.28,-2818.22 10842.42,-2786.41 10931.48,-2764.81 10979.57,-2774.95 11028.42,-2697.41 11040.98,-2677.48 11043.69,-2662.35 11028.42,-2644.41 10970.53,-2576.39 10474.95,-2513.26 10131.07,-2477.07"/>
<polygon fill="black" stroke="black" points="10131.26,-2473.57 10120.95,-2476 10130.53,-2480.53 10131.26,-2473.57"/>
</g>
<!-- Expert32_s1_l14_tp0 -->
<g id="node1235" class="node">
<title>Expert32_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5422.42,-2697.41 5114.42,-2697.41 5114.42,-2644.41 5422.42,-2644.41 5422.42,-2697.41"/>
<text text-anchor="middle" x="5268.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="5268.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5268.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp0&#45;&gt;Expert32_s1_l14_tp0 -->
<g id="edge2049" class="edge">
<title>Gate_s1_l14_tp0&#45;&gt;Expert32_s1_l14_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5038.03,-2733.4C5077.26,-2722.93 5122.8,-2710.78 5162.99,-2700.05"/>
<polygon fill="black" stroke="black" points="5164.06,-2703.39 5172.82,-2697.43 5162.25,-2696.62 5164.06,-2703.39"/>
</g>
<!-- Expert33_s1_l14_tp0 -->
<g id="node1236" class="node">
<title>Expert33_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5748.42,-2697.41 5440.42,-2697.41 5440.42,-2644.41 5748.42,-2644.41 5748.42,-2697.41"/>
<text text-anchor="middle" x="5594.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="5594.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5594.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp0&#45;&gt;Expert33_s1_l14_tp0 -->
<g id="edge2050" class="edge">
<title>Gate_s1_l14_tp0&#45;&gt;Expert33_s1_l14_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5111.47,-2738.92C5202.97,-2727.79 5318.22,-2713.28 5429.9,-2697.61"/>
<polygon fill="black" stroke="black" points="5430.59,-2701.05 5440.01,-2696.19 5429.62,-2694.12 5430.59,-2701.05"/>
</g>
<!-- Expert34_s1_l14_tp0 -->
<g id="node1237" class="node">
<title>Expert34_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="4770.42,-2697.41 4462.42,-2697.41 4462.42,-2644.41 4770.42,-2644.41 4770.42,-2697.41"/>
<text text-anchor="middle" x="4616.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="4616.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4616.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp0&#45;&gt;Expert34_s1_l14_tp0 -->
<g id="edge2051" class="edge">
<title>Gate_s1_l14_tp0&#45;&gt;Expert34_s1_l14_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4846.81,-2733.4C4807.59,-2722.93 4762.04,-2710.78 4721.85,-2700.05"/>
<polygon fill="black" stroke="black" points="4722.59,-2696.62 4712.03,-2697.43 4720.79,-2703.39 4722.59,-2696.62"/>
</g>
<!-- Expert35_s1_l14_tp0 -->
<g id="node1238" class="node">
<title>Expert35_s1_l14_tp0</title>
<polygon fill="none" stroke="black" points="5096.42,-2697.41 4788.42,-2697.41 4788.42,-2644.41 5096.42,-2644.41 5096.42,-2697.41"/>
<text text-anchor="middle" x="4942.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="4942.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4942.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp0&#45;&gt;Expert35_s1_l14_tp0 -->
<g id="edge2052" class="edge">
<title>Gate_s1_l14_tp0&#45;&gt;Expert35_s1_l14_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4942.42,-2733.28C4942.42,-2725.3 4942.42,-2716.35 4942.42,-2707.8"/>
<polygon fill="black" stroke="black" points="4945.92,-2707.66 4942.42,-2697.66 4938.92,-2707.66 4945.92,-2707.66"/>
</g>
<!-- Expert36_s1_l14_tp1 -->
<g id="node1239" class="node">
<title>Expert36_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="2814.42,-2697.41 2506.42,-2697.41 2506.42,-2644.41 2814.42,-2644.41 2814.42,-2697.41"/>
<text text-anchor="middle" x="2660.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="2660.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2660.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp1&#45;&gt;Expert36_s1_l14_tp1 -->
<g id="edge2053" class="edge">
<title>Gate_s1_l14_tp1&#45;&gt;Expert36_s1_l14_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2660.42,-2733.28C2660.42,-2725.3 2660.42,-2716.35 2660.42,-2707.8"/>
<polygon fill="black" stroke="black" points="2663.92,-2707.66 2660.42,-2697.66 2656.92,-2707.66 2663.92,-2707.66"/>
</g>
<!-- Expert37_s1_l14_tp1 -->
<g id="node1240" class="node">
<title>Expert37_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="3140.42,-2697.41 2832.42,-2697.41 2832.42,-2644.41 3140.42,-2644.41 3140.42,-2697.41"/>
<text text-anchor="middle" x="2986.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="2986.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2986.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp1&#45;&gt;Expert37_s1_l14_tp1 -->
<g id="edge2054" class="edge">
<title>Gate_s1_l14_tp1&#45;&gt;Expert37_s1_l14_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.03,-2733.4C2795.26,-2722.93 2840.8,-2710.78 2880.99,-2700.05"/>
<polygon fill="black" stroke="black" points="2882.06,-2703.39 2890.82,-2697.43 2880.25,-2696.62 2882.06,-2703.39"/>
</g>
<!-- Expert38_s1_l14_tp1 -->
<g id="node1241" class="node">
<title>Expert38_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="2162.42,-2697.41 1854.42,-2697.41 1854.42,-2644.41 2162.42,-2644.41 2162.42,-2697.41"/>
<text text-anchor="middle" x="2008.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="2008.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2008.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp1&#45;&gt;Expert38_s1_l14_tp1 -->
<g id="edge2055" class="edge">
<title>Gate_s1_l14_tp1&#45;&gt;Expert38_s1_l14_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2491.37,-2738.92C2399.87,-2727.79 2284.63,-2713.28 2172.94,-2697.61"/>
<polygon fill="black" stroke="black" points="2173.23,-2694.12 2162.84,-2696.19 2172.25,-2701.05 2173.23,-2694.12"/>
</g>
<!-- Expert39_s1_l14_tp1 -->
<g id="node1242" class="node">
<title>Expert39_s1_l14_tp1</title>
<polygon fill="none" stroke="black" points="2488.42,-2697.41 2180.42,-2697.41 2180.42,-2644.41 2488.42,-2644.41 2488.42,-2697.41"/>
<text text-anchor="middle" x="2334.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="2334.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2334.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp1&#45;&gt;Expert39_s1_l14_tp1 -->
<g id="edge2056" class="edge">
<title>Gate_s1_l14_tp1&#45;&gt;Expert39_s1_l14_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2564.81,-2733.4C2525.59,-2722.93 2480.04,-2710.78 2439.85,-2700.05"/>
<polygon fill="black" stroke="black" points="2440.59,-2696.62 2430.03,-2697.43 2438.79,-2703.39 2440.59,-2696.62"/>
</g>
<!-- Expert40_s1_l14_tp2 -->
<g id="node1243" class="node">
<title>Expert40_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="4444.42,-2697.41 4136.42,-2697.41 4136.42,-2644.41 4444.42,-2644.41 4444.42,-2697.41"/>
<text text-anchor="middle" x="4290.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="4290.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4290.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp2&#45;&gt;Expert40_s1_l14_tp2 -->
<g id="edge2057" class="edge">
<title>Gate_s1_l14_tp2&#45;&gt;Expert40_s1_l14_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3878.54,-2734.39C3951.81,-2723.67 4038.84,-2710.83 4125.93,-2697.64"/>
<polygon fill="black" stroke="black" points="4126.63,-2701.07 4135.99,-2696.11 4125.58,-2694.15 4126.63,-2701.07"/>
</g>
<!-- Expert41_s1_l14_tp2 -->
<g id="node1244" class="node">
<title>Expert41_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="3466.42,-2697.41 3158.42,-2697.41 3158.42,-2644.41 3466.42,-2644.41 3466.42,-2697.41"/>
<text text-anchor="middle" x="3312.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="3312.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3312.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp2&#45;&gt;Expert41_s1_l14_tp2 -->
<g id="edge2058" class="edge">
<title>Gate_s1_l14_tp2&#45;&gt;Expert41_s1_l14_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3592.99,-2733.4C3544.52,-2722.78 3488.11,-2710.42 3438.65,-2699.57"/>
<polygon fill="black" stroke="black" points="3439.37,-2696.15 3428.85,-2697.43 3437.87,-2702.99 3439.37,-2696.15"/>
</g>
<!-- Expert42_s1_l14_tp2 -->
<g id="node1245" class="node">
<title>Expert42_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="3792.42,-2697.41 3484.42,-2697.41 3484.42,-2644.41 3792.42,-2644.41 3792.42,-2697.41"/>
<text text-anchor="middle" x="3638.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="3638.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3638.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp2&#45;&gt;Expert42_s1_l14_tp2 -->
<g id="edge2059" class="edge">
<title>Gate_s1_l14_tp2&#45;&gt;Expert42_s1_l14_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3688.5,-2733.28C3681.42,-2724.6 3673.39,-2714.76 3665.88,-2705.55"/>
<polygon fill="black" stroke="black" points="3668.47,-2703.2 3659.44,-2697.66 3663.05,-2707.62 3668.47,-2703.2"/>
</g>
<!-- Expert43_s1_l14_tp2 -->
<g id="node1246" class="node">
<title>Expert43_s1_l14_tp2</title>
<polygon fill="none" stroke="black" points="4118.42,-2697.41 3810.42,-2697.41 3810.42,-2644.41 4118.42,-2644.41 4118.42,-2697.41"/>
<text text-anchor="middle" x="3964.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="3964.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3964.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp2&#45;&gt;Expert43_s1_l14_tp2 -->
<g id="edge2060" class="edge">
<title>Gate_s1_l14_tp2&#45;&gt;Expert43_s1_l14_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3784.21,-2733.4C3814.31,-2723.13 3849.16,-2711.24 3880.15,-2700.66"/>
<polygon fill="black" stroke="black" points="3881.3,-2703.97 3889.64,-2697.43 3879.04,-2697.34 3881.3,-2703.97"/>
</g>
<!-- Expert44_s1_l14_tp3 -->
<g id="node1247" class="node">
<title>Expert44_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6074.42,-2697.41 5766.42,-2697.41 5766.42,-2644.41 6074.42,-2644.41 6074.42,-2697.41"/>
<text text-anchor="middle" x="5920.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="5920.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5920.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp3&#45;&gt;Expert44_s1_l14_tp3 -->
<g id="edge2061" class="edge">
<title>Gate_s1_l14_tp3&#45;&gt;Expert44_s1_l14_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6403.37,-2738.92C6311.87,-2727.79 6196.63,-2713.28 6084.94,-2697.61"/>
<polygon fill="black" stroke="black" points="6085.23,-2694.12 6074.84,-2696.19 6084.25,-2701.05 6085.23,-2694.12"/>
</g>
<!-- Expert45_s1_l14_tp3 -->
<g id="node1248" class="node">
<title>Expert45_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6400.42,-2697.41 6092.42,-2697.41 6092.42,-2644.41 6400.42,-2644.41 6400.42,-2697.41"/>
<text text-anchor="middle" x="6246.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6246.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6246.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp3&#45;&gt;Expert45_s1_l14_tp3 -->
<g id="edge2062" class="edge">
<title>Gate_s1_l14_tp3&#45;&gt;Expert45_s1_l14_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6476.81,-2733.4C6437.59,-2722.93 6392.04,-2710.78 6351.85,-2700.05"/>
<polygon fill="black" stroke="black" points="6352.59,-2696.62 6342.03,-2697.43 6350.79,-2703.39 6352.59,-2696.62"/>
</g>
<!-- Expert46_s1_l14_tp3 -->
<g id="node1249" class="node">
<title>Expert46_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="6726.42,-2697.41 6418.42,-2697.41 6418.42,-2644.41 6726.42,-2644.41 6726.42,-2697.41"/>
<text text-anchor="middle" x="6572.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="6572.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6572.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp3&#45;&gt;Expert46_s1_l14_tp3 -->
<g id="edge2063" class="edge">
<title>Gate_s1_l14_tp3&#45;&gt;Expert46_s1_l14_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6572.42,-2733.28C6572.42,-2725.3 6572.42,-2716.35 6572.42,-2707.8"/>
<polygon fill="black" stroke="black" points="6575.92,-2707.66 6572.42,-2697.66 6568.92,-2707.66 6575.92,-2707.66"/>
</g>
<!-- Expert47_s1_l14_tp3 -->
<g id="node1250" class="node">
<title>Expert47_s1_l14_tp3</title>
<polygon fill="none" stroke="black" points="7052.42,-2697.41 6744.42,-2697.41 6744.42,-2644.41 7052.42,-2644.41 7052.42,-2697.41"/>
<text text-anchor="middle" x="6898.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="6898.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6898.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp3&#45;&gt;Expert47_s1_l14_tp3 -->
<g id="edge2064" class="edge">
<title>Gate_s1_l14_tp3&#45;&gt;Expert47_s1_l14_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6668.03,-2733.4C6707.26,-2722.93 6752.8,-2710.78 6792.99,-2700.05"/>
<polygon fill="black" stroke="black" points="6794.06,-2703.39 6802.82,-2697.43 6792.25,-2696.62 6794.06,-2703.39"/>
</g>
<!-- Expert48_s1_l14_tp4 -->
<g id="node1251" class="node">
<title>Expert48_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="7378.42,-2697.41 7070.42,-2697.41 7070.42,-2644.41 7378.42,-2644.41 7378.42,-2697.41"/>
<text text-anchor="middle" x="7224.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7224.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7224.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp4&#45;&gt;Expert48_s1_l14_tp4 -->
<g id="edge2065" class="edge">
<title>Gate_s1_l14_tp4&#45;&gt;Expert48_s1_l14_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7529.02,-2733.4C7476.17,-2722.73 7414.65,-2710.31 7360.79,-2699.44"/>
<polygon fill="black" stroke="black" points="7361.32,-2695.98 7350.82,-2697.43 7359.93,-2702.84 7361.32,-2695.98"/>
</g>
<!-- Expert49_s1_l14_tp4 -->
<g id="node1252" class="node">
<title>Expert49_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="7704.42,-2697.41 7396.42,-2697.41 7396.42,-2644.41 7704.42,-2644.41 7704.42,-2697.41"/>
<text text-anchor="middle" x="7550.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="7550.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7550.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp4&#45;&gt;Expert49_s1_l14_tp4 -->
<g id="edge2066" class="edge">
<title>Gate_s1_l14_tp4&#45;&gt;Expert49_s1_l14_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7624.49,-2733.28C7613.48,-2724.16 7600.94,-2713.77 7589.34,-2704.16"/>
<polygon fill="black" stroke="black" points="7591.43,-2701.35 7581.5,-2697.66 7586.97,-2706.74 7591.43,-2701.35"/>
</g>
<!-- Expert50_s1_l14_tp4 -->
<g id="node1253" class="node">
<title>Expert50_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="8030.42,-2697.41 7722.42,-2697.41 7722.42,-2644.41 8030.42,-2644.41 8030.42,-2697.41"/>
<text text-anchor="middle" x="7876.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="7876.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7876.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp4&#45;&gt;Expert50_s1_l14_tp4 -->
<g id="edge2067" class="edge">
<title>Gate_s1_l14_tp4&#45;&gt;Expert50_s1_l14_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7720.24,-2733.4C7745.87,-2723.31 7775.49,-2711.65 7802,-2701.21"/>
<polygon fill="black" stroke="black" points="7803.59,-2704.35 7811.61,-2697.43 7801.02,-2697.83 7803.59,-2704.35"/>
</g>
<!-- Expert51_s1_l14_tp4 -->
<g id="node1254" class="node">
<title>Expert51_s1_l14_tp4</title>
<polygon fill="none" stroke="black" points="8356.42,-2697.41 8048.42,-2697.41 8048.42,-2644.41 8356.42,-2644.41 8356.42,-2697.41"/>
<text text-anchor="middle" x="8202.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="8202.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8202.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp4&#45;&gt;Expert51_s1_l14_tp4 -->
<g id="edge2068" class="edge">
<title>Gate_s1_l14_tp4&#45;&gt;Expert51_s1_l14_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7815.84,-2733.4C7885.7,-2722.29 7967.51,-2709.28 8037.83,-2698.09"/>
<polygon fill="black" stroke="black" points="8038.79,-2701.48 8048.12,-2696.46 8037.69,-2694.57 8038.79,-2701.48"/>
</g>
<!-- Expert52_s1_l14_tp5 -->
<g id="node1255" class="node">
<title>Expert52_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="858.42,-2697.41 550.42,-2697.41 550.42,-2644.41 858.42,-2644.41 858.42,-2697.41"/>
<text text-anchor="middle" x="704.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="704.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="704.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp5&#45;&gt;Expert52_s1_l14_tp5 -->
<g id="edge2069" class="edge">
<title>Gate_s1_l14_tp5&#45;&gt;Expert52_s1_l14_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1187.37,-2738.92C1095.87,-2727.79 980.63,-2713.28 868.94,-2697.61"/>
<polygon fill="black" stroke="black" points="869.23,-2694.12 858.84,-2696.19 868.25,-2701.05 869.23,-2694.12"/>
</g>
<!-- Expert53_s1_l14_tp5 -->
<g id="node1256" class="node">
<title>Expert53_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="1184.42,-2697.41 876.42,-2697.41 876.42,-2644.41 1184.42,-2644.41 1184.42,-2697.41"/>
<text text-anchor="middle" x="1030.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="1030.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1030.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp5&#45;&gt;Expert53_s1_l14_tp5 -->
<g id="edge2070" class="edge">
<title>Gate_s1_l14_tp5&#45;&gt;Expert53_s1_l14_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1260.81,-2733.4C1221.59,-2722.93 1176.04,-2710.78 1135.85,-2700.05"/>
<polygon fill="black" stroke="black" points="1136.59,-2696.62 1126.03,-2697.43 1134.79,-2703.39 1136.59,-2696.62"/>
</g>
<!-- Expert54_s1_l14_tp5 -->
<g id="node1257" class="node">
<title>Expert54_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="1510.42,-2697.41 1202.42,-2697.41 1202.42,-2644.41 1510.42,-2644.41 1510.42,-2697.41"/>
<text text-anchor="middle" x="1356.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="1356.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1356.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp5&#45;&gt;Expert54_s1_l14_tp5 -->
<g id="edge2071" class="edge">
<title>Gate_s1_l14_tp5&#45;&gt;Expert54_s1_l14_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1356.42,-2733.28C1356.42,-2725.3 1356.42,-2716.35 1356.42,-2707.8"/>
<polygon fill="black" stroke="black" points="1359.92,-2707.66 1356.42,-2697.66 1352.92,-2707.66 1359.92,-2707.66"/>
</g>
<!-- Expert55_s1_l14_tp5 -->
<g id="node1258" class="node">
<title>Expert55_s1_l14_tp5</title>
<polygon fill="none" stroke="black" points="1836.42,-2697.41 1528.42,-2697.41 1528.42,-2644.41 1836.42,-2644.41 1836.42,-2697.41"/>
<text text-anchor="middle" x="1682.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="1682.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1682.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp5&#45;&gt;Expert55_s1_l14_tp5 -->
<g id="edge2072" class="edge">
<title>Gate_s1_l14_tp5&#45;&gt;Expert55_s1_l14_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1452.03,-2733.4C1491.26,-2722.93 1536.8,-2710.78 1576.99,-2700.05"/>
<polygon fill="black" stroke="black" points="1578.06,-2703.39 1586.82,-2697.43 1576.25,-2696.62 1578.06,-2703.39"/>
</g>
<!-- Expert56_s1_l14_tp6 -->
<g id="node1259" class="node">
<title>Expert56_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="9986.42,-2697.41 9678.42,-2697.41 9678.42,-2644.41 9986.42,-2644.41 9986.42,-2697.41"/>
<text text-anchor="middle" x="9832.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="9832.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9832.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp6&#45;&gt;Expert56_s1_l14_tp6 -->
<g id="edge2073" class="edge">
<title>Gate_s1_l14_tp6&#45;&gt;Expert56_s1_l14_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.81,-2733.4C10023.59,-2722.93 9978.04,-2710.78 9937.85,-2700.05"/>
<polygon fill="black" stroke="black" points="9938.59,-2696.62 9928.03,-2697.43 9936.79,-2703.39 9938.59,-2696.62"/>
</g>
<!-- Expert57_s1_l14_tp6 -->
<g id="node1260" class="node">
<title>Expert57_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="10312.42,-2697.41 10004.42,-2697.41 10004.42,-2644.41 10312.42,-2644.41 10312.42,-2697.41"/>
<text text-anchor="middle" x="10158.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="10158.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10158.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp6&#45;&gt;Expert57_s1_l14_tp6 -->
<g id="edge2074" class="edge">
<title>Gate_s1_l14_tp6&#45;&gt;Expert57_s1_l14_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10158.42,-2733.28C10158.42,-2725.3 10158.42,-2716.35 10158.42,-2707.8"/>
<polygon fill="black" stroke="black" points="10161.92,-2707.66 10158.42,-2697.66 10154.92,-2707.66 10161.92,-2707.66"/>
</g>
<!-- Expert58_s1_l14_tp6 -->
<g id="node1261" class="node">
<title>Expert58_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="10638.42,-2697.41 10330.42,-2697.41 10330.42,-2644.41 10638.42,-2644.41 10638.42,-2697.41"/>
<text text-anchor="middle" x="10484.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="10484.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10484.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp6&#45;&gt;Expert58_s1_l14_tp6 -->
<g id="edge2075" class="edge">
<title>Gate_s1_l14_tp6&#45;&gt;Expert58_s1_l14_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10254.03,-2733.4C10293.26,-2722.93 10338.8,-2710.78 10378.99,-2700.05"/>
<polygon fill="black" stroke="black" points="10380.06,-2703.39 10388.82,-2697.43 10378.25,-2696.62 10380.06,-2703.39"/>
</g>
<!-- Expert59_s1_l14_tp6 -->
<g id="node1262" class="node">
<title>Expert59_s1_l14_tp6</title>
<polygon fill="none" stroke="black" points="10964.42,-2697.41 10656.42,-2697.41 10656.42,-2644.41 10964.42,-2644.41 10964.42,-2697.41"/>
<text text-anchor="middle" x="10810.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="10810.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10810.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp6&#45;&gt;Expert59_s1_l14_tp6 -->
<g id="edge2076" class="edge">
<title>Gate_s1_l14_tp6&#45;&gt;Expert59_s1_l14_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10327.47,-2738.92C10418.97,-2727.79 10534.22,-2713.28 10645.9,-2697.61"/>
<polygon fill="black" stroke="black" points="10646.59,-2701.05 10656.01,-2696.19 10645.62,-2694.12 10646.59,-2701.05"/>
</g>
<!-- Expert60_s1_l14_tp7 -->
<g id="node1263" class="node">
<title>Expert60_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="8682.42,-2697.41 8374.42,-2697.41 8374.42,-2644.41 8682.42,-2644.41 8682.42,-2697.41"/>
<text text-anchor="middle" x="8528.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="8528.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8528.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp7&#45;&gt;Expert60_s1_l14_tp7 -->
<g id="edge2077" class="edge">
<title>Gate_s1_l14_tp7&#45;&gt;Expert60_s1_l14_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8758.81,-2733.4C8719.59,-2722.93 8674.04,-2710.78 8633.85,-2700.05"/>
<polygon fill="black" stroke="black" points="8634.59,-2696.62 8624.03,-2697.43 8632.79,-2703.39 8634.59,-2696.62"/>
</g>
<!-- Expert61_s1_l14_tp7 -->
<g id="node1264" class="node">
<title>Expert61_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="9008.42,-2697.41 8700.42,-2697.41 8700.42,-2644.41 9008.42,-2644.41 9008.42,-2697.41"/>
<text text-anchor="middle" x="8854.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="8854.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8854.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp7&#45;&gt;Expert61_s1_l14_tp7 -->
<g id="edge2078" class="edge">
<title>Gate_s1_l14_tp7&#45;&gt;Expert61_s1_l14_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8854.42,-2733.28C8854.42,-2725.3 8854.42,-2716.35 8854.42,-2707.8"/>
<polygon fill="black" stroke="black" points="8857.92,-2707.66 8854.42,-2697.66 8850.92,-2707.66 8857.92,-2707.66"/>
</g>
<!-- Expert62_s1_l14_tp7 -->
<g id="node1265" class="node">
<title>Expert62_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="9334.42,-2697.41 9026.42,-2697.41 9026.42,-2644.41 9334.42,-2644.41 9334.42,-2697.41"/>
<text text-anchor="middle" x="9180.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="9180.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9180.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp7&#45;&gt;Expert62_s1_l14_tp7 -->
<g id="edge2079" class="edge">
<title>Gate_s1_l14_tp7&#45;&gt;Expert62_s1_l14_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8950.03,-2733.4C8989.26,-2722.93 9034.8,-2710.78 9074.99,-2700.05"/>
<polygon fill="black" stroke="black" points="9076.06,-2703.39 9084.82,-2697.43 9074.25,-2696.62 9076.06,-2703.39"/>
</g>
<!-- Expert63_s1_l14_tp7 -->
<g id="node1266" class="node">
<title>Expert63_s1_l14_tp7</title>
<polygon fill="none" stroke="black" points="9660.42,-2697.41 9352.42,-2697.41 9352.42,-2644.41 9660.42,-2644.41 9660.42,-2697.41"/>
<text text-anchor="middle" x="9506.42" y="-2682.21" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="9506.42" y="-2667.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9506.42" y="-2652.21" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l14_tp7&#45;&gt;Expert63_s1_l14_tp7 -->
<g id="edge2080" class="edge">
<title>Gate_s1_l14_tp7&#45;&gt;Expert63_s1_l14_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9023.47,-2738.92C9114.97,-2727.79 9230.22,-2713.28 9341.9,-2697.61"/>
<polygon fill="black" stroke="black" points="9342.59,-2701.05 9352.01,-2696.19 9341.62,-2694.12 9342.59,-2701.05"/>
</g>
<!-- AR_exp_s1_l14 -->
<g id="node1267" class="node">
<title>AR_exp_s1_l14</title>
<ellipse fill="none" stroke="black" cx="5724.42" cy="-2570.94" rx="239" ry="37.45"/>
<text text-anchor="middle" x="5724.42" y="-2582.24" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="5724.42" y="-2567.24" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5724.42" y="-2552.24" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l14_tp0&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2081" class="edge">
<title>Expert32_s1_l14_tp0&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M5387.34,-2644.36C5445.08,-2631.96 5515.04,-2616.93 5576.22,-2603.78"/>
<polygon fill="black" stroke="black" points="5577.31,-2607.12 5586.35,-2601.6 5575.84,-2600.28 5577.31,-2607.12"/>
</g>
<!-- Expert33_s1_l14_tp0&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2082" class="edge">
<title>Expert33_s1_l14_tp0&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M5628.58,-2644.17C5640.79,-2634.97 5654.89,-2624.34 5668.46,-2614.12"/>
<polygon fill="black" stroke="black" points="5670.93,-2616.63 5676.81,-2607.82 5666.72,-2611.04 5670.93,-2616.63"/>
</g>
<!-- Expert34_s1_l14_tp0&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2083" class="edge">
<title>Expert34_s1_l14_tp0&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M4770.81,-2645.44C4773.71,-2645.09 4776.58,-2644.74 4779.42,-2644.41 5021.08,-2616.29 5298.82,-2596.47 5490.35,-2584.75"/>
<polygon fill="black" stroke="black" points="5490.78,-2588.23 5500.55,-2584.13 5490.36,-2581.25 5490.78,-2588.23"/>
</g>
<!-- Expert35_s1_l14_tp0&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2084" class="edge">
<title>Expert35_s1_l14_tp0&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M5096.83,-2645.6C5099.72,-2645.2 5102.58,-2644.8 5105.42,-2644.41 5243.32,-2625.56 5398.92,-2607.36 5519.62,-2593.91"/>
<polygon fill="black" stroke="black" points="5520.17,-2597.37 5529.72,-2592.78 5519.39,-2590.41 5520.17,-2597.37"/>
</g>
<!-- Expert36_s1_l14_tp1&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2085" class="edge">
<title>Expert36_s1_l14_tp1&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M2814.79,-2645.24C2817.69,-2644.95 2820.57,-2644.67 2823.42,-2644.41 3334.84,-2598.22 4871.22,-2579.64 5475.97,-2573.98"/>
<polygon fill="black" stroke="black" points="5476.16,-2577.48 5486.13,-2573.89 5476.09,-2570.48 5476.16,-2577.48"/>
</g>
<!-- Expert37_s1_l14_tp1&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2086" class="edge">
<title>Expert37_s1_l14_tp1&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M3140.79,-2645.25C3143.69,-2644.96 3146.57,-2644.68 3149.42,-2644.41 3595.79,-2603.38 4921.95,-2582.17 5476.41,-2574.9"/>
<polygon fill="black" stroke="black" points="5476.58,-2578.4 5486.54,-2574.76 5476.49,-2571.4 5476.58,-2578.4"/>
</g>
<!-- Expert38_s1_l14_tp1&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2087" class="edge">
<title>Expert38_s1_l14_tp1&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M2162.79,-2645.22C2165.69,-2644.93 2168.57,-2644.66 2171.42,-2644.41 2814.07,-2587.85 4777.83,-2575.33 5475.37,-2572.65"/>
<polygon fill="black" stroke="black" points="5475.55,-2576.15 5485.54,-2572.61 5475.53,-2569.15 5475.55,-2576.15"/>
</g>
<!-- Expert39_s1_l14_tp1&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2088" class="edge">
<title>Expert39_s1_l14_tp1&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M2488.79,-2645.23C2491.69,-2644.94 2494.57,-2644.67 2497.42,-2644.41 3074.2,-2593.05 4822.8,-2577.38 5475.34,-2573.25"/>
<polygon fill="black" stroke="black" points="5475.83,-2576.75 5485.81,-2573.19 5475.79,-2569.75 5475.83,-2576.75"/>
</g>
<!-- Expert40_s1_l14_tp2&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2089" class="edge">
<title>Expert40_s1_l14_tp2&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M4444.81,-2645.37C4447.7,-2645.04 4450.57,-2644.72 4453.42,-2644.41 4809.37,-2606.51 5223.66,-2587.56 5480,-2578.75"/>
<polygon fill="black" stroke="black" points="5480.31,-2582.24 5490.19,-2578.4 5480.08,-2575.24 5480.31,-2582.24"/>
</g>
<!-- Expert41_s1_l14_tp2&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2090" class="edge">
<title>Expert41_s1_l14_tp2&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M3466.8,-2645.27C3469.69,-2644.97 3472.57,-2644.68 3475.42,-2644.41 3857.24,-2608.53 4976.24,-2585.06 5477.1,-2576.07"/>
<polygon fill="black" stroke="black" points="5477.42,-2579.56 5487.35,-2575.88 5477.29,-2572.56 5477.42,-2579.56"/>
</g>
<!-- Expert42_s1_l14_tp2&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2091" class="edge">
<title>Expert42_s1_l14_tp2&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M3792.8,-2645.29C3795.69,-2644.98 3798.57,-2644.69 3801.42,-2644.41 4400.21,-2586.49 5108.03,-2574.2 5475.26,-2572"/>
<polygon fill="black" stroke="black" points="5475.51,-2575.49 5485.49,-2571.94 5475.47,-2568.5 5475.51,-2575.49"/>
</g>
<!-- Expert43_s1_l14_tp2&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2092" class="edge">
<title>Expert43_s1_l14_tp2&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M4118.8,-2645.32C4121.7,-2645 4124.57,-2644.7 4127.42,-2644.41 4603.1,-2596.56 5161.69,-2580.29 5476.24,-2574.77"/>
<polygon fill="black" stroke="black" points="5476.47,-2578.26 5486.4,-2574.59 5476.35,-2571.26 5476.47,-2578.26"/>
</g>
<!-- Expert44_s1_l14_tp3&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2093" class="edge">
<title>Expert44_s1_l14_tp3&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M5869.18,-2644.3C5849.04,-2634.23 5825.47,-2622.45 5803.26,-2611.34"/>
<polygon fill="black" stroke="black" points="5804.68,-2608.14 5794.17,-2606.8 5801.55,-2614.4 5804.68,-2608.14"/>
</g>
<!-- Expert45_s1_l14_tp3&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2094" class="edge">
<title>Expert45_s1_l14_tp3&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M6110.3,-2644.36C6041.2,-2631.39 5956.82,-2615.56 5884.61,-2602"/>
<polygon fill="black" stroke="black" points="5884.98,-2598.51 5874.51,-2600.11 5883.69,-2605.39 5884.98,-2598.51"/>
</g>
<!-- Expert46_s1_l14_tp3&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2095" class="edge">
<title>Expert46_s1_l14_tp3&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M6418.02,-2645.56C6415.13,-2645.17 6412.26,-2644.79 6409.42,-2644.41 6251.67,-2623.74 6072.87,-2604.98 5937.51,-2591.73"/>
<polygon fill="black" stroke="black" points="5937.72,-2588.23 5927.43,-2590.74 5937.04,-2595.2 5937.72,-2588.23"/>
</g>
<!-- Expert47_s1_l14_tp3&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2096" class="edge">
<title>Expert47_s1_l14_tp3&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M6744.03,-2645.42C6741.14,-2645.08 6738.27,-2644.74 6735.42,-2644.41 6471.15,-2614.32 6166.51,-2594.5 5961.29,-2583.31"/>
<polygon fill="black" stroke="black" points="5961.46,-2579.81 5951.29,-2582.77 5961.08,-2586.8 5961.46,-2579.81"/>
</g>
<!-- Expert48_s1_l14_tp4&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2097" class="edge">
<title>Expert48_s1_l14_tp4&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M7070.04,-2645.36C7067.15,-2645.03 7064.27,-2644.71 7061.42,-2644.41 6681.67,-2604.52 6238.79,-2585.98 5970.14,-2577.82"/>
<polygon fill="black" stroke="black" points="5969.97,-2574.31 5959.87,-2577.51 5969.76,-2581.31 5969.97,-2574.31"/>
</g>
<!-- Expert49_s1_l14_tp4&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2098" class="edge">
<title>Expert49_s1_l14_tp4&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M7396.04,-2645.31C7393.15,-2645 7390.27,-2644.7 7387.42,-2644.41 6887.03,-2594.53 6298.55,-2578.97 5972.92,-2574.13"/>
<polygon fill="black" stroke="black" points="5972.94,-2570.63 5962.89,-2573.98 5972.83,-2577.63 5972.94,-2570.63"/>
</g>
<!-- Expert50_s1_l14_tp4&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2099" class="edge">
<title>Expert50_s1_l14_tp4&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M7722.05,-2645.29C7719.15,-2644.98 7716.27,-2644.69 7713.42,-2644.41 7089.45,-2584.45 6351.02,-2573.08 5973.68,-2571.54"/>
<polygon fill="black" stroke="black" points="5973.47,-2568.04 5963.45,-2571.5 5973.44,-2575.04 5973.47,-2568.04"/>
</g>
<!-- Expert51_s1_l14_tp4&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2100" class="edge">
<title>Expert51_s1_l14_tp4&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M8048.05,-2645.27C8045.15,-2644.96 8042.27,-2644.68 8039.42,-2644.41 7644.56,-2607.49 6483.77,-2584.44 5971.82,-2575.8"/>
<polygon fill="black" stroke="black" points="5971.77,-2572.3 5961.71,-2575.63 5971.65,-2579.3 5971.77,-2572.3"/>
</g>
<!-- Expert52_s1_l14_tp5&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2101" class="edge">
<title>Expert52_s1_l14_tp5&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M858.79,-2645.2C861.69,-2644.92 864.57,-2644.66 867.42,-2644.41 1327.03,-2605.23 4548.69,-2580.08 5475.54,-2573.6"/>
<polygon fill="black" stroke="black" points="5475.69,-2577.1 5485.66,-2573.53 5475.64,-2570.1 5475.69,-2577.1"/>
</g>
<!-- Expert53_s1_l14_tp5&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2102" class="edge">
<title>Expert53_s1_l14_tp5&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M1184.79,-2645.21C1187.69,-2644.92 1190.57,-2644.66 1193.42,-2644.41 2035.13,-2572.2 4653.39,-2570.14 5475.1,-2571.35"/>
<polygon fill="black" stroke="black" points="5475.27,-2574.85 5485.28,-2571.37 5475.28,-2567.85 5475.27,-2574.85"/>
</g>
<!-- Expert54_s1_l14_tp5&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2103" class="edge">
<title>Expert54_s1_l14_tp5&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M1510.79,-2645.21C1513.69,-2644.93 1516.57,-2644.66 1519.42,-2644.41 2294.47,-2577.43 4692.74,-2571.74 5474.94,-2571.72"/>
<polygon fill="black" stroke="black" points="5475.2,-2575.22 5485.2,-2571.72 5475.2,-2568.22 5475.2,-2575.22"/>
</g>
<!-- Expert55_s1_l14_tp5&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2104" class="edge">
<title>Expert55_s1_l14_tp5&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M1836.79,-2645.22C1839.69,-2644.93 1842.57,-2644.66 1845.42,-2644.41 2554.13,-2582.65 4734.28,-2573.47 5475.08,-2572.14"/>
<polygon fill="black" stroke="black" points="5475.35,-2575.64 5485.34,-2572.13 5475.34,-2568.64 5475.35,-2575.64"/>
</g>
<!-- Expert56_s1_l14_tp6&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2105" class="edge">
<title>Expert56_s1_l14_tp6&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M9678.05,-2645.21C9675.16,-2644.93 9672.28,-2644.66 9669.42,-2644.41 8947.29,-2581.59 6723.02,-2573.11 5973.75,-2572.05"/>
<polygon fill="black" stroke="black" points="5973.65,-2568.55 5963.64,-2572.04 5973.64,-2575.55 5973.65,-2568.55"/>
</g>
<!-- Expert57_s1_l14_tp6&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2106" class="edge">
<title>Expert57_s1_l14_tp6&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M10004.05,-2645.21C10001.16,-2644.93 9998.28,-2644.66 9995.42,-2644.41 9206.85,-2576.37 6763.87,-2571.41 5973.72,-2571.64"/>
<polygon fill="black" stroke="black" points="5973.64,-2568.14 5963.64,-2571.64 5973.64,-2575.14 5973.64,-2568.14"/>
</g>
<!-- Expert58_s1_l14_tp6&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2107" class="edge">
<title>Expert58_s1_l14_tp6&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M10330.05,-2645.2C10327.16,-2644.92 10324.28,-2644.66 10321.42,-2644.41 9466.21,-2571.14 6803.35,-2569.83 5973.77,-2571.28"/>
<polygon fill="black" stroke="black" points="5973.49,-2567.78 5963.49,-2571.3 5973.5,-2574.78 5973.49,-2567.78"/>
</g>
<!-- Expert59_s1_l14_tp6&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2108" class="edge">
<title>Expert59_s1_l14_tp6&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M10656.06,-2645.2C10653.16,-2644.92 10650.28,-2644.66 10647.42,-2644.41 10180.97,-2604.69 6907.76,-2579.88 5973.09,-2573.55"/>
<polygon fill="black" stroke="black" points="5972.91,-2570.05 5962.88,-2573.48 5972.86,-2577.05 5972.91,-2570.05"/>
</g>
<!-- Expert60_s1_l14_tp7&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2109" class="edge">
<title>Expert60_s1_l14_tp7&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M8374.05,-2645.25C8371.15,-2644.95 8368.27,-2644.67 8365.42,-2644.41 7905.98,-2602.34 6537.75,-2581.64 5972.74,-2574.7"/>
<polygon fill="black" stroke="black" points="5972.47,-2571.19 5962.43,-2574.57 5972.38,-2578.19 5972.47,-2571.19"/>
</g>
<!-- Expert61_s1_l14_tp7&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2110" class="edge">
<title>Expert61_s1_l14_tp7&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M8700.05,-2645.24C8697.15,-2644.95 8694.28,-2644.67 8691.42,-2644.41 8166.85,-2597.18 6587.92,-2579.16 5973.18,-2573.82"/>
<polygon fill="black" stroke="black" points="5972.88,-2570.32 5962.85,-2573.73 5972.82,-2577.32 5972.88,-2570.32"/>
</g>
<!-- Expert62_s1_l14_tp7&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2111" class="edge">
<title>Expert62_s1_l14_tp7&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M9026.05,-2645.23C9023.15,-2644.94 9020.28,-2644.67 9017.42,-2644.41 8427.28,-2591.99 6635.01,-2576.95 5973.33,-2573.12"/>
<polygon fill="black" stroke="black" points="5973.21,-2569.62 5963.19,-2573.06 5973.17,-2576.62 5973.21,-2569.62"/>
</g>
<!-- Expert63_s1_l14_tp7&#45;&gt;AR_exp_s1_l14 -->
<g id="edge2112" class="edge">
<title>Expert63_s1_l14_tp7&#45;&gt;AR_exp_s1_l14</title>
<path fill="none" stroke="black" d="M9352.05,-2645.22C9349.15,-2644.93 9346.28,-2644.66 9343.42,-2644.41 8687.39,-2586.79 6679.77,-2574.94 5973.43,-2572.54"/>
<polygon fill="black" stroke="black" points="5973.39,-2569.04 5963.38,-2572.5 5973.37,-2576.04 5973.39,-2569.04"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp0 -->
<g id="edge2113" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp0</title>
<path fill="none" stroke="black" d="M5670.26,-2534.27C5655.49,-2524.54 5639.11,-2513.75 5622.99,-2503.13"/>
<polygon fill="black" stroke="black" points="5624.87,-2500.18 5614.59,-2497.6 5621.02,-2506.03 5624.87,-2500.18"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp1 -->
<g id="edge2115" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp1</title>
<path fill="none" stroke="black" d="M5495.41,-2560.04C5177.44,-2546.25 4584.2,-2520.37 4078.42,-2497.46 3805.53,-2485.1 3495.16,-2470.62 3270.96,-2460.08"/>
<polygon fill="black" stroke="black" points="3270.84,-2456.57 3260.69,-2459.6 3270.51,-2463.56 3270.84,-2456.57"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp2 -->
<g id="edge2117" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp2</title>
<path fill="none" stroke="black" d="M5523.68,-2550.52C5322.33,-2531.05 5008.71,-2500.71 4770.11,-2477.64"/>
<polygon fill="black" stroke="black" points="4770.17,-2474.13 4759.88,-2476.65 4769.49,-2481.09 4770.17,-2474.13"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp3 -->
<g id="edge2119" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp3</title>
<path fill="none" stroke="black" d="M5874.19,-2541.69C5956.57,-2526.15 6060.57,-2506.54 6153.15,-2489.08"/>
<polygon fill="black" stroke="black" points="6154.04,-2492.47 6163.22,-2487.18 6152.75,-2485.59 6154.04,-2492.47"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp4 -->
<g id="edge2121" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp4</title>
<path fill="none" stroke="black" d="M5952.04,-2559.43C6446.78,-2536.6 7618.28,-2482.53 8150.24,-2457.98"/>
<polygon fill="black" stroke="black" points="8150.53,-2461.47 8160.36,-2457.51 8150.21,-2454.47 8150.53,-2461.47"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp5 -->
<g id="edge2123" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp5</title>
<path fill="none" stroke="black" d="M5488.45,-2564.82C4967.61,-2553.46 3680.29,-2524.93 2602.42,-2497.46 2047.65,-2483.32 1400.54,-2464.95 1030.21,-2454.25"/>
<polygon fill="black" stroke="black" points="1030.25,-2450.75 1020.15,-2453.96 1030.05,-2457.75 1030.25,-2450.75"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp6 -->
<g id="edge2125" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp6</title>
<path fill="none" stroke="black" d="M5962.78,-2567.9C6760.16,-2560.79 9330.69,-2535.43 10158.42,-2497.46 10301.34,-2490.9 10460.64,-2479.17 10590.04,-2468.51"/>
<polygon fill="black" stroke="black" points="10590.41,-2471.99 10600.09,-2467.67 10589.84,-2465.01 10590.41,-2471.99"/>
</g>
<!-- AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp7 -->
<g id="edge2127" class="edge">
<title>AR_exp_s1_l14&#45;&gt;ResMOE_s1_l14_tp7</title>
<path fill="none" stroke="black" d="M5961.75,-2566.51C6475.71,-2558.61 7730.03,-2536.71 8780.42,-2497.46 9035.68,-2487.92 9326.69,-2472.63 9532.19,-2461.09"/>
<polygon fill="black" stroke="black" points="9532.43,-2464.59 9542.21,-2460.53 9532.03,-2457.6 9532.43,-2464.59"/>
</g>
<!-- QKV_s1_l15_tp0 -->
<g id="node1276" class="node">
<title>QKV_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4745.42,-2355.46 4407.42,-2355.46 4407.42,-2302.46 4745.42,-2302.46 4745.42,-2355.46"/>
<text text-anchor="middle" x="4576.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4576.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4576.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp0 -->
<g id="edge2129" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5202.03,-2404C5052.11,-2386.26 4881.11,-2366.02 4755.83,-2351.19"/>
<polygon fill="black" stroke="black" points="4756.09,-2347.7 4745.75,-2350 4755.27,-2354.65 4756.09,-2347.7"/>
</g>
<!-- QKV_s1_l15_tp1 -->
<g id="node1277" class="node">
<title>QKV_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="5143.42,-2355.46 4805.42,-2355.46 4805.42,-2302.46 5143.42,-2302.46 5143.42,-2355.46"/>
<text text-anchor="middle" x="4974.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4974.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4974.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp1 -->
<g id="edge2130" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M5278.32,-2391.44C5220.48,-2379.74 5161.31,-2367.77 5110.73,-2357.54"/>
<polygon fill="black" stroke="black" points="5111.23,-2354.07 5100.73,-2355.51 5109.84,-2360.93 5111.23,-2354.07"/>
</g>
<!-- QKV_s1_l15_tp2 -->
<g id="node1278" class="node">
<title>QKV_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="5517.42,-2355.46 5179.42,-2355.46 5179.42,-2302.46 5517.42,-2302.46 5517.42,-2355.46"/>
<text text-anchor="middle" x="5348.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5348.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5348.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp2 -->
<g id="edge2131" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5449.58,-2391.36C5432.41,-2380.94 5414.89,-2370.3 5399.35,-2360.87"/>
<polygon fill="black" stroke="black" points="5400.82,-2357.67 5390.46,-2355.47 5397.19,-2363.65 5400.82,-2357.67"/>
</g>
<!-- QKV_s1_l15_tp3 -->
<g id="node1279" class="node">
<title>QKV_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="5890.42,-2355.46 5552.42,-2355.46 5552.42,-2302.46 5890.42,-2302.46 5890.42,-2355.46"/>
<text text-anchor="middle" x="5721.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5721.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5721.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp3 -->
<g id="edge2132" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5620.8,-2391.36C5637.89,-2380.94 5655.31,-2370.3 5670.76,-2360.87"/>
<polygon fill="black" stroke="black" points="5672.9,-2363.67 5679.61,-2355.47 5669.25,-2357.69 5672.9,-2363.67"/>
</g>
<!-- QKV_s1_l15_tp4 -->
<g id="node1280" class="node">
<title>QKV_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="6263.42,-2355.46 5925.42,-2355.46 5925.42,-2302.46 6263.42,-2302.46 6263.42,-2355.46"/>
<text text-anchor="middle" x="6094.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6094.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6094.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp4 -->
<g id="edge2133" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M5753.15,-2399.25C5822.26,-2385.22 5896.68,-2370.11 5958.33,-2357.59"/>
<polygon fill="black" stroke="black" points="5959.4,-2360.95 5968.5,-2355.53 5958.01,-2354.09 5959.4,-2360.95"/>
</g>
<!-- QKV_s1_l15_tp5 -->
<g id="node1281" class="node">
<title>QKV_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="6653.42,-2355.46 6315.42,-2355.46 6315.42,-2302.46 6653.42,-2302.46 6653.42,-2355.46"/>
<text text-anchor="middle" x="6484.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6484.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6484.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp5 -->
<g id="edge2134" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M5774.41,-2414.98C5918.64,-2397.77 6106.09,-2375.39 6272.42,-2355.46 6283.06,-2354.19 6294,-2352.87 6305.03,-2351.55"/>
<polygon fill="black" stroke="black" points="6305.68,-2355 6315.19,-2350.33 6304.84,-2348.05 6305.68,-2355"/>
</g>
<!-- QKV_s1_l15_tp6 -->
<g id="node1282" class="node">
<title>QKV_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="7038.42,-2355.46 6700.42,-2355.46 6700.42,-2302.46 7038.42,-2302.46 7038.42,-2355.46"/>
<text text-anchor="middle" x="6869.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6869.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6869.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp6 -->
<g id="edge2135" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M5775.39,-2415.61C5854.9,-2407.02 5943.89,-2398.09 6025.42,-2391.46 6308.05,-2368.49 6379.99,-2380.81 6662.42,-2355.46 6671.49,-2354.65 6680.78,-2353.75 6690.15,-2352.78"/>
<polygon fill="black" stroke="black" points="6690.77,-2356.24 6700.35,-2351.72 6690.04,-2349.28 6690.77,-2356.24"/>
</g>
<!-- QKV_s1_l15_tp7 -->
<g id="node1283" class="node">
<title>QKV_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="4363.42,-2355.46 4025.42,-2355.46 4025.42,-2302.46 4363.42,-2302.46 4363.42,-2355.46"/>
<text text-anchor="middle" x="4194.42" y="-2340.26" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4194.42" y="-2325.26" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4194.42" y="-2310.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp7 -->
<g id="edge2136" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;QKV_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M5228.34,-2423.63C4999.34,-2407.88 4679,-2383.84 4398.42,-2355.46 4390.34,-2354.64 4382.09,-2353.77 4373.76,-2352.86"/>
<polygon fill="black" stroke="black" points="4373.88,-2349.35 4363.56,-2351.72 4373.11,-2356.31 4373.88,-2349.35"/>
</g>
<!-- ResAttn_s1_l15_tp0 -->
<g id="node1310" class="node">
<title>ResAttn_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4785.77,-1777.55 4228.45,-1777.55 4085.08,-1671.55 4642.4,-1671.55 4785.77,-1777.55"/>
<text text-anchor="middle" x="4435.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4435.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4435.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp0 -->
<g id="edge2178" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5223.15,-2419.81C5091.48,-2410.27 4936.54,-2399.62 4796.42,-2391.46 4709.81,-2386.41 4089.76,-2401.82 4016.42,-2355.46 3967.68,-2324.65 3955.42,-2298.62 3955.42,-2240.96 3955.42,-2240.96 3955.42,-2240.96 3955.42,-1939.03 3955.42,-1828.48 4063.04,-1774.75 4176.36,-1748.83"/>
<polygon fill="black" stroke="black" points="4177.28,-1752.21 4186.28,-1746.64 4175.76,-1745.38 4177.28,-1752.21"/>
</g>
<!-- ResAttn_s1_l15_tp1 -->
<g id="node1311" class="node">
<title>ResAttn_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="3063.77,-1777.55 2506.45,-1777.55 2363.08,-1671.55 2920.4,-1671.55 3063.77,-1777.55"/>
<text text-anchor="middle" x="2713.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2713.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2713.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp1 -->
<g id="edge2180" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M5221.4,-2418.52C5090.13,-2408.83 4935.96,-2398.42 4796.42,-2391.46 4251.97,-2364.32 4112.69,-2411.18 3570.42,-2355.46 3425.39,-2340.56 2924.42,-2386.75 2924.42,-2240.96 2924.42,-2240.96 2924.42,-2240.96 2924.42,-1939.03 2924.42,-1873 2872.72,-1820.03 2820.5,-1783.37"/>
<polygon fill="black" stroke="black" points="2822.35,-1780.4 2812.13,-1777.63 2818.4,-1786.17 2822.35,-1780.4"/>
</g>
<!-- ResAttn_s1_l15_tp2 -->
<g id="node1312" class="node">
<title>ResAttn_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="3911.77,-1777.55 3354.45,-1777.55 3211.08,-1671.55 3768.4,-1671.55 3911.77,-1777.55"/>
<text text-anchor="middle" x="3561.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3561.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3561.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp2 -->
<g id="edge2182" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5222.71,-2419.57C5091.14,-2410.01 4936.39,-2399.4 4796.42,-2391.46 4426.01,-2370.44 4328.66,-2414.8 3962.42,-2355.46 3779.46,-2325.81 3561.42,-2426.31 3561.42,-2240.96 3561.42,-2240.96 3561.42,-2240.96 3561.42,-1939.03 3561.42,-1888.19 3561.42,-1830.53 3561.42,-1787.96"/>
<polygon fill="black" stroke="black" points="3564.92,-1787.75 3561.42,-1777.75 3557.92,-1787.75 3564.92,-1787.75"/>
</g>
<!-- ResAttn_s1_l15_tp3 -->
<g id="node1313" class="node">
<title>ResAttn_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6992.77,-1777.55 6435.45,-1777.55 6292.08,-1671.55 6849.4,-1671.55 6992.77,-1777.55"/>
<text text-anchor="middle" x="6642.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6642.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6642.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp3 -->
<g id="edge2184" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5774.07,-2414.72C5853.88,-2406.02 5943.39,-2397.25 6025.42,-2391.46 6082.09,-2387.46 6998.74,-2384.75 7047.42,-2355.46 7097.76,-2325.18 7113.42,-2299.7 7113.42,-2240.96 7113.42,-2240.96 7113.42,-2240.96 7113.42,-1939.03 7113.42,-1862.56 7061.28,-1813.35 6991.7,-1781.71"/>
<polygon fill="black" stroke="black" points="6992.79,-1778.37 6982.22,-1777.56 6989.98,-1784.78 6992.79,-1778.37"/>
</g>
<!-- ResAttn_s1_l15_tp4 -->
<g id="node1314" class="node">
<title>ResAttn_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="7857.77,-1777.55 7300.45,-1777.55 7157.08,-1671.55 7714.4,-1671.55 7857.77,-1777.55"/>
<text text-anchor="middle" x="7507.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7507.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7507.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp4 -->
<g id="edge2186" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M5774.07,-2414.66C5853.88,-2405.95 5943.39,-2397.19 6025.42,-2391.46 6190.53,-2379.92 7507.42,-2406.47 7507.42,-2240.96 7507.42,-2240.96 7507.42,-2240.96 7507.42,-1939.03 7507.42,-1888.19 7507.42,-1830.53 7507.42,-1787.96"/>
<polygon fill="black" stroke="black" points="7510.92,-1787.75 7507.42,-1777.75 7503.92,-1787.75 7510.92,-1787.75"/>
</g>
<!-- ResAttn_s1_l15_tp5 -->
<g id="node1315" class="node">
<title>ResAttn_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="1922.77,-1777.55 1365.45,-1777.55 1222.08,-1671.55 1779.4,-1671.55 1922.77,-1777.55"/>
<text text-anchor="middle" x="1572.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1572.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1572.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp5 -->
<g id="edge2188" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M5220.52,-2417.78C5089.46,-2408 4935.67,-2397.72 4796.42,-2391.46 4389.64,-2373.16 3369.28,-2398.99 2964.42,-2355.46 2702.74,-2327.32 2383.42,-2504.15 2383.42,-2240.96 2383.42,-2240.96 2383.42,-2240.96 2383.42,-1939.03 2383.42,-1833.23 2122.02,-1778.75 1896.03,-1751.43"/>
<polygon fill="black" stroke="black" points="1896.32,-1747.94 1885.98,-1750.23 1895.49,-1754.89 1896.32,-1747.94"/>
</g>
<!-- ResAttn_s1_l15_tp6 -->
<g id="node1316" class="node">
<title>ResAttn_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10000.77,-1777.55 9443.45,-1777.55 9300.08,-1671.55 9857.4,-1671.55 10000.77,-1777.55"/>
<text text-anchor="middle" x="9650.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9650.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9650.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp6 -->
<g id="edge2190" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M5773.4,-2414.12C5853.37,-2405.36 5943.14,-2396.69 6025.42,-2391.46 6173.14,-2382.07 8685.42,-2388.97 8685.42,-2240.96 8685.42,-2240.96 8685.42,-2240.96 8685.42,-1939.03 8685.42,-1797.22 9087.71,-1749.54 9372.81,-1733.55"/>
<polygon fill="black" stroke="black" points="9373.11,-1737.04 9382.9,-1733 9372.72,-1730.05 9373.11,-1737.04"/>
</g>
<!-- ResAttn_s1_l15_tp7 -->
<g id="node1317" class="node">
<title>ResAttn_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="8851.77,-1777.55 8294.45,-1777.55 8151.08,-1671.55 8708.4,-1671.55 8851.77,-1777.55"/>
<text text-anchor="middle" x="8501.42" y="-1735.85" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8501.42" y="-1720.85" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8501.42" y="-1705.85" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp7 -->
<g id="edge2192" class="edge">
<title>ResMOE_s1_l14_tp0&#45;&gt;ResAttn_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M5773.74,-2414.43C5853.62,-2405.69 5943.27,-2396.98 6025.42,-2391.46 6588.83,-2353.64 6732.61,-2401.26 7295.42,-2355.46 7485.17,-2340.02 8144.42,-2431.33 8144.42,-2240.96 8144.42,-2240.96 8144.42,-2240.96 8144.42,-1939.03 8144.42,-1861.12 8207.83,-1810.96 8281.19,-1779"/>
<polygon fill="black" stroke="black" points="8282.81,-1782.12 8290.66,-1775 8280.08,-1775.67 8282.81,-1782.12"/>
</g>
<!-- SplitHeads_s1_l15_tp0 -->
<g id="node1284" class="node">
<title>SplitHeads_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4745.42,-2266.46 4373.42,-2266.46 4373.42,-2213.46 4745.42,-2213.46 4745.42,-2266.46"/>
<text text-anchor="middle" x="4559.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4559.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4559.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp0&#45;&gt;SplitHeads_s1_l15_tp0 -->
<g id="edge2137" class="edge">
<title>QKV_s1_l15_tp0&#45;&gt;SplitHeads_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M4571.41,-2302.33C4569.84,-2294.26 4568.07,-2285.2 4566.38,-2276.56"/>
<polygon fill="black" stroke="black" points="4569.81,-2275.85 4564.45,-2266.71 4562.94,-2277.2 4569.81,-2275.85"/>
</g>
<!-- SplitHeads_s1_l15_tp1 -->
<g id="node1285" class="node">
<title>SplitHeads_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="5135.42,-2266.46 4763.42,-2266.46 4763.42,-2213.46 5135.42,-2213.46 5135.42,-2266.46"/>
<text text-anchor="middle" x="4949.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4949.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4949.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp1&#45;&gt;SplitHeads_s1_l15_tp1 -->
<g id="edge2138" class="edge">
<title>QKV_s1_l15_tp1&#45;&gt;SplitHeads_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M4967.06,-2302.33C4964.74,-2294.26 4962.13,-2285.2 4959.65,-2276.56"/>
<polygon fill="black" stroke="black" points="4962.95,-2275.35 4956.82,-2266.71 4956.22,-2277.29 4962.95,-2275.35"/>
</g>
<!-- SplitHeads_s1_l15_tp2 -->
<g id="node1286" class="node">
<title>SplitHeads_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="5525.42,-2266.46 5153.42,-2266.46 5153.42,-2213.46 5525.42,-2213.46 5525.42,-2266.46"/>
<text text-anchor="middle" x="5339.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5339.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5339.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp2&#45;&gt;SplitHeads_s1_l15_tp2 -->
<g id="edge2139" class="edge">
<title>QKV_s1_l15_tp2&#45;&gt;SplitHeads_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5345.77,-2302.33C5344.95,-2294.35 5344.02,-2285.39 5343.13,-2276.84"/>
<polygon fill="black" stroke="black" points="5346.6,-2276.3 5342.09,-2266.71 5339.63,-2277.02 5346.6,-2276.3"/>
</g>
<!-- SplitHeads_s1_l15_tp3 -->
<g id="node1287" class="node">
<title>SplitHeads_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="5915.42,-2266.46 5543.42,-2266.46 5543.42,-2213.46 5915.42,-2213.46 5915.42,-2266.46"/>
<text text-anchor="middle" x="5729.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5729.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5729.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp3&#45;&gt;SplitHeads_s1_l15_tp3 -->
<g id="edge2140" class="edge">
<title>QKV_s1_l15_tp3&#45;&gt;SplitHeads_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5723.78,-2302.33C5724.51,-2294.35 5725.34,-2285.39 5726.12,-2276.84"/>
<polygon fill="black" stroke="black" points="5729.62,-2276.99 5727.05,-2266.71 5722.65,-2276.35 5729.62,-2276.99"/>
</g>
<!-- SplitHeads_s1_l15_tp4 -->
<g id="node1288" class="node">
<title>SplitHeads_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="6305.42,-2266.46 5933.42,-2266.46 5933.42,-2213.46 6305.42,-2213.46 6305.42,-2266.46"/>
<text text-anchor="middle" x="6119.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6119.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6119.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp4&#45;&gt;SplitHeads_s1_l15_tp4 -->
<g id="edge2141" class="edge">
<title>QKV_s1_l15_tp4&#45;&gt;SplitHeads_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M6101.79,-2302.33C6104.11,-2294.26 6106.71,-2285.2 6109.19,-2276.56"/>
<polygon fill="black" stroke="black" points="6112.63,-2277.29 6112.02,-2266.71 6105.9,-2275.35 6112.63,-2277.29"/>
</g>
<!-- SplitHeads_s1_l15_tp5 -->
<g id="node1289" class="node">
<title>SplitHeads_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="6695.42,-2266.46 6323.42,-2266.46 6323.42,-2213.46 6695.42,-2213.46 6695.42,-2266.46"/>
<text text-anchor="middle" x="6509.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6509.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6509.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp5&#45;&gt;SplitHeads_s1_l15_tp5 -->
<g id="edge2142" class="edge">
<title>QKV_s1_l15_tp5&#45;&gt;SplitHeads_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M6491.79,-2302.33C6494.11,-2294.26 6496.71,-2285.2 6499.19,-2276.56"/>
<polygon fill="black" stroke="black" points="6502.63,-2277.29 6502.02,-2266.71 6495.9,-2275.35 6502.63,-2277.29"/>
</g>
<!-- SplitHeads_s1_l15_tp6 -->
<g id="node1290" class="node">
<title>SplitHeads_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="7085.42,-2266.46 6713.42,-2266.46 6713.42,-2213.46 7085.42,-2213.46 7085.42,-2266.46"/>
<text text-anchor="middle" x="6899.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6899.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6899.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp6&#45;&gt;SplitHeads_s1_l15_tp6 -->
<g id="edge2143" class="edge">
<title>QKV_s1_l15_tp6&#45;&gt;SplitHeads_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M6878.26,-2302.33C6881.07,-2294.17 6884.24,-2285 6887.24,-2276.28"/>
<polygon fill="black" stroke="black" points="6890.59,-2277.3 6890.54,-2266.71 6883.97,-2275.02 6890.59,-2277.3"/>
</g>
<!-- SplitHeads_s1_l15_tp7 -->
<g id="node1291" class="node">
<title>SplitHeads_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="4355.42,-2266.46 3983.42,-2266.46 3983.42,-2213.46 4355.42,-2213.46 4355.42,-2266.46"/>
<text text-anchor="middle" x="4169.42" y="-2251.26" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4169.42" y="-2236.26" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4169.42" y="-2221.26" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l15_tp7&#45;&gt;SplitHeads_s1_l15_tp7 -->
<g id="edge2144" class="edge">
<title>QKV_s1_l15_tp7&#45;&gt;SplitHeads_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M4187.06,-2302.33C4184.74,-2294.26 4182.13,-2285.2 4179.65,-2276.56"/>
<polygon fill="black" stroke="black" points="4182.95,-2275.35 4176.82,-2266.71 4176.22,-2277.29 4182.95,-2275.35"/>
</g>
<!-- A2A_s1_l15 -->
<g id="node1292" class="node">
<title>A2A_s1_l15</title>
<ellipse fill="none" stroke="black" cx="5534.42" cy="-2139.98" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5534.42" y="-2151.28" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="5534.42" y="-2136.28" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5534.42" y="-2121.28" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l15_tp0&#45;&gt;A2A_s1_l15 -->
<g id="edge2145" class="edge">
<title>SplitHeads_s1_l15_tp0&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M4745.45,-2214.48C4748.46,-2214.13 4751.45,-2213.79 4754.42,-2213.46 4937.43,-2193 5145.05,-2173.91 5300.05,-2160.46"/>
<polygon fill="black" stroke="black" points="5300.53,-2163.93 5310.19,-2159.58 5299.92,-2156.96 5300.53,-2163.93"/>
</g>
<!-- SplitHeads_s1_l15_tp1&#45;&gt;A2A_s1_l15 -->
<g id="edge2146" class="edge">
<title>SplitHeads_s1_l15_tp1&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M5101.98,-2213.41C5180.22,-2200.31 5275.93,-2184.28 5357.41,-2170.63"/>
<polygon fill="black" stroke="black" points="5357.99,-2174.08 5367.27,-2168.98 5356.83,-2167.18 5357.99,-2174.08"/>
</g>
<!-- SplitHeads_s1_l15_tp2&#45;&gt;A2A_s1_l15 -->
<g id="edge2147" class="edge">
<title>SplitHeads_s1_l15_tp2&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M5390.4,-2213.35C5410.24,-2203.38 5433.43,-2191.73 5455.33,-2180.72"/>
<polygon fill="black" stroke="black" points="5456.94,-2183.83 5464.3,-2176.21 5453.8,-2177.58 5456.94,-2183.83"/>
</g>
<!-- SplitHeads_s1_l15_tp3&#45;&gt;A2A_s1_l15 -->
<g id="edge2148" class="edge">
<title>SplitHeads_s1_l15_tp3&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M5678.44,-2213.35C5658.61,-2203.38 5635.42,-2191.73 5613.51,-2180.72"/>
<polygon fill="black" stroke="black" points="5615.05,-2177.58 5604.54,-2176.21 5611.91,-2183.83 5615.05,-2177.58"/>
</g>
<!-- SplitHeads_s1_l15_tp4&#45;&gt;A2A_s1_l15 -->
<g id="edge2149" class="edge">
<title>SplitHeads_s1_l15_tp4&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M5966.87,-2213.41C5888.63,-2200.31 5792.91,-2184.28 5711.44,-2170.63"/>
<polygon fill="black" stroke="black" points="5712.02,-2167.18 5701.58,-2168.98 5710.86,-2174.08 5712.02,-2167.18"/>
</g>
<!-- SplitHeads_s1_l15_tp5&#45;&gt;A2A_s1_l15 -->
<g id="edge2150" class="edge">
<title>SplitHeads_s1_l15_tp5&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M6323.4,-2214.48C6320.39,-2214.13 6317.39,-2213.79 6314.42,-2213.46 6131.42,-2193 5923.79,-2173.91 5768.79,-2160.46"/>
<polygon fill="black" stroke="black" points="5768.92,-2156.96 5758.66,-2159.58 5768.32,-2163.93 5768.92,-2156.96"/>
</g>
<!-- SplitHeads_s1_l15_tp6&#45;&gt;A2A_s1_l15 -->
<g id="edge2151" class="edge">
<title>SplitHeads_s1_l15_tp6&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M6713.41,-2214.35C6710.39,-2214.04 6707.4,-2213.75 6704.42,-2213.46 6392.38,-2183.43 6032.25,-2163.3 5794.88,-2152.02"/>
<polygon fill="black" stroke="black" points="5794.88,-2148.52 5784.73,-2151.54 5794.55,-2155.51 5794.88,-2148.52"/>
</g>
<!-- SplitHeads_s1_l15_tp7&#45;&gt;A2A_s1_l15 -->
<g id="edge2152" class="edge">
<title>SplitHeads_s1_l15_tp7&#45;&gt;A2A_s1_l15</title>
<path fill="none" stroke="black" d="M4355.43,-2214.35C4358.45,-2214.04 4361.45,-2213.75 4364.42,-2213.46 4676.47,-2183.43 5036.6,-2163.3 5273.96,-2152.02"/>
<polygon fill="black" stroke="black" points="5274.29,-2155.51 5284.12,-2151.54 5273.96,-2148.52 5274.29,-2155.51"/>
</g>
<!-- Attn_s1_l15_tp0 -->
<g id="node1293" class="node">
<title>Attn_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4745.42,-2066.51 4373.42,-2066.51 4373.42,-2013.51 4745.42,-2013.51 4745.42,-2066.51"/>
<text text-anchor="middle" x="4559.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4559.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4559.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp0 -->
<g id="edge2153" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5310.19,-2120.38C5156.85,-2107.13 4948.7,-2088.08 4755.51,-2066.61"/>
<polygon fill="black" stroke="black" points="4755.77,-2063.12 4745.45,-2065.49 4755,-2070.08 4755.77,-2063.12"/>
</g>
<!-- Attn_s1_l15_tp1 -->
<g id="node1294" class="node">
<title>Attn_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="5135.42,-2066.51 4763.42,-2066.51 4763.42,-2013.51 5135.42,-2013.51 5135.42,-2066.51"/>
<text text-anchor="middle" x="4949.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4949.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4949.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp1 -->
<g id="edge2154" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M5367.18,-2110.97C5287.03,-2097.55 5191.42,-2081.54 5111.9,-2068.22"/>
<polygon fill="black" stroke="black" points="5112.23,-2064.72 5101.79,-2066.52 5111.07,-2071.63 5112.23,-2064.72"/>
</g>
<!-- Attn_s1_l15_tp2 -->
<g id="node1295" class="node">
<title>Attn_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="5525.42,-2066.51 5153.42,-2066.51 5153.42,-2013.51 5525.42,-2013.51 5525.42,-2066.51"/>
<text text-anchor="middle" x="5339.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5339.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5339.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp2 -->
<g id="edge2155" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5464.3,-2103.75C5442.99,-2093.05 5419.79,-2081.39 5399.23,-2071.06"/>
<polygon fill="black" stroke="black" points="5400.8,-2067.93 5390.29,-2066.57 5397.65,-2074.18 5400.8,-2067.93"/>
</g>
<!-- Attn_s1_l15_tp3 -->
<g id="node1296" class="node">
<title>Attn_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="5915.42,-2066.51 5543.42,-2066.51 5543.42,-2013.51 5915.42,-2013.51 5915.42,-2066.51"/>
<text text-anchor="middle" x="5729.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5729.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5729.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp3 -->
<g id="edge2156" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5604.55,-2103.75C5625.85,-2093.05 5649.06,-2081.39 5669.62,-2071.06"/>
<polygon fill="black" stroke="black" points="5671.19,-2074.18 5678.55,-2066.57 5668.05,-2067.93 5671.19,-2074.18"/>
</g>
<!-- Attn_s1_l15_tp4 -->
<g id="node1297" class="node">
<title>Attn_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="6305.42,-2066.51 5933.42,-2066.51 5933.42,-2013.51 6305.42,-2013.51 6305.42,-2066.51"/>
<text text-anchor="middle" x="6119.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6119.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6119.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp4 -->
<g id="edge2157" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M5701.67,-2110.97C5781.81,-2097.55 5877.43,-2081.54 5956.95,-2068.22"/>
<polygon fill="black" stroke="black" points="5957.77,-2071.63 5967.06,-2066.52 5956.62,-2064.72 5957.77,-2071.63"/>
</g>
<!-- Attn_s1_l15_tp5 -->
<g id="node1298" class="node">
<title>Attn_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="6695.42,-2066.51 6323.42,-2066.51 6323.42,-2013.51 6695.42,-2013.51 6695.42,-2066.51"/>
<text text-anchor="middle" x="6509.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6509.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6509.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp5 -->
<g id="edge2158" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M5758.66,-2120.38C5912,-2107.13 6120.14,-2088.08 6313.34,-2066.61"/>
<polygon fill="black" stroke="black" points="6313.85,-2070.08 6323.4,-2065.49 6313.07,-2063.12 6313.85,-2070.08"/>
</g>
<!-- Attn_s1_l15_tp6 -->
<g id="node1299" class="node">
<title>Attn_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="7085.42,-2066.51 6713.42,-2066.51 6713.42,-2013.51 7085.42,-2013.51 7085.42,-2066.51"/>
<text text-anchor="middle" x="6899.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6899.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6899.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp6 -->
<g id="edge2159" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M5784.73,-2128.42C6019.46,-2117.36 6380.4,-2097.39 6703.39,-2066.58"/>
<polygon fill="black" stroke="black" points="6703.79,-2070.06 6713.41,-2065.62 6703.12,-2063.09 6703.79,-2070.06"/>
</g>
<!-- Attn_s1_l15_tp7 -->
<g id="node1300" class="node">
<title>Attn_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="4355.42,-2066.51 3983.42,-2066.51 3983.42,-2013.51 4355.42,-2013.51 4355.42,-2066.51"/>
<text text-anchor="middle" x="4169.42" y="-2051.31" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4169.42" y="-2036.31" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4169.42" y="-2021.31" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l15&#45;&gt;Attn_s1_l15_tp7 -->
<g id="edge2160" class="edge">
<title>A2A_s1_l15&#45;&gt;Attn_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M5284.12,-2128.42C5049.38,-2117.36 4688.44,-2097.39 4365.46,-2066.58"/>
<polygon fill="black" stroke="black" points="4365.72,-2063.09 4355.43,-2065.62 4365.05,-2070.06 4365.72,-2063.09"/>
</g>
<!-- AR_attn_s1_l15 -->
<g id="node1301" class="node">
<title>AR_attn_s1_l15</title>
<ellipse fill="none" stroke="black" cx="5534.42" cy="-1940.03" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5534.42" y="-1951.33" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="5534.42" y="-1936.33" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5534.42" y="-1921.33" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l15_tp0&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2161" class="edge">
<title>Attn_s1_l15_tp0&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M4745.45,-2014.52C4748.46,-2014.18 4751.45,-2013.84 4754.42,-2013.51 4937.43,-1993.05 5145.05,-1973.95 5300.05,-1960.51"/>
<polygon fill="black" stroke="black" points="5300.53,-1963.98 5310.19,-1959.63 5299.92,-1957 5300.53,-1963.98"/>
</g>
<!-- Attn_s1_l15_tp1&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2162" class="edge">
<title>Attn_s1_l15_tp1&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M5101.98,-2013.46C5180.22,-2000.35 5275.93,-1984.32 5357.41,-1970.68"/>
<polygon fill="black" stroke="black" points="5357.99,-1974.13 5367.27,-1969.03 5356.83,-1967.23 5357.99,-1974.13"/>
</g>
<!-- Attn_s1_l15_tp2&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2163" class="edge">
<title>Attn_s1_l15_tp2&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M5390.4,-2013.39C5410.24,-2003.43 5433.43,-1991.77 5455.33,-1980.77"/>
<polygon fill="black" stroke="black" points="5456.94,-1983.88 5464.3,-1976.26 5453.8,-1977.62 5456.94,-1983.88"/>
</g>
<!-- Attn_s1_l15_tp3&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2164" class="edge">
<title>Attn_s1_l15_tp3&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M5678.44,-2013.39C5658.61,-2003.43 5635.42,-1991.77 5613.51,-1980.77"/>
<polygon fill="black" stroke="black" points="5615.05,-1977.62 5604.54,-1976.26 5611.91,-1983.88 5615.05,-1977.62"/>
</g>
<!-- Attn_s1_l15_tp4&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2165" class="edge">
<title>Attn_s1_l15_tp4&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M5966.87,-2013.46C5888.63,-2000.35 5792.91,-1984.32 5711.44,-1970.68"/>
<polygon fill="black" stroke="black" points="5712.02,-1967.23 5701.58,-1969.03 5710.86,-1974.13 5712.02,-1967.23"/>
</g>
<!-- Attn_s1_l15_tp5&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2166" class="edge">
<title>Attn_s1_l15_tp5&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M6323.4,-2014.52C6320.39,-2014.18 6317.39,-2013.84 6314.42,-2013.51 6131.42,-1993.05 5923.79,-1973.95 5768.79,-1960.51"/>
<polygon fill="black" stroke="black" points="5768.92,-1957 5758.66,-1959.63 5768.32,-1963.98 5768.92,-1957"/>
</g>
<!-- Attn_s1_l15_tp6&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2167" class="edge">
<title>Attn_s1_l15_tp6&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M6713.41,-2014.39C6710.39,-2014.09 6707.4,-2013.79 6704.42,-2013.51 6392.38,-1983.47 6032.25,-1963.34 5794.88,-1952.07"/>
<polygon fill="black" stroke="black" points="5794.88,-1948.57 5784.73,-1951.59 5794.55,-1955.56 5794.88,-1948.57"/>
</g>
<!-- Attn_s1_l15_tp7&#45;&gt;AR_attn_s1_l15 -->
<g id="edge2168" class="edge">
<title>Attn_s1_l15_tp7&#45;&gt;AR_attn_s1_l15</title>
<path fill="none" stroke="black" d="M4355.43,-2014.39C4358.45,-2014.09 4361.45,-2013.79 4364.42,-2013.51 4676.47,-1983.47 5036.6,-1963.34 5273.96,-1952.07"/>
<polygon fill="black" stroke="black" points="5274.29,-1955.56 5284.12,-1951.59 5273.96,-1948.57 5274.29,-1955.56"/>
</g>
<!-- O_s1_l15_tp0 -->
<g id="node1302" class="node">
<title>O_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="5495.42,-1866.55 5157.42,-1866.55 5157.42,-1813.55 5495.42,-1813.55 5495.42,-1866.55"/>
<text text-anchor="middle" x="5326.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5326.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5326.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp0 -->
<g id="edge2169" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5460.21,-1904.07C5437.24,-1893.25 5412.16,-1881.44 5389.98,-1870.99"/>
<polygon fill="black" stroke="black" points="5391.2,-1867.7 5380.66,-1866.6 5388.22,-1874.03 5391.2,-1867.7"/>
</g>
<!-- O_s1_l15_tp1 -->
<g id="node1303" class="node">
<title>O_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="3927.42,-1866.55 3589.42,-1866.55 3589.42,-1813.55 3927.42,-1813.55 3927.42,-1866.55"/>
<text text-anchor="middle" x="3758.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3758.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3758.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp1 -->
<g id="edge2170" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M5291.2,-1925.61C4929.61,-1905.66 4258.57,-1868.64 3937.98,-1850.96"/>
<polygon fill="black" stroke="black" points="3937.84,-1847.45 3927.67,-1850.39 3937.46,-1854.44 3937.84,-1847.45"/>
</g>
<!-- O_s1_l15_tp2 -->
<g id="node1304" class="node">
<title>O_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="4632.42,-1866.55 4294.42,-1866.55 4294.42,-1813.55 4632.42,-1813.55 4632.42,-1866.55"/>
<text text-anchor="middle" x="4463.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4463.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4463.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp2 -->
<g id="edge2171" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5316.08,-1919.06C5117.56,-1900.89 4828.14,-1874.42 4642.81,-1857.46"/>
<polygon fill="black" stroke="black" points="4642.96,-1853.96 4632.68,-1856.54 4642.32,-1860.93 4642.96,-1853.96"/>
</g>
<!-- O_s1_l15_tp3 -->
<g id="node1305" class="node">
<title>O_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="5910.42,-1866.55 5572.42,-1866.55 5572.42,-1813.55 5910.42,-1813.55 5910.42,-1866.55"/>
<text text-anchor="middle" x="5741.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5741.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5741.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp3 -->
<g id="edge2172" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5608.57,-1903.93C5631.31,-1893.17 5656.11,-1881.44 5678.05,-1871.05"/>
<polygon fill="black" stroke="black" points="5679.73,-1874.13 5687.27,-1866.68 5676.74,-1867.8 5679.73,-1874.13"/>
</g>
<!-- O_s1_l15_tp4 -->
<g id="node1306" class="node">
<title>O_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="6475.42,-1866.55 6137.42,-1866.55 6137.42,-1813.55 6475.42,-1813.55 6475.42,-1866.55"/>
<text text-anchor="middle" x="6306.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6306.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6306.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp4 -->
<g id="edge2173" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M5727.74,-1914.5C5850.24,-1898.95 6007.57,-1878.98 6127.25,-1863.79"/>
<polygon fill="black" stroke="black" points="6127.78,-1867.25 6137.26,-1862.52 6126.89,-1860.31 6127.78,-1867.25"/>
</g>
<!-- O_s1_l15_tp5 -->
<g id="node1307" class="node">
<title>O_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="3452.42,-1866.55 3114.42,-1866.55 3114.42,-1813.55 3452.42,-1813.55 3452.42,-1866.55"/>
<text text-anchor="middle" x="3283.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3283.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3283.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp5 -->
<g id="edge2174" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M5275.44,-1933.43C4901.1,-1924.42 4187.14,-1903.83 3580.42,-1866.55 3542.37,-1864.22 3501.62,-1861.11 3462.89,-1857.88"/>
<polygon fill="black" stroke="black" points="3462.81,-1854.36 3452.55,-1857.01 3462.22,-1861.33 3462.81,-1854.36"/>
</g>
<!-- O_s1_l15_tp6 -->
<g id="node1308" class="node">
<title>O_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="8035.42,-1866.55 7697.42,-1866.55 7697.42,-1813.55 8035.42,-1813.55 8035.42,-1866.55"/>
<text text-anchor="middle" x="7866.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7866.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7866.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp6 -->
<g id="edge2175" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M5791.37,-1931.98C6165.07,-1921.16 6880.33,-1898.33 7488.42,-1866.55 7553.27,-1863.16 7624.31,-1858.6 7687.13,-1854.26"/>
<polygon fill="black" stroke="black" points="7687.4,-1857.75 7697.14,-1853.57 7686.92,-1850.77 7687.4,-1857.75"/>
</g>
<!-- O_s1_l15_tp7 -->
<g id="node1309" class="node">
<title>O_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="7479.42,-1866.55 7141.42,-1866.55 7141.42,-1813.55 7479.42,-1813.55 7479.42,-1866.55"/>
<text text-anchor="middle" x="7310.42" y="-1851.35" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7310.42" y="-1836.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="7310.42" y="-1821.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l15&#45;&gt;O_s1_l15_tp7 -->
<g id="edge2176" class="edge">
<title>AR_attn_s1_l15&#45;&gt;O_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M5777.64,-1925.61C6139.23,-1905.66 6810.28,-1868.64 7130.86,-1850.96"/>
<polygon fill="black" stroke="black" points="7131.39,-1854.44 7141.18,-1850.39 7131,-1847.45 7131.39,-1854.44"/>
</g>
<!-- O_s1_l15_tp0&#45;&gt;ResAttn_s1_l15_tp0 -->
<g id="edge2177" class="edge">
<title>O_s1_l15_tp0&#45;&gt;ResAttn_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5157.26,-1817.5C5051.87,-1804.08 4912.38,-1786.31 4784.14,-1769.97"/>
<polygon fill="black" stroke="black" points="4784.5,-1766.49 4774.14,-1768.7 4783.62,-1773.44 4784.5,-1766.49"/>
</g>
<!-- O_s1_l15_tp1&#45;&gt;ResAttn_s1_l15_tp1 -->
<g id="edge2179" class="edge">
<title>O_s1_l15_tp1&#45;&gt;ResAttn_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M3589.36,-1820.69C3444.58,-1804.97 3231.64,-1781.84 3051.97,-1762.32"/>
<polygon fill="black" stroke="black" points="3052.14,-1758.82 3041.82,-1761.22 3051.38,-1765.78 3052.14,-1758.82"/>
</g>
<!-- O_s1_l15_tp2&#45;&gt;ResAttn_s1_l15_tp2 -->
<g id="edge2181" class="edge">
<title>O_s1_l15_tp2&#45;&gt;ResAttn_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M4294.29,-1817.77C4186.03,-1804.15 4041.61,-1785.98 3909.6,-1769.37"/>
<polygon fill="black" stroke="black" points="3909.67,-1765.85 3899.31,-1768.07 3908.79,-1772.79 3909.67,-1765.85"/>
</g>
<!-- O_s1_l15_tp3&#45;&gt;ResAttn_s1_l15_tp3 -->
<g id="edge2183" class="edge">
<title>O_s1_l15_tp3&#45;&gt;ResAttn_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5910.63,-1817.74C6047.15,-1800.54 6241.13,-1776.11 6395.07,-1756.71"/>
<polygon fill="black" stroke="black" points="6395.67,-1760.17 6405.15,-1755.44 6394.79,-1753.22 6395.67,-1760.17"/>
</g>
<!-- O_s1_l15_tp4&#45;&gt;ResAttn_s1_l15_tp4 -->
<g id="edge2185" class="edge">
<title>O_s1_l15_tp4&#45;&gt;ResAttn_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M6475.72,-1824.75C6616.49,-1812.69 6822.06,-1794.7 7001.42,-1777.55 7083.72,-1769.68 7173.5,-1760.62 7254.28,-1752.28"/>
<polygon fill="black" stroke="black" points="7255.01,-1755.72 7264.59,-1751.21 7254.29,-1748.76 7255.01,-1755.72"/>
</g>
<!-- O_s1_l15_tp5&#45;&gt;ResAttn_s1_l15_tp5 -->
<g id="edge2187" class="edge">
<title>O_s1_l15_tp5&#45;&gt;ResAttn_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M3114.32,-1827.87C2928.14,-1815.56 2619.93,-1795.17 2354.42,-1777.55 2201.79,-1767.43 2032.39,-1756.16 1890.4,-1746.72"/>
<polygon fill="black" stroke="black" points="1890.43,-1743.21 1880.22,-1746.04 1889.97,-1750.2 1890.43,-1743.21"/>
</g>
<!-- O_s1_l15_tp6&#45;&gt;ResAttn_s1_l15_tp6 -->
<g id="edge2189" class="edge">
<title>O_s1_l15_tp6&#45;&gt;ResAttn_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M8035.72,-1828.78C8233.55,-1816.73 8570.76,-1796.05 8860.42,-1777.55 9035.58,-1766.37 9232.56,-1753.4 9386.01,-1743.22"/>
<polygon fill="black" stroke="black" points="9386.31,-1746.71 9396.06,-1742.55 9385.85,-1739.72 9386.31,-1746.71"/>
</g>
<!-- O_s1_l15_tp7&#45;&gt;ResAttn_s1_l15_tp7 -->
<g id="edge2191" class="edge">
<title>O_s1_l15_tp7&#45;&gt;ResAttn_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M7479.48,-1822.94C7679.29,-1803.9 8013.83,-1772.02 8245.45,-1749.95"/>
<polygon fill="black" stroke="black" points="8246.09,-1753.4 8255.71,-1748.97 8245.42,-1746.43 8246.09,-1753.4"/>
</g>
<!-- Gate_s1_l15_tp0 -->
<g id="node1318" class="node">
<title>Gate_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4896.42,-1635.55 4558.42,-1635.55 4558.42,-1582.55 4896.42,-1582.55 4896.42,-1635.55"/>
<text text-anchor="middle" x="4727.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4727.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4727.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp0&#45;&gt;Gate_s1_l15_tp0 -->
<g id="edge2193" class="edge">
<title>ResAttn_s1_l15_tp0&#45;&gt;Gate_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M4569.46,-1671.45C4597.91,-1660.4 4626.97,-1649.1 4652.28,-1639.26"/>
<polygon fill="black" stroke="black" points="4653.73,-1642.45 4661.78,-1635.57 4651.2,-1635.93 4653.73,-1642.45"/>
</g>
<!-- ResMOE_s1_l15_tp0 -->
<g id="node1359" class="node">
<title>ResMOE_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="5670.77,-1346.6 5113.45,-1346.6 4970.08,-1240.6 5527.4,-1240.6 5670.77,-1346.6"/>
<text text-anchor="middle" x="5320.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5320.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5320.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp0&#45;&gt;ResMOE_s1_l15_tp0 -->
<g id="edge2266" class="edge">
<title>ResAttn_s1_l15_tp0&#45;&gt;ResMOE_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M4104.01,-1685.73C4043.03,-1680.01 3979.86,-1674.91 3920.42,-1671.55 3264.31,-1634.51 1618.71,-1685.12 963.42,-1635.55 678.38,-1613.99 514.05,-1762.22 326.42,-1546.55 310.96,-1528.78 310.06,-1510.49 326.42,-1493.55 490.76,-1323.44 4345.22,-1358.99 4581.42,-1346.6 4740.25,-1338.27 4918.06,-1325.86 5059.46,-1315.25"/>
<polygon fill="black" stroke="black" points="5059.87,-1318.73 5069.58,-1314.49 5059.35,-1311.74 5059.87,-1318.73"/>
</g>
<!-- Gate_s1_l15_tp1 -->
<g id="node1319" class="node">
<title>Gate_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="2614.42,-1635.55 2276.42,-1635.55 2276.42,-1582.55 2614.42,-1582.55 2614.42,-1635.55"/>
<text text-anchor="middle" x="2445.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2445.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2445.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp1&#45;&gt;Gate_s1_l15_tp1 -->
<g id="edge2194" class="edge">
<title>ResAttn_s1_l15_tp1&#45;&gt;Gate_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M2590.4,-1671.45C2564.52,-1660.49 2538.09,-1649.3 2515.01,-1639.52"/>
<polygon fill="black" stroke="black" points="2516.24,-1636.24 2505.67,-1635.57 2513.51,-1642.69 2516.24,-1636.24"/>
</g>
<!-- ResMOE_s1_l15_tp1 -->
<g id="node1360" class="node">
<title>ResMOE_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="3096.77,-1346.6 2539.45,-1346.6 2396.08,-1240.6 2953.4,-1240.6 3096.77,-1346.6"/>
<text text-anchor="middle" x="2746.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2746.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2746.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp1&#45;&gt;ResMOE_s1_l15_tp1 -->
<g id="edge2268" class="edge">
<title>ResAttn_s1_l15_tp1&#45;&gt;ResMOE_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M2400.62,-1699.53C2257.65,-1689.37 2086.05,-1678.35 1931.42,-1671.55 1884.9,-1669.51 287.99,-1668.83 255.42,-1635.55 216.1,-1595.38 216.38,-1423.04 255.42,-1382.6 274.44,-1362.9 1822.01,-1319.3 2468.01,-1301.94"/>
<polygon fill="black" stroke="black" points="2468.49,-1305.43 2478.4,-1301.66 2468.31,-1298.43 2468.49,-1305.43"/>
</g>
<!-- Gate_s1_l15_tp2 -->
<g id="node1320" class="node">
<title>Gate_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="3730.42,-1635.55 3392.42,-1635.55 3392.42,-1582.55 3730.42,-1582.55 3730.42,-1635.55"/>
<text text-anchor="middle" x="3561.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3561.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3561.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp2&#45;&gt;Gate_s1_l15_tp2 -->
<g id="edge2195" class="edge">
<title>ResAttn_s1_l15_tp2&#45;&gt;Gate_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M3561.42,-1671.45C3561.42,-1662.78 3561.42,-1653.97 3561.42,-1645.82"/>
<polygon fill="black" stroke="black" points="3564.92,-1645.57 3561.42,-1635.57 3557.92,-1645.57 3564.92,-1645.57"/>
</g>
<!-- ResMOE_s1_l15_tp2 -->
<g id="node1361" class="node">
<title>ResMOE_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="4572.77,-1346.6 4015.45,-1346.6 3872.08,-1240.6 4429.4,-1240.6 4572.77,-1346.6"/>
<text text-anchor="middle" x="4222.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4222.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4222.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp2&#45;&gt;ResMOE_s1_l15_tp2 -->
<g id="edge2270" class="edge">
<title>ResAttn_s1_l15_tp2&#45;&gt;ResMOE_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M3227.7,-1683.88C3175.78,-1678.92 3122.7,-1674.55 3072.42,-1671.55 3033.89,-1669.26 320.54,-1663.02 293.42,-1635.55 253.93,-1595.55 253.93,-1422.6 293.42,-1382.6 320.86,-1354.81 3066.38,-1347.76 3105.42,-1346.6 3395.82,-1337.98 3728.4,-1321.67 3954.62,-1309.61"/>
<polygon fill="black" stroke="black" points="3954.84,-1313.1 3964.64,-1309.07 3954.47,-1306.11 3954.84,-1313.1"/>
</g>
<!-- Gate_s1_l15_tp3 -->
<g id="node1321" class="node">
<title>Gate_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6526.42,-1635.55 6188.42,-1635.55 6188.42,-1582.55 6526.42,-1582.55 6526.42,-1635.55"/>
<text text-anchor="middle" x="6357.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6357.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6357.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp3&#45;&gt;Gate_s1_l15_tp3 -->
<g id="edge2196" class="edge">
<title>ResAttn_s1_l15_tp3&#45;&gt;Gate_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M6511.6,-1671.45C6483.96,-1660.44 6455.72,-1649.2 6431.09,-1639.39"/>
<polygon fill="black" stroke="black" points="6432.07,-1636.02 6421.49,-1635.57 6429.48,-1642.52 6432.07,-1636.02"/>
</g>
<!-- ResMOE_s1_l15_tp3 -->
<g id="node1362" class="node">
<title>ResMOE_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6519.77,-1346.6 5962.45,-1346.6 5819.08,-1240.6 6376.4,-1240.6 6519.77,-1346.6"/>
<text text-anchor="middle" x="6169.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6169.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6169.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp3&#45;&gt;ResMOE_s1_l15_tp3 -->
<g id="edge2272" class="edge">
<title>ResAttn_s1_l15_tp3&#45;&gt;ResMOE_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M6880.81,-1694.58C6965.21,-1685.51 7060.92,-1676.57 7148.42,-1671.55 7808.05,-1633.74 9462.59,-1685.37 10121.42,-1635.55 10410.66,-1613.69 10959.04,-1703.05 10758.42,-1493.55 10721.26,-1454.75 7491.82,-1340.19 6473.44,-1305"/>
<polygon fill="black" stroke="black" points="6473.53,-1301.5 6463.41,-1304.66 6473.29,-1308.5 6473.53,-1301.5"/>
</g>
<!-- Gate_s1_l15_tp4 -->
<g id="node1322" class="node">
<title>Gate_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="7676.42,-1635.55 7338.42,-1635.55 7338.42,-1582.55 7676.42,-1582.55 7676.42,-1635.55"/>
<text text-anchor="middle" x="7507.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7507.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7507.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp4&#45;&gt;Gate_s1_l15_tp4 -->
<g id="edge2197" class="edge">
<title>ResAttn_s1_l15_tp4&#45;&gt;Gate_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M7507.42,-1671.45C7507.42,-1662.78 7507.42,-1653.97 7507.42,-1645.82"/>
<polygon fill="black" stroke="black" points="7510.92,-1645.57 7507.42,-1635.57 7503.92,-1645.57 7510.92,-1645.57"/>
</g>
<!-- ResMOE_s1_l15_tp4 -->
<g id="node1363" class="node">
<title>ResMOE_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="8556.77,-1346.6 7999.45,-1346.6 7856.08,-1240.6 8413.4,-1240.6 8556.77,-1346.6"/>
<text text-anchor="middle" x="8206.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8206.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8206.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp4&#45;&gt;ResMOE_s1_l15_tp4 -->
<g id="edge2274" class="edge">
<title>ResAttn_s1_l15_tp4&#45;&gt;ResMOE_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M7752.56,-1699.67C7870.33,-1689.17 8013.57,-1677.82 8142.42,-1671.55 8401.15,-1658.98 10217.09,-1672.87 10473.42,-1635.55 10618.23,-1614.47 10702.03,-1663.18 10790.42,-1546.55 10972.3,-1306.59 9745.64,-1405.64 9445.42,-1382.6 9132.75,-1358.6 8775.5,-1333.47 8525.21,-1316.24"/>
<polygon fill="black" stroke="black" points="8525.08,-1312.72 8514.86,-1315.53 8524.6,-1319.71 8525.08,-1312.72"/>
</g>
<!-- Gate_s1_l15_tp5 -->
<g id="node1323" class="node">
<title>Gate_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="1310.42,-1635.55 972.42,-1635.55 972.42,-1582.55 1310.42,-1582.55 1310.42,-1635.55"/>
<text text-anchor="middle" x="1141.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1141.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1141.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp5&#45;&gt;Gate_s1_l15_tp5 -->
<g id="edge2198" class="edge">
<title>ResAttn_s1_l15_tp5&#45;&gt;Gate_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M1374.9,-1671.54C1331.39,-1660.08 1286.9,-1648.36 1248.58,-1638.27"/>
<polygon fill="black" stroke="black" points="1249.02,-1634.77 1238.46,-1635.61 1247.24,-1641.54 1249.02,-1634.77"/>
</g>
<!-- ResMOE_s1_l15_tp5 -->
<g id="node1364" class="node">
<title>ResMOE_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="863.77,-1346.6 306.45,-1346.6 163.08,-1240.6 720.4,-1240.6 863.77,-1346.6"/>
<text text-anchor="middle" x="513.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="513.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="513.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp5&#45;&gt;ResMOE_s1_l15_tp5 -->
<g id="edge2276" class="edge">
<title>ResAttn_s1_l15_tp5&#45;&gt;ResMOE_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M1279.41,-1714C895.47,-1700.09 266.25,-1671.91 229.42,-1635.55 149.4,-1556.57 157.32,-1472.07 225.42,-1382.6 235.9,-1368.84 260.19,-1356.31 290.46,-1345.3"/>
<polygon fill="black" stroke="black" points="291.77,-1348.56 300.04,-1341.94 289.45,-1341.95 291.77,-1348.56"/>
</g>
<!-- Gate_s1_l15_tp6 -->
<g id="node1324" class="node">
<title>Gate_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10112.42,-1635.55 9774.42,-1635.55 9774.42,-1582.55 10112.42,-1582.55 10112.42,-1635.55"/>
<text text-anchor="middle" x="9943.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9943.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9943.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp6&#45;&gt;Gate_s1_l15_tp6 -->
<g id="edge2199" class="edge">
<title>ResAttn_s1_l15_tp6&#45;&gt;Gate_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M9784.92,-1671.45C9813.46,-1660.4 9842.62,-1649.1 9868.02,-1639.26"/>
<polygon fill="black" stroke="black" points="9869.5,-1642.44 9877.56,-1635.57 9866.97,-1635.92 9869.5,-1642.44"/>
</g>
<!-- ResMOE_s1_l15_tp6 -->
<g id="node1365" class="node">
<title>ResMOE_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10982.77,-1346.6 10425.45,-1346.6 10282.08,-1240.6 10839.4,-1240.6 10982.77,-1346.6"/>
<text text-anchor="middle" x="10632.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10632.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10632.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp6&#45;&gt;ResMOE_s1_l15_tp6 -->
<g id="edge2278" class="edge">
<title>ResAttn_s1_l15_tp6&#45;&gt;ResMOE_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M9927.17,-1723C10266.54,-1719.38 10804.75,-1702.92 10867.42,-1635.55 10944,-1553.24 10931.48,-1474.99 10867.42,-1382.6 10859.53,-1371.22 10849.98,-1361.31 10839.3,-1352.68"/>
<polygon fill="black" stroke="black" points="10841.41,-1349.89 10831.33,-1346.62 10837.17,-1355.46 10841.41,-1349.89"/>
</g>
<!-- Gate_s1_l15_tp7 -->
<g id="node1325" class="node">
<title>Gate_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="8808.42,-1635.55 8470.42,-1635.55 8470.42,-1582.55 8808.42,-1582.55 8808.42,-1635.55"/>
<text text-anchor="middle" x="8639.42" y="-1620.35" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8639.42" y="-1605.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8639.42" y="-1590.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp7&#45;&gt;Gate_s1_l15_tp7 -->
<g id="edge2200" class="edge">
<title>ResAttn_s1_l15_tp7&#45;&gt;Gate_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M8564.77,-1671.45C8576.97,-1661.42 8589.41,-1651.19 8600.54,-1642.03"/>
<polygon fill="black" stroke="black" points="8602.9,-1644.62 8608.4,-1635.57 8598.45,-1639.22 8602.9,-1644.62"/>
</g>
<!-- ResMOE_s1_l15_tp7 -->
<g id="node1366" class="node">
<title>ResMOE_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="9934.77,-1346.6 9377.45,-1346.6 9234.08,-1240.6 9791.4,-1240.6 9934.77,-1346.6"/>
<text text-anchor="middle" x="9584.42" y="-1304.9" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9584.42" y="-1289.9" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9584.42" y="-1274.9" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l15_tp7&#45;&gt;ResMOE_s1_l15_tp7 -->
<g id="edge2280" class="edge">
<title>ResAttn_s1_l15_tp7&#45;&gt;ResMOE_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M8753,-1704.5C8908.13,-1693.37 9111.21,-1679.91 9291.42,-1671.55 9439.76,-1664.68 10483.06,-1670.36 10627.42,-1635.55 10716.51,-1614.07 10764.57,-1624.09 10813.42,-1546.55 10825.98,-1526.62 10828.69,-1511.49 10813.42,-1493.55 10755.53,-1425.53 10259.95,-1362.4 9916.07,-1326.21"/>
<polygon fill="black" stroke="black" points="9916.26,-1322.71 9905.95,-1325.14 9915.53,-1329.67 9916.26,-1322.71"/>
</g>
<!-- Expert32_s1_l15_tp0 -->
<g id="node1326" class="node">
<title>Expert32_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="5207.42,-1546.55 4899.42,-1546.55 4899.42,-1493.55 5207.42,-1493.55 5207.42,-1546.55"/>
<text text-anchor="middle" x="5053.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="5053.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5053.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp0&#45;&gt;Expert32_s1_l15_tp0 -->
<g id="edge2201" class="edge">
<title>Gate_s1_l15_tp0&#45;&gt;Expert32_s1_l15_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.03,-1582.54C4862.26,-1572.07 4907.8,-1559.92 4947.99,-1549.19"/>
<polygon fill="black" stroke="black" points="4949.06,-1552.53 4957.82,-1546.57 4947.25,-1545.76 4949.06,-1552.53"/>
</g>
<!-- Expert33_s1_l15_tp0 -->
<g id="node1327" class="node">
<title>Expert33_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="5533.42,-1546.55 5225.42,-1546.55 5225.42,-1493.55 5533.42,-1493.55 5533.42,-1546.55"/>
<text text-anchor="middle" x="5379.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="5379.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5379.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp0&#45;&gt;Expert33_s1_l15_tp0 -->
<g id="edge2202" class="edge">
<title>Gate_s1_l15_tp0&#45;&gt;Expert33_s1_l15_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4896.47,-1588.06C4987.97,-1576.93 5103.22,-1562.42 5214.9,-1546.75"/>
<polygon fill="black" stroke="black" points="5215.59,-1550.19 5225.01,-1545.33 5214.62,-1543.26 5215.59,-1550.19"/>
</g>
<!-- Expert34_s1_l15_tp0 -->
<g id="node1328" class="node">
<title>Expert34_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4555.42,-1546.55 4247.42,-1546.55 4247.42,-1493.55 4555.42,-1493.55 4555.42,-1546.55"/>
<text text-anchor="middle" x="4401.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="4401.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4401.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp0&#45;&gt;Expert34_s1_l15_tp0 -->
<g id="edge2203" class="edge">
<title>Gate_s1_l15_tp0&#45;&gt;Expert34_s1_l15_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4631.81,-1582.54C4592.59,-1572.07 4547.04,-1559.92 4506.85,-1549.19"/>
<polygon fill="black" stroke="black" points="4507.59,-1545.76 4497.03,-1546.57 4505.79,-1552.53 4507.59,-1545.76"/>
</g>
<!-- Expert35_s1_l15_tp0 -->
<g id="node1329" class="node">
<title>Expert35_s1_l15_tp0</title>
<polygon fill="none" stroke="black" points="4881.42,-1546.55 4573.42,-1546.55 4573.42,-1493.55 4881.42,-1493.55 4881.42,-1546.55"/>
<text text-anchor="middle" x="4727.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="4727.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4727.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp0&#45;&gt;Expert35_s1_l15_tp0 -->
<g id="edge2204" class="edge">
<title>Gate_s1_l15_tp0&#45;&gt;Expert35_s1_l15_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4727.42,-1582.42C4727.42,-1574.44 4727.42,-1565.49 4727.42,-1556.94"/>
<polygon fill="black" stroke="black" points="4730.92,-1556.8 4727.42,-1546.8 4723.92,-1556.8 4730.92,-1556.8"/>
</g>
<!-- Expert36_s1_l15_tp1 -->
<g id="node1330" class="node">
<title>Expert36_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="2599.42,-1546.55 2291.42,-1546.55 2291.42,-1493.55 2599.42,-1493.55 2599.42,-1546.55"/>
<text text-anchor="middle" x="2445.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="2445.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2445.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp1&#45;&gt;Expert36_s1_l15_tp1 -->
<g id="edge2205" class="edge">
<title>Gate_s1_l15_tp1&#45;&gt;Expert36_s1_l15_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2445.42,-1582.42C2445.42,-1574.44 2445.42,-1565.49 2445.42,-1556.94"/>
<polygon fill="black" stroke="black" points="2448.92,-1556.8 2445.42,-1546.8 2441.92,-1556.8 2448.92,-1556.8"/>
</g>
<!-- Expert37_s1_l15_tp1 -->
<g id="node1331" class="node">
<title>Expert37_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="2925.42,-1546.55 2617.42,-1546.55 2617.42,-1493.55 2925.42,-1493.55 2925.42,-1546.55"/>
<text text-anchor="middle" x="2771.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="2771.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2771.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp1&#45;&gt;Expert37_s1_l15_tp1 -->
<g id="edge2206" class="edge">
<title>Gate_s1_l15_tp1&#45;&gt;Expert37_s1_l15_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2541.03,-1582.54C2580.26,-1572.07 2625.8,-1559.92 2665.99,-1549.19"/>
<polygon fill="black" stroke="black" points="2667.06,-1552.53 2675.82,-1546.57 2665.25,-1545.76 2667.06,-1552.53"/>
</g>
<!-- Expert38_s1_l15_tp1 -->
<g id="node1332" class="node">
<title>Expert38_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="1947.42,-1546.55 1639.42,-1546.55 1639.42,-1493.55 1947.42,-1493.55 1947.42,-1546.55"/>
<text text-anchor="middle" x="1793.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="1793.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1793.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp1&#45;&gt;Expert38_s1_l15_tp1 -->
<g id="edge2207" class="edge">
<title>Gate_s1_l15_tp1&#45;&gt;Expert38_s1_l15_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2276.37,-1588.06C2184.87,-1576.93 2069.63,-1562.42 1957.94,-1546.75"/>
<polygon fill="black" stroke="black" points="1958.23,-1543.26 1947.84,-1545.33 1957.25,-1550.19 1958.23,-1543.26"/>
</g>
<!-- Expert39_s1_l15_tp1 -->
<g id="node1333" class="node">
<title>Expert39_s1_l15_tp1</title>
<polygon fill="none" stroke="black" points="2273.42,-1546.55 1965.42,-1546.55 1965.42,-1493.55 2273.42,-1493.55 2273.42,-1546.55"/>
<text text-anchor="middle" x="2119.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="2119.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2119.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp1&#45;&gt;Expert39_s1_l15_tp1 -->
<g id="edge2208" class="edge">
<title>Gate_s1_l15_tp1&#45;&gt;Expert39_s1_l15_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2349.81,-1582.54C2310.59,-1572.07 2265.04,-1559.92 2224.85,-1549.19"/>
<polygon fill="black" stroke="black" points="2225.59,-1545.76 2215.03,-1546.57 2223.79,-1552.53 2225.59,-1545.76"/>
</g>
<!-- Expert40_s1_l15_tp2 -->
<g id="node1334" class="node">
<title>Expert40_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="4229.42,-1546.55 3921.42,-1546.55 3921.42,-1493.55 4229.42,-1493.55 4229.42,-1546.55"/>
<text text-anchor="middle" x="4075.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="4075.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4075.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp2&#45;&gt;Expert40_s1_l15_tp2 -->
<g id="edge2209" class="edge">
<title>Gate_s1_l15_tp2&#45;&gt;Expert40_s1_l15_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3712.17,-1582.54C3775.84,-1571.76 3850.08,-1559.19 3914.79,-1548.24"/>
<polygon fill="black" stroke="black" points="3915.41,-1551.69 3924.68,-1546.57 3914.24,-1544.79 3915.41,-1551.69"/>
</g>
<!-- Expert41_s1_l15_tp2 -->
<g id="node1335" class="node">
<title>Expert41_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="3251.42,-1546.55 2943.42,-1546.55 2943.42,-1493.55 3251.42,-1493.55 3251.42,-1546.55"/>
<text text-anchor="middle" x="3097.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="3097.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3097.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp2&#45;&gt;Expert41_s1_l15_tp2 -->
<g id="edge2210" class="edge">
<title>Gate_s1_l15_tp2&#45;&gt;Expert41_s1_l15_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3425.34,-1582.54C3368.21,-1571.83 3301.67,-1559.35 3243.51,-1548.44"/>
<polygon fill="black" stroke="black" points="3243.97,-1544.97 3233.5,-1546.57 3242.68,-1551.85 3243.97,-1544.97"/>
</g>
<!-- Expert42_s1_l15_tp2 -->
<g id="node1336" class="node">
<title>Expert42_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="3577.42,-1546.55 3269.42,-1546.55 3269.42,-1493.55 3577.42,-1493.55 3577.42,-1546.55"/>
<text text-anchor="middle" x="3423.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="3423.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3423.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp2&#45;&gt;Expert42_s1_l15_tp2 -->
<g id="edge2211" class="edge">
<title>Gate_s1_l15_tp2&#45;&gt;Expert42_s1_l15_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3520.76,-1582.42C3505.74,-1572.95 3488.54,-1562.11 3472.82,-1552.2"/>
<polygon fill="black" stroke="black" points="3474.59,-1549.18 3464.27,-1546.8 3470.86,-1555.1 3474.59,-1549.18"/>
</g>
<!-- Expert43_s1_l15_tp2 -->
<g id="node1337" class="node">
<title>Expert43_s1_l15_tp2</title>
<polygon fill="none" stroke="black" points="3903.42,-1546.55 3595.42,-1546.55 3595.42,-1493.55 3903.42,-1493.55 3903.42,-1546.55"/>
<text text-anchor="middle" x="3749.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="3749.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3749.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp2&#45;&gt;Expert43_s1_l15_tp2 -->
<g id="edge2212" class="edge">
<title>Gate_s1_l15_tp2&#45;&gt;Expert43_s1_l15_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3616.56,-1582.54C3637.98,-1572.62 3662.68,-1561.2 3684.92,-1550.9"/>
<polygon fill="black" stroke="black" points="3686.68,-1553.94 3694.29,-1546.57 3683.74,-1547.59 3686.68,-1553.94"/>
</g>
<!-- Expert44_s1_l15_tp3 -->
<g id="node1338" class="node">
<title>Expert44_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="5859.42,-1546.55 5551.42,-1546.55 5551.42,-1493.55 5859.42,-1493.55 5859.42,-1546.55"/>
<text text-anchor="middle" x="5705.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="5705.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5705.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp3&#45;&gt;Expert44_s1_l15_tp3 -->
<g id="edge2213" class="edge">
<title>Gate_s1_l15_tp3&#45;&gt;Expert44_s1_l15_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6188.37,-1588.06C6096.87,-1576.93 5981.63,-1562.42 5869.94,-1546.75"/>
<polygon fill="black" stroke="black" points="5870.23,-1543.26 5859.84,-1545.33 5869.25,-1550.19 5870.23,-1543.26"/>
</g>
<!-- Expert45_s1_l15_tp3 -->
<g id="node1339" class="node">
<title>Expert45_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6185.42,-1546.55 5877.42,-1546.55 5877.42,-1493.55 6185.42,-1493.55 6185.42,-1546.55"/>
<text text-anchor="middle" x="6031.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="6031.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6031.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp3&#45;&gt;Expert45_s1_l15_tp3 -->
<g id="edge2214" class="edge">
<title>Gate_s1_l15_tp3&#45;&gt;Expert45_s1_l15_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6261.81,-1582.54C6222.59,-1572.07 6177.04,-1559.92 6136.85,-1549.19"/>
<polygon fill="black" stroke="black" points="6137.59,-1545.76 6127.03,-1546.57 6135.79,-1552.53 6137.59,-1545.76"/>
</g>
<!-- Expert46_s1_l15_tp3 -->
<g id="node1340" class="node">
<title>Expert46_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6511.42,-1546.55 6203.42,-1546.55 6203.42,-1493.55 6511.42,-1493.55 6511.42,-1546.55"/>
<text text-anchor="middle" x="6357.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="6357.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6357.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp3&#45;&gt;Expert46_s1_l15_tp3 -->
<g id="edge2215" class="edge">
<title>Gate_s1_l15_tp3&#45;&gt;Expert46_s1_l15_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6357.42,-1582.42C6357.42,-1574.44 6357.42,-1565.49 6357.42,-1556.94"/>
<polygon fill="black" stroke="black" points="6360.92,-1556.8 6357.42,-1546.8 6353.92,-1556.8 6360.92,-1556.8"/>
</g>
<!-- Expert47_s1_l15_tp3 -->
<g id="node1341" class="node">
<title>Expert47_s1_l15_tp3</title>
<polygon fill="none" stroke="black" points="6837.42,-1546.55 6529.42,-1546.55 6529.42,-1493.55 6837.42,-1493.55 6837.42,-1546.55"/>
<text text-anchor="middle" x="6683.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="6683.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6683.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp3&#45;&gt;Expert47_s1_l15_tp3 -->
<g id="edge2216" class="edge">
<title>Gate_s1_l15_tp3&#45;&gt;Expert47_s1_l15_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6453.03,-1582.54C6492.26,-1572.07 6537.8,-1559.92 6577.99,-1549.19"/>
<polygon fill="black" stroke="black" points="6579.06,-1552.53 6587.82,-1546.57 6577.25,-1545.76 6579.06,-1552.53"/>
</g>
<!-- Expert48_s1_l15_tp4 -->
<g id="node1342" class="node">
<title>Expert48_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="7163.42,-1546.55 6855.42,-1546.55 6855.42,-1493.55 7163.42,-1493.55 7163.42,-1546.55"/>
<text text-anchor="middle" x="7009.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="7009.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7009.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp4&#45;&gt;Expert48_s1_l15_tp4 -->
<g id="edge2217" class="edge">
<title>Gate_s1_l15_tp4&#45;&gt;Expert48_s1_l15_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7361.37,-1582.54C7299.8,-1571.78 7228.04,-1559.25 7165.44,-1548.31"/>
<polygon fill="black" stroke="black" points="7165.92,-1544.84 7155.47,-1546.57 7164.72,-1551.74 7165.92,-1544.84"/>
</g>
<!-- Expert49_s1_l15_tp4 -->
<g id="node1343" class="node">
<title>Expert49_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="7489.42,-1546.55 7181.42,-1546.55 7181.42,-1493.55 7489.42,-1493.55 7489.42,-1546.55"/>
<text text-anchor="middle" x="7335.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="7335.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7335.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp4&#45;&gt;Expert49_s1_l15_tp4 -->
<g id="edge2218" class="edge">
<title>Gate_s1_l15_tp4&#45;&gt;Expert49_s1_l15_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7456.75,-1582.42C7437.41,-1572.64 7415.19,-1561.4 7395.1,-1551.24"/>
<polygon fill="black" stroke="black" points="7396.54,-1548.04 7386.03,-1546.65 7393.38,-1554.29 7396.54,-1548.04"/>
</g>
<!-- Expert50_s1_l15_tp4 -->
<g id="node1344" class="node">
<title>Expert50_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="7815.42,-1546.55 7507.42,-1546.55 7507.42,-1493.55 7815.42,-1493.55 7815.42,-1546.55"/>
<text text-anchor="middle" x="7661.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="7661.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7661.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp4&#45;&gt;Expert50_s1_l15_tp4 -->
<g id="edge2219" class="edge">
<title>Gate_s1_l15_tp4&#45;&gt;Expert50_s1_l15_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7552.79,-1582.42C7569.79,-1572.82 7589.28,-1561.81 7607.02,-1551.79"/>
<polygon fill="black" stroke="black" points="7609.12,-1554.62 7616.11,-1546.65 7605.68,-1548.52 7609.12,-1554.62"/>
</g>
<!-- Expert51_s1_l15_tp4 -->
<g id="node1345" class="node">
<title>Expert51_s1_l15_tp4</title>
<polygon fill="none" stroke="black" points="8141.42,-1546.55 7833.42,-1546.55 7833.42,-1493.55 8141.42,-1493.55 8141.42,-1546.55"/>
<text text-anchor="middle" x="7987.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="7987.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7987.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp4&#45;&gt;Expert51_s1_l15_tp4 -->
<g id="edge2220" class="edge">
<title>Gate_s1_l15_tp4&#45;&gt;Expert51_s1_l15_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7648.2,-1582.54C7707.42,-1571.8 7776.42,-1559.3 7836.67,-1548.38"/>
<polygon fill="black" stroke="black" points="7837.44,-1551.8 7846.65,-1546.57 7836.19,-1544.91 7837.44,-1551.8"/>
</g>
<!-- Expert52_s1_l15_tp5 -->
<g id="node1346" class="node">
<title>Expert52_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="643.42,-1546.55 335.42,-1546.55 335.42,-1493.55 643.42,-1493.55 643.42,-1546.55"/>
<text text-anchor="middle" x="489.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="489.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="489.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp5&#45;&gt;Expert52_s1_l15_tp5 -->
<g id="edge2221" class="edge">
<title>Gate_s1_l15_tp5&#45;&gt;Expert52_s1_l15_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M972.37,-1588.06C880.87,-1576.93 765.63,-1562.42 653.94,-1546.75"/>
<polygon fill="black" stroke="black" points="654.23,-1543.26 643.84,-1545.33 653.25,-1550.19 654.23,-1543.26"/>
</g>
<!-- Expert53_s1_l15_tp5 -->
<g id="node1347" class="node">
<title>Expert53_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="969.42,-1546.55 661.42,-1546.55 661.42,-1493.55 969.42,-1493.55 969.42,-1546.55"/>
<text text-anchor="middle" x="815.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="815.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="815.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp5&#45;&gt;Expert53_s1_l15_tp5 -->
<g id="edge2222" class="edge">
<title>Gate_s1_l15_tp5&#45;&gt;Expert53_s1_l15_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1045.81,-1582.54C1006.59,-1572.07 961.04,-1559.92 920.85,-1549.19"/>
<polygon fill="black" stroke="black" points="921.59,-1545.76 911.03,-1546.57 919.79,-1552.53 921.59,-1545.76"/>
</g>
<!-- Expert54_s1_l15_tp5 -->
<g id="node1348" class="node">
<title>Expert54_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="1295.42,-1546.55 987.42,-1546.55 987.42,-1493.55 1295.42,-1493.55 1295.42,-1546.55"/>
<text text-anchor="middle" x="1141.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="1141.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1141.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp5&#45;&gt;Expert54_s1_l15_tp5 -->
<g id="edge2223" class="edge">
<title>Gate_s1_l15_tp5&#45;&gt;Expert54_s1_l15_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1141.42,-1582.42C1141.42,-1574.44 1141.42,-1565.49 1141.42,-1556.94"/>
<polygon fill="black" stroke="black" points="1144.92,-1556.8 1141.42,-1546.8 1137.92,-1556.8 1144.92,-1556.8"/>
</g>
<!-- Expert55_s1_l15_tp5 -->
<g id="node1349" class="node">
<title>Expert55_s1_l15_tp5</title>
<polygon fill="none" stroke="black" points="1621.42,-1546.55 1313.42,-1546.55 1313.42,-1493.55 1621.42,-1493.55 1621.42,-1546.55"/>
<text text-anchor="middle" x="1467.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="1467.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1467.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp5&#45;&gt;Expert55_s1_l15_tp5 -->
<g id="edge2224" class="edge">
<title>Gate_s1_l15_tp5&#45;&gt;Expert55_s1_l15_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1237.03,-1582.54C1276.26,-1572.07 1321.8,-1559.92 1361.99,-1549.19"/>
<polygon fill="black" stroke="black" points="1363.06,-1552.53 1371.82,-1546.57 1361.25,-1545.76 1363.06,-1552.53"/>
</g>
<!-- Expert56_s1_l15_tp6 -->
<g id="node1350" class="node">
<title>Expert56_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="9771.42,-1546.55 9463.42,-1546.55 9463.42,-1493.55 9771.42,-1493.55 9771.42,-1546.55"/>
<text text-anchor="middle" x="9617.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="9617.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9617.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp6&#45;&gt;Expert56_s1_l15_tp6 -->
<g id="edge2225" class="edge">
<title>Gate_s1_l15_tp6&#45;&gt;Expert56_s1_l15_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9847.81,-1582.54C9808.59,-1572.07 9763.04,-1559.92 9722.85,-1549.19"/>
<polygon fill="black" stroke="black" points="9723.59,-1545.76 9713.03,-1546.57 9721.79,-1552.53 9723.59,-1545.76"/>
</g>
<!-- Expert57_s1_l15_tp6 -->
<g id="node1351" class="node">
<title>Expert57_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10097.42,-1546.55 9789.42,-1546.55 9789.42,-1493.55 10097.42,-1493.55 10097.42,-1546.55"/>
<text text-anchor="middle" x="9943.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="9943.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9943.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp6&#45;&gt;Expert57_s1_l15_tp6 -->
<g id="edge2226" class="edge">
<title>Gate_s1_l15_tp6&#45;&gt;Expert57_s1_l15_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9943.42,-1582.42C9943.42,-1574.44 9943.42,-1565.49 9943.42,-1556.94"/>
<polygon fill="black" stroke="black" points="9946.92,-1556.8 9943.42,-1546.8 9939.92,-1556.8 9946.92,-1556.8"/>
</g>
<!-- Expert58_s1_l15_tp6 -->
<g id="node1352" class="node">
<title>Expert58_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10423.42,-1546.55 10115.42,-1546.55 10115.42,-1493.55 10423.42,-1493.55 10423.42,-1546.55"/>
<text text-anchor="middle" x="10269.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="10269.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10269.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp6&#45;&gt;Expert58_s1_l15_tp6 -->
<g id="edge2227" class="edge">
<title>Gate_s1_l15_tp6&#45;&gt;Expert58_s1_l15_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.03,-1582.54C10078.26,-1572.07 10123.8,-1559.92 10163.99,-1549.19"/>
<polygon fill="black" stroke="black" points="10165.06,-1552.53 10173.82,-1546.57 10163.25,-1545.76 10165.06,-1552.53"/>
</g>
<!-- Expert59_s1_l15_tp6 -->
<g id="node1353" class="node">
<title>Expert59_s1_l15_tp6</title>
<polygon fill="none" stroke="black" points="10749.42,-1546.55 10441.42,-1546.55 10441.42,-1493.55 10749.42,-1493.55 10749.42,-1546.55"/>
<text text-anchor="middle" x="10595.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="10595.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10595.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp6&#45;&gt;Expert59_s1_l15_tp6 -->
<g id="edge2228" class="edge">
<title>Gate_s1_l15_tp6&#45;&gt;Expert59_s1_l15_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10112.47,-1588.06C10203.97,-1576.93 10319.22,-1562.42 10430.9,-1546.75"/>
<polygon fill="black" stroke="black" points="10431.59,-1550.19 10441.01,-1545.33 10430.62,-1543.26 10431.59,-1550.19"/>
</g>
<!-- Expert60_s1_l15_tp7 -->
<g id="node1354" class="node">
<title>Expert60_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="8467.42,-1546.55 8159.42,-1546.55 8159.42,-1493.55 8467.42,-1493.55 8467.42,-1546.55"/>
<text text-anchor="middle" x="8313.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="8313.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8313.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp7&#45;&gt;Expert60_s1_l15_tp7 -->
<g id="edge2229" class="edge">
<title>Gate_s1_l15_tp7&#45;&gt;Expert60_s1_l15_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8543.81,-1582.54C8504.59,-1572.07 8459.04,-1559.92 8418.85,-1549.19"/>
<polygon fill="black" stroke="black" points="8419.59,-1545.76 8409.03,-1546.57 8417.79,-1552.53 8419.59,-1545.76"/>
</g>
<!-- Expert61_s1_l15_tp7 -->
<g id="node1355" class="node">
<title>Expert61_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="8793.42,-1546.55 8485.42,-1546.55 8485.42,-1493.55 8793.42,-1493.55 8793.42,-1546.55"/>
<text text-anchor="middle" x="8639.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="8639.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8639.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp7&#45;&gt;Expert61_s1_l15_tp7 -->
<g id="edge2230" class="edge">
<title>Gate_s1_l15_tp7&#45;&gt;Expert61_s1_l15_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.42,-1582.42C8639.42,-1574.44 8639.42,-1565.49 8639.42,-1556.94"/>
<polygon fill="black" stroke="black" points="8642.92,-1556.8 8639.42,-1546.8 8635.92,-1556.8 8642.92,-1556.8"/>
</g>
<!-- Expert62_s1_l15_tp7 -->
<g id="node1356" class="node">
<title>Expert62_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="9119.42,-1546.55 8811.42,-1546.55 8811.42,-1493.55 9119.42,-1493.55 9119.42,-1546.55"/>
<text text-anchor="middle" x="8965.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="8965.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8965.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp7&#45;&gt;Expert62_s1_l15_tp7 -->
<g id="edge2231" class="edge">
<title>Gate_s1_l15_tp7&#45;&gt;Expert62_s1_l15_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8735.03,-1582.54C8774.26,-1572.07 8819.8,-1559.92 8859.99,-1549.19"/>
<polygon fill="black" stroke="black" points="8861.06,-1552.53 8869.82,-1546.57 8859.25,-1545.76 8861.06,-1552.53"/>
</g>
<!-- Expert63_s1_l15_tp7 -->
<g id="node1357" class="node">
<title>Expert63_s1_l15_tp7</title>
<polygon fill="none" stroke="black" points="9445.42,-1546.55 9137.42,-1546.55 9137.42,-1493.55 9445.42,-1493.55 9445.42,-1546.55"/>
<text text-anchor="middle" x="9291.42" y="-1531.35" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="9291.42" y="-1516.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9291.42" y="-1501.35" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l15_tp7&#45;&gt;Expert63_s1_l15_tp7 -->
<g id="edge2232" class="edge">
<title>Gate_s1_l15_tp7&#45;&gt;Expert63_s1_l15_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8808.47,-1588.06C8899.97,-1576.93 9015.22,-1562.42 9126.9,-1546.75"/>
<polygon fill="black" stroke="black" points="9127.59,-1550.19 9137.01,-1545.33 9126.62,-1543.26 9127.59,-1550.19"/>
</g>
<!-- AR_exp_s1_l15 -->
<g id="node1358" class="node">
<title>AR_exp_s1_l15</title>
<ellipse fill="none" stroke="black" cx="5509.42" cy="-1420.08" rx="239" ry="37.45"/>
<text text-anchor="middle" x="5509.42" y="-1431.38" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="5509.42" y="-1416.38" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5509.42" y="-1401.38" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l15_tp0&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2233" class="edge">
<title>Expert32_s1_l15_tp0&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M5172.34,-1493.5C5230.08,-1481.1 5300.04,-1466.07 5361.22,-1452.92"/>
<polygon fill="black" stroke="black" points="5362.31,-1456.27 5371.35,-1450.74 5360.84,-1449.42 5362.31,-1456.27"/>
</g>
<!-- Expert33_s1_l15_tp0&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2234" class="edge">
<title>Expert33_s1_l15_tp0&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M5413.58,-1493.31C5425.79,-1484.11 5439.89,-1473.48 5453.46,-1463.26"/>
<polygon fill="black" stroke="black" points="5455.93,-1465.77 5461.81,-1456.96 5451.72,-1460.18 5455.93,-1465.77"/>
</g>
<!-- Expert34_s1_l15_tp0&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2235" class="edge">
<title>Expert34_s1_l15_tp0&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M4555.81,-1494.58C4558.71,-1494.23 4561.58,-1493.88 4564.42,-1493.55 4806.08,-1465.43 5083.82,-1445.61 5275.35,-1433.89"/>
<polygon fill="black" stroke="black" points="5275.78,-1437.37 5285.55,-1433.27 5275.36,-1430.39 5275.78,-1437.37"/>
</g>
<!-- Expert35_s1_l15_tp0&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2236" class="edge">
<title>Expert35_s1_l15_tp0&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M4881.83,-1494.74C4884.72,-1494.34 4887.58,-1493.94 4890.42,-1493.55 5028.32,-1474.7 5183.92,-1456.5 5304.62,-1443.05"/>
<polygon fill="black" stroke="black" points="5305.17,-1446.51 5314.72,-1441.92 5304.39,-1439.55 5305.17,-1446.51"/>
</g>
<!-- Expert36_s1_l15_tp1&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2237" class="edge">
<title>Expert36_s1_l15_tp1&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M2599.79,-1494.38C2602.69,-1494.09 2605.57,-1493.81 2608.42,-1493.55 3119.84,-1447.36 4656.22,-1428.78 5260.97,-1423.12"/>
<polygon fill="black" stroke="black" points="5261.16,-1426.62 5271.13,-1423.03 5261.09,-1419.62 5261.16,-1426.62"/>
</g>
<!-- Expert37_s1_l15_tp1&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2238" class="edge">
<title>Expert37_s1_l15_tp1&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M2925.79,-1494.39C2928.69,-1494.1 2931.57,-1493.82 2934.42,-1493.55 3380.79,-1452.52 4706.95,-1431.31 5261.41,-1424.04"/>
<polygon fill="black" stroke="black" points="5261.58,-1427.54 5271.54,-1423.9 5261.49,-1420.54 5261.58,-1427.54"/>
</g>
<!-- Expert38_s1_l15_tp1&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2239" class="edge">
<title>Expert38_s1_l15_tp1&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M1947.79,-1494.36C1950.69,-1494.07 1953.57,-1493.8 1956.42,-1493.55 2599.07,-1436.99 4562.83,-1424.47 5260.37,-1421.79"/>
<polygon fill="black" stroke="black" points="5260.55,-1425.29 5270.54,-1421.75 5260.53,-1418.29 5260.55,-1425.29"/>
</g>
<!-- Expert39_s1_l15_tp1&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2240" class="edge">
<title>Expert39_s1_l15_tp1&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M2273.79,-1494.37C2276.69,-1494.08 2279.57,-1493.81 2282.42,-1493.55 2859.2,-1442.19 4607.8,-1426.52 5260.34,-1422.39"/>
<polygon fill="black" stroke="black" points="5260.83,-1425.89 5270.81,-1422.33 5260.79,-1418.89 5260.83,-1425.89"/>
</g>
<!-- Expert40_s1_l15_tp2&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2241" class="edge">
<title>Expert40_s1_l15_tp2&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M4229.81,-1494.51C4232.7,-1494.18 4235.57,-1493.86 4238.42,-1493.55 4594.37,-1455.65 5008.66,-1436.7 5265,-1427.89"/>
<polygon fill="black" stroke="black" points="5265.31,-1431.38 5275.19,-1427.54 5265.08,-1424.38 5265.31,-1431.38"/>
</g>
<!-- Expert41_s1_l15_tp2&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2242" class="edge">
<title>Expert41_s1_l15_tp2&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M3251.8,-1494.41C3254.69,-1494.11 3257.57,-1493.82 3260.42,-1493.55 3642.24,-1457.67 4761.24,-1434.2 5262.1,-1425.21"/>
<polygon fill="black" stroke="black" points="5262.42,-1428.7 5272.35,-1425.02 5262.29,-1421.7 5262.42,-1428.7"/>
</g>
<!-- Expert42_s1_l15_tp2&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2243" class="edge">
<title>Expert42_s1_l15_tp2&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M3577.8,-1494.43C3580.69,-1494.12 3583.57,-1493.83 3586.42,-1493.55 4185.21,-1435.63 4893.03,-1423.34 5260.26,-1421.14"/>
<polygon fill="black" stroke="black" points="5260.51,-1424.63 5270.49,-1421.08 5260.47,-1417.64 5260.51,-1424.63"/>
</g>
<!-- Expert43_s1_l15_tp2&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2244" class="edge">
<title>Expert43_s1_l15_tp2&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M3903.8,-1494.46C3906.7,-1494.14 3909.57,-1493.84 3912.42,-1493.55 4388.1,-1445.7 4946.69,-1429.43 5261.24,-1423.91"/>
<polygon fill="black" stroke="black" points="5261.47,-1427.4 5271.4,-1423.73 5261.35,-1420.4 5261.47,-1427.4"/>
</g>
<!-- Expert44_s1_l15_tp3&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2245" class="edge">
<title>Expert44_s1_l15_tp3&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M5654.18,-1493.44C5634.04,-1483.37 5610.47,-1471.59 5588.26,-1460.48"/>
<polygon fill="black" stroke="black" points="5589.68,-1457.28 5579.17,-1455.94 5586.55,-1463.54 5589.68,-1457.28"/>
</g>
<!-- Expert45_s1_l15_tp3&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2246" class="edge">
<title>Expert45_s1_l15_tp3&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M5895.3,-1493.5C5826.2,-1480.53 5741.82,-1464.7 5669.61,-1451.14"/>
<polygon fill="black" stroke="black" points="5669.98,-1447.65 5659.51,-1449.25 5668.69,-1454.53 5669.98,-1447.65"/>
</g>
<!-- Expert46_s1_l15_tp3&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2247" class="edge">
<title>Expert46_s1_l15_tp3&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M6203.02,-1494.7C6200.13,-1494.31 6197.26,-1493.93 6194.42,-1493.55 6036.67,-1472.88 5857.87,-1454.12 5722.51,-1440.87"/>
<polygon fill="black" stroke="black" points="5722.72,-1437.37 5712.43,-1439.88 5722.04,-1444.34 5722.72,-1437.37"/>
</g>
<!-- Expert47_s1_l15_tp3&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2248" class="edge">
<title>Expert47_s1_l15_tp3&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M6529.03,-1494.56C6526.14,-1494.22 6523.27,-1493.88 6520.42,-1493.55 6256.15,-1463.46 5951.51,-1443.64 5746.29,-1432.45"/>
<polygon fill="black" stroke="black" points="5746.46,-1428.95 5736.29,-1431.91 5746.08,-1435.94 5746.46,-1428.95"/>
</g>
<!-- Expert48_s1_l15_tp4&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2249" class="edge">
<title>Expert48_s1_l15_tp4&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M6855.04,-1494.5C6852.15,-1494.17 6849.27,-1493.85 6846.42,-1493.55 6466.67,-1453.66 6023.79,-1435.12 5755.14,-1426.96"/>
<polygon fill="black" stroke="black" points="5754.97,-1423.45 5744.87,-1426.65 5754.76,-1430.45 5754.97,-1423.45"/>
</g>
<!-- Expert49_s1_l15_tp4&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2250" class="edge">
<title>Expert49_s1_l15_tp4&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M7181.04,-1494.45C7178.15,-1494.14 7175.27,-1493.84 7172.42,-1493.55 6672.03,-1443.67 6083.55,-1428.11 5757.92,-1423.27"/>
<polygon fill="black" stroke="black" points="5757.94,-1419.77 5747.89,-1423.12 5757.83,-1426.77 5757.94,-1419.77"/>
</g>
<!-- Expert50_s1_l15_tp4&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2251" class="edge">
<title>Expert50_s1_l15_tp4&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M7507.05,-1494.43C7504.15,-1494.12 7501.27,-1493.83 7498.42,-1493.55 6874.45,-1433.59 6136.02,-1422.22 5758.68,-1420.68"/>
<polygon fill="black" stroke="black" points="5758.47,-1417.18 5748.45,-1420.64 5758.44,-1424.18 5758.47,-1417.18"/>
</g>
<!-- Expert51_s1_l15_tp4&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2252" class="edge">
<title>Expert51_s1_l15_tp4&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M7833.05,-1494.41C7830.15,-1494.1 7827.27,-1493.82 7824.42,-1493.55 7429.56,-1456.63 6268.77,-1433.58 5756.82,-1424.94"/>
<polygon fill="black" stroke="black" points="5756.77,-1421.44 5746.71,-1424.77 5756.65,-1428.44 5756.77,-1421.44"/>
</g>
<!-- Expert52_s1_l15_tp5&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2253" class="edge">
<title>Expert52_s1_l15_tp5&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M643.79,-1494.34C646.69,-1494.06 649.57,-1493.8 652.42,-1493.55 1112.03,-1454.37 4333.69,-1429.22 5260.54,-1422.74"/>
<polygon fill="black" stroke="black" points="5260.69,-1426.24 5270.66,-1422.67 5260.64,-1419.24 5260.69,-1426.24"/>
</g>
<!-- Expert53_s1_l15_tp5&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2254" class="edge">
<title>Expert53_s1_l15_tp5&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M969.79,-1494.35C972.69,-1494.06 975.57,-1493.8 978.42,-1493.55 1820.13,-1421.34 4438.39,-1419.28 5260.1,-1420.49"/>
<polygon fill="black" stroke="black" points="5260.27,-1423.99 5270.28,-1420.51 5260.28,-1416.99 5260.27,-1423.99"/>
</g>
<!-- Expert54_s1_l15_tp5&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2255" class="edge">
<title>Expert54_s1_l15_tp5&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M1295.79,-1494.35C1298.69,-1494.07 1301.57,-1493.8 1304.42,-1493.55 2079.47,-1426.57 4477.74,-1420.88 5259.94,-1420.86"/>
<polygon fill="black" stroke="black" points="5260.2,-1424.36 5270.2,-1420.86 5260.2,-1417.36 5260.2,-1424.36"/>
</g>
<!-- Expert55_s1_l15_tp5&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2256" class="edge">
<title>Expert55_s1_l15_tp5&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M1621.79,-1494.36C1624.69,-1494.07 1627.57,-1493.8 1630.42,-1493.55 2339.13,-1431.79 4519.28,-1422.61 5260.08,-1421.28"/>
<polygon fill="black" stroke="black" points="5260.35,-1424.78 5270.34,-1421.27 5260.34,-1417.78 5260.35,-1424.78"/>
</g>
<!-- Expert56_s1_l15_tp6&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2257" class="edge">
<title>Expert56_s1_l15_tp6&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M9463.05,-1494.35C9460.16,-1494.07 9457.28,-1493.8 9454.42,-1493.55 8732.29,-1430.73 6508.02,-1422.25 5758.75,-1421.19"/>
<polygon fill="black" stroke="black" points="5758.65,-1417.69 5748.64,-1421.18 5758.64,-1424.69 5758.65,-1417.69"/>
</g>
<!-- Expert57_s1_l15_tp6&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2258" class="edge">
<title>Expert57_s1_l15_tp6&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M9789.05,-1494.35C9786.16,-1494.07 9783.28,-1493.8 9780.42,-1493.55 8991.85,-1425.51 6548.87,-1420.55 5758.72,-1420.78"/>
<polygon fill="black" stroke="black" points="5758.64,-1417.28 5748.64,-1420.78 5758.64,-1424.28 5758.64,-1417.28"/>
</g>
<!-- Expert58_s1_l15_tp6&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2259" class="edge">
<title>Expert58_s1_l15_tp6&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M10115.05,-1494.34C10112.16,-1494.06 10109.28,-1493.8 10106.42,-1493.55 9251.21,-1420.28 6588.35,-1418.97 5758.77,-1420.42"/>
<polygon fill="black" stroke="black" points="5758.49,-1416.92 5748.49,-1420.44 5758.5,-1423.92 5758.49,-1416.92"/>
</g>
<!-- Expert59_s1_l15_tp6&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2260" class="edge">
<title>Expert59_s1_l15_tp6&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M10441.06,-1494.34C10438.16,-1494.06 10435.28,-1493.8 10432.42,-1493.55 9965.97,-1453.83 6692.76,-1429.02 5758.09,-1422.69"/>
<polygon fill="black" stroke="black" points="5757.91,-1419.19 5747.88,-1422.62 5757.86,-1426.19 5757.91,-1419.19"/>
</g>
<!-- Expert60_s1_l15_tp7&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2261" class="edge">
<title>Expert60_s1_l15_tp7&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M8159.05,-1494.39C8156.15,-1494.09 8153.27,-1493.81 8150.42,-1493.55 7690.98,-1451.48 6322.75,-1430.78 5757.74,-1423.84"/>
<polygon fill="black" stroke="black" points="5757.47,-1420.33 5747.43,-1423.71 5757.38,-1427.33 5757.47,-1420.33"/>
</g>
<!-- Expert61_s1_l15_tp7&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2262" class="edge">
<title>Expert61_s1_l15_tp7&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M8485.05,-1494.38C8482.15,-1494.09 8479.28,-1493.81 8476.42,-1493.55 7951.85,-1446.32 6372.92,-1428.3 5758.18,-1422.96"/>
<polygon fill="black" stroke="black" points="5757.88,-1419.46 5747.85,-1422.87 5757.82,-1426.46 5757.88,-1419.46"/>
</g>
<!-- Expert62_s1_l15_tp7&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2263" class="edge">
<title>Expert62_s1_l15_tp7&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M8811.05,-1494.37C8808.15,-1494.08 8805.28,-1493.81 8802.42,-1493.55 8212.28,-1441.13 6420.01,-1426.09 5758.33,-1422.26"/>
<polygon fill="black" stroke="black" points="5758.21,-1418.76 5748.19,-1422.2 5758.17,-1425.76 5758.21,-1418.76"/>
</g>
<!-- Expert63_s1_l15_tp7&#45;&gt;AR_exp_s1_l15 -->
<g id="edge2264" class="edge">
<title>Expert63_s1_l15_tp7&#45;&gt;AR_exp_s1_l15</title>
<path fill="none" stroke="black" d="M9137.05,-1494.36C9134.15,-1494.07 9131.28,-1493.8 9128.42,-1493.55 8472.39,-1435.93 6464.77,-1424.08 5758.43,-1421.68"/>
<polygon fill="black" stroke="black" points="5758.39,-1418.18 5748.38,-1421.64 5758.37,-1425.18 5758.39,-1418.18"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp0 -->
<g id="edge2265" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp0</title>
<path fill="none" stroke="black" d="M5455.26,-1383.41C5440.49,-1373.68 5424.11,-1362.89 5407.99,-1352.27"/>
<polygon fill="black" stroke="black" points="5409.87,-1349.32 5399.59,-1346.74 5406.02,-1355.17 5409.87,-1349.32"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp1 -->
<g id="edge2267" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp1</title>
<path fill="none" stroke="black" d="M5280.41,-1409.18C4962.44,-1395.39 4369.2,-1369.51 3863.42,-1346.6 3590.53,-1334.24 3280.16,-1319.76 3055.96,-1309.22"/>
<polygon fill="black" stroke="black" points="3055.84,-1305.71 3045.69,-1308.74 3055.51,-1312.7 3055.84,-1305.71"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp2 -->
<g id="edge2269" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp2</title>
<path fill="none" stroke="black" d="M5308.68,-1399.66C5107.33,-1380.19 4793.71,-1349.85 4555.11,-1326.78"/>
<polygon fill="black" stroke="black" points="4555.17,-1323.27 4544.88,-1325.79 4554.49,-1330.23 4555.17,-1323.27"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp3 -->
<g id="edge2271" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp3</title>
<path fill="none" stroke="black" d="M5659.19,-1390.83C5741.57,-1375.29 5845.57,-1355.68 5938.15,-1338.22"/>
<polygon fill="black" stroke="black" points="5939.04,-1341.61 5948.22,-1336.32 5937.75,-1334.73 5939.04,-1341.61"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp4 -->
<g id="edge2273" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp4</title>
<path fill="none" stroke="black" d="M5737.04,-1408.57C6231.78,-1385.74 7403.28,-1331.67 7935.24,-1307.12"/>
<polygon fill="black" stroke="black" points="7935.53,-1310.61 7945.36,-1306.65 7935.21,-1303.61 7935.53,-1310.61"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp5 -->
<g id="edge2275" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp5</title>
<path fill="none" stroke="black" d="M5273.45,-1413.96C4752.61,-1402.6 3465.29,-1374.07 2387.42,-1346.6 1832.65,-1332.46 1185.54,-1314.09 815.21,-1303.39"/>
<polygon fill="black" stroke="black" points="815.25,-1299.89 805.15,-1303.1 815.05,-1306.89 815.25,-1299.89"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp6 -->
<g id="edge2277" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp6</title>
<path fill="none" stroke="black" d="M5747.78,-1417.04C6545.16,-1409.93 9115.69,-1384.57 9943.42,-1346.6 10086.34,-1340.04 10245.64,-1328.31 10375.04,-1317.65"/>
<polygon fill="black" stroke="black" points="10375.41,-1321.13 10385.09,-1316.81 10374.84,-1314.15 10375.41,-1321.13"/>
</g>
<!-- AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp7 -->
<g id="edge2279" class="edge">
<title>AR_exp_s1_l15&#45;&gt;ResMOE_s1_l15_tp7</title>
<path fill="none" stroke="black" d="M5746.75,-1415.65C6260.71,-1407.75 7515.03,-1385.85 8565.42,-1346.6 8820.68,-1337.06 9111.69,-1321.77 9317.19,-1310.23"/>
<polygon fill="black" stroke="black" points="9317.43,-1313.73 9327.21,-1309.67 9317.03,-1306.74 9317.43,-1313.73"/>
</g>
<!-- QKV_s1_l16_tp0 -->
<g id="node1367" class="node">
<title>QKV_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4556.42,-1204.6 4218.42,-1204.6 4218.42,-1151.6 4556.42,-1151.6 4556.42,-1204.6"/>
<text text-anchor="middle" x="4387.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4387.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4387.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp0 -->
<g id="edge2281" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M4987.85,-1253.76C4860.94,-1238.72 4714.94,-1221.16 4582.42,-1204.6 4577.26,-1203.95 4572.02,-1203.3 4566.74,-1202.63"/>
<polygon fill="black" stroke="black" points="4566.88,-1199.12 4556.52,-1201.33 4566,-1206.06 4566.88,-1199.12"/>
</g>
<!-- QKV_s1_l16_tp1 -->
<g id="node1368" class="node">
<title>QKV_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="4929.42,-1204.6 4591.42,-1204.6 4591.42,-1151.6 4929.42,-1151.6 4929.42,-1204.6"/>
<text text-anchor="middle" x="4760.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="4760.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4760.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp1 -->
<g id="edge2282" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M5063.78,-1240.58C5006.04,-1228.88 4946.98,-1216.91 4896.49,-1206.68"/>
<polygon fill="black" stroke="black" points="4897,-1203.21 4886.51,-1204.65 4895.61,-1210.07 4897,-1203.21"/>
</g>
<!-- QKV_s1_l16_tp2 -->
<g id="node1369" class="node">
<title>QKV_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="5310.42,-1204.6 4972.42,-1204.6 4972.42,-1151.6 5310.42,-1151.6 5310.42,-1204.6"/>
<text text-anchor="middle" x="5141.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5141.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5141.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp2 -->
<g id="edge2283" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5238.26,-1240.5C5221.82,-1230.08 5205.04,-1219.44 5190.18,-1210.01"/>
<polygon fill="black" stroke="black" points="5191.98,-1207.01 5181.66,-1204.61 5188.23,-1212.92 5191.98,-1207.01"/>
</g>
<!-- QKV_s1_l16_tp3 -->
<g id="node1370" class="node">
<title>QKV_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="5675.42,-1204.6 5337.42,-1204.6 5337.42,-1151.6 5675.42,-1151.6 5675.42,-1204.6"/>
<text text-anchor="middle" x="5506.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5506.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5506.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp3 -->
<g id="edge2284" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5405.8,-1240.5C5422.89,-1230.08 5440.31,-1219.44 5455.76,-1210.01"/>
<polygon fill="black" stroke="black" points="5457.9,-1212.81 5464.61,-1204.61 5454.25,-1206.83 5457.9,-1212.81"/>
</g>
<!-- QKV_s1_l16_tp4 -->
<g id="node1371" class="node">
<title>QKV_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="6056.42,-1204.6 5718.42,-1204.6 5718.42,-1151.6 6056.42,-1151.6 6056.42,-1204.6"/>
<text text-anchor="middle" x="5887.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="5887.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5887.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp4 -->
<g id="edge2285" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5538.83,-1248.88C5609.75,-1234.68 5686.42,-1219.34 5749.74,-1206.66"/>
<polygon fill="black" stroke="black" points="5750.67,-1210.04 5759.79,-1204.65 5749.3,-1203.18 5750.67,-1210.04"/>
</g>
<!-- QKV_s1_l16_tp5 -->
<g id="node1372" class="node">
<title>QKV_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="6442.42,-1204.6 6104.42,-1204.6 6104.42,-1151.6 6442.42,-1151.6 6442.42,-1204.6"/>
<text text-anchor="middle" x="6273.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6273.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6273.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp5 -->
<g id="edge2286" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M5559.93,-1264.58C5706.01,-1247.42 5896.52,-1224.93 6065.42,-1204.6 6074.81,-1203.47 6084.43,-1202.31 6094.14,-1201.13"/>
<polygon fill="black" stroke="black" points="6094.78,-1204.58 6104.29,-1199.9 6093.94,-1197.63 6094.78,-1204.58"/>
</g>
<!-- QKV_s1_l16_tp6 -->
<g id="node1373" class="node">
<title>QKV_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="6830.42,-1204.6 6492.42,-1204.6 6492.42,-1151.6 6830.42,-1151.6 6830.42,-1204.6"/>
<text text-anchor="middle" x="6661.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="6661.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6661.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp6 -->
<g id="edge2287" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M5560.39,-1264.73C5639.89,-1256.14 5728.89,-1247.21 5810.42,-1240.6 6094.83,-1217.54 6167.2,-1229.81 6451.42,-1204.6 6461.47,-1203.71 6471.78,-1202.71 6482.18,-1201.65"/>
<polygon fill="black" stroke="black" points="6482.59,-1205.13 6492.18,-1200.61 6481.87,-1198.17 6482.59,-1205.13"/>
</g>
<!-- QKV_s1_l16_tp7 -->
<g id="node1374" class="node">
<title>QKV_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="4166.42,-1204.6 3828.42,-1204.6 3828.42,-1151.6 4166.42,-1151.6 4166.42,-1204.6"/>
<text text-anchor="middle" x="3997.42" y="-1189.4" font-family="Times,serif" font-size="14.00">QKV_linear</text>
<text text-anchor="middle" x="3997.42" y="-1174.4" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="3997.42" y="-1159.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp7 -->
<g id="edge2288" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;QKV_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M5011.82,-1271.54C4788.71,-1255.49 4480.17,-1231.59 4209.42,-1204.6 4198.76,-1203.54 4187.8,-1202.39 4176.76,-1201.19"/>
<polygon fill="black" stroke="black" points="4176.91,-1197.68 4166.59,-1200.07 4176.15,-1204.64 4176.91,-1197.68"/>
</g>
<!-- ResAttn_s1_l16_tp0 -->
<g id="node1401" class="node">
<title>ResAttn_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4818.77,-626.69 4261.45,-626.69 4118.08,-520.69 4675.4,-520.69 4818.77,-626.69"/>
<text text-anchor="middle" x="4468.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4468.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4468.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp0 -->
<g id="edge2330" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M5008.14,-1269.03C4876.47,-1259.5 4721.53,-1248.84 4581.42,-1240.6 4496.81,-1235.62 3892.36,-1247.79 3819.42,-1204.6 3768.1,-1174.21 3749.42,-1149.75 3749.42,-1090.1 3749.42,-1090.1 3749.42,-1090.1 3749.42,-788.17 3749.42,-688.12 4008.5,-631.26 4215.62,-601.8"/>
<polygon fill="black" stroke="black" points="4216.34,-605.23 4225.75,-600.37 4215.36,-598.3 4216.34,-605.23"/>
</g>
<!-- ResAttn_s1_l16_tp1 -->
<g id="node1402" class="node">
<title>ResAttn_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2857.77,-626.69 2300.45,-626.69 2157.08,-520.69 2714.4,-520.69 2857.77,-626.69"/>
<text text-anchor="middle" x="2507.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2507.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2507.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp1 -->
<g id="edge2332" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M5006.4,-1267.67C4875.13,-1257.99 4720.96,-1247.57 4581.42,-1240.6 4040.97,-1213.6 3902.71,-1259.97 3364.42,-1204.6 3219.39,-1189.68 2718.42,-1235.89 2718.42,-1090.1 2718.42,-1090.1 2718.42,-1090.1 2718.42,-788.17 2718.42,-722.14 2666.72,-669.17 2614.5,-632.51"/>
<polygon fill="black" stroke="black" points="2616.35,-629.54 2606.13,-626.77 2612.4,-635.31 2616.35,-629.54"/>
</g>
<!-- ResAttn_s1_l16_tp2 -->
<g id="node1403" class="node">
<title>ResAttn_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="3705.77,-626.69 3148.45,-626.69 3005.08,-520.69 3562.4,-520.69 3705.77,-626.69"/>
<text text-anchor="middle" x="3355.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="3355.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3355.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp2 -->
<g id="edge2334" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5008.16,-1268.78C4876.49,-1259.22 4721.55,-1248.59 4581.42,-1240.6 4215.89,-1219.75 4119.86,-1263.03 3758.42,-1204.6 3574.61,-1174.89 3355.42,-1276.3 3355.42,-1090.1 3355.42,-1090.1 3355.42,-1090.1 3355.42,-788.17 3355.42,-737.33 3355.42,-679.67 3355.42,-637.1"/>
<polygon fill="black" stroke="black" points="3358.92,-636.89 3355.42,-626.89 3351.92,-636.89 3358.92,-636.89"/>
</g>
<!-- ResAttn_s1_l16_tp3 -->
<g id="node1404" class="node">
<title>ResAttn_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6738.77,-626.69 6181.45,-626.69 6038.08,-520.69 6595.4,-520.69 6738.77,-626.69"/>
<text text-anchor="middle" x="6388.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6388.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6388.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp3 -->
<g id="edge2336" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5559.07,-1263.85C5638.88,-1255.15 5728.39,-1246.38 5810.42,-1240.6 5867.48,-1236.58 6790.21,-1233.76 6839.42,-1204.6 6890.34,-1174.43 6907.42,-1149.29 6907.42,-1090.1 6907.42,-1090.1 6907.42,-1090.1 6907.42,-788.17 6907.42,-722.88 6765.15,-667.44 6629.59,-629.43"/>
<polygon fill="black" stroke="black" points="6630.41,-626.02 6619.84,-626.72 6628.54,-632.77 6630.41,-626.02"/>
</g>
<!-- ResAttn_s1_l16_tp4 -->
<g id="node1405" class="node">
<title>ResAttn_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7651.77,-626.69 7094.45,-626.69 6951.08,-520.69 7508.4,-520.69 7651.77,-626.69"/>
<text text-anchor="middle" x="7301.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="7301.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7301.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp4 -->
<g id="edge2338" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5559.06,-1263.78C5638.88,-1255.08 5728.39,-1246.32 5810.42,-1240.6 5976.53,-1229.01 7301.42,-1256.61 7301.42,-1090.1 7301.42,-1090.1 7301.42,-1090.1 7301.42,-788.17 7301.42,-737.33 7301.42,-679.67 7301.42,-637.1"/>
<polygon fill="black" stroke="black" points="7304.92,-636.89 7301.42,-626.89 7297.92,-636.89 7304.92,-636.89"/>
</g>
<!-- ResAttn_s1_l16_tp5 -->
<g id="node1406" class="node">
<title>ResAttn_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="1716.77,-626.69 1159.45,-626.69 1016.08,-520.69 1573.4,-520.69 1716.77,-626.69"/>
<text text-anchor="middle" x="1366.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="1366.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1366.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp5 -->
<g id="edge2340" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M5005.52,-1266.92C4874.46,-1257.15 4720.67,-1246.87 4581.42,-1240.6 4176.64,-1222.37 3161.29,-1247.94 2758.42,-1204.6 2496.74,-1176.45 2177.42,-1353.29 2177.42,-1090.1 2177.42,-1090.1 2177.42,-1090.1 2177.42,-788.17 2177.42,-682.37 1916.02,-627.89 1690.03,-600.57"/>
<polygon fill="black" stroke="black" points="1690.32,-597.08 1679.98,-599.37 1689.49,-604.03 1690.32,-597.08"/>
</g>
<!-- ResAttn_s1_l16_tp6 -->
<g id="node1407" class="node">
<title>ResAttn_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="9794.77,-626.69 9237.45,-626.69 9094.08,-520.69 9651.4,-520.69 9794.77,-626.69"/>
<text text-anchor="middle" x="9444.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9444.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9444.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp6 -->
<g id="edge2342" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M5558.09,-1263.29C5638.13,-1254.51 5728.04,-1245.84 5810.42,-1240.6 5958.64,-1231.18 8479.42,-1238.61 8479.42,-1090.1 8479.42,-1090.1 8479.42,-1090.1 8479.42,-788.17 8479.42,-646.36 8881.71,-598.68 9166.81,-582.69"/>
<polygon fill="black" stroke="black" points="9167.11,-586.18 9176.9,-582.14 9166.72,-579.19 9167.11,-586.18"/>
</g>
<!-- ResAttn_s1_l16_tp7 -->
<g id="node1408" class="node">
<title>ResAttn_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="8645.77,-626.69 8088.45,-626.69 7945.08,-520.69 8502.4,-520.69 8645.77,-626.69"/>
<text text-anchor="middle" x="8295.42" y="-584.99" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8295.42" y="-569.99" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8295.42" y="-554.99" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp7 -->
<g id="edge2344" class="edge">
<title>ResMOE_s1_l15_tp0&#45;&gt;ResAttn_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M5558.74,-1263.56C5638.62,-1254.82 5728.27,-1246.11 5810.42,-1240.6 6377.38,-1202.59 6522.06,-1250.59 7088.42,-1204.6 7278.39,-1189.17 7938.42,-1280.7 7938.42,-1090.1 7938.42,-1090.1 7938.42,-1090.1 7938.42,-788.17 7938.42,-710.26 8001.83,-660.1 8075.19,-628.14"/>
<polygon fill="black" stroke="black" points="8076.81,-631.26 8084.66,-624.14 8074.08,-624.81 8076.81,-631.26"/>
</g>
<!-- SplitHeads_s1_l16_tp0 -->
<g id="node1375" class="node">
<title>SplitHeads_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4539.42,-1115.6 4167.42,-1115.6 4167.42,-1062.6 4539.42,-1062.6 4539.42,-1115.6"/>
<text text-anchor="middle" x="4353.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4353.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4353.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp0&#45;&gt;SplitHeads_s1_l16_tp0 -->
<g id="edge2289" class="edge">
<title>QKV_s1_l16_tp0&#45;&gt;SplitHeads_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M4377.41,-1151.47C4374.22,-1143.31 4370.63,-1134.14 4367.23,-1125.42"/>
<polygon fill="black" stroke="black" points="4370.39,-1123.89 4363.49,-1115.85 4363.87,-1126.44 4370.39,-1123.89"/>
</g>
<!-- SplitHeads_s1_l16_tp1 -->
<g id="node1376" class="node">
<title>SplitHeads_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="4929.42,-1115.6 4557.42,-1115.6 4557.42,-1062.6 4929.42,-1062.6 4929.42,-1115.6"/>
<text text-anchor="middle" x="4743.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="4743.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4743.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp1&#45;&gt;SplitHeads_s1_l16_tp1 -->
<g id="edge2290" class="edge">
<title>QKV_s1_l16_tp1&#45;&gt;SplitHeads_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M4755.41,-1151.47C4753.84,-1143.4 4752.07,-1134.34 4750.38,-1125.7"/>
<polygon fill="black" stroke="black" points="4753.81,-1124.99 4748.45,-1115.85 4746.94,-1126.34 4753.81,-1124.99"/>
</g>
<!-- SplitHeads_s1_l16_tp2 -->
<g id="node1377" class="node">
<title>SplitHeads_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="5319.42,-1115.6 4947.42,-1115.6 4947.42,-1062.6 5319.42,-1062.6 5319.42,-1115.6"/>
<text text-anchor="middle" x="5133.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5133.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5133.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp2&#45;&gt;SplitHeads_s1_l16_tp2 -->
<g id="edge2291" class="edge">
<title>QKV_s1_l16_tp2&#45;&gt;SplitHeads_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5139.07,-1151.47C5138.33,-1143.49 5137.51,-1134.53 5136.72,-1125.98"/>
<polygon fill="black" stroke="black" points="5140.19,-1125.49 5135.79,-1115.85 5133.22,-1126.13 5140.19,-1125.49"/>
</g>
<!-- SplitHeads_s1_l16_tp3 -->
<g id="node1378" class="node">
<title>SplitHeads_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="5709.42,-1115.6 5337.42,-1115.6 5337.42,-1062.6 5709.42,-1062.6 5709.42,-1115.6"/>
<text text-anchor="middle" x="5523.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5523.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5523.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp3&#45;&gt;SplitHeads_s1_l16_tp3 -->
<g id="edge2292" class="edge">
<title>QKV_s1_l16_tp3&#45;&gt;SplitHeads_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5511.43,-1151.47C5513.01,-1143.4 5514.78,-1134.34 5516.47,-1125.7"/>
<polygon fill="black" stroke="black" points="5519.91,-1126.34 5518.39,-1115.85 5513.04,-1124.99 5519.91,-1126.34"/>
</g>
<!-- SplitHeads_s1_l16_tp4 -->
<g id="node1379" class="node">
<title>SplitHeads_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="6099.42,-1115.6 5727.42,-1115.6 5727.42,-1062.6 6099.42,-1062.6 6099.42,-1115.6"/>
<text text-anchor="middle" x="5913.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="5913.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5913.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp4&#45;&gt;SplitHeads_s1_l16_tp4 -->
<g id="edge2293" class="edge">
<title>QKV_s1_l16_tp4&#45;&gt;SplitHeads_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5895.08,-1151.47C5897.49,-1143.4 5900.2,-1134.34 5902.78,-1125.7"/>
<polygon fill="black" stroke="black" points="5906.22,-1126.43 5905.73,-1115.85 5899.51,-1124.43 5906.22,-1126.43"/>
</g>
<!-- SplitHeads_s1_l16_tp5 -->
<g id="node1380" class="node">
<title>SplitHeads_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="6489.42,-1115.6 6117.42,-1115.6 6117.42,-1062.6 6489.42,-1062.6 6489.42,-1115.6"/>
<text text-anchor="middle" x="6303.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6303.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6303.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp5&#45;&gt;SplitHeads_s1_l16_tp5 -->
<g id="edge2294" class="edge">
<title>QKV_s1_l16_tp5&#45;&gt;SplitHeads_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M6282.26,-1151.47C6285.07,-1143.31 6288.24,-1134.14 6291.24,-1125.42"/>
<polygon fill="black" stroke="black" points="6294.59,-1126.44 6294.54,-1115.85 6287.97,-1124.16 6294.59,-1126.44"/>
</g>
<!-- SplitHeads_s1_l16_tp6 -->
<g id="node1381" class="node">
<title>SplitHeads_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="6879.42,-1115.6 6507.42,-1115.6 6507.42,-1062.6 6879.42,-1062.6 6879.42,-1115.6"/>
<text text-anchor="middle" x="6693.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="6693.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6693.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp6&#45;&gt;SplitHeads_s1_l16_tp6 -->
<g id="edge2295" class="edge">
<title>QKV_s1_l16_tp6&#45;&gt;SplitHeads_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M6670.85,-1151.47C6673.85,-1143.31 6677.22,-1134.14 6680.43,-1125.42"/>
<polygon fill="black" stroke="black" points="6683.78,-1126.44 6683.95,-1115.85 6677.21,-1124.03 6683.78,-1126.44"/>
</g>
<!-- SplitHeads_s1_l16_tp7 -->
<g id="node1382" class="node">
<title>SplitHeads_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="4149.42,-1115.6 3777.42,-1115.6 3777.42,-1062.6 4149.42,-1062.6 4149.42,-1115.6"/>
<text text-anchor="middle" x="3963.42" y="-1100.4" font-family="Times,serif" font-size="14.00">SplitHeads</text>
<text text-anchor="middle" x="3963.42" y="-1085.4" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="3963.42" y="-1070.4" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- QKV_s1_l16_tp7&#45;&gt;SplitHeads_s1_l16_tp7 -->
<g id="edge2296" class="edge">
<title>QKV_s1_l16_tp7&#45;&gt;SplitHeads_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M3987.41,-1151.47C3984.22,-1143.31 3980.63,-1134.14 3977.23,-1125.42"/>
<polygon fill="black" stroke="black" points="3980.39,-1123.89 3973.49,-1115.85 3973.87,-1126.44 3980.39,-1123.89"/>
</g>
<!-- A2A_s1_l16 -->
<g id="node1383" class="node">
<title>A2A_s1_l16</title>
<ellipse fill="none" stroke="black" cx="5328.42" cy="-989.12" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5328.42" y="-1000.42" font-family="Times,serif" font-size="14.00">AllToAll</text>
<text text-anchor="middle" x="5328.42" y="-985.42" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5328.42" y="-970.42" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- SplitHeads_s1_l16_tp0&#45;&gt;A2A_s1_l16 -->
<g id="edge2297" class="edge">
<title>SplitHeads_s1_l16_tp0&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M4539.45,-1063.62C4542.46,-1063.27 4545.45,-1062.93 4548.42,-1062.6 4731.43,-1042.14 4939.05,-1023.05 5094.05,-1009.6"/>
<polygon fill="black" stroke="black" points="5094.53,-1013.07 5104.19,-1008.72 5093.92,-1006.1 5094.53,-1013.07"/>
</g>
<!-- SplitHeads_s1_l16_tp1&#45;&gt;A2A_s1_l16 -->
<g id="edge2298" class="edge">
<title>SplitHeads_s1_l16_tp1&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M4895.98,-1062.55C4974.22,-1049.45 5069.93,-1033.42 5151.41,-1019.77"/>
<polygon fill="black" stroke="black" points="5151.99,-1023.22 5161.27,-1018.12 5150.83,-1016.32 5151.99,-1023.22"/>
</g>
<!-- SplitHeads_s1_l16_tp2&#45;&gt;A2A_s1_l16 -->
<g id="edge2299" class="edge">
<title>SplitHeads_s1_l16_tp2&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M5184.4,-1062.49C5204.24,-1052.52 5227.43,-1040.87 5249.33,-1029.86"/>
<polygon fill="black" stroke="black" points="5250.94,-1032.97 5258.3,-1025.35 5247.8,-1026.72 5250.94,-1032.97"/>
</g>
<!-- SplitHeads_s1_l16_tp3&#45;&gt;A2A_s1_l16 -->
<g id="edge2300" class="edge">
<title>SplitHeads_s1_l16_tp3&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M5472.44,-1062.49C5452.61,-1052.52 5429.42,-1040.87 5407.51,-1029.86"/>
<polygon fill="black" stroke="black" points="5409.05,-1026.72 5398.54,-1025.35 5405.91,-1032.97 5409.05,-1026.72"/>
</g>
<!-- SplitHeads_s1_l16_tp4&#45;&gt;A2A_s1_l16 -->
<g id="edge2301" class="edge">
<title>SplitHeads_s1_l16_tp4&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M5760.87,-1062.55C5682.63,-1049.45 5586.91,-1033.42 5505.44,-1019.77"/>
<polygon fill="black" stroke="black" points="5506.02,-1016.32 5495.58,-1018.12 5504.86,-1023.22 5506.02,-1016.32"/>
</g>
<!-- SplitHeads_s1_l16_tp5&#45;&gt;A2A_s1_l16 -->
<g id="edge2302" class="edge">
<title>SplitHeads_s1_l16_tp5&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M6117.4,-1063.62C6114.39,-1063.27 6111.39,-1062.93 6108.42,-1062.6 5925.42,-1042.14 5717.79,-1023.05 5562.79,-1009.6"/>
<polygon fill="black" stroke="black" points="5562.92,-1006.1 5552.66,-1008.72 5562.32,-1013.07 5562.92,-1006.1"/>
</g>
<!-- SplitHeads_s1_l16_tp6&#45;&gt;A2A_s1_l16 -->
<g id="edge2303" class="edge">
<title>SplitHeads_s1_l16_tp6&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M6507.41,-1063.49C6504.39,-1063.18 6501.4,-1062.89 6498.42,-1062.6 6186.38,-1032.57 5826.25,-1012.44 5588.88,-1001.16"/>
<polygon fill="black" stroke="black" points="5588.88,-997.66 5578.73,-1000.68 5588.55,-1004.65 5588.88,-997.66"/>
</g>
<!-- SplitHeads_s1_l16_tp7&#45;&gt;A2A_s1_l16 -->
<g id="edge2304" class="edge">
<title>SplitHeads_s1_l16_tp7&#45;&gt;A2A_s1_l16</title>
<path fill="none" stroke="black" d="M4149.43,-1063.49C4152.45,-1063.18 4155.45,-1062.89 4158.42,-1062.6 4470.47,-1032.57 4830.6,-1012.44 5067.96,-1001.16"/>
<polygon fill="black" stroke="black" points="5068.29,-1004.65 5078.12,-1000.68 5067.96,-997.66 5068.29,-1004.65"/>
</g>
<!-- Attn_s1_l16_tp0 -->
<g id="node1384" class="node">
<title>Attn_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4539.42,-915.65 4167.42,-915.65 4167.42,-862.65 4539.42,-862.65 4539.42,-915.65"/>
<text text-anchor="middle" x="4353.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4353.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4353.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp0 -->
<g id="edge2305" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M5104.19,-969.52C4950.85,-956.27 4742.7,-937.22 4549.51,-915.75"/>
<polygon fill="black" stroke="black" points="4549.77,-912.26 4539.45,-914.63 4549,-919.22 4549.77,-912.26"/>
</g>
<!-- Attn_s1_l16_tp1 -->
<g id="node1385" class="node">
<title>Attn_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="4929.42,-915.65 4557.42,-915.65 4557.42,-862.65 4929.42,-862.65 4929.42,-915.65"/>
<text text-anchor="middle" x="4743.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4743.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="4743.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp1 -->
<g id="edge2306" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M5161.18,-960.11C5081.03,-946.69 4985.42,-930.68 4905.9,-917.36"/>
<polygon fill="black" stroke="black" points="4906.23,-913.86 4895.79,-915.66 4905.07,-920.77 4906.23,-913.86"/>
</g>
<!-- Attn_s1_l16_tp2 -->
<g id="node1386" class="node">
<title>Attn_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="5319.42,-915.65 4947.42,-915.65 4947.42,-862.65 5319.42,-862.65 5319.42,-915.65"/>
<text text-anchor="middle" x="5133.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5133.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5133.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp2 -->
<g id="edge2307" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5258.3,-952.89C5236.99,-942.19 5213.79,-930.53 5193.23,-920.2"/>
<polygon fill="black" stroke="black" points="5194.8,-917.07 5184.29,-915.71 5191.65,-923.32 5194.8,-917.07"/>
</g>
<!-- Attn_s1_l16_tp3 -->
<g id="node1387" class="node">
<title>Attn_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="5709.42,-915.65 5337.42,-915.65 5337.42,-862.65 5709.42,-862.65 5709.42,-915.65"/>
<text text-anchor="middle" x="5523.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5523.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5523.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp3 -->
<g id="edge2308" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5398.55,-952.89C5419.85,-942.19 5443.06,-930.53 5463.62,-920.2"/>
<polygon fill="black" stroke="black" points="5465.19,-923.32 5472.55,-915.71 5462.05,-917.07 5465.19,-923.32"/>
</g>
<!-- Attn_s1_l16_tp4 -->
<g id="node1388" class="node">
<title>Attn_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="6099.42,-915.65 5727.42,-915.65 5727.42,-862.65 6099.42,-862.65 6099.42,-915.65"/>
<text text-anchor="middle" x="5913.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5913.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5913.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp4 -->
<g id="edge2309" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5495.67,-960.11C5575.81,-946.69 5671.43,-930.68 5750.95,-917.36"/>
<polygon fill="black" stroke="black" points="5751.77,-920.77 5761.06,-915.66 5750.62,-913.86 5751.77,-920.77"/>
</g>
<!-- Attn_s1_l16_tp5 -->
<g id="node1389" class="node">
<title>Attn_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="6489.42,-915.65 6117.42,-915.65 6117.42,-862.65 6489.42,-862.65 6489.42,-915.65"/>
<text text-anchor="middle" x="6303.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6303.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6303.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp5 -->
<g id="edge2310" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M5552.66,-969.52C5706,-956.27 5914.14,-937.22 6107.34,-915.75"/>
<polygon fill="black" stroke="black" points="6107.85,-919.22 6117.4,-914.63 6107.07,-912.26 6107.85,-919.22"/>
</g>
<!-- Attn_s1_l16_tp6 -->
<g id="node1390" class="node">
<title>Attn_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="6879.42,-915.65 6507.42,-915.65 6507.42,-862.65 6879.42,-862.65 6879.42,-915.65"/>
<text text-anchor="middle" x="6693.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6693.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6693.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp6 -->
<g id="edge2311" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M5578.73,-977.56C5813.46,-966.5 6174.4,-946.53 6497.39,-915.72"/>
<polygon fill="black" stroke="black" points="6497.79,-919.2 6507.41,-914.76 6497.12,-912.23 6497.79,-919.2"/>
</g>
<!-- Attn_s1_l16_tp7 -->
<g id="node1391" class="node">
<title>Attn_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="4149.42,-915.65 3777.42,-915.65 3777.42,-862.65 4149.42,-862.65 4149.42,-915.65"/>
<text text-anchor="middle" x="3963.42" y="-900.45" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3963.42" y="-885.45" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="3963.42" y="-870.45" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- A2A_s1_l16&#45;&gt;Attn_s1_l16_tp7 -->
<g id="edge2312" class="edge">
<title>A2A_s1_l16&#45;&gt;Attn_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M5078.12,-977.56C4843.38,-966.5 4482.44,-946.53 4159.46,-915.72"/>
<polygon fill="black" stroke="black" points="4159.72,-912.23 4149.43,-914.76 4159.05,-919.2 4159.72,-912.23"/>
</g>
<!-- AR_attn_s1_l16 -->
<g id="node1392" class="node">
<title>AR_attn_s1_l16</title>
<ellipse fill="none" stroke="black" cx="5286.42" cy="-789.17" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="5286.42" y="-800.47" font-family="Times,serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="5286.42" y="-785.47" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5286.42" y="-770.47" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,heads=16,d_k=64]</text>
</g>
<!-- Attn_s1_l16_tp0&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2313" class="edge">
<title>Attn_s1_l16_tp0&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M4539.45,-863.68C4542.46,-863.33 4545.45,-862.99 4548.42,-862.65 4718.62,-843.17 4911.28,-824.35 5057.07,-810.78"/>
<polygon fill="black" stroke="black" points="5057.41,-814.26 5067.04,-809.85 5056.76,-807.29 5057.41,-814.26"/>
</g>
<!-- Attn_s1_l16_tp1&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2314" class="edge">
<title>Attn_s1_l16_tp1&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M4885.03,-862.6C4955.85,-849.82 5042.1,-834.25 5116.47,-820.84"/>
<polygon fill="black" stroke="black" points="5117.2,-824.26 5126.41,-819.04 5115.95,-817.37 5117.2,-824.26"/>
</g>
<!-- Attn_s1_l16_tp2&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2315" class="edge">
<title>Attn_s1_l16_tp2&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M5173.62,-862.4C5188.47,-852.89 5205.7,-841.86 5222.16,-831.32"/>
<polygon fill="black" stroke="black" points="5224.14,-834.21 5230.68,-825.87 5220.37,-828.31 5224.14,-834.21"/>
</g>
<!-- Attn_s1_l16_tp3&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2316" class="edge">
<title>Attn_s1_l16_tp3&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M5461.46,-862.53C5436.56,-852.24 5407.3,-840.14 5379.91,-828.82"/>
<polygon fill="black" stroke="black" points="5380.89,-825.44 5370.31,-824.85 5378.22,-831.91 5380.89,-825.44"/>
</g>
<!-- Attn_s1_l16_tp4&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2317" class="edge">
<title>Attn_s1_l16_tp4&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M5749.91,-862.6C5664.14,-849.19 5558.77,-832.73 5470.18,-818.89"/>
<polygon fill="black" stroke="black" points="5470.71,-815.43 5460.29,-817.34 5469.63,-822.34 5470.71,-815.43"/>
</g>
<!-- Attn_s1_l16_tp5&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2318" class="edge">
<title>Attn_s1_l16_tp5&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M6117.4,-863.64C6114.39,-863.3 6111.39,-862.97 6108.42,-862.65 5912.44,-841.2 5689.62,-821.87 5525.45,-808.57"/>
<polygon fill="black" stroke="black" points="5525.47,-805.06 5515.22,-807.75 5524.91,-812.04 5525.47,-805.06"/>
</g>
<!-- Attn_s1_l16_tp6&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2319" class="edge">
<title>Attn_s1_l16_tp6&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M6507.41,-863.53C6504.4,-863.22 6501.4,-862.93 6498.42,-862.65 6171.79,-831.56 5794.29,-811.48 5548.53,-800.52"/>
<polygon fill="black" stroke="black" points="5548.53,-797.02 5538.39,-800.07 5548.22,-804.01 5548.53,-797.02"/>
</g>
<!-- Attn_s1_l16_tp7&#45;&gt;AR_attn_s1_l16 -->
<g id="edge2320" class="edge">
<title>Attn_s1_l16_tp7&#45;&gt;AR_attn_s1_l16</title>
<path fill="none" stroke="black" d="M4149.43,-863.54C4152.45,-863.24 4155.45,-862.94 4158.42,-862.65 4455.88,-833.67 4798.64,-813.52 5027.52,-801.95"/>
<polygon fill="black" stroke="black" points="5027.84,-805.44 5037.66,-801.44 5027.49,-798.45 5027.84,-805.44"/>
</g>
<!-- O_s1_l16_tp0 -->
<g id="node1393" class="node">
<title>O_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4840.42,-715.69 4502.42,-715.69 4502.42,-662.69 4840.42,-662.69 4840.42,-715.69"/>
<text text-anchor="middle" x="4671.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4671.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4671.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp0 -->
<g id="edge2321" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M5114.29,-760.75C5029.1,-747.17 4926.58,-730.84 4841.64,-717.31"/>
<polygon fill="black" stroke="black" points="4842.06,-713.83 4831.64,-715.72 4840.96,-720.75 4842.06,-713.83"/>
</g>
<!-- O_s1_l16_tp1 -->
<g id="node1394" class="node">
<title>O_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="3721.42,-715.69 3383.42,-715.69 3383.42,-662.69 3721.42,-662.69 3721.42,-715.69"/>
<text text-anchor="middle" x="3552.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3552.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3552.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp1 -->
<g id="edge2322" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M5040.94,-775.67C4772.19,-761.81 4328.56,-738.39 3946.42,-715.69 3876.29,-711.53 3799.17,-706.61 3731.89,-702.21"/>
<polygon fill="black" stroke="black" points="3731.81,-698.7 3721.61,-701.54 3731.36,-705.68 3731.81,-698.7"/>
</g>
<!-- O_s1_l16_tp2 -->
<g id="node1395" class="node">
<title>O_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="4293.42,-715.69 3955.42,-715.69 3955.42,-662.69 4293.42,-662.69 4293.42,-715.69"/>
<text text-anchor="middle" x="4124.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="4124.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4124.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp2 -->
<g id="edge2323" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5063.07,-769.34C4842.16,-750.71 4508.35,-722.56 4304.04,-705.34"/>
<polygon fill="black" stroke="black" points="4304.07,-701.83 4293.81,-704.48 4303.48,-708.8 4304.07,-701.83"/>
</g>
<!-- O_s1_l16_tp3 -->
<g id="node1396" class="node">
<title>O_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="5608.42,-715.69 5270.42,-715.69 5270.42,-662.69 5608.42,-662.69 5608.42,-715.69"/>
<text text-anchor="middle" x="5439.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="5439.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5439.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp3 -->
<g id="edge2324" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5342.09,-752.52C5358.1,-742.27 5375.42,-731.18 5390.95,-721.23"/>
<polygon fill="black" stroke="black" points="5392.84,-724.18 5399.38,-715.84 5389.07,-718.28 5392.84,-724.18"/>
</g>
<!-- O_s1_l16_tp4 -->
<g id="node1397" class="node">
<title>O_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="6574.42,-715.69 6236.42,-715.69 6236.42,-662.69 6574.42,-662.69 6574.42,-715.69"/>
<text text-anchor="middle" x="6405.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="6405.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6405.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp4 -->
<g id="edge2325" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5507.5,-768.81C5718.01,-750.38 6030.9,-722.99 6226.28,-705.88"/>
<polygon fill="black" stroke="black" points="6226.7,-709.36 6236.36,-705 6226.09,-702.38 6226.7,-709.36"/>
</g>
<!-- O_s1_l16_tp5 -->
<g id="node1398" class="node">
<title>O_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="3246.42,-715.69 2908.42,-715.69 2908.42,-662.69 3246.42,-662.69 3246.42,-715.69"/>
<text text-anchor="middle" x="3077.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="3077.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3077.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp5 -->
<g id="edge2326" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M5027.61,-782.28C4659.89,-773.02 3965.2,-752.23 3374.42,-715.69 3336.37,-713.34 3295.63,-710.23 3256.89,-706.99"/>
<polygon fill="black" stroke="black" points="3256.81,-703.47 3246.55,-706.12 3256.22,-710.45 3256.81,-703.47"/>
</g>
<!-- O_s1_l16_tp6 -->
<g id="node1399" class="node">
<title>O_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="7829.42,-715.69 7491.42,-715.69 7491.42,-662.69 7829.42,-662.69 7829.42,-715.69"/>
<text text-anchor="middle" x="7660.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7660.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="7660.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp6 -->
<g id="edge2327" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M5543.73,-781.38C5924,-770.77 6658.45,-748.06 7282.42,-715.69 7347.27,-712.33 7418.31,-707.77 7481.13,-703.43"/>
<polygon fill="black" stroke="black" points="7481.4,-706.92 7491.14,-702.74 7480.92,-699.94 7481.4,-706.92"/>
</g>
<!-- O_s1_l16_tp7 -->
<g id="node1400" class="node">
<title>O_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="7273.42,-715.69 6935.42,-715.69 6935.42,-662.69 7273.42,-662.69 7273.42,-715.69"/>
<text text-anchor="middle" x="7104.42" y="-700.49" font-family="Times,serif" font-size="14.00">O_linear</text>
<text text-anchor="middle" x="7104.42" y="-685.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="7104.42" y="-670.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- AR_attn_s1_l16&#45;&gt;O_s1_l16_tp7 -->
<g id="edge2328" class="edge">
<title>AR_attn_s1_l16&#45;&gt;O_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M5530.19,-775.03C5900.83,-755.06 6597.57,-717.51 6925.35,-699.84"/>
<polygon fill="black" stroke="black" points="6925.62,-703.33 6935.42,-699.3 6925.24,-696.34 6925.62,-703.33"/>
</g>
<!-- O_s1_l16_tp0&#45;&gt;ResAttn_s1_l16_tp0 -->
<g id="edge2329" class="edge">
<title>O_s1_l16_tp0&#45;&gt;ResAttn_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M4625.61,-662.58C4609.18,-653.4 4589.94,-642.63 4570.65,-631.85"/>
<polygon fill="black" stroke="black" points="4572.24,-628.73 4561.8,-626.9 4568.82,-634.84 4572.24,-628.73"/>
</g>
<!-- O_s1_l16_tp1&#45;&gt;ResAttn_s1_l16_tp1 -->
<g id="edge2331" class="edge">
<title>O_s1_l16_tp1&#45;&gt;ResAttn_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M3383.36,-669.83C3238.58,-654.11 3025.64,-630.98 2845.97,-611.46"/>
<polygon fill="black" stroke="black" points="2846.14,-607.96 2835.82,-610.36 2845.38,-614.92 2846.14,-607.96"/>
</g>
<!-- O_s1_l16_tp2&#45;&gt;ResAttn_s1_l16_tp2 -->
<g id="edge2333" class="edge">
<title>O_s1_l16_tp2&#45;&gt;ResAttn_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M3955.19,-663.22C3884.36,-652.76 3799.16,-640.19 3715.5,-627.84"/>
<polygon fill="black" stroke="black" points="3715.98,-624.37 3705.58,-626.37 3714.96,-631.3 3715.98,-624.37"/>
</g>
<!-- O_s1_l16_tp3&#45;&gt;ResAttn_s1_l16_tp3 -->
<g id="edge2335" class="edge">
<title>O_s1_l16_tp3&#45;&gt;ResAttn_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5608.54,-667.97C5756.14,-650.31 5972.28,-624.46 6139.61,-604.45"/>
<polygon fill="black" stroke="black" points="6140.04,-607.93 6149.55,-603.26 6139.21,-600.97 6140.04,-607.93"/>
</g>
<!-- O_s1_l16_tp4&#45;&gt;ResAttn_s1_l16_tp4 -->
<g id="edge2337" class="edge">
<title>O_s1_l16_tp4&#45;&gt;ResAttn_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M6574.48,-666.78C6709.95,-649.62 6901.95,-625.3 7054.61,-605.96"/>
<polygon fill="black" stroke="black" points="7055.13,-609.42 7064.61,-604.69 7054.25,-602.48 7055.13,-609.42"/>
</g>
<!-- O_s1_l16_tp5&#45;&gt;ResAttn_s1_l16_tp5 -->
<g id="edge2339" class="edge">
<title>O_s1_l16_tp5&#45;&gt;ResAttn_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M2908.32,-677.01C2722.14,-664.7 2413.93,-644.31 2148.42,-626.69 1995.79,-616.57 1826.39,-605.31 1684.4,-595.86"/>
<polygon fill="black" stroke="black" points="1684.43,-592.35 1674.22,-595.18 1683.97,-599.34 1684.43,-592.35"/>
</g>
<!-- O_s1_l16_tp6&#45;&gt;ResAttn_s1_l16_tp6 -->
<g id="edge2341" class="edge">
<title>O_s1_l16_tp6&#45;&gt;ResAttn_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M7829.72,-677.92C8027.55,-665.87 8364.76,-645.19 8654.42,-626.69 8829.58,-615.51 9026.56,-602.55 9180.01,-592.36"/>
<polygon fill="black" stroke="black" points="9180.31,-595.85 9190.06,-591.69 9179.85,-588.86 9180.31,-595.85"/>
</g>
<!-- O_s1_l16_tp7&#45;&gt;ResAttn_s1_l16_tp7 -->
<g id="edge2343" class="edge">
<title>O_s1_l16_tp7&#45;&gt;ResAttn_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M7273.48,-672.08C7473.29,-653.04 7807.83,-621.16 8039.45,-599.09"/>
<polygon fill="black" stroke="black" points="8040.09,-602.54 8049.71,-598.11 8039.42,-595.57 8040.09,-602.54"/>
</g>
<!-- Gate_s1_l16_tp0 -->
<g id="node1409" class="node">
<title>Gate_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4733.42,-484.69 4395.42,-484.69 4395.42,-431.69 4733.42,-431.69 4733.42,-484.69"/>
<text text-anchor="middle" x="4564.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4564.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4564.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp0&#45;&gt;Gate_s1_l16_tp0 -->
<g id="edge2345" class="edge">
<title>ResAttn_s1_l16_tp0&#45;&gt;Gate_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M4512.49,-520.59C4520.56,-511.05 4528.79,-501.32 4536.24,-492.51"/>
<polygon fill="black" stroke="black" points="4539.06,-494.6 4542.84,-484.71 4533.71,-490.08 4539.06,-494.6"/>
</g>
<!-- ResMOE_s1_l16_tp0 -->
<g id="node1450" class="node">
<title>ResMOE_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="5507.77,-195.74 4950.45,-195.74 4807.08,-89.74 5364.4,-89.74 5507.77,-195.74"/>
<text text-anchor="middle" x="5157.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="5157.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5157.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp0&#45;&gt;ResMOE_s1_l16_tp0 -->
<g id="edge2418" class="edge">
<title>ResAttn_s1_l16_tp0&#45;&gt;ResMOE_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M4153.61,-547C4018.49,-537 3858.8,-526.56 3714.42,-520.69 3067.35,-494.4 1446.18,-533.6 800.42,-484.69 511.19,-462.79 -38.11,-551.31 163.42,-342.69 327.76,-172.58 4182.22,-208.13 4418.42,-195.74 4577.25,-187.41 4755.06,-175 4896.46,-164.39"/>
<polygon fill="black" stroke="black" points="4896.87,-167.87 4906.58,-163.63 4896.35,-160.88 4896.87,-167.87"/>
</g>
<!-- Gate_s1_l16_tp1 -->
<g id="node1410" class="node">
<title>Gate_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2451.42,-484.69 2113.42,-484.69 2113.42,-431.69 2451.42,-431.69 2451.42,-484.69"/>
<text text-anchor="middle" x="2282.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2282.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2282.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp1&#45;&gt;Gate_s1_l16_tp1 -->
<g id="edge2346" class="edge">
<title>ResAttn_s1_l16_tp1&#45;&gt;Gate_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M2404.14,-520.59C2382.9,-509.88 2361.21,-498.94 2342.14,-489.32"/>
<polygon fill="black" stroke="black" points="2343.5,-486.09 2333,-484.71 2340.35,-492.34 2343.5,-486.09"/>
</g>
<!-- ResMOE_s1_l16_tp1 -->
<g id="node1451" class="node">
<title>ResMOE_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2933.77,-195.74 2376.45,-195.74 2233.08,-89.74 2790.4,-89.74 2933.77,-195.74"/>
<text text-anchor="middle" x="2583.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="2583.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2583.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp1&#45;&gt;ResMOE_s1_l16_tp1 -->
<g id="edge2420" class="edge">
<title>ResAttn_s1_l16_tp1&#45;&gt;ResMOE_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M2194.62,-548.71C2051.65,-538.56 1880.04,-527.54 1725.42,-520.69 1680.09,-518.69 124.15,-517.13 92.42,-484.69 53.12,-444.51 53.38,-272.18 92.42,-231.74 111.44,-212.04 1659.01,-168.44 2305.01,-151.08"/>
<polygon fill="black" stroke="black" points="2305.49,-154.57 2315.4,-150.8 2305.31,-147.57 2305.49,-154.57"/>
</g>
<!-- Gate_s1_l16_tp2 -->
<g id="node1411" class="node">
<title>Gate_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="3524.42,-484.69 3186.42,-484.69 3186.42,-431.69 3524.42,-431.69 3524.42,-484.69"/>
<text text-anchor="middle" x="3355.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3355.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3355.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp2&#45;&gt;Gate_s1_l16_tp2 -->
<g id="edge2347" class="edge">
<title>ResAttn_s1_l16_tp2&#45;&gt;Gate_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M3355.42,-520.59C3355.42,-511.92 3355.42,-503.11 3355.42,-494.96"/>
<polygon fill="black" stroke="black" points="3358.92,-494.71 3355.42,-484.71 3351.92,-494.71 3358.92,-494.71"/>
</g>
<!-- ResMOE_s1_l16_tp2 -->
<g id="node1452" class="node">
<title>ResMOE_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="4409.77,-195.74 3852.45,-195.74 3709.08,-89.74 4266.4,-89.74 4409.77,-195.74"/>
<text text-anchor="middle" x="4059.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="4059.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="4059.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp2&#45;&gt;ResMOE_s1_l16_tp2 -->
<g id="edge2422" class="edge">
<title>ResAttn_s1_l16_tp2&#45;&gt;ResMOE_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M3021.7,-533.03C2969.78,-528.07 2916.7,-523.69 2866.42,-520.69 2828.35,-518.42 147.22,-511.84 120.42,-484.69 110.03,-474.16 110.76,-368.03 123.42,-342.69 158.62,-272.3 187.37,-258.38 261.42,-231.74 401.59,-181.32 2793.53,-200.2 2942.42,-195.74 3232.69,-187.04 3565.13,-170.75 3791.34,-158.71"/>
<polygon fill="black" stroke="black" points="3791.56,-162.21 3801.36,-158.18 3791.18,-155.22 3791.56,-162.21"/>
</g>
<!-- Gate_s1_l16_tp3 -->
<g id="node1412" class="node">
<title>Gate_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6363.42,-484.69 6025.42,-484.69 6025.42,-431.69 6363.42,-431.69 6363.42,-484.69"/>
<text text-anchor="middle" x="6194.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6194.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6194.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp3&#45;&gt;Gate_s1_l16_tp3 -->
<g id="edge2348" class="edge">
<title>ResAttn_s1_l16_tp3&#45;&gt;Gate_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M6299.37,-520.59C6281.39,-510.07 6263.03,-499.33 6246.81,-489.84"/>
<polygon fill="black" stroke="black" points="6248.43,-486.74 6238.03,-484.71 6244.9,-492.78 6248.43,-486.74"/>
</g>
<!-- ResMOE_s1_l16_tp3 -->
<g id="node1453" class="node">
<title>ResMOE_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6356.77,-195.74 5799.45,-195.74 5656.08,-89.74 6213.4,-89.74 6356.77,-195.74"/>
<text text-anchor="middle" x="6006.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="6006.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6006.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp3&#45;&gt;ResMOE_s1_l16_tp3 -->
<g id="edge2424" class="edge">
<title>ResAttn_s1_l16_tp3&#45;&gt;ResMOE_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M6629.44,-545.76C6726.55,-536.03 6839.68,-526.12 6942.42,-520.69 7611.76,-485.34 9290.06,-535.17 9958.42,-484.69 10247.66,-462.85 10796.04,-552.19 10595.42,-342.69 10558.26,-303.89 7328.82,-189.33 6310.44,-154.14"/>
<polygon fill="black" stroke="black" points="6310.53,-150.64 6300.41,-153.8 6310.29,-157.64 6310.53,-150.64"/>
</g>
<!-- Gate_s1_l16_tp4 -->
<g id="node1413" class="node">
<title>Gate_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7470.42,-484.69 7132.42,-484.69 7132.42,-431.69 7470.42,-431.69 7470.42,-484.69"/>
<text text-anchor="middle" x="7301.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7301.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7301.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp4&#45;&gt;Gate_s1_l16_tp4 -->
<g id="edge2349" class="edge">
<title>ResAttn_s1_l16_tp4&#45;&gt;Gate_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M7301.42,-520.59C7301.42,-511.92 7301.42,-503.11 7301.42,-494.96"/>
<polygon fill="black" stroke="black" points="7304.92,-494.71 7301.42,-484.71 7297.92,-494.71 7304.92,-494.71"/>
</g>
<!-- ResMOE_s1_l16_tp4 -->
<g id="node1454" class="node">
<title>ResMOE_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="8393.77,-195.74 7836.45,-195.74 7693.08,-89.74 8250.4,-89.74 8393.77,-195.74"/>
<text text-anchor="middle" x="8043.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="8043.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8043.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp4&#45;&gt;ResMOE_s1_l16_tp4 -->
<g id="edge2426" class="edge">
<title>ResAttn_s1_l16_tp4&#45;&gt;ResMOE_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M7546.56,-548.79C7664.33,-538.29 7807.57,-526.94 7936.42,-520.69 8199.92,-507.92 10049.36,-522.66 10310.42,-484.69 10455.24,-463.63 10539.03,-512.32 10627.42,-395.69 10809.3,-155.73 9582.64,-254.78 9282.42,-231.74 8969.75,-207.74 8612.5,-182.61 8362.21,-165.38"/>
<polygon fill="black" stroke="black" points="8362.08,-161.86 8351.86,-164.67 8361.6,-168.85 8362.08,-161.86"/>
</g>
<!-- Gate_s1_l16_tp5 -->
<g id="node1414" class="node">
<title>Gate_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="1147.42,-484.69 809.42,-484.69 809.42,-431.69 1147.42,-431.69 1147.42,-484.69"/>
<text text-anchor="middle" x="978.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="978.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="978.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp5&#45;&gt;Gate_s1_l16_tp5 -->
<g id="edge2350" class="edge">
<title>ResAttn_s1_l16_tp5&#45;&gt;Gate_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M1188.6,-520.68C1149.77,-509.32 1110.07,-497.7 1075.77,-487.67"/>
<polygon fill="black" stroke="black" points="1076.36,-484.2 1065.78,-484.75 1074.4,-490.92 1076.36,-484.2"/>
</g>
<!-- ResMOE_s1_l16_tp5 -->
<g id="node1455" class="node">
<title>ResMOE_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="700.77,-195.74 143.45,-195.74 0.08,-89.74 557.4,-89.74 700.77,-195.74"/>
<text text-anchor="middle" x="350.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="350.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="350.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp5&#45;&gt;ResMOE_s1_l16_tp5 -->
<g id="edge2428" class="edge">
<title>ResAttn_s1_l16_tp5&#45;&gt;ResMOE_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M1086.41,-572.8C725.94,-570.06 137.24,-554.74 66.42,-484.69 -13.52,-405.62 -5.68,-321.21 62.42,-231.74 72.9,-217.98 97.19,-205.45 127.46,-194.44"/>
<polygon fill="black" stroke="black" points="128.77,-197.7 137.04,-191.08 126.45,-191.09 128.77,-197.7"/>
</g>
<!-- Gate_s1_l16_tp6 -->
<g id="node1415" class="node">
<title>Gate_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="9949.42,-484.69 9611.42,-484.69 9611.42,-431.69 9949.42,-431.69 9949.42,-484.69"/>
<text text-anchor="middle" x="9780.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9780.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9780.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp6&#45;&gt;Gate_s1_l16_tp6 -->
<g id="edge2351" class="edge">
<title>ResAttn_s1_l16_tp6&#45;&gt;Gate_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M9598.66,-520.59C9631.82,-509.39 9665.71,-497.94 9695.11,-488.01"/>
<polygon fill="black" stroke="black" points="9696.54,-491.22 9704.89,-484.71 9694.3,-484.59 9696.54,-491.22"/>
</g>
<!-- ResMOE_s1_l16_tp6 -->
<g id="node1456" class="node">
<title>ResMOE_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="10819.77,-195.74 10262.45,-195.74 10119.08,-89.74 10676.4,-89.74 10819.77,-195.74"/>
<text text-anchor="middle" x="10469.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="10469.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10469.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp6&#45;&gt;ResMOE_s1_l16_tp6 -->
<g id="edge2430" class="edge">
<title>ResAttn_s1_l16_tp6&#45;&gt;ResMOE_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M9722.25,-572.92C10073.01,-570.25 10638.92,-554.93 10704.42,-484.69 10781.1,-402.48 10768.48,-324.13 10704.42,-231.74 10696.53,-220.36 10686.98,-210.45 10676.3,-201.82"/>
<polygon fill="black" stroke="black" points="10678.41,-199.03 10668.33,-195.76 10674.17,-204.6 10678.41,-199.03"/>
</g>
<!-- Gate_s1_l16_tp7 -->
<g id="node1416" class="node">
<title>Gate_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="8645.42,-484.69 8307.42,-484.69 8307.42,-431.69 8645.42,-431.69 8645.42,-484.69"/>
<text text-anchor="middle" x="8476.42" y="-469.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8476.42" y="-454.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8476.42" y="-439.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp7&#45;&gt;Gate_s1_l16_tp7 -->
<g id="edge2352" class="edge">
<title>ResAttn_s1_l16_tp7&#45;&gt;Gate_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M8378.51,-520.59C8395.13,-510.17 8412.09,-499.53 8427.12,-490.11"/>
<polygon fill="black" stroke="black" points="8429.12,-492.98 8435.74,-484.71 8425.4,-487.05 8429.12,-492.98"/>
</g>
<!-- ResMOE_s1_l16_tp7 -->
<g id="node1457" class="node">
<title>ResMOE_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="9771.77,-195.74 9214.45,-195.74 9071.08,-89.74 9628.4,-89.74 9771.77,-195.74"/>
<text text-anchor="middle" x="9421.42" y="-154.04" font-family="Times,serif" font-size="14.00">ResAdd</text>
<text text-anchor="middle" x="9421.42" y="-139.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9421.42" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResAttn_s1_l16_tp7&#45;&gt;ResMOE_s1_l16_tp7 -->
<g id="edge2432" class="edge">
<title>ResAttn_s1_l16_tp7&#45;&gt;ResMOE_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M8547,-553.58C8702.13,-542.43 8905.21,-528.97 9085.42,-520.69 9238.54,-513.66 10315.4,-520.56 10464.42,-484.69 10553.52,-463.25 10601.57,-473.23 10650.42,-395.69 10662.98,-375.76 10665.69,-360.63 10650.42,-342.69 10592.53,-274.67 10096.95,-211.54 9753.07,-175.35"/>
<polygon fill="black" stroke="black" points="9753.26,-171.85 9742.95,-174.28 9752.53,-178.81 9753.26,-171.85"/>
</g>
<!-- Expert32_s1_l16_tp0 -->
<g id="node1417" class="node">
<title>Expert32_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="5044.42,-395.69 4736.42,-395.69 4736.42,-342.69 5044.42,-342.69 5044.42,-395.69"/>
<text text-anchor="middle" x="4890.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert32</text>
<text text-anchor="middle" x="4890.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4890.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp0&#45;&gt;Expert32_s1_l16_tp0 -->
<g id="edge2353" class="edge">
<title>Gate_s1_l16_tp0&#45;&gt;Expert32_s1_l16_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4660.03,-431.68C4699.26,-421.21 4744.8,-409.06 4784.99,-398.33"/>
<polygon fill="black" stroke="black" points="4786.06,-401.67 4794.82,-395.71 4784.25,-394.9 4786.06,-401.67"/>
</g>
<!-- Expert33_s1_l16_tp0 -->
<g id="node1418" class="node">
<title>Expert33_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="5370.42,-395.69 5062.42,-395.69 5062.42,-342.69 5370.42,-342.69 5370.42,-395.69"/>
<text text-anchor="middle" x="5216.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert33</text>
<text text-anchor="middle" x="5216.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5216.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp0&#45;&gt;Expert33_s1_l16_tp0 -->
<g id="edge2354" class="edge">
<title>Gate_s1_l16_tp0&#45;&gt;Expert33_s1_l16_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4733.47,-437.2C4824.97,-426.07 4940.22,-411.56 5051.9,-395.89"/>
<polygon fill="black" stroke="black" points="5052.59,-399.33 5062.01,-394.47 5051.62,-392.4 5052.59,-399.33"/>
</g>
<!-- Expert34_s1_l16_tp0 -->
<g id="node1419" class="node">
<title>Expert34_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4392.42,-395.69 4084.42,-395.69 4084.42,-342.69 4392.42,-342.69 4392.42,-395.69"/>
<text text-anchor="middle" x="4238.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert34</text>
<text text-anchor="middle" x="4238.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4238.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp0&#45;&gt;Expert34_s1_l16_tp0 -->
<g id="edge2355" class="edge">
<title>Gate_s1_l16_tp0&#45;&gt;Expert34_s1_l16_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4468.81,-431.68C4429.59,-421.21 4384.04,-409.06 4343.85,-398.33"/>
<polygon fill="black" stroke="black" points="4344.59,-394.9 4334.03,-395.71 4342.79,-401.67 4344.59,-394.9"/>
</g>
<!-- Expert35_s1_l16_tp0 -->
<g id="node1420" class="node">
<title>Expert35_s1_l16_tp0</title>
<polygon fill="none" stroke="black" points="4718.42,-395.69 4410.42,-395.69 4410.42,-342.69 4718.42,-342.69 4718.42,-395.69"/>
<text text-anchor="middle" x="4564.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert35</text>
<text text-anchor="middle" x="4564.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4564.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp0&#45;&gt;Expert35_s1_l16_tp0 -->
<g id="edge2356" class="edge">
<title>Gate_s1_l16_tp0&#45;&gt;Expert35_s1_l16_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4564.42,-431.56C4564.42,-423.58 4564.42,-414.63 4564.42,-406.08"/>
<polygon fill="black" stroke="black" points="4567.92,-405.94 4564.42,-395.94 4560.92,-405.94 4567.92,-405.94"/>
</g>
<!-- Expert36_s1_l16_tp1 -->
<g id="node1421" class="node">
<title>Expert36_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2436.42,-395.69 2128.42,-395.69 2128.42,-342.69 2436.42,-342.69 2436.42,-395.69"/>
<text text-anchor="middle" x="2282.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert36</text>
<text text-anchor="middle" x="2282.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2282.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp1&#45;&gt;Expert36_s1_l16_tp1 -->
<g id="edge2357" class="edge">
<title>Gate_s1_l16_tp1&#45;&gt;Expert36_s1_l16_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2282.42,-431.56C2282.42,-423.58 2282.42,-414.63 2282.42,-406.08"/>
<polygon fill="black" stroke="black" points="2285.92,-405.94 2282.42,-395.94 2278.92,-405.94 2285.92,-405.94"/>
</g>
<!-- Expert37_s1_l16_tp1 -->
<g id="node1422" class="node">
<title>Expert37_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2762.42,-395.69 2454.42,-395.69 2454.42,-342.69 2762.42,-342.69 2762.42,-395.69"/>
<text text-anchor="middle" x="2608.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert37</text>
<text text-anchor="middle" x="2608.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2608.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp1&#45;&gt;Expert37_s1_l16_tp1 -->
<g id="edge2358" class="edge">
<title>Gate_s1_l16_tp1&#45;&gt;Expert37_s1_l16_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2378.03,-431.68C2417.26,-421.21 2462.8,-409.06 2502.99,-398.33"/>
<polygon fill="black" stroke="black" points="2504.06,-401.67 2512.82,-395.71 2502.25,-394.9 2504.06,-401.67"/>
</g>
<!-- Expert38_s1_l16_tp1 -->
<g id="node1423" class="node">
<title>Expert38_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="1784.42,-395.69 1476.42,-395.69 1476.42,-342.69 1784.42,-342.69 1784.42,-395.69"/>
<text text-anchor="middle" x="1630.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert38</text>
<text text-anchor="middle" x="1630.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1630.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp1&#45;&gt;Expert38_s1_l16_tp1 -->
<g id="edge2359" class="edge">
<title>Gate_s1_l16_tp1&#45;&gt;Expert38_s1_l16_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2113.37,-437.2C2021.87,-426.07 1906.63,-411.56 1794.94,-395.89"/>
<polygon fill="black" stroke="black" points="1795.23,-392.4 1784.84,-394.47 1794.25,-399.33 1795.23,-392.4"/>
</g>
<!-- Expert39_s1_l16_tp1 -->
<g id="node1424" class="node">
<title>Expert39_s1_l16_tp1</title>
<polygon fill="none" stroke="black" points="2110.42,-395.69 1802.42,-395.69 1802.42,-342.69 2110.42,-342.69 2110.42,-395.69"/>
<text text-anchor="middle" x="1956.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert39</text>
<text text-anchor="middle" x="1956.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1956.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp1&#45;&gt;Expert39_s1_l16_tp1 -->
<g id="edge2360" class="edge">
<title>Gate_s1_l16_tp1&#45;&gt;Expert39_s1_l16_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2186.81,-431.68C2147.59,-421.21 2102.04,-409.06 2061.85,-398.33"/>
<polygon fill="black" stroke="black" points="2062.59,-394.9 2052.03,-395.71 2060.79,-401.67 2062.59,-394.9"/>
</g>
<!-- Expert40_s1_l16_tp2 -->
<g id="node1425" class="node">
<title>Expert40_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="4066.42,-395.69 3758.42,-395.69 3758.42,-342.69 4066.42,-342.69 4066.42,-395.69"/>
<text text-anchor="middle" x="3912.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert40</text>
<text text-anchor="middle" x="3912.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3912.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp2&#45;&gt;Expert40_s1_l16_tp2 -->
<g id="edge2361" class="edge">
<title>Gate_s1_l16_tp2&#45;&gt;Expert40_s1_l16_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3519.32,-431.62C3587.33,-421.01 3667.32,-408.52 3748.51,-395.84"/>
<polygon fill="black" stroke="black" points="3749.08,-399.29 3758.42,-394.29 3748,-392.37 3749.08,-399.29"/>
</g>
<!-- Expert41_s1_l16_tp2 -->
<g id="node1426" class="node">
<title>Expert41_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="3088.42,-395.69 2780.42,-395.69 2780.42,-342.69 3088.42,-342.69 3088.42,-395.69"/>
<text text-anchor="middle" x="2934.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert41</text>
<text text-anchor="middle" x="2934.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="2934.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp2&#45;&gt;Expert41_s1_l16_tp2 -->
<g id="edge2362" class="edge">
<title>Gate_s1_l16_tp2&#45;&gt;Expert41_s1_l16_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3231.95,-431.68C3180.44,-421.03 3120.49,-408.64 3067.95,-397.79"/>
<polygon fill="black" stroke="black" points="3068.39,-394.3 3057.89,-395.71 3066.97,-401.16 3068.39,-394.3"/>
</g>
<!-- Expert42_s1_l16_tp2 -->
<g id="node1427" class="node">
<title>Expert42_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="3414.42,-395.69 3106.42,-395.69 3106.42,-342.69 3414.42,-342.69 3414.42,-395.69"/>
<text text-anchor="middle" x="3260.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert42</text>
<text text-anchor="middle" x="3260.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3260.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp2&#45;&gt;Expert42_s1_l16_tp2 -->
<g id="edge2363" class="edge">
<title>Gate_s1_l16_tp2&#45;&gt;Expert42_s1_l16_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3327.43,-431.56C3317.57,-422.53 3306.34,-412.25 3295.94,-402.72"/>
<polygon fill="black" stroke="black" points="3298.28,-400.12 3288.54,-395.94 3293.55,-405.28 3298.28,-400.12"/>
</g>
<!-- Expert43_s1_l16_tp2 -->
<g id="node1428" class="node">
<title>Expert43_s1_l16_tp2</title>
<polygon fill="none" stroke="black" points="3740.42,-395.69 3432.42,-395.69 3432.42,-342.69 3740.42,-342.69 3740.42,-395.69"/>
<text text-anchor="middle" x="3586.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert43</text>
<text text-anchor="middle" x="3586.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3586.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp2&#45;&gt;Expert43_s1_l16_tp2 -->
<g id="edge2364" class="edge">
<title>Gate_s1_l16_tp2&#45;&gt;Expert43_s1_l16_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3423.17,-431.68C3450.08,-421.54 3481.2,-409.82 3508.99,-399.35"/>
<polygon fill="black" stroke="black" points="3510.55,-402.51 3518.68,-395.71 3508.09,-395.96 3510.55,-402.51"/>
</g>
<!-- Expert44_s1_l16_tp3 -->
<g id="node1429" class="node">
<title>Expert44_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="5696.42,-395.69 5388.42,-395.69 5388.42,-342.69 5696.42,-342.69 5696.42,-395.69"/>
<text text-anchor="middle" x="5542.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert44</text>
<text text-anchor="middle" x="5542.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5542.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp3&#45;&gt;Expert44_s1_l16_tp3 -->
<g id="edge2365" class="edge">
<title>Gate_s1_l16_tp3&#45;&gt;Expert44_s1_l16_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6025.37,-437.2C5933.87,-426.07 5818.63,-411.56 5706.94,-395.89"/>
<polygon fill="black" stroke="black" points="5707.23,-392.4 5696.84,-394.47 5706.25,-399.33 5707.23,-392.4"/>
</g>
<!-- Expert45_s1_l16_tp3 -->
<g id="node1430" class="node">
<title>Expert45_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6022.42,-395.69 5714.42,-395.69 5714.42,-342.69 6022.42,-342.69 6022.42,-395.69"/>
<text text-anchor="middle" x="5868.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert45</text>
<text text-anchor="middle" x="5868.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5868.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp3&#45;&gt;Expert45_s1_l16_tp3 -->
<g id="edge2366" class="edge">
<title>Gate_s1_l16_tp3&#45;&gt;Expert45_s1_l16_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6098.81,-431.68C6059.59,-421.21 6014.04,-409.06 5973.85,-398.33"/>
<polygon fill="black" stroke="black" points="5974.59,-394.9 5964.03,-395.71 5972.79,-401.67 5974.59,-394.9"/>
</g>
<!-- Expert46_s1_l16_tp3 -->
<g id="node1431" class="node">
<title>Expert46_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6348.42,-395.69 6040.42,-395.69 6040.42,-342.69 6348.42,-342.69 6348.42,-395.69"/>
<text text-anchor="middle" x="6194.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert46</text>
<text text-anchor="middle" x="6194.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6194.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp3&#45;&gt;Expert46_s1_l16_tp3 -->
<g id="edge2367" class="edge">
<title>Gate_s1_l16_tp3&#45;&gt;Expert46_s1_l16_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6194.42,-431.56C6194.42,-423.58 6194.42,-414.63 6194.42,-406.08"/>
<polygon fill="black" stroke="black" points="6197.92,-405.94 6194.42,-395.94 6190.92,-405.94 6197.92,-405.94"/>
</g>
<!-- Expert47_s1_l16_tp3 -->
<g id="node1432" class="node">
<title>Expert47_s1_l16_tp3</title>
<polygon fill="none" stroke="black" points="6674.42,-395.69 6366.42,-395.69 6366.42,-342.69 6674.42,-342.69 6674.42,-395.69"/>
<text text-anchor="middle" x="6520.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert47</text>
<text text-anchor="middle" x="6520.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6520.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp3&#45;&gt;Expert47_s1_l16_tp3 -->
<g id="edge2368" class="edge">
<title>Gate_s1_l16_tp3&#45;&gt;Expert47_s1_l16_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6290.03,-431.68C6329.26,-421.21 6374.8,-409.06 6414.99,-398.33"/>
<polygon fill="black" stroke="black" points="6416.06,-401.67 6424.82,-395.71 6414.25,-394.9 6416.06,-401.67"/>
</g>
<!-- Expert48_s1_l16_tp4 -->
<g id="node1433" class="node">
<title>Expert48_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7000.42,-395.69 6692.42,-395.69 6692.42,-342.69 7000.42,-342.69 7000.42,-395.69"/>
<text text-anchor="middle" x="6846.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert48</text>
<text text-anchor="middle" x="6846.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6846.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp4&#45;&gt;Expert48_s1_l16_tp4 -->
<g id="edge2369" class="edge">
<title>Gate_s1_l16_tp4&#45;&gt;Expert48_s1_l16_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7167.98,-431.68C7112.08,-420.99 7046.97,-408.54 6990.03,-397.65"/>
<polygon fill="black" stroke="black" points="6990.34,-394.15 6979.86,-395.71 6989.03,-401.02 6990.34,-394.15"/>
</g>
<!-- Expert49_s1_l16_tp4 -->
<g id="node1434" class="node">
<title>Expert49_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7326.42,-395.69 7018.42,-395.69 7018.42,-342.69 7326.42,-342.69 7326.42,-395.69"/>
<text text-anchor="middle" x="7172.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert49</text>
<text text-anchor="middle" x="7172.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7172.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp4&#45;&gt;Expert49_s1_l16_tp4 -->
<g id="edge2370" class="edge">
<title>Gate_s1_l16_tp4&#45;&gt;Expert49_s1_l16_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7263.42,-431.56C7249.5,-422.18 7233.59,-411.45 7219.01,-401.61"/>
<polygon fill="black" stroke="black" points="7220.85,-398.63 7210.6,-395.94 7216.94,-404.44 7220.85,-398.63"/>
</g>
<!-- Expert50_s1_l16_tp4 -->
<g id="node1435" class="node">
<title>Expert50_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7652.42,-395.69 7344.42,-395.69 7344.42,-342.69 7652.42,-342.69 7652.42,-395.69"/>
<text text-anchor="middle" x="7498.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert50</text>
<text text-anchor="middle" x="7498.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7498.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp4&#45;&gt;Expert50_s1_l16_tp4 -->
<g id="edge2371" class="edge">
<title>Gate_s1_l16_tp4&#45;&gt;Expert50_s1_l16_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7359.2,-431.68C7381.85,-421.67 7407.99,-410.13 7431.46,-399.77"/>
<polygon fill="black" stroke="black" points="7432.91,-402.95 7440.65,-395.71 7430.09,-396.55 7432.91,-402.95"/>
</g>
<!-- Expert51_s1_l16_tp4 -->
<g id="node1436" class="node">
<title>Expert51_s1_l16_tp4</title>
<polygon fill="none" stroke="black" points="7978.42,-395.69 7670.42,-395.69 7670.42,-342.69 7978.42,-342.69 7978.42,-395.69"/>
<text text-anchor="middle" x="7824.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert51</text>
<text text-anchor="middle" x="7824.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7824.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp4&#45;&gt;Expert51_s1_l16_tp4 -->
<g id="edge2372" class="edge">
<title>Gate_s1_l16_tp4&#45;&gt;Expert51_s1_l16_tp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7454.81,-431.68C7519.6,-420.9 7595.14,-408.33 7660.98,-397.38"/>
<polygon fill="black" stroke="black" points="7661.75,-400.8 7671.04,-395.71 7660.6,-393.9 7661.75,-400.8"/>
</g>
<!-- Expert52_s1_l16_tp5 -->
<g id="node1437" class="node">
<title>Expert52_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="480.42,-395.69 172.42,-395.69 172.42,-342.69 480.42,-342.69 480.42,-395.69"/>
<text text-anchor="middle" x="326.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert52</text>
<text text-anchor="middle" x="326.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="326.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp5&#45;&gt;Expert52_s1_l16_tp5 -->
<g id="edge2373" class="edge">
<title>Gate_s1_l16_tp5&#45;&gt;Expert52_s1_l16_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M809.37,-437.2C717.87,-426.07 602.63,-411.56 490.94,-395.89"/>
<polygon fill="black" stroke="black" points="491.23,-392.4 480.84,-394.47 490.25,-399.33 491.23,-392.4"/>
</g>
<!-- Expert53_s1_l16_tp5 -->
<g id="node1438" class="node">
<title>Expert53_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="806.42,-395.69 498.42,-395.69 498.42,-342.69 806.42,-342.69 806.42,-395.69"/>
<text text-anchor="middle" x="652.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert53</text>
<text text-anchor="middle" x="652.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="652.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp5&#45;&gt;Expert53_s1_l16_tp5 -->
<g id="edge2374" class="edge">
<title>Gate_s1_l16_tp5&#45;&gt;Expert53_s1_l16_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M882.81,-431.68C843.59,-421.21 798.04,-409.06 757.85,-398.33"/>
<polygon fill="black" stroke="black" points="758.59,-394.9 748.03,-395.71 756.79,-401.67 758.59,-394.9"/>
</g>
<!-- Expert54_s1_l16_tp5 -->
<g id="node1439" class="node">
<title>Expert54_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="1132.42,-395.69 824.42,-395.69 824.42,-342.69 1132.42,-342.69 1132.42,-395.69"/>
<text text-anchor="middle" x="978.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert54</text>
<text text-anchor="middle" x="978.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="978.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp5&#45;&gt;Expert54_s1_l16_tp5 -->
<g id="edge2375" class="edge">
<title>Gate_s1_l16_tp5&#45;&gt;Expert54_s1_l16_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M978.42,-431.56C978.42,-423.58 978.42,-414.63 978.42,-406.08"/>
<polygon fill="black" stroke="black" points="981.92,-405.94 978.42,-395.94 974.92,-405.94 981.92,-405.94"/>
</g>
<!-- Expert55_s1_l16_tp5 -->
<g id="node1440" class="node">
<title>Expert55_s1_l16_tp5</title>
<polygon fill="none" stroke="black" points="1458.42,-395.69 1150.42,-395.69 1150.42,-342.69 1458.42,-342.69 1458.42,-395.69"/>
<text text-anchor="middle" x="1304.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert55</text>
<text text-anchor="middle" x="1304.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="1304.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp5&#45;&gt;Expert55_s1_l16_tp5 -->
<g id="edge2376" class="edge">
<title>Gate_s1_l16_tp5&#45;&gt;Expert55_s1_l16_tp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1074.03,-431.68C1113.26,-421.21 1158.8,-409.06 1198.99,-398.33"/>
<polygon fill="black" stroke="black" points="1200.06,-401.67 1208.82,-395.71 1198.25,-394.9 1200.06,-401.67"/>
</g>
<!-- Expert56_s1_l16_tp6 -->
<g id="node1441" class="node">
<title>Expert56_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="9608.42,-395.69 9300.42,-395.69 9300.42,-342.69 9608.42,-342.69 9608.42,-395.69"/>
<text text-anchor="middle" x="9454.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert56</text>
<text text-anchor="middle" x="9454.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9454.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp6&#45;&gt;Expert56_s1_l16_tp6 -->
<g id="edge2377" class="edge">
<title>Gate_s1_l16_tp6&#45;&gt;Expert56_s1_l16_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9684.81,-431.68C9645.59,-421.21 9600.04,-409.06 9559.85,-398.33"/>
<polygon fill="black" stroke="black" points="9560.59,-394.9 9550.03,-395.71 9558.79,-401.67 9560.59,-394.9"/>
</g>
<!-- Expert57_s1_l16_tp6 -->
<g id="node1442" class="node">
<title>Expert57_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="9934.42,-395.69 9626.42,-395.69 9626.42,-342.69 9934.42,-342.69 9934.42,-395.69"/>
<text text-anchor="middle" x="9780.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert57</text>
<text text-anchor="middle" x="9780.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9780.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp6&#45;&gt;Expert57_s1_l16_tp6 -->
<g id="edge2378" class="edge">
<title>Gate_s1_l16_tp6&#45;&gt;Expert57_s1_l16_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9780.42,-431.56C9780.42,-423.58 9780.42,-414.63 9780.42,-406.08"/>
<polygon fill="black" stroke="black" points="9783.92,-405.94 9780.42,-395.94 9776.92,-405.94 9783.92,-405.94"/>
</g>
<!-- Expert58_s1_l16_tp6 -->
<g id="node1443" class="node">
<title>Expert58_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="10260.42,-395.69 9952.42,-395.69 9952.42,-342.69 10260.42,-342.69 10260.42,-395.69"/>
<text text-anchor="middle" x="10106.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert58</text>
<text text-anchor="middle" x="10106.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10106.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp6&#45;&gt;Expert58_s1_l16_tp6 -->
<g id="edge2379" class="edge">
<title>Gate_s1_l16_tp6&#45;&gt;Expert58_s1_l16_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9876.03,-431.68C9915.26,-421.21 9960.8,-409.06 10000.99,-398.33"/>
<polygon fill="black" stroke="black" points="10002.06,-401.67 10010.82,-395.71 10000.25,-394.9 10002.06,-401.67"/>
</g>
<!-- Expert59_s1_l16_tp6 -->
<g id="node1444" class="node">
<title>Expert59_s1_l16_tp6</title>
<polygon fill="none" stroke="black" points="10586.42,-395.69 10278.42,-395.69 10278.42,-342.69 10586.42,-342.69 10586.42,-395.69"/>
<text text-anchor="middle" x="10432.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert59</text>
<text text-anchor="middle" x="10432.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10432.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp6&#45;&gt;Expert59_s1_l16_tp6 -->
<g id="edge2380" class="edge">
<title>Gate_s1_l16_tp6&#45;&gt;Expert59_s1_l16_tp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9949.47,-437.2C10040.97,-426.07 10156.22,-411.56 10267.9,-395.89"/>
<polygon fill="black" stroke="black" points="10268.59,-399.33 10278.01,-394.47 10267.62,-392.4 10268.59,-399.33"/>
</g>
<!-- Expert60_s1_l16_tp7 -->
<g id="node1445" class="node">
<title>Expert60_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="8304.42,-395.69 7996.42,-395.69 7996.42,-342.69 8304.42,-342.69 8304.42,-395.69"/>
<text text-anchor="middle" x="8150.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert60</text>
<text text-anchor="middle" x="8150.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8150.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp7&#45;&gt;Expert60_s1_l16_tp7 -->
<g id="edge2381" class="edge">
<title>Gate_s1_l16_tp7&#45;&gt;Expert60_s1_l16_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8380.81,-431.68C8341.59,-421.21 8296.04,-409.06 8255.85,-398.33"/>
<polygon fill="black" stroke="black" points="8256.59,-394.9 8246.03,-395.71 8254.79,-401.67 8256.59,-394.9"/>
</g>
<!-- Expert61_s1_l16_tp7 -->
<g id="node1446" class="node">
<title>Expert61_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="8630.42,-395.69 8322.42,-395.69 8322.42,-342.69 8630.42,-342.69 8630.42,-395.69"/>
<text text-anchor="middle" x="8476.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert61</text>
<text text-anchor="middle" x="8476.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8476.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp7&#45;&gt;Expert61_s1_l16_tp7 -->
<g id="edge2382" class="edge">
<title>Gate_s1_l16_tp7&#45;&gt;Expert61_s1_l16_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8476.42,-431.56C8476.42,-423.58 8476.42,-414.63 8476.42,-406.08"/>
<polygon fill="black" stroke="black" points="8479.92,-405.94 8476.42,-395.94 8472.92,-405.94 8479.92,-405.94"/>
</g>
<!-- Expert62_s1_l16_tp7 -->
<g id="node1447" class="node">
<title>Expert62_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="8956.42,-395.69 8648.42,-395.69 8648.42,-342.69 8956.42,-342.69 8956.42,-395.69"/>
<text text-anchor="middle" x="8802.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert62</text>
<text text-anchor="middle" x="8802.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8802.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp7&#45;&gt;Expert62_s1_l16_tp7 -->
<g id="edge2383" class="edge">
<title>Gate_s1_l16_tp7&#45;&gt;Expert62_s1_l16_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8572.03,-431.68C8611.26,-421.21 8656.8,-409.06 8696.99,-398.33"/>
<polygon fill="black" stroke="black" points="8698.06,-401.67 8706.82,-395.71 8696.25,-394.9 8698.06,-401.67"/>
</g>
<!-- Expert63_s1_l16_tp7 -->
<g id="node1448" class="node">
<title>Expert63_s1_l16_tp7</title>
<polygon fill="none" stroke="black" points="9282.42,-395.69 8974.42,-395.69 8974.42,-342.69 9282.42,-342.69 9282.42,-395.69"/>
<text text-anchor="middle" x="9128.42" y="-380.49" font-family="Times,serif" font-size="14.00">Expert63</text>
<text text-anchor="middle" x="9128.42" y="-365.49" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9128.42" y="-350.49" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,ffn=2048]</text>
</g>
<!-- Gate_s1_l16_tp7&#45;&gt;Expert63_s1_l16_tp7 -->
<g id="edge2384" class="edge">
<title>Gate_s1_l16_tp7&#45;&gt;Expert63_s1_l16_tp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8645.47,-437.2C8736.97,-426.07 8852.22,-411.56 8963.9,-395.89"/>
<polygon fill="black" stroke="black" points="8964.59,-399.33 8974.01,-394.47 8963.62,-392.4 8964.59,-399.33"/>
</g>
<!-- AR_exp_s1_l16 -->
<g id="node1449" class="node">
<title>AR_exp_s1_l16</title>
<ellipse fill="none" stroke="black" cx="5346.42" cy="-269.22" rx="239" ry="37.45"/>
<text text-anchor="middle" x="5346.42" y="-280.52" font-family="Times,serif" font-size="14.00">AllReduceExperts</text>
<text text-anchor="middle" x="5346.42" y="-265.52" font-family="Times,serif" font-size="14.00">stage1</text>
<text text-anchor="middle" x="5346.42" y="-250.52" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- Expert32_s1_l16_tp0&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2385" class="edge">
<title>Expert32_s1_l16_tp0&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M5009.34,-342.64C5067.08,-330.24 5137.04,-315.21 5198.22,-302.06"/>
<polygon fill="black" stroke="black" points="5199.31,-305.41 5208.35,-299.88 5197.84,-298.56 5199.31,-305.41"/>
</g>
<!-- Expert33_s1_l16_tp0&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2386" class="edge">
<title>Expert33_s1_l16_tp0&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M5250.58,-342.45C5262.79,-333.25 5276.89,-322.62 5290.46,-312.4"/>
<polygon fill="black" stroke="black" points="5292.93,-314.91 5298.81,-306.1 5288.72,-309.32 5292.93,-314.91"/>
</g>
<!-- Expert34_s1_l16_tp0&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2387" class="edge">
<title>Expert34_s1_l16_tp0&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M4392.81,-343.72C4395.71,-343.37 4398.58,-343.02 4401.42,-342.69 4643.08,-314.57 4920.82,-294.75 5112.35,-283.03"/>
<polygon fill="black" stroke="black" points="5112.78,-286.51 5122.55,-282.41 5112.36,-279.53 5112.78,-286.51"/>
</g>
<!-- Expert35_s1_l16_tp0&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2388" class="edge">
<title>Expert35_s1_l16_tp0&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M4718.83,-343.88C4721.72,-343.48 4724.58,-343.08 4727.42,-342.69 4865.32,-323.84 5020.92,-305.64 5141.62,-292.19"/>
<polygon fill="black" stroke="black" points="5142.17,-295.65 5151.72,-291.06 5141.39,-288.69 5142.17,-295.65"/>
</g>
<!-- Expert36_s1_l16_tp1&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2389" class="edge">
<title>Expert36_s1_l16_tp1&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M2436.79,-343.52C2439.69,-343.23 2442.57,-342.95 2445.42,-342.69 2956.84,-296.5 4493.22,-277.92 5097.97,-272.26"/>
<polygon fill="black" stroke="black" points="5098.16,-275.76 5108.13,-272.17 5098.09,-268.76 5098.16,-275.76"/>
</g>
<!-- Expert37_s1_l16_tp1&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2390" class="edge">
<title>Expert37_s1_l16_tp1&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M2762.79,-343.53C2765.69,-343.24 2768.57,-342.96 2771.42,-342.69 3217.79,-301.66 4543.95,-280.45 5098.41,-273.18"/>
<polygon fill="black" stroke="black" points="5098.58,-276.68 5108.54,-273.04 5098.49,-269.68 5098.58,-276.68"/>
</g>
<!-- Expert38_s1_l16_tp1&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2391" class="edge">
<title>Expert38_s1_l16_tp1&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M1784.79,-343.5C1787.69,-343.21 1790.57,-342.94 1793.42,-342.69 2436.07,-286.13 4399.83,-273.61 5097.37,-270.93"/>
<polygon fill="black" stroke="black" points="5097.55,-274.43 5107.54,-270.89 5097.53,-267.43 5097.55,-274.43"/>
</g>
<!-- Expert39_s1_l16_tp1&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2392" class="edge">
<title>Expert39_s1_l16_tp1&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M2110.79,-343.51C2113.69,-343.22 2116.57,-342.95 2119.42,-342.69 2696.2,-291.33 4444.8,-275.66 5097.34,-271.53"/>
<polygon fill="black" stroke="black" points="5097.83,-275.03 5107.81,-271.47 5097.79,-268.03 5097.83,-275.03"/>
</g>
<!-- Expert40_s1_l16_tp2&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2393" class="edge">
<title>Expert40_s1_l16_tp2&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M4066.81,-343.65C4069.7,-343.32 4072.57,-343 4075.42,-342.69 4431.37,-304.79 4845.66,-285.84 5102,-277.03"/>
<polygon fill="black" stroke="black" points="5102.31,-280.52 5112.19,-276.68 5102.08,-273.52 5102.31,-280.52"/>
</g>
<!-- Expert41_s1_l16_tp2&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2394" class="edge">
<title>Expert41_s1_l16_tp2&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M3088.8,-343.55C3091.69,-343.25 3094.57,-342.96 3097.42,-342.69 3479.24,-306.81 4598.24,-283.34 5099.1,-274.35"/>
<polygon fill="black" stroke="black" points="5099.42,-277.84 5109.35,-274.16 5099.29,-270.84 5099.42,-277.84"/>
</g>
<!-- Expert42_s1_l16_tp2&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2395" class="edge">
<title>Expert42_s1_l16_tp2&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M3414.8,-343.57C3417.69,-343.26 3420.57,-342.97 3423.42,-342.69 4022.21,-284.77 4730.03,-272.48 5097.26,-270.28"/>
<polygon fill="black" stroke="black" points="5097.51,-273.78 5107.49,-270.22 5097.47,-266.78 5097.51,-273.78"/>
</g>
<!-- Expert43_s1_l16_tp2&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2396" class="edge">
<title>Expert43_s1_l16_tp2&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M3740.8,-343.6C3743.7,-343.28 3746.57,-342.98 3749.42,-342.69 4225.1,-294.84 4783.69,-278.57 5098.24,-273.05"/>
<polygon fill="black" stroke="black" points="5098.47,-276.54 5108.4,-272.87 5098.35,-269.54 5098.47,-276.54"/>
</g>
<!-- Expert44_s1_l16_tp3&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2397" class="edge">
<title>Expert44_s1_l16_tp3&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M5491.18,-342.58C5471.04,-332.51 5447.47,-320.73 5425.26,-309.62"/>
<polygon fill="black" stroke="black" points="5426.68,-306.42 5416.17,-305.08 5423.55,-312.68 5426.68,-306.42"/>
</g>
<!-- Expert45_s1_l16_tp3&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2398" class="edge">
<title>Expert45_s1_l16_tp3&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M5732.3,-342.64C5663.2,-329.67 5578.82,-313.84 5506.61,-300.28"/>
<polygon fill="black" stroke="black" points="5506.98,-296.79 5496.51,-298.39 5505.69,-303.67 5506.98,-296.79"/>
</g>
<!-- Expert46_s1_l16_tp3&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2399" class="edge">
<title>Expert46_s1_l16_tp3&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M6040.02,-343.84C6037.13,-343.45 6034.26,-343.07 6031.42,-342.69 5873.67,-322.02 5694.87,-303.26 5559.51,-290.01"/>
<polygon fill="black" stroke="black" points="5559.72,-286.51 5549.43,-289.02 5559.04,-293.48 5559.72,-286.51"/>
</g>
<!-- Expert47_s1_l16_tp3&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2400" class="edge">
<title>Expert47_s1_l16_tp3&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M6366.03,-343.7C6363.14,-343.36 6360.27,-343.02 6357.42,-342.69 6093.15,-312.6 5788.51,-292.78 5583.29,-281.59"/>
<polygon fill="black" stroke="black" points="5583.46,-278.09 5573.29,-281.05 5583.08,-285.08 5583.46,-278.09"/>
</g>
<!-- Expert48_s1_l16_tp4&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2401" class="edge">
<title>Expert48_s1_l16_tp4&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M6692.04,-343.64C6689.15,-343.31 6686.27,-342.99 6683.42,-342.69 6303.67,-302.8 5860.79,-284.26 5592.14,-276.1"/>
<polygon fill="black" stroke="black" points="5591.97,-272.59 5581.87,-275.79 5591.76,-279.59 5591.97,-272.59"/>
</g>
<!-- Expert49_s1_l16_tp4&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2402" class="edge">
<title>Expert49_s1_l16_tp4&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M7018.04,-343.59C7015.15,-343.28 7012.27,-342.98 7009.42,-342.69 6509.03,-292.81 5920.55,-277.25 5594.92,-272.41"/>
<polygon fill="black" stroke="black" points="5594.94,-268.91 5584.89,-272.26 5594.83,-275.91 5594.94,-268.91"/>
</g>
<!-- Expert50_s1_l16_tp4&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2403" class="edge">
<title>Expert50_s1_l16_tp4&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M7344.05,-343.57C7341.15,-343.26 7338.27,-342.97 7335.42,-342.69 6711.45,-282.73 5973.02,-271.36 5595.68,-269.82"/>
<polygon fill="black" stroke="black" points="5595.47,-266.32 5585.45,-269.78 5595.44,-273.32 5595.47,-266.32"/>
</g>
<!-- Expert51_s1_l16_tp4&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2404" class="edge">
<title>Expert51_s1_l16_tp4&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M7670.05,-343.55C7667.15,-343.24 7664.27,-342.96 7661.42,-342.69 7266.56,-305.77 6105.77,-282.72 5593.82,-274.08"/>
<polygon fill="black" stroke="black" points="5593.77,-270.58 5583.71,-273.91 5593.65,-277.58 5593.77,-270.58"/>
</g>
<!-- Expert52_s1_l16_tp5&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2405" class="edge">
<title>Expert52_s1_l16_tp5&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M480.79,-343.48C483.69,-343.2 486.57,-342.94 489.42,-342.69 949.03,-303.51 4170.69,-278.36 5097.54,-271.88"/>
<polygon fill="black" stroke="black" points="5097.69,-275.38 5107.66,-271.81 5097.64,-268.38 5097.69,-275.38"/>
</g>
<!-- Expert53_s1_l16_tp5&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2406" class="edge">
<title>Expert53_s1_l16_tp5&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M806.79,-343.49C809.69,-343.2 812.57,-342.94 815.42,-342.69 1657.13,-270.48 4275.39,-268.42 5097.1,-269.63"/>
<polygon fill="black" stroke="black" points="5097.27,-273.13 5107.28,-269.65 5097.28,-266.13 5097.27,-273.13"/>
</g>
<!-- Expert54_s1_l16_tp5&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2407" class="edge">
<title>Expert54_s1_l16_tp5&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M1132.79,-343.49C1135.69,-343.21 1138.57,-342.94 1141.42,-342.69 1916.47,-275.71 4314.74,-270.02 5096.94,-270"/>
<polygon fill="black" stroke="black" points="5097.2,-273.5 5107.2,-270 5097.2,-266.5 5097.2,-273.5"/>
</g>
<!-- Expert55_s1_l16_tp5&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2408" class="edge">
<title>Expert55_s1_l16_tp5&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M1458.79,-343.5C1461.69,-343.21 1464.57,-342.94 1467.42,-342.69 2176.13,-280.93 4356.28,-271.75 5097.08,-270.42"/>
<polygon fill="black" stroke="black" points="5097.35,-273.92 5107.34,-270.41 5097.34,-266.92 5097.35,-273.92"/>
</g>
<!-- Expert56_s1_l16_tp6&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2409" class="edge">
<title>Expert56_s1_l16_tp6&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M9300.05,-343.49C9297.16,-343.21 9294.28,-342.94 9291.42,-342.69 8569.29,-279.87 6345.02,-271.39 5595.75,-270.33"/>
<polygon fill="black" stroke="black" points="5595.65,-266.83 5585.64,-270.32 5595.64,-273.83 5595.65,-266.83"/>
</g>
<!-- Expert57_s1_l16_tp6&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2410" class="edge">
<title>Expert57_s1_l16_tp6&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M9626.05,-343.49C9623.16,-343.21 9620.28,-342.94 9617.42,-342.69 8828.85,-274.65 6385.87,-269.69 5595.72,-269.92"/>
<polygon fill="black" stroke="black" points="5595.64,-266.42 5585.64,-269.92 5595.64,-273.42 5595.64,-266.42"/>
</g>
<!-- Expert58_s1_l16_tp6&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2411" class="edge">
<title>Expert58_s1_l16_tp6&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M9952.05,-343.48C9949.16,-343.2 9946.28,-342.94 9943.42,-342.69 9088.21,-269.42 6425.35,-268.11 5595.77,-269.56"/>
<polygon fill="black" stroke="black" points="5595.49,-266.06 5585.49,-269.58 5595.5,-273.06 5595.49,-266.06"/>
</g>
<!-- Expert59_s1_l16_tp6&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2412" class="edge">
<title>Expert59_s1_l16_tp6&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M10278.06,-343.48C10275.16,-343.2 10272.28,-342.94 10269.42,-342.69 9802.97,-302.97 6529.76,-278.16 5595.09,-271.83"/>
<polygon fill="black" stroke="black" points="5594.91,-268.33 5584.88,-271.76 5594.86,-275.33 5594.91,-268.33"/>
</g>
<!-- Expert60_s1_l16_tp7&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2413" class="edge">
<title>Expert60_s1_l16_tp7&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M7996.05,-343.53C7993.15,-343.23 7990.27,-342.95 7987.42,-342.69 7527.98,-300.62 6159.75,-279.92 5594.74,-272.98"/>
<polygon fill="black" stroke="black" points="5594.47,-269.47 5584.43,-272.85 5594.38,-276.47 5594.47,-269.47"/>
</g>
<!-- Expert61_s1_l16_tp7&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2414" class="edge">
<title>Expert61_s1_l16_tp7&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M8322.05,-343.52C8319.15,-343.23 8316.28,-342.95 8313.42,-342.69 7788.85,-295.46 6209.92,-277.44 5595.18,-272.1"/>
<polygon fill="black" stroke="black" points="5594.88,-268.6 5584.85,-272.01 5594.82,-275.6 5594.88,-268.6"/>
</g>
<!-- Expert62_s1_l16_tp7&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2415" class="edge">
<title>Expert62_s1_l16_tp7&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M8648.05,-343.51C8645.15,-343.22 8642.28,-342.95 8639.42,-342.69 8049.28,-290.27 6257.01,-275.23 5595.33,-271.4"/>
<polygon fill="black" stroke="black" points="5595.21,-267.9 5585.19,-271.34 5595.17,-274.9 5595.21,-267.9"/>
</g>
<!-- Expert63_s1_l16_tp7&#45;&gt;AR_exp_s1_l16 -->
<g id="edge2416" class="edge">
<title>Expert63_s1_l16_tp7&#45;&gt;AR_exp_s1_l16</title>
<path fill="none" stroke="black" d="M8974.05,-343.5C8971.15,-343.21 8968.28,-342.94 8965.42,-342.69 8309.39,-285.07 6301.77,-273.22 5595.43,-270.82"/>
<polygon fill="black" stroke="black" points="5595.39,-267.32 5585.38,-270.78 5595.37,-274.32 5595.39,-267.32"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp0 -->
<g id="edge2417" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp0</title>
<path fill="none" stroke="black" d="M5292.26,-232.55C5277.49,-222.82 5261.11,-212.03 5244.99,-201.41"/>
<polygon fill="black" stroke="black" points="5246.87,-198.46 5236.59,-195.88 5243.02,-204.31 5246.87,-198.46"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp1 -->
<g id="edge2419" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp1</title>
<path fill="none" stroke="black" d="M5117.41,-258.32C4799.44,-244.53 4206.2,-218.65 3700.42,-195.74 3427.53,-183.38 3117.16,-168.9 2892.96,-158.36"/>
<polygon fill="black" stroke="black" points="2892.84,-154.85 2882.69,-157.88 2892.51,-161.84 2892.84,-154.85"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp2 -->
<g id="edge2421" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp2</title>
<path fill="none" stroke="black" d="M5145.68,-248.8C4944.33,-229.33 4630.71,-198.99 4392.11,-175.92"/>
<polygon fill="black" stroke="black" points="4392.17,-172.41 4381.88,-174.93 4391.49,-179.37 4392.17,-172.41"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp3 -->
<g id="edge2423" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp3</title>
<path fill="none" stroke="black" d="M5496.19,-239.97C5578.57,-224.43 5682.57,-204.82 5775.15,-187.36"/>
<polygon fill="black" stroke="black" points="5776.04,-190.75 5785.22,-185.46 5774.75,-183.87 5776.04,-190.75"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp4 -->
<g id="edge2425" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp4</title>
<path fill="none" stroke="black" d="M5574.04,-257.71C6068.78,-234.88 7240.28,-180.81 7772.24,-156.26"/>
<polygon fill="black" stroke="black" points="7772.53,-159.75 7782.36,-155.79 7772.21,-152.75 7772.53,-159.75"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp5 -->
<g id="edge2427" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp5</title>
<path fill="none" stroke="black" d="M5110.45,-263.1C4589.61,-251.74 3302.29,-223.21 2224.42,-195.74 1669.65,-181.6 1022.54,-163.23 652.21,-152.53"/>
<polygon fill="black" stroke="black" points="652.25,-149.03 642.15,-152.24 652.05,-156.03 652.25,-149.03"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp6 -->
<g id="edge2429" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp6</title>
<path fill="none" stroke="black" d="M5584.78,-266.18C6382.16,-259.07 8952.69,-233.71 9780.42,-195.74 9923.34,-189.18 10082.64,-177.45 10212.04,-166.79"/>
<polygon fill="black" stroke="black" points="10212.41,-170.27 10222.09,-165.95 10211.84,-163.29 10212.41,-170.27"/>
</g>
<!-- AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp7 -->
<g id="edge2431" class="edge">
<title>AR_exp_s1_l16&#45;&gt;ResMOE_s1_l16_tp7</title>
<path fill="none" stroke="black" d="M5583.75,-264.79C6097.71,-256.89 7352.03,-234.99 8402.42,-195.74 8657.68,-186.2 8948.69,-170.91 9154.19,-159.37"/>
<polygon fill="black" stroke="black" points="9154.43,-162.87 9164.21,-158.81 9154.03,-155.88 9154.43,-162.87"/>
</g>
<!-- Output -->
<g id="node1458" class="node">
<title>Output</title>
<ellipse fill="none" stroke="black" cx="5157.42" cy="-26.87" rx="239" ry="26.74"/>
<text text-anchor="middle" x="5157.42" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="5157.42" y="-15.67" font-family="Times,serif" font-size="14.00">[batch_size=128,seq_len=128,hidden=1024]</text>
</g>
<!-- ResMOE_s1_l16_tp0&#45;&gt;Output -->
<g id="edge2433" class="edge">
<title>ResMOE_s1_l16_tp0&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M5157.42,-89.47C5157.42,-80.85 5157.42,-72.09 5157.42,-63.98"/>
<polygon fill="black" stroke="black" points="5160.92,-63.77 5157.42,-53.77 5153.92,-63.77 5160.92,-63.77"/>
</g>
</g>
</svg>
