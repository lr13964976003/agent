digraph Baseline {\n  rank_policy=TB;\n  node [shape=rectangle];\n\n  Input [shape=ellipse, label="Input\n[batch_size=128,seq_len=128,hidden=1024]"];\n  QKV_s0_l1_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp0;\n  QKV_s0_l1_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp1;\n  QKV_s0_l1_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp2;\n  QKV_s0_l1_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp3;\n  QKV_s0_l1_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp4;\n  QKV_s0_l1_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp5;\n  QKV_s0_l1_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp6;\n  QKV_s0_l1_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Input -> QKV_s0_l1_tp7;\n  SplitHeads_s0_l1_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp0 -> SplitHeads_s0_l1_tp0;\n  SplitHeads_s0_l1_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp1 -> SplitHeads_s0_l1_tp1;\n  SplitHeads_s0_l1_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp2 -> SplitHeads_s0_l1_tp2;\n  SplitHeads_s0_l1_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp3 -> SplitHeads_s0_l1_tp3;\n  SplitHeads_s0_l1_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp4 -> SplitHeads_s0_l1_tp4;\n  SplitHeads_s0_l1_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp5 -> SplitHeads_s0_l1_tp5;\n  SplitHeads_s0_l1_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp6 -> SplitHeads_s0_l1_tp6;\n  SplitHeads_s0_l1_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l1_tp7 -> SplitHeads_s0_l1_tp7;\n  A2A_s0_l1 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l1_tp0 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp1 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp2 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp3 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp4 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp5 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp6 -> A2A_s0_l1;\n  SplitHeads_s0_l1_tp7 -> A2A_s0_l1;\n  Attn_s0_l1_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp0;\n  Attn_s0_l1_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp1;\n  Attn_s0_l1_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp2;\n  Attn_s0_l1_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp3;\n  Attn_s0_l1_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp4;\n  Attn_s0_l1_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp5;\n  Attn_s0_l1_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp6;\n  Attn_s0_l1_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l1 -> Attn_s0_l1_tp7;\n  AR_attn_s0_l1 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l1_tp0 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp1 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp2 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp3 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp4 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp5 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp6 -> AR_attn_s0_l1;\n  Attn_s0_l1_tp7 -> AR_attn_s0_l1;\n  O_s0_l1_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp0;\n  O_s0_l1_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp1;\n  O_s0_l1_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp2;\n  O_s0_l1_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp3;\n  O_s0_l1_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp4;\n  O_s0_l1_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp5;\n  O_s0_l1_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp6;\n  O_s0_l1_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l1 -> O_s0_l1_tp7;\n  ResAttn_s0_l1_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp0 -> ResAttn_s0_l1_tp0;\n  Input -> ResAttn_s0_l1_tp0;\n  ResAttn_s0_l1_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp1 -> ResAttn_s0_l1_tp1;\n  Input -> ResAttn_s0_l1_tp1;\n  ResAttn_s0_l1_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp2 -> ResAttn_s0_l1_tp2;\n  Input -> ResAttn_s0_l1_tp2;\n  ResAttn_s0_l1_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp3 -> ResAttn_s0_l1_tp3;\n  Input -> ResAttn_s0_l1_tp3;\n  ResAttn_s0_l1_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp4 -> ResAttn_s0_l1_tp4;\n  Input -> ResAttn_s0_l1_tp4;\n  ResAttn_s0_l1_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp5 -> ResAttn_s0_l1_tp5;\n  Input -> ResAttn_s0_l1_tp5;\n  ResAttn_s0_l1_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp6 -> ResAttn_s0_l1_tp6;\n  Input -> ResAttn_s0_l1_tp6;\n  ResAttn_s0_l1_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l1_tp7 -> ResAttn_s0_l1_tp7;\n  Input -> ResAttn_s0_l1_tp7;\n  Gate_s0_l1_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp0 -> Gate_s0_l1_tp0;\n  Gate_s0_l1_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp1 -> Gate_s0_l1_tp1;\n  Gate_s0_l1_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp2 -> Gate_s0_l1_tp2;\n  Gate_s0_l1_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp3 -> Gate_s0_l1_tp3;\n  Gate_s0_l1_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp4 -> Gate_s0_l1_tp4;\n  Gate_s0_l1_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp5 -> Gate_s0_l1_tp5;\n  Gate_s0_l1_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp6 -> Gate_s0_l1_tp6;\n  Gate_s0_l1_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l1_tp7 -> Gate_s0_l1_tp7;\n  Expert0_s0_l1_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp0 -> Expert0_s0_l1_tp0 [style=dashed];\n  Expert1_s0_l1_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp0 -> Expert1_s0_l1_tp0 [style=dashed];\n  Expert2_s0_l1_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp0 -> Expert2_s0_l1_tp0 [style=dashed];\n  Expert3_s0_l1_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp0 -> Expert3_s0_l1_tp0 [style=dashed];\n  Expert4_s0_l1_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp1 -> Expert4_s0_l1_tp1 [style=dashed];\n  Expert5_s0_l1_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp1 -> Expert5_s0_l1_tp1 [style=dashed];\n  Expert6_s0_l1_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp1 -> Expert6_s0_l1_tp1 [style=dashed];\n  Expert7_s0_l1_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp1 -> Expert7_s0_l1_tp1 [style=dashed];\n  Expert8_s0_l1_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp2 -> Expert8_s0_l1_tp2 [style=dashed];\n  Expert9_s0_l1_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp2 -> Expert9_s0_l1_tp2 [style=dashed];\n  Expert10_s0_l1_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp2 -> Expert10_s0_l1_tp2 [style=dashed];\n  Expert11_s0_l1_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp2 -> Expert11_s0_l1_tp2 [style=dashed];\n  Expert12_s0_l1_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp3 -> Expert12_s0_l1_tp3 [style=dashed];\n  Expert13_s0_l1_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp3 -> Expert13_s0_l1_tp3 [style=dashed];\n  Expert14_s0_l1_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp3 -> Expert14_s0_l1_tp3 [style=dashed];\n  Expert15_s0_l1_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp3 -> Expert15_s0_l1_tp3 [style=dashed];\n  Expert16_s0_l1_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp4 -> Expert16_s0_l1_tp4 [style=dashed];\n  Expert17_s0_l1_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp4 -> Expert17_s0_l1_tp4 [style=dashed];\n  Expert18_s0_l1_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp4 -> Expert18_s0_l1_tp4 [style=dashed];\n  Expert19_s0_l1_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp4 -> Expert19_s0_l1_tp4 [style=dashed];\n  Expert20_s0_l1_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp5 -> Expert20_s0_l1_tp5 [style=dashed];\n  Expert21_s0_l1_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp5 -> Expert21_s0_l1_tp5 [style=dashed];\n  Expert22_s0_l1_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp5 -> Expert22_s0_l1_tp5 [style=dashed];\n  Expert23_s0_l1_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp5 -> Expert23_s0_l1_tp5 [style=dashed];\n  Expert24_s0_l1_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp6 -> Expert24_s0_l1_tp6 [style=dashed];\n  Expert25_s0_l1_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp6 -> Expert25_s0_l1_tp6 [style=dashed];\n  Expert26_s0_l1_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp6 -> Expert26_s0_l1_tp6 [style=dashed];\n  Expert27_s0_l1_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp6 -> Expert27_s0_l1_tp6 [style=dashed];\n  Expert28_s0_l1_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp7 -> Expert28_s0_l1_tp7 [style=dashed];\n  Expert29_s0_l1_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp7 -> Expert29_s0_l1_tp7 [style=dashed];\n  Expert30_s0_l1_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp7 -> Expert30_s0_l1_tp7 [style=dashed];\n  Expert31_s0_l1_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l1_tp7 -> Expert31_s0_l1_tp7 [style=dashed];\n  AR_exp_s0_l1 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l1_tp0 -> AR_exp_s0_l1;\n  Expert1_s0_l1_tp0 -> AR_exp_s0_l1;\n  Expert2_s0_l1_tp0 -> AR_exp_s0_l1;\n  Expert3_s0_l1_tp0 -> AR_exp_s0_l1;\n  Expert4_s0_l1_tp1 -> AR_exp_s0_l1;\n  Expert5_s0_l1_tp1 -> AR_exp_s0_l1;\n  Expert6_s0_l1_tp1 -> AR_exp_s0_l1;\n  Expert7_s0_l1_tp1 -> AR_exp_s0_l1;\n  Expert8_s0_l1_tp2 -> AR_exp_s0_l1;\n  Expert9_s0_l1_tp2 -> AR_exp_s0_l1;\n  Expert10_s0_l1_tp2 -> AR_exp_s0_l1;\n  Expert11_s0_l1_tp2 -> AR_exp_s0_l1;\n  Expert12_s0_l1_tp3 -> AR_exp_s0_l1;\n  Expert13_s0_l1_tp3 -> AR_exp_s0_l1;\n  Expert14_s0_l1_tp3 -> AR_exp_s0_l1;\n  Expert15_s0_l1_tp3 -> AR_exp_s0_l1;\n  Expert16_s0_l1_tp4 -> AR_exp_s0_l1;\n  Expert17_s0_l1_tp4 -> AR_exp_s0_l1;\n  Expert18_s0_l1_tp4 -> AR_exp_s0_l1;\n  Expert19_s0_l1_tp4 -> AR_exp_s0_l1;\n  Expert20_s0_l1_tp5 -> AR_exp_s0_l1;\n  Expert21_s0_l1_tp5 -> AR_exp_s0_l1;\n  Expert22_s0_l1_tp5 -> AR_exp_s0_l1;\n  Expert23_s0_l1_tp5 -> AR_exp_s0_l1;\n  Expert24_s0_l1_tp6 -> AR_exp_s0_l1;\n  Expert25_s0_l1_tp6 -> AR_exp_s0_l1;\n  Expert26_s0_l1_tp6 -> AR_exp_s0_l1;\n  Expert27_s0_l1_tp6 -> AR_exp_s0_l1;\n  Expert28_s0_l1_tp7 -> AR_exp_s0_l1;\n  Expert29_s0_l1_tp7 -> AR_exp_s0_l1;\n  Expert30_s0_l1_tp7 -> AR_exp_s0_l1;\n  Expert31_s0_l1_tp7 -> AR_exp_s0_l1;\n  ResMOE_s0_l1_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp0;\n  ResAttn_s0_l1_tp0 -> ResMOE_s0_l1_tp0;\n  ResMOE_s0_l1_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp1;\n  ResAttn_s0_l1_tp1 -> ResMOE_s0_l1_tp1;\n  ResMOE_s0_l1_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp2;\n  ResAttn_s0_l1_tp2 -> ResMOE_s0_l1_tp2;\n  ResMOE_s0_l1_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp3;\n  ResAttn_s0_l1_tp3 -> ResMOE_s0_l1_tp3;\n  ResMOE_s0_l1_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp4;\n  ResAttn_s0_l1_tp4 -> ResMOE_s0_l1_tp4;\n  ResMOE_s0_l1_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp5;\n  ResAttn_s0_l1_tp5 -> ResMOE_s0_l1_tp5;\n  ResMOE_s0_l1_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp6;\n  ResAttn_s0_l1_tp6 -> ResMOE_s0_l1_tp6;\n  ResMOE_s0_l1_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l1 -> ResMOE_s0_l1_tp7;\n  ResAttn_s0_l1_tp7 -> ResMOE_s0_l1_tp7;\n  QKV_s0_l2_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp0;\n  QKV_s0_l2_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp1;\n  QKV_s0_l2_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp2;\n  QKV_s0_l2_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp3;\n  QKV_s0_l2_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp4;\n  QKV_s0_l2_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp5;\n  QKV_s0_l2_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp6;\n  QKV_s0_l2_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l1_tp0 -> QKV_s0_l2_tp7;\n  SplitHeads_s0_l2_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp0 -> SplitHeads_s0_l2_tp0;\n  SplitHeads_s0_l2_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp1 -> SplitHeads_s0_l2_tp1;\n  SplitHeads_s0_l2_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp2 -> SplitHeads_s0_l2_tp2;\n  SplitHeads_s0_l2_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp3 -> SplitHeads_s0_l2_tp3;\n  SplitHeads_s0_l2_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp4 -> SplitHeads_s0_l2_tp4;\n  SplitHeads_s0_l2_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp5 -> SplitHeads_s0_l2_tp5;\n  SplitHeads_s0_l2_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp6 -> SplitHeads_s0_l2_tp6;\n  SplitHeads_s0_l2_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l2_tp7 -> SplitHeads_s0_l2_tp7;\n  A2A_s0_l2 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l2_tp0 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp1 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp2 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp3 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp4 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp5 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp6 -> A2A_s0_l2;\n  SplitHeads_s0_l2_tp7 -> A2A_s0_l2;\n  Attn_s0_l2_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp0;\n  Attn_s0_l2_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp1;\n  Attn_s0_l2_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp2;\n  Attn_s0_l2_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp3;\n  Attn_s0_l2_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp4;\n  Attn_s0_l2_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp5;\n  Attn_s0_l2_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp6;\n  Attn_s0_l2_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l2 -> Attn_s0_l2_tp7;\n  AR_attn_s0_l2 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l2_tp0 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp1 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp2 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp3 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp4 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp5 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp6 -> AR_attn_s0_l2;\n  Attn_s0_l2_tp7 -> AR_attn_s0_l2;\n  O_s0_l2_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp0;\n  O_s0_l2_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp1;\n  O_s0_l2_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp2;\n  O_s0_l2_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp3;\n  O_s0_l2_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp4;\n  O_s0_l2_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp5;\n  O_s0_l2_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp6;\n  O_s0_l2_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l2 -> O_s0_l2_tp7;\n  ResAttn_s0_l2_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp0 -> ResAttn_s0_l2_tp0;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp0;\n  ResAttn_s0_l2_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp1 -> ResAttn_s0_l2_tp1;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp1;\n  ResAttn_s0_l2_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp2 -> ResAttn_s0_l2_tp2;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp2;\n  ResAttn_s0_l2_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp3 -> ResAttn_s0_l2_tp3;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp3;\n  ResAttn_s0_l2_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp4 -> ResAttn_s0_l2_tp4;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp4;\n  ResAttn_s0_l2_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp5 -> ResAttn_s0_l2_tp5;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp5;\n  ResAttn_s0_l2_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp6 -> ResAttn_s0_l2_tp6;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp6;\n  ResAttn_s0_l2_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l2_tp7 -> ResAttn_s0_l2_tp7;\n  ResMOE_s0_l1_tp0 -> ResAttn_s0_l2_tp7;\n  Gate_s0_l2_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp0 -> Gate_s0_l2_tp0;\n  Gate_s0_l2_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp1 -> Gate_s0_l2_tp1;\n  Gate_s0_l2_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp2 -> Gate_s0_l2_tp2;\n  Gate_s0_l2_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp3 -> Gate_s0_l2_tp3;\n  Gate_s0_l2_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp4 -> Gate_s0_l2_tp4;\n  Gate_s0_l2_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp5 -> Gate_s0_l2_tp5;\n  Gate_s0_l2_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp6 -> Gate_s0_l2_tp6;\n  Gate_s0_l2_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l2_tp7 -> Gate_s0_l2_tp7;\n  Expert0_s0_l2_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp0 -> Expert0_s0_l2_tp0 [style=dashed];\n  Expert1_s0_l2_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp0 -> Expert1_s0_l2_tp0 [style=dashed];\n  Expert2_s0_l2_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp0 -> Expert2_s0_l2_tp0 [style=dashed];\n  Expert3_s0_l2_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp0 -> Expert3_s0_l2_tp0 [style=dashed];\n  Expert4_s0_l2_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp1 -> Expert4_s0_l2_tp1 [style=dashed];\n  Expert5_s0_l2_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp1 -> Expert5_s0_l2_tp1 [style=dashed];\n  Expert6_s0_l2_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp1 -> Expert6_s0_l2_tp1 [style=dashed];\n  Expert7_s0_l2_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp1 -> Expert7_s0_l2_tp1 [style=dashed];\n  Expert8_s0_l2_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp2 -> Expert8_s0_l2_tp2 [style=dashed];\n  Expert9_s0_l2_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp2 -> Expert9_s0_l2_tp2 [style=dashed];\n  Expert10_s0_l2_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp2 -> Expert10_s0_l2_tp2 [style=dashed];\n  Expert11_s0_l2_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp2 -> Expert11_s0_l2_tp2 [style=dashed];\n  Expert12_s0_l2_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp3 -> Expert12_s0_l2_tp3 [style=dashed];\n  Expert13_s0_l2_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp3 -> Expert13_s0_l2_tp3 [style=dashed];\n  Expert14_s0_l2_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp3 -> Expert14_s0_l2_tp3 [style=dashed];\n  Expert15_s0_l2_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp3 -> Expert15_s0_l2_tp3 [style=dashed];\n  Expert16_s0_l2_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp4 -> Expert16_s0_l2_tp4 [style=dashed];\n  Expert17_s0_l2_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp4 -> Expert17_s0_l2_tp4 [style=dashed];\n  Expert18_s0_l2_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp4 -> Expert18_s0_l2_tp4 [style=dashed];\n  Expert19_s0_l2_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp4 -> Expert19_s0_l2_tp4 [style=dashed];\n  Expert20_s0_l2_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp5 -> Expert20_s0_l2_tp5 [style=dashed];\n  Expert21_s0_l2_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp5 -> Expert21_s0_l2_tp5 [style=dashed];\n  Expert22_s0_l2_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp5 -> Expert22_s0_l2_tp5 [style=dashed];\n  Expert23_s0_l2_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp5 -> Expert23_s0_l2_tp5 [style=dashed];\n  Expert24_s0_l2_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp6 -> Expert24_s0_l2_tp6 [style=dashed];\n  Expert25_s0_l2_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp6 -> Expert25_s0_l2_tp6 [style=dashed];\n  Expert26_s0_l2_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp6 -> Expert26_s0_l2_tp6 [style=dashed];\n  Expert27_s0_l2_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp6 -> Expert27_s0_l2_tp6 [style=dashed];\n  Expert28_s0_l2_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp7 -> Expert28_s0_l2_tp7 [style=dashed];\n  Expert29_s0_l2_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp7 -> Expert29_s0_l2_tp7 [style=dashed];\n  Expert30_s0_l2_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp7 -> Expert30_s0_l2_tp7 [style=dashed];\n  Expert31_s0_l2_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l2_tp7 -> Expert31_s0_l2_tp7 [style=dashed];\n  AR_exp_s0_l2 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l2_tp0 -> AR_exp_s0_l2;\n  Expert1_s0_l2_tp0 -> AR_exp_s0_l2;\n  Expert2_s0_l2_tp0 -> AR_exp_s0_l2;\n  Expert3_s0_l2_tp0 -> AR_exp_s0_l2;\n  Expert4_s0_l2_tp1 -> AR_exp_s0_l2;\n  Expert5_s0_l2_tp1 -> AR_exp_s0_l2;\n  Expert6_s0_l2_tp1 -> AR_exp_s0_l2;\n  Expert7_s0_l2_tp1 -> AR_exp_s0_l2;\n  Expert8_s0_l2_tp2 -> AR_exp_s0_l2;\n  Expert9_s0_l2_tp2 -> AR_exp_s0_l2;\n  Expert10_s0_l2_tp2 -> AR_exp_s0_l2;\n  Expert11_s0_l2_tp2 -> AR_exp_s0_l2;\n  Expert12_s0_l2_tp3 -> AR_exp_s0_l2;\n  Expert13_s0_l2_tp3 -> AR_exp_s0_l2;\n  Expert14_s0_l2_tp3 -> AR_exp_s0_l2;\n  Expert15_s0_l2_tp3 -> AR_exp_s0_l2;\n  Expert16_s0_l2_tp4 -> AR_exp_s0_l2;\n  Expert17_s0_l2_tp4 -> AR_exp_s0_l2;\n  Expert18_s0_l2_tp4 -> AR_exp_s0_l2;\n  Expert19_s0_l2_tp4 -> AR_exp_s0_l2;\n  Expert20_s0_l2_tp5 -> AR_exp_s0_l2;\n  Expert21_s0_l2_tp5 -> AR_exp_s0_l2;\n  Expert22_s0_l2_tp5 -> AR_exp_s0_l2;\n  Expert23_s0_l2_tp5 -> AR_exp_s0_l2;\n  Expert24_s0_l2_tp6 -> AR_exp_s0_l2;\n  Expert25_s0_l2_tp6 -> AR_exp_s0_l2;\n  Expert26_s0_l2_tp6 -> AR_exp_s0_l2;\n  Expert27_s0_l2_tp6 -> AR_exp_s0_l2;\n  Expert28_s0_l2_tp7 -> AR_exp_s0_l2;\n  Expert29_s0_l2_tp7 -> AR_exp_s0_l2;\n  Expert30_s0_l2_tp7 -> AR_exp_s0_l2;\n  Expert31_s0_l2_tp7 -> AR_exp_s0_l2;\n  ResMOE_s0_l2_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp0;\n  ResAttn_s0_l2_tp0 -> ResMOE_s0_l2_tp0;\n  ResMOE_s0_l2_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp1;\n  ResAttn_s0_l2_tp1 -> ResMOE_s0_l2_tp1;\n  ResMOE_s0_l2_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp2;\n  ResAttn_s0_l2_tp2 -> ResMOE_s0_l2_tp2;\n  ResMOE_s0_l2_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp3;\n  ResAttn_s0_l2_tp3 -> ResMOE_s0_l2_tp3;\n  ResMOE_s0_l2_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp4;\n  ResAttn_s0_l2_tp4 -> ResMOE_s0_l2_tp4;\n  ResMOE_s0_l2_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp5;\n  ResAttn_s0_l2_tp5 -> ResMOE_s0_l2_tp5;\n  ResMOE_s0_l2_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp6;\n  ResAttn_s0_l2_tp6 -> ResMOE_s0_l2_tp6;\n  ResMOE_s0_l2_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l2 -> ResMOE_s0_l2_tp7;\n  ResAttn_s0_l2_tp7 -> ResMOE_s0_l2_tp7;\n  QKV_s0_l3_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp0;\n  QKV_s0_l3_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp1;\n  QKV_s0_l3_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp2;\n  QKV_s0_l3_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp3;\n  QKV_s0_l3_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp4;\n  QKV_s0_l3_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp5;\n  QKV_s0_l3_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp6;\n  QKV_s0_l3_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l2_tp0 -> QKV_s0_l3_tp7;\n  SplitHeads_s0_l3_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp0 -> SplitHeads_s0_l3_tp0;\n  SplitHeads_s0_l3_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp1 -> SplitHeads_s0_l3_tp1;\n  SplitHeads_s0_l3_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp2 -> SplitHeads_s0_l3_tp2;\n  SplitHeads_s0_l3_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp3 -> SplitHeads_s0_l3_tp3;\n  SplitHeads_s0_l3_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp4 -> SplitHeads_s0_l3_tp4;\n  SplitHeads_s0_l3_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp5 -> SplitHeads_s0_l3_tp5;\n  SplitHeads_s0_l3_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp6 -> SplitHeads_s0_l3_tp6;\n  SplitHeads_s0_l3_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l3_tp7 -> SplitHeads_s0_l3_tp7;\n  A2A_s0_l3 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l3_tp0 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp1 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp2 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp3 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp4 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp5 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp6 -> A2A_s0_l3;\n  SplitHeads_s0_l3_tp7 -> A2A_s0_l3;\n  Attn_s0_l3_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp0;\n  Attn_s0_l3_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp1;\n  Attn_s0_l3_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp2;\n  Attn_s0_l3_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp3;\n  Attn_s0_l3_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp4;\n  Attn_s0_l3_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp5;\n  Attn_s0_l3_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp6;\n  Attn_s0_l3_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l3 -> Attn_s0_l3_tp7;\n  AR_attn_s0_l3 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l3_tp0 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp1 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp2 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp3 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp4 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp5 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp6 -> AR_attn_s0_l3;\n  Attn_s0_l3_tp7 -> AR_attn_s0_l3;\n  O_s0_l3_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp0;\n  O_s0_l3_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp1;\n  O_s0_l3_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp2;\n  O_s0_l3_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp3;\n  O_s0_l3_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp4;\n  O_s0_l3_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp5;\n  O_s0_l3_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp6;\n  O_s0_l3_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l3 -> O_s0_l3_tp7;\n  ResAttn_s0_l3_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp0 -> ResAttn_s0_l3_tp0;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp0;\n  ResAttn_s0_l3_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp1 -> ResAttn_s0_l3_tp1;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp1;\n  ResAttn_s0_l3_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp2 -> ResAttn_s0_l3_tp2;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp2;\n  ResAttn_s0_l3_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp3 -> ResAttn_s0_l3_tp3;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp3;\n  ResAttn_s0_l3_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp4 -> ResAttn_s0_l3_tp4;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp4;\n  ResAttn_s0_l3_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp5 -> ResAttn_s0_l3_tp5;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp5;\n  ResAttn_s0_l3_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp6 -> ResAttn_s0_l3_tp6;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp6;\n  ResAttn_s0_l3_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l3_tp7 -> ResAttn_s0_l3_tp7;\n  ResMOE_s0_l2_tp0 -> ResAttn_s0_l3_tp7;\n  Gate_s0_l3_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp0 -> Gate_s0_l3_tp0;\n  Gate_s0_l3_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp1 -> Gate_s0_l3_tp1;\n  Gate_s0_l3_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp2 -> Gate_s0_l3_tp2;\n  Gate_s0_l3_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp3 -> Gate_s0_l3_tp3;\n  Gate_s0_l3_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp4 -> Gate_s0_l3_tp4;\n  Gate_s0_l3_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp5 -> Gate_s0_l3_tp5;\n  Gate_s0_l3_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp6 -> Gate_s0_l3_tp6;\n  Gate_s0_l3_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l3_tp7 -> Gate_s0_l3_tp7;\n  Expert0_s0_l3_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp0 -> Expert0_s0_l3_tp0 [style=dashed];\n  Expert1_s0_l3_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp0 -> Expert1_s0_l3_tp0 [style=dashed];\n  Expert2_s0_l3_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp0 -> Expert2_s0_l3_tp0 [style=dashed];\n  Expert3_s0_l3_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp0 -> Expert3_s0_l3_tp0 [style=dashed];\n  Expert4_s0_l3_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp1 -> Expert4_s0_l3_tp1 [style=dashed];\n  Expert5_s0_l3_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp1 -> Expert5_s0_l3_tp1 [style=dashed];\n  Expert6_s0_l3_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp1 -> Expert6_s0_l3_tp1 [style=dashed];\n  Expert7_s0_l3_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp1 -> Expert7_s0_l3_tp1 [style=dashed];\n  Expert8_s0_l3_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp2 -> Expert8_s0_l3_tp2 [style=dashed];\n  Expert9_s0_l3_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp2 -> Expert9_s0_l3_tp2 [style=dashed];\n  Expert10_s0_l3_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp2 -> Expert10_s0_l3_tp2 [style=dashed];\n  Expert11_s0_l3_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp2 -> Expert11_s0_l3_tp2 [style=dashed];\n  Expert12_s0_l3_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp3 -> Expert12_s0_l3_tp3 [style=dashed];\n  Expert13_s0_l3_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp3 -> Expert13_s0_l3_tp3 [style=dashed];\n  Expert14_s0_l3_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp3 -> Expert14_s0_l3_tp3 [style=dashed];\n  Expert15_s0_l3_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp3 -> Expert15_s0_l3_tp3 [style=dashed];\n  Expert16_s0_l3_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp4 -> Expert16_s0_l3_tp4 [style=dashed];\n  Expert17_s0_l3_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp4 -> Expert17_s0_l3_tp4 [style=dashed];\n  Expert18_s0_l3_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp4 -> Expert18_s0_l3_tp4 [style=dashed];\n  Expert19_s0_l3_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp4 -> Expert19_s0_l3_tp4 [style=dashed];\n  Expert20_s0_l3_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp5 -> Expert20_s0_l3_tp5 [style=dashed];\n  Expert21_s0_l3_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp5 -> Expert21_s0_l3_tp5 [style=dashed];\n  Expert22_s0_l3_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp5 -> Expert22_s0_l3_tp5 [style=dashed];\n  Expert23_s0_l3_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp5 -> Expert23_s0_l3_tp5 [style=dashed];\n  Expert24_s0_l3_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp6 -> Expert24_s0_l3_tp6 [style=dashed];\n  Expert25_s0_l3_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp6 -> Expert25_s0_l3_tp6 [style=dashed];\n  Expert26_s0_l3_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp6 -> Expert26_s0_l3_tp6 [style=dashed];\n  Expert27_s0_l3_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp6 -> Expert27_s0_l3_tp6 [style=dashed];\n  Expert28_s0_l3_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp7 -> Expert28_s0_l3_tp7 [style=dashed];\n  Expert29_s0_l3_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp7 -> Expert29_s0_l3_tp7 [style=dashed];\n  Expert30_s0_l3_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp7 -> Expert30_s0_l3_tp7 [style=dashed];\n  Expert31_s0_l3_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l3_tp7 -> Expert31_s0_l3_tp7 [style=dashed];\n  AR_exp_s0_l3 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l3_tp0 -> AR_exp_s0_l3;\n  Expert1_s0_l3_tp0 -> AR_exp_s0_l3;\n  Expert2_s0_l3_tp0 -> AR_exp_s0_l3;\n  Expert3_s0_l3_tp0 -> AR_exp_s0_l3;\n  Expert4_s0_l3_tp1 -> AR_exp_s0_l3;\n  Expert5_s0_l3_tp1 -> AR_exp_s0_l3;\n  Expert6_s0_l3_tp1 -> AR_exp_s0_l3;\n  Expert7_s0_l3_tp1 -> AR_exp_s0_l3;\n  Expert8_s0_l3_tp2 -> AR_exp_s0_l3;\n  Expert9_s0_l3_tp2 -> AR_exp_s0_l3;\n  Expert10_s0_l3_tp2 -> AR_exp_s0_l3;\n  Expert11_s0_l3_tp2 -> AR_exp_s0_l3;\n  Expert12_s0_l3_tp3 -> AR_exp_s0_l3;\n  Expert13_s0_l3_tp3 -> AR_exp_s0_l3;\n  Expert14_s0_l3_tp3 -> AR_exp_s0_l3;\n  Expert15_s0_l3_tp3 -> AR_exp_s0_l3;\n  Expert16_s0_l3_tp4 -> AR_exp_s0_l3;\n  Expert17_s0_l3_tp4 -> AR_exp_s0_l3;\n  Expert18_s0_l3_tp4 -> AR_exp_s0_l3;\n  Expert19_s0_l3_tp4 -> AR_exp_s0_l3;\n  Expert20_s0_l3_tp5 -> AR_exp_s0_l3;\n  Expert21_s0_l3_tp5 -> AR_exp_s0_l3;\n  Expert22_s0_l3_tp5 -> AR_exp_s0_l3;\n  Expert23_s0_l3_tp5 -> AR_exp_s0_l3;\n  Expert24_s0_l3_tp6 -> AR_exp_s0_l3;\n  Expert25_s0_l3_tp6 -> AR_exp_s0_l3;\n  Expert26_s0_l3_tp6 -> AR_exp_s0_l3;\n  Expert27_s0_l3_tp6 -> AR_exp_s0_l3;\n  Expert28_s0_l3_tp7 -> AR_exp_s0_l3;\n  Expert29_s0_l3_tp7 -> AR_exp_s0_l3;\n  Expert30_s0_l3_tp7 -> AR_exp_s0_l3;\n  Expert31_s0_l3_tp7 -> AR_exp_s0_l3;\n  ResMOE_s0_l3_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp0;\n  ResAttn_s0_l3_tp0 -> ResMOE_s0_l3_tp0;\n  ResMOE_s0_l3_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp1;\n  ResAttn_s0_l3_tp1 -> ResMOE_s0_l3_tp1;\n  ResMOE_s0_l3_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp2;\n  ResAttn_s0_l3_tp2 -> ResMOE_s0_l3_tp2;\n  ResMOE_s0_l3_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp3;\n  ResAttn_s0_l3_tp3 -> ResMOE_s0_l3_tp3;\n  ResMOE_s0_l3_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp4;\n  ResAttn_s0_l3_tp4 -> ResMOE_s0_l3_tp4;\n  ResMOE_s0_l3_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp5;\n  ResAttn_s0_l3_tp5 -> ResMOE_s0_l3_tp5;\n  ResMOE_s0_l3_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp6;\n  ResAttn_s0_l3_tp6 -> ResMOE_s0_l3_tp6;\n  ResMOE_s0_l3_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l3 -> ResMOE_s0_l3_tp7;\n  ResAttn_s0_l3_tp7 -> ResMOE_s0_l3_tp7;\n  QKV_s0_l4_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp0;\n  QKV_s0_l4_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp1;\n  QKV_s0_l4_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp2;\n  QKV_s0_l4_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp3;\n  QKV_s0_l4_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp4;\n  QKV_s0_l4_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp5;\n  QKV_s0_l4_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp6;\n  QKV_s0_l4_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l3_tp0 -> QKV_s0_l4_tp7;\n  SplitHeads_s0_l4_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp0 -> SplitHeads_s0_l4_tp0;\n  SplitHeads_s0_l4_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp1 -> SplitHeads_s0_l4_tp1;\n  SplitHeads_s0_l4_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp2 -> SplitHeads_s0_l4_tp2;\n  SplitHeads_s0_l4_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp3 -> SplitHeads_s0_l4_tp3;\n  SplitHeads_s0_l4_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp4 -> SplitHeads_s0_l4_tp4;\n  SplitHeads_s0_l4_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp5 -> SplitHeads_s0_l4_tp5;\n  SplitHeads_s0_l4_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp6 -> SplitHeads_s0_l4_tp6;\n  SplitHeads_s0_l4_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l4_tp7 -> SplitHeads_s0_l4_tp7;\n  A2A_s0_l4 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l4_tp0 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp1 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp2 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp3 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp4 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp5 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp6 -> A2A_s0_l4;\n  SplitHeads_s0_l4_tp7 -> A2A_s0_l4;\n  Attn_s0_l4_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp0;\n  Attn_s0_l4_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp1;\n  Attn_s0_l4_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp2;\n  Attn_s0_l4_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp3;\n  Attn_s0_l4_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp4;\n  Attn_s0_l4_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp5;\n  Attn_s0_l4_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp6;\n  Attn_s0_l4_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l4 -> Attn_s0_l4_tp7;\n  AR_attn_s0_l4 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l4_tp0 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp1 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp2 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp3 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp4 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp5 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp6 -> AR_attn_s0_l4;\n  Attn_s0_l4_tp7 -> AR_attn_s0_l4;\n  O_s0_l4_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp0;\n  O_s0_l4_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp1;\n  O_s0_l4_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp2;\n  O_s0_l4_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp3;\n  O_s0_l4_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp4;\n  O_s0_l4_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp5;\n  O_s0_l4_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp6;\n  O_s0_l4_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l4 -> O_s0_l4_tp7;\n  ResAttn_s0_l4_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp0 -> ResAttn_s0_l4_tp0;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp0;\n  ResAttn_s0_l4_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp1 -> ResAttn_s0_l4_tp1;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp1;\n  ResAttn_s0_l4_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp2 -> ResAttn_s0_l4_tp2;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp2;\n  ResAttn_s0_l4_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp3 -> ResAttn_s0_l4_tp3;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp3;\n  ResAttn_s0_l4_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp4 -> ResAttn_s0_l4_tp4;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp4;\n  ResAttn_s0_l4_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp5 -> ResAttn_s0_l4_tp5;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp5;\n  ResAttn_s0_l4_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp6 -> ResAttn_s0_l4_tp6;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp6;\n  ResAttn_s0_l4_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l4_tp7 -> ResAttn_s0_l4_tp7;\n  ResMOE_s0_l3_tp0 -> ResAttn_s0_l4_tp7;\n  Gate_s0_l4_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp0 -> Gate_s0_l4_tp0;\n  Gate_s0_l4_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp1 -> Gate_s0_l4_tp1;\n  Gate_s0_l4_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp2 -> Gate_s0_l4_tp2;\n  Gate_s0_l4_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp3 -> Gate_s0_l4_tp3;\n  Gate_s0_l4_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp4 -> Gate_s0_l4_tp4;\n  Gate_s0_l4_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp5 -> Gate_s0_l4_tp5;\n  Gate_s0_l4_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp6 -> Gate_s0_l4_tp6;\n  Gate_s0_l4_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l4_tp7 -> Gate_s0_l4_tp7;\n  Expert0_s0_l4_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp0 -> Expert0_s0_l4_tp0 [style=dashed];\n  Expert1_s0_l4_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp0 -> Expert1_s0_l4_tp0 [style=dashed];\n  Expert2_s0_l4_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp0 -> Expert2_s0_l4_tp0 [style=dashed];\n  Expert3_s0_l4_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp0 -> Expert3_s0_l4_tp0 [style=dashed];\n  Expert4_s0_l4_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp1 -> Expert4_s0_l4_tp1 [style=dashed];\n  Expert5_s0_l4_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp1 -> Expert5_s0_l4_tp1 [style=dashed];\n  Expert6_s0_l4_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp1 -> Expert6_s0_l4_tp1 [style=dashed];\n  Expert7_s0_l4_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp1 -> Expert7_s0_l4_tp1 [style=dashed];\n  Expert8_s0_l4_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp2 -> Expert8_s0_l4_tp2 [style=dashed];\n  Expert9_s0_l4_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp2 -> Expert9_s0_l4_tp2 [style=dashed];\n  Expert10_s0_l4_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp2 -> Expert10_s0_l4_tp2 [style=dashed];\n  Expert11_s0_l4_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp2 -> Expert11_s0_l4_tp2 [style=dashed];\n  Expert12_s0_l4_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp3 -> Expert12_s0_l4_tp3 [style=dashed];\n  Expert13_s0_l4_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp3 -> Expert13_s0_l4_tp3 [style=dashed];\n  Expert14_s0_l4_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp3 -> Expert14_s0_l4_tp3 [style=dashed];\n  Expert15_s0_l4_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp3 -> Expert15_s0_l4_tp3 [style=dashed];\n  Expert16_s0_l4_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp4 -> Expert16_s0_l4_tp4 [style=dashed];\n  Expert17_s0_l4_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp4 -> Expert17_s0_l4_tp4 [style=dashed];\n  Expert18_s0_l4_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp4 -> Expert18_s0_l4_tp4 [style=dashed];\n  Expert19_s0_l4_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp4 -> Expert19_s0_l4_tp4 [style=dashed];\n  Expert20_s0_l4_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp5 -> Expert20_s0_l4_tp5 [style=dashed];\n  Expert21_s0_l4_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp5 -> Expert21_s0_l4_tp5 [style=dashed];\n  Expert22_s0_l4_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp5 -> Expert22_s0_l4_tp5 [style=dashed];\n  Expert23_s0_l4_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp5 -> Expert23_s0_l4_tp5 [style=dashed];\n  Expert24_s0_l4_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp6 -> Expert24_s0_l4_tp6 [style=dashed];\n  Expert25_s0_l4_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp6 -> Expert25_s0_l4_tp6 [style=dashed];\n  Expert26_s0_l4_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp6 -> Expert26_s0_l4_tp6 [style=dashed];\n  Expert27_s0_l4_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp6 -> Expert27_s0_l4_tp6 [style=dashed];\n  Expert28_s0_l4_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp7 -> Expert28_s0_l4_tp7 [style=dashed];\n  Expert29_s0_l4_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp7 -> Expert29_s0_l4_tp7 [style=dashed];\n  Expert30_s0_l4_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp7 -> Expert30_s0_l4_tp7 [style=dashed];\n  Expert31_s0_l4_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l4_tp7 -> Expert31_s0_l4_tp7 [style=dashed];\n  AR_exp_s0_l4 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l4_tp0 -> AR_exp_s0_l4;\n  Expert1_s0_l4_tp0 -> AR_exp_s0_l4;\n  Expert2_s0_l4_tp0 -> AR_exp_s0_l4;\n  Expert3_s0_l4_tp0 -> AR_exp_s0_l4;\n  Expert4_s0_l4_tp1 -> AR_exp_s0_l4;\n  Expert5_s0_l4_tp1 -> AR_exp_s0_l4;\n  Expert6_s0_l4_tp1 -> AR_exp_s0_l4;\n  Expert7_s0_l4_tp1 -> AR_exp_s0_l4;\n  Expert8_s0_l4_tp2 -> AR_exp_s0_l4;\n  Expert9_s0_l4_tp2 -> AR_exp_s0_l4;\n  Expert10_s0_l4_tp2 -> AR_exp_s0_l4;\n  Expert11_s0_l4_tp2 -> AR_exp_s0_l4;\n  Expert12_s0_l4_tp3 -> AR_exp_s0_l4;\n  Expert13_s0_l4_tp3 -> AR_exp_s0_l4;\n  Expert14_s0_l4_tp3 -> AR_exp_s0_l4;\n  Expert15_s0_l4_tp3 -> AR_exp_s0_l4;\n  Expert16_s0_l4_tp4 -> AR_exp_s0_l4;\n  Expert17_s0_l4_tp4 -> AR_exp_s0_l4;\n  Expert18_s0_l4_tp4 -> AR_exp_s0_l4;\n  Expert19_s0_l4_tp4 -> AR_exp_s0_l4;\n  Expert20_s0_l4_tp5 -> AR_exp_s0_l4;\n  Expert21_s0_l4_tp5 -> AR_exp_s0_l4;\n  Expert22_s0_l4_tp5 -> AR_exp_s0_l4;\n  Expert23_s0_l4_tp5 -> AR_exp_s0_l4;\n  Expert24_s0_l4_tp6 -> AR_exp_s0_l4;\n  Expert25_s0_l4_tp6 -> AR_exp_s0_l4;\n  Expert26_s0_l4_tp6 -> AR_exp_s0_l4;\n  Expert27_s0_l4_tp6 -> AR_exp_s0_l4;\n  Expert28_s0_l4_tp7 -> AR_exp_s0_l4;\n  Expert29_s0_l4_tp7 -> AR_exp_s0_l4;\n  Expert30_s0_l4_tp7 -> AR_exp_s0_l4;\n  Expert31_s0_l4_tp7 -> AR_exp_s0_l4;\n  ResMOE_s0_l4_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp0;\n  ResAttn_s0_l4_tp0 -> ResMOE_s0_l4_tp0;\n  ResMOE_s0_l4_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp1;\n  ResAttn_s0_l4_tp1 -> ResMOE_s0_l4_tp1;\n  ResMOE_s0_l4_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp2;\n  ResAttn_s0_l4_tp2 -> ResMOE_s0_l4_tp2;\n  ResMOE_s0_l4_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp3;\n  ResAttn_s0_l4_tp3 -> ResMOE_s0_l4_tp3;\n  ResMOE_s0_l4_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp4;\n  ResAttn_s0_l4_tp4 -> ResMOE_s0_l4_tp4;\n  ResMOE_s0_l4_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp5;\n  ResAttn_s0_l4_tp5 -> ResMOE_s0_l4_tp5;\n  ResMOE_s0_l4_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp6;\n  ResAttn_s0_l4_tp6 -> ResMOE_s0_l4_tp6;\n  ResMOE_s0_l4_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l4 -> ResMOE_s0_l4_tp7;\n  ResAttn_s0_l4_tp7 -> ResMOE_s0_l4_tp7;\n  QKV_s0_l5_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp0;\n  QKV_s0_l5_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp1;\n  QKV_s0_l5_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp2;\n  QKV_s0_l5_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp3;\n  QKV_s0_l5_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp4;\n  QKV_s0_l5_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp5;\n  QKV_s0_l5_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp6;\n  QKV_s0_l5_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l4_tp0 -> QKV_s0_l5_tp7;\n  SplitHeads_s0_l5_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp0 -> SplitHeads_s0_l5_tp0;\n  SplitHeads_s0_l5_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp1 -> SplitHeads_s0_l5_tp1;\n  SplitHeads_s0_l5_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp2 -> SplitHeads_s0_l5_tp2;\n  SplitHeads_s0_l5_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp3 -> SplitHeads_s0_l5_tp3;\n  SplitHeads_s0_l5_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp4 -> SplitHeads_s0_l5_tp4;\n  SplitHeads_s0_l5_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp5 -> SplitHeads_s0_l5_tp5;\n  SplitHeads_s0_l5_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp6 -> SplitHeads_s0_l5_tp6;\n  SplitHeads_s0_l5_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l5_tp7 -> SplitHeads_s0_l5_tp7;\n  A2A_s0_l5 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l5_tp0 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp1 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp2 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp3 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp4 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp5 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp6 -> A2A_s0_l5;\n  SplitHeads_s0_l5_tp7 -> A2A_s0_l5;\n  Attn_s0_l5_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp0;\n  Attn_s0_l5_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp1;\n  Attn_s0_l5_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp2;\n  Attn_s0_l5_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp3;\n  Attn_s0_l5_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp4;\n  Attn_s0_l5_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp5;\n  Attn_s0_l5_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp6;\n  Attn_s0_l5_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l5 -> Attn_s0_l5_tp7;\n  AR_attn_s0_l5 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l5_tp0 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp1 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp2 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp3 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp4 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp5 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp6 -> AR_attn_s0_l5;\n  Attn_s0_l5_tp7 -> AR_attn_s0_l5;\n  O_s0_l5_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp0;\n  O_s0_l5_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp1;\n  O_s0_l5_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp2;\n  O_s0_l5_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp3;\n  O_s0_l5_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp4;\n  O_s0_l5_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp5;\n  O_s0_l5_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp6;\n  O_s0_l5_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l5 -> O_s0_l5_tp7;\n  ResAttn_s0_l5_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp0 -> ResAttn_s0_l5_tp0;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp0;\n  ResAttn_s0_l5_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp1 -> ResAttn_s0_l5_tp1;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp1;\n  ResAttn_s0_l5_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp2 -> ResAttn_s0_l5_tp2;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp2;\n  ResAttn_s0_l5_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp3 -> ResAttn_s0_l5_tp3;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp3;\n  ResAttn_s0_l5_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp4 -> ResAttn_s0_l5_tp4;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp4;\n  ResAttn_s0_l5_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp5 -> ResAttn_s0_l5_tp5;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp5;\n  ResAttn_s0_l5_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp6 -> ResAttn_s0_l5_tp6;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp6;\n  ResAttn_s0_l5_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l5_tp7 -> ResAttn_s0_l5_tp7;\n  ResMOE_s0_l4_tp0 -> ResAttn_s0_l5_tp7;\n  Gate_s0_l5_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp0 -> Gate_s0_l5_tp0;\n  Gate_s0_l5_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp1 -> Gate_s0_l5_tp1;\n  Gate_s0_l5_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp2 -> Gate_s0_l5_tp2;\n  Gate_s0_l5_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp3 -> Gate_s0_l5_tp3;\n  Gate_s0_l5_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp4 -> Gate_s0_l5_tp4;\n  Gate_s0_l5_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp5 -> Gate_s0_l5_tp5;\n  Gate_s0_l5_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp6 -> Gate_s0_l5_tp6;\n  Gate_s0_l5_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l5_tp7 -> Gate_s0_l5_tp7;\n  Expert0_s0_l5_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp0 -> Expert0_s0_l5_tp0 [style=dashed];\n  Expert1_s0_l5_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp0 -> Expert1_s0_l5_tp0 [style=dashed];\n  Expert2_s0_l5_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp0 -> Expert2_s0_l5_tp0 [style=dashed];\n  Expert3_s0_l5_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp0 -> Expert3_s0_l5_tp0 [style=dashed];\n  Expert4_s0_l5_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp1 -> Expert4_s0_l5_tp1 [style=dashed];\n  Expert5_s0_l5_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp1 -> Expert5_s0_l5_tp1 [style=dashed];\n  Expert6_s0_l5_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp1 -> Expert6_s0_l5_tp1 [style=dashed];\n  Expert7_s0_l5_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp1 -> Expert7_s0_l5_tp1 [style=dashed];\n  Expert8_s0_l5_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp2 -> Expert8_s0_l5_tp2 [style=dashed];\n  Expert9_s0_l5_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp2 -> Expert9_s0_l5_tp2 [style=dashed];\n  Expert10_s0_l5_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp2 -> Expert10_s0_l5_tp2 [style=dashed];\n  Expert11_s0_l5_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp2 -> Expert11_s0_l5_tp2 [style=dashed];\n  Expert12_s0_l5_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp3 -> Expert12_s0_l5_tp3 [style=dashed];\n  Expert13_s0_l5_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp3 -> Expert13_s0_l5_tp3 [style=dashed];\n  Expert14_s0_l5_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp3 -> Expert14_s0_l5_tp3 [style=dashed];\n  Expert15_s0_l5_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp3 -> Expert15_s0_l5_tp3 [style=dashed];\n  Expert16_s0_l5_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp4 -> Expert16_s0_l5_tp4 [style=dashed];\n  Expert17_s0_l5_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp4 -> Expert17_s0_l5_tp4 [style=dashed];\n  Expert18_s0_l5_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp4 -> Expert18_s0_l5_tp4 [style=dashed];\n  Expert19_s0_l5_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp4 -> Expert19_s0_l5_tp4 [style=dashed];\n  Expert20_s0_l5_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp5 -> Expert20_s0_l5_tp5 [style=dashed];\n  Expert21_s0_l5_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp5 -> Expert21_s0_l5_tp5 [style=dashed];\n  Expert22_s0_l5_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp5 -> Expert22_s0_l5_tp5 [style=dashed];\n  Expert23_s0_l5_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp5 -> Expert23_s0_l5_tp5 [style=dashed];\n  Expert24_s0_l5_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp6 -> Expert24_s0_l5_tp6 [style=dashed];\n  Expert25_s0_l5_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp6 -> Expert25_s0_l5_tp6 [style=dashed];\n  Expert26_s0_l5_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp6 -> Expert26_s0_l5_tp6 [style=dashed];\n  Expert27_s0_l5_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp6 -> Expert27_s0_l5_tp6 [style=dashed];\n  Expert28_s0_l5_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp7 -> Expert28_s0_l5_tp7 [style=dashed];\n  Expert29_s0_l5_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp7 -> Expert29_s0_l5_tp7 [style=dashed];\n  Expert30_s0_l5_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp7 -> Expert30_s0_l5_tp7 [style=dashed];\n  Expert31_s0_l5_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l5_tp7 -> Expert31_s0_l5_tp7 [style=dashed];\n  AR_exp_s0_l5 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l5_tp0 -> AR_exp_s0_l5;\n  Expert1_s0_l5_tp0 -> AR_exp_s0_l5;\n  Expert2_s0_l5_tp0 -> AR_exp_s0_l5;\n  Expert3_s0_l5_tp0 -> AR_exp_s0_l5;\n  Expert4_s0_l5_tp1 -> AR_exp_s0_l5;\n  Expert5_s0_l5_tp1 -> AR_exp_s0_l5;\n  Expert6_s0_l5_tp1 -> AR_exp_s0_l5;\n  Expert7_s0_l5_tp1 -> AR_exp_s0_l5;\n  Expert8_s0_l5_tp2 -> AR_exp_s0_l5;\n  Expert9_s0_l5_tp2 -> AR_exp_s0_l5;\n  Expert10_s0_l5_tp2 -> AR_exp_s0_l5;\n  Expert11_s0_l5_tp2 -> AR_exp_s0_l5;\n  Expert12_s0_l5_tp3 -> AR_exp_s0_l5;\n  Expert13_s0_l5_tp3 -> AR_exp_s0_l5;\n  Expert14_s0_l5_tp3 -> AR_exp_s0_l5;\n  Expert15_s0_l5_tp3 -> AR_exp_s0_l5;\n  Expert16_s0_l5_tp4 -> AR_exp_s0_l5;\n  Expert17_s0_l5_tp4 -> AR_exp_s0_l5;\n  Expert18_s0_l5_tp4 -> AR_exp_s0_l5;\n  Expert19_s0_l5_tp4 -> AR_exp_s0_l5;\n  Expert20_s0_l5_tp5 -> AR_exp_s0_l5;\n  Expert21_s0_l5_tp5 -> AR_exp_s0_l5;\n  Expert22_s0_l5_tp5 -> AR_exp_s0_l5;\n  Expert23_s0_l5_tp5 -> AR_exp_s0_l5;\n  Expert24_s0_l5_tp6 -> AR_exp_s0_l5;\n  Expert25_s0_l5_tp6 -> AR_exp_s0_l5;\n  Expert26_s0_l5_tp6 -> AR_exp_s0_l5;\n  Expert27_s0_l5_tp6 -> AR_exp_s0_l5;\n  Expert28_s0_l5_tp7 -> AR_exp_s0_l5;\n  Expert29_s0_l5_tp7 -> AR_exp_s0_l5;\n  Expert30_s0_l5_tp7 -> AR_exp_s0_l5;\n  Expert31_s0_l5_tp7 -> AR_exp_s0_l5;\n  ResMOE_s0_l5_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp0;\n  ResAttn_s0_l5_tp0 -> ResMOE_s0_l5_tp0;\n  ResMOE_s0_l5_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp1;\n  ResAttn_s0_l5_tp1 -> ResMOE_s0_l5_tp1;\n  ResMOE_s0_l5_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp2;\n  ResAttn_s0_l5_tp2 -> ResMOE_s0_l5_tp2;\n  ResMOE_s0_l5_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp3;\n  ResAttn_s0_l5_tp3 -> ResMOE_s0_l5_tp3;\n  ResMOE_s0_l5_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp4;\n  ResAttn_s0_l5_tp4 -> ResMOE_s0_l5_tp4;\n  ResMOE_s0_l5_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp5;\n  ResAttn_s0_l5_tp5 -> ResMOE_s0_l5_tp5;\n  ResMOE_s0_l5_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp6;\n  ResAttn_s0_l5_tp6 -> ResMOE_s0_l5_tp6;\n  ResMOE_s0_l5_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l5 -> ResMOE_s0_l5_tp7;\n  ResAttn_s0_l5_tp7 -> ResMOE_s0_l5_tp7;\n  QKV_s0_l6_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp0;\n  QKV_s0_l6_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp1;\n  QKV_s0_l6_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp2;\n  QKV_s0_l6_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp3;\n  QKV_s0_l6_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp4;\n  QKV_s0_l6_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp5;\n  QKV_s0_l6_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp6;\n  QKV_s0_l6_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l5_tp0 -> QKV_s0_l6_tp7;\n  SplitHeads_s0_l6_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp0 -> SplitHeads_s0_l6_tp0;\n  SplitHeads_s0_l6_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp1 -> SplitHeads_s0_l6_tp1;\n  SplitHeads_s0_l6_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp2 -> SplitHeads_s0_l6_tp2;\n  SplitHeads_s0_l6_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp3 -> SplitHeads_s0_l6_tp3;\n  SplitHeads_s0_l6_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp4 -> SplitHeads_s0_l6_tp4;\n  SplitHeads_s0_l6_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp5 -> SplitHeads_s0_l6_tp5;\n  SplitHeads_s0_l6_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp6 -> SplitHeads_s0_l6_tp6;\n  SplitHeads_s0_l6_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l6_tp7 -> SplitHeads_s0_l6_tp7;\n  A2A_s0_l6 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l6_tp0 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp1 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp2 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp3 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp4 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp5 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp6 -> A2A_s0_l6;\n  SplitHeads_s0_l6_tp7 -> A2A_s0_l6;\n  Attn_s0_l6_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp0;\n  Attn_s0_l6_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp1;\n  Attn_s0_l6_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp2;\n  Attn_s0_l6_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp3;\n  Attn_s0_l6_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp4;\n  Attn_s0_l6_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp5;\n  Attn_s0_l6_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp6;\n  Attn_s0_l6_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l6 -> Attn_s0_l6_tp7;\n  AR_attn_s0_l6 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l6_tp0 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp1 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp2 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp3 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp4 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp5 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp6 -> AR_attn_s0_l6;\n  Attn_s0_l6_tp7 -> AR_attn_s0_l6;\n  O_s0_l6_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp0;\n  O_s0_l6_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp1;\n  O_s0_l6_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp2;\n  O_s0_l6_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp3;\n  O_s0_l6_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp4;\n  O_s0_l6_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp5;\n  O_s0_l6_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp6;\n  O_s0_l6_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l6 -> O_s0_l6_tp7;\n  ResAttn_s0_l6_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp0 -> ResAttn_s0_l6_tp0;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp0;\n  ResAttn_s0_l6_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp1 -> ResAttn_s0_l6_tp1;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp1;\n  ResAttn_s0_l6_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp2 -> ResAttn_s0_l6_tp2;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp2;\n  ResAttn_s0_l6_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp3 -> ResAttn_s0_l6_tp3;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp3;\n  ResAttn_s0_l6_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp4 -> ResAttn_s0_l6_tp4;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp4;\n  ResAttn_s0_l6_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp5 -> ResAttn_s0_l6_tp5;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp5;\n  ResAttn_s0_l6_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp6 -> ResAttn_s0_l6_tp6;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp6;\n  ResAttn_s0_l6_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l6_tp7 -> ResAttn_s0_l6_tp7;\n  ResMOE_s0_l5_tp0 -> ResAttn_s0_l6_tp7;\n  Gate_s0_l6_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp0 -> Gate_s0_l6_tp0;\n  Gate_s0_l6_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp1 -> Gate_s0_l6_tp1;\n  Gate_s0_l6_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp2 -> Gate_s0_l6_tp2;\n  Gate_s0_l6_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp3 -> Gate_s0_l6_tp3;\n  Gate_s0_l6_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp4 -> Gate_s0_l6_tp4;\n  Gate_s0_l6_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp5 -> Gate_s0_l6_tp5;\n  Gate_s0_l6_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp6 -> Gate_s0_l6_tp6;\n  Gate_s0_l6_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l6_tp7 -> Gate_s0_l6_tp7;\n  Expert0_s0_l6_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp0 -> Expert0_s0_l6_tp0 [style=dashed];\n  Expert1_s0_l6_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp0 -> Expert1_s0_l6_tp0 [style=dashed];\n  Expert2_s0_l6_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp0 -> Expert2_s0_l6_tp0 [style=dashed];\n  Expert3_s0_l6_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp0 -> Expert3_s0_l6_tp0 [style=dashed];\n  Expert4_s0_l6_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp1 -> Expert4_s0_l6_tp1 [style=dashed];\n  Expert5_s0_l6_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp1 -> Expert5_s0_l6_tp1 [style=dashed];\n  Expert6_s0_l6_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp1 -> Expert6_s0_l6_tp1 [style=dashed];\n  Expert7_s0_l6_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp1 -> Expert7_s0_l6_tp1 [style=dashed];\n  Expert8_s0_l6_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp2 -> Expert8_s0_l6_tp2 [style=dashed];\n  Expert9_s0_l6_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp2 -> Expert9_s0_l6_tp2 [style=dashed];\n  Expert10_s0_l6_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp2 -> Expert10_s0_l6_tp2 [style=dashed];\n  Expert11_s0_l6_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp2 -> Expert11_s0_l6_tp2 [style=dashed];\n  Expert12_s0_l6_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp3 -> Expert12_s0_l6_tp3 [style=dashed];\n  Expert13_s0_l6_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp3 -> Expert13_s0_l6_tp3 [style=dashed];\n  Expert14_s0_l6_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp3 -> Expert14_s0_l6_tp3 [style=dashed];\n  Expert15_s0_l6_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp3 -> Expert15_s0_l6_tp3 [style=dashed];\n  Expert16_s0_l6_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp4 -> Expert16_s0_l6_tp4 [style=dashed];\n  Expert17_s0_l6_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp4 -> Expert17_s0_l6_tp4 [style=dashed];\n  Expert18_s0_l6_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp4 -> Expert18_s0_l6_tp4 [style=dashed];\n  Expert19_s0_l6_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp4 -> Expert19_s0_l6_tp4 [style=dashed];\n  Expert20_s0_l6_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp5 -> Expert20_s0_l6_tp5 [style=dashed];\n  Expert21_s0_l6_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp5 -> Expert21_s0_l6_tp5 [style=dashed];\n  Expert22_s0_l6_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp5 -> Expert22_s0_l6_tp5 [style=dashed];\n  Expert23_s0_l6_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp5 -> Expert23_s0_l6_tp5 [style=dashed];\n  Expert24_s0_l6_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp6 -> Expert24_s0_l6_tp6 [style=dashed];\n  Expert25_s0_l6_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp6 -> Expert25_s0_l6_tp6 [style=dashed];\n  Expert26_s0_l6_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp6 -> Expert26_s0_l6_tp6 [style=dashed];\n  Expert27_s0_l6_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp6 -> Expert27_s0_l6_tp6 [style=dashed];\n  Expert28_s0_l6_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp7 -> Expert28_s0_l6_tp7 [style=dashed];\n  Expert29_s0_l6_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp7 -> Expert29_s0_l6_tp7 [style=dashed];\n  Expert30_s0_l6_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp7 -> Expert30_s0_l6_tp7 [style=dashed];\n  Expert31_s0_l6_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l6_tp7 -> Expert31_s0_l6_tp7 [style=dashed];\n  AR_exp_s0_l6 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l6_tp0 -> AR_exp_s0_l6;\n  Expert1_s0_l6_tp0 -> AR_exp_s0_l6;\n  Expert2_s0_l6_tp0 -> AR_exp_s0_l6;\n  Expert3_s0_l6_tp0 -> AR_exp_s0_l6;\n  Expert4_s0_l6_tp1 -> AR_exp_s0_l6;\n  Expert5_s0_l6_tp1 -> AR_exp_s0_l6;\n  Expert6_s0_l6_tp1 -> AR_exp_s0_l6;\n  Expert7_s0_l6_tp1 -> AR_exp_s0_l6;\n  Expert8_s0_l6_tp2 -> AR_exp_s0_l6;\n  Expert9_s0_l6_tp2 -> AR_exp_s0_l6;\n  Expert10_s0_l6_tp2 -> AR_exp_s0_l6;\n  Expert11_s0_l6_tp2 -> AR_exp_s0_l6;\n  Expert12_s0_l6_tp3 -> AR_exp_s0_l6;\n  Expert13_s0_l6_tp3 -> AR_exp_s0_l6;\n  Expert14_s0_l6_tp3 -> AR_exp_s0_l6;\n  Expert15_s0_l6_tp3 -> AR_exp_s0_l6;\n  Expert16_s0_l6_tp4 -> AR_exp_s0_l6;\n  Expert17_s0_l6_tp4 -> AR_exp_s0_l6;\n  Expert18_s0_l6_tp4 -> AR_exp_s0_l6;\n  Expert19_s0_l6_tp4 -> AR_exp_s0_l6;\n  Expert20_s0_l6_tp5 -> AR_exp_s0_l6;\n  Expert21_s0_l6_tp5 -> AR_exp_s0_l6;\n  Expert22_s0_l6_tp5 -> AR_exp_s0_l6;\n  Expert23_s0_l6_tp5 -> AR_exp_s0_l6;\n  Expert24_s0_l6_tp6 -> AR_exp_s0_l6;\n  Expert25_s0_l6_tp6 -> AR_exp_s0_l6;\n  Expert26_s0_l6_tp6 -> AR_exp_s0_l6;\n  Expert27_s0_l6_tp6 -> AR_exp_s0_l6;\n  Expert28_s0_l6_tp7 -> AR_exp_s0_l6;\n  Expert29_s0_l6_tp7 -> AR_exp_s0_l6;\n  Expert30_s0_l6_tp7 -> AR_exp_s0_l6;\n  Expert31_s0_l6_tp7 -> AR_exp_s0_l6;\n  ResMOE_s0_l6_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp0;\n  ResAttn_s0_l6_tp0 -> ResMOE_s0_l6_tp0;\n  ResMOE_s0_l6_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp1;\n  ResAttn_s0_l6_tp1 -> ResMOE_s0_l6_tp1;\n  ResMOE_s0_l6_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp2;\n  ResAttn_s0_l6_tp2 -> ResMOE_s0_l6_tp2;\n  ResMOE_s0_l6_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp3;\n  ResAttn_s0_l6_tp3 -> ResMOE_s0_l6_tp3;\n  ResMOE_s0_l6_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp4;\n  ResAttn_s0_l6_tp4 -> ResMOE_s0_l6_tp4;\n  ResMOE_s0_l6_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp5;\n  ResAttn_s0_l6_tp5 -> ResMOE_s0_l6_tp5;\n  ResMOE_s0_l6_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp6;\n  ResAttn_s0_l6_tp6 -> ResMOE_s0_l6_tp6;\n  ResMOE_s0_l6_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l6 -> ResMOE_s0_l6_tp7;\n  ResAttn_s0_l6_tp7 -> ResMOE_s0_l6_tp7;\n  QKV_s0_l7_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp0;\n  QKV_s0_l7_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp1;\n  QKV_s0_l7_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp2;\n  QKV_s0_l7_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp3;\n  QKV_s0_l7_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp4;\n  QKV_s0_l7_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp5;\n  QKV_s0_l7_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp6;\n  QKV_s0_l7_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l6_tp0 -> QKV_s0_l7_tp7;\n  SplitHeads_s0_l7_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp0 -> SplitHeads_s0_l7_tp0;\n  SplitHeads_s0_l7_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp1 -> SplitHeads_s0_l7_tp1;\n  SplitHeads_s0_l7_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp2 -> SplitHeads_s0_l7_tp2;\n  SplitHeads_s0_l7_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp3 -> SplitHeads_s0_l7_tp3;\n  SplitHeads_s0_l7_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp4 -> SplitHeads_s0_l7_tp4;\n  SplitHeads_s0_l7_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp5 -> SplitHeads_s0_l7_tp5;\n  SplitHeads_s0_l7_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp6 -> SplitHeads_s0_l7_tp6;\n  SplitHeads_s0_l7_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l7_tp7 -> SplitHeads_s0_l7_tp7;\n  A2A_s0_l7 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l7_tp0 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp1 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp2 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp3 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp4 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp5 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp6 -> A2A_s0_l7;\n  SplitHeads_s0_l7_tp7 -> A2A_s0_l7;\n  Attn_s0_l7_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp0;\n  Attn_s0_l7_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp1;\n  Attn_s0_l7_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp2;\n  Attn_s0_l7_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp3;\n  Attn_s0_l7_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp4;\n  Attn_s0_l7_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp5;\n  Attn_s0_l7_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp6;\n  Attn_s0_l7_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l7 -> Attn_s0_l7_tp7;\n  AR_attn_s0_l7 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l7_tp0 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp1 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp2 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp3 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp4 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp5 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp6 -> AR_attn_s0_l7;\n  Attn_s0_l7_tp7 -> AR_attn_s0_l7;\n  O_s0_l7_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp0;\n  O_s0_l7_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp1;\n  O_s0_l7_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp2;\n  O_s0_l7_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp3;\n  O_s0_l7_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp4;\n  O_s0_l7_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp5;\n  O_s0_l7_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp6;\n  O_s0_l7_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l7 -> O_s0_l7_tp7;\n  ResAttn_s0_l7_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp0 -> ResAttn_s0_l7_tp0;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp0;\n  ResAttn_s0_l7_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp1 -> ResAttn_s0_l7_tp1;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp1;\n  ResAttn_s0_l7_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp2 -> ResAttn_s0_l7_tp2;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp2;\n  ResAttn_s0_l7_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp3 -> ResAttn_s0_l7_tp3;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp3;\n  ResAttn_s0_l7_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp4 -> ResAttn_s0_l7_tp4;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp4;\n  ResAttn_s0_l7_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp5 -> ResAttn_s0_l7_tp5;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp5;\n  ResAttn_s0_l7_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp6 -> ResAttn_s0_l7_tp6;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp6;\n  ResAttn_s0_l7_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l7_tp7 -> ResAttn_s0_l7_tp7;\n  ResMOE_s0_l6_tp0 -> ResAttn_s0_l7_tp7;\n  Gate_s0_l7_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp0 -> Gate_s0_l7_tp0;\n  Gate_s0_l7_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp1 -> Gate_s0_l7_tp1;\n  Gate_s0_l7_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp2 -> Gate_s0_l7_tp2;\n  Gate_s0_l7_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp3 -> Gate_s0_l7_tp3;\n  Gate_s0_l7_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp4 -> Gate_s0_l7_tp4;\n  Gate_s0_l7_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp5 -> Gate_s0_l7_tp5;\n  Gate_s0_l7_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp6 -> Gate_s0_l7_tp6;\n  Gate_s0_l7_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l7_tp7 -> Gate_s0_l7_tp7;\n  Expert0_s0_l7_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp0 -> Expert0_s0_l7_tp0 [style=dashed];\n  Expert1_s0_l7_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp0 -> Expert1_s0_l7_tp0 [style=dashed];\n  Expert2_s0_l7_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp0 -> Expert2_s0_l7_tp0 [style=dashed];\n  Expert3_s0_l7_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp0 -> Expert3_s0_l7_tp0 [style=dashed];\n  Expert4_s0_l7_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp1 -> Expert4_s0_l7_tp1 [style=dashed];\n  Expert5_s0_l7_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp1 -> Expert5_s0_l7_tp1 [style=dashed];\n  Expert6_s0_l7_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp1 -> Expert6_s0_l7_tp1 [style=dashed];\n  Expert7_s0_l7_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp1 -> Expert7_s0_l7_tp1 [style=dashed];\n  Expert8_s0_l7_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp2 -> Expert8_s0_l7_tp2 [style=dashed];\n  Expert9_s0_l7_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp2 -> Expert9_s0_l7_tp2 [style=dashed];\n  Expert10_s0_l7_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp2 -> Expert10_s0_l7_tp2 [style=dashed];\n  Expert11_s0_l7_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp2 -> Expert11_s0_l7_tp2 [style=dashed];\n  Expert12_s0_l7_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp3 -> Expert12_s0_l7_tp3 [style=dashed];\n  Expert13_s0_l7_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp3 -> Expert13_s0_l7_tp3 [style=dashed];\n  Expert14_s0_l7_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp3 -> Expert14_s0_l7_tp3 [style=dashed];\n  Expert15_s0_l7_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp3 -> Expert15_s0_l7_tp3 [style=dashed];\n  Expert16_s0_l7_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp4 -> Expert16_s0_l7_tp4 [style=dashed];\n  Expert17_s0_l7_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp4 -> Expert17_s0_l7_tp4 [style=dashed];\n  Expert18_s0_l7_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp4 -> Expert18_s0_l7_tp4 [style=dashed];\n  Expert19_s0_l7_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp4 -> Expert19_s0_l7_tp4 [style=dashed];\n  Expert20_s0_l7_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp5 -> Expert20_s0_l7_tp5 [style=dashed];\n  Expert21_s0_l7_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp5 -> Expert21_s0_l7_tp5 [style=dashed];\n  Expert22_s0_l7_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp5 -> Expert22_s0_l7_tp5 [style=dashed];\n  Expert23_s0_l7_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp5 -> Expert23_s0_l7_tp5 [style=dashed];\n  Expert24_s0_l7_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp6 -> Expert24_s0_l7_tp6 [style=dashed];\n  Expert25_s0_l7_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp6 -> Expert25_s0_l7_tp6 [style=dashed];\n  Expert26_s0_l7_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp6 -> Expert26_s0_l7_tp6 [style=dashed];\n  Expert27_s0_l7_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp6 -> Expert27_s0_l7_tp6 [style=dashed];\n  Expert28_s0_l7_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp7 -> Expert28_s0_l7_tp7 [style=dashed];\n  Expert29_s0_l7_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp7 -> Expert29_s0_l7_tp7 [style=dashed];\n  Expert30_s0_l7_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp7 -> Expert30_s0_l7_tp7 [style=dashed];\n  Expert31_s0_l7_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l7_tp7 -> Expert31_s0_l7_tp7 [style=dashed];\n  AR_exp_s0_l7 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l7_tp0 -> AR_exp_s0_l7;\n  Expert1_s0_l7_tp0 -> AR_exp_s0_l7;\n  Expert2_s0_l7_tp0 -> AR_exp_s0_l7;\n  Expert3_s0_l7_tp0 -> AR_exp_s0_l7;\n  Expert4_s0_l7_tp1 -> AR_exp_s0_l7;\n  Expert5_s0_l7_tp1 -> AR_exp_s0_l7;\n  Expert6_s0_l7_tp1 -> AR_exp_s0_l7;\n  Expert7_s0_l7_tp1 -> AR_exp_s0_l7;\n  Expert8_s0_l7_tp2 -> AR_exp_s0_l7;\n  Expert9_s0_l7_tp2 -> AR_exp_s0_l7;\n  Expert10_s0_l7_tp2 -> AR_exp_s0_l7;\n  Expert11_s0_l7_tp2 -> AR_exp_s0_l7;\n  Expert12_s0_l7_tp3 -> AR_exp_s0_l7;\n  Expert13_s0_l7_tp3 -> AR_exp_s0_l7;\n  Expert14_s0_l7_tp3 -> AR_exp_s0_l7;\n  Expert15_s0_l7_tp3 -> AR_exp_s0_l7;\n  Expert16_s0_l7_tp4 -> AR_exp_s0_l7;\n  Expert17_s0_l7_tp4 -> AR_exp_s0_l7;\n  Expert18_s0_l7_tp4 -> AR_exp_s0_l7;\n  Expert19_s0_l7_tp4 -> AR_exp_s0_l7;\n  Expert20_s0_l7_tp5 -> AR_exp_s0_l7;\n  Expert21_s0_l7_tp5 -> AR_exp_s0_l7;\n  Expert22_s0_l7_tp5 -> AR_exp_s0_l7;\n  Expert23_s0_l7_tp5 -> AR_exp_s0_l7;\n  Expert24_s0_l7_tp6 -> AR_exp_s0_l7;\n  Expert25_s0_l7_tp6 -> AR_exp_s0_l7;\n  Expert26_s0_l7_tp6 -> AR_exp_s0_l7;\n  Expert27_s0_l7_tp6 -> AR_exp_s0_l7;\n  Expert28_s0_l7_tp7 -> AR_exp_s0_l7;\n  Expert29_s0_l7_tp7 -> AR_exp_s0_l7;\n  Expert30_s0_l7_tp7 -> AR_exp_s0_l7;\n  Expert31_s0_l7_tp7 -> AR_exp_s0_l7;\n  ResMOE_s0_l7_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp0;\n  ResAttn_s0_l7_tp0 -> ResMOE_s0_l7_tp0;\n  ResMOE_s0_l7_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp1;\n  ResAttn_s0_l7_tp1 -> ResMOE_s0_l7_tp1;\n  ResMOE_s0_l7_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp2;\n  ResAttn_s0_l7_tp2 -> ResMOE_s0_l7_tp2;\n  ResMOE_s0_l7_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp3;\n  ResAttn_s0_l7_tp3 -> ResMOE_s0_l7_tp3;\n  ResMOE_s0_l7_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp4;\n  ResAttn_s0_l7_tp4 -> ResMOE_s0_l7_tp4;\n  ResMOE_s0_l7_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp5;\n  ResAttn_s0_l7_tp5 -> ResMOE_s0_l7_tp5;\n  ResMOE_s0_l7_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp6;\n  ResAttn_s0_l7_tp6 -> ResMOE_s0_l7_tp6;\n  ResMOE_s0_l7_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l7 -> ResMOE_s0_l7_tp7;\n  ResAttn_s0_l7_tp7 -> ResMOE_s0_l7_tp7;\n  QKV_s0_l8_tp0 [label="QKV_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp0;\n  QKV_s0_l8_tp1 [label="QKV_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp1;\n  QKV_s0_l8_tp2 [label="QKV_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp2;\n  QKV_s0_l8_tp3 [label="QKV_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp3;\n  QKV_s0_l8_tp4 [label="QKV_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp4;\n  QKV_s0_l8_tp5 [label="QKV_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp5;\n  QKV_s0_l8_tp6 [label="QKV_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp6;\n  QKV_s0_l8_tp7 [label="QKV_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l7_tp0 -> QKV_s0_l8_tp7;\n  SplitHeads_s0_l8_tp0 [label="SplitHeads\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp0 -> SplitHeads_s0_l8_tp0;\n  SplitHeads_s0_l8_tp1 [label="SplitHeads\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp1 -> SplitHeads_s0_l8_tp1;\n  SplitHeads_s0_l8_tp2 [label="SplitHeads\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp2 -> SplitHeads_s0_l8_tp2;\n  SplitHeads_s0_l8_tp3 [label="SplitHeads\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp3 -> SplitHeads_s0_l8_tp3;\n  SplitHeads_s0_l8_tp4 [label="SplitHeads\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp4 -> SplitHeads_s0_l8_tp4;\n  SplitHeads_s0_l8_tp5 [label="SplitHeads\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp5 -> SplitHeads_s0_l8_tp5;\n  SplitHeads_s0_l8_tp6 [label="SplitHeads\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp6 -> SplitHeads_s0_l8_tp6;\n  SplitHeads_s0_l8_tp7 [label="SplitHeads\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s0_l8_tp7 -> SplitHeads_s0_l8_tp7;\n  A2A_s0_l8 [shape=ellipse, label="AllToAll\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s0_l8_tp0 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp1 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp2 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp3 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp4 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp5 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp6 -> A2A_s0_l8;\n  SplitHeads_s0_l8_tp7 -> A2A_s0_l8;\n  Attn_s0_l8_tp0 [label="Attention\nGPU0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp0;\n  Attn_s0_l8_tp1 [label="Attention\nGPU1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp1;\n  Attn_s0_l8_tp2 [label="Attention\nGPU2\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp2;\n  Attn_s0_l8_tp3 [label="Attention\nGPU3\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp3;\n  Attn_s0_l8_tp4 [label="Attention\nGPU4\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp4;\n  Attn_s0_l8_tp5 [label="Attention\nGPU5\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp5;\n  Attn_s0_l8_tp6 [label="Attention\nGPU6\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp6;\n  Attn_s0_l8_tp7 [label="Attention\nGPU7\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s0_l8 -> Attn_s0_l8_tp7;\n  AR_attn_s0_l8 [shape=ellipse, label="AllReduce\nstage0\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s0_l8_tp0 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp1 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp2 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp3 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp4 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp5 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp6 -> AR_attn_s0_l8;\n  Attn_s0_l8_tp7 -> AR_attn_s0_l8;\n  O_s0_l8_tp0 [label="O_linear\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp0;\n  O_s0_l8_tp1 [label="O_linear\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp1;\n  O_s0_l8_tp2 [label="O_linear\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp2;\n  O_s0_l8_tp3 [label="O_linear\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp3;\n  O_s0_l8_tp4 [label="O_linear\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp4;\n  O_s0_l8_tp5 [label="O_linear\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp5;\n  O_s0_l8_tp6 [label="O_linear\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp6;\n  O_s0_l8_tp7 [label="O_linear\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s0_l8 -> O_s0_l8_tp7;\n  ResAttn_s0_l8_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp0 -> ResAttn_s0_l8_tp0;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp0;\n  ResAttn_s0_l8_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp1 -> ResAttn_s0_l8_tp1;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp1;\n  ResAttn_s0_l8_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp2 -> ResAttn_s0_l8_tp2;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp2;\n  ResAttn_s0_l8_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp3 -> ResAttn_s0_l8_tp3;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp3;\n  ResAttn_s0_l8_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp4 -> ResAttn_s0_l8_tp4;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp4;\n  ResAttn_s0_l8_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp5 -> ResAttn_s0_l8_tp5;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp5;\n  ResAttn_s0_l8_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp6 -> ResAttn_s0_l8_tp6;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp6;\n  ResAttn_s0_l8_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s0_l8_tp7 -> ResAttn_s0_l8_tp7;\n  ResMOE_s0_l7_tp0 -> ResAttn_s0_l8_tp7;\n  Gate_s0_l8_tp0 [label="Gate\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp0 -> Gate_s0_l8_tp0;\n  Gate_s0_l8_tp1 [label="Gate\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp1 -> Gate_s0_l8_tp1;\n  Gate_s0_l8_tp2 [label="Gate\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp2 -> Gate_s0_l8_tp2;\n  Gate_s0_l8_tp3 [label="Gate\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp3 -> Gate_s0_l8_tp3;\n  Gate_s0_l8_tp4 [label="Gate\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp4 -> Gate_s0_l8_tp4;\n  Gate_s0_l8_tp5 [label="Gate\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp5 -> Gate_s0_l8_tp5;\n  Gate_s0_l8_tp6 [label="Gate\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp6 -> Gate_s0_l8_tp6;\n  Gate_s0_l8_tp7 [label="Gate\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s0_l8_tp7 -> Gate_s0_l8_tp7;\n  Expert0_s0_l8_tp0 [label="Expert0\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp0 -> Expert0_s0_l8_tp0 [style=dashed];\n  Expert1_s0_l8_tp0 [label="Expert1\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp0 -> Expert1_s0_l8_tp0 [style=dashed];\n  Expert2_s0_l8_tp0 [label="Expert2\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp0 -> Expert2_s0_l8_tp0 [style=dashed];\n  Expert3_s0_l8_tp0 [label="Expert3\nGPU0\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp0 -> Expert3_s0_l8_tp0 [style=dashed];\n  Expert4_s0_l8_tp1 [label="Expert4\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp1 -> Expert4_s0_l8_tp1 [style=dashed];\n  Expert5_s0_l8_tp1 [label="Expert5\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp1 -> Expert5_s0_l8_tp1 [style=dashed];\n  Expert6_s0_l8_tp1 [label="Expert6\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp1 -> Expert6_s0_l8_tp1 [style=dashed];\n  Expert7_s0_l8_tp1 [label="Expert7\nGPU1\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp1 -> Expert7_s0_l8_tp1 [style=dashed];\n  Expert8_s0_l8_tp2 [label="Expert8\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp2 -> Expert8_s0_l8_tp2 [style=dashed];\n  Expert9_s0_l8_tp2 [label="Expert9\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp2 -> Expert9_s0_l8_tp2 [style=dashed];\n  Expert10_s0_l8_tp2 [label="Expert10\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp2 -> Expert10_s0_l8_tp2 [style=dashed];\n  Expert11_s0_l8_tp2 [label="Expert11\nGPU2\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp2 -> Expert11_s0_l8_tp2 [style=dashed];\n  Expert12_s0_l8_tp3 [label="Expert12\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp3 -> Expert12_s0_l8_tp3 [style=dashed];\n  Expert13_s0_l8_tp3 [label="Expert13\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp3 -> Expert13_s0_l8_tp3 [style=dashed];\n  Expert14_s0_l8_tp3 [label="Expert14\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp3 -> Expert14_s0_l8_tp3 [style=dashed];\n  Expert15_s0_l8_tp3 [label="Expert15\nGPU3\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp3 -> Expert15_s0_l8_tp3 [style=dashed];\n  Expert16_s0_l8_tp4 [label="Expert16\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp4 -> Expert16_s0_l8_tp4 [style=dashed];\n  Expert17_s0_l8_tp4 [label="Expert17\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp4 -> Expert17_s0_l8_tp4 [style=dashed];\n  Expert18_s0_l8_tp4 [label="Expert18\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp4 -> Expert18_s0_l8_tp4 [style=dashed];\n  Expert19_s0_l8_tp4 [label="Expert19\nGPU4\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp4 -> Expert19_s0_l8_tp4 [style=dashed];\n  Expert20_s0_l8_tp5 [label="Expert20\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp5 -> Expert20_s0_l8_tp5 [style=dashed];\n  Expert21_s0_l8_tp5 [label="Expert21\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp5 -> Expert21_s0_l8_tp5 [style=dashed];\n  Expert22_s0_l8_tp5 [label="Expert22\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp5 -> Expert22_s0_l8_tp5 [style=dashed];\n  Expert23_s0_l8_tp5 [label="Expert23\nGPU5\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp5 -> Expert23_s0_l8_tp5 [style=dashed];\n  Expert24_s0_l8_tp6 [label="Expert24\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp6 -> Expert24_s0_l8_tp6 [style=dashed];\n  Expert25_s0_l8_tp6 [label="Expert25\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp6 -> Expert25_s0_l8_tp6 [style=dashed];\n  Expert26_s0_l8_tp6 [label="Expert26\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp6 -> Expert26_s0_l8_tp6 [style=dashed];\n  Expert27_s0_l8_tp6 [label="Expert27\nGPU6\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp6 -> Expert27_s0_l8_tp6 [style=dashed];\n  Expert28_s0_l8_tp7 [label="Expert28\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp7 -> Expert28_s0_l8_tp7 [style=dashed];\n  Expert29_s0_l8_tp7 [label="Expert29\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp7 -> Expert29_s0_l8_tp7 [style=dashed];\n  Expert30_s0_l8_tp7 [label="Expert30\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp7 -> Expert30_s0_l8_tp7 [style=dashed];\n  Expert31_s0_l8_tp7 [label="Expert31\nGPU7\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s0_l8_tp7 -> Expert31_s0_l8_tp7 [style=dashed];\n  AR_exp_s0_l8 [shape=ellipse, label="AllReduceExperts\nstage0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert0_s0_l8_tp0 -> AR_exp_s0_l8;\n  Expert1_s0_l8_tp0 -> AR_exp_s0_l8;\n  Expert2_s0_l8_tp0 -> AR_exp_s0_l8;\n  Expert3_s0_l8_tp0 -> AR_exp_s0_l8;\n  Expert4_s0_l8_tp1 -> AR_exp_s0_l8;\n  Expert5_s0_l8_tp1 -> AR_exp_s0_l8;\n  Expert6_s0_l8_tp1 -> AR_exp_s0_l8;\n  Expert7_s0_l8_tp1 -> AR_exp_s0_l8;\n  Expert8_s0_l8_tp2 -> AR_exp_s0_l8;\n  Expert9_s0_l8_tp2 -> AR_exp_s0_l8;\n  Expert10_s0_l8_tp2 -> AR_exp_s0_l8;\n  Expert11_s0_l8_tp2 -> AR_exp_s0_l8;\n  Expert12_s0_l8_tp3 -> AR_exp_s0_l8;\n  Expert13_s0_l8_tp3 -> AR_exp_s0_l8;\n  Expert14_s0_l8_tp3 -> AR_exp_s0_l8;\n  Expert15_s0_l8_tp3 -> AR_exp_s0_l8;\n  Expert16_s0_l8_tp4 -> AR_exp_s0_l8;\n  Expert17_s0_l8_tp4 -> AR_exp_s0_l8;\n  Expert18_s0_l8_tp4 -> AR_exp_s0_l8;\n  Expert19_s0_l8_tp4 -> AR_exp_s0_l8;\n  Expert20_s0_l8_tp5 -> AR_exp_s0_l8;\n  Expert21_s0_l8_tp5 -> AR_exp_s0_l8;\n  Expert22_s0_l8_tp5 -> AR_exp_s0_l8;\n  Expert23_s0_l8_tp5 -> AR_exp_s0_l8;\n  Expert24_s0_l8_tp6 -> AR_exp_s0_l8;\n  Expert25_s0_l8_tp6 -> AR_exp_s0_l8;\n  Expert26_s0_l8_tp6 -> AR_exp_s0_l8;\n  Expert27_s0_l8_tp6 -> AR_exp_s0_l8;\n  Expert28_s0_l8_tp7 -> AR_exp_s0_l8;\n  Expert29_s0_l8_tp7 -> AR_exp_s0_l8;\n  Expert30_s0_l8_tp7 -> AR_exp_s0_l8;\n  Expert31_s0_l8_tp7 -> AR_exp_s0_l8;\n  ResMOE_s0_l8_tp0 [shape=parallelogram, label="ResAdd\nGPU0\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp0;\n  ResAttn_s0_l8_tp0 -> ResMOE_s0_l8_tp0;\n  ResMOE_s0_l8_tp1 [shape=parallelogram, label="ResAdd\nGPU1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp1;\n  ResAttn_s0_l8_tp1 -> ResMOE_s0_l8_tp1;\n  ResMOE_s0_l8_tp2 [shape=parallelogram, label="ResAdd\nGPU2\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp2;\n  ResAttn_s0_l8_tp2 -> ResMOE_s0_l8_tp2;\n  ResMOE_s0_l8_tp3 [shape=parallelogram, label="ResAdd\nGPU3\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp3;\n  ResAttn_s0_l8_tp3 -> ResMOE_s0_l8_tp3;\n  ResMOE_s0_l8_tp4 [shape=parallelogram, label="ResAdd\nGPU4\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp4;\n  ResAttn_s0_l8_tp4 -> ResMOE_s0_l8_tp4;\n  ResMOE_s0_l8_tp5 [shape=parallelogram, label="ResAdd\nGPU5\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp5;\n  ResAttn_s0_l8_tp5 -> ResMOE_s0_l8_tp5;\n  ResMOE_s0_l8_tp6 [shape=parallelogram, label="ResAdd\nGPU6\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp6;\n  ResAttn_s0_l8_tp6 -> ResMOE_s0_l8_tp6;\n  ResMOE_s0_l8_tp7 [shape=parallelogram, label="ResAdd\nGPU7\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s0_l8 -> ResMOE_s0_l8_tp7;\n  ResAttn_s0_l8_tp7 -> ResMOE_s0_l8_tp7;\n  QKV_s1_l9_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp0;\n  QKV_s1_l9_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp1;\n  QKV_s1_l9_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp2;\n  QKV_s1_l9_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp3;\n  QKV_s1_l9_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp4;\n  QKV_s1_l9_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp5;\n  QKV_s1_l9_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp6;\n  QKV_s1_l9_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s0_l8_tp0 -> QKV_s1_l9_tp7;\n  SplitHeads_s1_l9_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp0 -> SplitHeads_s1_l9_tp0;\n  SplitHeads_s1_l9_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp1 -> SplitHeads_s1_l9_tp1;\n  SplitHeads_s1_l9_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp2 -> SplitHeads_s1_l9_tp2;\n  SplitHeads_s1_l9_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp3 -> SplitHeads_s1_l9_tp3;\n  SplitHeads_s1_l9_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp4 -> SplitHeads_s1_l9_tp4;\n  SplitHeads_s1_l9_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp5 -> SplitHeads_s1_l9_tp5;\n  SplitHeads_s1_l9_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp6 -> SplitHeads_s1_l9_tp6;\n  SplitHeads_s1_l9_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l9_tp7 -> SplitHeads_s1_l9_tp7;\n  A2A_s1_l9 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l9_tp0 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp1 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp2 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp3 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp4 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp5 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp6 -> A2A_s1_l9;\n  SplitHeads_s1_l9_tp7 -> A2A_s1_l9;\n  Attn_s1_l9_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp0;\n  Attn_s1_l9_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp1;\n  Attn_s1_l9_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp2;\n  Attn_s1_l9_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp3;\n  Attn_s1_l9_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp4;\n  Attn_s1_l9_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp5;\n  Attn_s1_l9_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp6;\n  Attn_s1_l9_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l9 -> Attn_s1_l9_tp7;\n  AR_attn_s1_l9 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l9_tp0 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp1 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp2 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp3 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp4 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp5 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp6 -> AR_attn_s1_l9;\n  Attn_s1_l9_tp7 -> AR_attn_s1_l9;\n  O_s1_l9_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp0;\n  O_s1_l9_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp1;\n  O_s1_l9_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp2;\n  O_s1_l9_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp3;\n  O_s1_l9_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp4;\n  O_s1_l9_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp5;\n  O_s1_l9_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp6;\n  O_s1_l9_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l9 -> O_s1_l9_tp7;\n  ResAttn_s1_l9_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp0 -> ResAttn_s1_l9_tp0;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp0;\n  ResAttn_s1_l9_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp1 -> ResAttn_s1_l9_tp1;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp1;\n  ResAttn_s1_l9_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp2 -> ResAttn_s1_l9_tp2;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp2;\n  ResAttn_s1_l9_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp3 -> ResAttn_s1_l9_tp3;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp3;\n  ResAttn_s1_l9_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp4 -> ResAttn_s1_l9_tp4;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp4;\n  ResAttn_s1_l9_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp5 -> ResAttn_s1_l9_tp5;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp5;\n  ResAttn_s1_l9_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp6 -> ResAttn_s1_l9_tp6;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp6;\n  ResAttn_s1_l9_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l9_tp7 -> ResAttn_s1_l9_tp7;\n  ResMOE_s0_l8_tp0 -> ResAttn_s1_l9_tp7;\n  Gate_s1_l9_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp0 -> Gate_s1_l9_tp0;\n  Gate_s1_l9_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp1 -> Gate_s1_l9_tp1;\n  Gate_s1_l9_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp2 -> Gate_s1_l9_tp2;\n  Gate_s1_l9_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp3 -> Gate_s1_l9_tp3;\n  Gate_s1_l9_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp4 -> Gate_s1_l9_tp4;\n  Gate_s1_l9_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp5 -> Gate_s1_l9_tp5;\n  Gate_s1_l9_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp6 -> Gate_s1_l9_tp6;\n  Gate_s1_l9_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l9_tp7 -> Gate_s1_l9_tp7;\n  Expert32_s1_l9_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp0 -> Expert32_s1_l9_tp0 [style=dashed];\n  Expert33_s1_l9_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp0 -> Expert33_s1_l9_tp0 [style=dashed];\n  Expert34_s1_l9_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp0 -> Expert34_s1_l9_tp0 [style=dashed];\n  Expert35_s1_l9_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp0 -> Expert35_s1_l9_tp0 [style=dashed];\n  Expert36_s1_l9_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp1 -> Expert36_s1_l9_tp1 [style=dashed];\n  Expert37_s1_l9_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp1 -> Expert37_s1_l9_tp1 [style=dashed];\n  Expert38_s1_l9_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp1 -> Expert38_s1_l9_tp1 [style=dashed];\n  Expert39_s1_l9_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp1 -> Expert39_s1_l9_tp1 [style=dashed];\n  Expert40_s1_l9_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp2 -> Expert40_s1_l9_tp2 [style=dashed];\n  Expert41_s1_l9_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp2 -> Expert41_s1_l9_tp2 [style=dashed];\n  Expert42_s1_l9_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp2 -> Expert42_s1_l9_tp2 [style=dashed];\n  Expert43_s1_l9_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp2 -> Expert43_s1_l9_tp2 [style=dashed];\n  Expert44_s1_l9_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp3 -> Expert44_s1_l9_tp3 [style=dashed];\n  Expert45_s1_l9_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp3 -> Expert45_s1_l9_tp3 [style=dashed];\n  Expert46_s1_l9_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp3 -> Expert46_s1_l9_tp3 [style=dashed];\n  Expert47_s1_l9_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp3 -> Expert47_s1_l9_tp3 [style=dashed];\n  Expert48_s1_l9_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp4 -> Expert48_s1_l9_tp4 [style=dashed];\n  Expert49_s1_l9_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp4 -> Expert49_s1_l9_tp4 [style=dashed];\n  Expert50_s1_l9_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp4 -> Expert50_s1_l9_tp4 [style=dashed];\n  Expert51_s1_l9_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp4 -> Expert51_s1_l9_tp4 [style=dashed];\n  Expert52_s1_l9_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp5 -> Expert52_s1_l9_tp5 [style=dashed];\n  Expert53_s1_l9_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp5 -> Expert53_s1_l9_tp5 [style=dashed];\n  Expert54_s1_l9_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp5 -> Expert54_s1_l9_tp5 [style=dashed];\n  Expert55_s1_l9_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp5 -> Expert55_s1_l9_tp5 [style=dashed];\n  Expert56_s1_l9_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp6 -> Expert56_s1_l9_tp6 [style=dashed];\n  Expert57_s1_l9_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp6 -> Expert57_s1_l9_tp6 [style=dashed];\n  Expert58_s1_l9_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp6 -> Expert58_s1_l9_tp6 [style=dashed];\n  Expert59_s1_l9_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp6 -> Expert59_s1_l9_tp6 [style=dashed];\n  Expert60_s1_l9_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp7 -> Expert60_s1_l9_tp7 [style=dashed];\n  Expert61_s1_l9_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp7 -> Expert61_s1_l9_tp7 [style=dashed];\n  Expert62_s1_l9_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp7 -> Expert62_s1_l9_tp7 [style=dashed];\n  Expert63_s1_l9_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l9_tp7 -> Expert63_s1_l9_tp7 [style=dashed];\n  AR_exp_s1_l9 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l9_tp0 -> AR_exp_s1_l9;\n  Expert33_s1_l9_tp0 -> AR_exp_s1_l9;\n  Expert34_s1_l9_tp0 -> AR_exp_s1_l9;\n  Expert35_s1_l9_tp0 -> AR_exp_s1_l9;\n  Expert36_s1_l9_tp1 -> AR_exp_s1_l9;\n  Expert37_s1_l9_tp1 -> AR_exp_s1_l9;\n  Expert38_s1_l9_tp1 -> AR_exp_s1_l9;\n  Expert39_s1_l9_tp1 -> AR_exp_s1_l9;\n  Expert40_s1_l9_tp2 -> AR_exp_s1_l9;\n  Expert41_s1_l9_tp2 -> AR_exp_s1_l9;\n  Expert42_s1_l9_tp2 -> AR_exp_s1_l9;\n  Expert43_s1_l9_tp2 -> AR_exp_s1_l9;\n  Expert44_s1_l9_tp3 -> AR_exp_s1_l9;\n  Expert45_s1_l9_tp3 -> AR_exp_s1_l9;\n  Expert46_s1_l9_tp3 -> AR_exp_s1_l9;\n  Expert47_s1_l9_tp3 -> AR_exp_s1_l9;\n  Expert48_s1_l9_tp4 -> AR_exp_s1_l9;\n  Expert49_s1_l9_tp4 -> AR_exp_s1_l9;\n  Expert50_s1_l9_tp4 -> AR_exp_s1_l9;\n  Expert51_s1_l9_tp4 -> AR_exp_s1_l9;\n  Expert52_s1_l9_tp5 -> AR_exp_s1_l9;\n  Expert53_s1_l9_tp5 -> AR_exp_s1_l9;\n  Expert54_s1_l9_tp5 -> AR_exp_s1_l9;\n  Expert55_s1_l9_tp5 -> AR_exp_s1_l9;\n  Expert56_s1_l9_tp6 -> AR_exp_s1_l9;\n  Expert57_s1_l9_tp6 -> AR_exp_s1_l9;\n  Expert58_s1_l9_tp6 -> AR_exp_s1_l9;\n  Expert59_s1_l9_tp6 -> AR_exp_s1_l9;\n  Expert60_s1_l9_tp7 -> AR_exp_s1_l9;\n  Expert61_s1_l9_tp7 -> AR_exp_s1_l9;\n  Expert62_s1_l9_tp7 -> AR_exp_s1_l9;\n  Expert63_s1_l9_tp7 -> AR_exp_s1_l9;\n  ResMOE_s1_l9_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp0;\n  ResAttn_s1_l9_tp0 -> ResMOE_s1_l9_tp0;\n  ResMOE_s1_l9_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp1;\n  ResAttn_s1_l9_tp1 -> ResMOE_s1_l9_tp1;\n  ResMOE_s1_l9_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp2;\n  ResAttn_s1_l9_tp2 -> ResMOE_s1_l9_tp2;\n  ResMOE_s1_l9_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp3;\n  ResAttn_s1_l9_tp3 -> ResMOE_s1_l9_tp3;\n  ResMOE_s1_l9_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp4;\n  ResAttn_s1_l9_tp4 -> ResMOE_s1_l9_tp4;\n  ResMOE_s1_l9_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp5;\n  ResAttn_s1_l9_tp5 -> ResMOE_s1_l9_tp5;\n  ResMOE_s1_l9_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp6;\n  ResAttn_s1_l9_tp6 -> ResMOE_s1_l9_tp6;\n  ResMOE_s1_l9_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l9 -> ResMOE_s1_l9_tp7;\n  ResAttn_s1_l9_tp7 -> ResMOE_s1_l9_tp7;\n  QKV_s1_l10_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp0;\n  QKV_s1_l10_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp1;\n  QKV_s1_l10_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp2;\n  QKV_s1_l10_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp3;\n  QKV_s1_l10_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp4;\n  QKV_s1_l10_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp5;\n  QKV_s1_l10_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp6;\n  QKV_s1_l10_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l9_tp0 -> QKV_s1_l10_tp7;\n  SplitHeads_s1_l10_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp0 -> SplitHeads_s1_l10_tp0;\n  SplitHeads_s1_l10_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp1 -> SplitHeads_s1_l10_tp1;\n  SplitHeads_s1_l10_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp2 -> SplitHeads_s1_l10_tp2;\n  SplitHeads_s1_l10_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp3 -> SplitHeads_s1_l10_tp3;\n  SplitHeads_s1_l10_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp4 -> SplitHeads_s1_l10_tp4;\n  SplitHeads_s1_l10_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp5 -> SplitHeads_s1_l10_tp5;\n  SplitHeads_s1_l10_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp6 -> SplitHeads_s1_l10_tp6;\n  SplitHeads_s1_l10_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l10_tp7 -> SplitHeads_s1_l10_tp7;\n  A2A_s1_l10 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l10_tp0 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp1 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp2 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp3 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp4 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp5 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp6 -> A2A_s1_l10;\n  SplitHeads_s1_l10_tp7 -> A2A_s1_l10;\n  Attn_s1_l10_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp0;\n  Attn_s1_l10_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp1;\n  Attn_s1_l10_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp2;\n  Attn_s1_l10_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp3;\n  Attn_s1_l10_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp4;\n  Attn_s1_l10_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp5;\n  Attn_s1_l10_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp6;\n  Attn_s1_l10_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l10 -> Attn_s1_l10_tp7;\n  AR_attn_s1_l10 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l10_tp0 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp1 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp2 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp3 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp4 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp5 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp6 -> AR_attn_s1_l10;\n  Attn_s1_l10_tp7 -> AR_attn_s1_l10;\n  O_s1_l10_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp0;\n  O_s1_l10_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp1;\n  O_s1_l10_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp2;\n  O_s1_l10_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp3;\n  O_s1_l10_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp4;\n  O_s1_l10_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp5;\n  O_s1_l10_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp6;\n  O_s1_l10_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l10 -> O_s1_l10_tp7;\n  ResAttn_s1_l10_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp0 -> ResAttn_s1_l10_tp0;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp0;\n  ResAttn_s1_l10_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp1 -> ResAttn_s1_l10_tp1;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp1;\n  ResAttn_s1_l10_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp2 -> ResAttn_s1_l10_tp2;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp2;\n  ResAttn_s1_l10_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp3 -> ResAttn_s1_l10_tp3;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp3;\n  ResAttn_s1_l10_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp4 -> ResAttn_s1_l10_tp4;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp4;\n  ResAttn_s1_l10_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp5 -> ResAttn_s1_l10_tp5;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp5;\n  ResAttn_s1_l10_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp6 -> ResAttn_s1_l10_tp6;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp6;\n  ResAttn_s1_l10_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l10_tp7 -> ResAttn_s1_l10_tp7;\n  ResMOE_s1_l9_tp0 -> ResAttn_s1_l10_tp7;\n  Gate_s1_l10_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp0 -> Gate_s1_l10_tp0;\n  Gate_s1_l10_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp1 -> Gate_s1_l10_tp1;\n  Gate_s1_l10_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp2 -> Gate_s1_l10_tp2;\n  Gate_s1_l10_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp3 -> Gate_s1_l10_tp3;\n  Gate_s1_l10_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp4 -> Gate_s1_l10_tp4;\n  Gate_s1_l10_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp5 -> Gate_s1_l10_tp5;\n  Gate_s1_l10_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp6 -> Gate_s1_l10_tp6;\n  Gate_s1_l10_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l10_tp7 -> Gate_s1_l10_tp7;\n  Expert32_s1_l10_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp0 -> Expert32_s1_l10_tp0 [style=dashed];\n  Expert33_s1_l10_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp0 -> Expert33_s1_l10_tp0 [style=dashed];\n  Expert34_s1_l10_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp0 -> Expert34_s1_l10_tp0 [style=dashed];\n  Expert35_s1_l10_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp0 -> Expert35_s1_l10_tp0 [style=dashed];\n  Expert36_s1_l10_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp1 -> Expert36_s1_l10_tp1 [style=dashed];\n  Expert37_s1_l10_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp1 -> Expert37_s1_l10_tp1 [style=dashed];\n  Expert38_s1_l10_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp1 -> Expert38_s1_l10_tp1 [style=dashed];\n  Expert39_s1_l10_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp1 -> Expert39_s1_l10_tp1 [style=dashed];\n  Expert40_s1_l10_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp2 -> Expert40_s1_l10_tp2 [style=dashed];\n  Expert41_s1_l10_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp2 -> Expert41_s1_l10_tp2 [style=dashed];\n  Expert42_s1_l10_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp2 -> Expert42_s1_l10_tp2 [style=dashed];\n  Expert43_s1_l10_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp2 -> Expert43_s1_l10_tp2 [style=dashed];\n  Expert44_s1_l10_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp3 -> Expert44_s1_l10_tp3 [style=dashed];\n  Expert45_s1_l10_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp3 -> Expert45_s1_l10_tp3 [style=dashed];\n  Expert46_s1_l10_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp3 -> Expert46_s1_l10_tp3 [style=dashed];\n  Expert47_s1_l10_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp3 -> Expert47_s1_l10_tp3 [style=dashed];\n  Expert48_s1_l10_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp4 -> Expert48_s1_l10_tp4 [style=dashed];\n  Expert49_s1_l10_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp4 -> Expert49_s1_l10_tp4 [style=dashed];\n  Expert50_s1_l10_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp4 -> Expert50_s1_l10_tp4 [style=dashed];\n  Expert51_s1_l10_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp4 -> Expert51_s1_l10_tp4 [style=dashed];\n  Expert52_s1_l10_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp5 -> Expert52_s1_l10_tp5 [style=dashed];\n  Expert53_s1_l10_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp5 -> Expert53_s1_l10_tp5 [style=dashed];\n  Expert54_s1_l10_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp5 -> Expert54_s1_l10_tp5 [style=dashed];\n  Expert55_s1_l10_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp5 -> Expert55_s1_l10_tp5 [style=dashed];\n  Expert56_s1_l10_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp6 -> Expert56_s1_l10_tp6 [style=dashed];\n  Expert57_s1_l10_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp6 -> Expert57_s1_l10_tp6 [style=dashed];\n  Expert58_s1_l10_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp6 -> Expert58_s1_l10_tp6 [style=dashed];\n  Expert59_s1_l10_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp6 -> Expert59_s1_l10_tp6 [style=dashed];\n  Expert60_s1_l10_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp7 -> Expert60_s1_l10_tp7 [style=dashed];\n  Expert61_s1_l10_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp7 -> Expert61_s1_l10_tp7 [style=dashed];\n  Expert62_s1_l10_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp7 -> Expert62_s1_l10_tp7 [style=dashed];\n  Expert63_s1_l10_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l10_tp7 -> Expert63_s1_l10_tp7 [style=dashed];\n  AR_exp_s1_l10 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l10_tp0 -> AR_exp_s1_l10;\n  Expert33_s1_l10_tp0 -> AR_exp_s1_l10;\n  Expert34_s1_l10_tp0 -> AR_exp_s1_l10;\n  Expert35_s1_l10_tp0 -> AR_exp_s1_l10;\n  Expert36_s1_l10_tp1 -> AR_exp_s1_l10;\n  Expert37_s1_l10_tp1 -> AR_exp_s1_l10;\n  Expert38_s1_l10_tp1 -> AR_exp_s1_l10;\n  Expert39_s1_l10_tp1 -> AR_exp_s1_l10;\n  Expert40_s1_l10_tp2 -> AR_exp_s1_l10;\n  Expert41_s1_l10_tp2 -> AR_exp_s1_l10;\n  Expert42_s1_l10_tp2 -> AR_exp_s1_l10;\n  Expert43_s1_l10_tp2 -> AR_exp_s1_l10;\n  Expert44_s1_l10_tp3 -> AR_exp_s1_l10;\n  Expert45_s1_l10_tp3 -> AR_exp_s1_l10;\n  Expert46_s1_l10_tp3 -> AR_exp_s1_l10;\n  Expert47_s1_l10_tp3 -> AR_exp_s1_l10;\n  Expert48_s1_l10_tp4 -> AR_exp_s1_l10;\n  Expert49_s1_l10_tp4 -> AR_exp_s1_l10;\n  Expert50_s1_l10_tp4 -> AR_exp_s1_l10;\n  Expert51_s1_l10_tp4 -> AR_exp_s1_l10;\n  Expert52_s1_l10_tp5 -> AR_exp_s1_l10;\n  Expert53_s1_l10_tp5 -> AR_exp_s1_l10;\n  Expert54_s1_l10_tp5 -> AR_exp_s1_l10;\n  Expert55_s1_l10_tp5 -> AR_exp_s1_l10;\n  Expert56_s1_l10_tp6 -> AR_exp_s1_l10;\n  Expert57_s1_l10_tp6 -> AR_exp_s1_l10;\n  Expert58_s1_l10_tp6 -> AR_exp_s1_l10;\n  Expert59_s1_l10_tp6 -> AR_exp_s1_l10;\n  Expert60_s1_l10_tp7 -> AR_exp_s1_l10;\n  Expert61_s1_l10_tp7 -> AR_exp_s1_l10;\n  Expert62_s1_l10_tp7 -> AR_exp_s1_l10;\n  Expert63_s1_l10_tp7 -> AR_exp_s1_l10;\n  ResMOE_s1_l10_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp0;\n  ResAttn_s1_l10_tp0 -> ResMOE_s1_l10_tp0;\n  ResMOE_s1_l10_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp1;\n  ResAttn_s1_l10_tp1 -> ResMOE_s1_l10_tp1;\n  ResMOE_s1_l10_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp2;\n  ResAttn_s1_l10_tp2 -> ResMOE_s1_l10_tp2;\n  ResMOE_s1_l10_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp3;\n  ResAttn_s1_l10_tp3 -> ResMOE_s1_l10_tp3;\n  ResMOE_s1_l10_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp4;\n  ResAttn_s1_l10_tp4 -> ResMOE_s1_l10_tp4;\n  ResMOE_s1_l10_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp5;\n  ResAttn_s1_l10_tp5 -> ResMOE_s1_l10_tp5;\n  ResMOE_s1_l10_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp6;\n  ResAttn_s1_l10_tp6 -> ResMOE_s1_l10_tp6;\n  ResMOE_s1_l10_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l10 -> ResMOE_s1_l10_tp7;\n  ResAttn_s1_l10_tp7 -> ResMOE_s1_l10_tp7;\n  QKV_s1_l11_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp0;\n  QKV_s1_l11_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp1;\n  QKV_s1_l11_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp2;\n  QKV_s1_l11_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp3;\n  QKV_s1_l11_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp4;\n  QKV_s1_l11_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp5;\n  QKV_s1_l11_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp6;\n  QKV_s1_l11_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l10_tp0 -> QKV_s1_l11_tp7;\n  SplitHeads_s1_l11_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp0 -> SplitHeads_s1_l11_tp0;\n  SplitHeads_s1_l11_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp1 -> SplitHeads_s1_l11_tp1;\n  SplitHeads_s1_l11_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp2 -> SplitHeads_s1_l11_tp2;\n  SplitHeads_s1_l11_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp3 -> SplitHeads_s1_l11_tp3;\n  SplitHeads_s1_l11_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp4 -> SplitHeads_s1_l11_tp4;\n  SplitHeads_s1_l11_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp5 -> SplitHeads_s1_l11_tp5;\n  SplitHeads_s1_l11_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp6 -> SplitHeads_s1_l11_tp6;\n  SplitHeads_s1_l11_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l11_tp7 -> SplitHeads_s1_l11_tp7;\n  A2A_s1_l11 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l11_tp0 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp1 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp2 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp3 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp4 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp5 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp6 -> A2A_s1_l11;\n  SplitHeads_s1_l11_tp7 -> A2A_s1_l11;\n  Attn_s1_l11_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp0;\n  Attn_s1_l11_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp1;\n  Attn_s1_l11_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp2;\n  Attn_s1_l11_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp3;\n  Attn_s1_l11_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp4;\n  Attn_s1_l11_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp5;\n  Attn_s1_l11_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp6;\n  Attn_s1_l11_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l11 -> Attn_s1_l11_tp7;\n  AR_attn_s1_l11 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l11_tp0 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp1 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp2 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp3 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp4 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp5 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp6 -> AR_attn_s1_l11;\n  Attn_s1_l11_tp7 -> AR_attn_s1_l11;\n  O_s1_l11_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp0;\n  O_s1_l11_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp1;\n  O_s1_l11_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp2;\n  O_s1_l11_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp3;\n  O_s1_l11_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp4;\n  O_s1_l11_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp5;\n  O_s1_l11_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp6;\n  O_s1_l11_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l11 -> O_s1_l11_tp7;\n  ResAttn_s1_l11_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp0 -> ResAttn_s1_l11_tp0;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp0;\n  ResAttn_s1_l11_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp1 -> ResAttn_s1_l11_tp1;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp1;\n  ResAttn_s1_l11_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp2 -> ResAttn_s1_l11_tp2;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp2;\n  ResAttn_s1_l11_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp3 -> ResAttn_s1_l11_tp3;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp3;\n  ResAttn_s1_l11_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp4 -> ResAttn_s1_l11_tp4;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp4;\n  ResAttn_s1_l11_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp5 -> ResAttn_s1_l11_tp5;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp5;\n  ResAttn_s1_l11_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp6 -> ResAttn_s1_l11_tp6;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp6;\n  ResAttn_s1_l11_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l11_tp7 -> ResAttn_s1_l11_tp7;\n  ResMOE_s1_l10_tp0 -> ResAttn_s1_l11_tp7;\n  Gate_s1_l11_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp0 -> Gate_s1_l11_tp0;\n  Gate_s1_l11_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp1 -> Gate_s1_l11_tp1;\n  Gate_s1_l11_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp2 -> Gate_s1_l11_tp2;\n  Gate_s1_l11_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp3 -> Gate_s1_l11_tp3;\n  Gate_s1_l11_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp4 -> Gate_s1_l11_tp4;\n  Gate_s1_l11_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp5 -> Gate_s1_l11_tp5;\n  Gate_s1_l11_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp6 -> Gate_s1_l11_tp6;\n  Gate_s1_l11_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l11_tp7 -> Gate_s1_l11_tp7;\n  Expert32_s1_l11_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp0 -> Expert32_s1_l11_tp0 [style=dashed];\n  Expert33_s1_l11_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp0 -> Expert33_s1_l11_tp0 [style=dashed];\n  Expert34_s1_l11_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp0 -> Expert34_s1_l11_tp0 [style=dashed];\n  Expert35_s1_l11_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp0 -> Expert35_s1_l11_tp0 [style=dashed];\n  Expert36_s1_l11_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp1 -> Expert36_s1_l11_tp1 [style=dashed];\n  Expert37_s1_l11_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp1 -> Expert37_s1_l11_tp1 [style=dashed];\n  Expert38_s1_l11_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp1 -> Expert38_s1_l11_tp1 [style=dashed];\n  Expert39_s1_l11_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp1 -> Expert39_s1_l11_tp1 [style=dashed];\n  Expert40_s1_l11_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp2 -> Expert40_s1_l11_tp2 [style=dashed];\n  Expert41_s1_l11_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp2 -> Expert41_s1_l11_tp2 [style=dashed];\n  Expert42_s1_l11_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp2 -> Expert42_s1_l11_tp2 [style=dashed];\n  Expert43_s1_l11_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp2 -> Expert43_s1_l11_tp2 [style=dashed];\n  Expert44_s1_l11_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp3 -> Expert44_s1_l11_tp3 [style=dashed];\n  Expert45_s1_l11_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp3 -> Expert45_s1_l11_tp3 [style=dashed];\n  Expert46_s1_l11_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp3 -> Expert46_s1_l11_tp3 [style=dashed];\n  Expert47_s1_l11_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp3 -> Expert47_s1_l11_tp3 [style=dashed];\n  Expert48_s1_l11_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp4 -> Expert48_s1_l11_tp4 [style=dashed];\n  Expert49_s1_l11_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp4 -> Expert49_s1_l11_tp4 [style=dashed];\n  Expert50_s1_l11_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp4 -> Expert50_s1_l11_tp4 [style=dashed];\n  Expert51_s1_l11_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp4 -> Expert51_s1_l11_tp4 [style=dashed];\n  Expert52_s1_l11_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp5 -> Expert52_s1_l11_tp5 [style=dashed];\n  Expert53_s1_l11_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp5 -> Expert53_s1_l11_tp5 [style=dashed];\n  Expert54_s1_l11_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp5 -> Expert54_s1_l11_tp5 [style=dashed];\n  Expert55_s1_l11_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp5 -> Expert55_s1_l11_tp5 [style=dashed];\n  Expert56_s1_l11_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp6 -> Expert56_s1_l11_tp6 [style=dashed];\n  Expert57_s1_l11_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp6 -> Expert57_s1_l11_tp6 [style=dashed];\n  Expert58_s1_l11_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp6 -> Expert58_s1_l11_tp6 [style=dashed];\n  Expert59_s1_l11_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp6 -> Expert59_s1_l11_tp6 [style=dashed];\n  Expert60_s1_l11_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp7 -> Expert60_s1_l11_tp7 [style=dashed];\n  Expert61_s1_l11_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp7 -> Expert61_s1_l11_tp7 [style=dashed];\n  Expert62_s1_l11_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp7 -> Expert62_s1_l11_tp7 [style=dashed];\n  Expert63_s1_l11_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l11_tp7 -> Expert63_s1_l11_tp7 [style=dashed];\n  AR_exp_s1_l11 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l11_tp0 -> AR_exp_s1_l11;\n  Expert33_s1_l11_tp0 -> AR_exp_s1_l11;\n  Expert34_s1_l11_tp0 -> AR_exp_s1_l11;\n  Expert35_s1_l11_tp0 -> AR_exp_s1_l11;\n  Expert36_s1_l11_tp1 -> AR_exp_s1_l11;\n  Expert37_s1_l11_tp1 -> AR_exp_s1_l11;\n  Expert38_s1_l11_tp1 -> AR_exp_s1_l11;\n  Expert39_s1_l11_tp1 -> AR_exp_s1_l11;\n  Expert40_s1_l11_tp2 -> AR_exp_s1_l11;\n  Expert41_s1_l11_tp2 -> AR_exp_s1_l11;\n  Expert42_s1_l11_tp2 -> AR_exp_s1_l11;\n  Expert43_s1_l11_tp2 -> AR_exp_s1_l11;\n  Expert44_s1_l11_tp3 -> AR_exp_s1_l11;\n  Expert45_s1_l11_tp3 -> AR_exp_s1_l11;\n  Expert46_s1_l11_tp3 -> AR_exp_s1_l11;\n  Expert47_s1_l11_tp3 -> AR_exp_s1_l11;\n  Expert48_s1_l11_tp4 -> AR_exp_s1_l11;\n  Expert49_s1_l11_tp4 -> AR_exp_s1_l11;\n  Expert50_s1_l11_tp4 -> AR_exp_s1_l11;\n  Expert51_s1_l11_tp4 -> AR_exp_s1_l11;\n  Expert52_s1_l11_tp5 -> AR_exp_s1_l11;\n  Expert53_s1_l11_tp5 -> AR_exp_s1_l11;\n  Expert54_s1_l11_tp5 -> AR_exp_s1_l11;\n  Expert55_s1_l11_tp5 -> AR_exp_s1_l11;\n  Expert56_s1_l11_tp6 -> AR_exp_s1_l11;\n  Expert57_s1_l11_tp6 -> AR_exp_s1_l11;\n  Expert58_s1_l11_tp6 -> AR_exp_s1_l11;\n  Expert59_s1_l11_tp6 -> AR_exp_s1_l11;\n  Expert60_s1_l11_tp7 -> AR_exp_s1_l11;\n  Expert61_s1_l11_tp7 -> AR_exp_s1_l11;\n  Expert62_s1_l11_tp7 -> AR_exp_s1_l11;\n  Expert63_s1_l11_tp7 -> AR_exp_s1_l11;\n  ResMOE_s1_l11_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp0;\n  ResAttn_s1_l11_tp0 -> ResMOE_s1_l11_tp0;\n  ResMOE_s1_l11_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp1;\n  ResAttn_s1_l11_tp1 -> ResMOE_s1_l11_tp1;\n  ResMOE_s1_l11_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp2;\n  ResAttn_s1_l11_tp2 -> ResMOE_s1_l11_tp2;\n  ResMOE_s1_l11_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp3;\n  ResAttn_s1_l11_tp3 -> ResMOE_s1_l11_tp3;\n  ResMOE_s1_l11_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp4;\n  ResAttn_s1_l11_tp4 -> ResMOE_s1_l11_tp4;\n  ResMOE_s1_l11_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp5;\n  ResAttn_s1_l11_tp5 -> ResMOE_s1_l11_tp5;\n  ResMOE_s1_l11_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp6;\n  ResAttn_s1_l11_tp6 -> ResMOE_s1_l11_tp6;\n  ResMOE_s1_l11_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l11 -> ResMOE_s1_l11_tp7;\n  ResAttn_s1_l11_tp7 -> ResMOE_s1_l11_tp7;\n  QKV_s1_l12_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp0;\n  QKV_s1_l12_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp1;\n  QKV_s1_l12_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp2;\n  QKV_s1_l12_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp3;\n  QKV_s1_l12_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp4;\n  QKV_s1_l12_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp5;\n  QKV_s1_l12_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp6;\n  QKV_s1_l12_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l11_tp0 -> QKV_s1_l12_tp7;\n  SplitHeads_s1_l12_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp0 -> SplitHeads_s1_l12_tp0;\n  SplitHeads_s1_l12_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp1 -> SplitHeads_s1_l12_tp1;\n  SplitHeads_s1_l12_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp2 -> SplitHeads_s1_l12_tp2;\n  SplitHeads_s1_l12_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp3 -> SplitHeads_s1_l12_tp3;\n  SplitHeads_s1_l12_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp4 -> SplitHeads_s1_l12_tp4;\n  SplitHeads_s1_l12_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp5 -> SplitHeads_s1_l12_tp5;\n  SplitHeads_s1_l12_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp6 -> SplitHeads_s1_l12_tp6;\n  SplitHeads_s1_l12_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l12_tp7 -> SplitHeads_s1_l12_tp7;\n  A2A_s1_l12 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l12_tp0 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp1 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp2 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp3 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp4 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp5 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp6 -> A2A_s1_l12;\n  SplitHeads_s1_l12_tp7 -> A2A_s1_l12;\n  Attn_s1_l12_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp0;\n  Attn_s1_l12_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp1;\n  Attn_s1_l12_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp2;\n  Attn_s1_l12_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp3;\n  Attn_s1_l12_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp4;\n  Attn_s1_l12_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp5;\n  Attn_s1_l12_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp6;\n  Attn_s1_l12_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l12 -> Attn_s1_l12_tp7;\n  AR_attn_s1_l12 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l12_tp0 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp1 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp2 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp3 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp4 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp5 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp6 -> AR_attn_s1_l12;\n  Attn_s1_l12_tp7 -> AR_attn_s1_l12;\n  O_s1_l12_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp0;\n  O_s1_l12_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp1;\n  O_s1_l12_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp2;\n  O_s1_l12_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp3;\n  O_s1_l12_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp4;\n  O_s1_l12_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp5;\n  O_s1_l12_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp6;\n  O_s1_l12_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l12 -> O_s1_l12_tp7;\n  ResAttn_s1_l12_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp0 -> ResAttn_s1_l12_tp0;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp0;\n  ResAttn_s1_l12_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp1 -> ResAttn_s1_l12_tp1;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp1;\n  ResAttn_s1_l12_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp2 -> ResAttn_s1_l12_tp2;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp2;\n  ResAttn_s1_l12_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp3 -> ResAttn_s1_l12_tp3;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp3;\n  ResAttn_s1_l12_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp4 -> ResAttn_s1_l12_tp4;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp4;\n  ResAttn_s1_l12_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp5 -> ResAttn_s1_l12_tp5;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp5;\n  ResAttn_s1_l12_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp6 -> ResAttn_s1_l12_tp6;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp6;\n  ResAttn_s1_l12_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l12_tp7 -> ResAttn_s1_l12_tp7;\n  ResMOE_s1_l11_tp0 -> ResAttn_s1_l12_tp7;\n  Gate_s1_l12_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp0 -> Gate_s1_l12_tp0;\n  Gate_s1_l12_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp1 -> Gate_s1_l12_tp1;\n  Gate_s1_l12_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp2 -> Gate_s1_l12_tp2;\n  Gate_s1_l12_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp3 -> Gate_s1_l12_tp3;\n  Gate_s1_l12_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp4 -> Gate_s1_l12_tp4;\n  Gate_s1_l12_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp5 -> Gate_s1_l12_tp5;\n  Gate_s1_l12_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp6 -> Gate_s1_l12_tp6;\n  Gate_s1_l12_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l12_tp7 -> Gate_s1_l12_tp7;\n  Expert32_s1_l12_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp0 -> Expert32_s1_l12_tp0 [style=dashed];\n  Expert33_s1_l12_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp0 -> Expert33_s1_l12_tp0 [style=dashed];\n  Expert34_s1_l12_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp0 -> Expert34_s1_l12_tp0 [style=dashed];\n  Expert35_s1_l12_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp0 -> Expert35_s1_l12_tp0 [style=dashed];\n  Expert36_s1_l12_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp1 -> Expert36_s1_l12_tp1 [style=dashed];\n  Expert37_s1_l12_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp1 -> Expert37_s1_l12_tp1 [style=dashed];\n  Expert38_s1_l12_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp1 -> Expert38_s1_l12_tp1 [style=dashed];\n  Expert39_s1_l12_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp1 -> Expert39_s1_l12_tp1 [style=dashed];\n  Expert40_s1_l12_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp2 -> Expert40_s1_l12_tp2 [style=dashed];\n  Expert41_s1_l12_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp2 -> Expert41_s1_l12_tp2 [style=dashed];\n  Expert42_s1_l12_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp2 -> Expert42_s1_l12_tp2 [style=dashed];\n  Expert43_s1_l12_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp2 -> Expert43_s1_l12_tp2 [style=dashed];\n  Expert44_s1_l12_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp3 -> Expert44_s1_l12_tp3 [style=dashed];\n  Expert45_s1_l12_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp3 -> Expert45_s1_l12_tp3 [style=dashed];\n  Expert46_s1_l12_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp3 -> Expert46_s1_l12_tp3 [style=dashed];\n  Expert47_s1_l12_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp3 -> Expert47_s1_l12_tp3 [style=dashed];\n  Expert48_s1_l12_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp4 -> Expert48_s1_l12_tp4 [style=dashed];\n  Expert49_s1_l12_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp4 -> Expert49_s1_l12_tp4 [style=dashed];\n  Expert50_s1_l12_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp4 -> Expert50_s1_l12_tp4 [style=dashed];\n  Expert51_s1_l12_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp4 -> Expert51_s1_l12_tp4 [style=dashed];\n  Expert52_s1_l12_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp5 -> Expert52_s1_l12_tp5 [style=dashed];\n  Expert53_s1_l12_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp5 -> Expert53_s1_l12_tp5 [style=dashed];\n  Expert54_s1_l12_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp5 -> Expert54_s1_l12_tp5 [style=dashed];\n  Expert55_s1_l12_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp5 -> Expert55_s1_l12_tp5 [style=dashed];\n  Expert56_s1_l12_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp6 -> Expert56_s1_l12_tp6 [style=dashed];\n  Expert57_s1_l12_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp6 -> Expert57_s1_l12_tp6 [style=dashed];\n  Expert58_s1_l12_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp6 -> Expert58_s1_l12_tp6 [style=dashed];\n  Expert59_s1_l12_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp6 -> Expert59_s1_l12_tp6 [style=dashed];\n  Expert60_s1_l12_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp7 -> Expert60_s1_l12_tp7 [style=dashed];\n  Expert61_s1_l12_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp7 -> Expert61_s1_l12_tp7 [style=dashed];\n  Expert62_s1_l12_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp7 -> Expert62_s1_l12_tp7 [style=dashed];\n  Expert63_s1_l12_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l12_tp7 -> Expert63_s1_l12_tp7 [style=dashed];\n  AR_exp_s1_l12 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l12_tp0 -> AR_exp_s1_l12;\n  Expert33_s1_l12_tp0 -> AR_exp_s1_l12;\n  Expert34_s1_l12_tp0 -> AR_exp_s1_l12;\n  Expert35_s1_l12_tp0 -> AR_exp_s1_l12;\n  Expert36_s1_l12_tp1 -> AR_exp_s1_l12;\n  Expert37_s1_l12_tp1 -> AR_exp_s1_l12;\n  Expert38_s1_l12_tp1 -> AR_exp_s1_l12;\n  Expert39_s1_l12_tp1 -> AR_exp_s1_l12;\n  Expert40_s1_l12_tp2 -> AR_exp_s1_l12;\n  Expert41_s1_l12_tp2 -> AR_exp_s1_l12;\n  Expert42_s1_l12_tp2 -> AR_exp_s1_l12;\n  Expert43_s1_l12_tp2 -> AR_exp_s1_l12;\n  Expert44_s1_l12_tp3 -> AR_exp_s1_l12;\n  Expert45_s1_l12_tp3 -> AR_exp_s1_l12;\n  Expert46_s1_l12_tp3 -> AR_exp_s1_l12;\n  Expert47_s1_l12_tp3 -> AR_exp_s1_l12;\n  Expert48_s1_l12_tp4 -> AR_exp_s1_l12;\n  Expert49_s1_l12_tp4 -> AR_exp_s1_l12;\n  Expert50_s1_l12_tp4 -> AR_exp_s1_l12;\n  Expert51_s1_l12_tp4 -> AR_exp_s1_l12;\n  Expert52_s1_l12_tp5 -> AR_exp_s1_l12;\n  Expert53_s1_l12_tp5 -> AR_exp_s1_l12;\n  Expert54_s1_l12_tp5 -> AR_exp_s1_l12;\n  Expert55_s1_l12_tp5 -> AR_exp_s1_l12;\n  Expert56_s1_l12_tp6 -> AR_exp_s1_l12;\n  Expert57_s1_l12_tp6 -> AR_exp_s1_l12;\n  Expert58_s1_l12_tp6 -> AR_exp_s1_l12;\n  Expert59_s1_l12_tp6 -> AR_exp_s1_l12;\n  Expert60_s1_l12_tp7 -> AR_exp_s1_l12;\n  Expert61_s1_l12_tp7 -> AR_exp_s1_l12;\n  Expert62_s1_l12_tp7 -> AR_exp_s1_l12;\n  Expert63_s1_l12_tp7 -> AR_exp_s1_l12;\n  ResMOE_s1_l12_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp0;\n  ResAttn_s1_l12_tp0 -> ResMOE_s1_l12_tp0;\n  ResMOE_s1_l12_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp1;\n  ResAttn_s1_l12_tp1 -> ResMOE_s1_l12_tp1;\n  ResMOE_s1_l12_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp2;\n  ResAttn_s1_l12_tp2 -> ResMOE_s1_l12_tp2;\n  ResMOE_s1_l12_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp3;\n  ResAttn_s1_l12_tp3 -> ResMOE_s1_l12_tp3;\n  ResMOE_s1_l12_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp4;\n  ResAttn_s1_l12_tp4 -> ResMOE_s1_l12_tp4;\n  ResMOE_s1_l12_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp5;\n  ResAttn_s1_l12_tp5 -> ResMOE_s1_l12_tp5;\n  ResMOE_s1_l12_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp6;\n  ResAttn_s1_l12_tp6 -> ResMOE_s1_l12_tp6;\n  ResMOE_s1_l12_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l12 -> ResMOE_s1_l12_tp7;\n  ResAttn_s1_l12_tp7 -> ResMOE_s1_l12_tp7;\n  QKV_s1_l13_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp0;\n  QKV_s1_l13_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp1;\n  QKV_s1_l13_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp2;\n  QKV_s1_l13_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp3;\n  QKV_s1_l13_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp4;\n  QKV_s1_l13_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp5;\n  QKV_s1_l13_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp6;\n  QKV_s1_l13_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l12_tp0 -> QKV_s1_l13_tp7;\n  SplitHeads_s1_l13_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp0 -> SplitHeads_s1_l13_tp0;\n  SplitHeads_s1_l13_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp1 -> SplitHeads_s1_l13_tp1;\n  SplitHeads_s1_l13_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp2 -> SplitHeads_s1_l13_tp2;\n  SplitHeads_s1_l13_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp3 -> SplitHeads_s1_l13_tp3;\n  SplitHeads_s1_l13_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp4 -> SplitHeads_s1_l13_tp4;\n  SplitHeads_s1_l13_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp5 -> SplitHeads_s1_l13_tp5;\n  SplitHeads_s1_l13_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp6 -> SplitHeads_s1_l13_tp6;\n  SplitHeads_s1_l13_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l13_tp7 -> SplitHeads_s1_l13_tp7;\n  A2A_s1_l13 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l13_tp0 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp1 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp2 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp3 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp4 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp5 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp6 -> A2A_s1_l13;\n  SplitHeads_s1_l13_tp7 -> A2A_s1_l13;\n  Attn_s1_l13_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp0;\n  Attn_s1_l13_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp1;\n  Attn_s1_l13_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp2;\n  Attn_s1_l13_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp3;\n  Attn_s1_l13_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp4;\n  Attn_s1_l13_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp5;\n  Attn_s1_l13_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp6;\n  Attn_s1_l13_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l13 -> Attn_s1_l13_tp7;\n  AR_attn_s1_l13 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l13_tp0 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp1 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp2 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp3 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp4 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp5 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp6 -> AR_attn_s1_l13;\n  Attn_s1_l13_tp7 -> AR_attn_s1_l13;\n  O_s1_l13_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp0;\n  O_s1_l13_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp1;\n  O_s1_l13_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp2;\n  O_s1_l13_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp3;\n  O_s1_l13_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp4;\n  O_s1_l13_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp5;\n  O_s1_l13_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp6;\n  O_s1_l13_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l13 -> O_s1_l13_tp7;\n  ResAttn_s1_l13_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp0 -> ResAttn_s1_l13_tp0;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp0;\n  ResAttn_s1_l13_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp1 -> ResAttn_s1_l13_tp1;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp1;\n  ResAttn_s1_l13_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp2 -> ResAttn_s1_l13_tp2;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp2;\n  ResAttn_s1_l13_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp3 -> ResAttn_s1_l13_tp3;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp3;\n  ResAttn_s1_l13_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp4 -> ResAttn_s1_l13_tp4;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp4;\n  ResAttn_s1_l13_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp5 -> ResAttn_s1_l13_tp5;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp5;\n  ResAttn_s1_l13_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp6 -> ResAttn_s1_l13_tp6;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp6;\n  ResAttn_s1_l13_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l13_tp7 -> ResAttn_s1_l13_tp7;\n  ResMOE_s1_l12_tp0 -> ResAttn_s1_l13_tp7;\n  Gate_s1_l13_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp0 -> Gate_s1_l13_tp0;\n  Gate_s1_l13_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp1 -> Gate_s1_l13_tp1;\n  Gate_s1_l13_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp2 -> Gate_s1_l13_tp2;\n  Gate_s1_l13_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp3 -> Gate_s1_l13_tp3;\n  Gate_s1_l13_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp4 -> Gate_s1_l13_tp4;\n  Gate_s1_l13_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp5 -> Gate_s1_l13_tp5;\n  Gate_s1_l13_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp6 -> Gate_s1_l13_tp6;\n  Gate_s1_l13_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l13_tp7 -> Gate_s1_l13_tp7;\n  Expert32_s1_l13_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp0 -> Expert32_s1_l13_tp0 [style=dashed];\n  Expert33_s1_l13_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp0 -> Expert33_s1_l13_tp0 [style=dashed];\n  Expert34_s1_l13_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp0 -> Expert34_s1_l13_tp0 [style=dashed];\n  Expert35_s1_l13_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp0 -> Expert35_s1_l13_tp0 [style=dashed];\n  Expert36_s1_l13_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp1 -> Expert36_s1_l13_tp1 [style=dashed];\n  Expert37_s1_l13_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp1 -> Expert37_s1_l13_tp1 [style=dashed];\n  Expert38_s1_l13_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp1 -> Expert38_s1_l13_tp1 [style=dashed];\n  Expert39_s1_l13_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp1 -> Expert39_s1_l13_tp1 [style=dashed];\n  Expert40_s1_l13_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp2 -> Expert40_s1_l13_tp2 [style=dashed];\n  Expert41_s1_l13_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp2 -> Expert41_s1_l13_tp2 [style=dashed];\n  Expert42_s1_l13_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp2 -> Expert42_s1_l13_tp2 [style=dashed];\n  Expert43_s1_l13_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp2 -> Expert43_s1_l13_tp2 [style=dashed];\n  Expert44_s1_l13_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp3 -> Expert44_s1_l13_tp3 [style=dashed];\n  Expert45_s1_l13_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp3 -> Expert45_s1_l13_tp3 [style=dashed];\n  Expert46_s1_l13_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp3 -> Expert46_s1_l13_tp3 [style=dashed];\n  Expert47_s1_l13_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp3 -> Expert47_s1_l13_tp3 [style=dashed];\n  Expert48_s1_l13_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp4 -> Expert48_s1_l13_tp4 [style=dashed];\n  Expert49_s1_l13_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp4 -> Expert49_s1_l13_tp4 [style=dashed];\n  Expert50_s1_l13_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp4 -> Expert50_s1_l13_tp4 [style=dashed];\n  Expert51_s1_l13_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp4 -> Expert51_s1_l13_tp4 [style=dashed];\n  Expert52_s1_l13_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp5 -> Expert52_s1_l13_tp5 [style=dashed];\n  Expert53_s1_l13_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp5 -> Expert53_s1_l13_tp5 [style=dashed];\n  Expert54_s1_l13_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp5 -> Expert54_s1_l13_tp5 [style=dashed];\n  Expert55_s1_l13_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp5 -> Expert55_s1_l13_tp5 [style=dashed];\n  Expert56_s1_l13_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp6 -> Expert56_s1_l13_tp6 [style=dashed];\n  Expert57_s1_l13_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp6 -> Expert57_s1_l13_tp6 [style=dashed];\n  Expert58_s1_l13_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp6 -> Expert58_s1_l13_tp6 [style=dashed];\n  Expert59_s1_l13_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp6 -> Expert59_s1_l13_tp6 [style=dashed];\n  Expert60_s1_l13_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp7 -> Expert60_s1_l13_tp7 [style=dashed];\n  Expert61_s1_l13_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp7 -> Expert61_s1_l13_tp7 [style=dashed];\n  Expert62_s1_l13_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp7 -> Expert62_s1_l13_tp7 [style=dashed];\n  Expert63_s1_l13_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l13_tp7 -> Expert63_s1_l13_tp7 [style=dashed];\n  AR_exp_s1_l13 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l13_tp0 -> AR_exp_s1_l13;\n  Expert33_s1_l13_tp0 -> AR_exp_s1_l13;\n  Expert34_s1_l13_tp0 -> AR_exp_s1_l13;\n  Expert35_s1_l13_tp0 -> AR_exp_s1_l13;\n  Expert36_s1_l13_tp1 -> AR_exp_s1_l13;\n  Expert37_s1_l13_tp1 -> AR_exp_s1_l13;\n  Expert38_s1_l13_tp1 -> AR_exp_s1_l13;\n  Expert39_s1_l13_tp1 -> AR_exp_s1_l13;\n  Expert40_s1_l13_tp2 -> AR_exp_s1_l13;\n  Expert41_s1_l13_tp2 -> AR_exp_s1_l13;\n  Expert42_s1_l13_tp2 -> AR_exp_s1_l13;\n  Expert43_s1_l13_tp2 -> AR_exp_s1_l13;\n  Expert44_s1_l13_tp3 -> AR_exp_s1_l13;\n  Expert45_s1_l13_tp3 -> AR_exp_s1_l13;\n  Expert46_s1_l13_tp3 -> AR_exp_s1_l13;\n  Expert47_s1_l13_tp3 -> AR_exp_s1_l13;\n  Expert48_s1_l13_tp4 -> AR_exp_s1_l13;\n  Expert49_s1_l13_tp4 -> AR_exp_s1_l13;\n  Expert50_s1_l13_tp4 -> AR_exp_s1_l13;\n  Expert51_s1_l13_tp4 -> AR_exp_s1_l13;\n  Expert52_s1_l13_tp5 -> AR_exp_s1_l13;\n  Expert53_s1_l13_tp5 -> AR_exp_s1_l13;\n  Expert54_s1_l13_tp5 -> AR_exp_s1_l13;\n  Expert55_s1_l13_tp5 -> AR_exp_s1_l13;\n  Expert56_s1_l13_tp6 -> AR_exp_s1_l13;\n  Expert57_s1_l13_tp6 -> AR_exp_s1_l13;\n  Expert58_s1_l13_tp6 -> AR_exp_s1_l13;\n  Expert59_s1_l13_tp6 -> AR_exp_s1_l13;\n  Expert60_s1_l13_tp7 -> AR_exp_s1_l13;\n  Expert61_s1_l13_tp7 -> AR_exp_s1_l13;\n  Expert62_s1_l13_tp7 -> AR_exp_s1_l13;\n  Expert63_s1_l13_tp7 -> AR_exp_s1_l13;\n  ResMOE_s1_l13_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp0;\n  ResAttn_s1_l13_tp0 -> ResMOE_s1_l13_tp0;\n  ResMOE_s1_l13_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp1;\n  ResAttn_s1_l13_tp1 -> ResMOE_s1_l13_tp1;\n  ResMOE_s1_l13_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp2;\n  ResAttn_s1_l13_tp2 -> ResMOE_s1_l13_tp2;\n  ResMOE_s1_l13_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp3;\n  ResAttn_s1_l13_tp3 -> ResMOE_s1_l13_tp3;\n  ResMOE_s1_l13_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp4;\n  ResAttn_s1_l13_tp4 -> ResMOE_s1_l13_tp4;\n  ResMOE_s1_l13_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp5;\n  ResAttn_s1_l13_tp5 -> ResMOE_s1_l13_tp5;\n  ResMOE_s1_l13_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp6;\n  ResAttn_s1_l13_tp6 -> ResMOE_s1_l13_tp6;\n  ResMOE_s1_l13_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l13 -> ResMOE_s1_l13_tp7;\n  ResAttn_s1_l13_tp7 -> ResMOE_s1_l13_tp7;\n  QKV_s1_l14_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp0;\n  QKV_s1_l14_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp1;\n  QKV_s1_l14_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp2;\n  QKV_s1_l14_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp3;\n  QKV_s1_l14_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp4;\n  QKV_s1_l14_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp5;\n  QKV_s1_l14_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp6;\n  QKV_s1_l14_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l13_tp0 -> QKV_s1_l14_tp7;\n  SplitHeads_s1_l14_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp0 -> SplitHeads_s1_l14_tp0;\n  SplitHeads_s1_l14_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp1 -> SplitHeads_s1_l14_tp1;\n  SplitHeads_s1_l14_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp2 -> SplitHeads_s1_l14_tp2;\n  SplitHeads_s1_l14_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp3 -> SplitHeads_s1_l14_tp3;\n  SplitHeads_s1_l14_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp4 -> SplitHeads_s1_l14_tp4;\n  SplitHeads_s1_l14_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp5 -> SplitHeads_s1_l14_tp5;\n  SplitHeads_s1_l14_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp6 -> SplitHeads_s1_l14_tp6;\n  SplitHeads_s1_l14_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l14_tp7 -> SplitHeads_s1_l14_tp7;\n  A2A_s1_l14 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l14_tp0 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp1 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp2 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp3 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp4 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp5 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp6 -> A2A_s1_l14;\n  SplitHeads_s1_l14_tp7 -> A2A_s1_l14;\n  Attn_s1_l14_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp0;\n  Attn_s1_l14_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp1;\n  Attn_s1_l14_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp2;\n  Attn_s1_l14_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp3;\n  Attn_s1_l14_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp4;\n  Attn_s1_l14_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp5;\n  Attn_s1_l14_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp6;\n  Attn_s1_l14_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l14 -> Attn_s1_l14_tp7;\n  AR_attn_s1_l14 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l14_tp0 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp1 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp2 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp3 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp4 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp5 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp6 -> AR_attn_s1_l14;\n  Attn_s1_l14_tp7 -> AR_attn_s1_l14;\n  O_s1_l14_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp0;\n  O_s1_l14_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp1;\n  O_s1_l14_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp2;\n  O_s1_l14_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp3;\n  O_s1_l14_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp4;\n  O_s1_l14_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp5;\n  O_s1_l14_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp6;\n  O_s1_l14_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l14 -> O_s1_l14_tp7;\n  ResAttn_s1_l14_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp0 -> ResAttn_s1_l14_tp0;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp0;\n  ResAttn_s1_l14_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp1 -> ResAttn_s1_l14_tp1;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp1;\n  ResAttn_s1_l14_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp2 -> ResAttn_s1_l14_tp2;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp2;\n  ResAttn_s1_l14_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp3 -> ResAttn_s1_l14_tp3;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp3;\n  ResAttn_s1_l14_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp4 -> ResAttn_s1_l14_tp4;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp4;\n  ResAttn_s1_l14_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp5 -> ResAttn_s1_l14_tp5;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp5;\n  ResAttn_s1_l14_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp6 -> ResAttn_s1_l14_tp6;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp6;\n  ResAttn_s1_l14_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l14_tp7 -> ResAttn_s1_l14_tp7;\n  ResMOE_s1_l13_tp0 -> ResAttn_s1_l14_tp7;\n  Gate_s1_l14_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp0 -> Gate_s1_l14_tp0;\n  Gate_s1_l14_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp1 -> Gate_s1_l14_tp1;\n  Gate_s1_l14_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp2 -> Gate_s1_l14_tp2;\n  Gate_s1_l14_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp3 -> Gate_s1_l14_tp3;\n  Gate_s1_l14_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp4 -> Gate_s1_l14_tp4;\n  Gate_s1_l14_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp5 -> Gate_s1_l14_tp5;\n  Gate_s1_l14_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp6 -> Gate_s1_l14_tp6;\n  Gate_s1_l14_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l14_tp7 -> Gate_s1_l14_tp7;\n  Expert32_s1_l14_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp0 -> Expert32_s1_l14_tp0 [style=dashed];\n  Expert33_s1_l14_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp0 -> Expert33_s1_l14_tp0 [style=dashed];\n  Expert34_s1_l14_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp0 -> Expert34_s1_l14_tp0 [style=dashed];\n  Expert35_s1_l14_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp0 -> Expert35_s1_l14_tp0 [style=dashed];\n  Expert36_s1_l14_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp1 -> Expert36_s1_l14_tp1 [style=dashed];\n  Expert37_s1_l14_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp1 -> Expert37_s1_l14_tp1 [style=dashed];\n  Expert38_s1_l14_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp1 -> Expert38_s1_l14_tp1 [style=dashed];\n  Expert39_s1_l14_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp1 -> Expert39_s1_l14_tp1 [style=dashed];\n  Expert40_s1_l14_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp2 -> Expert40_s1_l14_tp2 [style=dashed];\n  Expert41_s1_l14_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp2 -> Expert41_s1_l14_tp2 [style=dashed];\n  Expert42_s1_l14_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp2 -> Expert42_s1_l14_tp2 [style=dashed];\n  Expert43_s1_l14_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp2 -> Expert43_s1_l14_tp2 [style=dashed];\n  Expert44_s1_l14_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp3 -> Expert44_s1_l14_tp3 [style=dashed];\n  Expert45_s1_l14_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp3 -> Expert45_s1_l14_tp3 [style=dashed];\n  Expert46_s1_l14_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp3 -> Expert46_s1_l14_tp3 [style=dashed];\n  Expert47_s1_l14_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp3 -> Expert47_s1_l14_tp3 [style=dashed];\n  Expert48_s1_l14_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp4 -> Expert48_s1_l14_tp4 [style=dashed];\n  Expert49_s1_l14_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp4 -> Expert49_s1_l14_tp4 [style=dashed];\n  Expert50_s1_l14_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp4 -> Expert50_s1_l14_tp4 [style=dashed];\n  Expert51_s1_l14_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp4 -> Expert51_s1_l14_tp4 [style=dashed];\n  Expert52_s1_l14_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp5 -> Expert52_s1_l14_tp5 [style=dashed];\n  Expert53_s1_l14_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp5 -> Expert53_s1_l14_tp5 [style=dashed];\n  Expert54_s1_l14_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp5 -> Expert54_s1_l14_tp5 [style=dashed];\n  Expert55_s1_l14_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp5 -> Expert55_s1_l14_tp5 [style=dashed];\n  Expert56_s1_l14_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp6 -> Expert56_s1_l14_tp6 [style=dashed];\n  Expert57_s1_l14_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp6 -> Expert57_s1_l14_tp6 [style=dashed];\n  Expert58_s1_l14_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp6 -> Expert58_s1_l14_tp6 [style=dashed];\n  Expert59_s1_l14_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp6 -> Expert59_s1_l14_tp6 [style=dashed];\n  Expert60_s1_l14_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp7 -> Expert60_s1_l14_tp7 [style=dashed];\n  Expert61_s1_l14_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp7 -> Expert61_s1_l14_tp7 [style=dashed];\n  Expert62_s1_l14_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp7 -> Expert62_s1_l14_tp7 [style=dashed];\n  Expert63_s1_l14_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l14_tp7 -> Expert63_s1_l14_tp7 [style=dashed];\n  AR_exp_s1_l14 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l14_tp0 -> AR_exp_s1_l14;\n  Expert33_s1_l14_tp0 -> AR_exp_s1_l14;\n  Expert34_s1_l14_tp0 -> AR_exp_s1_l14;\n  Expert35_s1_l14_tp0 -> AR_exp_s1_l14;\n  Expert36_s1_l14_tp1 -> AR_exp_s1_l14;\n  Expert37_s1_l14_tp1 -> AR_exp_s1_l14;\n  Expert38_s1_l14_tp1 -> AR_exp_s1_l14;\n  Expert39_s1_l14_tp1 -> AR_exp_s1_l14;\n  Expert40_s1_l14_tp2 -> AR_exp_s1_l14;\n  Expert41_s1_l14_tp2 -> AR_exp_s1_l14;\n  Expert42_s1_l14_tp2 -> AR_exp_s1_l14;\n  Expert43_s1_l14_tp2 -> AR_exp_s1_l14;\n  Expert44_s1_l14_tp3 -> AR_exp_s1_l14;\n  Expert45_s1_l14_tp3 -> AR_exp_s1_l14;\n  Expert46_s1_l14_tp3 -> AR_exp_s1_l14;\n  Expert47_s1_l14_tp3 -> AR_exp_s1_l14;\n  Expert48_s1_l14_tp4 -> AR_exp_s1_l14;\n  Expert49_s1_l14_tp4 -> AR_exp_s1_l14;\n  Expert50_s1_l14_tp4 -> AR_exp_s1_l14;\n  Expert51_s1_l14_tp4 -> AR_exp_s1_l14;\n  Expert52_s1_l14_tp5 -> AR_exp_s1_l14;\n  Expert53_s1_l14_tp5 -> AR_exp_s1_l14;\n  Expert54_s1_l14_tp5 -> AR_exp_s1_l14;\n  Expert55_s1_l14_tp5 -> AR_exp_s1_l14;\n  Expert56_s1_l14_tp6 -> AR_exp_s1_l14;\n  Expert57_s1_l14_tp6 -> AR_exp_s1_l14;\n  Expert58_s1_l14_tp6 -> AR_exp_s1_l14;\n  Expert59_s1_l14_tp6 -> AR_exp_s1_l14;\n  Expert60_s1_l14_tp7 -> AR_exp_s1_l14;\n  Expert61_s1_l14_tp7 -> AR_exp_s1_l14;\n  Expert62_s1_l14_tp7 -> AR_exp_s1_l14;\n  Expert63_s1_l14_tp7 -> AR_exp_s1_l14;\n  ResMOE_s1_l14_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp0;\n  ResAttn_s1_l14_tp0 -> ResMOE_s1_l14_tp0;\n  ResMOE_s1_l14_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp1;\n  ResAttn_s1_l14_tp1 -> ResMOE_s1_l14_tp1;\n  ResMOE_s1_l14_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp2;\n  ResAttn_s1_l14_tp2 -> ResMOE_s1_l14_tp2;\n  ResMOE_s1_l14_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp3;\n  ResAttn_s1_l14_tp3 -> ResMOE_s1_l14_tp3;\n  ResMOE_s1_l14_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp4;\n  ResAttn_s1_l14_tp4 -> ResMOE_s1_l14_tp4;\n  ResMOE_s1_l14_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp5;\n  ResAttn_s1_l14_tp5 -> ResMOE_s1_l14_tp5;\n  ResMOE_s1_l14_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp6;\n  ResAttn_s1_l14_tp6 -> ResMOE_s1_l14_tp6;\n  ResMOE_s1_l14_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l14 -> ResMOE_s1_l14_tp7;\n  ResAttn_s1_l14_tp7 -> ResMOE_s1_l14_tp7;\n  QKV_s1_l15_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp0;\n  QKV_s1_l15_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp1;\n  QKV_s1_l15_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp2;\n  QKV_s1_l15_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp3;\n  QKV_s1_l15_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp4;\n  QKV_s1_l15_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp5;\n  QKV_s1_l15_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp6;\n  QKV_s1_l15_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l14_tp0 -> QKV_s1_l15_tp7;\n  SplitHeads_s1_l15_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp0 -> SplitHeads_s1_l15_tp0;\n  SplitHeads_s1_l15_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp1 -> SplitHeads_s1_l15_tp1;\n  SplitHeads_s1_l15_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp2 -> SplitHeads_s1_l15_tp2;\n  SplitHeads_s1_l15_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp3 -> SplitHeads_s1_l15_tp3;\n  SplitHeads_s1_l15_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp4 -> SplitHeads_s1_l15_tp4;\n  SplitHeads_s1_l15_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp5 -> SplitHeads_s1_l15_tp5;\n  SplitHeads_s1_l15_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp6 -> SplitHeads_s1_l15_tp6;\n  SplitHeads_s1_l15_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l15_tp7 -> SplitHeads_s1_l15_tp7;\n  A2A_s1_l15 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l15_tp0 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp1 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp2 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp3 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp4 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp5 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp6 -> A2A_s1_l15;\n  SplitHeads_s1_l15_tp7 -> A2A_s1_l15;\n  Attn_s1_l15_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp0;\n  Attn_s1_l15_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp1;\n  Attn_s1_l15_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp2;\n  Attn_s1_l15_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp3;\n  Attn_s1_l15_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp4;\n  Attn_s1_l15_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp5;\n  Attn_s1_l15_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp6;\n  Attn_s1_l15_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l15 -> Attn_s1_l15_tp7;\n  AR_attn_s1_l15 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l15_tp0 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp1 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp2 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp3 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp4 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp5 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp6 -> AR_attn_s1_l15;\n  Attn_s1_l15_tp7 -> AR_attn_s1_l15;\n  O_s1_l15_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp0;\n  O_s1_l15_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp1;\n  O_s1_l15_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp2;\n  O_s1_l15_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp3;\n  O_s1_l15_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp4;\n  O_s1_l15_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp5;\n  O_s1_l15_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp6;\n  O_s1_l15_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l15 -> O_s1_l15_tp7;\n  ResAttn_s1_l15_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp0 -> ResAttn_s1_l15_tp0;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp0;\n  ResAttn_s1_l15_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp1 -> ResAttn_s1_l15_tp1;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp1;\n  ResAttn_s1_l15_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp2 -> ResAttn_s1_l15_tp2;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp2;\n  ResAttn_s1_l15_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp3 -> ResAttn_s1_l15_tp3;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp3;\n  ResAttn_s1_l15_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp4 -> ResAttn_s1_l15_tp4;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp4;\n  ResAttn_s1_l15_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp5 -> ResAttn_s1_l15_tp5;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp5;\n  ResAttn_s1_l15_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp6 -> ResAttn_s1_l15_tp6;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp6;\n  ResAttn_s1_l15_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l15_tp7 -> ResAttn_s1_l15_tp7;\n  ResMOE_s1_l14_tp0 -> ResAttn_s1_l15_tp7;\n  Gate_s1_l15_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp0 -> Gate_s1_l15_tp0;\n  Gate_s1_l15_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp1 -> Gate_s1_l15_tp1;\n  Gate_s1_l15_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp2 -> Gate_s1_l15_tp2;\n  Gate_s1_l15_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp3 -> Gate_s1_l15_tp3;\n  Gate_s1_l15_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp4 -> Gate_s1_l15_tp4;\n  Gate_s1_l15_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp5 -> Gate_s1_l15_tp5;\n  Gate_s1_l15_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp6 -> Gate_s1_l15_tp6;\n  Gate_s1_l15_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l15_tp7 -> Gate_s1_l15_tp7;\n  Expert32_s1_l15_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp0 -> Expert32_s1_l15_tp0 [style=dashed];\n  Expert33_s1_l15_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp0 -> Expert33_s1_l15_tp0 [style=dashed];\n  Expert34_s1_l15_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp0 -> Expert34_s1_l15_tp0 [style=dashed];\n  Expert35_s1_l15_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp0 -> Expert35_s1_l15_tp0 [style=dashed];\n  Expert36_s1_l15_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp1 -> Expert36_s1_l15_tp1 [style=dashed];\n  Expert37_s1_l15_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp1 -> Expert37_s1_l15_tp1 [style=dashed];\n  Expert38_s1_l15_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp1 -> Expert38_s1_l15_tp1 [style=dashed];\n  Expert39_s1_l15_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp1 -> Expert39_s1_l15_tp1 [style=dashed];\n  Expert40_s1_l15_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp2 -> Expert40_s1_l15_tp2 [style=dashed];\n  Expert41_s1_l15_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp2 -> Expert41_s1_l15_tp2 [style=dashed];\n  Expert42_s1_l15_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp2 -> Expert42_s1_l15_tp2 [style=dashed];\n  Expert43_s1_l15_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp2 -> Expert43_s1_l15_tp2 [style=dashed];\n  Expert44_s1_l15_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp3 -> Expert44_s1_l15_tp3 [style=dashed];\n  Expert45_s1_l15_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp3 -> Expert45_s1_l15_tp3 [style=dashed];\n  Expert46_s1_l15_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp3 -> Expert46_s1_l15_tp3 [style=dashed];\n  Expert47_s1_l15_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp3 -> Expert47_s1_l15_tp3 [style=dashed];\n  Expert48_s1_l15_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp4 -> Expert48_s1_l15_tp4 [style=dashed];\n  Expert49_s1_l15_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp4 -> Expert49_s1_l15_tp4 [style=dashed];\n  Expert50_s1_l15_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp4 -> Expert50_s1_l15_tp4 [style=dashed];\n  Expert51_s1_l15_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp4 -> Expert51_s1_l15_tp4 [style=dashed];\n  Expert52_s1_l15_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp5 -> Expert52_s1_l15_tp5 [style=dashed];\n  Expert53_s1_l15_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp5 -> Expert53_s1_l15_tp5 [style=dashed];\n  Expert54_s1_l15_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp5 -> Expert54_s1_l15_tp5 [style=dashed];\n  Expert55_s1_l15_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp5 -> Expert55_s1_l15_tp5 [style=dashed];\n  Expert56_s1_l15_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp6 -> Expert56_s1_l15_tp6 [style=dashed];\n  Expert57_s1_l15_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp6 -> Expert57_s1_l15_tp6 [style=dashed];\n  Expert58_s1_l15_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp6 -> Expert58_s1_l15_tp6 [style=dashed];\n  Expert59_s1_l15_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp6 -> Expert59_s1_l15_tp6 [style=dashed];\n  Expert60_s1_l15_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp7 -> Expert60_s1_l15_tp7 [style=dashed];\n  Expert61_s1_l15_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp7 -> Expert61_s1_l15_tp7 [style=dashed];\n  Expert62_s1_l15_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp7 -> Expert62_s1_l15_tp7 [style=dashed];\n  Expert63_s1_l15_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l15_tp7 -> Expert63_s1_l15_tp7 [style=dashed];\n  AR_exp_s1_l15 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l15_tp0 -> AR_exp_s1_l15;\n  Expert33_s1_l15_tp0 -> AR_exp_s1_l15;\n  Expert34_s1_l15_tp0 -> AR_exp_s1_l15;\n  Expert35_s1_l15_tp0 -> AR_exp_s1_l15;\n  Expert36_s1_l15_tp1 -> AR_exp_s1_l15;\n  Expert37_s1_l15_tp1 -> AR_exp_s1_l15;\n  Expert38_s1_l15_tp1 -> AR_exp_s1_l15;\n  Expert39_s1_l15_tp1 -> AR_exp_s1_l15;\n  Expert40_s1_l15_tp2 -> AR_exp_s1_l15;\n  Expert41_s1_l15_tp2 -> AR_exp_s1_l15;\n  Expert42_s1_l15_tp2 -> AR_exp_s1_l15;\n  Expert43_s1_l15_tp2 -> AR_exp_s1_l15;\n  Expert44_s1_l15_tp3 -> AR_exp_s1_l15;\n  Expert45_s1_l15_tp3 -> AR_exp_s1_l15;\n  Expert46_s1_l15_tp3 -> AR_exp_s1_l15;\n  Expert47_s1_l15_tp3 -> AR_exp_s1_l15;\n  Expert48_s1_l15_tp4 -> AR_exp_s1_l15;\n  Expert49_s1_l15_tp4 -> AR_exp_s1_l15;\n  Expert50_s1_l15_tp4 -> AR_exp_s1_l15;\n  Expert51_s1_l15_tp4 -> AR_exp_s1_l15;\n  Expert52_s1_l15_tp5 -> AR_exp_s1_l15;\n  Expert53_s1_l15_tp5 -> AR_exp_s1_l15;\n  Expert54_s1_l15_tp5 -> AR_exp_s1_l15;\n  Expert55_s1_l15_tp5 -> AR_exp_s1_l15;\n  Expert56_s1_l15_tp6 -> AR_exp_s1_l15;\n  Expert57_s1_l15_tp6 -> AR_exp_s1_l15;\n  Expert58_s1_l15_tp6 -> AR_exp_s1_l15;\n  Expert59_s1_l15_tp6 -> AR_exp_s1_l15;\n  Expert60_s1_l15_tp7 -> AR_exp_s1_l15;\n  Expert61_s1_l15_tp7 -> AR_exp_s1_l15;\n  Expert62_s1_l15_tp7 -> AR_exp_s1_l15;\n  Expert63_s1_l15_tp7 -> AR_exp_s1_l15;\n  ResMOE_s1_l15_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp0;\n  ResAttn_s1_l15_tp0 -> ResMOE_s1_l15_tp0;\n  ResMOE_s1_l15_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp1;\n  ResAttn_s1_l15_tp1 -> ResMOE_s1_l15_tp1;\n  ResMOE_s1_l15_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp2;\n  ResAttn_s1_l15_tp2 -> ResMOE_s1_l15_tp2;\n  ResMOE_s1_l15_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp3;\n  ResAttn_s1_l15_tp3 -> ResMOE_s1_l15_tp3;\n  ResMOE_s1_l15_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp4;\n  ResAttn_s1_l15_tp4 -> ResMOE_s1_l15_tp4;\n  ResMOE_s1_l15_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp5;\n  ResAttn_s1_l15_tp5 -> ResMOE_s1_l15_tp5;\n  ResMOE_s1_l15_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp6;\n  ResAttn_s1_l15_tp6 -> ResMOE_s1_l15_tp6;\n  ResMOE_s1_l15_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l15 -> ResMOE_s1_l15_tp7;\n  ResAttn_s1_l15_tp7 -> ResMOE_s1_l15_tp7;\n  QKV_s1_l16_tp0 [label="QKV_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp0;\n  QKV_s1_l16_tp1 [label="QKV_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp1;\n  QKV_s1_l16_tp2 [label="QKV_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp2;\n  QKV_s1_l16_tp3 [label="QKV_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp3;\n  QKV_s1_l16_tp4 [label="QKV_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp4;\n  QKV_s1_l16_tp5 [label="QKV_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp5;\n  QKV_s1_l16_tp6 [label="QKV_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp6;\n  QKV_s1_l16_tp7 [label="QKV_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l15_tp0 -> QKV_s1_l16_tp7;\n  SplitHeads_s1_l16_tp0 [label="SplitHeads\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp0 -> SplitHeads_s1_l16_tp0;\n  SplitHeads_s1_l16_tp1 [label="SplitHeads\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp1 -> SplitHeads_s1_l16_tp1;\n  SplitHeads_s1_l16_tp2 [label="SplitHeads\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp2 -> SplitHeads_s1_l16_tp2;\n  SplitHeads_s1_l16_tp3 [label="SplitHeads\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp3 -> SplitHeads_s1_l16_tp3;\n  SplitHeads_s1_l16_tp4 [label="SplitHeads\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp4 -> SplitHeads_s1_l16_tp4;\n  SplitHeads_s1_l16_tp5 [label="SplitHeads\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp5 -> SplitHeads_s1_l16_tp5;\n  SplitHeads_s1_l16_tp6 [label="SplitHeads\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp6 -> SplitHeads_s1_l16_tp6;\n  SplitHeads_s1_l16_tp7 [label="SplitHeads\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  QKV_s1_l16_tp7 -> SplitHeads_s1_l16_tp7;\n  A2A_s1_l16 [shape=ellipse, label="AllToAll\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  SplitHeads_s1_l16_tp0 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp1 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp2 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp3 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp4 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp5 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp6 -> A2A_s1_l16;\n  SplitHeads_s1_l16_tp7 -> A2A_s1_l16;\n  Attn_s1_l16_tp0 [label="Attention\nGPU8\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp0;\n  Attn_s1_l16_tp1 [label="Attention\nGPU9\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp1;\n  Attn_s1_l16_tp2 [label="Attention\nGPU10\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp2;\n  Attn_s1_l16_tp3 [label="Attention\nGPU11\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp3;\n  Attn_s1_l16_tp4 [label="Attention\nGPU12\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp4;\n  Attn_s1_l16_tp5 [label="Attention\nGPU13\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp5;\n  Attn_s1_l16_tp6 [label="Attention\nGPU14\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp6;\n  Attn_s1_l16_tp7 [label="Attention\nGPU15\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  A2A_s1_l16 -> Attn_s1_l16_tp7;\n  AR_attn_s1_l16 [shape=ellipse, label="AllReduce\nstage1\n[batch_size=128,seq_len=128,heads=16,d_k=64]"];\n  Attn_s1_l16_tp0 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp1 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp2 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp3 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp4 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp5 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp6 -> AR_attn_s1_l16;\n  Attn_s1_l16_tp7 -> AR_attn_s1_l16;\n  O_s1_l16_tp0 [label="O_linear\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp0;\n  O_s1_l16_tp1 [label="O_linear\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp1;\n  O_s1_l16_tp2 [label="O_linear\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp2;\n  O_s1_l16_tp3 [label="O_linear\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp3;\n  O_s1_l16_tp4 [label="O_linear\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp4;\n  O_s1_l16_tp5 [label="O_linear\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp5;\n  O_s1_l16_tp6 [label="O_linear\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp6;\n  O_s1_l16_tp7 [label="O_linear\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_attn_s1_l16 -> O_s1_l16_tp7;\n  ResAttn_s1_l16_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp0 -> ResAttn_s1_l16_tp0;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp0;\n  ResAttn_s1_l16_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp1 -> ResAttn_s1_l16_tp1;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp1;\n  ResAttn_s1_l16_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp2 -> ResAttn_s1_l16_tp2;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp2;\n  ResAttn_s1_l16_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp3 -> ResAttn_s1_l16_tp3;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp3;\n  ResAttn_s1_l16_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp4 -> ResAttn_s1_l16_tp4;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp4;\n  ResAttn_s1_l16_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp5 -> ResAttn_s1_l16_tp5;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp5;\n  ResAttn_s1_l16_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp6 -> ResAttn_s1_l16_tp6;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp6;\n  ResAttn_s1_l16_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  O_s1_l16_tp7 -> ResAttn_s1_l16_tp7;\n  ResMOE_s1_l15_tp0 -> ResAttn_s1_l16_tp7;\n  Gate_s1_l16_tp0 [label="Gate\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp0 -> Gate_s1_l16_tp0;\n  Gate_s1_l16_tp1 [label="Gate\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp1 -> Gate_s1_l16_tp1;\n  Gate_s1_l16_tp2 [label="Gate\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp2 -> Gate_s1_l16_tp2;\n  Gate_s1_l16_tp3 [label="Gate\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp3 -> Gate_s1_l16_tp3;\n  Gate_s1_l16_tp4 [label="Gate\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp4 -> Gate_s1_l16_tp4;\n  Gate_s1_l16_tp5 [label="Gate\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp5 -> Gate_s1_l16_tp5;\n  Gate_s1_l16_tp6 [label="Gate\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp6 -> Gate_s1_l16_tp6;\n  Gate_s1_l16_tp7 [label="Gate\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResAttn_s1_l16_tp7 -> Gate_s1_l16_tp7;\n  Expert32_s1_l16_tp0 [label="Expert32\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp0 -> Expert32_s1_l16_tp0 [style=dashed];\n  Expert33_s1_l16_tp0 [label="Expert33\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp0 -> Expert33_s1_l16_tp0 [style=dashed];\n  Expert34_s1_l16_tp0 [label="Expert34\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp0 -> Expert34_s1_l16_tp0 [style=dashed];\n  Expert35_s1_l16_tp0 [label="Expert35\nGPU8\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp0 -> Expert35_s1_l16_tp0 [style=dashed];\n  Expert36_s1_l16_tp1 [label="Expert36\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp1 -> Expert36_s1_l16_tp1 [style=dashed];\n  Expert37_s1_l16_tp1 [label="Expert37\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp1 -> Expert37_s1_l16_tp1 [style=dashed];\n  Expert38_s1_l16_tp1 [label="Expert38\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp1 -> Expert38_s1_l16_tp1 [style=dashed];\n  Expert39_s1_l16_tp1 [label="Expert39\nGPU9\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp1 -> Expert39_s1_l16_tp1 [style=dashed];\n  Expert40_s1_l16_tp2 [label="Expert40\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp2 -> Expert40_s1_l16_tp2 [style=dashed];\n  Expert41_s1_l16_tp2 [label="Expert41\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp2 -> Expert41_s1_l16_tp2 [style=dashed];\n  Expert42_s1_l16_tp2 [label="Expert42\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp2 -> Expert42_s1_l16_tp2 [style=dashed];\n  Expert43_s1_l16_tp2 [label="Expert43\nGPU10\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp2 -> Expert43_s1_l16_tp2 [style=dashed];\n  Expert44_s1_l16_tp3 [label="Expert44\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp3 -> Expert44_s1_l16_tp3 [style=dashed];\n  Expert45_s1_l16_tp3 [label="Expert45\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp3 -> Expert45_s1_l16_tp3 [style=dashed];\n  Expert46_s1_l16_tp3 [label="Expert46\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp3 -> Expert46_s1_l16_tp3 [style=dashed];\n  Expert47_s1_l16_tp3 [label="Expert47\nGPU11\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp3 -> Expert47_s1_l16_tp3 [style=dashed];\n  Expert48_s1_l16_tp4 [label="Expert48\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp4 -> Expert48_s1_l16_tp4 [style=dashed];\n  Expert49_s1_l16_tp4 [label="Expert49\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp4 -> Expert49_s1_l16_tp4 [style=dashed];\n  Expert50_s1_l16_tp4 [label="Expert50\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp4 -> Expert50_s1_l16_tp4 [style=dashed];\n  Expert51_s1_l16_tp4 [label="Expert51\nGPU12\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp4 -> Expert51_s1_l16_tp4 [style=dashed];\n  Expert52_s1_l16_tp5 [label="Expert52\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp5 -> Expert52_s1_l16_tp5 [style=dashed];\n  Expert53_s1_l16_tp5 [label="Expert53\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp5 -> Expert53_s1_l16_tp5 [style=dashed];\n  Expert54_s1_l16_tp5 [label="Expert54\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp5 -> Expert54_s1_l16_tp5 [style=dashed];\n  Expert55_s1_l16_tp5 [label="Expert55\nGPU13\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp5 -> Expert55_s1_l16_tp5 [style=dashed];\n  Expert56_s1_l16_tp6 [label="Expert56\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp6 -> Expert56_s1_l16_tp6 [style=dashed];\n  Expert57_s1_l16_tp6 [label="Expert57\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp6 -> Expert57_s1_l16_tp6 [style=dashed];\n  Expert58_s1_l16_tp6 [label="Expert58\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp6 -> Expert58_s1_l16_tp6 [style=dashed];\n  Expert59_s1_l16_tp6 [label="Expert59\nGPU14\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp6 -> Expert59_s1_l16_tp6 [style=dashed];\n  Expert60_s1_l16_tp7 [label="Expert60\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp7 -> Expert60_s1_l16_tp7 [style=dashed];\n  Expert61_s1_l16_tp7 [label="Expert61\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp7 -> Expert61_s1_l16_tp7 [style=dashed];\n  Expert62_s1_l16_tp7 [label="Expert62\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp7 -> Expert62_s1_l16_tp7 [style=dashed];\n  Expert63_s1_l16_tp7 [label="Expert63\nGPU15\n[batch_size=128,seq_len=128,ffn=2048]"];\n  Gate_s1_l16_tp7 -> Expert63_s1_l16_tp7 [style=dashed];\n  AR_exp_s1_l16 [shape=ellipse, label="AllReduceExperts\nstage1\n[batch_size=128,seq_len=128,hidden=1024]"];\n  Expert32_s1_l16_tp0 -> AR_exp_s1_l16;\n  Expert33_s1_l16_tp0 -> AR_exp_s1_l16;\n  Expert34_s1_l16_tp0 -> AR_exp_s1_l16;\n  Expert35_s1_l16_tp0 -> AR_exp_s1_l16;\n  Expert36_s1_l16_tp1 -> AR_exp_s1_l16;\n  Expert37_s1_l16_tp1 -> AR_exp_s1_l16;\n  Expert38_s1_l16_tp1 -> AR_exp_s1_l16;\n  Expert39_s1_l16_tp1 -> AR_exp_s1_l16;\n  Expert40_s1_l16_tp2 -> AR_exp_s1_l16;\n  Expert41_s1_l16_tp2 -> AR_exp_s1_l16;\n  Expert42_s1_l16_tp2 -> AR_exp_s1_l16;\n  Expert43_s1_l16_tp2 -> AR_exp_s1_l16;\n  Expert44_s1_l16_tp3 -> AR_exp_s1_l16;\n  Expert45_s1_l16_tp3 -> AR_exp_s1_l16;\n  Expert46_s1_l16_tp3 -> AR_exp_s1_l16;\n  Expert47_s1_l16_tp3 -> AR_exp_s1_l16;\n  Expert48_s1_l16_tp4 -> AR_exp_s1_l16;\n  Expert49_s1_l16_tp4 -> AR_exp_s1_l16;\n  Expert50_s1_l16_tp4 -> AR_exp_s1_l16;\n  Expert51_s1_l16_tp4 -> AR_exp_s1_l16;\n  Expert52_s1_l16_tp5 -> AR_exp_s1_l16;\n  Expert53_s1_l16_tp5 -> AR_exp_s1_l16;\n  Expert54_s1_l16_tp5 -> AR_exp_s1_l16;\n  Expert55_s1_l16_tp5 -> AR_exp_s1_l16;\n  Expert56_s1_l16_tp6 -> AR_exp_s1_l16;\n  Expert57_s1_l16_tp6 -> AR_exp_s1_l16;\n  Expert58_s1_l16_tp6 -> AR_exp_s1_l16;\n  Expert59_s1_l16_tp6 -> AR_exp_s1_l16;\n  Expert60_s1_l16_tp7 -> AR_exp_s1_l16;\n  Expert61_s1_l16_tp7 -> AR_exp_s1_l16;\n  Expert62_s1_l16_tp7 -> AR_exp_s1_l16;\n  Expert63_s1_l16_tp7 -> AR_exp_s1_l16;\n  ResMOE_s1_l16_tp0 [shape=parallelogram, label="ResAdd\nGPU8\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp0;\n  ResAttn_s1_l16_tp0 -> ResMOE_s1_l16_tp0;\n  ResMOE_s1_l16_tp1 [shape=parallelogram, label="ResAdd\nGPU9\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp1;\n  ResAttn_s1_l16_tp1 -> ResMOE_s1_l16_tp1;\n  ResMOE_s1_l16_tp2 [shape=parallelogram, label="ResAdd\nGPU10\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp2;\n  ResAttn_s1_l16_tp2 -> ResMOE_s1_l16_tp2;\n  ResMOE_s1_l16_tp3 [shape=parallelogram, label="ResAdd\nGPU11\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp3;\n  ResAttn_s1_l16_tp3 -> ResMOE_s1_l16_tp3;\n  ResMOE_s1_l16_tp4 [shape=parallelogram, label="ResAdd\nGPU12\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp4;\n  ResAttn_s1_l16_tp4 -> ResMOE_s1_l16_tp4;\n  ResMOE_s1_l16_tp5 [shape=parallelogram, label="ResAdd\nGPU13\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp5;\n  ResAttn_s1_l16_tp5 -> ResMOE_s1_l16_tp5;\n  ResMOE_s1_l16_tp6 [shape=parallelogram, label="ResAdd\nGPU14\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp6;\n  ResAttn_s1_l16_tp6 -> ResMOE_s1_l16_tp6;\n  ResMOE_s1_l16_tp7 [shape=parallelogram, label="ResAdd\nGPU15\n[batch_size=128,seq_len=128,hidden=1024]"];\n  AR_exp_s1_l16 -> ResMOE_s1_l16_tp7;\n  ResAttn_s1_l16_tp7 -> ResMOE_s1_l16_tp7;\n  Output [shape=ellipse, label="Output\n[batch_size=128,seq_len=128,hidden=1024]"];\n  ResMOE_s1_l16_tp0 -> Output;\n}