<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_ep16 Pages: 1 -->
<svg width="6251pt" height="1456pt"
 viewBox="0.00 0.00 6250.89 1455.81" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1451.81)">
<title>proposed_ep16</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1451.81 6246.89,-1451.81 6246.89,4 -4,4"/>
<!-- INPUT -->
<g id="node1" class="node">
<title>INPUT</title>
<polygon fill="none" stroke="black" points="3469.5,-1447.81 3125.5,-1447.81 3125.5,-1379.81 3469.5,-1379.81 3469.5,-1447.81"/>
<text text-anchor="middle" x="3297.5" y="-1432.61" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="3297.5" y="-1417.61" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="3297.5" y="-1402.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3297.5" y="-1387.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- gpu0_mha_qkv -->
<g id="node2" class="node">
<title>gpu0_mha_qkv</title>
<polygon fill="none" stroke="black" points="371,-1343.81 0,-1343.81 0,-1275.81 371,-1275.81 371,-1343.81"/>
<text text-anchor="middle" x="185.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu0_mha_qkv</text>
<text text-anchor="middle" x="185.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="185.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="185.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu0_mha_qkv -->
<g id="edge1" class="edge">
<title>INPUT&#45;&gt;gpu0_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.08,-1412.02C2586.26,-1409.01 937.45,-1395.79 381.15,-1343.91"/>
<polygon fill="black" stroke="black" points="381.31,-1340.41 371.03,-1342.95 380.65,-1347.38 381.31,-1340.41"/>
</g>
<!-- gpu1_mha_qkv -->
<g id="node3" class="node">
<title>gpu1_mha_qkv</title>
<polygon fill="none" stroke="black" points="760,-1343.81 389,-1343.81 389,-1275.81 760,-1275.81 760,-1343.81"/>
<text text-anchor="middle" x="574.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu1_mha_qkv</text>
<text text-anchor="middle" x="574.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="574.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu1_mha_qkv -->
<g id="edge2" class="edge">
<title>INPUT&#45;&gt;gpu1_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.46,-1411.29C2637.05,-1406.46 1247.07,-1389.11 770.09,-1343.91"/>
<polygon fill="black" stroke="black" points="770.32,-1340.42 760.03,-1342.94 769.64,-1347.38 770.32,-1340.42"/>
</g>
<!-- gpu2_mha_qkv -->
<g id="node4" class="node">
<title>gpu2_mha_qkv</title>
<polygon fill="none" stroke="black" points="1149,-1343.81 778,-1343.81 778,-1275.81 1149,-1275.81 1149,-1343.81"/>
<text text-anchor="middle" x="963.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu2_mha_qkv</text>
<text text-anchor="middle" x="963.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="963.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="963.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu2_mha_qkv -->
<g id="edge3" class="edge">
<title>INPUT&#45;&gt;gpu2_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.29,-1410.29C2690.85,-1403.45 1557.23,-1382.46 1159.16,-1343.92"/>
<polygon fill="black" stroke="black" points="1159.32,-1340.42 1149.03,-1342.92 1158.64,-1347.39 1159.32,-1340.42"/>
</g>
<!-- gpu3_mha_qkv -->
<g id="node5" class="node">
<title>gpu3_mha_qkv</title>
<polygon fill="none" stroke="black" points="1538,-1343.81 1167,-1343.81 1167,-1275.81 1538,-1275.81 1538,-1343.81"/>
<text text-anchor="middle" x="1352.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu3_mha_qkv</text>
<text text-anchor="middle" x="1352.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1352.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1352.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu3_mha_qkv -->
<g id="edge4" class="edge">
<title>INPUT&#45;&gt;gpu3_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.48,-1413.38C2812.92,-1412.79 2130.98,-1404.05 1548.32,-1343.96"/>
<polygon fill="black" stroke="black" points="1548.34,-1340.44 1538.03,-1342.89 1547.62,-1347.4 1548.34,-1340.44"/>
</g>
<!-- gpu4_mha_qkv -->
<g id="node6" class="node">
<title>gpu4_mha_qkv</title>
<polygon fill="none" stroke="black" points="1927,-1343.81 1556,-1343.81 1556,-1275.81 1927,-1275.81 1927,-1343.81"/>
<text text-anchor="middle" x="1741.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu4_mha_qkv</text>
<text text-anchor="middle" x="1741.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1741.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1741.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu4_mha_qkv -->
<g id="edge5" class="edge">
<title>INPUT&#45;&gt;gpu4_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.24,-1410.59C2868.32,-1405.81 2369.49,-1390.92 1937.23,-1343.96"/>
<polygon fill="black" stroke="black" points="1937.36,-1340.45 1927.04,-1342.85 1936.6,-1347.41 1937.36,-1340.45"/>
</g>
<!-- gpu5_mha_qkv -->
<g id="node7" class="node">
<title>gpu5_mha_qkv</title>
<polygon fill="none" stroke="black" points="2316,-1343.81 1945,-1343.81 1945,-1275.81 2316,-1275.81 2316,-1343.81"/>
<text text-anchor="middle" x="2130.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu5_mha_qkv</text>
<text text-anchor="middle" x="2130.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="2130.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2130.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu5_mha_qkv -->
<g id="edge6" class="edge">
<title>INPUT&#45;&gt;gpu5_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.21,-1405.69C2932.64,-1396.56 2611.45,-1377.84 2326.18,-1343.98"/>
<polygon fill="black" stroke="black" points="2326.39,-1340.48 2316.05,-1342.77 2325.56,-1347.43 2326.39,-1340.48"/>
</g>
<!-- gpu6_mha_qkv -->
<g id="node8" class="node">
<title>gpu6_mha_qkv</title>
<polygon fill="none" stroke="black" points="2705,-1343.81 2334,-1343.81 2334,-1275.81 2705,-1275.81 2705,-1343.81"/>
<text text-anchor="middle" x="2519.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu6_mha_qkv</text>
<text text-anchor="middle" x="2519.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2519.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2519.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu6_mha_qkv -->
<g id="edge7" class="edge">
<title>INPUT&#45;&gt;gpu6_mha_qkv</title>
<path fill="none" stroke="black" d="M3125.35,-1394.8C3011.61,-1382.34 2859.03,-1364.57 2715.4,-1344.06"/>
<polygon fill="black" stroke="black" points="2715.47,-1340.54 2705.07,-1342.58 2714.47,-1347.47 2715.47,-1340.54"/>
</g>
<!-- gpu7_mha_qkv -->
<g id="node9" class="node">
<title>gpu7_mha_qkv</title>
<polygon fill="none" stroke="black" points="3094,-1343.81 2723,-1343.81 2723,-1275.81 3094,-1275.81 3094,-1343.81"/>
<text text-anchor="middle" x="2908.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu7_mha_qkv</text>
<text text-anchor="middle" x="2908.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2908.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2908.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu7_mha_qkv -->
<g id="edge8" class="edge">
<title>INPUT&#45;&gt;gpu7_mha_qkv</title>
<path fill="none" stroke="black" d="M3171.47,-1379.77C3130.9,-1369.13 3085.76,-1357.29 3044.51,-1346.48"/>
<polygon fill="black" stroke="black" points="3045.22,-1343.04 3034.66,-1343.89 3043.45,-1349.82 3045.22,-1343.04"/>
</g>
<!-- gpu8_mha_qkv -->
<g id="node10" class="node">
<title>gpu8_mha_qkv</title>
<polygon fill="none" stroke="black" points="3483,-1343.81 3112,-1343.81 3112,-1275.81 3483,-1275.81 3483,-1343.81"/>
<text text-anchor="middle" x="3297.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu8_mha_qkv</text>
<text text-anchor="middle" x="3297.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3297.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3297.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu8_mha_qkv -->
<g id="edge9" class="edge">
<title>INPUT&#45;&gt;gpu8_mha_qkv</title>
<path fill="none" stroke="black" d="M3297.5,-1379.7C3297.5,-1371.59 3297.5,-1362.8 3297.5,-1354.29"/>
<polygon fill="black" stroke="black" points="3301,-1354.11 3297.5,-1344.11 3294,-1354.11 3301,-1354.11"/>
</g>
<!-- gpu9_mha_qkv -->
<g id="node11" class="node">
<title>gpu9_mha_qkv</title>
<polygon fill="none" stroke="black" points="3872,-1343.81 3501,-1343.81 3501,-1275.81 3872,-1275.81 3872,-1343.81"/>
<text text-anchor="middle" x="3686.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu9_mha_qkv</text>
<text text-anchor="middle" x="3686.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3686.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3686.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu9_mha_qkv -->
<g id="edge10" class="edge">
<title>INPUT&#45;&gt;gpu9_mha_qkv</title>
<path fill="none" stroke="black" d="M3423.53,-1379.77C3464.1,-1369.13 3509.24,-1357.29 3550.49,-1346.48"/>
<polygon fill="black" stroke="black" points="3551.55,-1349.82 3560.34,-1343.89 3549.78,-1343.04 3551.55,-1349.82"/>
</g>
<!-- gpu10_mha_qkv -->
<g id="node12" class="node">
<title>gpu10_mha_qkv</title>
<polygon fill="none" stroke="black" points="4261,-1343.81 3890,-1343.81 3890,-1275.81 4261,-1275.81 4261,-1343.81"/>
<text text-anchor="middle" x="4075.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu10_mha_qkv</text>
<text text-anchor="middle" x="4075.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4075.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4075.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu10_mha_qkv -->
<g id="edge11" class="edge">
<title>INPUT&#45;&gt;gpu10_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.65,-1394.8C3583.39,-1382.34 3735.97,-1364.57 3879.6,-1344.06"/>
<polygon fill="black" stroke="black" points="3880.53,-1347.47 3889.93,-1342.58 3879.53,-1340.54 3880.53,-1347.47"/>
</g>
<!-- gpu11_mha_qkv -->
<g id="node13" class="node">
<title>gpu11_mha_qkv</title>
<polygon fill="none" stroke="black" points="4650,-1343.81 4279,-1343.81 4279,-1275.81 4650,-1275.81 4650,-1343.81"/>
<text text-anchor="middle" x="4464.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu11_mha_qkv</text>
<text text-anchor="middle" x="4464.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4464.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4464.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu11_mha_qkv -->
<g id="edge12" class="edge">
<title>INPUT&#45;&gt;gpu11_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.79,-1405.69C3662.36,-1396.56 3983.55,-1377.84 4268.82,-1343.98"/>
<polygon fill="black" stroke="black" points="4269.44,-1347.43 4278.95,-1342.77 4268.61,-1340.48 4269.44,-1347.43"/>
</g>
<!-- gpu12_mha_qkv -->
<g id="node14" class="node">
<title>gpu12_mha_qkv</title>
<polygon fill="none" stroke="black" points="5039,-1343.81 4668,-1343.81 4668,-1275.81 5039,-1275.81 5039,-1343.81"/>
<text text-anchor="middle" x="4853.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu12_mha_qkv</text>
<text text-anchor="middle" x="4853.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="4853.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4853.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu12_mha_qkv -->
<g id="edge13" class="edge">
<title>INPUT&#45;&gt;gpu12_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.76,-1410.59C3726.68,-1405.81 4225.51,-1390.92 4657.77,-1343.96"/>
<polygon fill="black" stroke="black" points="4658.4,-1347.41 4667.96,-1342.85 4657.64,-1340.45 4658.4,-1347.41"/>
</g>
<!-- gpu13_mha_qkv -->
<g id="node15" class="node">
<title>gpu13_mha_qkv</title>
<polygon fill="none" stroke="black" points="5428,-1343.81 5057,-1343.81 5057,-1275.81 5428,-1275.81 5428,-1343.81"/>
<text text-anchor="middle" x="5242.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu13_mha_qkv</text>
<text text-anchor="middle" x="5242.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="5242.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5242.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu13_mha_qkv -->
<g id="edge14" class="edge">
<title>INPUT&#45;&gt;gpu13_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.52,-1413.38C3782.08,-1412.79 4464.02,-1404.05 5046.68,-1343.96"/>
<polygon fill="black" stroke="black" points="5047.38,-1347.4 5056.97,-1342.89 5046.66,-1340.44 5047.38,-1347.4"/>
</g>
<!-- gpu14_mha_qkv -->
<g id="node16" class="node">
<title>gpu14_mha_qkv</title>
<polygon fill="none" stroke="black" points="5817,-1343.81 5446,-1343.81 5446,-1275.81 5817,-1275.81 5817,-1343.81"/>
<text text-anchor="middle" x="5631.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu14_mha_qkv</text>
<text text-anchor="middle" x="5631.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="5631.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5631.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu14_mha_qkv -->
<g id="edge15" class="edge">
<title>INPUT&#45;&gt;gpu14_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.71,-1410.29C3904.15,-1403.45 5037.77,-1382.46 5435.84,-1343.92"/>
<polygon fill="black" stroke="black" points="5436.36,-1347.39 5445.97,-1342.92 5435.68,-1340.42 5436.36,-1347.39"/>
</g>
<!-- gpu15_mha_qkv -->
<g id="node17" class="node">
<title>gpu15_mha_qkv</title>
<polygon fill="none" stroke="black" points="6206,-1343.81 5835,-1343.81 5835,-1275.81 6206,-1275.81 6206,-1343.81"/>
<text text-anchor="middle" x="6020.5" y="-1328.61" font-family="Times,serif" font-size="14.00">gpu15_mha_qkv</text>
<text text-anchor="middle" x="6020.5" y="-1313.61" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="6020.5" y="-1298.61" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="6020.5" y="-1283.61" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, heads=16, d_k=64</text>
</g>
<!-- INPUT&#45;&gt;gpu15_mha_qkv -->
<g id="edge16" class="edge">
<title>INPUT&#45;&gt;gpu15_mha_qkv</title>
<path fill="none" stroke="black" d="M3469.54,-1411.29C3957.95,-1406.46 5347.93,-1389.11 5824.91,-1343.91"/>
<polygon fill="black" stroke="black" points="5825.36,-1347.38 5834.97,-1342.94 5824.68,-1340.42 5825.36,-1347.38"/>
</g>
<!-- resid1 -->
<g id="node38" class="node">
<title>resid1</title>
<polygon fill="none" stroke="black" points="4937.5,-705.91 4593.5,-705.91 4593.5,-637.91 4937.5,-637.91 4937.5,-705.91"/>
<text text-anchor="middle" x="4765.5" y="-690.71" font-family="Times,serif" font-size="14.00">resid1</text>
<text text-anchor="middle" x="4765.5" y="-675.71" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="4765.5" y="-660.71" font-family="Times,serif" font-size="14.00">In: x2</text>
<text text-anchor="middle" x="4765.5" y="-645.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- INPUT&#45;&gt;resid1 -->
<g id="edge67" class="edge">
<title>INPUT&#45;&gt;resid1</title>
<path fill="none" stroke="black" d="M3469.75,-1411.73C4088.38,-1407.48 6164.1,-1389.81 6215.5,-1343.81 6262.45,-1301.8 6234.5,-1266.34 6234.5,-1203.34 6234.5,-1203.34 6234.5,-1203.34 6234.5,-885.86 6234.5,-868.94 6229.6,-862.22 6215.5,-852.86 6011.38,-717.39 5289.79,-683.9 4947.83,-675.62"/>
<polygon fill="black" stroke="black" points="4947.9,-672.12 4937.82,-675.39 4947.74,-679.12 4947.9,-672.12"/>
</g>
<!-- ag_qkv -->
<g id="node18" class="node">
<title>ag_qkv</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3102.5" cy="-1202.34" rx="56.64" ry="37.45"/>
<text text-anchor="middle" x="3102.5" y="-1213.64" font-family="Times,serif" font-size="14.00">ag_qkv</text>
<text text-anchor="middle" x="3102.5" y="-1198.64" font-family="Times,serif" font-size="14.00">In: shard</text>
<text text-anchor="middle" x="3102.5" y="-1183.64" font-family="Times,serif" font-size="14.00">Out: full</text>
</g>
<!-- gpu0_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge17" class="edge">
<title>gpu0_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M371.03,-1276.69C373.87,-1276.38 376.69,-1276.09 379.5,-1275.81 918.23,-1223.09 2670.92,-1206.7 3035.64,-1203.83"/>
<polygon fill="black" stroke="black" points="3035.8,-1207.33 3045.77,-1203.75 3035.75,-1200.33 3035.8,-1207.33"/>
</g>
<!-- gpu1_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge18" class="edge">
<title>gpu1_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M760.03,-1276.7C762.87,-1276.39 765.7,-1276.09 768.5,-1275.81 1225.54,-1230.06 2702.19,-1208.52 3035.31,-1204.17"/>
<polygon fill="black" stroke="black" points="3035.8,-1207.67 3045.76,-1204.04 3035.71,-1200.67 3035.8,-1207.67"/>
</g>
<!-- gpu2_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge19" class="edge">
<title>gpu2_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M1149.03,-1276.73C1151.87,-1276.41 1154.7,-1276.1 1157.5,-1275.81 1533.49,-1237 2737.76,-1210.67 3035.47,-1204.65"/>
<polygon fill="black" stroke="black" points="3035.74,-1208.15 3045.67,-1204.45 3035.6,-1201.15 3035.74,-1208.15"/>
</g>
<!-- gpu3_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge20" class="edge">
<title>gpu3_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M1538.03,-1276.76C1540.87,-1276.43 1543.7,-1276.12 1546.5,-1275.81 2120.55,-1213.85 2819.37,-1204.83 3035.56,-1203.54"/>
<polygon fill="black" stroke="black" points="3035.81,-1207.04 3045.79,-1203.49 3035.77,-1200.04 3035.81,-1207.04"/>
</g>
<!-- gpu4_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge21" class="edge">
<title>gpu4_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M1927.04,-1276.82C1929.88,-1276.47 1932.7,-1276.14 1935.5,-1275.81 2352.38,-1227.55 2857.02,-1209.97 3035.8,-1204.99"/>
<polygon fill="black" stroke="black" points="3035.94,-1208.49 3045.84,-1204.72 3035.75,-1201.49 3035.94,-1208.49"/>
</g>
<!-- gpu5_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge22" class="edge">
<title>gpu5_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2316.06,-1276.95C2318.89,-1276.56 2321.71,-1276.18 2324.5,-1275.81 2586.99,-1241.31 2901.43,-1217.29 3036.05,-1207.82"/>
<polygon fill="black" stroke="black" points="3036.47,-1211.3 3046.2,-1207.11 3035.98,-1204.32 3036.47,-1211.3"/>
</g>
<!-- gpu6_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge23" class="edge">
<title>gpu6_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2701.97,-1275.8C2816.64,-1255.05 2957.62,-1229.55 3038.06,-1214.99"/>
<polygon fill="black" stroke="black" points="3038.83,-1218.41 3048.04,-1213.19 3037.58,-1211.53 3038.83,-1218.41"/>
</g>
<!-- gpu7_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge24" class="edge">
<title>gpu7_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2969.35,-1275.73C2995.38,-1261.58 3025.46,-1245.22 3050.44,-1231.64"/>
<polygon fill="black" stroke="black" points="3052.28,-1234.63 3059.39,-1226.77 3048.93,-1228.48 3052.28,-1234.63"/>
</g>
<!-- gpu8_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge25" class="edge">
<title>gpu8_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M3236.34,-1275.73C3210.17,-1261.58 3179.94,-1245.22 3154.83,-1231.64"/>
<polygon fill="black" stroke="black" points="3156.29,-1228.45 3145.83,-1226.77 3152.96,-1234.61 3156.29,-1228.45"/>
</g>
<!-- gpu9_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge26" class="edge">
<title>gpu9_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M3503.72,-1275.8C3388.69,-1255.03 3247.24,-1229.48 3166.71,-1214.93"/>
<polygon fill="black" stroke="black" points="3167.18,-1211.46 3156.72,-1213.13 3165.94,-1218.35 3167.18,-1211.46"/>
</g>
<!-- gpu10_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge27" class="edge">
<title>gpu10_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M3889.94,-1276.95C3887.11,-1276.56 3884.29,-1276.18 3881.5,-1275.81 3618.67,-1241.28 3303.83,-1217.28 3169.04,-1207.82"/>
<polygon fill="black" stroke="black" points="3169.09,-1204.32 3158.87,-1207.11 3168.61,-1211.3 3169.09,-1204.32"/>
</g>
<!-- gpu11_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge28" class="edge">
<title>gpu11_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M4278.96,-1276.82C4276.12,-1276.47 4273.3,-1276.14 4270.5,-1275.81 3853.26,-1227.52 3348.19,-1209.96 3169.26,-1204.99"/>
<polygon fill="black" stroke="black" points="3169.3,-1201.49 3159.21,-1204.71 3169.11,-1208.49 3169.3,-1201.49"/>
</g>
<!-- gpu12_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge29" class="edge">
<title>gpu12_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M4667.97,-1276.76C4665.13,-1276.43 4662.3,-1276.12 4659.5,-1275.81 4085.08,-1213.82 3385.82,-1204.82 3169.49,-1203.54"/>
<polygon fill="black" stroke="black" points="3169.27,-1200.04 3159.25,-1203.48 3169.23,-1207.04 3169.27,-1200.04"/>
</g>
<!-- gpu13_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge30" class="edge">
<title>gpu13_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M5056.97,-1276.73C5054.13,-1276.41 5051.3,-1276.1 5048.5,-1275.81 4672.32,-1236.98 3467.43,-1210.67 3169.57,-1204.65"/>
<polygon fill="black" stroke="black" points="3169.43,-1201.15 3159.36,-1204.45 3169.28,-1208.15 3169.43,-1201.15"/>
</g>
<!-- gpu14_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge31" class="edge">
<title>gpu14_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M5445.97,-1276.7C5443.13,-1276.39 5440.3,-1276.09 5437.5,-1275.81 4980.14,-1230.03 3502.17,-1208.5 3169.44,-1204.17"/>
<polygon fill="black" stroke="black" points="3169.06,-1200.67 3159.01,-1204.04 3168.97,-1207.66 3169.06,-1200.67"/>
</g>
<!-- gpu15_mha_qkv&#45;&gt;ag_qkv -->
<g id="edge32" class="edge">
<title>gpu15_mha_qkv&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M5834.97,-1276.69C5832.13,-1276.38 5829.31,-1276.09 5826.5,-1275.81 5287.57,-1223.08 3534.23,-1206.7 3169.38,-1203.83"/>
<polygon fill="black" stroke="black" points="3169.27,-1200.33 3159.25,-1203.75 3169.22,-1207.33 3169.27,-1200.33"/>
</g>
<!-- mha_score -->
<g id="node19" class="node">
<title>mha_score</title>
<polygon fill="none" stroke="black" points="3307.5,-1128.86 2897.5,-1128.86 2897.5,-1060.86 3307.5,-1060.86 3307.5,-1128.86"/>
<text text-anchor="middle" x="3102.5" y="-1113.66" font-family="Times,serif" font-size="14.00">mha_score</text>
<text text-anchor="middle" x="3102.5" y="-1098.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="3102.5" y="-1083.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="3102.5" y="-1068.66" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- ag_qkv&#45;&gt;mha_score -->
<g id="edge33" class="edge">
<title>ag_qkv&#45;&gt;mha_score</title>
<path fill="none" stroke="black" d="M3102.5,-1164.74C3102.5,-1156.45 3102.5,-1147.57 3102.5,-1139.04"/>
<polygon fill="black" stroke="black" points="3106,-1138.86 3102.5,-1128.86 3099,-1138.86 3106,-1138.86"/>
</g>
<!-- mha_softmax -->
<g id="node20" class="node">
<title>mha_softmax</title>
<polygon fill="none" stroke="black" points="3307.5,-1024.86 2897.5,-1024.86 2897.5,-956.86 3307.5,-956.86 3307.5,-1024.86"/>
<text text-anchor="middle" x="3102.5" y="-1009.66" font-family="Times,serif" font-size="14.00">mha_softmax</text>
<text text-anchor="middle" x="3102.5" y="-994.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="3102.5" y="-979.66" font-family="Times,serif" font-size="14.00">In: batch_size, heads=16, seq_len=128, seq_len=128</text>
<text text-anchor="middle" x="3102.5" y="-964.66" font-family="Times,serif" font-size="14.00">Out: batch_size, heads=16, seq_len=128, seq_len=128</text>
</g>
<!-- mha_score&#45;&gt;mha_softmax -->
<g id="edge34" class="edge">
<title>mha_score&#45;&gt;mha_softmax</title>
<path fill="none" stroke="black" d="M3102.5,-1060.74C3102.5,-1052.64 3102.5,-1043.84 3102.5,-1035.33"/>
<polygon fill="black" stroke="black" points="3106,-1035.16 3102.5,-1025.16 3099,-1035.16 3106,-1035.16"/>
</g>
<!-- gpu0_mha_out -->
<g id="node21" class="node">
<title>gpu0_mha_out</title>
<polygon fill="none" stroke="black" points="371,-920.86 0,-920.86 0,-852.86 371,-852.86 371,-920.86"/>
<text text-anchor="middle" x="185.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu0_mha_out</text>
<text text-anchor="middle" x="185.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="185.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="185.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu0_mha_out -->
<g id="edge35" class="edge">
<title>mha_softmax&#45;&gt;gpu0_mha_out</title>
<path fill="none" stroke="black" d="M2897.43,-988.47C2354.56,-984.18 887.62,-968.51 381.34,-920.98"/>
<polygon fill="black" stroke="black" points="381.31,-917.46 371.03,-919.99 380.65,-924.43 381.31,-917.46"/>
</g>
<!-- gpu1_mha_out -->
<g id="node22" class="node">
<title>gpu1_mha_out</title>
<polygon fill="none" stroke="black" points="760,-920.86 389,-920.86 389,-852.86 760,-852.86 760,-920.86"/>
<text text-anchor="middle" x="574.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu1_mha_out</text>
<text text-anchor="middle" x="574.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="574.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu1_mha_out -->
<g id="edge36" class="edge">
<title>mha_softmax&#45;&gt;gpu1_mha_out</title>
<path fill="none" stroke="black" d="M2897.36,-987.45C2411.12,-981.17 1197.96,-961.88 770.29,-920.98"/>
<polygon fill="black" stroke="black" points="770.32,-917.46 760.03,-919.98 769.64,-924.43 770.32,-917.46"/>
</g>
<!-- gpu2_mha_out -->
<g id="node23" class="node">
<title>gpu2_mha_out</title>
<polygon fill="none" stroke="black" points="1149,-920.86 778,-920.86 778,-852.86 1149,-852.86 1149,-920.86"/>
<text text-anchor="middle" x="963.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu2_mha_out</text>
<text text-anchor="middle" x="963.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="963.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="963.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu2_mha_out -->
<g id="edge37" class="edge">
<title>mha_softmax&#45;&gt;gpu2_mha_out</title>
<path fill="none" stroke="black" d="M2897.44,-986.04C2472.89,-977.58 1508.81,-955.3 1159.19,-920.97"/>
<polygon fill="black" stroke="black" points="1159.33,-917.47 1149.03,-919.95 1158.63,-924.43 1159.33,-917.47"/>
</g>
<!-- gpu3_mha_out -->
<g id="node24" class="node">
<title>gpu3_mha_out</title>
<polygon fill="none" stroke="black" points="1538,-920.86 1167,-920.86 1167,-852.86 1538,-852.86 1538,-920.86"/>
<text text-anchor="middle" x="1352.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu3_mha_out</text>
<text text-anchor="middle" x="1352.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1352.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="1352.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu3_mha_out -->
<g id="edge38" class="edge">
<title>mha_softmax&#45;&gt;gpu3_mha_out</title>
<path fill="none" stroke="black" d="M2897.37,-988.86C2601.19,-985.6 2036.58,-972.55 1548.11,-920.99"/>
<polygon fill="black" stroke="black" points="1548.35,-917.49 1538.03,-919.92 1547.61,-924.46 1548.35,-917.49"/>
</g>
<!-- gpu4_mha_out -->
<g id="node25" class="node">
<title>gpu4_mha_out</title>
<polygon fill="none" stroke="black" points="1927,-920.86 1556,-920.86 1556,-852.86 1927,-852.86 1927,-920.86"/>
<text text-anchor="middle" x="1741.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu4_mha_out</text>
<text text-anchor="middle" x="1741.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1741.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="1741.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu4_mha_out -->
<g id="edge39" class="edge">
<title>mha_softmax&#45;&gt;gpu4_mha_out</title>
<path fill="none" stroke="black" d="M2897.43,-984.52C2666.19,-976.95 2278.89,-959.57 1937.14,-921.01"/>
<polygon fill="black" stroke="black" points="1937.37,-917.51 1927.04,-919.86 1936.58,-924.47 1937.37,-917.51"/>
</g>
<!-- gpu5_mha_out -->
<g id="node26" class="node">
<title>gpu5_mha_out</title>
<polygon fill="none" stroke="black" points="2316,-920.86 1945,-920.86 1945,-852.86 2316,-852.86 2316,-920.86"/>
<text text-anchor="middle" x="2130.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu5_mha_out</text>
<text text-anchor="middle" x="2130.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="2130.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="2130.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu5_mha_out -->
<g id="edge40" class="edge">
<title>mha_softmax&#45;&gt;gpu5_mha_out</title>
<path fill="none" stroke="black" d="M2897.26,-976.16C2742.72,-964.77 2525.51,-946.5 2326.14,-921.04"/>
<polygon fill="black" stroke="black" points="2326.42,-917.55 2316.05,-919.74 2325.53,-924.49 2326.42,-917.55"/>
</g>
<!-- gpu6_mha_out -->
<g id="node27" class="node">
<title>gpu6_mha_out</title>
<polygon fill="none" stroke="black" points="2705,-920.86 2334,-920.86 2334,-852.86 2705,-852.86 2705,-920.86"/>
<text text-anchor="middle" x="2519.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu6_mha_out</text>
<text text-anchor="middle" x="2519.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2519.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="2519.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu6_mha_out -->
<g id="edge41" class="edge">
<title>mha_softmax&#45;&gt;gpu6_mha_out</title>
<path fill="none" stroke="black" d="M2913.62,-956.81C2850.16,-945.71 2779.27,-933.31 2715.3,-922.12"/>
<polygon fill="black" stroke="black" points="2715.55,-918.61 2705.09,-920.33 2714.34,-925.5 2715.55,-918.61"/>
</g>
<!-- gpu7_mha_out -->
<g id="node28" class="node">
<title>gpu7_mha_out</title>
<polygon fill="none" stroke="black" points="3094,-920.86 2723,-920.86 2723,-852.86 3094,-852.86 3094,-920.86"/>
<text text-anchor="middle" x="2908.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu7_mha_out</text>
<text text-anchor="middle" x="2908.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="2908.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="2908.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu7_mha_out -->
<g id="edge42" class="edge">
<title>mha_softmax&#45;&gt;gpu7_mha_out</title>
<path fill="none" stroke="black" d="M3039.51,-956.74C3020.7,-946.85 2999.93,-935.93 2980.58,-925.76"/>
<polygon fill="black" stroke="black" points="2981.98,-922.54 2971.5,-920.98 2978.72,-928.74 2981.98,-922.54"/>
</g>
<!-- gpu8_mha_out -->
<g id="node29" class="node">
<title>gpu8_mha_out</title>
<polygon fill="none" stroke="black" points="3483,-920.86 3112,-920.86 3112,-852.86 3483,-852.86 3483,-920.86"/>
<text text-anchor="middle" x="3297.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu8_mha_out</text>
<text text-anchor="middle" x="3297.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3297.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="3297.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu8_mha_out -->
<g id="edge43" class="edge">
<title>mha_softmax&#45;&gt;gpu8_mha_out</title>
<path fill="none" stroke="black" d="M3165.81,-956.74C3184.72,-946.85 3205.6,-935.93 3225.05,-925.76"/>
<polygon fill="black" stroke="black" points="3226.93,-928.72 3234.17,-920.98 3223.69,-922.52 3226.93,-928.72"/>
</g>
<!-- gpu9_mha_out -->
<g id="node30" class="node">
<title>gpu9_mha_out</title>
<polygon fill="none" stroke="black" points="3872,-920.86 3501,-920.86 3501,-852.86 3872,-852.86 3872,-920.86"/>
<text text-anchor="middle" x="3686.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu9_mha_out</text>
<text text-anchor="middle" x="3686.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3686.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="3686.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu9_mha_out -->
<g id="edge44" class="edge">
<title>mha_softmax&#45;&gt;gpu9_mha_out</title>
<path fill="none" stroke="black" d="M3291.7,-956.81C3355.27,-945.71 3426.28,-933.31 3490.36,-922.12"/>
<polygon fill="black" stroke="black" points="3491.34,-925.5 3500.59,-920.33 3490.13,-918.6 3491.34,-925.5"/>
</g>
<!-- gpu10_mha_out -->
<g id="node31" class="node">
<title>gpu10_mha_out</title>
<polygon fill="none" stroke="black" points="4261,-920.86 3890,-920.86 3890,-852.86 4261,-852.86 4261,-920.86"/>
<text text-anchor="middle" x="4075.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu10_mha_out</text>
<text text-anchor="middle" x="4075.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4075.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="4075.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu10_mha_out -->
<g id="edge45" class="edge">
<title>mha_softmax&#45;&gt;gpu10_mha_out</title>
<path fill="none" stroke="black" d="M3307.6,-976.2C3462.36,-964.83 3680.06,-946.54 3879.84,-921.04"/>
<polygon fill="black" stroke="black" points="3880.47,-924.49 3889.95,-919.75 3879.58,-917.55 3880.47,-924.49"/>
</g>
<!-- gpu11_mha_out -->
<g id="node32" class="node">
<title>gpu11_mha_out</title>
<polygon fill="none" stroke="black" points="4650,-920.86 4279,-920.86 4279,-852.86 4650,-852.86 4650,-920.86"/>
<text text-anchor="middle" x="4464.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu11_mha_out</text>
<text text-anchor="middle" x="4464.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4464.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="4464.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu11_mha_out -->
<g id="edge46" class="edge">
<title>mha_softmax&#45;&gt;gpu11_mha_out</title>
<path fill="none" stroke="black" d="M3307.75,-984.53C3539.19,-976.96 3926.81,-959.59 4268.85,-921.01"/>
<polygon fill="black" stroke="black" points="4269.42,-924.47 4278.96,-919.86 4268.63,-917.51 4269.42,-924.47"/>
</g>
<!-- gpu12_mha_out -->
<g id="node33" class="node">
<title>gpu12_mha_out</title>
<polygon fill="none" stroke="black" points="5039,-920.86 4668,-920.86 4668,-852.86 5039,-852.86 5039,-920.86"/>
<text text-anchor="middle" x="4853.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu12_mha_out</text>
<text text-anchor="middle" x="4853.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="4853.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="4853.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu12_mha_out -->
<g id="edge47" class="edge">
<title>mha_softmax&#45;&gt;gpu12_mha_out</title>
<path fill="none" stroke="black" d="M3307.76,-988.87C3604.14,-985.61 4169.11,-972.58 4657.88,-920.99"/>
<polygon fill="black" stroke="black" points="4658.39,-924.46 4667.97,-919.92 4657.65,-917.49 4658.39,-924.46"/>
</g>
<!-- gpu13_mha_out -->
<g id="node34" class="node">
<title>gpu13_mha_out</title>
<polygon fill="none" stroke="black" points="5428,-920.86 5057,-920.86 5057,-852.86 5428,-852.86 5428,-920.86"/>
<text text-anchor="middle" x="5242.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu13_mha_out</text>
<text text-anchor="middle" x="5242.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="5242.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="5242.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu13_mha_out -->
<g id="edge48" class="edge">
<title>mha_softmax&#45;&gt;gpu13_mha_out</title>
<path fill="none" stroke="black" d="M3307.67,-986.05C3732.44,-977.58 4697.01,-955.31 5046.8,-920.97"/>
<polygon fill="black" stroke="black" points="5047.37,-924.43 5056.97,-919.95 5046.67,-917.47 5047.37,-924.43"/>
</g>
<!-- gpu14_mha_out -->
<g id="node35" class="node">
<title>gpu14_mha_out</title>
<polygon fill="none" stroke="black" points="5817,-920.86 5446,-920.86 5446,-852.86 5817,-852.86 5817,-920.86"/>
<text text-anchor="middle" x="5631.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu14_mha_out</text>
<text text-anchor="middle" x="5631.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="5631.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="5631.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu14_mha_out -->
<g id="edge49" class="edge">
<title>mha_softmax&#45;&gt;gpu14_mha_out</title>
<path fill="none" stroke="black" d="M3307.73,-987.46C3794.3,-981.17 5008.46,-961.88 5436.02,-920.95"/>
<polygon fill="black" stroke="black" points="5436.36,-924.43 5445.97,-919.98 5435.68,-917.46 5436.36,-924.43"/>
</g>
<!-- gpu15_mha_out -->
<g id="node36" class="node">
<title>gpu15_mha_out</title>
<polygon fill="none" stroke="black" points="6206,-920.86 5835,-920.86 5835,-852.86 6206,-852.86 6206,-920.86"/>
<text text-anchor="middle" x="6020.5" y="-905.66" font-family="Times,serif" font-size="14.00">gpu15_mha_out</text>
<text text-anchor="middle" x="6020.5" y="-890.66" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="6020.5" y="-875.66" font-family="Times,serif" font-size="14.00">In: full</text>
<text text-anchor="middle" x="6020.5" y="-860.66" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024//16</text>
</g>
<!-- mha_softmax&#45;&gt;gpu15_mha_out -->
<g id="edge50" class="edge">
<title>mha_softmax&#45;&gt;gpu15_mha_out</title>
<path fill="none" stroke="black" d="M3307.65,-988.47C3850.72,-984.19 5318.19,-968.52 5824.65,-920.98"/>
<polygon fill="black" stroke="black" points="5825.35,-924.43 5834.97,-919.99 5824.69,-917.46 5825.35,-924.43"/>
</g>
<!-- ar_mha -->
<g id="node37" class="node">
<title>ar_mha</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3297.5" cy="-779.38" rx="56.64" ry="37.45"/>
<text text-anchor="middle" x="3297.5" y="-790.68" font-family="Times,serif" font-size="14.00">ar_mha</text>
<text text-anchor="middle" x="3297.5" y="-775.68" font-family="Times,serif" font-size="14.00">In: shard</text>
<text text-anchor="middle" x="3297.5" y="-760.68" font-family="Times,serif" font-size="14.00">Out: full</text>
</g>
<!-- gpu0_mha_out&#45;&gt;ar_mha -->
<g id="edge51" class="edge">
<title>gpu0_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M371.03,-853.72C373.87,-853.42 376.69,-853.13 379.5,-852.86 959.3,-796.64 2851.13,-782.94 3230.79,-780.74"/>
<polygon fill="black" stroke="black" points="3230.82,-784.24 3240.8,-780.68 3230.78,-777.24 3230.82,-784.24"/>
</g>
<!-- gpu1_mha_out&#45;&gt;ar_mha -->
<g id="edge52" class="edge">
<title>gpu1_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M760.03,-853.74C762.87,-853.43 765.7,-853.14 768.5,-852.86 1266.55,-803.61 2881.89,-784.61 3230.7,-781.03"/>
<polygon fill="black" stroke="black" points="3230.93,-784.53 3240.89,-780.93 3230.86,-777.53 3230.93,-784.53"/>
</g>
<!-- gpu2_mha_out&#45;&gt;ar_mha -->
<g id="edge53" class="edge">
<title>gpu2_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M1149.03,-853.76C1151.87,-853.45 1154.7,-853.14 1157.5,-852.86 1574.15,-810.56 2915.12,-786.58 3230.6,-781.43"/>
<polygon fill="black" stroke="black" points="3231,-784.93 3240.94,-781.27 3230.89,-777.93 3231,-784.93"/>
</g>
<!-- gpu3_mha_out&#45;&gt;ar_mha -->
<g id="edge54" class="edge">
<title>gpu3_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M1538.03,-853.79C1540.87,-853.47 1543.7,-853.16 1546.5,-852.86 2200.19,-784.02 2997.59,-779.75 3230.61,-780.1"/>
<polygon fill="black" stroke="black" points="3230.61,-783.6 3240.62,-780.12 3230.63,-776.6 3230.61,-783.6"/>
</g>
<!-- gpu4_mha_out&#45;&gt;ar_mha -->
<g id="edge55" class="edge">
<title>gpu4_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M1927.04,-853.84C1929.88,-853.5 1932.7,-853.17 1935.5,-852.86 2430.85,-797.74 3032.38,-784.26 3230.62,-781.21"/>
<polygon fill="black" stroke="black" points="3230.93,-784.71 3240.87,-781.06 3230.82,-777.71 3230.93,-784.71"/>
</g>
<!-- gpu5_mha_out&#45;&gt;ar_mha -->
<g id="edge56" class="edge">
<title>gpu5_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M2316.05,-853.92C2318.88,-853.56 2321.7,-853.2 2324.5,-852.86 2664.05,-811.43 3073.36,-790.26 3231.08,-783.17"/>
<polygon fill="black" stroke="black" points="3231.27,-786.67 3241.11,-782.72 3230.96,-779.67 3231.27,-786.67"/>
</g>
<!-- gpu6_mha_out&#45;&gt;ar_mha -->
<g id="edge57" class="edge">
<title>gpu6_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M2705.07,-854.11C2707.9,-853.69 2710.71,-853.27 2713.5,-852.86 2901.02,-825.29 3123.45,-799.62 3231.71,-787.57"/>
<polygon fill="black" stroke="black" points="3232.27,-791.03 3241.83,-786.45 3231.5,-784.07 3232.27,-791.03"/>
</g>
<!-- gpu7_mha_out&#45;&gt;ar_mha -->
<g id="edge58" class="edge">
<title>gpu7_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M3030.25,-852.85C3098.44,-834.36 3180.56,-812.09 3235.62,-797.16"/>
<polygon fill="black" stroke="black" points="3236.84,-800.46 3245.58,-794.46 3235.01,-793.7 3236.84,-800.46"/>
</g>
<!-- gpu8_mha_out&#45;&gt;ar_mha -->
<g id="edge59" class="edge">
<title>gpu8_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M3297.5,-852.78C3297.5,-844.61 3297.5,-835.72 3297.5,-827.04"/>
<polygon fill="black" stroke="black" points="3301,-827.02 3297.5,-817.02 3294,-827.02 3301,-827.02"/>
</g>
<!-- gpu9_mha_out&#45;&gt;ar_mha -->
<g id="edge60" class="edge">
<title>gpu9_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M3564.75,-852.85C3496.56,-834.36 3414.44,-812.09 3359.38,-797.16"/>
<polygon fill="black" stroke="black" points="3359.99,-793.7 3349.42,-794.46 3358.16,-800.46 3359.99,-793.7"/>
</g>
<!-- gpu10_mha_out&#45;&gt;ar_mha -->
<g id="edge61" class="edge">
<title>gpu10_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M3889.93,-854.11C3887.1,-853.69 3884.29,-853.27 3881.5,-852.86 3693.98,-825.29 3471.55,-799.62 3363.29,-787.57"/>
<polygon fill="black" stroke="black" points="3363.5,-784.07 3353.17,-786.45 3362.73,-791.03 3363.5,-784.07"/>
</g>
<!-- gpu11_mha_out&#45;&gt;ar_mha -->
<g id="edge62" class="edge">
<title>gpu11_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M4278.95,-853.92C4276.12,-853.56 4273.3,-853.2 4270.5,-852.86 3930.95,-811.43 3521.64,-790.26 3363.92,-783.17"/>
<polygon fill="black" stroke="black" points="3364.04,-779.67 3353.89,-782.72 3363.73,-786.67 3364.04,-779.67"/>
</g>
<!-- gpu12_mha_out&#45;&gt;ar_mha -->
<g id="edge63" class="edge">
<title>gpu12_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M4667.96,-853.84C4665.12,-853.5 4662.3,-853.17 4659.5,-852.86 4164.15,-797.74 3562.62,-784.26 3364.38,-781.21"/>
<polygon fill="black" stroke="black" points="3364.18,-777.71 3354.13,-781.06 3364.07,-784.71 3364.18,-777.71"/>
</g>
<!-- gpu13_mha_out&#45;&gt;ar_mha -->
<g id="edge64" class="edge">
<title>gpu13_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M5056.97,-853.79C5054.13,-853.47 5051.3,-853.16 5048.5,-852.86 4394.81,-784.02 3597.41,-779.75 3364.39,-780.1"/>
<polygon fill="black" stroke="black" points="3364.37,-776.6 3354.38,-780.12 3364.39,-783.6 3364.37,-776.6"/>
</g>
<!-- gpu14_mha_out&#45;&gt;ar_mha -->
<g id="edge65" class="edge">
<title>gpu14_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M5445.97,-853.76C5443.13,-853.45 5440.3,-853.14 5437.5,-852.86 5020.85,-810.56 3679.88,-786.58 3364.4,-781.43"/>
<polygon fill="black" stroke="black" points="3364.11,-777.93 3354.06,-781.27 3364,-784.93 3364.11,-777.93"/>
</g>
<!-- gpu15_mha_out&#45;&gt;ar_mha -->
<g id="edge66" class="edge">
<title>gpu15_mha_out&#45;&gt;ar_mha</title>
<path fill="none" stroke="black" d="M5834.97,-853.74C5832.13,-853.43 5829.3,-853.14 5826.5,-852.86 5328.45,-803.61 3713.11,-784.61 3364.3,-781.03"/>
<polygon fill="black" stroke="black" points="3364.14,-777.53 3354.11,-780.93 3364.07,-784.53 3364.14,-777.53"/>
</g>
<!-- ar_mha&#45;&gt;resid1 -->
<g id="edge68" class="edge">
<title>ar_mha&#45;&gt;resid1</title>
<path fill="none" stroke="black" d="M3353.7,-774.35C3555.5,-759.85 4249.22,-710 4583.11,-686.01"/>
<polygon fill="black" stroke="black" points="4583.65,-689.48 4593.37,-685.27 4583.14,-682.5 4583.65,-689.48"/>
</g>
<!-- moe_gate -->
<g id="node39" class="node">
<title>moe_gate</title>
<polygon fill="none" stroke="black" points="4834.5,-601.91 4502.5,-601.91 4502.5,-533.91 4834.5,-533.91 4834.5,-601.91"/>
<text text-anchor="middle" x="4668.5" y="-586.71" font-family="Times,serif" font-size="14.00">moe_gate</text>
<text text-anchor="middle" x="4668.5" y="-571.71" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="4668.5" y="-556.71" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4668.5" y="-541.71" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, 64</text>
</g>
<!-- resid1&#45;&gt;moe_gate -->
<g id="edge69" class="edge">
<title>resid1&#45;&gt;moe_gate</title>
<path fill="none" stroke="black" d="M4734.01,-637.79C4725.45,-628.79 4716.09,-618.95 4707.18,-609.58"/>
<polygon fill="black" stroke="black" points="4709.59,-607.04 4700.17,-602.21 4704.52,-611.86 4709.59,-607.04"/>
</g>
<!-- resid2 -->
<g id="node58" class="node">
<title>resid2</title>
<polygon fill="none" stroke="black" points="4937.5,-172 4593.5,-172 4593.5,-104 4937.5,-104 4937.5,-172"/>
<text text-anchor="middle" x="4765.5" y="-156.8" font-family="Times,serif" font-size="14.00">resid2</text>
<text text-anchor="middle" x="4765.5" y="-141.8" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="4765.5" y="-126.8" font-family="Times,serif" font-size="14.00">In: x2</text>
<text text-anchor="middle" x="4765.5" y="-111.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- resid1&#45;&gt;resid2 -->
<g id="edge103" class="edge">
<title>resid1&#45;&gt;resid2</title>
<path fill="none" stroke="black" d="M4937.59,-662.2C5304.91,-641.31 6132.5,-580.99 6132.5,-461.43 6132.5,-461.43 6132.5,-461.43 6132.5,-351.95 6132.5,-335.03 6127.56,-328.38 6113.5,-318.95 5926.65,-193.69 5271.08,-155.2 4948.11,-143.71"/>
<polygon fill="black" stroke="black" points="4947.82,-140.2 4937.71,-143.35 4947.58,-147.19 4947.82,-140.2"/>
</g>
<!-- dispatch -->
<g id="node40" class="node">
<title>dispatch</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3398.5" cy="-460.43" rx="243.49" ry="37.45"/>
<text text-anchor="middle" x="3398.5" y="-471.73" font-family="Times,serif" font-size="14.00">dispatch</text>
<text text-anchor="middle" x="3398.5" y="-456.73" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3398.5" y="-441.73" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- moe_gate&#45;&gt;dispatch -->
<g id="edge70" class="edge">
<title>moe_gate&#45;&gt;dispatch</title>
<path fill="none" stroke="black" d="M4502.47,-553.12C4276.55,-534.35 3871.69,-500.73 3620.06,-479.83"/>
<polygon fill="black" stroke="black" points="3620.31,-476.34 3610.05,-479 3619.73,-483.32 3620.31,-476.34"/>
</g>
<!-- gpu0_expert -->
<g id="node41" class="node">
<title>gpu0_expert</title>
<polygon fill="none" stroke="black" points="674.5,-386.95 330.5,-386.95 330.5,-318.95 674.5,-318.95 674.5,-386.95"/>
<text text-anchor="middle" x="502.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu0_expert</text>
<text text-anchor="middle" x="502.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="502.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="502.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu0_expert -->
<g id="edge71" class="edge">
<title>dispatch&#45;&gt;gpu0_expert</title>
<path fill="none" stroke="black" d="M3155.88,-457.73C2586.88,-452.98 1178.16,-436.55 684.91,-387.03"/>
<polygon fill="black" stroke="black" points="685.16,-383.54 674.86,-386 684.45,-390.5 685.16,-383.54"/>
</g>
<!-- gpu1_expert -->
<g id="node42" class="node">
<title>gpu1_expert</title>
<polygon fill="none" stroke="black" points="1036.5,-386.95 692.5,-386.95 692.5,-318.95 1036.5,-318.95 1036.5,-386.95"/>
<text text-anchor="middle" x="864.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu1_expert</text>
<text text-anchor="middle" x="864.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="864.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="864.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu1_expert -->
<g id="edge72" class="edge">
<title>dispatch&#45;&gt;gpu1_expert</title>
<path fill="none" stroke="black" d="M3156.27,-456.57C2644.8,-449.77 1467.91,-430 1046.97,-387.04"/>
<polygon fill="black" stroke="black" points="1047.17,-383.54 1036.86,-385.99 1046.44,-390.5 1047.17,-383.54"/>
</g>
<!-- gpu2_expert -->
<g id="node43" class="node">
<title>gpu2_expert</title>
<polygon fill="none" stroke="black" points="1398.5,-386.95 1054.5,-386.95 1054.5,-318.95 1398.5,-318.95 1398.5,-386.95"/>
<text text-anchor="middle" x="1226.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu2_expert</text>
<text text-anchor="middle" x="1226.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="1226.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1226.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu2_expert -->
<g id="edge73" class="edge">
<title>dispatch&#45;&gt;gpu2_expert</title>
<path fill="none" stroke="black" d="M3157.72,-455.01C2708.75,-446.05 1758.44,-423.53 1409.02,-387.05"/>
<polygon fill="black" stroke="black" points="1409.18,-383.55 1398.86,-385.97 1408.44,-390.51 1409.18,-383.55"/>
</g>
<!-- gpu3_expert -->
<g id="node44" class="node">
<title>gpu3_expert</title>
<polygon fill="none" stroke="black" points="1760.5,-386.95 1416.5,-386.95 1416.5,-318.95 1760.5,-318.95 1760.5,-386.95"/>
<text text-anchor="middle" x="1588.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu3_expert</text>
<text text-anchor="middle" x="1588.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1588.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1588.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu3_expert -->
<g id="edge74" class="edge">
<title>dispatch&#45;&gt;gpu3_expert</title>
<path fill="none" stroke="black" d="M3155.17,-458.89C2838.22,-455.86 2267.02,-442.41 1771.1,-387.08"/>
<polygon fill="black" stroke="black" points="1771.19,-383.57 1760.87,-385.93 1770.41,-390.53 1771.19,-383.57"/>
</g>
<!-- gpu4_expert -->
<g id="node45" class="node">
<title>gpu4_expert</title>
<polygon fill="none" stroke="black" points="2122.5,-386.95 1778.5,-386.95 1778.5,-318.95 2122.5,-318.95 2122.5,-386.95"/>
<text text-anchor="middle" x="1950.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu4_expert</text>
<text text-anchor="middle" x="1950.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1950.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="1950.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu4_expert -->
<g id="edge75" class="edge">
<title>dispatch&#45;&gt;gpu4_expert</title>
<path fill="none" stroke="black" d="M3158.07,-454.49C2905.02,-447.25 2495.11,-429.74 2133.03,-387.09"/>
<polygon fill="black" stroke="black" points="2133.22,-383.59 2122.87,-385.88 2132.39,-390.54 2133.22,-383.59"/>
</g>
<!-- gpu5_expert -->
<g id="node46" class="node">
<title>gpu5_expert</title>
<polygon fill="none" stroke="black" points="2484.5,-386.95 2140.5,-386.95 2140.5,-318.95 2484.5,-318.95 2484.5,-386.95"/>
<text text-anchor="middle" x="2312.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu5_expert</text>
<text text-anchor="middle" x="2312.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="2312.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2312.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu5_expert -->
<g id="edge76" class="edge">
<title>dispatch&#45;&gt;gpu5_expert</title>
<path fill="none" stroke="black" d="M3170.03,-447.5C2989.24,-436.54 2730.31,-417.52 2495.01,-387.11"/>
<polygon fill="black" stroke="black" points="2495.25,-383.61 2484.88,-385.79 2494.35,-390.55 2495.25,-383.61"/>
</g>
<!-- gpu6_expert -->
<g id="node47" class="node">
<title>gpu6_expert</title>
<polygon fill="none" stroke="black" points="2846.5,-386.95 2502.5,-386.95 2502.5,-318.95 2846.5,-318.95 2846.5,-386.95"/>
<text text-anchor="middle" x="2674.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu6_expert</text>
<text text-anchor="middle" x="2674.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="2674.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="2674.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu6_expert -->
<g id="edge77" class="edge">
<title>dispatch&#45;&gt;gpu6_expert</title>
<path fill="none" stroke="black" d="M3210.65,-436.59C3108.7,-423.66 2980.26,-406.47 2856.92,-387.16"/>
<polygon fill="black" stroke="black" points="2857.34,-383.68 2846.91,-385.58 2856.25,-390.59 2857.34,-383.68"/>
</g>
<!-- gpu7_expert -->
<g id="node48" class="node">
<title>gpu7_expert</title>
<polygon fill="none" stroke="black" points="3208.5,-386.95 2864.5,-386.95 2864.5,-318.95 3208.5,-318.95 3208.5,-386.95"/>
<text text-anchor="middle" x="3036.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu7_expert</text>
<text text-anchor="middle" x="3036.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="3036.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3036.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu7_expert -->
<g id="edge78" class="edge">
<title>dispatch&#45;&gt;gpu7_expert</title>
<path fill="none" stroke="black" d="M3287.43,-427.07C3246.94,-415.27 3200.93,-401.86 3159.46,-389.78"/>
<polygon fill="black" stroke="black" points="3160.44,-386.42 3149.86,-386.98 3158.48,-393.14 3160.44,-386.42"/>
</g>
<!-- gpu8_expert -->
<g id="node49" class="node">
<title>gpu8_expert</title>
<polygon fill="none" stroke="black" points="3570.5,-386.95 3226.5,-386.95 3226.5,-318.95 3570.5,-318.95 3570.5,-386.95"/>
<text text-anchor="middle" x="3398.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu8_expert</text>
<text text-anchor="middle" x="3398.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3398.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3398.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu8_expert -->
<g id="edge79" class="edge">
<title>dispatch&#45;&gt;gpu8_expert</title>
<path fill="none" stroke="black" d="M3398.5,-422.84C3398.5,-414.54 3398.5,-405.66 3398.5,-397.13"/>
<polygon fill="black" stroke="black" points="3402,-396.95 3398.5,-386.95 3395,-396.95 3402,-396.95"/>
</g>
<!-- gpu9_expert -->
<g id="node50" class="node">
<title>gpu9_expert</title>
<polygon fill="none" stroke="black" points="3932.5,-386.95 3588.5,-386.95 3588.5,-318.95 3932.5,-318.95 3932.5,-386.95"/>
<text text-anchor="middle" x="3760.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu9_expert</text>
<text text-anchor="middle" x="3760.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3760.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="3760.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu9_expert -->
<g id="edge80" class="edge">
<title>dispatch&#45;&gt;gpu9_expert</title>
<path fill="none" stroke="black" d="M3509.57,-427.07C3550.06,-415.27 3596.07,-401.86 3637.54,-389.78"/>
<polygon fill="black" stroke="black" points="3638.52,-393.14 3647.14,-386.98 3636.56,-386.42 3638.52,-393.14"/>
</g>
<!-- gpu10_expert -->
<g id="node51" class="node">
<title>gpu10_expert</title>
<polygon fill="none" stroke="black" points="4294.5,-386.95 3950.5,-386.95 3950.5,-318.95 4294.5,-318.95 4294.5,-386.95"/>
<text text-anchor="middle" x="4122.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu10_expert</text>
<text text-anchor="middle" x="4122.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4122.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4122.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu10_expert -->
<g id="edge81" class="edge">
<title>dispatch&#45;&gt;gpu10_expert</title>
<path fill="none" stroke="black" d="M3586.35,-436.59C3688.3,-423.66 3816.74,-406.47 3940.08,-387.16"/>
<polygon fill="black" stroke="black" points="3940.75,-390.59 3950.09,-385.58 3939.66,-383.68 3940.75,-390.59"/>
</g>
<!-- gpu11_expert -->
<g id="node52" class="node">
<title>gpu11_expert</title>
<polygon fill="none" stroke="black" points="4656.5,-386.95 4312.5,-386.95 4312.5,-318.95 4656.5,-318.95 4656.5,-386.95"/>
<text text-anchor="middle" x="4484.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu11_expert</text>
<text text-anchor="middle" x="4484.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4484.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4484.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu11_expert -->
<g id="edge82" class="edge">
<title>dispatch&#45;&gt;gpu11_expert</title>
<path fill="none" stroke="black" d="M3626.97,-447.5C3807.76,-436.54 4066.69,-417.52 4301.99,-387.11"/>
<polygon fill="black" stroke="black" points="4302.65,-390.55 4312.12,-385.79 4301.75,-383.61 4302.65,-390.55"/>
</g>
<!-- gpu12_expert -->
<g id="node53" class="node">
<title>gpu12_expert</title>
<polygon fill="none" stroke="black" points="5018.5,-386.95 4674.5,-386.95 4674.5,-318.95 5018.5,-318.95 5018.5,-386.95"/>
<text text-anchor="middle" x="4846.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu12_expert</text>
<text text-anchor="middle" x="4846.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="4846.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4846.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu12_expert -->
<g id="edge83" class="edge">
<title>dispatch&#45;&gt;gpu12_expert</title>
<path fill="none" stroke="black" d="M3638.93,-454.49C3891.98,-447.25 4301.89,-429.74 4663.97,-387.09"/>
<polygon fill="black" stroke="black" points="4664.61,-390.54 4674.13,-385.88 4663.78,-383.59 4664.61,-390.54"/>
</g>
<!-- gpu13_expert -->
<g id="node54" class="node">
<title>gpu13_expert</title>
<polygon fill="none" stroke="black" points="5380.5,-386.95 5036.5,-386.95 5036.5,-318.95 5380.5,-318.95 5380.5,-386.95"/>
<text text-anchor="middle" x="5208.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu13_expert</text>
<text text-anchor="middle" x="5208.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="5208.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5208.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu13_expert -->
<g id="edge84" class="edge">
<title>dispatch&#45;&gt;gpu13_expert</title>
<path fill="none" stroke="black" d="M3641.83,-458.89C3958.78,-455.86 4529.98,-442.41 5025.9,-387.08"/>
<polygon fill="black" stroke="black" points="5026.59,-390.53 5036.13,-385.93 5025.81,-383.57 5026.59,-390.53"/>
</g>
<!-- gpu14_expert -->
<g id="node55" class="node">
<title>gpu14_expert</title>
<polygon fill="none" stroke="black" points="5742.5,-386.95 5398.5,-386.95 5398.5,-318.95 5742.5,-318.95 5742.5,-386.95"/>
<text text-anchor="middle" x="5570.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu14_expert</text>
<text text-anchor="middle" x="5570.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="5570.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5570.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu14_expert -->
<g id="edge85" class="edge">
<title>dispatch&#45;&gt;gpu14_expert</title>
<path fill="none" stroke="black" d="M3639.28,-455.01C4088.25,-446.05 5038.56,-423.53 5387.98,-387.05"/>
<polygon fill="black" stroke="black" points="5388.56,-390.51 5398.14,-385.97 5387.82,-383.55 5388.56,-390.51"/>
</g>
<!-- gpu15_expert -->
<g id="node56" class="node">
<title>gpu15_expert</title>
<polygon fill="none" stroke="black" points="6104.5,-386.95 5760.5,-386.95 5760.5,-318.95 6104.5,-318.95 6104.5,-386.95"/>
<text text-anchor="middle" x="5932.5" y="-371.75" font-family="Times,serif" font-size="14.00">gpu15_expert</text>
<text text-anchor="middle" x="5932.5" y="-356.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="5932.5" y="-341.75" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="5932.5" y="-326.75" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- dispatch&#45;&gt;gpu15_expert -->
<g id="edge86" class="edge">
<title>dispatch&#45;&gt;gpu15_expert</title>
<path fill="none" stroke="black" d="M3640.73,-456.57C4152.2,-449.77 5329.09,-430 5750.03,-387.04"/>
<polygon fill="black" stroke="black" points="5750.56,-390.5 5760.14,-385.99 5749.83,-383.54 5750.56,-390.5"/>
</g>
<!-- combine -->
<g id="node57" class="node">
<title>combine</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3398.5" cy="-245.48" rx="263.5" ry="37.45"/>
<text text-anchor="middle" x="3398.5" y="-256.78" font-family="Times,serif" font-size="14.00">combine</text>
<text text-anchor="middle" x="3398.5" y="-241.78" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024 (x16)</text>
<text text-anchor="middle" x="3398.5" y="-226.78" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- gpu0_expert&#45;&gt;combine -->
<g id="edge87" class="edge">
<title>gpu0_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M674.86,-319.9C677.76,-319.57 680.64,-319.25 683.5,-318.95 1150.41,-270.45 2533.38,-253.55 3125.01,-248.44"/>
<polygon fill="black" stroke="black" points="3125.42,-251.93 3135.39,-248.35 3125.36,-244.93 3125.42,-251.93"/>
</g>
<!-- gpu1_expert&#45;&gt;combine -->
<g id="edge88" class="edge">
<title>gpu1_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M1036.86,-319.92C1039.76,-319.58 1042.64,-319.26 1045.5,-318.95 1441.08,-277.04 2595.59,-256.96 3126.12,-249.75"/>
<polygon fill="black" stroke="black" points="3126.26,-253.24 3136.21,-249.61 3126.16,-246.25 3126.26,-253.24"/>
</g>
<!-- gpu2_expert&#45;&gt;combine -->
<g id="edge89" class="edge">
<title>gpu2_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M1398.86,-319.94C1401.76,-319.59 1404.64,-319.26 1407.5,-318.95 1732.41,-283.61 2662.61,-260.95 3127.38,-251.51"/>
<polygon fill="black" stroke="black" points="3127.67,-255.01 3137.6,-251.3 3127.53,-248.01 3127.67,-255.01"/>
</g>
<!-- gpu3_expert&#45;&gt;combine -->
<g id="edge90" class="edge">
<title>gpu3_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M1760.87,-319.97C1763.76,-319.62 1766.64,-319.28 1769.5,-318.95 2244.03,-265.39 2800.51,-250.95 3124.89,-247.33"/>
<polygon fill="black" stroke="black" points="3124.94,-250.83 3134.9,-247.22 3124.86,-243.83 3124.94,-250.83"/>
</g>
<!-- gpu4_expert&#45;&gt;combine -->
<g id="edge91" class="edge">
<title>gpu4_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M2122.87,-320.02C2125.77,-319.65 2128.65,-319.29 2131.5,-318.95 2473.95,-278.1 2871.32,-260.11 3128.42,-252.3"/>
<polygon fill="black" stroke="black" points="3128.75,-255.79 3138.64,-251.99 3128.54,-248.79 3128.75,-255.79"/>
</g>
<!-- gpu5_expert&#45;&gt;combine -->
<g id="edge92" class="edge">
<title>gpu5_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M2484.88,-320.11C2487.78,-319.71 2490.65,-319.33 2493.5,-318.95 2711.89,-290.37 2961.5,-271.4 3143.18,-260.06"/>
<polygon fill="black" stroke="black" points="3143.65,-263.54 3153.41,-259.43 3143.22,-256.55 3143.65,-263.54"/>
</g>
<!-- gpu6_expert&#45;&gt;combine -->
<g id="edge93" class="edge">
<title>gpu6_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M2846.91,-320.32C2849.8,-319.86 2852.66,-319.4 2855.5,-318.95 2966.19,-301.49 3090.02,-284.74 3191.44,-271.76"/>
<polygon fill="black" stroke="black" points="3192.02,-275.21 3201.5,-270.48 3191.13,-268.27 3192.02,-275.21"/>
</g>
<!-- gpu7_expert&#45;&gt;combine -->
<g id="edge94" class="edge">
<title>gpu7_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M3150.05,-318.87C3190.07,-307.21 3235.23,-294.05 3275.96,-282.18"/>
<polygon fill="black" stroke="black" points="3277.05,-285.51 3285.67,-279.35 3275.09,-278.79 3277.05,-285.51"/>
</g>
<!-- gpu8_expert&#45;&gt;combine -->
<g id="edge95" class="edge">
<title>gpu8_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M3398.5,-318.87C3398.5,-310.71 3398.5,-301.81 3398.5,-293.13"/>
<polygon fill="black" stroke="black" points="3402,-293.11 3398.5,-283.11 3395,-293.11 3402,-293.11"/>
</g>
<!-- gpu9_expert&#45;&gt;combine -->
<g id="edge96" class="edge">
<title>gpu9_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M3646.95,-318.87C3606.93,-307.21 3561.77,-294.05 3521.04,-282.18"/>
<polygon fill="black" stroke="black" points="3521.91,-278.79 3511.33,-279.35 3519.95,-285.51 3521.91,-278.79"/>
</g>
<!-- gpu10_expert&#45;&gt;combine -->
<g id="edge97" class="edge">
<title>gpu10_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M3950.09,-320.32C3947.2,-319.86 3944.34,-319.4 3941.5,-318.95 3830.81,-301.49 3706.98,-284.74 3605.56,-271.76"/>
<polygon fill="black" stroke="black" points="3605.87,-268.27 3595.5,-270.48 3604.98,-275.21 3605.87,-268.27"/>
</g>
<!-- gpu11_expert&#45;&gt;combine -->
<g id="edge98" class="edge">
<title>gpu11_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M4312.12,-320.11C4309.22,-319.71 4306.35,-319.33 4303.5,-318.95 4085.11,-290.37 3835.5,-271.4 3653.82,-260.06"/>
<polygon fill="black" stroke="black" points="3653.78,-256.55 3643.59,-259.43 3653.35,-263.54 3653.78,-256.55"/>
</g>
<!-- gpu12_expert&#45;&gt;combine -->
<g id="edge99" class="edge">
<title>gpu12_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M4674.13,-320.02C4671.23,-319.65 4668.35,-319.29 4665.5,-318.95 4323.05,-278.1 3925.68,-260.11 3668.58,-252.3"/>
<polygon fill="black" stroke="black" points="3668.46,-248.79 3658.36,-251.99 3668.25,-255.79 3668.46,-248.79"/>
</g>
<!-- gpu13_expert&#45;&gt;combine -->
<g id="edge100" class="edge">
<title>gpu13_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M5036.13,-319.97C5033.24,-319.62 5030.36,-319.28 5027.5,-318.95 4552.97,-265.39 3996.49,-250.95 3672.11,-247.33"/>
<polygon fill="black" stroke="black" points="3672.14,-243.83 3662.1,-247.22 3672.06,-250.83 3672.14,-243.83"/>
</g>
<!-- gpu14_expert&#45;&gt;combine -->
<g id="edge101" class="edge">
<title>gpu14_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M5398.14,-319.94C5395.24,-319.59 5392.36,-319.26 5389.5,-318.95 5064.59,-283.61 4134.39,-260.95 3669.62,-251.51"/>
<polygon fill="black" stroke="black" points="3669.47,-248.01 3659.4,-251.3 3669.33,-255.01 3669.47,-248.01"/>
</g>
<!-- gpu15_expert&#45;&gt;combine -->
<g id="edge102" class="edge">
<title>gpu15_expert&#45;&gt;combine</title>
<path fill="none" stroke="black" d="M5760.14,-319.92C5757.24,-319.58 5754.36,-319.26 5751.5,-318.95 5355.92,-277.04 4201.41,-256.96 3670.88,-249.75"/>
<polygon fill="black" stroke="black" points="3670.84,-246.25 3660.79,-249.61 3670.74,-253.24 3670.84,-246.25"/>
</g>
<!-- combine&#45;&gt;resid2 -->
<g id="edge104" class="edge">
<title>combine&#45;&gt;resid2</title>
<path fill="none" stroke="black" d="M3627.31,-226.82C3896.06,-206.09 4336.47,-172.1 4583.25,-153.06"/>
<polygon fill="black" stroke="black" points="4583.7,-156.54 4593.4,-152.28 4583.16,-149.56 4583.7,-156.54"/>
</g>
<!-- OUTPUT -->
<g id="node59" class="node">
<title>OUTPUT</title>
<polygon fill="none" stroke="black" points="4937.5,-68 4593.5,-68 4593.5,0 4937.5,0 4937.5,-68"/>
<text text-anchor="middle" x="4765.5" y="-52.8" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="4765.5" y="-37.8" font-family="Times,serif" font-size="14.00">GPU: all</text>
<text text-anchor="middle" x="4765.5" y="-22.8" font-family="Times,serif" font-size="14.00">In: batch_size, seq_len=128, d_model=1024</text>
<text text-anchor="middle" x="4765.5" y="-7.8" font-family="Times,serif" font-size="14.00">Out: batch_size, seq_len=128, d_model=1024</text>
</g>
<!-- resid2&#45;&gt;OUTPUT -->
<g id="edge105" class="edge">
<title>resid2&#45;&gt;OUTPUT</title>
<path fill="none" stroke="black" d="M4765.5,-103.88C4765.5,-95.78 4765.5,-86.98 4765.5,-78.47"/>
<polygon fill="black" stroke="black" points="4769,-78.3 4765.5,-68.3 4762,-78.3 4769,-78.3"/>
</g>
</g>
</svg>
