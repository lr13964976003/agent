digraph proposed_moe {
	graph [bb="0,0,6740.3,16913",
		rankdir=TB,
		size="20,25"
	];
	node [label="\N"];
	subgraph cluster_layer_1 {
		graph [bb="928,15669,6718,16697",
			label="Layer 1 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3823,16686",
			lwidth=3.29,
			style=dashed
		];
		dist_l1	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 1\nAll GPUs\n[128,10000,4096]",
			pos="4004,16618",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l1_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1393,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu0	[pos="e,1476,16506 3902.2,16617 3581.5,16614 2564.2,16601 1725,16534 1644.1,16528 1552.5,16516 1486.1,16507"];
		mha_l1_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1817,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu1	[pos="e,1900.4,16504 3902,16615 3628.5,16607 2856.1,16582 2215,16534 2110.5,16527 1991.1,16514 1910.5,16505"];
		mha_l1_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2307,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu2	[pos="e,2390,16510 3902,16615 3664.6,16610 3056.7,16590 2552,16534 2501.5,16529 2445.6,16520 2399.9,16512"];
		mha_l1_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2644,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu3	[pos="e,2727.2,16517 3902.1,16616 3695.4,16612 3212.3,16596 2812,16534 2787.5,16531 2761.3,16525 2737.1,16519"];
		mha_l1_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2904,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu4	[pos="e,2987.2,16523 3902.1,16616 3724.3,16612 3346.4,16596 3034,16534 3021.9,16532 3009.4,16529 2997.1,16525"];
		mha_l1_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3126,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu5	[pos="e,3209,16510 3905.2,16606 3777.3,16592 3547.6,16564 3352,16534 3308.1,16528 3259.7,16519 3218.9,16512"];
		mha_l1_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3444,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu6	[pos="e,3527.3,16512 3912.5,16597 3809,16574 3641.4,16537 3537.2,16514"];
		mha_l1_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3743,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu7	[pos="e,3826.5,16533 3933,16584 3903.1,16570 3867.8,16553 3835.8,16538"];
		mha_l1_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu8	[pos="e,4004,16534 4004,16570 4004,16562 4004,16553 4004,16545"];
		mha_l1_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4264,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu9	[pos="e,4180.9,16533 4074.7,16584 4104.5,16570 4139.7,16553 4171.5,16538"];
		mha_l1_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4594,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu10	[pos="e,4510.7,16511 4096.5,16598 4206.9,16575 4390.2,16537 4500.8,16513"];
		mha_l1_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4912,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu11	[pos="e,4828.7,16510 4103.1,16607 4236,16593 4479.3,16565 4686,16534 4729.8,16528 4778.1,16519 4818.8,16512"];
		mha_l1_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5239,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu12	[pos="e,5155.8,16510 4105.1,16612 4285.9,16602 4676.5,16576 5004,16534 5051,16528 5102.9,16520 5145.9,16512"];
		mha_l1_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5571,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu13	[pos="e,5487.7,16510 4105.9,16615 4328.7,16608 4875.8,16587 5331,16534 5379.7,16529 5433.5,16520 5477.8,16512"];
		mha_l1_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5981,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu14	[pos="e,5897.8,16506 4105.7,16615 4365.4,16608 5074.5,16586 5663,16534 5738.9,16528 5824.6,16516 5887.9,16508"];
		mha_l1_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 1\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6299,16493",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l1 -> mha_l1_gpu15	[pos="e,6215.9,16512 4105.8,16615 4466.8,16607 5685,16577 6073,16534 6117,16530 6165.4,16521 6206.1,16513"];
		gate_l1_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1287,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu0 -> gate_l1_gpu0	[pos="e,1342,16416 1365.7,16451 1360.1,16443 1353.9,16433 1347.6,16424"];
		gate_l1_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1635,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu1 -> gate_l1_gpu1	[pos="e,1729.5,16416 1770.1,16451 1759.8,16442 1748.6,16432 1737.1,16422"];
		gate_l1_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1977,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu2 -> gate_l1_gpu2	[pos="e,2134.5,16409 2223.7,16452 2199.2,16440 2171.4,16427 2143.6,16413"];
		gate_l1_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2317,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu3 -> gate_l1_gpu3	[pos="e,2474.9,16410 2560.8,16452 2536.6,16440 2510.3,16427 2486,16415 2485.3,16415 2484.6,16415 2483.9,16414"];
		gate_l1_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2655,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu4 -> gate_l1_gpu4	[pos="e,2784,16415 2840.2,16451 2825.5,16442 2809.3,16432 2792.7,16421"];
		gate_l1_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2993,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu5 -> gate_l1_gpu5	[pos="e,3062,16416 3091.7,16451 3084.5,16442 3076.6,16433 3068.5,16423"];
		gate_l1_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3330,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu6 -> gate_l1_gpu6	[pos="e,3389.2,16416 3414.6,16451 3408.6,16443 3401.9,16433 3395.2,16424"];
		gate_l1_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3667,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu7 -> gate_l1_gpu7	[pos="e,3706.4,16416 3723.4,16451 3719.5,16443 3715.2,16434 3710.9,16425"];
		gate_l1_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4004,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu8 -> gate_l1_gpu8	[pos="e,4004,16416 4004,16451 4004,16443 4004,16434 4004,16426"];
		gate_l1_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4353,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu9 -> gate_l1_gpu9	[pos="e,4306.8,16416 4286.9,16451 4291.6,16443 4296.6,16434 4301.8,16425"];
		gate_l1_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4709,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu10 -> gate_l1_gpu10	[pos="e,4649.3,16416 4623.6,16451 4629.7,16443 4636.4,16433 4643.3,16424"];
		gate_l1_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5068,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu11 -> gate_l1_gpu11	[pos="e,4987,16416 4952.2,16451 4960.8,16442 4970.3,16433 4980,16423"];
		gate_l1_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5428,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu12 -> gate_l1_gpu12	[pos="e,5332.5,16413 5287.7,16451 5299.1,16441 5311.7,16431 5324.5,16420"];
		gate_l1_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5789,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu13 -> gate_l1_gpu13	[pos="e,5690.1,16405 5626.9,16451 5643.7,16439 5662.9,16425 5682,16411"];
		gate_l1_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6139,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu14 -> gate_l1_gpu14	[pos="e,6057,16416 6021.7,16451 6030.4,16442 6040,16433 6049.8,16423"];
		gate_l1_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 1\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6501,16332",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l1_gpu15 -> gate_l1_gpu15	[pos="e,6403.8,16410 6350.8,16451 6364.6,16440 6380.1,16428 6395.7,16416"];
		expert_l1_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 1\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1287,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu0 -> expert_l1_gpu0	[pos="e,1287,16214 1287,16249 1287,16241 1287,16232 1287,16224",
			style=dashed];
		expert_l1_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 1\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1553,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu1 -> expert_l1_gpu1	[pos="e,1574.1,16214 1592.6,16249 1587.9,16240 1583.2,16231 1578.8,16223",
			style=dashed];
		expert_l1_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 1\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1904,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu2 -> expert_l1_gpu2	[pos="e,1922.8,16214 1939.2,16249 1935.1,16240 1930.9,16231 1927.1,16223",
			style=dashed];
		expert_l1_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 1\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2255,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu3 -> expert_l1_gpu3	[pos="e,2271,16214 2284.9,16249 2281.4,16240 2278,16232 2274.7,16223",
			style=dashed];
		expert_l1_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 1\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2605,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu4 -> expert_l1_gpu4	[pos="e,2617.9,16214 2629.1,16249 2626.3,16240 2623.5,16232 2620.9,16223",
			style=dashed];
		expert_l1_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 1\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2955,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu5 -> expert_l1_gpu5	[pos="e,2964.8,16214 2973.3,16249 2971.2,16240 2969.1,16232 2967.1,16223",
			style=dashed];
		expert_l1_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 1\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3305,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu6 -> expert_l1_gpu6	[pos="e,3311.4,16214 3317.1,16249 3315.7,16241 3314.3,16232 3313,16224",
			style=dashed];
		expert_l1_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 1\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3655,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu7 -> expert_l1_gpu7	[pos="e,3658.1,16214 3660.8,16249 3660.1,16241 3659.5,16232 3658.9,16224",
			style=dashed];
		expert_l1_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 1\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu8 -> expert_l1_gpu8	[pos="e,4004,16214 4004,16249 4004,16241 4004,16232 4004,16224",
			style=dashed];
		expert_l1_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 1\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4359,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu9 -> expert_l1_gpu9	[pos="e,4357.5,16214 4356.1,16249 4356.4,16241 4356.8,16232 4357.1,16224",
			style=dashed];
		expert_l1_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 1\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4718,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu10 -> expert_l1_gpu10	[pos="e,4715.7,16214 4713.7,16249 4714.2,16241 4714.6,16232 4715.1,16224",
			style=dashed];
		expert_l1_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 1\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5079,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu11 -> expert_l1_gpu11	[pos="e,5076.2,16214 5073.7,16249 5074.3,16241 5074.9,16232 5075.5,16224",
			style=dashed];
		expert_l1_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 1\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5440,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu12 -> expert_l1_gpu12	[pos="e,5436.9,16214 5434.2,16249 5434.9,16241 5435.5,16232 5436.1,16224",
			style=dashed];
		expert_l1_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 1\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5801,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu13 -> expert_l1_gpu13	[pos="e,5797.9,16214 5795.2,16249 5795.9,16241 5796.5,16232 5797.1,16224",
			style=dashed];
		expert_l1_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 1\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6151,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu14 -> expert_l1_gpu14	[pos="e,6147.9,16214 6145.2,16249 6145.9,16241 6146.5,16232 6147.1,16224",
			style=dashed];
		expert_l1_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 1\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6513,16172",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l1_gpu15 -> expert_l1_gpu15	[pos="e,6509.9,16214 6507.2,16249 6507.9,16241 6508.5,16232 6509.1,16224",
			style=dashed];
		agg_l1_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu0 -> agg_l1_gpu0	[pos="e,1200.9,16095 1240.9,16130 1230.9,16121 1219.9,16111 1208.7,16102"];
		agg_l1_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1470,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu1 -> agg_l1_gpu1	[pos="e,1513.1,16095 1531.6,16130 1527.3,16122 1522.6,16113 1517.7,16104"];
		agg_l1_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1832,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu2 -> agg_l1_gpu2	[pos="e,1869.4,16095 1885.5,16130 1881.7,16122 1877.7,16113 1873.5,16104"];
		agg_l1_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2194,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu3 -> agg_l1_gpu3	[pos="e,2225.7,16095 2239.3,16130 2236.2,16122 2232.8,16113 2229.3,16104"];
		agg_l1_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2556,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu4 -> agg_l1_gpu4	[pos="e,2581.4,16095 2592.4,16130 2589.9,16122 2587.2,16113 2584.5,16104"];
		agg_l1_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2918,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu5 -> agg_l1_gpu5	[pos="e,2937.2,16095 2945.5,16130 2943.6,16122 2941.6,16113 2939.5,16104"];
		agg_l1_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3280,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu6 -> agg_l1_gpu6	[pos="e,3293,16095 3298.6,16130 3297.3,16122 3296,16113 3294.6,16105"];
		agg_l1_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3642,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu7 -> agg_l1_gpu7	[pos="e,3648.7,16095 3651.7,16130 3651,16122 3650.3,16113 3649.6,16105"];
		agg_l1_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu8 -> agg_l1_gpu8	[pos="e,4004,16095 4004,16130 4004,16122 4004,16113 4004,16105"];
		agg_l1_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4366,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu9 -> agg_l1_gpu9	[pos="e,4362.4,16095 4360.8,16130 4361.2,16122 4361.5,16113 4361.9,16105"];
		agg_l1_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4728,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu10 -> agg_l1_gpu10	[pos="e,4722.8,16095 4720.6,16130 4721.1,16122 4721.6,16113 4722.2,16105"];
		agg_l1_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5090,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu11 -> agg_l1_gpu11	[pos="e,5084.3,16095 5081.8,16130 5082.4,16122 5083,16113 5083.6,16105"];
		agg_l1_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5452,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu12 -> agg_l1_gpu12	[pos="e,5445.8,16095 5443.1,16130 5443.7,16122 5444.3,16113 5445,16105"];
		agg_l1_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5814,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu13 -> agg_l1_gpu13	[pos="e,5807.3,16095 5804.3,16130 5805,16122 5805.7,16113 5806.4,16105"];
		agg_l1_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6176,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu14 -> agg_l1_gpu14	[pos="e,6163,16095 6157.4,16130 6158.7,16122 6160,16113 6161.4,16105"];
		agg_l1_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 1\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6538,16011",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l1_gpu15 -> agg_l1_gpu15	[pos="e,6525,16095 6519.4,16130 6520.7,16122 6522,16113 6523.4,16105"];
		global_agg_l1	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 1\nAll GPUs\n[128,10000,4096]",
			pos="4004,15844",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l1_gpu0 -> global_agg_l1	[pos="e,3894.3,15846 1220,15951 1242.3,15942 1266,15934 1289,15928 1543.5,15869 3391.9,15850 3883.9,15846"];
		agg_l1_gpu1 -> global_agg_l1	[pos="e,3894.2,15847 1582,15951 1604.3,15942 1628,15934 1651,15928 1868.8,15877 3435.3,15853 3884.1,15847"];
		agg_l1_gpu2 -> global_agg_l1	[pos="e,3894.5,15847 1944.1,15952 1966.4,15942 1990,15934 2013,15928 2194.4,15885 3482.2,15856 3884.3,15848"];
		agg_l1_gpu3 -> global_agg_l1	[pos="e,3894.2,15846 2306.1,15952 2328.4,15942 2352,15934 2375,15928 2661.2,15859 3557.6,15847 3883.8,15846"];
		agg_l1_gpu4 -> global_agg_l1	[pos="e,3894.4,15847 2668.2,15952 2690.5,15943 2714.1,15934 2737,15928 2952.1,15874 3611.5,15854 3884.1,15848"];
		agg_l1_gpu5 -> global_agg_l1	[pos="e,3895.3,15851 3030.3,15953 3052.6,15943 3076.2,15934 3099,15928 3244.3,15890 3674.5,15863 3885.1,15851"];
		agg_l1_gpu6 -> global_agg_l1	[pos="e,3896,15853 3392.6,15954 3414.9,15944 3438.3,15935 3461,15928 3603.7,15886 3774.3,15864 3885.7,15854"];
		agg_l1_gpu7 -> global_agg_l1	[pos="e,3929,15879 3756.5,15958 3809.5,15934 3871.2,15906 3919.8,15884"];
		agg_l1_gpu8 -> global_agg_l1	[pos="e,4004,15892 4004,15928 4004,15920 4004,15911 4004,15903"];
		agg_l1_gpu9 -> global_agg_l1	[pos="e,4079.1,15880 4195.6,15933 4158.4,15916 4120.6,15898 4088.5,15884"];
		agg_l1_gpu10 -> global_agg_l1	[pos="e,4112,15853 4557,15931 4553.6,15930 4550.3,15929 4547,15928 4404.3,15886 4233.7,15864 4122.3,15854"];
		agg_l1_gpu11 -> global_agg_l1	[pos="e,4112.7,15851 4918.8,15931 4915.5,15930 4912.3,15929 4909,15928 4763.7,15890 4333.5,15863 4122.9,15851"];
		agg_l1_gpu12 -> global_agg_l1	[pos="e,4113.6,15847 5280.8,15931 5277.5,15930 5274.3,15929 5271,15928 5055.9,15874 4396.5,15854 4123.9,15848"];
		agg_l1_gpu13 -> global_agg_l1	[pos="e,4113.8,15846 5642.8,15931 5639.6,15930 5636.3,15929 5633,15928 5346.8,15859 4450.4,15847 4124.2,15846"];
		agg_l1_gpu14 -> global_agg_l1	[pos="e,4113.5,15847 6004.9,15931 6001.6,15930 5998.3,15929 5995,15928 5813.6,15885 4525.8,15856 4123.7,15848"];
		agg_l1_gpu15 -> global_agg_l1	[pos="e,4113.8,15847 6366.6,15931 6363.4,15930 6360.2,15929 6357,15928 6139.2,15877 4572.7,15853 4123.9,15847"];
		residual_l1	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 1\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="5306,15719",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l1 -> residual_l1	[pos="e,5204.4,15729 4110.8,15833 4353.9,15810 4946.5,15754 5194.3,15730"];
	}
	subgraph cluster_layer_2 {
		graph [bb="416,14633,6206,15661",
			label="Layer 2 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3311,15650",
			lwidth=3.29,
			style=dashed
		];
		dist_l2	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 2\nAll GPUs\n[128,10000,4096]",
			pos="3492,15582",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l2_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="745,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu0	[pos="e,828.35,15467 3390.1,15580 3065.4,15575 2025.1,15555 1166,15498 1053.2,15491 923.75,15477 838.52,15468"];
		mha_l2_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1258,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu1	[pos="e,1341,15473 3390.1,15581 3097.6,15580 2230.5,15569 1515,15498 1460.3,15493 1399.6,15483 1350.9,15475"];
		mha_l2_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1607,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu2	[pos="e,1690.1,15481 3390.4,15579 3071.1,15571 2089.9,15543 1775,15498 1750.5,15494 1724.3,15489 1700,15483"];
		mha_l2_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1867,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu3	[pos="e,1950.1,15475 3390.1,15579 3158.5,15574 2575.2,15556 2091,15498 2047.8,15493 2000.3,15485 1960.2,15477"];
		mha_l2_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2183,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu4	[pos="e,2266.1,15466 3392.2,15572 3224.6,15558 2875.8,15526 2581,15498 2476.6,15488 2356.8,15476 2276.2,15467"];
		mha_l2_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2673,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu5	[pos="e,2756.3,15472 3394.7,15568 3280.4,15552 3085.3,15524 2918,15498 2867.8,15490 2811.9,15481 2766.2,15473"];
		mha_l2_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3010,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu6	[pos="e,3093.3,15479 3403.3,15558 3318.1,15536 3189.8,15504 3103.1,15481"];
		mha_l2_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3270,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu7	[pos="e,3342.9,15498 3426.9,15545 3403.4,15532 3376.6,15517 3351.9,15503"];
		mha_l2_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3492,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu8	[pos="e,3492,15498 3492,15534 3492,15525 3492,15517 3492,15508"];
		mha_l2_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3752,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu9	[pos="e,3668.9,15497 3562.7,15547 3592.5,15533 3627.7,15517 3659.5,15501"];
		mha_l2_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4048,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu10	[pos="e,3964.6,15476 3583.5,15561 3686.1,15538 3851.5,15501 3954.8,15478"];
		mha_l2_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4401,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu11	[pos="e,4317.9,15471 3590.4,15569 3717.4,15554 3945.4,15526 4140,15498 4195.7,15490 4258.1,15480 4307.8,15473"];
		mha_l2_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4758,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu12	[pos="e,4674.9,15472 3592.8,15575 3773.5,15564 4164.6,15537 4493,15498 4550.3,15491 4614.3,15482 4665,15473"];
		mha_l2_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5117,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu13	[pos="e,5034,15472 3593.6,15578 3819.9,15570 4382,15548 4850,15498 4908,15492 4972.7,15482 5023.9,15474"];
		mha_l2_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5478,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu14	[pos="e,5395,15472 3593.9,15580 3860,15575 4598,15559 5209,15498 5267.7,15492 5333.2,15482 5384.8,15474"];
		mha_l2_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 2\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5769,15456",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l2 -> mha_l2_gpu15	[pos="e,5685.7,15478 3593.7,15579 3955.6,15572 5180.6,15545 5570,15498 5604.7,15494 5642.4,15487 5675.6,15480"];
		gate_l2_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="608,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu0 -> gate_l2_gpu0	[pos="e,679.11,15379 709.72,15415 702.27,15406 694.14,15397 685.82,15387"];
		gate_l2_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="979,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu1 -> gate_l2_gpu1	[pos="e,1123.6,15379 1186.5,15415 1169.7,15405 1151.2,15395 1132.3,15384"];
		gate_l2_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1323,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu2 -> gate_l2_gpu2	[pos="e,1470.2,15379 1534.2,15415 1517.1,15405 1498.3,15395 1479,15384"];
		gate_l2_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1735,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu3 -> gate_l2_gpu3	[pos="e,1803.5,15379 1833,15415 1825.8,15406 1818,15397 1810,15387"];
		gate_l2_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2109,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu4 -> gate_l2_gpu4	[pos="e,2147.4,15379 2163.9,15415 2160.1,15406 2156,15398 2151.7,15388"];
		gate_l2_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2465,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu5 -> gate_l2_gpu5	[pos="e,2572.8,15379 2619.7,15415 2607.6,15406 2594.3,15396 2580.8,15385"];
		gate_l2_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2811,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu6 -> gate_l2_gpu6	[pos="e,2914.1,15379 2959,15415 2947.6,15406 2935,15396 2922.2,15386"];
		gate_l2_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3153,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu7 -> gate_l2_gpu7	[pos="e,3213.7,15379 3239.9,15415 3233.6,15406 3226.8,15397 3219.9,15388"];
		gate_l2_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3492,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu8 -> gate_l2_gpu8	[pos="e,3492,15379 3492,15415 3492,15407 3492,15398 3492,15389"];
		gate_l2_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3841,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu9 -> gate_l2_gpu9	[pos="e,3794.8,15379 3774.9,15415 3779.6,15406 3784.6,15397 3789.8,15388"];
		gate_l2_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4188,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu10 -> gate_l2_gpu10	[pos="e,4115.3,15379 4084.1,15415 4091.7,15406 4100,15397 4108.5,15387"];
		gate_l2_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4547,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu11 -> gate_l2_gpu11	[pos="e,4471.2,15379 4438.6,15415 4446.6,15406 4455.4,15396 4464.3,15387"];
		gate_l2_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4907,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu12 -> gate_l2_gpu12	[pos="e,4829.7,15379 4796.4,15415 4804.5,15406 4813.5,15396 4822.6,15387"];
		gate_l2_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5268,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu13 -> gate_l2_gpu13	[pos="e,5189.6,15379 5155.9,15415 5164.2,15406 5173.2,15396 5182.5,15387"];
		gate_l2_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5630,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu14 -> gate_l2_gpu14	[pos="e,5551.1,15379 5517.1,15415 5525.5,15406 5534.6,15396 5543.9,15387"];
		gate_l2_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 2\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5984,15296",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l2_gpu15 -> gate_l2_gpu15	[pos="e,5885.6,15370 5824.1,15415 5840.4,15403 5858.8,15389 5877.2,15376"];
		expert_l2_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 2\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="600,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu0 -> expert_l2_gpu0	[pos="e,602.06,15177 603.86,15213 603.42,15204 602.98,15196 602.57,15187",
			style=dashed];
		expert_l2_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 2\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="965,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu1 -> expert_l2_gpu1	[pos="e,968.6,15177 971.75,15213 970.98,15204 970.22,15196 969.49,15187",
			style=dashed];
		expert_l2_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 2\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1322,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu2 -> expert_l2_gpu2	[pos="e,1322.3,15177 1322.5,15213 1322.4,15204 1322.4,15196 1322.3,15187",
			style=dashed];
		expert_l2_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 2\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1708,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu3 -> expert_l2_gpu3	[pos="e,1714.9,15177 1721,15213 1719.5,15204 1718.1,15196 1716.7,15187",
			style=dashed];
		expert_l2_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 2\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2076,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu4 -> expert_l2_gpu4	[pos="e,2084.5,15177 2091.9,15213 2090.1,15204 2088.3,15195 2086.5,15187",
			style=dashed];
		expert_l2_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 2\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2435,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu5 -> expert_l2_gpu5	[pos="e,2442.7,15177 2449.5,15213 2447.8,15204 2446.1,15195 2444.6,15187",
			style=dashed];
		expert_l2_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 2\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2789,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu6 -> expert_l2_gpu6	[pos="e,2794.7,15177 2799.6,15213 2798.4,15204 2797.2,15196 2796.1,15187",
			style=dashed];
		expert_l2_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 2\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3141,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu7 -> expert_l2_gpu7	[pos="e,3144.1,15177 3146.8,15213 3146.1,15204 3145.5,15196 3144.9,15187",
			style=dashed];
		expert_l2_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 2\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3492,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu8 -> expert_l2_gpu8	[pos="e,3492,15177 3492,15213 3492,15204 3492,15196 3492,15187",
			style=dashed];
		expert_l2_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 2\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3848,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu9 -> expert_l2_gpu9	[pos="e,3846.2,15177 3844.6,15213 3845,15204 3845.4,15196 3845.8,15187",
			style=dashed];
		expert_l2_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 2\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4207,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu10 -> expert_l2_gpu10	[pos="e,4202.1,15177 4197.8,15213 4198.9,15204 4199.9,15196 4200.9,15187",
			style=dashed];
		expert_l2_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 2\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4562,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu11 -> expert_l2_gpu11	[pos="e,4558.1,15177 4554.8,15213 4555.6,15204 4556.4,15196 4557.2,15187",
			style=dashed];
		expert_l2_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 2\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4923,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu12 -> expert_l2_gpu12	[pos="e,4918.9,15177 4915.3,15213 4916.2,15204 4917,15196 4917.9,15187",
			style=dashed];
		expert_l2_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 2\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5285,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu13 -> expert_l2_gpu13	[pos="e,5280.6,15177 5276.8,15213 5277.7,15204 5278.7,15196 5279.5,15187",
			style=dashed];
		expert_l2_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 2\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5647,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu14 -> expert_l2_gpu14	[pos="e,5642.6,15177 5638.8,15213 5639.7,15204 5640.7,15196 5641.5,15187",
			style=dashed];
		expert_l2_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 2\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6001,15135",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l2_gpu15 -> expert_l2_gpu15	[pos="e,5996.6,15177 5992.8,15213 5993.7,15204 5994.7,15196 5995.5,15187",
			style=dashed];
		agg_l2_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="596,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu0 -> agg_l2_gpu0	[pos="e,598.08,15058 598.97,15094 598.77,15086 598.55,15077 598.33,15068"];
		agg_l2_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="958,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu1 -> agg_l2_gpu1	[pos="e,961.63,15058 963.2,15094 962.85,15086 962.47,15077 962.08,15068"];
		agg_l2_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1320,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu2 -> agg_l2_gpu2	[pos="e,1321,15058 1321.5,15094 1321.4,15086 1321.3,15077 1321.2,15068"];
		agg_l2_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1682,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu3 -> agg_l2_gpu3	[pos="e,1695.5,15058 1701.3,15094 1700,15086 1698.6,15077 1697.1,15068"];
		agg_l2_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2044,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu4 -> agg_l2_gpu4	[pos="e,2060.6,15058 2067.8,15094 2066.2,15086 2064.4,15077 2062.6,15068"];
		agg_l2_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2406,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu5 -> agg_l2_gpu5	[pos="e,2421.1,15058 2427.5,15094 2426.1,15086 2424.5,15077 2422.9,15068"];
		agg_l2_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2768,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu6 -> agg_l2_gpu6	[pos="e,2778.9,15058 2783.6,15094 2782.5,15086 2781.4,15077 2780.2,15068"];
		agg_l2_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3130,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu7 -> agg_l2_gpu7	[pos="e,3135.7,15058 3138.2,15094 3137.6,15086 3137,15077 3136.4,15068"];
		agg_l2_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3492,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu8 -> agg_l2_gpu8	[pos="e,3492,15058 3492,15094 3492,15086 3492,15077 3492,15068"];
		agg_l2_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3854,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu9 -> agg_l2_gpu9	[pos="e,3850.9,15058 3849.5,15094 3849.8,15086 3850.2,15077 3850.5,15068"];
		agg_l2_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4216,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu10 -> agg_l2_gpu10	[pos="e,4211.3,15058 4209.3,15094 4209.8,15086 4210.3,15077 4210.8,15068"];
		agg_l2_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4578,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu11 -> agg_l2_gpu11	[pos="e,4569.7,15058 4566.1,15094 4566.9,15086 4567.8,15077 4568.7,15068"];
		agg_l2_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4940,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu12 -> agg_l2_gpu12	[pos="e,4931.2,15058 4927.4,15094 4928.2,15086 4929.2,15077 4930.1,15068"];
		agg_l2_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5302,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu13 -> agg_l2_gpu13	[pos="e,5293.2,15058 5289.4,15094 5290.2,15086 5291.2,15077 5292.1,15068"];
		agg_l2_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5664,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu14 -> agg_l2_gpu14	[pos="e,5655.2,15058 5651.4,15094 5652.2,15086 5653.2,15077 5654.1,15068"];
		agg_l2_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 2\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6026,14975",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l2_gpu15 -> agg_l2_gpu15	[pos="e,6013,15058 6007.4,15094 6008.7,15086 6010,15077 6011.4,15068"];
		global_agg_l2	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 2\nAll GPUs\n[128,10000,4096]",
			pos="3492,14808",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l2_gpu0 -> global_agg_l2	[pos="e,3382.3,14810 708.01,14915 730.32,14906 753.98,14897 777,14892 1031.5,14833 2879.9,14814 3371.9,14810"];
		agg_l2_gpu1 -> global_agg_l2	[pos="e,3382.2,14810 1070,14915 1092.3,14906 1116,14897 1139,14892 1356.8,14841 2923.3,14816 3372.1,14810"];
		agg_l2_gpu2 -> global_agg_l2	[pos="e,3382.5,14811 1432.1,14915 1454.4,14906 1478,14897 1501,14892 1682.4,14849 2970.2,14819 3372.3,14811"];
		agg_l2_gpu3 -> global_agg_l2	[pos="e,3382.2,14809 1794.1,14915 1816.4,14906 1840,14898 1863,14892 2149.2,14823 3045.6,14811 3371.8,14809"];
		agg_l2_gpu4 -> global_agg_l2	[pos="e,3382.4,14811 2156.2,14916 2178.5,14906 2202.1,14898 2225,14892 2440.1,14838 3099.5,14818 3372.1,14811"];
		agg_l2_gpu5 -> global_agg_l2	[pos="e,3383.3,14814 2518.3,14916 2540.6,14907 2564.2,14898 2587,14892 2732.3,14854 3162.5,14826 3373.1,14815"];
		agg_l2_gpu6 -> global_agg_l2	[pos="e,3384,14817 2880.6,14917 2902.9,14908 2926.3,14899 2949,14892 3091.7,14850 3262.3,14828 3373.7,14818"];
		agg_l2_gpu7 -> global_agg_l2	[pos="e,3417,14843 3244.5,14922 3297.5,14898 3359.2,14869 3407.8,14847"];
		agg_l2_gpu8 -> global_agg_l2	[pos="e,3492,14856 3492,14892 3492,14883 3492,14875 3492,14866"];
		agg_l2_gpu9 -> global_agg_l2	[pos="e,3567.1,14843 3683.6,14896 3646.4,14879 3608.6,14862 3576.5,14847"];
		agg_l2_gpu10 -> global_agg_l2	[pos="e,3600,14817 4045,14895 4041.6,14894 4038.3,14893 4035,14892 3892.3,14850 3721.7,14828 3610.3,14818"];
		agg_l2_gpu11 -> global_agg_l2	[pos="e,3600.7,14814 4406.8,14895 4403.5,14894 4400.3,14893 4397,14892 4251.7,14854 3821.5,14826 3610.9,14815"];
		agg_l2_gpu12 -> global_agg_l2	[pos="e,3601.6,14811 4768.8,14895 4765.5,14894 4762.3,14893 4759,14892 4543.9,14838 3884.5,14818 3611.9,14811"];
		agg_l2_gpu13 -> global_agg_l2	[pos="e,3601.8,14809 5130.8,14895 5127.6,14894 5124.3,14893 5121,14892 4834.8,14823 3938.4,14811 3612.2,14809"];
		agg_l2_gpu14 -> global_agg_l2	[pos="e,3601.5,14811 5492.9,14895 5489.6,14894 5486.3,14893 5483,14892 5301.6,14849 4013.8,14819 3611.7,14811"];
		agg_l2_gpu15 -> global_agg_l2	[pos="e,3601.8,14810 5854.6,14894 5851.4,14894 5848.2,14893 5845,14892 5627.2,14841 4060.7,14816 3611.9,14810"];
		residual_l2	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 2\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3833,14682",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l2 -> residual_l2	[pos="e,3731.3,14720 3575.4,14777 3619.5,14761 3674.2,14741 3721.9,14724"];
	}
	subgraph cluster_layer_3 {
		graph [bb="74,13596,5864,14625",
			label="Layer 3 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="2969,14613",
			lwidth=3.29,
			style=dashed
		];
		dist_l3	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 3\nAll GPUs\n[128,10000,4096]",
			pos="3150,14546",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l3_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="364,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu0	[pos="e,447.09,14426 3048.4,14541 2747.6,14531 1835.3,14498 1079,14462 855.77,14451 593.52,14435 457.09,14427"];
		mha_l3_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1171,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu1	[pos="e,1254.3,14431 3048.5,14541 2797.9,14532 2129.9,14504 1574,14462 1467.8,14454 1346.1,14441 1264.5,14432"];
		mha_l3_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1666,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu2	[pos="e,1749.2,14437 3048.4,14541 2836.7,14533 2333.6,14510 1914,14462 1862.6,14456 1805.6,14447 1759.3,14439"];
		mha_l3_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2006,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu3	[pos="e,2089.4,14444 3048.4,14541 2870.6,14533 2491.8,14512 2176,14462 2150.9,14458 2124,14452 2099.1,14446"];
		mha_l3_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2268,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu4	[pos="e,2351.2,14449 3048.8,14540 2903.7,14531 2628.6,14509 2399,14462 2386.6,14459 2373.6,14456 2360.9,14452"];
		mha_l3_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2491,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu5	[pos="e,2574.1,14453 3050.3,14536 2939.6,14524 2756.1,14501 2602,14462 2596,14460 2589.9,14458 2583.7,14457"];
		mha_l3_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2694,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu6	[pos="e,2777.1,14455 3056.2,14527 2984.2,14512 2882.9,14489 2796,14462 2792.9,14461 2789.8,14460 2786.6,14459"];
		mha_l3_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2888,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu7	[pos="e,2971.3,14460 3078.8,14511 3048.5,14497 3013,14480 2980.7,14465"];
		mha_l3_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3150,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu8	[pos="e,3150,14462 3150,14497 3150,14489 3150,14480 3150,14472"];
		mha_l3_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3423,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu9	[pos="e,3339.6,14459 3222.4,14512 3255.5,14497 3295,14479 3330.3,14463"];
		mha_l3_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3722,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu10	[pos="e,3638.7,14439 3241.9,14525 3348.2,14502 3522.1,14464 3628.9,14441"];
		mha_l3_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4043,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu11	[pos="e,3960,14437 3248.9,14534 3378.9,14519 3614,14492 3814,14462 3858.8,14455 3908.4,14446 3949.9,14439"];
		mha_l3_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4372,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu12	[pos="e,4288.9,14437 3251,14539 3429.7,14528 3813.2,14503 4135,14462 4182.6,14456 4235.3,14447 4278.9,14439"];
		mha_l3_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4755,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu13	[pos="e,4671.8,14434 3251.6,14541 3472.6,14532 4013.1,14507 4464,14462 4530.3,14455 4604.7,14445 4661.7,14436"];
		mha_l3_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5098,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu14	[pos="e,5014.9,14437 3252.2,14544 3516.5,14540 4244.5,14525 4847,14462 4899.6,14456 4957.9,14447 5005,14439"];
		mha_l3_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 3\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5477,14420",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l3 -> mha_l3_gpu15	[pos="e,5393.7,14435 3251.9,14544 3550.3,14542 4448.5,14529 5190,14462 5255,14456 5327.8,14445 5383.8,14437"];
		gate_l3_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="282,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu0 -> gate_l3_gpu0	[pos="e,324.56,14343 342.88,14378 338.6,14370 333.94,14361 329.17,14352"];
		gate_l3_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="631,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu1 -> gate_l3_gpu1	[pos="e,787.65,14334 1087.7,14407 1014,14394 904.32,14373 812,14343 807.11,14341 802.17,14339 797.21,14338"];
		gate_l3_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="981,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu2 -> gate_l3_gpu2	[pos="e,1130,14315 1582.9,14409 1493.5,14396 1347.4,14374 1224,14343 1196.5,14336 1167.6,14327 1139.8,14318"];
		gate_l3_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1393,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu3 -> gate_l3_gpu3	[pos="e,1546.3,14326 1922.7,14406 1821.7,14389 1657.6,14360 1598,14343 1584.2,14339 1570.1,14334 1556.1,14329"];
		gate_l3_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1767,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu4 -> gate_l3_gpu4	[pos="e,1922.3,14331 2185,14399 2095.7,14378 1965.1,14346 1954,14343 1946.7,14340 1939.3,14338 1931.8,14335"];
		gate_l3_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2123,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu5 -> gate_l3_gpu5	[pos="e,2279.6,14334 2407.9,14387 2374.2,14374 2335.1,14358 2300,14343 2296.3,14341 2292.7,14339 2288.9,14338"];
		gate_l3_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2469,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu6 -> gate_l3_gpu6	[pos="e,2585.6,14343 2636.3,14379 2623.2,14369 2608.7,14359 2593.9,14349"];
		gate_l3_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2811,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu7 -> gate_l3_gpu7	[pos="e,2851,14343 2868.2,14378 2864.2,14370 2859.9,14361 2855.4,14352"];
		gate_l3_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3150,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu8 -> gate_l3_gpu8	[pos="e,3150,14343 3150,14378 3150,14370 3150,14362 3150,14353"];
		gate_l3_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3494,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu9 -> gate_l3_gpu9	[pos="e,3457.1,14343 3441.3,14378 3445,14370 3448.9,14361 3453,14352"];
		gate_l3_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3843,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu10 -> gate_l3_gpu10	[pos="e,3780.2,14343 3753.2,14378 3759.7,14370 3766.8,14361 3774.1,14351"];
		gate_l3_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4199,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu11 -> gate_l3_gpu11	[pos="e,4118,14343 4083.2,14378 4091.8,14370 4101.3,14360 4111,14350"];
		gate_l3_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4558,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu12 -> gate_l3_gpu12	[pos="e,4462.9,14342 4419.9,14378 4430.9,14369 4442.9,14359 4455.2,14348"];
		gate_l3_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4919,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu13 -> gate_l3_gpu13	[pos="e,4833.9,14343 4797.2,14378 4806.3,14370 4816.3,14360 4826.4,14350"];
		gate_l3_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5286,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu14 -> gate_l3_gpu14	[pos="e,5190.6,14341 5146.4,14378 5157.7,14369 5170.1,14358 5182.7,14348"];
		gate_l3_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 3\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5647,14260",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l3_gpu15 -> gate_l3_gpu15	[pos="e,5558.8,14343 5520.8,14378 5530.3,14369 5540.7,14360 5551.4,14350"];
		expert_l3_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 3\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="268,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu0 -> expert_l3_gpu0	[pos="e,271.6,14141 274.75,14177 273.98,14168 273.22,14159 272.49,14151",
			style=dashed];
		expert_l3_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 3\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="621,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu1 -> expert_l3_gpu1	[pos="e,623.57,14141 625.82,14177 625.27,14168 624.73,14159 624.21,14151",
			style=dashed];
		expert_l3_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 3\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="980,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu2 -> expert_l3_gpu2	[pos="e,980.26,14141 980.48,14177 980.43,14168 980.37,14159 980.32,14151",
			style=dashed];
		expert_l3_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 3\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1366,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu3 -> expert_l3_gpu3	[pos="e,1372.9,14141 1379,14177 1377.5,14168 1376.1,14159 1374.7,14151",
			style=dashed];
		expert_l3_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 3\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1734,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu4 -> expert_l3_gpu4	[pos="e,1742.5,14141 1749.9,14177 1748.1,14168 1746.3,14159 1744.5,14151",
			style=dashed];
		expert_l3_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 3\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2093,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu5 -> expert_l3_gpu5	[pos="e,2100.7,14141 2107.5,14177 2105.8,14168 2104.1,14159 2102.6,14151",
			style=dashed];
		expert_l3_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 3\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2447,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu6 -> expert_l3_gpu6	[pos="e,2452.7,14141 2457.6,14177 2456.4,14168 2455.2,14159 2454.1,14151",
			style=dashed];
		expert_l3_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 3\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2799,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu7 -> expert_l3_gpu7	[pos="e,2802.1,14141 2804.8,14177 2804.1,14168 2803.5,14159 2802.9,14151",
			style=dashed];
		expert_l3_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 3\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3150,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu8 -> expert_l3_gpu8	[pos="e,3150,14141 3150,14177 3150,14168 3150,14159 3150,14151",
			style=dashed];
		expert_l3_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 3\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3500,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu9 -> expert_l3_gpu9	[pos="e,3498.5,14141 3497.1,14177 3497.4,14168 3497.8,14159 3498.1,14151",
			style=dashed];
		expert_l3_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 3\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3855,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu10 -> expert_l3_gpu10	[pos="e,3851.9,14141 3849.2,14177 3849.9,14168 3850.5,14159 3851.1,14151",
			style=dashed];
		expert_l3_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 3\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4214,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu11 -> expert_l3_gpu11	[pos="e,4210.1,14141 4206.8,14177 4207.6,14168 4208.4,14159 4209.2,14151",
			style=dashed];
		expert_l3_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 3\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4575,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu12 -> expert_l3_gpu12	[pos="e,4570.6,14141 4566.8,14177 4567.7,14168 4568.7,14159 4569.5,14151",
			style=dashed];
		expert_l3_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 3\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4937,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu13 -> expert_l3_gpu13	[pos="e,4932.4,14141 4928.3,14177 4929.3,14168 4930.3,14159 4931.2,14151",
			style=dashed];
		expert_l3_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 3\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5298,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu14 -> expert_l3_gpu14	[pos="e,5294.9,14141 5292.2,14177 5292.9,14168 5293.5,14159 5294.1,14151",
			style=dashed];
		expert_l3_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 3\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5659,14099",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l3_gpu15 -> expert_l3_gpu15	[pos="e,5655.9,14141 5653.2,14177 5653.9,14168 5654.5,14159 5655.1,14151",
			style=dashed];
		agg_l3_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="254,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu0 -> agg_l3_gpu0	[pos="e,261.27,14022 264.39,14057 263.69,14049 262.93,14041 262.15,14032"];
		agg_l3_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="616,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu1 -> agg_l3_gpu1	[pos="e,618.6,14022 619.71,14057 619.46,14049 619.19,14041 618.91,14032"];
		agg_l3_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="978,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu2 -> agg_l3_gpu2	[pos="e,979.04,14022 979.48,14057 979.38,14049 979.28,14041 979.16,14032"];
		agg_l3_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1340,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu3 -> agg_l3_gpu3	[pos="e,1353.5,14022 1359.3,14057 1358,14049 1356.6,14041 1355.1,14032"];
		agg_l3_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1702,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu4 -> agg_l3_gpu4	[pos="e,1718.6,14022 1725.8,14057 1724.2,14049 1722.4,14041 1720.6,14032"];
		agg_l3_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2064,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu5 -> agg_l3_gpu5	[pos="e,2079.1,14022 2085.5,14057 2084.1,14049 2082.5,14041 2080.9,14032"];
		agg_l3_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2426,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu6 -> agg_l3_gpu6	[pos="e,2436.9,14022 2441.6,14057 2440.5,14049 2439.4,14041 2438.2,14032"];
		agg_l3_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2788,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu7 -> agg_l3_gpu7	[pos="e,2793.7,14022 2796.2,14057 2795.6,14049 2795,14041 2794.4,14032"];
		agg_l3_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3150,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu8 -> agg_l3_gpu8	[pos="e,3150,14022 3150,14057 3150,14049 3150,14041 3150,14032"];
		agg_l3_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3512,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu9 -> agg_l3_gpu9	[pos="e,3505.8,14022 3503.1,14057 3503.7,14049 3504.3,14041 3505,14032"];
		agg_l3_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3874,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu10 -> agg_l3_gpu10	[pos="e,3864.1,14022 3859.9,14057 3860.8,14049 3861.9,14041 3862.9,14032"];
		agg_l3_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4236,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu11 -> agg_l3_gpu11	[pos="e,4224.6,14022 4219.7,14057 4220.8,14049 4222,14041 4223.2,14032"];
		agg_l3_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4598,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu12 -> agg_l3_gpu12	[pos="e,4586.1,14022 4580.9,14057 4582.1,14049 4583.3,14041 4584.6,14032"];
		agg_l3_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4960,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu13 -> agg_l3_gpu13	[pos="e,4948.1,14022 4942.9,14057 4944.1,14049 4945.3,14041 4946.6,14032"];
		agg_l3_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5322,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu14 -> agg_l3_gpu14	[pos="e,5309.5,14022 5304.2,14057 5305.4,14049 5306.7,14041 5308,14032"];
		agg_l3_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 3\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5684,13939",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l3_gpu15 -> agg_l3_gpu15	[pos="e,5671,14022 5665.4,14057 5666.7,14049 5668,14041 5669.4,14032"];
		global_agg_l3	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 3\nAll GPUs\n[128,10000,4096]",
			pos="3150,13772",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l3_gpu0 -> global_agg_l3	[pos="e,3040.3,13773 366.01,13879 388.32,13869 411.98,13861 435,13856 689.5,13797 2537.9,13778 3029.9,13773"];
		agg_l3_gpu1 -> global_agg_l3	[pos="e,3040.2,13774 728.03,13879 750.34,13869 773.99,13861 797,13856 1014.8,13805 2581.3,13780 3030.1,13774"];
		agg_l3_gpu2 -> global_agg_l3	[pos="e,3040.5,13775 1090.1,13879 1112.4,13870 1136,13861 1159,13856 1340.4,13813 2628.2,13783 3030.3,13775"];
		agg_l3_gpu3 -> global_agg_l3	[pos="e,3040.2,13773 1452.1,13879 1474.4,13870 1498,13861 1521,13856 1807.2,13786 2703.6,13775 3029.8,13773"];
		agg_l3_gpu4 -> global_agg_l3	[pos="e,3040.4,13775 1814.2,13879 1836.5,13870 1860.1,13861 1883,13856 2098.1,13802 2757.5,13781 3030.1,13775"];
		agg_l3_gpu5 -> global_agg_l3	[pos="e,3041.3,13778 2176.3,13880 2198.6,13870 2222.2,13862 2245,13856 2390.3,13817 2820.5,13790 3031.1,13779"];
		agg_l3_gpu6 -> global_agg_l3	[pos="e,3042,13780 2538.6,13881 2560.9,13871 2584.3,13862 2607,13856 2749.7,13813 2920.3,13792 3031.7,13781"];
		agg_l3_gpu7 -> global_agg_l3	[pos="e,3075,13807 2902.5,13885 2955.5,13861 3017.2,13833 3065.8,13811"];
		agg_l3_gpu8 -> global_agg_l3	[pos="e,3150,13820 3150,13856 3150,13847 3150,13838 3150,13830"];
		agg_l3_gpu9 -> global_agg_l3	[pos="e,3225.1,13807 3341.6,13860 3304.4,13843 3266.6,13826 3234.5,13811"];
		agg_l3_gpu10 -> global_agg_l3	[pos="e,3258,13780 3703,13859 3699.6,13858 3696.3,13857 3693,13856 3550.3,13813 3379.7,13792 3268.3,13781"];
		agg_l3_gpu11 -> global_agg_l3	[pos="e,3258.7,13778 4064.8,13858 4061.5,13857 4058.3,13857 4055,13856 3909.7,13817 3479.5,13790 3268.9,13779"];
		agg_l3_gpu12 -> global_agg_l3	[pos="e,3259.6,13775 4426.8,13858 4423.5,13857 4420.3,13856 4417,13856 4201.9,13802 3542.5,13781 3269.9,13775"];
		agg_l3_gpu13 -> global_agg_l3	[pos="e,3259.8,13773 4788.8,13858 4785.6,13857 4782.3,13856 4779,13856 4492.8,13786 3596.4,13775 3270.2,13773"];
		agg_l3_gpu14 -> global_agg_l3	[pos="e,3259.5,13775 5150.9,13858 5147.6,13857 5144.3,13856 5141,13856 4959.6,13813 3671.8,13783 3269.7,13775"];
		agg_l3_gpu15 -> global_agg_l3	[pos="e,3259.8,13774 5512.6,13858 5509.4,13857 5506.2,13856 5503,13856 5285.2,13805 3718.7,13780 3269.9,13774"];
		residual_l3	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 3\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4834,13646",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l3 -> residual_l3	[pos="e,4732.4,13654 3257.9,13763 3560.4,13740 4414.8,13678 4722.1,13655"];
	}
	subgraph cluster_layer_4 {
		graph [bb="456,12560,6246,13588",
			label="Layer 4 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3351,13577",
			lwidth=3.29,
			style=dashed
		];
		dist_l4	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 4\nAll GPUs\n[128,10000,4096]",
			pos="3532,13509",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l4_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="889,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu0	[pos="e,972.2,13407 3430,13508 3025.8,13504 1536,13486 1068,13425 1039.9,13422 1009.6,13416 982.18,13409"];
		mha_l4_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1160,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu1	[pos="e,1243.1,13391 3430.3,13504 3163,13493 2417.9,13460 1798,13425 1604.3,13415 1377.6,13400 1253.3,13391"];
		mha_l4_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1890,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu2	[pos="e,1973.2,13395 3430.9,13503 3214.8,13492 2692.1,13464 2255,13425 2162.5,13417 2057.1,13405 1983.4,13396"];
		mha_l4_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2347,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu3	[pos="e,2430.2,13401 3430.9,13503 3256.1,13492 2886.3,13466 2576,13425 2531.2,13419 2481.7,13411 2440.3,13403"];
		mha_l4_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2668,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu4	[pos="e,2751,13408 3431.7,13501 3294.6,13489 3041.3,13465 2828,13425 2806.1,13421 2782.8,13416 2760.9,13411"];
		mha_l4_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2920,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu5	[pos="e,3003.2,13413 3433.9,13496 3335.1,13482 3178.8,13458 3046,13425 3035.2,13423 3024,13420 3012.9,13416"];
		mha_l4_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3138,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu6	[pos="e,3221.1,13416 3444.5,13485 3387.9,13469 3312.7,13447 3247,13425 3241.7,13424 3236.3,13422 3230.9,13420"];
		mha_l4_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3339,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu7	[pos="e,3402.3,13425 3472.5,13470 3453,13458 3431.2,13444 3410.9,13431"];
		mha_l4_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3532,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu8	[pos="e,3532,13425 3532,13461 3532,13453 3532,13444 3532,13436"];
		mha_l4_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3805,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu9	[pos="e,3721.6,13423 3604.4,13476 3637.5,13461 3677,13443 3712.3,13427"];
		mha_l4_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4093,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu10	[pos="e,4010,13403 3623.7,13488 3727.5,13465 3895.8,13428 4000.1,13405"];
		mha_l4_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4431,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu11	[pos="e,4348,13399 3630.6,13497 3758.6,13482 3988.8,13454 4185,13425 4235.7,13418 4292.1,13409 4338,13401"];
		mha_l4_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4781,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu12	[pos="e,4697.8,13399 3632.8,13502 3812.2,13491 4198.6,13464 4523,13425 4577.9,13419 4638.9,13409 4687.9,13401"];
		mha_l4_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5137,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu13	[pos="e,5053.7,13400 3633.6,13505 3857.9,13498 4411.8,13475 4873,13425 4929.9,13419 4993.4,13410 5043.8,13401"];
		mha_l4_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5484,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu14	[pos="e,5400.7,13400 3634.2,13507 3898.5,13503 4626.4,13488 5229,13425 5282.8,13420 5342.5,13410 5390.7,13402"];
		mha_l4_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 4\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5826,13384",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l4 -> mha_l4_gpu15	[pos="e,5743,13401 3633.9,13509 3932.8,13508 4833.5,13500 5576,13425 5628.2,13420 5686,13411 5732.9,13403"];
		gate_l4_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="802,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu0 -> gate_l4_gpu0	[pos="e,847.16,13307 866.6,13342 862.06,13334 857.11,13325 852.04,13316"];
		gate_l4_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1143,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu1 -> gate_l4_gpu1	[pos="e,1151.8,13307 1155.6,13342 1154.8,13334 1153.8,13325 1152.9,13317"];
		gate_l4_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1489,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu2 -> gate_l4_gpu2	[pos="e,1646.6,13300 1807,13358 1763.1,13344 1708.6,13326 1661,13306 1659.4,13306 1657.7,13305 1656.1,13304"];
		gate_l4_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1830,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu3 -> gate_l4_gpu3	[pos="e,1988.3,13302 2263.8,13370 2192.6,13358 2087.9,13337 2000,13306 1999.3,13306 1998.5,13306 1997.8,13306"];
		gate_l4_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2169,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu4 -> gate_l4_gpu4	[pos="e,2327.3,13302 2584.8,13369 2517.2,13356 2419.9,13335 2338,13306 2337.7,13306 2337.3,13306 2337,13306"];
		gate_l4_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2507,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu5 -> gate_l4_gpu5	[pos="e,2665.5,13302 2836.8,13360 2789.1,13346 2728.5,13327 2676,13306 2675.7,13306 2675.3,13306 2675,13306"];
		gate_l4_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2845,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu6 -> gate_l4_gpu6	[pos="e,2996.8,13306 3062.9,13342 3045.2,13333 3025.6,13322 3005.7,13311"];
		gate_l4_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3195,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu7 -> gate_l4_gpu7	[pos="e,3269.7,13307 3301.9,13342 3294,13333 3285.4,13324 3276.5,13314"];
		gate_l4_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3532,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu8 -> gate_l4_gpu8	[pos="e,3532,13307 3532,13342 3532,13334 3532,13325 3532,13317"];
		gate_l4_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3876,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu9 -> gate_l4_gpu9	[pos="e,3839.1,13307 3823.3,13342 3827,13334 3830.9,13325 3835,13316"];
		gate_l4_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4226,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu10 -> gate_l4_gpu10	[pos="e,4157,13307 4127.3,13342 4134.5,13333 4142.4,13324 4150.5,13314"];
		gate_l4_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4586,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu11 -> gate_l4_gpu11	[pos="e,4505.5,13307 4470.9,13342 4479.5,13333 4488.9,13324 4498.5,13314"];
		gate_l4_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4946,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu12 -> gate_l4_gpu12	[pos="e,4860.4,13307 4823.5,13342 4832.6,13333 4842.6,13324 4852.9,13314"];
		gate_l4_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5301,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu13 -> gate_l4_gpu13	[pos="e,5215.9,13307 5179.2,13342 5188.3,13333 5198.3,13324 5208.4,13314"];
		gate_l4_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5662,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu14 -> gate_l4_gpu14	[pos="e,5569.6,13307 5529.8,13342 5539.8,13333 5550.7,13323 5561.9,13314"];
		gate_l4_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 4\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6024,13223",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l4_gpu15 -> gate_l4_gpu15	[pos="e,5927.6,13302 5876.7,13342 5890,13332 5904.8,13320 5919.8,13308"];
		expert_l4_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 4\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="802,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu0 -> expert_l4_gpu0	[pos="e,802,13105 802,13140 802,13132 802,13123 802,13115",
			style=dashed];
		expert_l4_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 4\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1010,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu1 -> expert_l4_gpu1	[pos="e,1044.2,13105 1074.2,13140 1066.2,13131 1058.3,13121 1050.9,13113",
			style=dashed];
		expert_l4_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 4\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1418,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu2 -> expert_l4_gpu2	[pos="e,1436.3,13105 1452.3,13140 1448.2,13131 1444.2,13122 1440.4,13114",
			style=dashed];
		expert_l4_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 4\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1770,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu3 -> expert_l4_gpu3	[pos="e,1785.4,13105 1798.9,13140 1795.6,13131 1792.2,13123 1789.1,13114",
			style=dashed];
		expert_l4_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 4\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2120,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu4 -> expert_l4_gpu4	[pos="e,2132.6,13105 2143.6,13140 2140.9,13131 2138.1,13123 2135.6,13114",
			style=dashed];
		expert_l4_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 4\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2470,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu5 -> expert_l4_gpu5	[pos="e,2479.5,13105 2487.8,13140 2485.8,13131 2483.7,13123 2481.8,13114",
			style=dashed];
		expert_l4_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 4\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2820,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu6 -> expert_l4_gpu6	[pos="e,2826.4,13105 2832.1,13140 2830.7,13132 2829.3,13123 2828,13115",
			style=dashed];
		expert_l4_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 4\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3182,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu7 -> expert_l4_gpu7	[pos="e,3185.3,13105 3188.3,13140 3187.6,13132 3186.8,13123 3186.2,13115",
			style=dashed];
		expert_l4_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 4\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3532,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu8 -> expert_l4_gpu8	[pos="e,3532,13105 3532,13140 3532,13132 3532,13123 3532,13115",
			style=dashed];
		expert_l4_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 4\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3888,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu9 -> expert_l4_gpu9	[pos="e,3884.9,13105 3882.2,13140 3882.9,13132 3883.5,13123 3884.1,13115",
			style=dashed];
		expert_l4_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 4\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4238,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu10 -> expert_l4_gpu10	[pos="e,4234.9,13105 4232.2,13140 4232.9,13132 4233.5,13123 4234.1,13115",
			style=dashed];
		expert_l4_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 4\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4607,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu11 -> expert_l4_gpu11	[pos="e,4601.6,13105 4596.9,13140 4598,13132 4599.2,13123 4600.3,13115",
			style=dashed];
		expert_l4_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 4\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4969,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu12 -> expert_l4_gpu12	[pos="e,4963.1,13105 4957.9,13140 4959.2,13132 4960.4,13123 4961.6,13115",
			style=dashed];
		expert_l4_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 4\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5318,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu13 -> expert_l4_gpu13	[pos="e,5313.6,13105 5309.8,13140 5310.7,13132 5311.7,13123 5312.5,13115",
			style=dashed];
		expert_l4_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 4\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5674,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu14 -> expert_l4_gpu14	[pos="e,5670.9,13105 5668.2,13140 5668.9,13132 5669.5,13123 5670.1,13115",
			style=dashed];
		expert_l4_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 4\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6036,13063",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l4_gpu15 -> expert_l4_gpu15	[pos="e,6032.9,13105 6030.2,13140 6030.9,13132 6031.5,13123 6032.1,13115",
			style=dashed];
		agg_l4_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="636,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu0 -> agg_l4_gpu0	[pos="e,722.17,12986 759.25,13021 750.05,13012 739.98,13003 729.69,12993"];
		agg_l4_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="998,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu1 -> agg_l4_gpu1	[pos="e,1004.2,12986 1006.9,13021 1006.3,13013 1005.7,13004 1005,12996"];
		agg_l4_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1360,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu2 -> agg_l4_gpu2	[pos="e,1390.1,12986 1403.1,13021 1400.1,13013 1396.9,13004 1393.6,12995"];
		agg_l4_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1722,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu3 -> agg_l4_gpu3	[pos="e,1746.9,12986 1757.6,13021 1755.2,13013 1752.6,13004 1749.9,12995"];
		agg_l4_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2084,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu4 -> agg_l4_gpu4	[pos="e,2102.7,12986 2110.7,13021 2108.9,13013 2106.9,13004 2104.9,12995"];
		agg_l4_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2446,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu5 -> agg_l4_gpu5	[pos="e,2458.5,12986 2463.8,13021 2462.6,13013 2461.3,13004 2460,12996"];
		agg_l4_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2808,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu6 -> agg_l4_gpu6	[pos="e,2814.2,12986 2816.9,13021 2816.3,13013 2815.7,13004 2815,12996"];
		agg_l4_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3170,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu7 -> agg_l4_gpu7	[pos="e,3176.2,12986 3178.9,13021 3178.3,13013 3177.7,13004 3177,12996"];
		agg_l4_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3532,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu8 -> agg_l4_gpu8	[pos="e,3532,12986 3532,13021 3532,13013 3532,13004 3532,12996"];
		agg_l4_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3894,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu9 -> agg_l4_gpu9	[pos="e,3890.9,12986 3889.5,13021 3889.8,13013 3890.2,13004 3890.5,12996"];
		agg_l4_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4256,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu10 -> agg_l4_gpu10	[pos="e,4246.7,12986 4242.6,13021 4243.5,13013 4244.5,13004 4245.5,12996"];
		agg_l4_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4618,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu11 -> agg_l4_gpu11	[pos="e,4612.3,12986 4609.8,13021 4610.4,13013 4611,13004 4611.6,12996"];
		agg_l4_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4980,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu12 -> agg_l4_gpu12	[pos="e,4974.3,12986 4971.8,13021 4972.4,13013 4973,13004 4973.6,12996"];
		agg_l4_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5342,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu13 -> agg_l4_gpu13	[pos="e,5329.5,12986 5324.2,13021 5325.4,13013 5326.7,13004 5328,12996"];
		agg_l4_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5704,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu14 -> agg_l4_gpu14	[pos="e,5688.4,12986 5681.7,13021 5683.2,13013 5684.9,13004 5686.5,12996"];
		agg_l4_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 4\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6066,12902",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l4_gpu15 -> agg_l4_gpu15	[pos="e,6050.4,12986 6043.7,13021 6045.2,13013 6046.9,13004 6048.5,12996"];
		global_agg_l4	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 4\nAll GPUs\n[128,10000,4096]",
			pos="3532,12735",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l4_gpu0 -> global_agg_l4	[pos="e,3422.3,12737 748.01,12842 770.32,12833 793.98,12825 817,12819 1071.5,12760 2919.9,12741 3411.9,12737"];
		agg_l4_gpu1 -> global_agg_l4	[pos="e,3422.2,12738 1110,12842 1132.3,12833 1156,12825 1179,12819 1396.8,12768 2963.3,12744 3412.1,12738"];
		agg_l4_gpu2 -> global_agg_l4	[pos="e,3422.5,12738 1472.1,12843 1494.4,12833 1518,12825 1541,12819 1722.4,12776 3010.2,12747 3412.3,12739"];
		agg_l4_gpu3 -> global_agg_l4	[pos="e,3422.2,12737 1834.1,12843 1856.4,12833 1880,12825 1903,12819 2189.2,12750 3085.6,12738 3411.8,12737"];
		agg_l4_gpu4 -> global_agg_l4	[pos="e,3422.4,12738 2196.2,12843 2218.5,12834 2242.1,12825 2265,12819 2480.1,12765 3139.5,12745 3412.1,12739"];
		agg_l4_gpu5 -> global_agg_l4	[pos="e,3423.3,12742 2558.3,12844 2580.6,12834 2604.2,12825 2627,12819 2772.3,12781 3202.5,12754 3413.1,12742"];
		agg_l4_gpu6 -> global_agg_l4	[pos="e,3424,12744 2920.6,12845 2942.9,12835 2966.3,12826 2989,12819 3131.7,12777 3302.3,12755 3413.7,12745"];
		agg_l4_gpu7 -> global_agg_l4	[pos="e,3457,12770 3284.5,12849 3337.5,12825 3399.2,12797 3447.8,12775"];
		agg_l4_gpu8 -> global_agg_l4	[pos="e,3532,12783 3532,12819 3532,12811 3532,12802 3532,12794"];
		agg_l4_gpu9 -> global_agg_l4	[pos="e,3607.1,12771 3723.6,12824 3686.4,12807 3648.6,12789 3616.5,12775"];
		agg_l4_gpu10 -> global_agg_l4	[pos="e,3640,12744 4085,12822 4081.6,12821 4078.3,12820 4075,12819 3932.3,12777 3761.7,12755 3650.3,12745"];
		agg_l4_gpu11 -> global_agg_l4	[pos="e,3640.7,12742 4446.8,12822 4443.5,12821 4440.3,12820 4437,12819 4291.7,12781 3861.5,12754 3650.9,12742"];
		agg_l4_gpu12 -> global_agg_l4	[pos="e,3641.6,12738 4808.8,12822 4805.5,12821 4802.3,12820 4799,12819 4583.9,12765 3924.5,12745 3651.9,12739"];
		agg_l4_gpu13 -> global_agg_l4	[pos="e,3641.8,12737 5170.8,12822 5167.6,12821 5164.3,12820 5161,12819 4874.8,12750 3978.4,12738 3652.2,12737"];
		agg_l4_gpu14 -> global_agg_l4	[pos="e,3641.5,12738 5532.9,12822 5529.6,12821 5526.3,12820 5523,12819 5341.6,12776 4053.8,12747 3651.7,12739"];
		agg_l4_gpu15 -> global_agg_l4	[pos="e,3641.8,12738 5894.6,12822 5891.4,12821 5888.2,12820 5885,12819 5667.2,12768 4100.7,12744 3651.9,12738"];
		residual_l4	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 4\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3711,12610",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l4 -> residual_l4	[pos="e,3652.3,12651 3590.1,12694 3607.2,12682 3626.1,12669 3643.7,12657"];
	}
	subgraph cluster_layer_5 {
		graph [bb="277,11524,6067,12552",
			label="Layer 5 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3172,12541",
			lwidth=3.29,
			style=dashed
		];
		dist_l5	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 5\nAll GPUs\n[128,10000,4096]",
			pos="3353,12473",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l5_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="463,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu0	[pos="e,546.03,12353 3251.5,12468 2949.4,12457 2029.6,12423 1267,12389 1009.6,12377 705.87,12361 556.11,12354"];
		mha_l5_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1359,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu1	[pos="e,1442.3,12357 3251.6,12468 3004.5,12457 2351.2,12428 1807,12389 1684.2,12380 1542.9,12367 1452.3,12358"];
		mha_l5_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1899,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu2	[pos="e,1982.1,12363 3251.8,12468 3046.9,12458 2568.7,12433 2169,12389 2110,12383 2044.2,12373 1992.3,12364"];
		mha_l5_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2261,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu3	[pos="e,2344.4,12370 3251.7,12467 3083,12458 2734,12435 2442,12389 2413.3,12384 2382.3,12378 2354.2,12372"];
		mha_l5_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2534,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu4	[pos="e,2617.2,12376 3252.3,12465 3118.3,12455 2874.5,12432 2670,12389 2656,12386 2641.3,12382 2627,12378"];
		mha_l5_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2762,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu5	[pos="e,2845.2,12380 3254.7,12460 3157.5,12447 3005.1,12423 2876,12389 2869.1,12387 2862,12385 2854.9,12383"];
		mha_l5_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2968,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu6	[pos="e,3051.2,12382 3265.4,12448 3209.4,12433 3135.4,12411 3071,12389 3067.7,12388 3064.3,12387 3060.9,12385"];
		mha_l5_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3163,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu7	[pos="e,3225.5,12389 3294.2,12434 3275.1,12421 3253.8,12408 3233.9,12395"];
		mha_l5_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3353,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu8	[pos="e,3353,12389 3353,12425 3353,12416 3353,12408 3353,12399"];
		mha_l5_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3613,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu9	[pos="e,3529.9,12388 3423.7,12438 3453.5,12424 3488.7,12408 3520.5,12392"];
		mha_l5_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3909,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu10	[pos="e,3825.6,12367 3444.5,12452 3547.1,12429 3712.5,12392 3815.8,12369"];
		mha_l5_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4247,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu11	[pos="e,4164,12363 3451.4,12461 3578.5,12445 3806.6,12417 4001,12389 4051.7,12382 4108.1,12372 4154,12365"];
		mha_l5_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4593,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu12	[pos="e,4510,12363 3454,12466 3632.9,12455 4016.7,12428 4339,12389 4392.5,12382 4452,12373 4499.9,12365"];
		mha_l5_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4954,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu13	[pos="e,4870.9,12363 3454.8,12469 3678,12461 4227.4,12438 4685,12389 4743.7,12383 4809.1,12373 4860.8,12365"];
		mha_l5_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5314,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu14	[pos="e,5231,12363 3454.9,12471 3718.5,12466 4444.6,12449 5046,12389 5104.4,12383 5169.5,12373 5220.9,12365"];
		mha_l5_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 5\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5675,12347",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l5 -> mha_l5_gpu15	[pos="e,5592,12363 3455,12472 3754.9,12470 4659.6,12460 5406,12389 5464.7,12383 5530.2,12374 5581.8,12365"];
		gate_l5_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="461,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu0 -> gate_l5_gpu0	[pos="e,462.04,12270 462.48,12306 462.38,12298 462.28,12289 462.16,12280"];
		gate_l5_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="821,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu1 -> gate_l5_gpu1	[pos="e,967.61,12236 1275.7,12325 1219.2,12310 1142.9,12290 1076,12270 1043.9,12261 1009.8,12250 977.21,12240"];
		gate_l5_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1245,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu2 -> gate_l5_gpu2	[pos="e,1397.5,12251 1815.6,12337 1726,12326 1579.7,12304 1457,12270 1440.7,12265 1423.9,12260 1407.3,12254"];
		gate_l5_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1626,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu3 -> gate_l5_gpu3	[pos="e,1781.5,12259 2177.6,12335 2068.2,12319 1882.2,12290 1816,12270 1807.7,12268 1799.4,12265 1791,12262"];
		gate_l5_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1985,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu4 -> gate_l5_gpu4	[pos="e,2142.3,12263 2450.8,12327 2420.1,12320 2385,12313 2353,12306 2269.3,12289 2245.5,12296 2164,12270 2160,12269 2155.9,12267 2151.8,\
12266"];
		gate_l5_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2333,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu5 -> gate_l5_gpu5	[pos="e,2490.5,12264 2678.8,12322 2604.8,12300 2508.1,12271 2506,12270 2504.1,12269 2502.2,12269 2500.2,12268"];
		gate_l5_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2675,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu6 -> gate_l5_gpu6	[pos="e,2826.8,12270 2892.9,12306 2875.2,12296 2855.6,12286 2835.7,12275"];
		gate_l5_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3015,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu7 -> gate_l5_gpu7	[pos="e,3091.8,12270 3124.9,12306 3116.8,12297 3107.9,12287 3098.8,12278"];
		gate_l5_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3353,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu8 -> gate_l5_gpu8	[pos="e,3353,12270 3353,12306 3353,12298 3353,12289 3353,12280"];
		gate_l5_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3702,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu9 -> gate_l5_gpu9	[pos="e,3655.8,12270 3635.9,12306 3640.6,12297 3645.6,12288 3650.8,12279"];
		gate_l5_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4049,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu10 -> gate_l5_gpu10	[pos="e,3976.3,12270 3945.1,12306 3952.7,12297 3961,12288 3969.5,12278"];
		gate_l5_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4406,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu11 -> gate_l5_gpu11	[pos="e,4323.5,12270 4287.9,12306 4296.8,12297 4306.4,12287 4316.3,12277"];
		gate_l5_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4761,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu12 -> gate_l5_gpu12	[pos="e,4673.8,12270 4636.3,12306 4645.7,12297 4656,12287 4666.5,12277"];
		gate_l5_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5127,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu13 -> gate_l5_gpu13	[pos="e,5037.2,12270 4998.6,12306 5008.2,12297 5018.8,12287 5029.7,12277"];
		gate_l5_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5489,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu14 -> gate_l5_gpu14	[pos="e,5398.2,12270 5359.1,12306 5368.9,12297 5379.6,12287 5390.5,12277"];
		gate_l5_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 5\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5851,12187",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l5_gpu15 -> gate_l5_gpu15	[pos="e,5759.6,12270 5720.3,12306 5730.2,12297 5741,12287 5752,12277"];
		expert_l5_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 5\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="458,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu0 -> expert_l5_gpu0	[pos="e,458.77,12068 459.45,12104 459.28,12095 459.12,12087 458.96,12078",
			style=dashed];
		expert_l5_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 5\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="820,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu1 -> expert_l5_gpu1	[pos="e,820.26,12068 820.48,12104 820.43,12095 820.37,12087 820.32,12078",
			style=dashed];
		expert_l5_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 5\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1213,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu2 -> expert_l5_gpu2	[pos="e,1221.2,12068 1228.4,12104 1226.7,12095 1224.9,12086 1223.2,12078",
			style=dashed];
		expert_l5_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 5\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1584,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu3 -> expert_l5_gpu3	[pos="e,1594.8,12068 1604.3,12104 1601.9,12095 1599.6,12086 1597.4,12078",
			style=dashed];
		expert_l5_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 5\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1945,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu4 -> expert_l5_gpu4	[pos="e,1955.3,12068 1964.3,12104 1962.1,12095 1959.9,12086 1957.8,12078",
			style=dashed];
		expert_l5_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 5\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2300,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu5 -> expert_l5_gpu5	[pos="e,2308.5,12068 2315.9,12104 2314.1,12095 2312.3,12086 2310.5,12078",
			style=dashed];
		expert_l5_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 5\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2652,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu6 -> expert_l5_gpu6	[pos="e,2657.9,12068 2663.1,12104 2661.8,12095 2660.6,12087 2659.4,12078",
			style=dashed];
		expert_l5_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 5\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3003,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu7 -> expert_l5_gpu7	[pos="e,3006.1,12068 3008.8,12104 3008.1,12095 3007.5,12087 3006.9,12078",
			style=dashed];
		expert_l5_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 5\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3353,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu8 -> expert_l5_gpu8	[pos="e,3353,12068 3353,12104 3353,12095 3353,12087 3353,12078",
			style=dashed];
		expert_l5_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 5\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3709,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu9 -> expert_l5_gpu9	[pos="e,3707.2,12068 3705.6,12104 3706,12095 3706.4,12087 3706.8,12078",
			style=dashed];
		expert_l5_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 5\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4068,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu10 -> expert_l5_gpu10	[pos="e,4063.1,12068 4058.8,12104 4059.9,12095 4060.9,12087 4061.9,12078",
			style=dashed];
		expert_l5_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 5\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4428,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu11 -> expert_l5_gpu11	[pos="e,4422.3,12068 4417.4,12104 4418.6,12095 4419.8,12087 4420.9,12078",
			style=dashed];
		expert_l5_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 5\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4778,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu12 -> expert_l5_gpu12	[pos="e,4773.6,12068 4769.8,12104 4770.7,12095 4771.7,12087 4772.5,12078",
			style=dashed];
		expert_l5_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 5\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5139,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu13 -> expert_l5_gpu13	[pos="e,5135.9,12068 5133.2,12104 5133.9,12095 5134.5,12087 5135.1,12078",
			style=dashed];
		expert_l5_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 5\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5501,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu14 -> expert_l5_gpu14	[pos="e,5497.9,12068 5495.2,12104 5495.9,12095 5496.5,12087 5497.1,12078",
			style=dashed];
		expert_l5_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 5\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5863,12026",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l5_gpu15 -> expert_l5_gpu15	[pos="e,5859.9,12068 5857.2,12104 5857.9,12095 5858.5,12087 5859.1,12078",
			style=dashed];
		agg_l5_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="457,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu0 -> agg_l5_gpu0	[pos="e,457.52,11949 457.74,11985 457.69,11977 457.64,11968 457.58,11959"];
		agg_l5_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="819,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu1 -> agg_l5_gpu1	[pos="e,819.52,11949 819.74,11985 819.69,11977 819.64,11968 819.58,11959"];
		agg_l5_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1181,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu2 -> agg_l5_gpu2	[pos="e,1197.6,11949 1204.8,11985 1203.2,11977 1201.4,11968 1199.6,11959"];
		agg_l5_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1543,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu3 -> agg_l5_gpu3	[pos="e,1564.3,11949 1573.4,11985 1571.4,11977 1569.1,11968 1566.8,11959"];
		agg_l5_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1905,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu4 -> agg_l5_gpu4	[pos="e,1925.8,11949 1934.7,11985 1932.7,11977 1930.5,11968 1928.2,11959"];
		agg_l5_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2267,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu5 -> agg_l5_gpu5	[pos="e,2284.1,11949 2291.5,11985 2289.9,11977 2288.1,11968 2286.2,11959"];
		agg_l5_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2629,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu6 -> agg_l5_gpu6	[pos="e,2640.9,11949 2646.1,11985 2644.9,11977 2643.7,11968 2642.4,11959"];
		agg_l5_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2991,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu7 -> agg_l5_gpu7	[pos="e,2997.2,11949 2999.9,11985 2999.3,11977 2998.7,11968 2998,11959"];
		agg_l5_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3353,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu8 -> agg_l5_gpu8	[pos="e,3353,11949 3353,11985 3353,11977 3353,11968 3353,11959"];
		agg_l5_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3715,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu9 -> agg_l5_gpu9	[pos="e,3711.9,11949 3710.5,11985 3710.8,11977 3711.2,11968 3711.5,11959"];
		agg_l5_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4077,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu10 -> agg_l5_gpu10	[pos="e,4072.3,11949 4070.3,11985 4070.8,11977 4071.3,11968 4071.8,11959"];
		agg_l5_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4439,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu11 -> agg_l5_gpu11	[pos="e,4433.3,11949 4430.8,11985 4431.4,11977 4432,11968 4432.6,11959"];
		agg_l5_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4801,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu12 -> agg_l5_gpu12	[pos="e,4789.1,11949 4783.9,11985 4785.1,11977 4786.3,11968 4787.6,11959"];
		agg_l5_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5163,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu13 -> agg_l5_gpu13	[pos="e,5150.5,11949 5145.2,11985 5146.4,11977 5147.7,11968 5149,11959"];
		agg_l5_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5525,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu14 -> agg_l5_gpu14	[pos="e,5512.5,11949 5507.2,11985 5508.4,11977 5509.7,11968 5511,11959"];
		agg_l5_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 5\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5887,11866",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l5_gpu15 -> agg_l5_gpu15	[pos="e,5874.5,11949 5869.2,11985 5870.4,11977 5871.7,11968 5873,11959"];
		global_agg_l5	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 5\nAll GPUs\n[128,10000,4096]",
			pos="3353,11699",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l5_gpu0 -> global_agg_l5	[pos="e,3243.3,11701 569.01,11806 591.32,11797 614.98,11788 638,11783 892.5,11724 2740.9,11705 3232.9,11701"];
		agg_l5_gpu1 -> global_agg_l5	[pos="e,3243.2,11701 931.03,11806 953.34,11797 976.99,11788 1000,11783 1217.8,11732 2784.3,11707 3233.1,11701"];
		agg_l5_gpu2 -> global_agg_l5	[pos="e,3243.5,11702 1293.1,11806 1315.4,11797 1339,11788 1362,11783 1543.4,11740 2831.2,11710 3233.3,11702"];
		agg_l5_gpu3 -> global_agg_l5	[pos="e,3243.2,11700 1655.1,11806 1677.4,11797 1701,11789 1724,11783 2010.2,11714 2906.6,11702 3232.8,11700"];
		agg_l5_gpu4 -> global_agg_l5	[pos="e,3243.4,11702 2017.2,11807 2039.5,11797 2063.1,11789 2086,11783 2301.1,11729 2960.5,11709 3233.1,11702"];
		agg_l5_gpu5 -> global_agg_l5	[pos="e,3244.3,11705 2379.3,11807 2401.6,11798 2425.2,11789 2448,11783 2593.3,11745 3023.5,11717 3234.1,11706"];
		agg_l5_gpu6 -> global_agg_l5	[pos="e,3245,11708 2741.6,11808 2763.9,11799 2787.3,11790 2810,11783 2952.7,11741 3123.3,11719 3234.7,11709"];
		agg_l5_gpu7 -> global_agg_l5	[pos="e,3278,11734 3105.5,11813 3158.5,11789 3220.2,11760 3268.8,11738"];
		agg_l5_gpu8 -> global_agg_l5	[pos="e,3353,11747 3353,11783 3353,11774 3353,11766 3353,11757"];
		agg_l5_gpu9 -> global_agg_l5	[pos="e,3428.1,11734 3544.6,11787 3507.4,11770 3469.6,11753 3437.5,11738"];
		agg_l5_gpu10 -> global_agg_l5	[pos="e,3461,11708 3906,11786 3902.6,11785 3899.3,11784 3896,11783 3753.3,11741 3582.7,11719 3471.3,11709"];
		agg_l5_gpu11 -> global_agg_l5	[pos="e,3461.7,11705 4267.8,11786 4264.5,11785 4261.3,11784 4258,11783 4112.7,11745 3682.5,11717 3471.9,11706"];
		agg_l5_gpu12 -> global_agg_l5	[pos="e,3462.6,11702 4629.8,11786 4626.5,11785 4623.3,11784 4620,11783 4404.9,11729 3745.5,11709 3472.9,11702"];
		agg_l5_gpu13 -> global_agg_l5	[pos="e,3462.8,11700 4991.8,11786 4988.6,11785 4985.3,11784 4982,11783 4695.8,11714 3799.4,11702 3473.2,11700"];
		agg_l5_gpu14 -> global_agg_l5	[pos="e,3462.5,11702 5353.9,11786 5350.6,11785 5347.3,11784 5344,11783 5162.6,11740 3874.8,11710 3472.7,11702"];
		agg_l5_gpu15 -> global_agg_l5	[pos="e,3462.8,11701 5715.6,11785 5712.4,11785 5709.2,11784 5706,11783 5488.2,11732 3921.7,11707 3472.9,11701"];
		residual_l5	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 5\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3532,11573",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l5 -> residual_l5	[pos="e,3473.3,11615 3411.1,11658 3428.2,11646 3447.1,11633 3464.7,11621"];
	}
	subgraph cluster_layer_6 {
		graph [bb="98,10487,5888,11516",
			label="Layer 6 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="2993,11504",
			lwidth=3.29,
			style=dashed
		];
		dist_l6	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 6\nAll GPUs\n[128,10000,4096]",
			pos="3174,11437",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l6_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="606,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu0	[pos="e,689.25,11326 3072,11436 2750.9,11435 1732.3,11427 893,11353 827.98,11347 755.17,11337 699.15,11328"];
		mha_l6_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="985,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu1	[pos="e,1068,11328 3072,11436 2782.6,11435 1931.8,11425 1230,11353 1179.5,11347 1123.5,11338 1077.9,11330"];
		mha_l6_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1322,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu2	[pos="e,1405.1,11335 3072.4,11433 2757.2,11425 1798.2,11397 1490,11353 1465.5,11349 1439.3,11344 1415,11338"];
		mha_l6_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1582,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu3	[pos="e,1665.2,11333 3072,11435 2840.1,11432 2256.2,11418 1773,11353 1740.9,11348 1706.1,11342 1675.1,11335"];
		mha_l6_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1865,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu4	[pos="e,1948.1,11321 3074.2,11427 2906.6,11412 2557.8,11381 2263,11353 2158.6,11343 2038.8,11330 1958.2,11322"];
		mha_l6_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2355,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu5	[pos="e,2438.3,11326 3076.7,11422 2962.4,11406 2767.3,11379 2600,11353 2549.8,11345 2493.9,11336 2448.2,11328"];
		mha_l6_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2692,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu6	[pos="e,2775.3,11334 3085.3,11413 3000.1,11391 2871.8,11358 2785.1,11336"];
		mha_l6_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2952,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu7	[pos="e,3024.9,11353 3108.9,11400 3085.4,11386 3058.6,11372 3033.9,11358"];
		mha_l6_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu8	[pos="e,3174,11353 3174,11388 3174,11380 3174,11371 3174,11363"];
		mha_l6_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3434,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu9	[pos="e,3350.9,11352 3244.7,11402 3274.5,11388 3309.7,11371 3341.5,11356"];
		mha_l6_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3764,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu10	[pos="e,3680.7,11330 3266.5,11416 3376.9,11393 3560.2,11355 3670.8,11332"];
		mha_l6_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4082,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu11	[pos="e,3998.7,11328 3273.1,11425 3406,11411 3649.3,11384 3856,11353 3899.8,11346 3948.1,11338 3988.8,11330"];
		mha_l6_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4409,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu12	[pos="e,4325.8,11328 3275.1,11430 3455.9,11420 3846.5,11394 4174,11353 4221,11347 4272.9,11338 4315.9,11330"];
		mha_l6_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4741,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu13	[pos="e,4657.7,11328 3275.9,11433 3498.7,11426 4045.8,11405 4501,11353 4549.7,11347 4603.5,11338 4647.8,11330"];
		mha_l6_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5151,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu14	[pos="e,5067.8,11325 3275.7,11433 3535.4,11427 4244.5,11405 4833,11353 4908.9,11346 4994.6,11335 5057.9,11326"];
		mha_l6_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 6\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5469,11311",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l6 -> mha_l6_gpu15	[pos="e,5385.9,11330 3275.8,11434 3636.8,11425 4855,11395 5243,11353 5287,11348 5335.4,11340 5376.1,11332"];
		gate_l6_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="412,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu0 -> gate_l6_gpu0	[pos="e,512.54,11234 556.29,11270 545.14,11260 532.87,11250 520.36,11240"];
		gate_l6_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="794,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu1 -> gate_l6_gpu1	[pos="e,893.14,11234 935.81,11269 925.02,11260 913.19,11251 901.11,11241"];
		gate_l6_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1142,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu2 -> gate_l6_gpu2	[pos="e,1235.4,11234 1275.6,11269 1265.5,11260 1254.3,11251 1242.9,11241"];
		gate_l6_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1484,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu3 -> gate_l6_gpu3	[pos="e,1534.9,11234 1556.8,11269 1551.6,11261 1546,11252 1540.2,11243"];
		gate_l6_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1824,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu4 -> gate_l6_gpu4	[pos="e,1845.3,11234 1854.4,11269 1852.4,11261 1850.1,11253 1847.8,11244"];
		gate_l6_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2162,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu5 -> gate_l6_gpu5	[pos="e,2262,11234 2305.5,11270 2294.4,11260 2282.3,11250 2269.8,11240"];
		gate_l6_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2500,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu6 -> gate_l6_gpu6	[pos="e,2599.7,11234 2642.6,11269 2631.7,11260 2619.8,11251 2607.7,11241"];
		gate_l6_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2837,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu7 -> gate_l6_gpu7	[pos="e,2896.7,11234 2922.4,11269 2916.3,11261 2909.6,11252 2902.7,11242"];
		gate_l6_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3174,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu8 -> gate_l6_gpu8	[pos="e,3174,11234 3174,11269 3174,11261 3174,11253 3174,11244"];
		gate_l6_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3517,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu9 -> gate_l6_gpu9	[pos="e,3473.9,11234 3455.4,11269 3459.7,11261 3464.4,11252 3469.3,11243"];
		gate_l6_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3879,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu10 -> gate_l6_gpu10	[pos="e,3819.3,11234 3793.6,11269 3799.7,11261 3806.4,11252 3813.3,11242"];
		gate_l6_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4241,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu11 -> gate_l6_gpu11	[pos="e,4158.5,11234 4122.9,11269 4131.8,11261 4141.4,11251 4151.3,11241"];
		gate_l6_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4603,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu12 -> gate_l6_gpu12	[pos="e,4507,11230 4458.7,11270 4471.2,11259 4485.1,11248 4499.2,11236"];
		gate_l6_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4965,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu13 -> gate_l6_gpu13	[pos="e,4865.6,11222 4798.4,11270 4816.4,11257 4836.9,11242 4857.2,11228"];
		gate_l6_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5312,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu14 -> gate_l6_gpu14	[pos="e,5228.4,11234 5192.5,11269 5201.4,11261 5211.1,11251 5221.1,11241"];
		gate_l6_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 6\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5671,11151",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l6_gpu15 -> gate_l6_gpu15	[pos="e,5573.8,11228 5520.8,11270 5534.6,11259 5550.1,11247 5565.7,11234"];
		expert_l6_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 6\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="412,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu0 -> expert_l6_gpu0	[pos="e,412,11032 412,11068 412,11059 412,11050 412,11042",
			style=dashed];
		expert_l6_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 6\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="685,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu1 -> expert_l6_gpu1	[pos="e,713.05,11032 737.58,11068 731.19,11058 724.84,11049 718.87,11040",
			style=dashed];
		expert_l6_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 6\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1072,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu2 -> expert_l6_gpu2	[pos="e,1090,11032 1105.8,11068 1101.8,11059 1097.8,11050 1094.1,11041",
			style=dashed];
		expert_l6_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 6\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1424,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu3 -> expert_l6_gpu3	[pos="e,1439.4,11032 1452.9,11068 1449.6,11059 1446.2,11050 1443.1,11042",
			style=dashed];
		expert_l6_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 6\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1775,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu4 -> expert_l6_gpu4	[pos="e,1787.6,11032 1798.6,11068 1795.9,11059 1793.1,11050 1790.6,11042",
			style=dashed];
		expert_l6_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 6\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2125,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu5 -> expert_l6_gpu5	[pos="e,2134.5,11032 2142.8,11068 2140.8,11059 2138.7,11050 2136.8,11042",
			style=dashed];
		expert_l6_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 6\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2475,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu6 -> expert_l6_gpu6	[pos="e,2481.4,11032 2487.1,11068 2485.7,11059 2484.3,11050 2483,11042",
			style=dashed];
		expert_l6_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 6\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2824,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu7 -> expert_l6_gpu7	[pos="e,2827.3,11032 2830.3,11068 2829.6,11059 2828.8,11050 2828.2,11042",
			style=dashed];
		expert_l6_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 6\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu8 -> expert_l6_gpu8	[pos="e,3174,11032 3174,11068 3174,11059 3174,11050 3174,11042",
			style=dashed];
		expert_l6_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 6\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3524,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu9 -> expert_l6_gpu9	[pos="e,3522.2,11032 3520.6,11068 3521,11059 3521.4,11050 3521.8,11042",
			style=dashed];
		expert_l6_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 6\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3888,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu10 -> expert_l6_gpu10	[pos="e,3885.7,11032 3883.7,11068 3884.2,11059 3884.6,11050 3885.1,11042",
			style=dashed];
		expert_l6_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 6\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4250,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu11 -> expert_l6_gpu11	[pos="e,4247.7,11032 4245.7,11068 4246.2,11059 4246.6,11050 4247.1,11042",
			style=dashed];
		expert_l6_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 6\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4612,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu12 -> expert_l6_gpu12	[pos="e,4609.7,11032 4607.7,11068 4608.2,11059 4608.6,11050 4609.1,11042",
			style=dashed];
		expert_l6_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 6\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4974,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu13 -> expert_l6_gpu13	[pos="e,4971.7,11032 4969.7,11068 4970.2,11059 4970.6,11050 4971.1,11042",
			style=dashed];
		expert_l6_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 6\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5321,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu14 -> expert_l6_gpu14	[pos="e,5318.7,11032 5316.7,11068 5317.2,11059 5317.6,11050 5318.1,11042",
			style=dashed];
		expert_l6_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 6\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5683,10990",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l6_gpu15 -> expert_l6_gpu15	[pos="e,5679.9,11032 5677.2,11068 5677.9,11059 5678.5,11050 5679.1,11042",
			style=dashed];
		agg_l6_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="278,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu0 -> agg_l6_gpu0	[pos="e,347.56,10913 377.49,10948 370.21,10940 362.25,10930 354.11,10921"];
		agg_l6_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="640,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu1 -> agg_l6_gpu1	[pos="e,663.36,10913 673.41,10948 671.14,10940 668.66,10932 666.13,10923"];
		agg_l6_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1002,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu2 -> agg_l6_gpu2	[pos="e,1038.3,10913 1054,10948 1050.4,10940 1046.4,10931 1042.4,10922"];
		agg_l6_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1364,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu3 -> agg_l6_gpu3	[pos="e,1395.1,10913 1408.5,10948 1405.5,10940 1402.1,10931 1398.7,10922"];
		agg_l6_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1726,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu4 -> agg_l6_gpu4	[pos="e,1751.4,10913 1762.4,10948 1759.9,10940 1757.2,10932 1754.5,10923"];
		agg_l6_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2088,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu5 -> agg_l6_gpu5	[pos="e,2107.2,10913 2115.5,10948 2113.6,10940 2111.6,10932 2109.5,10923"];
		agg_l6_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2450,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu6 -> agg_l6_gpu6	[pos="e,2463,10913 2468.6,10948 2467.3,10940 2466,10932 2464.6,10923"];
		agg_l6_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2812,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu7 -> agg_l6_gpu7	[pos="e,2818.2,10913 2820.9,10948 2820.3,10940 2819.7,10932 2819,10923"];
		agg_l6_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu8 -> agg_l6_gpu8	[pos="e,3174,10913 3174,10948 3174,10940 3174,10932 3174,10923"];
		agg_l6_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3536,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu9 -> agg_l6_gpu9	[pos="e,3529.8,10913 3527.1,10948 3527.7,10940 3528.3,10932 3529,10923"];
		agg_l6_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3898,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu10 -> agg_l6_gpu10	[pos="e,3892.8,10913 3890.6,10948 3891.1,10940 3891.6,10932 3892.2,10923"];
		agg_l6_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4260,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu11 -> agg_l6_gpu11	[pos="e,4254.8,10913 4252.6,10948 4253.1,10940 4253.6,10932 4254.2,10923"];
		agg_l6_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4622,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu12 -> agg_l6_gpu12	[pos="e,4616.8,10913 4614.6,10948 4615.1,10940 4615.6,10932 4616.2,10923"];
		agg_l6_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4984,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu13 -> agg_l6_gpu13	[pos="e,4978.8,10913 4976.6,10948 4977.1,10940 4977.6,10932 4978.2,10923"];
		agg_l6_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5346,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu14 -> agg_l6_gpu14	[pos="e,5333,10913 5327.4,10948 5328.7,10940 5330,10932 5331.4,10923"];
		agg_l6_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 6\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5708,10830",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l6_gpu15 -> agg_l6_gpu15	[pos="e,5695,10913 5689.4,10948 5690.7,10940 5692,10932 5693.4,10923"];
		global_agg_l6	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 6\nAll GPUs\n[128,10000,4096]",
			pos="3174,10663",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l6_gpu0 -> global_agg_l6	[pos="e,3064.3,10664 390.01,10770 412.32,10760 435.98,10752 459,10747 713.5,10688 2561.9,10669 3053.9,10664"];
		agg_l6_gpu1 -> global_agg_l6	[pos="e,3064.2,10665 752.03,10770 774.34,10760 797.99,10752 821,10747 1038.8,10696 2605.3,10671 3054.1,10665"];
		agg_l6_gpu2 -> global_agg_l6	[pos="e,3064.5,10666 1114.1,10770 1136.4,10761 1160,10752 1183,10747 1364.4,10704 2652.2,10674 3054.3,10666"];
		agg_l6_gpu3 -> global_agg_l6	[pos="e,3064.2,10664 1476.1,10770 1498.4,10761 1522,10752 1545,10747 1831.2,10677 2727.6,10666 3053.8,10664"];
		agg_l6_gpu4 -> global_agg_l6	[pos="e,3064.4,10666 1838.2,10770 1860.5,10761 1884.1,10752 1907,10747 2122.1,10693 2781.5,10672 3054.1,10666"];
		agg_l6_gpu5 -> global_agg_l6	[pos="e,3065.3,10669 2200.3,10771 2222.6,10761 2246.2,10753 2269,10747 2414.3,10708 2844.5,10681 3055.1,10670"];
		agg_l6_gpu6 -> global_agg_l6	[pos="e,3066,10671 2562.6,10772 2584.9,10762 2608.3,10753 2631,10747 2773.7,10704 2944.3,10683 3055.7,10672"];
		agg_l6_gpu7 -> global_agg_l6	[pos="e,3099,10698 2926.5,10776 2979.5,10752 3041.2,10724 3089.8,10702"];
		agg_l6_gpu8 -> global_agg_l6	[pos="e,3174,10711 3174,10747 3174,10738 3174,10729 3174,10721"];
		agg_l6_gpu9 -> global_agg_l6	[pos="e,3249.1,10698 3365.6,10751 3328.4,10734 3290.6,10717 3258.5,10702"];
		agg_l6_gpu10 -> global_agg_l6	[pos="e,3282,10671 3727,10750 3723.6,10749 3720.3,10748 3717,10747 3574.3,10704 3403.7,10683 3292.3,10672"];
		agg_l6_gpu11 -> global_agg_l6	[pos="e,3282.7,10669 4088.8,10749 4085.5,10748 4082.3,10748 4079,10747 3933.7,10708 3503.5,10681 3292.9,10670"];
		agg_l6_gpu12 -> global_agg_l6	[pos="e,3283.6,10666 4450.8,10749 4447.5,10748 4444.3,10747 4441,10747 4225.9,10693 3566.5,10672 3293.9,10666"];
		agg_l6_gpu13 -> global_agg_l6	[pos="e,3283.8,10664 4812.8,10749 4809.6,10748 4806.3,10747 4803,10747 4516.8,10677 3620.4,10666 3294.2,10664"];
		agg_l6_gpu14 -> global_agg_l6	[pos="e,3283.5,10666 5174.9,10749 5171.6,10748 5168.3,10747 5165,10747 4983.6,10704 3695.8,10674 3293.7,10666"];
		agg_l6_gpu15 -> global_agg_l6	[pos="e,3283.8,10665 5536.6,10749 5533.4,10748 5530.2,10747 5527,10747 5309.2,10696 3742.7,10671 3293.9,10665"];
		residual_l6	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 6\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3174,10537",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l6 -> residual_l6	[pos="e,3174,10579 3174,10614 3174,10606 3174,10597 3174,10589"];
	}
	subgraph cluster_layer_7 {
		graph [bb="98,9451.2,5888,10479",
			label="Layer 7 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="2993,10468",
			lwidth=3.29,
			style=dashed
		];
		dist_l7	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 7\nAll GPUs\n[128,10000,4096]",
			pos="3174,10400",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l7_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="463,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu0	[pos="e,546.01,10292 3072.2,10398 2669.5,10390 1187.7,10361 720,10316 665.31,10311 604.58,10302 555.89,10293"];
		mha_l7_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="812,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu1	[pos="e,895.2,10291 3072.2,10399 2768,10399 1840,10390 1075,10316 1018.4,10311 955.49,10301 905.37,10293"];
		mha_l7_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1167,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu2	[pos="e,1250,10282 3072.9,10394 2836.1,10382 2226.8,10350 1718,10316 1557,10306 1369.6,10292 1260.1,10283"];
		mha_l7_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1810,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu3	[pos="e,1893,10287 3073.2,10393 2886.9,10381 2476.1,10352 2131,10316 2054.1,10308 1967.1,10297 1903.1,10289"];
		mha_l7_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2223,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu4	[pos="e,2306.3,10294 3074.1,10391 2930.9,10378 2659.5,10352 2430,10316 2392.6,10311 2351.7,10303 2316.2,10296"];
		mha_l7_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2522,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu5	[pos="e,2605.2,10300 3076.5,10386 2974.8,10372 2810.9,10347 2671,10316 2652.8,10312 2633.5,10308 2615,10303"];
		mha_l7_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2763,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu6	[pos="e,2846.2,10304 3086.8,10376 3029,10359 2951.8,10337 2884,10316 2874.8,10313 2865.2,10310 2855.7,10307"];
		mha_l7_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2976,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu7	[pos="e,3040.9,10316 3113.5,10362 3093.3,10349 3070.6,10335 3049.5,10322"];
		mha_l7_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu8	[pos="e,3174,10316 3174,10352 3174,10344 3174,10335 3174,10327"];
		mha_l7_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3434,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu9	[pos="e,3350.9,10315 3244.7,10366 3274.5,10352 3309.7,10335 3341.5,10320"];
		mha_l7_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3758,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu10	[pos="e,3674.8,10293 3266.2,10380 3375.2,10357 3555.4,10319 3664.7,10296"];
		mha_l7_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4088,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu11	[pos="e,4005,10291 3273,10389 3404.9,10374 3645.4,10346 3850,10316 3897.9,10309 3951,10300 3994.9,10293"];
		mha_l7_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4422,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu12	[pos="e,4338.8,10292 3275,10394 3456.5,10383 3850,10357 4180,10316 4229.3,10310 4284,10301 4328.8,10293"];
		mha_l7_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4753,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu13	[pos="e,4669.8,10292 3275.6,10397 3499.8,10390 4053.5,10369 4514,10316 4562.3,10311 4615.7,10302 4659.7,10294"];
		mha_l7_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5128,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu14	[pos="e,5045,10290 3276,10398 3537.3,10392 4252.3,10373 4845,10316 4908.6,10310 4979.8,10300 5034.9,10291"];
		mha_l7_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 7\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5492,10275",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l7 -> mha_l7_gpu15	[pos="e,5409,10291 3275.9,10399 3575,10397 4476.3,10387 5220,10316 5279.8,10311 5346.6,10301 5399,10292"];
		gate_l7_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="298,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu0 -> gate_l7_gpu0	[pos="e,383.65,10198 420.51,10233 411.36,10224 401.36,10215 391.13,10205"];
		gate_l7_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="642,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu1 -> gate_l7_gpu1	[pos="e,730.24,10198 768.22,10233 758.71,10224 748.29,10214 737.64,10205"];
		gate_l7_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1066,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu2 -> gate_l7_gpu2	[pos="e,1118.4,10198 1141,10233 1135.7,10225 1129.9,10216 1123.9,10206"];
		gate_l7_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1447,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu3 -> gate_l7_gpu3	[pos="e,1601.2,10183 1726.7,10237 1692.2,10222 1650.8,10204 1610.6,10187"];
		gate_l7_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1806,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu4 -> gate_l7_gpu4	[pos="e,1962.2,10188 2139.8,10250 2093.7,10236 2035.7,10217 1985,10197 1980.6,10196 1976.1,10194 1971.5,10192"];
		gate_l7_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2154,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu5 -> gate_l7_gpu5	[pos="e,2311.3,10190 2438.9,10243 2404.1,10229 2363.4,10213 2327,10197 2324.9,10196 2322.8,10195 2320.6,10195"];
		gate_l7_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2496,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu6 -> gate_l7_gpu6	[pos="e,2634.4,10197 2694.6,10233 2678.7,10224 2661.1,10213 2643.2,10203"];
		gate_l7_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2836,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu7 -> gate_l7_gpu7	[pos="e,2908.7,10198 2939.9,10233 2932.3,10224 2924,10215 2915.5,10205"];
		gate_l7_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3174,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu8 -> gate_l7_gpu8	[pos="e,3174,10198 3174,10233 3174,10225 3174,10216 3174,10208"];
		gate_l7_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3523,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu9 -> gate_l7_gpu9	[pos="e,3476.8,10198 3456.9,10233 3461.6,10225 3466.6,10216 3471.8,10207"];
		gate_l7_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3870,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu10 -> gate_l7_gpu10	[pos="e,3811.9,10198 3786.8,10233 3792.8,10225 3799.3,10215 3806,10206"];
		gate_l7_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4219,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu11 -> gate_l7_gpu11	[pos="e,4151,10198 4121.7,10233 4128.9,10224 4136.6,10215 4144.6,10205"];
		gate_l7_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4575,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu12 -> gate_l7_gpu12	[pos="e,4495.6,10198 4461.4,10233 4469.8,10224 4479,10215 4488.4,10205"];
		gate_l7_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4942,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu13 -> gate_l7_gpu13	[pos="e,4846.5,10195 4801.7,10233 4813.1,10223 4825.7,10213 4838.5,10202"];
		gate_l7_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5311,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu14 -> gate_l7_gpu14	[pos="e,5216.4,10197 5175.1,10233 5185.6,10224 5197,10214 5208.7,10204"];
		gate_l7_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 7\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5672,10114",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l7_gpu15 -> gate_l7_gpu15	[pos="e,5578.6,10198 5538.4,10233 5548.5,10224 5559.7,10214 5571.1,10204"];
		expert_l7_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 7\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="285,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu0 -> expert_l7_gpu0	[pos="e,288.35,9995.6 291.27,10031 290.56,10023 289.85,10014 289.17,10006",
			style=dashed];
		expert_l7_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 7\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="641,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu1 -> expert_l7_gpu1	[pos="e,641.26,9995.6 641.48,10031 641.43,10023 641.37,10014 641.32,10006",
			style=dashed];
		expert_l7_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 7\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1034,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu2 -> expert_l7_gpu2	[pos="e,1042.2,9995.6 1049.4,10031 1047.7,10022 1045.9,10014 1044.2,10005",
			style=dashed];
		expert_l7_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 7\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1405,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu3 -> expert_l7_gpu3	[pos="e,1415.8,9995.6 1425.3,10031 1422.9,10022 1420.6,10014 1418.4,10005",
			style=dashed];
		expert_l7_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 7\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1766,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu4 -> expert_l7_gpu4	[pos="e,1776.3,9995.6 1785.3,10031 1783.1,10022 1780.9,10014 1778.8,10005",
			style=dashed];
		expert_l7_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 7\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2121,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu5 -> expert_l7_gpu5	[pos="e,2129.5,9995.6 2136.9,10031 2135.1,10022 2133.3,10014 2131.5,10005",
			style=dashed];
		expert_l7_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 7\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2473,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu6 -> expert_l7_gpu6	[pos="e,2478.9,9995.6 2484.1,10031 2482.8,10023 2481.6,10014 2480.4,10006",
			style=dashed];
		expert_l7_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 7\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2824,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu7 -> expert_l7_gpu7	[pos="e,2827.1,9995.6 2829.8,10031 2829.1,10023 2828.5,10014 2827.9,10006",
			style=dashed];
		expert_l7_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 7\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu8 -> expert_l7_gpu8	[pos="e,3174,9995.6 3174,10031 3174,10023 3174,10014 3174,10006",
			style=dashed];
		expert_l7_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 7\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3530,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu9 -> expert_l7_gpu9	[pos="e,3528.2,9995.6 3526.6,10031 3527,10023 3527.4,10014 3527.8,10006",
			style=dashed];
		expert_l7_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 7\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3879,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu10 -> expert_l7_gpu10	[pos="e,3876.7,9995.6 3874.7,10031 3875.2,10023 3875.6,10014 3876.1,10006",
			style=dashed];
		expert_l7_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 7\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4254,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu11 -> expert_l7_gpu11	[pos="e,4245,9995.6 4237.1,10031 4239.1,10022 4241,10014 4242.8,10005",
			style=dashed];
		expert_l7_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 7\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4594,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu12 -> expert_l7_gpu12	[pos="e,4589.1,9995.6 4584.8,10031 4585.9,10023 4586.9,10014 4587.9,10006",
			style=dashed];
		expert_l7_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 7\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4962,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu13 -> expert_l7_gpu13	[pos="e,4956.9,9995.6 4952.4,10031 4953.5,10023 4954.5,10014 4955.6,10006",
			style=dashed];
		expert_l7_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 7\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5323,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu14 -> expert_l7_gpu14	[pos="e,5319.9,9995.6 5317.2,10031 5317.9,10023 5318.5,10014 5319.1,10006",
			style=dashed];
		expert_l7_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 7\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5684,9953.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l7_gpu15 -> expert_l7_gpu15	[pos="e,5680.9,9995.6 5678.2,10031 5678.9,10023 5679.5,10014 5680.1,10006",
			style=dashed];
		agg_l7_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="278,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu0 -> agg_l7_gpu0	[pos="e,281.63,9876.6 283.2,9912 282.85,9904.1 282.47,9895.5 282.08,9886.6"];
		agg_l7_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="640,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu1 -> agg_l7_gpu1	[pos="e,640.52,9876.6 640.74,9912 640.69,9904.1 640.64,9895.5 640.58,9886.6"];
		agg_l7_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1002,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu2 -> agg_l7_gpu2	[pos="e,1018.6,9876.6 1025.8,9912 1024.2,9904.1 1022.4,9895.5 1020.6,9886.6"];
		agg_l7_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1364,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu3 -> agg_l7_gpu3	[pos="e,1385.3,9876.6 1394.4,9912 1392.4,9904 1390.1,9895.3 1387.8,9886.4"];
		agg_l7_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1726,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu4 -> agg_l7_gpu4	[pos="e,1746.8,9876.6 1755.7,9912 1753.7,9904 1751.5,9895.3 1749.2,9886.4"];
		agg_l7_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2088,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu5 -> agg_l7_gpu5	[pos="e,2105.1,9876.6 2112.5,9912 2110.9,9904.1 2109.1,9895.5 2107.2,9886.6"];
		agg_l7_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2450,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu6 -> agg_l7_gpu6	[pos="e,2461.9,9876.6 2467.1,9912 2465.9,9904.1 2464.7,9895.5 2463.4,9886.6"];
		agg_l7_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2812,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu7 -> agg_l7_gpu7	[pos="e,2818.2,9876.6 2820.9,9912 2820.3,9904.1 2819.7,9895.5 2819,9886.6"];
		agg_l7_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu8 -> agg_l7_gpu8	[pos="e,3174,9876.6 3174,9912 3174,9904.1 3174,9895.5 3174,9886.6"];
		agg_l7_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3536,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu9 -> agg_l7_gpu9	[pos="e,3532.9,9876.6 3531.5,9912 3531.8,9904.1 3532.2,9895.5 3532.5,9886.6"];
		agg_l7_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3898,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu10 -> agg_l7_gpu10	[pos="e,3888.1,9876.6 3883.9,9912 3884.8,9904.1 3885.9,9895.5 3886.9,9886.6"];
		agg_l7_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4260,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu11 -> agg_l7_gpu11	[pos="e,4256.9,9876.6 4255.5,9912 4255.8,9904.1 4256.2,9895.5 4256.5,9886.6"];
		agg_l7_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4622,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu12 -> agg_l7_gpu12	[pos="e,4607.5,9876.6 4601.2,9912 4602.6,9904.1 4604.1,9895.5 4605.7,9886.6"];
		agg_l7_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4984,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu13 -> agg_l7_gpu13	[pos="e,4972.6,9876.6 4967.7,9912 4968.8,9904.1 4970,9895.5 4971.2,9886.6"];
		agg_l7_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5346,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu14 -> agg_l7_gpu14	[pos="e,5334.1,9876.6 5328.9,9912 5330.1,9904.1 5331.3,9895.5 5332.6,9886.6"];
		agg_l7_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 7\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5708,9793.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l7_gpu15 -> agg_l7_gpu15	[pos="e,5695.5,9876.6 5690.2,9912 5691.4,9904.1 5692.7,9895.5 5694,9886.6"];
		global_agg_l7	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 7\nAll GPUs\n[128,10000,4096]",
			pos="3174,9626.2",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l7_gpu0 -> global_agg_l7	[pos="e,3064.3,9628.1 390.01,9733.4 412.32,9724 435.98,9715.7 459,9710.3 713.5,9651.3 2561.9,9632.2 3053.9,9628.1"];
		agg_l7_gpu1 -> global_agg_l7	[pos="e,3064.2,9628.6 752.03,9733.5 774.34,9724.1 797.99,9715.7 821,9710.3 1038.8,9659.2 2605.3,9634.8 3054.1,9628.8"];
		agg_l7_gpu2 -> global_agg_l7	[pos="e,3064.5,9629.4 1114.1,9733.6 1136.4,9724.2 1160,9715.8 1183,9710.3 1364.4,9667.2 2652.2,9637.8 3054.3,9629.6"];
		agg_l7_gpu3 -> global_agg_l7	[pos="e,3064.2,9627.5 1476.1,9733.8 1498.4,9724.4 1522,9715.9 1545,9710.3 1831.2,9640.9 2727.6,9629.4 3053.8,9627.6"];
		agg_l7_gpu4 -> global_agg_l7	[pos="e,3064.4,9629.4 1838.2,9734 1860.5,9724.6 1884.1,9716.1 1907,9710.3 2122.1,9656.5 2781.5,9635.9 3054.1,9629.6"];
		agg_l7_gpu5 -> global_agg_l7	[pos="e,3065.3,9632.7 2200.3,9734.5 2222.6,9725 2246.2,9716.4 2269,9710.3 2414.3,9671.9 2844.5,9644.7 3055.1,9633.2"];
		agg_l7_gpu6 -> global_agg_l7	[pos="e,3066,9635 2562.6,9735.6 2584.9,9726.1 2608.3,9717.1 2631,9710.3 2773.7,9668 2944.3,9646.4 3055.7,9636"];
		agg_l7_gpu7 -> global_agg_l7	[pos="e,3099,9661.5 2926.5,9740.1 2979.5,9716 3041.2,9687.8 3089.8,9665.7"];
		agg_l7_gpu8 -> global_agg_l7	[pos="e,3174,9674.4 3174,9710.3 3174,9701.6 3174,9693 3174,9684.7"];
		agg_l7_gpu9 -> global_agg_l7	[pos="e,3249.1,9661.5 3365.6,9714.6 3328.4,9697.6 3290.6,9680.4 3258.5,9665.8"];
		agg_l7_gpu10 -> global_agg_l7	[pos="e,3282,9635 3727,9713.4 3723.6,9712.3 3720.3,9711.3 3717,9710.3 3574.3,9668 3403.7,9646.4 3292.3,9636"];
		agg_l7_gpu11 -> global_agg_l7	[pos="e,3282.7,9632.7 4088.8,9713.1 4085.5,9712.1 4082.3,9711.2 4079,9710.3 3933.7,9671.9 3503.5,9644.7 3292.9,9633.2"];
		agg_l7_gpu12 -> global_agg_l7	[pos="e,3283.6,9629.4 4450.8,9712.9 4447.5,9712 4444.3,9711.1 4441,9710.3 4225.9,9656.5 3566.5,9635.9 3293.9,9629.6"];
		agg_l7_gpu13 -> global_agg_l7	[pos="e,3283.8,9627.5 4812.8,9712.9 4809.6,9712 4806.3,9711.1 4803,9710.3 4516.8,9640.9 3620.4,9629.4 3294.2,9627.6"];
		agg_l7_gpu14 -> global_agg_l7	[pos="e,3283.5,9629.4 5174.9,9712.8 5171.6,9711.9 5168.3,9711.1 5165,9710.3 4983.6,9667.2 3695.8,9637.8 3293.7,9629.6"];
		agg_l7_gpu15 -> global_agg_l7	[pos="e,3283.8,9628.6 5536.6,9712.7 5533.4,9711.9 5530.2,9711.1 5527,9710.3 5309.2,9659.2 3742.7,9634.8 3293.9,9628.8"];
		residual_l7	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 7\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3174,9500.7",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l7 -> residual_l7	[pos="e,3174,9542.3 3174,9577.8 3174,9569.5 3174,9560.8 3174,9552.4"];
	}
	subgraph cluster_layer_8 {
		graph [bb="98,8414.8,5888,9443.2",
			label="Layer 8 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="2993,9431.7",
			lwidth=3.29,
			style=dashed
		];
		dist_l8	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 8\nAll GPUs\n[128,10000,4096]",
			pos="3174,9364.1",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l8_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="512,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu0	[pos="e,595.1,9253.3 3072.2,9363.2 2743.4,9362.9 1680.4,9355.6 805,9280 737.91,9274.2 662.68,9263.7 605.25,9254.9"];
		mha_l8_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="897,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu1	[pos="e,980.05,9251.6 3072.1,9361.6 2782.6,9356.8 1930.2,9338.5 1225,9280 1145.6,9273.4 1055.9,9262.1 990.36,9253"];
		mha_l8_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1317,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu2	[pos="e,1400,9255.6 3071.8,9361.8 2816.5,9357.7 2130.4,9341.4 1562,9280 1511.5,9274.5 1455.6,9265.5 1409.9,9257.4"];
		mha_l8_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1654,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu3	[pos="e,1737.2,9262.6 3072,9362.9 2845.8,9361.1 2285.1,9349.5 1822,9280 1797.5,9276.3 1771.3,9270.8 1747.1,9265"];
		mha_l8_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1914,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu4	[pos="e,1997.1,9257.3 3072.7,9358.6 2885.7,9349.6 2473.6,9326 2129,9280 2088.8,9274.6 2044.8,9266.7 2007.1,9259.3"];
		mha_l8_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2221,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu5	[pos="e,2304.2,9250.3 3076,9350.4 2891.6,9326.5 2494.9,9275 2314.2,9251.6"];
		mha_l8_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2634,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu6	[pos="e,2717.4,9258.6 3083,9342.3 2984.1,9319.6 2826.9,9283.6 2727.1,9260.8"];
		mha_l8_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2933,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu7	[pos="e,3012,9280 3105.9,9328.2 3079.5,9314.6 3049,9299 3021,9284.6"];
		mha_l8_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu8	[pos="e,3174,9280.2 3174,9315.7 3174,9307.3 3174,9298.6 3174,9290.2"];
		mha_l8_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3429,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu9	[pos="e,3345.6,9279.9 3244,9329.1 3272.5,9315.4 3305.8,9299.2 3336.2,9284.5"];
		mha_l8_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3734,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu10	[pos="e,3650.7,9257.9 3265.5,9342.9 3369,9320 3536.6,9283.1 3640.8,9260.1"];
		mha_l8_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4086,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu11	[pos="e,4003,9253 3272.4,9351.4 3400.2,9336 3630,9307.7 3826,9280 3881.4,9272.1 3943.4,9262.5 3992.9,9254.6"];
		mha_l8_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4452,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu12	[pos="e,4368.8,9253.2 3275,9356.9 3456.3,9345.3 3848.5,9317.9 4178,9280 4238.4,9273 4305.9,9263.1 4358.8,9254.8"];
		mha_l8_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4769,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu13	[pos="e,4685.7,9256.9 3275.8,9361 3503.7,9355.4 4072,9336.6 4544,9280 4587.6,9274.8 4635.5,9266.5 4675.9,9258.8"];
		mha_l8_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5144,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu14	[pos="e,5061,9253.5 3276,9361.4 3539,9356.2 4261.9,9337.5 4861,9280 4924.6,9273.9 4995.8,9263.7 5050.9,9255"];
		mha_l8_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 8\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5512,9238.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l8 -> mha_l8_gpu15	[pos="e,5428.9,9254 3275.9,9362.8 3576.5,9361 4485.8,9350 5236,9280 5297.2,9274.3 5365.5,9264.3 5418.8,9255.7"];
		gate_l8_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="312,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu0 -> gate_l8_gpu0	[pos="e,415.65,9161.1 460.75,9196.9 449.25,9187.8 436.61,9177.8 423.71,9167.5"];
		gate_l8_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="661,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu1 -> gate_l8_gpu1	[pos="e,783.3,9161.1 836.53,9196.9 822.7,9187.6 807.48,9177.4 791.95,9166.9"];
		gate_l8_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1005,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu2 -> gate_l8_gpu2	[pos="e,1164.6,9160.1 1237.1,9196.9 1217.5,9186.9 1195.7,9175.9 1173.7,9164.7"];
		gate_l8_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1417,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu3 -> gate_l8_gpu3	[pos="e,1539.8,9161.1 1593.3,9196.9 1579.4,9187.6 1564.1,9177.4 1548.5,9166.9"];
		gate_l8_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1791,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu4 -> gate_l8_gpu4	[pos="e,1854.8,9161.3 1882.3,9196.7 1875.7,9188.2 1868.5,9178.8 1861.1,9169.3"];
		gate_l8_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2147,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu5 -> gate_l8_gpu5	[pos="e,2185.4,9161.3 2201.9,9196.7 2198.1,9188.5 2194,9179.6 2189.7,9170.5"];
		gate_l8_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2493,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu6 -> gate_l8_gpu6	[pos="e,2566.2,9161.3 2597.7,9196.7 2590,9188.1 2581.7,9178.7 2573.1,9169"];
		gate_l8_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2835,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu7 -> gate_l8_gpu7	[pos="e,2885.9,9161.3 2907.8,9196.7 2902.6,9188.3 2897,9179.2 2891.2,9169.9"];
		gate_l8_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3174,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu8 -> gate_l8_gpu8	[pos="e,3174,9161.3 3174,9196.7 3174,9188.7 3174,9180.1 3174,9171.3"];
		gate_l8_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3518,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu9 -> gate_l8_gpu9	[pos="e,3471.8,9161.3 3451.9,9196.7 3456.6,9188.4 3461.6,9179.4 3466.8,9170.2"];
		gate_l8_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3867,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu10 -> gate_l8_gpu10	[pos="e,3798,9161.3 3768.3,9196.7 3775.5,9188.1 3783.4,9178.7 3791.5,9169"];
		gate_l8_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4223,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu11 -> gate_l8_gpu11	[pos="e,4151.9,9161.3 4121.3,9196.7 4128.7,9188.1 4136.9,9178.7 4145.2,9169"];
		gate_l8_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4583,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu12 -> gate_l8_gpu12	[pos="e,4515,9161.3 4485.7,9196.7 4492.9,9188.1 4500.6,9178.7 4508.6,9169"];
		gate_l8_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4949,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu13 -> gate_l8_gpu13	[pos="e,4855.6,9161.3 4815.4,9196.7 4825.5,9187.7 4836.7,9177.9 4848.1,9167.9"];
		gate_l8_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5310,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu14 -> gate_l8_gpu14	[pos="e,5223.8,9161.3 5186.7,9196.7 5195.9,9187.9 5206,9178.3 5216.3,9168.5"];
		gate_l8_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 8\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5671,9078",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l8_gpu15 -> gate_l8_gpu15	[pos="e,5588.5,9161.3 5552.9,9196.7 5561.8,9187.9 5571.4,9178.3 5581.3,9168.5"];
		expert_l8_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 8\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="306,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu0 -> expert_l8_gpu0	[pos="e,307.54,8959.3 308.89,8995 308.56,8986.3 308.24,8977.6 307.93,8969.4",
			style=dashed];
		expert_l8_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 8\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="647,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu1 -> expert_l8_gpu1	[pos="e,650.6,8959.3 653.75,8995 652.98,8986.3 652.22,8977.6 651.49,8969.4",
			style=dashed];
		expert_l8_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 8\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1003,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu2 -> expert_l8_gpu2	[pos="e,1003.5,8959.3 1004,8995 1003.9,8986.3 1003.7,8977.6 1003.6,8969.4",
			style=dashed];
		expert_l8_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 8\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1390,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu3 -> expert_l8_gpu3	[pos="e,1396.9,8959.3 1403,8995 1401.5,8986.3 1400.1,8977.6 1398.7,8969.4",
			style=dashed];
		expert_l8_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 8\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1758,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu4 -> expert_l8_gpu4	[pos="e,1766.5,8959.3 1773.9,8995 1772.1,8986.2 1770.3,8977.4 1768.5,8969.1",
			style=dashed];
		expert_l8_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 8\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2117,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu5 -> expert_l8_gpu5	[pos="e,2124.7,8959.3 2131.5,8995 2129.8,8986.2 2128.1,8977.4 2126.6,8969.1",
			style=dashed];
		expert_l8_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 8\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2471,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu6 -> expert_l8_gpu6	[pos="e,2476.7,8959.3 2481.6,8995 2480.4,8986.3 2479.2,8977.6 2478.1,8969.4",
			style=dashed];
		expert_l8_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 8\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2823,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu7 -> expert_l8_gpu7	[pos="e,2826.1,8959.3 2828.8,8995 2828.1,8986.3 2827.5,8977.6 2826.9,8969.4",
			style=dashed];
		expert_l8_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 8\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu8 -> expert_l8_gpu8	[pos="e,3174,8959.3 3174,8995 3174,8986.3 3174,8977.6 3174,8969.4",
			style=dashed];
		expert_l8_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 8\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3524,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu9 -> expert_l8_gpu9	[pos="e,3522.5,8959.3 3521.1,8995 3521.4,8986.3 3521.8,8977.6 3522.1,8969.4",
			style=dashed];
		expert_l8_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 8\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3886,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu10 -> expert_l8_gpu10	[pos="e,3881.1,8959.3 3876.8,8995 3877.9,8986.3 3878.9,8977.6 3879.9,8969.4",
			style=dashed];
		expert_l8_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 8\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4238,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu11 -> expert_l8_gpu11	[pos="e,4234.1,8959.3 4230.8,8995 4231.6,8986.3 4232.4,8977.6 4233.2,8969.4",
			style=dashed];
		expert_l8_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 8\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4600,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu12 -> expert_l8_gpu12	[pos="e,4595.6,8959.3 4591.8,8995 4592.7,8986.3 4593.7,8977.6 4594.5,8969.4",
			style=dashed];
		expert_l8_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 8\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4961,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu13 -> expert_l8_gpu13	[pos="e,4957.9,8959.3 4955.2,8995 4955.9,8986.3 4956.5,8977.6 4957.1,8969.4",
			style=dashed];
		expert_l8_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 8\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5322,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu14 -> expert_l8_gpu14	[pos="e,5318.9,8959.3 5316.2,8995 5316.9,8986.3 5317.5,8977.6 5318.1,8969.4",
			style=dashed];
		expert_l8_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 8\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5683,8917.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l8_gpu15 -> expert_l8_gpu15	[pos="e,5679.9,8959.3 5677.2,8995 5677.9,8986.3 5678.5,8977.6 5679.1,8969.4",
			style=dashed];
		agg_l8_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="278,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu0 -> agg_l8_gpu0	[pos="e,292.53,8840.3 298.79,8875.7 297.39,8867.7 295.87,8859.1 294.31,8850.3"];
		agg_l8_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="640,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu1 -> agg_l8_gpu1	[pos="e,643.63,8840.3 645.2,8875.7 644.85,8867.7 644.47,8859.1 644.08,8850.3"];
		agg_l8_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1002,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu2 -> agg_l8_gpu2	[pos="e,1002.5,8840.3 1002.7,8875.7 1002.7,8867.7 1002.6,8859.1 1002.6,8850.3"];
		agg_l8_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1364,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu3 -> agg_l8_gpu3	[pos="e,1377.5,8840.3 1383.3,8875.7 1382,8867.7 1380.6,8859.1 1379.1,8850.3"];
		agg_l8_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1726,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu4 -> agg_l8_gpu4	[pos="e,1742.6,8840.3 1749.8,8875.7 1748.2,8867.7 1746.4,8859.1 1744.6,8850.3"];
		agg_l8_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2088,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu5 -> agg_l8_gpu5	[pos="e,2103.1,8840.3 2109.5,8875.7 2108.1,8867.7 2106.5,8859.1 2104.9,8850.3"];
		agg_l8_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2450,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu6 -> agg_l8_gpu6	[pos="e,2460.9,8840.3 2465.6,8875.7 2464.5,8867.7 2463.4,8859.1 2462.2,8850.3"];
		agg_l8_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2812,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu7 -> agg_l8_gpu7	[pos="e,2817.7,8840.3 2820.2,8875.7 2819.6,8867.7 2819,8859.1 2818.4,8850.3"];
		agg_l8_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu8 -> agg_l8_gpu8	[pos="e,3174,8840.3 3174,8875.7 3174,8867.7 3174,8859.1 3174,8850.3"];
		agg_l8_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3536,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu9 -> agg_l8_gpu9	[pos="e,3529.8,8840.3 3527.1,8875.7 3527.7,8867.7 3528.3,8859.1 3529,8850.3"];
		agg_l8_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3898,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu10 -> agg_l8_gpu10	[pos="e,3891.8,8840.3 3889.1,8875.7 3889.7,8867.7 3890.3,8859.1 3891,8850.3"];
		agg_l8_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4260,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu11 -> agg_l8_gpu11	[pos="e,4248.6,8840.3 4243.7,8875.7 4244.8,8867.7 4246,8859.1 4247.2,8850.3"];
		agg_l8_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4622,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu12 -> agg_l8_gpu12	[pos="e,4610.6,8840.3 4605.7,8875.7 4606.8,8867.7 4608,8859.1 4609.2,8850.3"];
		agg_l8_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4984,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu13 -> agg_l8_gpu13	[pos="e,4972.1,8840.3 4966.9,8875.7 4968.1,8867.7 4969.3,8859.1 4970.6,8850.3"];
		agg_l8_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5346,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu14 -> agg_l8_gpu14	[pos="e,5333.5,8840.3 5328.2,8875.7 5329.4,8867.7 5330.7,8859.1 5332,8850.3"];
		agg_l8_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 8\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5708,8757",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l8_gpu15 -> agg_l8_gpu15	[pos="e,5695,8840.3 5689.4,8875.7 5690.7,8867.7 5692,8859.1 5693.4,8850.3"];
		global_agg_l8	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 8\nAll GPUs\n[128,10000,4096]",
			pos="3174,8589.9",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l8_gpu0 -> global_agg_l8	[pos="e,3064.3,8591.7 390.01,8697.1 412.32,8687.7 435.98,8679.3 459,8674 713.5,8614.9 2561.9,8595.9 3053.9,8591.8"];
		agg_l8_gpu1 -> global_agg_l8	[pos="e,3064.2,8592.3 752.03,8697.2 774.34,8687.8 797.99,8679.4 821,8674 1038.8,8622.9 2605.3,8598.4 3054.1,8592.4"];
		agg_l8_gpu2 -> global_agg_l8	[pos="e,3064.5,8593 1114.1,8697.3 1136.4,8687.9 1160,8679.5 1183,8674 1364.4,8630.8 2652.2,8601.5 3054.3,8593.2"];
		agg_l8_gpu3 -> global_agg_l8	[pos="e,3064.2,8591.2 1476.1,8697.4 1498.4,8688 1522,8679.6 1545,8674 1831.2,8604.5 2727.6,8593.1 3053.8,8591.3"];
		agg_l8_gpu4 -> global_agg_l8	[pos="e,3064.4,8593.1 1838.2,8697.7 1860.5,8688.3 1884.1,8679.7 1907,8674 2122.1,8620.1 2781.5,8599.6 3054.1,8593.3"];
		agg_l8_gpu5 -> global_agg_l8	[pos="e,3065.3,8596.4 2200.3,8698.2 2222.6,8688.7 2246.2,8680 2269,8674 2414.3,8635.6 2844.5,8608.3 3055.1,8596.9"];
		agg_l8_gpu6 -> global_agg_l8	[pos="e,3066,8598.7 2562.6,8699.3 2584.9,8689.7 2608.3,8680.7 2631,8674 2773.7,8631.6 2944.3,8610 3055.7,8599.6"];
		agg_l8_gpu7 -> global_agg_l8	[pos="e,3099,8625.1 2926.5,8703.8 2979.5,8679.6 3041.2,8651.5 3089.8,8629.3"];
		agg_l8_gpu8 -> global_agg_l8	[pos="e,3174,8638.1 3174,8673.9 3174,8665.3 3174,8656.6 3174,8648.4"];
		agg_l8_gpu9 -> global_agg_l8	[pos="e,3249.1,8625.2 3365.6,8678.3 3328.4,8661.3 3290.6,8644.1 3258.5,8629.4"];
		agg_l8_gpu10 -> global_agg_l8	[pos="e,3282,8598.7 3727,8677.1 3723.6,8676 3720.3,8675 3717,8674 3574.3,8631.6 3403.7,8610 3292.3,8599.6"];
		agg_l8_gpu11 -> global_agg_l8	[pos="e,3282.7,8596.4 4088.8,8676.7 4085.5,8675.8 4082.3,8674.9 4079,8674 3933.7,8635.6 3503.5,8608.3 3292.9,8596.9"];
		agg_l8_gpu12 -> global_agg_l8	[pos="e,3283.6,8593.1 4450.8,8676.6 4447.5,8675.7 4444.3,8674.8 4441,8674 4225.9,8620.1 3566.5,8599.6 3293.9,8593.3"];
		agg_l8_gpu13 -> global_agg_l8	[pos="e,3283.8,8591.2 4812.8,8676.5 4809.6,8675.6 4806.3,8674.8 4803,8674 4516.8,8604.5 3620.4,8593.1 3294.2,8591.3"];
		agg_l8_gpu14 -> global_agg_l8	[pos="e,3283.5,8593 5174.9,8676.5 5171.6,8675.6 5168.3,8674.8 5165,8674 4983.6,8630.8 3695.8,8601.5 3293.7,8593.2"];
		agg_l8_gpu15 -> global_agg_l8	[pos="e,3283.8,8592.3 5536.6,8676.4 5533.4,8675.6 5530.2,8674.7 5527,8674 5309.2,8622.9 3742.7,8598.4 3293.9,8592.4"];
		residual_l8	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 8\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="5306,8464.3",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l8 -> residual_l8	[pos="e,5204.5,8471.2 3282.7,8582.6 3647.3,8561.5 4825.2,8493.2 5194.3,8471.8"];
	}
	subgraph cluster_layer_9 {
		graph [bb="928,7378.5,6718,8406.8",
			label="Layer 9 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3823,8395.3",
			lwidth=3.29,
			style=dashed
		];
		dist_l9	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 9\nAll GPUs\n[128,10000,4096]",
			pos="4004,8327.7",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l9_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1313,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu0	[pos="e,1396.2,8208.4 3902.7,8323.1 3610.2,8312.3 2739.4,8279.5 2017,8243.7 1798.2,8232.8 1541.3,8217.3 1406.4,8209"];
		mha_l9_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2109,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu1	[pos="e,2192.4,8212.8 3902.7,8322.7 3661,8312.8 3031.5,8284.9 2507,8243.7 2402.6,8235.5 2283.1,8222.9 2202.5,8213.9"];
		mha_l9_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2599,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu2	[pos="e,2682.1,8218.9 3902.5,8322.6 3700.4,8313.7 3233.7,8289.7 2844,8243.7 2793.5,8237.7 2737.6,8228.6 2692,8220.6"];
		mha_l9_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2936,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu3	[pos="e,3019.3,8225.8 3902.8,8322.2 3735.6,8313.6 3391.5,8291.3 3104,8243.7 3079.5,8239.6 3053.4,8234 3029.2,8228.2"];
		mha_l9_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3196,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu4	[pos="e,3279.3,8231.6 3903.4,8320.1 3770.2,8310 3528.5,8287.2 3326,8243.7 3314,8241.1 3301.4,8237.9 3289.1,8234.4"];
		mha_l9_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3418,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu5	[pos="e,3501.1,8235.3 3905.6,8314.7 3808.7,8301.6 3657.2,8278 3529,8243.7 3523,8242.1 3516.9,8240.3 3510.8,8238.4"];
		mha_l9_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3621,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu6	[pos="e,3704.3,8236.9 3916.3,8303 3860.6,8287.4 3787.1,8265.8 3723,8243.7 3719.9,8242.6 3716.8,8241.5 3713.7,8240.4"];
		mha_l9_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3815,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu7	[pos="e,3877,8243.7 3945.2,8288.3 3926.4,8276 3905.2,8262.2 3885.6,8249.3"];
		mha_l9_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu8	[pos="e,4004,8243.8 4004,8279.3 4004,8271 4004,8262.3 4004,8253.9"];
		mha_l9_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4259,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu9	[pos="e,4175.6,8243.6 4074,8292.8 4102.5,8279 4135.8,8262.9 4166.2,8248.1"];
		mha_l9_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4576,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu10	[pos="e,4492.7,8221.2 4095.9,8306.9 4202.2,8283.9 4376.1,8246.3 4482.9,8223.3"];
		mha_l9_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4916,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu11	[pos="e,4832.9,8217.5 4102.6,8315.6 4232.4,8300.6 4467.6,8272.6 4668,8243.7 4719.3,8236.3 4776.4,8227 4822.8,8219.2"];
		mha_l9_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5258,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu12	[pos="e,5174.9,8218.3 4105.1,8321 4286.4,8310.1 4678.8,8283.9 5008,8243.7 5060,8237.3 5117.9,8228.1 5164.8,8220"];
		mha_l9_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5614,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu13	[pos="e,5530.7,8217.9 4105.6,8323.6 4330.4,8316 4886.8,8293.4 5350,8243.7 5406.9,8237.6 5470.4,8227.9 5520.8,8219.6"];
		mha_l9_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5979,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu14	[pos="e,5895.9,8217.7 4105.9,8325.3 4370.6,8320.7 5101,8303.2 5706,8243.7 5766.1,8237.8 5833.3,8227.8 5885.9,8219.3"];
		mha_l9_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 9\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6319,8202.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l9 -> mha_l9_gpu15	[pos="e,6235.8,8219.3 4105.9,8327 4407.2,8326.9 5319.3,8319.9 6071,8243.7 6122.5,8238.4 6179.4,8229.4 6225.8,8221.1"];
		gate_l9_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1109,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu0 -> gate_l9_gpu0	[pos="e,1214.7,8124.8 1260.7,8160.6 1249,8151.4 1236.1,8141.4 1222.9,8131.2"];
		gate_l9_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1546,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu1 -> gate_l9_gpu1	[pos="e,1697.2,8102.7 2025.9,8186.2 1955.5,8172.6 1852.2,8150.9 1764,8124.7 1745.3,8119.1 1726,8112.8 1706.9,8106.1"];
		gate_l9_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1933,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu2 -> gate_l9_gpu2	[pos="e,2088,8112.3 2515.6,8193.8 2420.1,8184 2259.5,8163.2 2126,8124.7 2116.6,8122 2107.1,8118.9 2097.5,8115.6"];
		gate_l9_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2295,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu3 -> gate_l9_gpu3	[pos="e,2451.9,8117 2852.8,8187.4 2720.3,8165.5 2476.1,8125 2475,8124.7 2470.6,8123.3 2466.1,8121.9 2461.7,8120.4"];
		gate_l9_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2644,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu4 -> gate_l9_gpu4	[pos="e,2802.1,8119.3 3112.9,8180 3085.9,8173.4 3055.8,8166.4 3028,8160.7 2935.3,8141.6 2908.3,8153.1 2818,8124.7 2816,8124 2814.1,8123.4 \
2812.1,8122.7"];
		gate_l9_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2987,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu5 -> gate_l9_gpu5	[pos="e,3145,8119.6 3334.9,8174.8 3319.3,8170 3303.2,8165.1 3288,8160.7 3230.5,8143.7 3214.1,8145.7 3158,8124.7 3156.8,8124.2 3155.6,8123.7 \
3154.3,8123.3"];
		gate_l9_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3327,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu6 -> gate_l9_gpu6	[pos="e,3479.4,8124.8 3545.7,8160.6 3527.9,8151 3508.2,8140.4 3488.3,8129.6"];
		gate_l9_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3666,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu7 -> gate_l9_gpu7	[pos="e,3743.3,8124.9 3776.6,8160.3 3768.5,8151.6 3759.5,8142.1 3750.4,8132.4"];
		gate_l9_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4004,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu8 -> gate_l9_gpu8	[pos="e,4004,8124.9 4004,8160.3 4004,8152.4 4004,8143.8 4004,8135"];
		gate_l9_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4348,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu9 -> gate_l9_gpu9	[pos="e,4301.8,8124.9 4281.9,8160.3 4286.6,8152.1 4291.6,8143.1 4296.8,8133.8"];
		gate_l9_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4701,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu10 -> gate_l9_gpu10	[pos="e,4636.1,8124.9 4608.2,8160.3 4614.9,8151.8 4622.3,8142.5 4629.8,8133"];
		gate_l9_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5063,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu11 -> gate_l9_gpu11	[pos="e,4986.7,8124.9 4953.9,8160.3 4961.9,8151.6 4970.7,8142.1 4979.8,8132.4"];
		gate_l9_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5425,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu12 -> gate_l9_gpu12	[pos="e,5338.3,8124.9 5301,8160.3 5310.4,8151.5 5320.6,8141.8 5331,8131.8"];
		gate_l9_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5782,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu13 -> gate_l9_gpu13	[pos="e,5694.8,8124.9 5657.3,8160.3 5666.7,8151.5 5677,8141.8 5687.5,8131.8"];
		gate_l9_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6142,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu14 -> gate_l9_gpu14	[pos="e,6057.4,8124.9 6021,8160.3 6030,8151.6 6039.9,8141.9 6050,8132.1"];
		gate_l9_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 9\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6502,8041.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l9_gpu15 -> gate_l9_gpu15	[pos="e,6407.4,8124.6 6366.1,8160.3 6376.6,8151.3 6388,8141.4 6399.7,8131.3"];
		expert_l9_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 9\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu0 -> expert_l9_gpu0	[pos="e,1108.3,7922.9 1108.5,7958.6 1108.4,7949.9 1108.4,7941.3 1108.3,7933.1",
			style=dashed];
		expert_l9_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 9\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1508,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu1 -> expert_l9_gpu1	[pos="e,1517.8,7922.9 1526.3,7958.6 1524.2,7949.8 1522.1,7941.1 1520.1,7932.8",
			style=dashed];
		expert_l9_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 9\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1882,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu2 -> expert_l9_gpu2	[pos="e,1895.1,7922.9 1906.6,7958.6 1903.7,7949.7 1900.9,7940.9 1898.2,7932.5",
			style=dashed];
		expert_l9_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 9\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2244,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu3 -> expert_l9_gpu3	[pos="e,2257.1,7922.9 2268.6,7958.6 2265.7,7949.7 2262.9,7940.9 2260.2,7932.5",
			style=dashed];
		expert_l9_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 9\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2600,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu4 -> expert_l9_gpu4	[pos="e,2611.3,7922.9 2621.2,7958.6 2618.8,7949.8 2616.3,7941.1 2614.1,7932.8",
			style=dashed];
		expert_l9_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 9\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2952,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu5 -> expert_l9_gpu5	[pos="e,2961,7922.9 2968.9,7958.6 2966.9,7949.8 2965,7941.1 2963.2,7932.8",
			style=dashed];
		expert_l9_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 9\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3303,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu6 -> expert_l9_gpu6	[pos="e,3309.2,7922.9 3314.6,7958.6 3313.3,7949.9 3311.9,7941.3 3310.7,7933.1",
			style=dashed];
		expert_l9_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 9\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3654,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu7 -> expert_l9_gpu7	[pos="e,3657.1,7922.9 3659.8,7958.6 3659.1,7949.9 3658.5,7941.3 3657.9,7933.1",
			style=dashed];
		expert_l9_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 9\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu8 -> expert_l9_gpu8	[pos="e,4004,7922.9 4004,7958.6 4004,7949.9 4004,7941.3 4004,7933.1",
			style=dashed];
		expert_l9_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 9\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4354,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu9 -> expert_l9_gpu9	[pos="e,4352.5,7922.9 4351.1,7958.6 4351.4,7949.9 4351.8,7941.3 4352.1,7933.1",
			style=dashed];
		expert_l9_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 9\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4710,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu10 -> expert_l9_gpu10	[pos="e,4707.7,7922.9 4705.7,7958.6 4706.2,7949.9 4706.6,7941.3 4707.1,7933.1",
			style=dashed];
		expert_l9_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 9\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5078,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu11 -> expert_l9_gpu11	[pos="e,5074.1,7922.9 5070.8,7958.6 5071.6,7949.9 5072.4,7941.3 5073.2,7933.1",
			style=dashed];
		expert_l9_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 9\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5434,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu12 -> expert_l9_gpu12	[pos="e,5431.7,7922.9 5429.7,7958.6 5430.2,7949.9 5430.6,7941.3 5431.1,7933.1",
			style=dashed];
		expert_l9_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 9\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5793,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu13 -> expert_l9_gpu13	[pos="e,5790.2,7922.9 5787.7,7958.6 5788.3,7949.9 5788.9,7941.3 5789.5,7933.1",
			style=dashed];
		expert_l9_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 9\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6153,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu14 -> expert_l9_gpu14	[pos="e,6150.2,7922.9 6147.7,7958.6 6148.3,7949.9 6148.9,7941.3 6149.5,7933.1",
			style=dashed];
		expert_l9_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 9\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6514,7881.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l9_gpu15 -> expert_l9_gpu15	[pos="e,6510.9,7922.9 6508.2,7958.6 6508.9,7949.9 6509.5,7941.3 6510.1,7933.1",
			style=dashed];
		agg_l9_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu0 -> agg_l9_gpu0	[pos="e,1108,7803.9 1108,7839.3 1108,7831.4 1108,7822.8 1108,7814"];
		agg_l9_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1470,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu1 -> agg_l9_gpu1	[pos="e,1489.7,7803.9 1498.2,7839.3 1496.3,7831.3 1494.2,7822.6 1492.1,7813.7"];
		agg_l9_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1832,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu2 -> agg_l9_gpu2	[pos="e,1858,7803.9 1869.1,7839.3 1866.6,7831.3 1863.8,7822.6 1861,7813.7"];
		agg_l9_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2194,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu3 -> agg_l9_gpu3	[pos="e,2220,7803.9 2231.1,7839.3 2228.6,7831.3 2225.8,7822.6 2223,7813.7"];
		agg_l9_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2556,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu4 -> agg_l9_gpu4	[pos="e,2578.8,7803.9 2588.7,7839.3 2586.4,7831.3 2584,7822.6 2581.5,7813.7"];
		agg_l9_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2918,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu5 -> agg_l9_gpu5	[pos="e,2935.6,7803.9 2943.2,7839.3 2941.5,7831.4 2939.7,7822.8 2937.8,7814"];
		agg_l9_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3280,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu6 -> agg_l9_gpu6	[pos="e,3291.9,7803.9 3297.1,7839.3 3295.9,7831.4 3294.7,7822.8 3293.4,7814"];
		agg_l9_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3642,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu7 -> agg_l9_gpu7	[pos="e,3648.2,7803.9 3650.9,7839.3 3650.3,7831.4 3649.7,7822.8 3649,7814"];
		agg_l9_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu8 -> agg_l9_gpu8	[pos="e,4004,7803.9 4004,7839.3 4004,7831.4 4004,7822.8 4004,7814"];
		agg_l9_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4366,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu9 -> agg_l9_gpu9	[pos="e,4359.8,7803.9 4357.1,7839.3 4357.7,7831.4 4358.3,7822.8 4359,7814"];
		agg_l9_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4728,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu10 -> agg_l9_gpu10	[pos="e,4718.7,7803.9 4714.6,7839.3 4715.5,7831.4 4716.5,7822.8 4717.5,7814"];
		agg_l9_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5090,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu11 -> agg_l9_gpu11	[pos="e,5083.8,7803.9 5081.1,7839.3 5081.7,7831.4 5082.3,7822.8 5083,7814"];
		agg_l9_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5452,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu12 -> agg_l9_gpu12	[pos="e,5442.7,7803.9 5438.6,7839.3 5439.5,7831.4 5440.5,7822.8 5441.5,7814"];
		agg_l9_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5814,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu13 -> agg_l9_gpu13	[pos="e,5803.1,7803.9 5798.4,7839.3 5799.5,7831.4 5800.6,7822.8 5801.8,7814"];
		agg_l9_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6176,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu14 -> agg_l9_gpu14	[pos="e,6164.1,7803.9 6158.9,7839.3 6160.1,7831.4 6161.3,7822.8 6162.6,7814"];
		agg_l9_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 9\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6538,7720.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l9_gpu15 -> agg_l9_gpu15	[pos="e,6525.5,7803.9 6520.2,7839.3 6521.4,7831.4 6522.7,7822.8 6524,7814"];
		global_agg_l9	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 9\nAll GPUs\n[128,10000,4096]",
			pos="4004,7553.6",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l9_gpu0 -> global_agg_l9	[pos="e,3894.3,7555.4 1220,7660.7 1242.3,7651.4 1266,7643 1289,7637.7 1543.5,7578.6 3391.9,7559.5 3883.9,7555.5"];
		agg_l9_gpu1 -> global_agg_l9	[pos="e,3894.2,7556 1582,7660.8 1604.3,7651.4 1628,7643.1 1651,7637.7 1868.8,7586.6 3435.3,7562.1 3884.1,7556.1"];
		agg_l9_gpu2 -> global_agg_l9	[pos="e,3894.5,7556.7 1944.1,7660.9 1966.4,7651.5 1990,7643.1 2013,7637.7 2194.4,7594.5 3482.2,7565.1 3884.3,7556.9"];
		agg_l9_gpu3 -> global_agg_l9	[pos="e,3894.2,7554.9 2306.1,7661.1 2328.4,7651.7 2352,7643.2 2375,7637.7 2661.2,7568.2 3557.6,7556.8 3883.8,7554.9"];
		agg_l9_gpu4 -> global_agg_l9	[pos="e,3894.4,7556.7 2668.2,7661.4 2690.5,7651.9 2714.1,7643.4 2737,7637.7 2952.1,7583.8 3611.5,7563.3 3884.1,7557"];
		agg_l9_gpu5 -> global_agg_l9	[pos="e,3895.3,7560 3030.3,7661.9 3052.6,7652.4 3076.2,7643.7 3099,7637.7 3244.3,7599.3 3674.5,7572 3885.1,7560.6"];
		agg_l9_gpu6 -> global_agg_l9	[pos="e,3896,7562.4 3392.6,7663 3414.9,7653.4 3438.3,7644.4 3461,7637.7 3603.7,7595.3 3774.3,7573.7 3885.7,7563.3"];
		agg_l9_gpu7 -> global_agg_l9	[pos="e,3929,7588.8 3756.5,7667.4 3809.5,7643.3 3871.2,7615.1 3919.8,7593"];
		agg_l9_gpu8 -> global_agg_l9	[pos="e,4004,7601.8 4004,7637.6 4004,7629 4004,7620.3 4004,7612"];
		agg_l9_gpu9 -> global_agg_l9	[pos="e,4079.1,7588.8 4195.6,7642 4158.4,7625 4120.6,7607.7 4088.5,7593.1"];
		agg_l9_gpu10 -> global_agg_l9	[pos="e,4112,7562.4 4557,7640.7 4553.6,7639.7 4550.3,7638.6 4547,7637.7 4404.3,7595.3 4233.7,7573.7 4122.3,7563.3"];
		agg_l9_gpu11 -> global_agg_l9	[pos="e,4112.7,7560 4918.8,7640.4 4915.5,7639.4 4912.3,7638.5 4909,7637.7 4763.7,7599.3 4333.5,7572 4122.9,7560.6"];
		agg_l9_gpu12 -> global_agg_l9	[pos="e,4113.6,7556.7 5280.8,7640.3 5277.5,7639.4 5274.3,7638.5 5271,7637.7 5055.9,7583.8 4396.5,7563.3 4123.9,7557"];
		agg_l9_gpu13 -> global_agg_l9	[pos="e,4113.8,7554.9 5642.8,7640.2 5639.6,7639.3 5636.3,7638.5 5633,7637.7 5346.8,7568.2 4450.4,7556.8 4124.2,7554.9"];
		agg_l9_gpu14 -> global_agg_l9	[pos="e,4113.5,7556.7 6004.9,7640.2 6001.6,7639.3 5998.3,7638.4 5995,7637.7 5813.6,7594.5 4525.8,7565.1 4123.7,7556.9"];
		agg_l9_gpu15 -> global_agg_l9	[pos="e,4113.8,7556 6366.6,7640.1 6363.4,7639.2 6360.2,7638.4 6357,7637.7 6139.2,7586.6 4572.7,7562.1 4123.9,7556.1"];
		residual_l9	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 9\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4004,7428",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l9 -> residual_l9	[pos="e,4004,7469.7 4004,7505.2 4004,7496.8 4004,7488.1 4004,7479.7"];
	}
	subgraph cluster_layer_10 {
		graph [bb="928,6342.2,6718,7370.5",
			label="Layer 10 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3823,7359",
			lwidth=3.42,
			style=dashed
		];
		dist_l10	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 10\nAll GPUs\n[128,10000,4096]",
			pos="4004,7291.4",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l10_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1299,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu0	[pos="e,1382.2,7182.2 3902.3,7288.6 3501.2,7281 2027.4,7250.9 1562,7207.3 1505.4,7202 1442.5,7192.5 1392.4,7184"];
		mha_l10_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1654,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu1	[pos="e,1737.1,7172.6 3902.5,7286.1 3636.4,7274.7 2896.6,7242.1 2281,7207.3 2091.4,7196.6 1869.7,7181.8 1747.2,7173.3"];
		mha_l10_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2373,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu2	[pos="e,2456.2,7177.3 3903,7285.4 3687.6,7274.4 3167.7,7246 2733,7207.3 2642.2,7199.3 2538.8,7187.3 2466.2,7178.5"];
		mha_l10_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2825,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu3	[pos="e,2908.2,7183.6 3903.2,7284.6 3728.9,7274 3360.3,7248.4 3051,7207.3 3007.1,7201.5 2958.7,7193.1 2918.1,7185.5"];
		mha_l10_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3143,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu4	[pos="e,3226.3,7190.2 3903.7,7282.7 3766.9,7271.3 3514.5,7246.8 3302,7207.3 3280.5,7203.3 3257.6,7198.1 3236.1,7192.7"];
		mha_l10_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3394,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu5	[pos="e,3477.2,7195.6 3906.1,7277.9 3807.5,7264.2 3651.5,7240 3519,7207.3 3508.6,7204.8 3497.7,7201.8 3487,7198.6"];
		mha_l10_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3611,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu6	[pos="e,3694.1,7198.4 3916.5,7266.6 3860.1,7250.7 3785.3,7229 3720,7207.3 3714.7,7205.6 3709.3,7203.7 3703.9,7201.9"];
		mha_l10_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3812,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu7	[pos="e,3875.1,7207.5 3944.6,7252.2 3925.3,7239.8 3903.7,7225.9 3883.6,7212.9"];
		mha_l10_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu8	[pos="e,4004,7207.5 4004,7243 4004,7234.7 4004,7226 4004,7217.6"];
		mha_l10_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4264,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu9	[pos="e,4180.9,7206.4 4074.7,7256.8 4104.5,7242.6 4139.7,7225.9 4171.5,7210.8"];
		mha_l10_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4563,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu10	[pos="e,4479.9,7185.2 4095.7,7270.1 4199.1,7247.3 4366.2,7210.3 4470.1,7187.4"];
		mha_l10_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4881,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu11	[pos="e,4798,7182.7 4102.6,7279.4 4230.4,7264.8 4459.7,7237.3 4655,7207.3 4698.9,7200.6 4747.3,7192.1 4788.1,7184.6"];
		mha_l10_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5208,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu12	[pos="e,5124.8,7182.9 4105.1,7284.6 4281.7,7273.8 4657.5,7248 4973,7207.3 5020,7201.3 5071.8,7192.6 5114.9,7184.8"];
		mha_l10_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5567,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu13	[pos="e,5484,7181.3 4105.5,7286.9 4324.3,7278.7 4856.4,7255.1 5300,7207.3 5358,7201.1 5422.7,7191.3 5473.9,7183"];
		mha_l10_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5946,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu14	[pos="e,5862.7,7180.6 4105.9,7288.5 4365.5,7282.9 5072.6,7263.3 5659,7207.3 5724,7201.1 5796.8,7190.8 5852.8,7182.1"];
		mha_l10_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 10\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6316,7165.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l10 -> mha_l10_gpu15	[pos="e,6232.9,7181.2 4105.8,7290 4403.7,7287.9 5299,7276.1 6038,7207.3 6099.9,7201.6 6169.2,7191.5 6223.1,7182.8"];
		gate_l10_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1128,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu0 -> gate_l10_gpu0	[pos="e,1216.8,7088.6 1255,7124 1245.4,7115.1 1234.9,7105.4 1224.2,7095.5"];
		gate_l10_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1472,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu1 -> gate_l10_gpu1	[pos="e,1566.5,7088.6 1607.1,7124 1596.8,7115.1 1585.6,7105.2 1574.1,7095.2"];
		gate_l10_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1896,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu2 -> gate_l10_gpu2	[pos="e,2047.4,7066.7 2289.8,7142.8 2237.3,7128.4 2168.2,7108.6 2108,7088.3 2091.4,7082.7 2074.1,7076.6 2056.9,7070.3"];
		gate_l10_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2277,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu3 -> gate_l10_gpu3	[pos="e,2432.1,7076.2 2741.7,7151.8 2668.3,7139.2 2559.2,7117.8 2467,7088.3 2458.7,7085.7 2450.2,7082.8 2441.7,7079.7"];
		gate_l10_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2636,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu4 -> gate_l10_gpu4	[pos="e,2792.9,7080.3 3059.8,7150.2 2992.7,7137.3 2896.5,7116.2 2815,7088.3 2810.9,7086.9 2806.8,7085.5 2802.6,7084"];
		gate_l10_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2984,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu5 -> gate_l10_gpu5	[pos="e,3141.5,7082 3310.8,7140.9 3264.9,7127 3207.2,7108.2 3157,7088.3 3155.1,7087.6 3153.2,7086.8 3151.2,7086"];
		gate_l10_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3326,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu6 -> gate_l10_gpu6	[pos="e,3473.7,7088.5 3538,7124.2 3520.8,7114.7 3501.9,7104.1 3482.6,7093.4"];
		gate_l10_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3666,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu7 -> gate_l10_gpu7	[pos="e,3741.8,7088.6 3774.4,7124 3766.4,7115.3 3757.6,7105.8 3748.7,7096.1"];
		gate_l10_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4004,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu8 -> gate_l10_gpu8	[pos="e,4004,7088.6 4004,7124 4004,7116.1 4004,7107.5 4004,7098.6"];
		gate_l10_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4353,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu9 -> gate_l10_gpu9	[pos="e,4306.8,7088.6 4286.9,7124 4291.6,7115.7 4296.6,7106.7 4301.8,7097.5"];
		gate_l10_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4709,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu10 -> gate_l10_gpu10	[pos="e,4633.2,7088.6 4600.6,7124 4608.6,7115.3 4617.4,7105.8 4626.3,7096.1"];
		gate_l10_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5068,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu11 -> gate_l10_gpu11	[pos="e,4972.8,7087.1 4929.2,7124 4940.3,7114.6 4952.5,7104.2 4965,7093.7"];
		gate_l10_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5428,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu12 -> gate_l10_gpu12	[pos="e,5329.1,7077.6 5264.4,7124.2 5281.6,7111.8 5301.2,7097.7 5320.7,7083.6"];
		gate_l10_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5778,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu13 -> gate_l10_gpu13	[pos="e,5679.8,7080.1 5621.1,7124.2 5636.6,7112.5 5654.2,7099.3 5671.7,7086.2"];
		gate_l10_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6140,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu14 -> gate_l10_gpu14	[pos="e,6044,7084.7 5995.7,7124.2 6008.2,7114 6022.1,7102.7 6036.2,7091.1"];
		gate_l10_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 10\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6502,7005.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l10_gpu15 -> gate_l10_gpu15	[pos="e,6406.9,7087.4 6363.9,7124 6374.9,7114.7 6386.9,7104.4 6399.2,7093.9"];
		expert_l10_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 10\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1115,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu0 -> expert_l10_gpu0	[pos="e,1118.3,6886.6 1121.3,6922.3 1120.6,6913.6 1119.8,6904.9 1119.2,6896.7",
			style=dashed];
		expert_l10_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 10\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1471,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu1 -> expert_l10_gpu1	[pos="e,1471.3,6886.6 1471.5,6922.3 1471.4,6913.6 1471.4,6904.9 1471.3,6896.7",
			style=dashed];
		expert_l10_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 10\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1864,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu2 -> expert_l10_gpu2	[pos="e,1872.2,6886.6 1879.4,6922.3 1877.7,6913.5 1875.9,6904.7 1874.2,6896.4",
			style=dashed];
		expert_l10_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 10\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2235,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu3 -> expert_l10_gpu3	[pos="e,2245.8,6886.6 2255.3,6922.3 2252.9,6913.5 2250.6,6904.7 2248.4,6896.4",
			style=dashed];
		expert_l10_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 10\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2596,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu4 -> expert_l10_gpu4	[pos="e,2606.3,6886.6 2615.3,6922.3 2613.1,6913.5 2610.9,6904.7 2608.8,6896.4",
			style=dashed];
		expert_l10_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 10\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2951,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu5 -> expert_l10_gpu5	[pos="e,2959.5,6886.6 2966.9,6922.3 2965.1,6913.5 2963.3,6904.7 2961.5,6896.4",
			style=dashed];
		expert_l10_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 10\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3303,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu6 -> expert_l10_gpu6	[pos="e,3308.9,6886.6 3314.1,6922.3 3312.8,6913.6 3311.6,6904.9 3310.4,6896.7",
			style=dashed];
		expert_l10_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 10\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3654,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu7 -> expert_l10_gpu7	[pos="e,3657.1,6886.6 3659.8,6922.3 3659.1,6913.6 3658.5,6904.9 3657.9,6896.7",
			style=dashed];
		expert_l10_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 10\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu8 -> expert_l10_gpu8	[pos="e,4004,6886.6 4004,6922.3 4004,6913.6 4004,6904.9 4004,6896.7",
			style=dashed];
		expert_l10_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 10\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4360,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu9 -> expert_l10_gpu9	[pos="e,4358.2,6886.6 4356.6,6922.3 4357,6913.6 4357.4,6904.9 4357.8,6896.7",
			style=dashed];
		expert_l10_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 10\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4719,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu10 -> expert_l10_gpu10	[pos="e,4716.4,6886.6 4714.2,6922.3 4714.7,6913.6 4715.3,6904.9 4715.8,6896.7",
			style=dashed];
		expert_l10_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 10\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5079,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu11 -> expert_l10_gpu11	[pos="e,5076.2,6886.6 5073.7,6922.3 5074.3,6913.6 5074.9,6904.9 5075.5,6896.7",
			style=dashed];
		expert_l10_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 10\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5440,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu12 -> expert_l10_gpu12	[pos="e,5436.9,6886.6 5434.2,6922.3 5434.9,6913.6 5435.5,6904.9 5436.1,6896.7",
			style=dashed];
		expert_l10_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 10\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5790,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu13 -> expert_l10_gpu13	[pos="e,5786.9,6886.6 5784.2,6922.3 5784.9,6913.6 5785.5,6904.9 5786.1,6896.7",
			style=dashed];
		expert_l10_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 10\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6152,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu14 -> expert_l10_gpu14	[pos="e,6148.9,6886.6 6146.2,6922.3 6146.9,6913.6 6147.5,6904.9 6148.1,6896.7",
			style=dashed];
		expert_l10_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 10\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6514,6844.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l10_gpu15 -> expert_l10_gpu15	[pos="e,6510.9,6886.6 6508.2,6922.3 6508.9,6913.6 6509.5,6904.9 6510.1,6896.7",
			style=dashed];
		agg_l10_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu0 -> agg_l10_gpu0	[pos="e,1111.6,6767.6 1113.2,6803 1112.8,6795.1 1112.5,6786.5 1112.1,6777.6"];
		agg_l10_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1470,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu1 -> agg_l10_gpu1	[pos="e,1470.5,6767.6 1470.7,6803 1470.7,6795.1 1470.6,6786.5 1470.6,6777.6"];
		agg_l10_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1832,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu2 -> agg_l10_gpu2	[pos="e,1848.6,6767.6 1855.8,6803 1854.2,6795.1 1852.4,6786.5 1850.6,6777.6"];
		agg_l10_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2194,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu3 -> agg_l10_gpu3	[pos="e,2215.3,6767.6 2224.4,6803 2222.4,6795 2220.1,6786.3 2217.8,6777.4"];
		agg_l10_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2556,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu4 -> agg_l10_gpu4	[pos="e,2576.8,6767.6 2585.7,6803 2583.7,6795 2581.5,6786.3 2579.2,6777.4"];
		agg_l10_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2918,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu5 -> agg_l10_gpu5	[pos="e,2935.1,6767.6 2942.5,6803 2940.9,6795.1 2939.1,6786.5 2937.2,6777.6"];
		agg_l10_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3280,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu6 -> agg_l10_gpu6	[pos="e,3291.9,6767.6 3297.1,6803 3295.9,6795.1 3294.7,6786.5 3293.4,6777.6"];
		agg_l10_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3642,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu7 -> agg_l10_gpu7	[pos="e,3648.2,6767.6 3650.9,6803 3650.3,6795.1 3649.7,6786.5 3649,6777.6"];
		agg_l10_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu8 -> agg_l10_gpu8	[pos="e,4004,6767.6 4004,6803 4004,6795.1 4004,6786.5 4004,6777.6"];
		agg_l10_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4366,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu9 -> agg_l10_gpu9	[pos="e,4362.9,6767.6 4361.5,6803 4361.8,6795.1 4362.2,6786.5 4362.5,6777.6"];
		agg_l10_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4728,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu10 -> agg_l10_gpu10	[pos="e,4723.3,6767.6 4721.3,6803 4721.8,6795.1 4722.3,6786.5 4722.8,6777.6"];
		agg_l10_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5090,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu11 -> agg_l10_gpu11	[pos="e,5084.3,6767.6 5081.8,6803 5082.4,6795.1 5083,6786.5 5083.6,6777.6"];
		agg_l10_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5452,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu12 -> agg_l10_gpu12	[pos="e,5445.8,6767.6 5443.1,6803 5443.7,6795.1 5444.3,6786.5 5445,6777.6"];
		agg_l10_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5814,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu13 -> agg_l10_gpu13	[pos="e,5801.5,6767.6 5796.2,6803 5797.4,6795.1 5798.7,6786.5 5800,6777.6"];
		agg_l10_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6176,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu14 -> agg_l10_gpu14	[pos="e,6163.5,6767.6 6158.2,6803 6159.4,6795.1 6160.7,6786.5 6162,6777.6"];
		agg_l10_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 10\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6538,6684.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l10_gpu15 -> agg_l10_gpu15	[pos="e,6525.5,6767.6 6520.2,6803 6521.4,6795.1 6522.7,6786.5 6524,6777.6"];
		global_agg_l10	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 10\nAll GPUs\n[128,10000,4096]",
			pos="4004,6517.2",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l10_gpu0 -> global_agg_l10	[pos="e,3894.3,6519.1 1220,6624.4 1242.3,6615 1266,6606.7 1289,6601.3 1543.5,6542.3 3391.9,6523.2 3883.9,6519.1"];
		agg_l10_gpu1 -> global_agg_l10	[pos="e,3894.2,6519.6 1582,6624.5 1604.3,6615.1 1628,6606.7 1651,6601.3 1868.8,6550.2 3435.3,6525.8 3884.1,6519.8"];
		agg_l10_gpu2 -> global_agg_l10	[pos="e,3894.5,6520.4 1944.1,6624.6 1966.4,6615.2 1990,6606.8 2013,6601.3 2194.4,6558.2 3482.2,6528.8 3884.3,6520.6"];
		agg_l10_gpu3 -> global_agg_l10	[pos="e,3894.2,6518.5 2306.1,6624.8 2328.4,6615.4 2352,6606.9 2375,6601.3 2661.2,6531.9 3557.6,6520.4 3883.8,6518.6"];
		agg_l10_gpu4 -> global_agg_l10	[pos="e,3894.4,6520.4 2668.2,6625 2690.5,6615.6 2714.1,6607.1 2737,6601.3 2952.1,6547.5 3611.5,6527 3884.1,6520.6"];
		agg_l10_gpu5 -> global_agg_l10	[pos="e,3895.3,6523.7 3030.3,6625.5 3052.6,6616 3076.2,6607.4 3099,6601.3 3244.3,6562.9 3674.5,6535.7 3885.1,6524.2"];
		agg_l10_gpu6 -> global_agg_l10	[pos="e,3896,6526 3392.6,6626.6 3414.9,6617.1 3438.3,6608.1 3461,6601.3 3603.7,6559 3774.3,6537.4 3885.7,6527"];
		agg_l10_gpu7 -> global_agg_l10	[pos="e,3929,6552.5 3756.5,6631.1 3809.5,6607 3871.2,6578.8 3919.8,6556.7"];
		agg_l10_gpu8 -> global_agg_l10	[pos="e,4004,6565.4 4004,6601.3 4004,6592.6 4004,6584 4004,6575.7"];
		agg_l10_gpu9 -> global_agg_l10	[pos="e,4079.1,6552.5 4195.6,6605.6 4158.4,6588.7 4120.6,6571.4 4088.5,6556.8"];
		agg_l10_gpu10 -> global_agg_l10	[pos="e,4112,6526 4557,6604.4 4553.6,6603.3 4550.3,6602.3 4547,6601.3 4404.3,6559 4233.7,6537.4 4122.3,6527"];
		agg_l10_gpu11 -> global_agg_l10	[pos="e,4112.7,6523.7 4918.8,6604.1 4915.5,6603.1 4912.3,6602.2 4909,6601.3 4763.7,6562.9 4333.5,6535.7 4122.9,6524.2"];
		agg_l10_gpu12 -> global_agg_l10	[pos="e,4113.6,6520.4 5280.8,6603.9 5277.5,6603 5274.3,6602.1 5271,6601.3 5055.9,6547.5 4396.5,6527 4123.9,6520.6"];
		agg_l10_gpu13 -> global_agg_l10	[pos="e,4113.8,6518.5 5642.8,6603.9 5639.6,6603 5636.3,6602.1 5633,6601.3 5346.8,6531.9 4450.4,6520.4 4124.2,6518.6"];
		agg_l10_gpu14 -> global_agg_l10	[pos="e,4113.5,6520.4 6004.9,6603.8 6001.6,6602.9 5998.3,6602.1 5995,6601.3 5813.6,6558.2 4525.8,6528.8 4123.7,6520.6"];
		agg_l10_gpu15 -> global_agg_l10	[pos="e,4113.8,6519.6 6366.6,6603.7 6363.4,6602.9 6360.2,6602.1 6357,6601.3 6139.2,6550.2 4572.7,6525.8 4123.9,6519.8"];
		residual_l10	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 10\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4004,6391.7",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l10 -> residual_l10	[pos="e,4004,6433.3 4004,6468.8 4004,6460.5 4004,6451.8 4004,6443.4"];
	}
	subgraph cluster_layer_11 {
		graph [bb="928,5305.8,6718,6334.2",
			label="Layer 11 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3823,6322.7",
			lwidth=3.42,
			style=dashed
		];
		dist_l11	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 11\nAll GPUs\n[128,10000,4096]",
			pos="4004,6255.1",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l11_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1290,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu0	[pos="e,1373,6145.4 3902,6254.8 3566.4,6256.1 2466.6,6253.5 1562,6171 1502.1,6165.5 1435.4,6155.7 1383,6147"];
		mha_l11_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1654,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu1	[pos="e,1737.1,6136.3 3902.5,6249.8 3636.4,6238.3 2896.6,6205.7 2281,6171 2091.4,6160.3 1869.7,6145.4 1747.2,6137"];
		mha_l11_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2373,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu2	[pos="e,2456.2,6141 3903,6249.1 3687.6,6238.1 3167.7,6209.6 2733,6171 2642.2,6162.9 2538.8,6151 2466.2,6142.2"];
		mha_l11_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2825,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu3	[pos="e,2908.2,6147.3 3903.2,6248.3 3728.9,6237.6 3360.3,6212.1 3051,6171 3007.1,6165.2 2958.7,6156.8 2918.1,6149.1"];
		mha_l11_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3143,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu4	[pos="e,3226.3,6153.9 3903.7,6246.4 3766.9,6235 3514.5,6210.5 3302,6171 3280.5,6167 3257.6,6161.8 3236.1,6156.4"];
		mha_l11_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3394,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu5	[pos="e,3477.2,6159.3 3906.1,6241.5 3807.5,6227.9 3651.5,6203.6 3519,6171 3508.6,6168.4 3497.7,6165.4 3487,6162.3"];
		mha_l11_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3611,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu6	[pos="e,3694.1,6162.1 3916.5,6230.2 3860.1,6214.4 3785.3,6192.7 3720,6171 3714.7,6169.3 3709.3,6167.4 3703.9,6165.5"];
		mha_l11_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3812,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu7	[pos="e,3875.1,6171.1 3944.6,6215.8 3925.3,6203.4 3903.7,6189.5 3883.6,6176.6"];
		mha_l11_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu8	[pos="e,4004,6171.2 4004,6206.7 4004,6198.3 4004,6189.6 4004,6181.2"];
		mha_l11_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4264,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu9	[pos="e,4180.9,6170 4074.7,6220.5 4104.5,6206.3 4139.7,6189.6 4171.5,6174.5"];
		mha_l11_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4555,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu10	[pos="e,4471.7,6149.2 4095.3,6233.6 4196.7,6210.9 4359.5,6174.4 4461.6,6151.4"];
		mha_l11_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4898,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu11	[pos="e,4814.7,6144.6 4102.4,6242.3 4228.7,6227 4454.4,6199 4647,6171 4699.3,6163.4 4757.6,6154.1 4804.8,6146.3"];
		mha_l11_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5251,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu12	[pos="e,5167.7,6144.9 4105,6247.9 4283.8,6236.5 4667.6,6209.5 4990,6171 5045.8,6164.3 5108,6154.8 5157.7,6146.6"];
		mha_l11_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5608,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu13	[pos="e,5525,6145.1 4105.5,6250.9 4329.4,6243.2 4882.4,6220.4 5343,6171 5400.4,6164.8 5464.3,6155.2 5515,6146.8"];
		mha_l11_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5928,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu14	[pos="e,5845,6147.9 4106.2,6253.6 4370.5,6251.3 5098.4,6238.9 5700,6171 5744.7,6166 5793.8,6157.6 5835,6149.8"];
		mha_l11_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 11\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6312,6129.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l11 -> mha_l11_gpu15	[pos="e,6228.9,6144.2 4106,6253.4 4402.2,6250.5 5288.2,6236.7 6020,6171 6086.7,6165 6161.5,6154.6 6218.8,6145.8"];
		gate_l11_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1110,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu0 -> gate_l11_gpu0	[pos="e,1203.4,6052.3 1243.6,6087.7 1233.5,6078.7 1222.3,6068.9 1210.9,6058.9"];
		gate_l11_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1547,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu1 -> gate_l11_gpu1	[pos="e,1602.5,6052.3 1626.4,6087.7 1620.7,6079.2 1614.5,6070 1608.2,6060.6"];
		gate_l11_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1884,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu2 -> gate_l11_gpu2	[pos="e,2034.7,6028.6 2289.7,6106.9 2235.8,6092.5 2164.4,6072.5 2102,6052 2083.2,6045.8 2063.6,6039 2044.2,6032"];
		gate_l11_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2271,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu3 -> gate_l11_gpu3	[pos="e,2425.7,6038.8 2741.7,6115.6 2667.8,6103 2557.3,6081.4 2464,6052 2454.6,6049 2444.9,6045.8 2435.3,6042.3"];
		gate_l11_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2633,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu4 -> gate_l11_gpu4	[pos="e,2789.8,6043.6 3059.7,6114 2992.2,6101.1 2895.1,6079.9 2813,6052 2808.5,6050.5 2803.9,6048.8 2799.3,6047.2"];
		gate_l11_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2982,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu5 -> gate_l11_gpu5	[pos="e,3139.5,6045.3 3310.7,6104.6 3264.6,6090.7 3206.6,6071.9 3156,6052 3153.6,6051.1 3151.2,6050.1 3148.8,6049.1"];
		gate_l11_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3325,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu6 -> gate_l11_gpu6	[pos="e,3473.2,6052.1 3537.7,6087.9 3520.5,6078.3 3501.5,6067.8 3482.1,6057.1"];
		gate_l11_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3665,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu7 -> gate_l11_gpu7	[pos="e,3741.3,6052.3 3774.1,6087.7 3766.1,6079 3757.3,6069.5 3748.2,6059.7"];
		gate_l11_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4004,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu8 -> gate_l11_gpu8	[pos="e,4004,6052.3 4004,6087.7 4004,6079.8 4004,6071.1 4004,6062.3"];
		gate_l11_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4347,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu9 -> gate_l11_gpu9	[pos="e,4303.9,6052.3 4285.4,6087.7 4289.7,6079.4 4294.4,6070.4 4299.3,6061.2"];
		gate_l11_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4695,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu10 -> gate_l11_gpu10	[pos="e,4622.3,6052.3 4591.1,6087.7 4598.7,6079.1 4607,6069.7 4615.5,6060"];
		gate_l11_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5044,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu11 -> gate_l11_gpu11	[pos="e,4968.2,6052.3 4935.6,6087.7 4943.6,6079 4952.4,6069.5 4961.3,6059.7"];
		gate_l11_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5400,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu12 -> gate_l11_gpu12	[pos="e,5322.7,6052.3 5289.4,6087.7 5297.5,6079 5306.5,6069.5 5315.6,6059.7"];
		gate_l11_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5759,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu13 -> gate_l11_gpu13	[pos="e,5680.6,6052.3 5646.9,6087.7 5655.2,6079 5664.2,6069.5 5673.5,6059.7"];
		gate_l11_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6130,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu14 -> gate_l11_gpu14	[pos="e,6032.8,6046.2 5979.8,6087.9 5993.6,6077 6009.1,6064.9 6024.7,6052.6"];
		gate_l11_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 11\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6502,5969",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l11_gpu15 -> gate_l11_gpu15	[pos="e,6406.3,6049.8 6360.9,6087.7 6372.6,6077.9 6385.5,6067.2 6398.6,6056.2"];
		expert_l11_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 11\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1109,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu0 -> expert_l11_gpu0	[pos="e,1109.3,5850.3 1109.5,5886 1109.4,5877.3 1109.4,5868.6 1109.3,5860.4",
			style=dashed];
		expert_l11_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 11\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1509,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu1 -> expert_l11_gpu1	[pos="e,1518.8,5850.3 1527.3,5886 1525.2,5877.2 1523.1,5868.4 1521.1,5860.1",
			style=dashed];
		expert_l11_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 11\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1858,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu2 -> expert_l11_gpu2	[pos="e,1864.7,5850.3 1870.5,5886 1869.1,5877.3 1867.7,5868.6 1866.3,5860.4",
			style=dashed];
		expert_l11_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 11\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2232,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu3 -> expert_l11_gpu3	[pos="e,2242,5850.3 2250.8,5886 2248.6,5877.2 2246.5,5868.4 2244.5,5860.1",
			style=dashed];
		expert_l11_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 11\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2594,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu4 -> expert_l11_gpu4	[pos="e,2604,5850.3 2612.8,5886 2610.6,5877.2 2608.5,5868.4 2606.5,5860.1",
			style=dashed];
		expert_l11_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 11\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2950,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu5 -> expert_l11_gpu5	[pos="e,2958.2,5850.3 2965.4,5886 2963.7,5877.2 2961.9,5868.4 2960.2,5860.1",
			style=dashed];
		expert_l11_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 11\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3302,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu6 -> expert_l11_gpu6	[pos="e,3307.9,5850.3 3313.1,5886 3311.8,5877.3 3310.6,5868.6 3309.4,5860.4",
			style=dashed];
		expert_l11_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 11\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3653,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu7 -> expert_l11_gpu7	[pos="e,3656.1,5850.3 3658.8,5886 3658.1,5877.3 3657.5,5868.6 3656.9,5860.4",
			style=dashed];
		expert_l11_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 11\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu8 -> expert_l11_gpu8	[pos="e,4004,5850.3 4004,5886 4004,5877.3 4004,5868.6 4004,5860.4",
			style=dashed];
		expert_l11_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 11\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4354,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu9 -> expert_l11_gpu9	[pos="e,4352.2,5850.3 4350.6,5886 4351,5877.3 4351.4,5868.6 4351.8,5860.4",
			style=dashed];
		expert_l11_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 11\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4706,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu10 -> expert_l11_gpu10	[pos="e,4703.2,5850.3 4700.7,5886 4701.3,5877.3 4701.9,5868.6 4702.5,5860.4",
			style=dashed];
		expert_l11_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 11\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5084,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu11 -> expert_l11_gpu11	[pos="e,5073.7,5850.3 5064.7,5886 5066.9,5877.2 5069.1,5868.4 5071.2,5860.1",
			style=dashed];
		expert_l11_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 11\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5420,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu12 -> expert_l11_gpu12	[pos="e,5414.9,5850.3 5410.4,5886 5411.5,5877.3 5412.5,5868.6 5413.6,5860.4",
			style=dashed];
		expert_l11_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 11\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5781,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu13 -> expert_l11_gpu13	[pos="e,5775.3,5850.3 5770.4,5886 5771.6,5877.3 5772.8,5868.6 5773.9,5860.4",
			style=dashed];
		expert_l11_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 11\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6153,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu14 -> expert_l11_gpu14	[pos="e,6147.1,5850.3 6141.9,5886 6143.2,5877.3 6144.4,5868.6 6145.6,5860.4",
			style=dashed];
		expert_l11_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 11\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6514,5808.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l11_gpu15 -> expert_l11_gpu15	[pos="e,6510.9,5850.3 6508.2,5886 6508.9,5877.3 6509.5,5868.6 6510.1,5860.4",
			style=dashed];
		agg_l11_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu0 -> agg_l11_gpu0	[pos="e,1108.5,5731.3 1108.7,5766.7 1108.7,5758.8 1108.6,5750.1 1108.6,5741.3"];
		agg_l11_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1470,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu1 -> agg_l11_gpu1	[pos="e,1490.2,5731.3 1499,5766.7 1497,5758.7 1494.8,5750 1492.6,5741"];
		agg_l11_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1832,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu2 -> agg_l11_gpu2	[pos="e,1845.5,5731.3 1851.3,5766.7 1850,5758.8 1848.6,5750.1 1847.1,5741.3"];
		agg_l11_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2194,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu3 -> agg_l11_gpu3	[pos="e,2213.7,5731.3 2222.2,5766.7 2220.3,5758.7 2218.2,5750 2216.1,5741"];
		agg_l11_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2556,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu4 -> agg_l11_gpu4	[pos="e,2575.7,5731.3 2584.2,5766.7 2582.3,5758.7 2580.2,5750 2578.1,5741"];
		agg_l11_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2918,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu5 -> agg_l11_gpu5	[pos="e,2934.6,5731.3 2941.8,5766.7 2940.2,5758.8 2938.4,5750.1 2936.6,5741.3"];
		agg_l11_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3280,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu6 -> agg_l11_gpu6	[pos="e,3291.4,5731.3 3296.3,5766.7 3295.2,5758.8 3294,5750.1 3292.8,5741.3"];
		agg_l11_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3642,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu7 -> agg_l11_gpu7	[pos="e,3647.7,5731.3 3650.2,5766.7 3649.6,5758.8 3649,5750.1 3648.4,5741.3"];
		agg_l11_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu8 -> agg_l11_gpu8	[pos="e,4004,5731.3 4004,5766.7 4004,5758.8 4004,5750.1 4004,5741.3"];
		agg_l11_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4366,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu9 -> agg_l11_gpu9	[pos="e,4359.8,5731.3 4357.1,5766.7 4357.7,5758.8 4358.3,5750.1 4359,5741.3"];
		agg_l11_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4728,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu10 -> agg_l11_gpu10	[pos="e,4716.6,5731.3 4711.7,5766.7 4712.8,5758.8 4714,5750.1 4715.2,5741.3"];
		agg_l11_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5090,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu11 -> agg_l11_gpu11	[pos="e,5086.9,5731.3 5085.5,5766.7 5085.8,5758.8 5086.2,5750.1 5086.5,5741.3"];
		agg_l11_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5452,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu12 -> agg_l11_gpu12	[pos="e,5435.4,5731.3 5428.2,5766.7 5429.8,5758.8 5431.6,5750.1 5433.4,5741.3"];
		agg_l11_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5814,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu13 -> agg_l11_gpu13	[pos="e,5796.9,5731.3 5789.5,5766.7 5791.1,5758.8 5792.9,5750.1 5794.8,5741.3"];
		agg_l11_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6176,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu14 -> agg_l11_gpu14	[pos="e,6164.1,5731.3 6158.9,5766.7 6160.1,5758.8 6161.3,5750.1 6162.6,5741.3"];
		agg_l11_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 11\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6538,5648",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l11_gpu15 -> agg_l11_gpu15	[pos="e,6525.5,5731.3 6520.2,5766.7 6521.4,5758.8 6522.7,5750.1 6524,5741.3"];
		global_agg_l11	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 11\nAll GPUs\n[128,10000,4096]",
			pos="4004,5480.9",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l11_gpu0 -> global_agg_l11	[pos="e,3894.3,5482.7 1220,5588.1 1242.3,5578.7 1266,5570.3 1289,5565 1543.5,5505.9 3391.9,5486.9 3883.9,5482.8"];
		agg_l11_gpu1 -> global_agg_l11	[pos="e,3894.2,5483.3 1582,5588.2 1604.3,5578.8 1628,5570.4 1651,5565 1868.8,5513.9 3435.3,5489.4 3884.1,5483.4"];
		agg_l11_gpu2 -> global_agg_l11	[pos="e,3894.5,5484 1944.1,5588.3 1966.4,5578.9 1990,5570.5 2013,5565 2194.4,5521.8 3482.2,5492.5 3884.3,5484.2"];
		agg_l11_gpu3 -> global_agg_l11	[pos="e,3894.2,5482.2 2306.1,5588.4 2328.4,5579 2352,5570.6 2375,5565 2661.2,5495.5 3557.6,5484.1 3883.8,5482.3"];
		agg_l11_gpu4 -> global_agg_l11	[pos="e,3894.4,5484.1 2668.2,5588.7 2690.5,5579.3 2714.1,5570.7 2737,5565 2952.1,5511.1 3611.5,5490.6 3884.1,5484.3"];
		agg_l11_gpu5 -> global_agg_l11	[pos="e,3895.3,5487.4 3030.3,5589.2 3052.6,5579.7 3076.2,5571 3099,5565 3244.3,5526.6 3674.5,5499.3 3885.1,5487.9"];
		agg_l11_gpu6 -> global_agg_l11	[pos="e,3896,5489.7 3392.6,5590.3 3414.9,5580.7 3438.3,5571.7 3461,5565 3603.7,5522.6 3774.3,5501 3885.7,5490.6"];
		agg_l11_gpu7 -> global_agg_l11	[pos="e,3929,5516.1 3756.5,5594.8 3809.5,5570.6 3871.2,5542.5 3919.8,5520.3"];
		agg_l11_gpu8 -> global_agg_l11	[pos="e,4004,5529.1 4004,5564.9 4004,5556.3 4004,5547.6 4004,5539.4"];
		agg_l11_gpu9 -> global_agg_l11	[pos="e,4079.1,5516.2 4195.6,5569.3 4158.4,5552.3 4120.6,5535.1 4088.5,5520.4"];
		agg_l11_gpu10 -> global_agg_l11	[pos="e,4112,5489.7 4557,5568.1 4553.6,5567 4550.3,5566 4547,5565 4404.3,5522.6 4233.7,5501 4122.3,5490.6"];
		agg_l11_gpu11 -> global_agg_l11	[pos="e,4112.7,5487.4 4918.8,5567.7 4915.5,5566.8 4912.3,5565.9 4909,5565 4763.7,5526.6 4333.5,5499.3 4122.9,5487.9"];
		agg_l11_gpu12 -> global_agg_l11	[pos="e,4113.6,5484.1 5280.8,5567.6 5277.5,5566.7 5274.3,5565.8 5271,5565 5055.9,5511.1 4396.5,5490.6 4123.9,5484.3"];
		agg_l11_gpu13 -> global_agg_l11	[pos="e,4113.8,5482.2 5642.8,5567.5 5639.6,5566.6 5636.3,5565.8 5633,5565 5346.8,5495.5 4450.4,5484.1 4124.2,5482.3"];
		agg_l11_gpu14 -> global_agg_l11	[pos="e,4113.5,5484 6004.9,5567.5 6001.6,5566.6 5998.3,5565.8 5995,5565 5813.6,5521.8 4525.8,5492.5 4123.7,5484.2"];
		agg_l11_gpu15 -> global_agg_l11	[pos="e,4113.8,5483.3 6366.6,5567.4 6363.4,5566.6 6360.2,5565.7 6357,5565 6139.2,5513.9 4572.7,5489.4 4123.9,5483.4"];
		residual_l11	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 11\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="5306,5355.3",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l11 -> residual_l11	[pos="e,5204.4,5366 4110.8,5469.8 4353.9,5446.7 4946.5,5390.5 5194.3,5366.9"];
	}
	subgraph cluster_layer_12 {
		graph [bb="928,4269.5,6718,5297.8",
			label="Layer 12 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3823,5286.3",
			lwidth=3.42,
			style=dashed
		];
		dist_l12	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 12\nAll GPUs\n[128,10000,4096]",
			pos="4004,5218.7",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l12_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1365,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu0	[pos="e,1448,5105.7 3902,5216.9 3580.2,5213.7 2557.7,5198.8 1714,5134.7 1627,5128.1 1528.4,5116.2 1458.2,5107"];
		mha_l12_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1806,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu1	[pos="e,1889,5110.5 3902,5217.8 3611.8,5216.9 2756.5,5207.7 2051,5134.7 2000.5,5129.4 1944.5,5120.4 1898.9,5112.2"];
		mha_l12_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2143,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu2	[pos="e,2226.1,5117.5 3902.2,5215.3 3585.5,5207.1 2620.9,5179.2 2311,5134.7 2286.5,5131.1 2260.3,5125.7 2236,5119.9"];
		mha_l12_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2403,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu3	[pos="e,2486.2,5113.7 3902,5216.6 3670.2,5212.9 3086.5,5197.6 2603,5134.7 2567.8,5130.1 2529.6,5122.9 2496,5115.8"];
		mha_l12_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2695,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu4	[pos="e,2778.1,5102.9 3904.2,5209 3736.6,5194.2 3387.8,5163.1 3093,5134.7 2988.6,5124.6 2868.8,5112.3 2788.2,5103.9"];
		mha_l12_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3185,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu5	[pos="e,3268.3,5108.4 3906.7,5204.3 3792.4,5188.3 3597.3,5160.6 3430,5134.7 3379.8,5126.9 3323.9,5117.7 3278.2,5110"];
		mha_l12_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3522,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu6	[pos="e,3605.3,5115.5 3915.3,5195 3830.1,5173.2 3701.8,5140.3 3615.1,5118"];
		mha_l12_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3782,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu7	[pos="e,3854.9,5134.7 3938.9,5181.5 3915.4,5168.4 3888.6,5153.5 3863.9,5139.8"];
		mha_l12_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu8	[pos="e,4004,5134.8 4004,5170.3 4004,5162 4004,5153.3 4004,5144.9"];
		mha_l12_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4264,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu9	[pos="e,4180.9,5133.7 4074.7,5184.1 4104.5,5170 4139.7,5153.3 4171.5,5138.1"];
		mha_l12_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4588,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu10	[pos="e,4504.8,5111.8 4096.2,5198.2 4205.2,5175.2 4385.4,5137 4494.7,5113.9"];
		mha_l12_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4931,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu11	[pos="e,4847.7,5108.4 4102.7,5206.8 4234.5,5191.9 4475.1,5163.8 4680,5134.7 4732.3,5127.2 4790.6,5117.9 4837.8,5110.1"];
		mha_l12_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5283,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu12	[pos="e,5199.8,5108.7 4105.1,5212 4288.5,5200.9 4687.9,5174.4 5023,5134.7 5078.5,5128.1 5140.3,5118.6 5189.8,5110.4"];
		mha_l12_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5640,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu13	[pos="e,5556.7,5108.9 4105.7,5214.8 4333.6,5207.4 4902,5185 5375,5134.7 5432.3,5128.6 5496.1,5118.9 5546.8,5110.5"];
		mha_l12_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5966,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu14	[pos="e,5883,5111.1 4106.1,5217.2 4373.8,5214.9 5117.4,5202.4 5732,5134.7 5778.8,5129.5 5830.3,5120.9 5873.1,5113"];
		mha_l12_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 12\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6325,5093.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l12 -> mha_l12_gpu15	[pos="e,6241.7,5109.2 4106.1,5217.6 4406.1,5216.3 5311.3,5206.2 6058,5134.7 6116,5129.1 6180.6,5119.4 6231.7,5110.9"];
		gate_l12_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1109,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu0 -> gate_l12_gpu0	[pos="e,1241.7,5015.8 1299.4,5051.6 1284.3,5042.2 1267.6,5031.9 1250.6,5021.3"];
		gate_l12_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1546,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu1 -> gate_l12_gpu1	[pos="e,1680.7,5015.8 1739.4,5051.6 1723.9,5042.1 1706.8,5031.7 1689.3,5021"];
		gate_l12_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1933,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu2 -> gate_l12_gpu2	[pos="e,2041.8,5015.8 2089.2,5051.6 2077,5042.4 2063.6,5032.2 2049.9,5021.9"];
		gate_l12_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2295,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu3 -> gate_l12_gpu3	[pos="e,2351.1,5015.9 2375.2,5051.3 2369.4,5042.9 2363.2,5033.7 2356.7,5024.3"];
		gate_l12_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2644,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu4 -> gate_l12_gpu4	[pos="e,2670.5,5015.9 2681.9,5051.3 2679.3,5043.3 2676.5,5034.6 2673.6,5025.7"];
		gate_l12_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2987,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu5 -> gate_l12_gpu5	[pos="e,3089.6,5015.8 3134.3,5051.6 3122.9,5042.4 3110.4,5032.4 3097.6,5022.2"];
		gate_l12_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3327,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu6 -> gate_l12_gpu6	[pos="e,3428.1,5015.8 3472,5051.6 3460.8,5042.4 3448.5,5032.4 3435.9,5022.2"];
		gate_l12_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3666,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu7 -> gate_l12_gpu7	[pos="e,3726.2,5015.9 3752.1,5051.3 3745.9,5042.9 3739.2,5033.7 3732.3,5024.3"];
		gate_l12_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4004,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu8 -> gate_l12_gpu8	[pos="e,4004,5015.9 4004,5051.3 4004,5043.4 4004,5034.8 4004,5026"];
		gate_l12_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4353,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu9 -> gate_l12_gpu9	[pos="e,4306.8,5015.9 4286.9,5051.3 4291.6,5043.1 4296.6,5034.1 4301.8,5024.8"];
		gate_l12_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4700,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu10 -> gate_l12_gpu10	[pos="e,4641.9,5015.9 4616.8,5051.3 4622.8,5042.9 4629.3,5033.7 4636,5024.3"];
		gate_l12_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5062,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu11 -> gate_l12_gpu11	[pos="e,4994,5015.9 4964.7,5051.3 4971.9,5042.7 4979.6,5033.3 4987.6,5023.7"];
		gate_l12_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5425,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu12 -> gate_l12_gpu12	[pos="e,5351.3,5015.9 5319.6,5051.3 5327.4,5042.6 5335.9,5033.1 5344.6,5023.4"];
		gate_l12_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5782,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu13 -> gate_l12_gpu13	[pos="e,5708.3,5015.9 5676.6,5051.3 5684.4,5042.6 5692.9,5033.1 5701.6,5023.4"];
		gate_l12_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6142,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu14 -> gate_l12_gpu14	[pos="e,6050.6,5015.9 6011.3,5051.3 6021.2,5042.5 6032,5032.8 6043,5022.8"];
		gate_l12_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 12\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6502,4932.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l12_gpu15 -> gate_l12_gpu15	[pos="e,6410.1,5015.9 6370.6,5051.3 6380.5,5042.5 6391.3,5032.8 6402.4,5022.8"];
		expert_l12_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 12\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu0 -> expert_l12_gpu0	[pos="e,1108.3,4814 1108.5,4849.6 1108.4,4840.9 1108.4,4832.3 1108.3,4824.1",
			style=dashed];
		expert_l12_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 12\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1508,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu1 -> expert_l12_gpu1	[pos="e,1517.8,4814 1526.3,4849.6 1524.2,4840.8 1522.1,4832.1 1520.1,4823.8",
			style=dashed];
		expert_l12_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 12\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1882,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu2 -> expert_l12_gpu2	[pos="e,1895.1,4814 1906.6,4849.6 1903.7,4840.7 1900.9,4831.9 1898.2,4823.5",
			style=dashed];
		expert_l12_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 12\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2244,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu3 -> expert_l12_gpu3	[pos="e,2257.1,4814 2268.6,4849.6 2265.7,4840.7 2262.9,4831.9 2260.2,4823.5",
			style=dashed];
		expert_l12_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 12\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2600,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu4 -> expert_l12_gpu4	[pos="e,2611.3,4814 2621.2,4849.6 2618.8,4840.8 2616.3,4832.1 2614.1,4823.8",
			style=dashed];
		expert_l12_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 12\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2952,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu5 -> expert_l12_gpu5	[pos="e,2961,4814 2968.9,4849.6 2966.9,4840.8 2965,4832.1 2963.2,4823.8",
			style=dashed];
		expert_l12_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 12\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3303,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu6 -> expert_l12_gpu6	[pos="e,3309.2,4814 3314.6,4849.6 3313.3,4840.9 3311.9,4832.3 3310.7,4824.1",
			style=dashed];
		expert_l12_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 12\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3654,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu7 -> expert_l12_gpu7	[pos="e,3657.1,4814 3659.8,4849.6 3659.1,4840.9 3658.5,4832.3 3657.9,4824.1",
			style=dashed];
		expert_l12_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 12\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu8 -> expert_l12_gpu8	[pos="e,4004,4814 4004,4849.6 4004,4840.9 4004,4832.3 4004,4824.1",
			style=dashed];
		expert_l12_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 12\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4360,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu9 -> expert_l12_gpu9	[pos="e,4358.2,4814 4356.6,4849.6 4357,4840.9 4357.4,4832.3 4357.8,4824.1",
			style=dashed];
		expert_l12_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 12\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4709,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu10 -> expert_l12_gpu10	[pos="e,4706.7,4814 4704.7,4849.6 4705.2,4840.9 4705.6,4832.3 4706.1,4824.1",
			style=dashed];
		expert_l12_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 12\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5078,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu11 -> expert_l12_gpu11	[pos="e,5073.9,4814 5070.3,4849.6 5071.2,4840.9 5072,4832.3 5072.9,4824.1",
			style=dashed];
		expert_l12_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 12\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5434,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu12 -> expert_l12_gpu12	[pos="e,5431.7,4814 5429.7,4849.6 5430.2,4840.9 5430.6,4832.3 5431.1,4824.1",
			style=dashed];
		expert_l12_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 12\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5793,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu13 -> expert_l12_gpu13	[pos="e,5790.2,4814 5787.7,4849.6 5788.3,4840.9 5788.9,4832.3 5789.5,4824.1",
			style=dashed];
		expert_l12_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 12\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6153,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu14 -> expert_l12_gpu14	[pos="e,6150.2,4814 6147.7,4849.6 6148.3,4840.9 6148.9,4832.3 6149.5,4824.1",
			style=dashed];
		expert_l12_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 12\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6514,4772.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l12_gpu15 -> expert_l12_gpu15	[pos="e,6510.9,4814 6508.2,4849.6 6508.9,4840.9 6509.5,4832.3 6510.1,4824.1",
			style=dashed];
		agg_l12_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1108,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu0 -> agg_l12_gpu0	[pos="e,1108,4694.9 1108,4730.3 1108,4722.4 1108,4713.8 1108,4705"];
		agg_l12_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1470,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu1 -> agg_l12_gpu1	[pos="e,1489.7,4694.9 1498.2,4730.3 1496.3,4722.3 1494.2,4713.6 1492.1,4704.7"];
		agg_l12_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1832,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu2 -> agg_l12_gpu2	[pos="e,1858,4694.9 1869.1,4730.3 1866.6,4722.3 1863.8,4713.6 1861,4704.7"];
		agg_l12_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2194,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu3 -> agg_l12_gpu3	[pos="e,2220,4694.9 2231.1,4730.3 2228.6,4722.3 2225.8,4713.6 2223,4704.7"];
		agg_l12_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2556,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu4 -> agg_l12_gpu4	[pos="e,2578.8,4694.9 2588.7,4730.3 2586.4,4722.3 2584,4713.6 2581.5,4704.7"];
		agg_l12_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2918,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu5 -> agg_l12_gpu5	[pos="e,2935.6,4694.9 2943.2,4730.3 2941.5,4722.4 2939.7,4713.8 2937.8,4705"];
		agg_l12_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3280,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu6 -> agg_l12_gpu6	[pos="e,3291.9,4694.9 3297.1,4730.3 3295.9,4722.4 3294.7,4713.8 3293.4,4705"];
		agg_l12_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3642,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu7 -> agg_l12_gpu7	[pos="e,3648.2,4694.9 3650.9,4730.3 3650.3,4722.4 3649.7,4713.8 3649,4705"];
		agg_l12_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4004,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu8 -> agg_l12_gpu8	[pos="e,4004,4694.9 4004,4730.3 4004,4722.4 4004,4713.8 4004,4705"];
		agg_l12_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4366,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu9 -> agg_l12_gpu9	[pos="e,4362.9,4694.9 4361.5,4730.3 4361.8,4722.4 4362.2,4713.8 4362.5,4705"];
		agg_l12_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4728,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu10 -> agg_l12_gpu10	[pos="e,4718.1,4694.9 4713.9,4730.3 4714.8,4722.4 4715.9,4713.8 4716.9,4705"];
		agg_l12_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5090,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu11 -> agg_l12_gpu11	[pos="e,5083.8,4694.9 5081.1,4730.3 5081.7,4722.4 5082.3,4713.8 5083,4705"];
		agg_l12_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5452,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu12 -> agg_l12_gpu12	[pos="e,5442.7,4694.9 5438.6,4730.3 5439.5,4722.4 5440.5,4713.8 5441.5,4705"];
		agg_l12_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5814,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu13 -> agg_l12_gpu13	[pos="e,5803.1,4694.9 5798.4,4730.3 5799.5,4722.4 5800.6,4713.8 5801.8,4705"];
		agg_l12_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6176,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu14 -> agg_l12_gpu14	[pos="e,6164.1,4694.9 6158.9,4730.3 6160.1,4722.4 6161.3,4713.8 6162.6,4705"];
		agg_l12_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 12\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6538,4611.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l12_gpu15 -> agg_l12_gpu15	[pos="e,6525.5,4694.9 6520.2,4730.3 6521.4,4722.4 6522.7,4713.8 6524,4705"];
		global_agg_l12	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 12\nAll GPUs\n[128,10000,4096]",
			pos="4004,4444.6",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l12_gpu0 -> global_agg_l12	[pos="e,3894.3,4446.4 1220,4551.7 1242.3,4542.4 1266,4534 1289,4528.7 1543.5,4469.6 3391.9,4450.5 3883.9,4446.5"];
		agg_l12_gpu1 -> global_agg_l12	[pos="e,3894.2,4447 1582,4551.8 1604.3,4542.4 1628,4534.1 1651,4528.7 1868.8,4477.6 3435.3,4453.1 3884.1,4447.1"];
		agg_l12_gpu2 -> global_agg_l12	[pos="e,3894.5,4447.7 1944.1,4551.9 1966.4,4542.5 1990,4534.1 2013,4528.7 2194.4,4485.5 3482.2,4456.1 3884.3,4447.9"];
		agg_l12_gpu3 -> global_agg_l12	[pos="e,3894.2,4445.9 2306.1,4552.1 2328.4,4542.7 2352,4534.2 2375,4528.7 2661.2,4459.2 3557.6,4447.8 3883.8,4445.9"];
		agg_l12_gpu4 -> global_agg_l12	[pos="e,3894.4,4447.7 2668.2,4552.4 2690.5,4542.9 2714.1,4534.4 2737,4528.7 2952.1,4474.8 3611.5,4454.3 3884.1,4448"];
		agg_l12_gpu5 -> global_agg_l12	[pos="e,3895.3,4451 3030.3,4552.9 3052.6,4543.4 3076.2,4534.7 3099,4528.7 3244.3,4490.3 3674.5,4463 3885.1,4451.6"];
		agg_l12_gpu6 -> global_agg_l12	[pos="e,3896,4453.4 3392.6,4554 3414.9,4544.4 3438.3,4535.4 3461,4528.7 3603.7,4486.3 3774.3,4464.7 3885.7,4454.3"];
		agg_l12_gpu7 -> global_agg_l12	[pos="e,3929,4479.8 3756.5,4558.4 3809.5,4534.3 3871.2,4506.1 3919.8,4484"];
		agg_l12_gpu8 -> global_agg_l12	[pos="e,4004,4492.8 4004,4528.6 4004,4520 4004,4511.3 4004,4503"];
		agg_l12_gpu9 -> global_agg_l12	[pos="e,4079.1,4479.8 4195.6,4533 4158.4,4516 4120.6,4498.7 4088.5,4484.1"];
		agg_l12_gpu10 -> global_agg_l12	[pos="e,4112,4453.4 4557,4531.8 4553.6,4530.7 4550.3,4529.6 4547,4528.7 4404.3,4486.3 4233.7,4464.7 4122.3,4454.3"];
		agg_l12_gpu11 -> global_agg_l12	[pos="e,4112.7,4451 4918.8,4531.4 4915.5,4530.4 4912.3,4529.5 4909,4528.7 4763.7,4490.3 4333.5,4463 4122.9,4451.6"];
		agg_l12_gpu12 -> global_agg_l12	[pos="e,4113.6,4447.7 5280.8,4531.3 5277.5,4530.4 5274.3,4529.5 5271,4528.7 5055.9,4474.8 4396.5,4454.3 4123.9,4448"];
		agg_l12_gpu13 -> global_agg_l12	[pos="e,4113.8,4445.9 5642.8,4531.2 5639.6,4530.3 5636.3,4529.5 5633,4528.7 5346.8,4459.2 4450.4,4447.8 4124.2,4445.9"];
		agg_l12_gpu14 -> global_agg_l12	[pos="e,4113.5,4447.7 6004.9,4531.2 6001.6,4530.3 5998.3,4529.4 5995,4528.7 5813.6,4485.5 4525.8,4456.1 4123.7,4447.9"];
		agg_l12_gpu15 -> global_agg_l12	[pos="e,4113.8,4447 6366.6,4531.1 6363.4,4530.2 6360.2,4529.4 6357,4528.7 6139.2,4477.6 4572.7,4453.1 4123.9,4447.1"];
		residual_l12	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 12\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4859,4319",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l12 -> residual_l12	[pos="e,4757.3,4334.7 4107.6,4428.6 4269.2,4405.2 4580.3,4360.3 4747,4336.2"];
	}
	subgraph cluster_layer_13 {
		graph [bb="481,3233.2,6271,4261.5",
			label="Layer 13 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3376,4250",
			lwidth=3.42,
			style=dashed
		];
		dist_l13	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 13\nAll GPUs\n[128,10000,4096]",
			pos="3557,4182.4",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l13_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="984,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu0	[pos="e,1067,4072.1 3455.1,4181.6 3133.3,4181.3 2109.4,4174 1266,4098.3 1202.7,4092.7 1131.9,4082.5 1077.1,4073.7"];
		mha_l13_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1358,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu1	[pos="e,1441.1,4081.3 3455.1,4179.9 3098.1,4174.1 1904.8,4151.2 1526,4098.3 1501.5,4094.9 1475.2,4089.5 1451,4083.7"];
		mha_l13_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1618,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu2	[pos="e,1701.3,4079.1 3455.3,4178.8 3131.5,4170.2 2126.7,4140.8 1804,4098.3 1773.5,4094.3 1740.7,4087.9 1711.1,4081.3"];
		mha_l13_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1896,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu3	[pos="e,1979,4065.3 3456.1,4174.9 3251.3,4161.5 2772.1,4129.6 2370,4098.3 2237.7,4088.1 2084.8,4074.7 1989.2,4066.2"];
		mha_l13_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2462,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu4	[pos="e,2545.2,4070.6 3457.2,4172.5 3303.8,4158.5 3001.2,4129.8 2745,4098.3 2681.6,4090.6 2610.4,4080.4 2555.3,4072.1"];
		mha_l13_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2837,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu5	[pos="e,2920.1,4076.8 3459.6,4167.9 3352.7,4152.7 3176.2,4126.4 3025,4098.3 2994,4092.6 2960.4,4085.6 2930.2,4079"];
		mha_l13_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3117,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu6	[pos="e,3200.2,4082.1 3469.6,4157.5 3409.7,4141 3328.5,4118.6 3257,4098.3 3241.8,4094 3225.6,4089.4 3209.9,4084.9"];
		mha_l13_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3349,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu7	[pos="e,3417.2,4098.3 3494.6,4144.3 3473,4131.5 3448.6,4117 3426.1,4103.6"];
		mha_l13_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu8	[pos="e,3557,4098.5 3557,4134 3557,4125.7 3557,4117 3557,4108.6"];
		mha_l13_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3817,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu9	[pos="e,3733.9,4097.4 3627.7,4147.8 3657.5,4133.6 3692.7,4116.9 3724.5,4101.8"];
		mha_l13_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4113,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu10	[pos="e,4029.6,4076.4 3648.5,4161.1 3751.1,4138.3 3916.5,4101.5 4019.8,4078.5"];
		mha_l13_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4456,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu11	[pos="e,4372.7,4072 3655.4,4169.8 3782.5,4154.6 4010.5,4126.5 4205,4098.3 4257.3,4090.8 4315.6,4081.4 4362.8,4073.6"];
		mha_l13_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4796,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu12	[pos="e,4712.7,4073.1 3657.8,4175.6 3837.3,4164.6 4223.7,4138.3 4548,4098.3 4599.3,4092 4656.3,4082.8 4702.7,4074.8"];
		mha_l13_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5159,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu13	[pos="e,5075.9,4072.1 3658.7,4178.1 3881.8,4170 4430.7,4146.7 4888,4098.3 4947.4,4092 5013.8,4082.2 5066,4073.8"];
		mha_l13_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5509,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu14	[pos="e,5425.9,4073.2 3659,4180.2 3922.8,4176.2 4649.4,4160.1 5251,4098.3 5306,4092.7 5367.1,4083.2 5416,4074.9"];
		mha_l13_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 13\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5853,4056.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l13 -> mha_l13_gpu15	[pos="e,5769.9,4073.7 3658.9,4181.5 3957.8,4181 4858.5,4172.8 5601,4098.3 5653.9,4093 5712.6,4083.8 5760,4075.5"];
		gate_l13_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="795,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu0 -> gate_l13_gpu0	[pos="e,893.1,3979.6 935.33,4015 924.65,4006.1 912.94,3996.2 900.99,3986.2"];
		gate_l13_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1177,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu1 -> gate_l13_gpu1	[pos="e,1271,3979.6 1311.4,4015 1301.2,4006.1 1290,3996.2 1278.5,3986.2"];
		gate_l13_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1525,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu2 -> gate_l13_gpu2	[pos="e,1573.3,3979.6 1594.1,4015 1589.2,4006.7 1583.9,3997.7 1578.5,3988.5"];
		gate_l13_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1867,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu3 -> gate_l13_gpu3	[pos="e,1882.1,3979.6 1888.5,4015 1887.1,4007.1 1885.5,3998.5 1883.9,3989.6"];
		gate_l13_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2207,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu4 -> gate_l13_gpu4	[pos="e,2339.2,3979.5 2396.7,4015.2 2381.6,4005.8 2365,3995.5 2348,3985"];
		gate_l13_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2545,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu5 -> gate_l13_gpu5	[pos="e,2696.3,3979.5 2762.2,4015.2 2744.5,4005.6 2725,3995 2705.2,3984.3"];
		gate_l13_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2883,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu6 -> gate_l13_gpu6	[pos="e,3004.3,3979.5 3057,4015.2 3043.3,4005.9 3028.2,3995.7 3012.8,3985.3"];
		gate_l13_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3220,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu7 -> gate_l13_gpu7	[pos="e,3287,3979.6 3315.8,4015 3308.8,4006.4 3301.1,3997 3293.3,3987.4"];
		gate_l13_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3557,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu8 -> gate_l13_gpu8	[pos="e,3557,3979.6 3557,4015 3557,4007.1 3557,3998.5 3557,3989.6"];
		gate_l13_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3906,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu9 -> gate_l13_gpu9	[pos="e,3859.8,3979.6 3839.9,4015 3844.6,4006.7 3849.6,3997.7 3854.8,3988.5"];
		gate_l13_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4253,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu10 -> gate_l13_gpu10	[pos="e,4180.3,3979.6 4149.1,4015 4156.7,4006.4 4165,3997 4173.5,3987.4"];
		gate_l13_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4615,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu11 -> gate_l13_gpu11	[pos="e,4532.5,3979.6 4496.9,4015 4505.8,4006.2 4515.4,3996.6 4525.3,3986.8"];
		gate_l13_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4970,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu12 -> gate_l13_gpu12	[pos="e,4879.7,3979.6 4840.8,4015 4850.5,4006.1 4861.2,3996.4 4872.1,3986.5"];
		gate_l13_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5334,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu13 -> gate_l13_gpu13	[pos="e,5243.2,3979.6 5204.1,4015 5213.9,4006.1 5224.6,3996.4 5235.5,3986.5"];
		gate_l13_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5694,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu14 -> gate_l13_gpu14	[pos="e,5599.1,3978.7 5556.6,4015 5567.4,4005.8 5579.1,3995.7 5591.1,3985.5"];
		gate_l13_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 13\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6055,3896.3",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l13_gpu15 -> gate_l13_gpu15	[pos="e,5957.8,3973.6 5904.8,4015.2 5918.6,4004.4 5934.1,3992.2 5949.7,3980"];
		expert_l13_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 13\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="795,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu0 -> expert_l13_gpu0	[pos="e,795,3777.6 795,3813.3 795,3804.6 795,3795.9 795,3787.7",
			style=dashed];
		expert_l13_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 13\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1068,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu1 -> expert_l13_gpu1	[pos="e,1096,3777.6 1120.6,3813.3 1114.2,3804 1107.8,3794.8 1101.9,3786.1",
			style=dashed];
		expert_l13_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 13\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1455,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu2 -> expert_l13_gpu2	[pos="e,1473,3777.6 1488.8,3813.3 1484.8,3804.3 1480.8,3795.3 1477.1,3786.9",
			style=dashed];
		expert_l13_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 13\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1807,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu3 -> expert_l13_gpu3	[pos="e,1822.4,3777.6 1835.9,3813.3 1832.6,3804.4 1829.2,3795.5 1826.1,3787.2",
			style=dashed];
		expert_l13_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 13\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2158,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu4 -> expert_l13_gpu4	[pos="e,2170.6,3777.6 2181.6,3813.3 2178.9,3804.4 2176.1,3795.5 2173.6,3787.2",
			style=dashed];
		expert_l13_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 13\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2508,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu5 -> expert_l13_gpu5	[pos="e,2517.5,3777.6 2525.8,3813.3 2523.8,3804.5 2521.7,3795.7 2519.8,3787.4",
			style=dashed];
		expert_l13_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 13\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2858,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu6 -> expert_l13_gpu6	[pos="e,2864.4,3777.6 2870.1,3813.3 2868.7,3804.6 2867.3,3795.9 2866,3787.7",
			style=dashed];
		expert_l13_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 13\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3207,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu7 -> expert_l13_gpu7	[pos="e,3210.3,3777.6 3213.3,3813.3 3212.6,3804.6 3211.8,3795.9 3211.2,3787.7",
			style=dashed];
		expert_l13_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 13\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu8 -> expert_l13_gpu8	[pos="e,3557,3777.6 3557,3813.3 3557,3804.6 3557,3795.9 3557,3787.7",
			style=dashed];
		expert_l13_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 13\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3913,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu9 -> expert_l13_gpu9	[pos="e,3911.2,3777.6 3909.6,3813.3 3910,3804.6 3910.4,3795.9 3910.8,3787.7",
			style=dashed];
		expert_l13_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 13\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4262,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu10 -> expert_l13_gpu10	[pos="e,4259.7,3777.6 4257.7,3813.3 4258.2,3804.6 4258.6,3795.9 4259.1,3787.7",
			style=dashed];
		expert_l13_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 13\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4631,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu11 -> expert_l13_gpu11	[pos="e,4626.9,3777.6 4623.3,3813.3 4624.2,3804.6 4625,3795.9 4625.9,3787.7",
			style=dashed];
		expert_l13_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 13\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4979,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu12 -> expert_l13_gpu12	[pos="e,4976.7,3777.6 4974.7,3813.3 4975.2,3804.6 4975.6,3795.9 4976.1,3787.7",
			style=dashed];
		expert_l13_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 13\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5345,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu13 -> expert_l13_gpu13	[pos="e,5342.2,3777.6 5339.7,3813.3 5340.3,3804.6 5340.9,3795.9 5341.5,3787.7",
			style=dashed];
		expert_l13_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 13\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5706,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu14 -> expert_l13_gpu14	[pos="e,5702.9,3777.6 5700.2,3813.3 5700.9,3804.6 5701.5,3795.9 5702.1,3787.7",
			style=dashed];
		expert_l13_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 13\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6067,3735.8",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l13_gpu15 -> expert_l13_gpu15	[pos="e,6063.9,3777.6 6061.2,3813.3 6061.9,3804.6 6062.5,3795.9 6063.1,3787.7",
			style=dashed];
		agg_l13_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="661,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu0 -> agg_l13_gpu0	[pos="e,730.56,3658.6 760.49,3694 753.21,3685.4 745.25,3676 737.11,3666.4"];
		agg_l13_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1023,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu1 -> agg_l13_gpu1	[pos="e,1046.4,3658.6 1056.4,3694 1054.1,3686 1051.7,3677.3 1049.1,3668.4"];
		agg_l13_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1385,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu2 -> agg_l13_gpu2	[pos="e,1421.3,3658.6 1437,3694 1433.4,3685.8 1429.4,3676.9 1425.4,3667.8"];
		agg_l13_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1747,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu3 -> agg_l13_gpu3	[pos="e,1778.1,3658.6 1791.5,3694 1788.5,3685.9 1785.1,3677.1 1781.7,3668.1"];
		agg_l13_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2109,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu4 -> agg_l13_gpu4	[pos="e,2134.4,3658.6 2145.4,3694 2142.9,3686 2140.2,3677.3 2137.5,3668.4"];
		agg_l13_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2471,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu5 -> agg_l13_gpu5	[pos="e,2490.2,3658.6 2498.5,3694 2496.6,3686 2494.6,3677.3 2492.5,3668.4"];
		agg_l13_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2833,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu6 -> agg_l13_gpu6	[pos="e,2846,3658.6 2851.6,3694 2850.3,3686.1 2849,3677.5 2847.6,3668.6"];
		agg_l13_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3195,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu7 -> agg_l13_gpu7	[pos="e,3201.2,3658.6 3203.9,3694 3203.3,3686.1 3202.7,3677.5 3202,3668.6"];
		agg_l13_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu8 -> agg_l13_gpu8	[pos="e,3557,3658.6 3557,3694 3557,3686.1 3557,3677.5 3557,3668.6"];
		agg_l13_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3919,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu9 -> agg_l13_gpu9	[pos="e,3915.9,3658.6 3914.5,3694 3914.8,3686.1 3915.2,3677.5 3915.5,3668.6"];
		agg_l13_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4281,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu10 -> agg_l13_gpu10	[pos="e,4271.1,3658.6 4266.9,3694 4267.8,3686.1 4268.9,3677.5 4269.9,3668.6"];
		agg_l13_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4643,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu11 -> agg_l13_gpu11	[pos="e,4636.8,3658.6 4634.1,3694 4634.7,3686.1 4635.3,3677.5 4636,3668.6"];
		agg_l13_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5005,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu12 -> agg_l13_gpu12	[pos="e,4991.5,3658.6 4985.7,3694 4987,3686.1 4988.4,3677.5 4989.9,3668.6"];
		agg_l13_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5367,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu13 -> agg_l13_gpu13	[pos="e,5355.6,3658.6 5350.7,3694 5351.8,3686.1 5353,3677.5 5354.2,3668.6"];
		agg_l13_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5729,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu14 -> agg_l13_gpu14	[pos="e,5717.1,3658.6 5711.9,3694 5713.1,3686.1 5714.3,3677.5 5715.6,3668.6"];
		agg_l13_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 13\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6091,3575.3",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l13_gpu15 -> agg_l13_gpu15	[pos="e,6078.5,3658.6 6073.2,3694 6074.4,3686.1 6075.7,3677.5 6077,3668.6"];
		global_agg_l13	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 13\nAll GPUs\n[128,10000,4096]",
			pos="3557,3408.2",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l13_gpu0 -> global_agg_l13	[pos="e,3447.3,3410.1 773.01,3515.4 795.32,3506 818.98,3497.7 842,3492.3 1096.5,3433.3 2944.9,3414.2 3436.9,3410.1"];
		agg_l13_gpu1 -> global_agg_l13	[pos="e,3447.2,3410.6 1135,3515.5 1157.3,3506.1 1181,3497.7 1204,3492.3 1421.8,3441.2 2988.3,3416.8 3437.1,3410.8"];
		agg_l13_gpu2 -> global_agg_l13	[pos="e,3447.5,3411.4 1497.1,3515.6 1519.4,3506.2 1543,3497.8 1566,3492.3 1747.4,3449.2 3035.2,3419.8 3437.3,3411.6"];
		agg_l13_gpu3 -> global_agg_l13	[pos="e,3447.2,3409.5 1859.1,3515.8 1881.4,3506.4 1905,3497.9 1928,3492.3 2214.2,3422.9 3110.6,3411.4 3436.8,3409.6"];
		agg_l13_gpu4 -> global_agg_l13	[pos="e,3447.4,3411.4 2221.2,3516 2243.5,3506.6 2267.1,3498.1 2290,3492.3 2505.1,3438.5 3164.5,3418 3437.1,3411.6"];
		agg_l13_gpu5 -> global_agg_l13	[pos="e,3448.3,3414.7 2583.3,3516.5 2605.6,3507.1 2629.2,3498.4 2652,3492.3 2797.3,3453.9 3227.5,3426.7 3438.1,3415.2"];
		agg_l13_gpu6 -> global_agg_l13	[pos="e,3449,3417 2945.6,3517.6 2967.9,3508.1 2991.3,3499.1 3014,3492.3 3156.7,3450 3327.3,3428.4 3438.7,3418"];
		agg_l13_gpu7 -> global_agg_l13	[pos="e,3482,3443.5 3309.5,3522.1 3362.5,3498 3424.2,3469.8 3472.8,3447.7"];
		agg_l13_gpu8 -> global_agg_l13	[pos="e,3557,3456.4 3557,3492.3 3557,3483.6 3557,3475 3557,3466.7"];
		agg_l13_gpu9 -> global_agg_l13	[pos="e,3632.1,3443.5 3748.6,3496.6 3711.4,3479.7 3673.6,3462.4 3641.5,3447.8"];
		agg_l13_gpu10 -> global_agg_l13	[pos="e,3665,3417 4110,3495.4 4106.6,3494.3 4103.3,3493.3 4100,3492.3 3957.3,3450 3786.7,3428.4 3675.3,3418"];
		agg_l13_gpu11 -> global_agg_l13	[pos="e,3665.7,3414.7 4471.8,3495.1 4468.5,3494.1 4465.3,3493.2 4462,3492.3 4316.7,3453.9 3886.5,3426.7 3675.9,3415.2"];
		agg_l13_gpu12 -> global_agg_l13	[pos="e,3666.6,3411.4 4833.8,3494.9 4830.5,3494 4827.3,3493.1 4824,3492.3 4608.9,3438.5 3949.5,3418 3676.9,3411.6"];
		agg_l13_gpu13 -> global_agg_l13	[pos="e,3666.8,3409.5 5195.8,3494.9 5192.6,3494 5189.3,3493.1 5186,3492.3 4899.8,3422.9 4003.4,3411.4 3677.2,3409.6"];
		agg_l13_gpu14 -> global_agg_l13	[pos="e,3666.5,3411.4 5557.9,3494.8 5554.6,3493.9 5551.3,3493.1 5548,3492.3 5366.6,3449.2 4078.8,3419.8 3676.7,3411.6"];
		agg_l13_gpu15 -> global_agg_l13	[pos="e,3666.8,3410.6 5919.6,3494.7 5916.4,3493.9 5913.2,3493.1 5910,3492.3 5692.2,3441.2 4125.7,3416.8 3676.9,3410.8"];
		residual_l13	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 13\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3557,3282.7",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l13 -> residual_l13	[pos="e,3557,3324.3 3557,3359.8 3557,3351.5 3557,3342.8 3557,3334.4"];
	}
	subgraph cluster_layer_14 {
		graph [bb="481,2196.8,6271,3225.2",
			label="Layer 14 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3376,3213.7",
			lwidth=3.42,
			style=dashed
		];
		dist_l14	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 14\nAll GPUs\n[128,10000,4096]",
			pos="3557,3146.1",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l14_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="844,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu0	[pos="e,927.09,3026.6 3455.6,3141.4 3162,3130.6 2285.9,3097.7 1559,3062 1335.8,3051 1073.5,3035.5 937.1,3027.2"];
		mha_l14_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1651,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu1	[pos="e,1734.3,3031 3455.3,3141 3212.6,3131 2580.6,3103 2054,3062 1947.8,3053.7 1826.1,3041.1 1744.5,3032.1"];
		mha_l14_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2146,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu2	[pos="e,2229.3,3037 3455.6,3140.9 3253.2,3132 2785,3107.8 2394,3062 2342.6,3056 2285.7,3046.9 2239.3,3038.8"];
		mha_l14_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2486,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu3	[pos="e,2569.4,3043.9 3455.7,3140.4 3288.4,3131.7 2943.9,3109.3 2656,3062 2630.9,3057.9 2604,3052.1 2579.2,3046.2"];
		mha_l14_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2748,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu4	[pos="e,2831.3,3049.7 3456.4,3138.4 3323.2,3128.2 3081.5,3105.3 2879,3062 2866.6,3059.3 2853.6,3056 2840.9,3052.4"];
		mha_l14_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2971,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu5	[pos="e,3054.1,3053.6 3458.6,3133 3361.7,3120 3210.2,3096.3 3082,3062 3076,3060.4 3069.9,3058.6 3063.8,3056.7"];
		mha_l14_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3174,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu6	[pos="e,3257.3,3055.3 3469.3,3121.4 3413.6,3105.7 3340.1,3084.1 3276,3062 3272.9,3060.9 3269.8,3059.8 3266.7,3058.7"];
		mha_l14_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3368,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu7	[pos="e,3430,3062 3498.2,3106.7 3479.4,3094.3 3458.2,3080.5 3438.6,3067.7"];
		mha_l14_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu8	[pos="e,3557,3062.2 3557,3097.7 3557,3089.3 3557,3080.6 3557,3072.2"];
		mha_l14_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3824,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu9	[pos="e,3740.6,3060.1 3628.9,3111.8 3660.4,3097.2 3697.7,3079.9 3731.3,3064.4"];
		mha_l14_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4109,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu10	[pos="e,4025.9,3040.1 3648.5,3124.6 3750.2,3101.8 3913.6,3065.3 4015.9,3042.3"];
		mha_l14_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4420,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu11	[pos="e,4337,3038 3655.7,3134 3782.3,3119.5 4008.5,3092.2 4201,3062 4242.4,3055.5 4287.9,3047.3 4326.8,3039.9"];
		mha_l14_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4769,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu12	[pos="e,4685.9,3036.1 3657.6,3138.6 3832,3127 4201.4,3099.9 4512,3062 4566.5,3055.3 4627.3,3045.9 4676,3037.8"];
		mha_l14_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5125,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu13	[pos="e,5041.7,3036.2 3658.7,3141.7 3878.6,3133.6 4414.5,3110.4 4861,3062 4917.9,3055.8 4981.4,3046.2 5031.8,3037.9"];
		mha_l14_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5519,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu14	[pos="e,5435.9,3034.5 3658.7,3142.9 3918.7,3136.8 4628.3,3116.1 5217,3062 5287.2,3055.5 5366.2,3044.8 5425.8,3036"];
		mha_l14_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 14\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5879,3020.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l14 -> mha_l14_gpu15	[pos="e,5796,3036.4 3659.1,3144.9 3959.1,3143.5 4864.3,3133.3 5611,3062 5669.4,3056.4 5734.5,3046.7 5785.9,3038.1"];
		gate_l14_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="795,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu0 -> gate_l14_gpu0	[pos="e,820.43,2943.3 831.38,2978.7 828.9,2970.7 826.21,2962 823.45,2953"];
		gate_l14_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1177,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu1 -> gate_l14_gpu1	[pos="e,1333.5,2934.6 1567.8,3002 1508.1,2988.5 1426,2967.9 1356,2943 1351.7,2941.5 1347.4,2939.9 1343.1,2938.3"];
		gate_l14_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1525,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu2 -> gate_l14_gpu2	[pos="e,1683.2,2938 2062.7,3012.1 1971.5,3002.5 1821.8,2982.1 1698,2943 1696.3,2942.5 1694.6,2941.9 1692.9,2941.4"];
		gate_l14_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1867,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu3 -> gate_l14_gpu3	[pos="e,2025.2,2938.7 2403,3005.9 2278.3,2985.5 2055.3,2948.5 2038,2943 2036.9,2942.7 2035.9,2942.3 2034.8,2942"];
		gate_l14_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2207,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu4 -> gate_l14_gpu4	[pos="e,2365.7,2939.5 2664.8,2998.7 2637.2,2992 2606.4,2984.9 2578,2979 2488.7,2960.4 2462.7,2971.2 2376,2943 2375.8,2942.9 2375.6,2942.9 \
2375.4,2942.8"];
		gate_l14_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2545,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu5 -> gate_l14_gpu5	[pos="e,2703.4,2938.9 2887.9,2993.5 2872,2988.6 2855.5,2983.6 2840,2979 2784.2,2962.4 2768.4,2963.8 2714,2943 2713.7,2942.9 2713.3,2942.7 \
2713,2942.6"];
		gate_l14_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2883,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu6 -> gate_l14_gpu6	[pos="e,3033.8,2943.1 3099.4,2978.9 3081.8,2969.3 3062.4,2958.7 3042.6,2947.9"];
		gate_l14_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3220,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu7 -> gate_l14_gpu7	[pos="e,3296.8,2943.3 3329.9,2978.7 3321.8,2970 3312.9,2960.5 3303.8,2950.7"];
		gate_l14_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3557,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu8 -> gate_l14_gpu8	[pos="e,3557,2943.3 3557,2978.7 3557,2970.8 3557,2962.1 3557,2953.3"];
		gate_l14_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3906,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu9 -> gate_l14_gpu9	[pos="e,3863.4,2943.3 3845.1,2978.7 3849.4,2970.4 3854.1,2961.4 3858.8,2952.2"];
		gate_l14_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4253,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu10 -> gate_l14_gpu10	[pos="e,4178.3,2943.3 4146.1,2978.7 4154,2970 4162.6,2960.5 4171.5,2950.7"];
		gate_l14_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4602,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu11 -> gate_l14_gpu11	[pos="e,4507.5,2943.3 4466.9,2978.7 4477.2,2969.7 4488.4,2959.9 4499.9,2949.9"];
		gate_l14_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4967,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu12 -> gate_l14_gpu12	[pos="e,4870.6,2938.2 4819.7,2978.9 4833,2968.3 4847.8,2956.4 4862.8,2944.4"];
		gate_l14_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5334,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu13 -> gate_l14_gpu13	[pos="e,5236.3,2935.1 5178.6,2978.9 5193.7,2967.4 5210.8,2954.4 5227.9,2941.4"];
		gate_l14_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5694,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu14 -> gate_l14_gpu14	[pos="e,5603.2,2943.3 5564.1,2978.7 5573.9,2969.8 5584.6,2960.1 5595.5,2950.2"];
		gate_l14_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 14\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6055,2860",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l14_gpu15 -> gate_l14_gpu15	[pos="e,5963.6,2943.3 5924.3,2978.7 5934.2,2969.8 5945,2960.1 5956,2950.2"];
		expert_l14_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 14\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="795,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu0 -> expert_l14_gpu0	[pos="e,795,2741.3 795,2777 795,2768.3 795,2759.6 795,2751.4",
			style=dashed];
		expert_l14_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 14\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1068,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu1 -> expert_l14_gpu1	[pos="e,1096,2741.3 1120.6,2777 1114.2,2767.7 1107.8,2758.4 1101.9,2749.8",
			style=dashed];
		expert_l14_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 14\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1455,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu2 -> expert_l14_gpu2	[pos="e,1473,2741.3 1488.8,2777 1484.8,2768 1480.8,2759 1477.1,2750.6",
			style=dashed];
		expert_l14_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 14\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1807,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu3 -> expert_l14_gpu3	[pos="e,1822.4,2741.3 1835.9,2777 1832.6,2768.1 1829.2,2759.2 1826.1,2750.8",
			style=dashed];
		expert_l14_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 14\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2158,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu4 -> expert_l14_gpu4	[pos="e,2170.6,2741.3 2181.6,2777 2178.9,2768.1 2176.1,2759.2 2173.6,2750.8",
			style=dashed];
		expert_l14_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 14\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2508,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu5 -> expert_l14_gpu5	[pos="e,2517.5,2741.3 2525.8,2777 2523.8,2768.2 2521.7,2759.4 2519.8,2751.1",
			style=dashed];
		expert_l14_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 14\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2858,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu6 -> expert_l14_gpu6	[pos="e,2864.4,2741.3 2870.1,2777 2868.7,2768.3 2867.3,2759.6 2866,2751.4",
			style=dashed];
		expert_l14_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 14\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3207,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu7 -> expert_l14_gpu7	[pos="e,3210.3,2741.3 3213.3,2777 3212.6,2768.3 3211.8,2759.6 3211.2,2751.4",
			style=dashed];
		expert_l14_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 14\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu8 -> expert_l14_gpu8	[pos="e,3557,2741.3 3557,2777 3557,2768.3 3557,2759.6 3557,2751.4",
			style=dashed];
		expert_l14_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 14\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3912,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu9 -> expert_l14_gpu9	[pos="e,3910.5,2741.3 3909.1,2777 3909.4,2768.3 3909.8,2759.6 3910.1,2751.4",
			style=dashed];
		expert_l14_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 14\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4262,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu10 -> expert_l14_gpu10	[pos="e,4259.7,2741.3 4257.7,2777 4258.2,2768.3 4258.6,2759.6 4259.1,2751.4",
			style=dashed];
		expert_l14_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 14\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4637,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu11 -> expert_l14_gpu11	[pos="e,4628,2741.3 4620.1,2777 4622.1,2768.2 4624,2759.4 4625.8,2751.1",
			style=dashed];
		expert_l14_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 14\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4986,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu12 -> expert_l14_gpu12	[pos="e,4981.1,2741.3 4976.8,2777 4977.9,2768.3 4978.9,2759.6 4979.9,2751.4",
			style=dashed];
		expert_l14_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 14\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5345,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu13 -> expert_l14_gpu13	[pos="e,5342.2,2741.3 5339.7,2777 5340.3,2768.3 5340.9,2759.6 5341.5,2751.4",
			style=dashed];
		expert_l14_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 14\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5706,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu14 -> expert_l14_gpu14	[pos="e,5702.9,2741.3 5700.2,2777 5700.9,2768.3 5701.5,2759.6 5702.1,2751.4",
			style=dashed];
		expert_l14_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 14\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6067,2699.5",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l14_gpu15 -> expert_l14_gpu15	[pos="e,6063.9,2741.3 6061.2,2777 6061.9,2768.3 6062.5,2759.6 6063.1,2751.4",
			style=dashed];
		agg_l14_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="661,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu0 -> agg_l14_gpu0	[pos="e,730.56,2622.3 760.49,2657.7 753.21,2649.1 745.25,2639.7 737.11,2630"];
		agg_l14_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1023,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu1 -> agg_l14_gpu1	[pos="e,1046.4,2622.3 1056.4,2657.7 1054.1,2649.7 1051.7,2641 1049.1,2632"];
		agg_l14_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1385,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu2 -> agg_l14_gpu2	[pos="e,1421.3,2622.3 1437,2657.7 1433.4,2649.5 1429.4,2640.6 1425.4,2631.5"];
		agg_l14_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1747,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu3 -> agg_l14_gpu3	[pos="e,1778.1,2622.3 1791.5,2657.7 1788.5,2649.6 1785.1,2640.8 1781.7,2631.7"];
		agg_l14_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2109,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu4 -> agg_l14_gpu4	[pos="e,2134.4,2622.3 2145.4,2657.7 2142.9,2649.7 2140.2,2641 2137.5,2632"];
		agg_l14_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2471,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu5 -> agg_l14_gpu5	[pos="e,2490.2,2622.3 2498.5,2657.7 2496.6,2649.7 2494.6,2641 2492.5,2632"];
		agg_l14_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2833,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu6 -> agg_l14_gpu6	[pos="e,2846,2622.3 2851.6,2657.7 2850.3,2649.8 2849,2641.1 2847.6,2632.3"];
		agg_l14_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3195,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu7 -> agg_l14_gpu7	[pos="e,3201.2,2622.3 3203.9,2657.7 3203.3,2649.8 3202.7,2641.1 3202,2632.3"];
		agg_l14_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu8 -> agg_l14_gpu8	[pos="e,3557,2622.3 3557,2657.7 3557,2649.8 3557,2641.1 3557,2632.3"];
		agg_l14_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3919,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu9 -> agg_l14_gpu9	[pos="e,3915.4,2622.3 3913.8,2657.7 3914.2,2649.8 3914.5,2641.1 3914.9,2632.3"];
		agg_l14_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4281,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu10 -> agg_l14_gpu10	[pos="e,4271.1,2622.3 4266.9,2657.7 4267.8,2649.8 4268.9,2641.1 4269.9,2632.3"];
		agg_l14_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4643,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu11 -> agg_l14_gpu11	[pos="e,4639.9,2622.3 4638.5,2657.7 4638.8,2649.8 4639.2,2641.1 4639.5,2632.3"];
		agg_l14_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5005,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu12 -> agg_l14_gpu12	[pos="e,4995.1,2622.3 4990.9,2657.7 4991.8,2649.8 4992.9,2641.1 4993.9,2632.3"];
		agg_l14_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5367,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu13 -> agg_l14_gpu13	[pos="e,5355.6,2622.3 5350.7,2657.7 5351.8,2649.8 5353,2641.1 5354.2,2632.3"];
		agg_l14_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5729,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu14 -> agg_l14_gpu14	[pos="e,5717.1,2622.3 5711.9,2657.7 5713.1,2649.8 5714.3,2641.1 5715.6,2632.3"];
		agg_l14_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 14\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6091,2539",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l14_gpu15 -> agg_l14_gpu15	[pos="e,6078.5,2622.3 6073.2,2657.7 6074.4,2649.8 6075.7,2641.1 6077,2632.3"];
		global_agg_l14	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 14\nAll GPUs\n[128,10000,4096]",
			pos="3557,2371.9",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l14_gpu0 -> global_agg_l14	[pos="e,3447.3,2373.7 773.01,2479.1 795.32,2469.7 818.98,2461.3 842,2456 1096.5,2397 2944.9,2377.9 3436.9,2373.8"];
		agg_l14_gpu1 -> global_agg_l14	[pos="e,3447.2,2374.3 1135,2479.2 1157.3,2469.8 1181,2461.4 1204,2456 1421.8,2404.9 2988.3,2380.4 3437.1,2374.4"];
		agg_l14_gpu2 -> global_agg_l14	[pos="e,3447.5,2375 1497.1,2479.3 1519.4,2469.9 1543,2461.5 1566,2456 1747.4,2412.8 3035.2,2383.5 3437.3,2375.2"];
		agg_l14_gpu3 -> global_agg_l14	[pos="e,3447.2,2373.2 1859.1,2479.4 1881.4,2470 1905,2461.6 1928,2456 2214.2,2386.5 3110.6,2375.1 3436.8,2373.3"];
		agg_l14_gpu4 -> global_agg_l14	[pos="e,3447.4,2375.1 2221.2,2479.7 2243.5,2470.3 2267.1,2461.7 2290,2456 2505.1,2402.1 3164.5,2381.6 3437.1,2375.3"];
		agg_l14_gpu5 -> global_agg_l14	[pos="e,3448.3,2378.4 2583.3,2480.2 2605.6,2470.7 2629.2,2462 2652,2456 2797.3,2417.6 3227.5,2390.3 3438.1,2378.9"];
		agg_l14_gpu6 -> global_agg_l14	[pos="e,3449,2380.7 2945.6,2481.3 2967.9,2471.7 2991.3,2462.7 3014,2456 3156.7,2413.6 3327.3,2392 3438.7,2381.6"];
		agg_l14_gpu7 -> global_agg_l14	[pos="e,3482,2407.1 3309.5,2485.8 3362.5,2461.6 3424.2,2433.5 3472.8,2411.3"];
		agg_l14_gpu8 -> global_agg_l14	[pos="e,3557,2420.1 3557,2455.9 3557,2447.3 3557,2438.6 3557,2430.4"];
		agg_l14_gpu9 -> global_agg_l14	[pos="e,3632.1,2407.2 3748.6,2460.3 3711.4,2443.3 3673.6,2426.1 3641.5,2411.4"];
		agg_l14_gpu10 -> global_agg_l14	[pos="e,3665,2380.7 4110,2459.1 4106.6,2458 4103.3,2457 4100,2456 3957.3,2413.6 3786.7,2392 3675.3,2381.6"];
		agg_l14_gpu11 -> global_agg_l14	[pos="e,3665.7,2378.4 4471.8,2458.7 4468.5,2457.8 4465.3,2456.9 4462,2456 4316.7,2417.6 3886.5,2390.3 3675.9,2378.9"];
		agg_l14_gpu12 -> global_agg_l14	[pos="e,3666.6,2375.1 4833.8,2458.6 4830.5,2457.7 4827.3,2456.8 4824,2456 4608.9,2402.1 3949.5,2381.6 3676.9,2375.3"];
		agg_l14_gpu13 -> global_agg_l14	[pos="e,3666.8,2373.2 5195.8,2458.5 5192.6,2457.6 5189.3,2456.8 5186,2456 4899.8,2386.5 4003.4,2375.1 3677.2,2373.3"];
		agg_l14_gpu14 -> global_agg_l14	[pos="e,3666.5,2375 5557.9,2458.5 5554.6,2457.6 5551.3,2456.8 5548,2456 5366.6,2412.8 4078.8,2383.5 3676.7,2375.2"];
		agg_l14_gpu15 -> global_agg_l14	[pos="e,3666.8,2374.3 5919.6,2458.4 5916.4,2457.6 5913.2,2456.7 5910,2456 5692.2,2404.9 4125.7,2380.4 3676.9,2374.4"];
		residual_l14	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 14\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="3557,2246.3",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l14 -> residual_l14	[pos="e,3557,2288 3557,2323.5 3557,2315.2 3557,2306.5 3557,2298.1"];
	}
	subgraph cluster_layer_15 {
		graph [bb="481,1160.5,6271,2188.8",
			label="Layer 15 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="3376,2177.3",
			lwidth=3.42,
			style=dashed
		];
		dist_l15	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 15\nAll GPUs\n[128,10000,4096]",
			pos="3557,2109.7",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l15_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1017,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu0	[pos="e,1100.1,2008.7 3455.1,2107.9 3060.7,2104.3 1633.7,2087 1185,2025.7 1160.4,2022.3 1134.2,2016.9 1110,2011.1"];
		mha_l15_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1277,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu1	[pos="e,1360.2,2007.1 3455.2,2107.2 3090.7,2101.1 1851.2,2077 1458,2025.7 1429.2,2021.9 1398.1,2015.7 1370,2009.4"];
		mha_l15_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1550,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu2	[pos="e,1633,1991.7 3455.9,2103.6 3219.1,2091.2 2609.8,2058.9 2101,2025.7 1940,2015.2 1752.6,2001 1643.1,1992.5"];
		mha_l15_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2193,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu3	[pos="e,2276,1996.7 3456.2,2102.3 3269.9,2089.9 2859.1,2061.2 2514,2025.7 2437.1,2017.8 2350.1,2006.6 2286.1,1998.1"];
		mha_l15_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2606,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu4	[pos="e,2689.3,2003.1 3457.1,2100.2 3313.9,2087.4 3042.5,2060.9 2813,2025.7 2775.6,2019.9 2734.7,2012.2 2699.2,2005.1"];
		mha_l15_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2905,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu5	[pos="e,2988.2,2009.4 3459.5,2095.7 3357.8,2081.3 3193.9,2056.1 3054,2025.7 3035.8,2021.7 3016.5,2016.9 2998,2012"];
		mha_l15_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3146,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu6	[pos="e,3229.2,2013.5 3469.8,2084.8 3412,2068.7 3334.8,2046.7 3267,2025.7 3257.8,2022.8 3248.2,2019.8 3238.7,2016.6"];
		mha_l15_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3359,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu7	[pos="e,3423.9,2025.7 3496.5,2071 3476.3,2058.4 3453.6,2044.2 3432.5,2031.1"];
		mha_l15_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu8	[pos="e,3557,2025.8 3557,2061.3 3557,2053 3557,2044.3 3557,2035.9"];
		mha_l15_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3830,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu9	[pos="e,3746.6,2022.9 3629.4,2076 3662.5,2061 3702,2043.1 3737.3,2027.2"];
		mha_l15_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4135,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu10	[pos="e,4051.5,2003 3649.2,2089 3756.8,2066 3933.6,2028.2 4041.6,2005.1"];
		mha_l15_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4456,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu11	[pos="e,4373,2000.9 3656,2098.1 3786.9,2083.6 4024.7,2056.1 4227,2025.7 4271.8,2018.9 4321.4,2010.3 4362.9,2002.8"];
		mha_l15_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4822,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu12	[pos="e,4738.8,1998.9 3657.8,2102.4 3837.2,2090.7 4223.4,2063.2 4548,2025.7 4608.4,2018.7 4675.9,2008.7 4728.8,2000.4"];
		mha_l15_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5155,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu13	[pos="e,5071.9,2001.3 3658.6,2106.2 3884.8,2099.7 4446.8,2079.1 4914,2025.7 4963.1,2020.1 5017.4,2011.2 5062,2003.1"];
		mha_l15_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5524,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu14	[pos="e,5440.9,1999.4 3658.7,2107.2 3921.8,2102.3 4646.5,2084.2 5247,2025.7 5308.5,2019.7 5377.2,2009.7 5430.8,2001.1"];
		mha_l15_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 15\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5864,1984.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l15 -> mha_l15_gpu15	[pos="e,5780.8,2001.3 3659.1,2109 3959.7,2108.8 4867.7,2101.6 5616,2025.7 5667.5,2020.4 5724.4,2011.4 5770.8,2003.1"];
		gate_l15_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="840,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu0 -> gate_l15_gpu0	[pos="e,931.88,1906.9 971.42,1942.3 961.51,1933.5 950.66,1923.8 939.58,1913.8"];
		gate_l15_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1188,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu1 -> gate_l15_gpu1	[pos="e,1234.2,1906.9 1254.1,1942.3 1249.4,1934.1 1244.4,1925.1 1239.2,1915.8"];
		gate_l15_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1530,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu2 -> gate_l15_gpu2	[pos="e,1540.4,1906.9 1544.8,1942.3 1543.8,1934.4 1542.8,1925.8 1541.6,1917"];
		gate_l15_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1870,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu3 -> gate_l15_gpu3	[pos="e,2028.2,1902.3 2110.2,1942.6 2087.8,1931.5 2062.6,1919.2 2037.2,1906.7"];
		gate_l15_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2208,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu4 -> gate_l15_gpu4	[pos="e,2366,1902.1 2522.9,1958.3 2479,1944.4 2424.5,1926 2377,1906.7 2376.4,1906.4 2375.9,1906.2 2375.3,1906"];
		gate_l15_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2546,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu5 -> gate_l15_gpu5	[pos="e,2704.1,1902.2 2821.7,1951.3 2788,1938.1 2748.9,1922.2 2714,1906.7 2713.8,1906.6 2713.6,1906.5 2713.4,1906.4"];
		gate_l15_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2883,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu6 -> gate_l15_gpu6	[pos="e,3019.3,1906.8 3078.6,1942.6 3062.9,1933.1 3045.6,1922.7 3028,1912"];
		gate_l15_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3220,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu7 -> gate_l15_gpu7	[pos="e,3292.2,1906.9 3323.2,1942.3 3315.7,1933.7 3307.4,1924.3 3299,1914.7"];
		gate_l15_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3557,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu8 -> gate_l15_gpu8	[pos="e,3557,1906.9 3557,1942.3 3557,1934.4 3557,1925.8 3557,1917"];
		gate_l15_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3901,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu9 -> gate_l15_gpu9	[pos="e,3864.1,1906.9 3848.3,1942.3 3852,1934.2 3855.9,1925.3 3860,1916.1"];
		gate_l15_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4250,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu10 -> gate_l15_gpu10	[pos="e,4190.3,1906.9 4164.6,1942.3 4170.7,1933.9 4177.4,1924.7 4184.3,1915.3"];
		gate_l15_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4606,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu11 -> gate_l15_gpu11	[pos="e,4528.1,1906.9 4494.6,1942.3 4502.9,1933.7 4511.9,1924.1 4521.1,1914.4"];
		gate_l15_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4963,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu12 -> gate_l15_gpu12	[pos="e,4889.8,1906.9 4858.3,1942.3 4866,1933.7 4874.3,1924.3 4882.9,1914.7"];
		gate_l15_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5323,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu13 -> gate_l15_gpu13	[pos="e,5235.8,1906.9 5198.3,1942.3 5207.7,1933.5 5218,1923.8 5228.5,1913.8"];
		gate_l15_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5684,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu14 -> gate_l15_gpu14	[pos="e,5600.9,1906.9 5565.2,1942.3 5574.1,1933.6 5583.8,1924 5593.7,1914.1"];
		gate_l15_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 15\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="6046,1823.7",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l15_gpu15 -> gate_l15_gpu15	[pos="e,5951.5,1906.9 5910.9,1942.3 5921.2,1933.4 5932.4,1923.6 5943.9,1913.6"];
		expert_l15_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 15\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="840,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu0 -> expert_l15_gpu0	[pos="e,840,1705 840,1740.6 840,1731.9 840,1723.3 840,1715.1",
			style=dashed];
		expert_l15_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 15\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1106,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu1 -> expert_l15_gpu1	[pos="e,1127.1,1705 1145.6,1740.6 1140.9,1731.5 1136.2,1722.5 1131.8,1714",
			style=dashed];
		expert_l15_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 15\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1457,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu2 -> expert_l15_gpu2	[pos="e,1475.8,1705 1492.2,1740.6 1488.1,1731.6 1483.9,1722.7 1480.1,1714.2",
			style=dashed];
		expert_l15_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 15\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1808,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu3 -> expert_l15_gpu3	[pos="e,1824,1705 1837.9,1740.6 1834.4,1731.7 1831,1722.9 1827.7,1714.5",
			style=dashed];
		expert_l15_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 15\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2158,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu4 -> expert_l15_gpu4	[pos="e,2170.9,1705 2182.1,1740.6 2179.3,1731.7 2176.5,1722.9 2173.9,1714.5",
			style=dashed];
		expert_l15_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 15\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2508,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu5 -> expert_l15_gpu5	[pos="e,2517.8,1705 2526.3,1740.6 2524.2,1731.8 2522.1,1723.1 2520.1,1714.8",
			style=dashed];
		expert_l15_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 15\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2858,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu6 -> expert_l15_gpu6	[pos="e,2864.4,1705 2870.1,1740.6 2868.7,1731.9 2867.3,1723.3 2866,1715.1",
			style=dashed];
		expert_l15_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 15\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3207,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu7 -> expert_l15_gpu7	[pos="e,3210.3,1705 3213.3,1740.6 3212.6,1731.9 3211.8,1723.3 3211.2,1715.1",
			style=dashed];
		expert_l15_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 15\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu8 -> expert_l15_gpu8	[pos="e,3557,1705 3557,1740.6 3557,1731.9 3557,1723.3 3557,1715.1",
			style=dashed];
		expert_l15_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 15\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3907,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu9 -> expert_l15_gpu9	[pos="e,3905.5,1705 3904.1,1740.6 3904.4,1731.9 3904.8,1723.3 3905.1,1715.1",
			style=dashed];
		expert_l15_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 15\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4266,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu10 -> expert_l15_gpu10	[pos="e,4261.9,1705 4258.3,1740.6 4259.2,1731.9 4260,1723.3 4260.9,1715.1",
			style=dashed];
		expert_l15_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 15\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4624,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu11 -> expert_l15_gpu11	[pos="e,4619.4,1705 4615.3,1740.6 4616.3,1731.9 4617.3,1723.3 4618.2,1715.1",
			style=dashed];
		expert_l15_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 15\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4983,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu12 -> expert_l15_gpu12	[pos="e,4977.9,1705 4973.4,1740.6 4974.5,1731.9 4975.5,1723.3 4976.6,1715.1",
			style=dashed];
		expert_l15_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 15\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5335,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu13 -> expert_l15_gpu13	[pos="e,5331.9,1705 5329.2,1740.6 5329.9,1731.9 5330.5,1723.3 5331.1,1715.1",
			style=dashed];
		expert_l15_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 15\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5696,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu14 -> expert_l15_gpu14	[pos="e,5692.9,1705 5690.2,1740.6 5690.9,1731.9 5691.5,1723.3 5692.1,1715.1",
			style=dashed];
		expert_l15_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 15\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6058,1663.2",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l15_gpu15 -> expert_l15_gpu15	[pos="e,6054.9,1705 6052.2,1740.6 6052.9,1731.9 6053.5,1723.3 6054.1,1715.1",
			style=dashed];
		agg_l15_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="661,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu0 -> agg_l15_gpu0	[pos="e,753.91,1585.9 793.9,1621.3 783.89,1612.5 772.92,1602.8 761.7,1592.8"];
		agg_l15_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1023,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu1 -> agg_l15_gpu1	[pos="e,1066.1,1585.9 1084.6,1621.3 1080.3,1613.1 1075.6,1604.1 1070.7,1594.8"];
		agg_l15_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1385,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu2 -> agg_l15_gpu2	[pos="e,1422.4,1585.9 1438.5,1621.3 1434.7,1613.2 1430.7,1604.3 1426.5,1595.1"];
		agg_l15_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1747,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu3 -> agg_l15_gpu3	[pos="e,1778.7,1585.9 1792.3,1621.3 1789.2,1613.2 1785.8,1604.4 1782.3,1595.4"];
		agg_l15_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2109,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu4 -> agg_l15_gpu4	[pos="e,2134.4,1585.9 2145.4,1621.3 2142.9,1613.3 2140.2,1604.6 2137.5,1595.7"];
		agg_l15_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2471,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu5 -> agg_l15_gpu5	[pos="e,2490.2,1585.9 2498.5,1621.3 2496.6,1613.3 2494.6,1604.6 2492.5,1595.7"];
		agg_l15_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2833,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu6 -> agg_l15_gpu6	[pos="e,2846,1585.9 2851.6,1621.3 2850.3,1613.4 2849,1604.8 2847.6,1596"];
		agg_l15_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3195,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu7 -> agg_l15_gpu7	[pos="e,3201.2,1585.9 3203.9,1621.3 3203.3,1613.4 3202.7,1604.8 3202,1596"];
		agg_l15_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3557,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu8 -> agg_l15_gpu8	[pos="e,3557,1585.9 3557,1621.3 3557,1613.4 3557,1604.8 3557,1596"];
		agg_l15_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3919,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu9 -> agg_l15_gpu9	[pos="e,3912.8,1585.9 3910.1,1621.3 3910.7,1613.4 3911.3,1604.8 3912,1596"];
		agg_l15_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4281,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu10 -> agg_l15_gpu10	[pos="e,4273.2,1585.9 4269.9,1621.3 4270.6,1613.4 4271.4,1604.8 4272.3,1596"];
		agg_l15_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4643,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu11 -> agg_l15_gpu11	[pos="e,4633.1,1585.9 4628.9,1621.3 4629.8,1613.4 4630.9,1604.8 4631.9,1596"];
		agg_l15_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5005,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu12 -> agg_l15_gpu12	[pos="e,4993.6,1585.9 4988.7,1621.3 4989.8,1613.4 4991,1604.8 4992.2,1596"];
		agg_l15_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5367,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu13 -> agg_l15_gpu13	[pos="e,5350.4,1585.9 5343.2,1621.3 5344.8,1613.4 5346.6,1604.8 5348.4,1596"];
		agg_l15_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5729,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu14 -> agg_l15_gpu14	[pos="e,5711.9,1585.9 5704.5,1621.3 5706.1,1613.4 5707.9,1604.8 5709.8,1596"];
		agg_l15_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 15\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="6091,1502.7",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l15_gpu15 -> agg_l15_gpu15	[pos="e,6073.9,1585.9 6066.5,1621.3 6068.1,1613.4 6069.9,1604.8 6071.8,1596"];
		global_agg_l15	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 15\nAll GPUs\n[128,10000,4096]",
			pos="3557,1335.6",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l15_gpu0 -> global_agg_l15	[pos="e,3447.3,1337.4 773.01,1442.7 795.32,1433.4 818.98,1425 842,1419.7 1096.5,1360.6 2944.9,1341.5 3436.9,1337.5"];
		agg_l15_gpu1 -> global_agg_l15	[pos="e,3447.2,1338 1135,1442.8 1157.3,1433.4 1181,1425.1 1204,1419.7 1421.8,1368.6 2988.3,1344.1 3437.1,1338.1"];
		agg_l15_gpu2 -> global_agg_l15	[pos="e,3447.5,1338.7 1497.1,1442.9 1519.4,1433.5 1543,1425.1 1566,1419.7 1747.4,1376.5 3035.2,1347.1 3437.3,1338.9"];
		agg_l15_gpu3 -> global_agg_l15	[pos="e,3447.2,1336.9 1859.1,1443.1 1881.4,1433.7 1905,1425.2 1928,1419.7 2214.2,1350.2 3110.6,1338.8 3436.8,1336.9"];
		agg_l15_gpu4 -> global_agg_l15	[pos="e,3447.4,1338.7 2221.2,1443.4 2243.5,1433.9 2267.1,1425.4 2290,1419.7 2505.1,1365.8 3164.5,1345.3 3437.1,1339"];
		agg_l15_gpu5 -> global_agg_l15	[pos="e,3448.3,1342 2583.3,1443.9 2605.6,1434.4 2629.2,1425.7 2652,1419.7 2797.3,1381.3 3227.5,1354 3438.1,1342.6"];
		agg_l15_gpu6 -> global_agg_l15	[pos="e,3449,1344.4 2945.6,1445 2967.9,1435.4 2991.3,1426.4 3014,1419.7 3156.7,1377.3 3327.3,1355.7 3438.7,1345.3"];
		agg_l15_gpu7 -> global_agg_l15	[pos="e,3482,1370.8 3309.5,1449.4 3362.5,1425.3 3424.2,1397.1 3472.8,1375"];
		agg_l15_gpu8 -> global_agg_l15	[pos="e,3557,1383.8 3557,1419.6 3557,1411 3557,1402.3 3557,1394"];
		agg_l15_gpu9 -> global_agg_l15	[pos="e,3632.1,1370.8 3748.6,1424 3711.4,1407 3673.6,1389.7 3641.5,1375.1"];
		agg_l15_gpu10 -> global_agg_l15	[pos="e,3665,1344.4 4110,1422.8 4106.6,1421.7 4103.3,1420.6 4100,1419.7 3957.3,1377.3 3786.7,1355.7 3675.3,1345.3"];
		agg_l15_gpu11 -> global_agg_l15	[pos="e,3665.7,1342 4471.8,1422.4 4468.5,1421.4 4465.3,1420.5 4462,1419.7 4316.7,1381.3 3886.5,1354 3675.9,1342.6"];
		agg_l15_gpu12 -> global_agg_l15	[pos="e,3666.6,1338.7 4833.8,1422.3 4830.5,1421.4 4827.3,1420.5 4824,1419.7 4608.9,1365.8 3949.5,1345.3 3676.9,1339"];
		agg_l15_gpu13 -> global_agg_l15	[pos="e,3666.8,1336.9 5195.8,1422.2 5192.6,1421.3 5189.3,1420.5 5186,1419.7 4899.8,1350.2 4003.4,1338.8 3677.2,1336.9"];
		agg_l15_gpu14 -> global_agg_l15	[pos="e,3666.5,1338.7 5557.9,1422.2 5554.6,1421.3 5551.3,1420.4 5548,1419.7 5366.6,1376.5 4078.8,1347.1 3676.7,1338.9"];
		agg_l15_gpu15 -> global_agg_l15	[pos="e,3666.8,1338 5919.6,1422.1 5916.4,1421.2 5913.2,1420.4 5910,1419.7 5692.2,1368.6 4125.7,1344.1 3676.9,1338.1"];
		residual_l15	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 15\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4859,1210",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l15 -> residual_l15	[pos="e,4757.4,1220.6 3663.8,1324.4 3906.9,1301.4 4499.5,1245.1 4747.3,1221.6"];
	}
	subgraph cluster_layer_16 {
		graph [bb="8,124.17,5798,1152.5",
			label="Layer 16 (16 Experts on 16 GPUs)",
			lheight=0.21,
			lp="2903,1141",
			lwidth=3.42,
			style=dashed
		];
		dist_l16	[fillcolor=lightyellow,
			height=1.3356,
			label="Distribute Tokens\nLayer 16\nAll GPUs\n[128,10000,4096]",
			pos="3084,1073.4",
			shape=ellipse,
			style=filled,
			width=2.8284];
		mha_l16_gpu0	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="511,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu0	[pos="e,594.02,963.13 2982.1,1072.6 2660.3,1072.3 1636.4,1065 793,989.33 729.7,983.66 658.89,973.47 604.06,964.74"];
		mha_l16_gpu1	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="885,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu1	[pos="e,968.13,972.28 2982.1,1070.9 2625.1,1065.1 1431.8,1042.2 1053,989.33 1028.5,985.91 1002.2,980.47 978.02,974.68"];
		mha_l16_gpu2	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1145,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu2	[pos="e,1228.3,970.07 2982.3,1069.8 2658.5,1061.2 1653.7,1031.8 1331,989.33 1300.5,985.32 1267.7,978.88 1238.1,972.31"];
		mha_l16_gpu3	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1423,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu3	[pos="e,1506,956.32 2983.1,1065.9 2778.3,1052.5 2299.1,1020.6 1897,989.33 1764.7,979.05 1611.8,965.73 1516.2,957.23"];
		mha_l16_gpu4	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1989,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu4	[pos="e,2072.2,961.63 2984.2,1063.5 2830.8,1049.5 2528.2,1020.8 2272,989.33 2208.6,981.55 2137.4,971.36 2082.3,963.14"];
		mha_l16_gpu5	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2364,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu5	[pos="e,2447.1,967.8 2986.6,1058.9 2879.7,1043.7 2703.2,1017.4 2552,989.33 2521,983.58 2487.4,976.57 2457.2,970.01"];
		mha_l16_gpu6	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2644,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu6	[pos="e,2727.2,973.08 2996.6,1048.5 2936.7,1032 2855.5,1009.6 2784,989.33 2768.8,985.02 2752.6,980.4 2736.9,975.88"];
		mha_l16_gpu7	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2876,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu7	[pos="e,2944.2,989.34 3021.6,1035.3 3000,1022.5 2975.6,1008 2953.1,994.62"];
		mha_l16_gpu8	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3084,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu8	[pos="e,3084,989.49 3084,1025 3084,1016.7 3084,1008 3084,999.56"];
		mha_l16_gpu9	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3344,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu9	[pos="e,3260.9,988.35 3154.7,1038.8 3184.5,1024.6 3219.7,1007.9 3251.5,992.79"];
		mha_l16_gpu10	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3668,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu10	[pos="e,3584.8,966.44 3176.2,1052.9 3285.2,1029.8 3465.4,991.72 3574.7,968.57"];
		mha_l16_gpu11	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3978,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu11	[pos="e,3894.9,965.52 3183.1,1062.2 3315,1048.1 3555.6,1020.8 3760,989.33 3801,983.01 3846.2,974.82 3884.7,967.47"];
		mha_l16_gpu12	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4318,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu12	[pos="e,4235,964.04 3185,1066.5 3363.9,1055.5 3747.8,1029.2 4070,989.33 4121.4,982.98 4178.5,973.8 4225,965.79"];
		mha_l16_gpu13	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4704,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu13	[pos="e,4620.9,961.96 3185.7,1068.6 3408.1,1059.8 3954.4,1034.9 4410,989.33 4477.3,982.59 4553,972.11 4610.7,963.49"];
		mha_l16_gpu14	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5022,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu14	[pos="e,4938.9,966.36 3186.2,1072 3452.2,1070.1 4188,1058.3 4796,989.33 4840,984.34 4888.4,976.06 4929,968.28"];
		mha_l16_gpu15	[fillcolor=lightgreen,
			height=1.1528,
			label="MHA\nLayer 16\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5390,947.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		dist_l16 -> mha_l16_gpu15	[pos="e,5306.9,963.34 3185.9,1072 3483.5,1070 4376.7,1058.3 5114,989.33 5175.2,983.61 5243.5,973.62 5296.8,964.99"];
		gate_l16_gpu0	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="322,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu0 -> gate_l16_gpu0	[pos="e,420.1,870.61 462.33,906.02 451.65,897.06 439.94,887.24 427.99,877.22"];
		gate_l16_gpu1	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="704,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu1 -> gate_l16_gpu1	[pos="e,797.95,870.61 838.39,906.02 828.16,897.06 816.95,887.24 805.5,877.22"];
		gate_l16_gpu2	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1052,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu2 -> gate_l16_gpu2	[pos="e,1100.3,870.61 1121.1,906.02 1116.2,897.74 1110.9,888.74 1105.5,879.51"];
		gate_l16_gpu3	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1394,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu3 -> gate_l16_gpu3	[pos="e,1409.1,870.61 1415.5,906.02 1414.1,898.08 1412.5,889.48 1410.9,880.65"];
		gate_l16_gpu4	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="1734,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu4 -> gate_l16_gpu4	[pos="e,1866.2,870.47 1923.7,906.22 1908.6,896.85 1892,886.52 1875,875.99"];
		gate_l16_gpu5	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2072,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu5 -> gate_l16_gpu5	[pos="e,2223.3,870.47 2289.2,906.22 2271.5,896.63 2252,886.05 2232.2,875.27"];
		gate_l16_gpu6	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2410,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu6 -> gate_l16_gpu6	[pos="e,2531.3,870.47 2584,906.22 2570.3,896.93 2555.2,886.71 2539.8,876.28"];
		gate_l16_gpu7	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="2747,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu7 -> gate_l16_gpu7	[pos="e,2814,870.61 2842.8,906.02 2835.8,897.4 2828.1,887.99 2820.3,878.36"];
		gate_l16_gpu8	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3084,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu8 -> gate_l16_gpu8	[pos="e,3084,870.61 3084,906.02 3084,898.08 3084,889.48 3084,880.65"];
		gate_l16_gpu9	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3433,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu9 -> gate_l16_gpu9	[pos="e,3386.8,870.61 3366.9,906.02 3371.6,897.74 3376.6,888.74 3381.8,879.51"];
		gate_l16_gpu10	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="3780,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu10 -> gate_l16_gpu10	[pos="e,3721.9,870.61 3696.8,906.02 3702.8,897.57 3709.3,888.36 3716,878.93"];
		gate_l16_gpu11	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4137,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu11 -> gate_l16_gpu11	[pos="e,4054.5,870.61 4018.9,906.02 4027.8,897.23 4037.4,887.62 4047.3,877.79"];
		gate_l16_gpu12	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4497,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu12 -> gate_l16_gpu12	[pos="e,4404.1,870.61 4364.1,906.02 4374.1,897.15 4385.1,887.43 4396.3,877.5"];
		gate_l16_gpu13	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="4858,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu13 -> gate_l16_gpu13	[pos="e,4778.1,870.61 4743.7,906.02 4752.2,897.23 4761.5,887.62 4771.1,877.79"];
		gate_l16_gpu14	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5213,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu14 -> gate_l16_gpu14	[pos="e,5117.2,867.82 5071.2,906.02 5083,896.2 5096.1,885.35 5109.4,874.32"];
		gate_l16_gpu15	[fillcolor=lightblue,
			height=2.3056,
			label="Gate\nLayer 16\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,16]",
			pos="5581,787.33",
			shape=parallelogram,
			style=filled,
			width=4.435];
		mha_l16_gpu15 -> gate_l16_gpu15	[pos="e,5485.2,867.82 5439.2,906.02 5451,896.2 5464.1,885.35 5477.4,874.32"];
		expert_l16_gpu0	[fillcolor=light1,
			height=1.1528,
			label="Expert 1\nLayer 16\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="322,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu0 -> expert_l16_gpu0	[pos="e,322,668.62 322,704.3 322,695.59 322,686.92 322,678.72",
			style=dashed];
		expert_l16_gpu1	[fillcolor=light2,
			height=1.1528,
			label="Expert 2\nLayer 16\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="595,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu1 -> expert_l16_gpu1	[pos="e,623.05,668.62 647.58,704.3 641.19,695.01 634.84,685.77 628.87,677.09",
			style=dashed];
		expert_l16_gpu2	[fillcolor=light3,
			height=1.1528,
			label="Expert 3\nLayer 16\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="982,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu2 -> expert_l16_gpu2	[pos="e,1000,668.62 1015.8,704.3 1011.8,695.3 1007.8,686.34 1004.1,677.9",
			style=dashed];
		expert_l16_gpu3	[fillcolor=light4,
			height=1.1528,
			label="Expert 4\nLayer 16\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1334,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu3 -> expert_l16_gpu3	[pos="e,1349.4,668.62 1362.9,704.3 1359.6,695.39 1356.2,686.54 1353.1,678.18",
			style=dashed];
		expert_l16_gpu4	[fillcolor=light5,
			height=1.1528,
			label="Expert 5\nLayer 16\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1685,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu4 -> expert_l16_gpu4	[pos="e,1697.6,668.62 1708.6,704.3 1705.9,695.39 1703.1,686.54 1700.6,678.18",
			style=dashed];
		expert_l16_gpu5	[fillcolor=light6,
			height=1.1528,
			label="Expert 6\nLayer 16\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2035,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu5 -> expert_l16_gpu5	[pos="e,2044.5,668.62 2052.8,704.3 2050.8,695.49 2048.7,686.73 2046.8,678.45",
			style=dashed];
		expert_l16_gpu6	[fillcolor=light7,
			height=1.1528,
			label="Expert 7\nLayer 16\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2385,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu6 -> expert_l16_gpu6	[pos="e,2391.4,668.62 2397.1,704.3 2395.7,695.59 2394.3,686.92 2393,678.72",
			style=dashed];
		expert_l16_gpu7	[fillcolor=light8,
			height=1.1528,
			label="Expert 8\nLayer 16\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2734,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu7 -> expert_l16_gpu7	[pos="e,2737.3,668.62 2740.3,704.3 2739.6,695.59 2738.8,686.92 2738.2,678.72",
			style=dashed];
		expert_l16_gpu8	[fillcolor=light9,
			height=1.1528,
			label="Expert 9\nLayer 16\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3084,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu8 -> expert_l16_gpu8	[pos="e,3084,668.62 3084,704.3 3084,695.59 3084,686.92 3084,678.72",
			style=dashed];
		expert_l16_gpu9	[fillcolor=light10,
			height=1.1528,
			label="Expert 10\nLayer 16\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3439,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu9 -> expert_l16_gpu9	[pos="e,3437.5,668.62 3436.1,704.3 3436.4,695.59 3436.8,686.92 3437.1,678.72",
			style=dashed];
		expert_l16_gpu10	[fillcolor=light11,
			height=1.1528,
			label="Expert 11\nLayer 16\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3789,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu10 -> expert_l16_gpu10	[pos="e,3786.7,668.62 3784.7,704.3 3785.2,695.59 3785.6,686.92 3786.1,678.72",
			style=dashed];
		expert_l16_gpu11	[fillcolor=light12,
			height=1.1528,
			label="Expert 12\nLayer 16\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4159,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu11 -> expert_l16_gpu11	[pos="e,4153.3,668.62 4148.4,704.3 4149.6,695.59 4150.8,686.92 4151.9,678.72",
			style=dashed];
		expert_l16_gpu12	[fillcolor=light13,
			height=1.1528,
			label="Expert 13\nLayer 16\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4514,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu12 -> expert_l16_gpu12	[pos="e,4509.6,668.62 4505.8,704.3 4506.7,695.59 4507.7,686.92 4508.5,678.72",
			style=dashed];
		expert_l16_gpu13	[fillcolor=light14,
			height=1.1528,
			label="Expert 14\nLayer 16\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4876,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu13 -> expert_l16_gpu13	[pos="e,4871.4,668.62 4867.3,704.3 4868.3,695.59 4869.3,686.92 4870.2,678.72",
			style=dashed];
		expert_l16_gpu14	[fillcolor=light15,
			height=1.1528,
			label="Expert 15\nLayer 16\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5231,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu14 -> expert_l16_gpu14	[pos="e,5226.4,668.62 5222.3,704.3 5223.3,695.59 5224.3,686.92 5225.2,678.72",
			style=dashed];
		expert_l16_gpu15	[fillcolor=light16,
			height=1.1528,
			label="Expert 16\nLayer 16\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5593,626.83",
			shape=rectangle,
			style=filled,
			width=2.3056];
		gate_l16_gpu15 -> expert_l16_gpu15	[pos="e,5589.9,668.62 5587.2,704.3 5587.9,695.59 5588.5,686.92 5589.1,678.72",
			style=dashed];
		agg_l16_gpu0	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 0\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="188,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu0 -> agg_l16_gpu0	[pos="e,257.56,549.61 287.49,585.02 280.21,576.4 272.25,566.99 264.11,557.36"];
		agg_l16_gpu1	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 1\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="550,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu1 -> agg_l16_gpu1	[pos="e,573.36,549.61 583.41,585.02 581.14,577 578.66,568.29 576.13,559.36"];
		agg_l16_gpu2	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 2\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="912,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu2 -> agg_l16_gpu2	[pos="e,948.34,549.61 963.97,585.02 960.36,576.83 956.42,567.92 952.39,558.79"];
		agg_l16_gpu3	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 3\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1274,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu3 -> agg_l16_gpu3	[pos="e,1305.1,549.61 1318.5,585.02 1315.5,576.91 1312.1,568.11 1308.7,559.08"];
		agg_l16_gpu4	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 4\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1636,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu4 -> agg_l16_gpu4	[pos="e,1661.4,549.61 1672.4,585.02 1669.9,577 1667.2,568.29 1664.5,559.36"];
		agg_l16_gpu5	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 5\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="1998,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu5 -> agg_l16_gpu5	[pos="e,2017.2,549.61 2025.5,585.02 2023.6,577 2021.6,568.29 2019.5,559.36"];
		agg_l16_gpu6	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 6\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2360,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu6 -> agg_l16_gpu6	[pos="e,2373,549.61 2378.6,585.02 2377.3,577.08 2376,568.48 2374.6,559.65"];
		agg_l16_gpu7	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 7\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="2722,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu7 -> agg_l16_gpu7	[pos="e,2728.2,549.61 2730.9,585.02 2730.3,577.08 2729.7,568.48 2729,559.65"];
		agg_l16_gpu8	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 8\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3084,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu8 -> agg_l16_gpu8	[pos="e,3084,549.61 3084,585.02 3084,577.08 3084,568.48 3084,559.65"];
		agg_l16_gpu9	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 9\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3446,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu9 -> agg_l16_gpu9	[pos="e,3442.4,549.61 3440.8,585.02 3441.2,577.08 3441.5,568.48 3441.9,559.65"];
		agg_l16_gpu10	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 10\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="3808,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu10 -> agg_l16_gpu10	[pos="e,3798.1,549.61 3793.9,585.02 3794.8,577.08 3795.9,568.48 3796.9,559.65"];
		agg_l16_gpu11	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 11\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4170,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu11 -> agg_l16_gpu11	[pos="e,4164.3,549.61 4161.8,585.02 4162.4,577.08 4163,568.48 4163.6,559.65"];
		agg_l16_gpu12	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 12\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4532,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu12 -> agg_l16_gpu12	[pos="e,4522.7,549.61 4518.6,585.02 4519.5,577.08 4520.5,568.48 4521.5,559.65"];
		agg_l16_gpu13	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 13\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="4894,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu13 -> agg_l16_gpu13	[pos="e,4884.7,549.61 4880.6,585.02 4881.5,577.08 4882.5,568.48 4883.5,559.65"];
		agg_l16_gpu14	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 14\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5256,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu14 -> agg_l16_gpu14	[pos="e,5243,549.61 5237.4,585.02 5238.7,577.08 5240,568.48 5241.4,559.65"];
		agg_l16_gpu15	[fillcolor=orange,
			height=2.3056,
			label="Aggregate\nLayer 16\nGPU 15\nInput: [128,?,4096]\nOutput: [128,?,4096]",
			pos="5618,466.33",
			shape=parallelogram,
			style=filled,
			width=4.7806];
		expert_l16_gpu15 -> agg_l16_gpu15	[pos="e,5605,549.61 5599.4,585.02 5600.7,577.08 5602,568.48 5603.4,559.65"];
		global_agg_l16	[fillcolor=pink,
			height=1.3356,
			label="Global Aggregation\nLayer 16\nAll GPUs\n[128,10000,4096]",
			pos="3084,299.25",
			shape=ellipse,
			style=filled,
			width=3.0445];
		agg_l16_gpu0 -> global_agg_l16	[pos="e,2974.3,301.06 300.01,406.4 322.32,397.03 345.98,388.67 369,383.33 623.5,324.28 2471.9,305.21 2963.9,301.15"];
		agg_l16_gpu1 -> global_agg_l16	[pos="e,2974.2,301.62 662.03,406.49 684.34,397.11 707.99,388.73 731,383.33 948.84,332.25 2515.3,307.77 2964.1,301.76"];
		agg_l16_gpu2 -> global_agg_l16	[pos="e,2974.5,302.37 1024.1,406.61 1046.4,397.22 1070,388.8 1093,383.33 1274.4,340.18 2562.2,310.79 2964.3,302.58"];
		agg_l16_gpu3 -> global_agg_l16	[pos="e,2974.2,300.53 1386.1,406.78 1408.4,397.37 1432,388.91 1455,383.33 1741.2,313.85 2637.6,302.43 2963.8,300.59"];
		agg_l16_gpu4 -> global_agg_l16	[pos="e,2974.4,302.4 1748.2,407.04 1770.5,397.61 1794.1,389.07 1817,383.33 2032.1,329.46 2691.5,308.95 2964.1,302.64"];
		agg_l16_gpu5 -> global_agg_l16	[pos="e,2975.3,305.69 2110.3,407.52 2132.6,398.05 2156.2,389.37 2179,383.33 2324.3,344.92 2754.5,317.67 2965.1,306.24"];
		agg_l16_gpu6 -> global_agg_l16	[pos="e,2976,308.03 2472.6,408.63 2494.9,399.06 2518.3,390.06 2541,383.33 2683.7,340.96 2854.3,319.37 2965.7,308.97"];
		agg_l16_gpu7 -> global_agg_l16	[pos="e,3009,334.46 2836.5,413.1 2889.5,388.96 2951.2,360.81 2999.8,338.66"];
		agg_l16_gpu8 -> global_agg_l16	[pos="e,3084,347.42 3084,383.28 3084,374.63 3084,365.97 3084,357.69"];
		agg_l16_gpu9 -> global_agg_l16	[pos="e,3159.1,334.51 3275.6,387.63 3238.4,370.65 3200.6,353.4 3168.5,338.77"];
		agg_l16_gpu10 -> global_agg_l16	[pos="e,3192,308.03 3637,386.42 3633.6,385.35 3630.3,384.31 3627,383.33 3484.3,340.96 3313.7,319.37 3202.3,308.97"];
		agg_l16_gpu11 -> global_agg_l16	[pos="e,3192.7,305.69 3998.8,386.07 3995.5,385.11 3992.3,384.19 3989,383.33 3843.7,344.92 3413.5,317.67 3202.9,306.24"];
		agg_l16_gpu12 -> global_agg_l16	[pos="e,3193.6,302.4 4360.8,385.95 4357.5,385.02 4354.3,384.15 4351,383.33 4135.9,329.46 3476.5,308.95 3203.9,302.64"];
		agg_l16_gpu13 -> global_agg_l16	[pos="e,3193.8,300.53 4722.8,385.88 4719.6,384.98 4716.3,384.13 4713,383.33 4426.8,313.85 3530.4,302.43 3204.2,300.59"];
		agg_l16_gpu14 -> global_agg_l16	[pos="e,3193.5,302.37 5084.9,385.84 5081.6,384.95 5078.3,384.11 5075,383.33 4893.6,340.18 3605.8,310.79 3203.7,302.58"];
		agg_l16_gpu15 -> global_agg_l16	[pos="e,3193.8,301.62 5446.6,385.74 5443.4,384.89 5440.2,384.08 5437,383.33 5219.2,332.25 3652.7,307.77 3203.9,301.76"];
		residual_l16	[fillcolor=lightgray,
			height=1.1528,
			label="Residual Add\nLayer 16\nAll GPUs\nInput: [128,10000,4096]\nOutput: [128,10000,4096]",
			pos="4386,173.67",
			shape=rectangle,
			style=filled,
			width=2.8194];
		global_agg_l16 -> residual_l16	[pos="e,4284.4,184.31 3190.8,288.11 3433.9,265.04 4026.5,208.79 4274.3,185.27"];
	}
	input	[fillcolor=yellow,
		height=1.3356,
		label="Input\nBatch: 128\nSeq Len: 10,000\nDim: 4096",
		pos="5371,16865",
		shape=ellipse,
		style=filled,
		width=2.6124];
	token_dist	[fillcolor=lightcoral,
		height=1.041,
		label="Token Distribution\nAll GPUs\n[128,10000,4096][128,10000,4096]",
		pos="5371,16743",
		shape=ellipse,
		style=filled,
		width=5.5783];
	input -> token_dist	[pos="e,5371,16781 5371,16816 5371,16808 5371,16799 5371,16791"];
	token_dist -> dist_l1	[pos="e,4103.8,16628 5191.9,16726 4904.8,16700 4349.7,16650 4114.1,16629"];
	token_dist -> residual_l1	[pos="e,5407.7,15720 5554.3,16728 5927,16696 6738,16613 6738,16494 6738,16494 6738,16494 6738,16010 6738,15973 6746.5,15954 6719,15928 \
6529.7,15754 5717.4,15725 5417.7,15721"];
	residual_l1 -> dist_l2	[pos="e,3592.4,15591 5204.3,15710 4889,15687 3930,15616 3602.8,15591"];
	residual_l1 -> residual_l2	[pos="e,3934.7,14685 5407.5,15711 5646.8,15691 6226,15626 6226,15457 6226,15457 6226,15457 6226,14974 6226,14937 6235.2,14917 6207,14892 \
6034.5,14742 4391.5,14696 3944.7,14686"];
	residual_l2 -> dist_l3	[pos="e,3243.3,14565 3731.5,14661 3602.9,14636 3382.6,14593 3253.2,14567"];
	residual_l2 -> residual_l3	[pos="e,4935.9,13654 3934.7,14679 4348.6,14670 5884,14620 5884,14421 5884,14421 5884,14421 5884,13938 5884,13900 5891.8,13882 5865,13856 \
5734.9,13729 5185.3,13673 4946,13655"];
	residual_l3 -> dist_l4	[pos="e,3631.1,13521 4732.4,13634 4491.8,13610 3889.2,13547 3641.2,13522"];
	residual_l3 -> residual_l4	[pos="e,3812.7,12612 4935.6,13637 5262.4,13611 6266,13520 6266,13385 6266,13385 6266,13385 6266,12901 6266,12864 6275.3,12844 6247,12819 \
6061.4,12659 4288.8,12620 3822.8,12612"];
	residual_l4 -> dist_l5	[pos="e,3431.8,12504 3609.4,12570 3556.4,12551 3492.4,12526 3441.5,12507"];
	residual_l4 -> residual_l5	[pos="e,3633.7,11576 3812.7,12608 4266.9,12606 6087,12581 6087,12348 6087,12348 6087,12348 6087,11865 6087,11828 6096.3,11807 6068,11783 \
5882.4,11623 4109.8,11583 3643.8,11576"];
	residual_l5 -> dist_l6	[pos="e,3252.8,11467 3430.4,11534 3377.4,11514 3313.4,11490 3262.5,11471"];
	residual_l5 -> residual_l6	[pos="e,3275.7,10539 3633.7,11572 4087.9,11569 5908,11545 5908,11312 5908,11312 5908,11312 5908,10829 5908,10791 5917.4,10771 5889,10747 \
5688.9,10575 3772.5,10544 3285.9,10539"];
	residual_l6 -> dist_l7	[pos="e,3174,10449 3174,10495 3174,10484 3174,10471 3174,10459"];
	residual_l6 -> residual_l7	[pos="e,3275.7,9502.5 3275.8,10532 3771.3,10510 5908,10411 5908,10276 5908,10276 5908,10276 5908,9792.3 5908,9754.9 5917.4,9734.7 5889,\
9710.3 5688.9,9538.3 3772.5,9507.6 3285.9,9502.6"];
	residual_l7 -> dist_l8	[pos="e,3174,9412.3 3174,9458.9 3174,9447.4 3174,9434.7 3174,9422.5"];
	residual_l7 -> residual_l8	[pos="e,5407.8,8469.5 3275.8,9495.4 3771.3,9474.1 5908,9374.4 5908,9239.5 5908,9239.5 5908,9239.5 5908,8756 5908,8540.7 5591.8,8484.8 \
5417.8,8470.3"];
	residual_l8 -> dist_l9	[pos="e,4103.1,8339 5204.4,8452.8 4963.8,8428 4361.2,8365.7 4113.2,8340"];
	residual_l8 -> residual_l9	[pos="e,4105.7,7429.8 5407.6,8455.7 5734.4,8429.6 6738,8338.5 6738,8203.2 6738,8203.2 6738,8203.2 6738,7719.7 6738,7682.3 6747.4,7662 \
6719,7637.7 6518.9,7465.7 4602.5,7435 4115.9,7429.9"];
	residual_l9 -> dist_l10	[pos="e,4004,7339.6 4004,7386.3 4004,7374.8 4004,7362.1 4004,7349.8"];
	residual_l9 -> residual_l10	[pos="e,4105.7,6393.5 4105.8,7422.8 4601.3,7401.4 6738,7301.7 6738,7166.8 6738,7166.8 6738,7166.8 6738,6683.3 6738,6645.9 6747.4,6625.7 \
6719,6601.3 6518.9,6429.3 4602.5,6398.6 4115.9,6393.6"];
	residual_l10 -> dist_l11	[pos="e,4004,6303.3 4004,6349.9 4004,6338.4 4004,6325.7 4004,6313.5"];
	residual_l10 -> residual_l11	[pos="e,5407.7,5357 4105.8,6386.4 4601.3,6365.1 6738,6265.4 6738,6130.5 6738,6130.5 6738,6130.5 6738,5647 6738,5609.6 6746.5,5590.4 6719,\
5565 6529.7,5390.4 5717.4,5361.8 5417.7,5357.2"];
	residual_l11 -> dist_l12	[pos="e,4103.1,5230 5204.4,5343.8 4963.8,5319 4361.2,5256.7 4113.2,5231"];
	residual_l11 -> residual_l12	[pos="e,4960.7,4324.6 5407.6,5346.7 5734.4,5320.6 6738,5229.5 6738,5094.2 6738,5094.2 6738,5094.2 6738,4610.7 6738,4573.3 6746.9,4553.5 \
6719,4528.7 6587.9,4411.9 5352.8,4343.6 4970.9,4325.1"];
	residual_l12 -> dist_l13	[pos="e,3656.1,4193.7 4757.4,4307.5 4516.8,4282.6 3914.2,4220.3 3666.2,4194.7"];
	residual_l12 -> residual_l13	[pos="e,3658.7,3284.5 4960.6,4310.3 5287.4,4284.3 6291,4193.2 6291,4057.8 6291,4057.8 6291,4057.8 6291,3574.3 6291,3536.9 6300.4,3516.7 \
6272,3492.3 6071.9,3320.3 4155.5,3289.6 3668.9,3284.6"];
	residual_l13 -> dist_l14	[pos="e,3557,3194.3 3557,3240.9 3557,3229.4 3557,3216.7 3557,3204.5"];
	residual_l13 -> residual_l14	[pos="e,3658.7,2248.2 3658.8,3277.4 4154.3,3256.1 6291,3156.4 6291,3021.5 6291,3021.5 6291,3021.5 6291,2538 6291,2500.6 6300.4,2480.4 \
6272,2456 6071.9,2284 4155.5,2253.3 3668.9,2248.3"];
	residual_l14 -> dist_l15	[pos="e,3557,2158 3557,2204.6 3557,2193.1 3557,2180.4 3557,2168.1"];
	residual_l14 -> residual_l15	[pos="e,4960.7,1211.7 3658.8,2241.1 4154.3,2219.8 6291,2120 6291,1985.2 6291,1985.2 6291,1985.2 6291,1501.7 6291,1464.3 6299.5,1445 6272,\
1419.7 6082.7,1245.1 5270.4,1216.4 4970.7,1211.8"];
	residual_l15 -> dist_l16	[pos="e,3184.3,1082 4757.2,1201.3 4447.1,1177.8 3516,1107.2 3194.5,1082.8"];
	residual_l15 -> residual_l16	[pos="e,4487.7,175.36 4960.7,1203 5207.5,1185.7 5818,1125 5818,948.83 5818,948.83 5818,948.83 5818,465.33 5818,427.92 5826.5,408.69 5799,\
383.33 5609.7,208.77 4797.4,180.11 4497.7,175.51"];
	output	[fillcolor=yellow,
		height=1.3356,
		label="Output\nBatch: 128\nSeq Len: 10,000\nDim: 4096",
		pos="4386,48.083",
		shape=ellipse,
		style=filled,
		width=2.6124];
	residual_l16 -> output	[pos="e,4386,96.274 4386,131.86 4386,123.67 4386,114.93 4386,106.3"];
}
