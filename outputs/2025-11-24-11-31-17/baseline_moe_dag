digraph baseline_moe {
	rankdir=TB size="15,20"
	input [label="Input\nBatch: 128\nSeq Len: 10,000\nDim: 4096" fillcolor=yellow shape=ellipse style=filled]
	subgraph cluster_pipeline_0 {
		color=blue label="Pipeline Stage 0 (GPUs 0-7)" style=dashed
		split_l1_p0 [label="Split Layer 1\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l1_gpu0 [label="MHA Layer 1\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu1 [label="MHA Layer 1\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu2 [label="MHA Layer 1\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu3 [label="MHA Layer 1\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu4 [label="MHA Layer 1\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu5 [label="MHA Layer 1\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu6 [label="MHA Layer 1\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l1_gpu7 [label="MHA Layer 1\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l1_gpu0 [label="Gate Layer 1\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu0_exp0 [label="Expert 0\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp1 [label="Expert 1\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp2 [label="Expert 2\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp3 [label="Expert 3\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp4 [label="Expert 4\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp5 [label="Expert 5\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp6 [label="Expert 6\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu0_exp7 [label="Expert 7\nLayer 1\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu0 [label="Aggregate\nLayer 1\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu1 [label="Gate Layer 1\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu1_exp0 [label="Expert 0\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp1 [label="Expert 1\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp2 [label="Expert 2\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp3 [label="Expert 3\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp4 [label="Expert 4\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp5 [label="Expert 5\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp6 [label="Expert 6\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu1_exp7 [label="Expert 7\nLayer 1\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu1 [label="Aggregate\nLayer 1\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu2 [label="Gate Layer 1\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu2_exp0 [label="Expert 0\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp1 [label="Expert 1\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp2 [label="Expert 2\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp3 [label="Expert 3\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp4 [label="Expert 4\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp5 [label="Expert 5\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp6 [label="Expert 6\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu2_exp7 [label="Expert 7\nLayer 1\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu2 [label="Aggregate\nLayer 1\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu3 [label="Gate Layer 1\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu3_exp0 [label="Expert 0\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp1 [label="Expert 1\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp2 [label="Expert 2\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp3 [label="Expert 3\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp4 [label="Expert 4\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp5 [label="Expert 5\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp6 [label="Expert 6\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu3_exp7 [label="Expert 7\nLayer 1\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu3 [label="Aggregate\nLayer 1\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu4 [label="Gate Layer 1\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu4_exp0 [label="Expert 0\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp1 [label="Expert 1\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp2 [label="Expert 2\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp3 [label="Expert 3\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp4 [label="Expert 4\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp5 [label="Expert 5\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp6 [label="Expert 6\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu4_exp7 [label="Expert 7\nLayer 1\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu4 [label="Aggregate\nLayer 1\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu5 [label="Gate Layer 1\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu5_exp0 [label="Expert 0\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp1 [label="Expert 1\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp2 [label="Expert 2\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp3 [label="Expert 3\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp4 [label="Expert 4\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp5 [label="Expert 5\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp6 [label="Expert 6\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu5_exp7 [label="Expert 7\nLayer 1\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu5 [label="Aggregate\nLayer 1\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu6 [label="Gate Layer 1\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu6_exp0 [label="Expert 0\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp1 [label="Expert 1\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp2 [label="Expert 2\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp3 [label="Expert 3\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp4 [label="Expert 4\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp5 [label="Expert 5\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp6 [label="Expert 6\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu6_exp7 [label="Expert 7\nLayer 1\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu6 [label="Aggregate\nLayer 1\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l1_gpu7 [label="Gate Layer 1\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l1_gpu7_exp0 [label="Expert 0\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp1 [label="Expert 1\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp2 [label="Expert 2\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp3 [label="Expert 3\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp4 [label="Expert 4\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp5 [label="Expert 5\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp6 [label="Expert 6\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l1_gpu7_exp7 [label="Expert 7\nLayer 1\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l1_gpu7 [label="Aggregate\nLayer 1\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l1_p0 [label="Residual Add\nLayer 1\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l2_p0 [label="Split Layer 2\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l2_gpu0 [label="MHA Layer 2\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu1 [label="MHA Layer 2\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu2 [label="MHA Layer 2\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu3 [label="MHA Layer 2\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu4 [label="MHA Layer 2\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu5 [label="MHA Layer 2\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu6 [label="MHA Layer 2\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l2_gpu7 [label="MHA Layer 2\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l2_gpu0 [label="Gate Layer 2\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu0_exp0 [label="Expert 0\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp1 [label="Expert 1\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp2 [label="Expert 2\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp3 [label="Expert 3\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp4 [label="Expert 4\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp5 [label="Expert 5\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp6 [label="Expert 6\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu0_exp7 [label="Expert 7\nLayer 2\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu0 [label="Aggregate\nLayer 2\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu1 [label="Gate Layer 2\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu1_exp0 [label="Expert 0\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp1 [label="Expert 1\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp2 [label="Expert 2\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp3 [label="Expert 3\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp4 [label="Expert 4\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp5 [label="Expert 5\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp6 [label="Expert 6\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu1_exp7 [label="Expert 7\nLayer 2\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu1 [label="Aggregate\nLayer 2\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu2 [label="Gate Layer 2\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu2_exp0 [label="Expert 0\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp1 [label="Expert 1\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp2 [label="Expert 2\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp3 [label="Expert 3\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp4 [label="Expert 4\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp5 [label="Expert 5\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp6 [label="Expert 6\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu2_exp7 [label="Expert 7\nLayer 2\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu2 [label="Aggregate\nLayer 2\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu3 [label="Gate Layer 2\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu3_exp0 [label="Expert 0\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp1 [label="Expert 1\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp2 [label="Expert 2\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp3 [label="Expert 3\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp4 [label="Expert 4\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp5 [label="Expert 5\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp6 [label="Expert 6\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu3_exp7 [label="Expert 7\nLayer 2\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu3 [label="Aggregate\nLayer 2\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu4 [label="Gate Layer 2\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu4_exp0 [label="Expert 0\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp1 [label="Expert 1\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp2 [label="Expert 2\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp3 [label="Expert 3\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp4 [label="Expert 4\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp5 [label="Expert 5\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp6 [label="Expert 6\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu4_exp7 [label="Expert 7\nLayer 2\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu4 [label="Aggregate\nLayer 2\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu5 [label="Gate Layer 2\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu5_exp0 [label="Expert 0\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp1 [label="Expert 1\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp2 [label="Expert 2\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp3 [label="Expert 3\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp4 [label="Expert 4\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp5 [label="Expert 5\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp6 [label="Expert 6\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu5_exp7 [label="Expert 7\nLayer 2\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu5 [label="Aggregate\nLayer 2\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu6 [label="Gate Layer 2\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu6_exp0 [label="Expert 0\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp1 [label="Expert 1\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp2 [label="Expert 2\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp3 [label="Expert 3\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp4 [label="Expert 4\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp5 [label="Expert 5\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp6 [label="Expert 6\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu6_exp7 [label="Expert 7\nLayer 2\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu6 [label="Aggregate\nLayer 2\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l2_gpu7 [label="Gate Layer 2\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l2_gpu7_exp0 [label="Expert 0\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp1 [label="Expert 1\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp2 [label="Expert 2\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp3 [label="Expert 3\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp4 [label="Expert 4\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp5 [label="Expert 5\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp6 [label="Expert 6\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l2_gpu7_exp7 [label="Expert 7\nLayer 2\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l2_gpu7 [label="Aggregate\nLayer 2\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l2_p0 [label="Residual Add\nLayer 2\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l3_p0 [label="Split Layer 3\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l3_gpu0 [label="MHA Layer 3\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu1 [label="MHA Layer 3\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu2 [label="MHA Layer 3\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu3 [label="MHA Layer 3\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu4 [label="MHA Layer 3\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu5 [label="MHA Layer 3\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu6 [label="MHA Layer 3\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l3_gpu7 [label="MHA Layer 3\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l3_gpu0 [label="Gate Layer 3\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu0_exp0 [label="Expert 0\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp1 [label="Expert 1\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp2 [label="Expert 2\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp3 [label="Expert 3\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp4 [label="Expert 4\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp5 [label="Expert 5\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp6 [label="Expert 6\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu0_exp7 [label="Expert 7\nLayer 3\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu0 [label="Aggregate\nLayer 3\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu1 [label="Gate Layer 3\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu1_exp0 [label="Expert 0\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp1 [label="Expert 1\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp2 [label="Expert 2\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp3 [label="Expert 3\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp4 [label="Expert 4\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp5 [label="Expert 5\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp6 [label="Expert 6\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu1_exp7 [label="Expert 7\nLayer 3\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu1 [label="Aggregate\nLayer 3\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu2 [label="Gate Layer 3\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu2_exp0 [label="Expert 0\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp1 [label="Expert 1\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp2 [label="Expert 2\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp3 [label="Expert 3\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp4 [label="Expert 4\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp5 [label="Expert 5\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp6 [label="Expert 6\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu2_exp7 [label="Expert 7\nLayer 3\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu2 [label="Aggregate\nLayer 3\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu3 [label="Gate Layer 3\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu3_exp0 [label="Expert 0\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp1 [label="Expert 1\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp2 [label="Expert 2\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp3 [label="Expert 3\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp4 [label="Expert 4\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp5 [label="Expert 5\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp6 [label="Expert 6\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu3_exp7 [label="Expert 7\nLayer 3\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu3 [label="Aggregate\nLayer 3\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu4 [label="Gate Layer 3\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu4_exp0 [label="Expert 0\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp1 [label="Expert 1\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp2 [label="Expert 2\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp3 [label="Expert 3\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp4 [label="Expert 4\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp5 [label="Expert 5\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp6 [label="Expert 6\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu4_exp7 [label="Expert 7\nLayer 3\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu4 [label="Aggregate\nLayer 3\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu5 [label="Gate Layer 3\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu5_exp0 [label="Expert 0\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp1 [label="Expert 1\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp2 [label="Expert 2\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp3 [label="Expert 3\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp4 [label="Expert 4\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp5 [label="Expert 5\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp6 [label="Expert 6\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu5_exp7 [label="Expert 7\nLayer 3\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu5 [label="Aggregate\nLayer 3\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu6 [label="Gate Layer 3\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu6_exp0 [label="Expert 0\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp1 [label="Expert 1\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp2 [label="Expert 2\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp3 [label="Expert 3\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp4 [label="Expert 4\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp5 [label="Expert 5\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp6 [label="Expert 6\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu6_exp7 [label="Expert 7\nLayer 3\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu6 [label="Aggregate\nLayer 3\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l3_gpu7 [label="Gate Layer 3\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l3_gpu7_exp0 [label="Expert 0\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp1 [label="Expert 1\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp2 [label="Expert 2\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp3 [label="Expert 3\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp4 [label="Expert 4\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp5 [label="Expert 5\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp6 [label="Expert 6\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l3_gpu7_exp7 [label="Expert 7\nLayer 3\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l3_gpu7 [label="Aggregate\nLayer 3\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l3_p0 [label="Residual Add\nLayer 3\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l4_p0 [label="Split Layer 4\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l4_gpu0 [label="MHA Layer 4\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu1 [label="MHA Layer 4\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu2 [label="MHA Layer 4\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu3 [label="MHA Layer 4\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu4 [label="MHA Layer 4\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu5 [label="MHA Layer 4\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu6 [label="MHA Layer 4\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l4_gpu7 [label="MHA Layer 4\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l4_gpu0 [label="Gate Layer 4\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu0_exp0 [label="Expert 0\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp1 [label="Expert 1\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp2 [label="Expert 2\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp3 [label="Expert 3\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp4 [label="Expert 4\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp5 [label="Expert 5\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp6 [label="Expert 6\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu0_exp7 [label="Expert 7\nLayer 4\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu0 [label="Aggregate\nLayer 4\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu1 [label="Gate Layer 4\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu1_exp0 [label="Expert 0\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp1 [label="Expert 1\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp2 [label="Expert 2\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp3 [label="Expert 3\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp4 [label="Expert 4\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp5 [label="Expert 5\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp6 [label="Expert 6\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu1_exp7 [label="Expert 7\nLayer 4\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu1 [label="Aggregate\nLayer 4\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu2 [label="Gate Layer 4\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu2_exp0 [label="Expert 0\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp1 [label="Expert 1\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp2 [label="Expert 2\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp3 [label="Expert 3\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp4 [label="Expert 4\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp5 [label="Expert 5\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp6 [label="Expert 6\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu2_exp7 [label="Expert 7\nLayer 4\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu2 [label="Aggregate\nLayer 4\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu3 [label="Gate Layer 4\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu3_exp0 [label="Expert 0\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp1 [label="Expert 1\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp2 [label="Expert 2\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp3 [label="Expert 3\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp4 [label="Expert 4\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp5 [label="Expert 5\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp6 [label="Expert 6\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu3_exp7 [label="Expert 7\nLayer 4\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu3 [label="Aggregate\nLayer 4\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu4 [label="Gate Layer 4\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu4_exp0 [label="Expert 0\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp1 [label="Expert 1\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp2 [label="Expert 2\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp3 [label="Expert 3\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp4 [label="Expert 4\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp5 [label="Expert 5\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp6 [label="Expert 6\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu4_exp7 [label="Expert 7\nLayer 4\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu4 [label="Aggregate\nLayer 4\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu5 [label="Gate Layer 4\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu5_exp0 [label="Expert 0\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp1 [label="Expert 1\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp2 [label="Expert 2\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp3 [label="Expert 3\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp4 [label="Expert 4\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp5 [label="Expert 5\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp6 [label="Expert 6\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu5_exp7 [label="Expert 7\nLayer 4\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu5 [label="Aggregate\nLayer 4\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu6 [label="Gate Layer 4\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu6_exp0 [label="Expert 0\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp1 [label="Expert 1\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp2 [label="Expert 2\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp3 [label="Expert 3\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp4 [label="Expert 4\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp5 [label="Expert 5\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp6 [label="Expert 6\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu6_exp7 [label="Expert 7\nLayer 4\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu6 [label="Aggregate\nLayer 4\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l4_gpu7 [label="Gate Layer 4\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l4_gpu7_exp0 [label="Expert 0\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp1 [label="Expert 1\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp2 [label="Expert 2\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp3 [label="Expert 3\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp4 [label="Expert 4\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp5 [label="Expert 5\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp6 [label="Expert 6\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l4_gpu7_exp7 [label="Expert 7\nLayer 4\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l4_gpu7 [label="Aggregate\nLayer 4\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l4_p0 [label="Residual Add\nLayer 4\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l5_p0 [label="Split Layer 5\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l5_gpu0 [label="MHA Layer 5\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu1 [label="MHA Layer 5\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu2 [label="MHA Layer 5\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu3 [label="MHA Layer 5\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu4 [label="MHA Layer 5\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu5 [label="MHA Layer 5\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu6 [label="MHA Layer 5\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l5_gpu7 [label="MHA Layer 5\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l5_gpu0 [label="Gate Layer 5\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu0_exp0 [label="Expert 0\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp1 [label="Expert 1\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp2 [label="Expert 2\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp3 [label="Expert 3\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp4 [label="Expert 4\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp5 [label="Expert 5\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp6 [label="Expert 6\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu0_exp7 [label="Expert 7\nLayer 5\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu0 [label="Aggregate\nLayer 5\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu1 [label="Gate Layer 5\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu1_exp0 [label="Expert 0\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp1 [label="Expert 1\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp2 [label="Expert 2\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp3 [label="Expert 3\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp4 [label="Expert 4\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp5 [label="Expert 5\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp6 [label="Expert 6\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu1_exp7 [label="Expert 7\nLayer 5\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu1 [label="Aggregate\nLayer 5\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu2 [label="Gate Layer 5\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu2_exp0 [label="Expert 0\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp1 [label="Expert 1\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp2 [label="Expert 2\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp3 [label="Expert 3\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp4 [label="Expert 4\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp5 [label="Expert 5\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp6 [label="Expert 6\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu2_exp7 [label="Expert 7\nLayer 5\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu2 [label="Aggregate\nLayer 5\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu3 [label="Gate Layer 5\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu3_exp0 [label="Expert 0\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp1 [label="Expert 1\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp2 [label="Expert 2\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp3 [label="Expert 3\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp4 [label="Expert 4\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp5 [label="Expert 5\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp6 [label="Expert 6\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu3_exp7 [label="Expert 7\nLayer 5\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu3 [label="Aggregate\nLayer 5\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu4 [label="Gate Layer 5\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu4_exp0 [label="Expert 0\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp1 [label="Expert 1\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp2 [label="Expert 2\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp3 [label="Expert 3\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp4 [label="Expert 4\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp5 [label="Expert 5\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp6 [label="Expert 6\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu4_exp7 [label="Expert 7\nLayer 5\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu4 [label="Aggregate\nLayer 5\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu5 [label="Gate Layer 5\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu5_exp0 [label="Expert 0\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp1 [label="Expert 1\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp2 [label="Expert 2\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp3 [label="Expert 3\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp4 [label="Expert 4\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp5 [label="Expert 5\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp6 [label="Expert 6\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu5_exp7 [label="Expert 7\nLayer 5\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu5 [label="Aggregate\nLayer 5\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu6 [label="Gate Layer 5\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu6_exp0 [label="Expert 0\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp1 [label="Expert 1\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp2 [label="Expert 2\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp3 [label="Expert 3\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp4 [label="Expert 4\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp5 [label="Expert 5\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp6 [label="Expert 6\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu6_exp7 [label="Expert 7\nLayer 5\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu6 [label="Aggregate\nLayer 5\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l5_gpu7 [label="Gate Layer 5\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l5_gpu7_exp0 [label="Expert 0\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp1 [label="Expert 1\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp2 [label="Expert 2\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp3 [label="Expert 3\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp4 [label="Expert 4\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp5 [label="Expert 5\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp6 [label="Expert 6\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l5_gpu7_exp7 [label="Expert 7\nLayer 5\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l5_gpu7 [label="Aggregate\nLayer 5\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l5_p0 [label="Residual Add\nLayer 5\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l6_p0 [label="Split Layer 6\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l6_gpu0 [label="MHA Layer 6\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu1 [label="MHA Layer 6\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu2 [label="MHA Layer 6\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu3 [label="MHA Layer 6\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu4 [label="MHA Layer 6\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu5 [label="MHA Layer 6\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu6 [label="MHA Layer 6\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l6_gpu7 [label="MHA Layer 6\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l6_gpu0 [label="Gate Layer 6\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu0_exp0 [label="Expert 0\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp1 [label="Expert 1\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp2 [label="Expert 2\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp3 [label="Expert 3\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp4 [label="Expert 4\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp5 [label="Expert 5\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp6 [label="Expert 6\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu0_exp7 [label="Expert 7\nLayer 6\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu0 [label="Aggregate\nLayer 6\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu1 [label="Gate Layer 6\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu1_exp0 [label="Expert 0\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp1 [label="Expert 1\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp2 [label="Expert 2\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp3 [label="Expert 3\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp4 [label="Expert 4\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp5 [label="Expert 5\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp6 [label="Expert 6\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu1_exp7 [label="Expert 7\nLayer 6\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu1 [label="Aggregate\nLayer 6\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu2 [label="Gate Layer 6\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu2_exp0 [label="Expert 0\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp1 [label="Expert 1\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp2 [label="Expert 2\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp3 [label="Expert 3\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp4 [label="Expert 4\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp5 [label="Expert 5\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp6 [label="Expert 6\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu2_exp7 [label="Expert 7\nLayer 6\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu2 [label="Aggregate\nLayer 6\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu3 [label="Gate Layer 6\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu3_exp0 [label="Expert 0\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp1 [label="Expert 1\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp2 [label="Expert 2\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp3 [label="Expert 3\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp4 [label="Expert 4\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp5 [label="Expert 5\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp6 [label="Expert 6\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu3_exp7 [label="Expert 7\nLayer 6\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu3 [label="Aggregate\nLayer 6\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu4 [label="Gate Layer 6\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu4_exp0 [label="Expert 0\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp1 [label="Expert 1\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp2 [label="Expert 2\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp3 [label="Expert 3\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp4 [label="Expert 4\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp5 [label="Expert 5\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp6 [label="Expert 6\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu4_exp7 [label="Expert 7\nLayer 6\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu4 [label="Aggregate\nLayer 6\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu5 [label="Gate Layer 6\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu5_exp0 [label="Expert 0\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp1 [label="Expert 1\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp2 [label="Expert 2\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp3 [label="Expert 3\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp4 [label="Expert 4\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp5 [label="Expert 5\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp6 [label="Expert 6\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu5_exp7 [label="Expert 7\nLayer 6\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu5 [label="Aggregate\nLayer 6\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu6 [label="Gate Layer 6\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu6_exp0 [label="Expert 0\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp1 [label="Expert 1\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp2 [label="Expert 2\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp3 [label="Expert 3\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp4 [label="Expert 4\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp5 [label="Expert 5\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp6 [label="Expert 6\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu6_exp7 [label="Expert 7\nLayer 6\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu6 [label="Aggregate\nLayer 6\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l6_gpu7 [label="Gate Layer 6\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l6_gpu7_exp0 [label="Expert 0\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp1 [label="Expert 1\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp2 [label="Expert 2\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp3 [label="Expert 3\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp4 [label="Expert 4\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp5 [label="Expert 5\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp6 [label="Expert 6\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l6_gpu7_exp7 [label="Expert 7\nLayer 6\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l6_gpu7 [label="Aggregate\nLayer 6\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l6_p0 [label="Residual Add\nLayer 6\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l7_p0 [label="Split Layer 7\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l7_gpu0 [label="MHA Layer 7\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu1 [label="MHA Layer 7\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu2 [label="MHA Layer 7\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu3 [label="MHA Layer 7\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu4 [label="MHA Layer 7\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu5 [label="MHA Layer 7\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu6 [label="MHA Layer 7\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l7_gpu7 [label="MHA Layer 7\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l7_gpu0 [label="Gate Layer 7\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu0_exp0 [label="Expert 0\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp1 [label="Expert 1\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp2 [label="Expert 2\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp3 [label="Expert 3\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp4 [label="Expert 4\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp5 [label="Expert 5\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp6 [label="Expert 6\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu0_exp7 [label="Expert 7\nLayer 7\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu0 [label="Aggregate\nLayer 7\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu1 [label="Gate Layer 7\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu1_exp0 [label="Expert 0\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp1 [label="Expert 1\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp2 [label="Expert 2\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp3 [label="Expert 3\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp4 [label="Expert 4\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp5 [label="Expert 5\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp6 [label="Expert 6\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu1_exp7 [label="Expert 7\nLayer 7\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu1 [label="Aggregate\nLayer 7\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu2 [label="Gate Layer 7\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu2_exp0 [label="Expert 0\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp1 [label="Expert 1\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp2 [label="Expert 2\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp3 [label="Expert 3\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp4 [label="Expert 4\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp5 [label="Expert 5\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp6 [label="Expert 6\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu2_exp7 [label="Expert 7\nLayer 7\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu2 [label="Aggregate\nLayer 7\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu3 [label="Gate Layer 7\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu3_exp0 [label="Expert 0\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp1 [label="Expert 1\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp2 [label="Expert 2\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp3 [label="Expert 3\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp4 [label="Expert 4\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp5 [label="Expert 5\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp6 [label="Expert 6\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu3_exp7 [label="Expert 7\nLayer 7\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu3 [label="Aggregate\nLayer 7\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu4 [label="Gate Layer 7\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu4_exp0 [label="Expert 0\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp1 [label="Expert 1\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp2 [label="Expert 2\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp3 [label="Expert 3\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp4 [label="Expert 4\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp5 [label="Expert 5\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp6 [label="Expert 6\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu4_exp7 [label="Expert 7\nLayer 7\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu4 [label="Aggregate\nLayer 7\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu5 [label="Gate Layer 7\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu5_exp0 [label="Expert 0\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp1 [label="Expert 1\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp2 [label="Expert 2\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp3 [label="Expert 3\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp4 [label="Expert 4\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp5 [label="Expert 5\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp6 [label="Expert 6\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu5_exp7 [label="Expert 7\nLayer 7\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu5 [label="Aggregate\nLayer 7\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu6 [label="Gate Layer 7\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu6_exp0 [label="Expert 0\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp1 [label="Expert 1\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp2 [label="Expert 2\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp3 [label="Expert 3\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp4 [label="Expert 4\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp5 [label="Expert 5\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp6 [label="Expert 6\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu6_exp7 [label="Expert 7\nLayer 7\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu6 [label="Aggregate\nLayer 7\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l7_gpu7 [label="Gate Layer 7\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l7_gpu7_exp0 [label="Expert 0\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp1 [label="Expert 1\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp2 [label="Expert 2\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp3 [label="Expert 3\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp4 [label="Expert 4\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp5 [label="Expert 5\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp6 [label="Expert 6\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l7_gpu7_exp7 [label="Expert 7\nLayer 7\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l7_gpu7 [label="Aggregate\nLayer 7\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l7_p0 [label="Residual Add\nLayer 7\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l8_p0 [label="Split Layer 8\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l8_gpu0 [label="MHA Layer 8\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu1 [label="MHA Layer 8\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu2 [label="MHA Layer 8\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu3 [label="MHA Layer 8\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu4 [label="MHA Layer 8\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu5 [label="MHA Layer 8\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu6 [label="MHA Layer 8\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		mha_l8_gpu7 [label="MHA Layer 8\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=rectangle style=filled]
		gate_l8_gpu0 [label="Gate Layer 8\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu0_exp0 [label="Expert 0\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp1 [label="Expert 1\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp2 [label="Expert 2\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp3 [label="Expert 3\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp4 [label="Expert 4\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp5 [label="Expert 5\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp6 [label="Expert 6\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu0_exp7 [label="Expert 7\nLayer 8\nGPU 0\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu0 [label="Aggregate\nLayer 8\nGPU 0\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu1 [label="Gate Layer 8\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu1_exp0 [label="Expert 0\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp1 [label="Expert 1\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp2 [label="Expert 2\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp3 [label="Expert 3\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp4 [label="Expert 4\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp5 [label="Expert 5\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp6 [label="Expert 6\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu1_exp7 [label="Expert 7\nLayer 8\nGPU 1\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu1 [label="Aggregate\nLayer 8\nGPU 1\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu2 [label="Gate Layer 8\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu2_exp0 [label="Expert 0\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp1 [label="Expert 1\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp2 [label="Expert 2\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp3 [label="Expert 3\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp4 [label="Expert 4\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp5 [label="Expert 5\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp6 [label="Expert 6\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu2_exp7 [label="Expert 7\nLayer 8\nGPU 2\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu2 [label="Aggregate\nLayer 8\nGPU 2\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu3 [label="Gate Layer 8\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu3_exp0 [label="Expert 0\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp1 [label="Expert 1\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp2 [label="Expert 2\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp3 [label="Expert 3\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp4 [label="Expert 4\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp5 [label="Expert 5\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp6 [label="Expert 6\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu3_exp7 [label="Expert 7\nLayer 8\nGPU 3\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu3 [label="Aggregate\nLayer 8\nGPU 3\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu4 [label="Gate Layer 8\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu4_exp0 [label="Expert 0\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp1 [label="Expert 1\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp2 [label="Expert 2\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp3 [label="Expert 3\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp4 [label="Expert 4\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp5 [label="Expert 5\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp6 [label="Expert 6\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu4_exp7 [label="Expert 7\nLayer 8\nGPU 4\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu4 [label="Aggregate\nLayer 8\nGPU 4\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu5 [label="Gate Layer 8\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu5_exp0 [label="Expert 0\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp1 [label="Expert 1\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp2 [label="Expert 2\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp3 [label="Expert 3\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp4 [label="Expert 4\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp5 [label="Expert 5\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp6 [label="Expert 6\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu5_exp7 [label="Expert 7\nLayer 8\nGPU 5\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu5 [label="Aggregate\nLayer 8\nGPU 5\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu6 [label="Gate Layer 8\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu6_exp0 [label="Expert 0\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp1 [label="Expert 1\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp2 [label="Expert 2\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp3 [label="Expert 3\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp4 [label="Expert 4\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp5 [label="Expert 5\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp6 [label="Expert 6\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu6_exp7 [label="Expert 7\nLayer 8\nGPU 6\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu6 [label="Aggregate\nLayer 8\nGPU 6\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		gate_l8_gpu7 [label="Gate Layer 8\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightblue shape=parallelogram style=filled]
		exp_l8_gpu7_exp0 [label="Expert 0\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp1 [label="Expert 1\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp2 [label="Expert 2\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp3 [label="Expert 3\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp4 [label="Expert 4\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp5 [label="Expert 5\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp6 [label="Expert 6\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		exp_l8_gpu7_exp7 [label="Expert 7\nLayer 8\nGPU 7\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightblue shape=rectangle style=filled]
		agg_l8_gpu7 [label="Aggregate\nLayer 8\nGPU 7\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightblue shape=parallelogram style=filled]
		residual_l8_p0 [label="Residual Add\nLayer 8\nGPUs 0-7\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
	}
	subgraph cluster_pipeline_1 {
		color=green label="Pipeline Stage 1 (GPUs 8-15)" style=dashed
		split_l9_p1 [label="Split Layer 9\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l9_gpu8 [label="MHA Layer 9\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu9 [label="MHA Layer 9\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu10 [label="MHA Layer 9\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu11 [label="MHA Layer 9\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu12 [label="MHA Layer 9\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu13 [label="MHA Layer 9\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu14 [label="MHA Layer 9\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l9_gpu15 [label="MHA Layer 9\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l9_gpu8 [label="Gate Layer 9\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu8_exp0 [label="Expert 0\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp1 [label="Expert 1\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp2 [label="Expert 2\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp3 [label="Expert 3\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp4 [label="Expert 4\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp5 [label="Expert 5\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp6 [label="Expert 6\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu8_exp7 [label="Expert 7\nLayer 9\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu8 [label="Aggregate\nLayer 9\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu9 [label="Gate Layer 9\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu9_exp0 [label="Expert 0\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp1 [label="Expert 1\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp2 [label="Expert 2\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp3 [label="Expert 3\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp4 [label="Expert 4\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp5 [label="Expert 5\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp6 [label="Expert 6\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu9_exp7 [label="Expert 7\nLayer 9\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu9 [label="Aggregate\nLayer 9\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu10 [label="Gate Layer 9\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu10_exp0 [label="Expert 0\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp1 [label="Expert 1\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp2 [label="Expert 2\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp3 [label="Expert 3\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp4 [label="Expert 4\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp5 [label="Expert 5\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp6 [label="Expert 6\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu10_exp7 [label="Expert 7\nLayer 9\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu10 [label="Aggregate\nLayer 9\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu11 [label="Gate Layer 9\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu11_exp0 [label="Expert 0\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp1 [label="Expert 1\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp2 [label="Expert 2\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp3 [label="Expert 3\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp4 [label="Expert 4\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp5 [label="Expert 5\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp6 [label="Expert 6\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu11_exp7 [label="Expert 7\nLayer 9\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu11 [label="Aggregate\nLayer 9\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu12 [label="Gate Layer 9\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu12_exp0 [label="Expert 0\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp1 [label="Expert 1\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp2 [label="Expert 2\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp3 [label="Expert 3\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp4 [label="Expert 4\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp5 [label="Expert 5\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp6 [label="Expert 6\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu12_exp7 [label="Expert 7\nLayer 9\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu12 [label="Aggregate\nLayer 9\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu13 [label="Gate Layer 9\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu13_exp0 [label="Expert 0\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp1 [label="Expert 1\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp2 [label="Expert 2\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp3 [label="Expert 3\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp4 [label="Expert 4\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp5 [label="Expert 5\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp6 [label="Expert 6\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu13_exp7 [label="Expert 7\nLayer 9\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu13 [label="Aggregate\nLayer 9\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu14 [label="Gate Layer 9\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu14_exp0 [label="Expert 0\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp1 [label="Expert 1\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp2 [label="Expert 2\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp3 [label="Expert 3\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp4 [label="Expert 4\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp5 [label="Expert 5\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp6 [label="Expert 6\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu14_exp7 [label="Expert 7\nLayer 9\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu14 [label="Aggregate\nLayer 9\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l9_gpu15 [label="Gate Layer 9\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l9_gpu15_exp0 [label="Expert 0\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp1 [label="Expert 1\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp2 [label="Expert 2\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp3 [label="Expert 3\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp4 [label="Expert 4\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp5 [label="Expert 5\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp6 [label="Expert 6\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l9_gpu15_exp7 [label="Expert 7\nLayer 9\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l9_gpu15 [label="Aggregate\nLayer 9\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l9_p1 [label="Residual Add\nLayer 9\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l10_p1 [label="Split Layer 10\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l10_gpu8 [label="MHA Layer 10\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu9 [label="MHA Layer 10\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu10 [label="MHA Layer 10\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu11 [label="MHA Layer 10\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu12 [label="MHA Layer 10\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu13 [label="MHA Layer 10\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu14 [label="MHA Layer 10\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l10_gpu15 [label="MHA Layer 10\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l10_gpu8 [label="Gate Layer 10\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu8_exp0 [label="Expert 0\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp1 [label="Expert 1\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp2 [label="Expert 2\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp3 [label="Expert 3\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp4 [label="Expert 4\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp5 [label="Expert 5\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp6 [label="Expert 6\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu8_exp7 [label="Expert 7\nLayer 10\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu8 [label="Aggregate\nLayer 10\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu9 [label="Gate Layer 10\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu9_exp0 [label="Expert 0\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp1 [label="Expert 1\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp2 [label="Expert 2\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp3 [label="Expert 3\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp4 [label="Expert 4\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp5 [label="Expert 5\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp6 [label="Expert 6\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu9_exp7 [label="Expert 7\nLayer 10\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu9 [label="Aggregate\nLayer 10\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu10 [label="Gate Layer 10\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu10_exp0 [label="Expert 0\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp1 [label="Expert 1\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp2 [label="Expert 2\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp3 [label="Expert 3\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp4 [label="Expert 4\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp5 [label="Expert 5\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp6 [label="Expert 6\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu10_exp7 [label="Expert 7\nLayer 10\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu10 [label="Aggregate\nLayer 10\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu11 [label="Gate Layer 10\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu11_exp0 [label="Expert 0\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp1 [label="Expert 1\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp2 [label="Expert 2\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp3 [label="Expert 3\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp4 [label="Expert 4\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp5 [label="Expert 5\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp6 [label="Expert 6\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu11_exp7 [label="Expert 7\nLayer 10\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu11 [label="Aggregate\nLayer 10\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu12 [label="Gate Layer 10\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu12_exp0 [label="Expert 0\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp1 [label="Expert 1\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp2 [label="Expert 2\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp3 [label="Expert 3\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp4 [label="Expert 4\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp5 [label="Expert 5\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp6 [label="Expert 6\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu12_exp7 [label="Expert 7\nLayer 10\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu12 [label="Aggregate\nLayer 10\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu13 [label="Gate Layer 10\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu13_exp0 [label="Expert 0\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp1 [label="Expert 1\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp2 [label="Expert 2\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp3 [label="Expert 3\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp4 [label="Expert 4\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp5 [label="Expert 5\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp6 [label="Expert 6\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu13_exp7 [label="Expert 7\nLayer 10\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu13 [label="Aggregate\nLayer 10\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu14 [label="Gate Layer 10\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu14_exp0 [label="Expert 0\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp1 [label="Expert 1\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp2 [label="Expert 2\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp3 [label="Expert 3\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp4 [label="Expert 4\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp5 [label="Expert 5\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp6 [label="Expert 6\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu14_exp7 [label="Expert 7\nLayer 10\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu14 [label="Aggregate\nLayer 10\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l10_gpu15 [label="Gate Layer 10\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l10_gpu15_exp0 [label="Expert 0\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp1 [label="Expert 1\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp2 [label="Expert 2\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp3 [label="Expert 3\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp4 [label="Expert 4\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp5 [label="Expert 5\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp6 [label="Expert 6\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l10_gpu15_exp7 [label="Expert 7\nLayer 10\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l10_gpu15 [label="Aggregate\nLayer 10\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l10_p1 [label="Residual Add\nLayer 10\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l11_p1 [label="Split Layer 11\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l11_gpu8 [label="MHA Layer 11\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu9 [label="MHA Layer 11\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu10 [label="MHA Layer 11\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu11 [label="MHA Layer 11\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu12 [label="MHA Layer 11\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu13 [label="MHA Layer 11\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu14 [label="MHA Layer 11\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l11_gpu15 [label="MHA Layer 11\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l11_gpu8 [label="Gate Layer 11\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu8_exp0 [label="Expert 0\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp1 [label="Expert 1\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp2 [label="Expert 2\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp3 [label="Expert 3\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp4 [label="Expert 4\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp5 [label="Expert 5\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp6 [label="Expert 6\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu8_exp7 [label="Expert 7\nLayer 11\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu8 [label="Aggregate\nLayer 11\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu9 [label="Gate Layer 11\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu9_exp0 [label="Expert 0\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp1 [label="Expert 1\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp2 [label="Expert 2\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp3 [label="Expert 3\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp4 [label="Expert 4\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp5 [label="Expert 5\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp6 [label="Expert 6\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu9_exp7 [label="Expert 7\nLayer 11\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu9 [label="Aggregate\nLayer 11\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu10 [label="Gate Layer 11\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu10_exp0 [label="Expert 0\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp1 [label="Expert 1\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp2 [label="Expert 2\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp3 [label="Expert 3\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp4 [label="Expert 4\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp5 [label="Expert 5\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp6 [label="Expert 6\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu10_exp7 [label="Expert 7\nLayer 11\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu10 [label="Aggregate\nLayer 11\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu11 [label="Gate Layer 11\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu11_exp0 [label="Expert 0\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp1 [label="Expert 1\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp2 [label="Expert 2\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp3 [label="Expert 3\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp4 [label="Expert 4\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp5 [label="Expert 5\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp6 [label="Expert 6\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu11_exp7 [label="Expert 7\nLayer 11\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu11 [label="Aggregate\nLayer 11\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu12 [label="Gate Layer 11\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu12_exp0 [label="Expert 0\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp1 [label="Expert 1\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp2 [label="Expert 2\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp3 [label="Expert 3\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp4 [label="Expert 4\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp5 [label="Expert 5\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp6 [label="Expert 6\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu12_exp7 [label="Expert 7\nLayer 11\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu12 [label="Aggregate\nLayer 11\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu13 [label="Gate Layer 11\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu13_exp0 [label="Expert 0\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp1 [label="Expert 1\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp2 [label="Expert 2\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp3 [label="Expert 3\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp4 [label="Expert 4\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp5 [label="Expert 5\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp6 [label="Expert 6\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu13_exp7 [label="Expert 7\nLayer 11\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu13 [label="Aggregate\nLayer 11\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu14 [label="Gate Layer 11\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu14_exp0 [label="Expert 0\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp1 [label="Expert 1\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp2 [label="Expert 2\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp3 [label="Expert 3\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp4 [label="Expert 4\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp5 [label="Expert 5\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp6 [label="Expert 6\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu14_exp7 [label="Expert 7\nLayer 11\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu14 [label="Aggregate\nLayer 11\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l11_gpu15 [label="Gate Layer 11\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l11_gpu15_exp0 [label="Expert 0\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp1 [label="Expert 1\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp2 [label="Expert 2\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp3 [label="Expert 3\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp4 [label="Expert 4\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp5 [label="Expert 5\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp6 [label="Expert 6\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l11_gpu15_exp7 [label="Expert 7\nLayer 11\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l11_gpu15 [label="Aggregate\nLayer 11\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l11_p1 [label="Residual Add\nLayer 11\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l12_p1 [label="Split Layer 12\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l12_gpu8 [label="MHA Layer 12\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu9 [label="MHA Layer 12\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu10 [label="MHA Layer 12\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu11 [label="MHA Layer 12\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu12 [label="MHA Layer 12\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu13 [label="MHA Layer 12\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu14 [label="MHA Layer 12\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l12_gpu15 [label="MHA Layer 12\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l12_gpu8 [label="Gate Layer 12\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu8_exp0 [label="Expert 0\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp1 [label="Expert 1\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp2 [label="Expert 2\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp3 [label="Expert 3\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp4 [label="Expert 4\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp5 [label="Expert 5\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp6 [label="Expert 6\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu8_exp7 [label="Expert 7\nLayer 12\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu8 [label="Aggregate\nLayer 12\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu9 [label="Gate Layer 12\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu9_exp0 [label="Expert 0\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp1 [label="Expert 1\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp2 [label="Expert 2\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp3 [label="Expert 3\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp4 [label="Expert 4\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp5 [label="Expert 5\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp6 [label="Expert 6\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu9_exp7 [label="Expert 7\nLayer 12\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu9 [label="Aggregate\nLayer 12\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu10 [label="Gate Layer 12\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu10_exp0 [label="Expert 0\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp1 [label="Expert 1\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp2 [label="Expert 2\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp3 [label="Expert 3\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp4 [label="Expert 4\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp5 [label="Expert 5\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp6 [label="Expert 6\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu10_exp7 [label="Expert 7\nLayer 12\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu10 [label="Aggregate\nLayer 12\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu11 [label="Gate Layer 12\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu11_exp0 [label="Expert 0\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp1 [label="Expert 1\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp2 [label="Expert 2\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp3 [label="Expert 3\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp4 [label="Expert 4\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp5 [label="Expert 5\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp6 [label="Expert 6\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu11_exp7 [label="Expert 7\nLayer 12\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu11 [label="Aggregate\nLayer 12\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu12 [label="Gate Layer 12\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu12_exp0 [label="Expert 0\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp1 [label="Expert 1\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp2 [label="Expert 2\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp3 [label="Expert 3\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp4 [label="Expert 4\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp5 [label="Expert 5\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp6 [label="Expert 6\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu12_exp7 [label="Expert 7\nLayer 12\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu12 [label="Aggregate\nLayer 12\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu13 [label="Gate Layer 12\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu13_exp0 [label="Expert 0\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp1 [label="Expert 1\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp2 [label="Expert 2\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp3 [label="Expert 3\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp4 [label="Expert 4\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp5 [label="Expert 5\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp6 [label="Expert 6\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu13_exp7 [label="Expert 7\nLayer 12\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu13 [label="Aggregate\nLayer 12\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu14 [label="Gate Layer 12\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu14_exp0 [label="Expert 0\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp1 [label="Expert 1\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp2 [label="Expert 2\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp3 [label="Expert 3\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp4 [label="Expert 4\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp5 [label="Expert 5\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp6 [label="Expert 6\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu14_exp7 [label="Expert 7\nLayer 12\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu14 [label="Aggregate\nLayer 12\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l12_gpu15 [label="Gate Layer 12\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l12_gpu15_exp0 [label="Expert 0\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp1 [label="Expert 1\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp2 [label="Expert 2\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp3 [label="Expert 3\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp4 [label="Expert 4\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp5 [label="Expert 5\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp6 [label="Expert 6\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l12_gpu15_exp7 [label="Expert 7\nLayer 12\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l12_gpu15 [label="Aggregate\nLayer 12\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l12_p1 [label="Residual Add\nLayer 12\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l13_p1 [label="Split Layer 13\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l13_gpu8 [label="MHA Layer 13\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu9 [label="MHA Layer 13\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu10 [label="MHA Layer 13\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu11 [label="MHA Layer 13\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu12 [label="MHA Layer 13\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu13 [label="MHA Layer 13\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu14 [label="MHA Layer 13\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l13_gpu15 [label="MHA Layer 13\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l13_gpu8 [label="Gate Layer 13\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu8_exp0 [label="Expert 0\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp1 [label="Expert 1\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp2 [label="Expert 2\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp3 [label="Expert 3\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp4 [label="Expert 4\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp5 [label="Expert 5\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp6 [label="Expert 6\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu8_exp7 [label="Expert 7\nLayer 13\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu8 [label="Aggregate\nLayer 13\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu9 [label="Gate Layer 13\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu9_exp0 [label="Expert 0\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp1 [label="Expert 1\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp2 [label="Expert 2\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp3 [label="Expert 3\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp4 [label="Expert 4\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp5 [label="Expert 5\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp6 [label="Expert 6\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu9_exp7 [label="Expert 7\nLayer 13\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu9 [label="Aggregate\nLayer 13\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu10 [label="Gate Layer 13\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu10_exp0 [label="Expert 0\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp1 [label="Expert 1\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp2 [label="Expert 2\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp3 [label="Expert 3\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp4 [label="Expert 4\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp5 [label="Expert 5\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp6 [label="Expert 6\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu10_exp7 [label="Expert 7\nLayer 13\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu10 [label="Aggregate\nLayer 13\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu11 [label="Gate Layer 13\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu11_exp0 [label="Expert 0\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp1 [label="Expert 1\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp2 [label="Expert 2\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp3 [label="Expert 3\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp4 [label="Expert 4\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp5 [label="Expert 5\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp6 [label="Expert 6\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu11_exp7 [label="Expert 7\nLayer 13\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu11 [label="Aggregate\nLayer 13\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu12 [label="Gate Layer 13\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu12_exp0 [label="Expert 0\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp1 [label="Expert 1\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp2 [label="Expert 2\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp3 [label="Expert 3\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp4 [label="Expert 4\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp5 [label="Expert 5\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp6 [label="Expert 6\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu12_exp7 [label="Expert 7\nLayer 13\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu12 [label="Aggregate\nLayer 13\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu13 [label="Gate Layer 13\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu13_exp0 [label="Expert 0\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp1 [label="Expert 1\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp2 [label="Expert 2\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp3 [label="Expert 3\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp4 [label="Expert 4\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp5 [label="Expert 5\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp6 [label="Expert 6\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu13_exp7 [label="Expert 7\nLayer 13\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu13 [label="Aggregate\nLayer 13\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu14 [label="Gate Layer 13\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu14_exp0 [label="Expert 0\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp1 [label="Expert 1\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp2 [label="Expert 2\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp3 [label="Expert 3\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp4 [label="Expert 4\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp5 [label="Expert 5\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp6 [label="Expert 6\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu14_exp7 [label="Expert 7\nLayer 13\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu14 [label="Aggregate\nLayer 13\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l13_gpu15 [label="Gate Layer 13\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l13_gpu15_exp0 [label="Expert 0\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp1 [label="Expert 1\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp2 [label="Expert 2\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp3 [label="Expert 3\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp4 [label="Expert 4\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp5 [label="Expert 5\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp6 [label="Expert 6\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l13_gpu15_exp7 [label="Expert 7\nLayer 13\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l13_gpu15 [label="Aggregate\nLayer 13\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l13_p1 [label="Residual Add\nLayer 13\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l14_p1 [label="Split Layer 14\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l14_gpu8 [label="MHA Layer 14\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu9 [label="MHA Layer 14\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu10 [label="MHA Layer 14\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu11 [label="MHA Layer 14\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu12 [label="MHA Layer 14\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu13 [label="MHA Layer 14\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu14 [label="MHA Layer 14\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l14_gpu15 [label="MHA Layer 14\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l14_gpu8 [label="Gate Layer 14\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu8_exp0 [label="Expert 0\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp1 [label="Expert 1\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp2 [label="Expert 2\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp3 [label="Expert 3\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp4 [label="Expert 4\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp5 [label="Expert 5\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp6 [label="Expert 6\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu8_exp7 [label="Expert 7\nLayer 14\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu8 [label="Aggregate\nLayer 14\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu9 [label="Gate Layer 14\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu9_exp0 [label="Expert 0\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp1 [label="Expert 1\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp2 [label="Expert 2\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp3 [label="Expert 3\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp4 [label="Expert 4\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp5 [label="Expert 5\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp6 [label="Expert 6\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu9_exp7 [label="Expert 7\nLayer 14\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu9 [label="Aggregate\nLayer 14\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu10 [label="Gate Layer 14\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu10_exp0 [label="Expert 0\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp1 [label="Expert 1\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp2 [label="Expert 2\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp3 [label="Expert 3\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp4 [label="Expert 4\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp5 [label="Expert 5\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp6 [label="Expert 6\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu10_exp7 [label="Expert 7\nLayer 14\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu10 [label="Aggregate\nLayer 14\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu11 [label="Gate Layer 14\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu11_exp0 [label="Expert 0\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp1 [label="Expert 1\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp2 [label="Expert 2\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp3 [label="Expert 3\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp4 [label="Expert 4\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp5 [label="Expert 5\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp6 [label="Expert 6\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu11_exp7 [label="Expert 7\nLayer 14\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu11 [label="Aggregate\nLayer 14\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu12 [label="Gate Layer 14\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu12_exp0 [label="Expert 0\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp1 [label="Expert 1\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp2 [label="Expert 2\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp3 [label="Expert 3\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp4 [label="Expert 4\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp5 [label="Expert 5\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp6 [label="Expert 6\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu12_exp7 [label="Expert 7\nLayer 14\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu12 [label="Aggregate\nLayer 14\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu13 [label="Gate Layer 14\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu13_exp0 [label="Expert 0\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp1 [label="Expert 1\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp2 [label="Expert 2\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp3 [label="Expert 3\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp4 [label="Expert 4\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp5 [label="Expert 5\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp6 [label="Expert 6\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu13_exp7 [label="Expert 7\nLayer 14\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu13 [label="Aggregate\nLayer 14\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu14 [label="Gate Layer 14\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu14_exp0 [label="Expert 0\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp1 [label="Expert 1\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp2 [label="Expert 2\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp3 [label="Expert 3\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp4 [label="Expert 4\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp5 [label="Expert 5\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp6 [label="Expert 6\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu14_exp7 [label="Expert 7\nLayer 14\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu14 [label="Aggregate\nLayer 14\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l14_gpu15 [label="Gate Layer 14\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l14_gpu15_exp0 [label="Expert 0\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp1 [label="Expert 1\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp2 [label="Expert 2\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp3 [label="Expert 3\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp4 [label="Expert 4\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp5 [label="Expert 5\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp6 [label="Expert 6\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l14_gpu15_exp7 [label="Expert 7\nLayer 14\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l14_gpu15 [label="Aggregate\nLayer 14\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l14_p1 [label="Residual Add\nLayer 14\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l15_p1 [label="Split Layer 15\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l15_gpu8 [label="MHA Layer 15\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu9 [label="MHA Layer 15\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu10 [label="MHA Layer 15\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu11 [label="MHA Layer 15\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu12 [label="MHA Layer 15\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu13 [label="MHA Layer 15\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu14 [label="MHA Layer 15\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l15_gpu15 [label="MHA Layer 15\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l15_gpu8 [label="Gate Layer 15\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu8_exp0 [label="Expert 0\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp1 [label="Expert 1\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp2 [label="Expert 2\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp3 [label="Expert 3\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp4 [label="Expert 4\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp5 [label="Expert 5\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp6 [label="Expert 6\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu8_exp7 [label="Expert 7\nLayer 15\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu8 [label="Aggregate\nLayer 15\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu9 [label="Gate Layer 15\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu9_exp0 [label="Expert 0\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp1 [label="Expert 1\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp2 [label="Expert 2\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp3 [label="Expert 3\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp4 [label="Expert 4\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp5 [label="Expert 5\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp6 [label="Expert 6\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu9_exp7 [label="Expert 7\nLayer 15\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu9 [label="Aggregate\nLayer 15\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu10 [label="Gate Layer 15\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu10_exp0 [label="Expert 0\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp1 [label="Expert 1\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp2 [label="Expert 2\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp3 [label="Expert 3\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp4 [label="Expert 4\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp5 [label="Expert 5\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp6 [label="Expert 6\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu10_exp7 [label="Expert 7\nLayer 15\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu10 [label="Aggregate\nLayer 15\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu11 [label="Gate Layer 15\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu11_exp0 [label="Expert 0\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp1 [label="Expert 1\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp2 [label="Expert 2\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp3 [label="Expert 3\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp4 [label="Expert 4\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp5 [label="Expert 5\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp6 [label="Expert 6\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu11_exp7 [label="Expert 7\nLayer 15\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu11 [label="Aggregate\nLayer 15\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu12 [label="Gate Layer 15\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu12_exp0 [label="Expert 0\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp1 [label="Expert 1\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp2 [label="Expert 2\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp3 [label="Expert 3\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp4 [label="Expert 4\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp5 [label="Expert 5\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp6 [label="Expert 6\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu12_exp7 [label="Expert 7\nLayer 15\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu12 [label="Aggregate\nLayer 15\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu13 [label="Gate Layer 15\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu13_exp0 [label="Expert 0\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp1 [label="Expert 1\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp2 [label="Expert 2\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp3 [label="Expert 3\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp4 [label="Expert 4\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp5 [label="Expert 5\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp6 [label="Expert 6\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu13_exp7 [label="Expert 7\nLayer 15\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu13 [label="Aggregate\nLayer 15\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu14 [label="Gate Layer 15\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu14_exp0 [label="Expert 0\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp1 [label="Expert 1\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp2 [label="Expert 2\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp3 [label="Expert 3\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp4 [label="Expert 4\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp5 [label="Expert 5\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp6 [label="Expert 6\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu14_exp7 [label="Expert 7\nLayer 15\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu14 [label="Aggregate\nLayer 15\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l15_gpu15 [label="Gate Layer 15\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l15_gpu15_exp0 [label="Expert 0\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp1 [label="Expert 1\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp2 [label="Expert 2\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp3 [label="Expert 3\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp4 [label="Expert 4\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp5 [label="Expert 5\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp6 [label="Expert 6\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l15_gpu15_exp7 [label="Expert 7\nLayer 15\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l15_gpu15 [label="Aggregate\nLayer 15\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l15_p1 [label="Residual Add\nLayer 15\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
		split_l16_p1 [label="Split Layer 16\nInput: [128,10000,4096]\nOutput: [128,10000,512]" fillcolor=lightyellow shape=parallelogram style=filled]
		mha_l16_gpu8 [label="MHA Layer 16\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu9 [label="MHA Layer 16\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu10 [label="MHA Layer 16\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu11 [label="MHA Layer 16\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu12 [label="MHA Layer 16\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu13 [label="MHA Layer 16\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu14 [label="MHA Layer 16\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		mha_l16_gpu15 [label="MHA Layer 16\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=rectangle style=filled]
		gate_l16_gpu8 [label="Gate Layer 16\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu8_exp0 [label="Expert 0\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp1 [label="Expert 1\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp2 [label="Expert 2\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp3 [label="Expert 3\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp4 [label="Expert 4\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp5 [label="Expert 5\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp6 [label="Expert 6\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu8_exp7 [label="Expert 7\nLayer 16\nGPU 8\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu8 [label="Aggregate\nLayer 16\nGPU 8\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu9 [label="Gate Layer 16\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu9_exp0 [label="Expert 0\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp1 [label="Expert 1\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp2 [label="Expert 2\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp3 [label="Expert 3\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp4 [label="Expert 4\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp5 [label="Expert 5\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp6 [label="Expert 6\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu9_exp7 [label="Expert 7\nLayer 16\nGPU 9\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu9 [label="Aggregate\nLayer 16\nGPU 9\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu10 [label="Gate Layer 16\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu10_exp0 [label="Expert 0\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp1 [label="Expert 1\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp2 [label="Expert 2\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp3 [label="Expert 3\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp4 [label="Expert 4\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp5 [label="Expert 5\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp6 [label="Expert 6\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu10_exp7 [label="Expert 7\nLayer 16\nGPU 10\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu10 [label="Aggregate\nLayer 16\nGPU 10\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu11 [label="Gate Layer 16\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu11_exp0 [label="Expert 0\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp1 [label="Expert 1\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp2 [label="Expert 2\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp3 [label="Expert 3\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp4 [label="Expert 4\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp5 [label="Expert 5\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp6 [label="Expert 6\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu11_exp7 [label="Expert 7\nLayer 16\nGPU 11\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu11 [label="Aggregate\nLayer 16\nGPU 11\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu12 [label="Gate Layer 16\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu12_exp0 [label="Expert 0\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp1 [label="Expert 1\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp2 [label="Expert 2\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp3 [label="Expert 3\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp4 [label="Expert 4\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp5 [label="Expert 5\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp6 [label="Expert 6\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu12_exp7 [label="Expert 7\nLayer 16\nGPU 12\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu12 [label="Aggregate\nLayer 16\nGPU 12\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu13 [label="Gate Layer 16\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu13_exp0 [label="Expert 0\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp1 [label="Expert 1\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp2 [label="Expert 2\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp3 [label="Expert 3\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp4 [label="Expert 4\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp5 [label="Expert 5\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp6 [label="Expert 6\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu13_exp7 [label="Expert 7\nLayer 16\nGPU 13\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu13 [label="Aggregate\nLayer 16\nGPU 13\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu14 [label="Gate Layer 16\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu14_exp0 [label="Expert 0\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp1 [label="Expert 1\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp2 [label="Expert 2\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp3 [label="Expert 3\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp4 [label="Expert 4\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp5 [label="Expert 5\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp6 [label="Expert 6\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu14_exp7 [label="Expert 7\nLayer 16\nGPU 14\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu14 [label="Aggregate\nLayer 16\nGPU 14\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		gate_l16_gpu15 [label="Gate Layer 16\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,8]" fillcolor=lightgreen shape=parallelogram style=filled]
		exp_l16_gpu15_exp0 [label="Expert 0\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp1 [label="Expert 1\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp2 [label="Expert 2\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp3 [label="Expert 3\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp4 [label="Expert 4\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp5 [label="Expert 5\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp6 [label="Expert 6\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		exp_l16_gpu15_exp7 [label="Expert 7\nLayer 16\nGPU 15\nInput: [128,?,512]\nOutput: [128,?,512]" fillcolor=lightgreen shape=rectangle style=filled]
		agg_l16_gpu15 [label="Aggregate\nLayer 16\nGPU 15\nInput: [128,10000,512]\nOutput: [128,10000,512]" fillcolor=lightgreen shape=parallelogram style=filled]
		residual_l16_p1 [label="Residual Add\nLayer 16\nGPUs 8-15\nInput: [128,10000,512]\nOutput: [128,10000,4096]" fillcolor=lightgray shape=rectangle style=filled]
	}
	pipeline_comm [label="Pipeline Communication\nGPUs 78\n[128,10000,4096][128,10000,4096]" fillcolor=orange shape=ellipse style=dashed]
	output [label="Output\nBatch: 128\nSeq Len: 10,000\nDim: 4096" fillcolor=yellow shape=ellipse style=filled]
	input -> split_l1_p0
	split_l1_p0 -> mha_l1_gpu0
	split_l1_p0 -> mha_l1_gpu1
	split_l1_p0 -> mha_l1_gpu2
	split_l1_p0 -> mha_l1_gpu3
	split_l1_p0 -> mha_l1_gpu4
	split_l1_p0 -> mha_l1_gpu5
	split_l1_p0 -> mha_l1_gpu6
	split_l1_p0 -> mha_l1_gpu7
	mha_l1_gpu0 -> gate_l1_gpu0
	gate_l1_gpu0 -> exp_l1_gpu0_exp0 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp1 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp2 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp3 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp4 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp5 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp6 [style=dashed]
	gate_l1_gpu0 -> exp_l1_gpu0_exp7 [style=dashed]
	mha_l1_gpu1 -> gate_l1_gpu1
	gate_l1_gpu1 -> exp_l1_gpu1_exp0 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp1 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp2 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp3 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp4 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp5 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp6 [style=dashed]
	gate_l1_gpu1 -> exp_l1_gpu1_exp7 [style=dashed]
	mha_l1_gpu2 -> gate_l1_gpu2
	gate_l1_gpu2 -> exp_l1_gpu2_exp0 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp1 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp2 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp3 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp4 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp5 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp6 [style=dashed]
	gate_l1_gpu2 -> exp_l1_gpu2_exp7 [style=dashed]
	mha_l1_gpu3 -> gate_l1_gpu3
	gate_l1_gpu3 -> exp_l1_gpu3_exp0 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp1 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp2 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp3 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp4 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp5 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp6 [style=dashed]
	gate_l1_gpu3 -> exp_l1_gpu3_exp7 [style=dashed]
	mha_l1_gpu4 -> gate_l1_gpu4
	gate_l1_gpu4 -> exp_l1_gpu4_exp0 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp1 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp2 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp3 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp4 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp5 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp6 [style=dashed]
	gate_l1_gpu4 -> exp_l1_gpu4_exp7 [style=dashed]
	mha_l1_gpu5 -> gate_l1_gpu5
	gate_l1_gpu5 -> exp_l1_gpu5_exp0 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp1 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp2 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp3 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp4 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp5 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp6 [style=dashed]
	gate_l1_gpu5 -> exp_l1_gpu5_exp7 [style=dashed]
	mha_l1_gpu6 -> gate_l1_gpu6
	gate_l1_gpu6 -> exp_l1_gpu6_exp0 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp1 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp2 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp3 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp4 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp5 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp6 [style=dashed]
	gate_l1_gpu6 -> exp_l1_gpu6_exp7 [style=dashed]
	mha_l1_gpu7 -> gate_l1_gpu7
	gate_l1_gpu7 -> exp_l1_gpu7_exp0 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp1 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp2 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp3 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp4 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp5 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp6 [style=dashed]
	gate_l1_gpu7 -> exp_l1_gpu7_exp7 [style=dashed]
	exp_l1_gpu0_exp0 -> agg_l1_gpu0
	exp_l1_gpu0_exp1 -> agg_l1_gpu0
	exp_l1_gpu0_exp2 -> agg_l1_gpu0
	exp_l1_gpu0_exp3 -> agg_l1_gpu0
	exp_l1_gpu0_exp4 -> agg_l1_gpu0
	exp_l1_gpu0_exp5 -> agg_l1_gpu0
	exp_l1_gpu0_exp6 -> agg_l1_gpu0
	exp_l1_gpu0_exp7 -> agg_l1_gpu0
	agg_l1_gpu0 -> residual_l1_p0
	exp_l1_gpu1_exp0 -> agg_l1_gpu1
	exp_l1_gpu1_exp1 -> agg_l1_gpu1
	exp_l1_gpu1_exp2 -> agg_l1_gpu1
	exp_l1_gpu1_exp3 -> agg_l1_gpu1
	exp_l1_gpu1_exp4 -> agg_l1_gpu1
	exp_l1_gpu1_exp5 -> agg_l1_gpu1
	exp_l1_gpu1_exp6 -> agg_l1_gpu1
	exp_l1_gpu1_exp7 -> agg_l1_gpu1
	agg_l1_gpu1 -> residual_l1_p0
	exp_l1_gpu2_exp0 -> agg_l1_gpu2
	exp_l1_gpu2_exp1 -> agg_l1_gpu2
	exp_l1_gpu2_exp2 -> agg_l1_gpu2
	exp_l1_gpu2_exp3 -> agg_l1_gpu2
	exp_l1_gpu2_exp4 -> agg_l1_gpu2
	exp_l1_gpu2_exp5 -> agg_l1_gpu2
	exp_l1_gpu2_exp6 -> agg_l1_gpu2
	exp_l1_gpu2_exp7 -> agg_l1_gpu2
	agg_l1_gpu2 -> residual_l1_p0
	exp_l1_gpu3_exp0 -> agg_l1_gpu3
	exp_l1_gpu3_exp1 -> agg_l1_gpu3
	exp_l1_gpu3_exp2 -> agg_l1_gpu3
	exp_l1_gpu3_exp3 -> agg_l1_gpu3
	exp_l1_gpu3_exp4 -> agg_l1_gpu3
	exp_l1_gpu3_exp5 -> agg_l1_gpu3
	exp_l1_gpu3_exp6 -> agg_l1_gpu3
	exp_l1_gpu3_exp7 -> agg_l1_gpu3
	agg_l1_gpu3 -> residual_l1_p0
	exp_l1_gpu4_exp0 -> agg_l1_gpu4
	exp_l1_gpu4_exp1 -> agg_l1_gpu4
	exp_l1_gpu4_exp2 -> agg_l1_gpu4
	exp_l1_gpu4_exp3 -> agg_l1_gpu4
	exp_l1_gpu4_exp4 -> agg_l1_gpu4
	exp_l1_gpu4_exp5 -> agg_l1_gpu4
	exp_l1_gpu4_exp6 -> agg_l1_gpu4
	exp_l1_gpu4_exp7 -> agg_l1_gpu4
	agg_l1_gpu4 -> residual_l1_p0
	exp_l1_gpu5_exp0 -> agg_l1_gpu5
	exp_l1_gpu5_exp1 -> agg_l1_gpu5
	exp_l1_gpu5_exp2 -> agg_l1_gpu5
	exp_l1_gpu5_exp3 -> agg_l1_gpu5
	exp_l1_gpu5_exp4 -> agg_l1_gpu5
	exp_l1_gpu5_exp5 -> agg_l1_gpu5
	exp_l1_gpu5_exp6 -> agg_l1_gpu5
	exp_l1_gpu5_exp7 -> agg_l1_gpu5
	agg_l1_gpu5 -> residual_l1_p0
	exp_l1_gpu6_exp0 -> agg_l1_gpu6
	exp_l1_gpu6_exp1 -> agg_l1_gpu6
	exp_l1_gpu6_exp2 -> agg_l1_gpu6
	exp_l1_gpu6_exp3 -> agg_l1_gpu6
	exp_l1_gpu6_exp4 -> agg_l1_gpu6
	exp_l1_gpu6_exp5 -> agg_l1_gpu6
	exp_l1_gpu6_exp6 -> agg_l1_gpu6
	exp_l1_gpu6_exp7 -> agg_l1_gpu6
	agg_l1_gpu6 -> residual_l1_p0
	exp_l1_gpu7_exp0 -> agg_l1_gpu7
	exp_l1_gpu7_exp1 -> agg_l1_gpu7
	exp_l1_gpu7_exp2 -> agg_l1_gpu7
	exp_l1_gpu7_exp3 -> agg_l1_gpu7
	exp_l1_gpu7_exp4 -> agg_l1_gpu7
	exp_l1_gpu7_exp5 -> agg_l1_gpu7
	exp_l1_gpu7_exp6 -> agg_l1_gpu7
	exp_l1_gpu7_exp7 -> agg_l1_gpu7
	agg_l1_gpu7 -> residual_l1_p0
	residual_l8_p0 -> pipeline_comm
	pipeline_comm -> split_l9_p1
	residual_l16_p1 -> output
}
