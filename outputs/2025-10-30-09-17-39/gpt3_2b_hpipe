// GPT3-2B HPipe Token-Level Pipeline Deployment
digraph GPT3_2B_HPipe {
	graph [compound=true concentrate=true nodesep=0.2 rankdir=TB ranksep=1.5]
	subgraph cluster_P100_1 {
		color=black fillcolor=lightblue label="P100_1\nhost_1" style="rounded,filled"
		P100_1_layer_1_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_1_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_1_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_1_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_1_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_1_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_1_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_1_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_1_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_1_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_2_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_2_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_2_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_2_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_2_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_2_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_2_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_2_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_2_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_2_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_3_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_3_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_3_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_3_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_3_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_3_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_3_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_3_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_3_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_3_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_4_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_4_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_4_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcoral shape=rectangle style=filled]
		P100_1_layer_4_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_4_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_4_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_4_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightcyan shape=rectangle style=filled]
		P100_1_layer_4_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_1_layer_4_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
		P100_1_layer_4_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_1" fillcolor=lightgray shape=ellipse style=filled]
	}
	subgraph cluster_P100_2 {
		color=black fillcolor=lightblue label="P100_2\nhost_1" style="rounded,filled"
		P100_2_layer_5_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_5_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_5_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_5_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_5_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_5_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_5_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_5_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_5_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_5_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_6_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_6_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_6_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_6_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_6_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_6_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_6_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_6_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_6_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_6_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_7_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_7_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_7_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_7_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_7_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_7_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_7_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_7_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_7_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_7_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_8_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_8_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_8_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcoral shape=rectangle style=filled]
		P100_2_layer_8_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_8_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_8_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_8_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightcyan shape=rectangle style=filled]
		P100_2_layer_8_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_2_layer_8_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
		P100_2_layer_8_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_2" fillcolor=lightgray shape=ellipse style=filled]
	}
	subgraph cluster_P100_3 {
		color=black fillcolor=lightblue label="P100_3\nhost_1" style="rounded,filled"
		P100_3_layer_9_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_9_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_9_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_9_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_9_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_9_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_9_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_9_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_9_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_9_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_10_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_10_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_10_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_10_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_10_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_10_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_10_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_10_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_10_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_10_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_11_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_11_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_11_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_11_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_11_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_11_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_11_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_11_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_11_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_11_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_12_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_12_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_12_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcoral shape=rectangle style=filled]
		P100_3_layer_12_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_12_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_12_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_12_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightcyan shape=rectangle style=filled]
		P100_3_layer_12_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_3_layer_12_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
		P100_3_layer_12_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_3" fillcolor=lightgray shape=ellipse style=filled]
	}
	subgraph cluster_P100_4 {
		color=black fillcolor=lightblue label="P100_4\nhost_1" style="rounded,filled"
		P100_4_layer_13_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_13_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_13_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_13_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_13_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_13_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_13_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_13_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_13_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_13_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_14_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_14_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_14_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_14_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_14_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_14_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_14_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_14_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_14_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_14_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_15_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_15_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_15_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_15_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_15_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_15_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_15_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_15_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_15_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_15_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_16_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_16_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_16_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcoral shape=rectangle style=filled]
		P100_4_layer_16_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_16_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_16_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_16_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightcyan shape=rectangle style=filled]
		P100_4_layer_16_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightyellow shape=parallelogram style=filled]
		P100_4_layer_16_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
		P100_4_layer_16_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: P100_4" fillcolor=lightgray shape=ellipse style=filled]
	}
	subgraph cluster_RTX3090_1 {
		color=black fillcolor=lightgreen label="RTX3090_1\nhost_2" style="rounded,filled"
		RTX3090_1_layer_17_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_17_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_17_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_17_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_17_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_17_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_17_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_17_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_17_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_17_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_18_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_18_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_18_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_18_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_18_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_18_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_18_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_18_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_18_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_18_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_19_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_19_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_19_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_19_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_19_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_19_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_19_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_19_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_19_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_19_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_20_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_20_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_20_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_1_layer_20_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_20_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_20_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_20_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_1_layer_20_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_1_layer_20_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_1_layer_20_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_1" fillcolor=lightgray shape=ellipse style=filled]
	}
	subgraph cluster_RTX3090_2 {
		color=black fillcolor=lightgreen label="RTX3090_2\nhost_2" style="rounded,filled"
		RTX3090_2_layer_21_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_21_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_21_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_21_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_21_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_21_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_21_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_21_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_21_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_21_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_22_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_22_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_22_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_22_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_22_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_22_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_22_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_22_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_22_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_22_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_23_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_23_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_23_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_23_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_23_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_23_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_23_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_23_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_23_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_23_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_24_qkv_proj [label="QKV Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, heads=16, head_dim=128]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_24_attn_calc [label="Multi-Head Attention\nInput: [batch=12, seq=2048, heads=16, head_dim=128]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_24_attn_out [label="Attention Output\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcoral shape=rectangle style=filled]
		RTX3090_2_layer_24_attn_res [label="Attention+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_24_ffn_up [label="FFN Up\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_24_ffn_gate [label="FFN Gate\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, ffn=8192]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_24_ffn_down [label="FFN Down\nInput: [batch=12, seq=2048, ffn=8192]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightcyan shape=rectangle style=filled]
		RTX3090_2_layer_24_ffn_res [label="FFN+Residual\nInput1: [batch=12, seq=2048, hidden=2048]\nInput2: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightyellow shape=parallelogram style=filled]
		RTX3090_2_layer_24_norm1 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
		RTX3090_2_layer_24_norm2 [label="LayerNorm\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: RTX3090_2" fillcolor=lightgray shape=ellipse style=filled]
	}
	slice_1_input [label="slice_1\nTokens: 256\nShape: [batch=12, seq=256, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_2_input [label="slice_2\nTokens: 252\nShape: [batch=12, seq=252, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_3_input [label="slice_3\nTokens: 248\nShape: [batch=12, seq=248, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_4_input [label="slice_4\nTokens: 244\nShape: [batch=12, seq=244, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_5_input [label="slice_5\nTokens: 240\nShape: [batch=12, seq=240, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_6_input [label="slice_6\nTokens: 236\nShape: [batch=12, seq=236, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_7_input [label="slice_7\nTokens: 232\nShape: [batch=12, seq=232, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_8_input [label="slice_8\nTokens: 228\nShape: [batch=12, seq=228, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_9_input [label="slice_9\nTokens: 224\nShape: [batch=12, seq=224, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_10_input [label="slice_10\nTokens: 220\nShape: [batch=12, seq=220, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_11_input [label="slice_11\nTokens: 216\nShape: [batch=12, seq=216, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_12_input [label="slice_12\nTokens: 212\nShape: [batch=12, seq=212, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_13_input [label="slice_13\nTokens: 208\nShape: [batch=12, seq=208, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_14_input [label="slice_14\nTokens: 204\nShape: [batch=12, seq=204, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_15_input [label="slice_15\nTokens: 200\nShape: [batch=12, seq=200, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_16_input [label="slice_16\nTokens: 196\nShape: [batch=12, seq=196, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	slice_17_input [label="slice_17\nTokens: 192\nShape: [batch=12, seq=192, hidden=2048]" fillcolor=lightpink shape=octagon style=filled]
	input_embedding [label="Input Embedding\nInput: [batch=12, seq=2048, vocab=50257]\nOutput: [batch=12, seq=2048, hidden=2048]\nDevice: All GPUs" fillcolor=lightgreen shape=rectangle style=filled]
	output_projection [label="Output Projection\nInput: [batch=12, seq=2048, hidden=2048]\nOutput: [batch=12, seq=2048, vocab=50257]\nDevice: RTX3090_2" fillcolor=lightgreen shape=rectangle style=filled]
	final_output [label="Final Output\nShape: [batch=12, seq=2048, vocab=50257]" fillcolor=lightblue shape=doubleoctagon style=filled]
	comm_P100_1_to_P100_2 [label="Communication\nP100_1  P100_2\n[batch=12, seq=2048, hidden=2048]\nBandwidth: 15.75Gbps" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
	comm_P100_2_to_P100_3 [label="Communication\nP100_2  P100_3\n[batch=12, seq=2048, hidden=2048]\nBandwidth: 15.75Gbps" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
	comm_P100_3_to_P100_4 [label="Communication\nP100_3  P100_4\n[batch=12, seq=2048, hidden=2048]\nBandwidth: 15.75Gbps" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
	comm_P100_4_to_RTX3090_1 [label="Communication\nP100_4  RTX3090_1\n[batch=12, seq=2048, hidden=2048]\nBandwidth: 1Gbps" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
	comm_RTX3090_1_to_RTX3090_2 [label="Communication\nRTX3090_1  RTX3090_2\n[batch=12, seq=2048, hidden=2048]\nBandwidth: 15.75Gbps" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
	kv_cache_P100_1_slice_1 [label="KV Cache\nP100_1\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_2 [label="KV Cache\nP100_1\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_3 [label="KV Cache\nP100_1\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_4 [label="KV Cache\nP100_1\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_5 [label="KV Cache\nP100_1\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_6 [label="KV Cache\nP100_1\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_7 [label="KV Cache\nP100_1\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_8 [label="KV Cache\nP100_1\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_9 [label="KV Cache\nP100_1\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_10 [label="KV Cache\nP100_1\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_11 [label="KV Cache\nP100_1\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_12 [label="KV Cache\nP100_1\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_13 [label="KV Cache\nP100_1\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_14 [label="KV Cache\nP100_1\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_15 [label="KV Cache\nP100_1\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_16 [label="KV Cache\nP100_1\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_1_slice_17 [label="KV Cache\nP100_1\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_1 [label="KV Cache\nP100_2\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_2 [label="KV Cache\nP100_2\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_3 [label="KV Cache\nP100_2\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_4 [label="KV Cache\nP100_2\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_5 [label="KV Cache\nP100_2\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_6 [label="KV Cache\nP100_2\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_7 [label="KV Cache\nP100_2\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_8 [label="KV Cache\nP100_2\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_9 [label="KV Cache\nP100_2\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_10 [label="KV Cache\nP100_2\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_11 [label="KV Cache\nP100_2\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_12 [label="KV Cache\nP100_2\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_13 [label="KV Cache\nP100_2\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_14 [label="KV Cache\nP100_2\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_15 [label="KV Cache\nP100_2\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_16 [label="KV Cache\nP100_2\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_2_slice_17 [label="KV Cache\nP100_2\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_1 [label="KV Cache\nP100_3\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_2 [label="KV Cache\nP100_3\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_3 [label="KV Cache\nP100_3\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_4 [label="KV Cache\nP100_3\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_5 [label="KV Cache\nP100_3\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_6 [label="KV Cache\nP100_3\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_7 [label="KV Cache\nP100_3\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_8 [label="KV Cache\nP100_3\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_9 [label="KV Cache\nP100_3\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_10 [label="KV Cache\nP100_3\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_11 [label="KV Cache\nP100_3\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_12 [label="KV Cache\nP100_3\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_13 [label="KV Cache\nP100_3\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_14 [label="KV Cache\nP100_3\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_15 [label="KV Cache\nP100_3\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_16 [label="KV Cache\nP100_3\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_3_slice_17 [label="KV Cache\nP100_3\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_1 [label="KV Cache\nP100_4\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_2 [label="KV Cache\nP100_4\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_3 [label="KV Cache\nP100_4\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_4 [label="KV Cache\nP100_4\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_5 [label="KV Cache\nP100_4\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_6 [label="KV Cache\nP100_4\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_7 [label="KV Cache\nP100_4\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_8 [label="KV Cache\nP100_4\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_9 [label="KV Cache\nP100_4\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_10 [label="KV Cache\nP100_4\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_11 [label="KV Cache\nP100_4\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_12 [label="KV Cache\nP100_4\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_13 [label="KV Cache\nP100_4\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_14 [label="KV Cache\nP100_4\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_15 [label="KV Cache\nP100_4\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_16 [label="KV Cache\nP100_4\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_P100_4_slice_17 [label="KV Cache\nP100_4\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_1 [label="KV Cache\nRTX3090_1\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_2 [label="KV Cache\nRTX3090_1\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_3 [label="KV Cache\nRTX3090_1\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_4 [label="KV Cache\nRTX3090_1\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_5 [label="KV Cache\nRTX3090_1\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_6 [label="KV Cache\nRTX3090_1\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_7 [label="KV Cache\nRTX3090_1\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_8 [label="KV Cache\nRTX3090_1\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_9 [label="KV Cache\nRTX3090_1\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_10 [label="KV Cache\nRTX3090_1\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_11 [label="KV Cache\nRTX3090_1\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_12 [label="KV Cache\nRTX3090_1\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_13 [label="KV Cache\nRTX3090_1\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_14 [label="KV Cache\nRTX3090_1\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_15 [label="KV Cache\nRTX3090_1\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_16 [label="KV Cache\nRTX3090_1\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_1_slice_17 [label="KV Cache\nRTX3090_1\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_1 [label="KV Cache\nRTX3090_2\nslice_1\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_2 [label="KV Cache\nRTX3090_2\nslice_2\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_3 [label="KV Cache\nRTX3090_2\nslice_3\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_4 [label="KV Cache\nRTX3090_2\nslice_4\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_5 [label="KV Cache\nRTX3090_2\nslice_5\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_6 [label="KV Cache\nRTX3090_2\nslice_6\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_7 [label="KV Cache\nRTX3090_2\nslice_7\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_8 [label="KV Cache\nRTX3090_2\nslice_8\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_9 [label="KV Cache\nRTX3090_2\nslice_9\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_10 [label="KV Cache\nRTX3090_2\nslice_10\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_11 [label="KV Cache\nRTX3090_2\nslice_11\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_12 [label="KV Cache\nRTX3090_2\nslice_12\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_13 [label="KV Cache\nRTX3090_2\nslice_13\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_14 [label="KV Cache\nRTX3090_2\nslice_14\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_15 [label="KV Cache\nRTX3090_2\nslice_15\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_16 [label="KV Cache\nRTX3090_2\nslice_16\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	kv_cache_RTX3090_2_slice_17 [label="KV Cache\nRTX3090_2\nslice_17\n[batch=12, heads=16, seq=?, head_dim=128]" fillcolor=lightgray shape=cylinder style=filled]
	input_embedding -> P100_1_layer_1_qkv_proj [label="[batch=12, seq=2048, hidden=2048]"]
	P100_1_layer_1_qkv_proj -> P100_1_layer_1_attn_calc
	P100_1_layer_1_attn_calc -> P100_1_layer_1_attn_out
	P100_1_layer_1_attn_out -> P100_1_layer_1_attn_res
	P100_1_layer_1_ffn_up -> P100_1_layer_1_ffn_gate
	P100_1_layer_1_ffn_gate -> P100_1_layer_1_ffn_down
	P100_1_layer_1_ffn_down -> P100_1_layer_1_ffn_res
	P100_1_layer_1_norm1 -> P100_1_layer_1_qkv_proj
	P100_1_layer_1_norm2 -> P100_1_layer_1_ffn_up
	P100_1_layer_1_attn_res -> P100_1_layer_1_norm2
	P100_1_layer_2_qkv_proj -> P100_1_layer_2_attn_calc
	P100_1_layer_2_attn_calc -> P100_1_layer_2_attn_out
	P100_1_layer_2_attn_out -> P100_1_layer_2_attn_res
	P100_1_layer_2_ffn_up -> P100_1_layer_2_ffn_gate
	P100_1_layer_2_ffn_gate -> P100_1_layer_2_ffn_down
	P100_1_layer_2_ffn_down -> P100_1_layer_2_ffn_res
	P100_1_layer_2_norm1 -> P100_1_layer_2_qkv_proj
	P100_1_layer_2_norm2 -> P100_1_layer_2_ffn_up
	P100_1_layer_2_attn_res -> P100_1_layer_2_norm2
	P100_1_layer_3_qkv_proj -> P100_1_layer_3_attn_calc
	P100_1_layer_3_attn_calc -> P100_1_layer_3_attn_out
	P100_1_layer_3_attn_out -> P100_1_layer_3_attn_res
	P100_1_layer_3_ffn_up -> P100_1_layer_3_ffn_gate
	P100_1_layer_3_ffn_gate -> P100_1_layer_3_ffn_down
	P100_1_layer_3_ffn_down -> P100_1_layer_3_ffn_res
	P100_1_layer_3_norm1 -> P100_1_layer_3_qkv_proj
	P100_1_layer_3_norm2 -> P100_1_layer_3_ffn_up
	P100_1_layer_3_attn_res -> P100_1_layer_3_norm2
	P100_1_layer_4_qkv_proj -> P100_1_layer_4_attn_calc
	P100_1_layer_4_attn_calc -> P100_1_layer_4_attn_out
	P100_1_layer_4_attn_out -> P100_1_layer_4_attn_res
	P100_1_layer_4_ffn_up -> P100_1_layer_4_ffn_gate
	P100_1_layer_4_ffn_gate -> P100_1_layer_4_ffn_down
	P100_1_layer_4_ffn_down -> P100_1_layer_4_ffn_res
	P100_1_layer_4_norm1 -> P100_1_layer_4_qkv_proj
	P100_1_layer_4_norm2 -> P100_1_layer_4_ffn_up
	P100_1_layer_4_attn_res -> P100_1_layer_4_norm2
	P100_2_layer_5_qkv_proj -> P100_2_layer_5_attn_calc
	P100_2_layer_5_attn_calc -> P100_2_layer_5_attn_out
	P100_2_layer_5_attn_out -> P100_2_layer_5_attn_res
	P100_2_layer_5_ffn_up -> P100_2_layer_5_ffn_gate
	P100_2_layer_5_ffn_gate -> P100_2_layer_5_ffn_down
	P100_2_layer_5_ffn_down -> P100_2_layer_5_ffn_res
	P100_2_layer_5_norm1 -> P100_2_layer_5_qkv_proj
	P100_2_layer_5_norm2 -> P100_2_layer_5_ffn_up
	P100_2_layer_5_attn_res -> P100_2_layer_5_norm2
	P100_2_layer_6_qkv_proj -> P100_2_layer_6_attn_calc
	P100_2_layer_6_attn_calc -> P100_2_layer_6_attn_out
	P100_2_layer_6_attn_out -> P100_2_layer_6_attn_res
	P100_2_layer_6_ffn_up -> P100_2_layer_6_ffn_gate
	P100_2_layer_6_ffn_gate -> P100_2_layer_6_ffn_down
	P100_2_layer_6_ffn_down -> P100_2_layer_6_ffn_res
	P100_2_layer_6_norm1 -> P100_2_layer_6_qkv_proj
	P100_2_layer_6_norm2 -> P100_2_layer_6_ffn_up
	P100_2_layer_6_attn_res -> P100_2_layer_6_norm2
	P100_2_layer_7_qkv_proj -> P100_2_layer_7_attn_calc
	P100_2_layer_7_attn_calc -> P100_2_layer_7_attn_out
	P100_2_layer_7_attn_out -> P100_2_layer_7_attn_res
	P100_2_layer_7_ffn_up -> P100_2_layer_7_ffn_gate
	P100_2_layer_7_ffn_gate -> P100_2_layer_7_ffn_down
	P100_2_layer_7_ffn_down -> P100_2_layer_7_ffn_res
	P100_2_layer_7_norm1 -> P100_2_layer_7_qkv_proj
	P100_2_layer_7_norm2 -> P100_2_layer_7_ffn_up
	P100_2_layer_7_attn_res -> P100_2_layer_7_norm2
	P100_2_layer_8_qkv_proj -> P100_2_layer_8_attn_calc
	P100_2_layer_8_attn_calc -> P100_2_layer_8_attn_out
	P100_2_layer_8_attn_out -> P100_2_layer_8_attn_res
	P100_2_layer_8_ffn_up -> P100_2_layer_8_ffn_gate
	P100_2_layer_8_ffn_gate -> P100_2_layer_8_ffn_down
	P100_2_layer_8_ffn_down -> P100_2_layer_8_ffn_res
	P100_2_layer_8_norm1 -> P100_2_layer_8_qkv_proj
	P100_2_layer_8_norm2 -> P100_2_layer_8_ffn_up
	P100_2_layer_8_attn_res -> P100_2_layer_8_norm2
	P100_3_layer_9_qkv_proj -> P100_3_layer_9_attn_calc
	P100_3_layer_9_attn_calc -> P100_3_layer_9_attn_out
	P100_3_layer_9_attn_out -> P100_3_layer_9_attn_res
	P100_3_layer_9_ffn_up -> P100_3_layer_9_ffn_gate
	P100_3_layer_9_ffn_gate -> P100_3_layer_9_ffn_down
	P100_3_layer_9_ffn_down -> P100_3_layer_9_ffn_res
	P100_3_layer_9_norm1 -> P100_3_layer_9_qkv_proj
	P100_3_layer_9_norm2 -> P100_3_layer_9_ffn_up
	P100_3_layer_9_attn_res -> P100_3_layer_9_norm2
	P100_3_layer_10_qkv_proj -> P100_3_layer_10_attn_calc
	P100_3_layer_10_attn_calc -> P100_3_layer_10_attn_out
	P100_3_layer_10_attn_out -> P100_3_layer_10_attn_res
	P100_3_layer_10_ffn_up -> P100_3_layer_10_ffn_gate
	P100_3_layer_10_ffn_gate -> P100_3_layer_10_ffn_down
	P100_3_layer_10_ffn_down -> P100_3_layer_10_ffn_res
	P100_3_layer_10_norm1 -> P100_3_layer_10_qkv_proj
	P100_3_layer_10_norm2 -> P100_3_layer_10_ffn_up
	P100_3_layer_10_attn_res -> P100_3_layer_10_norm2
	P100_3_layer_11_qkv_proj -> P100_3_layer_11_attn_calc
	P100_3_layer_11_attn_calc -> P100_3_layer_11_attn_out
	P100_3_layer_11_attn_out -> P100_3_layer_11_attn_res
	P100_3_layer_11_ffn_up -> P100_3_layer_11_ffn_gate
	P100_3_layer_11_ffn_gate -> P100_3_layer_11_ffn_down
	P100_3_layer_11_ffn_down -> P100_3_layer_11_ffn_res
	P100_3_layer_11_norm1 -> P100_3_layer_11_qkv_proj
	P100_3_layer_11_norm2 -> P100_3_layer_11_ffn_up
	P100_3_layer_11_attn_res -> P100_3_layer_11_norm2
	P100_3_layer_12_qkv_proj -> P100_3_layer_12_attn_calc
	P100_3_layer_12_attn_calc -> P100_3_layer_12_attn_out
	P100_3_layer_12_attn_out -> P100_3_layer_12_attn_res
	P100_3_layer_12_ffn_up -> P100_3_layer_12_ffn_gate
	P100_3_layer_12_ffn_gate -> P100_3_layer_12_ffn_down
	P100_3_layer_12_ffn_down -> P100_3_layer_12_ffn_res
	P100_3_layer_12_norm1 -> P100_3_layer_12_qkv_proj
	P100_3_layer_12_norm2 -> P100_3_layer_12_ffn_up
	P100_3_layer_12_attn_res -> P100_3_layer_12_norm2
	P100_4_layer_13_qkv_proj -> P100_4_layer_13_attn_calc
	P100_4_layer_13_attn_calc -> P100_4_layer_13_attn_out
	P100_4_layer_13_attn_out -> P100_4_layer_13_attn_res
	P100_4_layer_13_ffn_up -> P100_4_layer_13_ffn_gate
	P100_4_layer_13_ffn_gate -> P100_4_layer_13_ffn_down
	P100_4_layer_13_ffn_down -> P100_4_layer_13_ffn_res
	P100_4_layer_13_norm1 -> P100_4_layer_13_qkv_proj
	P100_4_layer_13_norm2 -> P100_4_layer_13_ffn_up
	P100_4_layer_13_attn_res -> P100_4_layer_13_norm2
	P100_4_layer_14_qkv_proj -> P100_4_layer_14_attn_calc
	P100_4_layer_14_attn_calc -> P100_4_layer_14_attn_out
	P100_4_layer_14_attn_out -> P100_4_layer_14_attn_res
	P100_4_layer_14_ffn_up -> P100_4_layer_14_ffn_gate
	P100_4_layer_14_ffn_gate -> P100_4_layer_14_ffn_down
	P100_4_layer_14_ffn_down -> P100_4_layer_14_ffn_res
	P100_4_layer_14_norm1 -> P100_4_layer_14_qkv_proj
	P100_4_layer_14_norm2 -> P100_4_layer_14_ffn_up
	P100_4_layer_14_attn_res -> P100_4_layer_14_norm2
	P100_4_layer_15_qkv_proj -> P100_4_layer_15_attn_calc
	P100_4_layer_15_attn_calc -> P100_4_layer_15_attn_out
	P100_4_layer_15_attn_out -> P100_4_layer_15_attn_res
	P100_4_layer_15_ffn_up -> P100_4_layer_15_ffn_gate
	P100_4_layer_15_ffn_gate -> P100_4_layer_15_ffn_down
	P100_4_layer_15_ffn_down -> P100_4_layer_15_ffn_res
	P100_4_layer_15_norm1 -> P100_4_layer_15_qkv_proj
	P100_4_layer_15_norm2 -> P100_4_layer_15_ffn_up
	P100_4_layer_15_attn_res -> P100_4_layer_15_norm2
	P100_4_layer_16_qkv_proj -> P100_4_layer_16_attn_calc
	P100_4_layer_16_attn_calc -> P100_4_layer_16_attn_out
	P100_4_layer_16_attn_out -> P100_4_layer_16_attn_res
	P100_4_layer_16_ffn_up -> P100_4_layer_16_ffn_gate
	P100_4_layer_16_ffn_gate -> P100_4_layer_16_ffn_down
	P100_4_layer_16_ffn_down -> P100_4_layer_16_ffn_res
	P100_4_layer_16_norm1 -> P100_4_layer_16_qkv_proj
	P100_4_layer_16_norm2 -> P100_4_layer_16_ffn_up
	P100_4_layer_16_attn_res -> P100_4_layer_16_norm2
	RTX3090_1_layer_17_qkv_proj -> RTX3090_1_layer_17_attn_calc
	RTX3090_1_layer_17_attn_calc -> RTX3090_1_layer_17_attn_out
	RTX3090_1_layer_17_attn_out -> RTX3090_1_layer_17_attn_res
	RTX3090_1_layer_17_ffn_up -> RTX3090_1_layer_17_ffn_gate
	RTX3090_1_layer_17_ffn_gate -> RTX3090_1_layer_17_ffn_down
	RTX3090_1_layer_17_ffn_down -> RTX3090_1_layer_17_ffn_res
	RTX3090_1_layer_17_norm1 -> RTX3090_1_layer_17_qkv_proj
	RTX3090_1_layer_17_norm2 -> RTX3090_1_layer_17_ffn_up
	RTX3090_1_layer_17_attn_res -> RTX3090_1_layer_17_norm2
	RTX3090_1_layer_18_qkv_proj -> RTX3090_1_layer_18_attn_calc
	RTX3090_1_layer_18_attn_calc -> RTX3090_1_layer_18_attn_out
	RTX3090_1_layer_18_attn_out -> RTX3090_1_layer_18_attn_res
	RTX3090_1_layer_18_ffn_up -> RTX3090_1_layer_18_ffn_gate
	RTX3090_1_layer_18_ffn_gate -> RTX3090_1_layer_18_ffn_down
	RTX3090_1_layer_18_ffn_down -> RTX3090_1_layer_18_ffn_res
	RTX3090_1_layer_18_norm1 -> RTX3090_1_layer_18_qkv_proj
	RTX3090_1_layer_18_norm2 -> RTX3090_1_layer_18_ffn_up
	RTX3090_1_layer_18_attn_res -> RTX3090_1_layer_18_norm2
	RTX3090_1_layer_19_qkv_proj -> RTX3090_1_layer_19_attn_calc
	RTX3090_1_layer_19_attn_calc -> RTX3090_1_layer_19_attn_out
	RTX3090_1_layer_19_attn_out -> RTX3090_1_layer_19_attn_res
	RTX3090_1_layer_19_ffn_up -> RTX3090_1_layer_19_ffn_gate
	RTX3090_1_layer_19_ffn_gate -> RTX3090_1_layer_19_ffn_down
	RTX3090_1_layer_19_ffn_down -> RTX3090_1_layer_19_ffn_res
	RTX3090_1_layer_19_norm1 -> RTX3090_1_layer_19_qkv_proj
	RTX3090_1_layer_19_norm2 -> RTX3090_1_layer_19_ffn_up
	RTX3090_1_layer_19_attn_res -> RTX3090_1_layer_19_norm2
	RTX3090_1_layer_20_qkv_proj -> RTX3090_1_layer_20_attn_calc
	RTX3090_1_layer_20_attn_calc -> RTX3090_1_layer_20_attn_out
	RTX3090_1_layer_20_attn_out -> RTX3090_1_layer_20_attn_res
	RTX3090_1_layer_20_ffn_up -> RTX3090_1_layer_20_ffn_gate
	RTX3090_1_layer_20_ffn_gate -> RTX3090_1_layer_20_ffn_down
	RTX3090_1_layer_20_ffn_down -> RTX3090_1_layer_20_ffn_res
	RTX3090_1_layer_20_norm1 -> RTX3090_1_layer_20_qkv_proj
	RTX3090_1_layer_20_norm2 -> RTX3090_1_layer_20_ffn_up
	RTX3090_1_layer_20_attn_res -> RTX3090_1_layer_20_norm2
	RTX3090_2_layer_21_qkv_proj -> RTX3090_2_layer_21_attn_calc
	RTX3090_2_layer_21_attn_calc -> RTX3090_2_layer_21_attn_out
	RTX3090_2_layer_21_attn_out -> RTX3090_2_layer_21_attn_res
	RTX3090_2_layer_21_ffn_up -> RTX3090_2_layer_21_ffn_gate
	RTX3090_2_layer_21_ffn_gate -> RTX3090_2_layer_21_ffn_down
	RTX3090_2_layer_21_ffn_down -> RTX3090_2_layer_21_ffn_res
	RTX3090_2_layer_21_norm1 -> RTX3090_2_layer_21_qkv_proj
	RTX3090_2_layer_21_norm2 -> RTX3090_2_layer_21_ffn_up
	RTX3090_2_layer_21_attn_res -> RTX3090_2_layer_21_norm2
	RTX3090_2_layer_22_qkv_proj -> RTX3090_2_layer_22_attn_calc
	RTX3090_2_layer_22_attn_calc -> RTX3090_2_layer_22_attn_out
	RTX3090_2_layer_22_attn_out -> RTX3090_2_layer_22_attn_res
	RTX3090_2_layer_22_ffn_up -> RTX3090_2_layer_22_ffn_gate
	RTX3090_2_layer_22_ffn_gate -> RTX3090_2_layer_22_ffn_down
	RTX3090_2_layer_22_ffn_down -> RTX3090_2_layer_22_ffn_res
	RTX3090_2_layer_22_norm1 -> RTX3090_2_layer_22_qkv_proj
	RTX3090_2_layer_22_norm2 -> RTX3090_2_layer_22_ffn_up
	RTX3090_2_layer_22_attn_res -> RTX3090_2_layer_22_norm2
	RTX3090_2_layer_23_qkv_proj -> RTX3090_2_layer_23_attn_calc
	RTX3090_2_layer_23_attn_calc -> RTX3090_2_layer_23_attn_out
	RTX3090_2_layer_23_attn_out -> RTX3090_2_layer_23_attn_res
	RTX3090_2_layer_23_ffn_up -> RTX3090_2_layer_23_ffn_gate
	RTX3090_2_layer_23_ffn_gate -> RTX3090_2_layer_23_ffn_down
	RTX3090_2_layer_23_ffn_down -> RTX3090_2_layer_23_ffn_res
	RTX3090_2_layer_23_norm1 -> RTX3090_2_layer_23_qkv_proj
	RTX3090_2_layer_23_norm2 -> RTX3090_2_layer_23_ffn_up
	RTX3090_2_layer_23_attn_res -> RTX3090_2_layer_23_norm2
	RTX3090_2_layer_24_qkv_proj -> RTX3090_2_layer_24_attn_calc
	RTX3090_2_layer_24_attn_calc -> RTX3090_2_layer_24_attn_out
	RTX3090_2_layer_24_attn_out -> RTX3090_2_layer_24_attn_res
	RTX3090_2_layer_24_ffn_up -> RTX3090_2_layer_24_ffn_gate
	RTX3090_2_layer_24_ffn_gate -> RTX3090_2_layer_24_ffn_down
	RTX3090_2_layer_24_ffn_down -> RTX3090_2_layer_24_ffn_res
	RTX3090_2_layer_24_norm1 -> RTX3090_2_layer_24_qkv_proj
	RTX3090_2_layer_24_norm2 -> RTX3090_2_layer_24_ffn_up
	RTX3090_2_layer_24_attn_res -> RTX3090_2_layer_24_norm2
	P100_1_layer_4_ffn_res -> comm_P100_1_to_P100_2
	comm_P100_1_to_P100_2 -> P100_2_layer_5_norm1
	P100_2_layer_8_ffn_res -> comm_P100_2_to_P100_3
	comm_P100_2_to_P100_3 -> P100_3_layer_9_norm1
	P100_3_layer_12_ffn_res -> comm_P100_3_to_P100_4
	comm_P100_3_to_P100_4 -> P100_4_layer_13_norm1
	P100_4_layer_16_ffn_res -> comm_P100_4_to_RTX3090_1
	comm_P100_4_to_RTX3090_1 -> RTX3090_1_layer_17_norm1
	RTX3090_1_layer_20_ffn_res -> comm_RTX3090_1_to_RTX3090_2
	comm_RTX3090_1_to_RTX3090_2 -> RTX3090_2_layer_21_norm1
	RTX3090_2_layer_24_ffn_res -> output_projection
	output_projection -> final_output
	{
		rank=same
		P100_1_layer_1_norm1
		P100_1_layer_1_norm2
		P100_1_layer_2_norm1
		P100_1_layer_2_norm2
		P100_1_layer_3_norm1
		P100_1_layer_3_norm2
		P100_1_layer_4_norm1
		P100_1_layer_4_norm2
	}
	{
		rank=same
		P100_2_layer_5_norm1
		P100_2_layer_5_norm2
		P100_2_layer_6_norm1
		P100_2_layer_6_norm2
		P100_2_layer_7_norm1
		P100_2_layer_7_norm2
		P100_2_layer_8_norm1
		P100_2_layer_8_norm2
	}
	{
		rank=same
		P100_3_layer_9_norm1
		P100_3_layer_9_norm2
		P100_3_layer_10_norm1
		P100_3_layer_10_norm2
		P100_3_layer_11_norm1
		P100_3_layer_11_norm2
		P100_3_layer_12_norm1
		P100_3_layer_12_norm2
	}
	{
		rank=same
		P100_4_layer_13_norm1
		P100_4_layer_13_norm2
		P100_4_layer_14_norm1
		P100_4_layer_14_norm2
		P100_4_layer_15_norm1
		P100_4_layer_15_norm2
		P100_4_layer_16_norm1
		P100_4_layer_16_norm2
	}
	{
		rank=same
		RTX3090_1_layer_17_norm1
		RTX3090_1_layer_17_norm2
		RTX3090_1_layer_18_norm1
		RTX3090_1_layer_18_norm2
		RTX3090_1_layer_19_norm1
		RTX3090_1_layer_19_norm2
		RTX3090_1_layer_20_norm1
		RTX3090_1_layer_20_norm2
	}
	{
		rank=same
		RTX3090_2_layer_21_norm1
		RTX3090_2_layer_21_norm2
		RTX3090_2_layer_22_norm1
		RTX3090_2_layer_22_norm2
		RTX3090_2_layer_23_norm1
		RTX3090_2_layer_23_norm2
		RTX3090_2_layer_24_norm1
		RTX3090_2_layer_24_norm2
	}
}
