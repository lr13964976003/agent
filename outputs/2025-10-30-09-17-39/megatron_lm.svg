<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Megatron_LM Pages: 1 -->
<svg width="31110pt" height="4899pt"
 viewBox="0.00 0.00 31110.00 4898.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4894.7)">
<title>Megatron_LM</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4894.7 31106,-4894.7 31106,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_LLaMA_7B</title>
<path fill="lightyellow" stroke="black" d="M20,-130.17C20,-130.17 17286,-130.17 17286,-130.17 17292,-130.17 17298,-136.17 17298,-142.17 17298,-142.17 17298,-4870.7 17298,-4870.7 17298,-4876.7 17292,-4882.7 17286,-4882.7 17286,-4882.7 20,-4882.7 20,-4882.7 14,-4882.7 8,-4876.7 8,-4870.7 8,-4870.7 8,-142.17 8,-142.17 8,-136.17 14,-130.17 20,-130.17"/>
<text text-anchor="middle" x="8653" y="-4867.5" font-family="Times,serif" font-size="14.00">LLaMA_7B Megatron&#45;LM</text>
<text text-anchor="middle" x="8653" y="-4852.5" font-family="Times,serif" font-size="14.00">Tensor×2 Pipeline×3</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_LLaMA_7B_stage_1</title>
<path fill="lightblue" stroke="black" d="M468,-3322C468,-3322 17278,-3322 17278,-3322 17284,-3322 17290,-3328 17290,-3334 17290,-3334 17290,-4762.96 17290,-4762.96 17290,-4768.96 17284,-4774.96 17278,-4774.96 17278,-4774.96 468,-4774.96 468,-4774.96 462,-4774.96 456,-4768.96 456,-4762.96 456,-4762.96 456,-3334 456,-3334 456,-3328 462,-3322 468,-3322"/>
<text text-anchor="middle" x="8873" y="-4759.76" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="8873" y="-4744.76" font-family="Times,serif" font-size="14.00">Layers 1&#45;10</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_LLaMA_7B_stage_1_rank_1</title>
<path fill="lightgreen" stroke="black" d="M8889,-3330C8889,-3330 17270,-3330 17270,-3330 17276,-3330 17282,-3336 17282,-3342 17282,-3342 17282,-4716.96 17282,-4716.96 17282,-4722.96 17276,-4728.96 17270,-4728.96 17270,-4728.96 8889,-4728.96 8889,-4728.96 8883,-4728.96 8877,-4722.96 8877,-4716.96 8877,-4716.96 8877,-3342 8877,-3342 8877,-3336 8883,-3330 8889,-3330"/>
<text text-anchor="middle" x="13079.5" y="-4713.76" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="13079.5" y="-4698.76" font-family="Times,serif" font-size="14.00">GPU_1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_LLaMA_7B_stage_1_rank_2</title>
<path fill="lightgreen" stroke="black" d="M476,-3330C476,-3330 8857,-3330 8857,-3330 8863,-3330 8869,-3336 8869,-3342 8869,-3342 8869,-4716.96 8869,-4716.96 8869,-4722.96 8863,-4728.96 8857,-4728.96 8857,-4728.96 476,-4728.96 476,-4728.96 470,-4728.96 464,-4722.96 464,-4716.96 464,-4716.96 464,-3342 464,-3342 464,-3336 470,-3330 476,-3330"/>
<text text-anchor="middle" x="4666.5" y="-4713.76" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="4666.5" y="-4698.76" font-family="Times,serif" font-size="14.00">GPU_2</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_LLaMA_7B_stage_2</title>
<path fill="lightblue" stroke="black" d="M248,-1730.08C248,-1730.08 17058,-1730.08 17058,-1730.08 17064,-1730.08 17070,-1736.08 17070,-1742.08 17070,-1742.08 17070,-3171.04 17070,-3171.04 17070,-3177.04 17064,-3183.04 17058,-3183.04 17058,-3183.04 248,-3183.04 248,-3183.04 242,-3183.04 236,-3177.04 236,-3171.04 236,-3171.04 236,-1742.08 236,-1742.08 236,-1736.08 242,-1730.08 248,-1730.08"/>
<text text-anchor="middle" x="8653" y="-3167.84" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="8653" y="-3152.84" font-family="Times,serif" font-size="14.00">Layers 11&#45;20</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_LLaMA_7B_stage_2_rank_1</title>
<path fill="lightgreen" stroke="black" d="M8669,-1738.08C8669,-1738.08 17050,-1738.08 17050,-1738.08 17056,-1738.08 17062,-1744.08 17062,-1750.08 17062,-1750.08 17062,-3125.04 17062,-3125.04 17062,-3131.04 17056,-3137.04 17050,-3137.04 17050,-3137.04 8669,-3137.04 8669,-3137.04 8663,-3137.04 8657,-3131.04 8657,-3125.04 8657,-3125.04 8657,-1750.08 8657,-1750.08 8657,-1744.08 8663,-1738.08 8669,-1738.08"/>
<text text-anchor="middle" x="12859.5" y="-3121.84" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="12859.5" y="-3106.84" font-family="Times,serif" font-size="14.00">GPU_3</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_LLaMA_7B_stage_2_rank_2</title>
<path fill="lightgreen" stroke="black" d="M256,-1738.08C256,-1738.08 8637,-1738.08 8637,-1738.08 8643,-1738.08 8649,-1744.08 8649,-1750.08 8649,-1750.08 8649,-3125.04 8649,-3125.04 8649,-3131.04 8643,-3137.04 8637,-3137.04 8637,-3137.04 256,-3137.04 256,-3137.04 250,-3137.04 244,-3131.04 244,-3125.04 244,-3125.04 244,-1750.08 244,-1750.08 244,-1744.08 250,-1738.08 256,-1738.08"/>
<text text-anchor="middle" x="4446.5" y="-3121.84" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="4446.5" y="-3106.84" font-family="Times,serif" font-size="14.00">GPU_4</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_LLaMA_7B_stage_3</title>
<path fill="lightblue" stroke="black" d="M248,-138.17C248,-138.17 17058,-138.17 17058,-138.17 17064,-138.17 17070,-144.17 17070,-150.17 17070,-150.17 17070,-1579.13 17070,-1579.13 17070,-1585.13 17064,-1591.13 17058,-1591.13 17058,-1591.13 248,-1591.13 248,-1591.13 242,-1591.13 236,-1585.13 236,-1579.13 236,-1579.13 236,-150.17 236,-150.17 236,-144.17 242,-138.17 248,-138.17"/>
<text text-anchor="middle" x="8653" y="-1575.93" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="8653" y="-1560.93" font-family="Times,serif" font-size="14.00">Layers 21&#45;30</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_LLaMA_7B_stage_3_rank_1</title>
<path fill="lightgreen" stroke="black" d="M8669,-146.17C8669,-146.17 17050,-146.17 17050,-146.17 17056,-146.17 17062,-152.17 17062,-158.17 17062,-158.17 17062,-1533.13 17062,-1533.13 17062,-1539.13 17056,-1545.13 17050,-1545.13 17050,-1545.13 8669,-1545.13 8669,-1545.13 8663,-1545.13 8657,-1539.13 8657,-1533.13 8657,-1533.13 8657,-158.17 8657,-158.17 8657,-152.17 8663,-146.17 8669,-146.17"/>
<text text-anchor="middle" x="12859.5" y="-1529.93" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="12859.5" y="-1514.93" font-family="Times,serif" font-size="14.00">GPU_5</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_LLaMA_7B_stage_3_rank_2</title>
<path fill="lightgreen" stroke="black" d="M256,-146.17C256,-146.17 8637,-146.17 8637,-146.17 8643,-146.17 8649,-152.17 8649,-158.17 8649,-158.17 8649,-1533.13 8649,-1533.13 8649,-1539.13 8643,-1545.13 8637,-1545.13 8637,-1545.13 256,-1545.13 256,-1545.13 250,-1545.13 244,-1539.13 244,-1533.13 244,-1533.13 244,-158.17 244,-158.17 244,-152.17 250,-146.17 256,-146.17"/>
<text text-anchor="middle" x="4446.5" y="-1529.93" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="4446.5" y="-1514.93" font-family="Times,serif" font-size="14.00">GPU_6</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_GPT3_2B</title>
<path fill="lightyellow" stroke="black" d="M17318,-8C17318,-8 31082,-8 31082,-8 31088,-8 31094,-14 31094,-20 31094,-20 31094,-4870.7 31094,-4870.7 31094,-4876.7 31088,-4882.7 31082,-4882.7 31082,-4882.7 17318,-4882.7 17318,-4882.7 17312,-4882.7 17306,-4876.7 17306,-4870.7 17306,-4870.7 17306,-20 17306,-20 17306,-14 17312,-8 17318,-8"/>
<text text-anchor="middle" x="24200" y="-4867.5" font-family="Times,serif" font-size="14.00">GPT3_2B Megatron&#45;LM</text>
<text text-anchor="middle" x="24200" y="-4852.5" font-family="Times,serif" font-size="14.00">Tensor×2 Pipeline×3</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_GPT3_2B_stage_1</title>
<path fill="lightblue" stroke="black" d="M17326,-3322C17326,-3322 31074,-3322 31074,-3322 31080,-3322 31086,-3328 31086,-3334 31086,-3334 31086,-4762.96 31086,-4762.96 31086,-4768.96 31080,-4774.96 31074,-4774.96 31074,-4774.96 17326,-4774.96 17326,-4774.96 17320,-4774.96 17314,-4768.96 17314,-4762.96 17314,-4762.96 17314,-3334 17314,-3334 17314,-3328 17320,-3322 17326,-3322"/>
<text text-anchor="middle" x="24200" y="-4759.76" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="24200" y="-4744.76" font-family="Times,serif" font-size="14.00">Layers 1&#45;8</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_GPT3_2B_stage_1_rank_1</title>
<path fill="lightgreen" stroke="black" d="M24216,-3330C24216,-3330 31066,-3330 31066,-3330 31072,-3330 31078,-3336 31078,-3342 31078,-3342 31078,-4716.96 31078,-4716.96 31078,-4722.96 31072,-4728.96 31066,-4728.96 31066,-4728.96 24216,-4728.96 24216,-4728.96 24210,-4728.96 24204,-4722.96 24204,-4716.96 24204,-4716.96 24204,-3342 24204,-3342 24204,-3336 24210,-3330 24216,-3330"/>
<text text-anchor="middle" x="27641" y="-4713.76" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="27641" y="-4698.76" font-family="Times,serif" font-size="14.00">GPU_1</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_GPT3_2B_stage_1_rank_2</title>
<path fill="lightgreen" stroke="black" d="M17334,-3330C17334,-3330 24184,-3330 24184,-3330 24190,-3330 24196,-3336 24196,-3342 24196,-3342 24196,-4716.96 24196,-4716.96 24196,-4722.96 24190,-4728.96 24184,-4728.96 24184,-4728.96 17334,-4728.96 17334,-4728.96 17328,-4728.96 17322,-4722.96 17322,-4716.96 17322,-4716.96 17322,-3342 17322,-3342 17322,-3336 17328,-3330 17334,-3330"/>
<text text-anchor="middle" x="20759" y="-4713.76" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="20759" y="-4698.76" font-family="Times,serif" font-size="14.00">GPU_2</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_GPT3_2B_stage_2</title>
<path fill="lightblue" stroke="black" d="M17326,-1730.08C17326,-1730.08 31074,-1730.08 31074,-1730.08 31080,-1730.08 31086,-1736.08 31086,-1742.08 31086,-1742.08 31086,-3171.04 31086,-3171.04 31086,-3177.04 31080,-3183.04 31074,-3183.04 31074,-3183.04 17326,-3183.04 17326,-3183.04 17320,-3183.04 17314,-3177.04 17314,-3171.04 17314,-3171.04 17314,-1742.08 17314,-1742.08 17314,-1736.08 17320,-1730.08 17326,-1730.08"/>
<text text-anchor="middle" x="24200" y="-3167.84" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="24200" y="-3152.84" font-family="Times,serif" font-size="14.00">Layers 9&#45;16</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_GPT3_2B_stage_2_rank_1</title>
<path fill="lightgreen" stroke="black" d="M24216,-1738.08C24216,-1738.08 31066,-1738.08 31066,-1738.08 31072,-1738.08 31078,-1744.08 31078,-1750.08 31078,-1750.08 31078,-3125.04 31078,-3125.04 31078,-3131.04 31072,-3137.04 31066,-3137.04 31066,-3137.04 24216,-3137.04 24216,-3137.04 24210,-3137.04 24204,-3131.04 24204,-3125.04 24204,-3125.04 24204,-1750.08 24204,-1750.08 24204,-1744.08 24210,-1738.08 24216,-1738.08"/>
<text text-anchor="middle" x="27641" y="-3121.84" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="27641" y="-3106.84" font-family="Times,serif" font-size="14.00">GPU_3</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_GPT3_2B_stage_2_rank_2</title>
<path fill="lightgreen" stroke="black" d="M17334,-1738.08C17334,-1738.08 24184,-1738.08 24184,-1738.08 24190,-1738.08 24196,-1744.08 24196,-1750.08 24196,-1750.08 24196,-3125.04 24196,-3125.04 24196,-3131.04 24190,-3137.04 24184,-3137.04 24184,-3137.04 17334,-3137.04 17334,-3137.04 17328,-3137.04 17322,-3131.04 17322,-3125.04 17322,-3125.04 17322,-1750.08 17322,-1750.08 17322,-1744.08 17328,-1738.08 17334,-1738.08"/>
<text text-anchor="middle" x="20759" y="-3121.84" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="20759" y="-3106.84" font-family="Times,serif" font-size="14.00">GPU_4</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_GPT3_2B_stage_3</title>
<path fill="lightblue" stroke="black" d="M17326,-138.17C17326,-138.17 31074,-138.17 31074,-138.17 31080,-138.17 31086,-144.17 31086,-150.17 31086,-150.17 31086,-1579.13 31086,-1579.13 31086,-1585.13 31080,-1591.13 31074,-1591.13 31074,-1591.13 17326,-1591.13 17326,-1591.13 17320,-1591.13 17314,-1585.13 17314,-1579.13 17314,-1579.13 17314,-150.17 17314,-150.17 17314,-144.17 17320,-138.17 17326,-138.17"/>
<text text-anchor="middle" x="24200" y="-1575.93" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="24200" y="-1560.93" font-family="Times,serif" font-size="14.00">Layers 17&#45;24</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_GPT3_2B_stage_3_rank_1</title>
<path fill="lightgreen" stroke="black" d="M24216,-146.17C24216,-146.17 31066,-146.17 31066,-146.17 31072,-146.17 31078,-152.17 31078,-158.17 31078,-158.17 31078,-1533.13 31078,-1533.13 31078,-1539.13 31072,-1545.13 31066,-1545.13 31066,-1545.13 24216,-1545.13 24216,-1545.13 24210,-1545.13 24204,-1539.13 24204,-1533.13 24204,-1533.13 24204,-158.17 24204,-158.17 24204,-152.17 24210,-146.17 24216,-146.17"/>
<text text-anchor="middle" x="27641" y="-1529.93" font-family="Times,serif" font-size="14.00">Rank 1</text>
<text text-anchor="middle" x="27641" y="-1514.93" font-family="Times,serif" font-size="14.00">GPU_5</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_GPT3_2B_stage_3_rank_2</title>
<path fill="lightgreen" stroke="black" d="M17334,-146.17C17334,-146.17 24184,-146.17 24184,-146.17 24190,-146.17 24196,-152.17 24196,-158.17 24196,-158.17 24196,-1533.13 24196,-1533.13 24196,-1539.13 24190,-1545.13 24184,-1545.13 24184,-1545.13 17334,-1545.13 17334,-1545.13 17328,-1545.13 17322,-1539.13 17322,-1533.13 17322,-1533.13 17322,-158.17 17322,-158.17 17322,-152.17 17328,-146.17 17334,-146.17"/>
<text text-anchor="middle" x="20759" y="-1529.93" font-family="Times,serif" font-size="14.00">Rank 2</text>
<text text-anchor="middle" x="20759" y="-1514.93" font-family="Times,serif" font-size="14.00">GPU_6</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_split -->
<g id="node1" class="node">
<title>LLaMA_7B_S1_R1_L1_split</title>
<polygon fill="orange" stroke="black" points="17273.53,-4682.96 16622.06,-4682.96 16454.47,-4606.96 17105.94,-4606.96 17273.53,-4682.96"/>
<text text-anchor="middle" x="16864" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="16864" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_norm1 -->
<g id="node2" class="node">
<title>LLaMA_7B_S1_R1_L1_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="16864" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16864" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16864" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_split&#45;&gt;LLaMA_7B_S1_R1_L1_norm1 -->
<g id="edge1" class="edge">
<title>LLaMA_7B_S1_R1_L1_split&#45;&gt;LLaMA_7B_S1_R1_L1_norm1</title>
<path fill="none" stroke="black" d="M16864,-4606.75C16864,-4587.54 16864,-4564.2 16864,-4545.16"/>
<polygon fill="black" stroke="black" points="16867.5,-4545.07 16864,-4535.07 16860.5,-4545.07 16867.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_qkv -->
<g id="node3" class="node">
<title>LLaMA_7B_S1_R1_L1_qkv</title>
<polygon fill="lightcoral" stroke="black" points="17010.5,-4409.22 16717.5,-4409.22 16717.5,-4371.22 17010.5,-4371.22 17010.5,-4409.22"/>
<text text-anchor="middle" x="16864" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="16864" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_norm1&#45;&gt;LLaMA_7B_S1_R1_L1_qkv -->
<g id="edge2" class="edge">
<title>LLaMA_7B_S1_R1_L1_norm1&#45;&gt;LLaMA_7B_S1_R1_L1_qkv</title>
<path fill="none" stroke="black" d="M16864,-4481.08C16864,-4462.81 16864,-4438.39 16864,-4419.61"/>
<polygon fill="black" stroke="black" points="16867.5,-4419.57 16864,-4409.57 16860.5,-4419.57 16867.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_attn -->
<g id="node4" class="node">
<title>LLaMA_7B_S1_R1_L1_attn</title>
<polygon fill="lightcoral" stroke="black" points="17010.5,-4299.22 16717.5,-4299.22 16717.5,-4261.22 17010.5,-4261.22 17010.5,-4299.22"/>
<text text-anchor="middle" x="16864" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="16864" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_qkv&#45;&gt;LLaMA_7B_S1_R1_L1_attn -->
<g id="edge3" class="edge">
<title>LLaMA_7B_S1_R1_L1_qkv&#45;&gt;LLaMA_7B_S1_R1_L1_attn</title>
<path fill="none" stroke="black" d="M16864,-4370.9C16864,-4354.04 16864,-4328.78 16864,-4309.36"/>
<polygon fill="black" stroke="black" points="16867.5,-4309.27 16864,-4299.27 16860.5,-4309.27 16867.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_ar1 -->
<g id="node5" class="node">
<title>LLaMA_7B_S1_R1_L1_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16864" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16864" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16864" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_attn&#45;&gt;LLaMA_7B_S1_R1_L1_ar1 -->
<g id="edge4" class="edge">
<title>LLaMA_7B_S1_R1_L1_attn&#45;&gt;LLaMA_7B_S1_R1_L1_ar1</title>
<path fill="none" stroke="black" d="M16864,-4261.11C16864,-4244.74 16864,-4220.15 16864,-4199.73"/>
<polygon fill="black" stroke="black" points="16867.5,-4199.49 16864,-4189.49 16860.5,-4199.49 16867.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_res1 -->
<g id="node6" class="node">
<title>LLaMA_7B_S1_R1_L1_res1</title>
<polygon fill="lightyellow" stroke="black" points="16951.84,-4063.48 16812.11,-4063.48 16776.16,-4027.48 16915.89,-4027.48 16951.84,-4063.48"/>
<text text-anchor="middle" x="16864" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_ar1&#45;&gt;LLaMA_7B_S1_R1_L1_res1 -->
<g id="edge5" class="edge">
<title>LLaMA_7B_S1_R1_L1_ar1&#45;&gt;LLaMA_7B_S1_R1_L1_res1</title>
<path fill="none" stroke="black" d="M16864,-4135.28C16864,-4116.91 16864,-4092.36 16864,-4073.73"/>
<polygon fill="black" stroke="black" points="16867.5,-4073.54 16864,-4063.54 16860.5,-4073.54 16867.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_norm2 -->
<g id="node7" class="node">
<title>LLaMA_7B_S1_R1_L1_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="16864" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16864" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="16864" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_res1&#45;&gt;LLaMA_7B_S1_R1_L1_norm2 -->
<g id="edge6" class="edge">
<title>LLaMA_7B_S1_R1_L1_res1&#45;&gt;LLaMA_7B_S1_R1_L1_norm2</title>
<path fill="none" stroke="black" d="M16864,-4027.03C16864,-4010.89 16864,-3986.38 16864,-3965.99"/>
<polygon fill="black" stroke="black" points="16867.5,-3965.76 16864,-3955.76 16860.5,-3965.76 16867.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_up -->
<g id="node8" class="node">
<title>LLaMA_7B_S1_R1_L1_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="16970.5,-3829.74 16757.5,-3829.74 16757.5,-3791.74 16970.5,-3791.74 16970.5,-3829.74"/>
<text text-anchor="middle" x="16864" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16864" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_norm2&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_up -->
<g id="edge7" class="edge">
<title>LLaMA_7B_S1_R1_L1_norm2&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_up</title>
<path fill="none" stroke="black" d="M16864,-3901.6C16864,-3883.33 16864,-3858.91 16864,-3840.13"/>
<polygon fill="black" stroke="black" points="16867.5,-3840.09 16864,-3830.09 16860.5,-3840.09 16867.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_gate -->
<g id="node9" class="node">
<title>LLaMA_7B_S1_R1_L1_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="16970.5,-3719.74 16757.5,-3719.74 16757.5,-3681.74 16970.5,-3681.74 16970.5,-3719.74"/>
<text text-anchor="middle" x="16864" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16864" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_gate -->
<g id="edge8" class="edge">
<title>LLaMA_7B_S1_R1_L1_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_gate</title>
<path fill="none" stroke="black" d="M16864,-3791.41C16864,-3774.56 16864,-3749.3 16864,-3729.88"/>
<polygon fill="black" stroke="black" points="16867.5,-3729.79 16864,-3719.79 16860.5,-3729.79 16867.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_down -->
<g id="node10" class="node">
<title>LLaMA_7B_S1_R1_L1_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="16970.5,-3609.74 16757.5,-3609.74 16757.5,-3571.74 16970.5,-3571.74 16970.5,-3609.74"/>
<text text-anchor="middle" x="16864" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16864" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_down -->
<g id="edge9" class="edge">
<title>LLaMA_7B_S1_R1_L1_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L1_ffn_down</title>
<path fill="none" stroke="black" d="M16864,-3681.41C16864,-3664.56 16864,-3639.3 16864,-3619.88"/>
<polygon fill="black" stroke="black" points="16867.5,-3619.79 16864,-3609.79 16860.5,-3619.79 16867.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_ar2 -->
<g id="node11" class="node">
<title>LLaMA_7B_S1_R1_L1_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16864" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16864" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="16864" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L1_ar2 -->
<g id="edge10" class="edge">
<title>LLaMA_7B_S1_R1_L1_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L1_ar2</title>
<path fill="none" stroke="black" d="M16864,-3571.63C16864,-3555.26 16864,-3530.67 16864,-3510.25"/>
<polygon fill="black" stroke="black" points="16867.5,-3510.01 16864,-3500.01 16860.5,-3510.01 16867.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L1_res2 -->
<g id="node12" class="node">
<title>LLaMA_7B_S1_R1_L1_res2</title>
<polygon fill="lightyellow" stroke="black" points="16951.84,-3374 16812.11,-3374 16776.16,-3338 16915.89,-3338 16951.84,-3374"/>
<text text-anchor="middle" x="16864" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L1_ar2&#45;&gt;LLaMA_7B_S1_R1_L1_res2 -->
<g id="edge11" class="edge">
<title>LLaMA_7B_S1_R1_L1_ar2&#45;&gt;LLaMA_7B_S1_R1_L1_res2</title>
<path fill="none" stroke="black" d="M16864,-3445.8C16864,-3427.43 16864,-3402.88 16864,-3384.25"/>
<polygon fill="black" stroke="black" points="16867.5,-3384.06 16864,-3374.06 16860.5,-3384.06 16867.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_split -->
<g id="node13" class="node">
<title>LLaMA_7B_S1_R1_L2_split</title>
<polygon fill="orange" stroke="black" points="16432.53,-4682.96 15781.06,-4682.96 15613.47,-4606.96 16264.94,-4606.96 16432.53,-4682.96"/>
<text text-anchor="middle" x="16023" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="16023" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_norm1 -->
<g id="node14" class="node">
<title>LLaMA_7B_S1_R1_L2_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="16023" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16023" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16023" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_split&#45;&gt;LLaMA_7B_S1_R1_L2_norm1 -->
<g id="edge12" class="edge">
<title>LLaMA_7B_S1_R1_L2_split&#45;&gt;LLaMA_7B_S1_R1_L2_norm1</title>
<path fill="none" stroke="black" d="M16023,-4606.75C16023,-4587.54 16023,-4564.2 16023,-4545.16"/>
<polygon fill="black" stroke="black" points="16026.5,-4545.07 16023,-4535.07 16019.5,-4545.07 16026.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_qkv -->
<g id="node15" class="node">
<title>LLaMA_7B_S1_R1_L2_qkv</title>
<polygon fill="lightcoral" stroke="black" points="16169.5,-4409.22 15876.5,-4409.22 15876.5,-4371.22 16169.5,-4371.22 16169.5,-4409.22"/>
<text text-anchor="middle" x="16023" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="16023" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_norm1&#45;&gt;LLaMA_7B_S1_R1_L2_qkv -->
<g id="edge13" class="edge">
<title>LLaMA_7B_S1_R1_L2_norm1&#45;&gt;LLaMA_7B_S1_R1_L2_qkv</title>
<path fill="none" stroke="black" d="M16023,-4481.08C16023,-4462.81 16023,-4438.39 16023,-4419.61"/>
<polygon fill="black" stroke="black" points="16026.5,-4419.57 16023,-4409.57 16019.5,-4419.57 16026.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_attn -->
<g id="node16" class="node">
<title>LLaMA_7B_S1_R1_L2_attn</title>
<polygon fill="lightcoral" stroke="black" points="16169.5,-4299.22 15876.5,-4299.22 15876.5,-4261.22 16169.5,-4261.22 16169.5,-4299.22"/>
<text text-anchor="middle" x="16023" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="16023" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_qkv&#45;&gt;LLaMA_7B_S1_R1_L2_attn -->
<g id="edge14" class="edge">
<title>LLaMA_7B_S1_R1_L2_qkv&#45;&gt;LLaMA_7B_S1_R1_L2_attn</title>
<path fill="none" stroke="black" d="M16023,-4370.9C16023,-4354.04 16023,-4328.78 16023,-4309.36"/>
<polygon fill="black" stroke="black" points="16026.5,-4309.27 16023,-4299.27 16019.5,-4309.27 16026.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_ar1 -->
<g id="node17" class="node">
<title>LLaMA_7B_S1_R1_L2_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16023" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16023" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16023" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_attn&#45;&gt;LLaMA_7B_S1_R1_L2_ar1 -->
<g id="edge15" class="edge">
<title>LLaMA_7B_S1_R1_L2_attn&#45;&gt;LLaMA_7B_S1_R1_L2_ar1</title>
<path fill="none" stroke="black" d="M16023,-4261.11C16023,-4244.74 16023,-4220.15 16023,-4199.73"/>
<polygon fill="black" stroke="black" points="16026.5,-4199.49 16023,-4189.49 16019.5,-4199.49 16026.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_res1 -->
<g id="node18" class="node">
<title>LLaMA_7B_S1_R1_L2_res1</title>
<polygon fill="lightyellow" stroke="black" points="16110.84,-4063.48 15971.11,-4063.48 15935.16,-4027.48 16074.89,-4027.48 16110.84,-4063.48"/>
<text text-anchor="middle" x="16023" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_ar1&#45;&gt;LLaMA_7B_S1_R1_L2_res1 -->
<g id="edge16" class="edge">
<title>LLaMA_7B_S1_R1_L2_ar1&#45;&gt;LLaMA_7B_S1_R1_L2_res1</title>
<path fill="none" stroke="black" d="M16023,-4135.28C16023,-4116.91 16023,-4092.36 16023,-4073.73"/>
<polygon fill="black" stroke="black" points="16026.5,-4073.54 16023,-4063.54 16019.5,-4073.54 16026.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_norm2 -->
<g id="node19" class="node">
<title>LLaMA_7B_S1_R1_L2_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="16023" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16023" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="16023" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_res1&#45;&gt;LLaMA_7B_S1_R1_L2_norm2 -->
<g id="edge17" class="edge">
<title>LLaMA_7B_S1_R1_L2_res1&#45;&gt;LLaMA_7B_S1_R1_L2_norm2</title>
<path fill="none" stroke="black" d="M16023,-4027.03C16023,-4010.89 16023,-3986.38 16023,-3965.99"/>
<polygon fill="black" stroke="black" points="16026.5,-3965.76 16023,-3955.76 16019.5,-3965.76 16026.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_up -->
<g id="node20" class="node">
<title>LLaMA_7B_S1_R1_L2_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="16129.5,-3829.74 15916.5,-3829.74 15916.5,-3791.74 16129.5,-3791.74 16129.5,-3829.74"/>
<text text-anchor="middle" x="16023" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16023" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_norm2&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_up -->
<g id="edge18" class="edge">
<title>LLaMA_7B_S1_R1_L2_norm2&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_up</title>
<path fill="none" stroke="black" d="M16023,-3901.6C16023,-3883.33 16023,-3858.91 16023,-3840.13"/>
<polygon fill="black" stroke="black" points="16026.5,-3840.09 16023,-3830.09 16019.5,-3840.09 16026.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_gate -->
<g id="node21" class="node">
<title>LLaMA_7B_S1_R1_L2_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="16129.5,-3719.74 15916.5,-3719.74 15916.5,-3681.74 16129.5,-3681.74 16129.5,-3719.74"/>
<text text-anchor="middle" x="16023" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16023" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_gate -->
<g id="edge19" class="edge">
<title>LLaMA_7B_S1_R1_L2_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_gate</title>
<path fill="none" stroke="black" d="M16023,-3791.41C16023,-3774.56 16023,-3749.3 16023,-3729.88"/>
<polygon fill="black" stroke="black" points="16026.5,-3729.79 16023,-3719.79 16019.5,-3729.79 16026.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_down -->
<g id="node22" class="node">
<title>LLaMA_7B_S1_R1_L2_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="16129.5,-3609.74 15916.5,-3609.74 15916.5,-3571.74 16129.5,-3571.74 16129.5,-3609.74"/>
<text text-anchor="middle" x="16023" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16023" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_down -->
<g id="edge20" class="edge">
<title>LLaMA_7B_S1_R1_L2_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L2_ffn_down</title>
<path fill="none" stroke="black" d="M16023,-3681.41C16023,-3664.56 16023,-3639.3 16023,-3619.88"/>
<polygon fill="black" stroke="black" points="16026.5,-3619.79 16023,-3609.79 16019.5,-3619.79 16026.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_ar2 -->
<g id="node23" class="node">
<title>LLaMA_7B_S1_R1_L2_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16023" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16023" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="16023" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L2_ar2 -->
<g id="edge21" class="edge">
<title>LLaMA_7B_S1_R1_L2_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L2_ar2</title>
<path fill="none" stroke="black" d="M16023,-3571.63C16023,-3555.26 16023,-3530.67 16023,-3510.25"/>
<polygon fill="black" stroke="black" points="16026.5,-3510.01 16023,-3500.01 16019.5,-3510.01 16026.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L2_res2 -->
<g id="node24" class="node">
<title>LLaMA_7B_S1_R1_L2_res2</title>
<polygon fill="lightyellow" stroke="black" points="16110.84,-3374 15971.11,-3374 15935.16,-3338 16074.89,-3338 16110.84,-3374"/>
<text text-anchor="middle" x="16023" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L2_ar2&#45;&gt;LLaMA_7B_S1_R1_L2_res2 -->
<g id="edge22" class="edge">
<title>LLaMA_7B_S1_R1_L2_ar2&#45;&gt;LLaMA_7B_S1_R1_L2_res2</title>
<path fill="none" stroke="black" d="M16023,-3445.8C16023,-3427.43 16023,-3402.88 16023,-3384.25"/>
<polygon fill="black" stroke="black" points="16026.5,-3384.06 16023,-3374.06 16019.5,-3384.06 16026.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_split -->
<g id="node25" class="node">
<title>LLaMA_7B_S1_R1_L3_split</title>
<polygon fill="orange" stroke="black" points="15591.53,-4682.96 14940.06,-4682.96 14772.47,-4606.96 15423.94,-4606.96 15591.53,-4682.96"/>
<text text-anchor="middle" x="15182" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="15182" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_norm1 -->
<g id="node26" class="node">
<title>LLaMA_7B_S1_R1_L3_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="15182" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15182" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15182" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_split&#45;&gt;LLaMA_7B_S1_R1_L3_norm1 -->
<g id="edge23" class="edge">
<title>LLaMA_7B_S1_R1_L3_split&#45;&gt;LLaMA_7B_S1_R1_L3_norm1</title>
<path fill="none" stroke="black" d="M15182,-4606.75C15182,-4587.54 15182,-4564.2 15182,-4545.16"/>
<polygon fill="black" stroke="black" points="15185.5,-4545.07 15182,-4535.07 15178.5,-4545.07 15185.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_qkv -->
<g id="node27" class="node">
<title>LLaMA_7B_S1_R1_L3_qkv</title>
<polygon fill="lightcoral" stroke="black" points="15328.5,-4409.22 15035.5,-4409.22 15035.5,-4371.22 15328.5,-4371.22 15328.5,-4409.22"/>
<text text-anchor="middle" x="15182" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="15182" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_norm1&#45;&gt;LLaMA_7B_S1_R1_L3_qkv -->
<g id="edge24" class="edge">
<title>LLaMA_7B_S1_R1_L3_norm1&#45;&gt;LLaMA_7B_S1_R1_L3_qkv</title>
<path fill="none" stroke="black" d="M15182,-4481.08C15182,-4462.81 15182,-4438.39 15182,-4419.61"/>
<polygon fill="black" stroke="black" points="15185.5,-4419.57 15182,-4409.57 15178.5,-4419.57 15185.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_attn -->
<g id="node28" class="node">
<title>LLaMA_7B_S1_R1_L3_attn</title>
<polygon fill="lightcoral" stroke="black" points="15328.5,-4299.22 15035.5,-4299.22 15035.5,-4261.22 15328.5,-4261.22 15328.5,-4299.22"/>
<text text-anchor="middle" x="15182" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="15182" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_qkv&#45;&gt;LLaMA_7B_S1_R1_L3_attn -->
<g id="edge25" class="edge">
<title>LLaMA_7B_S1_R1_L3_qkv&#45;&gt;LLaMA_7B_S1_R1_L3_attn</title>
<path fill="none" stroke="black" d="M15182,-4370.9C15182,-4354.04 15182,-4328.78 15182,-4309.36"/>
<polygon fill="black" stroke="black" points="15185.5,-4309.27 15182,-4299.27 15178.5,-4309.27 15185.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_ar1 -->
<g id="node29" class="node">
<title>LLaMA_7B_S1_R1_L3_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15182" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15182" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="15182" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_attn&#45;&gt;LLaMA_7B_S1_R1_L3_ar1 -->
<g id="edge26" class="edge">
<title>LLaMA_7B_S1_R1_L3_attn&#45;&gt;LLaMA_7B_S1_R1_L3_ar1</title>
<path fill="none" stroke="black" d="M15182,-4261.11C15182,-4244.74 15182,-4220.15 15182,-4199.73"/>
<polygon fill="black" stroke="black" points="15185.5,-4199.49 15182,-4189.49 15178.5,-4199.49 15185.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_res1 -->
<g id="node30" class="node">
<title>LLaMA_7B_S1_R1_L3_res1</title>
<polygon fill="lightyellow" stroke="black" points="15269.84,-4063.48 15130.11,-4063.48 15094.16,-4027.48 15233.89,-4027.48 15269.84,-4063.48"/>
<text text-anchor="middle" x="15182" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_ar1&#45;&gt;LLaMA_7B_S1_R1_L3_res1 -->
<g id="edge27" class="edge">
<title>LLaMA_7B_S1_R1_L3_ar1&#45;&gt;LLaMA_7B_S1_R1_L3_res1</title>
<path fill="none" stroke="black" d="M15182,-4135.28C15182,-4116.91 15182,-4092.36 15182,-4073.73"/>
<polygon fill="black" stroke="black" points="15185.5,-4073.54 15182,-4063.54 15178.5,-4073.54 15185.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_norm2 -->
<g id="node31" class="node">
<title>LLaMA_7B_S1_R1_L3_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="15182" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15182" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="15182" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_res1&#45;&gt;LLaMA_7B_S1_R1_L3_norm2 -->
<g id="edge28" class="edge">
<title>LLaMA_7B_S1_R1_L3_res1&#45;&gt;LLaMA_7B_S1_R1_L3_norm2</title>
<path fill="none" stroke="black" d="M15182,-4027.03C15182,-4010.89 15182,-3986.38 15182,-3965.99"/>
<polygon fill="black" stroke="black" points="15185.5,-3965.76 15182,-3955.76 15178.5,-3965.76 15185.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_up -->
<g id="node32" class="node">
<title>LLaMA_7B_S1_R1_L3_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="15288.5,-3829.74 15075.5,-3829.74 15075.5,-3791.74 15288.5,-3791.74 15288.5,-3829.74"/>
<text text-anchor="middle" x="15182" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15182" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_norm2&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_up -->
<g id="edge29" class="edge">
<title>LLaMA_7B_S1_R1_L3_norm2&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_up</title>
<path fill="none" stroke="black" d="M15182,-3901.6C15182,-3883.33 15182,-3858.91 15182,-3840.13"/>
<polygon fill="black" stroke="black" points="15185.5,-3840.09 15182,-3830.09 15178.5,-3840.09 15185.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_gate -->
<g id="node33" class="node">
<title>LLaMA_7B_S1_R1_L3_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="15288.5,-3719.74 15075.5,-3719.74 15075.5,-3681.74 15288.5,-3681.74 15288.5,-3719.74"/>
<text text-anchor="middle" x="15182" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15182" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_gate -->
<g id="edge30" class="edge">
<title>LLaMA_7B_S1_R1_L3_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_gate</title>
<path fill="none" stroke="black" d="M15182,-3791.41C15182,-3774.56 15182,-3749.3 15182,-3729.88"/>
<polygon fill="black" stroke="black" points="15185.5,-3729.79 15182,-3719.79 15178.5,-3729.79 15185.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_down -->
<g id="node34" class="node">
<title>LLaMA_7B_S1_R1_L3_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="15288.5,-3609.74 15075.5,-3609.74 15075.5,-3571.74 15288.5,-3571.74 15288.5,-3609.74"/>
<text text-anchor="middle" x="15182" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15182" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_down -->
<g id="edge31" class="edge">
<title>LLaMA_7B_S1_R1_L3_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L3_ffn_down</title>
<path fill="none" stroke="black" d="M15182,-3681.41C15182,-3664.56 15182,-3639.3 15182,-3619.88"/>
<polygon fill="black" stroke="black" points="15185.5,-3619.79 15182,-3609.79 15178.5,-3619.79 15185.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_ar2 -->
<g id="node35" class="node">
<title>LLaMA_7B_S1_R1_L3_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15182" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15182" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="15182" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L3_ar2 -->
<g id="edge32" class="edge">
<title>LLaMA_7B_S1_R1_L3_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L3_ar2</title>
<path fill="none" stroke="black" d="M15182,-3571.63C15182,-3555.26 15182,-3530.67 15182,-3510.25"/>
<polygon fill="black" stroke="black" points="15185.5,-3510.01 15182,-3500.01 15178.5,-3510.01 15185.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L3_res2 -->
<g id="node36" class="node">
<title>LLaMA_7B_S1_R1_L3_res2</title>
<polygon fill="lightyellow" stroke="black" points="15269.84,-3374 15130.11,-3374 15094.16,-3338 15233.89,-3338 15269.84,-3374"/>
<text text-anchor="middle" x="15182" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L3_ar2&#45;&gt;LLaMA_7B_S1_R1_L3_res2 -->
<g id="edge33" class="edge">
<title>LLaMA_7B_S1_R1_L3_ar2&#45;&gt;LLaMA_7B_S1_R1_L3_res2</title>
<path fill="none" stroke="black" d="M15182,-3445.8C15182,-3427.43 15182,-3402.88 15182,-3384.25"/>
<polygon fill="black" stroke="black" points="15185.5,-3384.06 15182,-3374.06 15178.5,-3384.06 15185.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_split -->
<g id="node37" class="node">
<title>LLaMA_7B_S1_R1_L4_split</title>
<polygon fill="orange" stroke="black" points="14750.53,-4682.96 14099.06,-4682.96 13931.47,-4606.96 14582.94,-4606.96 14750.53,-4682.96"/>
<text text-anchor="middle" x="14341" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="14341" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_norm1 -->
<g id="node38" class="node">
<title>LLaMA_7B_S1_R1_L4_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="14341" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14341" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14341" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_split&#45;&gt;LLaMA_7B_S1_R1_L4_norm1 -->
<g id="edge34" class="edge">
<title>LLaMA_7B_S1_R1_L4_split&#45;&gt;LLaMA_7B_S1_R1_L4_norm1</title>
<path fill="none" stroke="black" d="M14341,-4606.75C14341,-4587.54 14341,-4564.2 14341,-4545.16"/>
<polygon fill="black" stroke="black" points="14344.5,-4545.07 14341,-4535.07 14337.5,-4545.07 14344.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_qkv -->
<g id="node39" class="node">
<title>LLaMA_7B_S1_R1_L4_qkv</title>
<polygon fill="lightcoral" stroke="black" points="14487.5,-4409.22 14194.5,-4409.22 14194.5,-4371.22 14487.5,-4371.22 14487.5,-4409.22"/>
<text text-anchor="middle" x="14341" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="14341" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_norm1&#45;&gt;LLaMA_7B_S1_R1_L4_qkv -->
<g id="edge35" class="edge">
<title>LLaMA_7B_S1_R1_L4_norm1&#45;&gt;LLaMA_7B_S1_R1_L4_qkv</title>
<path fill="none" stroke="black" d="M14341,-4481.08C14341,-4462.81 14341,-4438.39 14341,-4419.61"/>
<polygon fill="black" stroke="black" points="14344.5,-4419.57 14341,-4409.57 14337.5,-4419.57 14344.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_attn -->
<g id="node40" class="node">
<title>LLaMA_7B_S1_R1_L4_attn</title>
<polygon fill="lightcoral" stroke="black" points="14487.5,-4299.22 14194.5,-4299.22 14194.5,-4261.22 14487.5,-4261.22 14487.5,-4299.22"/>
<text text-anchor="middle" x="14341" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="14341" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_qkv&#45;&gt;LLaMA_7B_S1_R1_L4_attn -->
<g id="edge36" class="edge">
<title>LLaMA_7B_S1_R1_L4_qkv&#45;&gt;LLaMA_7B_S1_R1_L4_attn</title>
<path fill="none" stroke="black" d="M14341,-4370.9C14341,-4354.04 14341,-4328.78 14341,-4309.36"/>
<polygon fill="black" stroke="black" points="14344.5,-4309.27 14341,-4299.27 14337.5,-4309.27 14344.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_ar1 -->
<g id="node41" class="node">
<title>LLaMA_7B_S1_R1_L4_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14341" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14341" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14341" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_attn&#45;&gt;LLaMA_7B_S1_R1_L4_ar1 -->
<g id="edge37" class="edge">
<title>LLaMA_7B_S1_R1_L4_attn&#45;&gt;LLaMA_7B_S1_R1_L4_ar1</title>
<path fill="none" stroke="black" d="M14341,-4261.11C14341,-4244.74 14341,-4220.15 14341,-4199.73"/>
<polygon fill="black" stroke="black" points="14344.5,-4199.49 14341,-4189.49 14337.5,-4199.49 14344.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_res1 -->
<g id="node42" class="node">
<title>LLaMA_7B_S1_R1_L4_res1</title>
<polygon fill="lightyellow" stroke="black" points="14428.84,-4063.48 14289.11,-4063.48 14253.16,-4027.48 14392.89,-4027.48 14428.84,-4063.48"/>
<text text-anchor="middle" x="14341" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_ar1&#45;&gt;LLaMA_7B_S1_R1_L4_res1 -->
<g id="edge38" class="edge">
<title>LLaMA_7B_S1_R1_L4_ar1&#45;&gt;LLaMA_7B_S1_R1_L4_res1</title>
<path fill="none" stroke="black" d="M14341,-4135.28C14341,-4116.91 14341,-4092.36 14341,-4073.73"/>
<polygon fill="black" stroke="black" points="14344.5,-4073.54 14341,-4063.54 14337.5,-4073.54 14344.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_norm2 -->
<g id="node43" class="node">
<title>LLaMA_7B_S1_R1_L4_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="14341" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14341" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="14341" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_res1&#45;&gt;LLaMA_7B_S1_R1_L4_norm2 -->
<g id="edge39" class="edge">
<title>LLaMA_7B_S1_R1_L4_res1&#45;&gt;LLaMA_7B_S1_R1_L4_norm2</title>
<path fill="none" stroke="black" d="M14341,-4027.03C14341,-4010.89 14341,-3986.38 14341,-3965.99"/>
<polygon fill="black" stroke="black" points="14344.5,-3965.76 14341,-3955.76 14337.5,-3965.76 14344.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_up -->
<g id="node44" class="node">
<title>LLaMA_7B_S1_R1_L4_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="14447.5,-3829.74 14234.5,-3829.74 14234.5,-3791.74 14447.5,-3791.74 14447.5,-3829.74"/>
<text text-anchor="middle" x="14341" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14341" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_norm2&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_up -->
<g id="edge40" class="edge">
<title>LLaMA_7B_S1_R1_L4_norm2&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_up</title>
<path fill="none" stroke="black" d="M14341,-3901.6C14341,-3883.33 14341,-3858.91 14341,-3840.13"/>
<polygon fill="black" stroke="black" points="14344.5,-3840.09 14341,-3830.09 14337.5,-3840.09 14344.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_gate -->
<g id="node45" class="node">
<title>LLaMA_7B_S1_R1_L4_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="14447.5,-3719.74 14234.5,-3719.74 14234.5,-3681.74 14447.5,-3681.74 14447.5,-3719.74"/>
<text text-anchor="middle" x="14341" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14341" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_gate -->
<g id="edge41" class="edge">
<title>LLaMA_7B_S1_R1_L4_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_gate</title>
<path fill="none" stroke="black" d="M14341,-3791.41C14341,-3774.56 14341,-3749.3 14341,-3729.88"/>
<polygon fill="black" stroke="black" points="14344.5,-3729.79 14341,-3719.79 14337.5,-3729.79 14344.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_down -->
<g id="node46" class="node">
<title>LLaMA_7B_S1_R1_L4_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="14447.5,-3609.74 14234.5,-3609.74 14234.5,-3571.74 14447.5,-3571.74 14447.5,-3609.74"/>
<text text-anchor="middle" x="14341" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14341" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_down -->
<g id="edge42" class="edge">
<title>LLaMA_7B_S1_R1_L4_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L4_ffn_down</title>
<path fill="none" stroke="black" d="M14341,-3681.41C14341,-3664.56 14341,-3639.3 14341,-3619.88"/>
<polygon fill="black" stroke="black" points="14344.5,-3619.79 14341,-3609.79 14337.5,-3619.79 14344.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_ar2 -->
<g id="node47" class="node">
<title>LLaMA_7B_S1_R1_L4_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14341" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14341" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="14341" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L4_ar2 -->
<g id="edge43" class="edge">
<title>LLaMA_7B_S1_R1_L4_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L4_ar2</title>
<path fill="none" stroke="black" d="M14341,-3571.63C14341,-3555.26 14341,-3530.67 14341,-3510.25"/>
<polygon fill="black" stroke="black" points="14344.5,-3510.01 14341,-3500.01 14337.5,-3510.01 14344.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L4_res2 -->
<g id="node48" class="node">
<title>LLaMA_7B_S1_R1_L4_res2</title>
<polygon fill="lightyellow" stroke="black" points="14428.84,-3374 14289.11,-3374 14253.16,-3338 14392.89,-3338 14428.84,-3374"/>
<text text-anchor="middle" x="14341" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L4_ar2&#45;&gt;LLaMA_7B_S1_R1_L4_res2 -->
<g id="edge44" class="edge">
<title>LLaMA_7B_S1_R1_L4_ar2&#45;&gt;LLaMA_7B_S1_R1_L4_res2</title>
<path fill="none" stroke="black" d="M14341,-3445.8C14341,-3427.43 14341,-3402.88 14341,-3384.25"/>
<polygon fill="black" stroke="black" points="14344.5,-3384.06 14341,-3374.06 14337.5,-3384.06 14344.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_split -->
<g id="node49" class="node">
<title>LLaMA_7B_S1_R1_L5_split</title>
<polygon fill="orange" stroke="black" points="13909.53,-4682.96 13258.06,-4682.96 13090.47,-4606.96 13741.94,-4606.96 13909.53,-4682.96"/>
<text text-anchor="middle" x="13500" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="13500" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_norm1 -->
<g id="node50" class="node">
<title>LLaMA_7B_S1_R1_L5_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="13500" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13500" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13500" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_split&#45;&gt;LLaMA_7B_S1_R1_L5_norm1 -->
<g id="edge45" class="edge">
<title>LLaMA_7B_S1_R1_L5_split&#45;&gt;LLaMA_7B_S1_R1_L5_norm1</title>
<path fill="none" stroke="black" d="M13500,-4606.75C13500,-4587.54 13500,-4564.2 13500,-4545.16"/>
<polygon fill="black" stroke="black" points="13503.5,-4545.07 13500,-4535.07 13496.5,-4545.07 13503.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_qkv -->
<g id="node51" class="node">
<title>LLaMA_7B_S1_R1_L5_qkv</title>
<polygon fill="lightcoral" stroke="black" points="13646.5,-4409.22 13353.5,-4409.22 13353.5,-4371.22 13646.5,-4371.22 13646.5,-4409.22"/>
<text text-anchor="middle" x="13500" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="13500" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_norm1&#45;&gt;LLaMA_7B_S1_R1_L5_qkv -->
<g id="edge46" class="edge">
<title>LLaMA_7B_S1_R1_L5_norm1&#45;&gt;LLaMA_7B_S1_R1_L5_qkv</title>
<path fill="none" stroke="black" d="M13500,-4481.08C13500,-4462.81 13500,-4438.39 13500,-4419.61"/>
<polygon fill="black" stroke="black" points="13503.5,-4419.57 13500,-4409.57 13496.5,-4419.57 13503.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_attn -->
<g id="node52" class="node">
<title>LLaMA_7B_S1_R1_L5_attn</title>
<polygon fill="lightcoral" stroke="black" points="13646.5,-4299.22 13353.5,-4299.22 13353.5,-4261.22 13646.5,-4261.22 13646.5,-4299.22"/>
<text text-anchor="middle" x="13500" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="13500" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_qkv&#45;&gt;LLaMA_7B_S1_R1_L5_attn -->
<g id="edge47" class="edge">
<title>LLaMA_7B_S1_R1_L5_qkv&#45;&gt;LLaMA_7B_S1_R1_L5_attn</title>
<path fill="none" stroke="black" d="M13500,-4370.9C13500,-4354.04 13500,-4328.78 13500,-4309.36"/>
<polygon fill="black" stroke="black" points="13503.5,-4309.27 13500,-4299.27 13496.5,-4309.27 13503.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_ar1 -->
<g id="node53" class="node">
<title>LLaMA_7B_S1_R1_L5_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13500" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13500" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="13500" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_attn&#45;&gt;LLaMA_7B_S1_R1_L5_ar1 -->
<g id="edge48" class="edge">
<title>LLaMA_7B_S1_R1_L5_attn&#45;&gt;LLaMA_7B_S1_R1_L5_ar1</title>
<path fill="none" stroke="black" d="M13500,-4261.11C13500,-4244.74 13500,-4220.15 13500,-4199.73"/>
<polygon fill="black" stroke="black" points="13503.5,-4199.49 13500,-4189.49 13496.5,-4199.49 13503.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_res1 -->
<g id="node54" class="node">
<title>LLaMA_7B_S1_R1_L5_res1</title>
<polygon fill="lightyellow" stroke="black" points="13587.84,-4063.48 13448.11,-4063.48 13412.16,-4027.48 13551.89,-4027.48 13587.84,-4063.48"/>
<text text-anchor="middle" x="13500" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_ar1&#45;&gt;LLaMA_7B_S1_R1_L5_res1 -->
<g id="edge49" class="edge">
<title>LLaMA_7B_S1_R1_L5_ar1&#45;&gt;LLaMA_7B_S1_R1_L5_res1</title>
<path fill="none" stroke="black" d="M13500,-4135.28C13500,-4116.91 13500,-4092.36 13500,-4073.73"/>
<polygon fill="black" stroke="black" points="13503.5,-4073.54 13500,-4063.54 13496.5,-4073.54 13503.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_norm2 -->
<g id="node55" class="node">
<title>LLaMA_7B_S1_R1_L5_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="13500" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13500" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="13500" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_res1&#45;&gt;LLaMA_7B_S1_R1_L5_norm2 -->
<g id="edge50" class="edge">
<title>LLaMA_7B_S1_R1_L5_res1&#45;&gt;LLaMA_7B_S1_R1_L5_norm2</title>
<path fill="none" stroke="black" d="M13500,-4027.03C13500,-4010.89 13500,-3986.38 13500,-3965.99"/>
<polygon fill="black" stroke="black" points="13503.5,-3965.76 13500,-3955.76 13496.5,-3965.76 13503.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_up -->
<g id="node56" class="node">
<title>LLaMA_7B_S1_R1_L5_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="13606.5,-3829.74 13393.5,-3829.74 13393.5,-3791.74 13606.5,-3791.74 13606.5,-3829.74"/>
<text text-anchor="middle" x="13500" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13500" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_norm2&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_up -->
<g id="edge51" class="edge">
<title>LLaMA_7B_S1_R1_L5_norm2&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_up</title>
<path fill="none" stroke="black" d="M13500,-3901.6C13500,-3883.33 13500,-3858.91 13500,-3840.13"/>
<polygon fill="black" stroke="black" points="13503.5,-3840.09 13500,-3830.09 13496.5,-3840.09 13503.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_gate -->
<g id="node57" class="node">
<title>LLaMA_7B_S1_R1_L5_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="13606.5,-3719.74 13393.5,-3719.74 13393.5,-3681.74 13606.5,-3681.74 13606.5,-3719.74"/>
<text text-anchor="middle" x="13500" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13500" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_gate -->
<g id="edge52" class="edge">
<title>LLaMA_7B_S1_R1_L5_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_gate</title>
<path fill="none" stroke="black" d="M13500,-3791.41C13500,-3774.56 13500,-3749.3 13500,-3729.88"/>
<polygon fill="black" stroke="black" points="13503.5,-3729.79 13500,-3719.79 13496.5,-3729.79 13503.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_down -->
<g id="node58" class="node">
<title>LLaMA_7B_S1_R1_L5_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="13606.5,-3609.74 13393.5,-3609.74 13393.5,-3571.74 13606.5,-3571.74 13606.5,-3609.74"/>
<text text-anchor="middle" x="13500" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13500" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_down -->
<g id="edge53" class="edge">
<title>LLaMA_7B_S1_R1_L5_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L5_ffn_down</title>
<path fill="none" stroke="black" d="M13500,-3681.41C13500,-3664.56 13500,-3639.3 13500,-3619.88"/>
<polygon fill="black" stroke="black" points="13503.5,-3619.79 13500,-3609.79 13496.5,-3619.79 13503.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_ar2 -->
<g id="node59" class="node">
<title>LLaMA_7B_S1_R1_L5_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13500" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13500" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="13500" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L5_ar2 -->
<g id="edge54" class="edge">
<title>LLaMA_7B_S1_R1_L5_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L5_ar2</title>
<path fill="none" stroke="black" d="M13500,-3571.63C13500,-3555.26 13500,-3530.67 13500,-3510.25"/>
<polygon fill="black" stroke="black" points="13503.5,-3510.01 13500,-3500.01 13496.5,-3510.01 13503.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L5_res2 -->
<g id="node60" class="node">
<title>LLaMA_7B_S1_R1_L5_res2</title>
<polygon fill="lightyellow" stroke="black" points="13587.84,-3374 13448.11,-3374 13412.16,-3338 13551.89,-3338 13587.84,-3374"/>
<text text-anchor="middle" x="13500" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L5_ar2&#45;&gt;LLaMA_7B_S1_R1_L5_res2 -->
<g id="edge55" class="edge">
<title>LLaMA_7B_S1_R1_L5_ar2&#45;&gt;LLaMA_7B_S1_R1_L5_res2</title>
<path fill="none" stroke="black" d="M13500,-3445.8C13500,-3427.43 13500,-3402.88 13500,-3384.25"/>
<polygon fill="black" stroke="black" points="13503.5,-3384.06 13500,-3374.06 13496.5,-3384.06 13503.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_split -->
<g id="node61" class="node">
<title>LLaMA_7B_S1_R1_L6_split</title>
<polygon fill="orange" stroke="black" points="13068.53,-4682.96 12417.06,-4682.96 12249.47,-4606.96 12900.94,-4606.96 13068.53,-4682.96"/>
<text text-anchor="middle" x="12659" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="12659" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_norm1 -->
<g id="node62" class="node">
<title>LLaMA_7B_S1_R1_L6_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="12659" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12659" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12659" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_split&#45;&gt;LLaMA_7B_S1_R1_L6_norm1 -->
<g id="edge56" class="edge">
<title>LLaMA_7B_S1_R1_L6_split&#45;&gt;LLaMA_7B_S1_R1_L6_norm1</title>
<path fill="none" stroke="black" d="M12659,-4606.75C12659,-4587.54 12659,-4564.2 12659,-4545.16"/>
<polygon fill="black" stroke="black" points="12662.5,-4545.07 12659,-4535.07 12655.5,-4545.07 12662.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_qkv -->
<g id="node63" class="node">
<title>LLaMA_7B_S1_R1_L6_qkv</title>
<polygon fill="lightcoral" stroke="black" points="12805.5,-4409.22 12512.5,-4409.22 12512.5,-4371.22 12805.5,-4371.22 12805.5,-4409.22"/>
<text text-anchor="middle" x="12659" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="12659" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_norm1&#45;&gt;LLaMA_7B_S1_R1_L6_qkv -->
<g id="edge57" class="edge">
<title>LLaMA_7B_S1_R1_L6_norm1&#45;&gt;LLaMA_7B_S1_R1_L6_qkv</title>
<path fill="none" stroke="black" d="M12659,-4481.08C12659,-4462.81 12659,-4438.39 12659,-4419.61"/>
<polygon fill="black" stroke="black" points="12662.5,-4419.57 12659,-4409.57 12655.5,-4419.57 12662.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_attn -->
<g id="node64" class="node">
<title>LLaMA_7B_S1_R1_L6_attn</title>
<polygon fill="lightcoral" stroke="black" points="12805.5,-4299.22 12512.5,-4299.22 12512.5,-4261.22 12805.5,-4261.22 12805.5,-4299.22"/>
<text text-anchor="middle" x="12659" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="12659" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_qkv&#45;&gt;LLaMA_7B_S1_R1_L6_attn -->
<g id="edge58" class="edge">
<title>LLaMA_7B_S1_R1_L6_qkv&#45;&gt;LLaMA_7B_S1_R1_L6_attn</title>
<path fill="none" stroke="black" d="M12659,-4370.9C12659,-4354.04 12659,-4328.78 12659,-4309.36"/>
<polygon fill="black" stroke="black" points="12662.5,-4309.27 12659,-4299.27 12655.5,-4309.27 12662.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_ar1 -->
<g id="node65" class="node">
<title>LLaMA_7B_S1_R1_L6_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12659" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12659" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="12659" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_attn&#45;&gt;LLaMA_7B_S1_R1_L6_ar1 -->
<g id="edge59" class="edge">
<title>LLaMA_7B_S1_R1_L6_attn&#45;&gt;LLaMA_7B_S1_R1_L6_ar1</title>
<path fill="none" stroke="black" d="M12659,-4261.11C12659,-4244.74 12659,-4220.15 12659,-4199.73"/>
<polygon fill="black" stroke="black" points="12662.5,-4199.49 12659,-4189.49 12655.5,-4199.49 12662.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_res1 -->
<g id="node66" class="node">
<title>LLaMA_7B_S1_R1_L6_res1</title>
<polygon fill="lightyellow" stroke="black" points="12746.84,-4063.48 12607.11,-4063.48 12571.16,-4027.48 12710.89,-4027.48 12746.84,-4063.48"/>
<text text-anchor="middle" x="12659" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_ar1&#45;&gt;LLaMA_7B_S1_R1_L6_res1 -->
<g id="edge60" class="edge">
<title>LLaMA_7B_S1_R1_L6_ar1&#45;&gt;LLaMA_7B_S1_R1_L6_res1</title>
<path fill="none" stroke="black" d="M12659,-4135.28C12659,-4116.91 12659,-4092.36 12659,-4073.73"/>
<polygon fill="black" stroke="black" points="12662.5,-4073.54 12659,-4063.54 12655.5,-4073.54 12662.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_norm2 -->
<g id="node67" class="node">
<title>LLaMA_7B_S1_R1_L6_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="12659" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12659" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="12659" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_res1&#45;&gt;LLaMA_7B_S1_R1_L6_norm2 -->
<g id="edge61" class="edge">
<title>LLaMA_7B_S1_R1_L6_res1&#45;&gt;LLaMA_7B_S1_R1_L6_norm2</title>
<path fill="none" stroke="black" d="M12659,-4027.03C12659,-4010.89 12659,-3986.38 12659,-3965.99"/>
<polygon fill="black" stroke="black" points="12662.5,-3965.76 12659,-3955.76 12655.5,-3965.76 12662.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_up -->
<g id="node68" class="node">
<title>LLaMA_7B_S1_R1_L6_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="12765.5,-3829.74 12552.5,-3829.74 12552.5,-3791.74 12765.5,-3791.74 12765.5,-3829.74"/>
<text text-anchor="middle" x="12659" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12659" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_norm2&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_up -->
<g id="edge62" class="edge">
<title>LLaMA_7B_S1_R1_L6_norm2&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_up</title>
<path fill="none" stroke="black" d="M12659,-3901.6C12659,-3883.33 12659,-3858.91 12659,-3840.13"/>
<polygon fill="black" stroke="black" points="12662.5,-3840.09 12659,-3830.09 12655.5,-3840.09 12662.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_gate -->
<g id="node69" class="node">
<title>LLaMA_7B_S1_R1_L6_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="12765.5,-3719.74 12552.5,-3719.74 12552.5,-3681.74 12765.5,-3681.74 12765.5,-3719.74"/>
<text text-anchor="middle" x="12659" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12659" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_gate -->
<g id="edge63" class="edge">
<title>LLaMA_7B_S1_R1_L6_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_gate</title>
<path fill="none" stroke="black" d="M12659,-3791.41C12659,-3774.56 12659,-3749.3 12659,-3729.88"/>
<polygon fill="black" stroke="black" points="12662.5,-3729.79 12659,-3719.79 12655.5,-3729.79 12662.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_down -->
<g id="node70" class="node">
<title>LLaMA_7B_S1_R1_L6_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="12765.5,-3609.74 12552.5,-3609.74 12552.5,-3571.74 12765.5,-3571.74 12765.5,-3609.74"/>
<text text-anchor="middle" x="12659" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12659" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_down -->
<g id="edge64" class="edge">
<title>LLaMA_7B_S1_R1_L6_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L6_ffn_down</title>
<path fill="none" stroke="black" d="M12659,-3681.41C12659,-3664.56 12659,-3639.3 12659,-3619.88"/>
<polygon fill="black" stroke="black" points="12662.5,-3619.79 12659,-3609.79 12655.5,-3619.79 12662.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_ar2 -->
<g id="node71" class="node">
<title>LLaMA_7B_S1_R1_L6_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12659" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12659" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="12659" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L6_ar2 -->
<g id="edge65" class="edge">
<title>LLaMA_7B_S1_R1_L6_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L6_ar2</title>
<path fill="none" stroke="black" d="M12659,-3571.63C12659,-3555.26 12659,-3530.67 12659,-3510.25"/>
<polygon fill="black" stroke="black" points="12662.5,-3510.01 12659,-3500.01 12655.5,-3510.01 12662.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L6_res2 -->
<g id="node72" class="node">
<title>LLaMA_7B_S1_R1_L6_res2</title>
<polygon fill="lightyellow" stroke="black" points="12746.84,-3374 12607.11,-3374 12571.16,-3338 12710.89,-3338 12746.84,-3374"/>
<text text-anchor="middle" x="12659" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L6_ar2&#45;&gt;LLaMA_7B_S1_R1_L6_res2 -->
<g id="edge66" class="edge">
<title>LLaMA_7B_S1_R1_L6_ar2&#45;&gt;LLaMA_7B_S1_R1_L6_res2</title>
<path fill="none" stroke="black" d="M12659,-3445.8C12659,-3427.43 12659,-3402.88 12659,-3384.25"/>
<polygon fill="black" stroke="black" points="12662.5,-3384.06 12659,-3374.06 12655.5,-3384.06 12662.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_split -->
<g id="node73" class="node">
<title>LLaMA_7B_S1_R1_L7_split</title>
<polygon fill="orange" stroke="black" points="12227.53,-4682.96 11576.06,-4682.96 11408.47,-4606.96 12059.94,-4606.96 12227.53,-4682.96"/>
<text text-anchor="middle" x="11818" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="11818" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_norm1 -->
<g id="node74" class="node">
<title>LLaMA_7B_S1_R1_L7_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="11818" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11818" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11818" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_split&#45;&gt;LLaMA_7B_S1_R1_L7_norm1 -->
<g id="edge67" class="edge">
<title>LLaMA_7B_S1_R1_L7_split&#45;&gt;LLaMA_7B_S1_R1_L7_norm1</title>
<path fill="none" stroke="black" d="M11818,-4606.75C11818,-4587.54 11818,-4564.2 11818,-4545.16"/>
<polygon fill="black" stroke="black" points="11821.5,-4545.07 11818,-4535.07 11814.5,-4545.07 11821.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_qkv -->
<g id="node75" class="node">
<title>LLaMA_7B_S1_R1_L7_qkv</title>
<polygon fill="lightcoral" stroke="black" points="11964.5,-4409.22 11671.5,-4409.22 11671.5,-4371.22 11964.5,-4371.22 11964.5,-4409.22"/>
<text text-anchor="middle" x="11818" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="11818" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_norm1&#45;&gt;LLaMA_7B_S1_R1_L7_qkv -->
<g id="edge68" class="edge">
<title>LLaMA_7B_S1_R1_L7_norm1&#45;&gt;LLaMA_7B_S1_R1_L7_qkv</title>
<path fill="none" stroke="black" d="M11818,-4481.08C11818,-4462.81 11818,-4438.39 11818,-4419.61"/>
<polygon fill="black" stroke="black" points="11821.5,-4419.57 11818,-4409.57 11814.5,-4419.57 11821.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_attn -->
<g id="node76" class="node">
<title>LLaMA_7B_S1_R1_L7_attn</title>
<polygon fill="lightcoral" stroke="black" points="11964.5,-4299.22 11671.5,-4299.22 11671.5,-4261.22 11964.5,-4261.22 11964.5,-4299.22"/>
<text text-anchor="middle" x="11818" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="11818" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_qkv&#45;&gt;LLaMA_7B_S1_R1_L7_attn -->
<g id="edge69" class="edge">
<title>LLaMA_7B_S1_R1_L7_qkv&#45;&gt;LLaMA_7B_S1_R1_L7_attn</title>
<path fill="none" stroke="black" d="M11818,-4370.9C11818,-4354.04 11818,-4328.78 11818,-4309.36"/>
<polygon fill="black" stroke="black" points="11821.5,-4309.27 11818,-4299.27 11814.5,-4309.27 11821.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_ar1 -->
<g id="node77" class="node">
<title>LLaMA_7B_S1_R1_L7_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11818" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11818" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11818" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_attn&#45;&gt;LLaMA_7B_S1_R1_L7_ar1 -->
<g id="edge70" class="edge">
<title>LLaMA_7B_S1_R1_L7_attn&#45;&gt;LLaMA_7B_S1_R1_L7_ar1</title>
<path fill="none" stroke="black" d="M11818,-4261.11C11818,-4244.74 11818,-4220.15 11818,-4199.73"/>
<polygon fill="black" stroke="black" points="11821.5,-4199.49 11818,-4189.49 11814.5,-4199.49 11821.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_res1 -->
<g id="node78" class="node">
<title>LLaMA_7B_S1_R1_L7_res1</title>
<polygon fill="lightyellow" stroke="black" points="11905.84,-4063.48 11766.11,-4063.48 11730.16,-4027.48 11869.89,-4027.48 11905.84,-4063.48"/>
<text text-anchor="middle" x="11818" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_ar1&#45;&gt;LLaMA_7B_S1_R1_L7_res1 -->
<g id="edge71" class="edge">
<title>LLaMA_7B_S1_R1_L7_ar1&#45;&gt;LLaMA_7B_S1_R1_L7_res1</title>
<path fill="none" stroke="black" d="M11818,-4135.28C11818,-4116.91 11818,-4092.36 11818,-4073.73"/>
<polygon fill="black" stroke="black" points="11821.5,-4073.54 11818,-4063.54 11814.5,-4073.54 11821.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_norm2 -->
<g id="node79" class="node">
<title>LLaMA_7B_S1_R1_L7_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="11818" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11818" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="11818" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_res1&#45;&gt;LLaMA_7B_S1_R1_L7_norm2 -->
<g id="edge72" class="edge">
<title>LLaMA_7B_S1_R1_L7_res1&#45;&gt;LLaMA_7B_S1_R1_L7_norm2</title>
<path fill="none" stroke="black" d="M11818,-4027.03C11818,-4010.89 11818,-3986.38 11818,-3965.99"/>
<polygon fill="black" stroke="black" points="11821.5,-3965.76 11818,-3955.76 11814.5,-3965.76 11821.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_up -->
<g id="node80" class="node">
<title>LLaMA_7B_S1_R1_L7_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="11924.5,-3829.74 11711.5,-3829.74 11711.5,-3791.74 11924.5,-3791.74 11924.5,-3829.74"/>
<text text-anchor="middle" x="11818" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11818" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_norm2&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_up -->
<g id="edge73" class="edge">
<title>LLaMA_7B_S1_R1_L7_norm2&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_up</title>
<path fill="none" stroke="black" d="M11818,-3901.6C11818,-3883.33 11818,-3858.91 11818,-3840.13"/>
<polygon fill="black" stroke="black" points="11821.5,-3840.09 11818,-3830.09 11814.5,-3840.09 11821.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_gate -->
<g id="node81" class="node">
<title>LLaMA_7B_S1_R1_L7_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="11924.5,-3719.74 11711.5,-3719.74 11711.5,-3681.74 11924.5,-3681.74 11924.5,-3719.74"/>
<text text-anchor="middle" x="11818" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11818" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_gate -->
<g id="edge74" class="edge">
<title>LLaMA_7B_S1_R1_L7_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_gate</title>
<path fill="none" stroke="black" d="M11818,-3791.41C11818,-3774.56 11818,-3749.3 11818,-3729.88"/>
<polygon fill="black" stroke="black" points="11821.5,-3729.79 11818,-3719.79 11814.5,-3729.79 11821.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_down -->
<g id="node82" class="node">
<title>LLaMA_7B_S1_R1_L7_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="11924.5,-3609.74 11711.5,-3609.74 11711.5,-3571.74 11924.5,-3571.74 11924.5,-3609.74"/>
<text text-anchor="middle" x="11818" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11818" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_down -->
<g id="edge75" class="edge">
<title>LLaMA_7B_S1_R1_L7_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L7_ffn_down</title>
<path fill="none" stroke="black" d="M11818,-3681.41C11818,-3664.56 11818,-3639.3 11818,-3619.88"/>
<polygon fill="black" stroke="black" points="11821.5,-3619.79 11818,-3609.79 11814.5,-3619.79 11821.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_ar2 -->
<g id="node83" class="node">
<title>LLaMA_7B_S1_R1_L7_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11818" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11818" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="11818" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L7_ar2 -->
<g id="edge76" class="edge">
<title>LLaMA_7B_S1_R1_L7_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L7_ar2</title>
<path fill="none" stroke="black" d="M11818,-3571.63C11818,-3555.26 11818,-3530.67 11818,-3510.25"/>
<polygon fill="black" stroke="black" points="11821.5,-3510.01 11818,-3500.01 11814.5,-3510.01 11821.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L7_res2 -->
<g id="node84" class="node">
<title>LLaMA_7B_S1_R1_L7_res2</title>
<polygon fill="lightyellow" stroke="black" points="11905.84,-3374 11766.11,-3374 11730.16,-3338 11869.89,-3338 11905.84,-3374"/>
<text text-anchor="middle" x="11818" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L7_ar2&#45;&gt;LLaMA_7B_S1_R1_L7_res2 -->
<g id="edge77" class="edge">
<title>LLaMA_7B_S1_R1_L7_ar2&#45;&gt;LLaMA_7B_S1_R1_L7_res2</title>
<path fill="none" stroke="black" d="M11818,-3445.8C11818,-3427.43 11818,-3402.88 11818,-3384.25"/>
<polygon fill="black" stroke="black" points="11821.5,-3384.06 11818,-3374.06 11814.5,-3384.06 11821.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_split -->
<g id="node85" class="node">
<title>LLaMA_7B_S1_R1_L8_split</title>
<polygon fill="orange" stroke="black" points="11386.53,-4682.96 10735.06,-4682.96 10567.47,-4606.96 11218.94,-4606.96 11386.53,-4682.96"/>
<text text-anchor="middle" x="10977" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="10977" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_norm1 -->
<g id="node86" class="node">
<title>LLaMA_7B_S1_R1_L8_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="10977" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10977" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10977" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_split&#45;&gt;LLaMA_7B_S1_R1_L8_norm1 -->
<g id="edge78" class="edge">
<title>LLaMA_7B_S1_R1_L8_split&#45;&gt;LLaMA_7B_S1_R1_L8_norm1</title>
<path fill="none" stroke="black" d="M10977,-4606.75C10977,-4587.54 10977,-4564.2 10977,-4545.16"/>
<polygon fill="black" stroke="black" points="10980.5,-4545.07 10977,-4535.07 10973.5,-4545.07 10980.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_qkv -->
<g id="node87" class="node">
<title>LLaMA_7B_S1_R1_L8_qkv</title>
<polygon fill="lightcoral" stroke="black" points="11123.5,-4409.22 10830.5,-4409.22 10830.5,-4371.22 11123.5,-4371.22 11123.5,-4409.22"/>
<text text-anchor="middle" x="10977" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="10977" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_norm1&#45;&gt;LLaMA_7B_S1_R1_L8_qkv -->
<g id="edge79" class="edge">
<title>LLaMA_7B_S1_R1_L8_norm1&#45;&gt;LLaMA_7B_S1_R1_L8_qkv</title>
<path fill="none" stroke="black" d="M10977,-4481.08C10977,-4462.81 10977,-4438.39 10977,-4419.61"/>
<polygon fill="black" stroke="black" points="10980.5,-4419.57 10977,-4409.57 10973.5,-4419.57 10980.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_attn -->
<g id="node88" class="node">
<title>LLaMA_7B_S1_R1_L8_attn</title>
<polygon fill="lightcoral" stroke="black" points="11123.5,-4299.22 10830.5,-4299.22 10830.5,-4261.22 11123.5,-4261.22 11123.5,-4299.22"/>
<text text-anchor="middle" x="10977" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="10977" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_qkv&#45;&gt;LLaMA_7B_S1_R1_L8_attn -->
<g id="edge80" class="edge">
<title>LLaMA_7B_S1_R1_L8_qkv&#45;&gt;LLaMA_7B_S1_R1_L8_attn</title>
<path fill="none" stroke="black" d="M10977,-4370.9C10977,-4354.04 10977,-4328.78 10977,-4309.36"/>
<polygon fill="black" stroke="black" points="10980.5,-4309.27 10977,-4299.27 10973.5,-4309.27 10980.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_ar1 -->
<g id="node89" class="node">
<title>LLaMA_7B_S1_R1_L8_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10977" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10977" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10977" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_attn&#45;&gt;LLaMA_7B_S1_R1_L8_ar1 -->
<g id="edge81" class="edge">
<title>LLaMA_7B_S1_R1_L8_attn&#45;&gt;LLaMA_7B_S1_R1_L8_ar1</title>
<path fill="none" stroke="black" d="M10977,-4261.11C10977,-4244.74 10977,-4220.15 10977,-4199.73"/>
<polygon fill="black" stroke="black" points="10980.5,-4199.49 10977,-4189.49 10973.5,-4199.49 10980.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_res1 -->
<g id="node90" class="node">
<title>LLaMA_7B_S1_R1_L8_res1</title>
<polygon fill="lightyellow" stroke="black" points="11064.84,-4063.48 10925.11,-4063.48 10889.16,-4027.48 11028.89,-4027.48 11064.84,-4063.48"/>
<text text-anchor="middle" x="10977" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_ar1&#45;&gt;LLaMA_7B_S1_R1_L8_res1 -->
<g id="edge82" class="edge">
<title>LLaMA_7B_S1_R1_L8_ar1&#45;&gt;LLaMA_7B_S1_R1_L8_res1</title>
<path fill="none" stroke="black" d="M10977,-4135.28C10977,-4116.91 10977,-4092.36 10977,-4073.73"/>
<polygon fill="black" stroke="black" points="10980.5,-4073.54 10977,-4063.54 10973.5,-4073.54 10980.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_norm2 -->
<g id="node91" class="node">
<title>LLaMA_7B_S1_R1_L8_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="10977" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10977" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="10977" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_res1&#45;&gt;LLaMA_7B_S1_R1_L8_norm2 -->
<g id="edge83" class="edge">
<title>LLaMA_7B_S1_R1_L8_res1&#45;&gt;LLaMA_7B_S1_R1_L8_norm2</title>
<path fill="none" stroke="black" d="M10977,-4027.03C10977,-4010.89 10977,-3986.38 10977,-3965.99"/>
<polygon fill="black" stroke="black" points="10980.5,-3965.76 10977,-3955.76 10973.5,-3965.76 10980.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_up -->
<g id="node92" class="node">
<title>LLaMA_7B_S1_R1_L8_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="11083.5,-3829.74 10870.5,-3829.74 10870.5,-3791.74 11083.5,-3791.74 11083.5,-3829.74"/>
<text text-anchor="middle" x="10977" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10977" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_norm2&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_up -->
<g id="edge84" class="edge">
<title>LLaMA_7B_S1_R1_L8_norm2&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_up</title>
<path fill="none" stroke="black" d="M10977,-3901.6C10977,-3883.33 10977,-3858.91 10977,-3840.13"/>
<polygon fill="black" stroke="black" points="10980.5,-3840.09 10977,-3830.09 10973.5,-3840.09 10980.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_gate -->
<g id="node93" class="node">
<title>LLaMA_7B_S1_R1_L8_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="11083.5,-3719.74 10870.5,-3719.74 10870.5,-3681.74 11083.5,-3681.74 11083.5,-3719.74"/>
<text text-anchor="middle" x="10977" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10977" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_gate -->
<g id="edge85" class="edge">
<title>LLaMA_7B_S1_R1_L8_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_gate</title>
<path fill="none" stroke="black" d="M10977,-3791.41C10977,-3774.56 10977,-3749.3 10977,-3729.88"/>
<polygon fill="black" stroke="black" points="10980.5,-3729.79 10977,-3719.79 10973.5,-3729.79 10980.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_down -->
<g id="node94" class="node">
<title>LLaMA_7B_S1_R1_L8_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="11083.5,-3609.74 10870.5,-3609.74 10870.5,-3571.74 11083.5,-3571.74 11083.5,-3609.74"/>
<text text-anchor="middle" x="10977" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10977" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_down -->
<g id="edge86" class="edge">
<title>LLaMA_7B_S1_R1_L8_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L8_ffn_down</title>
<path fill="none" stroke="black" d="M10977,-3681.41C10977,-3664.56 10977,-3639.3 10977,-3619.88"/>
<polygon fill="black" stroke="black" points="10980.5,-3619.79 10977,-3609.79 10973.5,-3619.79 10980.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_ar2 -->
<g id="node95" class="node">
<title>LLaMA_7B_S1_R1_L8_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10977" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10977" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="10977" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L8_ar2 -->
<g id="edge87" class="edge">
<title>LLaMA_7B_S1_R1_L8_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L8_ar2</title>
<path fill="none" stroke="black" d="M10977,-3571.63C10977,-3555.26 10977,-3530.67 10977,-3510.25"/>
<polygon fill="black" stroke="black" points="10980.5,-3510.01 10977,-3500.01 10973.5,-3510.01 10980.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L8_res2 -->
<g id="node96" class="node">
<title>LLaMA_7B_S1_R1_L8_res2</title>
<polygon fill="lightyellow" stroke="black" points="11064.84,-3374 10925.11,-3374 10889.16,-3338 11028.89,-3338 11064.84,-3374"/>
<text text-anchor="middle" x="10977" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L8_ar2&#45;&gt;LLaMA_7B_S1_R1_L8_res2 -->
<g id="edge88" class="edge">
<title>LLaMA_7B_S1_R1_L8_ar2&#45;&gt;LLaMA_7B_S1_R1_L8_res2</title>
<path fill="none" stroke="black" d="M10977,-3445.8C10977,-3427.43 10977,-3402.88 10977,-3384.25"/>
<polygon fill="black" stroke="black" points="10980.5,-3384.06 10977,-3374.06 10973.5,-3384.06 10980.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_split -->
<g id="node97" class="node">
<title>LLaMA_7B_S1_R1_L9_split</title>
<polygon fill="orange" stroke="black" points="10545.53,-4682.96 9894.06,-4682.96 9726.47,-4606.96 10377.94,-4606.96 10545.53,-4682.96"/>
<text text-anchor="middle" x="10136" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="10136" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_norm1 -->
<g id="node98" class="node">
<title>LLaMA_7B_S1_R1_L9_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="10136" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10136" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10136" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_split&#45;&gt;LLaMA_7B_S1_R1_L9_norm1 -->
<g id="edge89" class="edge">
<title>LLaMA_7B_S1_R1_L9_split&#45;&gt;LLaMA_7B_S1_R1_L9_norm1</title>
<path fill="none" stroke="black" d="M10136,-4606.75C10136,-4587.54 10136,-4564.2 10136,-4545.16"/>
<polygon fill="black" stroke="black" points="10139.5,-4545.07 10136,-4535.07 10132.5,-4545.07 10139.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_qkv -->
<g id="node99" class="node">
<title>LLaMA_7B_S1_R1_L9_qkv</title>
<polygon fill="lightcoral" stroke="black" points="10282.5,-4409.22 9989.5,-4409.22 9989.5,-4371.22 10282.5,-4371.22 10282.5,-4409.22"/>
<text text-anchor="middle" x="10136" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="10136" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_norm1&#45;&gt;LLaMA_7B_S1_R1_L9_qkv -->
<g id="edge90" class="edge">
<title>LLaMA_7B_S1_R1_L9_norm1&#45;&gt;LLaMA_7B_S1_R1_L9_qkv</title>
<path fill="none" stroke="black" d="M10136,-4481.08C10136,-4462.81 10136,-4438.39 10136,-4419.61"/>
<polygon fill="black" stroke="black" points="10139.5,-4419.57 10136,-4409.57 10132.5,-4419.57 10139.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_attn -->
<g id="node100" class="node">
<title>LLaMA_7B_S1_R1_L9_attn</title>
<polygon fill="lightcoral" stroke="black" points="10282.5,-4299.22 9989.5,-4299.22 9989.5,-4261.22 10282.5,-4261.22 10282.5,-4299.22"/>
<text text-anchor="middle" x="10136" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="10136" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_qkv&#45;&gt;LLaMA_7B_S1_R1_L9_attn -->
<g id="edge91" class="edge">
<title>LLaMA_7B_S1_R1_L9_qkv&#45;&gt;LLaMA_7B_S1_R1_L9_attn</title>
<path fill="none" stroke="black" d="M10136,-4370.9C10136,-4354.04 10136,-4328.78 10136,-4309.36"/>
<polygon fill="black" stroke="black" points="10139.5,-4309.27 10136,-4299.27 10132.5,-4309.27 10139.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_ar1 -->
<g id="node101" class="node">
<title>LLaMA_7B_S1_R1_L9_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10136" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10136" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10136" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_attn&#45;&gt;LLaMA_7B_S1_R1_L9_ar1 -->
<g id="edge92" class="edge">
<title>LLaMA_7B_S1_R1_L9_attn&#45;&gt;LLaMA_7B_S1_R1_L9_ar1</title>
<path fill="none" stroke="black" d="M10136,-4261.11C10136,-4244.74 10136,-4220.15 10136,-4199.73"/>
<polygon fill="black" stroke="black" points="10139.5,-4199.49 10136,-4189.49 10132.5,-4199.49 10139.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_res1 -->
<g id="node102" class="node">
<title>LLaMA_7B_S1_R1_L9_res1</title>
<polygon fill="lightyellow" stroke="black" points="10223.84,-4063.48 10084.11,-4063.48 10048.16,-4027.48 10187.89,-4027.48 10223.84,-4063.48"/>
<text text-anchor="middle" x="10136" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_ar1&#45;&gt;LLaMA_7B_S1_R1_L9_res1 -->
<g id="edge93" class="edge">
<title>LLaMA_7B_S1_R1_L9_ar1&#45;&gt;LLaMA_7B_S1_R1_L9_res1</title>
<path fill="none" stroke="black" d="M10136,-4135.28C10136,-4116.91 10136,-4092.36 10136,-4073.73"/>
<polygon fill="black" stroke="black" points="10139.5,-4073.54 10136,-4063.54 10132.5,-4073.54 10139.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_norm2 -->
<g id="node103" class="node">
<title>LLaMA_7B_S1_R1_L9_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="10136" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10136" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="10136" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_res1&#45;&gt;LLaMA_7B_S1_R1_L9_norm2 -->
<g id="edge94" class="edge">
<title>LLaMA_7B_S1_R1_L9_res1&#45;&gt;LLaMA_7B_S1_R1_L9_norm2</title>
<path fill="none" stroke="black" d="M10136,-4027.03C10136,-4010.89 10136,-3986.38 10136,-3965.99"/>
<polygon fill="black" stroke="black" points="10139.5,-3965.76 10136,-3955.76 10132.5,-3965.76 10139.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_up -->
<g id="node104" class="node">
<title>LLaMA_7B_S1_R1_L9_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="10242.5,-3829.74 10029.5,-3829.74 10029.5,-3791.74 10242.5,-3791.74 10242.5,-3829.74"/>
<text text-anchor="middle" x="10136" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10136" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_norm2&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_up -->
<g id="edge95" class="edge">
<title>LLaMA_7B_S1_R1_L9_norm2&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_up</title>
<path fill="none" stroke="black" d="M10136,-3901.6C10136,-3883.33 10136,-3858.91 10136,-3840.13"/>
<polygon fill="black" stroke="black" points="10139.5,-3840.09 10136,-3830.09 10132.5,-3840.09 10139.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_gate -->
<g id="node105" class="node">
<title>LLaMA_7B_S1_R1_L9_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="10242.5,-3719.74 10029.5,-3719.74 10029.5,-3681.74 10242.5,-3681.74 10242.5,-3719.74"/>
<text text-anchor="middle" x="10136" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10136" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_gate -->
<g id="edge96" class="edge">
<title>LLaMA_7B_S1_R1_L9_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_gate</title>
<path fill="none" stroke="black" d="M10136,-3791.41C10136,-3774.56 10136,-3749.3 10136,-3729.88"/>
<polygon fill="black" stroke="black" points="10139.5,-3729.79 10136,-3719.79 10132.5,-3729.79 10139.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_down -->
<g id="node106" class="node">
<title>LLaMA_7B_S1_R1_L9_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="10242.5,-3609.74 10029.5,-3609.74 10029.5,-3571.74 10242.5,-3571.74 10242.5,-3609.74"/>
<text text-anchor="middle" x="10136" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10136" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_down -->
<g id="edge97" class="edge">
<title>LLaMA_7B_S1_R1_L9_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L9_ffn_down</title>
<path fill="none" stroke="black" d="M10136,-3681.41C10136,-3664.56 10136,-3639.3 10136,-3619.88"/>
<polygon fill="black" stroke="black" points="10139.5,-3619.79 10136,-3609.79 10132.5,-3619.79 10139.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_ar2 -->
<g id="node107" class="node">
<title>LLaMA_7B_S1_R1_L9_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10136" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10136" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="10136" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L9_ar2 -->
<g id="edge98" class="edge">
<title>LLaMA_7B_S1_R1_L9_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L9_ar2</title>
<path fill="none" stroke="black" d="M10136,-3571.63C10136,-3555.26 10136,-3530.67 10136,-3510.25"/>
<polygon fill="black" stroke="black" points="10139.5,-3510.01 10136,-3500.01 10132.5,-3510.01 10139.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R1_L9_res2 -->
<g id="node108" class="node">
<title>LLaMA_7B_S1_R1_L9_res2</title>
<polygon fill="lightyellow" stroke="black" points="10223.84,-3374 10084.11,-3374 10048.16,-3338 10187.89,-3338 10223.84,-3374"/>
<text text-anchor="middle" x="10136" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L9_ar2&#45;&gt;LLaMA_7B_S1_R1_L9_res2 -->
<g id="edge99" class="edge">
<title>LLaMA_7B_S1_R1_L9_ar2&#45;&gt;LLaMA_7B_S1_R1_L9_res2</title>
<path fill="none" stroke="black" d="M10136,-3445.8C10136,-3427.43 10136,-3402.88 10136,-3384.25"/>
<polygon fill="black" stroke="black" points="10139.5,-3384.06 10136,-3374.06 10132.5,-3384.06 10139.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_split -->
<g id="node109" class="node">
<title>LLaMA_7B_S1_R1_L10_split</title>
<polygon fill="orange" stroke="black" points="9704.53,-4682.96 9053.06,-4682.96 8885.47,-4606.96 9536.94,-4606.96 9704.53,-4682.96"/>
<text text-anchor="middle" x="9295" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="9295" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_norm1 -->
<g id="node110" class="node">
<title>LLaMA_7B_S1_R1_L10_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="9164" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9164" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9164" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_split&#45;&gt;LLaMA_7B_S1_R1_L10_norm1 -->
<g id="edge100" class="edge">
<title>LLaMA_7B_S1_R1_L10_split&#45;&gt;LLaMA_7B_S1_R1_L10_norm1</title>
<path fill="none" stroke="black" d="M9258.86,-4606.75C9238.98,-4586.28 9214.55,-4561.13 9195.47,-4541.48"/>
<polygon fill="black" stroke="black" points="9197.91,-4538.98 9188.43,-4534.24 9192.89,-4543.85 9197.91,-4538.98"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_qkv -->
<g id="node111" class="node">
<title>LLaMA_7B_S1_R1_L10_qkv</title>
<polygon fill="lightcoral" stroke="black" points="9310.5,-4409.22 9017.5,-4409.22 9017.5,-4371.22 9310.5,-4371.22 9310.5,-4409.22"/>
<text text-anchor="middle" x="9164" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="9164" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_norm1&#45;&gt;LLaMA_7B_S1_R1_L10_qkv -->
<g id="edge101" class="edge">
<title>LLaMA_7B_S1_R1_L10_norm1&#45;&gt;LLaMA_7B_S1_R1_L10_qkv</title>
<path fill="none" stroke="black" d="M9164,-4481.08C9164,-4462.81 9164,-4438.39 9164,-4419.61"/>
<polygon fill="black" stroke="black" points="9167.5,-4419.57 9164,-4409.57 9160.5,-4419.57 9167.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_attn -->
<g id="node112" class="node">
<title>LLaMA_7B_S1_R1_L10_attn</title>
<polygon fill="lightcoral" stroke="black" points="9309.5,-4299.22 9016.5,-4299.22 9016.5,-4261.22 9309.5,-4261.22 9309.5,-4299.22"/>
<text text-anchor="middle" x="9163" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="9163" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_qkv&#45;&gt;LLaMA_7B_S1_R1_L10_attn -->
<g id="edge102" class="edge">
<title>LLaMA_7B_S1_R1_L10_qkv&#45;&gt;LLaMA_7B_S1_R1_L10_attn</title>
<path fill="none" stroke="black" d="M9163.83,-4370.9C9163.67,-4354.04 9163.44,-4328.78 9163.26,-4309.36"/>
<polygon fill="black" stroke="black" points="9166.76,-4309.23 9163.17,-4299.27 9159.76,-4309.3 9166.76,-4309.23"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_ar1 -->
<g id="node113" class="node">
<title>LLaMA_7B_S1_R1_L10_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9141" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9141" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9141" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_attn&#45;&gt;LLaMA_7B_S1_R1_L10_ar1 -->
<g id="edge103" class="edge">
<title>LLaMA_7B_S1_R1_L10_attn&#45;&gt;LLaMA_7B_S1_R1_L10_ar1</title>
<path fill="none" stroke="black" d="M9159.56,-4261.11C9156.44,-4244.67 9151.74,-4219.93 9147.85,-4199.45"/>
<polygon fill="black" stroke="black" points="9151.27,-4198.67 9145.96,-4189.49 9144.39,-4199.97 9151.27,-4198.67"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_res1 -->
<g id="node114" class="node">
<title>LLaMA_7B_S1_R1_L10_res1</title>
<polygon fill="lightyellow" stroke="black" points="9142.84,-4063.48 9003.11,-4063.48 8967.16,-4027.48 9106.89,-4027.48 9142.84,-4063.48"/>
<text text-anchor="middle" x="9055" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_ar1&#45;&gt;LLaMA_7B_S1_R1_L10_res1 -->
<g id="edge104" class="edge">
<title>LLaMA_7B_S1_R1_L10_ar1&#45;&gt;LLaMA_7B_S1_R1_L10_res1</title>
<path fill="none" stroke="black" d="M9121.91,-4135.85C9107.67,-4116.82 9088.28,-4090.93 9074.05,-4071.92"/>
<polygon fill="black" stroke="black" points="9076.7,-4069.62 9067.9,-4063.71 9071.1,-4073.81 9076.7,-4069.62"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_norm2 -->
<g id="node115" class="node">
<title>LLaMA_7B_S1_R1_L10_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="9012" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9012" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="9012" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_res1&#45;&gt;LLaMA_7B_S1_R1_L10_norm2 -->
<g id="edge105" class="edge">
<title>LLaMA_7B_S1_R1_L10_res1&#45;&gt;LLaMA_7B_S1_R1_L10_norm2</title>
<path fill="none" stroke="black" d="M9048.47,-4027.03C9042.3,-4010.56 9032.88,-3985.38 9025.15,-3964.74"/>
<polygon fill="black" stroke="black" points="9028.41,-3963.47 9021.63,-3955.33 9021.86,-3965.92 9028.41,-3963.47"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_up -->
<g id="node116" class="node">
<title>LLaMA_7B_S1_R1_L10_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="9117.5,-3829.74 8904.5,-3829.74 8904.5,-3791.74 9117.5,-3791.74 9117.5,-3829.74"/>
<text text-anchor="middle" x="9011" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9011" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_norm2&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_up -->
<g id="edge106" class="edge">
<title>LLaMA_7B_S1_R1_L10_norm2&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_up</title>
<path fill="none" stroke="black" d="M9011.78,-3901.6C9011.62,-3883.33 9011.41,-3858.91 9011.25,-3840.13"/>
<polygon fill="black" stroke="black" points="9014.74,-3840.06 9011.16,-3830.09 9007.74,-3840.12 9014.74,-3840.06"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_gate -->
<g id="node117" class="node">
<title>LLaMA_7B_S1_R1_L10_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="9115.5,-3719.74 8902.5,-3719.74 8902.5,-3681.74 9115.5,-3681.74 9115.5,-3719.74"/>
<text text-anchor="middle" x="9009" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9009" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_gate -->
<g id="edge107" class="edge">
<title>LLaMA_7B_S1_R1_L10_ffn_up&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_gate</title>
<path fill="none" stroke="black" d="M9010.66,-3791.41C9010.35,-3774.56 9009.88,-3749.3 9009.52,-3729.88"/>
<polygon fill="black" stroke="black" points="9013.02,-3729.72 9009.33,-3719.79 9006.02,-3729.85 9013.02,-3729.72"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_down -->
<g id="node118" class="node">
<title>LLaMA_7B_S1_R1_L10_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="9110.5,-3609.74 8897.5,-3609.74 8897.5,-3571.74 9110.5,-3571.74 9110.5,-3609.74"/>
<text text-anchor="middle" x="9004" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9004" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_down -->
<g id="edge108" class="edge">
<title>LLaMA_7B_S1_R1_L10_ffn_gate&#45;&gt;LLaMA_7B_S1_R1_L10_ffn_down</title>
<path fill="none" stroke="black" d="M9008.15,-3681.41C9007.37,-3664.56 9006.2,-3639.3 9005.3,-3619.88"/>
<polygon fill="black" stroke="black" points="9008.79,-3619.61 9004.84,-3609.79 9001.8,-3619.94 9008.79,-3619.61"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_ar2 -->
<g id="node119" class="node">
<title>LLaMA_7B_S1_R1_L10_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8984" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8984" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="8984" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L10_ar2 -->
<g id="edge109" class="edge">
<title>LLaMA_7B_S1_R1_L10_ffn_down&#45;&gt;LLaMA_7B_S1_R1_L10_ar2</title>
<path fill="none" stroke="black" d="M9000.88,-3571.63C8998.04,-3555.19 8993.77,-3530.45 8990.23,-3509.97"/>
<polygon fill="black" stroke="black" points="8993.66,-3509.27 8988.51,-3500.01 8986.77,-3510.46 8993.66,-3509.27"/>
</g>
<!-- LLaMA_7B_S1_R1_L10_res2 -->
<g id="node120" class="node">
<title>LLaMA_7B_S1_R1_L10_res2</title>
<polygon fill="lightyellow" stroke="black" points="9061.84,-3374 8922.11,-3374 8886.16,-3338 9025.89,-3338 9061.84,-3374"/>
<text text-anchor="middle" x="8974" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_ar2&#45;&gt;LLaMA_7B_S1_R1_L10_res2 -->
<g id="edge110" class="edge">
<title>LLaMA_7B_S1_R1_L10_ar2&#45;&gt;LLaMA_7B_S1_R1_L10_res2</title>
<path fill="none" stroke="black" d="M8981.73,-3445.8C8980.13,-3427.43 8977.99,-3402.88 8976.37,-3384.25"/>
<polygon fill="black" stroke="black" points="8979.84,-3383.72 8975.49,-3374.06 8972.87,-3384.32 8979.84,-3383.72"/>
</g>
<!-- LLaMA_7B_comm_1_2 -->
<g id="node721" class="node">
<title>LLaMA_7B_comm_1_2</title>
<ellipse fill="lightyellow" stroke="black" stroke-dasharray="5,2" cx="8602" cy="-3228.52" rx="194.41" ry="37.45"/>
<text text-anchor="middle" x="8602" y="-3239.82" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="8602" y="-3224.82" font-family="Times,serif" font-size="14.00">Stage 1 → 2</text>
<text text-anchor="middle" x="8602" y="-3209.82" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]</text>
</g>
<!-- LLaMA_7B_S1_R1_L10_res2&#45;&gt;LLaMA_7B_comm_1_2 -->
<g id="edge661" class="edge">
<title>LLaMA_7B_S1_R1_L10_res2&#45;&gt;LLaMA_7B_comm_1_2</title>
<path fill="none" stroke="black" d="M8923.44,-3337.94C8867.95,-3319.22 8777.31,-3288.65 8706.41,-3264.74"/>
<polygon fill="black" stroke="black" points="8707.14,-3261.29 8696.54,-3261.41 8704.9,-3267.92 8707.14,-3261.29"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_split -->
<g id="node121" class="node">
<title>LLaMA_7B_S1_R2_L1_split</title>
<polygon fill="orange" stroke="black" points="8860.53,-4682.96 8209.06,-4682.96 8041.47,-4606.96 8692.94,-4606.96 8860.53,-4682.96"/>
<text text-anchor="middle" x="8451" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="8451" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_norm1 -->
<g id="node122" class="node">
<title>LLaMA_7B_S1_R2_L1_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="8451" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8451" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_split&#45;&gt;LLaMA_7B_S1_R2_L1_norm1 -->
<g id="edge111" class="edge">
<title>LLaMA_7B_S1_R2_L1_split&#45;&gt;LLaMA_7B_S1_R2_L1_norm1</title>
<path fill="none" stroke="black" d="M8451,-4606.75C8451,-4587.54 8451,-4564.2 8451,-4545.16"/>
<polygon fill="black" stroke="black" points="8454.5,-4545.07 8451,-4535.07 8447.5,-4545.07 8454.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_qkv -->
<g id="node123" class="node">
<title>LLaMA_7B_S1_R2_L1_qkv</title>
<polygon fill="lightcoral" stroke="black" points="8597.5,-4409.22 8304.5,-4409.22 8304.5,-4371.22 8597.5,-4371.22 8597.5,-4409.22"/>
<text text-anchor="middle" x="8451" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="8451" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_norm1&#45;&gt;LLaMA_7B_S1_R2_L1_qkv -->
<g id="edge112" class="edge">
<title>LLaMA_7B_S1_R2_L1_norm1&#45;&gt;LLaMA_7B_S1_R2_L1_qkv</title>
<path fill="none" stroke="black" d="M8451,-4481.08C8451,-4462.81 8451,-4438.39 8451,-4419.61"/>
<polygon fill="black" stroke="black" points="8454.5,-4419.57 8451,-4409.57 8447.5,-4419.57 8454.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_attn -->
<g id="node124" class="node">
<title>LLaMA_7B_S1_R2_L1_attn</title>
<polygon fill="lightcoral" stroke="black" points="8597.5,-4299.22 8304.5,-4299.22 8304.5,-4261.22 8597.5,-4261.22 8597.5,-4299.22"/>
<text text-anchor="middle" x="8451" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="8451" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_qkv&#45;&gt;LLaMA_7B_S1_R2_L1_attn -->
<g id="edge113" class="edge">
<title>LLaMA_7B_S1_R2_L1_qkv&#45;&gt;LLaMA_7B_S1_R2_L1_attn</title>
<path fill="none" stroke="black" d="M8451,-4370.9C8451,-4354.04 8451,-4328.78 8451,-4309.36"/>
<polygon fill="black" stroke="black" points="8454.5,-4309.27 8451,-4299.27 8447.5,-4309.27 8454.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_ar1 -->
<g id="node125" class="node">
<title>LLaMA_7B_S1_R2_L1_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8451" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="8451" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_attn&#45;&gt;LLaMA_7B_S1_R2_L1_ar1 -->
<g id="edge114" class="edge">
<title>LLaMA_7B_S1_R2_L1_attn&#45;&gt;LLaMA_7B_S1_R2_L1_ar1</title>
<path fill="none" stroke="black" d="M8451,-4261.11C8451,-4244.74 8451,-4220.15 8451,-4199.73"/>
<polygon fill="black" stroke="black" points="8454.5,-4199.49 8451,-4189.49 8447.5,-4199.49 8454.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_res1 -->
<g id="node126" class="node">
<title>LLaMA_7B_S1_R2_L1_res1</title>
<polygon fill="lightyellow" stroke="black" points="8538.84,-4063.48 8399.11,-4063.48 8363.16,-4027.48 8502.89,-4027.48 8538.84,-4063.48"/>
<text text-anchor="middle" x="8451" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_ar1&#45;&gt;LLaMA_7B_S1_R2_L1_res1 -->
<g id="edge115" class="edge">
<title>LLaMA_7B_S1_R2_L1_ar1&#45;&gt;LLaMA_7B_S1_R2_L1_res1</title>
<path fill="none" stroke="black" d="M8451,-4135.28C8451,-4116.91 8451,-4092.36 8451,-4073.73"/>
<polygon fill="black" stroke="black" points="8454.5,-4073.54 8451,-4063.54 8447.5,-4073.54 8454.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_norm2 -->
<g id="node127" class="node">
<title>LLaMA_7B_S1_R2_L1_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="8451" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="8451" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_res1&#45;&gt;LLaMA_7B_S1_R2_L1_norm2 -->
<g id="edge116" class="edge">
<title>LLaMA_7B_S1_R2_L1_res1&#45;&gt;LLaMA_7B_S1_R2_L1_norm2</title>
<path fill="none" stroke="black" d="M8451,-4027.03C8451,-4010.89 8451,-3986.38 8451,-3965.99"/>
<polygon fill="black" stroke="black" points="8454.5,-3965.76 8451,-3955.76 8447.5,-3965.76 8454.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_up -->
<g id="node128" class="node">
<title>LLaMA_7B_S1_R2_L1_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="8557.5,-3829.74 8344.5,-3829.74 8344.5,-3791.74 8557.5,-3791.74 8557.5,-3829.74"/>
<text text-anchor="middle" x="8451" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8451" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_norm2&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_up -->
<g id="edge117" class="edge">
<title>LLaMA_7B_S1_R2_L1_norm2&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_up</title>
<path fill="none" stroke="black" d="M8451,-3901.6C8451,-3883.33 8451,-3858.91 8451,-3840.13"/>
<polygon fill="black" stroke="black" points="8454.5,-3840.09 8451,-3830.09 8447.5,-3840.09 8454.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_gate -->
<g id="node129" class="node">
<title>LLaMA_7B_S1_R2_L1_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="8557.5,-3719.74 8344.5,-3719.74 8344.5,-3681.74 8557.5,-3681.74 8557.5,-3719.74"/>
<text text-anchor="middle" x="8451" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8451" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_gate -->
<g id="edge118" class="edge">
<title>LLaMA_7B_S1_R2_L1_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_gate</title>
<path fill="none" stroke="black" d="M8451,-3791.41C8451,-3774.56 8451,-3749.3 8451,-3729.88"/>
<polygon fill="black" stroke="black" points="8454.5,-3729.79 8451,-3719.79 8447.5,-3729.79 8454.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_down -->
<g id="node130" class="node">
<title>LLaMA_7B_S1_R2_L1_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="8557.5,-3609.74 8344.5,-3609.74 8344.5,-3571.74 8557.5,-3571.74 8557.5,-3609.74"/>
<text text-anchor="middle" x="8451" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8451" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_down -->
<g id="edge119" class="edge">
<title>LLaMA_7B_S1_R2_L1_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L1_ffn_down</title>
<path fill="none" stroke="black" d="M8451,-3681.41C8451,-3664.56 8451,-3639.3 8451,-3619.88"/>
<polygon fill="black" stroke="black" points="8454.5,-3619.79 8451,-3609.79 8447.5,-3619.79 8454.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_ar2 -->
<g id="node131" class="node">
<title>LLaMA_7B_S1_R2_L1_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8451" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8451" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="8451" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L1_ar2 -->
<g id="edge120" class="edge">
<title>LLaMA_7B_S1_R2_L1_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L1_ar2</title>
<path fill="none" stroke="black" d="M8451,-3571.63C8451,-3555.26 8451,-3530.67 8451,-3510.25"/>
<polygon fill="black" stroke="black" points="8454.5,-3510.01 8451,-3500.01 8447.5,-3510.01 8454.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L1_res2 -->
<g id="node132" class="node">
<title>LLaMA_7B_S1_R2_L1_res2</title>
<polygon fill="lightyellow" stroke="black" points="8538.84,-3374 8399.11,-3374 8363.16,-3338 8502.89,-3338 8538.84,-3374"/>
<text text-anchor="middle" x="8451" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L1_ar2&#45;&gt;LLaMA_7B_S1_R2_L1_res2 -->
<g id="edge121" class="edge">
<title>LLaMA_7B_S1_R2_L1_ar2&#45;&gt;LLaMA_7B_S1_R2_L1_res2</title>
<path fill="none" stroke="black" d="M8451,-3445.8C8451,-3427.43 8451,-3402.88 8451,-3384.25"/>
<polygon fill="black" stroke="black" points="8454.5,-3384.06 8451,-3374.06 8447.5,-3384.06 8454.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_split -->
<g id="node133" class="node">
<title>LLaMA_7B_S1_R2_L2_split</title>
<polygon fill="orange" stroke="black" points="8019.53,-4682.96 7368.06,-4682.96 7200.47,-4606.96 7851.94,-4606.96 8019.53,-4682.96"/>
<text text-anchor="middle" x="7610" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="7610" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_norm1 -->
<g id="node134" class="node">
<title>LLaMA_7B_S1_R2_L2_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="7610" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7610" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7610" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_split&#45;&gt;LLaMA_7B_S1_R2_L2_norm1 -->
<g id="edge122" class="edge">
<title>LLaMA_7B_S1_R2_L2_split&#45;&gt;LLaMA_7B_S1_R2_L2_norm1</title>
<path fill="none" stroke="black" d="M7610,-4606.75C7610,-4587.54 7610,-4564.2 7610,-4545.16"/>
<polygon fill="black" stroke="black" points="7613.5,-4545.07 7610,-4535.07 7606.5,-4545.07 7613.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_qkv -->
<g id="node135" class="node">
<title>LLaMA_7B_S1_R2_L2_qkv</title>
<polygon fill="lightcoral" stroke="black" points="7756.5,-4409.22 7463.5,-4409.22 7463.5,-4371.22 7756.5,-4371.22 7756.5,-4409.22"/>
<text text-anchor="middle" x="7610" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="7610" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_norm1&#45;&gt;LLaMA_7B_S1_R2_L2_qkv -->
<g id="edge123" class="edge">
<title>LLaMA_7B_S1_R2_L2_norm1&#45;&gt;LLaMA_7B_S1_R2_L2_qkv</title>
<path fill="none" stroke="black" d="M7610,-4481.08C7610,-4462.81 7610,-4438.39 7610,-4419.61"/>
<polygon fill="black" stroke="black" points="7613.5,-4419.57 7610,-4409.57 7606.5,-4419.57 7613.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_attn -->
<g id="node136" class="node">
<title>LLaMA_7B_S1_R2_L2_attn</title>
<polygon fill="lightcoral" stroke="black" points="7756.5,-4299.22 7463.5,-4299.22 7463.5,-4261.22 7756.5,-4261.22 7756.5,-4299.22"/>
<text text-anchor="middle" x="7610" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7610" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_qkv&#45;&gt;LLaMA_7B_S1_R2_L2_attn -->
<g id="edge124" class="edge">
<title>LLaMA_7B_S1_R2_L2_qkv&#45;&gt;LLaMA_7B_S1_R2_L2_attn</title>
<path fill="none" stroke="black" d="M7610,-4370.9C7610,-4354.04 7610,-4328.78 7610,-4309.36"/>
<polygon fill="black" stroke="black" points="7613.5,-4309.27 7610,-4299.27 7606.5,-4309.27 7613.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_ar1 -->
<g id="node137" class="node">
<title>LLaMA_7B_S1_R2_L2_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7610" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7610" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7610" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_attn&#45;&gt;LLaMA_7B_S1_R2_L2_ar1 -->
<g id="edge125" class="edge">
<title>LLaMA_7B_S1_R2_L2_attn&#45;&gt;LLaMA_7B_S1_R2_L2_ar1</title>
<path fill="none" stroke="black" d="M7610,-4261.11C7610,-4244.74 7610,-4220.15 7610,-4199.73"/>
<polygon fill="black" stroke="black" points="7613.5,-4199.49 7610,-4189.49 7606.5,-4199.49 7613.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_res1 -->
<g id="node138" class="node">
<title>LLaMA_7B_S1_R2_L2_res1</title>
<polygon fill="lightyellow" stroke="black" points="7697.84,-4063.48 7558.11,-4063.48 7522.16,-4027.48 7661.89,-4027.48 7697.84,-4063.48"/>
<text text-anchor="middle" x="7610" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_ar1&#45;&gt;LLaMA_7B_S1_R2_L2_res1 -->
<g id="edge126" class="edge">
<title>LLaMA_7B_S1_R2_L2_ar1&#45;&gt;LLaMA_7B_S1_R2_L2_res1</title>
<path fill="none" stroke="black" d="M7610,-4135.28C7610,-4116.91 7610,-4092.36 7610,-4073.73"/>
<polygon fill="black" stroke="black" points="7613.5,-4073.54 7610,-4063.54 7606.5,-4073.54 7613.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_norm2 -->
<g id="node139" class="node">
<title>LLaMA_7B_S1_R2_L2_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="7610" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7610" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="7610" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_res1&#45;&gt;LLaMA_7B_S1_R2_L2_norm2 -->
<g id="edge127" class="edge">
<title>LLaMA_7B_S1_R2_L2_res1&#45;&gt;LLaMA_7B_S1_R2_L2_norm2</title>
<path fill="none" stroke="black" d="M7610,-4027.03C7610,-4010.89 7610,-3986.38 7610,-3965.99"/>
<polygon fill="black" stroke="black" points="7613.5,-3965.76 7610,-3955.76 7606.5,-3965.76 7613.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_up -->
<g id="node140" class="node">
<title>LLaMA_7B_S1_R2_L2_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="7716.5,-3829.74 7503.5,-3829.74 7503.5,-3791.74 7716.5,-3791.74 7716.5,-3829.74"/>
<text text-anchor="middle" x="7610" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7610" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_norm2&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_up -->
<g id="edge128" class="edge">
<title>LLaMA_7B_S1_R2_L2_norm2&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_up</title>
<path fill="none" stroke="black" d="M7610,-3901.6C7610,-3883.33 7610,-3858.91 7610,-3840.13"/>
<polygon fill="black" stroke="black" points="7613.5,-3840.09 7610,-3830.09 7606.5,-3840.09 7613.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_gate -->
<g id="node141" class="node">
<title>LLaMA_7B_S1_R2_L2_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="7716.5,-3719.74 7503.5,-3719.74 7503.5,-3681.74 7716.5,-3681.74 7716.5,-3719.74"/>
<text text-anchor="middle" x="7610" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7610" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_gate -->
<g id="edge129" class="edge">
<title>LLaMA_7B_S1_R2_L2_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_gate</title>
<path fill="none" stroke="black" d="M7610,-3791.41C7610,-3774.56 7610,-3749.3 7610,-3729.88"/>
<polygon fill="black" stroke="black" points="7613.5,-3729.79 7610,-3719.79 7606.5,-3729.79 7613.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_down -->
<g id="node142" class="node">
<title>LLaMA_7B_S1_R2_L2_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="7716.5,-3609.74 7503.5,-3609.74 7503.5,-3571.74 7716.5,-3571.74 7716.5,-3609.74"/>
<text text-anchor="middle" x="7610" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7610" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_down -->
<g id="edge130" class="edge">
<title>LLaMA_7B_S1_R2_L2_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L2_ffn_down</title>
<path fill="none" stroke="black" d="M7610,-3681.41C7610,-3664.56 7610,-3639.3 7610,-3619.88"/>
<polygon fill="black" stroke="black" points="7613.5,-3619.79 7610,-3609.79 7606.5,-3619.79 7613.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_ar2 -->
<g id="node143" class="node">
<title>LLaMA_7B_S1_R2_L2_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7610" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7610" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="7610" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L2_ar2 -->
<g id="edge131" class="edge">
<title>LLaMA_7B_S1_R2_L2_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L2_ar2</title>
<path fill="none" stroke="black" d="M7610,-3571.63C7610,-3555.26 7610,-3530.67 7610,-3510.25"/>
<polygon fill="black" stroke="black" points="7613.5,-3510.01 7610,-3500.01 7606.5,-3510.01 7613.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L2_res2 -->
<g id="node144" class="node">
<title>LLaMA_7B_S1_R2_L2_res2</title>
<polygon fill="lightyellow" stroke="black" points="7697.84,-3374 7558.11,-3374 7522.16,-3338 7661.89,-3338 7697.84,-3374"/>
<text text-anchor="middle" x="7610" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L2_ar2&#45;&gt;LLaMA_7B_S1_R2_L2_res2 -->
<g id="edge132" class="edge">
<title>LLaMA_7B_S1_R2_L2_ar2&#45;&gt;LLaMA_7B_S1_R2_L2_res2</title>
<path fill="none" stroke="black" d="M7610,-3445.8C7610,-3427.43 7610,-3402.88 7610,-3384.25"/>
<polygon fill="black" stroke="black" points="7613.5,-3384.06 7610,-3374.06 7606.5,-3384.06 7613.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_split -->
<g id="node145" class="node">
<title>LLaMA_7B_S1_R2_L3_split</title>
<polygon fill="orange" stroke="black" points="7178.53,-4682.96 6527.06,-4682.96 6359.47,-4606.96 7010.94,-4606.96 7178.53,-4682.96"/>
<text text-anchor="middle" x="6769" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="6769" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_norm1 -->
<g id="node146" class="node">
<title>LLaMA_7B_S1_R2_L3_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="6769" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6769" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6769" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_split&#45;&gt;LLaMA_7B_S1_R2_L3_norm1 -->
<g id="edge133" class="edge">
<title>LLaMA_7B_S1_R2_L3_split&#45;&gt;LLaMA_7B_S1_R2_L3_norm1</title>
<path fill="none" stroke="black" d="M6769,-4606.75C6769,-4587.54 6769,-4564.2 6769,-4545.16"/>
<polygon fill="black" stroke="black" points="6772.5,-4545.07 6769,-4535.07 6765.5,-4545.07 6772.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_qkv -->
<g id="node147" class="node">
<title>LLaMA_7B_S1_R2_L3_qkv</title>
<polygon fill="lightcoral" stroke="black" points="6915.5,-4409.22 6622.5,-4409.22 6622.5,-4371.22 6915.5,-4371.22 6915.5,-4409.22"/>
<text text-anchor="middle" x="6769" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="6769" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_norm1&#45;&gt;LLaMA_7B_S1_R2_L3_qkv -->
<g id="edge134" class="edge">
<title>LLaMA_7B_S1_R2_L3_norm1&#45;&gt;LLaMA_7B_S1_R2_L3_qkv</title>
<path fill="none" stroke="black" d="M6769,-4481.08C6769,-4462.81 6769,-4438.39 6769,-4419.61"/>
<polygon fill="black" stroke="black" points="6772.5,-4419.57 6769,-4409.57 6765.5,-4419.57 6772.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_attn -->
<g id="node148" class="node">
<title>LLaMA_7B_S1_R2_L3_attn</title>
<polygon fill="lightcoral" stroke="black" points="6915.5,-4299.22 6622.5,-4299.22 6622.5,-4261.22 6915.5,-4261.22 6915.5,-4299.22"/>
<text text-anchor="middle" x="6769" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6769" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_qkv&#45;&gt;LLaMA_7B_S1_R2_L3_attn -->
<g id="edge135" class="edge">
<title>LLaMA_7B_S1_R2_L3_qkv&#45;&gt;LLaMA_7B_S1_R2_L3_attn</title>
<path fill="none" stroke="black" d="M6769,-4370.9C6769,-4354.04 6769,-4328.78 6769,-4309.36"/>
<polygon fill="black" stroke="black" points="6772.5,-4309.27 6769,-4299.27 6765.5,-4309.27 6772.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_ar1 -->
<g id="node149" class="node">
<title>LLaMA_7B_S1_R2_L3_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6769" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6769" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6769" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_attn&#45;&gt;LLaMA_7B_S1_R2_L3_ar1 -->
<g id="edge136" class="edge">
<title>LLaMA_7B_S1_R2_L3_attn&#45;&gt;LLaMA_7B_S1_R2_L3_ar1</title>
<path fill="none" stroke="black" d="M6769,-4261.11C6769,-4244.74 6769,-4220.15 6769,-4199.73"/>
<polygon fill="black" stroke="black" points="6772.5,-4199.49 6769,-4189.49 6765.5,-4199.49 6772.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_res1 -->
<g id="node150" class="node">
<title>LLaMA_7B_S1_R2_L3_res1</title>
<polygon fill="lightyellow" stroke="black" points="6856.84,-4063.48 6717.11,-4063.48 6681.16,-4027.48 6820.89,-4027.48 6856.84,-4063.48"/>
<text text-anchor="middle" x="6769" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_ar1&#45;&gt;LLaMA_7B_S1_R2_L3_res1 -->
<g id="edge137" class="edge">
<title>LLaMA_7B_S1_R2_L3_ar1&#45;&gt;LLaMA_7B_S1_R2_L3_res1</title>
<path fill="none" stroke="black" d="M6769,-4135.28C6769,-4116.91 6769,-4092.36 6769,-4073.73"/>
<polygon fill="black" stroke="black" points="6772.5,-4073.54 6769,-4063.54 6765.5,-4073.54 6772.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_norm2 -->
<g id="node151" class="node">
<title>LLaMA_7B_S1_R2_L3_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="6769" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6769" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="6769" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_res1&#45;&gt;LLaMA_7B_S1_R2_L3_norm2 -->
<g id="edge138" class="edge">
<title>LLaMA_7B_S1_R2_L3_res1&#45;&gt;LLaMA_7B_S1_R2_L3_norm2</title>
<path fill="none" stroke="black" d="M6769,-4027.03C6769,-4010.89 6769,-3986.38 6769,-3965.99"/>
<polygon fill="black" stroke="black" points="6772.5,-3965.76 6769,-3955.76 6765.5,-3965.76 6772.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_up -->
<g id="node152" class="node">
<title>LLaMA_7B_S1_R2_L3_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="6875.5,-3829.74 6662.5,-3829.74 6662.5,-3791.74 6875.5,-3791.74 6875.5,-3829.74"/>
<text text-anchor="middle" x="6769" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6769" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_norm2&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_up -->
<g id="edge139" class="edge">
<title>LLaMA_7B_S1_R2_L3_norm2&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_up</title>
<path fill="none" stroke="black" d="M6769,-3901.6C6769,-3883.33 6769,-3858.91 6769,-3840.13"/>
<polygon fill="black" stroke="black" points="6772.5,-3840.09 6769,-3830.09 6765.5,-3840.09 6772.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_gate -->
<g id="node153" class="node">
<title>LLaMA_7B_S1_R2_L3_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="6875.5,-3719.74 6662.5,-3719.74 6662.5,-3681.74 6875.5,-3681.74 6875.5,-3719.74"/>
<text text-anchor="middle" x="6769" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6769" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_gate -->
<g id="edge140" class="edge">
<title>LLaMA_7B_S1_R2_L3_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_gate</title>
<path fill="none" stroke="black" d="M6769,-3791.41C6769,-3774.56 6769,-3749.3 6769,-3729.88"/>
<polygon fill="black" stroke="black" points="6772.5,-3729.79 6769,-3719.79 6765.5,-3729.79 6772.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_down -->
<g id="node154" class="node">
<title>LLaMA_7B_S1_R2_L3_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="6875.5,-3609.74 6662.5,-3609.74 6662.5,-3571.74 6875.5,-3571.74 6875.5,-3609.74"/>
<text text-anchor="middle" x="6769" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6769" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_down -->
<g id="edge141" class="edge">
<title>LLaMA_7B_S1_R2_L3_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L3_ffn_down</title>
<path fill="none" stroke="black" d="M6769,-3681.41C6769,-3664.56 6769,-3639.3 6769,-3619.88"/>
<polygon fill="black" stroke="black" points="6772.5,-3619.79 6769,-3609.79 6765.5,-3619.79 6772.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_ar2 -->
<g id="node155" class="node">
<title>LLaMA_7B_S1_R2_L3_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6769" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6769" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="6769" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L3_ar2 -->
<g id="edge142" class="edge">
<title>LLaMA_7B_S1_R2_L3_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L3_ar2</title>
<path fill="none" stroke="black" d="M6769,-3571.63C6769,-3555.26 6769,-3530.67 6769,-3510.25"/>
<polygon fill="black" stroke="black" points="6772.5,-3510.01 6769,-3500.01 6765.5,-3510.01 6772.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L3_res2 -->
<g id="node156" class="node">
<title>LLaMA_7B_S1_R2_L3_res2</title>
<polygon fill="lightyellow" stroke="black" points="6856.84,-3374 6717.11,-3374 6681.16,-3338 6820.89,-3338 6856.84,-3374"/>
<text text-anchor="middle" x="6769" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L3_ar2&#45;&gt;LLaMA_7B_S1_R2_L3_res2 -->
<g id="edge143" class="edge">
<title>LLaMA_7B_S1_R2_L3_ar2&#45;&gt;LLaMA_7B_S1_R2_L3_res2</title>
<path fill="none" stroke="black" d="M6769,-3445.8C6769,-3427.43 6769,-3402.88 6769,-3384.25"/>
<polygon fill="black" stroke="black" points="6772.5,-3384.06 6769,-3374.06 6765.5,-3384.06 6772.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_split -->
<g id="node157" class="node">
<title>LLaMA_7B_S1_R2_L4_split</title>
<polygon fill="orange" stroke="black" points="6337.53,-4682.96 5686.06,-4682.96 5518.47,-4606.96 6169.94,-4606.96 6337.53,-4682.96"/>
<text text-anchor="middle" x="5928" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="5928" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_norm1 -->
<g id="node158" class="node">
<title>LLaMA_7B_S1_R2_L4_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="5928" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5928" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5928" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_split&#45;&gt;LLaMA_7B_S1_R2_L4_norm1 -->
<g id="edge144" class="edge">
<title>LLaMA_7B_S1_R2_L4_split&#45;&gt;LLaMA_7B_S1_R2_L4_norm1</title>
<path fill="none" stroke="black" d="M5928,-4606.75C5928,-4587.54 5928,-4564.2 5928,-4545.16"/>
<polygon fill="black" stroke="black" points="5931.5,-4545.07 5928,-4535.07 5924.5,-4545.07 5931.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_qkv -->
<g id="node159" class="node">
<title>LLaMA_7B_S1_R2_L4_qkv</title>
<polygon fill="lightcoral" stroke="black" points="6074.5,-4409.22 5781.5,-4409.22 5781.5,-4371.22 6074.5,-4371.22 6074.5,-4409.22"/>
<text text-anchor="middle" x="5928" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="5928" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_norm1&#45;&gt;LLaMA_7B_S1_R2_L4_qkv -->
<g id="edge145" class="edge">
<title>LLaMA_7B_S1_R2_L4_norm1&#45;&gt;LLaMA_7B_S1_R2_L4_qkv</title>
<path fill="none" stroke="black" d="M5928,-4481.08C5928,-4462.81 5928,-4438.39 5928,-4419.61"/>
<polygon fill="black" stroke="black" points="5931.5,-4419.57 5928,-4409.57 5924.5,-4419.57 5931.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_attn -->
<g id="node160" class="node">
<title>LLaMA_7B_S1_R2_L4_attn</title>
<polygon fill="lightcoral" stroke="black" points="6074.5,-4299.22 5781.5,-4299.22 5781.5,-4261.22 6074.5,-4261.22 6074.5,-4299.22"/>
<text text-anchor="middle" x="5928" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5928" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_qkv&#45;&gt;LLaMA_7B_S1_R2_L4_attn -->
<g id="edge146" class="edge">
<title>LLaMA_7B_S1_R2_L4_qkv&#45;&gt;LLaMA_7B_S1_R2_L4_attn</title>
<path fill="none" stroke="black" d="M5928,-4370.9C5928,-4354.04 5928,-4328.78 5928,-4309.36"/>
<polygon fill="black" stroke="black" points="5931.5,-4309.27 5928,-4299.27 5924.5,-4309.27 5931.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_ar1 -->
<g id="node161" class="node">
<title>LLaMA_7B_S1_R2_L4_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5928" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5928" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5928" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_attn&#45;&gt;LLaMA_7B_S1_R2_L4_ar1 -->
<g id="edge147" class="edge">
<title>LLaMA_7B_S1_R2_L4_attn&#45;&gt;LLaMA_7B_S1_R2_L4_ar1</title>
<path fill="none" stroke="black" d="M5928,-4261.11C5928,-4244.74 5928,-4220.15 5928,-4199.73"/>
<polygon fill="black" stroke="black" points="5931.5,-4199.49 5928,-4189.49 5924.5,-4199.49 5931.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_res1 -->
<g id="node162" class="node">
<title>LLaMA_7B_S1_R2_L4_res1</title>
<polygon fill="lightyellow" stroke="black" points="6015.84,-4063.48 5876.11,-4063.48 5840.16,-4027.48 5979.89,-4027.48 6015.84,-4063.48"/>
<text text-anchor="middle" x="5928" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_ar1&#45;&gt;LLaMA_7B_S1_R2_L4_res1 -->
<g id="edge148" class="edge">
<title>LLaMA_7B_S1_R2_L4_ar1&#45;&gt;LLaMA_7B_S1_R2_L4_res1</title>
<path fill="none" stroke="black" d="M5928,-4135.28C5928,-4116.91 5928,-4092.36 5928,-4073.73"/>
<polygon fill="black" stroke="black" points="5931.5,-4073.54 5928,-4063.54 5924.5,-4073.54 5931.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_norm2 -->
<g id="node163" class="node">
<title>LLaMA_7B_S1_R2_L4_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="5928" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5928" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5928" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_res1&#45;&gt;LLaMA_7B_S1_R2_L4_norm2 -->
<g id="edge149" class="edge">
<title>LLaMA_7B_S1_R2_L4_res1&#45;&gt;LLaMA_7B_S1_R2_L4_norm2</title>
<path fill="none" stroke="black" d="M5928,-4027.03C5928,-4010.89 5928,-3986.38 5928,-3965.99"/>
<polygon fill="black" stroke="black" points="5931.5,-3965.76 5928,-3955.76 5924.5,-3965.76 5931.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_up -->
<g id="node164" class="node">
<title>LLaMA_7B_S1_R2_L4_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="6034.5,-3829.74 5821.5,-3829.74 5821.5,-3791.74 6034.5,-3791.74 6034.5,-3829.74"/>
<text text-anchor="middle" x="5928" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5928" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_norm2&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_up -->
<g id="edge150" class="edge">
<title>LLaMA_7B_S1_R2_L4_norm2&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_up</title>
<path fill="none" stroke="black" d="M5928,-3901.6C5928,-3883.33 5928,-3858.91 5928,-3840.13"/>
<polygon fill="black" stroke="black" points="5931.5,-3840.09 5928,-3830.09 5924.5,-3840.09 5931.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_gate -->
<g id="node165" class="node">
<title>LLaMA_7B_S1_R2_L4_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="6034.5,-3719.74 5821.5,-3719.74 5821.5,-3681.74 6034.5,-3681.74 6034.5,-3719.74"/>
<text text-anchor="middle" x="5928" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5928" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_gate -->
<g id="edge151" class="edge">
<title>LLaMA_7B_S1_R2_L4_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_gate</title>
<path fill="none" stroke="black" d="M5928,-3791.41C5928,-3774.56 5928,-3749.3 5928,-3729.88"/>
<polygon fill="black" stroke="black" points="5931.5,-3729.79 5928,-3719.79 5924.5,-3729.79 5931.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_down -->
<g id="node166" class="node">
<title>LLaMA_7B_S1_R2_L4_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="6034.5,-3609.74 5821.5,-3609.74 5821.5,-3571.74 6034.5,-3571.74 6034.5,-3609.74"/>
<text text-anchor="middle" x="5928" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5928" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_down -->
<g id="edge152" class="edge">
<title>LLaMA_7B_S1_R2_L4_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L4_ffn_down</title>
<path fill="none" stroke="black" d="M5928,-3681.41C5928,-3664.56 5928,-3639.3 5928,-3619.88"/>
<polygon fill="black" stroke="black" points="5931.5,-3619.79 5928,-3609.79 5924.5,-3619.79 5931.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_ar2 -->
<g id="node167" class="node">
<title>LLaMA_7B_S1_R2_L4_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5928" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5928" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="5928" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L4_ar2 -->
<g id="edge153" class="edge">
<title>LLaMA_7B_S1_R2_L4_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L4_ar2</title>
<path fill="none" stroke="black" d="M5928,-3571.63C5928,-3555.26 5928,-3530.67 5928,-3510.25"/>
<polygon fill="black" stroke="black" points="5931.5,-3510.01 5928,-3500.01 5924.5,-3510.01 5931.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L4_res2 -->
<g id="node168" class="node">
<title>LLaMA_7B_S1_R2_L4_res2</title>
<polygon fill="lightyellow" stroke="black" points="6015.84,-3374 5876.11,-3374 5840.16,-3338 5979.89,-3338 6015.84,-3374"/>
<text text-anchor="middle" x="5928" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L4_ar2&#45;&gt;LLaMA_7B_S1_R2_L4_res2 -->
<g id="edge154" class="edge">
<title>LLaMA_7B_S1_R2_L4_ar2&#45;&gt;LLaMA_7B_S1_R2_L4_res2</title>
<path fill="none" stroke="black" d="M5928,-3445.8C5928,-3427.43 5928,-3402.88 5928,-3384.25"/>
<polygon fill="black" stroke="black" points="5931.5,-3384.06 5928,-3374.06 5924.5,-3384.06 5931.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_split -->
<g id="node169" class="node">
<title>LLaMA_7B_S1_R2_L5_split</title>
<polygon fill="orange" stroke="black" points="5496.53,-4682.96 4845.06,-4682.96 4677.47,-4606.96 5328.94,-4606.96 5496.53,-4682.96"/>
<text text-anchor="middle" x="5087" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="5087" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_norm1 -->
<g id="node170" class="node">
<title>LLaMA_7B_S1_R2_L5_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="5087" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5087" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5087" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_split&#45;&gt;LLaMA_7B_S1_R2_L5_norm1 -->
<g id="edge155" class="edge">
<title>LLaMA_7B_S1_R2_L5_split&#45;&gt;LLaMA_7B_S1_R2_L5_norm1</title>
<path fill="none" stroke="black" d="M5087,-4606.75C5087,-4587.54 5087,-4564.2 5087,-4545.16"/>
<polygon fill="black" stroke="black" points="5090.5,-4545.07 5087,-4535.07 5083.5,-4545.07 5090.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_qkv -->
<g id="node171" class="node">
<title>LLaMA_7B_S1_R2_L5_qkv</title>
<polygon fill="lightcoral" stroke="black" points="5233.5,-4409.22 4940.5,-4409.22 4940.5,-4371.22 5233.5,-4371.22 5233.5,-4409.22"/>
<text text-anchor="middle" x="5087" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="5087" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_norm1&#45;&gt;LLaMA_7B_S1_R2_L5_qkv -->
<g id="edge156" class="edge">
<title>LLaMA_7B_S1_R2_L5_norm1&#45;&gt;LLaMA_7B_S1_R2_L5_qkv</title>
<path fill="none" stroke="black" d="M5087,-4481.08C5087,-4462.81 5087,-4438.39 5087,-4419.61"/>
<polygon fill="black" stroke="black" points="5090.5,-4419.57 5087,-4409.57 5083.5,-4419.57 5090.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_attn -->
<g id="node172" class="node">
<title>LLaMA_7B_S1_R2_L5_attn</title>
<polygon fill="lightcoral" stroke="black" points="5233.5,-4299.22 4940.5,-4299.22 4940.5,-4261.22 5233.5,-4261.22 5233.5,-4299.22"/>
<text text-anchor="middle" x="5087" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5087" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_qkv&#45;&gt;LLaMA_7B_S1_R2_L5_attn -->
<g id="edge157" class="edge">
<title>LLaMA_7B_S1_R2_L5_qkv&#45;&gt;LLaMA_7B_S1_R2_L5_attn</title>
<path fill="none" stroke="black" d="M5087,-4370.9C5087,-4354.04 5087,-4328.78 5087,-4309.36"/>
<polygon fill="black" stroke="black" points="5090.5,-4309.27 5087,-4299.27 5083.5,-4309.27 5090.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_ar1 -->
<g id="node173" class="node">
<title>LLaMA_7B_S1_R2_L5_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5087" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5087" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5087" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_attn&#45;&gt;LLaMA_7B_S1_R2_L5_ar1 -->
<g id="edge158" class="edge">
<title>LLaMA_7B_S1_R2_L5_attn&#45;&gt;LLaMA_7B_S1_R2_L5_ar1</title>
<path fill="none" stroke="black" d="M5087,-4261.11C5087,-4244.74 5087,-4220.15 5087,-4199.73"/>
<polygon fill="black" stroke="black" points="5090.5,-4199.49 5087,-4189.49 5083.5,-4199.49 5090.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_res1 -->
<g id="node174" class="node">
<title>LLaMA_7B_S1_R2_L5_res1</title>
<polygon fill="lightyellow" stroke="black" points="5174.84,-4063.48 5035.11,-4063.48 4999.16,-4027.48 5138.89,-4027.48 5174.84,-4063.48"/>
<text text-anchor="middle" x="5087" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_ar1&#45;&gt;LLaMA_7B_S1_R2_L5_res1 -->
<g id="edge159" class="edge">
<title>LLaMA_7B_S1_R2_L5_ar1&#45;&gt;LLaMA_7B_S1_R2_L5_res1</title>
<path fill="none" stroke="black" d="M5087,-4135.28C5087,-4116.91 5087,-4092.36 5087,-4073.73"/>
<polygon fill="black" stroke="black" points="5090.5,-4073.54 5087,-4063.54 5083.5,-4073.54 5090.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_norm2 -->
<g id="node175" class="node">
<title>LLaMA_7B_S1_R2_L5_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="5087" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5087" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5087" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_res1&#45;&gt;LLaMA_7B_S1_R2_L5_norm2 -->
<g id="edge160" class="edge">
<title>LLaMA_7B_S1_R2_L5_res1&#45;&gt;LLaMA_7B_S1_R2_L5_norm2</title>
<path fill="none" stroke="black" d="M5087,-4027.03C5087,-4010.89 5087,-3986.38 5087,-3965.99"/>
<polygon fill="black" stroke="black" points="5090.5,-3965.76 5087,-3955.76 5083.5,-3965.76 5090.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_up -->
<g id="node176" class="node">
<title>LLaMA_7B_S1_R2_L5_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="5193.5,-3829.74 4980.5,-3829.74 4980.5,-3791.74 5193.5,-3791.74 5193.5,-3829.74"/>
<text text-anchor="middle" x="5087" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5087" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_norm2&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_up -->
<g id="edge161" class="edge">
<title>LLaMA_7B_S1_R2_L5_norm2&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_up</title>
<path fill="none" stroke="black" d="M5087,-3901.6C5087,-3883.33 5087,-3858.91 5087,-3840.13"/>
<polygon fill="black" stroke="black" points="5090.5,-3840.09 5087,-3830.09 5083.5,-3840.09 5090.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_gate -->
<g id="node177" class="node">
<title>LLaMA_7B_S1_R2_L5_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="5193.5,-3719.74 4980.5,-3719.74 4980.5,-3681.74 5193.5,-3681.74 5193.5,-3719.74"/>
<text text-anchor="middle" x="5087" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5087" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_gate -->
<g id="edge162" class="edge">
<title>LLaMA_7B_S1_R2_L5_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_gate</title>
<path fill="none" stroke="black" d="M5087,-3791.41C5087,-3774.56 5087,-3749.3 5087,-3729.88"/>
<polygon fill="black" stroke="black" points="5090.5,-3729.79 5087,-3719.79 5083.5,-3729.79 5090.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_down -->
<g id="node178" class="node">
<title>LLaMA_7B_S1_R2_L5_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="5193.5,-3609.74 4980.5,-3609.74 4980.5,-3571.74 5193.5,-3571.74 5193.5,-3609.74"/>
<text text-anchor="middle" x="5087" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5087" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_down -->
<g id="edge163" class="edge">
<title>LLaMA_7B_S1_R2_L5_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L5_ffn_down</title>
<path fill="none" stroke="black" d="M5087,-3681.41C5087,-3664.56 5087,-3639.3 5087,-3619.88"/>
<polygon fill="black" stroke="black" points="5090.5,-3619.79 5087,-3609.79 5083.5,-3619.79 5090.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_ar2 -->
<g id="node179" class="node">
<title>LLaMA_7B_S1_R2_L5_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5087" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5087" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="5087" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L5_ar2 -->
<g id="edge164" class="edge">
<title>LLaMA_7B_S1_R2_L5_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L5_ar2</title>
<path fill="none" stroke="black" d="M5087,-3571.63C5087,-3555.26 5087,-3530.67 5087,-3510.25"/>
<polygon fill="black" stroke="black" points="5090.5,-3510.01 5087,-3500.01 5083.5,-3510.01 5090.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L5_res2 -->
<g id="node180" class="node">
<title>LLaMA_7B_S1_R2_L5_res2</title>
<polygon fill="lightyellow" stroke="black" points="5174.84,-3374 5035.11,-3374 4999.16,-3338 5138.89,-3338 5174.84,-3374"/>
<text text-anchor="middle" x="5087" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L5_ar2&#45;&gt;LLaMA_7B_S1_R2_L5_res2 -->
<g id="edge165" class="edge">
<title>LLaMA_7B_S1_R2_L5_ar2&#45;&gt;LLaMA_7B_S1_R2_L5_res2</title>
<path fill="none" stroke="black" d="M5087,-3445.8C5087,-3427.43 5087,-3402.88 5087,-3384.25"/>
<polygon fill="black" stroke="black" points="5090.5,-3384.06 5087,-3374.06 5083.5,-3384.06 5090.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_split -->
<g id="node181" class="node">
<title>LLaMA_7B_S1_R2_L6_split</title>
<polygon fill="orange" stroke="black" points="4655.53,-4682.96 4004.06,-4682.96 3836.47,-4606.96 4487.94,-4606.96 4655.53,-4682.96"/>
<text text-anchor="middle" x="4246" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="4246" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_norm1 -->
<g id="node182" class="node">
<title>LLaMA_7B_S1_R2_L6_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="4246" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4246" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4246" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_split&#45;&gt;LLaMA_7B_S1_R2_L6_norm1 -->
<g id="edge166" class="edge">
<title>LLaMA_7B_S1_R2_L6_split&#45;&gt;LLaMA_7B_S1_R2_L6_norm1</title>
<path fill="none" stroke="black" d="M4246,-4606.75C4246,-4587.54 4246,-4564.2 4246,-4545.16"/>
<polygon fill="black" stroke="black" points="4249.5,-4545.07 4246,-4535.07 4242.5,-4545.07 4249.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_qkv -->
<g id="node183" class="node">
<title>LLaMA_7B_S1_R2_L6_qkv</title>
<polygon fill="lightcoral" stroke="black" points="4392.5,-4409.22 4099.5,-4409.22 4099.5,-4371.22 4392.5,-4371.22 4392.5,-4409.22"/>
<text text-anchor="middle" x="4246" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="4246" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_norm1&#45;&gt;LLaMA_7B_S1_R2_L6_qkv -->
<g id="edge167" class="edge">
<title>LLaMA_7B_S1_R2_L6_norm1&#45;&gt;LLaMA_7B_S1_R2_L6_qkv</title>
<path fill="none" stroke="black" d="M4246,-4481.08C4246,-4462.81 4246,-4438.39 4246,-4419.61"/>
<polygon fill="black" stroke="black" points="4249.5,-4419.57 4246,-4409.57 4242.5,-4419.57 4249.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_attn -->
<g id="node184" class="node">
<title>LLaMA_7B_S1_R2_L6_attn</title>
<polygon fill="lightcoral" stroke="black" points="4392.5,-4299.22 4099.5,-4299.22 4099.5,-4261.22 4392.5,-4261.22 4392.5,-4299.22"/>
<text text-anchor="middle" x="4246" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="4246" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_qkv&#45;&gt;LLaMA_7B_S1_R2_L6_attn -->
<g id="edge168" class="edge">
<title>LLaMA_7B_S1_R2_L6_qkv&#45;&gt;LLaMA_7B_S1_R2_L6_attn</title>
<path fill="none" stroke="black" d="M4246,-4370.9C4246,-4354.04 4246,-4328.78 4246,-4309.36"/>
<polygon fill="black" stroke="black" points="4249.5,-4309.27 4246,-4299.27 4242.5,-4309.27 4249.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_ar1 -->
<g id="node185" class="node">
<title>LLaMA_7B_S1_R2_L6_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4246" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4246" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4246" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_attn&#45;&gt;LLaMA_7B_S1_R2_L6_ar1 -->
<g id="edge169" class="edge">
<title>LLaMA_7B_S1_R2_L6_attn&#45;&gt;LLaMA_7B_S1_R2_L6_ar1</title>
<path fill="none" stroke="black" d="M4246,-4261.11C4246,-4244.74 4246,-4220.15 4246,-4199.73"/>
<polygon fill="black" stroke="black" points="4249.5,-4199.49 4246,-4189.49 4242.5,-4199.49 4249.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_res1 -->
<g id="node186" class="node">
<title>LLaMA_7B_S1_R2_L6_res1</title>
<polygon fill="lightyellow" stroke="black" points="4333.84,-4063.48 4194.11,-4063.48 4158.16,-4027.48 4297.89,-4027.48 4333.84,-4063.48"/>
<text text-anchor="middle" x="4246" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_ar1&#45;&gt;LLaMA_7B_S1_R2_L6_res1 -->
<g id="edge170" class="edge">
<title>LLaMA_7B_S1_R2_L6_ar1&#45;&gt;LLaMA_7B_S1_R2_L6_res1</title>
<path fill="none" stroke="black" d="M4246,-4135.28C4246,-4116.91 4246,-4092.36 4246,-4073.73"/>
<polygon fill="black" stroke="black" points="4249.5,-4073.54 4246,-4063.54 4242.5,-4073.54 4249.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_norm2 -->
<g id="node187" class="node">
<title>LLaMA_7B_S1_R2_L6_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="4246" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4246" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="4246" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_res1&#45;&gt;LLaMA_7B_S1_R2_L6_norm2 -->
<g id="edge171" class="edge">
<title>LLaMA_7B_S1_R2_L6_res1&#45;&gt;LLaMA_7B_S1_R2_L6_norm2</title>
<path fill="none" stroke="black" d="M4246,-4027.03C4246,-4010.89 4246,-3986.38 4246,-3965.99"/>
<polygon fill="black" stroke="black" points="4249.5,-3965.76 4246,-3955.76 4242.5,-3965.76 4249.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_up -->
<g id="node188" class="node">
<title>LLaMA_7B_S1_R2_L6_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="4352.5,-3829.74 4139.5,-3829.74 4139.5,-3791.74 4352.5,-3791.74 4352.5,-3829.74"/>
<text text-anchor="middle" x="4246" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4246" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_norm2&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_up -->
<g id="edge172" class="edge">
<title>LLaMA_7B_S1_R2_L6_norm2&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_up</title>
<path fill="none" stroke="black" d="M4246,-3901.6C4246,-3883.33 4246,-3858.91 4246,-3840.13"/>
<polygon fill="black" stroke="black" points="4249.5,-3840.09 4246,-3830.09 4242.5,-3840.09 4249.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_gate -->
<g id="node189" class="node">
<title>LLaMA_7B_S1_R2_L6_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="4352.5,-3719.74 4139.5,-3719.74 4139.5,-3681.74 4352.5,-3681.74 4352.5,-3719.74"/>
<text text-anchor="middle" x="4246" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4246" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_gate -->
<g id="edge173" class="edge">
<title>LLaMA_7B_S1_R2_L6_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_gate</title>
<path fill="none" stroke="black" d="M4246,-3791.41C4246,-3774.56 4246,-3749.3 4246,-3729.88"/>
<polygon fill="black" stroke="black" points="4249.5,-3729.79 4246,-3719.79 4242.5,-3729.79 4249.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_down -->
<g id="node190" class="node">
<title>LLaMA_7B_S1_R2_L6_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="4352.5,-3609.74 4139.5,-3609.74 4139.5,-3571.74 4352.5,-3571.74 4352.5,-3609.74"/>
<text text-anchor="middle" x="4246" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4246" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_down -->
<g id="edge174" class="edge">
<title>LLaMA_7B_S1_R2_L6_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L6_ffn_down</title>
<path fill="none" stroke="black" d="M4246,-3681.41C4246,-3664.56 4246,-3639.3 4246,-3619.88"/>
<polygon fill="black" stroke="black" points="4249.5,-3619.79 4246,-3609.79 4242.5,-3619.79 4249.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_ar2 -->
<g id="node191" class="node">
<title>LLaMA_7B_S1_R2_L6_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4246" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4246" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="4246" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L6_ar2 -->
<g id="edge175" class="edge">
<title>LLaMA_7B_S1_R2_L6_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L6_ar2</title>
<path fill="none" stroke="black" d="M4246,-3571.63C4246,-3555.26 4246,-3530.67 4246,-3510.25"/>
<polygon fill="black" stroke="black" points="4249.5,-3510.01 4246,-3500.01 4242.5,-3510.01 4249.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L6_res2 -->
<g id="node192" class="node">
<title>LLaMA_7B_S1_R2_L6_res2</title>
<polygon fill="lightyellow" stroke="black" points="4333.84,-3374 4194.11,-3374 4158.16,-3338 4297.89,-3338 4333.84,-3374"/>
<text text-anchor="middle" x="4246" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L6_ar2&#45;&gt;LLaMA_7B_S1_R2_L6_res2 -->
<g id="edge176" class="edge">
<title>LLaMA_7B_S1_R2_L6_ar2&#45;&gt;LLaMA_7B_S1_R2_L6_res2</title>
<path fill="none" stroke="black" d="M4246,-3445.8C4246,-3427.43 4246,-3402.88 4246,-3384.25"/>
<polygon fill="black" stroke="black" points="4249.5,-3384.06 4246,-3374.06 4242.5,-3384.06 4249.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_split -->
<g id="node193" class="node">
<title>LLaMA_7B_S1_R2_L7_split</title>
<polygon fill="orange" stroke="black" points="3814.53,-4682.96 3163.06,-4682.96 2995.47,-4606.96 3646.94,-4606.96 3814.53,-4682.96"/>
<text text-anchor="middle" x="3405" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="3405" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_norm1 -->
<g id="node194" class="node">
<title>LLaMA_7B_S1_R2_L7_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="3405" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3405" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_split&#45;&gt;LLaMA_7B_S1_R2_L7_norm1 -->
<g id="edge177" class="edge">
<title>LLaMA_7B_S1_R2_L7_split&#45;&gt;LLaMA_7B_S1_R2_L7_norm1</title>
<path fill="none" stroke="black" d="M3405,-4606.75C3405,-4587.54 3405,-4564.2 3405,-4545.16"/>
<polygon fill="black" stroke="black" points="3408.5,-4545.07 3405,-4535.07 3401.5,-4545.07 3408.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_qkv -->
<g id="node195" class="node">
<title>LLaMA_7B_S1_R2_L7_qkv</title>
<polygon fill="lightcoral" stroke="black" points="3551.5,-4409.22 3258.5,-4409.22 3258.5,-4371.22 3551.5,-4371.22 3551.5,-4409.22"/>
<text text-anchor="middle" x="3405" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="3405" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_norm1&#45;&gt;LLaMA_7B_S1_R2_L7_qkv -->
<g id="edge178" class="edge">
<title>LLaMA_7B_S1_R2_L7_norm1&#45;&gt;LLaMA_7B_S1_R2_L7_qkv</title>
<path fill="none" stroke="black" d="M3405,-4481.08C3405,-4462.81 3405,-4438.39 3405,-4419.61"/>
<polygon fill="black" stroke="black" points="3408.5,-4419.57 3405,-4409.57 3401.5,-4419.57 3408.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_attn -->
<g id="node196" class="node">
<title>LLaMA_7B_S1_R2_L7_attn</title>
<polygon fill="lightcoral" stroke="black" points="3551.5,-4299.22 3258.5,-4299.22 3258.5,-4261.22 3551.5,-4261.22 3551.5,-4299.22"/>
<text text-anchor="middle" x="3405" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="3405" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_qkv&#45;&gt;LLaMA_7B_S1_R2_L7_attn -->
<g id="edge179" class="edge">
<title>LLaMA_7B_S1_R2_L7_qkv&#45;&gt;LLaMA_7B_S1_R2_L7_attn</title>
<path fill="none" stroke="black" d="M3405,-4370.9C3405,-4354.04 3405,-4328.78 3405,-4309.36"/>
<polygon fill="black" stroke="black" points="3408.5,-4309.27 3405,-4299.27 3401.5,-4309.27 3408.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_ar1 -->
<g id="node197" class="node">
<title>LLaMA_7B_S1_R2_L7_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3405" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3405" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_attn&#45;&gt;LLaMA_7B_S1_R2_L7_ar1 -->
<g id="edge180" class="edge">
<title>LLaMA_7B_S1_R2_L7_attn&#45;&gt;LLaMA_7B_S1_R2_L7_ar1</title>
<path fill="none" stroke="black" d="M3405,-4261.11C3405,-4244.74 3405,-4220.15 3405,-4199.73"/>
<polygon fill="black" stroke="black" points="3408.5,-4199.49 3405,-4189.49 3401.5,-4199.49 3408.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_res1 -->
<g id="node198" class="node">
<title>LLaMA_7B_S1_R2_L7_res1</title>
<polygon fill="lightyellow" stroke="black" points="3492.84,-4063.48 3353.11,-4063.48 3317.16,-4027.48 3456.89,-4027.48 3492.84,-4063.48"/>
<text text-anchor="middle" x="3405" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_ar1&#45;&gt;LLaMA_7B_S1_R2_L7_res1 -->
<g id="edge181" class="edge">
<title>LLaMA_7B_S1_R2_L7_ar1&#45;&gt;LLaMA_7B_S1_R2_L7_res1</title>
<path fill="none" stroke="black" d="M3405,-4135.28C3405,-4116.91 3405,-4092.36 3405,-4073.73"/>
<polygon fill="black" stroke="black" points="3408.5,-4073.54 3405,-4063.54 3401.5,-4073.54 3408.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_norm2 -->
<g id="node199" class="node">
<title>LLaMA_7B_S1_R2_L7_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="3405" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="3405" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_res1&#45;&gt;LLaMA_7B_S1_R2_L7_norm2 -->
<g id="edge182" class="edge">
<title>LLaMA_7B_S1_R2_L7_res1&#45;&gt;LLaMA_7B_S1_R2_L7_norm2</title>
<path fill="none" stroke="black" d="M3405,-4027.03C3405,-4010.89 3405,-3986.38 3405,-3965.99"/>
<polygon fill="black" stroke="black" points="3408.5,-3965.76 3405,-3955.76 3401.5,-3965.76 3408.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_up -->
<g id="node200" class="node">
<title>LLaMA_7B_S1_R2_L7_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="3511.5,-3829.74 3298.5,-3829.74 3298.5,-3791.74 3511.5,-3791.74 3511.5,-3829.74"/>
<text text-anchor="middle" x="3405" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3405" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_norm2&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_up -->
<g id="edge183" class="edge">
<title>LLaMA_7B_S1_R2_L7_norm2&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_up</title>
<path fill="none" stroke="black" d="M3405,-3901.6C3405,-3883.33 3405,-3858.91 3405,-3840.13"/>
<polygon fill="black" stroke="black" points="3408.5,-3840.09 3405,-3830.09 3401.5,-3840.09 3408.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_gate -->
<g id="node201" class="node">
<title>LLaMA_7B_S1_R2_L7_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="3511.5,-3719.74 3298.5,-3719.74 3298.5,-3681.74 3511.5,-3681.74 3511.5,-3719.74"/>
<text text-anchor="middle" x="3405" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3405" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_gate -->
<g id="edge184" class="edge">
<title>LLaMA_7B_S1_R2_L7_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_gate</title>
<path fill="none" stroke="black" d="M3405,-3791.41C3405,-3774.56 3405,-3749.3 3405,-3729.88"/>
<polygon fill="black" stroke="black" points="3408.5,-3729.79 3405,-3719.79 3401.5,-3729.79 3408.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_down -->
<g id="node202" class="node">
<title>LLaMA_7B_S1_R2_L7_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="3511.5,-3609.74 3298.5,-3609.74 3298.5,-3571.74 3511.5,-3571.74 3511.5,-3609.74"/>
<text text-anchor="middle" x="3405" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3405" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_down -->
<g id="edge185" class="edge">
<title>LLaMA_7B_S1_R2_L7_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L7_ffn_down</title>
<path fill="none" stroke="black" d="M3405,-3681.41C3405,-3664.56 3405,-3639.3 3405,-3619.88"/>
<polygon fill="black" stroke="black" points="3408.5,-3619.79 3405,-3609.79 3401.5,-3619.79 3408.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_ar2 -->
<g id="node203" class="node">
<title>LLaMA_7B_S1_R2_L7_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3405" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="3405" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L7_ar2 -->
<g id="edge186" class="edge">
<title>LLaMA_7B_S1_R2_L7_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L7_ar2</title>
<path fill="none" stroke="black" d="M3405,-3571.63C3405,-3555.26 3405,-3530.67 3405,-3510.25"/>
<polygon fill="black" stroke="black" points="3408.5,-3510.01 3405,-3500.01 3401.5,-3510.01 3408.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L7_res2 -->
<g id="node204" class="node">
<title>LLaMA_7B_S1_R2_L7_res2</title>
<polygon fill="lightyellow" stroke="black" points="3492.84,-3374 3353.11,-3374 3317.16,-3338 3456.89,-3338 3492.84,-3374"/>
<text text-anchor="middle" x="3405" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L7_ar2&#45;&gt;LLaMA_7B_S1_R2_L7_res2 -->
<g id="edge187" class="edge">
<title>LLaMA_7B_S1_R2_L7_ar2&#45;&gt;LLaMA_7B_S1_R2_L7_res2</title>
<path fill="none" stroke="black" d="M3405,-3445.8C3405,-3427.43 3405,-3402.88 3405,-3384.25"/>
<polygon fill="black" stroke="black" points="3408.5,-3384.06 3405,-3374.06 3401.5,-3384.06 3408.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_split -->
<g id="node205" class="node">
<title>LLaMA_7B_S1_R2_L8_split</title>
<polygon fill="orange" stroke="black" points="2973.53,-4682.96 2322.06,-4682.96 2154.47,-4606.96 2805.94,-4606.96 2973.53,-4682.96"/>
<text text-anchor="middle" x="2564" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="2564" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_norm1 -->
<g id="node206" class="node">
<title>LLaMA_7B_S1_R2_L8_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="2564" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2564" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2564" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_split&#45;&gt;LLaMA_7B_S1_R2_L8_norm1 -->
<g id="edge188" class="edge">
<title>LLaMA_7B_S1_R2_L8_split&#45;&gt;LLaMA_7B_S1_R2_L8_norm1</title>
<path fill="none" stroke="black" d="M2564,-4606.75C2564,-4587.54 2564,-4564.2 2564,-4545.16"/>
<polygon fill="black" stroke="black" points="2567.5,-4545.07 2564,-4535.07 2560.5,-4545.07 2567.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_qkv -->
<g id="node207" class="node">
<title>LLaMA_7B_S1_R2_L8_qkv</title>
<polygon fill="lightcoral" stroke="black" points="2710.5,-4409.22 2417.5,-4409.22 2417.5,-4371.22 2710.5,-4371.22 2710.5,-4409.22"/>
<text text-anchor="middle" x="2564" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="2564" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_norm1&#45;&gt;LLaMA_7B_S1_R2_L8_qkv -->
<g id="edge189" class="edge">
<title>LLaMA_7B_S1_R2_L8_norm1&#45;&gt;LLaMA_7B_S1_R2_L8_qkv</title>
<path fill="none" stroke="black" d="M2564,-4481.08C2564,-4462.81 2564,-4438.39 2564,-4419.61"/>
<polygon fill="black" stroke="black" points="2567.5,-4419.57 2564,-4409.57 2560.5,-4419.57 2567.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_attn -->
<g id="node208" class="node">
<title>LLaMA_7B_S1_R2_L8_attn</title>
<polygon fill="lightcoral" stroke="black" points="2710.5,-4299.22 2417.5,-4299.22 2417.5,-4261.22 2710.5,-4261.22 2710.5,-4299.22"/>
<text text-anchor="middle" x="2564" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="2564" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_qkv&#45;&gt;LLaMA_7B_S1_R2_L8_attn -->
<g id="edge190" class="edge">
<title>LLaMA_7B_S1_R2_L8_qkv&#45;&gt;LLaMA_7B_S1_R2_L8_attn</title>
<path fill="none" stroke="black" d="M2564,-4370.9C2564,-4354.04 2564,-4328.78 2564,-4309.36"/>
<polygon fill="black" stroke="black" points="2567.5,-4309.27 2564,-4299.27 2560.5,-4309.27 2567.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_ar1 -->
<g id="node209" class="node">
<title>LLaMA_7B_S1_R2_L8_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2564" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2564" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2564" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_attn&#45;&gt;LLaMA_7B_S1_R2_L8_ar1 -->
<g id="edge191" class="edge">
<title>LLaMA_7B_S1_R2_L8_attn&#45;&gt;LLaMA_7B_S1_R2_L8_ar1</title>
<path fill="none" stroke="black" d="M2564,-4261.11C2564,-4244.74 2564,-4220.15 2564,-4199.73"/>
<polygon fill="black" stroke="black" points="2567.5,-4199.49 2564,-4189.49 2560.5,-4199.49 2567.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_res1 -->
<g id="node210" class="node">
<title>LLaMA_7B_S1_R2_L8_res1</title>
<polygon fill="lightyellow" stroke="black" points="2651.84,-4063.48 2512.11,-4063.48 2476.16,-4027.48 2615.89,-4027.48 2651.84,-4063.48"/>
<text text-anchor="middle" x="2564" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_ar1&#45;&gt;LLaMA_7B_S1_R2_L8_res1 -->
<g id="edge192" class="edge">
<title>LLaMA_7B_S1_R2_L8_ar1&#45;&gt;LLaMA_7B_S1_R2_L8_res1</title>
<path fill="none" stroke="black" d="M2564,-4135.28C2564,-4116.91 2564,-4092.36 2564,-4073.73"/>
<polygon fill="black" stroke="black" points="2567.5,-4073.54 2564,-4063.54 2560.5,-4073.54 2567.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_norm2 -->
<g id="node211" class="node">
<title>LLaMA_7B_S1_R2_L8_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="2564" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2564" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="2564" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_res1&#45;&gt;LLaMA_7B_S1_R2_L8_norm2 -->
<g id="edge193" class="edge">
<title>LLaMA_7B_S1_R2_L8_res1&#45;&gt;LLaMA_7B_S1_R2_L8_norm2</title>
<path fill="none" stroke="black" d="M2564,-4027.03C2564,-4010.89 2564,-3986.38 2564,-3965.99"/>
<polygon fill="black" stroke="black" points="2567.5,-3965.76 2564,-3955.76 2560.5,-3965.76 2567.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_up -->
<g id="node212" class="node">
<title>LLaMA_7B_S1_R2_L8_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="2670.5,-3829.74 2457.5,-3829.74 2457.5,-3791.74 2670.5,-3791.74 2670.5,-3829.74"/>
<text text-anchor="middle" x="2564" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2564" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_norm2&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_up -->
<g id="edge194" class="edge">
<title>LLaMA_7B_S1_R2_L8_norm2&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_up</title>
<path fill="none" stroke="black" d="M2564,-3901.6C2564,-3883.33 2564,-3858.91 2564,-3840.13"/>
<polygon fill="black" stroke="black" points="2567.5,-3840.09 2564,-3830.09 2560.5,-3840.09 2567.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_gate -->
<g id="node213" class="node">
<title>LLaMA_7B_S1_R2_L8_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="2670.5,-3719.74 2457.5,-3719.74 2457.5,-3681.74 2670.5,-3681.74 2670.5,-3719.74"/>
<text text-anchor="middle" x="2564" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2564" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_gate -->
<g id="edge195" class="edge">
<title>LLaMA_7B_S1_R2_L8_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_gate</title>
<path fill="none" stroke="black" d="M2564,-3791.41C2564,-3774.56 2564,-3749.3 2564,-3729.88"/>
<polygon fill="black" stroke="black" points="2567.5,-3729.79 2564,-3719.79 2560.5,-3729.79 2567.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_down -->
<g id="node214" class="node">
<title>LLaMA_7B_S1_R2_L8_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="2670.5,-3609.74 2457.5,-3609.74 2457.5,-3571.74 2670.5,-3571.74 2670.5,-3609.74"/>
<text text-anchor="middle" x="2564" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2564" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_down -->
<g id="edge196" class="edge">
<title>LLaMA_7B_S1_R2_L8_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L8_ffn_down</title>
<path fill="none" stroke="black" d="M2564,-3681.41C2564,-3664.56 2564,-3639.3 2564,-3619.88"/>
<polygon fill="black" stroke="black" points="2567.5,-3619.79 2564,-3609.79 2560.5,-3619.79 2567.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_ar2 -->
<g id="node215" class="node">
<title>LLaMA_7B_S1_R2_L8_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2564" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2564" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="2564" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L8_ar2 -->
<g id="edge197" class="edge">
<title>LLaMA_7B_S1_R2_L8_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L8_ar2</title>
<path fill="none" stroke="black" d="M2564,-3571.63C2564,-3555.26 2564,-3530.67 2564,-3510.25"/>
<polygon fill="black" stroke="black" points="2567.5,-3510.01 2564,-3500.01 2560.5,-3510.01 2567.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L8_res2 -->
<g id="node216" class="node">
<title>LLaMA_7B_S1_R2_L8_res2</title>
<polygon fill="lightyellow" stroke="black" points="2651.84,-3374 2512.11,-3374 2476.16,-3338 2615.89,-3338 2651.84,-3374"/>
<text text-anchor="middle" x="2564" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L8_ar2&#45;&gt;LLaMA_7B_S1_R2_L8_res2 -->
<g id="edge198" class="edge">
<title>LLaMA_7B_S1_R2_L8_ar2&#45;&gt;LLaMA_7B_S1_R2_L8_res2</title>
<path fill="none" stroke="black" d="M2564,-3445.8C2564,-3427.43 2564,-3402.88 2564,-3384.25"/>
<polygon fill="black" stroke="black" points="2567.5,-3384.06 2564,-3374.06 2560.5,-3384.06 2567.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_split -->
<g id="node217" class="node">
<title>LLaMA_7B_S1_R2_L9_split</title>
<polygon fill="orange" stroke="black" points="2132.53,-4682.96 1481.06,-4682.96 1313.47,-4606.96 1964.94,-4606.96 2132.53,-4682.96"/>
<text text-anchor="middle" x="1723" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="1723" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_norm1 -->
<g id="node218" class="node">
<title>LLaMA_7B_S1_R2_L9_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="1723" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1723" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1723" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_split&#45;&gt;LLaMA_7B_S1_R2_L9_norm1 -->
<g id="edge199" class="edge">
<title>LLaMA_7B_S1_R2_L9_split&#45;&gt;LLaMA_7B_S1_R2_L9_norm1</title>
<path fill="none" stroke="black" d="M1723,-4606.75C1723,-4587.54 1723,-4564.2 1723,-4545.16"/>
<polygon fill="black" stroke="black" points="1726.5,-4545.07 1723,-4535.07 1719.5,-4545.07 1726.5,-4545.07"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_qkv -->
<g id="node219" class="node">
<title>LLaMA_7B_S1_R2_L9_qkv</title>
<polygon fill="lightcoral" stroke="black" points="1869.5,-4409.22 1576.5,-4409.22 1576.5,-4371.22 1869.5,-4371.22 1869.5,-4409.22"/>
<text text-anchor="middle" x="1723" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1723" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_norm1&#45;&gt;LLaMA_7B_S1_R2_L9_qkv -->
<g id="edge200" class="edge">
<title>LLaMA_7B_S1_R2_L9_norm1&#45;&gt;LLaMA_7B_S1_R2_L9_qkv</title>
<path fill="none" stroke="black" d="M1723,-4481.08C1723,-4462.81 1723,-4438.39 1723,-4419.61"/>
<polygon fill="black" stroke="black" points="1726.5,-4419.57 1723,-4409.57 1719.5,-4419.57 1726.5,-4419.57"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_attn -->
<g id="node220" class="node">
<title>LLaMA_7B_S1_R2_L9_attn</title>
<polygon fill="lightcoral" stroke="black" points="1869.5,-4299.22 1576.5,-4299.22 1576.5,-4261.22 1869.5,-4261.22 1869.5,-4299.22"/>
<text text-anchor="middle" x="1723" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1723" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_qkv&#45;&gt;LLaMA_7B_S1_R2_L9_attn -->
<g id="edge201" class="edge">
<title>LLaMA_7B_S1_R2_L9_qkv&#45;&gt;LLaMA_7B_S1_R2_L9_attn</title>
<path fill="none" stroke="black" d="M1723,-4370.9C1723,-4354.04 1723,-4328.78 1723,-4309.36"/>
<polygon fill="black" stroke="black" points="1726.5,-4309.27 1723,-4299.27 1719.5,-4309.27 1726.5,-4309.27"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_ar1 -->
<g id="node221" class="node">
<title>LLaMA_7B_S1_R2_L9_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1723" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1723" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1723" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_attn&#45;&gt;LLaMA_7B_S1_R2_L9_ar1 -->
<g id="edge202" class="edge">
<title>LLaMA_7B_S1_R2_L9_attn&#45;&gt;LLaMA_7B_S1_R2_L9_ar1</title>
<path fill="none" stroke="black" d="M1723,-4261.11C1723,-4244.74 1723,-4220.15 1723,-4199.73"/>
<polygon fill="black" stroke="black" points="1726.5,-4199.49 1723,-4189.49 1719.5,-4199.49 1726.5,-4199.49"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_res1 -->
<g id="node222" class="node">
<title>LLaMA_7B_S1_R2_L9_res1</title>
<polygon fill="lightyellow" stroke="black" points="1810.84,-4063.48 1671.11,-4063.48 1635.16,-4027.48 1774.89,-4027.48 1810.84,-4063.48"/>
<text text-anchor="middle" x="1723" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_ar1&#45;&gt;LLaMA_7B_S1_R2_L9_res1 -->
<g id="edge203" class="edge">
<title>LLaMA_7B_S1_R2_L9_ar1&#45;&gt;LLaMA_7B_S1_R2_L9_res1</title>
<path fill="none" stroke="black" d="M1723,-4135.28C1723,-4116.91 1723,-4092.36 1723,-4073.73"/>
<polygon fill="black" stroke="black" points="1726.5,-4073.54 1723,-4063.54 1719.5,-4073.54 1726.5,-4073.54"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_norm2 -->
<g id="node223" class="node">
<title>LLaMA_7B_S1_R2_L9_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="1723" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1723" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1723" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_res1&#45;&gt;LLaMA_7B_S1_R2_L9_norm2 -->
<g id="edge204" class="edge">
<title>LLaMA_7B_S1_R2_L9_res1&#45;&gt;LLaMA_7B_S1_R2_L9_norm2</title>
<path fill="none" stroke="black" d="M1723,-4027.03C1723,-4010.89 1723,-3986.38 1723,-3965.99"/>
<polygon fill="black" stroke="black" points="1726.5,-3965.76 1723,-3955.76 1719.5,-3965.76 1726.5,-3965.76"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_up -->
<g id="node224" class="node">
<title>LLaMA_7B_S1_R2_L9_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="1829.5,-3829.74 1616.5,-3829.74 1616.5,-3791.74 1829.5,-3791.74 1829.5,-3829.74"/>
<text text-anchor="middle" x="1723" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1723" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_norm2&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_up -->
<g id="edge205" class="edge">
<title>LLaMA_7B_S1_R2_L9_norm2&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_up</title>
<path fill="none" stroke="black" d="M1723,-3901.6C1723,-3883.33 1723,-3858.91 1723,-3840.13"/>
<polygon fill="black" stroke="black" points="1726.5,-3840.09 1723,-3830.09 1719.5,-3840.09 1726.5,-3840.09"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_gate -->
<g id="node225" class="node">
<title>LLaMA_7B_S1_R2_L9_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="1829.5,-3719.74 1616.5,-3719.74 1616.5,-3681.74 1829.5,-3681.74 1829.5,-3719.74"/>
<text text-anchor="middle" x="1723" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1723" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_gate -->
<g id="edge206" class="edge">
<title>LLaMA_7B_S1_R2_L9_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_gate</title>
<path fill="none" stroke="black" d="M1723,-3791.41C1723,-3774.56 1723,-3749.3 1723,-3729.88"/>
<polygon fill="black" stroke="black" points="1726.5,-3729.79 1723,-3719.79 1719.5,-3729.79 1726.5,-3729.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_down -->
<g id="node226" class="node">
<title>LLaMA_7B_S1_R2_L9_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="1829.5,-3609.74 1616.5,-3609.74 1616.5,-3571.74 1829.5,-3571.74 1829.5,-3609.74"/>
<text text-anchor="middle" x="1723" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1723" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_down -->
<g id="edge207" class="edge">
<title>LLaMA_7B_S1_R2_L9_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L9_ffn_down</title>
<path fill="none" stroke="black" d="M1723,-3681.41C1723,-3664.56 1723,-3639.3 1723,-3619.88"/>
<polygon fill="black" stroke="black" points="1726.5,-3619.79 1723,-3609.79 1719.5,-3619.79 1726.5,-3619.79"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_ar2 -->
<g id="node227" class="node">
<title>LLaMA_7B_S1_R2_L9_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1723" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1723" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="1723" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L9_ar2 -->
<g id="edge208" class="edge">
<title>LLaMA_7B_S1_R2_L9_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L9_ar2</title>
<path fill="none" stroke="black" d="M1723,-3571.63C1723,-3555.26 1723,-3530.67 1723,-3510.25"/>
<polygon fill="black" stroke="black" points="1726.5,-3510.01 1723,-3500.01 1719.5,-3510.01 1726.5,-3510.01"/>
</g>
<!-- LLaMA_7B_S1_R2_L9_res2 -->
<g id="node228" class="node">
<title>LLaMA_7B_S1_R2_L9_res2</title>
<polygon fill="lightyellow" stroke="black" points="1810.84,-3374 1671.11,-3374 1635.16,-3338 1774.89,-3338 1810.84,-3374"/>
<text text-anchor="middle" x="1723" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L9_ar2&#45;&gt;LLaMA_7B_S1_R2_L9_res2 -->
<g id="edge209" class="edge">
<title>LLaMA_7B_S1_R2_L9_ar2&#45;&gt;LLaMA_7B_S1_R2_L9_res2</title>
<path fill="none" stroke="black" d="M1723,-3445.8C1723,-3427.43 1723,-3402.88 1723,-3384.25"/>
<polygon fill="black" stroke="black" points="1726.5,-3384.06 1723,-3374.06 1719.5,-3384.06 1726.5,-3384.06"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_split -->
<g id="node229" class="node">
<title>LLaMA_7B_S1_R2_L10_split</title>
<polygon fill="orange" stroke="black" points="1291.53,-4682.96 640.06,-4682.96 472.47,-4606.96 1123.94,-4606.96 1291.53,-4682.96"/>
<text text-anchor="middle" x="882" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="882" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_norm1 -->
<g id="node230" class="node">
<title>LLaMA_7B_S1_R2_L10_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="883" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="883" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="883" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_split&#45;&gt;LLaMA_7B_S1_R2_L10_norm1 -->
<g id="edge210" class="edge">
<title>LLaMA_7B_S1_R2_L10_split&#45;&gt;LLaMA_7B_S1_R2_L10_norm1</title>
<path fill="none" stroke="black" d="M882.28,-4606.75C882.42,-4587.54 882.59,-4564.2 882.73,-4545.16"/>
<polygon fill="black" stroke="black" points="886.23,-4545.1 882.81,-4535.07 879.23,-4545.05 886.23,-4545.1"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_qkv -->
<g id="node231" class="node">
<title>LLaMA_7B_S1_R2_L10_qkv</title>
<polygon fill="lightcoral" stroke="black" points="1292.5,-4409.22 999.5,-4409.22 999.5,-4371.22 1292.5,-4371.22 1292.5,-4409.22"/>
<text text-anchor="middle" x="1146" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1146" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_norm1&#45;&gt;LLaMA_7B_S1_R2_L10_qkv -->
<g id="edge211" class="edge">
<title>LLaMA_7B_S1_R2_L10_norm1&#45;&gt;LLaMA_7B_S1_R2_L10_qkv</title>
<path fill="none" stroke="black" d="M931.54,-4485.7C978.2,-4465.14 1048.4,-4434.21 1095.65,-4413.4"/>
<polygon fill="black" stroke="black" points="1097.34,-4416.48 1105.08,-4409.24 1094.52,-4410.07 1097.34,-4416.48"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_attn -->
<g id="node232" class="node">
<title>LLaMA_7B_S1_R2_L10_attn</title>
<polygon fill="lightcoral" stroke="black" points="1423.5,-4299.22 1130.5,-4299.22 1130.5,-4261.22 1423.5,-4261.22 1423.5,-4299.22"/>
<text text-anchor="middle" x="1277" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1277" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_qkv&#45;&gt;LLaMA_7B_S1_R2_L10_attn -->
<g id="edge212" class="edge">
<title>LLaMA_7B_S1_R2_L10_qkv&#45;&gt;LLaMA_7B_S1_R2_L10_attn</title>
<path fill="none" stroke="black" d="M1167.93,-4371.14C1189.65,-4353.23 1223.08,-4325.67 1247.21,-4305.78"/>
<polygon fill="black" stroke="black" points="1249.51,-4308.41 1255,-4299.35 1245.06,-4303.01 1249.51,-4308.41"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_ar1 -->
<g id="node233" class="node">
<title>LLaMA_7B_S1_R2_L10_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1279" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1279" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1279" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_attn&#45;&gt;LLaMA_7B_S1_R2_L10_ar1 -->
<g id="edge213" class="edge">
<title>LLaMA_7B_S1_R2_L10_attn&#45;&gt;LLaMA_7B_S1_R2_L10_ar1</title>
<path fill="none" stroke="black" d="M1277.31,-4261.11C1277.6,-4244.74 1278.02,-4220.15 1278.37,-4199.73"/>
<polygon fill="black" stroke="black" points="1281.88,-4199.55 1278.55,-4189.49 1274.88,-4199.43 1281.88,-4199.55"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_res1 -->
<g id="node234" class="node">
<title>LLaMA_7B_S1_R2_L10_res1</title>
<polygon fill="lightyellow" stroke="black" points="1419.84,-4063.48 1280.11,-4063.48 1244.16,-4027.48 1383.89,-4027.48 1419.84,-4063.48"/>
<text text-anchor="middle" x="1332" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_ar1&#45;&gt;LLaMA_7B_S1_R2_L10_res1 -->
<g id="edge214" class="edge">
<title>LLaMA_7B_S1_R2_L10_ar1&#45;&gt;LLaMA_7B_S1_R2_L10_res1</title>
<path fill="none" stroke="black" d="M1290.89,-4135.57C1299.52,-4116.87 1311.16,-4091.65 1319.84,-4072.82"/>
<polygon fill="black" stroke="black" points="1323.08,-4074.17 1324.09,-4063.62 1316.72,-4071.24 1323.08,-4074.17"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_norm2 -->
<g id="node235" class="node">
<title>LLaMA_7B_S1_R2_L10_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="1336" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1336" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1336" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_res1&#45;&gt;LLaMA_7B_S1_R2_L10_norm2 -->
<g id="edge215" class="edge">
<title>LLaMA_7B_S1_R2_L10_res1&#45;&gt;LLaMA_7B_S1_R2_L10_norm2</title>
<path fill="none" stroke="black" d="M1332.61,-4027.03C1333.17,-4010.89 1334.02,-3986.38 1334.73,-3965.99"/>
<polygon fill="black" stroke="black" points="1338.24,-3965.88 1335.09,-3955.76 1331.24,-3965.64 1338.24,-3965.88"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_up -->
<g id="node236" class="node">
<title>LLaMA_7B_S1_R2_L10_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="1548.5,-3829.74 1335.5,-3829.74 1335.5,-3791.74 1548.5,-3791.74 1548.5,-3829.74"/>
<text text-anchor="middle" x="1442" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1442" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_norm2&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_up -->
<g id="edge216" class="edge">
<title>LLaMA_7B_S1_R2_L10_norm2&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_up</title>
<path fill="none" stroke="black" d="M1359,-3902.46C1376.55,-3883.28 1400.65,-3856.93 1418.36,-3837.57"/>
<polygon fill="black" stroke="black" points="1421.12,-3839.75 1425.28,-3830.01 1415.95,-3835.02 1421.12,-3839.75"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_gate -->
<g id="node237" class="node">
<title>LLaMA_7B_S1_R2_L10_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="1556.5,-3719.74 1343.5,-3719.74 1343.5,-3681.74 1556.5,-3681.74 1556.5,-3719.74"/>
<text text-anchor="middle" x="1450" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1450" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_gate -->
<g id="edge217" class="edge">
<title>LLaMA_7B_S1_R2_L10_ffn_up&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_gate</title>
<path fill="none" stroke="black" d="M1443.36,-3791.41C1444.61,-3774.56 1446.48,-3749.3 1447.92,-3729.88"/>
<polygon fill="black" stroke="black" points="1451.41,-3730.02 1448.66,-3719.79 1444.43,-3729.5 1451.41,-3730.02"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_down -->
<g id="node238" class="node">
<title>LLaMA_7B_S1_R2_L10_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="1582.5,-3609.74 1369.5,-3609.74 1369.5,-3571.74 1582.5,-3571.74 1582.5,-3609.74"/>
<text text-anchor="middle" x="1476" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1476" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_down -->
<g id="edge218" class="edge">
<title>LLaMA_7B_S1_R2_L10_ffn_gate&#45;&gt;LLaMA_7B_S1_R2_L10_ffn_down</title>
<path fill="none" stroke="black" d="M1454.41,-3681.41C1458.49,-3664.48 1464.61,-3639.07 1469.29,-3619.61"/>
<polygon fill="black" stroke="black" points="1472.72,-3620.33 1471.65,-3609.79 1465.91,-3618.69 1472.72,-3620.33"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_ar2 -->
<g id="node239" class="node">
<title>LLaMA_7B_S1_R2_L10_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1492" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1492" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="1492" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L10_ar2 -->
<g id="edge219" class="edge">
<title>LLaMA_7B_S1_R2_L10_ffn_down&#45;&gt;LLaMA_7B_S1_R2_L10_ar2</title>
<path fill="none" stroke="black" d="M1478.5,-3571.63C1480.77,-3555.19 1484.19,-3530.45 1487.01,-3509.97"/>
<polygon fill="black" stroke="black" points="1490.49,-3510.4 1488.39,-3500.01 1483.55,-3509.44 1490.49,-3510.4"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_res2 -->
<g id="node240" class="node">
<title>LLaMA_7B_S1_R2_L10_res2</title>
<polygon fill="lightyellow" stroke="black" points="1611.84,-3374 1472.11,-3374 1436.16,-3338 1575.89,-3338 1611.84,-3374"/>
<text text-anchor="middle" x="1524" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S1_R2_L10_ar2&#45;&gt;LLaMA_7B_S1_R2_L10_res2 -->
<g id="edge220" class="edge">
<title>LLaMA_7B_S1_R2_L10_ar2&#45;&gt;LLaMA_7B_S1_R2_L10_res2</title>
<path fill="none" stroke="black" d="M1499.26,-3445.8C1504.43,-3427.26 1511.35,-3402.42 1516.55,-3383.73"/>
<polygon fill="black" stroke="black" points="1519.94,-3384.63 1519.25,-3374.06 1513.19,-3382.75 1519.94,-3384.63"/>
</g>
<!-- LLaMA_7B_S1_R2_L10_res2&#45;&gt;LLaMA_7B_comm_1_2 -->
<g id="edge663" class="edge">
<title>LLaMA_7B_S1_R2_L10_res2&#45;&gt;LLaMA_7B_comm_1_2</title>
<path fill="none" stroke="black" d="M1566.1,-3337.93C1583.69,-3331.64 1604.53,-3325.26 1624,-3322 1966.12,-3264.68 7282.12,-3235.9 8397.64,-3230.47"/>
<polygon fill="black" stroke="black" points="8397.78,-3233.97 8407.77,-3230.42 8397.75,-3226.97 8397.78,-3233.97"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_split -->
<g id="node241" class="node">
<title>LLaMA_7B_S2_R1_L11_split</title>
<polygon fill="orange" stroke="black" points="17053.53,-3091.04 16402.06,-3091.04 16234.47,-3015.04 16885.94,-3015.04 17053.53,-3091.04"/>
<text text-anchor="middle" x="16644" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="16644" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_norm1 -->
<g id="node242" class="node">
<title>LLaMA_7B_S2_R1_L11_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="16644" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16644" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_split&#45;&gt;LLaMA_7B_S2_R1_L11_norm1 -->
<g id="edge221" class="edge">
<title>LLaMA_7B_S2_R1_L11_split&#45;&gt;LLaMA_7B_S2_R1_L11_norm1</title>
<path fill="none" stroke="black" d="M16644,-3014.83C16644,-2995.62 16644,-2972.29 16644,-2953.24"/>
<polygon fill="black" stroke="black" points="16647.5,-2953.16 16644,-2943.16 16640.5,-2953.16 16647.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_qkv -->
<g id="node243" class="node">
<title>LLaMA_7B_S2_R1_L11_qkv</title>
<polygon fill="lightcoral" stroke="black" points="16790.5,-2817.3 16497.5,-2817.3 16497.5,-2779.3 16790.5,-2779.3 16790.5,-2817.3"/>
<text text-anchor="middle" x="16644" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="16644" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_norm1&#45;&gt;LLaMA_7B_S2_R1_L11_qkv -->
<g id="edge222" class="edge">
<title>LLaMA_7B_S2_R1_L11_norm1&#45;&gt;LLaMA_7B_S2_R1_L11_qkv</title>
<path fill="none" stroke="black" d="M16644,-2889.17C16644,-2870.9 16644,-2846.47 16644,-2827.7"/>
<polygon fill="black" stroke="black" points="16647.5,-2827.65 16644,-2817.65 16640.5,-2827.65 16647.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_attn -->
<g id="node244" class="node">
<title>LLaMA_7B_S2_R1_L11_attn</title>
<polygon fill="lightcoral" stroke="black" points="16790.5,-2707.3 16497.5,-2707.3 16497.5,-2669.3 16790.5,-2669.3 16790.5,-2707.3"/>
<text text-anchor="middle" x="16644" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="16644" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_qkv&#45;&gt;LLaMA_7B_S2_R1_L11_attn -->
<g id="edge223" class="edge">
<title>LLaMA_7B_S2_R1_L11_qkv&#45;&gt;LLaMA_7B_S2_R1_L11_attn</title>
<path fill="none" stroke="black" d="M16644,-2778.98C16644,-2762.12 16644,-2736.87 16644,-2717.45"/>
<polygon fill="black" stroke="black" points="16647.5,-2717.35 16644,-2707.35 16640.5,-2717.35 16647.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_ar1 -->
<g id="node245" class="node">
<title>LLaMA_7B_S2_R1_L11_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16644" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16644" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_attn&#45;&gt;LLaMA_7B_S2_R1_L11_ar1 -->
<g id="edge224" class="edge">
<title>LLaMA_7B_S2_R1_L11_attn&#45;&gt;LLaMA_7B_S2_R1_L11_ar1</title>
<path fill="none" stroke="black" d="M16644,-2669.2C16644,-2652.83 16644,-2628.24 16644,-2607.81"/>
<polygon fill="black" stroke="black" points="16647.5,-2607.58 16644,-2597.58 16640.5,-2607.58 16647.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_res1 -->
<g id="node246" class="node">
<title>LLaMA_7B_S2_R1_L11_res1</title>
<polygon fill="lightyellow" stroke="black" points="16731.84,-2471.56 16592.11,-2471.56 16556.16,-2435.56 16695.89,-2435.56 16731.84,-2471.56"/>
<text text-anchor="middle" x="16644" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_ar1&#45;&gt;LLaMA_7B_S2_R1_L11_res1 -->
<g id="edge225" class="edge">
<title>LLaMA_7B_S2_R1_L11_ar1&#45;&gt;LLaMA_7B_S2_R1_L11_res1</title>
<path fill="none" stroke="black" d="M16644,-2543.37C16644,-2525 16644,-2500.45 16644,-2481.82"/>
<polygon fill="black" stroke="black" points="16647.5,-2481.62 16644,-2471.62 16640.5,-2481.62 16647.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_norm2 -->
<g id="node247" class="node">
<title>LLaMA_7B_S2_R1_L11_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="16644" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="16644" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_res1&#45;&gt;LLaMA_7B_S2_R1_L11_norm2 -->
<g id="edge226" class="edge">
<title>LLaMA_7B_S2_R1_L11_res1&#45;&gt;LLaMA_7B_S2_R1_L11_norm2</title>
<path fill="none" stroke="black" d="M16644,-2435.12C16644,-2418.97 16644,-2394.47 16644,-2374.07"/>
<polygon fill="black" stroke="black" points="16647.5,-2373.85 16644,-2363.85 16640.5,-2373.85 16647.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_up -->
<g id="node248" class="node">
<title>LLaMA_7B_S2_R1_L11_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-2237.82 16537.5,-2237.82 16537.5,-2199.82 16750.5,-2199.82 16750.5,-2237.82"/>
<text text-anchor="middle" x="16644" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16644" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_norm2&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_up -->
<g id="edge227" class="edge">
<title>LLaMA_7B_S2_R1_L11_norm2&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_up</title>
<path fill="none" stroke="black" d="M16644,-2309.69C16644,-2291.42 16644,-2266.99 16644,-2248.22"/>
<polygon fill="black" stroke="black" points="16647.5,-2248.17 16644,-2238.17 16640.5,-2248.17 16647.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_gate -->
<g id="node249" class="node">
<title>LLaMA_7B_S2_R1_L11_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-2127.82 16537.5,-2127.82 16537.5,-2089.82 16750.5,-2089.82 16750.5,-2127.82"/>
<text text-anchor="middle" x="16644" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16644" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_gate -->
<g id="edge228" class="edge">
<title>LLaMA_7B_S2_R1_L11_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_gate</title>
<path fill="none" stroke="black" d="M16644,-2199.5C16644,-2182.64 16644,-2157.39 16644,-2137.97"/>
<polygon fill="black" stroke="black" points="16647.5,-2137.87 16644,-2127.87 16640.5,-2137.87 16647.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_down -->
<g id="node250" class="node">
<title>LLaMA_7B_S2_R1_L11_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-2017.82 16537.5,-2017.82 16537.5,-1979.82 16750.5,-1979.82 16750.5,-2017.82"/>
<text text-anchor="middle" x="16644" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16644" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_down -->
<g id="edge229" class="edge">
<title>LLaMA_7B_S2_R1_L11_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L11_ffn_down</title>
<path fill="none" stroke="black" d="M16644,-2089.5C16644,-2072.64 16644,-2047.39 16644,-2027.97"/>
<polygon fill="black" stroke="black" points="16647.5,-2027.87 16644,-2017.87 16640.5,-2027.87 16647.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_ar2 -->
<g id="node251" class="node">
<title>LLaMA_7B_S2_R1_L11_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16644" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="16644" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L11_ar2 -->
<g id="edge230" class="edge">
<title>LLaMA_7B_S2_R1_L11_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L11_ar2</title>
<path fill="none" stroke="black" d="M16644,-1979.72C16644,-1963.35 16644,-1938.76 16644,-1918.33"/>
<polygon fill="black" stroke="black" points="16647.5,-1918.1 16644,-1908.1 16640.5,-1918.1 16647.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L11_res2 -->
<g id="node252" class="node">
<title>LLaMA_7B_S2_R1_L11_res2</title>
<polygon fill="lightyellow" stroke="black" points="16731.84,-1782.08 16592.11,-1782.08 16556.16,-1746.08 16695.89,-1746.08 16731.84,-1782.08"/>
<text text-anchor="middle" x="16644" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L11_ar2&#45;&gt;LLaMA_7B_S2_R1_L11_res2 -->
<g id="edge231" class="edge">
<title>LLaMA_7B_S2_R1_L11_ar2&#45;&gt;LLaMA_7B_S2_R1_L11_res2</title>
<path fill="none" stroke="black" d="M16644,-1853.89C16644,-1835.51 16644,-1810.97 16644,-1792.34"/>
<polygon fill="black" stroke="black" points="16647.5,-1792.14 16644,-1782.14 16640.5,-1792.14 16647.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_split -->
<g id="node253" class="node">
<title>LLaMA_7B_S2_R1_L12_split</title>
<polygon fill="orange" stroke="black" points="16212.53,-3091.04 15561.06,-3091.04 15393.47,-3015.04 16044.94,-3015.04 16212.53,-3091.04"/>
<text text-anchor="middle" x="15803" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="15803" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_norm1 -->
<g id="node254" class="node">
<title>LLaMA_7B_S2_R1_L12_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="15803" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15803" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_split&#45;&gt;LLaMA_7B_S2_R1_L12_norm1 -->
<g id="edge232" class="edge">
<title>LLaMA_7B_S2_R1_L12_split&#45;&gt;LLaMA_7B_S2_R1_L12_norm1</title>
<path fill="none" stroke="black" d="M15803,-3014.83C15803,-2995.62 15803,-2972.29 15803,-2953.24"/>
<polygon fill="black" stroke="black" points="15806.5,-2953.16 15803,-2943.16 15799.5,-2953.16 15806.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_qkv -->
<g id="node255" class="node">
<title>LLaMA_7B_S2_R1_L12_qkv</title>
<polygon fill="lightcoral" stroke="black" points="15949.5,-2817.3 15656.5,-2817.3 15656.5,-2779.3 15949.5,-2779.3 15949.5,-2817.3"/>
<text text-anchor="middle" x="15803" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="15803" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_norm1&#45;&gt;LLaMA_7B_S2_R1_L12_qkv -->
<g id="edge233" class="edge">
<title>LLaMA_7B_S2_R1_L12_norm1&#45;&gt;LLaMA_7B_S2_R1_L12_qkv</title>
<path fill="none" stroke="black" d="M15803,-2889.17C15803,-2870.9 15803,-2846.47 15803,-2827.7"/>
<polygon fill="black" stroke="black" points="15806.5,-2827.65 15803,-2817.65 15799.5,-2827.65 15806.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_attn -->
<g id="node256" class="node">
<title>LLaMA_7B_S2_R1_L12_attn</title>
<polygon fill="lightcoral" stroke="black" points="15949.5,-2707.3 15656.5,-2707.3 15656.5,-2669.3 15949.5,-2669.3 15949.5,-2707.3"/>
<text text-anchor="middle" x="15803" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="15803" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_qkv&#45;&gt;LLaMA_7B_S2_R1_L12_attn -->
<g id="edge234" class="edge">
<title>LLaMA_7B_S2_R1_L12_qkv&#45;&gt;LLaMA_7B_S2_R1_L12_attn</title>
<path fill="none" stroke="black" d="M15803,-2778.98C15803,-2762.12 15803,-2736.87 15803,-2717.45"/>
<polygon fill="black" stroke="black" points="15806.5,-2717.35 15803,-2707.35 15799.5,-2717.35 15806.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_ar1 -->
<g id="node257" class="node">
<title>LLaMA_7B_S2_R1_L12_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15803" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="15803" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_attn&#45;&gt;LLaMA_7B_S2_R1_L12_ar1 -->
<g id="edge235" class="edge">
<title>LLaMA_7B_S2_R1_L12_attn&#45;&gt;LLaMA_7B_S2_R1_L12_ar1</title>
<path fill="none" stroke="black" d="M15803,-2669.2C15803,-2652.83 15803,-2628.24 15803,-2607.81"/>
<polygon fill="black" stroke="black" points="15806.5,-2607.58 15803,-2597.58 15799.5,-2607.58 15806.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_res1 -->
<g id="node258" class="node">
<title>LLaMA_7B_S2_R1_L12_res1</title>
<polygon fill="lightyellow" stroke="black" points="15890.84,-2471.56 15751.11,-2471.56 15715.16,-2435.56 15854.89,-2435.56 15890.84,-2471.56"/>
<text text-anchor="middle" x="15803" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_ar1&#45;&gt;LLaMA_7B_S2_R1_L12_res1 -->
<g id="edge236" class="edge">
<title>LLaMA_7B_S2_R1_L12_ar1&#45;&gt;LLaMA_7B_S2_R1_L12_res1</title>
<path fill="none" stroke="black" d="M15803,-2543.37C15803,-2525 15803,-2500.45 15803,-2481.82"/>
<polygon fill="black" stroke="black" points="15806.5,-2481.62 15803,-2471.62 15799.5,-2481.62 15806.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_norm2 -->
<g id="node259" class="node">
<title>LLaMA_7B_S2_R1_L12_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="15803" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="15803" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_res1&#45;&gt;LLaMA_7B_S2_R1_L12_norm2 -->
<g id="edge237" class="edge">
<title>LLaMA_7B_S2_R1_L12_res1&#45;&gt;LLaMA_7B_S2_R1_L12_norm2</title>
<path fill="none" stroke="black" d="M15803,-2435.12C15803,-2418.97 15803,-2394.47 15803,-2374.07"/>
<polygon fill="black" stroke="black" points="15806.5,-2373.85 15803,-2363.85 15799.5,-2373.85 15806.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_up -->
<g id="node260" class="node">
<title>LLaMA_7B_S2_R1_L12_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-2237.82 15696.5,-2237.82 15696.5,-2199.82 15909.5,-2199.82 15909.5,-2237.82"/>
<text text-anchor="middle" x="15803" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15803" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_norm2&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_up -->
<g id="edge238" class="edge">
<title>LLaMA_7B_S2_R1_L12_norm2&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_up</title>
<path fill="none" stroke="black" d="M15803,-2309.69C15803,-2291.42 15803,-2266.99 15803,-2248.22"/>
<polygon fill="black" stroke="black" points="15806.5,-2248.17 15803,-2238.17 15799.5,-2248.17 15806.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_gate -->
<g id="node261" class="node">
<title>LLaMA_7B_S2_R1_L12_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-2127.82 15696.5,-2127.82 15696.5,-2089.82 15909.5,-2089.82 15909.5,-2127.82"/>
<text text-anchor="middle" x="15803" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15803" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_gate -->
<g id="edge239" class="edge">
<title>LLaMA_7B_S2_R1_L12_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_gate</title>
<path fill="none" stroke="black" d="M15803,-2199.5C15803,-2182.64 15803,-2157.39 15803,-2137.97"/>
<polygon fill="black" stroke="black" points="15806.5,-2137.87 15803,-2127.87 15799.5,-2137.87 15806.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_down -->
<g id="node262" class="node">
<title>LLaMA_7B_S2_R1_L12_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-2017.82 15696.5,-2017.82 15696.5,-1979.82 15909.5,-1979.82 15909.5,-2017.82"/>
<text text-anchor="middle" x="15803" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15803" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_down -->
<g id="edge240" class="edge">
<title>LLaMA_7B_S2_R1_L12_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L12_ffn_down</title>
<path fill="none" stroke="black" d="M15803,-2089.5C15803,-2072.64 15803,-2047.39 15803,-2027.97"/>
<polygon fill="black" stroke="black" points="15806.5,-2027.87 15803,-2017.87 15799.5,-2027.87 15806.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_ar2 -->
<g id="node263" class="node">
<title>LLaMA_7B_S2_R1_L12_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15803" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="15803" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L12_ar2 -->
<g id="edge241" class="edge">
<title>LLaMA_7B_S2_R1_L12_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L12_ar2</title>
<path fill="none" stroke="black" d="M15803,-1979.72C15803,-1963.35 15803,-1938.76 15803,-1918.33"/>
<polygon fill="black" stroke="black" points="15806.5,-1918.1 15803,-1908.1 15799.5,-1918.1 15806.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L12_res2 -->
<g id="node264" class="node">
<title>LLaMA_7B_S2_R1_L12_res2</title>
<polygon fill="lightyellow" stroke="black" points="15890.84,-1782.08 15751.11,-1782.08 15715.16,-1746.08 15854.89,-1746.08 15890.84,-1782.08"/>
<text text-anchor="middle" x="15803" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L12_ar2&#45;&gt;LLaMA_7B_S2_R1_L12_res2 -->
<g id="edge242" class="edge">
<title>LLaMA_7B_S2_R1_L12_ar2&#45;&gt;LLaMA_7B_S2_R1_L12_res2</title>
<path fill="none" stroke="black" d="M15803,-1853.89C15803,-1835.51 15803,-1810.97 15803,-1792.34"/>
<polygon fill="black" stroke="black" points="15806.5,-1792.14 15803,-1782.14 15799.5,-1792.14 15806.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_split -->
<g id="node265" class="node">
<title>LLaMA_7B_S2_R1_L13_split</title>
<polygon fill="orange" stroke="black" points="15371.53,-3091.04 14720.06,-3091.04 14552.47,-3015.04 15203.94,-3015.04 15371.53,-3091.04"/>
<text text-anchor="middle" x="14962" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="14962" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_norm1 -->
<g id="node266" class="node">
<title>LLaMA_7B_S2_R1_L13_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="14962" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14962" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_split&#45;&gt;LLaMA_7B_S2_R1_L13_norm1 -->
<g id="edge243" class="edge">
<title>LLaMA_7B_S2_R1_L13_split&#45;&gt;LLaMA_7B_S2_R1_L13_norm1</title>
<path fill="none" stroke="black" d="M14962,-3014.83C14962,-2995.62 14962,-2972.29 14962,-2953.24"/>
<polygon fill="black" stroke="black" points="14965.5,-2953.16 14962,-2943.16 14958.5,-2953.16 14965.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_qkv -->
<g id="node267" class="node">
<title>LLaMA_7B_S2_R1_L13_qkv</title>
<polygon fill="lightcoral" stroke="black" points="15108.5,-2817.3 14815.5,-2817.3 14815.5,-2779.3 15108.5,-2779.3 15108.5,-2817.3"/>
<text text-anchor="middle" x="14962" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="14962" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_norm1&#45;&gt;LLaMA_7B_S2_R1_L13_qkv -->
<g id="edge244" class="edge">
<title>LLaMA_7B_S2_R1_L13_norm1&#45;&gt;LLaMA_7B_S2_R1_L13_qkv</title>
<path fill="none" stroke="black" d="M14962,-2889.17C14962,-2870.9 14962,-2846.47 14962,-2827.7"/>
<polygon fill="black" stroke="black" points="14965.5,-2827.65 14962,-2817.65 14958.5,-2827.65 14965.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_attn -->
<g id="node268" class="node">
<title>LLaMA_7B_S2_R1_L13_attn</title>
<polygon fill="lightcoral" stroke="black" points="15108.5,-2707.3 14815.5,-2707.3 14815.5,-2669.3 15108.5,-2669.3 15108.5,-2707.3"/>
<text text-anchor="middle" x="14962" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="14962" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_qkv&#45;&gt;LLaMA_7B_S2_R1_L13_attn -->
<g id="edge245" class="edge">
<title>LLaMA_7B_S2_R1_L13_qkv&#45;&gt;LLaMA_7B_S2_R1_L13_attn</title>
<path fill="none" stroke="black" d="M14962,-2778.98C14962,-2762.12 14962,-2736.87 14962,-2717.45"/>
<polygon fill="black" stroke="black" points="14965.5,-2717.35 14962,-2707.35 14958.5,-2717.35 14965.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_ar1 -->
<g id="node269" class="node">
<title>LLaMA_7B_S2_R1_L13_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14962" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14962" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_attn&#45;&gt;LLaMA_7B_S2_R1_L13_ar1 -->
<g id="edge246" class="edge">
<title>LLaMA_7B_S2_R1_L13_attn&#45;&gt;LLaMA_7B_S2_R1_L13_ar1</title>
<path fill="none" stroke="black" d="M14962,-2669.2C14962,-2652.83 14962,-2628.24 14962,-2607.81"/>
<polygon fill="black" stroke="black" points="14965.5,-2607.58 14962,-2597.58 14958.5,-2607.58 14965.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_res1 -->
<g id="node270" class="node">
<title>LLaMA_7B_S2_R1_L13_res1</title>
<polygon fill="lightyellow" stroke="black" points="15049.84,-2471.56 14910.11,-2471.56 14874.16,-2435.56 15013.89,-2435.56 15049.84,-2471.56"/>
<text text-anchor="middle" x="14962" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_ar1&#45;&gt;LLaMA_7B_S2_R1_L13_res1 -->
<g id="edge247" class="edge">
<title>LLaMA_7B_S2_R1_L13_ar1&#45;&gt;LLaMA_7B_S2_R1_L13_res1</title>
<path fill="none" stroke="black" d="M14962,-2543.37C14962,-2525 14962,-2500.45 14962,-2481.82"/>
<polygon fill="black" stroke="black" points="14965.5,-2481.62 14962,-2471.62 14958.5,-2481.62 14965.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_norm2 -->
<g id="node271" class="node">
<title>LLaMA_7B_S2_R1_L13_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="14962" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="14962" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_res1&#45;&gt;LLaMA_7B_S2_R1_L13_norm2 -->
<g id="edge248" class="edge">
<title>LLaMA_7B_S2_R1_L13_res1&#45;&gt;LLaMA_7B_S2_R1_L13_norm2</title>
<path fill="none" stroke="black" d="M14962,-2435.12C14962,-2418.97 14962,-2394.47 14962,-2374.07"/>
<polygon fill="black" stroke="black" points="14965.5,-2373.85 14962,-2363.85 14958.5,-2373.85 14965.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_up -->
<g id="node272" class="node">
<title>LLaMA_7B_S2_R1_L13_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-2237.82 14855.5,-2237.82 14855.5,-2199.82 15068.5,-2199.82 15068.5,-2237.82"/>
<text text-anchor="middle" x="14962" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14962" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_norm2&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_up -->
<g id="edge249" class="edge">
<title>LLaMA_7B_S2_R1_L13_norm2&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_up</title>
<path fill="none" stroke="black" d="M14962,-2309.69C14962,-2291.42 14962,-2266.99 14962,-2248.22"/>
<polygon fill="black" stroke="black" points="14965.5,-2248.17 14962,-2238.17 14958.5,-2248.17 14965.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_gate -->
<g id="node273" class="node">
<title>LLaMA_7B_S2_R1_L13_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-2127.82 14855.5,-2127.82 14855.5,-2089.82 15068.5,-2089.82 15068.5,-2127.82"/>
<text text-anchor="middle" x="14962" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14962" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_gate -->
<g id="edge250" class="edge">
<title>LLaMA_7B_S2_R1_L13_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_gate</title>
<path fill="none" stroke="black" d="M14962,-2199.5C14962,-2182.64 14962,-2157.39 14962,-2137.97"/>
<polygon fill="black" stroke="black" points="14965.5,-2137.87 14962,-2127.87 14958.5,-2137.87 14965.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_down -->
<g id="node274" class="node">
<title>LLaMA_7B_S2_R1_L13_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-2017.82 14855.5,-2017.82 14855.5,-1979.82 15068.5,-1979.82 15068.5,-2017.82"/>
<text text-anchor="middle" x="14962" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14962" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_down -->
<g id="edge251" class="edge">
<title>LLaMA_7B_S2_R1_L13_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L13_ffn_down</title>
<path fill="none" stroke="black" d="M14962,-2089.5C14962,-2072.64 14962,-2047.39 14962,-2027.97"/>
<polygon fill="black" stroke="black" points="14965.5,-2027.87 14962,-2017.87 14958.5,-2027.87 14965.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_ar2 -->
<g id="node275" class="node">
<title>LLaMA_7B_S2_R1_L13_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14962" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="14962" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L13_ar2 -->
<g id="edge252" class="edge">
<title>LLaMA_7B_S2_R1_L13_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L13_ar2</title>
<path fill="none" stroke="black" d="M14962,-1979.72C14962,-1963.35 14962,-1938.76 14962,-1918.33"/>
<polygon fill="black" stroke="black" points="14965.5,-1918.1 14962,-1908.1 14958.5,-1918.1 14965.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L13_res2 -->
<g id="node276" class="node">
<title>LLaMA_7B_S2_R1_L13_res2</title>
<polygon fill="lightyellow" stroke="black" points="15049.84,-1782.08 14910.11,-1782.08 14874.16,-1746.08 15013.89,-1746.08 15049.84,-1782.08"/>
<text text-anchor="middle" x="14962" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L13_ar2&#45;&gt;LLaMA_7B_S2_R1_L13_res2 -->
<g id="edge253" class="edge">
<title>LLaMA_7B_S2_R1_L13_ar2&#45;&gt;LLaMA_7B_S2_R1_L13_res2</title>
<path fill="none" stroke="black" d="M14962,-1853.89C14962,-1835.51 14962,-1810.97 14962,-1792.34"/>
<polygon fill="black" stroke="black" points="14965.5,-1792.14 14962,-1782.14 14958.5,-1792.14 14965.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_split -->
<g id="node277" class="node">
<title>LLaMA_7B_S2_R1_L14_split</title>
<polygon fill="orange" stroke="black" points="14530.53,-3091.04 13879.06,-3091.04 13711.47,-3015.04 14362.94,-3015.04 14530.53,-3091.04"/>
<text text-anchor="middle" x="14121" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="14121" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_norm1 -->
<g id="node278" class="node">
<title>LLaMA_7B_S2_R1_L14_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="14121" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14121" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_split&#45;&gt;LLaMA_7B_S2_R1_L14_norm1 -->
<g id="edge254" class="edge">
<title>LLaMA_7B_S2_R1_L14_split&#45;&gt;LLaMA_7B_S2_R1_L14_norm1</title>
<path fill="none" stroke="black" d="M14121,-3014.83C14121,-2995.62 14121,-2972.29 14121,-2953.24"/>
<polygon fill="black" stroke="black" points="14124.5,-2953.16 14121,-2943.16 14117.5,-2953.16 14124.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_qkv -->
<g id="node279" class="node">
<title>LLaMA_7B_S2_R1_L14_qkv</title>
<polygon fill="lightcoral" stroke="black" points="14267.5,-2817.3 13974.5,-2817.3 13974.5,-2779.3 14267.5,-2779.3 14267.5,-2817.3"/>
<text text-anchor="middle" x="14121" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="14121" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_norm1&#45;&gt;LLaMA_7B_S2_R1_L14_qkv -->
<g id="edge255" class="edge">
<title>LLaMA_7B_S2_R1_L14_norm1&#45;&gt;LLaMA_7B_S2_R1_L14_qkv</title>
<path fill="none" stroke="black" d="M14121,-2889.17C14121,-2870.9 14121,-2846.47 14121,-2827.7"/>
<polygon fill="black" stroke="black" points="14124.5,-2827.65 14121,-2817.65 14117.5,-2827.65 14124.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_attn -->
<g id="node280" class="node">
<title>LLaMA_7B_S2_R1_L14_attn</title>
<polygon fill="lightcoral" stroke="black" points="14267.5,-2707.3 13974.5,-2707.3 13974.5,-2669.3 14267.5,-2669.3 14267.5,-2707.3"/>
<text text-anchor="middle" x="14121" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="14121" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_qkv&#45;&gt;LLaMA_7B_S2_R1_L14_attn -->
<g id="edge256" class="edge">
<title>LLaMA_7B_S2_R1_L14_qkv&#45;&gt;LLaMA_7B_S2_R1_L14_attn</title>
<path fill="none" stroke="black" d="M14121,-2778.98C14121,-2762.12 14121,-2736.87 14121,-2717.45"/>
<polygon fill="black" stroke="black" points="14124.5,-2717.35 14121,-2707.35 14117.5,-2717.35 14124.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_ar1 -->
<g id="node281" class="node">
<title>LLaMA_7B_S2_R1_L14_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14121" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14121" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_attn&#45;&gt;LLaMA_7B_S2_R1_L14_ar1 -->
<g id="edge257" class="edge">
<title>LLaMA_7B_S2_R1_L14_attn&#45;&gt;LLaMA_7B_S2_R1_L14_ar1</title>
<path fill="none" stroke="black" d="M14121,-2669.2C14121,-2652.83 14121,-2628.24 14121,-2607.81"/>
<polygon fill="black" stroke="black" points="14124.5,-2607.58 14121,-2597.58 14117.5,-2607.58 14124.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_res1 -->
<g id="node282" class="node">
<title>LLaMA_7B_S2_R1_L14_res1</title>
<polygon fill="lightyellow" stroke="black" points="14208.84,-2471.56 14069.11,-2471.56 14033.16,-2435.56 14172.89,-2435.56 14208.84,-2471.56"/>
<text text-anchor="middle" x="14121" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_ar1&#45;&gt;LLaMA_7B_S2_R1_L14_res1 -->
<g id="edge258" class="edge">
<title>LLaMA_7B_S2_R1_L14_ar1&#45;&gt;LLaMA_7B_S2_R1_L14_res1</title>
<path fill="none" stroke="black" d="M14121,-2543.37C14121,-2525 14121,-2500.45 14121,-2481.82"/>
<polygon fill="black" stroke="black" points="14124.5,-2481.62 14121,-2471.62 14117.5,-2481.62 14124.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_norm2 -->
<g id="node283" class="node">
<title>LLaMA_7B_S2_R1_L14_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="14121" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="14121" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_res1&#45;&gt;LLaMA_7B_S2_R1_L14_norm2 -->
<g id="edge259" class="edge">
<title>LLaMA_7B_S2_R1_L14_res1&#45;&gt;LLaMA_7B_S2_R1_L14_norm2</title>
<path fill="none" stroke="black" d="M14121,-2435.12C14121,-2418.97 14121,-2394.47 14121,-2374.07"/>
<polygon fill="black" stroke="black" points="14124.5,-2373.85 14121,-2363.85 14117.5,-2373.85 14124.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_up -->
<g id="node284" class="node">
<title>LLaMA_7B_S2_R1_L14_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-2237.82 14014.5,-2237.82 14014.5,-2199.82 14227.5,-2199.82 14227.5,-2237.82"/>
<text text-anchor="middle" x="14121" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14121" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_norm2&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_up -->
<g id="edge260" class="edge">
<title>LLaMA_7B_S2_R1_L14_norm2&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_up</title>
<path fill="none" stroke="black" d="M14121,-2309.69C14121,-2291.42 14121,-2266.99 14121,-2248.22"/>
<polygon fill="black" stroke="black" points="14124.5,-2248.17 14121,-2238.17 14117.5,-2248.17 14124.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_gate -->
<g id="node285" class="node">
<title>LLaMA_7B_S2_R1_L14_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-2127.82 14014.5,-2127.82 14014.5,-2089.82 14227.5,-2089.82 14227.5,-2127.82"/>
<text text-anchor="middle" x="14121" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14121" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_gate -->
<g id="edge261" class="edge">
<title>LLaMA_7B_S2_R1_L14_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_gate</title>
<path fill="none" stroke="black" d="M14121,-2199.5C14121,-2182.64 14121,-2157.39 14121,-2137.97"/>
<polygon fill="black" stroke="black" points="14124.5,-2137.87 14121,-2127.87 14117.5,-2137.87 14124.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_down -->
<g id="node286" class="node">
<title>LLaMA_7B_S2_R1_L14_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-2017.82 14014.5,-2017.82 14014.5,-1979.82 14227.5,-1979.82 14227.5,-2017.82"/>
<text text-anchor="middle" x="14121" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14121" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_down -->
<g id="edge262" class="edge">
<title>LLaMA_7B_S2_R1_L14_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L14_ffn_down</title>
<path fill="none" stroke="black" d="M14121,-2089.5C14121,-2072.64 14121,-2047.39 14121,-2027.97"/>
<polygon fill="black" stroke="black" points="14124.5,-2027.87 14121,-2017.87 14117.5,-2027.87 14124.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_ar2 -->
<g id="node287" class="node">
<title>LLaMA_7B_S2_R1_L14_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14121" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="14121" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L14_ar2 -->
<g id="edge263" class="edge">
<title>LLaMA_7B_S2_R1_L14_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L14_ar2</title>
<path fill="none" stroke="black" d="M14121,-1979.72C14121,-1963.35 14121,-1938.76 14121,-1918.33"/>
<polygon fill="black" stroke="black" points="14124.5,-1918.1 14121,-1908.1 14117.5,-1918.1 14124.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L14_res2 -->
<g id="node288" class="node">
<title>LLaMA_7B_S2_R1_L14_res2</title>
<polygon fill="lightyellow" stroke="black" points="14208.84,-1782.08 14069.11,-1782.08 14033.16,-1746.08 14172.89,-1746.08 14208.84,-1782.08"/>
<text text-anchor="middle" x="14121" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L14_ar2&#45;&gt;LLaMA_7B_S2_R1_L14_res2 -->
<g id="edge264" class="edge">
<title>LLaMA_7B_S2_R1_L14_ar2&#45;&gt;LLaMA_7B_S2_R1_L14_res2</title>
<path fill="none" stroke="black" d="M14121,-1853.89C14121,-1835.51 14121,-1810.97 14121,-1792.34"/>
<polygon fill="black" stroke="black" points="14124.5,-1792.14 14121,-1782.14 14117.5,-1792.14 14124.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_split -->
<g id="node289" class="node">
<title>LLaMA_7B_S2_R1_L15_split</title>
<polygon fill="orange" stroke="black" points="13689.53,-3091.04 13038.06,-3091.04 12870.47,-3015.04 13521.94,-3015.04 13689.53,-3091.04"/>
<text text-anchor="middle" x="13280" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="13280" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_norm1 -->
<g id="node290" class="node">
<title>LLaMA_7B_S2_R1_L15_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="13280" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13280" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_split&#45;&gt;LLaMA_7B_S2_R1_L15_norm1 -->
<g id="edge265" class="edge">
<title>LLaMA_7B_S2_R1_L15_split&#45;&gt;LLaMA_7B_S2_R1_L15_norm1</title>
<path fill="none" stroke="black" d="M13280,-3014.83C13280,-2995.62 13280,-2972.29 13280,-2953.24"/>
<polygon fill="black" stroke="black" points="13283.5,-2953.16 13280,-2943.16 13276.5,-2953.16 13283.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_qkv -->
<g id="node291" class="node">
<title>LLaMA_7B_S2_R1_L15_qkv</title>
<polygon fill="lightcoral" stroke="black" points="13426.5,-2817.3 13133.5,-2817.3 13133.5,-2779.3 13426.5,-2779.3 13426.5,-2817.3"/>
<text text-anchor="middle" x="13280" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="13280" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_norm1&#45;&gt;LLaMA_7B_S2_R1_L15_qkv -->
<g id="edge266" class="edge">
<title>LLaMA_7B_S2_R1_L15_norm1&#45;&gt;LLaMA_7B_S2_R1_L15_qkv</title>
<path fill="none" stroke="black" d="M13280,-2889.17C13280,-2870.9 13280,-2846.47 13280,-2827.7"/>
<polygon fill="black" stroke="black" points="13283.5,-2827.65 13280,-2817.65 13276.5,-2827.65 13283.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_attn -->
<g id="node292" class="node">
<title>LLaMA_7B_S2_R1_L15_attn</title>
<polygon fill="lightcoral" stroke="black" points="13426.5,-2707.3 13133.5,-2707.3 13133.5,-2669.3 13426.5,-2669.3 13426.5,-2707.3"/>
<text text-anchor="middle" x="13280" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="13280" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_qkv&#45;&gt;LLaMA_7B_S2_R1_L15_attn -->
<g id="edge267" class="edge">
<title>LLaMA_7B_S2_R1_L15_qkv&#45;&gt;LLaMA_7B_S2_R1_L15_attn</title>
<path fill="none" stroke="black" d="M13280,-2778.98C13280,-2762.12 13280,-2736.87 13280,-2717.45"/>
<polygon fill="black" stroke="black" points="13283.5,-2717.35 13280,-2707.35 13276.5,-2717.35 13283.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_ar1 -->
<g id="node293" class="node">
<title>LLaMA_7B_S2_R1_L15_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13280" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="13280" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_attn&#45;&gt;LLaMA_7B_S2_R1_L15_ar1 -->
<g id="edge268" class="edge">
<title>LLaMA_7B_S2_R1_L15_attn&#45;&gt;LLaMA_7B_S2_R1_L15_ar1</title>
<path fill="none" stroke="black" d="M13280,-2669.2C13280,-2652.83 13280,-2628.24 13280,-2607.81"/>
<polygon fill="black" stroke="black" points="13283.5,-2607.58 13280,-2597.58 13276.5,-2607.58 13283.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_res1 -->
<g id="node294" class="node">
<title>LLaMA_7B_S2_R1_L15_res1</title>
<polygon fill="lightyellow" stroke="black" points="13367.84,-2471.56 13228.11,-2471.56 13192.16,-2435.56 13331.89,-2435.56 13367.84,-2471.56"/>
<text text-anchor="middle" x="13280" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_ar1&#45;&gt;LLaMA_7B_S2_R1_L15_res1 -->
<g id="edge269" class="edge">
<title>LLaMA_7B_S2_R1_L15_ar1&#45;&gt;LLaMA_7B_S2_R1_L15_res1</title>
<path fill="none" stroke="black" d="M13280,-2543.37C13280,-2525 13280,-2500.45 13280,-2481.82"/>
<polygon fill="black" stroke="black" points="13283.5,-2481.62 13280,-2471.62 13276.5,-2481.62 13283.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_norm2 -->
<g id="node295" class="node">
<title>LLaMA_7B_S2_R1_L15_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="13280" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="13280" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_res1&#45;&gt;LLaMA_7B_S2_R1_L15_norm2 -->
<g id="edge270" class="edge">
<title>LLaMA_7B_S2_R1_L15_res1&#45;&gt;LLaMA_7B_S2_R1_L15_norm2</title>
<path fill="none" stroke="black" d="M13280,-2435.12C13280,-2418.97 13280,-2394.47 13280,-2374.07"/>
<polygon fill="black" stroke="black" points="13283.5,-2373.85 13280,-2363.85 13276.5,-2373.85 13283.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_up -->
<g id="node296" class="node">
<title>LLaMA_7B_S2_R1_L15_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-2237.82 13173.5,-2237.82 13173.5,-2199.82 13386.5,-2199.82 13386.5,-2237.82"/>
<text text-anchor="middle" x="13280" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13280" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_norm2&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_up -->
<g id="edge271" class="edge">
<title>LLaMA_7B_S2_R1_L15_norm2&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_up</title>
<path fill="none" stroke="black" d="M13280,-2309.69C13280,-2291.42 13280,-2266.99 13280,-2248.22"/>
<polygon fill="black" stroke="black" points="13283.5,-2248.17 13280,-2238.17 13276.5,-2248.17 13283.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_gate -->
<g id="node297" class="node">
<title>LLaMA_7B_S2_R1_L15_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-2127.82 13173.5,-2127.82 13173.5,-2089.82 13386.5,-2089.82 13386.5,-2127.82"/>
<text text-anchor="middle" x="13280" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13280" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_gate -->
<g id="edge272" class="edge">
<title>LLaMA_7B_S2_R1_L15_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_gate</title>
<path fill="none" stroke="black" d="M13280,-2199.5C13280,-2182.64 13280,-2157.39 13280,-2137.97"/>
<polygon fill="black" stroke="black" points="13283.5,-2137.87 13280,-2127.87 13276.5,-2137.87 13283.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_down -->
<g id="node298" class="node">
<title>LLaMA_7B_S2_R1_L15_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-2017.82 13173.5,-2017.82 13173.5,-1979.82 13386.5,-1979.82 13386.5,-2017.82"/>
<text text-anchor="middle" x="13280" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13280" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_down -->
<g id="edge273" class="edge">
<title>LLaMA_7B_S2_R1_L15_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L15_ffn_down</title>
<path fill="none" stroke="black" d="M13280,-2089.5C13280,-2072.64 13280,-2047.39 13280,-2027.97"/>
<polygon fill="black" stroke="black" points="13283.5,-2027.87 13280,-2017.87 13276.5,-2027.87 13283.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_ar2 -->
<g id="node299" class="node">
<title>LLaMA_7B_S2_R1_L15_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13280" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="13280" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L15_ar2 -->
<g id="edge274" class="edge">
<title>LLaMA_7B_S2_R1_L15_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L15_ar2</title>
<path fill="none" stroke="black" d="M13280,-1979.72C13280,-1963.35 13280,-1938.76 13280,-1918.33"/>
<polygon fill="black" stroke="black" points="13283.5,-1918.1 13280,-1908.1 13276.5,-1918.1 13283.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L15_res2 -->
<g id="node300" class="node">
<title>LLaMA_7B_S2_R1_L15_res2</title>
<polygon fill="lightyellow" stroke="black" points="13367.84,-1782.08 13228.11,-1782.08 13192.16,-1746.08 13331.89,-1746.08 13367.84,-1782.08"/>
<text text-anchor="middle" x="13280" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L15_ar2&#45;&gt;LLaMA_7B_S2_R1_L15_res2 -->
<g id="edge275" class="edge">
<title>LLaMA_7B_S2_R1_L15_ar2&#45;&gt;LLaMA_7B_S2_R1_L15_res2</title>
<path fill="none" stroke="black" d="M13280,-1853.89C13280,-1835.51 13280,-1810.97 13280,-1792.34"/>
<polygon fill="black" stroke="black" points="13283.5,-1792.14 13280,-1782.14 13276.5,-1792.14 13283.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_split -->
<g id="node301" class="node">
<title>LLaMA_7B_S2_R1_L16_split</title>
<polygon fill="orange" stroke="black" points="12848.53,-3091.04 12197.06,-3091.04 12029.47,-3015.04 12680.94,-3015.04 12848.53,-3091.04"/>
<text text-anchor="middle" x="12439" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="12439" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_norm1 -->
<g id="node302" class="node">
<title>LLaMA_7B_S2_R1_L16_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="12439" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12439" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_split&#45;&gt;LLaMA_7B_S2_R1_L16_norm1 -->
<g id="edge276" class="edge">
<title>LLaMA_7B_S2_R1_L16_split&#45;&gt;LLaMA_7B_S2_R1_L16_norm1</title>
<path fill="none" stroke="black" d="M12439,-3014.83C12439,-2995.62 12439,-2972.29 12439,-2953.24"/>
<polygon fill="black" stroke="black" points="12442.5,-2953.16 12439,-2943.16 12435.5,-2953.16 12442.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_qkv -->
<g id="node303" class="node">
<title>LLaMA_7B_S2_R1_L16_qkv</title>
<polygon fill="lightcoral" stroke="black" points="12585.5,-2817.3 12292.5,-2817.3 12292.5,-2779.3 12585.5,-2779.3 12585.5,-2817.3"/>
<text text-anchor="middle" x="12439" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="12439" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_norm1&#45;&gt;LLaMA_7B_S2_R1_L16_qkv -->
<g id="edge277" class="edge">
<title>LLaMA_7B_S2_R1_L16_norm1&#45;&gt;LLaMA_7B_S2_R1_L16_qkv</title>
<path fill="none" stroke="black" d="M12439,-2889.17C12439,-2870.9 12439,-2846.47 12439,-2827.7"/>
<polygon fill="black" stroke="black" points="12442.5,-2827.65 12439,-2817.65 12435.5,-2827.65 12442.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_attn -->
<g id="node304" class="node">
<title>LLaMA_7B_S2_R1_L16_attn</title>
<polygon fill="lightcoral" stroke="black" points="12585.5,-2707.3 12292.5,-2707.3 12292.5,-2669.3 12585.5,-2669.3 12585.5,-2707.3"/>
<text text-anchor="middle" x="12439" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="12439" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_qkv&#45;&gt;LLaMA_7B_S2_R1_L16_attn -->
<g id="edge278" class="edge">
<title>LLaMA_7B_S2_R1_L16_qkv&#45;&gt;LLaMA_7B_S2_R1_L16_attn</title>
<path fill="none" stroke="black" d="M12439,-2778.98C12439,-2762.12 12439,-2736.87 12439,-2717.45"/>
<polygon fill="black" stroke="black" points="12442.5,-2717.35 12439,-2707.35 12435.5,-2717.35 12442.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_ar1 -->
<g id="node305" class="node">
<title>LLaMA_7B_S2_R1_L16_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12439" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="12439" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_attn&#45;&gt;LLaMA_7B_S2_R1_L16_ar1 -->
<g id="edge279" class="edge">
<title>LLaMA_7B_S2_R1_L16_attn&#45;&gt;LLaMA_7B_S2_R1_L16_ar1</title>
<path fill="none" stroke="black" d="M12439,-2669.2C12439,-2652.83 12439,-2628.24 12439,-2607.81"/>
<polygon fill="black" stroke="black" points="12442.5,-2607.58 12439,-2597.58 12435.5,-2607.58 12442.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_res1 -->
<g id="node306" class="node">
<title>LLaMA_7B_S2_R1_L16_res1</title>
<polygon fill="lightyellow" stroke="black" points="12526.84,-2471.56 12387.11,-2471.56 12351.16,-2435.56 12490.89,-2435.56 12526.84,-2471.56"/>
<text text-anchor="middle" x="12439" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_ar1&#45;&gt;LLaMA_7B_S2_R1_L16_res1 -->
<g id="edge280" class="edge">
<title>LLaMA_7B_S2_R1_L16_ar1&#45;&gt;LLaMA_7B_S2_R1_L16_res1</title>
<path fill="none" stroke="black" d="M12439,-2543.37C12439,-2525 12439,-2500.45 12439,-2481.82"/>
<polygon fill="black" stroke="black" points="12442.5,-2481.62 12439,-2471.62 12435.5,-2481.62 12442.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_norm2 -->
<g id="node307" class="node">
<title>LLaMA_7B_S2_R1_L16_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="12439" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="12439" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_res1&#45;&gt;LLaMA_7B_S2_R1_L16_norm2 -->
<g id="edge281" class="edge">
<title>LLaMA_7B_S2_R1_L16_res1&#45;&gt;LLaMA_7B_S2_R1_L16_norm2</title>
<path fill="none" stroke="black" d="M12439,-2435.12C12439,-2418.97 12439,-2394.47 12439,-2374.07"/>
<polygon fill="black" stroke="black" points="12442.5,-2373.85 12439,-2363.85 12435.5,-2373.85 12442.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_up -->
<g id="node308" class="node">
<title>LLaMA_7B_S2_R1_L16_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-2237.82 12332.5,-2237.82 12332.5,-2199.82 12545.5,-2199.82 12545.5,-2237.82"/>
<text text-anchor="middle" x="12439" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12439" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_norm2&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_up -->
<g id="edge282" class="edge">
<title>LLaMA_7B_S2_R1_L16_norm2&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_up</title>
<path fill="none" stroke="black" d="M12439,-2309.69C12439,-2291.42 12439,-2266.99 12439,-2248.22"/>
<polygon fill="black" stroke="black" points="12442.5,-2248.17 12439,-2238.17 12435.5,-2248.17 12442.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_gate -->
<g id="node309" class="node">
<title>LLaMA_7B_S2_R1_L16_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-2127.82 12332.5,-2127.82 12332.5,-2089.82 12545.5,-2089.82 12545.5,-2127.82"/>
<text text-anchor="middle" x="12439" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12439" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_gate -->
<g id="edge283" class="edge">
<title>LLaMA_7B_S2_R1_L16_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_gate</title>
<path fill="none" stroke="black" d="M12439,-2199.5C12439,-2182.64 12439,-2157.39 12439,-2137.97"/>
<polygon fill="black" stroke="black" points="12442.5,-2137.87 12439,-2127.87 12435.5,-2137.87 12442.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_down -->
<g id="node310" class="node">
<title>LLaMA_7B_S2_R1_L16_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-2017.82 12332.5,-2017.82 12332.5,-1979.82 12545.5,-1979.82 12545.5,-2017.82"/>
<text text-anchor="middle" x="12439" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12439" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_down -->
<g id="edge284" class="edge">
<title>LLaMA_7B_S2_R1_L16_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L16_ffn_down</title>
<path fill="none" stroke="black" d="M12439,-2089.5C12439,-2072.64 12439,-2047.39 12439,-2027.97"/>
<polygon fill="black" stroke="black" points="12442.5,-2027.87 12439,-2017.87 12435.5,-2027.87 12442.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_ar2 -->
<g id="node311" class="node">
<title>LLaMA_7B_S2_R1_L16_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12439" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="12439" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L16_ar2 -->
<g id="edge285" class="edge">
<title>LLaMA_7B_S2_R1_L16_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L16_ar2</title>
<path fill="none" stroke="black" d="M12439,-1979.72C12439,-1963.35 12439,-1938.76 12439,-1918.33"/>
<polygon fill="black" stroke="black" points="12442.5,-1918.1 12439,-1908.1 12435.5,-1918.1 12442.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L16_res2 -->
<g id="node312" class="node">
<title>LLaMA_7B_S2_R1_L16_res2</title>
<polygon fill="lightyellow" stroke="black" points="12526.84,-1782.08 12387.11,-1782.08 12351.16,-1746.08 12490.89,-1746.08 12526.84,-1782.08"/>
<text text-anchor="middle" x="12439" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L16_ar2&#45;&gt;LLaMA_7B_S2_R1_L16_res2 -->
<g id="edge286" class="edge">
<title>LLaMA_7B_S2_R1_L16_ar2&#45;&gt;LLaMA_7B_S2_R1_L16_res2</title>
<path fill="none" stroke="black" d="M12439,-1853.89C12439,-1835.51 12439,-1810.97 12439,-1792.34"/>
<polygon fill="black" stroke="black" points="12442.5,-1792.14 12439,-1782.14 12435.5,-1792.14 12442.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_split -->
<g id="node313" class="node">
<title>LLaMA_7B_S2_R1_L17_split</title>
<polygon fill="orange" stroke="black" points="12007.53,-3091.04 11356.06,-3091.04 11188.47,-3015.04 11839.94,-3015.04 12007.53,-3091.04"/>
<text text-anchor="middle" x="11598" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="11598" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_norm1 -->
<g id="node314" class="node">
<title>LLaMA_7B_S2_R1_L17_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="11598" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11598" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_split&#45;&gt;LLaMA_7B_S2_R1_L17_norm1 -->
<g id="edge287" class="edge">
<title>LLaMA_7B_S2_R1_L17_split&#45;&gt;LLaMA_7B_S2_R1_L17_norm1</title>
<path fill="none" stroke="black" d="M11598,-3014.83C11598,-2995.62 11598,-2972.29 11598,-2953.24"/>
<polygon fill="black" stroke="black" points="11601.5,-2953.16 11598,-2943.16 11594.5,-2953.16 11601.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_qkv -->
<g id="node315" class="node">
<title>LLaMA_7B_S2_R1_L17_qkv</title>
<polygon fill="lightcoral" stroke="black" points="11744.5,-2817.3 11451.5,-2817.3 11451.5,-2779.3 11744.5,-2779.3 11744.5,-2817.3"/>
<text text-anchor="middle" x="11598" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="11598" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_norm1&#45;&gt;LLaMA_7B_S2_R1_L17_qkv -->
<g id="edge288" class="edge">
<title>LLaMA_7B_S2_R1_L17_norm1&#45;&gt;LLaMA_7B_S2_R1_L17_qkv</title>
<path fill="none" stroke="black" d="M11598,-2889.17C11598,-2870.9 11598,-2846.47 11598,-2827.7"/>
<polygon fill="black" stroke="black" points="11601.5,-2827.65 11598,-2817.65 11594.5,-2827.65 11601.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_attn -->
<g id="node316" class="node">
<title>LLaMA_7B_S2_R1_L17_attn</title>
<polygon fill="lightcoral" stroke="black" points="11744.5,-2707.3 11451.5,-2707.3 11451.5,-2669.3 11744.5,-2669.3 11744.5,-2707.3"/>
<text text-anchor="middle" x="11598" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="11598" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_qkv&#45;&gt;LLaMA_7B_S2_R1_L17_attn -->
<g id="edge289" class="edge">
<title>LLaMA_7B_S2_R1_L17_qkv&#45;&gt;LLaMA_7B_S2_R1_L17_attn</title>
<path fill="none" stroke="black" d="M11598,-2778.98C11598,-2762.12 11598,-2736.87 11598,-2717.45"/>
<polygon fill="black" stroke="black" points="11601.5,-2717.35 11598,-2707.35 11594.5,-2717.35 11601.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_ar1 -->
<g id="node317" class="node">
<title>LLaMA_7B_S2_R1_L17_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11598" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11598" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_attn&#45;&gt;LLaMA_7B_S2_R1_L17_ar1 -->
<g id="edge290" class="edge">
<title>LLaMA_7B_S2_R1_L17_attn&#45;&gt;LLaMA_7B_S2_R1_L17_ar1</title>
<path fill="none" stroke="black" d="M11598,-2669.2C11598,-2652.83 11598,-2628.24 11598,-2607.81"/>
<polygon fill="black" stroke="black" points="11601.5,-2607.58 11598,-2597.58 11594.5,-2607.58 11601.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_res1 -->
<g id="node318" class="node">
<title>LLaMA_7B_S2_R1_L17_res1</title>
<polygon fill="lightyellow" stroke="black" points="11685.84,-2471.56 11546.11,-2471.56 11510.16,-2435.56 11649.89,-2435.56 11685.84,-2471.56"/>
<text text-anchor="middle" x="11598" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_ar1&#45;&gt;LLaMA_7B_S2_R1_L17_res1 -->
<g id="edge291" class="edge">
<title>LLaMA_7B_S2_R1_L17_ar1&#45;&gt;LLaMA_7B_S2_R1_L17_res1</title>
<path fill="none" stroke="black" d="M11598,-2543.37C11598,-2525 11598,-2500.45 11598,-2481.82"/>
<polygon fill="black" stroke="black" points="11601.5,-2481.62 11598,-2471.62 11594.5,-2481.62 11601.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_norm2 -->
<g id="node319" class="node">
<title>LLaMA_7B_S2_R1_L17_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="11598" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="11598" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_res1&#45;&gt;LLaMA_7B_S2_R1_L17_norm2 -->
<g id="edge292" class="edge">
<title>LLaMA_7B_S2_R1_L17_res1&#45;&gt;LLaMA_7B_S2_R1_L17_norm2</title>
<path fill="none" stroke="black" d="M11598,-2435.12C11598,-2418.97 11598,-2394.47 11598,-2374.07"/>
<polygon fill="black" stroke="black" points="11601.5,-2373.85 11598,-2363.85 11594.5,-2373.85 11601.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_up -->
<g id="node320" class="node">
<title>LLaMA_7B_S2_R1_L17_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-2237.82 11491.5,-2237.82 11491.5,-2199.82 11704.5,-2199.82 11704.5,-2237.82"/>
<text text-anchor="middle" x="11598" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11598" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_norm2&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_up -->
<g id="edge293" class="edge">
<title>LLaMA_7B_S2_R1_L17_norm2&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_up</title>
<path fill="none" stroke="black" d="M11598,-2309.69C11598,-2291.42 11598,-2266.99 11598,-2248.22"/>
<polygon fill="black" stroke="black" points="11601.5,-2248.17 11598,-2238.17 11594.5,-2248.17 11601.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_gate -->
<g id="node321" class="node">
<title>LLaMA_7B_S2_R1_L17_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-2127.82 11491.5,-2127.82 11491.5,-2089.82 11704.5,-2089.82 11704.5,-2127.82"/>
<text text-anchor="middle" x="11598" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11598" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_gate -->
<g id="edge294" class="edge">
<title>LLaMA_7B_S2_R1_L17_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_gate</title>
<path fill="none" stroke="black" d="M11598,-2199.5C11598,-2182.64 11598,-2157.39 11598,-2137.97"/>
<polygon fill="black" stroke="black" points="11601.5,-2137.87 11598,-2127.87 11594.5,-2137.87 11601.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_down -->
<g id="node322" class="node">
<title>LLaMA_7B_S2_R1_L17_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-2017.82 11491.5,-2017.82 11491.5,-1979.82 11704.5,-1979.82 11704.5,-2017.82"/>
<text text-anchor="middle" x="11598" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11598" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_down -->
<g id="edge295" class="edge">
<title>LLaMA_7B_S2_R1_L17_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L17_ffn_down</title>
<path fill="none" stroke="black" d="M11598,-2089.5C11598,-2072.64 11598,-2047.39 11598,-2027.97"/>
<polygon fill="black" stroke="black" points="11601.5,-2027.87 11598,-2017.87 11594.5,-2027.87 11601.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_ar2 -->
<g id="node323" class="node">
<title>LLaMA_7B_S2_R1_L17_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11598" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="11598" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L17_ar2 -->
<g id="edge296" class="edge">
<title>LLaMA_7B_S2_R1_L17_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L17_ar2</title>
<path fill="none" stroke="black" d="M11598,-1979.72C11598,-1963.35 11598,-1938.76 11598,-1918.33"/>
<polygon fill="black" stroke="black" points="11601.5,-1918.1 11598,-1908.1 11594.5,-1918.1 11601.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L17_res2 -->
<g id="node324" class="node">
<title>LLaMA_7B_S2_R1_L17_res2</title>
<polygon fill="lightyellow" stroke="black" points="11685.84,-1782.08 11546.11,-1782.08 11510.16,-1746.08 11649.89,-1746.08 11685.84,-1782.08"/>
<text text-anchor="middle" x="11598" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L17_ar2&#45;&gt;LLaMA_7B_S2_R1_L17_res2 -->
<g id="edge297" class="edge">
<title>LLaMA_7B_S2_R1_L17_ar2&#45;&gt;LLaMA_7B_S2_R1_L17_res2</title>
<path fill="none" stroke="black" d="M11598,-1853.89C11598,-1835.51 11598,-1810.97 11598,-1792.34"/>
<polygon fill="black" stroke="black" points="11601.5,-1792.14 11598,-1782.14 11594.5,-1792.14 11601.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_split -->
<g id="node325" class="node">
<title>LLaMA_7B_S2_R1_L18_split</title>
<polygon fill="orange" stroke="black" points="11166.53,-3091.04 10515.06,-3091.04 10347.47,-3015.04 10998.94,-3015.04 11166.53,-3091.04"/>
<text text-anchor="middle" x="10757" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="10757" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_norm1 -->
<g id="node326" class="node">
<title>LLaMA_7B_S2_R1_L18_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="10757" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10757" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_split&#45;&gt;LLaMA_7B_S2_R1_L18_norm1 -->
<g id="edge298" class="edge">
<title>LLaMA_7B_S2_R1_L18_split&#45;&gt;LLaMA_7B_S2_R1_L18_norm1</title>
<path fill="none" stroke="black" d="M10757,-3014.83C10757,-2995.62 10757,-2972.29 10757,-2953.24"/>
<polygon fill="black" stroke="black" points="10760.5,-2953.16 10757,-2943.16 10753.5,-2953.16 10760.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_qkv -->
<g id="node327" class="node">
<title>LLaMA_7B_S2_R1_L18_qkv</title>
<polygon fill="lightcoral" stroke="black" points="10903.5,-2817.3 10610.5,-2817.3 10610.5,-2779.3 10903.5,-2779.3 10903.5,-2817.3"/>
<text text-anchor="middle" x="10757" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="10757" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_norm1&#45;&gt;LLaMA_7B_S2_R1_L18_qkv -->
<g id="edge299" class="edge">
<title>LLaMA_7B_S2_R1_L18_norm1&#45;&gt;LLaMA_7B_S2_R1_L18_qkv</title>
<path fill="none" stroke="black" d="M10757,-2889.17C10757,-2870.9 10757,-2846.47 10757,-2827.7"/>
<polygon fill="black" stroke="black" points="10760.5,-2827.65 10757,-2817.65 10753.5,-2827.65 10760.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_attn -->
<g id="node328" class="node">
<title>LLaMA_7B_S2_R1_L18_attn</title>
<polygon fill="lightcoral" stroke="black" points="10903.5,-2707.3 10610.5,-2707.3 10610.5,-2669.3 10903.5,-2669.3 10903.5,-2707.3"/>
<text text-anchor="middle" x="10757" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="10757" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_qkv&#45;&gt;LLaMA_7B_S2_R1_L18_attn -->
<g id="edge300" class="edge">
<title>LLaMA_7B_S2_R1_L18_qkv&#45;&gt;LLaMA_7B_S2_R1_L18_attn</title>
<path fill="none" stroke="black" d="M10757,-2778.98C10757,-2762.12 10757,-2736.87 10757,-2717.45"/>
<polygon fill="black" stroke="black" points="10760.5,-2717.35 10757,-2707.35 10753.5,-2717.35 10760.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_ar1 -->
<g id="node329" class="node">
<title>LLaMA_7B_S2_R1_L18_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10757" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10757" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_attn&#45;&gt;LLaMA_7B_S2_R1_L18_ar1 -->
<g id="edge301" class="edge">
<title>LLaMA_7B_S2_R1_L18_attn&#45;&gt;LLaMA_7B_S2_R1_L18_ar1</title>
<path fill="none" stroke="black" d="M10757,-2669.2C10757,-2652.83 10757,-2628.24 10757,-2607.81"/>
<polygon fill="black" stroke="black" points="10760.5,-2607.58 10757,-2597.58 10753.5,-2607.58 10760.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_res1 -->
<g id="node330" class="node">
<title>LLaMA_7B_S2_R1_L18_res1</title>
<polygon fill="lightyellow" stroke="black" points="10844.84,-2471.56 10705.11,-2471.56 10669.16,-2435.56 10808.89,-2435.56 10844.84,-2471.56"/>
<text text-anchor="middle" x="10757" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_ar1&#45;&gt;LLaMA_7B_S2_R1_L18_res1 -->
<g id="edge302" class="edge">
<title>LLaMA_7B_S2_R1_L18_ar1&#45;&gt;LLaMA_7B_S2_R1_L18_res1</title>
<path fill="none" stroke="black" d="M10757,-2543.37C10757,-2525 10757,-2500.45 10757,-2481.82"/>
<polygon fill="black" stroke="black" points="10760.5,-2481.62 10757,-2471.62 10753.5,-2481.62 10760.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_norm2 -->
<g id="node331" class="node">
<title>LLaMA_7B_S2_R1_L18_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="10757" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="10757" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_res1&#45;&gt;LLaMA_7B_S2_R1_L18_norm2 -->
<g id="edge303" class="edge">
<title>LLaMA_7B_S2_R1_L18_res1&#45;&gt;LLaMA_7B_S2_R1_L18_norm2</title>
<path fill="none" stroke="black" d="M10757,-2435.12C10757,-2418.97 10757,-2394.47 10757,-2374.07"/>
<polygon fill="black" stroke="black" points="10760.5,-2373.85 10757,-2363.85 10753.5,-2373.85 10760.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_up -->
<g id="node332" class="node">
<title>LLaMA_7B_S2_R1_L18_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-2237.82 10650.5,-2237.82 10650.5,-2199.82 10863.5,-2199.82 10863.5,-2237.82"/>
<text text-anchor="middle" x="10757" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10757" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_norm2&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_up -->
<g id="edge304" class="edge">
<title>LLaMA_7B_S2_R1_L18_norm2&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_up</title>
<path fill="none" stroke="black" d="M10757,-2309.69C10757,-2291.42 10757,-2266.99 10757,-2248.22"/>
<polygon fill="black" stroke="black" points="10760.5,-2248.17 10757,-2238.17 10753.5,-2248.17 10760.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_gate -->
<g id="node333" class="node">
<title>LLaMA_7B_S2_R1_L18_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-2127.82 10650.5,-2127.82 10650.5,-2089.82 10863.5,-2089.82 10863.5,-2127.82"/>
<text text-anchor="middle" x="10757" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10757" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_gate -->
<g id="edge305" class="edge">
<title>LLaMA_7B_S2_R1_L18_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_gate</title>
<path fill="none" stroke="black" d="M10757,-2199.5C10757,-2182.64 10757,-2157.39 10757,-2137.97"/>
<polygon fill="black" stroke="black" points="10760.5,-2137.87 10757,-2127.87 10753.5,-2137.87 10760.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_down -->
<g id="node334" class="node">
<title>LLaMA_7B_S2_R1_L18_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-2017.82 10650.5,-2017.82 10650.5,-1979.82 10863.5,-1979.82 10863.5,-2017.82"/>
<text text-anchor="middle" x="10757" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10757" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_down -->
<g id="edge306" class="edge">
<title>LLaMA_7B_S2_R1_L18_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L18_ffn_down</title>
<path fill="none" stroke="black" d="M10757,-2089.5C10757,-2072.64 10757,-2047.39 10757,-2027.97"/>
<polygon fill="black" stroke="black" points="10760.5,-2027.87 10757,-2017.87 10753.5,-2027.87 10760.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_ar2 -->
<g id="node335" class="node">
<title>LLaMA_7B_S2_R1_L18_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10757" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="10757" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L18_ar2 -->
<g id="edge307" class="edge">
<title>LLaMA_7B_S2_R1_L18_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L18_ar2</title>
<path fill="none" stroke="black" d="M10757,-1979.72C10757,-1963.35 10757,-1938.76 10757,-1918.33"/>
<polygon fill="black" stroke="black" points="10760.5,-1918.1 10757,-1908.1 10753.5,-1918.1 10760.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L18_res2 -->
<g id="node336" class="node">
<title>LLaMA_7B_S2_R1_L18_res2</title>
<polygon fill="lightyellow" stroke="black" points="10844.84,-1782.08 10705.11,-1782.08 10669.16,-1746.08 10808.89,-1746.08 10844.84,-1782.08"/>
<text text-anchor="middle" x="10757" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L18_ar2&#45;&gt;LLaMA_7B_S2_R1_L18_res2 -->
<g id="edge308" class="edge">
<title>LLaMA_7B_S2_R1_L18_ar2&#45;&gt;LLaMA_7B_S2_R1_L18_res2</title>
<path fill="none" stroke="black" d="M10757,-1853.89C10757,-1835.51 10757,-1810.97 10757,-1792.34"/>
<polygon fill="black" stroke="black" points="10760.5,-1792.14 10757,-1782.14 10753.5,-1792.14 10760.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_split -->
<g id="node337" class="node">
<title>LLaMA_7B_S2_R1_L19_split</title>
<polygon fill="orange" stroke="black" points="10325.53,-3091.04 9674.06,-3091.04 9506.47,-3015.04 10157.94,-3015.04 10325.53,-3091.04"/>
<text text-anchor="middle" x="9916" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="9916" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_norm1 -->
<g id="node338" class="node">
<title>LLaMA_7B_S2_R1_L19_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="9916" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9916" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_split&#45;&gt;LLaMA_7B_S2_R1_L19_norm1 -->
<g id="edge309" class="edge">
<title>LLaMA_7B_S2_R1_L19_split&#45;&gt;LLaMA_7B_S2_R1_L19_norm1</title>
<path fill="none" stroke="black" d="M9916,-3014.83C9916,-2995.62 9916,-2972.29 9916,-2953.24"/>
<polygon fill="black" stroke="black" points="9919.5,-2953.16 9916,-2943.16 9912.5,-2953.16 9919.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_qkv -->
<g id="node339" class="node">
<title>LLaMA_7B_S2_R1_L19_qkv</title>
<polygon fill="lightcoral" stroke="black" points="10062.5,-2817.3 9769.5,-2817.3 9769.5,-2779.3 10062.5,-2779.3 10062.5,-2817.3"/>
<text text-anchor="middle" x="9916" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="9916" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_norm1&#45;&gt;LLaMA_7B_S2_R1_L19_qkv -->
<g id="edge310" class="edge">
<title>LLaMA_7B_S2_R1_L19_norm1&#45;&gt;LLaMA_7B_S2_R1_L19_qkv</title>
<path fill="none" stroke="black" d="M9916,-2889.17C9916,-2870.9 9916,-2846.47 9916,-2827.7"/>
<polygon fill="black" stroke="black" points="9919.5,-2827.65 9916,-2817.65 9912.5,-2827.65 9919.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_attn -->
<g id="node340" class="node">
<title>LLaMA_7B_S2_R1_L19_attn</title>
<polygon fill="lightcoral" stroke="black" points="10062.5,-2707.3 9769.5,-2707.3 9769.5,-2669.3 10062.5,-2669.3 10062.5,-2707.3"/>
<text text-anchor="middle" x="9916" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="9916" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_qkv&#45;&gt;LLaMA_7B_S2_R1_L19_attn -->
<g id="edge311" class="edge">
<title>LLaMA_7B_S2_R1_L19_qkv&#45;&gt;LLaMA_7B_S2_R1_L19_attn</title>
<path fill="none" stroke="black" d="M9916,-2778.98C9916,-2762.12 9916,-2736.87 9916,-2717.45"/>
<polygon fill="black" stroke="black" points="9919.5,-2717.35 9916,-2707.35 9912.5,-2717.35 9919.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_ar1 -->
<g id="node341" class="node">
<title>LLaMA_7B_S2_R1_L19_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9916" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9916" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_attn&#45;&gt;LLaMA_7B_S2_R1_L19_ar1 -->
<g id="edge312" class="edge">
<title>LLaMA_7B_S2_R1_L19_attn&#45;&gt;LLaMA_7B_S2_R1_L19_ar1</title>
<path fill="none" stroke="black" d="M9916,-2669.2C9916,-2652.83 9916,-2628.24 9916,-2607.81"/>
<polygon fill="black" stroke="black" points="9919.5,-2607.58 9916,-2597.58 9912.5,-2607.58 9919.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_res1 -->
<g id="node342" class="node">
<title>LLaMA_7B_S2_R1_L19_res1</title>
<polygon fill="lightyellow" stroke="black" points="10003.84,-2471.56 9864.11,-2471.56 9828.16,-2435.56 9967.89,-2435.56 10003.84,-2471.56"/>
<text text-anchor="middle" x="9916" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_ar1&#45;&gt;LLaMA_7B_S2_R1_L19_res1 -->
<g id="edge313" class="edge">
<title>LLaMA_7B_S2_R1_L19_ar1&#45;&gt;LLaMA_7B_S2_R1_L19_res1</title>
<path fill="none" stroke="black" d="M9916,-2543.37C9916,-2525 9916,-2500.45 9916,-2481.82"/>
<polygon fill="black" stroke="black" points="9919.5,-2481.62 9916,-2471.62 9912.5,-2481.62 9919.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_norm2 -->
<g id="node343" class="node">
<title>LLaMA_7B_S2_R1_L19_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="9916" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="9916" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_res1&#45;&gt;LLaMA_7B_S2_R1_L19_norm2 -->
<g id="edge314" class="edge">
<title>LLaMA_7B_S2_R1_L19_res1&#45;&gt;LLaMA_7B_S2_R1_L19_norm2</title>
<path fill="none" stroke="black" d="M9916,-2435.12C9916,-2418.97 9916,-2394.47 9916,-2374.07"/>
<polygon fill="black" stroke="black" points="9919.5,-2373.85 9916,-2363.85 9912.5,-2373.85 9919.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_up -->
<g id="node344" class="node">
<title>LLaMA_7B_S2_R1_L19_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-2237.82 9809.5,-2237.82 9809.5,-2199.82 10022.5,-2199.82 10022.5,-2237.82"/>
<text text-anchor="middle" x="9916" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9916" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_norm2&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_up -->
<g id="edge315" class="edge">
<title>LLaMA_7B_S2_R1_L19_norm2&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_up</title>
<path fill="none" stroke="black" d="M9916,-2309.69C9916,-2291.42 9916,-2266.99 9916,-2248.22"/>
<polygon fill="black" stroke="black" points="9919.5,-2248.17 9916,-2238.17 9912.5,-2248.17 9919.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_gate -->
<g id="node345" class="node">
<title>LLaMA_7B_S2_R1_L19_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-2127.82 9809.5,-2127.82 9809.5,-2089.82 10022.5,-2089.82 10022.5,-2127.82"/>
<text text-anchor="middle" x="9916" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9916" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_gate -->
<g id="edge316" class="edge">
<title>LLaMA_7B_S2_R1_L19_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_gate</title>
<path fill="none" stroke="black" d="M9916,-2199.5C9916,-2182.64 9916,-2157.39 9916,-2137.97"/>
<polygon fill="black" stroke="black" points="9919.5,-2137.87 9916,-2127.87 9912.5,-2137.87 9919.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_down -->
<g id="node346" class="node">
<title>LLaMA_7B_S2_R1_L19_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-2017.82 9809.5,-2017.82 9809.5,-1979.82 10022.5,-1979.82 10022.5,-2017.82"/>
<text text-anchor="middle" x="9916" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9916" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_down -->
<g id="edge317" class="edge">
<title>LLaMA_7B_S2_R1_L19_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L19_ffn_down</title>
<path fill="none" stroke="black" d="M9916,-2089.5C9916,-2072.64 9916,-2047.39 9916,-2027.97"/>
<polygon fill="black" stroke="black" points="9919.5,-2027.87 9916,-2017.87 9912.5,-2027.87 9919.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_ar2 -->
<g id="node347" class="node">
<title>LLaMA_7B_S2_R1_L19_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9916" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="9916" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L19_ar2 -->
<g id="edge318" class="edge">
<title>LLaMA_7B_S2_R1_L19_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L19_ar2</title>
<path fill="none" stroke="black" d="M9916,-1979.72C9916,-1963.35 9916,-1938.76 9916,-1918.33"/>
<polygon fill="black" stroke="black" points="9919.5,-1918.1 9916,-1908.1 9912.5,-1918.1 9919.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R1_L19_res2 -->
<g id="node348" class="node">
<title>LLaMA_7B_S2_R1_L19_res2</title>
<polygon fill="lightyellow" stroke="black" points="10003.84,-1782.08 9864.11,-1782.08 9828.16,-1746.08 9967.89,-1746.08 10003.84,-1782.08"/>
<text text-anchor="middle" x="9916" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L19_ar2&#45;&gt;LLaMA_7B_S2_R1_L19_res2 -->
<g id="edge319" class="edge">
<title>LLaMA_7B_S2_R1_L19_ar2&#45;&gt;LLaMA_7B_S2_R1_L19_res2</title>
<path fill="none" stroke="black" d="M9916,-1853.89C9916,-1835.51 9916,-1810.97 9916,-1792.34"/>
<polygon fill="black" stroke="black" points="9919.5,-1792.14 9916,-1782.14 9912.5,-1792.14 9919.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_split -->
<g id="node349" class="node">
<title>LLaMA_7B_S2_R1_L20_split</title>
<polygon fill="orange" stroke="black" points="9484.53,-3091.04 8833.06,-3091.04 8665.47,-3015.04 9316.94,-3015.04 9484.53,-3091.04"/>
<text text-anchor="middle" x="9075" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="9075" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_norm1 -->
<g id="node350" class="node">
<title>LLaMA_7B_S2_R1_L20_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="8944" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8944" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8944" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_split&#45;&gt;LLaMA_7B_S2_R1_L20_norm1 -->
<g id="edge320" class="edge">
<title>LLaMA_7B_S2_R1_L20_split&#45;&gt;LLaMA_7B_S2_R1_L20_norm1</title>
<path fill="none" stroke="black" d="M9038.86,-3014.83C9018.98,-2994.37 8994.55,-2969.22 8975.47,-2949.57"/>
<polygon fill="black" stroke="black" points="8977.91,-2947.06 8968.43,-2942.33 8972.89,-2951.94 8977.91,-2947.06"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_qkv -->
<g id="node351" class="node">
<title>LLaMA_7B_S2_R1_L20_qkv</title>
<polygon fill="lightcoral" stroke="black" points="9090.5,-2817.3 8797.5,-2817.3 8797.5,-2779.3 9090.5,-2779.3 9090.5,-2817.3"/>
<text text-anchor="middle" x="8944" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="8944" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_norm1&#45;&gt;LLaMA_7B_S2_R1_L20_qkv -->
<g id="edge321" class="edge">
<title>LLaMA_7B_S2_R1_L20_norm1&#45;&gt;LLaMA_7B_S2_R1_L20_qkv</title>
<path fill="none" stroke="black" d="M8944,-2889.17C8944,-2870.9 8944,-2846.47 8944,-2827.7"/>
<polygon fill="black" stroke="black" points="8947.5,-2827.65 8944,-2817.65 8940.5,-2827.65 8947.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_attn -->
<g id="node352" class="node">
<title>LLaMA_7B_S2_R1_L20_attn</title>
<polygon fill="lightcoral" stroke="black" points="9089.5,-2707.3 8796.5,-2707.3 8796.5,-2669.3 9089.5,-2669.3 9089.5,-2707.3"/>
<text text-anchor="middle" x="8943" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="8943" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_qkv&#45;&gt;LLaMA_7B_S2_R1_L20_attn -->
<g id="edge322" class="edge">
<title>LLaMA_7B_S2_R1_L20_qkv&#45;&gt;LLaMA_7B_S2_R1_L20_attn</title>
<path fill="none" stroke="black" d="M8943.83,-2778.98C8943.67,-2762.12 8943.44,-2736.87 8943.26,-2717.45"/>
<polygon fill="black" stroke="black" points="8946.76,-2717.32 8943.17,-2707.35 8939.76,-2717.38 8946.76,-2717.32"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_ar1 -->
<g id="node353" class="node">
<title>LLaMA_7B_S2_R1_L20_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8900" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8900" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="8900" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_attn&#45;&gt;LLaMA_7B_S2_R1_L20_ar1 -->
<g id="edge323" class="edge">
<title>LLaMA_7B_S2_R1_L20_attn&#45;&gt;LLaMA_7B_S2_R1_L20_ar1</title>
<path fill="none" stroke="black" d="M8936.28,-2669.2C8930.08,-2652.49 8920.71,-2627.23 8913.04,-2606.57"/>
<polygon fill="black" stroke="black" points="8916.3,-2605.3 8909.54,-2597.15 8909.74,-2607.74 8916.3,-2605.3"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_res1 -->
<g id="node354" class="node">
<title>LLaMA_7B_S2_R1_L20_res1</title>
<polygon fill="lightyellow" stroke="black" points="8986.84,-2471.56 8847.11,-2471.56 8811.16,-2435.56 8950.89,-2435.56 8986.84,-2471.56"/>
<text text-anchor="middle" x="8899" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_ar1&#45;&gt;LLaMA_7B_S2_R1_L20_res1 -->
<g id="edge324" class="edge">
<title>LLaMA_7B_S2_R1_L20_ar1&#45;&gt;LLaMA_7B_S2_R1_L20_res1</title>
<path fill="none" stroke="black" d="M8899.77,-2543.37C8899.61,-2525 8899.4,-2500.45 8899.24,-2481.82"/>
<polygon fill="black" stroke="black" points="8902.74,-2481.59 8899.15,-2471.62 8895.74,-2481.65 8902.74,-2481.59"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_norm2 -->
<g id="node355" class="node">
<title>LLaMA_7B_S2_R1_L20_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="8813" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8813" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="8813" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_res1&#45;&gt;LLaMA_7B_S2_R1_L20_norm2 -->
<g id="edge325" class="edge">
<title>LLaMA_7B_S2_R1_L20_res1&#45;&gt;LLaMA_7B_S2_R1_L20_norm2</title>
<path fill="none" stroke="black" d="M8885.94,-2435.12C8873.24,-2418.16 8853.64,-2391.98 8837.95,-2371.02"/>
<polygon fill="black" stroke="black" points="8840.73,-2368.89 8831.94,-2362.99 8835.13,-2373.09 8840.73,-2368.89"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_up -->
<g id="node356" class="node">
<title>LLaMA_7B_S2_R1_L20_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="8917.5,-2237.82 8704.5,-2237.82 8704.5,-2199.82 8917.5,-2199.82 8917.5,-2237.82"/>
<text text-anchor="middle" x="8811" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8811" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_norm2&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_up -->
<g id="edge326" class="edge">
<title>LLaMA_7B_S2_R1_L20_norm2&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_up</title>
<path fill="none" stroke="black" d="M8812.55,-2309.69C8812.24,-2291.42 8811.81,-2266.99 8811.49,-2248.22"/>
<polygon fill="black" stroke="black" points="8814.99,-2248.11 8811.32,-2238.17 8807.99,-2248.23 8814.99,-2248.11"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_gate -->
<g id="node357" class="node">
<title>LLaMA_7B_S2_R1_L20_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="8912.5,-2127.82 8699.5,-2127.82 8699.5,-2089.82 8912.5,-2089.82 8912.5,-2127.82"/>
<text text-anchor="middle" x="8806" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8806" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_gate -->
<g id="edge327" class="edge">
<title>LLaMA_7B_S2_R1_L20_ffn_up&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_gate</title>
<path fill="none" stroke="black" d="M8810.15,-2199.5C8809.37,-2182.64 8808.2,-2157.39 8807.3,-2137.97"/>
<polygon fill="black" stroke="black" points="8810.79,-2137.7 8806.84,-2127.87 8803.8,-2138.02 8810.79,-2137.7"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_down -->
<g id="node358" class="node">
<title>LLaMA_7B_S2_R1_L20_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="8890.5,-2017.82 8677.5,-2017.82 8677.5,-1979.82 8890.5,-1979.82 8890.5,-2017.82"/>
<text text-anchor="middle" x="8784" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8784" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_down -->
<g id="edge328" class="edge">
<title>LLaMA_7B_S2_R1_L20_ffn_gate&#45;&gt;LLaMA_7B_S2_R1_L20_ffn_down</title>
<path fill="none" stroke="black" d="M8802.27,-2089.5C8798.82,-2072.56 8793.64,-2047.15 8789.68,-2027.7"/>
<polygon fill="black" stroke="black" points="8793.1,-2026.97 8787.68,-2017.87 8786.24,-2028.37 8793.1,-2026.97"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_ar2 -->
<g id="node359" class="node">
<title>LLaMA_7B_S2_R1_L20_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8774" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8774" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="8774" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L20_ar2 -->
<g id="edge329" class="edge">
<title>LLaMA_7B_S2_R1_L20_ffn_down&#45;&gt;LLaMA_7B_S2_R1_L20_ar2</title>
<path fill="none" stroke="black" d="M8782.44,-1979.72C8781.02,-1963.35 8778.9,-1938.76 8777.14,-1918.33"/>
<polygon fill="black" stroke="black" points="8780.6,-1917.76 8776.26,-1908.1 8773.63,-1918.36 8780.6,-1917.76"/>
</g>
<!-- LLaMA_7B_S2_R1_L20_res2 -->
<g id="node360" class="node">
<title>LLaMA_7B_S2_R1_L20_res2</title>
<polygon fill="lightyellow" stroke="black" points="8841.84,-1782.08 8702.11,-1782.08 8666.16,-1746.08 8805.89,-1746.08 8841.84,-1782.08"/>
<text text-anchor="middle" x="8754" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_ar2&#45;&gt;LLaMA_7B_S2_R1_L20_res2 -->
<g id="edge330" class="edge">
<title>LLaMA_7B_S2_R1_L20_ar2&#45;&gt;LLaMA_7B_S2_R1_L20_res2</title>
<path fill="none" stroke="black" d="M8769.46,-1853.89C8766.25,-1835.43 8761.95,-1810.74 8758.7,-1792.08"/>
<polygon fill="black" stroke="black" points="8762.13,-1791.39 8756.97,-1782.14 8755.24,-1792.6 8762.13,-1791.39"/>
</g>
<!-- LLaMA_7B_comm_2_3 -->
<g id="node722" class="node">
<title>LLaMA_7B_comm_2_3</title>
<ellipse fill="lightyellow" stroke="black" stroke-dasharray="5,2" cx="8492" cy="-1636.61" rx="194.41" ry="37.45"/>
<text text-anchor="middle" x="8492" y="-1647.91" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="8492" y="-1632.91" font-family="Times,serif" font-size="14.00">Stage 2 → 3</text>
<text text-anchor="middle" x="8492" y="-1617.91" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]</text>
</g>
<!-- LLaMA_7B_S2_R1_L20_res2&#45;&gt;LLaMA_7B_comm_2_3 -->
<g id="edge665" class="edge">
<title>LLaMA_7B_S2_R1_L20_res2&#45;&gt;LLaMA_7B_comm_2_3</title>
<path fill="none" stroke="black" d="M8718.39,-1746.03C8681,-1728.12 8620.95,-1699.36 8572.09,-1675.96"/>
<polygon fill="black" stroke="black" points="8573.33,-1672.67 8562.79,-1671.51 8570.3,-1678.99 8573.33,-1672.67"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_split -->
<g id="node361" class="node">
<title>LLaMA_7B_S2_R2_L11_split</title>
<polygon fill="orange" stroke="black" points="8640.53,-3091.04 7989.06,-3091.04 7821.47,-3015.04 8472.94,-3015.04 8640.53,-3091.04"/>
<text text-anchor="middle" x="8231" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="8231" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_norm1 -->
<g id="node362" class="node">
<title>LLaMA_7B_S2_R2_L11_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="8231" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8231" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_split&#45;&gt;LLaMA_7B_S2_R2_L11_norm1 -->
<g id="edge331" class="edge">
<title>LLaMA_7B_S2_R2_L11_split&#45;&gt;LLaMA_7B_S2_R2_L11_norm1</title>
<path fill="none" stroke="black" d="M8231,-3014.83C8231,-2995.62 8231,-2972.29 8231,-2953.24"/>
<polygon fill="black" stroke="black" points="8234.5,-2953.16 8231,-2943.16 8227.5,-2953.16 8234.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_qkv -->
<g id="node363" class="node">
<title>LLaMA_7B_S2_R2_L11_qkv</title>
<polygon fill="lightcoral" stroke="black" points="8377.5,-2817.3 8084.5,-2817.3 8084.5,-2779.3 8377.5,-2779.3 8377.5,-2817.3"/>
<text text-anchor="middle" x="8231" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="8231" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_norm1&#45;&gt;LLaMA_7B_S2_R2_L11_qkv -->
<g id="edge332" class="edge">
<title>LLaMA_7B_S2_R2_L11_norm1&#45;&gt;LLaMA_7B_S2_R2_L11_qkv</title>
<path fill="none" stroke="black" d="M8231,-2889.17C8231,-2870.9 8231,-2846.47 8231,-2827.7"/>
<polygon fill="black" stroke="black" points="8234.5,-2827.65 8231,-2817.65 8227.5,-2827.65 8234.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_attn -->
<g id="node364" class="node">
<title>LLaMA_7B_S2_R2_L11_attn</title>
<polygon fill="lightcoral" stroke="black" points="8377.5,-2707.3 8084.5,-2707.3 8084.5,-2669.3 8377.5,-2669.3 8377.5,-2707.3"/>
<text text-anchor="middle" x="8231" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="8231" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_qkv&#45;&gt;LLaMA_7B_S2_R2_L11_attn -->
<g id="edge333" class="edge">
<title>LLaMA_7B_S2_R2_L11_qkv&#45;&gt;LLaMA_7B_S2_R2_L11_attn</title>
<path fill="none" stroke="black" d="M8231,-2778.98C8231,-2762.12 8231,-2736.87 8231,-2717.45"/>
<polygon fill="black" stroke="black" points="8234.5,-2717.35 8231,-2707.35 8227.5,-2717.35 8234.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_ar1 -->
<g id="node365" class="node">
<title>LLaMA_7B_S2_R2_L11_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8231" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="8231" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_attn&#45;&gt;LLaMA_7B_S2_R2_L11_ar1 -->
<g id="edge334" class="edge">
<title>LLaMA_7B_S2_R2_L11_attn&#45;&gt;LLaMA_7B_S2_R2_L11_ar1</title>
<path fill="none" stroke="black" d="M8231,-2669.2C8231,-2652.83 8231,-2628.24 8231,-2607.81"/>
<polygon fill="black" stroke="black" points="8234.5,-2607.58 8231,-2597.58 8227.5,-2607.58 8234.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_res1 -->
<g id="node366" class="node">
<title>LLaMA_7B_S2_R2_L11_res1</title>
<polygon fill="lightyellow" stroke="black" points="8318.84,-2471.56 8179.11,-2471.56 8143.16,-2435.56 8282.89,-2435.56 8318.84,-2471.56"/>
<text text-anchor="middle" x="8231" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_ar1&#45;&gt;LLaMA_7B_S2_R2_L11_res1 -->
<g id="edge335" class="edge">
<title>LLaMA_7B_S2_R2_L11_ar1&#45;&gt;LLaMA_7B_S2_R2_L11_res1</title>
<path fill="none" stroke="black" d="M8231,-2543.37C8231,-2525 8231,-2500.45 8231,-2481.82"/>
<polygon fill="black" stroke="black" points="8234.5,-2481.62 8231,-2471.62 8227.5,-2481.62 8234.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_norm2 -->
<g id="node367" class="node">
<title>LLaMA_7B_S2_R2_L11_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="8231" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="8231" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_res1&#45;&gt;LLaMA_7B_S2_R2_L11_norm2 -->
<g id="edge336" class="edge">
<title>LLaMA_7B_S2_R2_L11_res1&#45;&gt;LLaMA_7B_S2_R2_L11_norm2</title>
<path fill="none" stroke="black" d="M8231,-2435.12C8231,-2418.97 8231,-2394.47 8231,-2374.07"/>
<polygon fill="black" stroke="black" points="8234.5,-2373.85 8231,-2363.85 8227.5,-2373.85 8234.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_up -->
<g id="node368" class="node">
<title>LLaMA_7B_S2_R2_L11_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-2237.82 8124.5,-2237.82 8124.5,-2199.82 8337.5,-2199.82 8337.5,-2237.82"/>
<text text-anchor="middle" x="8231" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8231" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_norm2&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_up -->
<g id="edge337" class="edge">
<title>LLaMA_7B_S2_R2_L11_norm2&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_up</title>
<path fill="none" stroke="black" d="M8231,-2309.69C8231,-2291.42 8231,-2266.99 8231,-2248.22"/>
<polygon fill="black" stroke="black" points="8234.5,-2248.17 8231,-2238.17 8227.5,-2248.17 8234.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_gate -->
<g id="node369" class="node">
<title>LLaMA_7B_S2_R2_L11_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-2127.82 8124.5,-2127.82 8124.5,-2089.82 8337.5,-2089.82 8337.5,-2127.82"/>
<text text-anchor="middle" x="8231" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8231" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_gate -->
<g id="edge338" class="edge">
<title>LLaMA_7B_S2_R2_L11_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_gate</title>
<path fill="none" stroke="black" d="M8231,-2199.5C8231,-2182.64 8231,-2157.39 8231,-2137.97"/>
<polygon fill="black" stroke="black" points="8234.5,-2137.87 8231,-2127.87 8227.5,-2137.87 8234.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_down -->
<g id="node370" class="node">
<title>LLaMA_7B_S2_R2_L11_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-2017.82 8124.5,-2017.82 8124.5,-1979.82 8337.5,-1979.82 8337.5,-2017.82"/>
<text text-anchor="middle" x="8231" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8231" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_down -->
<g id="edge339" class="edge">
<title>LLaMA_7B_S2_R2_L11_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L11_ffn_down</title>
<path fill="none" stroke="black" d="M8231,-2089.5C8231,-2072.64 8231,-2047.39 8231,-2027.97"/>
<polygon fill="black" stroke="black" points="8234.5,-2027.87 8231,-2017.87 8227.5,-2027.87 8234.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_ar2 -->
<g id="node371" class="node">
<title>LLaMA_7B_S2_R2_L11_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8231" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="8231" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L11_ar2 -->
<g id="edge340" class="edge">
<title>LLaMA_7B_S2_R2_L11_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L11_ar2</title>
<path fill="none" stroke="black" d="M8231,-1979.72C8231,-1963.35 8231,-1938.76 8231,-1918.33"/>
<polygon fill="black" stroke="black" points="8234.5,-1918.1 8231,-1908.1 8227.5,-1918.1 8234.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L11_res2 -->
<g id="node372" class="node">
<title>LLaMA_7B_S2_R2_L11_res2</title>
<polygon fill="lightyellow" stroke="black" points="8318.84,-1782.08 8179.11,-1782.08 8143.16,-1746.08 8282.89,-1746.08 8318.84,-1782.08"/>
<text text-anchor="middle" x="8231" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L11_ar2&#45;&gt;LLaMA_7B_S2_R2_L11_res2 -->
<g id="edge341" class="edge">
<title>LLaMA_7B_S2_R2_L11_ar2&#45;&gt;LLaMA_7B_S2_R2_L11_res2</title>
<path fill="none" stroke="black" d="M8231,-1853.89C8231,-1835.51 8231,-1810.97 8231,-1792.34"/>
<polygon fill="black" stroke="black" points="8234.5,-1792.14 8231,-1782.14 8227.5,-1792.14 8234.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_split -->
<g id="node373" class="node">
<title>LLaMA_7B_S2_R2_L12_split</title>
<polygon fill="orange" stroke="black" points="7799.53,-3091.04 7148.06,-3091.04 6980.47,-3015.04 7631.94,-3015.04 7799.53,-3091.04"/>
<text text-anchor="middle" x="7390" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="7390" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_norm1 -->
<g id="node374" class="node">
<title>LLaMA_7B_S2_R2_L12_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="7390" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7390" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_split&#45;&gt;LLaMA_7B_S2_R2_L12_norm1 -->
<g id="edge342" class="edge">
<title>LLaMA_7B_S2_R2_L12_split&#45;&gt;LLaMA_7B_S2_R2_L12_norm1</title>
<path fill="none" stroke="black" d="M7390,-3014.83C7390,-2995.62 7390,-2972.29 7390,-2953.24"/>
<polygon fill="black" stroke="black" points="7393.5,-2953.16 7390,-2943.16 7386.5,-2953.16 7393.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_qkv -->
<g id="node375" class="node">
<title>LLaMA_7B_S2_R2_L12_qkv</title>
<polygon fill="lightcoral" stroke="black" points="7536.5,-2817.3 7243.5,-2817.3 7243.5,-2779.3 7536.5,-2779.3 7536.5,-2817.3"/>
<text text-anchor="middle" x="7390" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="7390" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_norm1&#45;&gt;LLaMA_7B_S2_R2_L12_qkv -->
<g id="edge343" class="edge">
<title>LLaMA_7B_S2_R2_L12_norm1&#45;&gt;LLaMA_7B_S2_R2_L12_qkv</title>
<path fill="none" stroke="black" d="M7390,-2889.17C7390,-2870.9 7390,-2846.47 7390,-2827.7"/>
<polygon fill="black" stroke="black" points="7393.5,-2827.65 7390,-2817.65 7386.5,-2827.65 7393.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_attn -->
<g id="node376" class="node">
<title>LLaMA_7B_S2_R2_L12_attn</title>
<polygon fill="lightcoral" stroke="black" points="7536.5,-2707.3 7243.5,-2707.3 7243.5,-2669.3 7536.5,-2669.3 7536.5,-2707.3"/>
<text text-anchor="middle" x="7390" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7390" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_qkv&#45;&gt;LLaMA_7B_S2_R2_L12_attn -->
<g id="edge344" class="edge">
<title>LLaMA_7B_S2_R2_L12_qkv&#45;&gt;LLaMA_7B_S2_R2_L12_attn</title>
<path fill="none" stroke="black" d="M7390,-2778.98C7390,-2762.12 7390,-2736.87 7390,-2717.45"/>
<polygon fill="black" stroke="black" points="7393.5,-2717.35 7390,-2707.35 7386.5,-2717.35 7393.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_ar1 -->
<g id="node377" class="node">
<title>LLaMA_7B_S2_R2_L12_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7390" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7390" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_attn&#45;&gt;LLaMA_7B_S2_R2_L12_ar1 -->
<g id="edge345" class="edge">
<title>LLaMA_7B_S2_R2_L12_attn&#45;&gt;LLaMA_7B_S2_R2_L12_ar1</title>
<path fill="none" stroke="black" d="M7390,-2669.2C7390,-2652.83 7390,-2628.24 7390,-2607.81"/>
<polygon fill="black" stroke="black" points="7393.5,-2607.58 7390,-2597.58 7386.5,-2607.58 7393.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_res1 -->
<g id="node378" class="node">
<title>LLaMA_7B_S2_R2_L12_res1</title>
<polygon fill="lightyellow" stroke="black" points="7477.84,-2471.56 7338.11,-2471.56 7302.16,-2435.56 7441.89,-2435.56 7477.84,-2471.56"/>
<text text-anchor="middle" x="7390" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_ar1&#45;&gt;LLaMA_7B_S2_R2_L12_res1 -->
<g id="edge346" class="edge">
<title>LLaMA_7B_S2_R2_L12_ar1&#45;&gt;LLaMA_7B_S2_R2_L12_res1</title>
<path fill="none" stroke="black" d="M7390,-2543.37C7390,-2525 7390,-2500.45 7390,-2481.82"/>
<polygon fill="black" stroke="black" points="7393.5,-2481.62 7390,-2471.62 7386.5,-2481.62 7393.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_norm2 -->
<g id="node379" class="node">
<title>LLaMA_7B_S2_R2_L12_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="7390" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="7390" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_res1&#45;&gt;LLaMA_7B_S2_R2_L12_norm2 -->
<g id="edge347" class="edge">
<title>LLaMA_7B_S2_R2_L12_res1&#45;&gt;LLaMA_7B_S2_R2_L12_norm2</title>
<path fill="none" stroke="black" d="M7390,-2435.12C7390,-2418.97 7390,-2394.47 7390,-2374.07"/>
<polygon fill="black" stroke="black" points="7393.5,-2373.85 7390,-2363.85 7386.5,-2373.85 7393.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_up -->
<g id="node380" class="node">
<title>LLaMA_7B_S2_R2_L12_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-2237.82 7283.5,-2237.82 7283.5,-2199.82 7496.5,-2199.82 7496.5,-2237.82"/>
<text text-anchor="middle" x="7390" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7390" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_norm2&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_up -->
<g id="edge348" class="edge">
<title>LLaMA_7B_S2_R2_L12_norm2&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_up</title>
<path fill="none" stroke="black" d="M7390,-2309.69C7390,-2291.42 7390,-2266.99 7390,-2248.22"/>
<polygon fill="black" stroke="black" points="7393.5,-2248.17 7390,-2238.17 7386.5,-2248.17 7393.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_gate -->
<g id="node381" class="node">
<title>LLaMA_7B_S2_R2_L12_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-2127.82 7283.5,-2127.82 7283.5,-2089.82 7496.5,-2089.82 7496.5,-2127.82"/>
<text text-anchor="middle" x="7390" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7390" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_gate -->
<g id="edge349" class="edge">
<title>LLaMA_7B_S2_R2_L12_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_gate</title>
<path fill="none" stroke="black" d="M7390,-2199.5C7390,-2182.64 7390,-2157.39 7390,-2137.97"/>
<polygon fill="black" stroke="black" points="7393.5,-2137.87 7390,-2127.87 7386.5,-2137.87 7393.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_down -->
<g id="node382" class="node">
<title>LLaMA_7B_S2_R2_L12_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-2017.82 7283.5,-2017.82 7283.5,-1979.82 7496.5,-1979.82 7496.5,-2017.82"/>
<text text-anchor="middle" x="7390" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7390" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_down -->
<g id="edge350" class="edge">
<title>LLaMA_7B_S2_R2_L12_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L12_ffn_down</title>
<path fill="none" stroke="black" d="M7390,-2089.5C7390,-2072.64 7390,-2047.39 7390,-2027.97"/>
<polygon fill="black" stroke="black" points="7393.5,-2027.87 7390,-2017.87 7386.5,-2027.87 7393.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_ar2 -->
<g id="node383" class="node">
<title>LLaMA_7B_S2_R2_L12_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7390" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="7390" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L12_ar2 -->
<g id="edge351" class="edge">
<title>LLaMA_7B_S2_R2_L12_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L12_ar2</title>
<path fill="none" stroke="black" d="M7390,-1979.72C7390,-1963.35 7390,-1938.76 7390,-1918.33"/>
<polygon fill="black" stroke="black" points="7393.5,-1918.1 7390,-1908.1 7386.5,-1918.1 7393.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L12_res2 -->
<g id="node384" class="node">
<title>LLaMA_7B_S2_R2_L12_res2</title>
<polygon fill="lightyellow" stroke="black" points="7477.84,-1782.08 7338.11,-1782.08 7302.16,-1746.08 7441.89,-1746.08 7477.84,-1782.08"/>
<text text-anchor="middle" x="7390" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L12_ar2&#45;&gt;LLaMA_7B_S2_R2_L12_res2 -->
<g id="edge352" class="edge">
<title>LLaMA_7B_S2_R2_L12_ar2&#45;&gt;LLaMA_7B_S2_R2_L12_res2</title>
<path fill="none" stroke="black" d="M7390,-1853.89C7390,-1835.51 7390,-1810.97 7390,-1792.34"/>
<polygon fill="black" stroke="black" points="7393.5,-1792.14 7390,-1782.14 7386.5,-1792.14 7393.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_split -->
<g id="node385" class="node">
<title>LLaMA_7B_S2_R2_L13_split</title>
<polygon fill="orange" stroke="black" points="6958.53,-3091.04 6307.06,-3091.04 6139.47,-3015.04 6790.94,-3015.04 6958.53,-3091.04"/>
<text text-anchor="middle" x="6549" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="6549" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_norm1 -->
<g id="node386" class="node">
<title>LLaMA_7B_S2_R2_L13_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="6549" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6549" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_split&#45;&gt;LLaMA_7B_S2_R2_L13_norm1 -->
<g id="edge353" class="edge">
<title>LLaMA_7B_S2_R2_L13_split&#45;&gt;LLaMA_7B_S2_R2_L13_norm1</title>
<path fill="none" stroke="black" d="M6549,-3014.83C6549,-2995.62 6549,-2972.29 6549,-2953.24"/>
<polygon fill="black" stroke="black" points="6552.5,-2953.16 6549,-2943.16 6545.5,-2953.16 6552.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_qkv -->
<g id="node387" class="node">
<title>LLaMA_7B_S2_R2_L13_qkv</title>
<polygon fill="lightcoral" stroke="black" points="6695.5,-2817.3 6402.5,-2817.3 6402.5,-2779.3 6695.5,-2779.3 6695.5,-2817.3"/>
<text text-anchor="middle" x="6549" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="6549" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_norm1&#45;&gt;LLaMA_7B_S2_R2_L13_qkv -->
<g id="edge354" class="edge">
<title>LLaMA_7B_S2_R2_L13_norm1&#45;&gt;LLaMA_7B_S2_R2_L13_qkv</title>
<path fill="none" stroke="black" d="M6549,-2889.17C6549,-2870.9 6549,-2846.47 6549,-2827.7"/>
<polygon fill="black" stroke="black" points="6552.5,-2827.65 6549,-2817.65 6545.5,-2827.65 6552.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_attn -->
<g id="node388" class="node">
<title>LLaMA_7B_S2_R2_L13_attn</title>
<polygon fill="lightcoral" stroke="black" points="6695.5,-2707.3 6402.5,-2707.3 6402.5,-2669.3 6695.5,-2669.3 6695.5,-2707.3"/>
<text text-anchor="middle" x="6549" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6549" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_qkv&#45;&gt;LLaMA_7B_S2_R2_L13_attn -->
<g id="edge355" class="edge">
<title>LLaMA_7B_S2_R2_L13_qkv&#45;&gt;LLaMA_7B_S2_R2_L13_attn</title>
<path fill="none" stroke="black" d="M6549,-2778.98C6549,-2762.12 6549,-2736.87 6549,-2717.45"/>
<polygon fill="black" stroke="black" points="6552.5,-2717.35 6549,-2707.35 6545.5,-2717.35 6552.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_ar1 -->
<g id="node389" class="node">
<title>LLaMA_7B_S2_R2_L13_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6549" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6549" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_attn&#45;&gt;LLaMA_7B_S2_R2_L13_ar1 -->
<g id="edge356" class="edge">
<title>LLaMA_7B_S2_R2_L13_attn&#45;&gt;LLaMA_7B_S2_R2_L13_ar1</title>
<path fill="none" stroke="black" d="M6549,-2669.2C6549,-2652.83 6549,-2628.24 6549,-2607.81"/>
<polygon fill="black" stroke="black" points="6552.5,-2607.58 6549,-2597.58 6545.5,-2607.58 6552.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_res1 -->
<g id="node390" class="node">
<title>LLaMA_7B_S2_R2_L13_res1</title>
<polygon fill="lightyellow" stroke="black" points="6636.84,-2471.56 6497.11,-2471.56 6461.16,-2435.56 6600.89,-2435.56 6636.84,-2471.56"/>
<text text-anchor="middle" x="6549" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_ar1&#45;&gt;LLaMA_7B_S2_R2_L13_res1 -->
<g id="edge357" class="edge">
<title>LLaMA_7B_S2_R2_L13_ar1&#45;&gt;LLaMA_7B_S2_R2_L13_res1</title>
<path fill="none" stroke="black" d="M6549,-2543.37C6549,-2525 6549,-2500.45 6549,-2481.82"/>
<polygon fill="black" stroke="black" points="6552.5,-2481.62 6549,-2471.62 6545.5,-2481.62 6552.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_norm2 -->
<g id="node391" class="node">
<title>LLaMA_7B_S2_R2_L13_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="6549" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="6549" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_res1&#45;&gt;LLaMA_7B_S2_R2_L13_norm2 -->
<g id="edge358" class="edge">
<title>LLaMA_7B_S2_R2_L13_res1&#45;&gt;LLaMA_7B_S2_R2_L13_norm2</title>
<path fill="none" stroke="black" d="M6549,-2435.12C6549,-2418.97 6549,-2394.47 6549,-2374.07"/>
<polygon fill="black" stroke="black" points="6552.5,-2373.85 6549,-2363.85 6545.5,-2373.85 6552.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_up -->
<g id="node392" class="node">
<title>LLaMA_7B_S2_R2_L13_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-2237.82 6442.5,-2237.82 6442.5,-2199.82 6655.5,-2199.82 6655.5,-2237.82"/>
<text text-anchor="middle" x="6549" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6549" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_norm2&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_up -->
<g id="edge359" class="edge">
<title>LLaMA_7B_S2_R2_L13_norm2&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_up</title>
<path fill="none" stroke="black" d="M6549,-2309.69C6549,-2291.42 6549,-2266.99 6549,-2248.22"/>
<polygon fill="black" stroke="black" points="6552.5,-2248.17 6549,-2238.17 6545.5,-2248.17 6552.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_gate -->
<g id="node393" class="node">
<title>LLaMA_7B_S2_R2_L13_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-2127.82 6442.5,-2127.82 6442.5,-2089.82 6655.5,-2089.82 6655.5,-2127.82"/>
<text text-anchor="middle" x="6549" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6549" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_gate -->
<g id="edge360" class="edge">
<title>LLaMA_7B_S2_R2_L13_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_gate</title>
<path fill="none" stroke="black" d="M6549,-2199.5C6549,-2182.64 6549,-2157.39 6549,-2137.97"/>
<polygon fill="black" stroke="black" points="6552.5,-2137.87 6549,-2127.87 6545.5,-2137.87 6552.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_down -->
<g id="node394" class="node">
<title>LLaMA_7B_S2_R2_L13_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-2017.82 6442.5,-2017.82 6442.5,-1979.82 6655.5,-1979.82 6655.5,-2017.82"/>
<text text-anchor="middle" x="6549" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6549" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_down -->
<g id="edge361" class="edge">
<title>LLaMA_7B_S2_R2_L13_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L13_ffn_down</title>
<path fill="none" stroke="black" d="M6549,-2089.5C6549,-2072.64 6549,-2047.39 6549,-2027.97"/>
<polygon fill="black" stroke="black" points="6552.5,-2027.87 6549,-2017.87 6545.5,-2027.87 6552.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_ar2 -->
<g id="node395" class="node">
<title>LLaMA_7B_S2_R2_L13_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6549" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="6549" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L13_ar2 -->
<g id="edge362" class="edge">
<title>LLaMA_7B_S2_R2_L13_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L13_ar2</title>
<path fill="none" stroke="black" d="M6549,-1979.72C6549,-1963.35 6549,-1938.76 6549,-1918.33"/>
<polygon fill="black" stroke="black" points="6552.5,-1918.1 6549,-1908.1 6545.5,-1918.1 6552.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L13_res2 -->
<g id="node396" class="node">
<title>LLaMA_7B_S2_R2_L13_res2</title>
<polygon fill="lightyellow" stroke="black" points="6636.84,-1782.08 6497.11,-1782.08 6461.16,-1746.08 6600.89,-1746.08 6636.84,-1782.08"/>
<text text-anchor="middle" x="6549" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L13_ar2&#45;&gt;LLaMA_7B_S2_R2_L13_res2 -->
<g id="edge363" class="edge">
<title>LLaMA_7B_S2_R2_L13_ar2&#45;&gt;LLaMA_7B_S2_R2_L13_res2</title>
<path fill="none" stroke="black" d="M6549,-1853.89C6549,-1835.51 6549,-1810.97 6549,-1792.34"/>
<polygon fill="black" stroke="black" points="6552.5,-1792.14 6549,-1782.14 6545.5,-1792.14 6552.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_split -->
<g id="node397" class="node">
<title>LLaMA_7B_S2_R2_L14_split</title>
<polygon fill="orange" stroke="black" points="6117.53,-3091.04 5466.06,-3091.04 5298.47,-3015.04 5949.94,-3015.04 6117.53,-3091.04"/>
<text text-anchor="middle" x="5708" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="5708" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_norm1 -->
<g id="node398" class="node">
<title>LLaMA_7B_S2_R2_L14_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="5708" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5708" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_split&#45;&gt;LLaMA_7B_S2_R2_L14_norm1 -->
<g id="edge364" class="edge">
<title>LLaMA_7B_S2_R2_L14_split&#45;&gt;LLaMA_7B_S2_R2_L14_norm1</title>
<path fill="none" stroke="black" d="M5708,-3014.83C5708,-2995.62 5708,-2972.29 5708,-2953.24"/>
<polygon fill="black" stroke="black" points="5711.5,-2953.16 5708,-2943.16 5704.5,-2953.16 5711.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_qkv -->
<g id="node399" class="node">
<title>LLaMA_7B_S2_R2_L14_qkv</title>
<polygon fill="lightcoral" stroke="black" points="5854.5,-2817.3 5561.5,-2817.3 5561.5,-2779.3 5854.5,-2779.3 5854.5,-2817.3"/>
<text text-anchor="middle" x="5708" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="5708" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_norm1&#45;&gt;LLaMA_7B_S2_R2_L14_qkv -->
<g id="edge365" class="edge">
<title>LLaMA_7B_S2_R2_L14_norm1&#45;&gt;LLaMA_7B_S2_R2_L14_qkv</title>
<path fill="none" stroke="black" d="M5708,-2889.17C5708,-2870.9 5708,-2846.47 5708,-2827.7"/>
<polygon fill="black" stroke="black" points="5711.5,-2827.65 5708,-2817.65 5704.5,-2827.65 5711.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_attn -->
<g id="node400" class="node">
<title>LLaMA_7B_S2_R2_L14_attn</title>
<polygon fill="lightcoral" stroke="black" points="5854.5,-2707.3 5561.5,-2707.3 5561.5,-2669.3 5854.5,-2669.3 5854.5,-2707.3"/>
<text text-anchor="middle" x="5708" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5708" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_qkv&#45;&gt;LLaMA_7B_S2_R2_L14_attn -->
<g id="edge366" class="edge">
<title>LLaMA_7B_S2_R2_L14_qkv&#45;&gt;LLaMA_7B_S2_R2_L14_attn</title>
<path fill="none" stroke="black" d="M5708,-2778.98C5708,-2762.12 5708,-2736.87 5708,-2717.45"/>
<polygon fill="black" stroke="black" points="5711.5,-2717.35 5708,-2707.35 5704.5,-2717.35 5711.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_ar1 -->
<g id="node401" class="node">
<title>LLaMA_7B_S2_R2_L14_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5708" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5708" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_attn&#45;&gt;LLaMA_7B_S2_R2_L14_ar1 -->
<g id="edge367" class="edge">
<title>LLaMA_7B_S2_R2_L14_attn&#45;&gt;LLaMA_7B_S2_R2_L14_ar1</title>
<path fill="none" stroke="black" d="M5708,-2669.2C5708,-2652.83 5708,-2628.24 5708,-2607.81"/>
<polygon fill="black" stroke="black" points="5711.5,-2607.58 5708,-2597.58 5704.5,-2607.58 5711.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_res1 -->
<g id="node402" class="node">
<title>LLaMA_7B_S2_R2_L14_res1</title>
<polygon fill="lightyellow" stroke="black" points="5795.84,-2471.56 5656.11,-2471.56 5620.16,-2435.56 5759.89,-2435.56 5795.84,-2471.56"/>
<text text-anchor="middle" x="5708" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_ar1&#45;&gt;LLaMA_7B_S2_R2_L14_res1 -->
<g id="edge368" class="edge">
<title>LLaMA_7B_S2_R2_L14_ar1&#45;&gt;LLaMA_7B_S2_R2_L14_res1</title>
<path fill="none" stroke="black" d="M5708,-2543.37C5708,-2525 5708,-2500.45 5708,-2481.82"/>
<polygon fill="black" stroke="black" points="5711.5,-2481.62 5708,-2471.62 5704.5,-2481.62 5711.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_norm2 -->
<g id="node403" class="node">
<title>LLaMA_7B_S2_R2_L14_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="5708" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5708" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_res1&#45;&gt;LLaMA_7B_S2_R2_L14_norm2 -->
<g id="edge369" class="edge">
<title>LLaMA_7B_S2_R2_L14_res1&#45;&gt;LLaMA_7B_S2_R2_L14_norm2</title>
<path fill="none" stroke="black" d="M5708,-2435.12C5708,-2418.97 5708,-2394.47 5708,-2374.07"/>
<polygon fill="black" stroke="black" points="5711.5,-2373.85 5708,-2363.85 5704.5,-2373.85 5711.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_up -->
<g id="node404" class="node">
<title>LLaMA_7B_S2_R2_L14_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-2237.82 5601.5,-2237.82 5601.5,-2199.82 5814.5,-2199.82 5814.5,-2237.82"/>
<text text-anchor="middle" x="5708" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5708" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_norm2&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_up -->
<g id="edge370" class="edge">
<title>LLaMA_7B_S2_R2_L14_norm2&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_up</title>
<path fill="none" stroke="black" d="M5708,-2309.69C5708,-2291.42 5708,-2266.99 5708,-2248.22"/>
<polygon fill="black" stroke="black" points="5711.5,-2248.17 5708,-2238.17 5704.5,-2248.17 5711.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_gate -->
<g id="node405" class="node">
<title>LLaMA_7B_S2_R2_L14_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-2127.82 5601.5,-2127.82 5601.5,-2089.82 5814.5,-2089.82 5814.5,-2127.82"/>
<text text-anchor="middle" x="5708" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5708" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_gate -->
<g id="edge371" class="edge">
<title>LLaMA_7B_S2_R2_L14_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_gate</title>
<path fill="none" stroke="black" d="M5708,-2199.5C5708,-2182.64 5708,-2157.39 5708,-2137.97"/>
<polygon fill="black" stroke="black" points="5711.5,-2137.87 5708,-2127.87 5704.5,-2137.87 5711.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_down -->
<g id="node406" class="node">
<title>LLaMA_7B_S2_R2_L14_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-2017.82 5601.5,-2017.82 5601.5,-1979.82 5814.5,-1979.82 5814.5,-2017.82"/>
<text text-anchor="middle" x="5708" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5708" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_down -->
<g id="edge372" class="edge">
<title>LLaMA_7B_S2_R2_L14_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L14_ffn_down</title>
<path fill="none" stroke="black" d="M5708,-2089.5C5708,-2072.64 5708,-2047.39 5708,-2027.97"/>
<polygon fill="black" stroke="black" points="5711.5,-2027.87 5708,-2017.87 5704.5,-2027.87 5711.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_ar2 -->
<g id="node407" class="node">
<title>LLaMA_7B_S2_R2_L14_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5708" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="5708" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L14_ar2 -->
<g id="edge373" class="edge">
<title>LLaMA_7B_S2_R2_L14_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L14_ar2</title>
<path fill="none" stroke="black" d="M5708,-1979.72C5708,-1963.35 5708,-1938.76 5708,-1918.33"/>
<polygon fill="black" stroke="black" points="5711.5,-1918.1 5708,-1908.1 5704.5,-1918.1 5711.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L14_res2 -->
<g id="node408" class="node">
<title>LLaMA_7B_S2_R2_L14_res2</title>
<polygon fill="lightyellow" stroke="black" points="5795.84,-1782.08 5656.11,-1782.08 5620.16,-1746.08 5759.89,-1746.08 5795.84,-1782.08"/>
<text text-anchor="middle" x="5708" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L14_ar2&#45;&gt;LLaMA_7B_S2_R2_L14_res2 -->
<g id="edge374" class="edge">
<title>LLaMA_7B_S2_R2_L14_ar2&#45;&gt;LLaMA_7B_S2_R2_L14_res2</title>
<path fill="none" stroke="black" d="M5708,-1853.89C5708,-1835.51 5708,-1810.97 5708,-1792.34"/>
<polygon fill="black" stroke="black" points="5711.5,-1792.14 5708,-1782.14 5704.5,-1792.14 5711.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_split -->
<g id="node409" class="node">
<title>LLaMA_7B_S2_R2_L15_split</title>
<polygon fill="orange" stroke="black" points="5276.53,-3091.04 4625.06,-3091.04 4457.47,-3015.04 5108.94,-3015.04 5276.53,-3091.04"/>
<text text-anchor="middle" x="4867" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="4867" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_norm1 -->
<g id="node410" class="node">
<title>LLaMA_7B_S2_R2_L15_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="4867" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4867" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_split&#45;&gt;LLaMA_7B_S2_R2_L15_norm1 -->
<g id="edge375" class="edge">
<title>LLaMA_7B_S2_R2_L15_split&#45;&gt;LLaMA_7B_S2_R2_L15_norm1</title>
<path fill="none" stroke="black" d="M4867,-3014.83C4867,-2995.62 4867,-2972.29 4867,-2953.24"/>
<polygon fill="black" stroke="black" points="4870.5,-2953.16 4867,-2943.16 4863.5,-2953.16 4870.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_qkv -->
<g id="node411" class="node">
<title>LLaMA_7B_S2_R2_L15_qkv</title>
<polygon fill="lightcoral" stroke="black" points="5013.5,-2817.3 4720.5,-2817.3 4720.5,-2779.3 5013.5,-2779.3 5013.5,-2817.3"/>
<text text-anchor="middle" x="4867" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="4867" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_norm1&#45;&gt;LLaMA_7B_S2_R2_L15_qkv -->
<g id="edge376" class="edge">
<title>LLaMA_7B_S2_R2_L15_norm1&#45;&gt;LLaMA_7B_S2_R2_L15_qkv</title>
<path fill="none" stroke="black" d="M4867,-2889.17C4867,-2870.9 4867,-2846.47 4867,-2827.7"/>
<polygon fill="black" stroke="black" points="4870.5,-2827.65 4867,-2817.65 4863.5,-2827.65 4870.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_attn -->
<g id="node412" class="node">
<title>LLaMA_7B_S2_R2_L15_attn</title>
<polygon fill="lightcoral" stroke="black" points="5013.5,-2707.3 4720.5,-2707.3 4720.5,-2669.3 5013.5,-2669.3 5013.5,-2707.3"/>
<text text-anchor="middle" x="4867" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="4867" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_qkv&#45;&gt;LLaMA_7B_S2_R2_L15_attn -->
<g id="edge377" class="edge">
<title>LLaMA_7B_S2_R2_L15_qkv&#45;&gt;LLaMA_7B_S2_R2_L15_attn</title>
<path fill="none" stroke="black" d="M4867,-2778.98C4867,-2762.12 4867,-2736.87 4867,-2717.45"/>
<polygon fill="black" stroke="black" points="4870.5,-2717.35 4867,-2707.35 4863.5,-2717.35 4870.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_ar1 -->
<g id="node413" class="node">
<title>LLaMA_7B_S2_R2_L15_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4867" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4867" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_attn&#45;&gt;LLaMA_7B_S2_R2_L15_ar1 -->
<g id="edge378" class="edge">
<title>LLaMA_7B_S2_R2_L15_attn&#45;&gt;LLaMA_7B_S2_R2_L15_ar1</title>
<path fill="none" stroke="black" d="M4867,-2669.2C4867,-2652.83 4867,-2628.24 4867,-2607.81"/>
<polygon fill="black" stroke="black" points="4870.5,-2607.58 4867,-2597.58 4863.5,-2607.58 4870.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_res1 -->
<g id="node414" class="node">
<title>LLaMA_7B_S2_R2_L15_res1</title>
<polygon fill="lightyellow" stroke="black" points="4954.84,-2471.56 4815.11,-2471.56 4779.16,-2435.56 4918.89,-2435.56 4954.84,-2471.56"/>
<text text-anchor="middle" x="4867" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_ar1&#45;&gt;LLaMA_7B_S2_R2_L15_res1 -->
<g id="edge379" class="edge">
<title>LLaMA_7B_S2_R2_L15_ar1&#45;&gt;LLaMA_7B_S2_R2_L15_res1</title>
<path fill="none" stroke="black" d="M4867,-2543.37C4867,-2525 4867,-2500.45 4867,-2481.82"/>
<polygon fill="black" stroke="black" points="4870.5,-2481.62 4867,-2471.62 4863.5,-2481.62 4870.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_norm2 -->
<g id="node415" class="node">
<title>LLaMA_7B_S2_R2_L15_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="4867" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="4867" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_res1&#45;&gt;LLaMA_7B_S2_R2_L15_norm2 -->
<g id="edge380" class="edge">
<title>LLaMA_7B_S2_R2_L15_res1&#45;&gt;LLaMA_7B_S2_R2_L15_norm2</title>
<path fill="none" stroke="black" d="M4867,-2435.12C4867,-2418.97 4867,-2394.47 4867,-2374.07"/>
<polygon fill="black" stroke="black" points="4870.5,-2373.85 4867,-2363.85 4863.5,-2373.85 4870.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_up -->
<g id="node416" class="node">
<title>LLaMA_7B_S2_R2_L15_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-2237.82 4760.5,-2237.82 4760.5,-2199.82 4973.5,-2199.82 4973.5,-2237.82"/>
<text text-anchor="middle" x="4867" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4867" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_norm2&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_up -->
<g id="edge381" class="edge">
<title>LLaMA_7B_S2_R2_L15_norm2&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_up</title>
<path fill="none" stroke="black" d="M4867,-2309.69C4867,-2291.42 4867,-2266.99 4867,-2248.22"/>
<polygon fill="black" stroke="black" points="4870.5,-2248.17 4867,-2238.17 4863.5,-2248.17 4870.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_gate -->
<g id="node417" class="node">
<title>LLaMA_7B_S2_R2_L15_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-2127.82 4760.5,-2127.82 4760.5,-2089.82 4973.5,-2089.82 4973.5,-2127.82"/>
<text text-anchor="middle" x="4867" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4867" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_gate -->
<g id="edge382" class="edge">
<title>LLaMA_7B_S2_R2_L15_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_gate</title>
<path fill="none" stroke="black" d="M4867,-2199.5C4867,-2182.64 4867,-2157.39 4867,-2137.97"/>
<polygon fill="black" stroke="black" points="4870.5,-2137.87 4867,-2127.87 4863.5,-2137.87 4870.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_down -->
<g id="node418" class="node">
<title>LLaMA_7B_S2_R2_L15_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-2017.82 4760.5,-2017.82 4760.5,-1979.82 4973.5,-1979.82 4973.5,-2017.82"/>
<text text-anchor="middle" x="4867" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4867" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_down -->
<g id="edge383" class="edge">
<title>LLaMA_7B_S2_R2_L15_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L15_ffn_down</title>
<path fill="none" stroke="black" d="M4867,-2089.5C4867,-2072.64 4867,-2047.39 4867,-2027.97"/>
<polygon fill="black" stroke="black" points="4870.5,-2027.87 4867,-2017.87 4863.5,-2027.87 4870.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_ar2 -->
<g id="node419" class="node">
<title>LLaMA_7B_S2_R2_L15_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4867" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="4867" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L15_ar2 -->
<g id="edge384" class="edge">
<title>LLaMA_7B_S2_R2_L15_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L15_ar2</title>
<path fill="none" stroke="black" d="M4867,-1979.72C4867,-1963.35 4867,-1938.76 4867,-1918.33"/>
<polygon fill="black" stroke="black" points="4870.5,-1918.1 4867,-1908.1 4863.5,-1918.1 4870.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L15_res2 -->
<g id="node420" class="node">
<title>LLaMA_7B_S2_R2_L15_res2</title>
<polygon fill="lightyellow" stroke="black" points="4954.84,-1782.08 4815.11,-1782.08 4779.16,-1746.08 4918.89,-1746.08 4954.84,-1782.08"/>
<text text-anchor="middle" x="4867" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L15_ar2&#45;&gt;LLaMA_7B_S2_R2_L15_res2 -->
<g id="edge385" class="edge">
<title>LLaMA_7B_S2_R2_L15_ar2&#45;&gt;LLaMA_7B_S2_R2_L15_res2</title>
<path fill="none" stroke="black" d="M4867,-1853.89C4867,-1835.51 4867,-1810.97 4867,-1792.34"/>
<polygon fill="black" stroke="black" points="4870.5,-1792.14 4867,-1782.14 4863.5,-1792.14 4870.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_split -->
<g id="node421" class="node">
<title>LLaMA_7B_S2_R2_L16_split</title>
<polygon fill="orange" stroke="black" points="4435.53,-3091.04 3784.06,-3091.04 3616.47,-3015.04 4267.94,-3015.04 4435.53,-3091.04"/>
<text text-anchor="middle" x="4026" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="4026" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_norm1 -->
<g id="node422" class="node">
<title>LLaMA_7B_S2_R2_L16_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="4026" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4026" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_split&#45;&gt;LLaMA_7B_S2_R2_L16_norm1 -->
<g id="edge386" class="edge">
<title>LLaMA_7B_S2_R2_L16_split&#45;&gt;LLaMA_7B_S2_R2_L16_norm1</title>
<path fill="none" stroke="black" d="M4026,-3014.83C4026,-2995.62 4026,-2972.29 4026,-2953.24"/>
<polygon fill="black" stroke="black" points="4029.5,-2953.16 4026,-2943.16 4022.5,-2953.16 4029.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_qkv -->
<g id="node423" class="node">
<title>LLaMA_7B_S2_R2_L16_qkv</title>
<polygon fill="lightcoral" stroke="black" points="4172.5,-2817.3 3879.5,-2817.3 3879.5,-2779.3 4172.5,-2779.3 4172.5,-2817.3"/>
<text text-anchor="middle" x="4026" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="4026" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_norm1&#45;&gt;LLaMA_7B_S2_R2_L16_qkv -->
<g id="edge387" class="edge">
<title>LLaMA_7B_S2_R2_L16_norm1&#45;&gt;LLaMA_7B_S2_R2_L16_qkv</title>
<path fill="none" stroke="black" d="M4026,-2889.17C4026,-2870.9 4026,-2846.47 4026,-2827.7"/>
<polygon fill="black" stroke="black" points="4029.5,-2827.65 4026,-2817.65 4022.5,-2827.65 4029.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_attn -->
<g id="node424" class="node">
<title>LLaMA_7B_S2_R2_L16_attn</title>
<polygon fill="lightcoral" stroke="black" points="4172.5,-2707.3 3879.5,-2707.3 3879.5,-2669.3 4172.5,-2669.3 4172.5,-2707.3"/>
<text text-anchor="middle" x="4026" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="4026" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_qkv&#45;&gt;LLaMA_7B_S2_R2_L16_attn -->
<g id="edge388" class="edge">
<title>LLaMA_7B_S2_R2_L16_qkv&#45;&gt;LLaMA_7B_S2_R2_L16_attn</title>
<path fill="none" stroke="black" d="M4026,-2778.98C4026,-2762.12 4026,-2736.87 4026,-2717.45"/>
<polygon fill="black" stroke="black" points="4029.5,-2717.35 4026,-2707.35 4022.5,-2717.35 4029.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_ar1 -->
<g id="node425" class="node">
<title>LLaMA_7B_S2_R2_L16_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4026" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4026" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_attn&#45;&gt;LLaMA_7B_S2_R2_L16_ar1 -->
<g id="edge389" class="edge">
<title>LLaMA_7B_S2_R2_L16_attn&#45;&gt;LLaMA_7B_S2_R2_L16_ar1</title>
<path fill="none" stroke="black" d="M4026,-2669.2C4026,-2652.83 4026,-2628.24 4026,-2607.81"/>
<polygon fill="black" stroke="black" points="4029.5,-2607.58 4026,-2597.58 4022.5,-2607.58 4029.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_res1 -->
<g id="node426" class="node">
<title>LLaMA_7B_S2_R2_L16_res1</title>
<polygon fill="lightyellow" stroke="black" points="4113.84,-2471.56 3974.11,-2471.56 3938.16,-2435.56 4077.89,-2435.56 4113.84,-2471.56"/>
<text text-anchor="middle" x="4026" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_ar1&#45;&gt;LLaMA_7B_S2_R2_L16_res1 -->
<g id="edge390" class="edge">
<title>LLaMA_7B_S2_R2_L16_ar1&#45;&gt;LLaMA_7B_S2_R2_L16_res1</title>
<path fill="none" stroke="black" d="M4026,-2543.37C4026,-2525 4026,-2500.45 4026,-2481.82"/>
<polygon fill="black" stroke="black" points="4029.5,-2481.62 4026,-2471.62 4022.5,-2481.62 4029.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_norm2 -->
<g id="node427" class="node">
<title>LLaMA_7B_S2_R2_L16_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="4026" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="4026" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_res1&#45;&gt;LLaMA_7B_S2_R2_L16_norm2 -->
<g id="edge391" class="edge">
<title>LLaMA_7B_S2_R2_L16_res1&#45;&gt;LLaMA_7B_S2_R2_L16_norm2</title>
<path fill="none" stroke="black" d="M4026,-2435.12C4026,-2418.97 4026,-2394.47 4026,-2374.07"/>
<polygon fill="black" stroke="black" points="4029.5,-2373.85 4026,-2363.85 4022.5,-2373.85 4029.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_up -->
<g id="node428" class="node">
<title>LLaMA_7B_S2_R2_L16_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-2237.82 3919.5,-2237.82 3919.5,-2199.82 4132.5,-2199.82 4132.5,-2237.82"/>
<text text-anchor="middle" x="4026" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4026" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_norm2&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_up -->
<g id="edge392" class="edge">
<title>LLaMA_7B_S2_R2_L16_norm2&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_up</title>
<path fill="none" stroke="black" d="M4026,-2309.69C4026,-2291.42 4026,-2266.99 4026,-2248.22"/>
<polygon fill="black" stroke="black" points="4029.5,-2248.17 4026,-2238.17 4022.5,-2248.17 4029.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_gate -->
<g id="node429" class="node">
<title>LLaMA_7B_S2_R2_L16_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-2127.82 3919.5,-2127.82 3919.5,-2089.82 4132.5,-2089.82 4132.5,-2127.82"/>
<text text-anchor="middle" x="4026" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4026" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_gate -->
<g id="edge393" class="edge">
<title>LLaMA_7B_S2_R2_L16_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_gate</title>
<path fill="none" stroke="black" d="M4026,-2199.5C4026,-2182.64 4026,-2157.39 4026,-2137.97"/>
<polygon fill="black" stroke="black" points="4029.5,-2137.87 4026,-2127.87 4022.5,-2137.87 4029.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_down -->
<g id="node430" class="node">
<title>LLaMA_7B_S2_R2_L16_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-2017.82 3919.5,-2017.82 3919.5,-1979.82 4132.5,-1979.82 4132.5,-2017.82"/>
<text text-anchor="middle" x="4026" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4026" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_down -->
<g id="edge394" class="edge">
<title>LLaMA_7B_S2_R2_L16_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L16_ffn_down</title>
<path fill="none" stroke="black" d="M4026,-2089.5C4026,-2072.64 4026,-2047.39 4026,-2027.97"/>
<polygon fill="black" stroke="black" points="4029.5,-2027.87 4026,-2017.87 4022.5,-2027.87 4029.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_ar2 -->
<g id="node431" class="node">
<title>LLaMA_7B_S2_R2_L16_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4026" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="4026" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L16_ar2 -->
<g id="edge395" class="edge">
<title>LLaMA_7B_S2_R2_L16_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L16_ar2</title>
<path fill="none" stroke="black" d="M4026,-1979.72C4026,-1963.35 4026,-1938.76 4026,-1918.33"/>
<polygon fill="black" stroke="black" points="4029.5,-1918.1 4026,-1908.1 4022.5,-1918.1 4029.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L16_res2 -->
<g id="node432" class="node">
<title>LLaMA_7B_S2_R2_L16_res2</title>
<polygon fill="lightyellow" stroke="black" points="4113.84,-1782.08 3974.11,-1782.08 3938.16,-1746.08 4077.89,-1746.08 4113.84,-1782.08"/>
<text text-anchor="middle" x="4026" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L16_ar2&#45;&gt;LLaMA_7B_S2_R2_L16_res2 -->
<g id="edge396" class="edge">
<title>LLaMA_7B_S2_R2_L16_ar2&#45;&gt;LLaMA_7B_S2_R2_L16_res2</title>
<path fill="none" stroke="black" d="M4026,-1853.89C4026,-1835.51 4026,-1810.97 4026,-1792.34"/>
<polygon fill="black" stroke="black" points="4029.5,-1792.14 4026,-1782.14 4022.5,-1792.14 4029.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_split -->
<g id="node433" class="node">
<title>LLaMA_7B_S2_R2_L17_split</title>
<polygon fill="orange" stroke="black" points="3594.53,-3091.04 2943.06,-3091.04 2775.47,-3015.04 3426.94,-3015.04 3594.53,-3091.04"/>
<text text-anchor="middle" x="3185" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="3185" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_norm1 -->
<g id="node434" class="node">
<title>LLaMA_7B_S2_R2_L17_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="3185" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3185" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_split&#45;&gt;LLaMA_7B_S2_R2_L17_norm1 -->
<g id="edge397" class="edge">
<title>LLaMA_7B_S2_R2_L17_split&#45;&gt;LLaMA_7B_S2_R2_L17_norm1</title>
<path fill="none" stroke="black" d="M3185,-3014.83C3185,-2995.62 3185,-2972.29 3185,-2953.24"/>
<polygon fill="black" stroke="black" points="3188.5,-2953.16 3185,-2943.16 3181.5,-2953.16 3188.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_qkv -->
<g id="node435" class="node">
<title>LLaMA_7B_S2_R2_L17_qkv</title>
<polygon fill="lightcoral" stroke="black" points="3331.5,-2817.3 3038.5,-2817.3 3038.5,-2779.3 3331.5,-2779.3 3331.5,-2817.3"/>
<text text-anchor="middle" x="3185" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="3185" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_norm1&#45;&gt;LLaMA_7B_S2_R2_L17_qkv -->
<g id="edge398" class="edge">
<title>LLaMA_7B_S2_R2_L17_norm1&#45;&gt;LLaMA_7B_S2_R2_L17_qkv</title>
<path fill="none" stroke="black" d="M3185,-2889.17C3185,-2870.9 3185,-2846.47 3185,-2827.7"/>
<polygon fill="black" stroke="black" points="3188.5,-2827.65 3185,-2817.65 3181.5,-2827.65 3188.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_attn -->
<g id="node436" class="node">
<title>LLaMA_7B_S2_R2_L17_attn</title>
<polygon fill="lightcoral" stroke="black" points="3331.5,-2707.3 3038.5,-2707.3 3038.5,-2669.3 3331.5,-2669.3 3331.5,-2707.3"/>
<text text-anchor="middle" x="3185" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="3185" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_qkv&#45;&gt;LLaMA_7B_S2_R2_L17_attn -->
<g id="edge399" class="edge">
<title>LLaMA_7B_S2_R2_L17_qkv&#45;&gt;LLaMA_7B_S2_R2_L17_attn</title>
<path fill="none" stroke="black" d="M3185,-2778.98C3185,-2762.12 3185,-2736.87 3185,-2717.45"/>
<polygon fill="black" stroke="black" points="3188.5,-2717.35 3185,-2707.35 3181.5,-2717.35 3188.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_ar1 -->
<g id="node437" class="node">
<title>LLaMA_7B_S2_R2_L17_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3185" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3185" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_attn&#45;&gt;LLaMA_7B_S2_R2_L17_ar1 -->
<g id="edge400" class="edge">
<title>LLaMA_7B_S2_R2_L17_attn&#45;&gt;LLaMA_7B_S2_R2_L17_ar1</title>
<path fill="none" stroke="black" d="M3185,-2669.2C3185,-2652.83 3185,-2628.24 3185,-2607.81"/>
<polygon fill="black" stroke="black" points="3188.5,-2607.58 3185,-2597.58 3181.5,-2607.58 3188.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_res1 -->
<g id="node438" class="node">
<title>LLaMA_7B_S2_R2_L17_res1</title>
<polygon fill="lightyellow" stroke="black" points="3272.84,-2471.56 3133.11,-2471.56 3097.16,-2435.56 3236.89,-2435.56 3272.84,-2471.56"/>
<text text-anchor="middle" x="3185" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_ar1&#45;&gt;LLaMA_7B_S2_R2_L17_res1 -->
<g id="edge401" class="edge">
<title>LLaMA_7B_S2_R2_L17_ar1&#45;&gt;LLaMA_7B_S2_R2_L17_res1</title>
<path fill="none" stroke="black" d="M3185,-2543.37C3185,-2525 3185,-2500.45 3185,-2481.82"/>
<polygon fill="black" stroke="black" points="3188.5,-2481.62 3185,-2471.62 3181.5,-2481.62 3188.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_norm2 -->
<g id="node439" class="node">
<title>LLaMA_7B_S2_R2_L17_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="3185" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="3185" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_res1&#45;&gt;LLaMA_7B_S2_R2_L17_norm2 -->
<g id="edge402" class="edge">
<title>LLaMA_7B_S2_R2_L17_res1&#45;&gt;LLaMA_7B_S2_R2_L17_norm2</title>
<path fill="none" stroke="black" d="M3185,-2435.12C3185,-2418.97 3185,-2394.47 3185,-2374.07"/>
<polygon fill="black" stroke="black" points="3188.5,-2373.85 3185,-2363.85 3181.5,-2373.85 3188.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_up -->
<g id="node440" class="node">
<title>LLaMA_7B_S2_R2_L17_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-2237.82 3078.5,-2237.82 3078.5,-2199.82 3291.5,-2199.82 3291.5,-2237.82"/>
<text text-anchor="middle" x="3185" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3185" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_norm2&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_up -->
<g id="edge403" class="edge">
<title>LLaMA_7B_S2_R2_L17_norm2&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_up</title>
<path fill="none" stroke="black" d="M3185,-2309.69C3185,-2291.42 3185,-2266.99 3185,-2248.22"/>
<polygon fill="black" stroke="black" points="3188.5,-2248.17 3185,-2238.17 3181.5,-2248.17 3188.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_gate -->
<g id="node441" class="node">
<title>LLaMA_7B_S2_R2_L17_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-2127.82 3078.5,-2127.82 3078.5,-2089.82 3291.5,-2089.82 3291.5,-2127.82"/>
<text text-anchor="middle" x="3185" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3185" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_gate -->
<g id="edge404" class="edge">
<title>LLaMA_7B_S2_R2_L17_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_gate</title>
<path fill="none" stroke="black" d="M3185,-2199.5C3185,-2182.64 3185,-2157.39 3185,-2137.97"/>
<polygon fill="black" stroke="black" points="3188.5,-2137.87 3185,-2127.87 3181.5,-2137.87 3188.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_down -->
<g id="node442" class="node">
<title>LLaMA_7B_S2_R2_L17_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-2017.82 3078.5,-2017.82 3078.5,-1979.82 3291.5,-1979.82 3291.5,-2017.82"/>
<text text-anchor="middle" x="3185" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3185" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_down -->
<g id="edge405" class="edge">
<title>LLaMA_7B_S2_R2_L17_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L17_ffn_down</title>
<path fill="none" stroke="black" d="M3185,-2089.5C3185,-2072.64 3185,-2047.39 3185,-2027.97"/>
<polygon fill="black" stroke="black" points="3188.5,-2027.87 3185,-2017.87 3181.5,-2027.87 3188.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_ar2 -->
<g id="node443" class="node">
<title>LLaMA_7B_S2_R2_L17_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3185" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="3185" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L17_ar2 -->
<g id="edge406" class="edge">
<title>LLaMA_7B_S2_R2_L17_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L17_ar2</title>
<path fill="none" stroke="black" d="M3185,-1979.72C3185,-1963.35 3185,-1938.76 3185,-1918.33"/>
<polygon fill="black" stroke="black" points="3188.5,-1918.1 3185,-1908.1 3181.5,-1918.1 3188.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L17_res2 -->
<g id="node444" class="node">
<title>LLaMA_7B_S2_R2_L17_res2</title>
<polygon fill="lightyellow" stroke="black" points="3272.84,-1782.08 3133.11,-1782.08 3097.16,-1746.08 3236.89,-1746.08 3272.84,-1782.08"/>
<text text-anchor="middle" x="3185" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L17_ar2&#45;&gt;LLaMA_7B_S2_R2_L17_res2 -->
<g id="edge407" class="edge">
<title>LLaMA_7B_S2_R2_L17_ar2&#45;&gt;LLaMA_7B_S2_R2_L17_res2</title>
<path fill="none" stroke="black" d="M3185,-1853.89C3185,-1835.51 3185,-1810.97 3185,-1792.34"/>
<polygon fill="black" stroke="black" points="3188.5,-1792.14 3185,-1782.14 3181.5,-1792.14 3188.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_split -->
<g id="node445" class="node">
<title>LLaMA_7B_S2_R2_L18_split</title>
<polygon fill="orange" stroke="black" points="2753.53,-3091.04 2102.06,-3091.04 1934.47,-3015.04 2585.94,-3015.04 2753.53,-3091.04"/>
<text text-anchor="middle" x="2344" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="2344" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_norm1 -->
<g id="node446" class="node">
<title>LLaMA_7B_S2_R2_L18_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="2344" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2344" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_split&#45;&gt;LLaMA_7B_S2_R2_L18_norm1 -->
<g id="edge408" class="edge">
<title>LLaMA_7B_S2_R2_L18_split&#45;&gt;LLaMA_7B_S2_R2_L18_norm1</title>
<path fill="none" stroke="black" d="M2344,-3014.83C2344,-2995.62 2344,-2972.29 2344,-2953.24"/>
<polygon fill="black" stroke="black" points="2347.5,-2953.16 2344,-2943.16 2340.5,-2953.16 2347.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_qkv -->
<g id="node447" class="node">
<title>LLaMA_7B_S2_R2_L18_qkv</title>
<polygon fill="lightcoral" stroke="black" points="2490.5,-2817.3 2197.5,-2817.3 2197.5,-2779.3 2490.5,-2779.3 2490.5,-2817.3"/>
<text text-anchor="middle" x="2344" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="2344" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_norm1&#45;&gt;LLaMA_7B_S2_R2_L18_qkv -->
<g id="edge409" class="edge">
<title>LLaMA_7B_S2_R2_L18_norm1&#45;&gt;LLaMA_7B_S2_R2_L18_qkv</title>
<path fill="none" stroke="black" d="M2344,-2889.17C2344,-2870.9 2344,-2846.47 2344,-2827.7"/>
<polygon fill="black" stroke="black" points="2347.5,-2827.65 2344,-2817.65 2340.5,-2827.65 2347.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_attn -->
<g id="node448" class="node">
<title>LLaMA_7B_S2_R2_L18_attn</title>
<polygon fill="lightcoral" stroke="black" points="2490.5,-2707.3 2197.5,-2707.3 2197.5,-2669.3 2490.5,-2669.3 2490.5,-2707.3"/>
<text text-anchor="middle" x="2344" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="2344" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_qkv&#45;&gt;LLaMA_7B_S2_R2_L18_attn -->
<g id="edge410" class="edge">
<title>LLaMA_7B_S2_R2_L18_qkv&#45;&gt;LLaMA_7B_S2_R2_L18_attn</title>
<path fill="none" stroke="black" d="M2344,-2778.98C2344,-2762.12 2344,-2736.87 2344,-2717.45"/>
<polygon fill="black" stroke="black" points="2347.5,-2717.35 2344,-2707.35 2340.5,-2717.35 2347.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_ar1 -->
<g id="node449" class="node">
<title>LLaMA_7B_S2_R2_L18_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2344" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2344" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_attn&#45;&gt;LLaMA_7B_S2_R2_L18_ar1 -->
<g id="edge411" class="edge">
<title>LLaMA_7B_S2_R2_L18_attn&#45;&gt;LLaMA_7B_S2_R2_L18_ar1</title>
<path fill="none" stroke="black" d="M2344,-2669.2C2344,-2652.83 2344,-2628.24 2344,-2607.81"/>
<polygon fill="black" stroke="black" points="2347.5,-2607.58 2344,-2597.58 2340.5,-2607.58 2347.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_res1 -->
<g id="node450" class="node">
<title>LLaMA_7B_S2_R2_L18_res1</title>
<polygon fill="lightyellow" stroke="black" points="2431.84,-2471.56 2292.11,-2471.56 2256.16,-2435.56 2395.89,-2435.56 2431.84,-2471.56"/>
<text text-anchor="middle" x="2344" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_ar1&#45;&gt;LLaMA_7B_S2_R2_L18_res1 -->
<g id="edge412" class="edge">
<title>LLaMA_7B_S2_R2_L18_ar1&#45;&gt;LLaMA_7B_S2_R2_L18_res1</title>
<path fill="none" stroke="black" d="M2344,-2543.37C2344,-2525 2344,-2500.45 2344,-2481.82"/>
<polygon fill="black" stroke="black" points="2347.5,-2481.62 2344,-2471.62 2340.5,-2481.62 2347.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_norm2 -->
<g id="node451" class="node">
<title>LLaMA_7B_S2_R2_L18_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="2344" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="2344" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_res1&#45;&gt;LLaMA_7B_S2_R2_L18_norm2 -->
<g id="edge413" class="edge">
<title>LLaMA_7B_S2_R2_L18_res1&#45;&gt;LLaMA_7B_S2_R2_L18_norm2</title>
<path fill="none" stroke="black" d="M2344,-2435.12C2344,-2418.97 2344,-2394.47 2344,-2374.07"/>
<polygon fill="black" stroke="black" points="2347.5,-2373.85 2344,-2363.85 2340.5,-2373.85 2347.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_up -->
<g id="node452" class="node">
<title>LLaMA_7B_S2_R2_L18_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-2237.82 2237.5,-2237.82 2237.5,-2199.82 2450.5,-2199.82 2450.5,-2237.82"/>
<text text-anchor="middle" x="2344" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2344" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_norm2&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_up -->
<g id="edge414" class="edge">
<title>LLaMA_7B_S2_R2_L18_norm2&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_up</title>
<path fill="none" stroke="black" d="M2344,-2309.69C2344,-2291.42 2344,-2266.99 2344,-2248.22"/>
<polygon fill="black" stroke="black" points="2347.5,-2248.17 2344,-2238.17 2340.5,-2248.17 2347.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_gate -->
<g id="node453" class="node">
<title>LLaMA_7B_S2_R2_L18_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-2127.82 2237.5,-2127.82 2237.5,-2089.82 2450.5,-2089.82 2450.5,-2127.82"/>
<text text-anchor="middle" x="2344" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2344" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_gate -->
<g id="edge415" class="edge">
<title>LLaMA_7B_S2_R2_L18_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_gate</title>
<path fill="none" stroke="black" d="M2344,-2199.5C2344,-2182.64 2344,-2157.39 2344,-2137.97"/>
<polygon fill="black" stroke="black" points="2347.5,-2137.87 2344,-2127.87 2340.5,-2137.87 2347.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_down -->
<g id="node454" class="node">
<title>LLaMA_7B_S2_R2_L18_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-2017.82 2237.5,-2017.82 2237.5,-1979.82 2450.5,-1979.82 2450.5,-2017.82"/>
<text text-anchor="middle" x="2344" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2344" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_down -->
<g id="edge416" class="edge">
<title>LLaMA_7B_S2_R2_L18_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L18_ffn_down</title>
<path fill="none" stroke="black" d="M2344,-2089.5C2344,-2072.64 2344,-2047.39 2344,-2027.97"/>
<polygon fill="black" stroke="black" points="2347.5,-2027.87 2344,-2017.87 2340.5,-2027.87 2347.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_ar2 -->
<g id="node455" class="node">
<title>LLaMA_7B_S2_R2_L18_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2344" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="2344" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L18_ar2 -->
<g id="edge417" class="edge">
<title>LLaMA_7B_S2_R2_L18_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L18_ar2</title>
<path fill="none" stroke="black" d="M2344,-1979.72C2344,-1963.35 2344,-1938.76 2344,-1918.33"/>
<polygon fill="black" stroke="black" points="2347.5,-1918.1 2344,-1908.1 2340.5,-1918.1 2347.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L18_res2 -->
<g id="node456" class="node">
<title>LLaMA_7B_S2_R2_L18_res2</title>
<polygon fill="lightyellow" stroke="black" points="2431.84,-1782.08 2292.11,-1782.08 2256.16,-1746.08 2395.89,-1746.08 2431.84,-1782.08"/>
<text text-anchor="middle" x="2344" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L18_ar2&#45;&gt;LLaMA_7B_S2_R2_L18_res2 -->
<g id="edge418" class="edge">
<title>LLaMA_7B_S2_R2_L18_ar2&#45;&gt;LLaMA_7B_S2_R2_L18_res2</title>
<path fill="none" stroke="black" d="M2344,-1853.89C2344,-1835.51 2344,-1810.97 2344,-1792.34"/>
<polygon fill="black" stroke="black" points="2347.5,-1792.14 2344,-1782.14 2340.5,-1792.14 2347.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_split -->
<g id="node457" class="node">
<title>LLaMA_7B_S2_R2_L19_split</title>
<polygon fill="orange" stroke="black" points="1912.53,-3091.04 1261.06,-3091.04 1093.47,-3015.04 1744.94,-3015.04 1912.53,-3091.04"/>
<text text-anchor="middle" x="1503" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="1503" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_norm1 -->
<g id="node458" class="node">
<title>LLaMA_7B_S2_R2_L19_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="1503" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1503" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_split&#45;&gt;LLaMA_7B_S2_R2_L19_norm1 -->
<g id="edge419" class="edge">
<title>LLaMA_7B_S2_R2_L19_split&#45;&gt;LLaMA_7B_S2_R2_L19_norm1</title>
<path fill="none" stroke="black" d="M1503,-3014.83C1503,-2995.62 1503,-2972.29 1503,-2953.24"/>
<polygon fill="black" stroke="black" points="1506.5,-2953.16 1503,-2943.16 1499.5,-2953.16 1506.5,-2953.16"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_qkv -->
<g id="node459" class="node">
<title>LLaMA_7B_S2_R2_L19_qkv</title>
<polygon fill="lightcoral" stroke="black" points="1649.5,-2817.3 1356.5,-2817.3 1356.5,-2779.3 1649.5,-2779.3 1649.5,-2817.3"/>
<text text-anchor="middle" x="1503" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1503" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_norm1&#45;&gt;LLaMA_7B_S2_R2_L19_qkv -->
<g id="edge420" class="edge">
<title>LLaMA_7B_S2_R2_L19_norm1&#45;&gt;LLaMA_7B_S2_R2_L19_qkv</title>
<path fill="none" stroke="black" d="M1503,-2889.17C1503,-2870.9 1503,-2846.47 1503,-2827.7"/>
<polygon fill="black" stroke="black" points="1506.5,-2827.65 1503,-2817.65 1499.5,-2827.65 1506.5,-2827.65"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_attn -->
<g id="node460" class="node">
<title>LLaMA_7B_S2_R2_L19_attn</title>
<polygon fill="lightcoral" stroke="black" points="1649.5,-2707.3 1356.5,-2707.3 1356.5,-2669.3 1649.5,-2669.3 1649.5,-2707.3"/>
<text text-anchor="middle" x="1503" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1503" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_qkv&#45;&gt;LLaMA_7B_S2_R2_L19_attn -->
<g id="edge421" class="edge">
<title>LLaMA_7B_S2_R2_L19_qkv&#45;&gt;LLaMA_7B_S2_R2_L19_attn</title>
<path fill="none" stroke="black" d="M1503,-2778.98C1503,-2762.12 1503,-2736.87 1503,-2717.45"/>
<polygon fill="black" stroke="black" points="1506.5,-2717.35 1503,-2707.35 1499.5,-2717.35 1506.5,-2717.35"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_ar1 -->
<g id="node461" class="node">
<title>LLaMA_7B_S2_R2_L19_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1503" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1503" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_attn&#45;&gt;LLaMA_7B_S2_R2_L19_ar1 -->
<g id="edge422" class="edge">
<title>LLaMA_7B_S2_R2_L19_attn&#45;&gt;LLaMA_7B_S2_R2_L19_ar1</title>
<path fill="none" stroke="black" d="M1503,-2669.2C1503,-2652.83 1503,-2628.24 1503,-2607.81"/>
<polygon fill="black" stroke="black" points="1506.5,-2607.58 1503,-2597.58 1499.5,-2607.58 1506.5,-2607.58"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_res1 -->
<g id="node462" class="node">
<title>LLaMA_7B_S2_R2_L19_res1</title>
<polygon fill="lightyellow" stroke="black" points="1590.84,-2471.56 1451.11,-2471.56 1415.16,-2435.56 1554.89,-2435.56 1590.84,-2471.56"/>
<text text-anchor="middle" x="1503" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_ar1&#45;&gt;LLaMA_7B_S2_R2_L19_res1 -->
<g id="edge423" class="edge">
<title>LLaMA_7B_S2_R2_L19_ar1&#45;&gt;LLaMA_7B_S2_R2_L19_res1</title>
<path fill="none" stroke="black" d="M1503,-2543.37C1503,-2525 1503,-2500.45 1503,-2481.82"/>
<polygon fill="black" stroke="black" points="1506.5,-2481.62 1503,-2471.62 1499.5,-2481.62 1506.5,-2481.62"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_norm2 -->
<g id="node463" class="node">
<title>LLaMA_7B_S2_R2_L19_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="1503" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1503" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_res1&#45;&gt;LLaMA_7B_S2_R2_L19_norm2 -->
<g id="edge424" class="edge">
<title>LLaMA_7B_S2_R2_L19_res1&#45;&gt;LLaMA_7B_S2_R2_L19_norm2</title>
<path fill="none" stroke="black" d="M1503,-2435.12C1503,-2418.97 1503,-2394.47 1503,-2374.07"/>
<polygon fill="black" stroke="black" points="1506.5,-2373.85 1503,-2363.85 1499.5,-2373.85 1506.5,-2373.85"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_up -->
<g id="node464" class="node">
<title>LLaMA_7B_S2_R2_L19_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-2237.82 1396.5,-2237.82 1396.5,-2199.82 1609.5,-2199.82 1609.5,-2237.82"/>
<text text-anchor="middle" x="1503" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1503" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_norm2&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_up -->
<g id="edge425" class="edge">
<title>LLaMA_7B_S2_R2_L19_norm2&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_up</title>
<path fill="none" stroke="black" d="M1503,-2309.69C1503,-2291.42 1503,-2266.99 1503,-2248.22"/>
<polygon fill="black" stroke="black" points="1506.5,-2248.17 1503,-2238.17 1499.5,-2248.17 1506.5,-2248.17"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_gate -->
<g id="node465" class="node">
<title>LLaMA_7B_S2_R2_L19_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-2127.82 1396.5,-2127.82 1396.5,-2089.82 1609.5,-2089.82 1609.5,-2127.82"/>
<text text-anchor="middle" x="1503" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1503" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_gate -->
<g id="edge426" class="edge">
<title>LLaMA_7B_S2_R2_L19_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_gate</title>
<path fill="none" stroke="black" d="M1503,-2199.5C1503,-2182.64 1503,-2157.39 1503,-2137.97"/>
<polygon fill="black" stroke="black" points="1506.5,-2137.87 1503,-2127.87 1499.5,-2137.87 1506.5,-2137.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_down -->
<g id="node466" class="node">
<title>LLaMA_7B_S2_R2_L19_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-2017.82 1396.5,-2017.82 1396.5,-1979.82 1609.5,-1979.82 1609.5,-2017.82"/>
<text text-anchor="middle" x="1503" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1503" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_down -->
<g id="edge427" class="edge">
<title>LLaMA_7B_S2_R2_L19_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L19_ffn_down</title>
<path fill="none" stroke="black" d="M1503,-2089.5C1503,-2072.64 1503,-2047.39 1503,-2027.97"/>
<polygon fill="black" stroke="black" points="1506.5,-2027.87 1503,-2017.87 1499.5,-2027.87 1506.5,-2027.87"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_ar2 -->
<g id="node467" class="node">
<title>LLaMA_7B_S2_R2_L19_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1503" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="1503" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L19_ar2 -->
<g id="edge428" class="edge">
<title>LLaMA_7B_S2_R2_L19_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L19_ar2</title>
<path fill="none" stroke="black" d="M1503,-1979.72C1503,-1963.35 1503,-1938.76 1503,-1918.33"/>
<polygon fill="black" stroke="black" points="1506.5,-1918.1 1503,-1908.1 1499.5,-1918.1 1506.5,-1918.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L19_res2 -->
<g id="node468" class="node">
<title>LLaMA_7B_S2_R2_L19_res2</title>
<polygon fill="lightyellow" stroke="black" points="1590.84,-1782.08 1451.11,-1782.08 1415.16,-1746.08 1554.89,-1746.08 1590.84,-1782.08"/>
<text text-anchor="middle" x="1503" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L19_ar2&#45;&gt;LLaMA_7B_S2_R2_L19_res2 -->
<g id="edge429" class="edge">
<title>LLaMA_7B_S2_R2_L19_ar2&#45;&gt;LLaMA_7B_S2_R2_L19_res2</title>
<path fill="none" stroke="black" d="M1503,-1853.89C1503,-1835.51 1503,-1810.97 1503,-1792.34"/>
<polygon fill="black" stroke="black" points="1506.5,-1792.14 1503,-1782.14 1499.5,-1792.14 1506.5,-1792.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_split -->
<g id="node469" class="node">
<title>LLaMA_7B_S2_R2_L20_split</title>
<polygon fill="orange" stroke="black" points="1071.53,-3091.04 420.06,-3091.04 252.47,-3015.04 903.94,-3015.04 1071.53,-3091.04"/>
<text text-anchor="middle" x="662" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="662" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_norm1 -->
<g id="node470" class="node">
<title>LLaMA_7B_S2_R2_L20_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="728" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="728" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="728" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_split&#45;&gt;LLaMA_7B_S2_R2_L20_norm1 -->
<g id="edge430" class="edge">
<title>LLaMA_7B_S2_R2_L20_split&#45;&gt;LLaMA_7B_S2_R2_L20_norm1</title>
<path fill="none" stroke="black" d="M680.21,-3014.83C689.78,-2995.27 701.45,-2971.42 710.86,-2952.19"/>
<polygon fill="black" stroke="black" points="714.03,-2953.68 715.28,-2943.16 707.74,-2950.6 714.03,-2953.68"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_qkv -->
<g id="node471" class="node">
<title>LLaMA_7B_S2_R2_L20_qkv</title>
<polygon fill="lightcoral" stroke="black" points="940.5,-2817.3 647.5,-2817.3 647.5,-2779.3 940.5,-2779.3 940.5,-2817.3"/>
<text text-anchor="middle" x="794" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="794" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_norm1&#45;&gt;LLaMA_7B_S2_R2_L20_qkv -->
<g id="edge431" class="edge">
<title>LLaMA_7B_S2_R2_L20_norm1&#45;&gt;LLaMA_7B_S2_R2_L20_qkv</title>
<path fill="none" stroke="black" d="M742.65,-2889.46C753.35,-2870.66 767.83,-2845.24 778.69,-2826.18"/>
<polygon fill="black" stroke="black" points="781.79,-2827.81 783.7,-2817.39 775.71,-2824.35 781.79,-2827.81"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_attn -->
<g id="node472" class="node">
<title>LLaMA_7B_S2_R2_L20_attn</title>
<polygon fill="lightcoral" stroke="black" points="1071.5,-2707.3 778.5,-2707.3 778.5,-2669.3 1071.5,-2669.3 1071.5,-2707.3"/>
<text text-anchor="middle" x="925" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="925" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_qkv&#45;&gt;LLaMA_7B_S2_R2_L20_attn -->
<g id="edge432" class="edge">
<title>LLaMA_7B_S2_R2_L20_qkv&#45;&gt;LLaMA_7B_S2_R2_L20_attn</title>
<path fill="none" stroke="black" d="M815.93,-2779.23C837.65,-2761.31 871.08,-2733.75 895.21,-2713.86"/>
<polygon fill="black" stroke="black" points="897.51,-2716.5 903,-2707.44 893.06,-2711.1 897.51,-2716.5"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_ar1 -->
<g id="node473" class="node">
<title>LLaMA_7B_S2_R2_L20_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="930" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="930" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="930" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_attn&#45;&gt;LLaMA_7B_S2_R2_L20_ar1 -->
<g id="edge433" class="edge">
<title>LLaMA_7B_S2_R2_L20_attn&#45;&gt;LLaMA_7B_S2_R2_L20_ar1</title>
<path fill="none" stroke="black" d="M925.78,-2669.2C926.49,-2652.83 927.55,-2628.24 928.43,-2607.81"/>
<polygon fill="black" stroke="black" points="931.94,-2607.72 928.87,-2597.58 924.94,-2607.42 931.94,-2607.72"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_res1 -->
<g id="node474" class="node">
<title>LLaMA_7B_S2_R2_L20_res1</title>
<polygon fill="lightyellow" stroke="black" points="1188.84,-2471.56 1049.11,-2471.56 1013.16,-2435.56 1152.89,-2435.56 1188.84,-2471.56"/>
<text text-anchor="middle" x="1101" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_ar1&#45;&gt;LLaMA_7B_S2_R2_L20_res1 -->
<g id="edge434" class="edge">
<title>LLaMA_7B_S2_R2_L20_ar1&#45;&gt;LLaMA_7B_S2_R2_L20_res1</title>
<path fill="none" stroke="black" d="M965.43,-2545.63C995.35,-2525.53 1037.89,-2496.96 1067.31,-2477.2"/>
<polygon fill="black" stroke="black" points="1069.26,-2480.1 1075.61,-2471.62 1065.35,-2474.29 1069.26,-2480.1"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_norm2 -->
<g id="node475" class="node">
<title>LLaMA_7B_S2_R2_L20_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="1112" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1112" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1112" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_res1&#45;&gt;LLaMA_7B_S2_R2_L20_norm2 -->
<g id="edge435" class="edge">
<title>LLaMA_7B_S2_R2_L20_res1&#45;&gt;LLaMA_7B_S2_R2_L20_norm2</title>
<path fill="none" stroke="black" d="M1102.67,-2435.12C1104.22,-2418.97 1106.56,-2394.47 1108.52,-2374.07"/>
<polygon fill="black" stroke="black" points="1112.03,-2374.14 1109.5,-2363.85 1105.06,-2373.47 1112.03,-2374.14"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_up -->
<g id="node476" class="node">
<title>LLaMA_7B_S2_R2_L20_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="1224.5,-2237.82 1011.5,-2237.82 1011.5,-2199.82 1224.5,-2199.82 1224.5,-2237.82"/>
<text text-anchor="middle" x="1118" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1118" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_norm2&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_up -->
<g id="edge436" class="edge">
<title>LLaMA_7B_S2_R2_L20_norm2&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_up</title>
<path fill="none" stroke="black" d="M1113.35,-2309.69C1114.29,-2291.42 1115.56,-2266.99 1116.53,-2248.22"/>
<polygon fill="black" stroke="black" points="1120.03,-2248.34 1117.05,-2238.17 1113.04,-2247.98 1120.03,-2248.34"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_gate -->
<g id="node477" class="node">
<title>LLaMA_7B_S2_R2_L20_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="1310.5,-2127.82 1097.5,-2127.82 1097.5,-2089.82 1310.5,-2089.82 1310.5,-2127.82"/>
<text text-anchor="middle" x="1204" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1204" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_gate -->
<g id="edge437" class="edge">
<title>LLaMA_7B_S2_R2_L20_ffn_up&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_gate</title>
<path fill="none" stroke="black" d="M1132.59,-2199.5C1146.51,-2182.02 1167.62,-2155.5 1183.28,-2135.84"/>
<polygon fill="black" stroke="black" points="1186.14,-2137.88 1189.63,-2127.87 1180.66,-2133.51 1186.14,-2137.88"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_down -->
<g id="node478" class="node">
<title>LLaMA_7B_S2_R2_L20_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="1331.5,-2017.82 1118.5,-2017.82 1118.5,-1979.82 1331.5,-1979.82 1331.5,-2017.82"/>
<text text-anchor="middle" x="1225" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1225" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_down -->
<g id="edge438" class="edge">
<title>LLaMA_7B_S2_R2_L20_ffn_gate&#45;&gt;LLaMA_7B_S2_R2_L20_ffn_down</title>
<path fill="none" stroke="black" d="M1207.56,-2089.5C1210.86,-2072.56 1215.8,-2047.15 1219.58,-2027.7"/>
<polygon fill="black" stroke="black" points="1223.02,-2028.36 1221.49,-2017.87 1216.15,-2027.02 1223.02,-2028.36"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_ar2 -->
<g id="node479" class="node">
<title>LLaMA_7B_S2_R2_L20_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1246" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1246" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="1246" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L20_ar2 -->
<g id="edge439" class="edge">
<title>LLaMA_7B_S2_R2_L20_ffn_down&#45;&gt;LLaMA_7B_S2_R2_L20_ar2</title>
<path fill="none" stroke="black" d="M1228.28,-1979.72C1231.26,-1963.27 1235.75,-1938.53 1239.46,-1918.05"/>
<polygon fill="black" stroke="black" points="1242.92,-1918.56 1241.26,-1908.1 1236.03,-1917.32 1242.92,-1918.56"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_res2 -->
<g id="node480" class="node">
<title>LLaMA_7B_S2_R2_L20_res2</title>
<polygon fill="lightyellow" stroke="black" points="1353.84,-1782.08 1214.11,-1782.08 1178.16,-1746.08 1317.89,-1746.08 1353.84,-1782.08"/>
<text text-anchor="middle" x="1266" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S2_R2_L20_ar2&#45;&gt;LLaMA_7B_S2_R2_L20_res2 -->
<g id="edge440" class="edge">
<title>LLaMA_7B_S2_R2_L20_ar2&#45;&gt;LLaMA_7B_S2_R2_L20_res2</title>
<path fill="none" stroke="black" d="M1250.54,-1853.89C1253.75,-1835.43 1258.05,-1810.74 1261.3,-1792.08"/>
<polygon fill="black" stroke="black" points="1264.76,-1792.6 1263.03,-1782.14 1257.87,-1791.39 1264.76,-1792.6"/>
</g>
<!-- LLaMA_7B_S2_R2_L20_res2&#45;&gt;LLaMA_7B_comm_2_3 -->
<g id="edge667" class="edge">
<title>LLaMA_7B_S2_R2_L20_res2&#45;&gt;LLaMA_7B_comm_2_3</title>
<path fill="none" stroke="black" d="M1319.56,-1747.35C1344.92,-1740.66 1375.77,-1733.6 1404,-1730.08 2101.31,-1643.25 7196.3,-1637.75 8286.89,-1637.57"/>
<polygon fill="black" stroke="black" points="8287.18,-1641.07 8297.18,-1637.57 8287.18,-1634.07 8287.18,-1641.07"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_split -->
<g id="node481" class="node">
<title>LLaMA_7B_S3_R1_L21_split</title>
<polygon fill="orange" stroke="black" points="17053.53,-1499.13 16402.06,-1499.13 16234.47,-1423.13 16885.94,-1423.13 17053.53,-1499.13"/>
<text text-anchor="middle" x="16644" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="16644" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_norm1 -->
<g id="node482" class="node">
<title>LLaMA_7B_S3_R1_L21_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="16644" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16644" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_split&#45;&gt;LLaMA_7B_S3_R1_L21_norm1 -->
<g id="edge441" class="edge">
<title>LLaMA_7B_S3_R1_L21_split&#45;&gt;LLaMA_7B_S3_R1_L21_norm1</title>
<path fill="none" stroke="black" d="M16644,-1422.92C16644,-1403.71 16644,-1380.37 16644,-1361.33"/>
<polygon fill="black" stroke="black" points="16647.5,-1361.25 16644,-1351.25 16640.5,-1361.25 16647.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_qkv -->
<g id="node483" class="node">
<title>LLaMA_7B_S3_R1_L21_qkv</title>
<polygon fill="lightcoral" stroke="black" points="16790.5,-1225.39 16497.5,-1225.39 16497.5,-1187.39 16790.5,-1187.39 16790.5,-1225.39"/>
<text text-anchor="middle" x="16644" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="16644" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_norm1&#45;&gt;LLaMA_7B_S3_R1_L21_qkv -->
<g id="edge442" class="edge">
<title>LLaMA_7B_S3_R1_L21_norm1&#45;&gt;LLaMA_7B_S3_R1_L21_qkv</title>
<path fill="none" stroke="black" d="M16644,-1297.25C16644,-1278.99 16644,-1254.56 16644,-1235.78"/>
<polygon fill="black" stroke="black" points="16647.5,-1235.74 16644,-1225.74 16640.5,-1235.74 16647.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_attn -->
<g id="node484" class="node">
<title>LLaMA_7B_S3_R1_L21_attn</title>
<polygon fill="lightcoral" stroke="black" points="16790.5,-1115.39 16497.5,-1115.39 16497.5,-1077.39 16790.5,-1077.39 16790.5,-1115.39"/>
<text text-anchor="middle" x="16644" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="16644" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_qkv&#45;&gt;LLaMA_7B_S3_R1_L21_attn -->
<g id="edge443" class="edge">
<title>LLaMA_7B_S3_R1_L21_qkv&#45;&gt;LLaMA_7B_S3_R1_L21_attn</title>
<path fill="none" stroke="black" d="M16644,-1187.07C16644,-1170.21 16644,-1144.95 16644,-1125.54"/>
<polygon fill="black" stroke="black" points="16647.5,-1125.44 16644,-1115.44 16640.5,-1125.44 16647.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_ar1 -->
<g id="node485" class="node">
<title>LLaMA_7B_S3_R1_L21_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16644" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16644" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_attn&#45;&gt;LLaMA_7B_S3_R1_L21_ar1 -->
<g id="edge444" class="edge">
<title>LLaMA_7B_S3_R1_L21_attn&#45;&gt;LLaMA_7B_S3_R1_L21_ar1</title>
<path fill="none" stroke="black" d="M16644,-1077.28C16644,-1060.91 16644,-1036.32 16644,-1015.9"/>
<polygon fill="black" stroke="black" points="16647.5,-1015.67 16644,-1005.67 16640.5,-1015.67 16647.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_res1 -->
<g id="node486" class="node">
<title>LLaMA_7B_S3_R1_L21_res1</title>
<polygon fill="lightyellow" stroke="black" points="16731.84,-879.65 16592.11,-879.65 16556.16,-843.65 16695.89,-843.65 16731.84,-879.65"/>
<text text-anchor="middle" x="16644" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_ar1&#45;&gt;LLaMA_7B_S3_R1_L21_res1 -->
<g id="edge445" class="edge">
<title>LLaMA_7B_S3_R1_L21_ar1&#45;&gt;LLaMA_7B_S3_R1_L21_res1</title>
<path fill="none" stroke="black" d="M16644,-951.45C16644,-933.08 16644,-908.53 16644,-889.9"/>
<polygon fill="black" stroke="black" points="16647.5,-889.71 16644,-879.71 16640.5,-889.71 16647.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_norm2 -->
<g id="node487" class="node">
<title>LLaMA_7B_S3_R1_L21_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="16644" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="16644" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_res1&#45;&gt;LLaMA_7B_S3_R1_L21_norm2 -->
<g id="edge446" class="edge">
<title>LLaMA_7B_S3_R1_L21_res1&#45;&gt;LLaMA_7B_S3_R1_L21_norm2</title>
<path fill="none" stroke="black" d="M16644,-843.2C16644,-827.06 16644,-802.56 16644,-782.16"/>
<polygon fill="black" stroke="black" points="16647.5,-781.94 16644,-771.94 16640.5,-781.94 16647.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_up -->
<g id="node488" class="node">
<title>LLaMA_7B_S3_R1_L21_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-645.91 16537.5,-645.91 16537.5,-607.91 16750.5,-607.91 16750.5,-645.91"/>
<text text-anchor="middle" x="16644" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="16644" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_norm2&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_up -->
<g id="edge447" class="edge">
<title>LLaMA_7B_S3_R1_L21_norm2&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_up</title>
<path fill="none" stroke="black" d="M16644,-717.77C16644,-699.51 16644,-675.08 16644,-656.3"/>
<polygon fill="black" stroke="black" points="16647.5,-656.26 16644,-646.26 16640.5,-656.26 16647.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_gate -->
<g id="node489" class="node">
<title>LLaMA_7B_S3_R1_L21_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-535.91 16537.5,-535.91 16537.5,-497.91 16750.5,-497.91 16750.5,-535.91"/>
<text text-anchor="middle" x="16644" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="16644" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_gate -->
<g id="edge448" class="edge">
<title>LLaMA_7B_S3_R1_L21_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_gate</title>
<path fill="none" stroke="black" d="M16644,-607.59C16644,-590.73 16644,-565.47 16644,-546.06"/>
<polygon fill="black" stroke="black" points="16647.5,-545.96 16644,-535.96 16640.5,-545.96 16647.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_down -->
<g id="node490" class="node">
<title>LLaMA_7B_S3_R1_L21_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="16750.5,-425.91 16537.5,-425.91 16537.5,-387.91 16750.5,-387.91 16750.5,-425.91"/>
<text text-anchor="middle" x="16644" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16644" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_down -->
<g id="edge449" class="edge">
<title>LLaMA_7B_S3_R1_L21_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L21_ffn_down</title>
<path fill="none" stroke="black" d="M16644,-497.59C16644,-480.73 16644,-455.47 16644,-436.06"/>
<polygon fill="black" stroke="black" points="16647.5,-435.96 16644,-425.96 16640.5,-435.96 16647.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_ar2 -->
<g id="node491" class="node">
<title>LLaMA_7B_S3_R1_L21_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="16644" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16644" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="16644" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L21_ar2 -->
<g id="edge450" class="edge">
<title>LLaMA_7B_S3_R1_L21_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L21_ar2</title>
<path fill="none" stroke="black" d="M16644,-387.8C16644,-371.43 16644,-346.84 16644,-326.42"/>
<polygon fill="black" stroke="black" points="16647.5,-326.19 16644,-316.19 16640.5,-326.19 16647.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L21_res2 -->
<g id="node492" class="node">
<title>LLaMA_7B_S3_R1_L21_res2</title>
<polygon fill="lightyellow" stroke="black" points="16731.84,-190.17 16592.11,-190.17 16556.16,-154.17 16695.89,-154.17 16731.84,-190.17"/>
<text text-anchor="middle" x="16644" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L21_ar2&#45;&gt;LLaMA_7B_S3_R1_L21_res2 -->
<g id="edge451" class="edge">
<title>LLaMA_7B_S3_R1_L21_ar2&#45;&gt;LLaMA_7B_S3_R1_L21_res2</title>
<path fill="none" stroke="black" d="M16644,-261.97C16644,-243.6 16644,-219.05 16644,-200.42"/>
<polygon fill="black" stroke="black" points="16647.5,-200.23 16644,-190.23 16640.5,-200.23 16647.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_split -->
<g id="node493" class="node">
<title>LLaMA_7B_S3_R1_L22_split</title>
<polygon fill="orange" stroke="black" points="16212.53,-1499.13 15561.06,-1499.13 15393.47,-1423.13 16044.94,-1423.13 16212.53,-1499.13"/>
<text text-anchor="middle" x="15803" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="15803" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_norm1 -->
<g id="node494" class="node">
<title>LLaMA_7B_S3_R1_L22_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="15803" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15803" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_split&#45;&gt;LLaMA_7B_S3_R1_L22_norm1 -->
<g id="edge452" class="edge">
<title>LLaMA_7B_S3_R1_L22_split&#45;&gt;LLaMA_7B_S3_R1_L22_norm1</title>
<path fill="none" stroke="black" d="M15803,-1422.92C15803,-1403.71 15803,-1380.37 15803,-1361.33"/>
<polygon fill="black" stroke="black" points="15806.5,-1361.25 15803,-1351.25 15799.5,-1361.25 15806.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_qkv -->
<g id="node495" class="node">
<title>LLaMA_7B_S3_R1_L22_qkv</title>
<polygon fill="lightcoral" stroke="black" points="15949.5,-1225.39 15656.5,-1225.39 15656.5,-1187.39 15949.5,-1187.39 15949.5,-1225.39"/>
<text text-anchor="middle" x="15803" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="15803" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_norm1&#45;&gt;LLaMA_7B_S3_R1_L22_qkv -->
<g id="edge453" class="edge">
<title>LLaMA_7B_S3_R1_L22_norm1&#45;&gt;LLaMA_7B_S3_R1_L22_qkv</title>
<path fill="none" stroke="black" d="M15803,-1297.25C15803,-1278.99 15803,-1254.56 15803,-1235.78"/>
<polygon fill="black" stroke="black" points="15806.5,-1235.74 15803,-1225.74 15799.5,-1235.74 15806.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_attn -->
<g id="node496" class="node">
<title>LLaMA_7B_S3_R1_L22_attn</title>
<polygon fill="lightcoral" stroke="black" points="15949.5,-1115.39 15656.5,-1115.39 15656.5,-1077.39 15949.5,-1077.39 15949.5,-1115.39"/>
<text text-anchor="middle" x="15803" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="15803" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_qkv&#45;&gt;LLaMA_7B_S3_R1_L22_attn -->
<g id="edge454" class="edge">
<title>LLaMA_7B_S3_R1_L22_qkv&#45;&gt;LLaMA_7B_S3_R1_L22_attn</title>
<path fill="none" stroke="black" d="M15803,-1187.07C15803,-1170.21 15803,-1144.95 15803,-1125.54"/>
<polygon fill="black" stroke="black" points="15806.5,-1125.44 15803,-1115.44 15799.5,-1125.44 15806.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_ar1 -->
<g id="node497" class="node">
<title>LLaMA_7B_S3_R1_L22_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15803" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="15803" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_attn&#45;&gt;LLaMA_7B_S3_R1_L22_ar1 -->
<g id="edge455" class="edge">
<title>LLaMA_7B_S3_R1_L22_attn&#45;&gt;LLaMA_7B_S3_R1_L22_ar1</title>
<path fill="none" stroke="black" d="M15803,-1077.28C15803,-1060.91 15803,-1036.32 15803,-1015.9"/>
<polygon fill="black" stroke="black" points="15806.5,-1015.67 15803,-1005.67 15799.5,-1015.67 15806.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_res1 -->
<g id="node498" class="node">
<title>LLaMA_7B_S3_R1_L22_res1</title>
<polygon fill="lightyellow" stroke="black" points="15890.84,-879.65 15751.11,-879.65 15715.16,-843.65 15854.89,-843.65 15890.84,-879.65"/>
<text text-anchor="middle" x="15803" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_ar1&#45;&gt;LLaMA_7B_S3_R1_L22_res1 -->
<g id="edge456" class="edge">
<title>LLaMA_7B_S3_R1_L22_ar1&#45;&gt;LLaMA_7B_S3_R1_L22_res1</title>
<path fill="none" stroke="black" d="M15803,-951.45C15803,-933.08 15803,-908.53 15803,-889.9"/>
<polygon fill="black" stroke="black" points="15806.5,-889.71 15803,-879.71 15799.5,-889.71 15806.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_norm2 -->
<g id="node499" class="node">
<title>LLaMA_7B_S3_R1_L22_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="15803" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="15803" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_res1&#45;&gt;LLaMA_7B_S3_R1_L22_norm2 -->
<g id="edge457" class="edge">
<title>LLaMA_7B_S3_R1_L22_res1&#45;&gt;LLaMA_7B_S3_R1_L22_norm2</title>
<path fill="none" stroke="black" d="M15803,-843.2C15803,-827.06 15803,-802.56 15803,-782.16"/>
<polygon fill="black" stroke="black" points="15806.5,-781.94 15803,-771.94 15799.5,-781.94 15806.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_up -->
<g id="node500" class="node">
<title>LLaMA_7B_S3_R1_L22_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-645.91 15696.5,-645.91 15696.5,-607.91 15909.5,-607.91 15909.5,-645.91"/>
<text text-anchor="middle" x="15803" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="15803" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_norm2&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_up -->
<g id="edge458" class="edge">
<title>LLaMA_7B_S3_R1_L22_norm2&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_up</title>
<path fill="none" stroke="black" d="M15803,-717.77C15803,-699.51 15803,-675.08 15803,-656.3"/>
<polygon fill="black" stroke="black" points="15806.5,-656.26 15803,-646.26 15799.5,-656.26 15806.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_gate -->
<g id="node501" class="node">
<title>LLaMA_7B_S3_R1_L22_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-535.91 15696.5,-535.91 15696.5,-497.91 15909.5,-497.91 15909.5,-535.91"/>
<text text-anchor="middle" x="15803" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15803" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_gate -->
<g id="edge459" class="edge">
<title>LLaMA_7B_S3_R1_L22_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_gate</title>
<path fill="none" stroke="black" d="M15803,-607.59C15803,-590.73 15803,-565.47 15803,-546.06"/>
<polygon fill="black" stroke="black" points="15806.5,-545.96 15803,-535.96 15799.5,-545.96 15806.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_down -->
<g id="node502" class="node">
<title>LLaMA_7B_S3_R1_L22_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="15909.5,-425.91 15696.5,-425.91 15696.5,-387.91 15909.5,-387.91 15909.5,-425.91"/>
<text text-anchor="middle" x="15803" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="15803" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_down -->
<g id="edge460" class="edge">
<title>LLaMA_7B_S3_R1_L22_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L22_ffn_down</title>
<path fill="none" stroke="black" d="M15803,-497.59C15803,-480.73 15803,-455.47 15803,-436.06"/>
<polygon fill="black" stroke="black" points="15806.5,-435.96 15803,-425.96 15799.5,-435.96 15806.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_ar2 -->
<g id="node503" class="node">
<title>LLaMA_7B_S3_R1_L22_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="15803" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15803" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="15803" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L22_ar2 -->
<g id="edge461" class="edge">
<title>LLaMA_7B_S3_R1_L22_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L22_ar2</title>
<path fill="none" stroke="black" d="M15803,-387.8C15803,-371.43 15803,-346.84 15803,-326.42"/>
<polygon fill="black" stroke="black" points="15806.5,-326.19 15803,-316.19 15799.5,-326.19 15806.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L22_res2 -->
<g id="node504" class="node">
<title>LLaMA_7B_S3_R1_L22_res2</title>
<polygon fill="lightyellow" stroke="black" points="15890.84,-190.17 15751.11,-190.17 15715.16,-154.17 15854.89,-154.17 15890.84,-190.17"/>
<text text-anchor="middle" x="15803" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L22_ar2&#45;&gt;LLaMA_7B_S3_R1_L22_res2 -->
<g id="edge462" class="edge">
<title>LLaMA_7B_S3_R1_L22_ar2&#45;&gt;LLaMA_7B_S3_R1_L22_res2</title>
<path fill="none" stroke="black" d="M15803,-261.97C15803,-243.6 15803,-219.05 15803,-200.42"/>
<polygon fill="black" stroke="black" points="15806.5,-200.23 15803,-190.23 15799.5,-200.23 15806.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_split -->
<g id="node505" class="node">
<title>LLaMA_7B_S3_R1_L23_split</title>
<polygon fill="orange" stroke="black" points="15371.53,-1499.13 14720.06,-1499.13 14552.47,-1423.13 15203.94,-1423.13 15371.53,-1499.13"/>
<text text-anchor="middle" x="14962" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="14962" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_norm1 -->
<g id="node506" class="node">
<title>LLaMA_7B_S3_R1_L23_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="14962" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14962" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_split&#45;&gt;LLaMA_7B_S3_R1_L23_norm1 -->
<g id="edge463" class="edge">
<title>LLaMA_7B_S3_R1_L23_split&#45;&gt;LLaMA_7B_S3_R1_L23_norm1</title>
<path fill="none" stroke="black" d="M14962,-1422.92C14962,-1403.71 14962,-1380.37 14962,-1361.33"/>
<polygon fill="black" stroke="black" points="14965.5,-1361.25 14962,-1351.25 14958.5,-1361.25 14965.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_qkv -->
<g id="node507" class="node">
<title>LLaMA_7B_S3_R1_L23_qkv</title>
<polygon fill="lightcoral" stroke="black" points="15108.5,-1225.39 14815.5,-1225.39 14815.5,-1187.39 15108.5,-1187.39 15108.5,-1225.39"/>
<text text-anchor="middle" x="14962" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="14962" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_norm1&#45;&gt;LLaMA_7B_S3_R1_L23_qkv -->
<g id="edge464" class="edge">
<title>LLaMA_7B_S3_R1_L23_norm1&#45;&gt;LLaMA_7B_S3_R1_L23_qkv</title>
<path fill="none" stroke="black" d="M14962,-1297.25C14962,-1278.99 14962,-1254.56 14962,-1235.78"/>
<polygon fill="black" stroke="black" points="14965.5,-1235.74 14962,-1225.74 14958.5,-1235.74 14965.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_attn -->
<g id="node508" class="node">
<title>LLaMA_7B_S3_R1_L23_attn</title>
<polygon fill="lightcoral" stroke="black" points="15108.5,-1115.39 14815.5,-1115.39 14815.5,-1077.39 15108.5,-1077.39 15108.5,-1115.39"/>
<text text-anchor="middle" x="14962" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="14962" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_qkv&#45;&gt;LLaMA_7B_S3_R1_L23_attn -->
<g id="edge465" class="edge">
<title>LLaMA_7B_S3_R1_L23_qkv&#45;&gt;LLaMA_7B_S3_R1_L23_attn</title>
<path fill="none" stroke="black" d="M14962,-1187.07C14962,-1170.21 14962,-1144.95 14962,-1125.54"/>
<polygon fill="black" stroke="black" points="14965.5,-1125.44 14962,-1115.44 14958.5,-1125.44 14965.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_ar1 -->
<g id="node509" class="node">
<title>LLaMA_7B_S3_R1_L23_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14962" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14962" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_attn&#45;&gt;LLaMA_7B_S3_R1_L23_ar1 -->
<g id="edge466" class="edge">
<title>LLaMA_7B_S3_R1_L23_attn&#45;&gt;LLaMA_7B_S3_R1_L23_ar1</title>
<path fill="none" stroke="black" d="M14962,-1077.28C14962,-1060.91 14962,-1036.32 14962,-1015.9"/>
<polygon fill="black" stroke="black" points="14965.5,-1015.67 14962,-1005.67 14958.5,-1015.67 14965.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_res1 -->
<g id="node510" class="node">
<title>LLaMA_7B_S3_R1_L23_res1</title>
<polygon fill="lightyellow" stroke="black" points="15049.84,-879.65 14910.11,-879.65 14874.16,-843.65 15013.89,-843.65 15049.84,-879.65"/>
<text text-anchor="middle" x="14962" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_ar1&#45;&gt;LLaMA_7B_S3_R1_L23_res1 -->
<g id="edge467" class="edge">
<title>LLaMA_7B_S3_R1_L23_ar1&#45;&gt;LLaMA_7B_S3_R1_L23_res1</title>
<path fill="none" stroke="black" d="M14962,-951.45C14962,-933.08 14962,-908.53 14962,-889.9"/>
<polygon fill="black" stroke="black" points="14965.5,-889.71 14962,-879.71 14958.5,-889.71 14965.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_norm2 -->
<g id="node511" class="node">
<title>LLaMA_7B_S3_R1_L23_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="14962" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="14962" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_res1&#45;&gt;LLaMA_7B_S3_R1_L23_norm2 -->
<g id="edge468" class="edge">
<title>LLaMA_7B_S3_R1_L23_res1&#45;&gt;LLaMA_7B_S3_R1_L23_norm2</title>
<path fill="none" stroke="black" d="M14962,-843.2C14962,-827.06 14962,-802.56 14962,-782.16"/>
<polygon fill="black" stroke="black" points="14965.5,-781.94 14962,-771.94 14958.5,-781.94 14965.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_up -->
<g id="node512" class="node">
<title>LLaMA_7B_S3_R1_L23_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-645.91 14855.5,-645.91 14855.5,-607.91 15068.5,-607.91 15068.5,-645.91"/>
<text text-anchor="middle" x="14962" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14962" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_norm2&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_up -->
<g id="edge469" class="edge">
<title>LLaMA_7B_S3_R1_L23_norm2&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_up</title>
<path fill="none" stroke="black" d="M14962,-717.77C14962,-699.51 14962,-675.08 14962,-656.3"/>
<polygon fill="black" stroke="black" points="14965.5,-656.26 14962,-646.26 14958.5,-656.26 14965.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_gate -->
<g id="node513" class="node">
<title>LLaMA_7B_S3_R1_L23_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-535.91 14855.5,-535.91 14855.5,-497.91 15068.5,-497.91 15068.5,-535.91"/>
<text text-anchor="middle" x="14962" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14962" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_gate -->
<g id="edge470" class="edge">
<title>LLaMA_7B_S3_R1_L23_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_gate</title>
<path fill="none" stroke="black" d="M14962,-607.59C14962,-590.73 14962,-565.47 14962,-546.06"/>
<polygon fill="black" stroke="black" points="14965.5,-545.96 14962,-535.96 14958.5,-545.96 14965.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_down -->
<g id="node514" class="node">
<title>LLaMA_7B_S3_R1_L23_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="15068.5,-425.91 14855.5,-425.91 14855.5,-387.91 15068.5,-387.91 15068.5,-425.91"/>
<text text-anchor="middle" x="14962" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14962" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_down -->
<g id="edge471" class="edge">
<title>LLaMA_7B_S3_R1_L23_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L23_ffn_down</title>
<path fill="none" stroke="black" d="M14962,-497.59C14962,-480.73 14962,-455.47 14962,-436.06"/>
<polygon fill="black" stroke="black" points="14965.5,-435.96 14962,-425.96 14958.5,-435.96 14965.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_ar2 -->
<g id="node515" class="node">
<title>LLaMA_7B_S3_R1_L23_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14962" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14962" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="14962" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L23_ar2 -->
<g id="edge472" class="edge">
<title>LLaMA_7B_S3_R1_L23_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L23_ar2</title>
<path fill="none" stroke="black" d="M14962,-387.8C14962,-371.43 14962,-346.84 14962,-326.42"/>
<polygon fill="black" stroke="black" points="14965.5,-326.19 14962,-316.19 14958.5,-326.19 14965.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L23_res2 -->
<g id="node516" class="node">
<title>LLaMA_7B_S3_R1_L23_res2</title>
<polygon fill="lightyellow" stroke="black" points="15049.84,-190.17 14910.11,-190.17 14874.16,-154.17 15013.89,-154.17 15049.84,-190.17"/>
<text text-anchor="middle" x="14962" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L23_ar2&#45;&gt;LLaMA_7B_S3_R1_L23_res2 -->
<g id="edge473" class="edge">
<title>LLaMA_7B_S3_R1_L23_ar2&#45;&gt;LLaMA_7B_S3_R1_L23_res2</title>
<path fill="none" stroke="black" d="M14962,-261.97C14962,-243.6 14962,-219.05 14962,-200.42"/>
<polygon fill="black" stroke="black" points="14965.5,-200.23 14962,-190.23 14958.5,-200.23 14965.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_split -->
<g id="node517" class="node">
<title>LLaMA_7B_S3_R1_L24_split</title>
<polygon fill="orange" stroke="black" points="14530.53,-1499.13 13879.06,-1499.13 13711.47,-1423.13 14362.94,-1423.13 14530.53,-1499.13"/>
<text text-anchor="middle" x="14121" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="14121" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_norm1 -->
<g id="node518" class="node">
<title>LLaMA_7B_S3_R1_L24_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="14121" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14121" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_split&#45;&gt;LLaMA_7B_S3_R1_L24_norm1 -->
<g id="edge474" class="edge">
<title>LLaMA_7B_S3_R1_L24_split&#45;&gt;LLaMA_7B_S3_R1_L24_norm1</title>
<path fill="none" stroke="black" d="M14121,-1422.92C14121,-1403.71 14121,-1380.37 14121,-1361.33"/>
<polygon fill="black" stroke="black" points="14124.5,-1361.25 14121,-1351.25 14117.5,-1361.25 14124.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_qkv -->
<g id="node519" class="node">
<title>LLaMA_7B_S3_R1_L24_qkv</title>
<polygon fill="lightcoral" stroke="black" points="14267.5,-1225.39 13974.5,-1225.39 13974.5,-1187.39 14267.5,-1187.39 14267.5,-1225.39"/>
<text text-anchor="middle" x="14121" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="14121" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_norm1&#45;&gt;LLaMA_7B_S3_R1_L24_qkv -->
<g id="edge475" class="edge">
<title>LLaMA_7B_S3_R1_L24_norm1&#45;&gt;LLaMA_7B_S3_R1_L24_qkv</title>
<path fill="none" stroke="black" d="M14121,-1297.25C14121,-1278.99 14121,-1254.56 14121,-1235.78"/>
<polygon fill="black" stroke="black" points="14124.5,-1235.74 14121,-1225.74 14117.5,-1235.74 14124.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_attn -->
<g id="node520" class="node">
<title>LLaMA_7B_S3_R1_L24_attn</title>
<polygon fill="lightcoral" stroke="black" points="14267.5,-1115.39 13974.5,-1115.39 13974.5,-1077.39 14267.5,-1077.39 14267.5,-1115.39"/>
<text text-anchor="middle" x="14121" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="14121" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_qkv&#45;&gt;LLaMA_7B_S3_R1_L24_attn -->
<g id="edge476" class="edge">
<title>LLaMA_7B_S3_R1_L24_qkv&#45;&gt;LLaMA_7B_S3_R1_L24_attn</title>
<path fill="none" stroke="black" d="M14121,-1187.07C14121,-1170.21 14121,-1144.95 14121,-1125.54"/>
<polygon fill="black" stroke="black" points="14124.5,-1125.44 14121,-1115.44 14117.5,-1125.44 14124.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_ar1 -->
<g id="node521" class="node">
<title>LLaMA_7B_S3_R1_L24_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14121" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14121" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_attn&#45;&gt;LLaMA_7B_S3_R1_L24_ar1 -->
<g id="edge477" class="edge">
<title>LLaMA_7B_S3_R1_L24_attn&#45;&gt;LLaMA_7B_S3_R1_L24_ar1</title>
<path fill="none" stroke="black" d="M14121,-1077.28C14121,-1060.91 14121,-1036.32 14121,-1015.9"/>
<polygon fill="black" stroke="black" points="14124.5,-1015.67 14121,-1005.67 14117.5,-1015.67 14124.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_res1 -->
<g id="node522" class="node">
<title>LLaMA_7B_S3_R1_L24_res1</title>
<polygon fill="lightyellow" stroke="black" points="14208.84,-879.65 14069.11,-879.65 14033.16,-843.65 14172.89,-843.65 14208.84,-879.65"/>
<text text-anchor="middle" x="14121" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_ar1&#45;&gt;LLaMA_7B_S3_R1_L24_res1 -->
<g id="edge478" class="edge">
<title>LLaMA_7B_S3_R1_L24_ar1&#45;&gt;LLaMA_7B_S3_R1_L24_res1</title>
<path fill="none" stroke="black" d="M14121,-951.45C14121,-933.08 14121,-908.53 14121,-889.9"/>
<polygon fill="black" stroke="black" points="14124.5,-889.71 14121,-879.71 14117.5,-889.71 14124.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_norm2 -->
<g id="node523" class="node">
<title>LLaMA_7B_S3_R1_L24_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="14121" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="14121" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_res1&#45;&gt;LLaMA_7B_S3_R1_L24_norm2 -->
<g id="edge479" class="edge">
<title>LLaMA_7B_S3_R1_L24_res1&#45;&gt;LLaMA_7B_S3_R1_L24_norm2</title>
<path fill="none" stroke="black" d="M14121,-843.2C14121,-827.06 14121,-802.56 14121,-782.16"/>
<polygon fill="black" stroke="black" points="14124.5,-781.94 14121,-771.94 14117.5,-781.94 14124.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_up -->
<g id="node524" class="node">
<title>LLaMA_7B_S3_R1_L24_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-645.91 14014.5,-645.91 14014.5,-607.91 14227.5,-607.91 14227.5,-645.91"/>
<text text-anchor="middle" x="14121" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14121" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_norm2&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_up -->
<g id="edge480" class="edge">
<title>LLaMA_7B_S3_R1_L24_norm2&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_up</title>
<path fill="none" stroke="black" d="M14121,-717.77C14121,-699.51 14121,-675.08 14121,-656.3"/>
<polygon fill="black" stroke="black" points="14124.5,-656.26 14121,-646.26 14117.5,-656.26 14124.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_gate -->
<g id="node525" class="node">
<title>LLaMA_7B_S3_R1_L24_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-535.91 14014.5,-535.91 14014.5,-497.91 14227.5,-497.91 14227.5,-535.91"/>
<text text-anchor="middle" x="14121" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14121" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_gate -->
<g id="edge481" class="edge">
<title>LLaMA_7B_S3_R1_L24_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_gate</title>
<path fill="none" stroke="black" d="M14121,-607.59C14121,-590.73 14121,-565.47 14121,-546.06"/>
<polygon fill="black" stroke="black" points="14124.5,-545.96 14121,-535.96 14117.5,-545.96 14124.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_down -->
<g id="node526" class="node">
<title>LLaMA_7B_S3_R1_L24_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="14227.5,-425.91 14014.5,-425.91 14014.5,-387.91 14227.5,-387.91 14227.5,-425.91"/>
<text text-anchor="middle" x="14121" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="14121" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_down -->
<g id="edge482" class="edge">
<title>LLaMA_7B_S3_R1_L24_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L24_ffn_down</title>
<path fill="none" stroke="black" d="M14121,-497.59C14121,-480.73 14121,-455.47 14121,-436.06"/>
<polygon fill="black" stroke="black" points="14124.5,-435.96 14121,-425.96 14117.5,-435.96 14124.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_ar2 -->
<g id="node527" class="node">
<title>LLaMA_7B_S3_R1_L24_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="14121" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14121" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="14121" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L24_ar2 -->
<g id="edge483" class="edge">
<title>LLaMA_7B_S3_R1_L24_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L24_ar2</title>
<path fill="none" stroke="black" d="M14121,-387.8C14121,-371.43 14121,-346.84 14121,-326.42"/>
<polygon fill="black" stroke="black" points="14124.5,-326.19 14121,-316.19 14117.5,-326.19 14124.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L24_res2 -->
<g id="node528" class="node">
<title>LLaMA_7B_S3_R1_L24_res2</title>
<polygon fill="lightyellow" stroke="black" points="14208.84,-190.17 14069.11,-190.17 14033.16,-154.17 14172.89,-154.17 14208.84,-190.17"/>
<text text-anchor="middle" x="14121" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L24_ar2&#45;&gt;LLaMA_7B_S3_R1_L24_res2 -->
<g id="edge484" class="edge">
<title>LLaMA_7B_S3_R1_L24_ar2&#45;&gt;LLaMA_7B_S3_R1_L24_res2</title>
<path fill="none" stroke="black" d="M14121,-261.97C14121,-243.6 14121,-219.05 14121,-200.42"/>
<polygon fill="black" stroke="black" points="14124.5,-200.23 14121,-190.23 14117.5,-200.23 14124.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_split -->
<g id="node529" class="node">
<title>LLaMA_7B_S3_R1_L25_split</title>
<polygon fill="orange" stroke="black" points="13689.53,-1499.13 13038.06,-1499.13 12870.47,-1423.13 13521.94,-1423.13 13689.53,-1499.13"/>
<text text-anchor="middle" x="13280" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="13280" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_norm1 -->
<g id="node530" class="node">
<title>LLaMA_7B_S3_R1_L25_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="13280" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13280" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_split&#45;&gt;LLaMA_7B_S3_R1_L25_norm1 -->
<g id="edge485" class="edge">
<title>LLaMA_7B_S3_R1_L25_split&#45;&gt;LLaMA_7B_S3_R1_L25_norm1</title>
<path fill="none" stroke="black" d="M13280,-1422.92C13280,-1403.71 13280,-1380.37 13280,-1361.33"/>
<polygon fill="black" stroke="black" points="13283.5,-1361.25 13280,-1351.25 13276.5,-1361.25 13283.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_qkv -->
<g id="node531" class="node">
<title>LLaMA_7B_S3_R1_L25_qkv</title>
<polygon fill="lightcoral" stroke="black" points="13426.5,-1225.39 13133.5,-1225.39 13133.5,-1187.39 13426.5,-1187.39 13426.5,-1225.39"/>
<text text-anchor="middle" x="13280" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="13280" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_norm1&#45;&gt;LLaMA_7B_S3_R1_L25_qkv -->
<g id="edge486" class="edge">
<title>LLaMA_7B_S3_R1_L25_norm1&#45;&gt;LLaMA_7B_S3_R1_L25_qkv</title>
<path fill="none" stroke="black" d="M13280,-1297.25C13280,-1278.99 13280,-1254.56 13280,-1235.78"/>
<polygon fill="black" stroke="black" points="13283.5,-1235.74 13280,-1225.74 13276.5,-1235.74 13283.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_attn -->
<g id="node532" class="node">
<title>LLaMA_7B_S3_R1_L25_attn</title>
<polygon fill="lightcoral" stroke="black" points="13426.5,-1115.39 13133.5,-1115.39 13133.5,-1077.39 13426.5,-1077.39 13426.5,-1115.39"/>
<text text-anchor="middle" x="13280" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="13280" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_qkv&#45;&gt;LLaMA_7B_S3_R1_L25_attn -->
<g id="edge487" class="edge">
<title>LLaMA_7B_S3_R1_L25_qkv&#45;&gt;LLaMA_7B_S3_R1_L25_attn</title>
<path fill="none" stroke="black" d="M13280,-1187.07C13280,-1170.21 13280,-1144.95 13280,-1125.54"/>
<polygon fill="black" stroke="black" points="13283.5,-1125.44 13280,-1115.44 13276.5,-1125.44 13283.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_ar1 -->
<g id="node533" class="node">
<title>LLaMA_7B_S3_R1_L25_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13280" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="13280" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_attn&#45;&gt;LLaMA_7B_S3_R1_L25_ar1 -->
<g id="edge488" class="edge">
<title>LLaMA_7B_S3_R1_L25_attn&#45;&gt;LLaMA_7B_S3_R1_L25_ar1</title>
<path fill="none" stroke="black" d="M13280,-1077.28C13280,-1060.91 13280,-1036.32 13280,-1015.9"/>
<polygon fill="black" stroke="black" points="13283.5,-1015.67 13280,-1005.67 13276.5,-1015.67 13283.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_res1 -->
<g id="node534" class="node">
<title>LLaMA_7B_S3_R1_L25_res1</title>
<polygon fill="lightyellow" stroke="black" points="13367.84,-879.65 13228.11,-879.65 13192.16,-843.65 13331.89,-843.65 13367.84,-879.65"/>
<text text-anchor="middle" x="13280" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_ar1&#45;&gt;LLaMA_7B_S3_R1_L25_res1 -->
<g id="edge489" class="edge">
<title>LLaMA_7B_S3_R1_L25_ar1&#45;&gt;LLaMA_7B_S3_R1_L25_res1</title>
<path fill="none" stroke="black" d="M13280,-951.45C13280,-933.08 13280,-908.53 13280,-889.9"/>
<polygon fill="black" stroke="black" points="13283.5,-889.71 13280,-879.71 13276.5,-889.71 13283.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_norm2 -->
<g id="node535" class="node">
<title>LLaMA_7B_S3_R1_L25_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="13280" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="13280" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_res1&#45;&gt;LLaMA_7B_S3_R1_L25_norm2 -->
<g id="edge490" class="edge">
<title>LLaMA_7B_S3_R1_L25_res1&#45;&gt;LLaMA_7B_S3_R1_L25_norm2</title>
<path fill="none" stroke="black" d="M13280,-843.2C13280,-827.06 13280,-802.56 13280,-782.16"/>
<polygon fill="black" stroke="black" points="13283.5,-781.94 13280,-771.94 13276.5,-781.94 13283.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_up -->
<g id="node536" class="node">
<title>LLaMA_7B_S3_R1_L25_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-645.91 13173.5,-645.91 13173.5,-607.91 13386.5,-607.91 13386.5,-645.91"/>
<text text-anchor="middle" x="13280" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="13280" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_norm2&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_up -->
<g id="edge491" class="edge">
<title>LLaMA_7B_S3_R1_L25_norm2&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_up</title>
<path fill="none" stroke="black" d="M13280,-717.77C13280,-699.51 13280,-675.08 13280,-656.3"/>
<polygon fill="black" stroke="black" points="13283.5,-656.26 13280,-646.26 13276.5,-656.26 13283.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_gate -->
<g id="node537" class="node">
<title>LLaMA_7B_S3_R1_L25_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-535.91 13173.5,-535.91 13173.5,-497.91 13386.5,-497.91 13386.5,-535.91"/>
<text text-anchor="middle" x="13280" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="13280" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_gate -->
<g id="edge492" class="edge">
<title>LLaMA_7B_S3_R1_L25_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_gate</title>
<path fill="none" stroke="black" d="M13280,-607.59C13280,-590.73 13280,-565.47 13280,-546.06"/>
<polygon fill="black" stroke="black" points="13283.5,-545.96 13280,-535.96 13276.5,-545.96 13283.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_down -->
<g id="node538" class="node">
<title>LLaMA_7B_S3_R1_L25_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="13386.5,-425.91 13173.5,-425.91 13173.5,-387.91 13386.5,-387.91 13386.5,-425.91"/>
<text text-anchor="middle" x="13280" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13280" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_down -->
<g id="edge493" class="edge">
<title>LLaMA_7B_S3_R1_L25_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L25_ffn_down</title>
<path fill="none" stroke="black" d="M13280,-497.59C13280,-480.73 13280,-455.47 13280,-436.06"/>
<polygon fill="black" stroke="black" points="13283.5,-435.96 13280,-425.96 13276.5,-435.96 13283.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_ar2 -->
<g id="node539" class="node">
<title>LLaMA_7B_S3_R1_L25_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="13280" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13280" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="13280" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L25_ar2 -->
<g id="edge494" class="edge">
<title>LLaMA_7B_S3_R1_L25_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L25_ar2</title>
<path fill="none" stroke="black" d="M13280,-387.8C13280,-371.43 13280,-346.84 13280,-326.42"/>
<polygon fill="black" stroke="black" points="13283.5,-326.19 13280,-316.19 13276.5,-326.19 13283.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L25_res2 -->
<g id="node540" class="node">
<title>LLaMA_7B_S3_R1_L25_res2</title>
<polygon fill="lightyellow" stroke="black" points="13367.84,-190.17 13228.11,-190.17 13192.16,-154.17 13331.89,-154.17 13367.84,-190.17"/>
<text text-anchor="middle" x="13280" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L25_ar2&#45;&gt;LLaMA_7B_S3_R1_L25_res2 -->
<g id="edge495" class="edge">
<title>LLaMA_7B_S3_R1_L25_ar2&#45;&gt;LLaMA_7B_S3_R1_L25_res2</title>
<path fill="none" stroke="black" d="M13280,-261.97C13280,-243.6 13280,-219.05 13280,-200.42"/>
<polygon fill="black" stroke="black" points="13283.5,-200.23 13280,-190.23 13276.5,-200.23 13283.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_split -->
<g id="node541" class="node">
<title>LLaMA_7B_S3_R1_L26_split</title>
<polygon fill="orange" stroke="black" points="12848.53,-1499.13 12197.06,-1499.13 12029.47,-1423.13 12680.94,-1423.13 12848.53,-1499.13"/>
<text text-anchor="middle" x="12439" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="12439" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_norm1 -->
<g id="node542" class="node">
<title>LLaMA_7B_S3_R1_L26_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="12439" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12439" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_split&#45;&gt;LLaMA_7B_S3_R1_L26_norm1 -->
<g id="edge496" class="edge">
<title>LLaMA_7B_S3_R1_L26_split&#45;&gt;LLaMA_7B_S3_R1_L26_norm1</title>
<path fill="none" stroke="black" d="M12439,-1422.92C12439,-1403.71 12439,-1380.37 12439,-1361.33"/>
<polygon fill="black" stroke="black" points="12442.5,-1361.25 12439,-1351.25 12435.5,-1361.25 12442.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_qkv -->
<g id="node543" class="node">
<title>LLaMA_7B_S3_R1_L26_qkv</title>
<polygon fill="lightcoral" stroke="black" points="12585.5,-1225.39 12292.5,-1225.39 12292.5,-1187.39 12585.5,-1187.39 12585.5,-1225.39"/>
<text text-anchor="middle" x="12439" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="12439" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_norm1&#45;&gt;LLaMA_7B_S3_R1_L26_qkv -->
<g id="edge497" class="edge">
<title>LLaMA_7B_S3_R1_L26_norm1&#45;&gt;LLaMA_7B_S3_R1_L26_qkv</title>
<path fill="none" stroke="black" d="M12439,-1297.25C12439,-1278.99 12439,-1254.56 12439,-1235.78"/>
<polygon fill="black" stroke="black" points="12442.5,-1235.74 12439,-1225.74 12435.5,-1235.74 12442.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_attn -->
<g id="node544" class="node">
<title>LLaMA_7B_S3_R1_L26_attn</title>
<polygon fill="lightcoral" stroke="black" points="12585.5,-1115.39 12292.5,-1115.39 12292.5,-1077.39 12585.5,-1077.39 12585.5,-1115.39"/>
<text text-anchor="middle" x="12439" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="12439" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_qkv&#45;&gt;LLaMA_7B_S3_R1_L26_attn -->
<g id="edge498" class="edge">
<title>LLaMA_7B_S3_R1_L26_qkv&#45;&gt;LLaMA_7B_S3_R1_L26_attn</title>
<path fill="none" stroke="black" d="M12439,-1187.07C12439,-1170.21 12439,-1144.95 12439,-1125.54"/>
<polygon fill="black" stroke="black" points="12442.5,-1125.44 12439,-1115.44 12435.5,-1125.44 12442.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_ar1 -->
<g id="node545" class="node">
<title>LLaMA_7B_S3_R1_L26_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12439" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="12439" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_attn&#45;&gt;LLaMA_7B_S3_R1_L26_ar1 -->
<g id="edge499" class="edge">
<title>LLaMA_7B_S3_R1_L26_attn&#45;&gt;LLaMA_7B_S3_R1_L26_ar1</title>
<path fill="none" stroke="black" d="M12439,-1077.28C12439,-1060.91 12439,-1036.32 12439,-1015.9"/>
<polygon fill="black" stroke="black" points="12442.5,-1015.67 12439,-1005.67 12435.5,-1015.67 12442.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_res1 -->
<g id="node546" class="node">
<title>LLaMA_7B_S3_R1_L26_res1</title>
<polygon fill="lightyellow" stroke="black" points="12526.84,-879.65 12387.11,-879.65 12351.16,-843.65 12490.89,-843.65 12526.84,-879.65"/>
<text text-anchor="middle" x="12439" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_ar1&#45;&gt;LLaMA_7B_S3_R1_L26_res1 -->
<g id="edge500" class="edge">
<title>LLaMA_7B_S3_R1_L26_ar1&#45;&gt;LLaMA_7B_S3_R1_L26_res1</title>
<path fill="none" stroke="black" d="M12439,-951.45C12439,-933.08 12439,-908.53 12439,-889.9"/>
<polygon fill="black" stroke="black" points="12442.5,-889.71 12439,-879.71 12435.5,-889.71 12442.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_norm2 -->
<g id="node547" class="node">
<title>LLaMA_7B_S3_R1_L26_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="12439" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="12439" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_res1&#45;&gt;LLaMA_7B_S3_R1_L26_norm2 -->
<g id="edge501" class="edge">
<title>LLaMA_7B_S3_R1_L26_res1&#45;&gt;LLaMA_7B_S3_R1_L26_norm2</title>
<path fill="none" stroke="black" d="M12439,-843.2C12439,-827.06 12439,-802.56 12439,-782.16"/>
<polygon fill="black" stroke="black" points="12442.5,-781.94 12439,-771.94 12435.5,-781.94 12442.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_up -->
<g id="node548" class="node">
<title>LLaMA_7B_S3_R1_L26_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-645.91 12332.5,-645.91 12332.5,-607.91 12545.5,-607.91 12545.5,-645.91"/>
<text text-anchor="middle" x="12439" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="12439" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_norm2&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_up -->
<g id="edge502" class="edge">
<title>LLaMA_7B_S3_R1_L26_norm2&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_up</title>
<path fill="none" stroke="black" d="M12439,-717.77C12439,-699.51 12439,-675.08 12439,-656.3"/>
<polygon fill="black" stroke="black" points="12442.5,-656.26 12439,-646.26 12435.5,-656.26 12442.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_gate -->
<g id="node549" class="node">
<title>LLaMA_7B_S3_R1_L26_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-535.91 12332.5,-535.91 12332.5,-497.91 12545.5,-497.91 12545.5,-535.91"/>
<text text-anchor="middle" x="12439" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="12439" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_gate -->
<g id="edge503" class="edge">
<title>LLaMA_7B_S3_R1_L26_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_gate</title>
<path fill="none" stroke="black" d="M12439,-607.59C12439,-590.73 12439,-565.47 12439,-546.06"/>
<polygon fill="black" stroke="black" points="12442.5,-545.96 12439,-535.96 12435.5,-545.96 12442.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_down -->
<g id="node550" class="node">
<title>LLaMA_7B_S3_R1_L26_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="12545.5,-425.91 12332.5,-425.91 12332.5,-387.91 12545.5,-387.91 12545.5,-425.91"/>
<text text-anchor="middle" x="12439" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="12439" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_down -->
<g id="edge504" class="edge">
<title>LLaMA_7B_S3_R1_L26_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L26_ffn_down</title>
<path fill="none" stroke="black" d="M12439,-497.59C12439,-480.73 12439,-455.47 12439,-436.06"/>
<polygon fill="black" stroke="black" points="12442.5,-435.96 12439,-425.96 12435.5,-435.96 12442.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_ar2 -->
<g id="node551" class="node">
<title>LLaMA_7B_S3_R1_L26_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="12439" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12439" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="12439" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L26_ar2 -->
<g id="edge505" class="edge">
<title>LLaMA_7B_S3_R1_L26_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L26_ar2</title>
<path fill="none" stroke="black" d="M12439,-387.8C12439,-371.43 12439,-346.84 12439,-326.42"/>
<polygon fill="black" stroke="black" points="12442.5,-326.19 12439,-316.19 12435.5,-326.19 12442.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L26_res2 -->
<g id="node552" class="node">
<title>LLaMA_7B_S3_R1_L26_res2</title>
<polygon fill="lightyellow" stroke="black" points="12526.84,-190.17 12387.11,-190.17 12351.16,-154.17 12490.89,-154.17 12526.84,-190.17"/>
<text text-anchor="middle" x="12439" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L26_ar2&#45;&gt;LLaMA_7B_S3_R1_L26_res2 -->
<g id="edge506" class="edge">
<title>LLaMA_7B_S3_R1_L26_ar2&#45;&gt;LLaMA_7B_S3_R1_L26_res2</title>
<path fill="none" stroke="black" d="M12439,-261.97C12439,-243.6 12439,-219.05 12439,-200.42"/>
<polygon fill="black" stroke="black" points="12442.5,-200.23 12439,-190.23 12435.5,-200.23 12442.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_split -->
<g id="node553" class="node">
<title>LLaMA_7B_S3_R1_L27_split</title>
<polygon fill="orange" stroke="black" points="12007.53,-1499.13 11356.06,-1499.13 11188.47,-1423.13 11839.94,-1423.13 12007.53,-1499.13"/>
<text text-anchor="middle" x="11598" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="11598" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_norm1 -->
<g id="node554" class="node">
<title>LLaMA_7B_S3_R1_L27_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="11598" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11598" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_split&#45;&gt;LLaMA_7B_S3_R1_L27_norm1 -->
<g id="edge507" class="edge">
<title>LLaMA_7B_S3_R1_L27_split&#45;&gt;LLaMA_7B_S3_R1_L27_norm1</title>
<path fill="none" stroke="black" d="M11598,-1422.92C11598,-1403.71 11598,-1380.37 11598,-1361.33"/>
<polygon fill="black" stroke="black" points="11601.5,-1361.25 11598,-1351.25 11594.5,-1361.25 11601.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_qkv -->
<g id="node555" class="node">
<title>LLaMA_7B_S3_R1_L27_qkv</title>
<polygon fill="lightcoral" stroke="black" points="11744.5,-1225.39 11451.5,-1225.39 11451.5,-1187.39 11744.5,-1187.39 11744.5,-1225.39"/>
<text text-anchor="middle" x="11598" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="11598" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_norm1&#45;&gt;LLaMA_7B_S3_R1_L27_qkv -->
<g id="edge508" class="edge">
<title>LLaMA_7B_S3_R1_L27_norm1&#45;&gt;LLaMA_7B_S3_R1_L27_qkv</title>
<path fill="none" stroke="black" d="M11598,-1297.25C11598,-1278.99 11598,-1254.56 11598,-1235.78"/>
<polygon fill="black" stroke="black" points="11601.5,-1235.74 11598,-1225.74 11594.5,-1235.74 11601.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_attn -->
<g id="node556" class="node">
<title>LLaMA_7B_S3_R1_L27_attn</title>
<polygon fill="lightcoral" stroke="black" points="11744.5,-1115.39 11451.5,-1115.39 11451.5,-1077.39 11744.5,-1077.39 11744.5,-1115.39"/>
<text text-anchor="middle" x="11598" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="11598" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_qkv&#45;&gt;LLaMA_7B_S3_R1_L27_attn -->
<g id="edge509" class="edge">
<title>LLaMA_7B_S3_R1_L27_qkv&#45;&gt;LLaMA_7B_S3_R1_L27_attn</title>
<path fill="none" stroke="black" d="M11598,-1187.07C11598,-1170.21 11598,-1144.95 11598,-1125.54"/>
<polygon fill="black" stroke="black" points="11601.5,-1125.44 11598,-1115.44 11594.5,-1125.44 11601.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_ar1 -->
<g id="node557" class="node">
<title>LLaMA_7B_S3_R1_L27_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11598" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11598" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_attn&#45;&gt;LLaMA_7B_S3_R1_L27_ar1 -->
<g id="edge510" class="edge">
<title>LLaMA_7B_S3_R1_L27_attn&#45;&gt;LLaMA_7B_S3_R1_L27_ar1</title>
<path fill="none" stroke="black" d="M11598,-1077.28C11598,-1060.91 11598,-1036.32 11598,-1015.9"/>
<polygon fill="black" stroke="black" points="11601.5,-1015.67 11598,-1005.67 11594.5,-1015.67 11601.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_res1 -->
<g id="node558" class="node">
<title>LLaMA_7B_S3_R1_L27_res1</title>
<polygon fill="lightyellow" stroke="black" points="11685.84,-879.65 11546.11,-879.65 11510.16,-843.65 11649.89,-843.65 11685.84,-879.65"/>
<text text-anchor="middle" x="11598" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_ar1&#45;&gt;LLaMA_7B_S3_R1_L27_res1 -->
<g id="edge511" class="edge">
<title>LLaMA_7B_S3_R1_L27_ar1&#45;&gt;LLaMA_7B_S3_R1_L27_res1</title>
<path fill="none" stroke="black" d="M11598,-951.45C11598,-933.08 11598,-908.53 11598,-889.9"/>
<polygon fill="black" stroke="black" points="11601.5,-889.71 11598,-879.71 11594.5,-889.71 11601.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_norm2 -->
<g id="node559" class="node">
<title>LLaMA_7B_S3_R1_L27_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="11598" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="11598" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_res1&#45;&gt;LLaMA_7B_S3_R1_L27_norm2 -->
<g id="edge512" class="edge">
<title>LLaMA_7B_S3_R1_L27_res1&#45;&gt;LLaMA_7B_S3_R1_L27_norm2</title>
<path fill="none" stroke="black" d="M11598,-843.2C11598,-827.06 11598,-802.56 11598,-782.16"/>
<polygon fill="black" stroke="black" points="11601.5,-781.94 11598,-771.94 11594.5,-781.94 11601.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_up -->
<g id="node560" class="node">
<title>LLaMA_7B_S3_R1_L27_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-645.91 11491.5,-645.91 11491.5,-607.91 11704.5,-607.91 11704.5,-645.91"/>
<text text-anchor="middle" x="11598" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11598" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_norm2&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_up -->
<g id="edge513" class="edge">
<title>LLaMA_7B_S3_R1_L27_norm2&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_up</title>
<path fill="none" stroke="black" d="M11598,-717.77C11598,-699.51 11598,-675.08 11598,-656.3"/>
<polygon fill="black" stroke="black" points="11601.5,-656.26 11598,-646.26 11594.5,-656.26 11601.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_gate -->
<g id="node561" class="node">
<title>LLaMA_7B_S3_R1_L27_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-535.91 11491.5,-535.91 11491.5,-497.91 11704.5,-497.91 11704.5,-535.91"/>
<text text-anchor="middle" x="11598" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11598" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_gate -->
<g id="edge514" class="edge">
<title>LLaMA_7B_S3_R1_L27_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_gate</title>
<path fill="none" stroke="black" d="M11598,-607.59C11598,-590.73 11598,-565.47 11598,-546.06"/>
<polygon fill="black" stroke="black" points="11601.5,-545.96 11598,-535.96 11594.5,-545.96 11601.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_down -->
<g id="node562" class="node">
<title>LLaMA_7B_S3_R1_L27_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="11704.5,-425.91 11491.5,-425.91 11491.5,-387.91 11704.5,-387.91 11704.5,-425.91"/>
<text text-anchor="middle" x="11598" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="11598" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_down -->
<g id="edge515" class="edge">
<title>LLaMA_7B_S3_R1_L27_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L27_ffn_down</title>
<path fill="none" stroke="black" d="M11598,-497.59C11598,-480.73 11598,-455.47 11598,-436.06"/>
<polygon fill="black" stroke="black" points="11601.5,-435.96 11598,-425.96 11594.5,-435.96 11601.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_ar2 -->
<g id="node563" class="node">
<title>LLaMA_7B_S3_R1_L27_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="11598" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="11598" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L27_ar2 -->
<g id="edge516" class="edge">
<title>LLaMA_7B_S3_R1_L27_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L27_ar2</title>
<path fill="none" stroke="black" d="M11598,-387.8C11598,-371.43 11598,-346.84 11598,-326.42"/>
<polygon fill="black" stroke="black" points="11601.5,-326.19 11598,-316.19 11594.5,-326.19 11601.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L27_res2 -->
<g id="node564" class="node">
<title>LLaMA_7B_S3_R1_L27_res2</title>
<polygon fill="lightyellow" stroke="black" points="11685.84,-190.17 11546.11,-190.17 11510.16,-154.17 11649.89,-154.17 11685.84,-190.17"/>
<text text-anchor="middle" x="11598" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L27_ar2&#45;&gt;LLaMA_7B_S3_R1_L27_res2 -->
<g id="edge517" class="edge">
<title>LLaMA_7B_S3_R1_L27_ar2&#45;&gt;LLaMA_7B_S3_R1_L27_res2</title>
<path fill="none" stroke="black" d="M11598,-261.97C11598,-243.6 11598,-219.05 11598,-200.42"/>
<polygon fill="black" stroke="black" points="11601.5,-200.23 11598,-190.23 11594.5,-200.23 11601.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_split -->
<g id="node565" class="node">
<title>LLaMA_7B_S3_R1_L28_split</title>
<polygon fill="orange" stroke="black" points="11166.53,-1499.13 10515.06,-1499.13 10347.47,-1423.13 10998.94,-1423.13 11166.53,-1499.13"/>
<text text-anchor="middle" x="10757" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="10757" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_norm1 -->
<g id="node566" class="node">
<title>LLaMA_7B_S3_R1_L28_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="10757" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10757" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_split&#45;&gt;LLaMA_7B_S3_R1_L28_norm1 -->
<g id="edge518" class="edge">
<title>LLaMA_7B_S3_R1_L28_split&#45;&gt;LLaMA_7B_S3_R1_L28_norm1</title>
<path fill="none" stroke="black" d="M10757,-1422.92C10757,-1403.71 10757,-1380.37 10757,-1361.33"/>
<polygon fill="black" stroke="black" points="10760.5,-1361.25 10757,-1351.25 10753.5,-1361.25 10760.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_qkv -->
<g id="node567" class="node">
<title>LLaMA_7B_S3_R1_L28_qkv</title>
<polygon fill="lightcoral" stroke="black" points="10903.5,-1225.39 10610.5,-1225.39 10610.5,-1187.39 10903.5,-1187.39 10903.5,-1225.39"/>
<text text-anchor="middle" x="10757" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="10757" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_norm1&#45;&gt;LLaMA_7B_S3_R1_L28_qkv -->
<g id="edge519" class="edge">
<title>LLaMA_7B_S3_R1_L28_norm1&#45;&gt;LLaMA_7B_S3_R1_L28_qkv</title>
<path fill="none" stroke="black" d="M10757,-1297.25C10757,-1278.99 10757,-1254.56 10757,-1235.78"/>
<polygon fill="black" stroke="black" points="10760.5,-1235.74 10757,-1225.74 10753.5,-1235.74 10760.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_attn -->
<g id="node568" class="node">
<title>LLaMA_7B_S3_R1_L28_attn</title>
<polygon fill="lightcoral" stroke="black" points="10903.5,-1115.39 10610.5,-1115.39 10610.5,-1077.39 10903.5,-1077.39 10903.5,-1115.39"/>
<text text-anchor="middle" x="10757" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="10757" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_qkv&#45;&gt;LLaMA_7B_S3_R1_L28_attn -->
<g id="edge520" class="edge">
<title>LLaMA_7B_S3_R1_L28_qkv&#45;&gt;LLaMA_7B_S3_R1_L28_attn</title>
<path fill="none" stroke="black" d="M10757,-1187.07C10757,-1170.21 10757,-1144.95 10757,-1125.54"/>
<polygon fill="black" stroke="black" points="10760.5,-1125.44 10757,-1115.44 10753.5,-1125.44 10760.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_ar1 -->
<g id="node569" class="node">
<title>LLaMA_7B_S3_R1_L28_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10757" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10757" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_attn&#45;&gt;LLaMA_7B_S3_R1_L28_ar1 -->
<g id="edge521" class="edge">
<title>LLaMA_7B_S3_R1_L28_attn&#45;&gt;LLaMA_7B_S3_R1_L28_ar1</title>
<path fill="none" stroke="black" d="M10757,-1077.28C10757,-1060.91 10757,-1036.32 10757,-1015.9"/>
<polygon fill="black" stroke="black" points="10760.5,-1015.67 10757,-1005.67 10753.5,-1015.67 10760.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_res1 -->
<g id="node570" class="node">
<title>LLaMA_7B_S3_R1_L28_res1</title>
<polygon fill="lightyellow" stroke="black" points="10844.84,-879.65 10705.11,-879.65 10669.16,-843.65 10808.89,-843.65 10844.84,-879.65"/>
<text text-anchor="middle" x="10757" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_ar1&#45;&gt;LLaMA_7B_S3_R1_L28_res1 -->
<g id="edge522" class="edge">
<title>LLaMA_7B_S3_R1_L28_ar1&#45;&gt;LLaMA_7B_S3_R1_L28_res1</title>
<path fill="none" stroke="black" d="M10757,-951.45C10757,-933.08 10757,-908.53 10757,-889.9"/>
<polygon fill="black" stroke="black" points="10760.5,-889.71 10757,-879.71 10753.5,-889.71 10760.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_norm2 -->
<g id="node571" class="node">
<title>LLaMA_7B_S3_R1_L28_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="10757" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="10757" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_res1&#45;&gt;LLaMA_7B_S3_R1_L28_norm2 -->
<g id="edge523" class="edge">
<title>LLaMA_7B_S3_R1_L28_res1&#45;&gt;LLaMA_7B_S3_R1_L28_norm2</title>
<path fill="none" stroke="black" d="M10757,-843.2C10757,-827.06 10757,-802.56 10757,-782.16"/>
<polygon fill="black" stroke="black" points="10760.5,-781.94 10757,-771.94 10753.5,-781.94 10760.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_up -->
<g id="node572" class="node">
<title>LLaMA_7B_S3_R1_L28_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-645.91 10650.5,-645.91 10650.5,-607.91 10863.5,-607.91 10863.5,-645.91"/>
<text text-anchor="middle" x="10757" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="10757" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_norm2&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_up -->
<g id="edge524" class="edge">
<title>LLaMA_7B_S3_R1_L28_norm2&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_up</title>
<path fill="none" stroke="black" d="M10757,-717.77C10757,-699.51 10757,-675.08 10757,-656.3"/>
<polygon fill="black" stroke="black" points="10760.5,-656.26 10757,-646.26 10753.5,-656.26 10760.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_gate -->
<g id="node573" class="node">
<title>LLaMA_7B_S3_R1_L28_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-535.91 10650.5,-535.91 10650.5,-497.91 10863.5,-497.91 10863.5,-535.91"/>
<text text-anchor="middle" x="10757" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="10757" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_gate -->
<g id="edge525" class="edge">
<title>LLaMA_7B_S3_R1_L28_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_gate</title>
<path fill="none" stroke="black" d="M10757,-607.59C10757,-590.73 10757,-565.47 10757,-546.06"/>
<polygon fill="black" stroke="black" points="10760.5,-545.96 10757,-535.96 10753.5,-545.96 10760.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_down -->
<g id="node574" class="node">
<title>LLaMA_7B_S3_R1_L28_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="10863.5,-425.91 10650.5,-425.91 10650.5,-387.91 10863.5,-387.91 10863.5,-425.91"/>
<text text-anchor="middle" x="10757" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10757" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_down -->
<g id="edge526" class="edge">
<title>LLaMA_7B_S3_R1_L28_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L28_ffn_down</title>
<path fill="none" stroke="black" d="M10757,-497.59C10757,-480.73 10757,-455.47 10757,-436.06"/>
<polygon fill="black" stroke="black" points="10760.5,-435.96 10757,-425.96 10753.5,-435.96 10760.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_ar2 -->
<g id="node575" class="node">
<title>LLaMA_7B_S3_R1_L28_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="10757" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="10757" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="10757" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L28_ar2 -->
<g id="edge527" class="edge">
<title>LLaMA_7B_S3_R1_L28_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L28_ar2</title>
<path fill="none" stroke="black" d="M10757,-387.8C10757,-371.43 10757,-346.84 10757,-326.42"/>
<polygon fill="black" stroke="black" points="10760.5,-326.19 10757,-316.19 10753.5,-326.19 10760.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L28_res2 -->
<g id="node576" class="node">
<title>LLaMA_7B_S3_R1_L28_res2</title>
<polygon fill="lightyellow" stroke="black" points="10844.84,-190.17 10705.11,-190.17 10669.16,-154.17 10808.89,-154.17 10844.84,-190.17"/>
<text text-anchor="middle" x="10757" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L28_ar2&#45;&gt;LLaMA_7B_S3_R1_L28_res2 -->
<g id="edge528" class="edge">
<title>LLaMA_7B_S3_R1_L28_ar2&#45;&gt;LLaMA_7B_S3_R1_L28_res2</title>
<path fill="none" stroke="black" d="M10757,-261.97C10757,-243.6 10757,-219.05 10757,-200.42"/>
<polygon fill="black" stroke="black" points="10760.5,-200.23 10757,-190.23 10753.5,-200.23 10760.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_split -->
<g id="node577" class="node">
<title>LLaMA_7B_S3_R1_L29_split</title>
<polygon fill="orange" stroke="black" points="10325.53,-1499.13 9674.06,-1499.13 9506.47,-1423.13 10157.94,-1423.13 10325.53,-1499.13"/>
<text text-anchor="middle" x="9916" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="9916" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_norm1 -->
<g id="node578" class="node">
<title>LLaMA_7B_S3_R1_L29_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="9916" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9916" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_split&#45;&gt;LLaMA_7B_S3_R1_L29_norm1 -->
<g id="edge529" class="edge">
<title>LLaMA_7B_S3_R1_L29_split&#45;&gt;LLaMA_7B_S3_R1_L29_norm1</title>
<path fill="none" stroke="black" d="M9916,-1422.92C9916,-1403.71 9916,-1380.37 9916,-1361.33"/>
<polygon fill="black" stroke="black" points="9919.5,-1361.25 9916,-1351.25 9912.5,-1361.25 9919.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_qkv -->
<g id="node579" class="node">
<title>LLaMA_7B_S3_R1_L29_qkv</title>
<polygon fill="lightcoral" stroke="black" points="10062.5,-1225.39 9769.5,-1225.39 9769.5,-1187.39 10062.5,-1187.39 10062.5,-1225.39"/>
<text text-anchor="middle" x="9916" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="9916" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_norm1&#45;&gt;LLaMA_7B_S3_R1_L29_qkv -->
<g id="edge530" class="edge">
<title>LLaMA_7B_S3_R1_L29_norm1&#45;&gt;LLaMA_7B_S3_R1_L29_qkv</title>
<path fill="none" stroke="black" d="M9916,-1297.25C9916,-1278.99 9916,-1254.56 9916,-1235.78"/>
<polygon fill="black" stroke="black" points="9919.5,-1235.74 9916,-1225.74 9912.5,-1235.74 9919.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_attn -->
<g id="node580" class="node">
<title>LLaMA_7B_S3_R1_L29_attn</title>
<polygon fill="lightcoral" stroke="black" points="10062.5,-1115.39 9769.5,-1115.39 9769.5,-1077.39 10062.5,-1077.39 10062.5,-1115.39"/>
<text text-anchor="middle" x="9916" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="9916" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_qkv&#45;&gt;LLaMA_7B_S3_R1_L29_attn -->
<g id="edge531" class="edge">
<title>LLaMA_7B_S3_R1_L29_qkv&#45;&gt;LLaMA_7B_S3_R1_L29_attn</title>
<path fill="none" stroke="black" d="M9916,-1187.07C9916,-1170.21 9916,-1144.95 9916,-1125.54"/>
<polygon fill="black" stroke="black" points="9919.5,-1125.44 9916,-1115.44 9912.5,-1125.44 9919.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_ar1 -->
<g id="node581" class="node">
<title>LLaMA_7B_S3_R1_L29_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9916" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9916" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_attn&#45;&gt;LLaMA_7B_S3_R1_L29_ar1 -->
<g id="edge532" class="edge">
<title>LLaMA_7B_S3_R1_L29_attn&#45;&gt;LLaMA_7B_S3_R1_L29_ar1</title>
<path fill="none" stroke="black" d="M9916,-1077.28C9916,-1060.91 9916,-1036.32 9916,-1015.9"/>
<polygon fill="black" stroke="black" points="9919.5,-1015.67 9916,-1005.67 9912.5,-1015.67 9919.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_res1 -->
<g id="node582" class="node">
<title>LLaMA_7B_S3_R1_L29_res1</title>
<polygon fill="lightyellow" stroke="black" points="10003.84,-879.65 9864.11,-879.65 9828.16,-843.65 9967.89,-843.65 10003.84,-879.65"/>
<text text-anchor="middle" x="9916" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_ar1&#45;&gt;LLaMA_7B_S3_R1_L29_res1 -->
<g id="edge533" class="edge">
<title>LLaMA_7B_S3_R1_L29_ar1&#45;&gt;LLaMA_7B_S3_R1_L29_res1</title>
<path fill="none" stroke="black" d="M9916,-951.45C9916,-933.08 9916,-908.53 9916,-889.9"/>
<polygon fill="black" stroke="black" points="9919.5,-889.71 9916,-879.71 9912.5,-889.71 9919.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_norm2 -->
<g id="node583" class="node">
<title>LLaMA_7B_S3_R1_L29_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="9916" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="9916" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_res1&#45;&gt;LLaMA_7B_S3_R1_L29_norm2 -->
<g id="edge534" class="edge">
<title>LLaMA_7B_S3_R1_L29_res1&#45;&gt;LLaMA_7B_S3_R1_L29_norm2</title>
<path fill="none" stroke="black" d="M9916,-843.2C9916,-827.06 9916,-802.56 9916,-782.16"/>
<polygon fill="black" stroke="black" points="9919.5,-781.94 9916,-771.94 9912.5,-781.94 9919.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_up -->
<g id="node584" class="node">
<title>LLaMA_7B_S3_R1_L29_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-645.91 9809.5,-645.91 9809.5,-607.91 10022.5,-607.91 10022.5,-645.91"/>
<text text-anchor="middle" x="9916" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9916" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_norm2&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_up -->
<g id="edge535" class="edge">
<title>LLaMA_7B_S3_R1_L29_norm2&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_up</title>
<path fill="none" stroke="black" d="M9916,-717.77C9916,-699.51 9916,-675.08 9916,-656.3"/>
<polygon fill="black" stroke="black" points="9919.5,-656.26 9916,-646.26 9912.5,-656.26 9919.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_gate -->
<g id="node585" class="node">
<title>LLaMA_7B_S3_R1_L29_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-535.91 9809.5,-535.91 9809.5,-497.91 10022.5,-497.91 10022.5,-535.91"/>
<text text-anchor="middle" x="9916" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9916" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_gate -->
<g id="edge536" class="edge">
<title>LLaMA_7B_S3_R1_L29_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_gate</title>
<path fill="none" stroke="black" d="M9916,-607.59C9916,-590.73 9916,-565.47 9916,-546.06"/>
<polygon fill="black" stroke="black" points="9919.5,-545.96 9916,-535.96 9912.5,-545.96 9919.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_down -->
<g id="node586" class="node">
<title>LLaMA_7B_S3_R1_L29_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="10022.5,-425.91 9809.5,-425.91 9809.5,-387.91 10022.5,-387.91 10022.5,-425.91"/>
<text text-anchor="middle" x="9916" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9916" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_down -->
<g id="edge537" class="edge">
<title>LLaMA_7B_S3_R1_L29_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L29_ffn_down</title>
<path fill="none" stroke="black" d="M9916,-497.59C9916,-480.73 9916,-455.47 9916,-436.06"/>
<polygon fill="black" stroke="black" points="9919.5,-435.96 9916,-425.96 9912.5,-435.96 9919.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_ar2 -->
<g id="node587" class="node">
<title>LLaMA_7B_S3_R1_L29_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9916" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9916" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="9916" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L29_ar2 -->
<g id="edge538" class="edge">
<title>LLaMA_7B_S3_R1_L29_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L29_ar2</title>
<path fill="none" stroke="black" d="M9916,-387.8C9916,-371.43 9916,-346.84 9916,-326.42"/>
<polygon fill="black" stroke="black" points="9919.5,-326.19 9916,-316.19 9912.5,-326.19 9919.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L29_res2 -->
<g id="node588" class="node">
<title>LLaMA_7B_S3_R1_L29_res2</title>
<polygon fill="lightyellow" stroke="black" points="10003.84,-190.17 9864.11,-190.17 9828.16,-154.17 9967.89,-154.17 10003.84,-190.17"/>
<text text-anchor="middle" x="9916" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L29_ar2&#45;&gt;LLaMA_7B_S3_R1_L29_res2 -->
<g id="edge539" class="edge">
<title>LLaMA_7B_S3_R1_L29_ar2&#45;&gt;LLaMA_7B_S3_R1_L29_res2</title>
<path fill="none" stroke="black" d="M9916,-261.97C9916,-243.6 9916,-219.05 9916,-200.42"/>
<polygon fill="black" stroke="black" points="9919.5,-200.23 9916,-190.23 9912.5,-200.23 9919.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_split -->
<g id="node589" class="node">
<title>LLaMA_7B_S3_R1_L30_split</title>
<polygon fill="orange" stroke="black" points="9484.53,-1499.13 8833.06,-1499.13 8665.47,-1423.13 9316.94,-1423.13 9484.53,-1499.13"/>
<text text-anchor="middle" x="9075" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="9075" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_norm1 -->
<g id="node590" class="node">
<title>LLaMA_7B_S3_R1_L30_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="9075" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9075" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9075" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_split&#45;&gt;LLaMA_7B_S3_R1_L30_norm1 -->
<g id="edge540" class="edge">
<title>LLaMA_7B_S3_R1_L30_split&#45;&gt;LLaMA_7B_S3_R1_L30_norm1</title>
<path fill="none" stroke="black" d="M9075,-1422.92C9075,-1403.71 9075,-1380.37 9075,-1361.33"/>
<polygon fill="black" stroke="black" points="9078.5,-1361.25 9075,-1351.25 9071.5,-1361.25 9078.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_qkv -->
<g id="node591" class="node">
<title>LLaMA_7B_S3_R1_L30_qkv</title>
<polygon fill="lightcoral" stroke="black" points="9221.5,-1225.39 8928.5,-1225.39 8928.5,-1187.39 9221.5,-1187.39 9221.5,-1225.39"/>
<text text-anchor="middle" x="9075" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="9075" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_norm1&#45;&gt;LLaMA_7B_S3_R1_L30_qkv -->
<g id="edge541" class="edge">
<title>LLaMA_7B_S3_R1_L30_norm1&#45;&gt;LLaMA_7B_S3_R1_L30_qkv</title>
<path fill="none" stroke="black" d="M9075,-1297.25C9075,-1278.99 9075,-1254.56 9075,-1235.78"/>
<polygon fill="black" stroke="black" points="9078.5,-1235.74 9075,-1225.74 9071.5,-1235.74 9078.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_attn -->
<g id="node592" class="node">
<title>LLaMA_7B_S3_R1_L30_attn</title>
<polygon fill="lightcoral" stroke="black" points="9221.5,-1115.39 8928.5,-1115.39 8928.5,-1077.39 9221.5,-1077.39 9221.5,-1115.39"/>
<text text-anchor="middle" x="9075" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="9075" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_qkv&#45;&gt;LLaMA_7B_S3_R1_L30_attn -->
<g id="edge542" class="edge">
<title>LLaMA_7B_S3_R1_L30_qkv&#45;&gt;LLaMA_7B_S3_R1_L30_attn</title>
<path fill="none" stroke="black" d="M9075,-1187.07C9075,-1170.21 9075,-1144.95 9075,-1125.54"/>
<polygon fill="black" stroke="black" points="9078.5,-1125.44 9075,-1115.44 9071.5,-1125.44 9078.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_ar1 -->
<g id="node593" class="node">
<title>LLaMA_7B_S3_R1_L30_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9075" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9075" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9075" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_attn&#45;&gt;LLaMA_7B_S3_R1_L30_ar1 -->
<g id="edge543" class="edge">
<title>LLaMA_7B_S3_R1_L30_attn&#45;&gt;LLaMA_7B_S3_R1_L30_ar1</title>
<path fill="none" stroke="black" d="M9075,-1077.28C9075,-1060.91 9075,-1036.32 9075,-1015.9"/>
<polygon fill="black" stroke="black" points="9078.5,-1015.67 9075,-1005.67 9071.5,-1015.67 9078.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_res1 -->
<g id="node594" class="node">
<title>LLaMA_7B_S3_R1_L30_res1</title>
<polygon fill="lightyellow" stroke="black" points="9162.84,-879.65 9023.11,-879.65 8987.16,-843.65 9126.89,-843.65 9162.84,-879.65"/>
<text text-anchor="middle" x="9075" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_ar1&#45;&gt;LLaMA_7B_S3_R1_L30_res1 -->
<g id="edge544" class="edge">
<title>LLaMA_7B_S3_R1_L30_ar1&#45;&gt;LLaMA_7B_S3_R1_L30_res1</title>
<path fill="none" stroke="black" d="M9075,-951.45C9075,-933.08 9075,-908.53 9075,-889.9"/>
<polygon fill="black" stroke="black" points="9078.5,-889.71 9075,-879.71 9071.5,-889.71 9078.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_norm2 -->
<g id="node595" class="node">
<title>LLaMA_7B_S3_R1_L30_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="9075" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="9075" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="9075" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_res1&#45;&gt;LLaMA_7B_S3_R1_L30_norm2 -->
<g id="edge545" class="edge">
<title>LLaMA_7B_S3_R1_L30_res1&#45;&gt;LLaMA_7B_S3_R1_L30_norm2</title>
<path fill="none" stroke="black" d="M9075,-843.2C9075,-827.06 9075,-802.56 9075,-782.16"/>
<polygon fill="black" stroke="black" points="9078.5,-781.94 9075,-771.94 9071.5,-781.94 9078.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_up -->
<g id="node596" class="node">
<title>LLaMA_7B_S3_R1_L30_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="9181.5,-645.91 8968.5,-645.91 8968.5,-607.91 9181.5,-607.91 9181.5,-645.91"/>
<text text-anchor="middle" x="9075" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9075" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_norm2&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_up -->
<g id="edge546" class="edge">
<title>LLaMA_7B_S3_R1_L30_norm2&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_up</title>
<path fill="none" stroke="black" d="M9075,-717.77C9075,-699.51 9075,-675.08 9075,-656.3"/>
<polygon fill="black" stroke="black" points="9078.5,-656.26 9075,-646.26 9071.5,-656.26 9078.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_gate -->
<g id="node597" class="node">
<title>LLaMA_7B_S3_R1_L30_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="9181.5,-535.91 8968.5,-535.91 8968.5,-497.91 9181.5,-497.91 9181.5,-535.91"/>
<text text-anchor="middle" x="9075" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="9075" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_gate -->
<g id="edge547" class="edge">
<title>LLaMA_7B_S3_R1_L30_ffn_up&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_gate</title>
<path fill="none" stroke="black" d="M9075,-607.59C9075,-590.73 9075,-565.47 9075,-546.06"/>
<polygon fill="black" stroke="black" points="9078.5,-545.96 9075,-535.96 9071.5,-545.96 9078.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_down -->
<g id="node598" class="node">
<title>LLaMA_7B_S3_R1_L30_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="9181.5,-425.91 8968.5,-425.91 8968.5,-387.91 9181.5,-387.91 9181.5,-425.91"/>
<text text-anchor="middle" x="9075" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9075" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_down -->
<g id="edge548" class="edge">
<title>LLaMA_7B_S3_R1_L30_ffn_gate&#45;&gt;LLaMA_7B_S3_R1_L30_ffn_down</title>
<path fill="none" stroke="black" d="M9075,-497.59C9075,-480.73 9075,-455.47 9075,-436.06"/>
<polygon fill="black" stroke="black" points="9078.5,-435.96 9075,-425.96 9071.5,-435.96 9078.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_ar2 -->
<g id="node599" class="node">
<title>LLaMA_7B_S3_R1_L30_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="9075" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="9075" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="9075" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L30_ar2 -->
<g id="edge549" class="edge">
<title>LLaMA_7B_S3_R1_L30_ffn_down&#45;&gt;LLaMA_7B_S3_R1_L30_ar2</title>
<path fill="none" stroke="black" d="M9075,-387.8C9075,-371.43 9075,-346.84 9075,-326.42"/>
<polygon fill="black" stroke="black" points="9078.5,-326.19 9075,-316.19 9071.5,-326.19 9078.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R1_L30_res2 -->
<g id="node600" class="node">
<title>LLaMA_7B_S3_R1_L30_res2</title>
<polygon fill="lightyellow" stroke="black" points="9162.84,-190.17 9023.11,-190.17 8987.16,-154.17 9126.89,-154.17 9162.84,-190.17"/>
<text text-anchor="middle" x="9075" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R1_L30_ar2&#45;&gt;LLaMA_7B_S3_R1_L30_res2 -->
<g id="edge550" class="edge">
<title>LLaMA_7B_S3_R1_L30_ar2&#45;&gt;LLaMA_7B_S3_R1_L30_res2</title>
<path fill="none" stroke="black" d="M9075,-261.97C9075,-243.6 9075,-219.05 9075,-200.42"/>
<polygon fill="black" stroke="black" points="9078.5,-200.23 9075,-190.23 9071.5,-200.23 9078.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_split -->
<g id="node601" class="node">
<title>LLaMA_7B_S3_R2_L21_split</title>
<polygon fill="orange" stroke="black" points="8640.53,-1499.13 7989.06,-1499.13 7821.47,-1423.13 8472.94,-1423.13 8640.53,-1499.13"/>
<text text-anchor="middle" x="8231" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="8231" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_norm1 -->
<g id="node602" class="node">
<title>LLaMA_7B_S3_R2_L21_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="8231" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8231" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_split&#45;&gt;LLaMA_7B_S3_R2_L21_norm1 -->
<g id="edge551" class="edge">
<title>LLaMA_7B_S3_R2_L21_split&#45;&gt;LLaMA_7B_S3_R2_L21_norm1</title>
<path fill="none" stroke="black" d="M8231,-1422.92C8231,-1403.71 8231,-1380.37 8231,-1361.33"/>
<polygon fill="black" stroke="black" points="8234.5,-1361.25 8231,-1351.25 8227.5,-1361.25 8234.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_qkv -->
<g id="node603" class="node">
<title>LLaMA_7B_S3_R2_L21_qkv</title>
<polygon fill="lightcoral" stroke="black" points="8377.5,-1225.39 8084.5,-1225.39 8084.5,-1187.39 8377.5,-1187.39 8377.5,-1225.39"/>
<text text-anchor="middle" x="8231" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="8231" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_norm1&#45;&gt;LLaMA_7B_S3_R2_L21_qkv -->
<g id="edge552" class="edge">
<title>LLaMA_7B_S3_R2_L21_norm1&#45;&gt;LLaMA_7B_S3_R2_L21_qkv</title>
<path fill="none" stroke="black" d="M8231,-1297.25C8231,-1278.99 8231,-1254.56 8231,-1235.78"/>
<polygon fill="black" stroke="black" points="8234.5,-1235.74 8231,-1225.74 8227.5,-1235.74 8234.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_attn -->
<g id="node604" class="node">
<title>LLaMA_7B_S3_R2_L21_attn</title>
<polygon fill="lightcoral" stroke="black" points="8377.5,-1115.39 8084.5,-1115.39 8084.5,-1077.39 8377.5,-1077.39 8377.5,-1115.39"/>
<text text-anchor="middle" x="8231" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="8231" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_qkv&#45;&gt;LLaMA_7B_S3_R2_L21_attn -->
<g id="edge553" class="edge">
<title>LLaMA_7B_S3_R2_L21_qkv&#45;&gt;LLaMA_7B_S3_R2_L21_attn</title>
<path fill="none" stroke="black" d="M8231,-1187.07C8231,-1170.21 8231,-1144.95 8231,-1125.54"/>
<polygon fill="black" stroke="black" points="8234.5,-1125.44 8231,-1115.44 8227.5,-1125.44 8234.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_ar1 -->
<g id="node605" class="node">
<title>LLaMA_7B_S3_R2_L21_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8231" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="8231" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_attn&#45;&gt;LLaMA_7B_S3_R2_L21_ar1 -->
<g id="edge554" class="edge">
<title>LLaMA_7B_S3_R2_L21_attn&#45;&gt;LLaMA_7B_S3_R2_L21_ar1</title>
<path fill="none" stroke="black" d="M8231,-1077.28C8231,-1060.91 8231,-1036.32 8231,-1015.9"/>
<polygon fill="black" stroke="black" points="8234.5,-1015.67 8231,-1005.67 8227.5,-1015.67 8234.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_res1 -->
<g id="node606" class="node">
<title>LLaMA_7B_S3_R2_L21_res1</title>
<polygon fill="lightyellow" stroke="black" points="8318.84,-879.65 8179.11,-879.65 8143.16,-843.65 8282.89,-843.65 8318.84,-879.65"/>
<text text-anchor="middle" x="8231" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_ar1&#45;&gt;LLaMA_7B_S3_R2_L21_res1 -->
<g id="edge555" class="edge">
<title>LLaMA_7B_S3_R2_L21_ar1&#45;&gt;LLaMA_7B_S3_R2_L21_res1</title>
<path fill="none" stroke="black" d="M8231,-951.45C8231,-933.08 8231,-908.53 8231,-889.9"/>
<polygon fill="black" stroke="black" points="8234.5,-889.71 8231,-879.71 8227.5,-889.71 8234.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_norm2 -->
<g id="node607" class="node">
<title>LLaMA_7B_S3_R2_L21_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="8231" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="8231" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_res1&#45;&gt;LLaMA_7B_S3_R2_L21_norm2 -->
<g id="edge556" class="edge">
<title>LLaMA_7B_S3_R2_L21_res1&#45;&gt;LLaMA_7B_S3_R2_L21_norm2</title>
<path fill="none" stroke="black" d="M8231,-843.2C8231,-827.06 8231,-802.56 8231,-782.16"/>
<polygon fill="black" stroke="black" points="8234.5,-781.94 8231,-771.94 8227.5,-781.94 8234.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_up -->
<g id="node608" class="node">
<title>LLaMA_7B_S3_R2_L21_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-645.91 8124.5,-645.91 8124.5,-607.91 8337.5,-607.91 8337.5,-645.91"/>
<text text-anchor="middle" x="8231" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8231" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_norm2&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_up -->
<g id="edge557" class="edge">
<title>LLaMA_7B_S3_R2_L21_norm2&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_up</title>
<path fill="none" stroke="black" d="M8231,-717.77C8231,-699.51 8231,-675.08 8231,-656.3"/>
<polygon fill="black" stroke="black" points="8234.5,-656.26 8231,-646.26 8227.5,-656.26 8234.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_gate -->
<g id="node609" class="node">
<title>LLaMA_7B_S3_R2_L21_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-535.91 8124.5,-535.91 8124.5,-497.91 8337.5,-497.91 8337.5,-535.91"/>
<text text-anchor="middle" x="8231" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8231" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_gate -->
<g id="edge558" class="edge">
<title>LLaMA_7B_S3_R2_L21_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_gate</title>
<path fill="none" stroke="black" d="M8231,-607.59C8231,-590.73 8231,-565.47 8231,-546.06"/>
<polygon fill="black" stroke="black" points="8234.5,-545.96 8231,-535.96 8227.5,-545.96 8234.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_down -->
<g id="node610" class="node">
<title>LLaMA_7B_S3_R2_L21_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="8337.5,-425.91 8124.5,-425.91 8124.5,-387.91 8337.5,-387.91 8337.5,-425.91"/>
<text text-anchor="middle" x="8231" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8231" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_down -->
<g id="edge559" class="edge">
<title>LLaMA_7B_S3_R2_L21_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L21_ffn_down</title>
<path fill="none" stroke="black" d="M8231,-497.59C8231,-480.73 8231,-455.47 8231,-436.06"/>
<polygon fill="black" stroke="black" points="8234.5,-435.96 8231,-425.96 8227.5,-435.96 8234.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_ar2 -->
<g id="node611" class="node">
<title>LLaMA_7B_S3_R2_L21_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="8231" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="8231" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="8231" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L21_ar2 -->
<g id="edge560" class="edge">
<title>LLaMA_7B_S3_R2_L21_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L21_ar2</title>
<path fill="none" stroke="black" d="M8231,-387.8C8231,-371.43 8231,-346.84 8231,-326.42"/>
<polygon fill="black" stroke="black" points="8234.5,-326.19 8231,-316.19 8227.5,-326.19 8234.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L21_res2 -->
<g id="node612" class="node">
<title>LLaMA_7B_S3_R2_L21_res2</title>
<polygon fill="lightyellow" stroke="black" points="8318.84,-190.17 8179.11,-190.17 8143.16,-154.17 8282.89,-154.17 8318.84,-190.17"/>
<text text-anchor="middle" x="8231" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L21_ar2&#45;&gt;LLaMA_7B_S3_R2_L21_res2 -->
<g id="edge561" class="edge">
<title>LLaMA_7B_S3_R2_L21_ar2&#45;&gt;LLaMA_7B_S3_R2_L21_res2</title>
<path fill="none" stroke="black" d="M8231,-261.97C8231,-243.6 8231,-219.05 8231,-200.42"/>
<polygon fill="black" stroke="black" points="8234.5,-200.23 8231,-190.23 8227.5,-200.23 8234.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_split -->
<g id="node613" class="node">
<title>LLaMA_7B_S3_R2_L22_split</title>
<polygon fill="orange" stroke="black" points="7799.53,-1499.13 7148.06,-1499.13 6980.47,-1423.13 7631.94,-1423.13 7799.53,-1499.13"/>
<text text-anchor="middle" x="7390" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="7390" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_norm1 -->
<g id="node614" class="node">
<title>LLaMA_7B_S3_R2_L22_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="7390" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7390" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_split&#45;&gt;LLaMA_7B_S3_R2_L22_norm1 -->
<g id="edge562" class="edge">
<title>LLaMA_7B_S3_R2_L22_split&#45;&gt;LLaMA_7B_S3_R2_L22_norm1</title>
<path fill="none" stroke="black" d="M7390,-1422.92C7390,-1403.71 7390,-1380.37 7390,-1361.33"/>
<polygon fill="black" stroke="black" points="7393.5,-1361.25 7390,-1351.25 7386.5,-1361.25 7393.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_qkv -->
<g id="node615" class="node">
<title>LLaMA_7B_S3_R2_L22_qkv</title>
<polygon fill="lightcoral" stroke="black" points="7536.5,-1225.39 7243.5,-1225.39 7243.5,-1187.39 7536.5,-1187.39 7536.5,-1225.39"/>
<text text-anchor="middle" x="7390" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="7390" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_norm1&#45;&gt;LLaMA_7B_S3_R2_L22_qkv -->
<g id="edge563" class="edge">
<title>LLaMA_7B_S3_R2_L22_norm1&#45;&gt;LLaMA_7B_S3_R2_L22_qkv</title>
<path fill="none" stroke="black" d="M7390,-1297.25C7390,-1278.99 7390,-1254.56 7390,-1235.78"/>
<polygon fill="black" stroke="black" points="7393.5,-1235.74 7390,-1225.74 7386.5,-1235.74 7393.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_attn -->
<g id="node616" class="node">
<title>LLaMA_7B_S3_R2_L22_attn</title>
<polygon fill="lightcoral" stroke="black" points="7536.5,-1115.39 7243.5,-1115.39 7243.5,-1077.39 7536.5,-1077.39 7536.5,-1115.39"/>
<text text-anchor="middle" x="7390" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7390" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_qkv&#45;&gt;LLaMA_7B_S3_R2_L22_attn -->
<g id="edge564" class="edge">
<title>LLaMA_7B_S3_R2_L22_qkv&#45;&gt;LLaMA_7B_S3_R2_L22_attn</title>
<path fill="none" stroke="black" d="M7390,-1187.07C7390,-1170.21 7390,-1144.95 7390,-1125.54"/>
<polygon fill="black" stroke="black" points="7393.5,-1125.44 7390,-1115.44 7386.5,-1125.44 7393.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_ar1 -->
<g id="node617" class="node">
<title>LLaMA_7B_S3_R2_L22_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7390" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7390" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_attn&#45;&gt;LLaMA_7B_S3_R2_L22_ar1 -->
<g id="edge565" class="edge">
<title>LLaMA_7B_S3_R2_L22_attn&#45;&gt;LLaMA_7B_S3_R2_L22_ar1</title>
<path fill="none" stroke="black" d="M7390,-1077.28C7390,-1060.91 7390,-1036.32 7390,-1015.9"/>
<polygon fill="black" stroke="black" points="7393.5,-1015.67 7390,-1005.67 7386.5,-1015.67 7393.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_res1 -->
<g id="node618" class="node">
<title>LLaMA_7B_S3_R2_L22_res1</title>
<polygon fill="lightyellow" stroke="black" points="7477.84,-879.65 7338.11,-879.65 7302.16,-843.65 7441.89,-843.65 7477.84,-879.65"/>
<text text-anchor="middle" x="7390" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_ar1&#45;&gt;LLaMA_7B_S3_R2_L22_res1 -->
<g id="edge566" class="edge">
<title>LLaMA_7B_S3_R2_L22_ar1&#45;&gt;LLaMA_7B_S3_R2_L22_res1</title>
<path fill="none" stroke="black" d="M7390,-951.45C7390,-933.08 7390,-908.53 7390,-889.9"/>
<polygon fill="black" stroke="black" points="7393.5,-889.71 7390,-879.71 7386.5,-889.71 7393.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_norm2 -->
<g id="node619" class="node">
<title>LLaMA_7B_S3_R2_L22_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="7390" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="7390" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_res1&#45;&gt;LLaMA_7B_S3_R2_L22_norm2 -->
<g id="edge567" class="edge">
<title>LLaMA_7B_S3_R2_L22_res1&#45;&gt;LLaMA_7B_S3_R2_L22_norm2</title>
<path fill="none" stroke="black" d="M7390,-843.2C7390,-827.06 7390,-802.56 7390,-782.16"/>
<polygon fill="black" stroke="black" points="7393.5,-781.94 7390,-771.94 7386.5,-781.94 7393.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_up -->
<g id="node620" class="node">
<title>LLaMA_7B_S3_R2_L22_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-645.91 7283.5,-645.91 7283.5,-607.91 7496.5,-607.91 7496.5,-645.91"/>
<text text-anchor="middle" x="7390" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7390" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_norm2&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_up -->
<g id="edge568" class="edge">
<title>LLaMA_7B_S3_R2_L22_norm2&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_up</title>
<path fill="none" stroke="black" d="M7390,-717.77C7390,-699.51 7390,-675.08 7390,-656.3"/>
<polygon fill="black" stroke="black" points="7393.5,-656.26 7390,-646.26 7386.5,-656.26 7393.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_gate -->
<g id="node621" class="node">
<title>LLaMA_7B_S3_R2_L22_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-535.91 7283.5,-535.91 7283.5,-497.91 7496.5,-497.91 7496.5,-535.91"/>
<text text-anchor="middle" x="7390" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="7390" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_gate -->
<g id="edge569" class="edge">
<title>LLaMA_7B_S3_R2_L22_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_gate</title>
<path fill="none" stroke="black" d="M7390,-607.59C7390,-590.73 7390,-565.47 7390,-546.06"/>
<polygon fill="black" stroke="black" points="7393.5,-545.96 7390,-535.96 7386.5,-545.96 7393.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_down -->
<g id="node622" class="node">
<title>LLaMA_7B_S3_R2_L22_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="7496.5,-425.91 7283.5,-425.91 7283.5,-387.91 7496.5,-387.91 7496.5,-425.91"/>
<text text-anchor="middle" x="7390" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7390" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_down -->
<g id="edge570" class="edge">
<title>LLaMA_7B_S3_R2_L22_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L22_ffn_down</title>
<path fill="none" stroke="black" d="M7390,-497.59C7390,-480.73 7390,-455.47 7390,-436.06"/>
<polygon fill="black" stroke="black" points="7393.5,-435.96 7390,-425.96 7386.5,-435.96 7393.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_ar2 -->
<g id="node623" class="node">
<title>LLaMA_7B_S3_R2_L22_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="7390" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="7390" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="7390" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L22_ar2 -->
<g id="edge571" class="edge">
<title>LLaMA_7B_S3_R2_L22_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L22_ar2</title>
<path fill="none" stroke="black" d="M7390,-387.8C7390,-371.43 7390,-346.84 7390,-326.42"/>
<polygon fill="black" stroke="black" points="7393.5,-326.19 7390,-316.19 7386.5,-326.19 7393.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L22_res2 -->
<g id="node624" class="node">
<title>LLaMA_7B_S3_R2_L22_res2</title>
<polygon fill="lightyellow" stroke="black" points="7477.84,-190.17 7338.11,-190.17 7302.16,-154.17 7441.89,-154.17 7477.84,-190.17"/>
<text text-anchor="middle" x="7390" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L22_ar2&#45;&gt;LLaMA_7B_S3_R2_L22_res2 -->
<g id="edge572" class="edge">
<title>LLaMA_7B_S3_R2_L22_ar2&#45;&gt;LLaMA_7B_S3_R2_L22_res2</title>
<path fill="none" stroke="black" d="M7390,-261.97C7390,-243.6 7390,-219.05 7390,-200.42"/>
<polygon fill="black" stroke="black" points="7393.5,-200.23 7390,-190.23 7386.5,-200.23 7393.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_split -->
<g id="node625" class="node">
<title>LLaMA_7B_S3_R2_L23_split</title>
<polygon fill="orange" stroke="black" points="6958.53,-1499.13 6307.06,-1499.13 6139.47,-1423.13 6790.94,-1423.13 6958.53,-1499.13"/>
<text text-anchor="middle" x="6549" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="6549" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_norm1 -->
<g id="node626" class="node">
<title>LLaMA_7B_S3_R2_L23_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="6549" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6549" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_split&#45;&gt;LLaMA_7B_S3_R2_L23_norm1 -->
<g id="edge573" class="edge">
<title>LLaMA_7B_S3_R2_L23_split&#45;&gt;LLaMA_7B_S3_R2_L23_norm1</title>
<path fill="none" stroke="black" d="M6549,-1422.92C6549,-1403.71 6549,-1380.37 6549,-1361.33"/>
<polygon fill="black" stroke="black" points="6552.5,-1361.25 6549,-1351.25 6545.5,-1361.25 6552.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_qkv -->
<g id="node627" class="node">
<title>LLaMA_7B_S3_R2_L23_qkv</title>
<polygon fill="lightcoral" stroke="black" points="6695.5,-1225.39 6402.5,-1225.39 6402.5,-1187.39 6695.5,-1187.39 6695.5,-1225.39"/>
<text text-anchor="middle" x="6549" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="6549" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_norm1&#45;&gt;LLaMA_7B_S3_R2_L23_qkv -->
<g id="edge574" class="edge">
<title>LLaMA_7B_S3_R2_L23_norm1&#45;&gt;LLaMA_7B_S3_R2_L23_qkv</title>
<path fill="none" stroke="black" d="M6549,-1297.25C6549,-1278.99 6549,-1254.56 6549,-1235.78"/>
<polygon fill="black" stroke="black" points="6552.5,-1235.74 6549,-1225.74 6545.5,-1235.74 6552.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_attn -->
<g id="node628" class="node">
<title>LLaMA_7B_S3_R2_L23_attn</title>
<polygon fill="lightcoral" stroke="black" points="6695.5,-1115.39 6402.5,-1115.39 6402.5,-1077.39 6695.5,-1077.39 6695.5,-1115.39"/>
<text text-anchor="middle" x="6549" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6549" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_qkv&#45;&gt;LLaMA_7B_S3_R2_L23_attn -->
<g id="edge575" class="edge">
<title>LLaMA_7B_S3_R2_L23_qkv&#45;&gt;LLaMA_7B_S3_R2_L23_attn</title>
<path fill="none" stroke="black" d="M6549,-1187.07C6549,-1170.21 6549,-1144.95 6549,-1125.54"/>
<polygon fill="black" stroke="black" points="6552.5,-1125.44 6549,-1115.44 6545.5,-1125.44 6552.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_ar1 -->
<g id="node629" class="node">
<title>LLaMA_7B_S3_R2_L23_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6549" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6549" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_attn&#45;&gt;LLaMA_7B_S3_R2_L23_ar1 -->
<g id="edge576" class="edge">
<title>LLaMA_7B_S3_R2_L23_attn&#45;&gt;LLaMA_7B_S3_R2_L23_ar1</title>
<path fill="none" stroke="black" d="M6549,-1077.28C6549,-1060.91 6549,-1036.32 6549,-1015.9"/>
<polygon fill="black" stroke="black" points="6552.5,-1015.67 6549,-1005.67 6545.5,-1015.67 6552.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_res1 -->
<g id="node630" class="node">
<title>LLaMA_7B_S3_R2_L23_res1</title>
<polygon fill="lightyellow" stroke="black" points="6636.84,-879.65 6497.11,-879.65 6461.16,-843.65 6600.89,-843.65 6636.84,-879.65"/>
<text text-anchor="middle" x="6549" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_ar1&#45;&gt;LLaMA_7B_S3_R2_L23_res1 -->
<g id="edge577" class="edge">
<title>LLaMA_7B_S3_R2_L23_ar1&#45;&gt;LLaMA_7B_S3_R2_L23_res1</title>
<path fill="none" stroke="black" d="M6549,-951.45C6549,-933.08 6549,-908.53 6549,-889.9"/>
<polygon fill="black" stroke="black" points="6552.5,-889.71 6549,-879.71 6545.5,-889.71 6552.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_norm2 -->
<g id="node631" class="node">
<title>LLaMA_7B_S3_R2_L23_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="6549" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="6549" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_res1&#45;&gt;LLaMA_7B_S3_R2_L23_norm2 -->
<g id="edge578" class="edge">
<title>LLaMA_7B_S3_R2_L23_res1&#45;&gt;LLaMA_7B_S3_R2_L23_norm2</title>
<path fill="none" stroke="black" d="M6549,-843.2C6549,-827.06 6549,-802.56 6549,-782.16"/>
<polygon fill="black" stroke="black" points="6552.5,-781.94 6549,-771.94 6545.5,-781.94 6552.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_up -->
<g id="node632" class="node">
<title>LLaMA_7B_S3_R2_L23_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-645.91 6442.5,-645.91 6442.5,-607.91 6655.5,-607.91 6655.5,-645.91"/>
<text text-anchor="middle" x="6549" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6549" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_norm2&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_up -->
<g id="edge579" class="edge">
<title>LLaMA_7B_S3_R2_L23_norm2&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_up</title>
<path fill="none" stroke="black" d="M6549,-717.77C6549,-699.51 6549,-675.08 6549,-656.3"/>
<polygon fill="black" stroke="black" points="6552.5,-656.26 6549,-646.26 6545.5,-656.26 6552.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_gate -->
<g id="node633" class="node">
<title>LLaMA_7B_S3_R2_L23_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-535.91 6442.5,-535.91 6442.5,-497.91 6655.5,-497.91 6655.5,-535.91"/>
<text text-anchor="middle" x="6549" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="6549" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_gate -->
<g id="edge580" class="edge">
<title>LLaMA_7B_S3_R2_L23_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_gate</title>
<path fill="none" stroke="black" d="M6549,-607.59C6549,-590.73 6549,-565.47 6549,-546.06"/>
<polygon fill="black" stroke="black" points="6552.5,-545.96 6549,-535.96 6545.5,-545.96 6552.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_down -->
<g id="node634" class="node">
<title>LLaMA_7B_S3_R2_L23_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="6655.5,-425.91 6442.5,-425.91 6442.5,-387.91 6655.5,-387.91 6655.5,-425.91"/>
<text text-anchor="middle" x="6549" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6549" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_down -->
<g id="edge581" class="edge">
<title>LLaMA_7B_S3_R2_L23_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L23_ffn_down</title>
<path fill="none" stroke="black" d="M6549,-497.59C6549,-480.73 6549,-455.47 6549,-436.06"/>
<polygon fill="black" stroke="black" points="6552.5,-435.96 6549,-425.96 6545.5,-435.96 6552.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_ar2 -->
<g id="node635" class="node">
<title>LLaMA_7B_S3_R2_L23_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="6549" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="6549" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="6549" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L23_ar2 -->
<g id="edge582" class="edge">
<title>LLaMA_7B_S3_R2_L23_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L23_ar2</title>
<path fill="none" stroke="black" d="M6549,-387.8C6549,-371.43 6549,-346.84 6549,-326.42"/>
<polygon fill="black" stroke="black" points="6552.5,-326.19 6549,-316.19 6545.5,-326.19 6552.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L23_res2 -->
<g id="node636" class="node">
<title>LLaMA_7B_S3_R2_L23_res2</title>
<polygon fill="lightyellow" stroke="black" points="6636.84,-190.17 6497.11,-190.17 6461.16,-154.17 6600.89,-154.17 6636.84,-190.17"/>
<text text-anchor="middle" x="6549" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L23_ar2&#45;&gt;LLaMA_7B_S3_R2_L23_res2 -->
<g id="edge583" class="edge">
<title>LLaMA_7B_S3_R2_L23_ar2&#45;&gt;LLaMA_7B_S3_R2_L23_res2</title>
<path fill="none" stroke="black" d="M6549,-261.97C6549,-243.6 6549,-219.05 6549,-200.42"/>
<polygon fill="black" stroke="black" points="6552.5,-200.23 6549,-190.23 6545.5,-200.23 6552.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_split -->
<g id="node637" class="node">
<title>LLaMA_7B_S3_R2_L24_split</title>
<polygon fill="orange" stroke="black" points="6117.53,-1499.13 5466.06,-1499.13 5298.47,-1423.13 5949.94,-1423.13 6117.53,-1499.13"/>
<text text-anchor="middle" x="5708" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="5708" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_norm1 -->
<g id="node638" class="node">
<title>LLaMA_7B_S3_R2_L24_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="5708" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5708" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_split&#45;&gt;LLaMA_7B_S3_R2_L24_norm1 -->
<g id="edge584" class="edge">
<title>LLaMA_7B_S3_R2_L24_split&#45;&gt;LLaMA_7B_S3_R2_L24_norm1</title>
<path fill="none" stroke="black" d="M5708,-1422.92C5708,-1403.71 5708,-1380.37 5708,-1361.33"/>
<polygon fill="black" stroke="black" points="5711.5,-1361.25 5708,-1351.25 5704.5,-1361.25 5711.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_qkv -->
<g id="node639" class="node">
<title>LLaMA_7B_S3_R2_L24_qkv</title>
<polygon fill="lightcoral" stroke="black" points="5854.5,-1225.39 5561.5,-1225.39 5561.5,-1187.39 5854.5,-1187.39 5854.5,-1225.39"/>
<text text-anchor="middle" x="5708" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="5708" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_norm1&#45;&gt;LLaMA_7B_S3_R2_L24_qkv -->
<g id="edge585" class="edge">
<title>LLaMA_7B_S3_R2_L24_norm1&#45;&gt;LLaMA_7B_S3_R2_L24_qkv</title>
<path fill="none" stroke="black" d="M5708,-1297.25C5708,-1278.99 5708,-1254.56 5708,-1235.78"/>
<polygon fill="black" stroke="black" points="5711.5,-1235.74 5708,-1225.74 5704.5,-1235.74 5711.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_attn -->
<g id="node640" class="node">
<title>LLaMA_7B_S3_R2_L24_attn</title>
<polygon fill="lightcoral" stroke="black" points="5854.5,-1115.39 5561.5,-1115.39 5561.5,-1077.39 5854.5,-1077.39 5854.5,-1115.39"/>
<text text-anchor="middle" x="5708" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5708" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_qkv&#45;&gt;LLaMA_7B_S3_R2_L24_attn -->
<g id="edge586" class="edge">
<title>LLaMA_7B_S3_R2_L24_qkv&#45;&gt;LLaMA_7B_S3_R2_L24_attn</title>
<path fill="none" stroke="black" d="M5708,-1187.07C5708,-1170.21 5708,-1144.95 5708,-1125.54"/>
<polygon fill="black" stroke="black" points="5711.5,-1125.44 5708,-1115.44 5704.5,-1125.44 5711.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_ar1 -->
<g id="node641" class="node">
<title>LLaMA_7B_S3_R2_L24_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5708" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5708" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_attn&#45;&gt;LLaMA_7B_S3_R2_L24_ar1 -->
<g id="edge587" class="edge">
<title>LLaMA_7B_S3_R2_L24_attn&#45;&gt;LLaMA_7B_S3_R2_L24_ar1</title>
<path fill="none" stroke="black" d="M5708,-1077.28C5708,-1060.91 5708,-1036.32 5708,-1015.9"/>
<polygon fill="black" stroke="black" points="5711.5,-1015.67 5708,-1005.67 5704.5,-1015.67 5711.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_res1 -->
<g id="node642" class="node">
<title>LLaMA_7B_S3_R2_L24_res1</title>
<polygon fill="lightyellow" stroke="black" points="5795.84,-879.65 5656.11,-879.65 5620.16,-843.65 5759.89,-843.65 5795.84,-879.65"/>
<text text-anchor="middle" x="5708" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_ar1&#45;&gt;LLaMA_7B_S3_R2_L24_res1 -->
<g id="edge588" class="edge">
<title>LLaMA_7B_S3_R2_L24_ar1&#45;&gt;LLaMA_7B_S3_R2_L24_res1</title>
<path fill="none" stroke="black" d="M5708,-951.45C5708,-933.08 5708,-908.53 5708,-889.9"/>
<polygon fill="black" stroke="black" points="5711.5,-889.71 5708,-879.71 5704.5,-889.71 5711.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_norm2 -->
<g id="node643" class="node">
<title>LLaMA_7B_S3_R2_L24_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="5708" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="5708" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_res1&#45;&gt;LLaMA_7B_S3_R2_L24_norm2 -->
<g id="edge589" class="edge">
<title>LLaMA_7B_S3_R2_L24_res1&#45;&gt;LLaMA_7B_S3_R2_L24_norm2</title>
<path fill="none" stroke="black" d="M5708,-843.2C5708,-827.06 5708,-802.56 5708,-782.16"/>
<polygon fill="black" stroke="black" points="5711.5,-781.94 5708,-771.94 5704.5,-781.94 5711.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_up -->
<g id="node644" class="node">
<title>LLaMA_7B_S3_R2_L24_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-645.91 5601.5,-645.91 5601.5,-607.91 5814.5,-607.91 5814.5,-645.91"/>
<text text-anchor="middle" x="5708" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5708" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_norm2&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_up -->
<g id="edge590" class="edge">
<title>LLaMA_7B_S3_R2_L24_norm2&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_up</title>
<path fill="none" stroke="black" d="M5708,-717.77C5708,-699.51 5708,-675.08 5708,-656.3"/>
<polygon fill="black" stroke="black" points="5711.5,-656.26 5708,-646.26 5704.5,-656.26 5711.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_gate -->
<g id="node645" class="node">
<title>LLaMA_7B_S3_R2_L24_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-535.91 5601.5,-535.91 5601.5,-497.91 5814.5,-497.91 5814.5,-535.91"/>
<text text-anchor="middle" x="5708" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5708" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_gate -->
<g id="edge591" class="edge">
<title>LLaMA_7B_S3_R2_L24_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_gate</title>
<path fill="none" stroke="black" d="M5708,-607.59C5708,-590.73 5708,-565.47 5708,-546.06"/>
<polygon fill="black" stroke="black" points="5711.5,-545.96 5708,-535.96 5704.5,-545.96 5711.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_down -->
<g id="node646" class="node">
<title>LLaMA_7B_S3_R2_L24_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="5814.5,-425.91 5601.5,-425.91 5601.5,-387.91 5814.5,-387.91 5814.5,-425.91"/>
<text text-anchor="middle" x="5708" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5708" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_down -->
<g id="edge592" class="edge">
<title>LLaMA_7B_S3_R2_L24_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L24_ffn_down</title>
<path fill="none" stroke="black" d="M5708,-497.59C5708,-480.73 5708,-455.47 5708,-436.06"/>
<polygon fill="black" stroke="black" points="5711.5,-435.96 5708,-425.96 5704.5,-435.96 5711.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_ar2 -->
<g id="node647" class="node">
<title>LLaMA_7B_S3_R2_L24_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="5708" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="5708" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L24_ar2 -->
<g id="edge593" class="edge">
<title>LLaMA_7B_S3_R2_L24_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L24_ar2</title>
<path fill="none" stroke="black" d="M5708,-387.8C5708,-371.43 5708,-346.84 5708,-326.42"/>
<polygon fill="black" stroke="black" points="5711.5,-326.19 5708,-316.19 5704.5,-326.19 5711.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L24_res2 -->
<g id="node648" class="node">
<title>LLaMA_7B_S3_R2_L24_res2</title>
<polygon fill="lightyellow" stroke="black" points="5795.84,-190.17 5656.11,-190.17 5620.16,-154.17 5759.89,-154.17 5795.84,-190.17"/>
<text text-anchor="middle" x="5708" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L24_ar2&#45;&gt;LLaMA_7B_S3_R2_L24_res2 -->
<g id="edge594" class="edge">
<title>LLaMA_7B_S3_R2_L24_ar2&#45;&gt;LLaMA_7B_S3_R2_L24_res2</title>
<path fill="none" stroke="black" d="M5708,-261.97C5708,-243.6 5708,-219.05 5708,-200.42"/>
<polygon fill="black" stroke="black" points="5711.5,-200.23 5708,-190.23 5704.5,-200.23 5711.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_split -->
<g id="node649" class="node">
<title>LLaMA_7B_S3_R2_L25_split</title>
<polygon fill="orange" stroke="black" points="5276.53,-1499.13 4625.06,-1499.13 4457.47,-1423.13 5108.94,-1423.13 5276.53,-1499.13"/>
<text text-anchor="middle" x="4867" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="4867" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_norm1 -->
<g id="node650" class="node">
<title>LLaMA_7B_S3_R2_L25_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="4867" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4867" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_split&#45;&gt;LLaMA_7B_S3_R2_L25_norm1 -->
<g id="edge595" class="edge">
<title>LLaMA_7B_S3_R2_L25_split&#45;&gt;LLaMA_7B_S3_R2_L25_norm1</title>
<path fill="none" stroke="black" d="M4867,-1422.92C4867,-1403.71 4867,-1380.37 4867,-1361.33"/>
<polygon fill="black" stroke="black" points="4870.5,-1361.25 4867,-1351.25 4863.5,-1361.25 4870.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_qkv -->
<g id="node651" class="node">
<title>LLaMA_7B_S3_R2_L25_qkv</title>
<polygon fill="lightcoral" stroke="black" points="5013.5,-1225.39 4720.5,-1225.39 4720.5,-1187.39 5013.5,-1187.39 5013.5,-1225.39"/>
<text text-anchor="middle" x="4867" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="4867" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_norm1&#45;&gt;LLaMA_7B_S3_R2_L25_qkv -->
<g id="edge596" class="edge">
<title>LLaMA_7B_S3_R2_L25_norm1&#45;&gt;LLaMA_7B_S3_R2_L25_qkv</title>
<path fill="none" stroke="black" d="M4867,-1297.25C4867,-1278.99 4867,-1254.56 4867,-1235.78"/>
<polygon fill="black" stroke="black" points="4870.5,-1235.74 4867,-1225.74 4863.5,-1235.74 4870.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_attn -->
<g id="node652" class="node">
<title>LLaMA_7B_S3_R2_L25_attn</title>
<polygon fill="lightcoral" stroke="black" points="5013.5,-1115.39 4720.5,-1115.39 4720.5,-1077.39 5013.5,-1077.39 5013.5,-1115.39"/>
<text text-anchor="middle" x="4867" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="4867" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_qkv&#45;&gt;LLaMA_7B_S3_R2_L25_attn -->
<g id="edge597" class="edge">
<title>LLaMA_7B_S3_R2_L25_qkv&#45;&gt;LLaMA_7B_S3_R2_L25_attn</title>
<path fill="none" stroke="black" d="M4867,-1187.07C4867,-1170.21 4867,-1144.95 4867,-1125.54"/>
<polygon fill="black" stroke="black" points="4870.5,-1125.44 4867,-1115.44 4863.5,-1125.44 4870.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_ar1 -->
<g id="node653" class="node">
<title>LLaMA_7B_S3_R2_L25_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4867" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4867" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_attn&#45;&gt;LLaMA_7B_S3_R2_L25_ar1 -->
<g id="edge598" class="edge">
<title>LLaMA_7B_S3_R2_L25_attn&#45;&gt;LLaMA_7B_S3_R2_L25_ar1</title>
<path fill="none" stroke="black" d="M4867,-1077.28C4867,-1060.91 4867,-1036.32 4867,-1015.9"/>
<polygon fill="black" stroke="black" points="4870.5,-1015.67 4867,-1005.67 4863.5,-1015.67 4870.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_res1 -->
<g id="node654" class="node">
<title>LLaMA_7B_S3_R2_L25_res1</title>
<polygon fill="lightyellow" stroke="black" points="4954.84,-879.65 4815.11,-879.65 4779.16,-843.65 4918.89,-843.65 4954.84,-879.65"/>
<text text-anchor="middle" x="4867" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_ar1&#45;&gt;LLaMA_7B_S3_R2_L25_res1 -->
<g id="edge599" class="edge">
<title>LLaMA_7B_S3_R2_L25_ar1&#45;&gt;LLaMA_7B_S3_R2_L25_res1</title>
<path fill="none" stroke="black" d="M4867,-951.45C4867,-933.08 4867,-908.53 4867,-889.9"/>
<polygon fill="black" stroke="black" points="4870.5,-889.71 4867,-879.71 4863.5,-889.71 4870.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_norm2 -->
<g id="node655" class="node">
<title>LLaMA_7B_S3_R2_L25_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="4867" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="4867" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_res1&#45;&gt;LLaMA_7B_S3_R2_L25_norm2 -->
<g id="edge600" class="edge">
<title>LLaMA_7B_S3_R2_L25_res1&#45;&gt;LLaMA_7B_S3_R2_L25_norm2</title>
<path fill="none" stroke="black" d="M4867,-843.2C4867,-827.06 4867,-802.56 4867,-782.16"/>
<polygon fill="black" stroke="black" points="4870.5,-781.94 4867,-771.94 4863.5,-781.94 4870.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_up -->
<g id="node656" class="node">
<title>LLaMA_7B_S3_R2_L25_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-645.91 4760.5,-645.91 4760.5,-607.91 4973.5,-607.91 4973.5,-645.91"/>
<text text-anchor="middle" x="4867" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4867" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_norm2&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_up -->
<g id="edge601" class="edge">
<title>LLaMA_7B_S3_R2_L25_norm2&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_up</title>
<path fill="none" stroke="black" d="M4867,-717.77C4867,-699.51 4867,-675.08 4867,-656.3"/>
<polygon fill="black" stroke="black" points="4870.5,-656.26 4867,-646.26 4863.5,-656.26 4870.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_gate -->
<g id="node657" class="node">
<title>LLaMA_7B_S3_R2_L25_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-535.91 4760.5,-535.91 4760.5,-497.91 4973.5,-497.91 4973.5,-535.91"/>
<text text-anchor="middle" x="4867" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4867" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_gate -->
<g id="edge602" class="edge">
<title>LLaMA_7B_S3_R2_L25_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_gate</title>
<path fill="none" stroke="black" d="M4867,-607.59C4867,-590.73 4867,-565.47 4867,-546.06"/>
<polygon fill="black" stroke="black" points="4870.5,-545.96 4867,-535.96 4863.5,-545.96 4870.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_down -->
<g id="node658" class="node">
<title>LLaMA_7B_S3_R2_L25_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="4973.5,-425.91 4760.5,-425.91 4760.5,-387.91 4973.5,-387.91 4973.5,-425.91"/>
<text text-anchor="middle" x="4867" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4867" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_down -->
<g id="edge603" class="edge">
<title>LLaMA_7B_S3_R2_L25_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L25_ffn_down</title>
<path fill="none" stroke="black" d="M4867,-497.59C4867,-480.73 4867,-455.47 4867,-436.06"/>
<polygon fill="black" stroke="black" points="4870.5,-435.96 4867,-425.96 4863.5,-435.96 4870.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_ar2 -->
<g id="node659" class="node">
<title>LLaMA_7B_S3_R2_L25_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4867" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4867" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="4867" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L25_ar2 -->
<g id="edge604" class="edge">
<title>LLaMA_7B_S3_R2_L25_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L25_ar2</title>
<path fill="none" stroke="black" d="M4867,-387.8C4867,-371.43 4867,-346.84 4867,-326.42"/>
<polygon fill="black" stroke="black" points="4870.5,-326.19 4867,-316.19 4863.5,-326.19 4870.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L25_res2 -->
<g id="node660" class="node">
<title>LLaMA_7B_S3_R2_L25_res2</title>
<polygon fill="lightyellow" stroke="black" points="4954.84,-190.17 4815.11,-190.17 4779.16,-154.17 4918.89,-154.17 4954.84,-190.17"/>
<text text-anchor="middle" x="4867" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L25_ar2&#45;&gt;LLaMA_7B_S3_R2_L25_res2 -->
<g id="edge605" class="edge">
<title>LLaMA_7B_S3_R2_L25_ar2&#45;&gt;LLaMA_7B_S3_R2_L25_res2</title>
<path fill="none" stroke="black" d="M4867,-261.97C4867,-243.6 4867,-219.05 4867,-200.42"/>
<polygon fill="black" stroke="black" points="4870.5,-200.23 4867,-190.23 4863.5,-200.23 4870.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_split -->
<g id="node661" class="node">
<title>LLaMA_7B_S3_R2_L26_split</title>
<polygon fill="orange" stroke="black" points="4435.53,-1499.13 3784.06,-1499.13 3616.47,-1423.13 4267.94,-1423.13 4435.53,-1499.13"/>
<text text-anchor="middle" x="4026" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="4026" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_norm1 -->
<g id="node662" class="node">
<title>LLaMA_7B_S3_R2_L26_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="4026" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4026" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_split&#45;&gt;LLaMA_7B_S3_R2_L26_norm1 -->
<g id="edge606" class="edge">
<title>LLaMA_7B_S3_R2_L26_split&#45;&gt;LLaMA_7B_S3_R2_L26_norm1</title>
<path fill="none" stroke="black" d="M4026,-1422.92C4026,-1403.71 4026,-1380.37 4026,-1361.33"/>
<polygon fill="black" stroke="black" points="4029.5,-1361.25 4026,-1351.25 4022.5,-1361.25 4029.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_qkv -->
<g id="node663" class="node">
<title>LLaMA_7B_S3_R2_L26_qkv</title>
<polygon fill="lightcoral" stroke="black" points="4172.5,-1225.39 3879.5,-1225.39 3879.5,-1187.39 4172.5,-1187.39 4172.5,-1225.39"/>
<text text-anchor="middle" x="4026" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="4026" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_norm1&#45;&gt;LLaMA_7B_S3_R2_L26_qkv -->
<g id="edge607" class="edge">
<title>LLaMA_7B_S3_R2_L26_norm1&#45;&gt;LLaMA_7B_S3_R2_L26_qkv</title>
<path fill="none" stroke="black" d="M4026,-1297.25C4026,-1278.99 4026,-1254.56 4026,-1235.78"/>
<polygon fill="black" stroke="black" points="4029.5,-1235.74 4026,-1225.74 4022.5,-1235.74 4029.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_attn -->
<g id="node664" class="node">
<title>LLaMA_7B_S3_R2_L26_attn</title>
<polygon fill="lightcoral" stroke="black" points="4172.5,-1115.39 3879.5,-1115.39 3879.5,-1077.39 4172.5,-1077.39 4172.5,-1115.39"/>
<text text-anchor="middle" x="4026" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="4026" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_qkv&#45;&gt;LLaMA_7B_S3_R2_L26_attn -->
<g id="edge608" class="edge">
<title>LLaMA_7B_S3_R2_L26_qkv&#45;&gt;LLaMA_7B_S3_R2_L26_attn</title>
<path fill="none" stroke="black" d="M4026,-1187.07C4026,-1170.21 4026,-1144.95 4026,-1125.54"/>
<polygon fill="black" stroke="black" points="4029.5,-1125.44 4026,-1115.44 4022.5,-1125.44 4029.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_ar1 -->
<g id="node665" class="node">
<title>LLaMA_7B_S3_R2_L26_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4026" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4026" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_attn&#45;&gt;LLaMA_7B_S3_R2_L26_ar1 -->
<g id="edge609" class="edge">
<title>LLaMA_7B_S3_R2_L26_attn&#45;&gt;LLaMA_7B_S3_R2_L26_ar1</title>
<path fill="none" stroke="black" d="M4026,-1077.28C4026,-1060.91 4026,-1036.32 4026,-1015.9"/>
<polygon fill="black" stroke="black" points="4029.5,-1015.67 4026,-1005.67 4022.5,-1015.67 4029.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_res1 -->
<g id="node666" class="node">
<title>LLaMA_7B_S3_R2_L26_res1</title>
<polygon fill="lightyellow" stroke="black" points="4113.84,-879.65 3974.11,-879.65 3938.16,-843.65 4077.89,-843.65 4113.84,-879.65"/>
<text text-anchor="middle" x="4026" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_ar1&#45;&gt;LLaMA_7B_S3_R2_L26_res1 -->
<g id="edge610" class="edge">
<title>LLaMA_7B_S3_R2_L26_ar1&#45;&gt;LLaMA_7B_S3_R2_L26_res1</title>
<path fill="none" stroke="black" d="M4026,-951.45C4026,-933.08 4026,-908.53 4026,-889.9"/>
<polygon fill="black" stroke="black" points="4029.5,-889.71 4026,-879.71 4022.5,-889.71 4029.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_norm2 -->
<g id="node667" class="node">
<title>LLaMA_7B_S3_R2_L26_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="4026" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="4026" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_res1&#45;&gt;LLaMA_7B_S3_R2_L26_norm2 -->
<g id="edge611" class="edge">
<title>LLaMA_7B_S3_R2_L26_res1&#45;&gt;LLaMA_7B_S3_R2_L26_norm2</title>
<path fill="none" stroke="black" d="M4026,-843.2C4026,-827.06 4026,-802.56 4026,-782.16"/>
<polygon fill="black" stroke="black" points="4029.5,-781.94 4026,-771.94 4022.5,-781.94 4029.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_up -->
<g id="node668" class="node">
<title>LLaMA_7B_S3_R2_L26_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-645.91 3919.5,-645.91 3919.5,-607.91 4132.5,-607.91 4132.5,-645.91"/>
<text text-anchor="middle" x="4026" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4026" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_norm2&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_up -->
<g id="edge612" class="edge">
<title>LLaMA_7B_S3_R2_L26_norm2&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_up</title>
<path fill="none" stroke="black" d="M4026,-717.77C4026,-699.51 4026,-675.08 4026,-656.3"/>
<polygon fill="black" stroke="black" points="4029.5,-656.26 4026,-646.26 4022.5,-656.26 4029.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_gate -->
<g id="node669" class="node">
<title>LLaMA_7B_S3_R2_L26_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-535.91 3919.5,-535.91 3919.5,-497.91 4132.5,-497.91 4132.5,-535.91"/>
<text text-anchor="middle" x="4026" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="4026" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_gate -->
<g id="edge613" class="edge">
<title>LLaMA_7B_S3_R2_L26_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_gate</title>
<path fill="none" stroke="black" d="M4026,-607.59C4026,-590.73 4026,-565.47 4026,-546.06"/>
<polygon fill="black" stroke="black" points="4029.5,-545.96 4026,-535.96 4022.5,-545.96 4029.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_down -->
<g id="node670" class="node">
<title>LLaMA_7B_S3_R2_L26_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="4132.5,-425.91 3919.5,-425.91 3919.5,-387.91 4132.5,-387.91 4132.5,-425.91"/>
<text text-anchor="middle" x="4026" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4026" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_down -->
<g id="edge614" class="edge">
<title>LLaMA_7B_S3_R2_L26_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L26_ffn_down</title>
<path fill="none" stroke="black" d="M4026,-497.59C4026,-480.73 4026,-455.47 4026,-436.06"/>
<polygon fill="black" stroke="black" points="4029.5,-435.96 4026,-425.96 4022.5,-435.96 4029.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_ar2 -->
<g id="node671" class="node">
<title>LLaMA_7B_S3_R2_L26_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="4026" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="4026" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="4026" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L26_ar2 -->
<g id="edge615" class="edge">
<title>LLaMA_7B_S3_R2_L26_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L26_ar2</title>
<path fill="none" stroke="black" d="M4026,-387.8C4026,-371.43 4026,-346.84 4026,-326.42"/>
<polygon fill="black" stroke="black" points="4029.5,-326.19 4026,-316.19 4022.5,-326.19 4029.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L26_res2 -->
<g id="node672" class="node">
<title>LLaMA_7B_S3_R2_L26_res2</title>
<polygon fill="lightyellow" stroke="black" points="4113.84,-190.17 3974.11,-190.17 3938.16,-154.17 4077.89,-154.17 4113.84,-190.17"/>
<text text-anchor="middle" x="4026" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L26_ar2&#45;&gt;LLaMA_7B_S3_R2_L26_res2 -->
<g id="edge616" class="edge">
<title>LLaMA_7B_S3_R2_L26_ar2&#45;&gt;LLaMA_7B_S3_R2_L26_res2</title>
<path fill="none" stroke="black" d="M4026,-261.97C4026,-243.6 4026,-219.05 4026,-200.42"/>
<polygon fill="black" stroke="black" points="4029.5,-200.23 4026,-190.23 4022.5,-200.23 4029.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_split -->
<g id="node673" class="node">
<title>LLaMA_7B_S3_R2_L27_split</title>
<polygon fill="orange" stroke="black" points="3594.53,-1499.13 2943.06,-1499.13 2775.47,-1423.13 3426.94,-1423.13 3594.53,-1499.13"/>
<text text-anchor="middle" x="3185" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="3185" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_norm1 -->
<g id="node674" class="node">
<title>LLaMA_7B_S3_R2_L27_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="3185" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3185" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_split&#45;&gt;LLaMA_7B_S3_R2_L27_norm1 -->
<g id="edge617" class="edge">
<title>LLaMA_7B_S3_R2_L27_split&#45;&gt;LLaMA_7B_S3_R2_L27_norm1</title>
<path fill="none" stroke="black" d="M3185,-1422.92C3185,-1403.71 3185,-1380.37 3185,-1361.33"/>
<polygon fill="black" stroke="black" points="3188.5,-1361.25 3185,-1351.25 3181.5,-1361.25 3188.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_qkv -->
<g id="node675" class="node">
<title>LLaMA_7B_S3_R2_L27_qkv</title>
<polygon fill="lightcoral" stroke="black" points="3331.5,-1225.39 3038.5,-1225.39 3038.5,-1187.39 3331.5,-1187.39 3331.5,-1225.39"/>
<text text-anchor="middle" x="3185" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="3185" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_norm1&#45;&gt;LLaMA_7B_S3_R2_L27_qkv -->
<g id="edge618" class="edge">
<title>LLaMA_7B_S3_R2_L27_norm1&#45;&gt;LLaMA_7B_S3_R2_L27_qkv</title>
<path fill="none" stroke="black" d="M3185,-1297.25C3185,-1278.99 3185,-1254.56 3185,-1235.78"/>
<polygon fill="black" stroke="black" points="3188.5,-1235.74 3185,-1225.74 3181.5,-1235.74 3188.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_attn -->
<g id="node676" class="node">
<title>LLaMA_7B_S3_R2_L27_attn</title>
<polygon fill="lightcoral" stroke="black" points="3331.5,-1115.39 3038.5,-1115.39 3038.5,-1077.39 3331.5,-1077.39 3331.5,-1115.39"/>
<text text-anchor="middle" x="3185" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="3185" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_qkv&#45;&gt;LLaMA_7B_S3_R2_L27_attn -->
<g id="edge619" class="edge">
<title>LLaMA_7B_S3_R2_L27_qkv&#45;&gt;LLaMA_7B_S3_R2_L27_attn</title>
<path fill="none" stroke="black" d="M3185,-1187.07C3185,-1170.21 3185,-1144.95 3185,-1125.54"/>
<polygon fill="black" stroke="black" points="3188.5,-1125.44 3185,-1115.44 3181.5,-1125.44 3188.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_ar1 -->
<g id="node677" class="node">
<title>LLaMA_7B_S3_R2_L27_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3185" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3185" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_attn&#45;&gt;LLaMA_7B_S3_R2_L27_ar1 -->
<g id="edge620" class="edge">
<title>LLaMA_7B_S3_R2_L27_attn&#45;&gt;LLaMA_7B_S3_R2_L27_ar1</title>
<path fill="none" stroke="black" d="M3185,-1077.28C3185,-1060.91 3185,-1036.32 3185,-1015.9"/>
<polygon fill="black" stroke="black" points="3188.5,-1015.67 3185,-1005.67 3181.5,-1015.67 3188.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_res1 -->
<g id="node678" class="node">
<title>LLaMA_7B_S3_R2_L27_res1</title>
<polygon fill="lightyellow" stroke="black" points="3272.84,-879.65 3133.11,-879.65 3097.16,-843.65 3236.89,-843.65 3272.84,-879.65"/>
<text text-anchor="middle" x="3185" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_ar1&#45;&gt;LLaMA_7B_S3_R2_L27_res1 -->
<g id="edge621" class="edge">
<title>LLaMA_7B_S3_R2_L27_ar1&#45;&gt;LLaMA_7B_S3_R2_L27_res1</title>
<path fill="none" stroke="black" d="M3185,-951.45C3185,-933.08 3185,-908.53 3185,-889.9"/>
<polygon fill="black" stroke="black" points="3188.5,-889.71 3185,-879.71 3181.5,-889.71 3188.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_norm2 -->
<g id="node679" class="node">
<title>LLaMA_7B_S3_R2_L27_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="3185" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="3185" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_res1&#45;&gt;LLaMA_7B_S3_R2_L27_norm2 -->
<g id="edge622" class="edge">
<title>LLaMA_7B_S3_R2_L27_res1&#45;&gt;LLaMA_7B_S3_R2_L27_norm2</title>
<path fill="none" stroke="black" d="M3185,-843.2C3185,-827.06 3185,-802.56 3185,-782.16"/>
<polygon fill="black" stroke="black" points="3188.5,-781.94 3185,-771.94 3181.5,-781.94 3188.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_up -->
<g id="node680" class="node">
<title>LLaMA_7B_S3_R2_L27_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-645.91 3078.5,-645.91 3078.5,-607.91 3291.5,-607.91 3291.5,-645.91"/>
<text text-anchor="middle" x="3185" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3185" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_norm2&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_up -->
<g id="edge623" class="edge">
<title>LLaMA_7B_S3_R2_L27_norm2&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_up</title>
<path fill="none" stroke="black" d="M3185,-717.77C3185,-699.51 3185,-675.08 3185,-656.3"/>
<polygon fill="black" stroke="black" points="3188.5,-656.26 3185,-646.26 3181.5,-656.26 3188.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_gate -->
<g id="node681" class="node">
<title>LLaMA_7B_S3_R2_L27_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-535.91 3078.5,-535.91 3078.5,-497.91 3291.5,-497.91 3291.5,-535.91"/>
<text text-anchor="middle" x="3185" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="3185" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_gate -->
<g id="edge624" class="edge">
<title>LLaMA_7B_S3_R2_L27_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_gate</title>
<path fill="none" stroke="black" d="M3185,-607.59C3185,-590.73 3185,-565.47 3185,-546.06"/>
<polygon fill="black" stroke="black" points="3188.5,-545.96 3185,-535.96 3181.5,-545.96 3188.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_down -->
<g id="node682" class="node">
<title>LLaMA_7B_S3_R2_L27_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="3291.5,-425.91 3078.5,-425.91 3078.5,-387.91 3291.5,-387.91 3291.5,-425.91"/>
<text text-anchor="middle" x="3185" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3185" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_down -->
<g id="edge625" class="edge">
<title>LLaMA_7B_S3_R2_L27_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L27_ffn_down</title>
<path fill="none" stroke="black" d="M3185,-497.59C3185,-480.73 3185,-455.47 3185,-436.06"/>
<polygon fill="black" stroke="black" points="3188.5,-435.96 3185,-425.96 3181.5,-435.96 3188.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_ar2 -->
<g id="node683" class="node">
<title>LLaMA_7B_S3_R2_L27_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="3185" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3185" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="3185" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L27_ar2 -->
<g id="edge626" class="edge">
<title>LLaMA_7B_S3_R2_L27_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L27_ar2</title>
<path fill="none" stroke="black" d="M3185,-387.8C3185,-371.43 3185,-346.84 3185,-326.42"/>
<polygon fill="black" stroke="black" points="3188.5,-326.19 3185,-316.19 3181.5,-326.19 3188.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L27_res2 -->
<g id="node684" class="node">
<title>LLaMA_7B_S3_R2_L27_res2</title>
<polygon fill="lightyellow" stroke="black" points="3272.84,-190.17 3133.11,-190.17 3097.16,-154.17 3236.89,-154.17 3272.84,-190.17"/>
<text text-anchor="middle" x="3185" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L27_ar2&#45;&gt;LLaMA_7B_S3_R2_L27_res2 -->
<g id="edge627" class="edge">
<title>LLaMA_7B_S3_R2_L27_ar2&#45;&gt;LLaMA_7B_S3_R2_L27_res2</title>
<path fill="none" stroke="black" d="M3185,-261.97C3185,-243.6 3185,-219.05 3185,-200.42"/>
<polygon fill="black" stroke="black" points="3188.5,-200.23 3185,-190.23 3181.5,-200.23 3188.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_split -->
<g id="node685" class="node">
<title>LLaMA_7B_S3_R2_L28_split</title>
<polygon fill="orange" stroke="black" points="2753.53,-1499.13 2102.06,-1499.13 1934.47,-1423.13 2585.94,-1423.13 2753.53,-1499.13"/>
<text text-anchor="middle" x="2344" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="2344" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_norm1 -->
<g id="node686" class="node">
<title>LLaMA_7B_S3_R2_L28_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="2344" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2344" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_split&#45;&gt;LLaMA_7B_S3_R2_L28_norm1 -->
<g id="edge628" class="edge">
<title>LLaMA_7B_S3_R2_L28_split&#45;&gt;LLaMA_7B_S3_R2_L28_norm1</title>
<path fill="none" stroke="black" d="M2344,-1422.92C2344,-1403.71 2344,-1380.37 2344,-1361.33"/>
<polygon fill="black" stroke="black" points="2347.5,-1361.25 2344,-1351.25 2340.5,-1361.25 2347.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_qkv -->
<g id="node687" class="node">
<title>LLaMA_7B_S3_R2_L28_qkv</title>
<polygon fill="lightcoral" stroke="black" points="2490.5,-1225.39 2197.5,-1225.39 2197.5,-1187.39 2490.5,-1187.39 2490.5,-1225.39"/>
<text text-anchor="middle" x="2344" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="2344" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_norm1&#45;&gt;LLaMA_7B_S3_R2_L28_qkv -->
<g id="edge629" class="edge">
<title>LLaMA_7B_S3_R2_L28_norm1&#45;&gt;LLaMA_7B_S3_R2_L28_qkv</title>
<path fill="none" stroke="black" d="M2344,-1297.25C2344,-1278.99 2344,-1254.56 2344,-1235.78"/>
<polygon fill="black" stroke="black" points="2347.5,-1235.74 2344,-1225.74 2340.5,-1235.74 2347.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_attn -->
<g id="node688" class="node">
<title>LLaMA_7B_S3_R2_L28_attn</title>
<polygon fill="lightcoral" stroke="black" points="2490.5,-1115.39 2197.5,-1115.39 2197.5,-1077.39 2490.5,-1077.39 2490.5,-1115.39"/>
<text text-anchor="middle" x="2344" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="2344" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_qkv&#45;&gt;LLaMA_7B_S3_R2_L28_attn -->
<g id="edge630" class="edge">
<title>LLaMA_7B_S3_R2_L28_qkv&#45;&gt;LLaMA_7B_S3_R2_L28_attn</title>
<path fill="none" stroke="black" d="M2344,-1187.07C2344,-1170.21 2344,-1144.95 2344,-1125.54"/>
<polygon fill="black" stroke="black" points="2347.5,-1125.44 2344,-1115.44 2340.5,-1125.44 2347.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_ar1 -->
<g id="node689" class="node">
<title>LLaMA_7B_S3_R2_L28_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2344" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2344" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_attn&#45;&gt;LLaMA_7B_S3_R2_L28_ar1 -->
<g id="edge631" class="edge">
<title>LLaMA_7B_S3_R2_L28_attn&#45;&gt;LLaMA_7B_S3_R2_L28_ar1</title>
<path fill="none" stroke="black" d="M2344,-1077.28C2344,-1060.91 2344,-1036.32 2344,-1015.9"/>
<polygon fill="black" stroke="black" points="2347.5,-1015.67 2344,-1005.67 2340.5,-1015.67 2347.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_res1 -->
<g id="node690" class="node">
<title>LLaMA_7B_S3_R2_L28_res1</title>
<polygon fill="lightyellow" stroke="black" points="2431.84,-879.65 2292.11,-879.65 2256.16,-843.65 2395.89,-843.65 2431.84,-879.65"/>
<text text-anchor="middle" x="2344" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_ar1&#45;&gt;LLaMA_7B_S3_R2_L28_res1 -->
<g id="edge632" class="edge">
<title>LLaMA_7B_S3_R2_L28_ar1&#45;&gt;LLaMA_7B_S3_R2_L28_res1</title>
<path fill="none" stroke="black" d="M2344,-951.45C2344,-933.08 2344,-908.53 2344,-889.9"/>
<polygon fill="black" stroke="black" points="2347.5,-889.71 2344,-879.71 2340.5,-889.71 2347.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_norm2 -->
<g id="node691" class="node">
<title>LLaMA_7B_S3_R2_L28_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="2344" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="2344" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_res1&#45;&gt;LLaMA_7B_S3_R2_L28_norm2 -->
<g id="edge633" class="edge">
<title>LLaMA_7B_S3_R2_L28_res1&#45;&gt;LLaMA_7B_S3_R2_L28_norm2</title>
<path fill="none" stroke="black" d="M2344,-843.2C2344,-827.06 2344,-802.56 2344,-782.16"/>
<polygon fill="black" stroke="black" points="2347.5,-781.94 2344,-771.94 2340.5,-781.94 2347.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_up -->
<g id="node692" class="node">
<title>LLaMA_7B_S3_R2_L28_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-645.91 2237.5,-645.91 2237.5,-607.91 2450.5,-607.91 2450.5,-645.91"/>
<text text-anchor="middle" x="2344" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2344" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_norm2&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_up -->
<g id="edge634" class="edge">
<title>LLaMA_7B_S3_R2_L28_norm2&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_up</title>
<path fill="none" stroke="black" d="M2344,-717.77C2344,-699.51 2344,-675.08 2344,-656.3"/>
<polygon fill="black" stroke="black" points="2347.5,-656.26 2344,-646.26 2340.5,-656.26 2347.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_gate -->
<g id="node693" class="node">
<title>LLaMA_7B_S3_R2_L28_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-535.91 2237.5,-535.91 2237.5,-497.91 2450.5,-497.91 2450.5,-535.91"/>
<text text-anchor="middle" x="2344" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2344" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_gate -->
<g id="edge635" class="edge">
<title>LLaMA_7B_S3_R2_L28_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_gate</title>
<path fill="none" stroke="black" d="M2344,-607.59C2344,-590.73 2344,-565.47 2344,-546.06"/>
<polygon fill="black" stroke="black" points="2347.5,-545.96 2344,-535.96 2340.5,-545.96 2347.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_down -->
<g id="node694" class="node">
<title>LLaMA_7B_S3_R2_L28_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="2450.5,-425.91 2237.5,-425.91 2237.5,-387.91 2450.5,-387.91 2450.5,-425.91"/>
<text text-anchor="middle" x="2344" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2344" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_down -->
<g id="edge636" class="edge">
<title>LLaMA_7B_S3_R2_L28_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L28_ffn_down</title>
<path fill="none" stroke="black" d="M2344,-497.59C2344,-480.73 2344,-455.47 2344,-436.06"/>
<polygon fill="black" stroke="black" points="2347.5,-435.96 2344,-425.96 2340.5,-435.96 2347.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_ar2 -->
<g id="node695" class="node">
<title>LLaMA_7B_S3_R2_L28_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="2344" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="2344" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="2344" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L28_ar2 -->
<g id="edge637" class="edge">
<title>LLaMA_7B_S3_R2_L28_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L28_ar2</title>
<path fill="none" stroke="black" d="M2344,-387.8C2344,-371.43 2344,-346.84 2344,-326.42"/>
<polygon fill="black" stroke="black" points="2347.5,-326.19 2344,-316.19 2340.5,-326.19 2347.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L28_res2 -->
<g id="node696" class="node">
<title>LLaMA_7B_S3_R2_L28_res2</title>
<polygon fill="lightyellow" stroke="black" points="2431.84,-190.17 2292.11,-190.17 2256.16,-154.17 2395.89,-154.17 2431.84,-190.17"/>
<text text-anchor="middle" x="2344" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L28_ar2&#45;&gt;LLaMA_7B_S3_R2_L28_res2 -->
<g id="edge638" class="edge">
<title>LLaMA_7B_S3_R2_L28_ar2&#45;&gt;LLaMA_7B_S3_R2_L28_res2</title>
<path fill="none" stroke="black" d="M2344,-261.97C2344,-243.6 2344,-219.05 2344,-200.42"/>
<polygon fill="black" stroke="black" points="2347.5,-200.23 2344,-190.23 2340.5,-200.23 2347.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_split -->
<g id="node697" class="node">
<title>LLaMA_7B_S3_R2_L29_split</title>
<polygon fill="orange" stroke="black" points="1912.53,-1499.13 1261.06,-1499.13 1093.47,-1423.13 1744.94,-1423.13 1912.53,-1499.13"/>
<text text-anchor="middle" x="1503" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="1503" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_norm1 -->
<g id="node698" class="node">
<title>LLaMA_7B_S3_R2_L29_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="1503" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1503" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_split&#45;&gt;LLaMA_7B_S3_R2_L29_norm1 -->
<g id="edge639" class="edge">
<title>LLaMA_7B_S3_R2_L29_split&#45;&gt;LLaMA_7B_S3_R2_L29_norm1</title>
<path fill="none" stroke="black" d="M1503,-1422.92C1503,-1403.71 1503,-1380.37 1503,-1361.33"/>
<polygon fill="black" stroke="black" points="1506.5,-1361.25 1503,-1351.25 1499.5,-1361.25 1506.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_qkv -->
<g id="node699" class="node">
<title>LLaMA_7B_S3_R2_L29_qkv</title>
<polygon fill="lightcoral" stroke="black" points="1649.5,-1225.39 1356.5,-1225.39 1356.5,-1187.39 1649.5,-1187.39 1649.5,-1225.39"/>
<text text-anchor="middle" x="1503" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="1503" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_norm1&#45;&gt;LLaMA_7B_S3_R2_L29_qkv -->
<g id="edge640" class="edge">
<title>LLaMA_7B_S3_R2_L29_norm1&#45;&gt;LLaMA_7B_S3_R2_L29_qkv</title>
<path fill="none" stroke="black" d="M1503,-1297.25C1503,-1278.99 1503,-1254.56 1503,-1235.78"/>
<polygon fill="black" stroke="black" points="1506.5,-1235.74 1503,-1225.74 1499.5,-1235.74 1506.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_attn -->
<g id="node700" class="node">
<title>LLaMA_7B_S3_R2_L29_attn</title>
<polygon fill="lightcoral" stroke="black" points="1649.5,-1115.39 1356.5,-1115.39 1356.5,-1077.39 1649.5,-1077.39 1649.5,-1115.39"/>
<text text-anchor="middle" x="1503" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1503" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_qkv&#45;&gt;LLaMA_7B_S3_R2_L29_attn -->
<g id="edge641" class="edge">
<title>LLaMA_7B_S3_R2_L29_qkv&#45;&gt;LLaMA_7B_S3_R2_L29_attn</title>
<path fill="none" stroke="black" d="M1503,-1187.07C1503,-1170.21 1503,-1144.95 1503,-1125.54"/>
<polygon fill="black" stroke="black" points="1506.5,-1125.44 1503,-1115.44 1499.5,-1125.44 1506.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_ar1 -->
<g id="node701" class="node">
<title>LLaMA_7B_S3_R2_L29_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1503" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1503" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_attn&#45;&gt;LLaMA_7B_S3_R2_L29_ar1 -->
<g id="edge642" class="edge">
<title>LLaMA_7B_S3_R2_L29_attn&#45;&gt;LLaMA_7B_S3_R2_L29_ar1</title>
<path fill="none" stroke="black" d="M1503,-1077.28C1503,-1060.91 1503,-1036.32 1503,-1015.9"/>
<polygon fill="black" stroke="black" points="1506.5,-1015.67 1503,-1005.67 1499.5,-1015.67 1506.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_res1 -->
<g id="node702" class="node">
<title>LLaMA_7B_S3_R2_L29_res1</title>
<polygon fill="lightyellow" stroke="black" points="1590.84,-879.65 1451.11,-879.65 1415.16,-843.65 1554.89,-843.65 1590.84,-879.65"/>
<text text-anchor="middle" x="1503" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_ar1&#45;&gt;LLaMA_7B_S3_R2_L29_res1 -->
<g id="edge643" class="edge">
<title>LLaMA_7B_S3_R2_L29_ar1&#45;&gt;LLaMA_7B_S3_R2_L29_res1</title>
<path fill="none" stroke="black" d="M1503,-951.45C1503,-933.08 1503,-908.53 1503,-889.9"/>
<polygon fill="black" stroke="black" points="1506.5,-889.71 1503,-879.71 1499.5,-889.71 1506.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_norm2 -->
<g id="node703" class="node">
<title>LLaMA_7B_S3_R2_L29_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="1503" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1503" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_res1&#45;&gt;LLaMA_7B_S3_R2_L29_norm2 -->
<g id="edge644" class="edge">
<title>LLaMA_7B_S3_R2_L29_res1&#45;&gt;LLaMA_7B_S3_R2_L29_norm2</title>
<path fill="none" stroke="black" d="M1503,-843.2C1503,-827.06 1503,-802.56 1503,-782.16"/>
<polygon fill="black" stroke="black" points="1506.5,-781.94 1503,-771.94 1499.5,-781.94 1506.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_up -->
<g id="node704" class="node">
<title>LLaMA_7B_S3_R2_L29_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-645.91 1396.5,-645.91 1396.5,-607.91 1609.5,-607.91 1609.5,-645.91"/>
<text text-anchor="middle" x="1503" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1503" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_norm2&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_up -->
<g id="edge645" class="edge">
<title>LLaMA_7B_S3_R2_L29_norm2&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_up</title>
<path fill="none" stroke="black" d="M1503,-717.77C1503,-699.51 1503,-675.08 1503,-656.3"/>
<polygon fill="black" stroke="black" points="1506.5,-656.26 1503,-646.26 1499.5,-656.26 1506.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_gate -->
<g id="node705" class="node">
<title>LLaMA_7B_S3_R2_L29_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-535.91 1396.5,-535.91 1396.5,-497.91 1609.5,-497.91 1609.5,-535.91"/>
<text text-anchor="middle" x="1503" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1503" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_gate -->
<g id="edge646" class="edge">
<title>LLaMA_7B_S3_R2_L29_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_gate</title>
<path fill="none" stroke="black" d="M1503,-607.59C1503,-590.73 1503,-565.47 1503,-546.06"/>
<polygon fill="black" stroke="black" points="1506.5,-545.96 1503,-535.96 1499.5,-545.96 1506.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_down -->
<g id="node706" class="node">
<title>LLaMA_7B_S3_R2_L29_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="1609.5,-425.91 1396.5,-425.91 1396.5,-387.91 1609.5,-387.91 1609.5,-425.91"/>
<text text-anchor="middle" x="1503" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1503" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_down -->
<g id="edge647" class="edge">
<title>LLaMA_7B_S3_R2_L29_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L29_ffn_down</title>
<path fill="none" stroke="black" d="M1503,-497.59C1503,-480.73 1503,-455.47 1503,-436.06"/>
<polygon fill="black" stroke="black" points="1506.5,-435.96 1503,-425.96 1499.5,-435.96 1506.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_ar2 -->
<g id="node707" class="node">
<title>LLaMA_7B_S3_R2_L29_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="1503" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="1503" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L29_ar2 -->
<g id="edge648" class="edge">
<title>LLaMA_7B_S3_R2_L29_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L29_ar2</title>
<path fill="none" stroke="black" d="M1503,-387.8C1503,-371.43 1503,-346.84 1503,-326.42"/>
<polygon fill="black" stroke="black" points="1506.5,-326.19 1503,-316.19 1499.5,-326.19 1506.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L29_res2 -->
<g id="node708" class="node">
<title>LLaMA_7B_S3_R2_L29_res2</title>
<polygon fill="lightyellow" stroke="black" points="1590.84,-190.17 1451.11,-190.17 1415.16,-154.17 1554.89,-154.17 1590.84,-190.17"/>
<text text-anchor="middle" x="1503" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L29_ar2&#45;&gt;LLaMA_7B_S3_R2_L29_res2 -->
<g id="edge649" class="edge">
<title>LLaMA_7B_S3_R2_L29_ar2&#45;&gt;LLaMA_7B_S3_R2_L29_res2</title>
<path fill="none" stroke="black" d="M1503,-261.97C1503,-243.6 1503,-219.05 1503,-200.42"/>
<polygon fill="black" stroke="black" points="1506.5,-200.23 1503,-190.23 1499.5,-200.23 1506.5,-200.23"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_split -->
<g id="node709" class="node">
<title>LLaMA_7B_S3_R2_L30_split</title>
<polygon fill="orange" stroke="black" points="1071.53,-1499.13 420.06,-1499.13 252.47,-1423.13 903.94,-1423.13 1071.53,-1499.13"/>
<text text-anchor="middle" x="662" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="662" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, hidden=4096]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_norm1 -->
<g id="node710" class="node">
<title>LLaMA_7B_S3_R2_L30_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="662" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="662" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="662" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_split&#45;&gt;LLaMA_7B_S3_R2_L30_norm1 -->
<g id="edge650" class="edge">
<title>LLaMA_7B_S3_R2_L30_split&#45;&gt;LLaMA_7B_S3_R2_L30_norm1</title>
<path fill="none" stroke="black" d="M662,-1422.92C662,-1403.71 662,-1380.37 662,-1361.33"/>
<polygon fill="black" stroke="black" points="665.5,-1361.25 662,-1351.25 658.5,-1361.25 665.5,-1361.25"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_qkv -->
<g id="node711" class="node">
<title>LLaMA_7B_S3_R2_L30_qkv</title>
<polygon fill="lightcoral" stroke="black" points="808.5,-1225.39 515.5,-1225.39 515.5,-1187.39 808.5,-1187.39 808.5,-1225.39"/>
<text text-anchor="middle" x="662" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="662" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=2048]→[heads=16, dim=128]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_norm1&#45;&gt;LLaMA_7B_S3_R2_L30_qkv -->
<g id="edge651" class="edge">
<title>LLaMA_7B_S3_R2_L30_norm1&#45;&gt;LLaMA_7B_S3_R2_L30_qkv</title>
<path fill="none" stroke="black" d="M662,-1297.25C662,-1278.99 662,-1254.56 662,-1235.78"/>
<polygon fill="black" stroke="black" points="665.5,-1235.74 662,-1225.74 658.5,-1235.74 665.5,-1235.74"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_attn -->
<g id="node712" class="node">
<title>LLaMA_7B_S3_R2_L30_attn</title>
<polygon fill="lightcoral" stroke="black" points="808.5,-1115.39 515.5,-1115.39 515.5,-1077.39 808.5,-1077.39 808.5,-1115.39"/>
<text text-anchor="middle" x="662" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="662" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=16, dim=128]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_qkv&#45;&gt;LLaMA_7B_S3_R2_L30_attn -->
<g id="edge652" class="edge">
<title>LLaMA_7B_S3_R2_L30_qkv&#45;&gt;LLaMA_7B_S3_R2_L30_attn</title>
<path fill="none" stroke="black" d="M662,-1187.07C662,-1170.21 662,-1144.95 662,-1125.54"/>
<polygon fill="black" stroke="black" points="665.5,-1125.44 662,-1115.44 658.5,-1125.44 665.5,-1125.44"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_ar1 -->
<g id="node713" class="node">
<title>LLaMA_7B_S3_R2_L30_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="662" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="662" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="662" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_attn&#45;&gt;LLaMA_7B_S3_R2_L30_ar1 -->
<g id="edge653" class="edge">
<title>LLaMA_7B_S3_R2_L30_attn&#45;&gt;LLaMA_7B_S3_R2_L30_ar1</title>
<path fill="none" stroke="black" d="M662,-1077.28C662,-1060.91 662,-1036.32 662,-1015.9"/>
<polygon fill="black" stroke="black" points="665.5,-1015.67 662,-1005.67 658.5,-1015.67 665.5,-1015.67"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_res1 -->
<g id="node714" class="node">
<title>LLaMA_7B_S3_R2_L30_res1</title>
<polygon fill="lightyellow" stroke="black" points="749.84,-879.65 610.11,-879.65 574.16,-843.65 713.89,-843.65 749.84,-879.65"/>
<text text-anchor="middle" x="662" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_ar1&#45;&gt;LLaMA_7B_S3_R2_L30_res1 -->
<g id="edge654" class="edge">
<title>LLaMA_7B_S3_R2_L30_ar1&#45;&gt;LLaMA_7B_S3_R2_L30_res1</title>
<path fill="none" stroke="black" d="M662,-951.45C662,-933.08 662,-908.53 662,-889.9"/>
<polygon fill="black" stroke="black" points="665.5,-889.71 662,-879.71 658.5,-889.71 665.5,-889.71"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_norm2 -->
<g id="node715" class="node">
<title>LLaMA_7B_S3_R2_L30_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="662" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="662" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="662" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_res1&#45;&gt;LLaMA_7B_S3_R2_L30_norm2 -->
<g id="edge655" class="edge">
<title>LLaMA_7B_S3_R2_L30_res1&#45;&gt;LLaMA_7B_S3_R2_L30_norm2</title>
<path fill="none" stroke="black" d="M662,-843.2C662,-827.06 662,-802.56 662,-782.16"/>
<polygon fill="black" stroke="black" points="665.5,-781.94 662,-771.94 658.5,-781.94 665.5,-781.94"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_up -->
<g id="node716" class="node">
<title>LLaMA_7B_S3_R2_L30_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="768.5,-645.91 555.5,-645.91 555.5,-607.91 768.5,-607.91 768.5,-645.91"/>
<text text-anchor="middle" x="662" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="662" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_norm2&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_up -->
<g id="edge656" class="edge">
<title>LLaMA_7B_S3_R2_L30_norm2&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_up</title>
<path fill="none" stroke="black" d="M662,-717.77C662,-699.51 662,-675.08 662,-656.3"/>
<polygon fill="black" stroke="black" points="665.5,-656.26 662,-646.26 658.5,-656.26 665.5,-656.26"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_gate -->
<g id="node717" class="node">
<title>LLaMA_7B_S3_R2_L30_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="768.5,-535.91 555.5,-535.91 555.5,-497.91 768.5,-497.91 768.5,-535.91"/>
<text text-anchor="middle" x="662" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="662" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=2048]→[ffn=5504]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_gate -->
<g id="edge657" class="edge">
<title>LLaMA_7B_S3_R2_L30_ffn_up&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_gate</title>
<path fill="none" stroke="black" d="M662,-607.59C662,-590.73 662,-565.47 662,-546.06"/>
<polygon fill="black" stroke="black" points="665.5,-545.96 662,-535.96 658.5,-545.96 665.5,-545.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_down -->
<g id="node718" class="node">
<title>LLaMA_7B_S3_R2_L30_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="768.5,-425.91 555.5,-425.91 555.5,-387.91 768.5,-387.91 768.5,-425.91"/>
<text text-anchor="middle" x="662" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="662" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=5504]→[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_down -->
<g id="edge658" class="edge">
<title>LLaMA_7B_S3_R2_L30_ffn_gate&#45;&gt;LLaMA_7B_S3_R2_L30_ffn_down</title>
<path fill="none" stroke="black" d="M662,-497.59C662,-480.73 662,-455.47 662,-436.06"/>
<polygon fill="black" stroke="black" points="665.5,-435.96 662,-425.96 658.5,-435.96 665.5,-435.96"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_ar2 -->
<g id="node719" class="node">
<title>LLaMA_7B_S3_R2_L30_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="662" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="662" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="662" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=2048]</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L30_ar2 -->
<g id="edge659" class="edge">
<title>LLaMA_7B_S3_R2_L30_ffn_down&#45;&gt;LLaMA_7B_S3_R2_L30_ar2</title>
<path fill="none" stroke="black" d="M662,-387.8C662,-371.43 662,-346.84 662,-326.42"/>
<polygon fill="black" stroke="black" points="665.5,-326.19 662,-316.19 658.5,-326.19 665.5,-326.19"/>
</g>
<!-- LLaMA_7B_S3_R2_L30_res2 -->
<g id="node720" class="node">
<title>LLaMA_7B_S3_R2_L30_res2</title>
<polygon fill="lightyellow" stroke="black" points="749.84,-190.17 610.11,-190.17 574.16,-154.17 713.89,-154.17 749.84,-190.17"/>
<text text-anchor="middle" x="662" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- LLaMA_7B_S3_R2_L30_ar2&#45;&gt;LLaMA_7B_S3_R2_L30_res2 -->
<g id="edge660" class="edge">
<title>LLaMA_7B_S3_R2_L30_ar2&#45;&gt;LLaMA_7B_S3_R2_L30_res2</title>
<path fill="none" stroke="black" d="M662,-261.97C662,-243.6 662,-219.05 662,-200.42"/>
<polygon fill="black" stroke="black" points="665.5,-200.23 662,-190.23 658.5,-200.23 665.5,-200.23"/>
</g>
<!-- LLaMA_7B_comm_1_2&#45;&gt;LLaMA_7B_S2_R1_L11_split -->
<g id="edge662" class="edge">
<title>LLaMA_7B_comm_1_2&#45;&gt;LLaMA_7B_S2_R1_L11_split</title>
<path fill="none" stroke="black" d="M8796.65,-3227.16C9967.99,-3224.93 16034.95,-3211.99 16224,-3183.04 16335.26,-3166.01 16457.81,-3125.75 16541.66,-3094.7"/>
<polygon fill="black" stroke="black" points="16543.03,-3097.93 16551.18,-3091.15 16540.58,-3091.37 16543.03,-3097.93"/>
</g>
<!-- LLaMA_7B_comm_1_2&#45;&gt;LLaMA_7B_S2_R2_L11_split -->
<g id="edge664" class="edge">
<title>LLaMA_7B_comm_1_2&#45;&gt;LLaMA_7B_S2_R2_L11_split</title>
<path fill="none" stroke="black" d="M8529.59,-3193.66C8469.49,-3165.56 8383.79,-3125.48 8319.6,-3095.47"/>
<polygon fill="black" stroke="black" points="8320.84,-3092.19 8310.3,-3091.12 8317.87,-3098.53 8320.84,-3092.19"/>
</g>
<!-- LLaMA_7B_comm_2_3&#45;&gt;LLaMA_7B_S3_R1_L21_split -->
<g id="edge666" class="edge">
<title>LLaMA_7B_comm_2_3&#45;&gt;LLaMA_7B_S3_R1_L21_split</title>
<path fill="none" stroke="black" d="M8686.58,-1635.27C9867.72,-1633.12 16032.06,-1620.51 16224,-1591.13 16335.26,-1574.1 16457.81,-1533.84 16541.66,-1502.79"/>
<polygon fill="black" stroke="black" points="16543.03,-1506.01 16551.18,-1499.24 16540.58,-1499.46 16543.03,-1506.01"/>
</g>
<!-- LLaMA_7B_comm_2_3&#45;&gt;LLaMA_7B_S3_R2_L21_split -->
<g id="edge668" class="edge">
<title>LLaMA_7B_comm_2_3&#45;&gt;LLaMA_7B_S3_R2_L21_split</title>
<path fill="none" stroke="black" d="M8439.18,-1600.5C8397.62,-1572.88 8339.53,-1534.27 8295.27,-1504.85"/>
<polygon fill="black" stroke="black" points="8297.16,-1501.9 8286.9,-1499.28 8293.29,-1507.73 8297.16,-1501.9"/>
</g>
<!-- LLaMA_7B_input -->
<g id="node723" class="node">
<title>LLaMA_7B_input</title>
<ellipse fill="lightgreen" stroke="black" cx="12657" cy="-4809.83" rx="195.74" ry="26.74"/>
<text text-anchor="middle" x="12657" y="-4813.63" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="12657" y="-4798.63" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, vocab=32000]</text>
</g>
<!-- LLaMA_7B_input&#45;&gt;LLaMA_7B_S1_R1_L1_split -->
<g id="edge669" class="edge">
<title>LLaMA_7B_input&#45;&gt;LLaMA_7B_S1_R1_L1_split</title>
<path fill="none" stroke="black" d="M12852.88,-4808.64C13603.77,-4807.73 16265.54,-4802.56 16444,-4774.96 16555.24,-4757.75 16677.78,-4717.52 16761.64,-4686.52"/>
<polygon fill="black" stroke="black" points="16763.01,-4689.75 16771.16,-4682.98 16760.57,-4683.19 16763.01,-4689.75"/>
</g>
<!-- LLaMA_7B_input&#45;&gt;LLaMA_7B_S1_R2_L1_split -->
<g id="edge670" class="edge">
<title>LLaMA_7B_input&#45;&gt;LLaMA_7B_S1_R2_L1_split</title>
<path fill="none" stroke="black" d="M12461.23,-4808.64C11710.73,-4807.71 9050.37,-4802.49 8872,-4774.96 8760.52,-4757.75 8637.67,-4717.52 8553.61,-4686.52"/>
<polygon fill="black" stroke="black" points="8554.66,-4683.18 8544.07,-4682.98 8552.22,-4689.74 8554.66,-4683.18"/>
</g>
<!-- LLaMA_7B_output -->
<g id="node724" class="node">
<title>LLaMA_7B_output</title>
<polygon fill="lightgreen" stroke="black" points="444.01,-4632.88 444.01,-4657.03 319.82,-4674.11 144.18,-4674.11 19.99,-4657.03 19.99,-4632.88 144.18,-4615.8 319.82,-4615.8 444.01,-4632.88"/>
<polygon fill="none" stroke="black" points="448.01,-4629.38 448.01,-4660.53 320.09,-4678.12 143.91,-4678.12 15.99,-4660.53 15.99,-4629.38 143.91,-4611.79 320.09,-4611.79 448.01,-4629.38"/>
<text text-anchor="middle" x="232" y="-4648.76" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="232" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=6, seq=2048, vocab=32000]</text>
</g>
<!-- LLaMA_7B_S3_R1_L32_res2 -->
<g id="node725" class="node">
<title>LLaMA_7B_S3_R1_L32_res2</title>
<ellipse fill="none" stroke="black" cx="499" cy="-4809.83" rx="141.07" ry="18"/>
<text text-anchor="middle" x="499" y="-4806.13" font-family="Times,serif" font-size="14.00">LLaMA_7B_S3_R1_L32_res2</text>
</g>
<!-- LLaMA_7B_S3_R1_L32_res2&#45;&gt;LLaMA_7B_output -->
<g id="edge671" class="edge">
<title>LLaMA_7B_S3_R1_L32_res2&#45;&gt;LLaMA_7B_output</title>
<path fill="none" stroke="black" d="M471.43,-4792.01C429.76,-4766.59 349.65,-4717.72 293.62,-4683.54"/>
<polygon fill="black" stroke="black" points="295.2,-4680.41 284.84,-4678.19 291.56,-4686.38 295.2,-4680.41"/>
</g>
<!-- LLaMA_7B_S3_R2_L32_res2 -->
<g id="node726" class="node">
<title>LLaMA_7B_S3_R2_L32_res2</title>
<ellipse fill="none" stroke="black" cx="195" cy="-4809.83" rx="141.07" ry="18"/>
<text text-anchor="middle" x="195" y="-4806.13" font-family="Times,serif" font-size="14.00">LLaMA_7B_S3_R2_L32_res2</text>
</g>
<!-- LLaMA_7B_S3_R2_L32_res2&#45;&gt;LLaMA_7B_output -->
<g id="edge672" class="edge">
<title>LLaMA_7B_S3_R2_L32_res2&#45;&gt;LLaMA_7B_output</title>
<path fill="none" stroke="black" d="M198.89,-4791.7C204.42,-4767.35 214.74,-4721.94 222.39,-4688.25"/>
<polygon fill="black" stroke="black" points="225.87,-4688.73 224.67,-4678.21 219.05,-4687.18 225.87,-4688.73"/>
</g>
<!-- GPT3_2B_S1_R1_L1_split -->
<g id="node727" class="node">
<title>GPT3_2B_S1_R1_L1_split</title>
<polygon fill="orange" stroke="black" points="31069.7,-4682.96 30403.64,-4682.96 30232.3,-4606.96 30898.36,-4606.96 31069.7,-4682.96"/>
<text text-anchor="middle" x="30651" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="30651" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_norm1 -->
<g id="node728" class="node">
<title>GPT3_2B_S1_R1_L1_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="30651" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L1_split&#45;&gt;GPT3_2B_S1_R1_L1_norm1 -->
<g id="edge673" class="edge">
<title>GPT3_2B_S1_R1_L1_split&#45;&gt;GPT3_2B_S1_R1_L1_norm1</title>
<path fill="none" stroke="black" d="M30651,-4606.75C30651,-4587.54 30651,-4564.2 30651,-4545.16"/>
<polygon fill="black" stroke="black" points="30654.5,-4545.07 30651,-4535.07 30647.5,-4545.07 30654.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L1_qkv -->
<g id="node729" class="node">
<title>GPT3_2B_S1_R1_L1_qkv</title>
<polygon fill="lightcoral" stroke="black" points="30793,-4409.22 30509,-4409.22 30509,-4371.22 30793,-4371.22 30793,-4409.22"/>
<text text-anchor="middle" x="30651" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="30651" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_norm1&#45;&gt;GPT3_2B_S1_R1_L1_qkv -->
<g id="edge674" class="edge">
<title>GPT3_2B_S1_R1_L1_norm1&#45;&gt;GPT3_2B_S1_R1_L1_qkv</title>
<path fill="none" stroke="black" d="M30651,-4481.08C30651,-4462.81 30651,-4438.39 30651,-4419.61"/>
<polygon fill="black" stroke="black" points="30654.5,-4419.57 30651,-4409.57 30647.5,-4419.57 30654.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L1_attn -->
<g id="node730" class="node">
<title>GPT3_2B_S1_R1_L1_attn</title>
<polygon fill="lightcoral" stroke="black" points="30793,-4299.22 30509,-4299.22 30509,-4261.22 30793,-4261.22 30793,-4299.22"/>
<text text-anchor="middle" x="30651" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="30651" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_qkv&#45;&gt;GPT3_2B_S1_R1_L1_attn -->
<g id="edge675" class="edge">
<title>GPT3_2B_S1_R1_L1_qkv&#45;&gt;GPT3_2B_S1_R1_L1_attn</title>
<path fill="none" stroke="black" d="M30651,-4370.9C30651,-4354.04 30651,-4328.78 30651,-4309.36"/>
<polygon fill="black" stroke="black" points="30654.5,-4309.27 30651,-4299.27 30647.5,-4309.27 30654.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L1_ar1 -->
<g id="node731" class="node">
<title>GPT3_2B_S1_R1_L1_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="30651" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_attn&#45;&gt;GPT3_2B_S1_R1_L1_ar1 -->
<g id="edge676" class="edge">
<title>GPT3_2B_S1_R1_L1_attn&#45;&gt;GPT3_2B_S1_R1_L1_ar1</title>
<path fill="none" stroke="black" d="M30651,-4261.11C30651,-4244.74 30651,-4220.15 30651,-4199.73"/>
<polygon fill="black" stroke="black" points="30654.5,-4199.49 30651,-4189.49 30647.5,-4199.49 30654.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L1_res1 -->
<g id="node732" class="node">
<title>GPT3_2B_S1_R1_L1_res1</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-4063.48 30599.11,-4063.48 30563.16,-4027.48 30702.89,-4027.48 30738.84,-4063.48"/>
<text text-anchor="middle" x="30651" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L1_ar1&#45;&gt;GPT3_2B_S1_R1_L1_res1 -->
<g id="edge677" class="edge">
<title>GPT3_2B_S1_R1_L1_ar1&#45;&gt;GPT3_2B_S1_R1_L1_res1</title>
<path fill="none" stroke="black" d="M30651,-4135.28C30651,-4116.91 30651,-4092.36 30651,-4073.73"/>
<polygon fill="black" stroke="black" points="30654.5,-4073.54 30651,-4063.54 30647.5,-4073.54 30654.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L1_norm2 -->
<g id="node733" class="node">
<title>GPT3_2B_S1_R1_L1_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="30651" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L1_res1&#45;&gt;GPT3_2B_S1_R1_L1_norm2 -->
<g id="edge678" class="edge">
<title>GPT3_2B_S1_R1_L1_res1&#45;&gt;GPT3_2B_S1_R1_L1_norm2</title>
<path fill="none" stroke="black" d="M30651,-4027.03C30651,-4010.89 30651,-3986.38 30651,-3965.99"/>
<polygon fill="black" stroke="black" points="30654.5,-3965.76 30651,-3955.76 30647.5,-3965.76 30654.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_up -->
<g id="node734" class="node">
<title>GPT3_2B_S1_R1_L1_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-3829.74 30544.5,-3829.74 30544.5,-3791.74 30757.5,-3791.74 30757.5,-3829.74"/>
<text text-anchor="middle" x="30651" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="30651" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_norm2&#45;&gt;GPT3_2B_S1_R1_L1_ffn_up -->
<g id="edge679" class="edge">
<title>GPT3_2B_S1_R1_L1_norm2&#45;&gt;GPT3_2B_S1_R1_L1_ffn_up</title>
<path fill="none" stroke="black" d="M30651,-3901.6C30651,-3883.33 30651,-3858.91 30651,-3840.13"/>
<polygon fill="black" stroke="black" points="30654.5,-3840.09 30651,-3830.09 30647.5,-3840.09 30654.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_gate -->
<g id="node735" class="node">
<title>GPT3_2B_S1_R1_L1_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-3719.74 30544.5,-3719.74 30544.5,-3681.74 30757.5,-3681.74 30757.5,-3719.74"/>
<text text-anchor="middle" x="30651" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="30651" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_up&#45;&gt;GPT3_2B_S1_R1_L1_ffn_gate -->
<g id="edge680" class="edge">
<title>GPT3_2B_S1_R1_L1_ffn_up&#45;&gt;GPT3_2B_S1_R1_L1_ffn_gate</title>
<path fill="none" stroke="black" d="M30651,-3791.41C30651,-3774.56 30651,-3749.3 30651,-3729.88"/>
<polygon fill="black" stroke="black" points="30654.5,-3729.79 30651,-3719.79 30647.5,-3729.79 30654.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_down -->
<g id="node736" class="node">
<title>GPT3_2B_S1_R1_L1_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-3609.74 30544.5,-3609.74 30544.5,-3571.74 30757.5,-3571.74 30757.5,-3609.74"/>
<text text-anchor="middle" x="30651" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="30651" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L1_ffn_down -->
<g id="edge681" class="edge">
<title>GPT3_2B_S1_R1_L1_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L1_ffn_down</title>
<path fill="none" stroke="black" d="M30651,-3681.41C30651,-3664.56 30651,-3639.3 30651,-3619.88"/>
<polygon fill="black" stroke="black" points="30654.5,-3619.79 30651,-3609.79 30647.5,-3619.79 30654.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L1_ar2 -->
<g id="node737" class="node">
<title>GPT3_2B_S1_R1_L1_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="30651" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L1_ffn_down&#45;&gt;GPT3_2B_S1_R1_L1_ar2 -->
<g id="edge682" class="edge">
<title>GPT3_2B_S1_R1_L1_ffn_down&#45;&gt;GPT3_2B_S1_R1_L1_ar2</title>
<path fill="none" stroke="black" d="M30651,-3571.63C30651,-3555.26 30651,-3530.67 30651,-3510.25"/>
<polygon fill="black" stroke="black" points="30654.5,-3510.01 30651,-3500.01 30647.5,-3510.01 30654.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L1_res2 -->
<g id="node738" class="node">
<title>GPT3_2B_S1_R1_L1_res2</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-3374 30599.11,-3374 30563.16,-3338 30702.89,-3338 30738.84,-3374"/>
<text text-anchor="middle" x="30651" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L1_ar2&#45;&gt;GPT3_2B_S1_R1_L1_res2 -->
<g id="edge683" class="edge">
<title>GPT3_2B_S1_R1_L1_ar2&#45;&gt;GPT3_2B_S1_R1_L1_res2</title>
<path fill="none" stroke="black" d="M30651,-3445.8C30651,-3427.43 30651,-3402.88 30651,-3384.25"/>
<polygon fill="black" stroke="black" points="30654.5,-3384.06 30651,-3374.06 30647.5,-3384.06 30654.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L2_split -->
<g id="node739" class="node">
<title>GPT3_2B_S1_R1_L2_split</title>
<polygon fill="orange" stroke="black" points="30209.7,-4682.96 29543.64,-4682.96 29372.3,-4606.96 30038.36,-4606.96 30209.7,-4682.96"/>
<text text-anchor="middle" x="29791" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="29791" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_norm1 -->
<g id="node740" class="node">
<title>GPT3_2B_S1_R1_L2_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29791" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L2_split&#45;&gt;GPT3_2B_S1_R1_L2_norm1 -->
<g id="edge684" class="edge">
<title>GPT3_2B_S1_R1_L2_split&#45;&gt;GPT3_2B_S1_R1_L2_norm1</title>
<path fill="none" stroke="black" d="M29791,-4606.75C29791,-4587.54 29791,-4564.2 29791,-4545.16"/>
<polygon fill="black" stroke="black" points="29794.5,-4545.07 29791,-4535.07 29787.5,-4545.07 29794.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L2_qkv -->
<g id="node741" class="node">
<title>GPT3_2B_S1_R1_L2_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29933,-4409.22 29649,-4409.22 29649,-4371.22 29933,-4371.22 29933,-4409.22"/>
<text text-anchor="middle" x="29791" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="29791" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_norm1&#45;&gt;GPT3_2B_S1_R1_L2_qkv -->
<g id="edge685" class="edge">
<title>GPT3_2B_S1_R1_L2_norm1&#45;&gt;GPT3_2B_S1_R1_L2_qkv</title>
<path fill="none" stroke="black" d="M29791,-4481.08C29791,-4462.81 29791,-4438.39 29791,-4419.61"/>
<polygon fill="black" stroke="black" points="29794.5,-4419.57 29791,-4409.57 29787.5,-4419.57 29794.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L2_attn -->
<g id="node742" class="node">
<title>GPT3_2B_S1_R1_L2_attn</title>
<polygon fill="lightcoral" stroke="black" points="29933,-4299.22 29649,-4299.22 29649,-4261.22 29933,-4261.22 29933,-4299.22"/>
<text text-anchor="middle" x="29791" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="29791" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_qkv&#45;&gt;GPT3_2B_S1_R1_L2_attn -->
<g id="edge686" class="edge">
<title>GPT3_2B_S1_R1_L2_qkv&#45;&gt;GPT3_2B_S1_R1_L2_attn</title>
<path fill="none" stroke="black" d="M29791,-4370.9C29791,-4354.04 29791,-4328.78 29791,-4309.36"/>
<polygon fill="black" stroke="black" points="29794.5,-4309.27 29791,-4299.27 29787.5,-4309.27 29794.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L2_ar1 -->
<g id="node743" class="node">
<title>GPT3_2B_S1_R1_L2_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29791" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_attn&#45;&gt;GPT3_2B_S1_R1_L2_ar1 -->
<g id="edge687" class="edge">
<title>GPT3_2B_S1_R1_L2_attn&#45;&gt;GPT3_2B_S1_R1_L2_ar1</title>
<path fill="none" stroke="black" d="M29791,-4261.11C29791,-4244.74 29791,-4220.15 29791,-4199.73"/>
<polygon fill="black" stroke="black" points="29794.5,-4199.49 29791,-4189.49 29787.5,-4199.49 29794.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L2_res1 -->
<g id="node744" class="node">
<title>GPT3_2B_S1_R1_L2_res1</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-4063.48 29739.11,-4063.48 29703.16,-4027.48 29842.89,-4027.48 29878.84,-4063.48"/>
<text text-anchor="middle" x="29791" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L2_ar1&#45;&gt;GPT3_2B_S1_R1_L2_res1 -->
<g id="edge688" class="edge">
<title>GPT3_2B_S1_R1_L2_ar1&#45;&gt;GPT3_2B_S1_R1_L2_res1</title>
<path fill="none" stroke="black" d="M29791,-4135.28C29791,-4116.91 29791,-4092.36 29791,-4073.73"/>
<polygon fill="black" stroke="black" points="29794.5,-4073.54 29791,-4063.54 29787.5,-4073.54 29794.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L2_norm2 -->
<g id="node745" class="node">
<title>GPT3_2B_S1_R1_L2_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="29791" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L2_res1&#45;&gt;GPT3_2B_S1_R1_L2_norm2 -->
<g id="edge689" class="edge">
<title>GPT3_2B_S1_R1_L2_res1&#45;&gt;GPT3_2B_S1_R1_L2_norm2</title>
<path fill="none" stroke="black" d="M29791,-4027.03C29791,-4010.89 29791,-3986.38 29791,-3965.99"/>
<polygon fill="black" stroke="black" points="29794.5,-3965.76 29791,-3955.76 29787.5,-3965.76 29794.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_up -->
<g id="node746" class="node">
<title>GPT3_2B_S1_R1_L2_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-3829.74 29684.5,-3829.74 29684.5,-3791.74 29897.5,-3791.74 29897.5,-3829.74"/>
<text text-anchor="middle" x="29791" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="29791" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_norm2&#45;&gt;GPT3_2B_S1_R1_L2_ffn_up -->
<g id="edge690" class="edge">
<title>GPT3_2B_S1_R1_L2_norm2&#45;&gt;GPT3_2B_S1_R1_L2_ffn_up</title>
<path fill="none" stroke="black" d="M29791,-3901.6C29791,-3883.33 29791,-3858.91 29791,-3840.13"/>
<polygon fill="black" stroke="black" points="29794.5,-3840.09 29791,-3830.09 29787.5,-3840.09 29794.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_gate -->
<g id="node747" class="node">
<title>GPT3_2B_S1_R1_L2_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-3719.74 29684.5,-3719.74 29684.5,-3681.74 29897.5,-3681.74 29897.5,-3719.74"/>
<text text-anchor="middle" x="29791" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="29791" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_up&#45;&gt;GPT3_2B_S1_R1_L2_ffn_gate -->
<g id="edge691" class="edge">
<title>GPT3_2B_S1_R1_L2_ffn_up&#45;&gt;GPT3_2B_S1_R1_L2_ffn_gate</title>
<path fill="none" stroke="black" d="M29791,-3791.41C29791,-3774.56 29791,-3749.3 29791,-3729.88"/>
<polygon fill="black" stroke="black" points="29794.5,-3729.79 29791,-3719.79 29787.5,-3729.79 29794.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_down -->
<g id="node748" class="node">
<title>GPT3_2B_S1_R1_L2_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-3609.74 29684.5,-3609.74 29684.5,-3571.74 29897.5,-3571.74 29897.5,-3609.74"/>
<text text-anchor="middle" x="29791" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="29791" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L2_ffn_down -->
<g id="edge692" class="edge">
<title>GPT3_2B_S1_R1_L2_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L2_ffn_down</title>
<path fill="none" stroke="black" d="M29791,-3681.41C29791,-3664.56 29791,-3639.3 29791,-3619.88"/>
<polygon fill="black" stroke="black" points="29794.5,-3619.79 29791,-3609.79 29787.5,-3619.79 29794.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L2_ar2 -->
<g id="node749" class="node">
<title>GPT3_2B_S1_R1_L2_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="29791" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L2_ffn_down&#45;&gt;GPT3_2B_S1_R1_L2_ar2 -->
<g id="edge693" class="edge">
<title>GPT3_2B_S1_R1_L2_ffn_down&#45;&gt;GPT3_2B_S1_R1_L2_ar2</title>
<path fill="none" stroke="black" d="M29791,-3571.63C29791,-3555.26 29791,-3530.67 29791,-3510.25"/>
<polygon fill="black" stroke="black" points="29794.5,-3510.01 29791,-3500.01 29787.5,-3510.01 29794.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L2_res2 -->
<g id="node750" class="node">
<title>GPT3_2B_S1_R1_L2_res2</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-3374 29739.11,-3374 29703.16,-3338 29842.89,-3338 29878.84,-3374"/>
<text text-anchor="middle" x="29791" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L2_ar2&#45;&gt;GPT3_2B_S1_R1_L2_res2 -->
<g id="edge694" class="edge">
<title>GPT3_2B_S1_R1_L2_ar2&#45;&gt;GPT3_2B_S1_R1_L2_res2</title>
<path fill="none" stroke="black" d="M29791,-3445.8C29791,-3427.43 29791,-3402.88 29791,-3384.25"/>
<polygon fill="black" stroke="black" points="29794.5,-3384.06 29791,-3374.06 29787.5,-3384.06 29794.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L3_split -->
<g id="node751" class="node">
<title>GPT3_2B_S1_R1_L3_split</title>
<polygon fill="orange" stroke="black" points="29349.7,-4682.96 28683.64,-4682.96 28512.3,-4606.96 29178.36,-4606.96 29349.7,-4682.96"/>
<text text-anchor="middle" x="28931" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28931" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_norm1 -->
<g id="node752" class="node">
<title>GPT3_2B_S1_R1_L3_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28931" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L3_split&#45;&gt;GPT3_2B_S1_R1_L3_norm1 -->
<g id="edge695" class="edge">
<title>GPT3_2B_S1_R1_L3_split&#45;&gt;GPT3_2B_S1_R1_L3_norm1</title>
<path fill="none" stroke="black" d="M28931,-4606.75C28931,-4587.54 28931,-4564.2 28931,-4545.16"/>
<polygon fill="black" stroke="black" points="28934.5,-4545.07 28931,-4535.07 28927.5,-4545.07 28934.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L3_qkv -->
<g id="node753" class="node">
<title>GPT3_2B_S1_R1_L3_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29073,-4409.22 28789,-4409.22 28789,-4371.22 29073,-4371.22 29073,-4409.22"/>
<text text-anchor="middle" x="28931" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28931" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_norm1&#45;&gt;GPT3_2B_S1_R1_L3_qkv -->
<g id="edge696" class="edge">
<title>GPT3_2B_S1_R1_L3_norm1&#45;&gt;GPT3_2B_S1_R1_L3_qkv</title>
<path fill="none" stroke="black" d="M28931,-4481.08C28931,-4462.81 28931,-4438.39 28931,-4419.61"/>
<polygon fill="black" stroke="black" points="28934.5,-4419.57 28931,-4409.57 28927.5,-4419.57 28934.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L3_attn -->
<g id="node754" class="node">
<title>GPT3_2B_S1_R1_L3_attn</title>
<polygon fill="lightcoral" stroke="black" points="29073,-4299.22 28789,-4299.22 28789,-4261.22 29073,-4261.22 29073,-4299.22"/>
<text text-anchor="middle" x="28931" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28931" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_qkv&#45;&gt;GPT3_2B_S1_R1_L3_attn -->
<g id="edge697" class="edge">
<title>GPT3_2B_S1_R1_L3_qkv&#45;&gt;GPT3_2B_S1_R1_L3_attn</title>
<path fill="none" stroke="black" d="M28931,-4370.9C28931,-4354.04 28931,-4328.78 28931,-4309.36"/>
<polygon fill="black" stroke="black" points="28934.5,-4309.27 28931,-4299.27 28927.5,-4309.27 28934.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L3_ar1 -->
<g id="node755" class="node">
<title>GPT3_2B_S1_R1_L3_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28931" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_attn&#45;&gt;GPT3_2B_S1_R1_L3_ar1 -->
<g id="edge698" class="edge">
<title>GPT3_2B_S1_R1_L3_attn&#45;&gt;GPT3_2B_S1_R1_L3_ar1</title>
<path fill="none" stroke="black" d="M28931,-4261.11C28931,-4244.74 28931,-4220.15 28931,-4199.73"/>
<polygon fill="black" stroke="black" points="28934.5,-4199.49 28931,-4189.49 28927.5,-4199.49 28934.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L3_res1 -->
<g id="node756" class="node">
<title>GPT3_2B_S1_R1_L3_res1</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-4063.48 28879.11,-4063.48 28843.16,-4027.48 28982.89,-4027.48 29018.84,-4063.48"/>
<text text-anchor="middle" x="28931" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L3_ar1&#45;&gt;GPT3_2B_S1_R1_L3_res1 -->
<g id="edge699" class="edge">
<title>GPT3_2B_S1_R1_L3_ar1&#45;&gt;GPT3_2B_S1_R1_L3_res1</title>
<path fill="none" stroke="black" d="M28931,-4135.28C28931,-4116.91 28931,-4092.36 28931,-4073.73"/>
<polygon fill="black" stroke="black" points="28934.5,-4073.54 28931,-4063.54 28927.5,-4073.54 28934.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L3_norm2 -->
<g id="node757" class="node">
<title>GPT3_2B_S1_R1_L3_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28931" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L3_res1&#45;&gt;GPT3_2B_S1_R1_L3_norm2 -->
<g id="edge700" class="edge">
<title>GPT3_2B_S1_R1_L3_res1&#45;&gt;GPT3_2B_S1_R1_L3_norm2</title>
<path fill="none" stroke="black" d="M28931,-4027.03C28931,-4010.89 28931,-3986.38 28931,-3965.99"/>
<polygon fill="black" stroke="black" points="28934.5,-3965.76 28931,-3955.76 28927.5,-3965.76 28934.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_up -->
<g id="node758" class="node">
<title>GPT3_2B_S1_R1_L3_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-3829.74 28824.5,-3829.74 28824.5,-3791.74 29037.5,-3791.74 29037.5,-3829.74"/>
<text text-anchor="middle" x="28931" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28931" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_norm2&#45;&gt;GPT3_2B_S1_R1_L3_ffn_up -->
<g id="edge701" class="edge">
<title>GPT3_2B_S1_R1_L3_norm2&#45;&gt;GPT3_2B_S1_R1_L3_ffn_up</title>
<path fill="none" stroke="black" d="M28931,-3901.6C28931,-3883.33 28931,-3858.91 28931,-3840.13"/>
<polygon fill="black" stroke="black" points="28934.5,-3840.09 28931,-3830.09 28927.5,-3840.09 28934.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_gate -->
<g id="node759" class="node">
<title>GPT3_2B_S1_R1_L3_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-3719.74 28824.5,-3719.74 28824.5,-3681.74 29037.5,-3681.74 29037.5,-3719.74"/>
<text text-anchor="middle" x="28931" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28931" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_up&#45;&gt;GPT3_2B_S1_R1_L3_ffn_gate -->
<g id="edge702" class="edge">
<title>GPT3_2B_S1_R1_L3_ffn_up&#45;&gt;GPT3_2B_S1_R1_L3_ffn_gate</title>
<path fill="none" stroke="black" d="M28931,-3791.41C28931,-3774.56 28931,-3749.3 28931,-3729.88"/>
<polygon fill="black" stroke="black" points="28934.5,-3729.79 28931,-3719.79 28927.5,-3729.79 28934.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_down -->
<g id="node760" class="node">
<title>GPT3_2B_S1_R1_L3_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-3609.74 28824.5,-3609.74 28824.5,-3571.74 29037.5,-3571.74 29037.5,-3609.74"/>
<text text-anchor="middle" x="28931" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28931" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L3_ffn_down -->
<g id="edge703" class="edge">
<title>GPT3_2B_S1_R1_L3_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L3_ffn_down</title>
<path fill="none" stroke="black" d="M28931,-3681.41C28931,-3664.56 28931,-3639.3 28931,-3619.88"/>
<polygon fill="black" stroke="black" points="28934.5,-3619.79 28931,-3609.79 28927.5,-3619.79 28934.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L3_ar2 -->
<g id="node761" class="node">
<title>GPT3_2B_S1_R1_L3_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28931" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L3_ffn_down&#45;&gt;GPT3_2B_S1_R1_L3_ar2 -->
<g id="edge704" class="edge">
<title>GPT3_2B_S1_R1_L3_ffn_down&#45;&gt;GPT3_2B_S1_R1_L3_ar2</title>
<path fill="none" stroke="black" d="M28931,-3571.63C28931,-3555.26 28931,-3530.67 28931,-3510.25"/>
<polygon fill="black" stroke="black" points="28934.5,-3510.01 28931,-3500.01 28927.5,-3510.01 28934.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L3_res2 -->
<g id="node762" class="node">
<title>GPT3_2B_S1_R1_L3_res2</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-3374 28879.11,-3374 28843.16,-3338 28982.89,-3338 29018.84,-3374"/>
<text text-anchor="middle" x="28931" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L3_ar2&#45;&gt;GPT3_2B_S1_R1_L3_res2 -->
<g id="edge705" class="edge">
<title>GPT3_2B_S1_R1_L3_ar2&#45;&gt;GPT3_2B_S1_R1_L3_res2</title>
<path fill="none" stroke="black" d="M28931,-3445.8C28931,-3427.43 28931,-3402.88 28931,-3384.25"/>
<polygon fill="black" stroke="black" points="28934.5,-3384.06 28931,-3374.06 28927.5,-3384.06 28934.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L4_split -->
<g id="node763" class="node">
<title>GPT3_2B_S1_R1_L4_split</title>
<polygon fill="orange" stroke="black" points="28489.7,-4682.96 27823.64,-4682.96 27652.3,-4606.96 28318.36,-4606.96 28489.7,-4682.96"/>
<text text-anchor="middle" x="28071" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28071" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_norm1 -->
<g id="node764" class="node">
<title>GPT3_2B_S1_R1_L4_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28071" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L4_split&#45;&gt;GPT3_2B_S1_R1_L4_norm1 -->
<g id="edge706" class="edge">
<title>GPT3_2B_S1_R1_L4_split&#45;&gt;GPT3_2B_S1_R1_L4_norm1</title>
<path fill="none" stroke="black" d="M28071,-4606.75C28071,-4587.54 28071,-4564.2 28071,-4545.16"/>
<polygon fill="black" stroke="black" points="28074.5,-4545.07 28071,-4535.07 28067.5,-4545.07 28074.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L4_qkv -->
<g id="node765" class="node">
<title>GPT3_2B_S1_R1_L4_qkv</title>
<polygon fill="lightcoral" stroke="black" points="28213,-4409.22 27929,-4409.22 27929,-4371.22 28213,-4371.22 28213,-4409.22"/>
<text text-anchor="middle" x="28071" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28071" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_norm1&#45;&gt;GPT3_2B_S1_R1_L4_qkv -->
<g id="edge707" class="edge">
<title>GPT3_2B_S1_R1_L4_norm1&#45;&gt;GPT3_2B_S1_R1_L4_qkv</title>
<path fill="none" stroke="black" d="M28071,-4481.08C28071,-4462.81 28071,-4438.39 28071,-4419.61"/>
<polygon fill="black" stroke="black" points="28074.5,-4419.57 28071,-4409.57 28067.5,-4419.57 28074.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L4_attn -->
<g id="node766" class="node">
<title>GPT3_2B_S1_R1_L4_attn</title>
<polygon fill="lightcoral" stroke="black" points="28213,-4299.22 27929,-4299.22 27929,-4261.22 28213,-4261.22 28213,-4299.22"/>
<text text-anchor="middle" x="28071" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28071" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_qkv&#45;&gt;GPT3_2B_S1_R1_L4_attn -->
<g id="edge708" class="edge">
<title>GPT3_2B_S1_R1_L4_qkv&#45;&gt;GPT3_2B_S1_R1_L4_attn</title>
<path fill="none" stroke="black" d="M28071,-4370.9C28071,-4354.04 28071,-4328.78 28071,-4309.36"/>
<polygon fill="black" stroke="black" points="28074.5,-4309.27 28071,-4299.27 28067.5,-4309.27 28074.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L4_ar1 -->
<g id="node767" class="node">
<title>GPT3_2B_S1_R1_L4_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28071" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_attn&#45;&gt;GPT3_2B_S1_R1_L4_ar1 -->
<g id="edge709" class="edge">
<title>GPT3_2B_S1_R1_L4_attn&#45;&gt;GPT3_2B_S1_R1_L4_ar1</title>
<path fill="none" stroke="black" d="M28071,-4261.11C28071,-4244.74 28071,-4220.15 28071,-4199.73"/>
<polygon fill="black" stroke="black" points="28074.5,-4199.49 28071,-4189.49 28067.5,-4199.49 28074.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L4_res1 -->
<g id="node768" class="node">
<title>GPT3_2B_S1_R1_L4_res1</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-4063.48 28019.11,-4063.48 27983.16,-4027.48 28122.89,-4027.48 28158.84,-4063.48"/>
<text text-anchor="middle" x="28071" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L4_ar1&#45;&gt;GPT3_2B_S1_R1_L4_res1 -->
<g id="edge710" class="edge">
<title>GPT3_2B_S1_R1_L4_ar1&#45;&gt;GPT3_2B_S1_R1_L4_res1</title>
<path fill="none" stroke="black" d="M28071,-4135.28C28071,-4116.91 28071,-4092.36 28071,-4073.73"/>
<polygon fill="black" stroke="black" points="28074.5,-4073.54 28071,-4063.54 28067.5,-4073.54 28074.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L4_norm2 -->
<g id="node769" class="node">
<title>GPT3_2B_S1_R1_L4_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28071" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L4_res1&#45;&gt;GPT3_2B_S1_R1_L4_norm2 -->
<g id="edge711" class="edge">
<title>GPT3_2B_S1_R1_L4_res1&#45;&gt;GPT3_2B_S1_R1_L4_norm2</title>
<path fill="none" stroke="black" d="M28071,-4027.03C28071,-4010.89 28071,-3986.38 28071,-3965.99"/>
<polygon fill="black" stroke="black" points="28074.5,-3965.76 28071,-3955.76 28067.5,-3965.76 28074.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_up -->
<g id="node770" class="node">
<title>GPT3_2B_S1_R1_L4_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-3829.74 27964.5,-3829.74 27964.5,-3791.74 28177.5,-3791.74 28177.5,-3829.74"/>
<text text-anchor="middle" x="28071" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28071" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_norm2&#45;&gt;GPT3_2B_S1_R1_L4_ffn_up -->
<g id="edge712" class="edge">
<title>GPT3_2B_S1_R1_L4_norm2&#45;&gt;GPT3_2B_S1_R1_L4_ffn_up</title>
<path fill="none" stroke="black" d="M28071,-3901.6C28071,-3883.33 28071,-3858.91 28071,-3840.13"/>
<polygon fill="black" stroke="black" points="28074.5,-3840.09 28071,-3830.09 28067.5,-3840.09 28074.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_gate -->
<g id="node771" class="node">
<title>GPT3_2B_S1_R1_L4_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-3719.74 27964.5,-3719.74 27964.5,-3681.74 28177.5,-3681.74 28177.5,-3719.74"/>
<text text-anchor="middle" x="28071" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28071" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_up&#45;&gt;GPT3_2B_S1_R1_L4_ffn_gate -->
<g id="edge713" class="edge">
<title>GPT3_2B_S1_R1_L4_ffn_up&#45;&gt;GPT3_2B_S1_R1_L4_ffn_gate</title>
<path fill="none" stroke="black" d="M28071,-3791.41C28071,-3774.56 28071,-3749.3 28071,-3729.88"/>
<polygon fill="black" stroke="black" points="28074.5,-3729.79 28071,-3719.79 28067.5,-3729.79 28074.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_down -->
<g id="node772" class="node">
<title>GPT3_2B_S1_R1_L4_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-3609.74 27964.5,-3609.74 27964.5,-3571.74 28177.5,-3571.74 28177.5,-3609.74"/>
<text text-anchor="middle" x="28071" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28071" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L4_ffn_down -->
<g id="edge714" class="edge">
<title>GPT3_2B_S1_R1_L4_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L4_ffn_down</title>
<path fill="none" stroke="black" d="M28071,-3681.41C28071,-3664.56 28071,-3639.3 28071,-3619.88"/>
<polygon fill="black" stroke="black" points="28074.5,-3619.79 28071,-3609.79 28067.5,-3619.79 28074.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L4_ar2 -->
<g id="node773" class="node">
<title>GPT3_2B_S1_R1_L4_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28071" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L4_ffn_down&#45;&gt;GPT3_2B_S1_R1_L4_ar2 -->
<g id="edge715" class="edge">
<title>GPT3_2B_S1_R1_L4_ffn_down&#45;&gt;GPT3_2B_S1_R1_L4_ar2</title>
<path fill="none" stroke="black" d="M28071,-3571.63C28071,-3555.26 28071,-3530.67 28071,-3510.25"/>
<polygon fill="black" stroke="black" points="28074.5,-3510.01 28071,-3500.01 28067.5,-3510.01 28074.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L4_res2 -->
<g id="node774" class="node">
<title>GPT3_2B_S1_R1_L4_res2</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-3374 28019.11,-3374 27983.16,-3338 28122.89,-3338 28158.84,-3374"/>
<text text-anchor="middle" x="28071" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L4_ar2&#45;&gt;GPT3_2B_S1_R1_L4_res2 -->
<g id="edge716" class="edge">
<title>GPT3_2B_S1_R1_L4_ar2&#45;&gt;GPT3_2B_S1_R1_L4_res2</title>
<path fill="none" stroke="black" d="M28071,-3445.8C28071,-3427.43 28071,-3402.88 28071,-3384.25"/>
<polygon fill="black" stroke="black" points="28074.5,-3384.06 28071,-3374.06 28067.5,-3384.06 28074.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L5_split -->
<g id="node775" class="node">
<title>GPT3_2B_S1_R1_L5_split</title>
<polygon fill="orange" stroke="black" points="27629.7,-4682.96 26963.64,-4682.96 26792.3,-4606.96 27458.36,-4606.96 27629.7,-4682.96"/>
<text text-anchor="middle" x="27211" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="27211" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_norm1 -->
<g id="node776" class="node">
<title>GPT3_2B_S1_R1_L5_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27211" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L5_split&#45;&gt;GPT3_2B_S1_R1_L5_norm1 -->
<g id="edge717" class="edge">
<title>GPT3_2B_S1_R1_L5_split&#45;&gt;GPT3_2B_S1_R1_L5_norm1</title>
<path fill="none" stroke="black" d="M27211,-4606.75C27211,-4587.54 27211,-4564.2 27211,-4545.16"/>
<polygon fill="black" stroke="black" points="27214.5,-4545.07 27211,-4535.07 27207.5,-4545.07 27214.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L5_qkv -->
<g id="node777" class="node">
<title>GPT3_2B_S1_R1_L5_qkv</title>
<polygon fill="lightcoral" stroke="black" points="27353,-4409.22 27069,-4409.22 27069,-4371.22 27353,-4371.22 27353,-4409.22"/>
<text text-anchor="middle" x="27211" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="27211" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_norm1&#45;&gt;GPT3_2B_S1_R1_L5_qkv -->
<g id="edge718" class="edge">
<title>GPT3_2B_S1_R1_L5_norm1&#45;&gt;GPT3_2B_S1_R1_L5_qkv</title>
<path fill="none" stroke="black" d="M27211,-4481.08C27211,-4462.81 27211,-4438.39 27211,-4419.61"/>
<polygon fill="black" stroke="black" points="27214.5,-4419.57 27211,-4409.57 27207.5,-4419.57 27214.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L5_attn -->
<g id="node778" class="node">
<title>GPT3_2B_S1_R1_L5_attn</title>
<polygon fill="lightcoral" stroke="black" points="27353,-4299.22 27069,-4299.22 27069,-4261.22 27353,-4261.22 27353,-4299.22"/>
<text text-anchor="middle" x="27211" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="27211" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_qkv&#45;&gt;GPT3_2B_S1_R1_L5_attn -->
<g id="edge719" class="edge">
<title>GPT3_2B_S1_R1_L5_qkv&#45;&gt;GPT3_2B_S1_R1_L5_attn</title>
<path fill="none" stroke="black" d="M27211,-4370.9C27211,-4354.04 27211,-4328.78 27211,-4309.36"/>
<polygon fill="black" stroke="black" points="27214.5,-4309.27 27211,-4299.27 27207.5,-4309.27 27214.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L5_ar1 -->
<g id="node779" class="node">
<title>GPT3_2B_S1_R1_L5_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="27211" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_attn&#45;&gt;GPT3_2B_S1_R1_L5_ar1 -->
<g id="edge720" class="edge">
<title>GPT3_2B_S1_R1_L5_attn&#45;&gt;GPT3_2B_S1_R1_L5_ar1</title>
<path fill="none" stroke="black" d="M27211,-4261.11C27211,-4244.74 27211,-4220.15 27211,-4199.73"/>
<polygon fill="black" stroke="black" points="27214.5,-4199.49 27211,-4189.49 27207.5,-4199.49 27214.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L5_res1 -->
<g id="node780" class="node">
<title>GPT3_2B_S1_R1_L5_res1</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-4063.48 27159.11,-4063.48 27123.16,-4027.48 27262.89,-4027.48 27298.84,-4063.48"/>
<text text-anchor="middle" x="27211" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L5_ar1&#45;&gt;GPT3_2B_S1_R1_L5_res1 -->
<g id="edge721" class="edge">
<title>GPT3_2B_S1_R1_L5_ar1&#45;&gt;GPT3_2B_S1_R1_L5_res1</title>
<path fill="none" stroke="black" d="M27211,-4135.28C27211,-4116.91 27211,-4092.36 27211,-4073.73"/>
<polygon fill="black" stroke="black" points="27214.5,-4073.54 27211,-4063.54 27207.5,-4073.54 27214.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L5_norm2 -->
<g id="node781" class="node">
<title>GPT3_2B_S1_R1_L5_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="27211" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L5_res1&#45;&gt;GPT3_2B_S1_R1_L5_norm2 -->
<g id="edge722" class="edge">
<title>GPT3_2B_S1_R1_L5_res1&#45;&gt;GPT3_2B_S1_R1_L5_norm2</title>
<path fill="none" stroke="black" d="M27211,-4027.03C27211,-4010.89 27211,-3986.38 27211,-3965.99"/>
<polygon fill="black" stroke="black" points="27214.5,-3965.76 27211,-3955.76 27207.5,-3965.76 27214.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_up -->
<g id="node782" class="node">
<title>GPT3_2B_S1_R1_L5_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-3829.74 27104.5,-3829.74 27104.5,-3791.74 27317.5,-3791.74 27317.5,-3829.74"/>
<text text-anchor="middle" x="27211" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="27211" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_norm2&#45;&gt;GPT3_2B_S1_R1_L5_ffn_up -->
<g id="edge723" class="edge">
<title>GPT3_2B_S1_R1_L5_norm2&#45;&gt;GPT3_2B_S1_R1_L5_ffn_up</title>
<path fill="none" stroke="black" d="M27211,-3901.6C27211,-3883.33 27211,-3858.91 27211,-3840.13"/>
<polygon fill="black" stroke="black" points="27214.5,-3840.09 27211,-3830.09 27207.5,-3840.09 27214.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_gate -->
<g id="node783" class="node">
<title>GPT3_2B_S1_R1_L5_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-3719.74 27104.5,-3719.74 27104.5,-3681.74 27317.5,-3681.74 27317.5,-3719.74"/>
<text text-anchor="middle" x="27211" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="27211" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_up&#45;&gt;GPT3_2B_S1_R1_L5_ffn_gate -->
<g id="edge724" class="edge">
<title>GPT3_2B_S1_R1_L5_ffn_up&#45;&gt;GPT3_2B_S1_R1_L5_ffn_gate</title>
<path fill="none" stroke="black" d="M27211,-3791.41C27211,-3774.56 27211,-3749.3 27211,-3729.88"/>
<polygon fill="black" stroke="black" points="27214.5,-3729.79 27211,-3719.79 27207.5,-3729.79 27214.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_down -->
<g id="node784" class="node">
<title>GPT3_2B_S1_R1_L5_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-3609.74 27104.5,-3609.74 27104.5,-3571.74 27317.5,-3571.74 27317.5,-3609.74"/>
<text text-anchor="middle" x="27211" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="27211" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L5_ffn_down -->
<g id="edge725" class="edge">
<title>GPT3_2B_S1_R1_L5_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L5_ffn_down</title>
<path fill="none" stroke="black" d="M27211,-3681.41C27211,-3664.56 27211,-3639.3 27211,-3619.88"/>
<polygon fill="black" stroke="black" points="27214.5,-3619.79 27211,-3609.79 27207.5,-3619.79 27214.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L5_ar2 -->
<g id="node785" class="node">
<title>GPT3_2B_S1_R1_L5_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="27211" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L5_ffn_down&#45;&gt;GPT3_2B_S1_R1_L5_ar2 -->
<g id="edge726" class="edge">
<title>GPT3_2B_S1_R1_L5_ffn_down&#45;&gt;GPT3_2B_S1_R1_L5_ar2</title>
<path fill="none" stroke="black" d="M27211,-3571.63C27211,-3555.26 27211,-3530.67 27211,-3510.25"/>
<polygon fill="black" stroke="black" points="27214.5,-3510.01 27211,-3500.01 27207.5,-3510.01 27214.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L5_res2 -->
<g id="node786" class="node">
<title>GPT3_2B_S1_R1_L5_res2</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-3374 27159.11,-3374 27123.16,-3338 27262.89,-3338 27298.84,-3374"/>
<text text-anchor="middle" x="27211" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L5_ar2&#45;&gt;GPT3_2B_S1_R1_L5_res2 -->
<g id="edge727" class="edge">
<title>GPT3_2B_S1_R1_L5_ar2&#45;&gt;GPT3_2B_S1_R1_L5_res2</title>
<path fill="none" stroke="black" d="M27211,-3445.8C27211,-3427.43 27211,-3402.88 27211,-3384.25"/>
<polygon fill="black" stroke="black" points="27214.5,-3384.06 27211,-3374.06 27207.5,-3384.06 27214.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L6_split -->
<g id="node787" class="node">
<title>GPT3_2B_S1_R1_L6_split</title>
<polygon fill="orange" stroke="black" points="26769.7,-4682.96 26103.64,-4682.96 25932.3,-4606.96 26598.36,-4606.96 26769.7,-4682.96"/>
<text text-anchor="middle" x="26351" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="26351" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_norm1 -->
<g id="node788" class="node">
<title>GPT3_2B_S1_R1_L6_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26351" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L6_split&#45;&gt;GPT3_2B_S1_R1_L6_norm1 -->
<g id="edge728" class="edge">
<title>GPT3_2B_S1_R1_L6_split&#45;&gt;GPT3_2B_S1_R1_L6_norm1</title>
<path fill="none" stroke="black" d="M26351,-4606.75C26351,-4587.54 26351,-4564.2 26351,-4545.16"/>
<polygon fill="black" stroke="black" points="26354.5,-4545.07 26351,-4535.07 26347.5,-4545.07 26354.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L6_qkv -->
<g id="node789" class="node">
<title>GPT3_2B_S1_R1_L6_qkv</title>
<polygon fill="lightcoral" stroke="black" points="26493,-4409.22 26209,-4409.22 26209,-4371.22 26493,-4371.22 26493,-4409.22"/>
<text text-anchor="middle" x="26351" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="26351" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_norm1&#45;&gt;GPT3_2B_S1_R1_L6_qkv -->
<g id="edge729" class="edge">
<title>GPT3_2B_S1_R1_L6_norm1&#45;&gt;GPT3_2B_S1_R1_L6_qkv</title>
<path fill="none" stroke="black" d="M26351,-4481.08C26351,-4462.81 26351,-4438.39 26351,-4419.61"/>
<polygon fill="black" stroke="black" points="26354.5,-4419.57 26351,-4409.57 26347.5,-4419.57 26354.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L6_attn -->
<g id="node790" class="node">
<title>GPT3_2B_S1_R1_L6_attn</title>
<polygon fill="lightcoral" stroke="black" points="26493,-4299.22 26209,-4299.22 26209,-4261.22 26493,-4261.22 26493,-4299.22"/>
<text text-anchor="middle" x="26351" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="26351" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_qkv&#45;&gt;GPT3_2B_S1_R1_L6_attn -->
<g id="edge730" class="edge">
<title>GPT3_2B_S1_R1_L6_qkv&#45;&gt;GPT3_2B_S1_R1_L6_attn</title>
<path fill="none" stroke="black" d="M26351,-4370.9C26351,-4354.04 26351,-4328.78 26351,-4309.36"/>
<polygon fill="black" stroke="black" points="26354.5,-4309.27 26351,-4299.27 26347.5,-4309.27 26354.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L6_ar1 -->
<g id="node791" class="node">
<title>GPT3_2B_S1_R1_L6_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="26351" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_attn&#45;&gt;GPT3_2B_S1_R1_L6_ar1 -->
<g id="edge731" class="edge">
<title>GPT3_2B_S1_R1_L6_attn&#45;&gt;GPT3_2B_S1_R1_L6_ar1</title>
<path fill="none" stroke="black" d="M26351,-4261.11C26351,-4244.74 26351,-4220.15 26351,-4199.73"/>
<polygon fill="black" stroke="black" points="26354.5,-4199.49 26351,-4189.49 26347.5,-4199.49 26354.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L6_res1 -->
<g id="node792" class="node">
<title>GPT3_2B_S1_R1_L6_res1</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-4063.48 26299.11,-4063.48 26263.16,-4027.48 26402.89,-4027.48 26438.84,-4063.48"/>
<text text-anchor="middle" x="26351" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L6_ar1&#45;&gt;GPT3_2B_S1_R1_L6_res1 -->
<g id="edge732" class="edge">
<title>GPT3_2B_S1_R1_L6_ar1&#45;&gt;GPT3_2B_S1_R1_L6_res1</title>
<path fill="none" stroke="black" d="M26351,-4135.28C26351,-4116.91 26351,-4092.36 26351,-4073.73"/>
<polygon fill="black" stroke="black" points="26354.5,-4073.54 26351,-4063.54 26347.5,-4073.54 26354.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L6_norm2 -->
<g id="node793" class="node">
<title>GPT3_2B_S1_R1_L6_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="26351" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L6_res1&#45;&gt;GPT3_2B_S1_R1_L6_norm2 -->
<g id="edge733" class="edge">
<title>GPT3_2B_S1_R1_L6_res1&#45;&gt;GPT3_2B_S1_R1_L6_norm2</title>
<path fill="none" stroke="black" d="M26351,-4027.03C26351,-4010.89 26351,-3986.38 26351,-3965.99"/>
<polygon fill="black" stroke="black" points="26354.5,-3965.76 26351,-3955.76 26347.5,-3965.76 26354.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_up -->
<g id="node794" class="node">
<title>GPT3_2B_S1_R1_L6_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-3829.74 26244.5,-3829.74 26244.5,-3791.74 26457.5,-3791.74 26457.5,-3829.74"/>
<text text-anchor="middle" x="26351" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="26351" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_norm2&#45;&gt;GPT3_2B_S1_R1_L6_ffn_up -->
<g id="edge734" class="edge">
<title>GPT3_2B_S1_R1_L6_norm2&#45;&gt;GPT3_2B_S1_R1_L6_ffn_up</title>
<path fill="none" stroke="black" d="M26351,-3901.6C26351,-3883.33 26351,-3858.91 26351,-3840.13"/>
<polygon fill="black" stroke="black" points="26354.5,-3840.09 26351,-3830.09 26347.5,-3840.09 26354.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_gate -->
<g id="node795" class="node">
<title>GPT3_2B_S1_R1_L6_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-3719.74 26244.5,-3719.74 26244.5,-3681.74 26457.5,-3681.74 26457.5,-3719.74"/>
<text text-anchor="middle" x="26351" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="26351" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_up&#45;&gt;GPT3_2B_S1_R1_L6_ffn_gate -->
<g id="edge735" class="edge">
<title>GPT3_2B_S1_R1_L6_ffn_up&#45;&gt;GPT3_2B_S1_R1_L6_ffn_gate</title>
<path fill="none" stroke="black" d="M26351,-3791.41C26351,-3774.56 26351,-3749.3 26351,-3729.88"/>
<polygon fill="black" stroke="black" points="26354.5,-3729.79 26351,-3719.79 26347.5,-3729.79 26354.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_down -->
<g id="node796" class="node">
<title>GPT3_2B_S1_R1_L6_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-3609.74 26244.5,-3609.74 26244.5,-3571.74 26457.5,-3571.74 26457.5,-3609.74"/>
<text text-anchor="middle" x="26351" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="26351" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L6_ffn_down -->
<g id="edge736" class="edge">
<title>GPT3_2B_S1_R1_L6_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L6_ffn_down</title>
<path fill="none" stroke="black" d="M26351,-3681.41C26351,-3664.56 26351,-3639.3 26351,-3619.88"/>
<polygon fill="black" stroke="black" points="26354.5,-3619.79 26351,-3609.79 26347.5,-3619.79 26354.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L6_ar2 -->
<g id="node797" class="node">
<title>GPT3_2B_S1_R1_L6_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="26351" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L6_ffn_down&#45;&gt;GPT3_2B_S1_R1_L6_ar2 -->
<g id="edge737" class="edge">
<title>GPT3_2B_S1_R1_L6_ffn_down&#45;&gt;GPT3_2B_S1_R1_L6_ar2</title>
<path fill="none" stroke="black" d="M26351,-3571.63C26351,-3555.26 26351,-3530.67 26351,-3510.25"/>
<polygon fill="black" stroke="black" points="26354.5,-3510.01 26351,-3500.01 26347.5,-3510.01 26354.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L6_res2 -->
<g id="node798" class="node">
<title>GPT3_2B_S1_R1_L6_res2</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-3374 26299.11,-3374 26263.16,-3338 26402.89,-3338 26438.84,-3374"/>
<text text-anchor="middle" x="26351" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L6_ar2&#45;&gt;GPT3_2B_S1_R1_L6_res2 -->
<g id="edge738" class="edge">
<title>GPT3_2B_S1_R1_L6_ar2&#45;&gt;GPT3_2B_S1_R1_L6_res2</title>
<path fill="none" stroke="black" d="M26351,-3445.8C26351,-3427.43 26351,-3402.88 26351,-3384.25"/>
<polygon fill="black" stroke="black" points="26354.5,-3384.06 26351,-3374.06 26347.5,-3384.06 26354.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L7_split -->
<g id="node799" class="node">
<title>GPT3_2B_S1_R1_L7_split</title>
<polygon fill="orange" stroke="black" points="25909.7,-4682.96 25243.64,-4682.96 25072.3,-4606.96 25738.36,-4606.96 25909.7,-4682.96"/>
<text text-anchor="middle" x="25491" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="25491" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_norm1 -->
<g id="node800" class="node">
<title>GPT3_2B_S1_R1_L7_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25491" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L7_split&#45;&gt;GPT3_2B_S1_R1_L7_norm1 -->
<g id="edge739" class="edge">
<title>GPT3_2B_S1_R1_L7_split&#45;&gt;GPT3_2B_S1_R1_L7_norm1</title>
<path fill="none" stroke="black" d="M25491,-4606.75C25491,-4587.54 25491,-4564.2 25491,-4545.16"/>
<polygon fill="black" stroke="black" points="25494.5,-4545.07 25491,-4535.07 25487.5,-4545.07 25494.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R1_L7_qkv -->
<g id="node801" class="node">
<title>GPT3_2B_S1_R1_L7_qkv</title>
<polygon fill="lightcoral" stroke="black" points="25633,-4409.22 25349,-4409.22 25349,-4371.22 25633,-4371.22 25633,-4409.22"/>
<text text-anchor="middle" x="25491" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="25491" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_norm1&#45;&gt;GPT3_2B_S1_R1_L7_qkv -->
<g id="edge740" class="edge">
<title>GPT3_2B_S1_R1_L7_norm1&#45;&gt;GPT3_2B_S1_R1_L7_qkv</title>
<path fill="none" stroke="black" d="M25491,-4481.08C25491,-4462.81 25491,-4438.39 25491,-4419.61"/>
<polygon fill="black" stroke="black" points="25494.5,-4419.57 25491,-4409.57 25487.5,-4419.57 25494.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L7_attn -->
<g id="node802" class="node">
<title>GPT3_2B_S1_R1_L7_attn</title>
<polygon fill="lightcoral" stroke="black" points="25633,-4299.22 25349,-4299.22 25349,-4261.22 25633,-4261.22 25633,-4299.22"/>
<text text-anchor="middle" x="25491" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="25491" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_qkv&#45;&gt;GPT3_2B_S1_R1_L7_attn -->
<g id="edge741" class="edge">
<title>GPT3_2B_S1_R1_L7_qkv&#45;&gt;GPT3_2B_S1_R1_L7_attn</title>
<path fill="none" stroke="black" d="M25491,-4370.9C25491,-4354.04 25491,-4328.78 25491,-4309.36"/>
<polygon fill="black" stroke="black" points="25494.5,-4309.27 25491,-4299.27 25487.5,-4309.27 25494.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L7_ar1 -->
<g id="node803" class="node">
<title>GPT3_2B_S1_R1_L7_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="25491" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_attn&#45;&gt;GPT3_2B_S1_R1_L7_ar1 -->
<g id="edge742" class="edge">
<title>GPT3_2B_S1_R1_L7_attn&#45;&gt;GPT3_2B_S1_R1_L7_ar1</title>
<path fill="none" stroke="black" d="M25491,-4261.11C25491,-4244.74 25491,-4220.15 25491,-4199.73"/>
<polygon fill="black" stroke="black" points="25494.5,-4199.49 25491,-4189.49 25487.5,-4199.49 25494.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R1_L7_res1 -->
<g id="node804" class="node">
<title>GPT3_2B_S1_R1_L7_res1</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-4063.48 25439.11,-4063.48 25403.16,-4027.48 25542.89,-4027.48 25578.84,-4063.48"/>
<text text-anchor="middle" x="25491" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L7_ar1&#45;&gt;GPT3_2B_S1_R1_L7_res1 -->
<g id="edge743" class="edge">
<title>GPT3_2B_S1_R1_L7_ar1&#45;&gt;GPT3_2B_S1_R1_L7_res1</title>
<path fill="none" stroke="black" d="M25491,-4135.28C25491,-4116.91 25491,-4092.36 25491,-4073.73"/>
<polygon fill="black" stroke="black" points="25494.5,-4073.54 25491,-4063.54 25487.5,-4073.54 25494.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R1_L7_norm2 -->
<g id="node805" class="node">
<title>GPT3_2B_S1_R1_L7_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="25491" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L7_res1&#45;&gt;GPT3_2B_S1_R1_L7_norm2 -->
<g id="edge744" class="edge">
<title>GPT3_2B_S1_R1_L7_res1&#45;&gt;GPT3_2B_S1_R1_L7_norm2</title>
<path fill="none" stroke="black" d="M25491,-4027.03C25491,-4010.89 25491,-3986.38 25491,-3965.99"/>
<polygon fill="black" stroke="black" points="25494.5,-3965.76 25491,-3955.76 25487.5,-3965.76 25494.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_up -->
<g id="node806" class="node">
<title>GPT3_2B_S1_R1_L7_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-3829.74 25384.5,-3829.74 25384.5,-3791.74 25597.5,-3791.74 25597.5,-3829.74"/>
<text text-anchor="middle" x="25491" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="25491" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_norm2&#45;&gt;GPT3_2B_S1_R1_L7_ffn_up -->
<g id="edge745" class="edge">
<title>GPT3_2B_S1_R1_L7_norm2&#45;&gt;GPT3_2B_S1_R1_L7_ffn_up</title>
<path fill="none" stroke="black" d="M25491,-3901.6C25491,-3883.33 25491,-3858.91 25491,-3840.13"/>
<polygon fill="black" stroke="black" points="25494.5,-3840.09 25491,-3830.09 25487.5,-3840.09 25494.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_gate -->
<g id="node807" class="node">
<title>GPT3_2B_S1_R1_L7_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-3719.74 25384.5,-3719.74 25384.5,-3681.74 25597.5,-3681.74 25597.5,-3719.74"/>
<text text-anchor="middle" x="25491" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="25491" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_up&#45;&gt;GPT3_2B_S1_R1_L7_ffn_gate -->
<g id="edge746" class="edge">
<title>GPT3_2B_S1_R1_L7_ffn_up&#45;&gt;GPT3_2B_S1_R1_L7_ffn_gate</title>
<path fill="none" stroke="black" d="M25491,-3791.41C25491,-3774.56 25491,-3749.3 25491,-3729.88"/>
<polygon fill="black" stroke="black" points="25494.5,-3729.79 25491,-3719.79 25487.5,-3729.79 25494.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_down -->
<g id="node808" class="node">
<title>GPT3_2B_S1_R1_L7_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-3609.74 25384.5,-3609.74 25384.5,-3571.74 25597.5,-3571.74 25597.5,-3609.74"/>
<text text-anchor="middle" x="25491" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="25491" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L7_ffn_down -->
<g id="edge747" class="edge">
<title>GPT3_2B_S1_R1_L7_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L7_ffn_down</title>
<path fill="none" stroke="black" d="M25491,-3681.41C25491,-3664.56 25491,-3639.3 25491,-3619.88"/>
<polygon fill="black" stroke="black" points="25494.5,-3619.79 25491,-3609.79 25487.5,-3619.79 25494.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R1_L7_ar2 -->
<g id="node809" class="node">
<title>GPT3_2B_S1_R1_L7_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="25491" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L7_ffn_down&#45;&gt;GPT3_2B_S1_R1_L7_ar2 -->
<g id="edge748" class="edge">
<title>GPT3_2B_S1_R1_L7_ffn_down&#45;&gt;GPT3_2B_S1_R1_L7_ar2</title>
<path fill="none" stroke="black" d="M25491,-3571.63C25491,-3555.26 25491,-3530.67 25491,-3510.25"/>
<polygon fill="black" stroke="black" points="25494.5,-3510.01 25491,-3500.01 25487.5,-3510.01 25494.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R1_L7_res2 -->
<g id="node810" class="node">
<title>GPT3_2B_S1_R1_L7_res2</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-3374 25439.11,-3374 25403.16,-3338 25542.89,-3338 25578.84,-3374"/>
<text text-anchor="middle" x="25491" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L7_ar2&#45;&gt;GPT3_2B_S1_R1_L7_res2 -->
<g id="edge749" class="edge">
<title>GPT3_2B_S1_R1_L7_ar2&#45;&gt;GPT3_2B_S1_R1_L7_res2</title>
<path fill="none" stroke="black" d="M25491,-3445.8C25491,-3427.43 25491,-3402.88 25491,-3384.25"/>
<polygon fill="black" stroke="black" points="25494.5,-3384.06 25491,-3374.06 25487.5,-3384.06 25494.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R1_L8_split -->
<g id="node811" class="node">
<title>GPT3_2B_S1_R1_L8_split</title>
<polygon fill="orange" stroke="black" points="25049.7,-4682.96 24383.64,-4682.96 24212.3,-4606.96 24878.36,-4606.96 25049.7,-4682.96"/>
<text text-anchor="middle" x="24631" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="24631" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_norm1 -->
<g id="node812" class="node">
<title>GPT3_2B_S1_R1_L8_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="24592" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24592" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24592" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L8_split&#45;&gt;GPT3_2B_S1_R1_L8_norm1 -->
<g id="edge750" class="edge">
<title>GPT3_2B_S1_R1_L8_split&#45;&gt;GPT3_2B_S1_R1_L8_norm1</title>
<path fill="none" stroke="black" d="M24620.24,-4606.75C24614.66,-4587.45 24607.87,-4563.98 24602.35,-4544.89"/>
<polygon fill="black" stroke="black" points="24605.65,-4543.71 24599.51,-4535.07 24598.93,-4545.65 24605.65,-4543.71"/>
</g>
<!-- GPT3_2B_S1_R1_L8_qkv -->
<g id="node813" class="node">
<title>GPT3_2B_S1_R1_L8_qkv</title>
<polygon fill="lightcoral" stroke="black" points="24734,-4409.22 24450,-4409.22 24450,-4371.22 24734,-4371.22 24734,-4409.22"/>
<text text-anchor="middle" x="24592" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="24592" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_norm1&#45;&gt;GPT3_2B_S1_R1_L8_qkv -->
<g id="edge751" class="edge">
<title>GPT3_2B_S1_R1_L8_norm1&#45;&gt;GPT3_2B_S1_R1_L8_qkv</title>
<path fill="none" stroke="black" d="M24592,-4481.08C24592,-4462.81 24592,-4438.39 24592,-4419.61"/>
<polygon fill="black" stroke="black" points="24595.5,-4419.57 24592,-4409.57 24588.5,-4419.57 24595.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R1_L8_attn -->
<g id="node814" class="node">
<title>GPT3_2B_S1_R1_L8_attn</title>
<polygon fill="lightcoral" stroke="black" points="24734,-4299.22 24450,-4299.22 24450,-4261.22 24734,-4261.22 24734,-4299.22"/>
<text text-anchor="middle" x="24592" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="24592" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_qkv&#45;&gt;GPT3_2B_S1_R1_L8_attn -->
<g id="edge752" class="edge">
<title>GPT3_2B_S1_R1_L8_qkv&#45;&gt;GPT3_2B_S1_R1_L8_attn</title>
<path fill="none" stroke="black" d="M24592,-4370.9C24592,-4354.04 24592,-4328.78 24592,-4309.36"/>
<polygon fill="black" stroke="black" points="24595.5,-4309.27 24592,-4299.27 24588.5,-4309.27 24595.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R1_L8_ar1 -->
<g id="node815" class="node">
<title>GPT3_2B_S1_R1_L8_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24514" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24514" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="24514" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_attn&#45;&gt;GPT3_2B_S1_R1_L8_ar1 -->
<g id="edge753" class="edge">
<title>GPT3_2B_S1_R1_L8_attn&#45;&gt;GPT3_2B_S1_R1_L8_ar1</title>
<path fill="none" stroke="black" d="M24579.81,-4261.11C24568.36,-4244.1 24550.94,-4218.22 24536.9,-4197.36"/>
<polygon fill="black" stroke="black" points="24539.8,-4195.4 24531.31,-4189.06 24533.99,-4199.31 24539.8,-4195.4"/>
</g>
<!-- GPT3_2B_S1_R1_L8_res1 -->
<g id="node816" class="node">
<title>GPT3_2B_S1_R1_L8_res1</title>
<polygon fill="lightyellow" stroke="black" points="24600.84,-4063.48 24461.11,-4063.48 24425.16,-4027.48 24564.89,-4027.48 24600.84,-4063.48"/>
<text text-anchor="middle" x="24513" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R1_L8_ar1&#45;&gt;GPT3_2B_S1_R1_L8_res1 -->
<g id="edge754" class="edge">
<title>GPT3_2B_S1_R1_L8_ar1&#45;&gt;GPT3_2B_S1_R1_L8_res1</title>
<path fill="none" stroke="black" d="M24513.77,-4135.28C24513.61,-4116.91 24513.4,-4092.36 24513.24,-4073.73"/>
<polygon fill="black" stroke="black" points="24516.74,-4073.51 24513.15,-4063.54 24509.74,-4073.57 24516.74,-4073.51"/>
</g>
<!-- GPT3_2B_S1_R1_L8_norm2 -->
<g id="node817" class="node">
<title>GPT3_2B_S1_R1_L8_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="24357" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24357" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="24357" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_1</text>
</g>
<!-- GPT3_2B_S1_R1_L8_res1&#45;&gt;GPT3_2B_S1_R1_L8_norm2 -->
<g id="edge755" class="edge">
<title>GPT3_2B_S1_R1_L8_res1&#45;&gt;GPT3_2B_S1_R1_L8_norm2</title>
<path fill="none" stroke="black" d="M24489.65,-4027.28C24465.43,-4009.45 24427.1,-3981.22 24397.85,-3959.69"/>
<polygon fill="black" stroke="black" points="24399.61,-3956.63 24389.48,-3953.52 24395.46,-3962.27 24399.61,-3956.63"/>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_up -->
<g id="node818" class="node">
<title>GPT3_2B_S1_R1_L8_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="24461.5,-3829.74 24248.5,-3829.74 24248.5,-3791.74 24461.5,-3791.74 24461.5,-3829.74"/>
<text text-anchor="middle" x="24355" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="24355" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_norm2&#45;&gt;GPT3_2B_S1_R1_L8_ffn_up -->
<g id="edge756" class="edge">
<title>GPT3_2B_S1_R1_L8_norm2&#45;&gt;GPT3_2B_S1_R1_L8_ffn_up</title>
<path fill="none" stroke="black" d="M24356.55,-3901.6C24356.24,-3883.33 24355.81,-3858.91 24355.49,-3840.13"/>
<polygon fill="black" stroke="black" points="24358.99,-3840.02 24355.32,-3830.09 24351.99,-3840.15 24358.99,-3840.02"/>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_gate -->
<g id="node819" class="node">
<title>GPT3_2B_S1_R1_L8_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="24457.5,-3719.74 24244.5,-3719.74 24244.5,-3681.74 24457.5,-3681.74 24457.5,-3719.74"/>
<text text-anchor="middle" x="24351" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="24351" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_up&#45;&gt;GPT3_2B_S1_R1_L8_ffn_gate -->
<g id="edge757" class="edge">
<title>GPT3_2B_S1_R1_L8_ffn_up&#45;&gt;GPT3_2B_S1_R1_L8_ffn_gate</title>
<path fill="none" stroke="black" d="M24354.32,-3791.41C24353.7,-3774.56 24352.76,-3749.3 24352.04,-3729.88"/>
<polygon fill="black" stroke="black" points="24355.54,-3729.65 24351.67,-3719.79 24348.54,-3729.91 24355.54,-3729.65"/>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_down -->
<g id="node820" class="node">
<title>GPT3_2B_S1_R1_L8_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="24450.5,-3609.74 24237.5,-3609.74 24237.5,-3571.74 24450.5,-3571.74 24450.5,-3609.74"/>
<text text-anchor="middle" x="24344" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="24344" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L8_ffn_down -->
<g id="edge758" class="edge">
<title>GPT3_2B_S1_R1_L8_ffn_gate&#45;&gt;GPT3_2B_S1_R1_L8_ffn_down</title>
<path fill="none" stroke="black" d="M24349.81,-3681.41C24348.72,-3664.56 24347.08,-3639.3 24345.82,-3619.88"/>
<polygon fill="black" stroke="black" points="24349.31,-3619.54 24345.17,-3609.79 24342.32,-3619.99 24349.31,-3619.54"/>
</g>
<!-- GPT3_2B_S1_R1_L8_ar2 -->
<g id="node821" class="node">
<title>GPT3_2B_S1_R1_L8_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24315" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24315" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="24315" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_ffn_down&#45;&gt;GPT3_2B_S1_R1_L8_ar2 -->
<g id="edge759" class="edge">
<title>GPT3_2B_S1_R1_L8_ffn_down&#45;&gt;GPT3_2B_S1_R1_L8_ar2</title>
<path fill="none" stroke="black" d="M24339.47,-3571.63C24335.35,-3555.19 24329.16,-3530.45 24324.04,-3509.97"/>
<polygon fill="black" stroke="black" points="24327.37,-3508.86 24321.54,-3500.01 24320.58,-3510.56 24327.37,-3508.86"/>
</g>
<!-- GPT3_2B_S1_R1_L8_res2 -->
<g id="node822" class="node">
<title>GPT3_2B_S1_R1_L8_res2</title>
<polygon fill="lightyellow" stroke="black" points="24388.84,-3374 24249.11,-3374 24213.16,-3338 24352.89,-3338 24388.84,-3374"/>
<text text-anchor="middle" x="24301" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R1_L8_ar2&#45;&gt;GPT3_2B_S1_R1_L8_res2 -->
<g id="edge760" class="edge">
<title>GPT3_2B_S1_R1_L8_ar2&#45;&gt;GPT3_2B_S1_R1_L8_res2</title>
<path fill="none" stroke="black" d="M24311.82,-3445.8C24309.57,-3427.34 24306.56,-3402.65 24304.29,-3383.99"/>
<polygon fill="black" stroke="black" points="24307.76,-3383.56 24303.08,-3374.06 24300.82,-3384.41 24307.76,-3383.56"/>
</g>
<!-- GPT3_2B_comm_1_2 -->
<g id="node1303" class="node">
<title>GPT3_2B_comm_1_2</title>
<ellipse fill="lightyellow" stroke="black" stroke-dasharray="5,2" cx="24035" cy="-3228.52" rx="200.64" ry="37.45"/>
<text text-anchor="middle" x="24035" y="-3239.82" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="24035" y="-3224.82" font-family="Times,serif" font-size="14.00">Stage 1 → 2</text>
<text text-anchor="middle" x="24035" y="-3209.82" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]</text>
</g>
<!-- GPT3_2B_S1_R1_L8_res2&#45;&gt;GPT3_2B_comm_1_2 -->
<g id="edge1201" class="edge">
<title>GPT3_2B_S1_R1_L8_res2&#45;&gt;GPT3_2B_comm_1_2</title>
<path fill="none" stroke="black" d="M24264.85,-3337.94C24226.87,-3320.03 24165.88,-3291.26 24116.27,-3267.85"/>
<polygon fill="black" stroke="black" points="24117.68,-3264.65 24107.15,-3263.55 24114.7,-3270.98 24117.68,-3264.65"/>
</g>
<!-- GPT3_2B_S1_R2_L1_split -->
<g id="node823" class="node">
<title>GPT3_2B_S1_R2_L1_split</title>
<polygon fill="orange" stroke="black" points="24187.7,-4682.96 23521.64,-4682.96 23350.3,-4606.96 24016.36,-4606.96 24187.7,-4682.96"/>
<text text-anchor="middle" x="23769" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="23769" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_norm1 -->
<g id="node824" class="node">
<title>GPT3_2B_S1_R2_L1_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23769" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L1_split&#45;&gt;GPT3_2B_S1_R2_L1_norm1 -->
<g id="edge761" class="edge">
<title>GPT3_2B_S1_R2_L1_split&#45;&gt;GPT3_2B_S1_R2_L1_norm1</title>
<path fill="none" stroke="black" d="M23769,-4606.75C23769,-4587.54 23769,-4564.2 23769,-4545.16"/>
<polygon fill="black" stroke="black" points="23772.5,-4545.07 23769,-4535.07 23765.5,-4545.07 23772.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L1_qkv -->
<g id="node825" class="node">
<title>GPT3_2B_S1_R2_L1_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23911,-4409.22 23627,-4409.22 23627,-4371.22 23911,-4371.22 23911,-4409.22"/>
<text text-anchor="middle" x="23769" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="23769" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_norm1&#45;&gt;GPT3_2B_S1_R2_L1_qkv -->
<g id="edge762" class="edge">
<title>GPT3_2B_S1_R2_L1_norm1&#45;&gt;GPT3_2B_S1_R2_L1_qkv</title>
<path fill="none" stroke="black" d="M23769,-4481.08C23769,-4462.81 23769,-4438.39 23769,-4419.61"/>
<polygon fill="black" stroke="black" points="23772.5,-4419.57 23769,-4409.57 23765.5,-4419.57 23772.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L1_attn -->
<g id="node826" class="node">
<title>GPT3_2B_S1_R2_L1_attn</title>
<polygon fill="lightcoral" stroke="black" points="23911,-4299.22 23627,-4299.22 23627,-4261.22 23911,-4261.22 23911,-4299.22"/>
<text text-anchor="middle" x="23769" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="23769" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_qkv&#45;&gt;GPT3_2B_S1_R2_L1_attn -->
<g id="edge763" class="edge">
<title>GPT3_2B_S1_R2_L1_qkv&#45;&gt;GPT3_2B_S1_R2_L1_attn</title>
<path fill="none" stroke="black" d="M23769,-4370.9C23769,-4354.04 23769,-4328.78 23769,-4309.36"/>
<polygon fill="black" stroke="black" points="23772.5,-4309.27 23769,-4299.27 23765.5,-4309.27 23772.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L1_ar1 -->
<g id="node827" class="node">
<title>GPT3_2B_S1_R2_L1_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23769" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_attn&#45;&gt;GPT3_2B_S1_R2_L1_ar1 -->
<g id="edge764" class="edge">
<title>GPT3_2B_S1_R2_L1_attn&#45;&gt;GPT3_2B_S1_R2_L1_ar1</title>
<path fill="none" stroke="black" d="M23769,-4261.11C23769,-4244.74 23769,-4220.15 23769,-4199.73"/>
<polygon fill="black" stroke="black" points="23772.5,-4199.49 23769,-4189.49 23765.5,-4199.49 23772.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L1_res1 -->
<g id="node828" class="node">
<title>GPT3_2B_S1_R2_L1_res1</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-4063.48 23717.11,-4063.48 23681.16,-4027.48 23820.89,-4027.48 23856.84,-4063.48"/>
<text text-anchor="middle" x="23769" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L1_ar1&#45;&gt;GPT3_2B_S1_R2_L1_res1 -->
<g id="edge765" class="edge">
<title>GPT3_2B_S1_R2_L1_ar1&#45;&gt;GPT3_2B_S1_R2_L1_res1</title>
<path fill="none" stroke="black" d="M23769,-4135.28C23769,-4116.91 23769,-4092.36 23769,-4073.73"/>
<polygon fill="black" stroke="black" points="23772.5,-4073.54 23769,-4063.54 23765.5,-4073.54 23772.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L1_norm2 -->
<g id="node829" class="node">
<title>GPT3_2B_S1_R2_L1_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="23769" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L1_res1&#45;&gt;GPT3_2B_S1_R2_L1_norm2 -->
<g id="edge766" class="edge">
<title>GPT3_2B_S1_R2_L1_res1&#45;&gt;GPT3_2B_S1_R2_L1_norm2</title>
<path fill="none" stroke="black" d="M23769,-4027.03C23769,-4010.89 23769,-3986.38 23769,-3965.99"/>
<polygon fill="black" stroke="black" points="23772.5,-3965.76 23769,-3955.76 23765.5,-3965.76 23772.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_up -->
<g id="node830" class="node">
<title>GPT3_2B_S1_R2_L1_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-3829.74 23662.5,-3829.74 23662.5,-3791.74 23875.5,-3791.74 23875.5,-3829.74"/>
<text text-anchor="middle" x="23769" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="23769" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_norm2&#45;&gt;GPT3_2B_S1_R2_L1_ffn_up -->
<g id="edge767" class="edge">
<title>GPT3_2B_S1_R2_L1_norm2&#45;&gt;GPT3_2B_S1_R2_L1_ffn_up</title>
<path fill="none" stroke="black" d="M23769,-3901.6C23769,-3883.33 23769,-3858.91 23769,-3840.13"/>
<polygon fill="black" stroke="black" points="23772.5,-3840.09 23769,-3830.09 23765.5,-3840.09 23772.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_gate -->
<g id="node831" class="node">
<title>GPT3_2B_S1_R2_L1_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-3719.74 23662.5,-3719.74 23662.5,-3681.74 23875.5,-3681.74 23875.5,-3719.74"/>
<text text-anchor="middle" x="23769" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="23769" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_up&#45;&gt;GPT3_2B_S1_R2_L1_ffn_gate -->
<g id="edge768" class="edge">
<title>GPT3_2B_S1_R2_L1_ffn_up&#45;&gt;GPT3_2B_S1_R2_L1_ffn_gate</title>
<path fill="none" stroke="black" d="M23769,-3791.41C23769,-3774.56 23769,-3749.3 23769,-3729.88"/>
<polygon fill="black" stroke="black" points="23772.5,-3729.79 23769,-3719.79 23765.5,-3729.79 23772.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_down -->
<g id="node832" class="node">
<title>GPT3_2B_S1_R2_L1_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-3609.74 23662.5,-3609.74 23662.5,-3571.74 23875.5,-3571.74 23875.5,-3609.74"/>
<text text-anchor="middle" x="23769" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="23769" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L1_ffn_down -->
<g id="edge769" class="edge">
<title>GPT3_2B_S1_R2_L1_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L1_ffn_down</title>
<path fill="none" stroke="black" d="M23769,-3681.41C23769,-3664.56 23769,-3639.3 23769,-3619.88"/>
<polygon fill="black" stroke="black" points="23772.5,-3619.79 23769,-3609.79 23765.5,-3619.79 23772.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L1_ar2 -->
<g id="node833" class="node">
<title>GPT3_2B_S1_R2_L1_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="23769" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L1_ffn_down&#45;&gt;GPT3_2B_S1_R2_L1_ar2 -->
<g id="edge770" class="edge">
<title>GPT3_2B_S1_R2_L1_ffn_down&#45;&gt;GPT3_2B_S1_R2_L1_ar2</title>
<path fill="none" stroke="black" d="M23769,-3571.63C23769,-3555.26 23769,-3530.67 23769,-3510.25"/>
<polygon fill="black" stroke="black" points="23772.5,-3510.01 23769,-3500.01 23765.5,-3510.01 23772.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L1_res2 -->
<g id="node834" class="node">
<title>GPT3_2B_S1_R2_L1_res2</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-3374 23717.11,-3374 23681.16,-3338 23820.89,-3338 23856.84,-3374"/>
<text text-anchor="middle" x="23769" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L1_ar2&#45;&gt;GPT3_2B_S1_R2_L1_res2 -->
<g id="edge771" class="edge">
<title>GPT3_2B_S1_R2_L1_ar2&#45;&gt;GPT3_2B_S1_R2_L1_res2</title>
<path fill="none" stroke="black" d="M23769,-3445.8C23769,-3427.43 23769,-3402.88 23769,-3384.25"/>
<polygon fill="black" stroke="black" points="23772.5,-3384.06 23769,-3374.06 23765.5,-3384.06 23772.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L2_split -->
<g id="node835" class="node">
<title>GPT3_2B_S1_R2_L2_split</title>
<polygon fill="orange" stroke="black" points="23327.7,-4682.96 22661.64,-4682.96 22490.3,-4606.96 23156.36,-4606.96 23327.7,-4682.96"/>
<text text-anchor="middle" x="22909" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22909" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_norm1 -->
<g id="node836" class="node">
<title>GPT3_2B_S1_R2_L2_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22909" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L2_split&#45;&gt;GPT3_2B_S1_R2_L2_norm1 -->
<g id="edge772" class="edge">
<title>GPT3_2B_S1_R2_L2_split&#45;&gt;GPT3_2B_S1_R2_L2_norm1</title>
<path fill="none" stroke="black" d="M22909,-4606.75C22909,-4587.54 22909,-4564.2 22909,-4545.16"/>
<polygon fill="black" stroke="black" points="22912.5,-4545.07 22909,-4535.07 22905.5,-4545.07 22912.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L2_qkv -->
<g id="node837" class="node">
<title>GPT3_2B_S1_R2_L2_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23051,-4409.22 22767,-4409.22 22767,-4371.22 23051,-4371.22 23051,-4409.22"/>
<text text-anchor="middle" x="22909" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22909" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_norm1&#45;&gt;GPT3_2B_S1_R2_L2_qkv -->
<g id="edge773" class="edge">
<title>GPT3_2B_S1_R2_L2_norm1&#45;&gt;GPT3_2B_S1_R2_L2_qkv</title>
<path fill="none" stroke="black" d="M22909,-4481.08C22909,-4462.81 22909,-4438.39 22909,-4419.61"/>
<polygon fill="black" stroke="black" points="22912.5,-4419.57 22909,-4409.57 22905.5,-4419.57 22912.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L2_attn -->
<g id="node838" class="node">
<title>GPT3_2B_S1_R2_L2_attn</title>
<polygon fill="lightcoral" stroke="black" points="23051,-4299.22 22767,-4299.22 22767,-4261.22 23051,-4261.22 23051,-4299.22"/>
<text text-anchor="middle" x="22909" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22909" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_qkv&#45;&gt;GPT3_2B_S1_R2_L2_attn -->
<g id="edge774" class="edge">
<title>GPT3_2B_S1_R2_L2_qkv&#45;&gt;GPT3_2B_S1_R2_L2_attn</title>
<path fill="none" stroke="black" d="M22909,-4370.9C22909,-4354.04 22909,-4328.78 22909,-4309.36"/>
<polygon fill="black" stroke="black" points="22912.5,-4309.27 22909,-4299.27 22905.5,-4309.27 22912.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L2_ar1 -->
<g id="node839" class="node">
<title>GPT3_2B_S1_R2_L2_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22909" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_attn&#45;&gt;GPT3_2B_S1_R2_L2_ar1 -->
<g id="edge775" class="edge">
<title>GPT3_2B_S1_R2_L2_attn&#45;&gt;GPT3_2B_S1_R2_L2_ar1</title>
<path fill="none" stroke="black" d="M22909,-4261.11C22909,-4244.74 22909,-4220.15 22909,-4199.73"/>
<polygon fill="black" stroke="black" points="22912.5,-4199.49 22909,-4189.49 22905.5,-4199.49 22912.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L2_res1 -->
<g id="node840" class="node">
<title>GPT3_2B_S1_R2_L2_res1</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-4063.48 22857.11,-4063.48 22821.16,-4027.48 22960.89,-4027.48 22996.84,-4063.48"/>
<text text-anchor="middle" x="22909" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L2_ar1&#45;&gt;GPT3_2B_S1_R2_L2_res1 -->
<g id="edge776" class="edge">
<title>GPT3_2B_S1_R2_L2_ar1&#45;&gt;GPT3_2B_S1_R2_L2_res1</title>
<path fill="none" stroke="black" d="M22909,-4135.28C22909,-4116.91 22909,-4092.36 22909,-4073.73"/>
<polygon fill="black" stroke="black" points="22912.5,-4073.54 22909,-4063.54 22905.5,-4073.54 22912.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L2_norm2 -->
<g id="node841" class="node">
<title>GPT3_2B_S1_R2_L2_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22909" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L2_res1&#45;&gt;GPT3_2B_S1_R2_L2_norm2 -->
<g id="edge777" class="edge">
<title>GPT3_2B_S1_R2_L2_res1&#45;&gt;GPT3_2B_S1_R2_L2_norm2</title>
<path fill="none" stroke="black" d="M22909,-4027.03C22909,-4010.89 22909,-3986.38 22909,-3965.99"/>
<polygon fill="black" stroke="black" points="22912.5,-3965.76 22909,-3955.76 22905.5,-3965.76 22912.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_up -->
<g id="node842" class="node">
<title>GPT3_2B_S1_R2_L2_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-3829.74 22802.5,-3829.74 22802.5,-3791.74 23015.5,-3791.74 23015.5,-3829.74"/>
<text text-anchor="middle" x="22909" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22909" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_norm2&#45;&gt;GPT3_2B_S1_R2_L2_ffn_up -->
<g id="edge778" class="edge">
<title>GPT3_2B_S1_R2_L2_norm2&#45;&gt;GPT3_2B_S1_R2_L2_ffn_up</title>
<path fill="none" stroke="black" d="M22909,-3901.6C22909,-3883.33 22909,-3858.91 22909,-3840.13"/>
<polygon fill="black" stroke="black" points="22912.5,-3840.09 22909,-3830.09 22905.5,-3840.09 22912.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_gate -->
<g id="node843" class="node">
<title>GPT3_2B_S1_R2_L2_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-3719.74 22802.5,-3719.74 22802.5,-3681.74 23015.5,-3681.74 23015.5,-3719.74"/>
<text text-anchor="middle" x="22909" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22909" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_up&#45;&gt;GPT3_2B_S1_R2_L2_ffn_gate -->
<g id="edge779" class="edge">
<title>GPT3_2B_S1_R2_L2_ffn_up&#45;&gt;GPT3_2B_S1_R2_L2_ffn_gate</title>
<path fill="none" stroke="black" d="M22909,-3791.41C22909,-3774.56 22909,-3749.3 22909,-3729.88"/>
<polygon fill="black" stroke="black" points="22912.5,-3729.79 22909,-3719.79 22905.5,-3729.79 22912.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_down -->
<g id="node844" class="node">
<title>GPT3_2B_S1_R2_L2_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-3609.74 22802.5,-3609.74 22802.5,-3571.74 23015.5,-3571.74 23015.5,-3609.74"/>
<text text-anchor="middle" x="22909" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22909" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L2_ffn_down -->
<g id="edge780" class="edge">
<title>GPT3_2B_S1_R2_L2_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L2_ffn_down</title>
<path fill="none" stroke="black" d="M22909,-3681.41C22909,-3664.56 22909,-3639.3 22909,-3619.88"/>
<polygon fill="black" stroke="black" points="22912.5,-3619.79 22909,-3609.79 22905.5,-3619.79 22912.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L2_ar2 -->
<g id="node845" class="node">
<title>GPT3_2B_S1_R2_L2_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22909" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L2_ffn_down&#45;&gt;GPT3_2B_S1_R2_L2_ar2 -->
<g id="edge781" class="edge">
<title>GPT3_2B_S1_R2_L2_ffn_down&#45;&gt;GPT3_2B_S1_R2_L2_ar2</title>
<path fill="none" stroke="black" d="M22909,-3571.63C22909,-3555.26 22909,-3530.67 22909,-3510.25"/>
<polygon fill="black" stroke="black" points="22912.5,-3510.01 22909,-3500.01 22905.5,-3510.01 22912.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L2_res2 -->
<g id="node846" class="node">
<title>GPT3_2B_S1_R2_L2_res2</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-3374 22857.11,-3374 22821.16,-3338 22960.89,-3338 22996.84,-3374"/>
<text text-anchor="middle" x="22909" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L2_ar2&#45;&gt;GPT3_2B_S1_R2_L2_res2 -->
<g id="edge782" class="edge">
<title>GPT3_2B_S1_R2_L2_ar2&#45;&gt;GPT3_2B_S1_R2_L2_res2</title>
<path fill="none" stroke="black" d="M22909,-3445.8C22909,-3427.43 22909,-3402.88 22909,-3384.25"/>
<polygon fill="black" stroke="black" points="22912.5,-3384.06 22909,-3374.06 22905.5,-3384.06 22912.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L3_split -->
<g id="node847" class="node">
<title>GPT3_2B_S1_R2_L3_split</title>
<polygon fill="orange" stroke="black" points="22467.7,-4682.96 21801.64,-4682.96 21630.3,-4606.96 22296.36,-4606.96 22467.7,-4682.96"/>
<text text-anchor="middle" x="22049" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22049" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_norm1 -->
<g id="node848" class="node">
<title>GPT3_2B_S1_R2_L3_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22049" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L3_split&#45;&gt;GPT3_2B_S1_R2_L3_norm1 -->
<g id="edge783" class="edge">
<title>GPT3_2B_S1_R2_L3_split&#45;&gt;GPT3_2B_S1_R2_L3_norm1</title>
<path fill="none" stroke="black" d="M22049,-4606.75C22049,-4587.54 22049,-4564.2 22049,-4545.16"/>
<polygon fill="black" stroke="black" points="22052.5,-4545.07 22049,-4535.07 22045.5,-4545.07 22052.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L3_qkv -->
<g id="node849" class="node">
<title>GPT3_2B_S1_R2_L3_qkv</title>
<polygon fill="lightcoral" stroke="black" points="22191,-4409.22 21907,-4409.22 21907,-4371.22 22191,-4371.22 22191,-4409.22"/>
<text text-anchor="middle" x="22049" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22049" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_norm1&#45;&gt;GPT3_2B_S1_R2_L3_qkv -->
<g id="edge784" class="edge">
<title>GPT3_2B_S1_R2_L3_norm1&#45;&gt;GPT3_2B_S1_R2_L3_qkv</title>
<path fill="none" stroke="black" d="M22049,-4481.08C22049,-4462.81 22049,-4438.39 22049,-4419.61"/>
<polygon fill="black" stroke="black" points="22052.5,-4419.57 22049,-4409.57 22045.5,-4419.57 22052.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L3_attn -->
<g id="node850" class="node">
<title>GPT3_2B_S1_R2_L3_attn</title>
<polygon fill="lightcoral" stroke="black" points="22191,-4299.22 21907,-4299.22 21907,-4261.22 22191,-4261.22 22191,-4299.22"/>
<text text-anchor="middle" x="22049" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22049" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_qkv&#45;&gt;GPT3_2B_S1_R2_L3_attn -->
<g id="edge785" class="edge">
<title>GPT3_2B_S1_R2_L3_qkv&#45;&gt;GPT3_2B_S1_R2_L3_attn</title>
<path fill="none" stroke="black" d="M22049,-4370.9C22049,-4354.04 22049,-4328.78 22049,-4309.36"/>
<polygon fill="black" stroke="black" points="22052.5,-4309.27 22049,-4299.27 22045.5,-4309.27 22052.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L3_ar1 -->
<g id="node851" class="node">
<title>GPT3_2B_S1_R2_L3_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22049" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_attn&#45;&gt;GPT3_2B_S1_R2_L3_ar1 -->
<g id="edge786" class="edge">
<title>GPT3_2B_S1_R2_L3_attn&#45;&gt;GPT3_2B_S1_R2_L3_ar1</title>
<path fill="none" stroke="black" d="M22049,-4261.11C22049,-4244.74 22049,-4220.15 22049,-4199.73"/>
<polygon fill="black" stroke="black" points="22052.5,-4199.49 22049,-4189.49 22045.5,-4199.49 22052.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L3_res1 -->
<g id="node852" class="node">
<title>GPT3_2B_S1_R2_L3_res1</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-4063.48 21997.11,-4063.48 21961.16,-4027.48 22100.89,-4027.48 22136.84,-4063.48"/>
<text text-anchor="middle" x="22049" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L3_ar1&#45;&gt;GPT3_2B_S1_R2_L3_res1 -->
<g id="edge787" class="edge">
<title>GPT3_2B_S1_R2_L3_ar1&#45;&gt;GPT3_2B_S1_R2_L3_res1</title>
<path fill="none" stroke="black" d="M22049,-4135.28C22049,-4116.91 22049,-4092.36 22049,-4073.73"/>
<polygon fill="black" stroke="black" points="22052.5,-4073.54 22049,-4063.54 22045.5,-4073.54 22052.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L3_norm2 -->
<g id="node853" class="node">
<title>GPT3_2B_S1_R2_L3_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22049" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L3_res1&#45;&gt;GPT3_2B_S1_R2_L3_norm2 -->
<g id="edge788" class="edge">
<title>GPT3_2B_S1_R2_L3_res1&#45;&gt;GPT3_2B_S1_R2_L3_norm2</title>
<path fill="none" stroke="black" d="M22049,-4027.03C22049,-4010.89 22049,-3986.38 22049,-3965.99"/>
<polygon fill="black" stroke="black" points="22052.5,-3965.76 22049,-3955.76 22045.5,-3965.76 22052.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_up -->
<g id="node854" class="node">
<title>GPT3_2B_S1_R2_L3_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-3829.74 21942.5,-3829.74 21942.5,-3791.74 22155.5,-3791.74 22155.5,-3829.74"/>
<text text-anchor="middle" x="22049" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22049" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_norm2&#45;&gt;GPT3_2B_S1_R2_L3_ffn_up -->
<g id="edge789" class="edge">
<title>GPT3_2B_S1_R2_L3_norm2&#45;&gt;GPT3_2B_S1_R2_L3_ffn_up</title>
<path fill="none" stroke="black" d="M22049,-3901.6C22049,-3883.33 22049,-3858.91 22049,-3840.13"/>
<polygon fill="black" stroke="black" points="22052.5,-3840.09 22049,-3830.09 22045.5,-3840.09 22052.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_gate -->
<g id="node855" class="node">
<title>GPT3_2B_S1_R2_L3_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-3719.74 21942.5,-3719.74 21942.5,-3681.74 22155.5,-3681.74 22155.5,-3719.74"/>
<text text-anchor="middle" x="22049" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22049" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_up&#45;&gt;GPT3_2B_S1_R2_L3_ffn_gate -->
<g id="edge790" class="edge">
<title>GPT3_2B_S1_R2_L3_ffn_up&#45;&gt;GPT3_2B_S1_R2_L3_ffn_gate</title>
<path fill="none" stroke="black" d="M22049,-3791.41C22049,-3774.56 22049,-3749.3 22049,-3729.88"/>
<polygon fill="black" stroke="black" points="22052.5,-3729.79 22049,-3719.79 22045.5,-3729.79 22052.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_down -->
<g id="node856" class="node">
<title>GPT3_2B_S1_R2_L3_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-3609.74 21942.5,-3609.74 21942.5,-3571.74 22155.5,-3571.74 22155.5,-3609.74"/>
<text text-anchor="middle" x="22049" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22049" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L3_ffn_down -->
<g id="edge791" class="edge">
<title>GPT3_2B_S1_R2_L3_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L3_ffn_down</title>
<path fill="none" stroke="black" d="M22049,-3681.41C22049,-3664.56 22049,-3639.3 22049,-3619.88"/>
<polygon fill="black" stroke="black" points="22052.5,-3619.79 22049,-3609.79 22045.5,-3619.79 22052.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L3_ar2 -->
<g id="node857" class="node">
<title>GPT3_2B_S1_R2_L3_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22049" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L3_ffn_down&#45;&gt;GPT3_2B_S1_R2_L3_ar2 -->
<g id="edge792" class="edge">
<title>GPT3_2B_S1_R2_L3_ffn_down&#45;&gt;GPT3_2B_S1_R2_L3_ar2</title>
<path fill="none" stroke="black" d="M22049,-3571.63C22049,-3555.26 22049,-3530.67 22049,-3510.25"/>
<polygon fill="black" stroke="black" points="22052.5,-3510.01 22049,-3500.01 22045.5,-3510.01 22052.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L3_res2 -->
<g id="node858" class="node">
<title>GPT3_2B_S1_R2_L3_res2</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-3374 21997.11,-3374 21961.16,-3338 22100.89,-3338 22136.84,-3374"/>
<text text-anchor="middle" x="22049" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L3_ar2&#45;&gt;GPT3_2B_S1_R2_L3_res2 -->
<g id="edge793" class="edge">
<title>GPT3_2B_S1_R2_L3_ar2&#45;&gt;GPT3_2B_S1_R2_L3_res2</title>
<path fill="none" stroke="black" d="M22049,-3445.8C22049,-3427.43 22049,-3402.88 22049,-3384.25"/>
<polygon fill="black" stroke="black" points="22052.5,-3384.06 22049,-3374.06 22045.5,-3384.06 22052.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L4_split -->
<g id="node859" class="node">
<title>GPT3_2B_S1_R2_L4_split</title>
<polygon fill="orange" stroke="black" points="21607.7,-4682.96 20941.64,-4682.96 20770.3,-4606.96 21436.36,-4606.96 21607.7,-4682.96"/>
<text text-anchor="middle" x="21189" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="21189" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_norm1 -->
<g id="node860" class="node">
<title>GPT3_2B_S1_R2_L4_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21189" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L4_split&#45;&gt;GPT3_2B_S1_R2_L4_norm1 -->
<g id="edge794" class="edge">
<title>GPT3_2B_S1_R2_L4_split&#45;&gt;GPT3_2B_S1_R2_L4_norm1</title>
<path fill="none" stroke="black" d="M21189,-4606.75C21189,-4587.54 21189,-4564.2 21189,-4545.16"/>
<polygon fill="black" stroke="black" points="21192.5,-4545.07 21189,-4535.07 21185.5,-4545.07 21192.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L4_qkv -->
<g id="node861" class="node">
<title>GPT3_2B_S1_R2_L4_qkv</title>
<polygon fill="lightcoral" stroke="black" points="21331,-4409.22 21047,-4409.22 21047,-4371.22 21331,-4371.22 21331,-4409.22"/>
<text text-anchor="middle" x="21189" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="21189" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_norm1&#45;&gt;GPT3_2B_S1_R2_L4_qkv -->
<g id="edge795" class="edge">
<title>GPT3_2B_S1_R2_L4_norm1&#45;&gt;GPT3_2B_S1_R2_L4_qkv</title>
<path fill="none" stroke="black" d="M21189,-4481.08C21189,-4462.81 21189,-4438.39 21189,-4419.61"/>
<polygon fill="black" stroke="black" points="21192.5,-4419.57 21189,-4409.57 21185.5,-4419.57 21192.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L4_attn -->
<g id="node862" class="node">
<title>GPT3_2B_S1_R2_L4_attn</title>
<polygon fill="lightcoral" stroke="black" points="21331,-4299.22 21047,-4299.22 21047,-4261.22 21331,-4261.22 21331,-4299.22"/>
<text text-anchor="middle" x="21189" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="21189" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_qkv&#45;&gt;GPT3_2B_S1_R2_L4_attn -->
<g id="edge796" class="edge">
<title>GPT3_2B_S1_R2_L4_qkv&#45;&gt;GPT3_2B_S1_R2_L4_attn</title>
<path fill="none" stroke="black" d="M21189,-4370.9C21189,-4354.04 21189,-4328.78 21189,-4309.36"/>
<polygon fill="black" stroke="black" points="21192.5,-4309.27 21189,-4299.27 21185.5,-4309.27 21192.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L4_ar1 -->
<g id="node863" class="node">
<title>GPT3_2B_S1_R2_L4_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="21189" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_attn&#45;&gt;GPT3_2B_S1_R2_L4_ar1 -->
<g id="edge797" class="edge">
<title>GPT3_2B_S1_R2_L4_attn&#45;&gt;GPT3_2B_S1_R2_L4_ar1</title>
<path fill="none" stroke="black" d="M21189,-4261.11C21189,-4244.74 21189,-4220.15 21189,-4199.73"/>
<polygon fill="black" stroke="black" points="21192.5,-4199.49 21189,-4189.49 21185.5,-4199.49 21192.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L4_res1 -->
<g id="node864" class="node">
<title>GPT3_2B_S1_R2_L4_res1</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-4063.48 21137.11,-4063.48 21101.16,-4027.48 21240.89,-4027.48 21276.84,-4063.48"/>
<text text-anchor="middle" x="21189" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L4_ar1&#45;&gt;GPT3_2B_S1_R2_L4_res1 -->
<g id="edge798" class="edge">
<title>GPT3_2B_S1_R2_L4_ar1&#45;&gt;GPT3_2B_S1_R2_L4_res1</title>
<path fill="none" stroke="black" d="M21189,-4135.28C21189,-4116.91 21189,-4092.36 21189,-4073.73"/>
<polygon fill="black" stroke="black" points="21192.5,-4073.54 21189,-4063.54 21185.5,-4073.54 21192.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L4_norm2 -->
<g id="node865" class="node">
<title>GPT3_2B_S1_R2_L4_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="21189" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L4_res1&#45;&gt;GPT3_2B_S1_R2_L4_norm2 -->
<g id="edge799" class="edge">
<title>GPT3_2B_S1_R2_L4_res1&#45;&gt;GPT3_2B_S1_R2_L4_norm2</title>
<path fill="none" stroke="black" d="M21189,-4027.03C21189,-4010.89 21189,-3986.38 21189,-3965.99"/>
<polygon fill="black" stroke="black" points="21192.5,-3965.76 21189,-3955.76 21185.5,-3965.76 21192.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_up -->
<g id="node866" class="node">
<title>GPT3_2B_S1_R2_L4_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-3829.74 21082.5,-3829.74 21082.5,-3791.74 21295.5,-3791.74 21295.5,-3829.74"/>
<text text-anchor="middle" x="21189" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="21189" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_norm2&#45;&gt;GPT3_2B_S1_R2_L4_ffn_up -->
<g id="edge800" class="edge">
<title>GPT3_2B_S1_R2_L4_norm2&#45;&gt;GPT3_2B_S1_R2_L4_ffn_up</title>
<path fill="none" stroke="black" d="M21189,-3901.6C21189,-3883.33 21189,-3858.91 21189,-3840.13"/>
<polygon fill="black" stroke="black" points="21192.5,-3840.09 21189,-3830.09 21185.5,-3840.09 21192.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_gate -->
<g id="node867" class="node">
<title>GPT3_2B_S1_R2_L4_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-3719.74 21082.5,-3719.74 21082.5,-3681.74 21295.5,-3681.74 21295.5,-3719.74"/>
<text text-anchor="middle" x="21189" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="21189" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_up&#45;&gt;GPT3_2B_S1_R2_L4_ffn_gate -->
<g id="edge801" class="edge">
<title>GPT3_2B_S1_R2_L4_ffn_up&#45;&gt;GPT3_2B_S1_R2_L4_ffn_gate</title>
<path fill="none" stroke="black" d="M21189,-3791.41C21189,-3774.56 21189,-3749.3 21189,-3729.88"/>
<polygon fill="black" stroke="black" points="21192.5,-3729.79 21189,-3719.79 21185.5,-3729.79 21192.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_down -->
<g id="node868" class="node">
<title>GPT3_2B_S1_R2_L4_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-3609.74 21082.5,-3609.74 21082.5,-3571.74 21295.5,-3571.74 21295.5,-3609.74"/>
<text text-anchor="middle" x="21189" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="21189" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L4_ffn_down -->
<g id="edge802" class="edge">
<title>GPT3_2B_S1_R2_L4_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L4_ffn_down</title>
<path fill="none" stroke="black" d="M21189,-3681.41C21189,-3664.56 21189,-3639.3 21189,-3619.88"/>
<polygon fill="black" stroke="black" points="21192.5,-3619.79 21189,-3609.79 21185.5,-3619.79 21192.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L4_ar2 -->
<g id="node869" class="node">
<title>GPT3_2B_S1_R2_L4_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="21189" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L4_ffn_down&#45;&gt;GPT3_2B_S1_R2_L4_ar2 -->
<g id="edge803" class="edge">
<title>GPT3_2B_S1_R2_L4_ffn_down&#45;&gt;GPT3_2B_S1_R2_L4_ar2</title>
<path fill="none" stroke="black" d="M21189,-3571.63C21189,-3555.26 21189,-3530.67 21189,-3510.25"/>
<polygon fill="black" stroke="black" points="21192.5,-3510.01 21189,-3500.01 21185.5,-3510.01 21192.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L4_res2 -->
<g id="node870" class="node">
<title>GPT3_2B_S1_R2_L4_res2</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-3374 21137.11,-3374 21101.16,-3338 21240.89,-3338 21276.84,-3374"/>
<text text-anchor="middle" x="21189" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L4_ar2&#45;&gt;GPT3_2B_S1_R2_L4_res2 -->
<g id="edge804" class="edge">
<title>GPT3_2B_S1_R2_L4_ar2&#45;&gt;GPT3_2B_S1_R2_L4_res2</title>
<path fill="none" stroke="black" d="M21189,-3445.8C21189,-3427.43 21189,-3402.88 21189,-3384.25"/>
<polygon fill="black" stroke="black" points="21192.5,-3384.06 21189,-3374.06 21185.5,-3384.06 21192.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L5_split -->
<g id="node871" class="node">
<title>GPT3_2B_S1_R2_L5_split</title>
<polygon fill="orange" stroke="black" points="20747.7,-4682.96 20081.64,-4682.96 19910.3,-4606.96 20576.36,-4606.96 20747.7,-4682.96"/>
<text text-anchor="middle" x="20329" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="20329" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_norm1 -->
<g id="node872" class="node">
<title>GPT3_2B_S1_R2_L5_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20329" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L5_split&#45;&gt;GPT3_2B_S1_R2_L5_norm1 -->
<g id="edge805" class="edge">
<title>GPT3_2B_S1_R2_L5_split&#45;&gt;GPT3_2B_S1_R2_L5_norm1</title>
<path fill="none" stroke="black" d="M20329,-4606.75C20329,-4587.54 20329,-4564.2 20329,-4545.16"/>
<polygon fill="black" stroke="black" points="20332.5,-4545.07 20329,-4535.07 20325.5,-4545.07 20332.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L5_qkv -->
<g id="node873" class="node">
<title>GPT3_2B_S1_R2_L5_qkv</title>
<polygon fill="lightcoral" stroke="black" points="20471,-4409.22 20187,-4409.22 20187,-4371.22 20471,-4371.22 20471,-4409.22"/>
<text text-anchor="middle" x="20329" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="20329" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_norm1&#45;&gt;GPT3_2B_S1_R2_L5_qkv -->
<g id="edge806" class="edge">
<title>GPT3_2B_S1_R2_L5_norm1&#45;&gt;GPT3_2B_S1_R2_L5_qkv</title>
<path fill="none" stroke="black" d="M20329,-4481.08C20329,-4462.81 20329,-4438.39 20329,-4419.61"/>
<polygon fill="black" stroke="black" points="20332.5,-4419.57 20329,-4409.57 20325.5,-4419.57 20332.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L5_attn -->
<g id="node874" class="node">
<title>GPT3_2B_S1_R2_L5_attn</title>
<polygon fill="lightcoral" stroke="black" points="20471,-4299.22 20187,-4299.22 20187,-4261.22 20471,-4261.22 20471,-4299.22"/>
<text text-anchor="middle" x="20329" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="20329" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_qkv&#45;&gt;GPT3_2B_S1_R2_L5_attn -->
<g id="edge807" class="edge">
<title>GPT3_2B_S1_R2_L5_qkv&#45;&gt;GPT3_2B_S1_R2_L5_attn</title>
<path fill="none" stroke="black" d="M20329,-4370.9C20329,-4354.04 20329,-4328.78 20329,-4309.36"/>
<polygon fill="black" stroke="black" points="20332.5,-4309.27 20329,-4299.27 20325.5,-4309.27 20332.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L5_ar1 -->
<g id="node875" class="node">
<title>GPT3_2B_S1_R2_L5_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20329" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_attn&#45;&gt;GPT3_2B_S1_R2_L5_ar1 -->
<g id="edge808" class="edge">
<title>GPT3_2B_S1_R2_L5_attn&#45;&gt;GPT3_2B_S1_R2_L5_ar1</title>
<path fill="none" stroke="black" d="M20329,-4261.11C20329,-4244.74 20329,-4220.15 20329,-4199.73"/>
<polygon fill="black" stroke="black" points="20332.5,-4199.49 20329,-4189.49 20325.5,-4199.49 20332.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L5_res1 -->
<g id="node876" class="node">
<title>GPT3_2B_S1_R2_L5_res1</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-4063.48 20277.11,-4063.48 20241.16,-4027.48 20380.89,-4027.48 20416.84,-4063.48"/>
<text text-anchor="middle" x="20329" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L5_ar1&#45;&gt;GPT3_2B_S1_R2_L5_res1 -->
<g id="edge809" class="edge">
<title>GPT3_2B_S1_R2_L5_ar1&#45;&gt;GPT3_2B_S1_R2_L5_res1</title>
<path fill="none" stroke="black" d="M20329,-4135.28C20329,-4116.91 20329,-4092.36 20329,-4073.73"/>
<polygon fill="black" stroke="black" points="20332.5,-4073.54 20329,-4063.54 20325.5,-4073.54 20332.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L5_norm2 -->
<g id="node877" class="node">
<title>GPT3_2B_S1_R2_L5_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="20329" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L5_res1&#45;&gt;GPT3_2B_S1_R2_L5_norm2 -->
<g id="edge810" class="edge">
<title>GPT3_2B_S1_R2_L5_res1&#45;&gt;GPT3_2B_S1_R2_L5_norm2</title>
<path fill="none" stroke="black" d="M20329,-4027.03C20329,-4010.89 20329,-3986.38 20329,-3965.99"/>
<polygon fill="black" stroke="black" points="20332.5,-3965.76 20329,-3955.76 20325.5,-3965.76 20332.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_up -->
<g id="node878" class="node">
<title>GPT3_2B_S1_R2_L5_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-3829.74 20222.5,-3829.74 20222.5,-3791.74 20435.5,-3791.74 20435.5,-3829.74"/>
<text text-anchor="middle" x="20329" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="20329" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_norm2&#45;&gt;GPT3_2B_S1_R2_L5_ffn_up -->
<g id="edge811" class="edge">
<title>GPT3_2B_S1_R2_L5_norm2&#45;&gt;GPT3_2B_S1_R2_L5_ffn_up</title>
<path fill="none" stroke="black" d="M20329,-3901.6C20329,-3883.33 20329,-3858.91 20329,-3840.13"/>
<polygon fill="black" stroke="black" points="20332.5,-3840.09 20329,-3830.09 20325.5,-3840.09 20332.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_gate -->
<g id="node879" class="node">
<title>GPT3_2B_S1_R2_L5_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-3719.74 20222.5,-3719.74 20222.5,-3681.74 20435.5,-3681.74 20435.5,-3719.74"/>
<text text-anchor="middle" x="20329" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="20329" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_up&#45;&gt;GPT3_2B_S1_R2_L5_ffn_gate -->
<g id="edge812" class="edge">
<title>GPT3_2B_S1_R2_L5_ffn_up&#45;&gt;GPT3_2B_S1_R2_L5_ffn_gate</title>
<path fill="none" stroke="black" d="M20329,-3791.41C20329,-3774.56 20329,-3749.3 20329,-3729.88"/>
<polygon fill="black" stroke="black" points="20332.5,-3729.79 20329,-3719.79 20325.5,-3729.79 20332.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_down -->
<g id="node880" class="node">
<title>GPT3_2B_S1_R2_L5_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-3609.74 20222.5,-3609.74 20222.5,-3571.74 20435.5,-3571.74 20435.5,-3609.74"/>
<text text-anchor="middle" x="20329" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="20329" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L5_ffn_down -->
<g id="edge813" class="edge">
<title>GPT3_2B_S1_R2_L5_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L5_ffn_down</title>
<path fill="none" stroke="black" d="M20329,-3681.41C20329,-3664.56 20329,-3639.3 20329,-3619.88"/>
<polygon fill="black" stroke="black" points="20332.5,-3619.79 20329,-3609.79 20325.5,-3619.79 20332.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L5_ar2 -->
<g id="node881" class="node">
<title>GPT3_2B_S1_R2_L5_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="20329" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L5_ffn_down&#45;&gt;GPT3_2B_S1_R2_L5_ar2 -->
<g id="edge814" class="edge">
<title>GPT3_2B_S1_R2_L5_ffn_down&#45;&gt;GPT3_2B_S1_R2_L5_ar2</title>
<path fill="none" stroke="black" d="M20329,-3571.63C20329,-3555.26 20329,-3530.67 20329,-3510.25"/>
<polygon fill="black" stroke="black" points="20332.5,-3510.01 20329,-3500.01 20325.5,-3510.01 20332.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L5_res2 -->
<g id="node882" class="node">
<title>GPT3_2B_S1_R2_L5_res2</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-3374 20277.11,-3374 20241.16,-3338 20380.89,-3338 20416.84,-3374"/>
<text text-anchor="middle" x="20329" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L5_ar2&#45;&gt;GPT3_2B_S1_R2_L5_res2 -->
<g id="edge815" class="edge">
<title>GPT3_2B_S1_R2_L5_ar2&#45;&gt;GPT3_2B_S1_R2_L5_res2</title>
<path fill="none" stroke="black" d="M20329,-3445.8C20329,-3427.43 20329,-3402.88 20329,-3384.25"/>
<polygon fill="black" stroke="black" points="20332.5,-3384.06 20329,-3374.06 20325.5,-3384.06 20332.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L6_split -->
<g id="node883" class="node">
<title>GPT3_2B_S1_R2_L6_split</title>
<polygon fill="orange" stroke="black" points="19887.7,-4682.96 19221.64,-4682.96 19050.3,-4606.96 19716.36,-4606.96 19887.7,-4682.96"/>
<text text-anchor="middle" x="19469" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="19469" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_norm1 -->
<g id="node884" class="node">
<title>GPT3_2B_S1_R2_L6_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19469" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L6_split&#45;&gt;GPT3_2B_S1_R2_L6_norm1 -->
<g id="edge816" class="edge">
<title>GPT3_2B_S1_R2_L6_split&#45;&gt;GPT3_2B_S1_R2_L6_norm1</title>
<path fill="none" stroke="black" d="M19469,-4606.75C19469,-4587.54 19469,-4564.2 19469,-4545.16"/>
<polygon fill="black" stroke="black" points="19472.5,-4545.07 19469,-4535.07 19465.5,-4545.07 19472.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L6_qkv -->
<g id="node885" class="node">
<title>GPT3_2B_S1_R2_L6_qkv</title>
<polygon fill="lightcoral" stroke="black" points="19611,-4409.22 19327,-4409.22 19327,-4371.22 19611,-4371.22 19611,-4409.22"/>
<text text-anchor="middle" x="19469" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="19469" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_norm1&#45;&gt;GPT3_2B_S1_R2_L6_qkv -->
<g id="edge817" class="edge">
<title>GPT3_2B_S1_R2_L6_norm1&#45;&gt;GPT3_2B_S1_R2_L6_qkv</title>
<path fill="none" stroke="black" d="M19469,-4481.08C19469,-4462.81 19469,-4438.39 19469,-4419.61"/>
<polygon fill="black" stroke="black" points="19472.5,-4419.57 19469,-4409.57 19465.5,-4419.57 19472.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L6_attn -->
<g id="node886" class="node">
<title>GPT3_2B_S1_R2_L6_attn</title>
<polygon fill="lightcoral" stroke="black" points="19611,-4299.22 19327,-4299.22 19327,-4261.22 19611,-4261.22 19611,-4299.22"/>
<text text-anchor="middle" x="19469" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="19469" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_qkv&#45;&gt;GPT3_2B_S1_R2_L6_attn -->
<g id="edge818" class="edge">
<title>GPT3_2B_S1_R2_L6_qkv&#45;&gt;GPT3_2B_S1_R2_L6_attn</title>
<path fill="none" stroke="black" d="M19469,-4370.9C19469,-4354.04 19469,-4328.78 19469,-4309.36"/>
<polygon fill="black" stroke="black" points="19472.5,-4309.27 19469,-4299.27 19465.5,-4309.27 19472.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L6_ar1 -->
<g id="node887" class="node">
<title>GPT3_2B_S1_R2_L6_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="19469" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_attn&#45;&gt;GPT3_2B_S1_R2_L6_ar1 -->
<g id="edge819" class="edge">
<title>GPT3_2B_S1_R2_L6_attn&#45;&gt;GPT3_2B_S1_R2_L6_ar1</title>
<path fill="none" stroke="black" d="M19469,-4261.11C19469,-4244.74 19469,-4220.15 19469,-4199.73"/>
<polygon fill="black" stroke="black" points="19472.5,-4199.49 19469,-4189.49 19465.5,-4199.49 19472.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L6_res1 -->
<g id="node888" class="node">
<title>GPT3_2B_S1_R2_L6_res1</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-4063.48 19417.11,-4063.48 19381.16,-4027.48 19520.89,-4027.48 19556.84,-4063.48"/>
<text text-anchor="middle" x="19469" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L6_ar1&#45;&gt;GPT3_2B_S1_R2_L6_res1 -->
<g id="edge820" class="edge">
<title>GPT3_2B_S1_R2_L6_ar1&#45;&gt;GPT3_2B_S1_R2_L6_res1</title>
<path fill="none" stroke="black" d="M19469,-4135.28C19469,-4116.91 19469,-4092.36 19469,-4073.73"/>
<polygon fill="black" stroke="black" points="19472.5,-4073.54 19469,-4063.54 19465.5,-4073.54 19472.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L6_norm2 -->
<g id="node889" class="node">
<title>GPT3_2B_S1_R2_L6_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="19469" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L6_res1&#45;&gt;GPT3_2B_S1_R2_L6_norm2 -->
<g id="edge821" class="edge">
<title>GPT3_2B_S1_R2_L6_res1&#45;&gt;GPT3_2B_S1_R2_L6_norm2</title>
<path fill="none" stroke="black" d="M19469,-4027.03C19469,-4010.89 19469,-3986.38 19469,-3965.99"/>
<polygon fill="black" stroke="black" points="19472.5,-3965.76 19469,-3955.76 19465.5,-3965.76 19472.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_up -->
<g id="node890" class="node">
<title>GPT3_2B_S1_R2_L6_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-3829.74 19362.5,-3829.74 19362.5,-3791.74 19575.5,-3791.74 19575.5,-3829.74"/>
<text text-anchor="middle" x="19469" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="19469" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_norm2&#45;&gt;GPT3_2B_S1_R2_L6_ffn_up -->
<g id="edge822" class="edge">
<title>GPT3_2B_S1_R2_L6_norm2&#45;&gt;GPT3_2B_S1_R2_L6_ffn_up</title>
<path fill="none" stroke="black" d="M19469,-3901.6C19469,-3883.33 19469,-3858.91 19469,-3840.13"/>
<polygon fill="black" stroke="black" points="19472.5,-3840.09 19469,-3830.09 19465.5,-3840.09 19472.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_gate -->
<g id="node891" class="node">
<title>GPT3_2B_S1_R2_L6_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-3719.74 19362.5,-3719.74 19362.5,-3681.74 19575.5,-3681.74 19575.5,-3719.74"/>
<text text-anchor="middle" x="19469" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="19469" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_up&#45;&gt;GPT3_2B_S1_R2_L6_ffn_gate -->
<g id="edge823" class="edge">
<title>GPT3_2B_S1_R2_L6_ffn_up&#45;&gt;GPT3_2B_S1_R2_L6_ffn_gate</title>
<path fill="none" stroke="black" d="M19469,-3791.41C19469,-3774.56 19469,-3749.3 19469,-3729.88"/>
<polygon fill="black" stroke="black" points="19472.5,-3729.79 19469,-3719.79 19465.5,-3729.79 19472.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_down -->
<g id="node892" class="node">
<title>GPT3_2B_S1_R2_L6_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-3609.74 19362.5,-3609.74 19362.5,-3571.74 19575.5,-3571.74 19575.5,-3609.74"/>
<text text-anchor="middle" x="19469" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="19469" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L6_ffn_down -->
<g id="edge824" class="edge">
<title>GPT3_2B_S1_R2_L6_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L6_ffn_down</title>
<path fill="none" stroke="black" d="M19469,-3681.41C19469,-3664.56 19469,-3639.3 19469,-3619.88"/>
<polygon fill="black" stroke="black" points="19472.5,-3619.79 19469,-3609.79 19465.5,-3619.79 19472.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L6_ar2 -->
<g id="node893" class="node">
<title>GPT3_2B_S1_R2_L6_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="19469" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L6_ffn_down&#45;&gt;GPT3_2B_S1_R2_L6_ar2 -->
<g id="edge825" class="edge">
<title>GPT3_2B_S1_R2_L6_ffn_down&#45;&gt;GPT3_2B_S1_R2_L6_ar2</title>
<path fill="none" stroke="black" d="M19469,-3571.63C19469,-3555.26 19469,-3530.67 19469,-3510.25"/>
<polygon fill="black" stroke="black" points="19472.5,-3510.01 19469,-3500.01 19465.5,-3510.01 19472.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L6_res2 -->
<g id="node894" class="node">
<title>GPT3_2B_S1_R2_L6_res2</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-3374 19417.11,-3374 19381.16,-3338 19520.89,-3338 19556.84,-3374"/>
<text text-anchor="middle" x="19469" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L6_ar2&#45;&gt;GPT3_2B_S1_R2_L6_res2 -->
<g id="edge826" class="edge">
<title>GPT3_2B_S1_R2_L6_ar2&#45;&gt;GPT3_2B_S1_R2_L6_res2</title>
<path fill="none" stroke="black" d="M19469,-3445.8C19469,-3427.43 19469,-3402.88 19469,-3384.25"/>
<polygon fill="black" stroke="black" points="19472.5,-3384.06 19469,-3374.06 19465.5,-3384.06 19472.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L7_split -->
<g id="node895" class="node">
<title>GPT3_2B_S1_R2_L7_split</title>
<polygon fill="orange" stroke="black" points="19027.7,-4682.96 18361.64,-4682.96 18190.3,-4606.96 18856.36,-4606.96 19027.7,-4682.96"/>
<text text-anchor="middle" x="18609" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="18609" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_norm1 -->
<g id="node896" class="node">
<title>GPT3_2B_S1_R2_L7_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18609" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L7_split&#45;&gt;GPT3_2B_S1_R2_L7_norm1 -->
<g id="edge827" class="edge">
<title>GPT3_2B_S1_R2_L7_split&#45;&gt;GPT3_2B_S1_R2_L7_norm1</title>
<path fill="none" stroke="black" d="M18609,-4606.75C18609,-4587.54 18609,-4564.2 18609,-4545.16"/>
<polygon fill="black" stroke="black" points="18612.5,-4545.07 18609,-4535.07 18605.5,-4545.07 18612.5,-4545.07"/>
</g>
<!-- GPT3_2B_S1_R2_L7_qkv -->
<g id="node897" class="node">
<title>GPT3_2B_S1_R2_L7_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18751,-4409.22 18467,-4409.22 18467,-4371.22 18751,-4371.22 18751,-4409.22"/>
<text text-anchor="middle" x="18609" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="18609" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_norm1&#45;&gt;GPT3_2B_S1_R2_L7_qkv -->
<g id="edge828" class="edge">
<title>GPT3_2B_S1_R2_L7_norm1&#45;&gt;GPT3_2B_S1_R2_L7_qkv</title>
<path fill="none" stroke="black" d="M18609,-4481.08C18609,-4462.81 18609,-4438.39 18609,-4419.61"/>
<polygon fill="black" stroke="black" points="18612.5,-4419.57 18609,-4409.57 18605.5,-4419.57 18612.5,-4419.57"/>
</g>
<!-- GPT3_2B_S1_R2_L7_attn -->
<g id="node898" class="node">
<title>GPT3_2B_S1_R2_L7_attn</title>
<polygon fill="lightcoral" stroke="black" points="18751,-4299.22 18467,-4299.22 18467,-4261.22 18751,-4261.22 18751,-4299.22"/>
<text text-anchor="middle" x="18609" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18609" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_qkv&#45;&gt;GPT3_2B_S1_R2_L7_attn -->
<g id="edge829" class="edge">
<title>GPT3_2B_S1_R2_L7_qkv&#45;&gt;GPT3_2B_S1_R2_L7_attn</title>
<path fill="none" stroke="black" d="M18609,-4370.9C18609,-4354.04 18609,-4328.78 18609,-4309.36"/>
<polygon fill="black" stroke="black" points="18612.5,-4309.27 18609,-4299.27 18605.5,-4309.27 18612.5,-4309.27"/>
</g>
<!-- GPT3_2B_S1_R2_L7_ar1 -->
<g id="node899" class="node">
<title>GPT3_2B_S1_R2_L7_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18609" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_attn&#45;&gt;GPT3_2B_S1_R2_L7_ar1 -->
<g id="edge830" class="edge">
<title>GPT3_2B_S1_R2_L7_attn&#45;&gt;GPT3_2B_S1_R2_L7_ar1</title>
<path fill="none" stroke="black" d="M18609,-4261.11C18609,-4244.74 18609,-4220.15 18609,-4199.73"/>
<polygon fill="black" stroke="black" points="18612.5,-4199.49 18609,-4189.49 18605.5,-4199.49 18612.5,-4199.49"/>
</g>
<!-- GPT3_2B_S1_R2_L7_res1 -->
<g id="node900" class="node">
<title>GPT3_2B_S1_R2_L7_res1</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-4063.48 18557.11,-4063.48 18521.16,-4027.48 18660.89,-4027.48 18696.84,-4063.48"/>
<text text-anchor="middle" x="18609" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L7_ar1&#45;&gt;GPT3_2B_S1_R2_L7_res1 -->
<g id="edge831" class="edge">
<title>GPT3_2B_S1_R2_L7_ar1&#45;&gt;GPT3_2B_S1_R2_L7_res1</title>
<path fill="none" stroke="black" d="M18609,-4135.28C18609,-4116.91 18609,-4092.36 18609,-4073.73"/>
<polygon fill="black" stroke="black" points="18612.5,-4073.54 18609,-4063.54 18605.5,-4073.54 18612.5,-4073.54"/>
</g>
<!-- GPT3_2B_S1_R2_L7_norm2 -->
<g id="node901" class="node">
<title>GPT3_2B_S1_R2_L7_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18609" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L7_res1&#45;&gt;GPT3_2B_S1_R2_L7_norm2 -->
<g id="edge832" class="edge">
<title>GPT3_2B_S1_R2_L7_res1&#45;&gt;GPT3_2B_S1_R2_L7_norm2</title>
<path fill="none" stroke="black" d="M18609,-4027.03C18609,-4010.89 18609,-3986.38 18609,-3965.99"/>
<polygon fill="black" stroke="black" points="18612.5,-3965.76 18609,-3955.76 18605.5,-3965.76 18612.5,-3965.76"/>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_up -->
<g id="node902" class="node">
<title>GPT3_2B_S1_R2_L7_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-3829.74 18502.5,-3829.74 18502.5,-3791.74 18715.5,-3791.74 18715.5,-3829.74"/>
<text text-anchor="middle" x="18609" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18609" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_norm2&#45;&gt;GPT3_2B_S1_R2_L7_ffn_up -->
<g id="edge833" class="edge">
<title>GPT3_2B_S1_R2_L7_norm2&#45;&gt;GPT3_2B_S1_R2_L7_ffn_up</title>
<path fill="none" stroke="black" d="M18609,-3901.6C18609,-3883.33 18609,-3858.91 18609,-3840.13"/>
<polygon fill="black" stroke="black" points="18612.5,-3840.09 18609,-3830.09 18605.5,-3840.09 18612.5,-3840.09"/>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_gate -->
<g id="node903" class="node">
<title>GPT3_2B_S1_R2_L7_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-3719.74 18502.5,-3719.74 18502.5,-3681.74 18715.5,-3681.74 18715.5,-3719.74"/>
<text text-anchor="middle" x="18609" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18609" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_up&#45;&gt;GPT3_2B_S1_R2_L7_ffn_gate -->
<g id="edge834" class="edge">
<title>GPT3_2B_S1_R2_L7_ffn_up&#45;&gt;GPT3_2B_S1_R2_L7_ffn_gate</title>
<path fill="none" stroke="black" d="M18609,-3791.41C18609,-3774.56 18609,-3749.3 18609,-3729.88"/>
<polygon fill="black" stroke="black" points="18612.5,-3729.79 18609,-3719.79 18605.5,-3729.79 18612.5,-3729.79"/>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_down -->
<g id="node904" class="node">
<title>GPT3_2B_S1_R2_L7_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-3609.74 18502.5,-3609.74 18502.5,-3571.74 18715.5,-3571.74 18715.5,-3609.74"/>
<text text-anchor="middle" x="18609" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18609" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L7_ffn_down -->
<g id="edge835" class="edge">
<title>GPT3_2B_S1_R2_L7_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L7_ffn_down</title>
<path fill="none" stroke="black" d="M18609,-3681.41C18609,-3664.56 18609,-3639.3 18609,-3619.88"/>
<polygon fill="black" stroke="black" points="18612.5,-3619.79 18609,-3609.79 18605.5,-3619.79 18612.5,-3619.79"/>
</g>
<!-- GPT3_2B_S1_R2_L7_ar2 -->
<g id="node905" class="node">
<title>GPT3_2B_S1_R2_L7_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18609" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L7_ffn_down&#45;&gt;GPT3_2B_S1_R2_L7_ar2 -->
<g id="edge836" class="edge">
<title>GPT3_2B_S1_R2_L7_ffn_down&#45;&gt;GPT3_2B_S1_R2_L7_ar2</title>
<path fill="none" stroke="black" d="M18609,-3571.63C18609,-3555.26 18609,-3530.67 18609,-3510.25"/>
<polygon fill="black" stroke="black" points="18612.5,-3510.01 18609,-3500.01 18605.5,-3510.01 18612.5,-3510.01"/>
</g>
<!-- GPT3_2B_S1_R2_L7_res2 -->
<g id="node906" class="node">
<title>GPT3_2B_S1_R2_L7_res2</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-3374 18557.11,-3374 18521.16,-3338 18660.89,-3338 18696.84,-3374"/>
<text text-anchor="middle" x="18609" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L7_ar2&#45;&gt;GPT3_2B_S1_R2_L7_res2 -->
<g id="edge837" class="edge">
<title>GPT3_2B_S1_R2_L7_ar2&#45;&gt;GPT3_2B_S1_R2_L7_res2</title>
<path fill="none" stroke="black" d="M18609,-3445.8C18609,-3427.43 18609,-3402.88 18609,-3384.25"/>
<polygon fill="black" stroke="black" points="18612.5,-3384.06 18609,-3374.06 18605.5,-3384.06 18612.5,-3384.06"/>
</g>
<!-- GPT3_2B_S1_R2_L8_split -->
<g id="node907" class="node">
<title>GPT3_2B_S1_R2_L8_split</title>
<polygon fill="orange" stroke="black" points="18167.7,-4682.96 17501.64,-4682.96 17330.3,-4606.96 17996.36,-4606.96 18167.7,-4682.96"/>
<text text-anchor="middle" x="17749" y="-4648.76" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="17749" y="-4633.76" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_norm1 -->
<g id="node908" class="node">
<title>GPT3_2B_S1_R2_L8_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="17818" cy="-4508.09" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="17818" y="-4511.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17818" y="-4496.89" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L8_split&#45;&gt;GPT3_2B_S1_R2_L8_norm1 -->
<g id="edge838" class="edge">
<title>GPT3_2B_S1_R2_L8_split&#45;&gt;GPT3_2B_S1_R2_L8_norm1</title>
<path fill="none" stroke="black" d="M17768.04,-4606.75C17778.12,-4587.05 17790.41,-4563.01 17800.29,-4543.71"/>
<polygon fill="black" stroke="black" points="17803.48,-4545.15 17804.92,-4534.66 17797.25,-4541.96 17803.48,-4545.15"/>
</g>
<!-- GPT3_2B_S1_R2_L8_qkv -->
<g id="node909" class="node">
<title>GPT3_2B_S1_R2_L8_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18030,-4409.22 17746,-4409.22 17746,-4371.22 18030,-4371.22 18030,-4409.22"/>
<text text-anchor="middle" x="17888" y="-4394.02" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="17888" y="-4379.02" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_norm1&#45;&gt;GPT3_2B_S1_R2_L8_qkv -->
<g id="edge839" class="edge">
<title>GPT3_2B_S1_R2_L8_norm1&#45;&gt;GPT3_2B_S1_R2_L8_qkv</title>
<path fill="none" stroke="black" d="M17833.54,-4481.37C17844.89,-4462.58 17860.25,-4437.15 17871.76,-4418.09"/>
<polygon fill="black" stroke="black" points="17874.9,-4419.67 17877.07,-4409.3 17868.91,-4416.05 17874.9,-4419.67"/>
</g>
<!-- GPT3_2B_S1_R2_L8_attn -->
<g id="node910" class="node">
<title>GPT3_2B_S1_R2_L8_attn</title>
<polygon fill="lightcoral" stroke="black" points="18168,-4299.22 17884,-4299.22 17884,-4261.22 18168,-4261.22 18168,-4299.22"/>
<text text-anchor="middle" x="18026" y="-4284.02" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18026" y="-4269.02" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_qkv&#45;&gt;GPT3_2B_S1_R2_L8_attn -->
<g id="edge840" class="edge">
<title>GPT3_2B_S1_R2_L8_qkv&#45;&gt;GPT3_2B_S1_R2_L8_attn</title>
<path fill="none" stroke="black" d="M17911.1,-4371.14C17934.08,-4353.15 17969.51,-4325.43 17994.95,-4305.52"/>
<polygon fill="black" stroke="black" points="17997.11,-4308.27 18002.83,-4299.35 17992.79,-4302.76 17997.11,-4308.27"/>
</g>
<!-- GPT3_2B_S1_R2_L8_ar1 -->
<g id="node911" class="node">
<title>GPT3_2B_S1_R2_L8_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18031" cy="-4162.35" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18031" y="-4166.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18031" y="-4151.15" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_attn&#45;&gt;GPT3_2B_S1_R2_L8_ar1 -->
<g id="edge841" class="edge">
<title>GPT3_2B_S1_R2_L8_attn&#45;&gt;GPT3_2B_S1_R2_L8_ar1</title>
<path fill="none" stroke="black" d="M18026.78,-4261.11C18027.49,-4244.74 18028.55,-4220.15 18029.43,-4199.73"/>
<polygon fill="black" stroke="black" points="18032.94,-4199.64 18029.87,-4189.49 18025.94,-4199.33 18032.94,-4199.64"/>
</g>
<!-- GPT3_2B_S1_R2_L8_res1 -->
<g id="node912" class="node">
<title>GPT3_2B_S1_R2_L8_res1</title>
<polygon fill="lightyellow" stroke="black" points="18292.84,-4063.48 18153.11,-4063.48 18117.16,-4027.48 18256.89,-4027.48 18292.84,-4063.48"/>
<text text-anchor="middle" x="18205" y="-4041.78" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S1_R2_L8_ar1&#45;&gt;GPT3_2B_S1_R2_L8_res1 -->
<g id="edge842" class="edge">
<title>GPT3_2B_S1_R2_L8_ar1&#45;&gt;GPT3_2B_S1_R2_L8_res1</title>
<path fill="none" stroke="black" d="M18067.05,-4137.54C18097.49,-4117.45 18140.78,-4088.87 18170.71,-4069.11"/>
<polygon fill="black" stroke="black" points="18172.74,-4071.96 18179.16,-4063.53 18168.89,-4066.12 18172.74,-4071.96"/>
</g>
<!-- GPT3_2B_S1_R2_L8_norm2 -->
<g id="node913" class="node">
<title>GPT3_2B_S1_R2_L8_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18216" cy="-3928.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18216" y="-3932.41" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18216" y="-3917.41" font-family="Times,serif" font-size="14.00">Device: GPU_2</text>
</g>
<!-- GPT3_2B_S1_R2_L8_res1&#45;&gt;GPT3_2B_S1_R2_L8_norm2 -->
<g id="edge843" class="edge">
<title>GPT3_2B_S1_R2_L8_res1&#45;&gt;GPT3_2B_S1_R2_L8_norm2</title>
<path fill="none" stroke="black" d="M18206.67,-4027.03C18208.22,-4010.89 18210.56,-3986.38 18212.52,-3965.99"/>
<polygon fill="black" stroke="black" points="18216.03,-3966.05 18213.5,-3955.76 18209.06,-3965.38 18216.03,-3966.05"/>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_up -->
<g id="node914" class="node">
<title>GPT3_2B_S1_R2_L8_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18328.5,-3829.74 18115.5,-3829.74 18115.5,-3791.74 18328.5,-3791.74 18328.5,-3829.74"/>
<text text-anchor="middle" x="18222" y="-3814.54" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18222" y="-3799.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_norm2&#45;&gt;GPT3_2B_S1_R2_L8_ffn_up -->
<g id="edge844" class="edge">
<title>GPT3_2B_S1_R2_L8_norm2&#45;&gt;GPT3_2B_S1_R2_L8_ffn_up</title>
<path fill="none" stroke="black" d="M18217.35,-3901.6C18218.29,-3883.33 18219.56,-3858.91 18220.53,-3840.13"/>
<polygon fill="black" stroke="black" points="18224.03,-3840.25 18221.05,-3830.09 18217.04,-3839.89 18224.03,-3840.25"/>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_gate -->
<g id="node915" class="node">
<title>GPT3_2B_S1_R2_L8_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18415.5,-3719.74 18202.5,-3719.74 18202.5,-3681.74 18415.5,-3681.74 18415.5,-3719.74"/>
<text text-anchor="middle" x="18309" y="-3704.54" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18309" y="-3689.54" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_up&#45;&gt;GPT3_2B_S1_R2_L8_ffn_gate -->
<g id="edge845" class="edge">
<title>GPT3_2B_S1_R2_L8_ffn_up&#45;&gt;GPT3_2B_S1_R2_L8_ffn_gate</title>
<path fill="none" stroke="black" d="M18236.76,-3791.41C18250.84,-3773.93 18272.2,-3747.42 18288.04,-3727.75"/>
<polygon fill="black" stroke="black" points="18290.91,-3729.77 18294.46,-3719.79 18285.46,-3725.38 18290.91,-3729.77"/>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_down -->
<g id="node916" class="node">
<title>GPT3_2B_S1_R2_L8_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18437.5,-3609.74 18224.5,-3609.74 18224.5,-3571.74 18437.5,-3571.74 18437.5,-3609.74"/>
<text text-anchor="middle" x="18331" y="-3594.54" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18331" y="-3579.54" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L8_ffn_down -->
<g id="edge846" class="edge">
<title>GPT3_2B_S1_R2_L8_ffn_gate&#45;&gt;GPT3_2B_S1_R2_L8_ffn_down</title>
<path fill="none" stroke="black" d="M18312.73,-3681.41C18316.18,-3664.48 18321.36,-3639.07 18325.32,-3619.61"/>
<polygon fill="black" stroke="black" points="18328.76,-3620.28 18327.32,-3609.79 18321.9,-3618.89 18328.76,-3620.28"/>
</g>
<!-- GPT3_2B_S1_R2_L8_ar2 -->
<g id="node917" class="node">
<title>GPT3_2B_S1_R2_L8_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18352" cy="-3472.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18352" y="-3476.67" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18352" y="-3461.67" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S1_R2_L8_ffn_down&#45;&gt;GPT3_2B_S1_R2_L8_ar2 -->
<g id="edge847" class="edge">
<title>GPT3_2B_S1_R2_L8_ffn_down&#45;&gt;GPT3_2B_S1_R2_L8_ar2</title>
<path fill="none" stroke="black" d="M18334.28,-3571.63C18337.26,-3555.19 18341.75,-3530.45 18345.46,-3509.97"/>
<polygon fill="black" stroke="black" points="18348.92,-3510.48 18347.26,-3500.01 18342.03,-3509.23 18348.92,-3510.48"/>
</g>
<!-- GPT3_2B_S1_R2_L8_res2 -->
<g id="node918" class="node">
<title>GPT3_2B_S1_R2_L8_res2</title>
<polygon fill="lightyellow" stroke="black" points="18459.84,-3374 18320.11,-3374 18284.16,-3338 18423.89,-3338 18459.84,-3374"/>
<text text-anchor="middle" x="18372" y="-3352.3" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S1_R2_L8_ar2&#45;&gt;GPT3_2B_S1_R2_L8_res2 -->
<g id="edge848" class="edge">
<title>GPT3_2B_S1_R2_L8_ar2&#45;&gt;GPT3_2B_S1_R2_L8_res2</title>
<path fill="none" stroke="black" d="M18356.54,-3445.8C18359.75,-3427.34 18364.05,-3402.65 18367.3,-3383.99"/>
<polygon fill="black" stroke="black" points="18370.76,-3384.51 18369.03,-3374.06 18363.87,-3383.31 18370.76,-3384.51"/>
</g>
<!-- GPT3_2B_S1_R2_L8_res2&#45;&gt;GPT3_2B_comm_1_2 -->
<g id="edge1203" class="edge">
<title>GPT3_2B_S1_R2_L8_res2&#45;&gt;GPT3_2B_comm_1_2</title>
<path fill="none" stroke="black" d="M18425.57,-3339.31C18450.93,-3332.63 18481.77,-3325.56 18510,-3322 19043.26,-3254.59 22877.22,-3234.33 23824.03,-3230.33"/>
<polygon fill="black" stroke="black" points="23824.36,-3233.83 23834.35,-3230.28 23824.33,-3226.83 23824.36,-3233.83"/>
</g>
<!-- GPT3_2B_S2_R1_L9_split -->
<g id="node919" class="node">
<title>GPT3_2B_S2_R1_L9_split</title>
<polygon fill="orange" stroke="black" points="31069.7,-3091.04 30403.64,-3091.04 30232.3,-3015.04 30898.36,-3015.04 31069.7,-3091.04"/>
<text text-anchor="middle" x="30651" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="30651" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_norm1 -->
<g id="node920" class="node">
<title>GPT3_2B_S2_R1_L9_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="30651" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L9_split&#45;&gt;GPT3_2B_S2_R1_L9_norm1 -->
<g id="edge849" class="edge">
<title>GPT3_2B_S2_R1_L9_split&#45;&gt;GPT3_2B_S2_R1_L9_norm1</title>
<path fill="none" stroke="black" d="M30651,-3014.83C30651,-2995.62 30651,-2972.29 30651,-2953.24"/>
<polygon fill="black" stroke="black" points="30654.5,-2953.16 30651,-2943.16 30647.5,-2953.16 30654.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L9_qkv -->
<g id="node921" class="node">
<title>GPT3_2B_S2_R1_L9_qkv</title>
<polygon fill="lightcoral" stroke="black" points="30793,-2817.3 30509,-2817.3 30509,-2779.3 30793,-2779.3 30793,-2817.3"/>
<text text-anchor="middle" x="30651" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="30651" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_norm1&#45;&gt;GPT3_2B_S2_R1_L9_qkv -->
<g id="edge850" class="edge">
<title>GPT3_2B_S2_R1_L9_norm1&#45;&gt;GPT3_2B_S2_R1_L9_qkv</title>
<path fill="none" stroke="black" d="M30651,-2889.17C30651,-2870.9 30651,-2846.47 30651,-2827.7"/>
<polygon fill="black" stroke="black" points="30654.5,-2827.65 30651,-2817.65 30647.5,-2827.65 30654.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L9_attn -->
<g id="node922" class="node">
<title>GPT3_2B_S2_R1_L9_attn</title>
<polygon fill="lightcoral" stroke="black" points="30793,-2707.3 30509,-2707.3 30509,-2669.3 30793,-2669.3 30793,-2707.3"/>
<text text-anchor="middle" x="30651" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="30651" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_qkv&#45;&gt;GPT3_2B_S2_R1_L9_attn -->
<g id="edge851" class="edge">
<title>GPT3_2B_S2_R1_L9_qkv&#45;&gt;GPT3_2B_S2_R1_L9_attn</title>
<path fill="none" stroke="black" d="M30651,-2778.98C30651,-2762.12 30651,-2736.87 30651,-2717.45"/>
<polygon fill="black" stroke="black" points="30654.5,-2717.35 30651,-2707.35 30647.5,-2717.35 30654.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L9_ar1 -->
<g id="node923" class="node">
<title>GPT3_2B_S2_R1_L9_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="30651" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_attn&#45;&gt;GPT3_2B_S2_R1_L9_ar1 -->
<g id="edge852" class="edge">
<title>GPT3_2B_S2_R1_L9_attn&#45;&gt;GPT3_2B_S2_R1_L9_ar1</title>
<path fill="none" stroke="black" d="M30651,-2669.2C30651,-2652.83 30651,-2628.24 30651,-2607.81"/>
<polygon fill="black" stroke="black" points="30654.5,-2607.58 30651,-2597.58 30647.5,-2607.58 30654.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L9_res1 -->
<g id="node924" class="node">
<title>GPT3_2B_S2_R1_L9_res1</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-2471.56 30599.11,-2471.56 30563.16,-2435.56 30702.89,-2435.56 30738.84,-2471.56"/>
<text text-anchor="middle" x="30651" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L9_ar1&#45;&gt;GPT3_2B_S2_R1_L9_res1 -->
<g id="edge853" class="edge">
<title>GPT3_2B_S2_R1_L9_ar1&#45;&gt;GPT3_2B_S2_R1_L9_res1</title>
<path fill="none" stroke="black" d="M30651,-2543.37C30651,-2525 30651,-2500.45 30651,-2481.82"/>
<polygon fill="black" stroke="black" points="30654.5,-2481.62 30651,-2471.62 30647.5,-2481.62 30654.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L9_norm2 -->
<g id="node925" class="node">
<title>GPT3_2B_S2_R1_L9_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="30651" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L9_res1&#45;&gt;GPT3_2B_S2_R1_L9_norm2 -->
<g id="edge854" class="edge">
<title>GPT3_2B_S2_R1_L9_res1&#45;&gt;GPT3_2B_S2_R1_L9_norm2</title>
<path fill="none" stroke="black" d="M30651,-2435.12C30651,-2418.97 30651,-2394.47 30651,-2374.07"/>
<polygon fill="black" stroke="black" points="30654.5,-2373.85 30651,-2363.85 30647.5,-2373.85 30654.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_up -->
<g id="node926" class="node">
<title>GPT3_2B_S2_R1_L9_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-2237.82 30544.5,-2237.82 30544.5,-2199.82 30757.5,-2199.82 30757.5,-2237.82"/>
<text text-anchor="middle" x="30651" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="30651" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_norm2&#45;&gt;GPT3_2B_S2_R1_L9_ffn_up -->
<g id="edge855" class="edge">
<title>GPT3_2B_S2_R1_L9_norm2&#45;&gt;GPT3_2B_S2_R1_L9_ffn_up</title>
<path fill="none" stroke="black" d="M30651,-2309.69C30651,-2291.42 30651,-2266.99 30651,-2248.22"/>
<polygon fill="black" stroke="black" points="30654.5,-2248.17 30651,-2238.17 30647.5,-2248.17 30654.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_gate -->
<g id="node927" class="node">
<title>GPT3_2B_S2_R1_L9_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-2127.82 30544.5,-2127.82 30544.5,-2089.82 30757.5,-2089.82 30757.5,-2127.82"/>
<text text-anchor="middle" x="30651" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="30651" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_up&#45;&gt;GPT3_2B_S2_R1_L9_ffn_gate -->
<g id="edge856" class="edge">
<title>GPT3_2B_S2_R1_L9_ffn_up&#45;&gt;GPT3_2B_S2_R1_L9_ffn_gate</title>
<path fill="none" stroke="black" d="M30651,-2199.5C30651,-2182.64 30651,-2157.39 30651,-2137.97"/>
<polygon fill="black" stroke="black" points="30654.5,-2137.87 30651,-2127.87 30647.5,-2137.87 30654.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_down -->
<g id="node928" class="node">
<title>GPT3_2B_S2_R1_L9_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-2017.82 30544.5,-2017.82 30544.5,-1979.82 30757.5,-1979.82 30757.5,-2017.82"/>
<text text-anchor="middle" x="30651" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="30651" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L9_ffn_down -->
<g id="edge857" class="edge">
<title>GPT3_2B_S2_R1_L9_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L9_ffn_down</title>
<path fill="none" stroke="black" d="M30651,-2089.5C30651,-2072.64 30651,-2047.39 30651,-2027.97"/>
<polygon fill="black" stroke="black" points="30654.5,-2027.87 30651,-2017.87 30647.5,-2027.87 30654.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L9_ar2 -->
<g id="node929" class="node">
<title>GPT3_2B_S2_R1_L9_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="30651" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L9_ffn_down&#45;&gt;GPT3_2B_S2_R1_L9_ar2 -->
<g id="edge858" class="edge">
<title>GPT3_2B_S2_R1_L9_ffn_down&#45;&gt;GPT3_2B_S2_R1_L9_ar2</title>
<path fill="none" stroke="black" d="M30651,-1979.72C30651,-1963.35 30651,-1938.76 30651,-1918.33"/>
<polygon fill="black" stroke="black" points="30654.5,-1918.1 30651,-1908.1 30647.5,-1918.1 30654.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L9_res2 -->
<g id="node930" class="node">
<title>GPT3_2B_S2_R1_L9_res2</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-1782.08 30599.11,-1782.08 30563.16,-1746.08 30702.89,-1746.08 30738.84,-1782.08"/>
<text text-anchor="middle" x="30651" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L9_ar2&#45;&gt;GPT3_2B_S2_R1_L9_res2 -->
<g id="edge859" class="edge">
<title>GPT3_2B_S2_R1_L9_ar2&#45;&gt;GPT3_2B_S2_R1_L9_res2</title>
<path fill="none" stroke="black" d="M30651,-1853.89C30651,-1835.51 30651,-1810.97 30651,-1792.34"/>
<polygon fill="black" stroke="black" points="30654.5,-1792.14 30651,-1782.14 30647.5,-1792.14 30654.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L10_split -->
<g id="node931" class="node">
<title>GPT3_2B_S2_R1_L10_split</title>
<polygon fill="orange" stroke="black" points="30209.7,-3091.04 29543.64,-3091.04 29372.3,-3015.04 30038.36,-3015.04 30209.7,-3091.04"/>
<text text-anchor="middle" x="29791" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="29791" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_norm1 -->
<g id="node932" class="node">
<title>GPT3_2B_S2_R1_L10_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29791" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L10_split&#45;&gt;GPT3_2B_S2_R1_L10_norm1 -->
<g id="edge860" class="edge">
<title>GPT3_2B_S2_R1_L10_split&#45;&gt;GPT3_2B_S2_R1_L10_norm1</title>
<path fill="none" stroke="black" d="M29791,-3014.83C29791,-2995.62 29791,-2972.29 29791,-2953.24"/>
<polygon fill="black" stroke="black" points="29794.5,-2953.16 29791,-2943.16 29787.5,-2953.16 29794.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L10_qkv -->
<g id="node933" class="node">
<title>GPT3_2B_S2_R1_L10_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29933,-2817.3 29649,-2817.3 29649,-2779.3 29933,-2779.3 29933,-2817.3"/>
<text text-anchor="middle" x="29791" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="29791" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_norm1&#45;&gt;GPT3_2B_S2_R1_L10_qkv -->
<g id="edge861" class="edge">
<title>GPT3_2B_S2_R1_L10_norm1&#45;&gt;GPT3_2B_S2_R1_L10_qkv</title>
<path fill="none" stroke="black" d="M29791,-2889.17C29791,-2870.9 29791,-2846.47 29791,-2827.7"/>
<polygon fill="black" stroke="black" points="29794.5,-2827.65 29791,-2817.65 29787.5,-2827.65 29794.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L10_attn -->
<g id="node934" class="node">
<title>GPT3_2B_S2_R1_L10_attn</title>
<polygon fill="lightcoral" stroke="black" points="29933,-2707.3 29649,-2707.3 29649,-2669.3 29933,-2669.3 29933,-2707.3"/>
<text text-anchor="middle" x="29791" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="29791" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_qkv&#45;&gt;GPT3_2B_S2_R1_L10_attn -->
<g id="edge862" class="edge">
<title>GPT3_2B_S2_R1_L10_qkv&#45;&gt;GPT3_2B_S2_R1_L10_attn</title>
<path fill="none" stroke="black" d="M29791,-2778.98C29791,-2762.12 29791,-2736.87 29791,-2717.45"/>
<polygon fill="black" stroke="black" points="29794.5,-2717.35 29791,-2707.35 29787.5,-2717.35 29794.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L10_ar1 -->
<g id="node935" class="node">
<title>GPT3_2B_S2_R1_L10_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29791" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_attn&#45;&gt;GPT3_2B_S2_R1_L10_ar1 -->
<g id="edge863" class="edge">
<title>GPT3_2B_S2_R1_L10_attn&#45;&gt;GPT3_2B_S2_R1_L10_ar1</title>
<path fill="none" stroke="black" d="M29791,-2669.2C29791,-2652.83 29791,-2628.24 29791,-2607.81"/>
<polygon fill="black" stroke="black" points="29794.5,-2607.58 29791,-2597.58 29787.5,-2607.58 29794.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L10_res1 -->
<g id="node936" class="node">
<title>GPT3_2B_S2_R1_L10_res1</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-2471.56 29739.11,-2471.56 29703.16,-2435.56 29842.89,-2435.56 29878.84,-2471.56"/>
<text text-anchor="middle" x="29791" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L10_ar1&#45;&gt;GPT3_2B_S2_R1_L10_res1 -->
<g id="edge864" class="edge">
<title>GPT3_2B_S2_R1_L10_ar1&#45;&gt;GPT3_2B_S2_R1_L10_res1</title>
<path fill="none" stroke="black" d="M29791,-2543.37C29791,-2525 29791,-2500.45 29791,-2481.82"/>
<polygon fill="black" stroke="black" points="29794.5,-2481.62 29791,-2471.62 29787.5,-2481.62 29794.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L10_norm2 -->
<g id="node937" class="node">
<title>GPT3_2B_S2_R1_L10_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="29791" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L10_res1&#45;&gt;GPT3_2B_S2_R1_L10_norm2 -->
<g id="edge865" class="edge">
<title>GPT3_2B_S2_R1_L10_res1&#45;&gt;GPT3_2B_S2_R1_L10_norm2</title>
<path fill="none" stroke="black" d="M29791,-2435.12C29791,-2418.97 29791,-2394.47 29791,-2374.07"/>
<polygon fill="black" stroke="black" points="29794.5,-2373.85 29791,-2363.85 29787.5,-2373.85 29794.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_up -->
<g id="node938" class="node">
<title>GPT3_2B_S2_R1_L10_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-2237.82 29684.5,-2237.82 29684.5,-2199.82 29897.5,-2199.82 29897.5,-2237.82"/>
<text text-anchor="middle" x="29791" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="29791" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_norm2&#45;&gt;GPT3_2B_S2_R1_L10_ffn_up -->
<g id="edge866" class="edge">
<title>GPT3_2B_S2_R1_L10_norm2&#45;&gt;GPT3_2B_S2_R1_L10_ffn_up</title>
<path fill="none" stroke="black" d="M29791,-2309.69C29791,-2291.42 29791,-2266.99 29791,-2248.22"/>
<polygon fill="black" stroke="black" points="29794.5,-2248.17 29791,-2238.17 29787.5,-2248.17 29794.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_gate -->
<g id="node939" class="node">
<title>GPT3_2B_S2_R1_L10_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-2127.82 29684.5,-2127.82 29684.5,-2089.82 29897.5,-2089.82 29897.5,-2127.82"/>
<text text-anchor="middle" x="29791" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="29791" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_up&#45;&gt;GPT3_2B_S2_R1_L10_ffn_gate -->
<g id="edge867" class="edge">
<title>GPT3_2B_S2_R1_L10_ffn_up&#45;&gt;GPT3_2B_S2_R1_L10_ffn_gate</title>
<path fill="none" stroke="black" d="M29791,-2199.5C29791,-2182.64 29791,-2157.39 29791,-2137.97"/>
<polygon fill="black" stroke="black" points="29794.5,-2137.87 29791,-2127.87 29787.5,-2137.87 29794.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_down -->
<g id="node940" class="node">
<title>GPT3_2B_S2_R1_L10_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-2017.82 29684.5,-2017.82 29684.5,-1979.82 29897.5,-1979.82 29897.5,-2017.82"/>
<text text-anchor="middle" x="29791" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="29791" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L10_ffn_down -->
<g id="edge868" class="edge">
<title>GPT3_2B_S2_R1_L10_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L10_ffn_down</title>
<path fill="none" stroke="black" d="M29791,-2089.5C29791,-2072.64 29791,-2047.39 29791,-2027.97"/>
<polygon fill="black" stroke="black" points="29794.5,-2027.87 29791,-2017.87 29787.5,-2027.87 29794.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L10_ar2 -->
<g id="node941" class="node">
<title>GPT3_2B_S2_R1_L10_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="29791" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L10_ffn_down&#45;&gt;GPT3_2B_S2_R1_L10_ar2 -->
<g id="edge869" class="edge">
<title>GPT3_2B_S2_R1_L10_ffn_down&#45;&gt;GPT3_2B_S2_R1_L10_ar2</title>
<path fill="none" stroke="black" d="M29791,-1979.72C29791,-1963.35 29791,-1938.76 29791,-1918.33"/>
<polygon fill="black" stroke="black" points="29794.5,-1918.1 29791,-1908.1 29787.5,-1918.1 29794.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L10_res2 -->
<g id="node942" class="node">
<title>GPT3_2B_S2_R1_L10_res2</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-1782.08 29739.11,-1782.08 29703.16,-1746.08 29842.89,-1746.08 29878.84,-1782.08"/>
<text text-anchor="middle" x="29791" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L10_ar2&#45;&gt;GPT3_2B_S2_R1_L10_res2 -->
<g id="edge870" class="edge">
<title>GPT3_2B_S2_R1_L10_ar2&#45;&gt;GPT3_2B_S2_R1_L10_res2</title>
<path fill="none" stroke="black" d="M29791,-1853.89C29791,-1835.51 29791,-1810.97 29791,-1792.34"/>
<polygon fill="black" stroke="black" points="29794.5,-1792.14 29791,-1782.14 29787.5,-1792.14 29794.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L11_split -->
<g id="node943" class="node">
<title>GPT3_2B_S2_R1_L11_split</title>
<polygon fill="orange" stroke="black" points="29349.7,-3091.04 28683.64,-3091.04 28512.3,-3015.04 29178.36,-3015.04 29349.7,-3091.04"/>
<text text-anchor="middle" x="28931" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28931" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_norm1 -->
<g id="node944" class="node">
<title>GPT3_2B_S2_R1_L11_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28931" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L11_split&#45;&gt;GPT3_2B_S2_R1_L11_norm1 -->
<g id="edge871" class="edge">
<title>GPT3_2B_S2_R1_L11_split&#45;&gt;GPT3_2B_S2_R1_L11_norm1</title>
<path fill="none" stroke="black" d="M28931,-3014.83C28931,-2995.62 28931,-2972.29 28931,-2953.24"/>
<polygon fill="black" stroke="black" points="28934.5,-2953.16 28931,-2943.16 28927.5,-2953.16 28934.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L11_qkv -->
<g id="node945" class="node">
<title>GPT3_2B_S2_R1_L11_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29073,-2817.3 28789,-2817.3 28789,-2779.3 29073,-2779.3 29073,-2817.3"/>
<text text-anchor="middle" x="28931" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28931" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_norm1&#45;&gt;GPT3_2B_S2_R1_L11_qkv -->
<g id="edge872" class="edge">
<title>GPT3_2B_S2_R1_L11_norm1&#45;&gt;GPT3_2B_S2_R1_L11_qkv</title>
<path fill="none" stroke="black" d="M28931,-2889.17C28931,-2870.9 28931,-2846.47 28931,-2827.7"/>
<polygon fill="black" stroke="black" points="28934.5,-2827.65 28931,-2817.65 28927.5,-2827.65 28934.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L11_attn -->
<g id="node946" class="node">
<title>GPT3_2B_S2_R1_L11_attn</title>
<polygon fill="lightcoral" stroke="black" points="29073,-2707.3 28789,-2707.3 28789,-2669.3 29073,-2669.3 29073,-2707.3"/>
<text text-anchor="middle" x="28931" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28931" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_qkv&#45;&gt;GPT3_2B_S2_R1_L11_attn -->
<g id="edge873" class="edge">
<title>GPT3_2B_S2_R1_L11_qkv&#45;&gt;GPT3_2B_S2_R1_L11_attn</title>
<path fill="none" stroke="black" d="M28931,-2778.98C28931,-2762.12 28931,-2736.87 28931,-2717.45"/>
<polygon fill="black" stroke="black" points="28934.5,-2717.35 28931,-2707.35 28927.5,-2717.35 28934.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L11_ar1 -->
<g id="node947" class="node">
<title>GPT3_2B_S2_R1_L11_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28931" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_attn&#45;&gt;GPT3_2B_S2_R1_L11_ar1 -->
<g id="edge874" class="edge">
<title>GPT3_2B_S2_R1_L11_attn&#45;&gt;GPT3_2B_S2_R1_L11_ar1</title>
<path fill="none" stroke="black" d="M28931,-2669.2C28931,-2652.83 28931,-2628.24 28931,-2607.81"/>
<polygon fill="black" stroke="black" points="28934.5,-2607.58 28931,-2597.58 28927.5,-2607.58 28934.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L11_res1 -->
<g id="node948" class="node">
<title>GPT3_2B_S2_R1_L11_res1</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-2471.56 28879.11,-2471.56 28843.16,-2435.56 28982.89,-2435.56 29018.84,-2471.56"/>
<text text-anchor="middle" x="28931" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L11_ar1&#45;&gt;GPT3_2B_S2_R1_L11_res1 -->
<g id="edge875" class="edge">
<title>GPT3_2B_S2_R1_L11_ar1&#45;&gt;GPT3_2B_S2_R1_L11_res1</title>
<path fill="none" stroke="black" d="M28931,-2543.37C28931,-2525 28931,-2500.45 28931,-2481.82"/>
<polygon fill="black" stroke="black" points="28934.5,-2481.62 28931,-2471.62 28927.5,-2481.62 28934.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L11_norm2 -->
<g id="node949" class="node">
<title>GPT3_2B_S2_R1_L11_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28931" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L11_res1&#45;&gt;GPT3_2B_S2_R1_L11_norm2 -->
<g id="edge876" class="edge">
<title>GPT3_2B_S2_R1_L11_res1&#45;&gt;GPT3_2B_S2_R1_L11_norm2</title>
<path fill="none" stroke="black" d="M28931,-2435.12C28931,-2418.97 28931,-2394.47 28931,-2374.07"/>
<polygon fill="black" stroke="black" points="28934.5,-2373.85 28931,-2363.85 28927.5,-2373.85 28934.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_up -->
<g id="node950" class="node">
<title>GPT3_2B_S2_R1_L11_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-2237.82 28824.5,-2237.82 28824.5,-2199.82 29037.5,-2199.82 29037.5,-2237.82"/>
<text text-anchor="middle" x="28931" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28931" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_norm2&#45;&gt;GPT3_2B_S2_R1_L11_ffn_up -->
<g id="edge877" class="edge">
<title>GPT3_2B_S2_R1_L11_norm2&#45;&gt;GPT3_2B_S2_R1_L11_ffn_up</title>
<path fill="none" stroke="black" d="M28931,-2309.69C28931,-2291.42 28931,-2266.99 28931,-2248.22"/>
<polygon fill="black" stroke="black" points="28934.5,-2248.17 28931,-2238.17 28927.5,-2248.17 28934.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_gate -->
<g id="node951" class="node">
<title>GPT3_2B_S2_R1_L11_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-2127.82 28824.5,-2127.82 28824.5,-2089.82 29037.5,-2089.82 29037.5,-2127.82"/>
<text text-anchor="middle" x="28931" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28931" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_up&#45;&gt;GPT3_2B_S2_R1_L11_ffn_gate -->
<g id="edge878" class="edge">
<title>GPT3_2B_S2_R1_L11_ffn_up&#45;&gt;GPT3_2B_S2_R1_L11_ffn_gate</title>
<path fill="none" stroke="black" d="M28931,-2199.5C28931,-2182.64 28931,-2157.39 28931,-2137.97"/>
<polygon fill="black" stroke="black" points="28934.5,-2137.87 28931,-2127.87 28927.5,-2137.87 28934.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_down -->
<g id="node952" class="node">
<title>GPT3_2B_S2_R1_L11_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-2017.82 28824.5,-2017.82 28824.5,-1979.82 29037.5,-1979.82 29037.5,-2017.82"/>
<text text-anchor="middle" x="28931" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28931" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L11_ffn_down -->
<g id="edge879" class="edge">
<title>GPT3_2B_S2_R1_L11_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L11_ffn_down</title>
<path fill="none" stroke="black" d="M28931,-2089.5C28931,-2072.64 28931,-2047.39 28931,-2027.97"/>
<polygon fill="black" stroke="black" points="28934.5,-2027.87 28931,-2017.87 28927.5,-2027.87 28934.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L11_ar2 -->
<g id="node953" class="node">
<title>GPT3_2B_S2_R1_L11_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28931" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L11_ffn_down&#45;&gt;GPT3_2B_S2_R1_L11_ar2 -->
<g id="edge880" class="edge">
<title>GPT3_2B_S2_R1_L11_ffn_down&#45;&gt;GPT3_2B_S2_R1_L11_ar2</title>
<path fill="none" stroke="black" d="M28931,-1979.72C28931,-1963.35 28931,-1938.76 28931,-1918.33"/>
<polygon fill="black" stroke="black" points="28934.5,-1918.1 28931,-1908.1 28927.5,-1918.1 28934.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L11_res2 -->
<g id="node954" class="node">
<title>GPT3_2B_S2_R1_L11_res2</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-1782.08 28879.11,-1782.08 28843.16,-1746.08 28982.89,-1746.08 29018.84,-1782.08"/>
<text text-anchor="middle" x="28931" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L11_ar2&#45;&gt;GPT3_2B_S2_R1_L11_res2 -->
<g id="edge881" class="edge">
<title>GPT3_2B_S2_R1_L11_ar2&#45;&gt;GPT3_2B_S2_R1_L11_res2</title>
<path fill="none" stroke="black" d="M28931,-1853.89C28931,-1835.51 28931,-1810.97 28931,-1792.34"/>
<polygon fill="black" stroke="black" points="28934.5,-1792.14 28931,-1782.14 28927.5,-1792.14 28934.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L12_split -->
<g id="node955" class="node">
<title>GPT3_2B_S2_R1_L12_split</title>
<polygon fill="orange" stroke="black" points="28489.7,-3091.04 27823.64,-3091.04 27652.3,-3015.04 28318.36,-3015.04 28489.7,-3091.04"/>
<text text-anchor="middle" x="28071" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28071" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_norm1 -->
<g id="node956" class="node">
<title>GPT3_2B_S2_R1_L12_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28071" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L12_split&#45;&gt;GPT3_2B_S2_R1_L12_norm1 -->
<g id="edge882" class="edge">
<title>GPT3_2B_S2_R1_L12_split&#45;&gt;GPT3_2B_S2_R1_L12_norm1</title>
<path fill="none" stroke="black" d="M28071,-3014.83C28071,-2995.62 28071,-2972.29 28071,-2953.24"/>
<polygon fill="black" stroke="black" points="28074.5,-2953.16 28071,-2943.16 28067.5,-2953.16 28074.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L12_qkv -->
<g id="node957" class="node">
<title>GPT3_2B_S2_R1_L12_qkv</title>
<polygon fill="lightcoral" stroke="black" points="28213,-2817.3 27929,-2817.3 27929,-2779.3 28213,-2779.3 28213,-2817.3"/>
<text text-anchor="middle" x="28071" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28071" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_norm1&#45;&gt;GPT3_2B_S2_R1_L12_qkv -->
<g id="edge883" class="edge">
<title>GPT3_2B_S2_R1_L12_norm1&#45;&gt;GPT3_2B_S2_R1_L12_qkv</title>
<path fill="none" stroke="black" d="M28071,-2889.17C28071,-2870.9 28071,-2846.47 28071,-2827.7"/>
<polygon fill="black" stroke="black" points="28074.5,-2827.65 28071,-2817.65 28067.5,-2827.65 28074.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L12_attn -->
<g id="node958" class="node">
<title>GPT3_2B_S2_R1_L12_attn</title>
<polygon fill="lightcoral" stroke="black" points="28213,-2707.3 27929,-2707.3 27929,-2669.3 28213,-2669.3 28213,-2707.3"/>
<text text-anchor="middle" x="28071" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28071" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_qkv&#45;&gt;GPT3_2B_S2_R1_L12_attn -->
<g id="edge884" class="edge">
<title>GPT3_2B_S2_R1_L12_qkv&#45;&gt;GPT3_2B_S2_R1_L12_attn</title>
<path fill="none" stroke="black" d="M28071,-2778.98C28071,-2762.12 28071,-2736.87 28071,-2717.45"/>
<polygon fill="black" stroke="black" points="28074.5,-2717.35 28071,-2707.35 28067.5,-2717.35 28074.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L12_ar1 -->
<g id="node959" class="node">
<title>GPT3_2B_S2_R1_L12_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28071" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_attn&#45;&gt;GPT3_2B_S2_R1_L12_ar1 -->
<g id="edge885" class="edge">
<title>GPT3_2B_S2_R1_L12_attn&#45;&gt;GPT3_2B_S2_R1_L12_ar1</title>
<path fill="none" stroke="black" d="M28071,-2669.2C28071,-2652.83 28071,-2628.24 28071,-2607.81"/>
<polygon fill="black" stroke="black" points="28074.5,-2607.58 28071,-2597.58 28067.5,-2607.58 28074.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L12_res1 -->
<g id="node960" class="node">
<title>GPT3_2B_S2_R1_L12_res1</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-2471.56 28019.11,-2471.56 27983.16,-2435.56 28122.89,-2435.56 28158.84,-2471.56"/>
<text text-anchor="middle" x="28071" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L12_ar1&#45;&gt;GPT3_2B_S2_R1_L12_res1 -->
<g id="edge886" class="edge">
<title>GPT3_2B_S2_R1_L12_ar1&#45;&gt;GPT3_2B_S2_R1_L12_res1</title>
<path fill="none" stroke="black" d="M28071,-2543.37C28071,-2525 28071,-2500.45 28071,-2481.82"/>
<polygon fill="black" stroke="black" points="28074.5,-2481.62 28071,-2471.62 28067.5,-2481.62 28074.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L12_norm2 -->
<g id="node961" class="node">
<title>GPT3_2B_S2_R1_L12_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28071" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L12_res1&#45;&gt;GPT3_2B_S2_R1_L12_norm2 -->
<g id="edge887" class="edge">
<title>GPT3_2B_S2_R1_L12_res1&#45;&gt;GPT3_2B_S2_R1_L12_norm2</title>
<path fill="none" stroke="black" d="M28071,-2435.12C28071,-2418.97 28071,-2394.47 28071,-2374.07"/>
<polygon fill="black" stroke="black" points="28074.5,-2373.85 28071,-2363.85 28067.5,-2373.85 28074.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_up -->
<g id="node962" class="node">
<title>GPT3_2B_S2_R1_L12_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-2237.82 27964.5,-2237.82 27964.5,-2199.82 28177.5,-2199.82 28177.5,-2237.82"/>
<text text-anchor="middle" x="28071" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28071" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_norm2&#45;&gt;GPT3_2B_S2_R1_L12_ffn_up -->
<g id="edge888" class="edge">
<title>GPT3_2B_S2_R1_L12_norm2&#45;&gt;GPT3_2B_S2_R1_L12_ffn_up</title>
<path fill="none" stroke="black" d="M28071,-2309.69C28071,-2291.42 28071,-2266.99 28071,-2248.22"/>
<polygon fill="black" stroke="black" points="28074.5,-2248.17 28071,-2238.17 28067.5,-2248.17 28074.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_gate -->
<g id="node963" class="node">
<title>GPT3_2B_S2_R1_L12_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-2127.82 27964.5,-2127.82 27964.5,-2089.82 28177.5,-2089.82 28177.5,-2127.82"/>
<text text-anchor="middle" x="28071" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28071" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_up&#45;&gt;GPT3_2B_S2_R1_L12_ffn_gate -->
<g id="edge889" class="edge">
<title>GPT3_2B_S2_R1_L12_ffn_up&#45;&gt;GPT3_2B_S2_R1_L12_ffn_gate</title>
<path fill="none" stroke="black" d="M28071,-2199.5C28071,-2182.64 28071,-2157.39 28071,-2137.97"/>
<polygon fill="black" stroke="black" points="28074.5,-2137.87 28071,-2127.87 28067.5,-2137.87 28074.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_down -->
<g id="node964" class="node">
<title>GPT3_2B_S2_R1_L12_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-2017.82 27964.5,-2017.82 27964.5,-1979.82 28177.5,-1979.82 28177.5,-2017.82"/>
<text text-anchor="middle" x="28071" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28071" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L12_ffn_down -->
<g id="edge890" class="edge">
<title>GPT3_2B_S2_R1_L12_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L12_ffn_down</title>
<path fill="none" stroke="black" d="M28071,-2089.5C28071,-2072.64 28071,-2047.39 28071,-2027.97"/>
<polygon fill="black" stroke="black" points="28074.5,-2027.87 28071,-2017.87 28067.5,-2027.87 28074.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L12_ar2 -->
<g id="node965" class="node">
<title>GPT3_2B_S2_R1_L12_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28071" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L12_ffn_down&#45;&gt;GPT3_2B_S2_R1_L12_ar2 -->
<g id="edge891" class="edge">
<title>GPT3_2B_S2_R1_L12_ffn_down&#45;&gt;GPT3_2B_S2_R1_L12_ar2</title>
<path fill="none" stroke="black" d="M28071,-1979.72C28071,-1963.35 28071,-1938.76 28071,-1918.33"/>
<polygon fill="black" stroke="black" points="28074.5,-1918.1 28071,-1908.1 28067.5,-1918.1 28074.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L12_res2 -->
<g id="node966" class="node">
<title>GPT3_2B_S2_R1_L12_res2</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-1782.08 28019.11,-1782.08 27983.16,-1746.08 28122.89,-1746.08 28158.84,-1782.08"/>
<text text-anchor="middle" x="28071" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L12_ar2&#45;&gt;GPT3_2B_S2_R1_L12_res2 -->
<g id="edge892" class="edge">
<title>GPT3_2B_S2_R1_L12_ar2&#45;&gt;GPT3_2B_S2_R1_L12_res2</title>
<path fill="none" stroke="black" d="M28071,-1853.89C28071,-1835.51 28071,-1810.97 28071,-1792.34"/>
<polygon fill="black" stroke="black" points="28074.5,-1792.14 28071,-1782.14 28067.5,-1792.14 28074.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L13_split -->
<g id="node967" class="node">
<title>GPT3_2B_S2_R1_L13_split</title>
<polygon fill="orange" stroke="black" points="27629.7,-3091.04 26963.64,-3091.04 26792.3,-3015.04 27458.36,-3015.04 27629.7,-3091.04"/>
<text text-anchor="middle" x="27211" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="27211" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_norm1 -->
<g id="node968" class="node">
<title>GPT3_2B_S2_R1_L13_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27211" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L13_split&#45;&gt;GPT3_2B_S2_R1_L13_norm1 -->
<g id="edge893" class="edge">
<title>GPT3_2B_S2_R1_L13_split&#45;&gt;GPT3_2B_S2_R1_L13_norm1</title>
<path fill="none" stroke="black" d="M27211,-3014.83C27211,-2995.62 27211,-2972.29 27211,-2953.24"/>
<polygon fill="black" stroke="black" points="27214.5,-2953.16 27211,-2943.16 27207.5,-2953.16 27214.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L13_qkv -->
<g id="node969" class="node">
<title>GPT3_2B_S2_R1_L13_qkv</title>
<polygon fill="lightcoral" stroke="black" points="27353,-2817.3 27069,-2817.3 27069,-2779.3 27353,-2779.3 27353,-2817.3"/>
<text text-anchor="middle" x="27211" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="27211" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_norm1&#45;&gt;GPT3_2B_S2_R1_L13_qkv -->
<g id="edge894" class="edge">
<title>GPT3_2B_S2_R1_L13_norm1&#45;&gt;GPT3_2B_S2_R1_L13_qkv</title>
<path fill="none" stroke="black" d="M27211,-2889.17C27211,-2870.9 27211,-2846.47 27211,-2827.7"/>
<polygon fill="black" stroke="black" points="27214.5,-2827.65 27211,-2817.65 27207.5,-2827.65 27214.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L13_attn -->
<g id="node970" class="node">
<title>GPT3_2B_S2_R1_L13_attn</title>
<polygon fill="lightcoral" stroke="black" points="27353,-2707.3 27069,-2707.3 27069,-2669.3 27353,-2669.3 27353,-2707.3"/>
<text text-anchor="middle" x="27211" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="27211" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_qkv&#45;&gt;GPT3_2B_S2_R1_L13_attn -->
<g id="edge895" class="edge">
<title>GPT3_2B_S2_R1_L13_qkv&#45;&gt;GPT3_2B_S2_R1_L13_attn</title>
<path fill="none" stroke="black" d="M27211,-2778.98C27211,-2762.12 27211,-2736.87 27211,-2717.45"/>
<polygon fill="black" stroke="black" points="27214.5,-2717.35 27211,-2707.35 27207.5,-2717.35 27214.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L13_ar1 -->
<g id="node971" class="node">
<title>GPT3_2B_S2_R1_L13_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="27211" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_attn&#45;&gt;GPT3_2B_S2_R1_L13_ar1 -->
<g id="edge896" class="edge">
<title>GPT3_2B_S2_R1_L13_attn&#45;&gt;GPT3_2B_S2_R1_L13_ar1</title>
<path fill="none" stroke="black" d="M27211,-2669.2C27211,-2652.83 27211,-2628.24 27211,-2607.81"/>
<polygon fill="black" stroke="black" points="27214.5,-2607.58 27211,-2597.58 27207.5,-2607.58 27214.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L13_res1 -->
<g id="node972" class="node">
<title>GPT3_2B_S2_R1_L13_res1</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-2471.56 27159.11,-2471.56 27123.16,-2435.56 27262.89,-2435.56 27298.84,-2471.56"/>
<text text-anchor="middle" x="27211" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L13_ar1&#45;&gt;GPT3_2B_S2_R1_L13_res1 -->
<g id="edge897" class="edge">
<title>GPT3_2B_S2_R1_L13_ar1&#45;&gt;GPT3_2B_S2_R1_L13_res1</title>
<path fill="none" stroke="black" d="M27211,-2543.37C27211,-2525 27211,-2500.45 27211,-2481.82"/>
<polygon fill="black" stroke="black" points="27214.5,-2481.62 27211,-2471.62 27207.5,-2481.62 27214.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L13_norm2 -->
<g id="node973" class="node">
<title>GPT3_2B_S2_R1_L13_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="27211" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L13_res1&#45;&gt;GPT3_2B_S2_R1_L13_norm2 -->
<g id="edge898" class="edge">
<title>GPT3_2B_S2_R1_L13_res1&#45;&gt;GPT3_2B_S2_R1_L13_norm2</title>
<path fill="none" stroke="black" d="M27211,-2435.12C27211,-2418.97 27211,-2394.47 27211,-2374.07"/>
<polygon fill="black" stroke="black" points="27214.5,-2373.85 27211,-2363.85 27207.5,-2373.85 27214.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_up -->
<g id="node974" class="node">
<title>GPT3_2B_S2_R1_L13_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-2237.82 27104.5,-2237.82 27104.5,-2199.82 27317.5,-2199.82 27317.5,-2237.82"/>
<text text-anchor="middle" x="27211" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="27211" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_norm2&#45;&gt;GPT3_2B_S2_R1_L13_ffn_up -->
<g id="edge899" class="edge">
<title>GPT3_2B_S2_R1_L13_norm2&#45;&gt;GPT3_2B_S2_R1_L13_ffn_up</title>
<path fill="none" stroke="black" d="M27211,-2309.69C27211,-2291.42 27211,-2266.99 27211,-2248.22"/>
<polygon fill="black" stroke="black" points="27214.5,-2248.17 27211,-2238.17 27207.5,-2248.17 27214.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_gate -->
<g id="node975" class="node">
<title>GPT3_2B_S2_R1_L13_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-2127.82 27104.5,-2127.82 27104.5,-2089.82 27317.5,-2089.82 27317.5,-2127.82"/>
<text text-anchor="middle" x="27211" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="27211" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_up&#45;&gt;GPT3_2B_S2_R1_L13_ffn_gate -->
<g id="edge900" class="edge">
<title>GPT3_2B_S2_R1_L13_ffn_up&#45;&gt;GPT3_2B_S2_R1_L13_ffn_gate</title>
<path fill="none" stroke="black" d="M27211,-2199.5C27211,-2182.64 27211,-2157.39 27211,-2137.97"/>
<polygon fill="black" stroke="black" points="27214.5,-2137.87 27211,-2127.87 27207.5,-2137.87 27214.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_down -->
<g id="node976" class="node">
<title>GPT3_2B_S2_R1_L13_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-2017.82 27104.5,-2017.82 27104.5,-1979.82 27317.5,-1979.82 27317.5,-2017.82"/>
<text text-anchor="middle" x="27211" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="27211" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L13_ffn_down -->
<g id="edge901" class="edge">
<title>GPT3_2B_S2_R1_L13_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L13_ffn_down</title>
<path fill="none" stroke="black" d="M27211,-2089.5C27211,-2072.64 27211,-2047.39 27211,-2027.97"/>
<polygon fill="black" stroke="black" points="27214.5,-2027.87 27211,-2017.87 27207.5,-2027.87 27214.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L13_ar2 -->
<g id="node977" class="node">
<title>GPT3_2B_S2_R1_L13_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="27211" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L13_ffn_down&#45;&gt;GPT3_2B_S2_R1_L13_ar2 -->
<g id="edge902" class="edge">
<title>GPT3_2B_S2_R1_L13_ffn_down&#45;&gt;GPT3_2B_S2_R1_L13_ar2</title>
<path fill="none" stroke="black" d="M27211,-1979.72C27211,-1963.35 27211,-1938.76 27211,-1918.33"/>
<polygon fill="black" stroke="black" points="27214.5,-1918.1 27211,-1908.1 27207.5,-1918.1 27214.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L13_res2 -->
<g id="node978" class="node">
<title>GPT3_2B_S2_R1_L13_res2</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-1782.08 27159.11,-1782.08 27123.16,-1746.08 27262.89,-1746.08 27298.84,-1782.08"/>
<text text-anchor="middle" x="27211" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L13_ar2&#45;&gt;GPT3_2B_S2_R1_L13_res2 -->
<g id="edge903" class="edge">
<title>GPT3_2B_S2_R1_L13_ar2&#45;&gt;GPT3_2B_S2_R1_L13_res2</title>
<path fill="none" stroke="black" d="M27211,-1853.89C27211,-1835.51 27211,-1810.97 27211,-1792.34"/>
<polygon fill="black" stroke="black" points="27214.5,-1792.14 27211,-1782.14 27207.5,-1792.14 27214.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L14_split -->
<g id="node979" class="node">
<title>GPT3_2B_S2_R1_L14_split</title>
<polygon fill="orange" stroke="black" points="26769.7,-3091.04 26103.64,-3091.04 25932.3,-3015.04 26598.36,-3015.04 26769.7,-3091.04"/>
<text text-anchor="middle" x="26351" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="26351" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_norm1 -->
<g id="node980" class="node">
<title>GPT3_2B_S2_R1_L14_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26351" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L14_split&#45;&gt;GPT3_2B_S2_R1_L14_norm1 -->
<g id="edge904" class="edge">
<title>GPT3_2B_S2_R1_L14_split&#45;&gt;GPT3_2B_S2_R1_L14_norm1</title>
<path fill="none" stroke="black" d="M26351,-3014.83C26351,-2995.62 26351,-2972.29 26351,-2953.24"/>
<polygon fill="black" stroke="black" points="26354.5,-2953.16 26351,-2943.16 26347.5,-2953.16 26354.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L14_qkv -->
<g id="node981" class="node">
<title>GPT3_2B_S2_R1_L14_qkv</title>
<polygon fill="lightcoral" stroke="black" points="26493,-2817.3 26209,-2817.3 26209,-2779.3 26493,-2779.3 26493,-2817.3"/>
<text text-anchor="middle" x="26351" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="26351" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_norm1&#45;&gt;GPT3_2B_S2_R1_L14_qkv -->
<g id="edge905" class="edge">
<title>GPT3_2B_S2_R1_L14_norm1&#45;&gt;GPT3_2B_S2_R1_L14_qkv</title>
<path fill="none" stroke="black" d="M26351,-2889.17C26351,-2870.9 26351,-2846.47 26351,-2827.7"/>
<polygon fill="black" stroke="black" points="26354.5,-2827.65 26351,-2817.65 26347.5,-2827.65 26354.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L14_attn -->
<g id="node982" class="node">
<title>GPT3_2B_S2_R1_L14_attn</title>
<polygon fill="lightcoral" stroke="black" points="26493,-2707.3 26209,-2707.3 26209,-2669.3 26493,-2669.3 26493,-2707.3"/>
<text text-anchor="middle" x="26351" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="26351" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_qkv&#45;&gt;GPT3_2B_S2_R1_L14_attn -->
<g id="edge906" class="edge">
<title>GPT3_2B_S2_R1_L14_qkv&#45;&gt;GPT3_2B_S2_R1_L14_attn</title>
<path fill="none" stroke="black" d="M26351,-2778.98C26351,-2762.12 26351,-2736.87 26351,-2717.45"/>
<polygon fill="black" stroke="black" points="26354.5,-2717.35 26351,-2707.35 26347.5,-2717.35 26354.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L14_ar1 -->
<g id="node983" class="node">
<title>GPT3_2B_S2_R1_L14_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="26351" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_attn&#45;&gt;GPT3_2B_S2_R1_L14_ar1 -->
<g id="edge907" class="edge">
<title>GPT3_2B_S2_R1_L14_attn&#45;&gt;GPT3_2B_S2_R1_L14_ar1</title>
<path fill="none" stroke="black" d="M26351,-2669.2C26351,-2652.83 26351,-2628.24 26351,-2607.81"/>
<polygon fill="black" stroke="black" points="26354.5,-2607.58 26351,-2597.58 26347.5,-2607.58 26354.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L14_res1 -->
<g id="node984" class="node">
<title>GPT3_2B_S2_R1_L14_res1</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-2471.56 26299.11,-2471.56 26263.16,-2435.56 26402.89,-2435.56 26438.84,-2471.56"/>
<text text-anchor="middle" x="26351" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L14_ar1&#45;&gt;GPT3_2B_S2_R1_L14_res1 -->
<g id="edge908" class="edge">
<title>GPT3_2B_S2_R1_L14_ar1&#45;&gt;GPT3_2B_S2_R1_L14_res1</title>
<path fill="none" stroke="black" d="M26351,-2543.37C26351,-2525 26351,-2500.45 26351,-2481.82"/>
<polygon fill="black" stroke="black" points="26354.5,-2481.62 26351,-2471.62 26347.5,-2481.62 26354.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L14_norm2 -->
<g id="node985" class="node">
<title>GPT3_2B_S2_R1_L14_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="26351" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L14_res1&#45;&gt;GPT3_2B_S2_R1_L14_norm2 -->
<g id="edge909" class="edge">
<title>GPT3_2B_S2_R1_L14_res1&#45;&gt;GPT3_2B_S2_R1_L14_norm2</title>
<path fill="none" stroke="black" d="M26351,-2435.12C26351,-2418.97 26351,-2394.47 26351,-2374.07"/>
<polygon fill="black" stroke="black" points="26354.5,-2373.85 26351,-2363.85 26347.5,-2373.85 26354.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_up -->
<g id="node986" class="node">
<title>GPT3_2B_S2_R1_L14_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-2237.82 26244.5,-2237.82 26244.5,-2199.82 26457.5,-2199.82 26457.5,-2237.82"/>
<text text-anchor="middle" x="26351" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="26351" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_norm2&#45;&gt;GPT3_2B_S2_R1_L14_ffn_up -->
<g id="edge910" class="edge">
<title>GPT3_2B_S2_R1_L14_norm2&#45;&gt;GPT3_2B_S2_R1_L14_ffn_up</title>
<path fill="none" stroke="black" d="M26351,-2309.69C26351,-2291.42 26351,-2266.99 26351,-2248.22"/>
<polygon fill="black" stroke="black" points="26354.5,-2248.17 26351,-2238.17 26347.5,-2248.17 26354.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_gate -->
<g id="node987" class="node">
<title>GPT3_2B_S2_R1_L14_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-2127.82 26244.5,-2127.82 26244.5,-2089.82 26457.5,-2089.82 26457.5,-2127.82"/>
<text text-anchor="middle" x="26351" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="26351" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_up&#45;&gt;GPT3_2B_S2_R1_L14_ffn_gate -->
<g id="edge911" class="edge">
<title>GPT3_2B_S2_R1_L14_ffn_up&#45;&gt;GPT3_2B_S2_R1_L14_ffn_gate</title>
<path fill="none" stroke="black" d="M26351,-2199.5C26351,-2182.64 26351,-2157.39 26351,-2137.97"/>
<polygon fill="black" stroke="black" points="26354.5,-2137.87 26351,-2127.87 26347.5,-2137.87 26354.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_down -->
<g id="node988" class="node">
<title>GPT3_2B_S2_R1_L14_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-2017.82 26244.5,-2017.82 26244.5,-1979.82 26457.5,-1979.82 26457.5,-2017.82"/>
<text text-anchor="middle" x="26351" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="26351" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L14_ffn_down -->
<g id="edge912" class="edge">
<title>GPT3_2B_S2_R1_L14_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L14_ffn_down</title>
<path fill="none" stroke="black" d="M26351,-2089.5C26351,-2072.64 26351,-2047.39 26351,-2027.97"/>
<polygon fill="black" stroke="black" points="26354.5,-2027.87 26351,-2017.87 26347.5,-2027.87 26354.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L14_ar2 -->
<g id="node989" class="node">
<title>GPT3_2B_S2_R1_L14_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="26351" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L14_ffn_down&#45;&gt;GPT3_2B_S2_R1_L14_ar2 -->
<g id="edge913" class="edge">
<title>GPT3_2B_S2_R1_L14_ffn_down&#45;&gt;GPT3_2B_S2_R1_L14_ar2</title>
<path fill="none" stroke="black" d="M26351,-1979.72C26351,-1963.35 26351,-1938.76 26351,-1918.33"/>
<polygon fill="black" stroke="black" points="26354.5,-1918.1 26351,-1908.1 26347.5,-1918.1 26354.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L14_res2 -->
<g id="node990" class="node">
<title>GPT3_2B_S2_R1_L14_res2</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-1782.08 26299.11,-1782.08 26263.16,-1746.08 26402.89,-1746.08 26438.84,-1782.08"/>
<text text-anchor="middle" x="26351" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L14_ar2&#45;&gt;GPT3_2B_S2_R1_L14_res2 -->
<g id="edge914" class="edge">
<title>GPT3_2B_S2_R1_L14_ar2&#45;&gt;GPT3_2B_S2_R1_L14_res2</title>
<path fill="none" stroke="black" d="M26351,-1853.89C26351,-1835.51 26351,-1810.97 26351,-1792.34"/>
<polygon fill="black" stroke="black" points="26354.5,-1792.14 26351,-1782.14 26347.5,-1792.14 26354.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L15_split -->
<g id="node991" class="node">
<title>GPT3_2B_S2_R1_L15_split</title>
<polygon fill="orange" stroke="black" points="25909.7,-3091.04 25243.64,-3091.04 25072.3,-3015.04 25738.36,-3015.04 25909.7,-3091.04"/>
<text text-anchor="middle" x="25491" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="25491" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_norm1 -->
<g id="node992" class="node">
<title>GPT3_2B_S2_R1_L15_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25491" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L15_split&#45;&gt;GPT3_2B_S2_R1_L15_norm1 -->
<g id="edge915" class="edge">
<title>GPT3_2B_S2_R1_L15_split&#45;&gt;GPT3_2B_S2_R1_L15_norm1</title>
<path fill="none" stroke="black" d="M25491,-3014.83C25491,-2995.62 25491,-2972.29 25491,-2953.24"/>
<polygon fill="black" stroke="black" points="25494.5,-2953.16 25491,-2943.16 25487.5,-2953.16 25494.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R1_L15_qkv -->
<g id="node993" class="node">
<title>GPT3_2B_S2_R1_L15_qkv</title>
<polygon fill="lightcoral" stroke="black" points="25633,-2817.3 25349,-2817.3 25349,-2779.3 25633,-2779.3 25633,-2817.3"/>
<text text-anchor="middle" x="25491" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="25491" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_norm1&#45;&gt;GPT3_2B_S2_R1_L15_qkv -->
<g id="edge916" class="edge">
<title>GPT3_2B_S2_R1_L15_norm1&#45;&gt;GPT3_2B_S2_R1_L15_qkv</title>
<path fill="none" stroke="black" d="M25491,-2889.17C25491,-2870.9 25491,-2846.47 25491,-2827.7"/>
<polygon fill="black" stroke="black" points="25494.5,-2827.65 25491,-2817.65 25487.5,-2827.65 25494.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L15_attn -->
<g id="node994" class="node">
<title>GPT3_2B_S2_R1_L15_attn</title>
<polygon fill="lightcoral" stroke="black" points="25633,-2707.3 25349,-2707.3 25349,-2669.3 25633,-2669.3 25633,-2707.3"/>
<text text-anchor="middle" x="25491" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="25491" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_qkv&#45;&gt;GPT3_2B_S2_R1_L15_attn -->
<g id="edge917" class="edge">
<title>GPT3_2B_S2_R1_L15_qkv&#45;&gt;GPT3_2B_S2_R1_L15_attn</title>
<path fill="none" stroke="black" d="M25491,-2778.98C25491,-2762.12 25491,-2736.87 25491,-2717.45"/>
<polygon fill="black" stroke="black" points="25494.5,-2717.35 25491,-2707.35 25487.5,-2717.35 25494.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L15_ar1 -->
<g id="node995" class="node">
<title>GPT3_2B_S2_R1_L15_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="25491" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_attn&#45;&gt;GPT3_2B_S2_R1_L15_ar1 -->
<g id="edge918" class="edge">
<title>GPT3_2B_S2_R1_L15_attn&#45;&gt;GPT3_2B_S2_R1_L15_ar1</title>
<path fill="none" stroke="black" d="M25491,-2669.2C25491,-2652.83 25491,-2628.24 25491,-2607.81"/>
<polygon fill="black" stroke="black" points="25494.5,-2607.58 25491,-2597.58 25487.5,-2607.58 25494.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R1_L15_res1 -->
<g id="node996" class="node">
<title>GPT3_2B_S2_R1_L15_res1</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-2471.56 25439.11,-2471.56 25403.16,-2435.56 25542.89,-2435.56 25578.84,-2471.56"/>
<text text-anchor="middle" x="25491" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L15_ar1&#45;&gt;GPT3_2B_S2_R1_L15_res1 -->
<g id="edge919" class="edge">
<title>GPT3_2B_S2_R1_L15_ar1&#45;&gt;GPT3_2B_S2_R1_L15_res1</title>
<path fill="none" stroke="black" d="M25491,-2543.37C25491,-2525 25491,-2500.45 25491,-2481.82"/>
<polygon fill="black" stroke="black" points="25494.5,-2481.62 25491,-2471.62 25487.5,-2481.62 25494.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R1_L15_norm2 -->
<g id="node997" class="node">
<title>GPT3_2B_S2_R1_L15_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="25491" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L15_res1&#45;&gt;GPT3_2B_S2_R1_L15_norm2 -->
<g id="edge920" class="edge">
<title>GPT3_2B_S2_R1_L15_res1&#45;&gt;GPT3_2B_S2_R1_L15_norm2</title>
<path fill="none" stroke="black" d="M25491,-2435.12C25491,-2418.97 25491,-2394.47 25491,-2374.07"/>
<polygon fill="black" stroke="black" points="25494.5,-2373.85 25491,-2363.85 25487.5,-2373.85 25494.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_up -->
<g id="node998" class="node">
<title>GPT3_2B_S2_R1_L15_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-2237.82 25384.5,-2237.82 25384.5,-2199.82 25597.5,-2199.82 25597.5,-2237.82"/>
<text text-anchor="middle" x="25491" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="25491" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_norm2&#45;&gt;GPT3_2B_S2_R1_L15_ffn_up -->
<g id="edge921" class="edge">
<title>GPT3_2B_S2_R1_L15_norm2&#45;&gt;GPT3_2B_S2_R1_L15_ffn_up</title>
<path fill="none" stroke="black" d="M25491,-2309.69C25491,-2291.42 25491,-2266.99 25491,-2248.22"/>
<polygon fill="black" stroke="black" points="25494.5,-2248.17 25491,-2238.17 25487.5,-2248.17 25494.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_gate -->
<g id="node999" class="node">
<title>GPT3_2B_S2_R1_L15_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-2127.82 25384.5,-2127.82 25384.5,-2089.82 25597.5,-2089.82 25597.5,-2127.82"/>
<text text-anchor="middle" x="25491" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="25491" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_up&#45;&gt;GPT3_2B_S2_R1_L15_ffn_gate -->
<g id="edge922" class="edge">
<title>GPT3_2B_S2_R1_L15_ffn_up&#45;&gt;GPT3_2B_S2_R1_L15_ffn_gate</title>
<path fill="none" stroke="black" d="M25491,-2199.5C25491,-2182.64 25491,-2157.39 25491,-2137.97"/>
<polygon fill="black" stroke="black" points="25494.5,-2137.87 25491,-2127.87 25487.5,-2137.87 25494.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_down -->
<g id="node1000" class="node">
<title>GPT3_2B_S2_R1_L15_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-2017.82 25384.5,-2017.82 25384.5,-1979.82 25597.5,-1979.82 25597.5,-2017.82"/>
<text text-anchor="middle" x="25491" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="25491" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L15_ffn_down -->
<g id="edge923" class="edge">
<title>GPT3_2B_S2_R1_L15_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L15_ffn_down</title>
<path fill="none" stroke="black" d="M25491,-2089.5C25491,-2072.64 25491,-2047.39 25491,-2027.97"/>
<polygon fill="black" stroke="black" points="25494.5,-2027.87 25491,-2017.87 25487.5,-2027.87 25494.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R1_L15_ar2 -->
<g id="node1001" class="node">
<title>GPT3_2B_S2_R1_L15_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="25491" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L15_ffn_down&#45;&gt;GPT3_2B_S2_R1_L15_ar2 -->
<g id="edge924" class="edge">
<title>GPT3_2B_S2_R1_L15_ffn_down&#45;&gt;GPT3_2B_S2_R1_L15_ar2</title>
<path fill="none" stroke="black" d="M25491,-1979.72C25491,-1963.35 25491,-1938.76 25491,-1918.33"/>
<polygon fill="black" stroke="black" points="25494.5,-1918.1 25491,-1908.1 25487.5,-1918.1 25494.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R1_L15_res2 -->
<g id="node1002" class="node">
<title>GPT3_2B_S2_R1_L15_res2</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-1782.08 25439.11,-1782.08 25403.16,-1746.08 25542.89,-1746.08 25578.84,-1782.08"/>
<text text-anchor="middle" x="25491" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L15_ar2&#45;&gt;GPT3_2B_S2_R1_L15_res2 -->
<g id="edge925" class="edge">
<title>GPT3_2B_S2_R1_L15_ar2&#45;&gt;GPT3_2B_S2_R1_L15_res2</title>
<path fill="none" stroke="black" d="M25491,-1853.89C25491,-1835.51 25491,-1810.97 25491,-1792.34"/>
<polygon fill="black" stroke="black" points="25494.5,-1792.14 25491,-1782.14 25487.5,-1792.14 25494.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R1_L16_split -->
<g id="node1003" class="node">
<title>GPT3_2B_S2_R1_L16_split</title>
<polygon fill="orange" stroke="black" points="25049.7,-3091.04 24383.64,-3091.04 24212.3,-3015.04 24878.36,-3015.04 25049.7,-3091.04"/>
<text text-anchor="middle" x="24631" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="24631" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_norm1 -->
<g id="node1004" class="node">
<title>GPT3_2B_S2_R1_L16_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="24592" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24592" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24592" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L16_split&#45;&gt;GPT3_2B_S2_R1_L16_norm1 -->
<g id="edge926" class="edge">
<title>GPT3_2B_S2_R1_L16_split&#45;&gt;GPT3_2B_S2_R1_L16_norm1</title>
<path fill="none" stroke="black" d="M24620.24,-3014.83C24614.66,-2995.53 24607.87,-2972.07 24602.35,-2952.98"/>
<polygon fill="black" stroke="black" points="24605.65,-2951.79 24599.51,-2943.16 24598.93,-2953.74 24605.65,-2951.79"/>
</g>
<!-- GPT3_2B_S2_R1_L16_qkv -->
<g id="node1005" class="node">
<title>GPT3_2B_S2_R1_L16_qkv</title>
<polygon fill="lightcoral" stroke="black" points="24734,-2817.3 24450,-2817.3 24450,-2779.3 24734,-2779.3 24734,-2817.3"/>
<text text-anchor="middle" x="24592" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="24592" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_norm1&#45;&gt;GPT3_2B_S2_R1_L16_qkv -->
<g id="edge927" class="edge">
<title>GPT3_2B_S2_R1_L16_norm1&#45;&gt;GPT3_2B_S2_R1_L16_qkv</title>
<path fill="none" stroke="black" d="M24592,-2889.17C24592,-2870.9 24592,-2846.47 24592,-2827.7"/>
<polygon fill="black" stroke="black" points="24595.5,-2827.65 24592,-2817.65 24588.5,-2827.65 24595.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R1_L16_attn -->
<g id="node1006" class="node">
<title>GPT3_2B_S2_R1_L16_attn</title>
<polygon fill="lightcoral" stroke="black" points="24734,-2707.3 24450,-2707.3 24450,-2669.3 24734,-2669.3 24734,-2707.3"/>
<text text-anchor="middle" x="24592" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="24592" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_qkv&#45;&gt;GPT3_2B_S2_R1_L16_attn -->
<g id="edge928" class="edge">
<title>GPT3_2B_S2_R1_L16_qkv&#45;&gt;GPT3_2B_S2_R1_L16_attn</title>
<path fill="none" stroke="black" d="M24592,-2778.98C24592,-2762.12 24592,-2736.87 24592,-2717.45"/>
<polygon fill="black" stroke="black" points="24595.5,-2717.35 24592,-2707.35 24588.5,-2717.35 24595.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R1_L16_ar1 -->
<g id="node1007" class="node">
<title>GPT3_2B_S2_R1_L16_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24590" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24590" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="24590" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_attn&#45;&gt;GPT3_2B_S2_R1_L16_ar1 -->
<g id="edge929" class="edge">
<title>GPT3_2B_S2_R1_L16_attn&#45;&gt;GPT3_2B_S2_R1_L16_ar1</title>
<path fill="none" stroke="black" d="M24591.69,-2669.2C24591.4,-2652.83 24590.98,-2628.24 24590.63,-2607.81"/>
<polygon fill="black" stroke="black" points="24594.12,-2607.52 24590.45,-2597.58 24587.12,-2607.64 24594.12,-2607.52"/>
</g>
<!-- GPT3_2B_S2_R1_L16_res1 -->
<g id="node1008" class="node">
<title>GPT3_2B_S2_R1_L16_res1</title>
<polygon fill="lightyellow" stroke="black" points="24676.84,-2471.56 24537.11,-2471.56 24501.16,-2435.56 24640.89,-2435.56 24676.84,-2471.56"/>
<text text-anchor="middle" x="24589" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R1_L16_ar1&#45;&gt;GPT3_2B_S2_R1_L16_res1 -->
<g id="edge930" class="edge">
<title>GPT3_2B_S2_R1_L16_ar1&#45;&gt;GPT3_2B_S2_R1_L16_res1</title>
<path fill="none" stroke="black" d="M24589.77,-2543.37C24589.61,-2525 24589.4,-2500.45 24589.24,-2481.82"/>
<polygon fill="black" stroke="black" points="24592.74,-2481.59 24589.15,-2471.62 24585.74,-2481.65 24592.74,-2481.59"/>
</g>
<!-- GPT3_2B_S2_R1_L16_norm2 -->
<g id="node1009" class="node">
<title>GPT3_2B_S2_R1_L16_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="24511" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24511" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="24511" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_3</text>
</g>
<!-- GPT3_2B_S2_R1_L16_res1&#45;&gt;GPT3_2B_S2_R1_L16_norm2 -->
<g id="edge931" class="edge">
<title>GPT3_2B_S2_R1_L16_res1&#45;&gt;GPT3_2B_S2_R1_L16_norm2</title>
<path fill="none" stroke="black" d="M24577.15,-2435.12C24565.77,-2418.35 24548.25,-2392.55 24534.1,-2371.71"/>
<polygon fill="black" stroke="black" points="24536.98,-2369.72 24528.47,-2363.42 24531.19,-2373.66 24536.98,-2369.72"/>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_up -->
<g id="node1010" class="node">
<title>GPT3_2B_S2_R1_L16_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="24461.5,-2237.82 24248.5,-2237.82 24248.5,-2199.82 24461.5,-2199.82 24461.5,-2237.82"/>
<text text-anchor="middle" x="24355" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="24355" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_norm2&#45;&gt;GPT3_2B_S2_R1_L16_ffn_up -->
<g id="edge932" class="edge">
<title>GPT3_2B_S2_R1_L16_norm2&#45;&gt;GPT3_2B_S2_R1_L16_ffn_up</title>
<path fill="none" stroke="black" d="M24478.68,-2311.68C24452.1,-2291.94 24414.61,-2264.09 24387.88,-2244.24"/>
<polygon fill="black" stroke="black" points="24389.72,-2241.25 24379.61,-2238.1 24385.55,-2246.87 24389.72,-2241.25"/>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_gate -->
<g id="node1011" class="node">
<title>GPT3_2B_S2_R1_L16_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="24457.5,-2127.82 24244.5,-2127.82 24244.5,-2089.82 24457.5,-2089.82 24457.5,-2127.82"/>
<text text-anchor="middle" x="24351" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="24351" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_up&#45;&gt;GPT3_2B_S2_R1_L16_ffn_gate -->
<g id="edge933" class="edge">
<title>GPT3_2B_S2_R1_L16_ffn_up&#45;&gt;GPT3_2B_S2_R1_L16_ffn_gate</title>
<path fill="none" stroke="black" d="M24354.32,-2199.5C24353.7,-2182.64 24352.76,-2157.39 24352.04,-2137.97"/>
<polygon fill="black" stroke="black" points="24355.54,-2137.74 24351.67,-2127.87 24348.54,-2137.99 24355.54,-2137.74"/>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_down -->
<g id="node1012" class="node">
<title>GPT3_2B_S2_R1_L16_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="24450.5,-2017.82 24237.5,-2017.82 24237.5,-1979.82 24450.5,-1979.82 24450.5,-2017.82"/>
<text text-anchor="middle" x="24344" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="24344" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L16_ffn_down -->
<g id="edge934" class="edge">
<title>GPT3_2B_S2_R1_L16_ffn_gate&#45;&gt;GPT3_2B_S2_R1_L16_ffn_down</title>
<path fill="none" stroke="black" d="M24349.81,-2089.5C24348.72,-2072.64 24347.08,-2047.39 24345.82,-2027.97"/>
<polygon fill="black" stroke="black" points="24349.31,-2027.62 24345.17,-2017.87 24342.32,-2028.08 24349.31,-2027.62"/>
</g>
<!-- GPT3_2B_S2_R1_L16_ar2 -->
<g id="node1013" class="node">
<title>GPT3_2B_S2_R1_L16_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24330" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24330" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="24330" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_ffn_down&#45;&gt;GPT3_2B_S2_R1_L16_ar2 -->
<g id="edge935" class="edge">
<title>GPT3_2B_S2_R1_L16_ffn_down&#45;&gt;GPT3_2B_S2_R1_L16_ar2</title>
<path fill="none" stroke="black" d="M24341.81,-1979.72C24339.83,-1963.27 24336.84,-1938.53 24334.36,-1918.05"/>
<polygon fill="black" stroke="black" points="24337.83,-1917.61 24333.16,-1908.1 24330.88,-1918.45 24337.83,-1917.61"/>
</g>
<!-- GPT3_2B_S2_R1_L16_res2 -->
<g id="node1014" class="node">
<title>GPT3_2B_S2_R1_L16_res2</title>
<polygon fill="lightyellow" stroke="black" points="24388.84,-1782.08 24249.11,-1782.08 24213.16,-1746.08 24352.89,-1746.08 24388.84,-1782.08"/>
<text text-anchor="middle" x="24301" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R1_L16_ar2&#45;&gt;GPT3_2B_S2_R1_L16_res2 -->
<g id="edge936" class="edge">
<title>GPT3_2B_S2_R1_L16_ar2&#45;&gt;GPT3_2B_S2_R1_L16_res2</title>
<path fill="none" stroke="black" d="M24323.42,-1853.89C24318.76,-1835.43 24312.53,-1810.74 24307.82,-1792.08"/>
<polygon fill="black" stroke="black" points="24311.15,-1790.98 24305.31,-1782.14 24304.36,-1792.7 24311.15,-1790.98"/>
</g>
<!-- GPT3_2B_comm_2_3 -->
<g id="node1304" class="node">
<title>GPT3_2B_comm_2_3</title>
<ellipse fill="lightyellow" stroke="black" stroke-dasharray="5,2" cx="24035" cy="-1636.61" rx="200.64" ry="37.45"/>
<text text-anchor="middle" x="24035" y="-1647.91" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="24035" y="-1632.91" font-family="Times,serif" font-size="14.00">Stage 2 → 3</text>
<text text-anchor="middle" x="24035" y="-1617.91" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]</text>
</g>
<!-- GPT3_2B_S2_R1_L16_res2&#45;&gt;GPT3_2B_comm_2_3 -->
<g id="edge1205" class="edge">
<title>GPT3_2B_S2_R1_L16_res2&#45;&gt;GPT3_2B_comm_2_3</title>
<path fill="none" stroke="black" d="M24264.85,-1746.03C24226.87,-1728.11 24165.88,-1699.34 24116.27,-1675.94"/>
<polygon fill="black" stroke="black" points="24117.68,-1672.74 24107.15,-1671.64 24114.7,-1679.07 24117.68,-1672.74"/>
</g>
<!-- GPT3_2B_S2_R2_L9_split -->
<g id="node1015" class="node">
<title>GPT3_2B_S2_R2_L9_split</title>
<polygon fill="orange" stroke="black" points="24187.7,-3091.04 23521.64,-3091.04 23350.3,-3015.04 24016.36,-3015.04 24187.7,-3091.04"/>
<text text-anchor="middle" x="23769" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="23769" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_norm1 -->
<g id="node1016" class="node">
<title>GPT3_2B_S2_R2_L9_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23769" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L9_split&#45;&gt;GPT3_2B_S2_R2_L9_norm1 -->
<g id="edge937" class="edge">
<title>GPT3_2B_S2_R2_L9_split&#45;&gt;GPT3_2B_S2_R2_L9_norm1</title>
<path fill="none" stroke="black" d="M23769,-3014.83C23769,-2995.62 23769,-2972.29 23769,-2953.24"/>
<polygon fill="black" stroke="black" points="23772.5,-2953.16 23769,-2943.16 23765.5,-2953.16 23772.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L9_qkv -->
<g id="node1017" class="node">
<title>GPT3_2B_S2_R2_L9_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23911,-2817.3 23627,-2817.3 23627,-2779.3 23911,-2779.3 23911,-2817.3"/>
<text text-anchor="middle" x="23769" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="23769" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_norm1&#45;&gt;GPT3_2B_S2_R2_L9_qkv -->
<g id="edge938" class="edge">
<title>GPT3_2B_S2_R2_L9_norm1&#45;&gt;GPT3_2B_S2_R2_L9_qkv</title>
<path fill="none" stroke="black" d="M23769,-2889.17C23769,-2870.9 23769,-2846.47 23769,-2827.7"/>
<polygon fill="black" stroke="black" points="23772.5,-2827.65 23769,-2817.65 23765.5,-2827.65 23772.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L9_attn -->
<g id="node1018" class="node">
<title>GPT3_2B_S2_R2_L9_attn</title>
<polygon fill="lightcoral" stroke="black" points="23911,-2707.3 23627,-2707.3 23627,-2669.3 23911,-2669.3 23911,-2707.3"/>
<text text-anchor="middle" x="23769" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="23769" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_qkv&#45;&gt;GPT3_2B_S2_R2_L9_attn -->
<g id="edge939" class="edge">
<title>GPT3_2B_S2_R2_L9_qkv&#45;&gt;GPT3_2B_S2_R2_L9_attn</title>
<path fill="none" stroke="black" d="M23769,-2778.98C23769,-2762.12 23769,-2736.87 23769,-2717.45"/>
<polygon fill="black" stroke="black" points="23772.5,-2717.35 23769,-2707.35 23765.5,-2717.35 23772.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L9_ar1 -->
<g id="node1019" class="node">
<title>GPT3_2B_S2_R2_L9_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23769" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_attn&#45;&gt;GPT3_2B_S2_R2_L9_ar1 -->
<g id="edge940" class="edge">
<title>GPT3_2B_S2_R2_L9_attn&#45;&gt;GPT3_2B_S2_R2_L9_ar1</title>
<path fill="none" stroke="black" d="M23769,-2669.2C23769,-2652.83 23769,-2628.24 23769,-2607.81"/>
<polygon fill="black" stroke="black" points="23772.5,-2607.58 23769,-2597.58 23765.5,-2607.58 23772.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L9_res1 -->
<g id="node1020" class="node">
<title>GPT3_2B_S2_R2_L9_res1</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-2471.56 23717.11,-2471.56 23681.16,-2435.56 23820.89,-2435.56 23856.84,-2471.56"/>
<text text-anchor="middle" x="23769" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L9_ar1&#45;&gt;GPT3_2B_S2_R2_L9_res1 -->
<g id="edge941" class="edge">
<title>GPT3_2B_S2_R2_L9_ar1&#45;&gt;GPT3_2B_S2_R2_L9_res1</title>
<path fill="none" stroke="black" d="M23769,-2543.37C23769,-2525 23769,-2500.45 23769,-2481.82"/>
<polygon fill="black" stroke="black" points="23772.5,-2481.62 23769,-2471.62 23765.5,-2481.62 23772.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L9_norm2 -->
<g id="node1021" class="node">
<title>GPT3_2B_S2_R2_L9_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="23769" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L9_res1&#45;&gt;GPT3_2B_S2_R2_L9_norm2 -->
<g id="edge942" class="edge">
<title>GPT3_2B_S2_R2_L9_res1&#45;&gt;GPT3_2B_S2_R2_L9_norm2</title>
<path fill="none" stroke="black" d="M23769,-2435.12C23769,-2418.97 23769,-2394.47 23769,-2374.07"/>
<polygon fill="black" stroke="black" points="23772.5,-2373.85 23769,-2363.85 23765.5,-2373.85 23772.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_up -->
<g id="node1022" class="node">
<title>GPT3_2B_S2_R2_L9_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-2237.82 23662.5,-2237.82 23662.5,-2199.82 23875.5,-2199.82 23875.5,-2237.82"/>
<text text-anchor="middle" x="23769" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="23769" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_norm2&#45;&gt;GPT3_2B_S2_R2_L9_ffn_up -->
<g id="edge943" class="edge">
<title>GPT3_2B_S2_R2_L9_norm2&#45;&gt;GPT3_2B_S2_R2_L9_ffn_up</title>
<path fill="none" stroke="black" d="M23769,-2309.69C23769,-2291.42 23769,-2266.99 23769,-2248.22"/>
<polygon fill="black" stroke="black" points="23772.5,-2248.17 23769,-2238.17 23765.5,-2248.17 23772.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_gate -->
<g id="node1023" class="node">
<title>GPT3_2B_S2_R2_L9_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-2127.82 23662.5,-2127.82 23662.5,-2089.82 23875.5,-2089.82 23875.5,-2127.82"/>
<text text-anchor="middle" x="23769" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="23769" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_up&#45;&gt;GPT3_2B_S2_R2_L9_ffn_gate -->
<g id="edge944" class="edge">
<title>GPT3_2B_S2_R2_L9_ffn_up&#45;&gt;GPT3_2B_S2_R2_L9_ffn_gate</title>
<path fill="none" stroke="black" d="M23769,-2199.5C23769,-2182.64 23769,-2157.39 23769,-2137.97"/>
<polygon fill="black" stroke="black" points="23772.5,-2137.87 23769,-2127.87 23765.5,-2137.87 23772.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_down -->
<g id="node1024" class="node">
<title>GPT3_2B_S2_R2_L9_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-2017.82 23662.5,-2017.82 23662.5,-1979.82 23875.5,-1979.82 23875.5,-2017.82"/>
<text text-anchor="middle" x="23769" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="23769" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L9_ffn_down -->
<g id="edge945" class="edge">
<title>GPT3_2B_S2_R2_L9_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L9_ffn_down</title>
<path fill="none" stroke="black" d="M23769,-2089.5C23769,-2072.64 23769,-2047.39 23769,-2027.97"/>
<polygon fill="black" stroke="black" points="23772.5,-2027.87 23769,-2017.87 23765.5,-2027.87 23772.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L9_ar2 -->
<g id="node1025" class="node">
<title>GPT3_2B_S2_R2_L9_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="23769" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L9_ffn_down&#45;&gt;GPT3_2B_S2_R2_L9_ar2 -->
<g id="edge946" class="edge">
<title>GPT3_2B_S2_R2_L9_ffn_down&#45;&gt;GPT3_2B_S2_R2_L9_ar2</title>
<path fill="none" stroke="black" d="M23769,-1979.72C23769,-1963.35 23769,-1938.76 23769,-1918.33"/>
<polygon fill="black" stroke="black" points="23772.5,-1918.1 23769,-1908.1 23765.5,-1918.1 23772.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L9_res2 -->
<g id="node1026" class="node">
<title>GPT3_2B_S2_R2_L9_res2</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-1782.08 23717.11,-1782.08 23681.16,-1746.08 23820.89,-1746.08 23856.84,-1782.08"/>
<text text-anchor="middle" x="23769" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L9_ar2&#45;&gt;GPT3_2B_S2_R2_L9_res2 -->
<g id="edge947" class="edge">
<title>GPT3_2B_S2_R2_L9_ar2&#45;&gt;GPT3_2B_S2_R2_L9_res2</title>
<path fill="none" stroke="black" d="M23769,-1853.89C23769,-1835.51 23769,-1810.97 23769,-1792.34"/>
<polygon fill="black" stroke="black" points="23772.5,-1792.14 23769,-1782.14 23765.5,-1792.14 23772.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L10_split -->
<g id="node1027" class="node">
<title>GPT3_2B_S2_R2_L10_split</title>
<polygon fill="orange" stroke="black" points="23327.7,-3091.04 22661.64,-3091.04 22490.3,-3015.04 23156.36,-3015.04 23327.7,-3091.04"/>
<text text-anchor="middle" x="22909" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22909" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_norm1 -->
<g id="node1028" class="node">
<title>GPT3_2B_S2_R2_L10_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22909" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L10_split&#45;&gt;GPT3_2B_S2_R2_L10_norm1 -->
<g id="edge948" class="edge">
<title>GPT3_2B_S2_R2_L10_split&#45;&gt;GPT3_2B_S2_R2_L10_norm1</title>
<path fill="none" stroke="black" d="M22909,-3014.83C22909,-2995.62 22909,-2972.29 22909,-2953.24"/>
<polygon fill="black" stroke="black" points="22912.5,-2953.16 22909,-2943.16 22905.5,-2953.16 22912.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L10_qkv -->
<g id="node1029" class="node">
<title>GPT3_2B_S2_R2_L10_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23051,-2817.3 22767,-2817.3 22767,-2779.3 23051,-2779.3 23051,-2817.3"/>
<text text-anchor="middle" x="22909" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22909" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_norm1&#45;&gt;GPT3_2B_S2_R2_L10_qkv -->
<g id="edge949" class="edge">
<title>GPT3_2B_S2_R2_L10_norm1&#45;&gt;GPT3_2B_S2_R2_L10_qkv</title>
<path fill="none" stroke="black" d="M22909,-2889.17C22909,-2870.9 22909,-2846.47 22909,-2827.7"/>
<polygon fill="black" stroke="black" points="22912.5,-2827.65 22909,-2817.65 22905.5,-2827.65 22912.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L10_attn -->
<g id="node1030" class="node">
<title>GPT3_2B_S2_R2_L10_attn</title>
<polygon fill="lightcoral" stroke="black" points="23051,-2707.3 22767,-2707.3 22767,-2669.3 23051,-2669.3 23051,-2707.3"/>
<text text-anchor="middle" x="22909" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22909" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_qkv&#45;&gt;GPT3_2B_S2_R2_L10_attn -->
<g id="edge950" class="edge">
<title>GPT3_2B_S2_R2_L10_qkv&#45;&gt;GPT3_2B_S2_R2_L10_attn</title>
<path fill="none" stroke="black" d="M22909,-2778.98C22909,-2762.12 22909,-2736.87 22909,-2717.45"/>
<polygon fill="black" stroke="black" points="22912.5,-2717.35 22909,-2707.35 22905.5,-2717.35 22912.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L10_ar1 -->
<g id="node1031" class="node">
<title>GPT3_2B_S2_R2_L10_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22909" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_attn&#45;&gt;GPT3_2B_S2_R2_L10_ar1 -->
<g id="edge951" class="edge">
<title>GPT3_2B_S2_R2_L10_attn&#45;&gt;GPT3_2B_S2_R2_L10_ar1</title>
<path fill="none" stroke="black" d="M22909,-2669.2C22909,-2652.83 22909,-2628.24 22909,-2607.81"/>
<polygon fill="black" stroke="black" points="22912.5,-2607.58 22909,-2597.58 22905.5,-2607.58 22912.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L10_res1 -->
<g id="node1032" class="node">
<title>GPT3_2B_S2_R2_L10_res1</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-2471.56 22857.11,-2471.56 22821.16,-2435.56 22960.89,-2435.56 22996.84,-2471.56"/>
<text text-anchor="middle" x="22909" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L10_ar1&#45;&gt;GPT3_2B_S2_R2_L10_res1 -->
<g id="edge952" class="edge">
<title>GPT3_2B_S2_R2_L10_ar1&#45;&gt;GPT3_2B_S2_R2_L10_res1</title>
<path fill="none" stroke="black" d="M22909,-2543.37C22909,-2525 22909,-2500.45 22909,-2481.82"/>
<polygon fill="black" stroke="black" points="22912.5,-2481.62 22909,-2471.62 22905.5,-2481.62 22912.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L10_norm2 -->
<g id="node1033" class="node">
<title>GPT3_2B_S2_R2_L10_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22909" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L10_res1&#45;&gt;GPT3_2B_S2_R2_L10_norm2 -->
<g id="edge953" class="edge">
<title>GPT3_2B_S2_R2_L10_res1&#45;&gt;GPT3_2B_S2_R2_L10_norm2</title>
<path fill="none" stroke="black" d="M22909,-2435.12C22909,-2418.97 22909,-2394.47 22909,-2374.07"/>
<polygon fill="black" stroke="black" points="22912.5,-2373.85 22909,-2363.85 22905.5,-2373.85 22912.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_up -->
<g id="node1034" class="node">
<title>GPT3_2B_S2_R2_L10_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-2237.82 22802.5,-2237.82 22802.5,-2199.82 23015.5,-2199.82 23015.5,-2237.82"/>
<text text-anchor="middle" x="22909" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22909" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_norm2&#45;&gt;GPT3_2B_S2_R2_L10_ffn_up -->
<g id="edge954" class="edge">
<title>GPT3_2B_S2_R2_L10_norm2&#45;&gt;GPT3_2B_S2_R2_L10_ffn_up</title>
<path fill="none" stroke="black" d="M22909,-2309.69C22909,-2291.42 22909,-2266.99 22909,-2248.22"/>
<polygon fill="black" stroke="black" points="22912.5,-2248.17 22909,-2238.17 22905.5,-2248.17 22912.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_gate -->
<g id="node1035" class="node">
<title>GPT3_2B_S2_R2_L10_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-2127.82 22802.5,-2127.82 22802.5,-2089.82 23015.5,-2089.82 23015.5,-2127.82"/>
<text text-anchor="middle" x="22909" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22909" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_up&#45;&gt;GPT3_2B_S2_R2_L10_ffn_gate -->
<g id="edge955" class="edge">
<title>GPT3_2B_S2_R2_L10_ffn_up&#45;&gt;GPT3_2B_S2_R2_L10_ffn_gate</title>
<path fill="none" stroke="black" d="M22909,-2199.5C22909,-2182.64 22909,-2157.39 22909,-2137.97"/>
<polygon fill="black" stroke="black" points="22912.5,-2137.87 22909,-2127.87 22905.5,-2137.87 22912.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_down -->
<g id="node1036" class="node">
<title>GPT3_2B_S2_R2_L10_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-2017.82 22802.5,-2017.82 22802.5,-1979.82 23015.5,-1979.82 23015.5,-2017.82"/>
<text text-anchor="middle" x="22909" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22909" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L10_ffn_down -->
<g id="edge956" class="edge">
<title>GPT3_2B_S2_R2_L10_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L10_ffn_down</title>
<path fill="none" stroke="black" d="M22909,-2089.5C22909,-2072.64 22909,-2047.39 22909,-2027.97"/>
<polygon fill="black" stroke="black" points="22912.5,-2027.87 22909,-2017.87 22905.5,-2027.87 22912.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L10_ar2 -->
<g id="node1037" class="node">
<title>GPT3_2B_S2_R2_L10_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22909" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L10_ffn_down&#45;&gt;GPT3_2B_S2_R2_L10_ar2 -->
<g id="edge957" class="edge">
<title>GPT3_2B_S2_R2_L10_ffn_down&#45;&gt;GPT3_2B_S2_R2_L10_ar2</title>
<path fill="none" stroke="black" d="M22909,-1979.72C22909,-1963.35 22909,-1938.76 22909,-1918.33"/>
<polygon fill="black" stroke="black" points="22912.5,-1918.1 22909,-1908.1 22905.5,-1918.1 22912.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L10_res2 -->
<g id="node1038" class="node">
<title>GPT3_2B_S2_R2_L10_res2</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-1782.08 22857.11,-1782.08 22821.16,-1746.08 22960.89,-1746.08 22996.84,-1782.08"/>
<text text-anchor="middle" x="22909" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L10_ar2&#45;&gt;GPT3_2B_S2_R2_L10_res2 -->
<g id="edge958" class="edge">
<title>GPT3_2B_S2_R2_L10_ar2&#45;&gt;GPT3_2B_S2_R2_L10_res2</title>
<path fill="none" stroke="black" d="M22909,-1853.89C22909,-1835.51 22909,-1810.97 22909,-1792.34"/>
<polygon fill="black" stroke="black" points="22912.5,-1792.14 22909,-1782.14 22905.5,-1792.14 22912.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L11_split -->
<g id="node1039" class="node">
<title>GPT3_2B_S2_R2_L11_split</title>
<polygon fill="orange" stroke="black" points="22467.7,-3091.04 21801.64,-3091.04 21630.3,-3015.04 22296.36,-3015.04 22467.7,-3091.04"/>
<text text-anchor="middle" x="22049" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22049" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_norm1 -->
<g id="node1040" class="node">
<title>GPT3_2B_S2_R2_L11_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22049" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L11_split&#45;&gt;GPT3_2B_S2_R2_L11_norm1 -->
<g id="edge959" class="edge">
<title>GPT3_2B_S2_R2_L11_split&#45;&gt;GPT3_2B_S2_R2_L11_norm1</title>
<path fill="none" stroke="black" d="M22049,-3014.83C22049,-2995.62 22049,-2972.29 22049,-2953.24"/>
<polygon fill="black" stroke="black" points="22052.5,-2953.16 22049,-2943.16 22045.5,-2953.16 22052.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L11_qkv -->
<g id="node1041" class="node">
<title>GPT3_2B_S2_R2_L11_qkv</title>
<polygon fill="lightcoral" stroke="black" points="22191,-2817.3 21907,-2817.3 21907,-2779.3 22191,-2779.3 22191,-2817.3"/>
<text text-anchor="middle" x="22049" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22049" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_norm1&#45;&gt;GPT3_2B_S2_R2_L11_qkv -->
<g id="edge960" class="edge">
<title>GPT3_2B_S2_R2_L11_norm1&#45;&gt;GPT3_2B_S2_R2_L11_qkv</title>
<path fill="none" stroke="black" d="M22049,-2889.17C22049,-2870.9 22049,-2846.47 22049,-2827.7"/>
<polygon fill="black" stroke="black" points="22052.5,-2827.65 22049,-2817.65 22045.5,-2827.65 22052.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L11_attn -->
<g id="node1042" class="node">
<title>GPT3_2B_S2_R2_L11_attn</title>
<polygon fill="lightcoral" stroke="black" points="22191,-2707.3 21907,-2707.3 21907,-2669.3 22191,-2669.3 22191,-2707.3"/>
<text text-anchor="middle" x="22049" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22049" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_qkv&#45;&gt;GPT3_2B_S2_R2_L11_attn -->
<g id="edge961" class="edge">
<title>GPT3_2B_S2_R2_L11_qkv&#45;&gt;GPT3_2B_S2_R2_L11_attn</title>
<path fill="none" stroke="black" d="M22049,-2778.98C22049,-2762.12 22049,-2736.87 22049,-2717.45"/>
<polygon fill="black" stroke="black" points="22052.5,-2717.35 22049,-2707.35 22045.5,-2717.35 22052.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L11_ar1 -->
<g id="node1043" class="node">
<title>GPT3_2B_S2_R2_L11_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22049" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_attn&#45;&gt;GPT3_2B_S2_R2_L11_ar1 -->
<g id="edge962" class="edge">
<title>GPT3_2B_S2_R2_L11_attn&#45;&gt;GPT3_2B_S2_R2_L11_ar1</title>
<path fill="none" stroke="black" d="M22049,-2669.2C22049,-2652.83 22049,-2628.24 22049,-2607.81"/>
<polygon fill="black" stroke="black" points="22052.5,-2607.58 22049,-2597.58 22045.5,-2607.58 22052.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L11_res1 -->
<g id="node1044" class="node">
<title>GPT3_2B_S2_R2_L11_res1</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-2471.56 21997.11,-2471.56 21961.16,-2435.56 22100.89,-2435.56 22136.84,-2471.56"/>
<text text-anchor="middle" x="22049" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L11_ar1&#45;&gt;GPT3_2B_S2_R2_L11_res1 -->
<g id="edge963" class="edge">
<title>GPT3_2B_S2_R2_L11_ar1&#45;&gt;GPT3_2B_S2_R2_L11_res1</title>
<path fill="none" stroke="black" d="M22049,-2543.37C22049,-2525 22049,-2500.45 22049,-2481.82"/>
<polygon fill="black" stroke="black" points="22052.5,-2481.62 22049,-2471.62 22045.5,-2481.62 22052.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L11_norm2 -->
<g id="node1045" class="node">
<title>GPT3_2B_S2_R2_L11_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22049" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L11_res1&#45;&gt;GPT3_2B_S2_R2_L11_norm2 -->
<g id="edge964" class="edge">
<title>GPT3_2B_S2_R2_L11_res1&#45;&gt;GPT3_2B_S2_R2_L11_norm2</title>
<path fill="none" stroke="black" d="M22049,-2435.12C22049,-2418.97 22049,-2394.47 22049,-2374.07"/>
<polygon fill="black" stroke="black" points="22052.5,-2373.85 22049,-2363.85 22045.5,-2373.85 22052.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_up -->
<g id="node1046" class="node">
<title>GPT3_2B_S2_R2_L11_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-2237.82 21942.5,-2237.82 21942.5,-2199.82 22155.5,-2199.82 22155.5,-2237.82"/>
<text text-anchor="middle" x="22049" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22049" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_norm2&#45;&gt;GPT3_2B_S2_R2_L11_ffn_up -->
<g id="edge965" class="edge">
<title>GPT3_2B_S2_R2_L11_norm2&#45;&gt;GPT3_2B_S2_R2_L11_ffn_up</title>
<path fill="none" stroke="black" d="M22049,-2309.69C22049,-2291.42 22049,-2266.99 22049,-2248.22"/>
<polygon fill="black" stroke="black" points="22052.5,-2248.17 22049,-2238.17 22045.5,-2248.17 22052.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_gate -->
<g id="node1047" class="node">
<title>GPT3_2B_S2_R2_L11_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-2127.82 21942.5,-2127.82 21942.5,-2089.82 22155.5,-2089.82 22155.5,-2127.82"/>
<text text-anchor="middle" x="22049" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22049" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_up&#45;&gt;GPT3_2B_S2_R2_L11_ffn_gate -->
<g id="edge966" class="edge">
<title>GPT3_2B_S2_R2_L11_ffn_up&#45;&gt;GPT3_2B_S2_R2_L11_ffn_gate</title>
<path fill="none" stroke="black" d="M22049,-2199.5C22049,-2182.64 22049,-2157.39 22049,-2137.97"/>
<polygon fill="black" stroke="black" points="22052.5,-2137.87 22049,-2127.87 22045.5,-2137.87 22052.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_down -->
<g id="node1048" class="node">
<title>GPT3_2B_S2_R2_L11_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-2017.82 21942.5,-2017.82 21942.5,-1979.82 22155.5,-1979.82 22155.5,-2017.82"/>
<text text-anchor="middle" x="22049" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22049" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L11_ffn_down -->
<g id="edge967" class="edge">
<title>GPT3_2B_S2_R2_L11_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L11_ffn_down</title>
<path fill="none" stroke="black" d="M22049,-2089.5C22049,-2072.64 22049,-2047.39 22049,-2027.97"/>
<polygon fill="black" stroke="black" points="22052.5,-2027.87 22049,-2017.87 22045.5,-2027.87 22052.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L11_ar2 -->
<g id="node1049" class="node">
<title>GPT3_2B_S2_R2_L11_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22049" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L11_ffn_down&#45;&gt;GPT3_2B_S2_R2_L11_ar2 -->
<g id="edge968" class="edge">
<title>GPT3_2B_S2_R2_L11_ffn_down&#45;&gt;GPT3_2B_S2_R2_L11_ar2</title>
<path fill="none" stroke="black" d="M22049,-1979.72C22049,-1963.35 22049,-1938.76 22049,-1918.33"/>
<polygon fill="black" stroke="black" points="22052.5,-1918.1 22049,-1908.1 22045.5,-1918.1 22052.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L11_res2 -->
<g id="node1050" class="node">
<title>GPT3_2B_S2_R2_L11_res2</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-1782.08 21997.11,-1782.08 21961.16,-1746.08 22100.89,-1746.08 22136.84,-1782.08"/>
<text text-anchor="middle" x="22049" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L11_ar2&#45;&gt;GPT3_2B_S2_R2_L11_res2 -->
<g id="edge969" class="edge">
<title>GPT3_2B_S2_R2_L11_ar2&#45;&gt;GPT3_2B_S2_R2_L11_res2</title>
<path fill="none" stroke="black" d="M22049,-1853.89C22049,-1835.51 22049,-1810.97 22049,-1792.34"/>
<polygon fill="black" stroke="black" points="22052.5,-1792.14 22049,-1782.14 22045.5,-1792.14 22052.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L12_split -->
<g id="node1051" class="node">
<title>GPT3_2B_S2_R2_L12_split</title>
<polygon fill="orange" stroke="black" points="21607.7,-3091.04 20941.64,-3091.04 20770.3,-3015.04 21436.36,-3015.04 21607.7,-3091.04"/>
<text text-anchor="middle" x="21189" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="21189" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_norm1 -->
<g id="node1052" class="node">
<title>GPT3_2B_S2_R2_L12_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21189" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L12_split&#45;&gt;GPT3_2B_S2_R2_L12_norm1 -->
<g id="edge970" class="edge">
<title>GPT3_2B_S2_R2_L12_split&#45;&gt;GPT3_2B_S2_R2_L12_norm1</title>
<path fill="none" stroke="black" d="M21189,-3014.83C21189,-2995.62 21189,-2972.29 21189,-2953.24"/>
<polygon fill="black" stroke="black" points="21192.5,-2953.16 21189,-2943.16 21185.5,-2953.16 21192.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L12_qkv -->
<g id="node1053" class="node">
<title>GPT3_2B_S2_R2_L12_qkv</title>
<polygon fill="lightcoral" stroke="black" points="21331,-2817.3 21047,-2817.3 21047,-2779.3 21331,-2779.3 21331,-2817.3"/>
<text text-anchor="middle" x="21189" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="21189" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_norm1&#45;&gt;GPT3_2B_S2_R2_L12_qkv -->
<g id="edge971" class="edge">
<title>GPT3_2B_S2_R2_L12_norm1&#45;&gt;GPT3_2B_S2_R2_L12_qkv</title>
<path fill="none" stroke="black" d="M21189,-2889.17C21189,-2870.9 21189,-2846.47 21189,-2827.7"/>
<polygon fill="black" stroke="black" points="21192.5,-2827.65 21189,-2817.65 21185.5,-2827.65 21192.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L12_attn -->
<g id="node1054" class="node">
<title>GPT3_2B_S2_R2_L12_attn</title>
<polygon fill="lightcoral" stroke="black" points="21331,-2707.3 21047,-2707.3 21047,-2669.3 21331,-2669.3 21331,-2707.3"/>
<text text-anchor="middle" x="21189" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="21189" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_qkv&#45;&gt;GPT3_2B_S2_R2_L12_attn -->
<g id="edge972" class="edge">
<title>GPT3_2B_S2_R2_L12_qkv&#45;&gt;GPT3_2B_S2_R2_L12_attn</title>
<path fill="none" stroke="black" d="M21189,-2778.98C21189,-2762.12 21189,-2736.87 21189,-2717.45"/>
<polygon fill="black" stroke="black" points="21192.5,-2717.35 21189,-2707.35 21185.5,-2717.35 21192.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L12_ar1 -->
<g id="node1055" class="node">
<title>GPT3_2B_S2_R2_L12_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="21189" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_attn&#45;&gt;GPT3_2B_S2_R2_L12_ar1 -->
<g id="edge973" class="edge">
<title>GPT3_2B_S2_R2_L12_attn&#45;&gt;GPT3_2B_S2_R2_L12_ar1</title>
<path fill="none" stroke="black" d="M21189,-2669.2C21189,-2652.83 21189,-2628.24 21189,-2607.81"/>
<polygon fill="black" stroke="black" points="21192.5,-2607.58 21189,-2597.58 21185.5,-2607.58 21192.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L12_res1 -->
<g id="node1056" class="node">
<title>GPT3_2B_S2_R2_L12_res1</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-2471.56 21137.11,-2471.56 21101.16,-2435.56 21240.89,-2435.56 21276.84,-2471.56"/>
<text text-anchor="middle" x="21189" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L12_ar1&#45;&gt;GPT3_2B_S2_R2_L12_res1 -->
<g id="edge974" class="edge">
<title>GPT3_2B_S2_R2_L12_ar1&#45;&gt;GPT3_2B_S2_R2_L12_res1</title>
<path fill="none" stroke="black" d="M21189,-2543.37C21189,-2525 21189,-2500.45 21189,-2481.82"/>
<polygon fill="black" stroke="black" points="21192.5,-2481.62 21189,-2471.62 21185.5,-2481.62 21192.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L12_norm2 -->
<g id="node1057" class="node">
<title>GPT3_2B_S2_R2_L12_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="21189" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L12_res1&#45;&gt;GPT3_2B_S2_R2_L12_norm2 -->
<g id="edge975" class="edge">
<title>GPT3_2B_S2_R2_L12_res1&#45;&gt;GPT3_2B_S2_R2_L12_norm2</title>
<path fill="none" stroke="black" d="M21189,-2435.12C21189,-2418.97 21189,-2394.47 21189,-2374.07"/>
<polygon fill="black" stroke="black" points="21192.5,-2373.85 21189,-2363.85 21185.5,-2373.85 21192.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_up -->
<g id="node1058" class="node">
<title>GPT3_2B_S2_R2_L12_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-2237.82 21082.5,-2237.82 21082.5,-2199.82 21295.5,-2199.82 21295.5,-2237.82"/>
<text text-anchor="middle" x="21189" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="21189" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_norm2&#45;&gt;GPT3_2B_S2_R2_L12_ffn_up -->
<g id="edge976" class="edge">
<title>GPT3_2B_S2_R2_L12_norm2&#45;&gt;GPT3_2B_S2_R2_L12_ffn_up</title>
<path fill="none" stroke="black" d="M21189,-2309.69C21189,-2291.42 21189,-2266.99 21189,-2248.22"/>
<polygon fill="black" stroke="black" points="21192.5,-2248.17 21189,-2238.17 21185.5,-2248.17 21192.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_gate -->
<g id="node1059" class="node">
<title>GPT3_2B_S2_R2_L12_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-2127.82 21082.5,-2127.82 21082.5,-2089.82 21295.5,-2089.82 21295.5,-2127.82"/>
<text text-anchor="middle" x="21189" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="21189" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_up&#45;&gt;GPT3_2B_S2_R2_L12_ffn_gate -->
<g id="edge977" class="edge">
<title>GPT3_2B_S2_R2_L12_ffn_up&#45;&gt;GPT3_2B_S2_R2_L12_ffn_gate</title>
<path fill="none" stroke="black" d="M21189,-2199.5C21189,-2182.64 21189,-2157.39 21189,-2137.97"/>
<polygon fill="black" stroke="black" points="21192.5,-2137.87 21189,-2127.87 21185.5,-2137.87 21192.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_down -->
<g id="node1060" class="node">
<title>GPT3_2B_S2_R2_L12_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-2017.82 21082.5,-2017.82 21082.5,-1979.82 21295.5,-1979.82 21295.5,-2017.82"/>
<text text-anchor="middle" x="21189" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="21189" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L12_ffn_down -->
<g id="edge978" class="edge">
<title>GPT3_2B_S2_R2_L12_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L12_ffn_down</title>
<path fill="none" stroke="black" d="M21189,-2089.5C21189,-2072.64 21189,-2047.39 21189,-2027.97"/>
<polygon fill="black" stroke="black" points="21192.5,-2027.87 21189,-2017.87 21185.5,-2027.87 21192.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L12_ar2 -->
<g id="node1061" class="node">
<title>GPT3_2B_S2_R2_L12_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="21189" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L12_ffn_down&#45;&gt;GPT3_2B_S2_R2_L12_ar2 -->
<g id="edge979" class="edge">
<title>GPT3_2B_S2_R2_L12_ffn_down&#45;&gt;GPT3_2B_S2_R2_L12_ar2</title>
<path fill="none" stroke="black" d="M21189,-1979.72C21189,-1963.35 21189,-1938.76 21189,-1918.33"/>
<polygon fill="black" stroke="black" points="21192.5,-1918.1 21189,-1908.1 21185.5,-1918.1 21192.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L12_res2 -->
<g id="node1062" class="node">
<title>GPT3_2B_S2_R2_L12_res2</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-1782.08 21137.11,-1782.08 21101.16,-1746.08 21240.89,-1746.08 21276.84,-1782.08"/>
<text text-anchor="middle" x="21189" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L12_ar2&#45;&gt;GPT3_2B_S2_R2_L12_res2 -->
<g id="edge980" class="edge">
<title>GPT3_2B_S2_R2_L12_ar2&#45;&gt;GPT3_2B_S2_R2_L12_res2</title>
<path fill="none" stroke="black" d="M21189,-1853.89C21189,-1835.51 21189,-1810.97 21189,-1792.34"/>
<polygon fill="black" stroke="black" points="21192.5,-1792.14 21189,-1782.14 21185.5,-1792.14 21192.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L13_split -->
<g id="node1063" class="node">
<title>GPT3_2B_S2_R2_L13_split</title>
<polygon fill="orange" stroke="black" points="20747.7,-3091.04 20081.64,-3091.04 19910.3,-3015.04 20576.36,-3015.04 20747.7,-3091.04"/>
<text text-anchor="middle" x="20329" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="20329" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_norm1 -->
<g id="node1064" class="node">
<title>GPT3_2B_S2_R2_L13_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20329" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L13_split&#45;&gt;GPT3_2B_S2_R2_L13_norm1 -->
<g id="edge981" class="edge">
<title>GPT3_2B_S2_R2_L13_split&#45;&gt;GPT3_2B_S2_R2_L13_norm1</title>
<path fill="none" stroke="black" d="M20329,-3014.83C20329,-2995.62 20329,-2972.29 20329,-2953.24"/>
<polygon fill="black" stroke="black" points="20332.5,-2953.16 20329,-2943.16 20325.5,-2953.16 20332.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L13_qkv -->
<g id="node1065" class="node">
<title>GPT3_2B_S2_R2_L13_qkv</title>
<polygon fill="lightcoral" stroke="black" points="20471,-2817.3 20187,-2817.3 20187,-2779.3 20471,-2779.3 20471,-2817.3"/>
<text text-anchor="middle" x="20329" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="20329" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_norm1&#45;&gt;GPT3_2B_S2_R2_L13_qkv -->
<g id="edge982" class="edge">
<title>GPT3_2B_S2_R2_L13_norm1&#45;&gt;GPT3_2B_S2_R2_L13_qkv</title>
<path fill="none" stroke="black" d="M20329,-2889.17C20329,-2870.9 20329,-2846.47 20329,-2827.7"/>
<polygon fill="black" stroke="black" points="20332.5,-2827.65 20329,-2817.65 20325.5,-2827.65 20332.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L13_attn -->
<g id="node1066" class="node">
<title>GPT3_2B_S2_R2_L13_attn</title>
<polygon fill="lightcoral" stroke="black" points="20471,-2707.3 20187,-2707.3 20187,-2669.3 20471,-2669.3 20471,-2707.3"/>
<text text-anchor="middle" x="20329" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="20329" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_qkv&#45;&gt;GPT3_2B_S2_R2_L13_attn -->
<g id="edge983" class="edge">
<title>GPT3_2B_S2_R2_L13_qkv&#45;&gt;GPT3_2B_S2_R2_L13_attn</title>
<path fill="none" stroke="black" d="M20329,-2778.98C20329,-2762.12 20329,-2736.87 20329,-2717.45"/>
<polygon fill="black" stroke="black" points="20332.5,-2717.35 20329,-2707.35 20325.5,-2717.35 20332.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L13_ar1 -->
<g id="node1067" class="node">
<title>GPT3_2B_S2_R2_L13_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20329" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_attn&#45;&gt;GPT3_2B_S2_R2_L13_ar1 -->
<g id="edge984" class="edge">
<title>GPT3_2B_S2_R2_L13_attn&#45;&gt;GPT3_2B_S2_R2_L13_ar1</title>
<path fill="none" stroke="black" d="M20329,-2669.2C20329,-2652.83 20329,-2628.24 20329,-2607.81"/>
<polygon fill="black" stroke="black" points="20332.5,-2607.58 20329,-2597.58 20325.5,-2607.58 20332.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L13_res1 -->
<g id="node1068" class="node">
<title>GPT3_2B_S2_R2_L13_res1</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-2471.56 20277.11,-2471.56 20241.16,-2435.56 20380.89,-2435.56 20416.84,-2471.56"/>
<text text-anchor="middle" x="20329" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L13_ar1&#45;&gt;GPT3_2B_S2_R2_L13_res1 -->
<g id="edge985" class="edge">
<title>GPT3_2B_S2_R2_L13_ar1&#45;&gt;GPT3_2B_S2_R2_L13_res1</title>
<path fill="none" stroke="black" d="M20329,-2543.37C20329,-2525 20329,-2500.45 20329,-2481.82"/>
<polygon fill="black" stroke="black" points="20332.5,-2481.62 20329,-2471.62 20325.5,-2481.62 20332.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L13_norm2 -->
<g id="node1069" class="node">
<title>GPT3_2B_S2_R2_L13_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="20329" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L13_res1&#45;&gt;GPT3_2B_S2_R2_L13_norm2 -->
<g id="edge986" class="edge">
<title>GPT3_2B_S2_R2_L13_res1&#45;&gt;GPT3_2B_S2_R2_L13_norm2</title>
<path fill="none" stroke="black" d="M20329,-2435.12C20329,-2418.97 20329,-2394.47 20329,-2374.07"/>
<polygon fill="black" stroke="black" points="20332.5,-2373.85 20329,-2363.85 20325.5,-2373.85 20332.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_up -->
<g id="node1070" class="node">
<title>GPT3_2B_S2_R2_L13_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-2237.82 20222.5,-2237.82 20222.5,-2199.82 20435.5,-2199.82 20435.5,-2237.82"/>
<text text-anchor="middle" x="20329" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="20329" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_norm2&#45;&gt;GPT3_2B_S2_R2_L13_ffn_up -->
<g id="edge987" class="edge">
<title>GPT3_2B_S2_R2_L13_norm2&#45;&gt;GPT3_2B_S2_R2_L13_ffn_up</title>
<path fill="none" stroke="black" d="M20329,-2309.69C20329,-2291.42 20329,-2266.99 20329,-2248.22"/>
<polygon fill="black" stroke="black" points="20332.5,-2248.17 20329,-2238.17 20325.5,-2248.17 20332.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_gate -->
<g id="node1071" class="node">
<title>GPT3_2B_S2_R2_L13_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-2127.82 20222.5,-2127.82 20222.5,-2089.82 20435.5,-2089.82 20435.5,-2127.82"/>
<text text-anchor="middle" x="20329" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="20329" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_up&#45;&gt;GPT3_2B_S2_R2_L13_ffn_gate -->
<g id="edge988" class="edge">
<title>GPT3_2B_S2_R2_L13_ffn_up&#45;&gt;GPT3_2B_S2_R2_L13_ffn_gate</title>
<path fill="none" stroke="black" d="M20329,-2199.5C20329,-2182.64 20329,-2157.39 20329,-2137.97"/>
<polygon fill="black" stroke="black" points="20332.5,-2137.87 20329,-2127.87 20325.5,-2137.87 20332.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_down -->
<g id="node1072" class="node">
<title>GPT3_2B_S2_R2_L13_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-2017.82 20222.5,-2017.82 20222.5,-1979.82 20435.5,-1979.82 20435.5,-2017.82"/>
<text text-anchor="middle" x="20329" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="20329" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L13_ffn_down -->
<g id="edge989" class="edge">
<title>GPT3_2B_S2_R2_L13_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L13_ffn_down</title>
<path fill="none" stroke="black" d="M20329,-2089.5C20329,-2072.64 20329,-2047.39 20329,-2027.97"/>
<polygon fill="black" stroke="black" points="20332.5,-2027.87 20329,-2017.87 20325.5,-2027.87 20332.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L13_ar2 -->
<g id="node1073" class="node">
<title>GPT3_2B_S2_R2_L13_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="20329" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L13_ffn_down&#45;&gt;GPT3_2B_S2_R2_L13_ar2 -->
<g id="edge990" class="edge">
<title>GPT3_2B_S2_R2_L13_ffn_down&#45;&gt;GPT3_2B_S2_R2_L13_ar2</title>
<path fill="none" stroke="black" d="M20329,-1979.72C20329,-1963.35 20329,-1938.76 20329,-1918.33"/>
<polygon fill="black" stroke="black" points="20332.5,-1918.1 20329,-1908.1 20325.5,-1918.1 20332.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L13_res2 -->
<g id="node1074" class="node">
<title>GPT3_2B_S2_R2_L13_res2</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-1782.08 20277.11,-1782.08 20241.16,-1746.08 20380.89,-1746.08 20416.84,-1782.08"/>
<text text-anchor="middle" x="20329" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L13_ar2&#45;&gt;GPT3_2B_S2_R2_L13_res2 -->
<g id="edge991" class="edge">
<title>GPT3_2B_S2_R2_L13_ar2&#45;&gt;GPT3_2B_S2_R2_L13_res2</title>
<path fill="none" stroke="black" d="M20329,-1853.89C20329,-1835.51 20329,-1810.97 20329,-1792.34"/>
<polygon fill="black" stroke="black" points="20332.5,-1792.14 20329,-1782.14 20325.5,-1792.14 20332.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L14_split -->
<g id="node1075" class="node">
<title>GPT3_2B_S2_R2_L14_split</title>
<polygon fill="orange" stroke="black" points="19887.7,-3091.04 19221.64,-3091.04 19050.3,-3015.04 19716.36,-3015.04 19887.7,-3091.04"/>
<text text-anchor="middle" x="19469" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="19469" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_norm1 -->
<g id="node1076" class="node">
<title>GPT3_2B_S2_R2_L14_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19469" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L14_split&#45;&gt;GPT3_2B_S2_R2_L14_norm1 -->
<g id="edge992" class="edge">
<title>GPT3_2B_S2_R2_L14_split&#45;&gt;GPT3_2B_S2_R2_L14_norm1</title>
<path fill="none" stroke="black" d="M19469,-3014.83C19469,-2995.62 19469,-2972.29 19469,-2953.24"/>
<polygon fill="black" stroke="black" points="19472.5,-2953.16 19469,-2943.16 19465.5,-2953.16 19472.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L14_qkv -->
<g id="node1077" class="node">
<title>GPT3_2B_S2_R2_L14_qkv</title>
<polygon fill="lightcoral" stroke="black" points="19611,-2817.3 19327,-2817.3 19327,-2779.3 19611,-2779.3 19611,-2817.3"/>
<text text-anchor="middle" x="19469" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="19469" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_norm1&#45;&gt;GPT3_2B_S2_R2_L14_qkv -->
<g id="edge993" class="edge">
<title>GPT3_2B_S2_R2_L14_norm1&#45;&gt;GPT3_2B_S2_R2_L14_qkv</title>
<path fill="none" stroke="black" d="M19469,-2889.17C19469,-2870.9 19469,-2846.47 19469,-2827.7"/>
<polygon fill="black" stroke="black" points="19472.5,-2827.65 19469,-2817.65 19465.5,-2827.65 19472.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L14_attn -->
<g id="node1078" class="node">
<title>GPT3_2B_S2_R2_L14_attn</title>
<polygon fill="lightcoral" stroke="black" points="19611,-2707.3 19327,-2707.3 19327,-2669.3 19611,-2669.3 19611,-2707.3"/>
<text text-anchor="middle" x="19469" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="19469" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_qkv&#45;&gt;GPT3_2B_S2_R2_L14_attn -->
<g id="edge994" class="edge">
<title>GPT3_2B_S2_R2_L14_qkv&#45;&gt;GPT3_2B_S2_R2_L14_attn</title>
<path fill="none" stroke="black" d="M19469,-2778.98C19469,-2762.12 19469,-2736.87 19469,-2717.45"/>
<polygon fill="black" stroke="black" points="19472.5,-2717.35 19469,-2707.35 19465.5,-2717.35 19472.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L14_ar1 -->
<g id="node1079" class="node">
<title>GPT3_2B_S2_R2_L14_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="19469" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_attn&#45;&gt;GPT3_2B_S2_R2_L14_ar1 -->
<g id="edge995" class="edge">
<title>GPT3_2B_S2_R2_L14_attn&#45;&gt;GPT3_2B_S2_R2_L14_ar1</title>
<path fill="none" stroke="black" d="M19469,-2669.2C19469,-2652.83 19469,-2628.24 19469,-2607.81"/>
<polygon fill="black" stroke="black" points="19472.5,-2607.58 19469,-2597.58 19465.5,-2607.58 19472.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L14_res1 -->
<g id="node1080" class="node">
<title>GPT3_2B_S2_R2_L14_res1</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-2471.56 19417.11,-2471.56 19381.16,-2435.56 19520.89,-2435.56 19556.84,-2471.56"/>
<text text-anchor="middle" x="19469" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L14_ar1&#45;&gt;GPT3_2B_S2_R2_L14_res1 -->
<g id="edge996" class="edge">
<title>GPT3_2B_S2_R2_L14_ar1&#45;&gt;GPT3_2B_S2_R2_L14_res1</title>
<path fill="none" stroke="black" d="M19469,-2543.37C19469,-2525 19469,-2500.45 19469,-2481.82"/>
<polygon fill="black" stroke="black" points="19472.5,-2481.62 19469,-2471.62 19465.5,-2481.62 19472.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L14_norm2 -->
<g id="node1081" class="node">
<title>GPT3_2B_S2_R2_L14_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="19469" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L14_res1&#45;&gt;GPT3_2B_S2_R2_L14_norm2 -->
<g id="edge997" class="edge">
<title>GPT3_2B_S2_R2_L14_res1&#45;&gt;GPT3_2B_S2_R2_L14_norm2</title>
<path fill="none" stroke="black" d="M19469,-2435.12C19469,-2418.97 19469,-2394.47 19469,-2374.07"/>
<polygon fill="black" stroke="black" points="19472.5,-2373.85 19469,-2363.85 19465.5,-2373.85 19472.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_up -->
<g id="node1082" class="node">
<title>GPT3_2B_S2_R2_L14_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-2237.82 19362.5,-2237.82 19362.5,-2199.82 19575.5,-2199.82 19575.5,-2237.82"/>
<text text-anchor="middle" x="19469" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="19469" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_norm2&#45;&gt;GPT3_2B_S2_R2_L14_ffn_up -->
<g id="edge998" class="edge">
<title>GPT3_2B_S2_R2_L14_norm2&#45;&gt;GPT3_2B_S2_R2_L14_ffn_up</title>
<path fill="none" stroke="black" d="M19469,-2309.69C19469,-2291.42 19469,-2266.99 19469,-2248.22"/>
<polygon fill="black" stroke="black" points="19472.5,-2248.17 19469,-2238.17 19465.5,-2248.17 19472.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_gate -->
<g id="node1083" class="node">
<title>GPT3_2B_S2_R2_L14_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-2127.82 19362.5,-2127.82 19362.5,-2089.82 19575.5,-2089.82 19575.5,-2127.82"/>
<text text-anchor="middle" x="19469" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="19469" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_up&#45;&gt;GPT3_2B_S2_R2_L14_ffn_gate -->
<g id="edge999" class="edge">
<title>GPT3_2B_S2_R2_L14_ffn_up&#45;&gt;GPT3_2B_S2_R2_L14_ffn_gate</title>
<path fill="none" stroke="black" d="M19469,-2199.5C19469,-2182.64 19469,-2157.39 19469,-2137.97"/>
<polygon fill="black" stroke="black" points="19472.5,-2137.87 19469,-2127.87 19465.5,-2137.87 19472.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_down -->
<g id="node1084" class="node">
<title>GPT3_2B_S2_R2_L14_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-2017.82 19362.5,-2017.82 19362.5,-1979.82 19575.5,-1979.82 19575.5,-2017.82"/>
<text text-anchor="middle" x="19469" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="19469" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L14_ffn_down -->
<g id="edge1000" class="edge">
<title>GPT3_2B_S2_R2_L14_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L14_ffn_down</title>
<path fill="none" stroke="black" d="M19469,-2089.5C19469,-2072.64 19469,-2047.39 19469,-2027.97"/>
<polygon fill="black" stroke="black" points="19472.5,-2027.87 19469,-2017.87 19465.5,-2027.87 19472.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L14_ar2 -->
<g id="node1085" class="node">
<title>GPT3_2B_S2_R2_L14_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="19469" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L14_ffn_down&#45;&gt;GPT3_2B_S2_R2_L14_ar2 -->
<g id="edge1001" class="edge">
<title>GPT3_2B_S2_R2_L14_ffn_down&#45;&gt;GPT3_2B_S2_R2_L14_ar2</title>
<path fill="none" stroke="black" d="M19469,-1979.72C19469,-1963.35 19469,-1938.76 19469,-1918.33"/>
<polygon fill="black" stroke="black" points="19472.5,-1918.1 19469,-1908.1 19465.5,-1918.1 19472.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L14_res2 -->
<g id="node1086" class="node">
<title>GPT3_2B_S2_R2_L14_res2</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-1782.08 19417.11,-1782.08 19381.16,-1746.08 19520.89,-1746.08 19556.84,-1782.08"/>
<text text-anchor="middle" x="19469" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L14_ar2&#45;&gt;GPT3_2B_S2_R2_L14_res2 -->
<g id="edge1002" class="edge">
<title>GPT3_2B_S2_R2_L14_ar2&#45;&gt;GPT3_2B_S2_R2_L14_res2</title>
<path fill="none" stroke="black" d="M19469,-1853.89C19469,-1835.51 19469,-1810.97 19469,-1792.34"/>
<polygon fill="black" stroke="black" points="19472.5,-1792.14 19469,-1782.14 19465.5,-1792.14 19472.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L15_split -->
<g id="node1087" class="node">
<title>GPT3_2B_S2_R2_L15_split</title>
<polygon fill="orange" stroke="black" points="19027.7,-3091.04 18361.64,-3091.04 18190.3,-3015.04 18856.36,-3015.04 19027.7,-3091.04"/>
<text text-anchor="middle" x="18609" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="18609" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_norm1 -->
<g id="node1088" class="node">
<title>GPT3_2B_S2_R2_L15_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18609" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L15_split&#45;&gt;GPT3_2B_S2_R2_L15_norm1 -->
<g id="edge1003" class="edge">
<title>GPT3_2B_S2_R2_L15_split&#45;&gt;GPT3_2B_S2_R2_L15_norm1</title>
<path fill="none" stroke="black" d="M18609,-3014.83C18609,-2995.62 18609,-2972.29 18609,-2953.24"/>
<polygon fill="black" stroke="black" points="18612.5,-2953.16 18609,-2943.16 18605.5,-2953.16 18612.5,-2953.16"/>
</g>
<!-- GPT3_2B_S2_R2_L15_qkv -->
<g id="node1089" class="node">
<title>GPT3_2B_S2_R2_L15_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18751,-2817.3 18467,-2817.3 18467,-2779.3 18751,-2779.3 18751,-2817.3"/>
<text text-anchor="middle" x="18609" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="18609" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_norm1&#45;&gt;GPT3_2B_S2_R2_L15_qkv -->
<g id="edge1004" class="edge">
<title>GPT3_2B_S2_R2_L15_norm1&#45;&gt;GPT3_2B_S2_R2_L15_qkv</title>
<path fill="none" stroke="black" d="M18609,-2889.17C18609,-2870.9 18609,-2846.47 18609,-2827.7"/>
<polygon fill="black" stroke="black" points="18612.5,-2827.65 18609,-2817.65 18605.5,-2827.65 18612.5,-2827.65"/>
</g>
<!-- GPT3_2B_S2_R2_L15_attn -->
<g id="node1090" class="node">
<title>GPT3_2B_S2_R2_L15_attn</title>
<polygon fill="lightcoral" stroke="black" points="18751,-2707.3 18467,-2707.3 18467,-2669.3 18751,-2669.3 18751,-2707.3"/>
<text text-anchor="middle" x="18609" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18609" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_qkv&#45;&gt;GPT3_2B_S2_R2_L15_attn -->
<g id="edge1005" class="edge">
<title>GPT3_2B_S2_R2_L15_qkv&#45;&gt;GPT3_2B_S2_R2_L15_attn</title>
<path fill="none" stroke="black" d="M18609,-2778.98C18609,-2762.12 18609,-2736.87 18609,-2717.45"/>
<polygon fill="black" stroke="black" points="18612.5,-2717.35 18609,-2707.35 18605.5,-2717.35 18612.5,-2717.35"/>
</g>
<!-- GPT3_2B_S2_R2_L15_ar1 -->
<g id="node1091" class="node">
<title>GPT3_2B_S2_R2_L15_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18609" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_attn&#45;&gt;GPT3_2B_S2_R2_L15_ar1 -->
<g id="edge1006" class="edge">
<title>GPT3_2B_S2_R2_L15_attn&#45;&gt;GPT3_2B_S2_R2_L15_ar1</title>
<path fill="none" stroke="black" d="M18609,-2669.2C18609,-2652.83 18609,-2628.24 18609,-2607.81"/>
<polygon fill="black" stroke="black" points="18612.5,-2607.58 18609,-2597.58 18605.5,-2607.58 18612.5,-2607.58"/>
</g>
<!-- GPT3_2B_S2_R2_L15_res1 -->
<g id="node1092" class="node">
<title>GPT3_2B_S2_R2_L15_res1</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-2471.56 18557.11,-2471.56 18521.16,-2435.56 18660.89,-2435.56 18696.84,-2471.56"/>
<text text-anchor="middle" x="18609" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L15_ar1&#45;&gt;GPT3_2B_S2_R2_L15_res1 -->
<g id="edge1007" class="edge">
<title>GPT3_2B_S2_R2_L15_ar1&#45;&gt;GPT3_2B_S2_R2_L15_res1</title>
<path fill="none" stroke="black" d="M18609,-2543.37C18609,-2525 18609,-2500.45 18609,-2481.82"/>
<polygon fill="black" stroke="black" points="18612.5,-2481.62 18609,-2471.62 18605.5,-2481.62 18612.5,-2481.62"/>
</g>
<!-- GPT3_2B_S2_R2_L15_norm2 -->
<g id="node1093" class="node">
<title>GPT3_2B_S2_R2_L15_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18609" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L15_res1&#45;&gt;GPT3_2B_S2_R2_L15_norm2 -->
<g id="edge1008" class="edge">
<title>GPT3_2B_S2_R2_L15_res1&#45;&gt;GPT3_2B_S2_R2_L15_norm2</title>
<path fill="none" stroke="black" d="M18609,-2435.12C18609,-2418.97 18609,-2394.47 18609,-2374.07"/>
<polygon fill="black" stroke="black" points="18612.5,-2373.85 18609,-2363.85 18605.5,-2373.85 18612.5,-2373.85"/>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_up -->
<g id="node1094" class="node">
<title>GPT3_2B_S2_R2_L15_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-2237.82 18502.5,-2237.82 18502.5,-2199.82 18715.5,-2199.82 18715.5,-2237.82"/>
<text text-anchor="middle" x="18609" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18609" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_norm2&#45;&gt;GPT3_2B_S2_R2_L15_ffn_up -->
<g id="edge1009" class="edge">
<title>GPT3_2B_S2_R2_L15_norm2&#45;&gt;GPT3_2B_S2_R2_L15_ffn_up</title>
<path fill="none" stroke="black" d="M18609,-2309.69C18609,-2291.42 18609,-2266.99 18609,-2248.22"/>
<polygon fill="black" stroke="black" points="18612.5,-2248.17 18609,-2238.17 18605.5,-2248.17 18612.5,-2248.17"/>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_gate -->
<g id="node1095" class="node">
<title>GPT3_2B_S2_R2_L15_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-2127.82 18502.5,-2127.82 18502.5,-2089.82 18715.5,-2089.82 18715.5,-2127.82"/>
<text text-anchor="middle" x="18609" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18609" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_up&#45;&gt;GPT3_2B_S2_R2_L15_ffn_gate -->
<g id="edge1010" class="edge">
<title>GPT3_2B_S2_R2_L15_ffn_up&#45;&gt;GPT3_2B_S2_R2_L15_ffn_gate</title>
<path fill="none" stroke="black" d="M18609,-2199.5C18609,-2182.64 18609,-2157.39 18609,-2137.97"/>
<polygon fill="black" stroke="black" points="18612.5,-2137.87 18609,-2127.87 18605.5,-2137.87 18612.5,-2137.87"/>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_down -->
<g id="node1096" class="node">
<title>GPT3_2B_S2_R2_L15_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-2017.82 18502.5,-2017.82 18502.5,-1979.82 18715.5,-1979.82 18715.5,-2017.82"/>
<text text-anchor="middle" x="18609" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18609" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L15_ffn_down -->
<g id="edge1011" class="edge">
<title>GPT3_2B_S2_R2_L15_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L15_ffn_down</title>
<path fill="none" stroke="black" d="M18609,-2089.5C18609,-2072.64 18609,-2047.39 18609,-2027.97"/>
<polygon fill="black" stroke="black" points="18612.5,-2027.87 18609,-2017.87 18605.5,-2027.87 18612.5,-2027.87"/>
</g>
<!-- GPT3_2B_S2_R2_L15_ar2 -->
<g id="node1097" class="node">
<title>GPT3_2B_S2_R2_L15_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18609" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L15_ffn_down&#45;&gt;GPT3_2B_S2_R2_L15_ar2 -->
<g id="edge1012" class="edge">
<title>GPT3_2B_S2_R2_L15_ffn_down&#45;&gt;GPT3_2B_S2_R2_L15_ar2</title>
<path fill="none" stroke="black" d="M18609,-1979.72C18609,-1963.35 18609,-1938.76 18609,-1918.33"/>
<polygon fill="black" stroke="black" points="18612.5,-1918.1 18609,-1908.1 18605.5,-1918.1 18612.5,-1918.1"/>
</g>
<!-- GPT3_2B_S2_R2_L15_res2 -->
<g id="node1098" class="node">
<title>GPT3_2B_S2_R2_L15_res2</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-1782.08 18557.11,-1782.08 18521.16,-1746.08 18660.89,-1746.08 18696.84,-1782.08"/>
<text text-anchor="middle" x="18609" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L15_ar2&#45;&gt;GPT3_2B_S2_R2_L15_res2 -->
<g id="edge1013" class="edge">
<title>GPT3_2B_S2_R2_L15_ar2&#45;&gt;GPT3_2B_S2_R2_L15_res2</title>
<path fill="none" stroke="black" d="M18609,-1853.89C18609,-1835.51 18609,-1810.97 18609,-1792.34"/>
<polygon fill="black" stroke="black" points="18612.5,-1792.14 18609,-1782.14 18605.5,-1792.14 18612.5,-1792.14"/>
</g>
<!-- GPT3_2B_S2_R2_L16_split -->
<g id="node1099" class="node">
<title>GPT3_2B_S2_R2_L16_split</title>
<polygon fill="orange" stroke="black" points="18167.7,-3091.04 17501.64,-3091.04 17330.3,-3015.04 17996.36,-3015.04 18167.7,-3091.04"/>
<text text-anchor="middle" x="17749" y="-3056.84" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="17749" y="-3041.84" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_norm1 -->
<g id="node1100" class="node">
<title>GPT3_2B_S2_R2_L16_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="17818" cy="-2916.17" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="17818" y="-2919.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17818" y="-2904.97" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L16_split&#45;&gt;GPT3_2B_S2_R2_L16_norm1 -->
<g id="edge1014" class="edge">
<title>GPT3_2B_S2_R2_L16_split&#45;&gt;GPT3_2B_S2_R2_L16_norm1</title>
<path fill="none" stroke="black" d="M17768.04,-3014.83C17778.12,-2995.13 17790.41,-2971.09 17800.29,-2951.8"/>
<polygon fill="black" stroke="black" points="17803.48,-2953.24 17804.92,-2942.74 17797.25,-2950.05 17803.48,-2953.24"/>
</g>
<!-- GPT3_2B_S2_R2_L16_qkv -->
<g id="node1101" class="node">
<title>GPT3_2B_S2_R2_L16_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18030,-2817.3 17746,-2817.3 17746,-2779.3 18030,-2779.3 18030,-2817.3"/>
<text text-anchor="middle" x="17888" y="-2802.1" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="17888" y="-2787.1" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_norm1&#45;&gt;GPT3_2B_S2_R2_L16_qkv -->
<g id="edge1015" class="edge">
<title>GPT3_2B_S2_R2_L16_norm1&#45;&gt;GPT3_2B_S2_R2_L16_qkv</title>
<path fill="none" stroke="black" d="M17833.54,-2889.46C17844.89,-2870.66 17860.25,-2845.24 17871.76,-2826.18"/>
<polygon fill="black" stroke="black" points="17874.9,-2827.76 17877.07,-2817.39 17868.91,-2824.14 17874.9,-2827.76"/>
</g>
<!-- GPT3_2B_S2_R2_L16_attn -->
<g id="node1102" class="node">
<title>GPT3_2B_S2_R2_L16_attn</title>
<polygon fill="lightcoral" stroke="black" points="18168,-2707.3 17884,-2707.3 17884,-2669.3 18168,-2669.3 18168,-2707.3"/>
<text text-anchor="middle" x="18026" y="-2692.1" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18026" y="-2677.1" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_qkv&#45;&gt;GPT3_2B_S2_R2_L16_attn -->
<g id="edge1016" class="edge">
<title>GPT3_2B_S2_R2_L16_qkv&#45;&gt;GPT3_2B_S2_R2_L16_attn</title>
<path fill="none" stroke="black" d="M17911.1,-2779.23C17934.08,-2761.24 17969.51,-2733.51 17994.95,-2713.6"/>
<polygon fill="black" stroke="black" points="17997.11,-2716.36 18002.83,-2707.44 17992.79,-2710.84 17997.11,-2716.36"/>
</g>
<!-- GPT3_2B_S2_R2_L16_ar1 -->
<g id="node1103" class="node">
<title>GPT3_2B_S2_R2_L16_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18031" cy="-2570.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18031" y="-2574.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18031" y="-2559.23" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_attn&#45;&gt;GPT3_2B_S2_R2_L16_ar1 -->
<g id="edge1017" class="edge">
<title>GPT3_2B_S2_R2_L16_attn&#45;&gt;GPT3_2B_S2_R2_L16_ar1</title>
<path fill="none" stroke="black" d="M18026.78,-2669.2C18027.49,-2652.83 18028.55,-2628.24 18029.43,-2607.81"/>
<polygon fill="black" stroke="black" points="18032.94,-2607.72 18029.87,-2597.58 18025.94,-2607.42 18032.94,-2607.72"/>
</g>
<!-- GPT3_2B_S2_R2_L16_res1 -->
<g id="node1104" class="node">
<title>GPT3_2B_S2_R2_L16_res1</title>
<polygon fill="lightyellow" stroke="black" points="18205.84,-2471.56 18066.11,-2471.56 18030.16,-2435.56 18169.89,-2435.56 18205.84,-2471.56"/>
<text text-anchor="middle" x="18118" y="-2449.86" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S2_R2_L16_ar1&#45;&gt;GPT3_2B_S2_R2_L16_res1 -->
<g id="edge1018" class="edge">
<title>GPT3_2B_S2_R2_L16_ar1&#45;&gt;GPT3_2B_S2_R2_L16_res1</title>
<path fill="none" stroke="black" d="M18050.31,-2543.94C18064.72,-2524.91 18084.33,-2499.02 18098.73,-2480"/>
<polygon fill="black" stroke="black" points="18101.7,-2481.88 18104.95,-2471.8 18096.12,-2477.66 18101.7,-2481.88"/>
</g>
<!-- GPT3_2B_S2_R2_L16_norm2 -->
<g id="node1105" class="node">
<title>GPT3_2B_S2_R2_L16_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18124" cy="-2336.69" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18124" y="-2340.49" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18124" y="-2325.49" font-family="Times,serif" font-size="14.00">Device: GPU_4</text>
</g>
<!-- GPT3_2B_S2_R2_L16_res1&#45;&gt;GPT3_2B_S2_R2_L16_norm2 -->
<g id="edge1019" class="edge">
<title>GPT3_2B_S2_R2_L16_res1&#45;&gt;GPT3_2B_S2_R2_L16_norm2</title>
<path fill="none" stroke="black" d="M18118.91,-2435.12C18119.75,-2418.97 18121.03,-2394.47 18122.1,-2374.07"/>
<polygon fill="black" stroke="black" points="18125.61,-2374.02 18122.63,-2363.85 18118.62,-2373.65 18125.61,-2374.02"/>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_up -->
<g id="node1106" class="node">
<title>GPT3_2B_S2_R2_L16_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18404.5,-2237.82 18191.5,-2237.82 18191.5,-2199.82 18404.5,-2199.82 18404.5,-2237.82"/>
<text text-anchor="middle" x="18298" y="-2222.62" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18298" y="-2207.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_norm2&#45;&gt;GPT3_2B_S2_R2_L16_ffn_up -->
<g id="edge1020" class="edge">
<title>GPT3_2B_S2_R2_L16_norm2&#45;&gt;GPT3_2B_S2_R2_L16_ffn_up</title>
<path fill="none" stroke="black" d="M18159.63,-2311.96C18189.68,-2291.96 18232.45,-2263.47 18262.47,-2243.48"/>
<polygon fill="black" stroke="black" points="18264.58,-2246.29 18270.96,-2237.83 18260.7,-2240.46 18264.58,-2246.29"/>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_gate -->
<g id="node1107" class="node">
<title>GPT3_2B_S2_R2_L16_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18415.5,-2127.82 18202.5,-2127.82 18202.5,-2089.82 18415.5,-2089.82 18415.5,-2127.82"/>
<text text-anchor="middle" x="18309" y="-2112.62" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18309" y="-2097.62" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_up&#45;&gt;GPT3_2B_S2_R2_L16_ffn_gate -->
<g id="edge1021" class="edge">
<title>GPT3_2B_S2_R2_L16_ffn_up&#45;&gt;GPT3_2B_S2_R2_L16_ffn_gate</title>
<path fill="none" stroke="black" d="M18299.87,-2199.5C18301.58,-2182.64 18304.16,-2157.39 18306.13,-2137.97"/>
<polygon fill="black" stroke="black" points="18309.63,-2138.18 18307.16,-2127.87 18302.67,-2137.47 18309.63,-2138.18"/>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_down -->
<g id="node1108" class="node">
<title>GPT3_2B_S2_R2_L16_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18437.5,-2017.82 18224.5,-2017.82 18224.5,-1979.82 18437.5,-1979.82 18437.5,-2017.82"/>
<text text-anchor="middle" x="18331" y="-2002.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18331" y="-1987.62" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L16_ffn_down -->
<g id="edge1022" class="edge">
<title>GPT3_2B_S2_R2_L16_ffn_gate&#45;&gt;GPT3_2B_S2_R2_L16_ffn_down</title>
<path fill="none" stroke="black" d="M18312.73,-2089.5C18316.18,-2072.56 18321.36,-2047.15 18325.32,-2027.7"/>
<polygon fill="black" stroke="black" points="18328.76,-2028.37 18327.32,-2017.87 18321.9,-2026.97 18328.76,-2028.37"/>
</g>
<!-- GPT3_2B_S2_R2_L16_ar2 -->
<g id="node1109" class="node">
<title>GPT3_2B_S2_R2_L16_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18352" cy="-1880.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18352" y="-1884.75" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18352" y="-1869.75" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S2_R2_L16_ffn_down&#45;&gt;GPT3_2B_S2_R2_L16_ar2 -->
<g id="edge1023" class="edge">
<title>GPT3_2B_S2_R2_L16_ffn_down&#45;&gt;GPT3_2B_S2_R2_L16_ar2</title>
<path fill="none" stroke="black" d="M18334.28,-1979.72C18337.26,-1963.27 18341.75,-1938.53 18345.46,-1918.05"/>
<polygon fill="black" stroke="black" points="18348.92,-1918.56 18347.26,-1908.1 18342.03,-1917.32 18348.92,-1918.56"/>
</g>
<!-- GPT3_2B_S2_R2_L16_res2 -->
<g id="node1110" class="node">
<title>GPT3_2B_S2_R2_L16_res2</title>
<polygon fill="lightyellow" stroke="black" points="18459.84,-1782.08 18320.11,-1782.08 18284.16,-1746.08 18423.89,-1746.08 18459.84,-1782.08"/>
<text text-anchor="middle" x="18372" y="-1760.38" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S2_R2_L16_ar2&#45;&gt;GPT3_2B_S2_R2_L16_res2 -->
<g id="edge1024" class="edge">
<title>GPT3_2B_S2_R2_L16_ar2&#45;&gt;GPT3_2B_S2_R2_L16_res2</title>
<path fill="none" stroke="black" d="M18356.54,-1853.89C18359.75,-1835.43 18364.05,-1810.74 18367.3,-1792.08"/>
<polygon fill="black" stroke="black" points="18370.76,-1792.6 18369.03,-1782.14 18363.87,-1791.39 18370.76,-1792.6"/>
</g>
<!-- GPT3_2B_S2_R2_L16_res2&#45;&gt;GPT3_2B_comm_2_3 -->
<g id="edge1207" class="edge">
<title>GPT3_2B_S2_R2_L16_res2&#45;&gt;GPT3_2B_comm_2_3</title>
<path fill="none" stroke="black" d="M18425.57,-1747.4C18450.93,-1740.72 18481.77,-1733.65 18510,-1730.08 19043.26,-1662.68 22877.22,-1642.42 23824.03,-1638.41"/>
<polygon fill="black" stroke="black" points="23824.36,-1641.91 23834.35,-1638.37 23824.33,-1634.91 23824.36,-1641.91"/>
</g>
<!-- GPT3_2B_S3_R1_L17_split -->
<g id="node1111" class="node">
<title>GPT3_2B_S3_R1_L17_split</title>
<polygon fill="orange" stroke="black" points="31069.7,-1499.13 30403.64,-1499.13 30232.3,-1423.13 30898.36,-1423.13 31069.7,-1499.13"/>
<text text-anchor="middle" x="30651" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="30651" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_norm1 -->
<g id="node1112" class="node">
<title>GPT3_2B_S3_R1_L17_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="30651" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L17_split&#45;&gt;GPT3_2B_S3_R1_L17_norm1 -->
<g id="edge1025" class="edge">
<title>GPT3_2B_S3_R1_L17_split&#45;&gt;GPT3_2B_S3_R1_L17_norm1</title>
<path fill="none" stroke="black" d="M30651,-1422.92C30651,-1403.71 30651,-1380.37 30651,-1361.33"/>
<polygon fill="black" stroke="black" points="30654.5,-1361.25 30651,-1351.25 30647.5,-1361.25 30654.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L17_qkv -->
<g id="node1113" class="node">
<title>GPT3_2B_S3_R1_L17_qkv</title>
<polygon fill="lightcoral" stroke="black" points="30793,-1225.39 30509,-1225.39 30509,-1187.39 30793,-1187.39 30793,-1225.39"/>
<text text-anchor="middle" x="30651" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="30651" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_norm1&#45;&gt;GPT3_2B_S3_R1_L17_qkv -->
<g id="edge1026" class="edge">
<title>GPT3_2B_S3_R1_L17_norm1&#45;&gt;GPT3_2B_S3_R1_L17_qkv</title>
<path fill="none" stroke="black" d="M30651,-1297.25C30651,-1278.99 30651,-1254.56 30651,-1235.78"/>
<polygon fill="black" stroke="black" points="30654.5,-1235.74 30651,-1225.74 30647.5,-1235.74 30654.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L17_attn -->
<g id="node1114" class="node">
<title>GPT3_2B_S3_R1_L17_attn</title>
<polygon fill="lightcoral" stroke="black" points="30793,-1115.39 30509,-1115.39 30509,-1077.39 30793,-1077.39 30793,-1115.39"/>
<text text-anchor="middle" x="30651" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="30651" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_qkv&#45;&gt;GPT3_2B_S3_R1_L17_attn -->
<g id="edge1027" class="edge">
<title>GPT3_2B_S3_R1_L17_qkv&#45;&gt;GPT3_2B_S3_R1_L17_attn</title>
<path fill="none" stroke="black" d="M30651,-1187.07C30651,-1170.21 30651,-1144.95 30651,-1125.54"/>
<polygon fill="black" stroke="black" points="30654.5,-1125.44 30651,-1115.44 30647.5,-1125.44 30654.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L17_ar1 -->
<g id="node1115" class="node">
<title>GPT3_2B_S3_R1_L17_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="30651" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_attn&#45;&gt;GPT3_2B_S3_R1_L17_ar1 -->
<g id="edge1028" class="edge">
<title>GPT3_2B_S3_R1_L17_attn&#45;&gt;GPT3_2B_S3_R1_L17_ar1</title>
<path fill="none" stroke="black" d="M30651,-1077.28C30651,-1060.91 30651,-1036.32 30651,-1015.9"/>
<polygon fill="black" stroke="black" points="30654.5,-1015.67 30651,-1005.67 30647.5,-1015.67 30654.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L17_res1 -->
<g id="node1116" class="node">
<title>GPT3_2B_S3_R1_L17_res1</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-879.65 30599.11,-879.65 30563.16,-843.65 30702.89,-843.65 30738.84,-879.65"/>
<text text-anchor="middle" x="30651" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L17_ar1&#45;&gt;GPT3_2B_S3_R1_L17_res1 -->
<g id="edge1029" class="edge">
<title>GPT3_2B_S3_R1_L17_ar1&#45;&gt;GPT3_2B_S3_R1_L17_res1</title>
<path fill="none" stroke="black" d="M30651,-951.45C30651,-933.08 30651,-908.53 30651,-889.9"/>
<polygon fill="black" stroke="black" points="30654.5,-889.71 30651,-879.71 30647.5,-889.71 30654.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L17_norm2 -->
<g id="node1117" class="node">
<title>GPT3_2B_S3_R1_L17_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="30651" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="30651" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L17_res1&#45;&gt;GPT3_2B_S3_R1_L17_norm2 -->
<g id="edge1030" class="edge">
<title>GPT3_2B_S3_R1_L17_res1&#45;&gt;GPT3_2B_S3_R1_L17_norm2</title>
<path fill="none" stroke="black" d="M30651,-843.2C30651,-827.06 30651,-802.56 30651,-782.16"/>
<polygon fill="black" stroke="black" points="30654.5,-781.94 30651,-771.94 30647.5,-781.94 30654.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_up -->
<g id="node1118" class="node">
<title>GPT3_2B_S3_R1_L17_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-645.91 30544.5,-645.91 30544.5,-607.91 30757.5,-607.91 30757.5,-645.91"/>
<text text-anchor="middle" x="30651" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="30651" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_norm2&#45;&gt;GPT3_2B_S3_R1_L17_ffn_up -->
<g id="edge1031" class="edge">
<title>GPT3_2B_S3_R1_L17_norm2&#45;&gt;GPT3_2B_S3_R1_L17_ffn_up</title>
<path fill="none" stroke="black" d="M30651,-717.77C30651,-699.51 30651,-675.08 30651,-656.3"/>
<polygon fill="black" stroke="black" points="30654.5,-656.26 30651,-646.26 30647.5,-656.26 30654.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_gate -->
<g id="node1119" class="node">
<title>GPT3_2B_S3_R1_L17_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-535.91 30544.5,-535.91 30544.5,-497.91 30757.5,-497.91 30757.5,-535.91"/>
<text text-anchor="middle" x="30651" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="30651" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_up&#45;&gt;GPT3_2B_S3_R1_L17_ffn_gate -->
<g id="edge1032" class="edge">
<title>GPT3_2B_S3_R1_L17_ffn_up&#45;&gt;GPT3_2B_S3_R1_L17_ffn_gate</title>
<path fill="none" stroke="black" d="M30651,-607.59C30651,-590.73 30651,-565.47 30651,-546.06"/>
<polygon fill="black" stroke="black" points="30654.5,-545.96 30651,-535.96 30647.5,-545.96 30654.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_down -->
<g id="node1120" class="node">
<title>GPT3_2B_S3_R1_L17_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="30757.5,-425.91 30544.5,-425.91 30544.5,-387.91 30757.5,-387.91 30757.5,-425.91"/>
<text text-anchor="middle" x="30651" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="30651" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L17_ffn_down -->
<g id="edge1033" class="edge">
<title>GPT3_2B_S3_R1_L17_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L17_ffn_down</title>
<path fill="none" stroke="black" d="M30651,-497.59C30651,-480.73 30651,-455.47 30651,-436.06"/>
<polygon fill="black" stroke="black" points="30654.5,-435.96 30651,-425.96 30647.5,-435.96 30654.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L17_ar2 -->
<g id="node1121" class="node">
<title>GPT3_2B_S3_R1_L17_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="30651" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30651" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="30651" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L17_ffn_down&#45;&gt;GPT3_2B_S3_R1_L17_ar2 -->
<g id="edge1034" class="edge">
<title>GPT3_2B_S3_R1_L17_ffn_down&#45;&gt;GPT3_2B_S3_R1_L17_ar2</title>
<path fill="none" stroke="black" d="M30651,-387.8C30651,-371.43 30651,-346.84 30651,-326.42"/>
<polygon fill="black" stroke="black" points="30654.5,-326.19 30651,-316.19 30647.5,-326.19 30654.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L17_res2 -->
<g id="node1122" class="node">
<title>GPT3_2B_S3_R1_L17_res2</title>
<polygon fill="lightyellow" stroke="black" points="30738.84,-190.17 30599.11,-190.17 30563.16,-154.17 30702.89,-154.17 30738.84,-190.17"/>
<text text-anchor="middle" x="30651" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L17_ar2&#45;&gt;GPT3_2B_S3_R1_L17_res2 -->
<g id="edge1035" class="edge">
<title>GPT3_2B_S3_R1_L17_ar2&#45;&gt;GPT3_2B_S3_R1_L17_res2</title>
<path fill="none" stroke="black" d="M30651,-261.97C30651,-243.6 30651,-219.05 30651,-200.42"/>
<polygon fill="black" stroke="black" points="30654.5,-200.23 30651,-190.23 30647.5,-200.23 30654.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L18_split -->
<g id="node1123" class="node">
<title>GPT3_2B_S3_R1_L18_split</title>
<polygon fill="orange" stroke="black" points="30209.7,-1499.13 29543.64,-1499.13 29372.3,-1423.13 30038.36,-1423.13 30209.7,-1499.13"/>
<text text-anchor="middle" x="29791" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="29791" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_norm1 -->
<g id="node1124" class="node">
<title>GPT3_2B_S3_R1_L18_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29791" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L18_split&#45;&gt;GPT3_2B_S3_R1_L18_norm1 -->
<g id="edge1036" class="edge">
<title>GPT3_2B_S3_R1_L18_split&#45;&gt;GPT3_2B_S3_R1_L18_norm1</title>
<path fill="none" stroke="black" d="M29791,-1422.92C29791,-1403.71 29791,-1380.37 29791,-1361.33"/>
<polygon fill="black" stroke="black" points="29794.5,-1361.25 29791,-1351.25 29787.5,-1361.25 29794.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L18_qkv -->
<g id="node1125" class="node">
<title>GPT3_2B_S3_R1_L18_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29933,-1225.39 29649,-1225.39 29649,-1187.39 29933,-1187.39 29933,-1225.39"/>
<text text-anchor="middle" x="29791" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="29791" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_norm1&#45;&gt;GPT3_2B_S3_R1_L18_qkv -->
<g id="edge1037" class="edge">
<title>GPT3_2B_S3_R1_L18_norm1&#45;&gt;GPT3_2B_S3_R1_L18_qkv</title>
<path fill="none" stroke="black" d="M29791,-1297.25C29791,-1278.99 29791,-1254.56 29791,-1235.78"/>
<polygon fill="black" stroke="black" points="29794.5,-1235.74 29791,-1225.74 29787.5,-1235.74 29794.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L18_attn -->
<g id="node1126" class="node">
<title>GPT3_2B_S3_R1_L18_attn</title>
<polygon fill="lightcoral" stroke="black" points="29933,-1115.39 29649,-1115.39 29649,-1077.39 29933,-1077.39 29933,-1115.39"/>
<text text-anchor="middle" x="29791" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="29791" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_qkv&#45;&gt;GPT3_2B_S3_R1_L18_attn -->
<g id="edge1038" class="edge">
<title>GPT3_2B_S3_R1_L18_qkv&#45;&gt;GPT3_2B_S3_R1_L18_attn</title>
<path fill="none" stroke="black" d="M29791,-1187.07C29791,-1170.21 29791,-1144.95 29791,-1125.54"/>
<polygon fill="black" stroke="black" points="29794.5,-1125.44 29791,-1115.44 29787.5,-1125.44 29794.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L18_ar1 -->
<g id="node1127" class="node">
<title>GPT3_2B_S3_R1_L18_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29791" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_attn&#45;&gt;GPT3_2B_S3_R1_L18_ar1 -->
<g id="edge1039" class="edge">
<title>GPT3_2B_S3_R1_L18_attn&#45;&gt;GPT3_2B_S3_R1_L18_ar1</title>
<path fill="none" stroke="black" d="M29791,-1077.28C29791,-1060.91 29791,-1036.32 29791,-1015.9"/>
<polygon fill="black" stroke="black" points="29794.5,-1015.67 29791,-1005.67 29787.5,-1015.67 29794.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L18_res1 -->
<g id="node1128" class="node">
<title>GPT3_2B_S3_R1_L18_res1</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-879.65 29739.11,-879.65 29703.16,-843.65 29842.89,-843.65 29878.84,-879.65"/>
<text text-anchor="middle" x="29791" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L18_ar1&#45;&gt;GPT3_2B_S3_R1_L18_res1 -->
<g id="edge1040" class="edge">
<title>GPT3_2B_S3_R1_L18_ar1&#45;&gt;GPT3_2B_S3_R1_L18_res1</title>
<path fill="none" stroke="black" d="M29791,-951.45C29791,-933.08 29791,-908.53 29791,-889.9"/>
<polygon fill="black" stroke="black" points="29794.5,-889.71 29791,-879.71 29787.5,-889.71 29794.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L18_norm2 -->
<g id="node1129" class="node">
<title>GPT3_2B_S3_R1_L18_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="29791" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="29791" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L18_res1&#45;&gt;GPT3_2B_S3_R1_L18_norm2 -->
<g id="edge1041" class="edge">
<title>GPT3_2B_S3_R1_L18_res1&#45;&gt;GPT3_2B_S3_R1_L18_norm2</title>
<path fill="none" stroke="black" d="M29791,-843.2C29791,-827.06 29791,-802.56 29791,-782.16"/>
<polygon fill="black" stroke="black" points="29794.5,-781.94 29791,-771.94 29787.5,-781.94 29794.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_up -->
<g id="node1130" class="node">
<title>GPT3_2B_S3_R1_L18_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-645.91 29684.5,-645.91 29684.5,-607.91 29897.5,-607.91 29897.5,-645.91"/>
<text text-anchor="middle" x="29791" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="29791" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_norm2&#45;&gt;GPT3_2B_S3_R1_L18_ffn_up -->
<g id="edge1042" class="edge">
<title>GPT3_2B_S3_R1_L18_norm2&#45;&gt;GPT3_2B_S3_R1_L18_ffn_up</title>
<path fill="none" stroke="black" d="M29791,-717.77C29791,-699.51 29791,-675.08 29791,-656.3"/>
<polygon fill="black" stroke="black" points="29794.5,-656.26 29791,-646.26 29787.5,-656.26 29794.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_gate -->
<g id="node1131" class="node">
<title>GPT3_2B_S3_R1_L18_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-535.91 29684.5,-535.91 29684.5,-497.91 29897.5,-497.91 29897.5,-535.91"/>
<text text-anchor="middle" x="29791" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="29791" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_up&#45;&gt;GPT3_2B_S3_R1_L18_ffn_gate -->
<g id="edge1043" class="edge">
<title>GPT3_2B_S3_R1_L18_ffn_up&#45;&gt;GPT3_2B_S3_R1_L18_ffn_gate</title>
<path fill="none" stroke="black" d="M29791,-607.59C29791,-590.73 29791,-565.47 29791,-546.06"/>
<polygon fill="black" stroke="black" points="29794.5,-545.96 29791,-535.96 29787.5,-545.96 29794.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_down -->
<g id="node1132" class="node">
<title>GPT3_2B_S3_R1_L18_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29897.5,-425.91 29684.5,-425.91 29684.5,-387.91 29897.5,-387.91 29897.5,-425.91"/>
<text text-anchor="middle" x="29791" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="29791" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L18_ffn_down -->
<g id="edge1044" class="edge">
<title>GPT3_2B_S3_R1_L18_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L18_ffn_down</title>
<path fill="none" stroke="black" d="M29791,-497.59C29791,-480.73 29791,-455.47 29791,-436.06"/>
<polygon fill="black" stroke="black" points="29794.5,-435.96 29791,-425.96 29787.5,-435.96 29794.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L18_ar2 -->
<g id="node1133" class="node">
<title>GPT3_2B_S3_R1_L18_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="29791" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29791" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="29791" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L18_ffn_down&#45;&gt;GPT3_2B_S3_R1_L18_ar2 -->
<g id="edge1045" class="edge">
<title>GPT3_2B_S3_R1_L18_ffn_down&#45;&gt;GPT3_2B_S3_R1_L18_ar2</title>
<path fill="none" stroke="black" d="M29791,-387.8C29791,-371.43 29791,-346.84 29791,-326.42"/>
<polygon fill="black" stroke="black" points="29794.5,-326.19 29791,-316.19 29787.5,-326.19 29794.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L18_res2 -->
<g id="node1134" class="node">
<title>GPT3_2B_S3_R1_L18_res2</title>
<polygon fill="lightyellow" stroke="black" points="29878.84,-190.17 29739.11,-190.17 29703.16,-154.17 29842.89,-154.17 29878.84,-190.17"/>
<text text-anchor="middle" x="29791" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L18_ar2&#45;&gt;GPT3_2B_S3_R1_L18_res2 -->
<g id="edge1046" class="edge">
<title>GPT3_2B_S3_R1_L18_ar2&#45;&gt;GPT3_2B_S3_R1_L18_res2</title>
<path fill="none" stroke="black" d="M29791,-261.97C29791,-243.6 29791,-219.05 29791,-200.42"/>
<polygon fill="black" stroke="black" points="29794.5,-200.23 29791,-190.23 29787.5,-200.23 29794.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L19_split -->
<g id="node1135" class="node">
<title>GPT3_2B_S3_R1_L19_split</title>
<polygon fill="orange" stroke="black" points="29349.7,-1499.13 28683.64,-1499.13 28512.3,-1423.13 29178.36,-1423.13 29349.7,-1499.13"/>
<text text-anchor="middle" x="28931" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28931" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_norm1 -->
<g id="node1136" class="node">
<title>GPT3_2B_S3_R1_L19_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28931" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L19_split&#45;&gt;GPT3_2B_S3_R1_L19_norm1 -->
<g id="edge1047" class="edge">
<title>GPT3_2B_S3_R1_L19_split&#45;&gt;GPT3_2B_S3_R1_L19_norm1</title>
<path fill="none" stroke="black" d="M28931,-1422.92C28931,-1403.71 28931,-1380.37 28931,-1361.33"/>
<polygon fill="black" stroke="black" points="28934.5,-1361.25 28931,-1351.25 28927.5,-1361.25 28934.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L19_qkv -->
<g id="node1137" class="node">
<title>GPT3_2B_S3_R1_L19_qkv</title>
<polygon fill="lightcoral" stroke="black" points="29073,-1225.39 28789,-1225.39 28789,-1187.39 29073,-1187.39 29073,-1225.39"/>
<text text-anchor="middle" x="28931" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28931" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_norm1&#45;&gt;GPT3_2B_S3_R1_L19_qkv -->
<g id="edge1048" class="edge">
<title>GPT3_2B_S3_R1_L19_norm1&#45;&gt;GPT3_2B_S3_R1_L19_qkv</title>
<path fill="none" stroke="black" d="M28931,-1297.25C28931,-1278.99 28931,-1254.56 28931,-1235.78"/>
<polygon fill="black" stroke="black" points="28934.5,-1235.74 28931,-1225.74 28927.5,-1235.74 28934.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L19_attn -->
<g id="node1138" class="node">
<title>GPT3_2B_S3_R1_L19_attn</title>
<polygon fill="lightcoral" stroke="black" points="29073,-1115.39 28789,-1115.39 28789,-1077.39 29073,-1077.39 29073,-1115.39"/>
<text text-anchor="middle" x="28931" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28931" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_qkv&#45;&gt;GPT3_2B_S3_R1_L19_attn -->
<g id="edge1049" class="edge">
<title>GPT3_2B_S3_R1_L19_qkv&#45;&gt;GPT3_2B_S3_R1_L19_attn</title>
<path fill="none" stroke="black" d="M28931,-1187.07C28931,-1170.21 28931,-1144.95 28931,-1125.54"/>
<polygon fill="black" stroke="black" points="28934.5,-1125.44 28931,-1115.44 28927.5,-1125.44 28934.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L19_ar1 -->
<g id="node1139" class="node">
<title>GPT3_2B_S3_R1_L19_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28931" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_attn&#45;&gt;GPT3_2B_S3_R1_L19_ar1 -->
<g id="edge1050" class="edge">
<title>GPT3_2B_S3_R1_L19_attn&#45;&gt;GPT3_2B_S3_R1_L19_ar1</title>
<path fill="none" stroke="black" d="M28931,-1077.28C28931,-1060.91 28931,-1036.32 28931,-1015.9"/>
<polygon fill="black" stroke="black" points="28934.5,-1015.67 28931,-1005.67 28927.5,-1015.67 28934.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L19_res1 -->
<g id="node1140" class="node">
<title>GPT3_2B_S3_R1_L19_res1</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-879.65 28879.11,-879.65 28843.16,-843.65 28982.89,-843.65 29018.84,-879.65"/>
<text text-anchor="middle" x="28931" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L19_ar1&#45;&gt;GPT3_2B_S3_R1_L19_res1 -->
<g id="edge1051" class="edge">
<title>GPT3_2B_S3_R1_L19_ar1&#45;&gt;GPT3_2B_S3_R1_L19_res1</title>
<path fill="none" stroke="black" d="M28931,-951.45C28931,-933.08 28931,-908.53 28931,-889.9"/>
<polygon fill="black" stroke="black" points="28934.5,-889.71 28931,-879.71 28927.5,-889.71 28934.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L19_norm2 -->
<g id="node1141" class="node">
<title>GPT3_2B_S3_R1_L19_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28931" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28931" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L19_res1&#45;&gt;GPT3_2B_S3_R1_L19_norm2 -->
<g id="edge1052" class="edge">
<title>GPT3_2B_S3_R1_L19_res1&#45;&gt;GPT3_2B_S3_R1_L19_norm2</title>
<path fill="none" stroke="black" d="M28931,-843.2C28931,-827.06 28931,-802.56 28931,-782.16"/>
<polygon fill="black" stroke="black" points="28934.5,-781.94 28931,-771.94 28927.5,-781.94 28934.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_up -->
<g id="node1142" class="node">
<title>GPT3_2B_S3_R1_L19_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-645.91 28824.5,-645.91 28824.5,-607.91 29037.5,-607.91 29037.5,-645.91"/>
<text text-anchor="middle" x="28931" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28931" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_norm2&#45;&gt;GPT3_2B_S3_R1_L19_ffn_up -->
<g id="edge1053" class="edge">
<title>GPT3_2B_S3_R1_L19_norm2&#45;&gt;GPT3_2B_S3_R1_L19_ffn_up</title>
<path fill="none" stroke="black" d="M28931,-717.77C28931,-699.51 28931,-675.08 28931,-656.3"/>
<polygon fill="black" stroke="black" points="28934.5,-656.26 28931,-646.26 28927.5,-656.26 28934.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_gate -->
<g id="node1143" class="node">
<title>GPT3_2B_S3_R1_L19_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-535.91 28824.5,-535.91 28824.5,-497.91 29037.5,-497.91 29037.5,-535.91"/>
<text text-anchor="middle" x="28931" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28931" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_up&#45;&gt;GPT3_2B_S3_R1_L19_ffn_gate -->
<g id="edge1054" class="edge">
<title>GPT3_2B_S3_R1_L19_ffn_up&#45;&gt;GPT3_2B_S3_R1_L19_ffn_gate</title>
<path fill="none" stroke="black" d="M28931,-607.59C28931,-590.73 28931,-565.47 28931,-546.06"/>
<polygon fill="black" stroke="black" points="28934.5,-545.96 28931,-535.96 28927.5,-545.96 28934.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_down -->
<g id="node1144" class="node">
<title>GPT3_2B_S3_R1_L19_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="29037.5,-425.91 28824.5,-425.91 28824.5,-387.91 29037.5,-387.91 29037.5,-425.91"/>
<text text-anchor="middle" x="28931" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28931" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L19_ffn_down -->
<g id="edge1055" class="edge">
<title>GPT3_2B_S3_R1_L19_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L19_ffn_down</title>
<path fill="none" stroke="black" d="M28931,-497.59C28931,-480.73 28931,-455.47 28931,-436.06"/>
<polygon fill="black" stroke="black" points="28934.5,-435.96 28931,-425.96 28927.5,-435.96 28934.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L19_ar2 -->
<g id="node1145" class="node">
<title>GPT3_2B_S3_R1_L19_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28931" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28931" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28931" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L19_ffn_down&#45;&gt;GPT3_2B_S3_R1_L19_ar2 -->
<g id="edge1056" class="edge">
<title>GPT3_2B_S3_R1_L19_ffn_down&#45;&gt;GPT3_2B_S3_R1_L19_ar2</title>
<path fill="none" stroke="black" d="M28931,-387.8C28931,-371.43 28931,-346.84 28931,-326.42"/>
<polygon fill="black" stroke="black" points="28934.5,-326.19 28931,-316.19 28927.5,-326.19 28934.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L19_res2 -->
<g id="node1146" class="node">
<title>GPT3_2B_S3_R1_L19_res2</title>
<polygon fill="lightyellow" stroke="black" points="29018.84,-190.17 28879.11,-190.17 28843.16,-154.17 28982.89,-154.17 29018.84,-190.17"/>
<text text-anchor="middle" x="28931" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L19_ar2&#45;&gt;GPT3_2B_S3_R1_L19_res2 -->
<g id="edge1057" class="edge">
<title>GPT3_2B_S3_R1_L19_ar2&#45;&gt;GPT3_2B_S3_R1_L19_res2</title>
<path fill="none" stroke="black" d="M28931,-261.97C28931,-243.6 28931,-219.05 28931,-200.42"/>
<polygon fill="black" stroke="black" points="28934.5,-200.23 28931,-190.23 28927.5,-200.23 28934.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L20_split -->
<g id="node1147" class="node">
<title>GPT3_2B_S3_R1_L20_split</title>
<polygon fill="orange" stroke="black" points="28489.7,-1499.13 27823.64,-1499.13 27652.3,-1423.13 28318.36,-1423.13 28489.7,-1499.13"/>
<text text-anchor="middle" x="28071" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="28071" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_norm1 -->
<g id="node1148" class="node">
<title>GPT3_2B_S3_R1_L20_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28071" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L20_split&#45;&gt;GPT3_2B_S3_R1_L20_norm1 -->
<g id="edge1058" class="edge">
<title>GPT3_2B_S3_R1_L20_split&#45;&gt;GPT3_2B_S3_R1_L20_norm1</title>
<path fill="none" stroke="black" d="M28071,-1422.92C28071,-1403.71 28071,-1380.37 28071,-1361.33"/>
<polygon fill="black" stroke="black" points="28074.5,-1361.25 28071,-1351.25 28067.5,-1361.25 28074.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L20_qkv -->
<g id="node1149" class="node">
<title>GPT3_2B_S3_R1_L20_qkv</title>
<polygon fill="lightcoral" stroke="black" points="28213,-1225.39 27929,-1225.39 27929,-1187.39 28213,-1187.39 28213,-1225.39"/>
<text text-anchor="middle" x="28071" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="28071" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_norm1&#45;&gt;GPT3_2B_S3_R1_L20_qkv -->
<g id="edge1059" class="edge">
<title>GPT3_2B_S3_R1_L20_norm1&#45;&gt;GPT3_2B_S3_R1_L20_qkv</title>
<path fill="none" stroke="black" d="M28071,-1297.25C28071,-1278.99 28071,-1254.56 28071,-1235.78"/>
<polygon fill="black" stroke="black" points="28074.5,-1235.74 28071,-1225.74 28067.5,-1235.74 28074.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L20_attn -->
<g id="node1150" class="node">
<title>GPT3_2B_S3_R1_L20_attn</title>
<polygon fill="lightcoral" stroke="black" points="28213,-1115.39 27929,-1115.39 27929,-1077.39 28213,-1077.39 28213,-1115.39"/>
<text text-anchor="middle" x="28071" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="28071" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_qkv&#45;&gt;GPT3_2B_S3_R1_L20_attn -->
<g id="edge1060" class="edge">
<title>GPT3_2B_S3_R1_L20_qkv&#45;&gt;GPT3_2B_S3_R1_L20_attn</title>
<path fill="none" stroke="black" d="M28071,-1187.07C28071,-1170.21 28071,-1144.95 28071,-1125.54"/>
<polygon fill="black" stroke="black" points="28074.5,-1125.44 28071,-1115.44 28067.5,-1125.44 28074.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L20_ar1 -->
<g id="node1151" class="node">
<title>GPT3_2B_S3_R1_L20_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28071" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_attn&#45;&gt;GPT3_2B_S3_R1_L20_ar1 -->
<g id="edge1061" class="edge">
<title>GPT3_2B_S3_R1_L20_attn&#45;&gt;GPT3_2B_S3_R1_L20_ar1</title>
<path fill="none" stroke="black" d="M28071,-1077.28C28071,-1060.91 28071,-1036.32 28071,-1015.9"/>
<polygon fill="black" stroke="black" points="28074.5,-1015.67 28071,-1005.67 28067.5,-1015.67 28074.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L20_res1 -->
<g id="node1152" class="node">
<title>GPT3_2B_S3_R1_L20_res1</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-879.65 28019.11,-879.65 27983.16,-843.65 28122.89,-843.65 28158.84,-879.65"/>
<text text-anchor="middle" x="28071" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L20_ar1&#45;&gt;GPT3_2B_S3_R1_L20_res1 -->
<g id="edge1062" class="edge">
<title>GPT3_2B_S3_R1_L20_ar1&#45;&gt;GPT3_2B_S3_R1_L20_res1</title>
<path fill="none" stroke="black" d="M28071,-951.45C28071,-933.08 28071,-908.53 28071,-889.9"/>
<polygon fill="black" stroke="black" points="28074.5,-889.71 28071,-879.71 28067.5,-889.71 28074.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L20_norm2 -->
<g id="node1153" class="node">
<title>GPT3_2B_S3_R1_L20_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="28071" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="28071" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L20_res1&#45;&gt;GPT3_2B_S3_R1_L20_norm2 -->
<g id="edge1063" class="edge">
<title>GPT3_2B_S3_R1_L20_res1&#45;&gt;GPT3_2B_S3_R1_L20_norm2</title>
<path fill="none" stroke="black" d="M28071,-843.2C28071,-827.06 28071,-802.56 28071,-782.16"/>
<polygon fill="black" stroke="black" points="28074.5,-781.94 28071,-771.94 28067.5,-781.94 28074.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_up -->
<g id="node1154" class="node">
<title>GPT3_2B_S3_R1_L20_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-645.91 27964.5,-645.91 27964.5,-607.91 28177.5,-607.91 28177.5,-645.91"/>
<text text-anchor="middle" x="28071" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="28071" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_norm2&#45;&gt;GPT3_2B_S3_R1_L20_ffn_up -->
<g id="edge1064" class="edge">
<title>GPT3_2B_S3_R1_L20_norm2&#45;&gt;GPT3_2B_S3_R1_L20_ffn_up</title>
<path fill="none" stroke="black" d="M28071,-717.77C28071,-699.51 28071,-675.08 28071,-656.3"/>
<polygon fill="black" stroke="black" points="28074.5,-656.26 28071,-646.26 28067.5,-656.26 28074.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_gate -->
<g id="node1155" class="node">
<title>GPT3_2B_S3_R1_L20_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-535.91 27964.5,-535.91 27964.5,-497.91 28177.5,-497.91 28177.5,-535.91"/>
<text text-anchor="middle" x="28071" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="28071" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_up&#45;&gt;GPT3_2B_S3_R1_L20_ffn_gate -->
<g id="edge1065" class="edge">
<title>GPT3_2B_S3_R1_L20_ffn_up&#45;&gt;GPT3_2B_S3_R1_L20_ffn_gate</title>
<path fill="none" stroke="black" d="M28071,-607.59C28071,-590.73 28071,-565.47 28071,-546.06"/>
<polygon fill="black" stroke="black" points="28074.5,-545.96 28071,-535.96 28067.5,-545.96 28074.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_down -->
<g id="node1156" class="node">
<title>GPT3_2B_S3_R1_L20_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="28177.5,-425.91 27964.5,-425.91 27964.5,-387.91 28177.5,-387.91 28177.5,-425.91"/>
<text text-anchor="middle" x="28071" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="28071" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L20_ffn_down -->
<g id="edge1066" class="edge">
<title>GPT3_2B_S3_R1_L20_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L20_ffn_down</title>
<path fill="none" stroke="black" d="M28071,-497.59C28071,-480.73 28071,-455.47 28071,-436.06"/>
<polygon fill="black" stroke="black" points="28074.5,-435.96 28071,-425.96 28067.5,-435.96 28074.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L20_ar2 -->
<g id="node1157" class="node">
<title>GPT3_2B_S3_R1_L20_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="28071" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28071" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="28071" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L20_ffn_down&#45;&gt;GPT3_2B_S3_R1_L20_ar2 -->
<g id="edge1067" class="edge">
<title>GPT3_2B_S3_R1_L20_ffn_down&#45;&gt;GPT3_2B_S3_R1_L20_ar2</title>
<path fill="none" stroke="black" d="M28071,-387.8C28071,-371.43 28071,-346.84 28071,-326.42"/>
<polygon fill="black" stroke="black" points="28074.5,-326.19 28071,-316.19 28067.5,-326.19 28074.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L20_res2 -->
<g id="node1158" class="node">
<title>GPT3_2B_S3_R1_L20_res2</title>
<polygon fill="lightyellow" stroke="black" points="28158.84,-190.17 28019.11,-190.17 27983.16,-154.17 28122.89,-154.17 28158.84,-190.17"/>
<text text-anchor="middle" x="28071" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L20_ar2&#45;&gt;GPT3_2B_S3_R1_L20_res2 -->
<g id="edge1068" class="edge">
<title>GPT3_2B_S3_R1_L20_ar2&#45;&gt;GPT3_2B_S3_R1_L20_res2</title>
<path fill="none" stroke="black" d="M28071,-261.97C28071,-243.6 28071,-219.05 28071,-200.42"/>
<polygon fill="black" stroke="black" points="28074.5,-200.23 28071,-190.23 28067.5,-200.23 28074.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L21_split -->
<g id="node1159" class="node">
<title>GPT3_2B_S3_R1_L21_split</title>
<polygon fill="orange" stroke="black" points="27629.7,-1499.13 26963.64,-1499.13 26792.3,-1423.13 27458.36,-1423.13 27629.7,-1499.13"/>
<text text-anchor="middle" x="27211" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="27211" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_norm1 -->
<g id="node1160" class="node">
<title>GPT3_2B_S3_R1_L21_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27211" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L21_split&#45;&gt;GPT3_2B_S3_R1_L21_norm1 -->
<g id="edge1069" class="edge">
<title>GPT3_2B_S3_R1_L21_split&#45;&gt;GPT3_2B_S3_R1_L21_norm1</title>
<path fill="none" stroke="black" d="M27211,-1422.92C27211,-1403.71 27211,-1380.37 27211,-1361.33"/>
<polygon fill="black" stroke="black" points="27214.5,-1361.25 27211,-1351.25 27207.5,-1361.25 27214.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L21_qkv -->
<g id="node1161" class="node">
<title>GPT3_2B_S3_R1_L21_qkv</title>
<polygon fill="lightcoral" stroke="black" points="27353,-1225.39 27069,-1225.39 27069,-1187.39 27353,-1187.39 27353,-1225.39"/>
<text text-anchor="middle" x="27211" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="27211" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_norm1&#45;&gt;GPT3_2B_S3_R1_L21_qkv -->
<g id="edge1070" class="edge">
<title>GPT3_2B_S3_R1_L21_norm1&#45;&gt;GPT3_2B_S3_R1_L21_qkv</title>
<path fill="none" stroke="black" d="M27211,-1297.25C27211,-1278.99 27211,-1254.56 27211,-1235.78"/>
<polygon fill="black" stroke="black" points="27214.5,-1235.74 27211,-1225.74 27207.5,-1235.74 27214.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L21_attn -->
<g id="node1162" class="node">
<title>GPT3_2B_S3_R1_L21_attn</title>
<polygon fill="lightcoral" stroke="black" points="27353,-1115.39 27069,-1115.39 27069,-1077.39 27353,-1077.39 27353,-1115.39"/>
<text text-anchor="middle" x="27211" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="27211" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_qkv&#45;&gt;GPT3_2B_S3_R1_L21_attn -->
<g id="edge1071" class="edge">
<title>GPT3_2B_S3_R1_L21_qkv&#45;&gt;GPT3_2B_S3_R1_L21_attn</title>
<path fill="none" stroke="black" d="M27211,-1187.07C27211,-1170.21 27211,-1144.95 27211,-1125.54"/>
<polygon fill="black" stroke="black" points="27214.5,-1125.44 27211,-1115.44 27207.5,-1125.44 27214.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L21_ar1 -->
<g id="node1163" class="node">
<title>GPT3_2B_S3_R1_L21_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="27211" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_attn&#45;&gt;GPT3_2B_S3_R1_L21_ar1 -->
<g id="edge1072" class="edge">
<title>GPT3_2B_S3_R1_L21_attn&#45;&gt;GPT3_2B_S3_R1_L21_ar1</title>
<path fill="none" stroke="black" d="M27211,-1077.28C27211,-1060.91 27211,-1036.32 27211,-1015.9"/>
<polygon fill="black" stroke="black" points="27214.5,-1015.67 27211,-1005.67 27207.5,-1015.67 27214.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L21_res1 -->
<g id="node1164" class="node">
<title>GPT3_2B_S3_R1_L21_res1</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-879.65 27159.11,-879.65 27123.16,-843.65 27262.89,-843.65 27298.84,-879.65"/>
<text text-anchor="middle" x="27211" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L21_ar1&#45;&gt;GPT3_2B_S3_R1_L21_res1 -->
<g id="edge1073" class="edge">
<title>GPT3_2B_S3_R1_L21_ar1&#45;&gt;GPT3_2B_S3_R1_L21_res1</title>
<path fill="none" stroke="black" d="M27211,-951.45C27211,-933.08 27211,-908.53 27211,-889.9"/>
<polygon fill="black" stroke="black" points="27214.5,-889.71 27211,-879.71 27207.5,-889.71 27214.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L21_norm2 -->
<g id="node1165" class="node">
<title>GPT3_2B_S3_R1_L21_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="27211" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="27211" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L21_res1&#45;&gt;GPT3_2B_S3_R1_L21_norm2 -->
<g id="edge1074" class="edge">
<title>GPT3_2B_S3_R1_L21_res1&#45;&gt;GPT3_2B_S3_R1_L21_norm2</title>
<path fill="none" stroke="black" d="M27211,-843.2C27211,-827.06 27211,-802.56 27211,-782.16"/>
<polygon fill="black" stroke="black" points="27214.5,-781.94 27211,-771.94 27207.5,-781.94 27214.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_up -->
<g id="node1166" class="node">
<title>GPT3_2B_S3_R1_L21_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-645.91 27104.5,-645.91 27104.5,-607.91 27317.5,-607.91 27317.5,-645.91"/>
<text text-anchor="middle" x="27211" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="27211" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_norm2&#45;&gt;GPT3_2B_S3_R1_L21_ffn_up -->
<g id="edge1075" class="edge">
<title>GPT3_2B_S3_R1_L21_norm2&#45;&gt;GPT3_2B_S3_R1_L21_ffn_up</title>
<path fill="none" stroke="black" d="M27211,-717.77C27211,-699.51 27211,-675.08 27211,-656.3"/>
<polygon fill="black" stroke="black" points="27214.5,-656.26 27211,-646.26 27207.5,-656.26 27214.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_gate -->
<g id="node1167" class="node">
<title>GPT3_2B_S3_R1_L21_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-535.91 27104.5,-535.91 27104.5,-497.91 27317.5,-497.91 27317.5,-535.91"/>
<text text-anchor="middle" x="27211" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="27211" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_up&#45;&gt;GPT3_2B_S3_R1_L21_ffn_gate -->
<g id="edge1076" class="edge">
<title>GPT3_2B_S3_R1_L21_ffn_up&#45;&gt;GPT3_2B_S3_R1_L21_ffn_gate</title>
<path fill="none" stroke="black" d="M27211,-607.59C27211,-590.73 27211,-565.47 27211,-546.06"/>
<polygon fill="black" stroke="black" points="27214.5,-545.96 27211,-535.96 27207.5,-545.96 27214.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_down -->
<g id="node1168" class="node">
<title>GPT3_2B_S3_R1_L21_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="27317.5,-425.91 27104.5,-425.91 27104.5,-387.91 27317.5,-387.91 27317.5,-425.91"/>
<text text-anchor="middle" x="27211" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="27211" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L21_ffn_down -->
<g id="edge1077" class="edge">
<title>GPT3_2B_S3_R1_L21_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L21_ffn_down</title>
<path fill="none" stroke="black" d="M27211,-497.59C27211,-480.73 27211,-455.47 27211,-436.06"/>
<polygon fill="black" stroke="black" points="27214.5,-435.96 27211,-425.96 27207.5,-435.96 27214.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L21_ar2 -->
<g id="node1169" class="node">
<title>GPT3_2B_S3_R1_L21_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="27211" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27211" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="27211" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L21_ffn_down&#45;&gt;GPT3_2B_S3_R1_L21_ar2 -->
<g id="edge1078" class="edge">
<title>GPT3_2B_S3_R1_L21_ffn_down&#45;&gt;GPT3_2B_S3_R1_L21_ar2</title>
<path fill="none" stroke="black" d="M27211,-387.8C27211,-371.43 27211,-346.84 27211,-326.42"/>
<polygon fill="black" stroke="black" points="27214.5,-326.19 27211,-316.19 27207.5,-326.19 27214.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L21_res2 -->
<g id="node1170" class="node">
<title>GPT3_2B_S3_R1_L21_res2</title>
<polygon fill="lightyellow" stroke="black" points="27298.84,-190.17 27159.11,-190.17 27123.16,-154.17 27262.89,-154.17 27298.84,-190.17"/>
<text text-anchor="middle" x="27211" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L21_ar2&#45;&gt;GPT3_2B_S3_R1_L21_res2 -->
<g id="edge1079" class="edge">
<title>GPT3_2B_S3_R1_L21_ar2&#45;&gt;GPT3_2B_S3_R1_L21_res2</title>
<path fill="none" stroke="black" d="M27211,-261.97C27211,-243.6 27211,-219.05 27211,-200.42"/>
<polygon fill="black" stroke="black" points="27214.5,-200.23 27211,-190.23 27207.5,-200.23 27214.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L22_split -->
<g id="node1171" class="node">
<title>GPT3_2B_S3_R1_L22_split</title>
<polygon fill="orange" stroke="black" points="26769.7,-1499.13 26103.64,-1499.13 25932.3,-1423.13 26598.36,-1423.13 26769.7,-1499.13"/>
<text text-anchor="middle" x="26351" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="26351" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_norm1 -->
<g id="node1172" class="node">
<title>GPT3_2B_S3_R1_L22_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26351" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L22_split&#45;&gt;GPT3_2B_S3_R1_L22_norm1 -->
<g id="edge1080" class="edge">
<title>GPT3_2B_S3_R1_L22_split&#45;&gt;GPT3_2B_S3_R1_L22_norm1</title>
<path fill="none" stroke="black" d="M26351,-1422.92C26351,-1403.71 26351,-1380.37 26351,-1361.33"/>
<polygon fill="black" stroke="black" points="26354.5,-1361.25 26351,-1351.25 26347.5,-1361.25 26354.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L22_qkv -->
<g id="node1173" class="node">
<title>GPT3_2B_S3_R1_L22_qkv</title>
<polygon fill="lightcoral" stroke="black" points="26493,-1225.39 26209,-1225.39 26209,-1187.39 26493,-1187.39 26493,-1225.39"/>
<text text-anchor="middle" x="26351" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="26351" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_norm1&#45;&gt;GPT3_2B_S3_R1_L22_qkv -->
<g id="edge1081" class="edge">
<title>GPT3_2B_S3_R1_L22_norm1&#45;&gt;GPT3_2B_S3_R1_L22_qkv</title>
<path fill="none" stroke="black" d="M26351,-1297.25C26351,-1278.99 26351,-1254.56 26351,-1235.78"/>
<polygon fill="black" stroke="black" points="26354.5,-1235.74 26351,-1225.74 26347.5,-1235.74 26354.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L22_attn -->
<g id="node1174" class="node">
<title>GPT3_2B_S3_R1_L22_attn</title>
<polygon fill="lightcoral" stroke="black" points="26493,-1115.39 26209,-1115.39 26209,-1077.39 26493,-1077.39 26493,-1115.39"/>
<text text-anchor="middle" x="26351" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="26351" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_qkv&#45;&gt;GPT3_2B_S3_R1_L22_attn -->
<g id="edge1082" class="edge">
<title>GPT3_2B_S3_R1_L22_qkv&#45;&gt;GPT3_2B_S3_R1_L22_attn</title>
<path fill="none" stroke="black" d="M26351,-1187.07C26351,-1170.21 26351,-1144.95 26351,-1125.54"/>
<polygon fill="black" stroke="black" points="26354.5,-1125.44 26351,-1115.44 26347.5,-1125.44 26354.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L22_ar1 -->
<g id="node1175" class="node">
<title>GPT3_2B_S3_R1_L22_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="26351" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_attn&#45;&gt;GPT3_2B_S3_R1_L22_ar1 -->
<g id="edge1083" class="edge">
<title>GPT3_2B_S3_R1_L22_attn&#45;&gt;GPT3_2B_S3_R1_L22_ar1</title>
<path fill="none" stroke="black" d="M26351,-1077.28C26351,-1060.91 26351,-1036.32 26351,-1015.9"/>
<polygon fill="black" stroke="black" points="26354.5,-1015.67 26351,-1005.67 26347.5,-1015.67 26354.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L22_res1 -->
<g id="node1176" class="node">
<title>GPT3_2B_S3_R1_L22_res1</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-879.65 26299.11,-879.65 26263.16,-843.65 26402.89,-843.65 26438.84,-879.65"/>
<text text-anchor="middle" x="26351" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L22_ar1&#45;&gt;GPT3_2B_S3_R1_L22_res1 -->
<g id="edge1084" class="edge">
<title>GPT3_2B_S3_R1_L22_ar1&#45;&gt;GPT3_2B_S3_R1_L22_res1</title>
<path fill="none" stroke="black" d="M26351,-951.45C26351,-933.08 26351,-908.53 26351,-889.9"/>
<polygon fill="black" stroke="black" points="26354.5,-889.71 26351,-879.71 26347.5,-889.71 26354.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L22_norm2 -->
<g id="node1177" class="node">
<title>GPT3_2B_S3_R1_L22_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="26351" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="26351" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L22_res1&#45;&gt;GPT3_2B_S3_R1_L22_norm2 -->
<g id="edge1085" class="edge">
<title>GPT3_2B_S3_R1_L22_res1&#45;&gt;GPT3_2B_S3_R1_L22_norm2</title>
<path fill="none" stroke="black" d="M26351,-843.2C26351,-827.06 26351,-802.56 26351,-782.16"/>
<polygon fill="black" stroke="black" points="26354.5,-781.94 26351,-771.94 26347.5,-781.94 26354.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_up -->
<g id="node1178" class="node">
<title>GPT3_2B_S3_R1_L22_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-645.91 26244.5,-645.91 26244.5,-607.91 26457.5,-607.91 26457.5,-645.91"/>
<text text-anchor="middle" x="26351" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="26351" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_norm2&#45;&gt;GPT3_2B_S3_R1_L22_ffn_up -->
<g id="edge1086" class="edge">
<title>GPT3_2B_S3_R1_L22_norm2&#45;&gt;GPT3_2B_S3_R1_L22_ffn_up</title>
<path fill="none" stroke="black" d="M26351,-717.77C26351,-699.51 26351,-675.08 26351,-656.3"/>
<polygon fill="black" stroke="black" points="26354.5,-656.26 26351,-646.26 26347.5,-656.26 26354.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_gate -->
<g id="node1179" class="node">
<title>GPT3_2B_S3_R1_L22_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-535.91 26244.5,-535.91 26244.5,-497.91 26457.5,-497.91 26457.5,-535.91"/>
<text text-anchor="middle" x="26351" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="26351" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_up&#45;&gt;GPT3_2B_S3_R1_L22_ffn_gate -->
<g id="edge1087" class="edge">
<title>GPT3_2B_S3_R1_L22_ffn_up&#45;&gt;GPT3_2B_S3_R1_L22_ffn_gate</title>
<path fill="none" stroke="black" d="M26351,-607.59C26351,-590.73 26351,-565.47 26351,-546.06"/>
<polygon fill="black" stroke="black" points="26354.5,-545.96 26351,-535.96 26347.5,-545.96 26354.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_down -->
<g id="node1180" class="node">
<title>GPT3_2B_S3_R1_L22_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="26457.5,-425.91 26244.5,-425.91 26244.5,-387.91 26457.5,-387.91 26457.5,-425.91"/>
<text text-anchor="middle" x="26351" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="26351" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L22_ffn_down -->
<g id="edge1088" class="edge">
<title>GPT3_2B_S3_R1_L22_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L22_ffn_down</title>
<path fill="none" stroke="black" d="M26351,-497.59C26351,-480.73 26351,-455.47 26351,-436.06"/>
<polygon fill="black" stroke="black" points="26354.5,-435.96 26351,-425.96 26347.5,-435.96 26354.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L22_ar2 -->
<g id="node1181" class="node">
<title>GPT3_2B_S3_R1_L22_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="26351" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26351" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="26351" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L22_ffn_down&#45;&gt;GPT3_2B_S3_R1_L22_ar2 -->
<g id="edge1089" class="edge">
<title>GPT3_2B_S3_R1_L22_ffn_down&#45;&gt;GPT3_2B_S3_R1_L22_ar2</title>
<path fill="none" stroke="black" d="M26351,-387.8C26351,-371.43 26351,-346.84 26351,-326.42"/>
<polygon fill="black" stroke="black" points="26354.5,-326.19 26351,-316.19 26347.5,-326.19 26354.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L22_res2 -->
<g id="node1182" class="node">
<title>GPT3_2B_S3_R1_L22_res2</title>
<polygon fill="lightyellow" stroke="black" points="26438.84,-190.17 26299.11,-190.17 26263.16,-154.17 26402.89,-154.17 26438.84,-190.17"/>
<text text-anchor="middle" x="26351" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L22_ar2&#45;&gt;GPT3_2B_S3_R1_L22_res2 -->
<g id="edge1090" class="edge">
<title>GPT3_2B_S3_R1_L22_ar2&#45;&gt;GPT3_2B_S3_R1_L22_res2</title>
<path fill="none" stroke="black" d="M26351,-261.97C26351,-243.6 26351,-219.05 26351,-200.42"/>
<polygon fill="black" stroke="black" points="26354.5,-200.23 26351,-190.23 26347.5,-200.23 26354.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L23_split -->
<g id="node1183" class="node">
<title>GPT3_2B_S3_R1_L23_split</title>
<polygon fill="orange" stroke="black" points="25909.7,-1499.13 25243.64,-1499.13 25072.3,-1423.13 25738.36,-1423.13 25909.7,-1499.13"/>
<text text-anchor="middle" x="25491" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="25491" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_norm1 -->
<g id="node1184" class="node">
<title>GPT3_2B_S3_R1_L23_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25491" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L23_split&#45;&gt;GPT3_2B_S3_R1_L23_norm1 -->
<g id="edge1091" class="edge">
<title>GPT3_2B_S3_R1_L23_split&#45;&gt;GPT3_2B_S3_R1_L23_norm1</title>
<path fill="none" stroke="black" d="M25491,-1422.92C25491,-1403.71 25491,-1380.37 25491,-1361.33"/>
<polygon fill="black" stroke="black" points="25494.5,-1361.25 25491,-1351.25 25487.5,-1361.25 25494.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R1_L23_qkv -->
<g id="node1185" class="node">
<title>GPT3_2B_S3_R1_L23_qkv</title>
<polygon fill="lightcoral" stroke="black" points="25633,-1225.39 25349,-1225.39 25349,-1187.39 25633,-1187.39 25633,-1225.39"/>
<text text-anchor="middle" x="25491" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="25491" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_norm1&#45;&gt;GPT3_2B_S3_R1_L23_qkv -->
<g id="edge1092" class="edge">
<title>GPT3_2B_S3_R1_L23_norm1&#45;&gt;GPT3_2B_S3_R1_L23_qkv</title>
<path fill="none" stroke="black" d="M25491,-1297.25C25491,-1278.99 25491,-1254.56 25491,-1235.78"/>
<polygon fill="black" stroke="black" points="25494.5,-1235.74 25491,-1225.74 25487.5,-1235.74 25494.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L23_attn -->
<g id="node1186" class="node">
<title>GPT3_2B_S3_R1_L23_attn</title>
<polygon fill="lightcoral" stroke="black" points="25633,-1115.39 25349,-1115.39 25349,-1077.39 25633,-1077.39 25633,-1115.39"/>
<text text-anchor="middle" x="25491" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="25491" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_qkv&#45;&gt;GPT3_2B_S3_R1_L23_attn -->
<g id="edge1093" class="edge">
<title>GPT3_2B_S3_R1_L23_qkv&#45;&gt;GPT3_2B_S3_R1_L23_attn</title>
<path fill="none" stroke="black" d="M25491,-1187.07C25491,-1170.21 25491,-1144.95 25491,-1125.54"/>
<polygon fill="black" stroke="black" points="25494.5,-1125.44 25491,-1115.44 25487.5,-1125.44 25494.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L23_ar1 -->
<g id="node1187" class="node">
<title>GPT3_2B_S3_R1_L23_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="25491" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_attn&#45;&gt;GPT3_2B_S3_R1_L23_ar1 -->
<g id="edge1094" class="edge">
<title>GPT3_2B_S3_R1_L23_attn&#45;&gt;GPT3_2B_S3_R1_L23_ar1</title>
<path fill="none" stroke="black" d="M25491,-1077.28C25491,-1060.91 25491,-1036.32 25491,-1015.9"/>
<polygon fill="black" stroke="black" points="25494.5,-1015.67 25491,-1005.67 25487.5,-1015.67 25494.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R1_L23_res1 -->
<g id="node1188" class="node">
<title>GPT3_2B_S3_R1_L23_res1</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-879.65 25439.11,-879.65 25403.16,-843.65 25542.89,-843.65 25578.84,-879.65"/>
<text text-anchor="middle" x="25491" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L23_ar1&#45;&gt;GPT3_2B_S3_R1_L23_res1 -->
<g id="edge1095" class="edge">
<title>GPT3_2B_S3_R1_L23_ar1&#45;&gt;GPT3_2B_S3_R1_L23_res1</title>
<path fill="none" stroke="black" d="M25491,-951.45C25491,-933.08 25491,-908.53 25491,-889.9"/>
<polygon fill="black" stroke="black" points="25494.5,-889.71 25491,-879.71 25487.5,-889.71 25494.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R1_L23_norm2 -->
<g id="node1189" class="node">
<title>GPT3_2B_S3_R1_L23_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="25491" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="25491" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L23_res1&#45;&gt;GPT3_2B_S3_R1_L23_norm2 -->
<g id="edge1096" class="edge">
<title>GPT3_2B_S3_R1_L23_res1&#45;&gt;GPT3_2B_S3_R1_L23_norm2</title>
<path fill="none" stroke="black" d="M25491,-843.2C25491,-827.06 25491,-802.56 25491,-782.16"/>
<polygon fill="black" stroke="black" points="25494.5,-781.94 25491,-771.94 25487.5,-781.94 25494.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_up -->
<g id="node1190" class="node">
<title>GPT3_2B_S3_R1_L23_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-645.91 25384.5,-645.91 25384.5,-607.91 25597.5,-607.91 25597.5,-645.91"/>
<text text-anchor="middle" x="25491" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="25491" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_norm2&#45;&gt;GPT3_2B_S3_R1_L23_ffn_up -->
<g id="edge1097" class="edge">
<title>GPT3_2B_S3_R1_L23_norm2&#45;&gt;GPT3_2B_S3_R1_L23_ffn_up</title>
<path fill="none" stroke="black" d="M25491,-717.77C25491,-699.51 25491,-675.08 25491,-656.3"/>
<polygon fill="black" stroke="black" points="25494.5,-656.26 25491,-646.26 25487.5,-656.26 25494.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_gate -->
<g id="node1191" class="node">
<title>GPT3_2B_S3_R1_L23_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-535.91 25384.5,-535.91 25384.5,-497.91 25597.5,-497.91 25597.5,-535.91"/>
<text text-anchor="middle" x="25491" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="25491" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_up&#45;&gt;GPT3_2B_S3_R1_L23_ffn_gate -->
<g id="edge1098" class="edge">
<title>GPT3_2B_S3_R1_L23_ffn_up&#45;&gt;GPT3_2B_S3_R1_L23_ffn_gate</title>
<path fill="none" stroke="black" d="M25491,-607.59C25491,-590.73 25491,-565.47 25491,-546.06"/>
<polygon fill="black" stroke="black" points="25494.5,-545.96 25491,-535.96 25487.5,-545.96 25494.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_down -->
<g id="node1192" class="node">
<title>GPT3_2B_S3_R1_L23_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="25597.5,-425.91 25384.5,-425.91 25384.5,-387.91 25597.5,-387.91 25597.5,-425.91"/>
<text text-anchor="middle" x="25491" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="25491" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L23_ffn_down -->
<g id="edge1099" class="edge">
<title>GPT3_2B_S3_R1_L23_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L23_ffn_down</title>
<path fill="none" stroke="black" d="M25491,-497.59C25491,-480.73 25491,-455.47 25491,-436.06"/>
<polygon fill="black" stroke="black" points="25494.5,-435.96 25491,-425.96 25487.5,-435.96 25494.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R1_L23_ar2 -->
<g id="node1193" class="node">
<title>GPT3_2B_S3_R1_L23_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="25491" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25491" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="25491" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L23_ffn_down&#45;&gt;GPT3_2B_S3_R1_L23_ar2 -->
<g id="edge1100" class="edge">
<title>GPT3_2B_S3_R1_L23_ffn_down&#45;&gt;GPT3_2B_S3_R1_L23_ar2</title>
<path fill="none" stroke="black" d="M25491,-387.8C25491,-371.43 25491,-346.84 25491,-326.42"/>
<polygon fill="black" stroke="black" points="25494.5,-326.19 25491,-316.19 25487.5,-326.19 25494.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R1_L23_res2 -->
<g id="node1194" class="node">
<title>GPT3_2B_S3_R1_L23_res2</title>
<polygon fill="lightyellow" stroke="black" points="25578.84,-190.17 25439.11,-190.17 25403.16,-154.17 25542.89,-154.17 25578.84,-190.17"/>
<text text-anchor="middle" x="25491" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L23_ar2&#45;&gt;GPT3_2B_S3_R1_L23_res2 -->
<g id="edge1101" class="edge">
<title>GPT3_2B_S3_R1_L23_ar2&#45;&gt;GPT3_2B_S3_R1_L23_res2</title>
<path fill="none" stroke="black" d="M25491,-261.97C25491,-243.6 25491,-219.05 25491,-200.42"/>
<polygon fill="black" stroke="black" points="25494.5,-200.23 25491,-190.23 25487.5,-200.23 25494.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R1_L24_split -->
<g id="node1195" class="node">
<title>GPT3_2B_S3_R1_L24_split</title>
<polygon fill="orange" stroke="black" points="25049.7,-1499.13 24383.64,-1499.13 24212.3,-1423.13 24878.36,-1423.13 25049.7,-1499.13"/>
<text text-anchor="middle" x="24631" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="24631" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_norm1 -->
<g id="node1196" class="node">
<title>GPT3_2B_S3_R1_L24_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="24592" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24592" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24592" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L24_split&#45;&gt;GPT3_2B_S3_R1_L24_norm1 -->
<g id="edge1102" class="edge">
<title>GPT3_2B_S3_R1_L24_split&#45;&gt;GPT3_2B_S3_R1_L24_norm1</title>
<path fill="none" stroke="black" d="M24620.24,-1422.92C24614.66,-1403.62 24607.87,-1380.16 24602.35,-1361.07"/>
<polygon fill="black" stroke="black" points="24605.65,-1359.88 24599.51,-1351.25 24598.93,-1361.82 24605.65,-1359.88"/>
</g>
<!-- GPT3_2B_S3_R1_L24_qkv -->
<g id="node1197" class="node">
<title>GPT3_2B_S3_R1_L24_qkv</title>
<polygon fill="lightcoral" stroke="black" points="24734,-1225.39 24450,-1225.39 24450,-1187.39 24734,-1187.39 24734,-1225.39"/>
<text text-anchor="middle" x="24592" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="24592" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_norm1&#45;&gt;GPT3_2B_S3_R1_L24_qkv -->
<g id="edge1103" class="edge">
<title>GPT3_2B_S3_R1_L24_norm1&#45;&gt;GPT3_2B_S3_R1_L24_qkv</title>
<path fill="none" stroke="black" d="M24592,-1297.25C24592,-1278.99 24592,-1254.56 24592,-1235.78"/>
<polygon fill="black" stroke="black" points="24595.5,-1235.74 24592,-1225.74 24588.5,-1235.74 24595.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R1_L24_attn -->
<g id="node1198" class="node">
<title>GPT3_2B_S3_R1_L24_attn</title>
<polygon fill="lightcoral" stroke="black" points="24734,-1115.39 24450,-1115.39 24450,-1077.39 24734,-1077.39 24734,-1115.39"/>
<text text-anchor="middle" x="24592" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="24592" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_qkv&#45;&gt;GPT3_2B_S3_R1_L24_attn -->
<g id="edge1104" class="edge">
<title>GPT3_2B_S3_R1_L24_qkv&#45;&gt;GPT3_2B_S3_R1_L24_attn</title>
<path fill="none" stroke="black" d="M24592,-1187.07C24592,-1170.21 24592,-1144.95 24592,-1125.54"/>
<polygon fill="black" stroke="black" points="24595.5,-1125.44 24592,-1115.44 24588.5,-1125.44 24595.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R1_L24_ar1 -->
<g id="node1199" class="node">
<title>GPT3_2B_S3_R1_L24_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24590" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24590" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="24590" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_attn&#45;&gt;GPT3_2B_S3_R1_L24_ar1 -->
<g id="edge1105" class="edge">
<title>GPT3_2B_S3_R1_L24_attn&#45;&gt;GPT3_2B_S3_R1_L24_ar1</title>
<path fill="none" stroke="black" d="M24591.69,-1077.28C24591.4,-1060.91 24590.98,-1036.32 24590.63,-1015.9"/>
<polygon fill="black" stroke="black" points="24594.12,-1015.6 24590.45,-1005.67 24587.12,-1015.73 24594.12,-1015.6"/>
</g>
<!-- GPT3_2B_S3_R1_L24_res1 -->
<g id="node1200" class="node">
<title>GPT3_2B_S3_R1_L24_res1</title>
<polygon fill="lightyellow" stroke="black" points="24676.84,-879.65 24537.11,-879.65 24501.16,-843.65 24640.89,-843.65 24676.84,-879.65"/>
<text text-anchor="middle" x="24589" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R1_L24_ar1&#45;&gt;GPT3_2B_S3_R1_L24_res1 -->
<g id="edge1106" class="edge">
<title>GPT3_2B_S3_R1_L24_ar1&#45;&gt;GPT3_2B_S3_R1_L24_res1</title>
<path fill="none" stroke="black" d="M24589.77,-951.45C24589.61,-933.08 24589.4,-908.53 24589.24,-889.9"/>
<polygon fill="black" stroke="black" points="24592.74,-889.68 24589.15,-879.71 24585.74,-889.74 24592.74,-889.68"/>
</g>
<!-- GPT3_2B_S3_R1_L24_norm2 -->
<g id="node1201" class="node">
<title>GPT3_2B_S3_R1_L24_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="24433" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="24433" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="24433" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_5</text>
</g>
<!-- GPT3_2B_S3_R1_L24_res1&#45;&gt;GPT3_2B_S3_R1_L24_norm2 -->
<g id="edge1107" class="edge">
<title>GPT3_2B_S3_R1_L24_res1&#45;&gt;GPT3_2B_S3_R1_L24_norm2</title>
<path fill="none" stroke="black" d="M24565.65,-843.45C24541.43,-825.62 24503.1,-797.39 24473.85,-775.86"/>
<polygon fill="black" stroke="black" points="24475.61,-772.81 24465.48,-769.7 24471.46,-778.44 24475.61,-772.81"/>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_up -->
<g id="node1202" class="node">
<title>GPT3_2B_S3_R1_L24_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="24461.5,-645.91 24248.5,-645.91 24248.5,-607.91 24461.5,-607.91 24461.5,-645.91"/>
<text text-anchor="middle" x="24355" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="24355" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_norm2&#45;&gt;GPT3_2B_S3_R1_L24_ffn_up -->
<g id="edge1108" class="edge">
<title>GPT3_2B_S3_R1_L24_norm2&#45;&gt;GPT3_2B_S3_R1_L24_ffn_up</title>
<path fill="none" stroke="black" d="M24415.88,-718.35C24403.13,-699.4 24385.75,-673.59 24372.83,-654.4"/>
<polygon fill="black" stroke="black" points="24375.73,-652.43 24367.24,-646.09 24369.92,-656.34 24375.73,-652.43"/>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_gate -->
<g id="node1203" class="node">
<title>GPT3_2B_S3_R1_L24_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="24457.5,-535.91 24244.5,-535.91 24244.5,-497.91 24457.5,-497.91 24457.5,-535.91"/>
<text text-anchor="middle" x="24351" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="24351" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_up&#45;&gt;GPT3_2B_S3_R1_L24_ffn_gate -->
<g id="edge1109" class="edge">
<title>GPT3_2B_S3_R1_L24_ffn_up&#45;&gt;GPT3_2B_S3_R1_L24_ffn_gate</title>
<path fill="none" stroke="black" d="M24354.32,-607.59C24353.7,-590.73 24352.76,-565.47 24352.04,-546.06"/>
<polygon fill="black" stroke="black" points="24355.54,-545.82 24351.67,-535.96 24348.54,-546.08 24355.54,-545.82"/>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_down -->
<g id="node1204" class="node">
<title>GPT3_2B_S3_R1_L24_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="24450.5,-425.91 24237.5,-425.91 24237.5,-387.91 24450.5,-387.91 24450.5,-425.91"/>
<text text-anchor="middle" x="24344" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="24344" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L24_ffn_down -->
<g id="edge1110" class="edge">
<title>GPT3_2B_S3_R1_L24_ffn_gate&#45;&gt;GPT3_2B_S3_R1_L24_ffn_down</title>
<path fill="none" stroke="black" d="M24349.81,-497.59C24348.72,-480.73 24347.08,-455.47 24345.82,-436.06"/>
<polygon fill="black" stroke="black" points="24349.31,-435.71 24345.17,-425.96 24342.32,-436.16 24349.31,-435.71"/>
</g>
<!-- GPT3_2B_S3_R1_L24_ar2 -->
<g id="node1205" class="node">
<title>GPT3_2B_S3_R1_L24_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="24315" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24315" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="24315" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_ffn_down&#45;&gt;GPT3_2B_S3_R1_L24_ar2 -->
<g id="edge1111" class="edge">
<title>GPT3_2B_S3_R1_L24_ffn_down&#45;&gt;GPT3_2B_S3_R1_L24_ar2</title>
<path fill="none" stroke="black" d="M24339.47,-387.8C24335.35,-371.36 24329.16,-346.62 24324.04,-326.14"/>
<polygon fill="black" stroke="black" points="24327.37,-325.04 24321.54,-316.19 24320.58,-326.74 24327.37,-325.04"/>
</g>
<!-- GPT3_2B_S3_R1_L24_res2 -->
<g id="node1206" class="node">
<title>GPT3_2B_S3_R1_L24_res2</title>
<polygon fill="lightyellow" stroke="black" points="24388.84,-190.17 24249.11,-190.17 24213.16,-154.17 24352.89,-154.17 24388.84,-190.17"/>
<text text-anchor="middle" x="24301" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R1_L24_ar2&#45;&gt;GPT3_2B_S3_R1_L24_res2 -->
<g id="edge1112" class="edge">
<title>GPT3_2B_S3_R1_L24_ar2&#45;&gt;GPT3_2B_S3_R1_L24_res2</title>
<path fill="none" stroke="black" d="M24311.82,-261.97C24309.57,-243.52 24306.56,-218.82 24304.29,-200.16"/>
<polygon fill="black" stroke="black" points="24307.76,-199.73 24303.08,-190.23 24300.82,-200.58 24307.76,-199.73"/>
</g>
<!-- GPT3_2B_output -->
<g id="node1306" class="node">
<title>GPT3_2B_output</title>
<polygon fill="lightgreen" stroke="black" points="21548.79,-37.01 21548.79,-61.16 21420.63,-78.24 21239.37,-78.24 21111.21,-61.16 21111.21,-37.01 21239.37,-19.93 21420.63,-19.93 21548.79,-37.01"/>
<polygon fill="none" stroke="black" points="21552.79,-33.49 21552.79,-64.67 21420.89,-82.25 21239.11,-82.25 21107.21,-64.67 21107.21,-33.49 21239.11,-15.92 21420.89,-15.92 21552.79,-33.49"/>
<text text-anchor="middle" x="21330" y="-52.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="21330" y="-37.88" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, vocab=50257]</text>
</g>
<!-- GPT3_2B_S3_R1_L24_res2&#45;&gt;GPT3_2B_output -->
<g id="edge1211" class="edge">
<title>GPT3_2B_S3_R1_L24_res2&#45;&gt;GPT3_2B_output</title>
<path fill="none" stroke="black" d="M24267.72,-153.97C24248.72,-145.07 24224.13,-135.06 24201,-130.17 23946.68,-76.36 22201.7,-57.08 21563.31,-51.77"/>
<polygon fill="black" stroke="black" points="21563.09,-48.27 21553.06,-51.69 21563.03,-55.27 21563.09,-48.27"/>
</g>
<!-- GPT3_2B_S3_R2_L17_split -->
<g id="node1207" class="node">
<title>GPT3_2B_S3_R2_L17_split</title>
<polygon fill="orange" stroke="black" points="24187.7,-1499.13 23521.64,-1499.13 23350.3,-1423.13 24016.36,-1423.13 24187.7,-1499.13"/>
<text text-anchor="middle" x="23769" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="23769" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_norm1 -->
<g id="node1208" class="node">
<title>GPT3_2B_S3_R2_L17_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23769" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L17_split&#45;&gt;GPT3_2B_S3_R2_L17_norm1 -->
<g id="edge1113" class="edge">
<title>GPT3_2B_S3_R2_L17_split&#45;&gt;GPT3_2B_S3_R2_L17_norm1</title>
<path fill="none" stroke="black" d="M23769,-1422.92C23769,-1403.71 23769,-1380.37 23769,-1361.33"/>
<polygon fill="black" stroke="black" points="23772.5,-1361.25 23769,-1351.25 23765.5,-1361.25 23772.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L17_qkv -->
<g id="node1209" class="node">
<title>GPT3_2B_S3_R2_L17_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23911,-1225.39 23627,-1225.39 23627,-1187.39 23911,-1187.39 23911,-1225.39"/>
<text text-anchor="middle" x="23769" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="23769" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_norm1&#45;&gt;GPT3_2B_S3_R2_L17_qkv -->
<g id="edge1114" class="edge">
<title>GPT3_2B_S3_R2_L17_norm1&#45;&gt;GPT3_2B_S3_R2_L17_qkv</title>
<path fill="none" stroke="black" d="M23769,-1297.25C23769,-1278.99 23769,-1254.56 23769,-1235.78"/>
<polygon fill="black" stroke="black" points="23772.5,-1235.74 23769,-1225.74 23765.5,-1235.74 23772.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L17_attn -->
<g id="node1210" class="node">
<title>GPT3_2B_S3_R2_L17_attn</title>
<polygon fill="lightcoral" stroke="black" points="23911,-1115.39 23627,-1115.39 23627,-1077.39 23911,-1077.39 23911,-1115.39"/>
<text text-anchor="middle" x="23769" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="23769" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_qkv&#45;&gt;GPT3_2B_S3_R2_L17_attn -->
<g id="edge1115" class="edge">
<title>GPT3_2B_S3_R2_L17_qkv&#45;&gt;GPT3_2B_S3_R2_L17_attn</title>
<path fill="none" stroke="black" d="M23769,-1187.07C23769,-1170.21 23769,-1144.95 23769,-1125.54"/>
<polygon fill="black" stroke="black" points="23772.5,-1125.44 23769,-1115.44 23765.5,-1125.44 23772.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L17_ar1 -->
<g id="node1211" class="node">
<title>GPT3_2B_S3_R2_L17_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23769" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_attn&#45;&gt;GPT3_2B_S3_R2_L17_ar1 -->
<g id="edge1116" class="edge">
<title>GPT3_2B_S3_R2_L17_attn&#45;&gt;GPT3_2B_S3_R2_L17_ar1</title>
<path fill="none" stroke="black" d="M23769,-1077.28C23769,-1060.91 23769,-1036.32 23769,-1015.9"/>
<polygon fill="black" stroke="black" points="23772.5,-1015.67 23769,-1005.67 23765.5,-1015.67 23772.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L17_res1 -->
<g id="node1212" class="node">
<title>GPT3_2B_S3_R2_L17_res1</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-879.65 23717.11,-879.65 23681.16,-843.65 23820.89,-843.65 23856.84,-879.65"/>
<text text-anchor="middle" x="23769" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L17_ar1&#45;&gt;GPT3_2B_S3_R2_L17_res1 -->
<g id="edge1117" class="edge">
<title>GPT3_2B_S3_R2_L17_ar1&#45;&gt;GPT3_2B_S3_R2_L17_res1</title>
<path fill="none" stroke="black" d="M23769,-951.45C23769,-933.08 23769,-908.53 23769,-889.9"/>
<polygon fill="black" stroke="black" points="23772.5,-889.71 23769,-879.71 23765.5,-889.71 23772.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L17_norm2 -->
<g id="node1213" class="node">
<title>GPT3_2B_S3_R2_L17_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="23769" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="23769" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L17_res1&#45;&gt;GPT3_2B_S3_R2_L17_norm2 -->
<g id="edge1118" class="edge">
<title>GPT3_2B_S3_R2_L17_res1&#45;&gt;GPT3_2B_S3_R2_L17_norm2</title>
<path fill="none" stroke="black" d="M23769,-843.2C23769,-827.06 23769,-802.56 23769,-782.16"/>
<polygon fill="black" stroke="black" points="23772.5,-781.94 23769,-771.94 23765.5,-781.94 23772.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_up -->
<g id="node1214" class="node">
<title>GPT3_2B_S3_R2_L17_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-645.91 23662.5,-645.91 23662.5,-607.91 23875.5,-607.91 23875.5,-645.91"/>
<text text-anchor="middle" x="23769" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="23769" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_norm2&#45;&gt;GPT3_2B_S3_R2_L17_ffn_up -->
<g id="edge1119" class="edge">
<title>GPT3_2B_S3_R2_L17_norm2&#45;&gt;GPT3_2B_S3_R2_L17_ffn_up</title>
<path fill="none" stroke="black" d="M23769,-717.77C23769,-699.51 23769,-675.08 23769,-656.3"/>
<polygon fill="black" stroke="black" points="23772.5,-656.26 23769,-646.26 23765.5,-656.26 23772.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_gate -->
<g id="node1215" class="node">
<title>GPT3_2B_S3_R2_L17_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-535.91 23662.5,-535.91 23662.5,-497.91 23875.5,-497.91 23875.5,-535.91"/>
<text text-anchor="middle" x="23769" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="23769" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_up&#45;&gt;GPT3_2B_S3_R2_L17_ffn_gate -->
<g id="edge1120" class="edge">
<title>GPT3_2B_S3_R2_L17_ffn_up&#45;&gt;GPT3_2B_S3_R2_L17_ffn_gate</title>
<path fill="none" stroke="black" d="M23769,-607.59C23769,-590.73 23769,-565.47 23769,-546.06"/>
<polygon fill="black" stroke="black" points="23772.5,-545.96 23769,-535.96 23765.5,-545.96 23772.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_down -->
<g id="node1216" class="node">
<title>GPT3_2B_S3_R2_L17_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23875.5,-425.91 23662.5,-425.91 23662.5,-387.91 23875.5,-387.91 23875.5,-425.91"/>
<text text-anchor="middle" x="23769" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="23769" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L17_ffn_down -->
<g id="edge1121" class="edge">
<title>GPT3_2B_S3_R2_L17_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L17_ffn_down</title>
<path fill="none" stroke="black" d="M23769,-497.59C23769,-480.73 23769,-455.47 23769,-436.06"/>
<polygon fill="black" stroke="black" points="23772.5,-435.96 23769,-425.96 23765.5,-435.96 23772.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L17_ar2 -->
<g id="node1217" class="node">
<title>GPT3_2B_S3_R2_L17_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="23769" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23769" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="23769" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L17_ffn_down&#45;&gt;GPT3_2B_S3_R2_L17_ar2 -->
<g id="edge1122" class="edge">
<title>GPT3_2B_S3_R2_L17_ffn_down&#45;&gt;GPT3_2B_S3_R2_L17_ar2</title>
<path fill="none" stroke="black" d="M23769,-387.8C23769,-371.43 23769,-346.84 23769,-326.42"/>
<polygon fill="black" stroke="black" points="23772.5,-326.19 23769,-316.19 23765.5,-326.19 23772.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L17_res2 -->
<g id="node1218" class="node">
<title>GPT3_2B_S3_R2_L17_res2</title>
<polygon fill="lightyellow" stroke="black" points="23856.84,-190.17 23717.11,-190.17 23681.16,-154.17 23820.89,-154.17 23856.84,-190.17"/>
<text text-anchor="middle" x="23769" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L17_ar2&#45;&gt;GPT3_2B_S3_R2_L17_res2 -->
<g id="edge1123" class="edge">
<title>GPT3_2B_S3_R2_L17_ar2&#45;&gt;GPT3_2B_S3_R2_L17_res2</title>
<path fill="none" stroke="black" d="M23769,-261.97C23769,-243.6 23769,-219.05 23769,-200.42"/>
<polygon fill="black" stroke="black" points="23772.5,-200.23 23769,-190.23 23765.5,-200.23 23772.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L18_split -->
<g id="node1219" class="node">
<title>GPT3_2B_S3_R2_L18_split</title>
<polygon fill="orange" stroke="black" points="23327.7,-1499.13 22661.64,-1499.13 22490.3,-1423.13 23156.36,-1423.13 23327.7,-1499.13"/>
<text text-anchor="middle" x="22909" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22909" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_norm1 -->
<g id="node1220" class="node">
<title>GPT3_2B_S3_R2_L18_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22909" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L18_split&#45;&gt;GPT3_2B_S3_R2_L18_norm1 -->
<g id="edge1124" class="edge">
<title>GPT3_2B_S3_R2_L18_split&#45;&gt;GPT3_2B_S3_R2_L18_norm1</title>
<path fill="none" stroke="black" d="M22909,-1422.92C22909,-1403.71 22909,-1380.37 22909,-1361.33"/>
<polygon fill="black" stroke="black" points="22912.5,-1361.25 22909,-1351.25 22905.5,-1361.25 22912.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L18_qkv -->
<g id="node1221" class="node">
<title>GPT3_2B_S3_R2_L18_qkv</title>
<polygon fill="lightcoral" stroke="black" points="23051,-1225.39 22767,-1225.39 22767,-1187.39 23051,-1187.39 23051,-1225.39"/>
<text text-anchor="middle" x="22909" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22909" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_norm1&#45;&gt;GPT3_2B_S3_R2_L18_qkv -->
<g id="edge1125" class="edge">
<title>GPT3_2B_S3_R2_L18_norm1&#45;&gt;GPT3_2B_S3_R2_L18_qkv</title>
<path fill="none" stroke="black" d="M22909,-1297.25C22909,-1278.99 22909,-1254.56 22909,-1235.78"/>
<polygon fill="black" stroke="black" points="22912.5,-1235.74 22909,-1225.74 22905.5,-1235.74 22912.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L18_attn -->
<g id="node1222" class="node">
<title>GPT3_2B_S3_R2_L18_attn</title>
<polygon fill="lightcoral" stroke="black" points="23051,-1115.39 22767,-1115.39 22767,-1077.39 23051,-1077.39 23051,-1115.39"/>
<text text-anchor="middle" x="22909" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22909" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_qkv&#45;&gt;GPT3_2B_S3_R2_L18_attn -->
<g id="edge1126" class="edge">
<title>GPT3_2B_S3_R2_L18_qkv&#45;&gt;GPT3_2B_S3_R2_L18_attn</title>
<path fill="none" stroke="black" d="M22909,-1187.07C22909,-1170.21 22909,-1144.95 22909,-1125.54"/>
<polygon fill="black" stroke="black" points="22912.5,-1125.44 22909,-1115.44 22905.5,-1125.44 22912.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L18_ar1 -->
<g id="node1223" class="node">
<title>GPT3_2B_S3_R2_L18_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22909" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_attn&#45;&gt;GPT3_2B_S3_R2_L18_ar1 -->
<g id="edge1127" class="edge">
<title>GPT3_2B_S3_R2_L18_attn&#45;&gt;GPT3_2B_S3_R2_L18_ar1</title>
<path fill="none" stroke="black" d="M22909,-1077.28C22909,-1060.91 22909,-1036.32 22909,-1015.9"/>
<polygon fill="black" stroke="black" points="22912.5,-1015.67 22909,-1005.67 22905.5,-1015.67 22912.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L18_res1 -->
<g id="node1224" class="node">
<title>GPT3_2B_S3_R2_L18_res1</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-879.65 22857.11,-879.65 22821.16,-843.65 22960.89,-843.65 22996.84,-879.65"/>
<text text-anchor="middle" x="22909" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L18_ar1&#45;&gt;GPT3_2B_S3_R2_L18_res1 -->
<g id="edge1128" class="edge">
<title>GPT3_2B_S3_R2_L18_ar1&#45;&gt;GPT3_2B_S3_R2_L18_res1</title>
<path fill="none" stroke="black" d="M22909,-951.45C22909,-933.08 22909,-908.53 22909,-889.9"/>
<polygon fill="black" stroke="black" points="22912.5,-889.71 22909,-879.71 22905.5,-889.71 22912.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L18_norm2 -->
<g id="node1225" class="node">
<title>GPT3_2B_S3_R2_L18_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22909" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22909" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L18_res1&#45;&gt;GPT3_2B_S3_R2_L18_norm2 -->
<g id="edge1129" class="edge">
<title>GPT3_2B_S3_R2_L18_res1&#45;&gt;GPT3_2B_S3_R2_L18_norm2</title>
<path fill="none" stroke="black" d="M22909,-843.2C22909,-827.06 22909,-802.56 22909,-782.16"/>
<polygon fill="black" stroke="black" points="22912.5,-781.94 22909,-771.94 22905.5,-781.94 22912.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_up -->
<g id="node1226" class="node">
<title>GPT3_2B_S3_R2_L18_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-645.91 22802.5,-645.91 22802.5,-607.91 23015.5,-607.91 23015.5,-645.91"/>
<text text-anchor="middle" x="22909" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22909" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_norm2&#45;&gt;GPT3_2B_S3_R2_L18_ffn_up -->
<g id="edge1130" class="edge">
<title>GPT3_2B_S3_R2_L18_norm2&#45;&gt;GPT3_2B_S3_R2_L18_ffn_up</title>
<path fill="none" stroke="black" d="M22909,-717.77C22909,-699.51 22909,-675.08 22909,-656.3"/>
<polygon fill="black" stroke="black" points="22912.5,-656.26 22909,-646.26 22905.5,-656.26 22912.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_gate -->
<g id="node1227" class="node">
<title>GPT3_2B_S3_R2_L18_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-535.91 22802.5,-535.91 22802.5,-497.91 23015.5,-497.91 23015.5,-535.91"/>
<text text-anchor="middle" x="22909" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22909" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_up&#45;&gt;GPT3_2B_S3_R2_L18_ffn_gate -->
<g id="edge1131" class="edge">
<title>GPT3_2B_S3_R2_L18_ffn_up&#45;&gt;GPT3_2B_S3_R2_L18_ffn_gate</title>
<path fill="none" stroke="black" d="M22909,-607.59C22909,-590.73 22909,-565.47 22909,-546.06"/>
<polygon fill="black" stroke="black" points="22912.5,-545.96 22909,-535.96 22905.5,-545.96 22912.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_down -->
<g id="node1228" class="node">
<title>GPT3_2B_S3_R2_L18_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="23015.5,-425.91 22802.5,-425.91 22802.5,-387.91 23015.5,-387.91 23015.5,-425.91"/>
<text text-anchor="middle" x="22909" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22909" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L18_ffn_down -->
<g id="edge1132" class="edge">
<title>GPT3_2B_S3_R2_L18_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L18_ffn_down</title>
<path fill="none" stroke="black" d="M22909,-497.59C22909,-480.73 22909,-455.47 22909,-436.06"/>
<polygon fill="black" stroke="black" points="22912.5,-435.96 22909,-425.96 22905.5,-435.96 22912.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L18_ar2 -->
<g id="node1229" class="node">
<title>GPT3_2B_S3_R2_L18_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22909" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22909" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22909" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L18_ffn_down&#45;&gt;GPT3_2B_S3_R2_L18_ar2 -->
<g id="edge1133" class="edge">
<title>GPT3_2B_S3_R2_L18_ffn_down&#45;&gt;GPT3_2B_S3_R2_L18_ar2</title>
<path fill="none" stroke="black" d="M22909,-387.8C22909,-371.43 22909,-346.84 22909,-326.42"/>
<polygon fill="black" stroke="black" points="22912.5,-326.19 22909,-316.19 22905.5,-326.19 22912.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L18_res2 -->
<g id="node1230" class="node">
<title>GPT3_2B_S3_R2_L18_res2</title>
<polygon fill="lightyellow" stroke="black" points="22996.84,-190.17 22857.11,-190.17 22821.16,-154.17 22960.89,-154.17 22996.84,-190.17"/>
<text text-anchor="middle" x="22909" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L18_ar2&#45;&gt;GPT3_2B_S3_R2_L18_res2 -->
<g id="edge1134" class="edge">
<title>GPT3_2B_S3_R2_L18_ar2&#45;&gt;GPT3_2B_S3_R2_L18_res2</title>
<path fill="none" stroke="black" d="M22909,-261.97C22909,-243.6 22909,-219.05 22909,-200.42"/>
<polygon fill="black" stroke="black" points="22912.5,-200.23 22909,-190.23 22905.5,-200.23 22912.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L19_split -->
<g id="node1231" class="node">
<title>GPT3_2B_S3_R2_L19_split</title>
<polygon fill="orange" stroke="black" points="22467.7,-1499.13 21801.64,-1499.13 21630.3,-1423.13 22296.36,-1423.13 22467.7,-1499.13"/>
<text text-anchor="middle" x="22049" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="22049" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_norm1 -->
<g id="node1232" class="node">
<title>GPT3_2B_S3_R2_L19_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22049" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L19_split&#45;&gt;GPT3_2B_S3_R2_L19_norm1 -->
<g id="edge1135" class="edge">
<title>GPT3_2B_S3_R2_L19_split&#45;&gt;GPT3_2B_S3_R2_L19_norm1</title>
<path fill="none" stroke="black" d="M22049,-1422.92C22049,-1403.71 22049,-1380.37 22049,-1361.33"/>
<polygon fill="black" stroke="black" points="22052.5,-1361.25 22049,-1351.25 22045.5,-1361.25 22052.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L19_qkv -->
<g id="node1233" class="node">
<title>GPT3_2B_S3_R2_L19_qkv</title>
<polygon fill="lightcoral" stroke="black" points="22191,-1225.39 21907,-1225.39 21907,-1187.39 22191,-1187.39 22191,-1225.39"/>
<text text-anchor="middle" x="22049" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="22049" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_norm1&#45;&gt;GPT3_2B_S3_R2_L19_qkv -->
<g id="edge1136" class="edge">
<title>GPT3_2B_S3_R2_L19_norm1&#45;&gt;GPT3_2B_S3_R2_L19_qkv</title>
<path fill="none" stroke="black" d="M22049,-1297.25C22049,-1278.99 22049,-1254.56 22049,-1235.78"/>
<polygon fill="black" stroke="black" points="22052.5,-1235.74 22049,-1225.74 22045.5,-1235.74 22052.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L19_attn -->
<g id="node1234" class="node">
<title>GPT3_2B_S3_R2_L19_attn</title>
<polygon fill="lightcoral" stroke="black" points="22191,-1115.39 21907,-1115.39 21907,-1077.39 22191,-1077.39 22191,-1115.39"/>
<text text-anchor="middle" x="22049" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="22049" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_qkv&#45;&gt;GPT3_2B_S3_R2_L19_attn -->
<g id="edge1137" class="edge">
<title>GPT3_2B_S3_R2_L19_qkv&#45;&gt;GPT3_2B_S3_R2_L19_attn</title>
<path fill="none" stroke="black" d="M22049,-1187.07C22049,-1170.21 22049,-1144.95 22049,-1125.54"/>
<polygon fill="black" stroke="black" points="22052.5,-1125.44 22049,-1115.44 22045.5,-1125.44 22052.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L19_ar1 -->
<g id="node1235" class="node">
<title>GPT3_2B_S3_R2_L19_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22049" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_attn&#45;&gt;GPT3_2B_S3_R2_L19_ar1 -->
<g id="edge1138" class="edge">
<title>GPT3_2B_S3_R2_L19_attn&#45;&gt;GPT3_2B_S3_R2_L19_ar1</title>
<path fill="none" stroke="black" d="M22049,-1077.28C22049,-1060.91 22049,-1036.32 22049,-1015.9"/>
<polygon fill="black" stroke="black" points="22052.5,-1015.67 22049,-1005.67 22045.5,-1015.67 22052.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L19_res1 -->
<g id="node1236" class="node">
<title>GPT3_2B_S3_R2_L19_res1</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-879.65 21997.11,-879.65 21961.16,-843.65 22100.89,-843.65 22136.84,-879.65"/>
<text text-anchor="middle" x="22049" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L19_ar1&#45;&gt;GPT3_2B_S3_R2_L19_res1 -->
<g id="edge1139" class="edge">
<title>GPT3_2B_S3_R2_L19_ar1&#45;&gt;GPT3_2B_S3_R2_L19_res1</title>
<path fill="none" stroke="black" d="M22049,-951.45C22049,-933.08 22049,-908.53 22049,-889.9"/>
<polygon fill="black" stroke="black" points="22052.5,-889.71 22049,-879.71 22045.5,-889.71 22052.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L19_norm2 -->
<g id="node1237" class="node">
<title>GPT3_2B_S3_R2_L19_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="22049" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="22049" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L19_res1&#45;&gt;GPT3_2B_S3_R2_L19_norm2 -->
<g id="edge1140" class="edge">
<title>GPT3_2B_S3_R2_L19_res1&#45;&gt;GPT3_2B_S3_R2_L19_norm2</title>
<path fill="none" stroke="black" d="M22049,-843.2C22049,-827.06 22049,-802.56 22049,-782.16"/>
<polygon fill="black" stroke="black" points="22052.5,-781.94 22049,-771.94 22045.5,-781.94 22052.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_up -->
<g id="node1238" class="node">
<title>GPT3_2B_S3_R2_L19_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-645.91 21942.5,-645.91 21942.5,-607.91 22155.5,-607.91 22155.5,-645.91"/>
<text text-anchor="middle" x="22049" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="22049" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_norm2&#45;&gt;GPT3_2B_S3_R2_L19_ffn_up -->
<g id="edge1141" class="edge">
<title>GPT3_2B_S3_R2_L19_norm2&#45;&gt;GPT3_2B_S3_R2_L19_ffn_up</title>
<path fill="none" stroke="black" d="M22049,-717.77C22049,-699.51 22049,-675.08 22049,-656.3"/>
<polygon fill="black" stroke="black" points="22052.5,-656.26 22049,-646.26 22045.5,-656.26 22052.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_gate -->
<g id="node1239" class="node">
<title>GPT3_2B_S3_R2_L19_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-535.91 21942.5,-535.91 21942.5,-497.91 22155.5,-497.91 22155.5,-535.91"/>
<text text-anchor="middle" x="22049" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="22049" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_up&#45;&gt;GPT3_2B_S3_R2_L19_ffn_gate -->
<g id="edge1142" class="edge">
<title>GPT3_2B_S3_R2_L19_ffn_up&#45;&gt;GPT3_2B_S3_R2_L19_ffn_gate</title>
<path fill="none" stroke="black" d="M22049,-607.59C22049,-590.73 22049,-565.47 22049,-546.06"/>
<polygon fill="black" stroke="black" points="22052.5,-545.96 22049,-535.96 22045.5,-545.96 22052.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_down -->
<g id="node1240" class="node">
<title>GPT3_2B_S3_R2_L19_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="22155.5,-425.91 21942.5,-425.91 21942.5,-387.91 22155.5,-387.91 22155.5,-425.91"/>
<text text-anchor="middle" x="22049" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="22049" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L19_ffn_down -->
<g id="edge1143" class="edge">
<title>GPT3_2B_S3_R2_L19_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L19_ffn_down</title>
<path fill="none" stroke="black" d="M22049,-497.59C22049,-480.73 22049,-455.47 22049,-436.06"/>
<polygon fill="black" stroke="black" points="22052.5,-435.96 22049,-425.96 22045.5,-435.96 22052.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L19_ar2 -->
<g id="node1241" class="node">
<title>GPT3_2B_S3_R2_L19_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="22049" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22049" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="22049" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L19_ffn_down&#45;&gt;GPT3_2B_S3_R2_L19_ar2 -->
<g id="edge1144" class="edge">
<title>GPT3_2B_S3_R2_L19_ffn_down&#45;&gt;GPT3_2B_S3_R2_L19_ar2</title>
<path fill="none" stroke="black" d="M22049,-387.8C22049,-371.43 22049,-346.84 22049,-326.42"/>
<polygon fill="black" stroke="black" points="22052.5,-326.19 22049,-316.19 22045.5,-326.19 22052.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L19_res2 -->
<g id="node1242" class="node">
<title>GPT3_2B_S3_R2_L19_res2</title>
<polygon fill="lightyellow" stroke="black" points="22136.84,-190.17 21997.11,-190.17 21961.16,-154.17 22100.89,-154.17 22136.84,-190.17"/>
<text text-anchor="middle" x="22049" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L19_ar2&#45;&gt;GPT3_2B_S3_R2_L19_res2 -->
<g id="edge1145" class="edge">
<title>GPT3_2B_S3_R2_L19_ar2&#45;&gt;GPT3_2B_S3_R2_L19_res2</title>
<path fill="none" stroke="black" d="M22049,-261.97C22049,-243.6 22049,-219.05 22049,-200.42"/>
<polygon fill="black" stroke="black" points="22052.5,-200.23 22049,-190.23 22045.5,-200.23 22052.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L20_split -->
<g id="node1243" class="node">
<title>GPT3_2B_S3_R2_L20_split</title>
<polygon fill="orange" stroke="black" points="21607.7,-1499.13 20941.64,-1499.13 20770.3,-1423.13 21436.36,-1423.13 21607.7,-1499.13"/>
<text text-anchor="middle" x="21189" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="21189" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_norm1 -->
<g id="node1244" class="node">
<title>GPT3_2B_S3_R2_L20_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21189" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L20_split&#45;&gt;GPT3_2B_S3_R2_L20_norm1 -->
<g id="edge1146" class="edge">
<title>GPT3_2B_S3_R2_L20_split&#45;&gt;GPT3_2B_S3_R2_L20_norm1</title>
<path fill="none" stroke="black" d="M21189,-1422.92C21189,-1403.71 21189,-1380.37 21189,-1361.33"/>
<polygon fill="black" stroke="black" points="21192.5,-1361.25 21189,-1351.25 21185.5,-1361.25 21192.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L20_qkv -->
<g id="node1245" class="node">
<title>GPT3_2B_S3_R2_L20_qkv</title>
<polygon fill="lightcoral" stroke="black" points="21331,-1225.39 21047,-1225.39 21047,-1187.39 21331,-1187.39 21331,-1225.39"/>
<text text-anchor="middle" x="21189" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="21189" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_norm1&#45;&gt;GPT3_2B_S3_R2_L20_qkv -->
<g id="edge1147" class="edge">
<title>GPT3_2B_S3_R2_L20_norm1&#45;&gt;GPT3_2B_S3_R2_L20_qkv</title>
<path fill="none" stroke="black" d="M21189,-1297.25C21189,-1278.99 21189,-1254.56 21189,-1235.78"/>
<polygon fill="black" stroke="black" points="21192.5,-1235.74 21189,-1225.74 21185.5,-1235.74 21192.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L20_attn -->
<g id="node1246" class="node">
<title>GPT3_2B_S3_R2_L20_attn</title>
<polygon fill="lightcoral" stroke="black" points="21331,-1115.39 21047,-1115.39 21047,-1077.39 21331,-1077.39 21331,-1115.39"/>
<text text-anchor="middle" x="21189" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="21189" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_qkv&#45;&gt;GPT3_2B_S3_R2_L20_attn -->
<g id="edge1148" class="edge">
<title>GPT3_2B_S3_R2_L20_qkv&#45;&gt;GPT3_2B_S3_R2_L20_attn</title>
<path fill="none" stroke="black" d="M21189,-1187.07C21189,-1170.21 21189,-1144.95 21189,-1125.54"/>
<polygon fill="black" stroke="black" points="21192.5,-1125.44 21189,-1115.44 21185.5,-1125.44 21192.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L20_ar1 -->
<g id="node1247" class="node">
<title>GPT3_2B_S3_R2_L20_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="21189" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_attn&#45;&gt;GPT3_2B_S3_R2_L20_ar1 -->
<g id="edge1149" class="edge">
<title>GPT3_2B_S3_R2_L20_attn&#45;&gt;GPT3_2B_S3_R2_L20_ar1</title>
<path fill="none" stroke="black" d="M21189,-1077.28C21189,-1060.91 21189,-1036.32 21189,-1015.9"/>
<polygon fill="black" stroke="black" points="21192.5,-1015.67 21189,-1005.67 21185.5,-1015.67 21192.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L20_res1 -->
<g id="node1248" class="node">
<title>GPT3_2B_S3_R2_L20_res1</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-879.65 21137.11,-879.65 21101.16,-843.65 21240.89,-843.65 21276.84,-879.65"/>
<text text-anchor="middle" x="21189" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L20_ar1&#45;&gt;GPT3_2B_S3_R2_L20_res1 -->
<g id="edge1150" class="edge">
<title>GPT3_2B_S3_R2_L20_ar1&#45;&gt;GPT3_2B_S3_R2_L20_res1</title>
<path fill="none" stroke="black" d="M21189,-951.45C21189,-933.08 21189,-908.53 21189,-889.9"/>
<polygon fill="black" stroke="black" points="21192.5,-889.71 21189,-879.71 21185.5,-889.71 21192.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L20_norm2 -->
<g id="node1249" class="node">
<title>GPT3_2B_S3_R2_L20_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="21189" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="21189" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L20_res1&#45;&gt;GPT3_2B_S3_R2_L20_norm2 -->
<g id="edge1151" class="edge">
<title>GPT3_2B_S3_R2_L20_res1&#45;&gt;GPT3_2B_S3_R2_L20_norm2</title>
<path fill="none" stroke="black" d="M21189,-843.2C21189,-827.06 21189,-802.56 21189,-782.16"/>
<polygon fill="black" stroke="black" points="21192.5,-781.94 21189,-771.94 21185.5,-781.94 21192.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_up -->
<g id="node1250" class="node">
<title>GPT3_2B_S3_R2_L20_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-645.91 21082.5,-645.91 21082.5,-607.91 21295.5,-607.91 21295.5,-645.91"/>
<text text-anchor="middle" x="21189" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="21189" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_norm2&#45;&gt;GPT3_2B_S3_R2_L20_ffn_up -->
<g id="edge1152" class="edge">
<title>GPT3_2B_S3_R2_L20_norm2&#45;&gt;GPT3_2B_S3_R2_L20_ffn_up</title>
<path fill="none" stroke="black" d="M21189,-717.77C21189,-699.51 21189,-675.08 21189,-656.3"/>
<polygon fill="black" stroke="black" points="21192.5,-656.26 21189,-646.26 21185.5,-656.26 21192.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_gate -->
<g id="node1251" class="node">
<title>GPT3_2B_S3_R2_L20_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-535.91 21082.5,-535.91 21082.5,-497.91 21295.5,-497.91 21295.5,-535.91"/>
<text text-anchor="middle" x="21189" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="21189" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_up&#45;&gt;GPT3_2B_S3_R2_L20_ffn_gate -->
<g id="edge1153" class="edge">
<title>GPT3_2B_S3_R2_L20_ffn_up&#45;&gt;GPT3_2B_S3_R2_L20_ffn_gate</title>
<path fill="none" stroke="black" d="M21189,-607.59C21189,-590.73 21189,-565.47 21189,-546.06"/>
<polygon fill="black" stroke="black" points="21192.5,-545.96 21189,-535.96 21185.5,-545.96 21192.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_down -->
<g id="node1252" class="node">
<title>GPT3_2B_S3_R2_L20_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="21295.5,-425.91 21082.5,-425.91 21082.5,-387.91 21295.5,-387.91 21295.5,-425.91"/>
<text text-anchor="middle" x="21189" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="21189" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L20_ffn_down -->
<g id="edge1154" class="edge">
<title>GPT3_2B_S3_R2_L20_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L20_ffn_down</title>
<path fill="none" stroke="black" d="M21189,-497.59C21189,-480.73 21189,-455.47 21189,-436.06"/>
<polygon fill="black" stroke="black" points="21192.5,-435.96 21189,-425.96 21185.5,-435.96 21192.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L20_ar2 -->
<g id="node1253" class="node">
<title>GPT3_2B_S3_R2_L20_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="21189" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21189" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="21189" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L20_ffn_down&#45;&gt;GPT3_2B_S3_R2_L20_ar2 -->
<g id="edge1155" class="edge">
<title>GPT3_2B_S3_R2_L20_ffn_down&#45;&gt;GPT3_2B_S3_R2_L20_ar2</title>
<path fill="none" stroke="black" d="M21189,-387.8C21189,-371.43 21189,-346.84 21189,-326.42"/>
<polygon fill="black" stroke="black" points="21192.5,-326.19 21189,-316.19 21185.5,-326.19 21192.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L20_res2 -->
<g id="node1254" class="node">
<title>GPT3_2B_S3_R2_L20_res2</title>
<polygon fill="lightyellow" stroke="black" points="21276.84,-190.17 21137.11,-190.17 21101.16,-154.17 21240.89,-154.17 21276.84,-190.17"/>
<text text-anchor="middle" x="21189" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L20_ar2&#45;&gt;GPT3_2B_S3_R2_L20_res2 -->
<g id="edge1156" class="edge">
<title>GPT3_2B_S3_R2_L20_ar2&#45;&gt;GPT3_2B_S3_R2_L20_res2</title>
<path fill="none" stroke="black" d="M21189,-261.97C21189,-243.6 21189,-219.05 21189,-200.42"/>
<polygon fill="black" stroke="black" points="21192.5,-200.23 21189,-190.23 21185.5,-200.23 21192.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L21_split -->
<g id="node1255" class="node">
<title>GPT3_2B_S3_R2_L21_split</title>
<polygon fill="orange" stroke="black" points="20747.7,-1499.13 20081.64,-1499.13 19910.3,-1423.13 20576.36,-1423.13 20747.7,-1499.13"/>
<text text-anchor="middle" x="20329" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="20329" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_norm1 -->
<g id="node1256" class="node">
<title>GPT3_2B_S3_R2_L21_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20329" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L21_split&#45;&gt;GPT3_2B_S3_R2_L21_norm1 -->
<g id="edge1157" class="edge">
<title>GPT3_2B_S3_R2_L21_split&#45;&gt;GPT3_2B_S3_R2_L21_norm1</title>
<path fill="none" stroke="black" d="M20329,-1422.92C20329,-1403.71 20329,-1380.37 20329,-1361.33"/>
<polygon fill="black" stroke="black" points="20332.5,-1361.25 20329,-1351.25 20325.5,-1361.25 20332.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L21_qkv -->
<g id="node1257" class="node">
<title>GPT3_2B_S3_R2_L21_qkv</title>
<polygon fill="lightcoral" stroke="black" points="20471,-1225.39 20187,-1225.39 20187,-1187.39 20471,-1187.39 20471,-1225.39"/>
<text text-anchor="middle" x="20329" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="20329" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_norm1&#45;&gt;GPT3_2B_S3_R2_L21_qkv -->
<g id="edge1158" class="edge">
<title>GPT3_2B_S3_R2_L21_norm1&#45;&gt;GPT3_2B_S3_R2_L21_qkv</title>
<path fill="none" stroke="black" d="M20329,-1297.25C20329,-1278.99 20329,-1254.56 20329,-1235.78"/>
<polygon fill="black" stroke="black" points="20332.5,-1235.74 20329,-1225.74 20325.5,-1235.74 20332.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L21_attn -->
<g id="node1258" class="node">
<title>GPT3_2B_S3_R2_L21_attn</title>
<polygon fill="lightcoral" stroke="black" points="20471,-1115.39 20187,-1115.39 20187,-1077.39 20471,-1077.39 20471,-1115.39"/>
<text text-anchor="middle" x="20329" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="20329" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_qkv&#45;&gt;GPT3_2B_S3_R2_L21_attn -->
<g id="edge1159" class="edge">
<title>GPT3_2B_S3_R2_L21_qkv&#45;&gt;GPT3_2B_S3_R2_L21_attn</title>
<path fill="none" stroke="black" d="M20329,-1187.07C20329,-1170.21 20329,-1144.95 20329,-1125.54"/>
<polygon fill="black" stroke="black" points="20332.5,-1125.44 20329,-1115.44 20325.5,-1125.44 20332.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L21_ar1 -->
<g id="node1259" class="node">
<title>GPT3_2B_S3_R2_L21_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20329" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_attn&#45;&gt;GPT3_2B_S3_R2_L21_ar1 -->
<g id="edge1160" class="edge">
<title>GPT3_2B_S3_R2_L21_attn&#45;&gt;GPT3_2B_S3_R2_L21_ar1</title>
<path fill="none" stroke="black" d="M20329,-1077.28C20329,-1060.91 20329,-1036.32 20329,-1015.9"/>
<polygon fill="black" stroke="black" points="20332.5,-1015.67 20329,-1005.67 20325.5,-1015.67 20332.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L21_res1 -->
<g id="node1260" class="node">
<title>GPT3_2B_S3_R2_L21_res1</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-879.65 20277.11,-879.65 20241.16,-843.65 20380.89,-843.65 20416.84,-879.65"/>
<text text-anchor="middle" x="20329" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L21_ar1&#45;&gt;GPT3_2B_S3_R2_L21_res1 -->
<g id="edge1161" class="edge">
<title>GPT3_2B_S3_R2_L21_ar1&#45;&gt;GPT3_2B_S3_R2_L21_res1</title>
<path fill="none" stroke="black" d="M20329,-951.45C20329,-933.08 20329,-908.53 20329,-889.9"/>
<polygon fill="black" stroke="black" points="20332.5,-889.71 20329,-879.71 20325.5,-889.71 20332.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L21_norm2 -->
<g id="node1261" class="node">
<title>GPT3_2B_S3_R2_L21_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="20329" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="20329" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L21_res1&#45;&gt;GPT3_2B_S3_R2_L21_norm2 -->
<g id="edge1162" class="edge">
<title>GPT3_2B_S3_R2_L21_res1&#45;&gt;GPT3_2B_S3_R2_L21_norm2</title>
<path fill="none" stroke="black" d="M20329,-843.2C20329,-827.06 20329,-802.56 20329,-782.16"/>
<polygon fill="black" stroke="black" points="20332.5,-781.94 20329,-771.94 20325.5,-781.94 20332.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_up -->
<g id="node1262" class="node">
<title>GPT3_2B_S3_R2_L21_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-645.91 20222.5,-645.91 20222.5,-607.91 20435.5,-607.91 20435.5,-645.91"/>
<text text-anchor="middle" x="20329" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="20329" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_norm2&#45;&gt;GPT3_2B_S3_R2_L21_ffn_up -->
<g id="edge1163" class="edge">
<title>GPT3_2B_S3_R2_L21_norm2&#45;&gt;GPT3_2B_S3_R2_L21_ffn_up</title>
<path fill="none" stroke="black" d="M20329,-717.77C20329,-699.51 20329,-675.08 20329,-656.3"/>
<polygon fill="black" stroke="black" points="20332.5,-656.26 20329,-646.26 20325.5,-656.26 20332.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_gate -->
<g id="node1263" class="node">
<title>GPT3_2B_S3_R2_L21_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-535.91 20222.5,-535.91 20222.5,-497.91 20435.5,-497.91 20435.5,-535.91"/>
<text text-anchor="middle" x="20329" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="20329" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_up&#45;&gt;GPT3_2B_S3_R2_L21_ffn_gate -->
<g id="edge1164" class="edge">
<title>GPT3_2B_S3_R2_L21_ffn_up&#45;&gt;GPT3_2B_S3_R2_L21_ffn_gate</title>
<path fill="none" stroke="black" d="M20329,-607.59C20329,-590.73 20329,-565.47 20329,-546.06"/>
<polygon fill="black" stroke="black" points="20332.5,-545.96 20329,-535.96 20325.5,-545.96 20332.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_down -->
<g id="node1264" class="node">
<title>GPT3_2B_S3_R2_L21_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="20435.5,-425.91 20222.5,-425.91 20222.5,-387.91 20435.5,-387.91 20435.5,-425.91"/>
<text text-anchor="middle" x="20329" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="20329" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L21_ffn_down -->
<g id="edge1165" class="edge">
<title>GPT3_2B_S3_R2_L21_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L21_ffn_down</title>
<path fill="none" stroke="black" d="M20329,-497.59C20329,-480.73 20329,-455.47 20329,-436.06"/>
<polygon fill="black" stroke="black" points="20332.5,-435.96 20329,-425.96 20325.5,-435.96 20332.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L21_ar2 -->
<g id="node1265" class="node">
<title>GPT3_2B_S3_R2_L21_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="20329" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20329" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="20329" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L21_ffn_down&#45;&gt;GPT3_2B_S3_R2_L21_ar2 -->
<g id="edge1166" class="edge">
<title>GPT3_2B_S3_R2_L21_ffn_down&#45;&gt;GPT3_2B_S3_R2_L21_ar2</title>
<path fill="none" stroke="black" d="M20329,-387.8C20329,-371.43 20329,-346.84 20329,-326.42"/>
<polygon fill="black" stroke="black" points="20332.5,-326.19 20329,-316.19 20325.5,-326.19 20332.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L21_res2 -->
<g id="node1266" class="node">
<title>GPT3_2B_S3_R2_L21_res2</title>
<polygon fill="lightyellow" stroke="black" points="20416.84,-190.17 20277.11,-190.17 20241.16,-154.17 20380.89,-154.17 20416.84,-190.17"/>
<text text-anchor="middle" x="20329" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L21_ar2&#45;&gt;GPT3_2B_S3_R2_L21_res2 -->
<g id="edge1167" class="edge">
<title>GPT3_2B_S3_R2_L21_ar2&#45;&gt;GPT3_2B_S3_R2_L21_res2</title>
<path fill="none" stroke="black" d="M20329,-261.97C20329,-243.6 20329,-219.05 20329,-200.42"/>
<polygon fill="black" stroke="black" points="20332.5,-200.23 20329,-190.23 20325.5,-200.23 20332.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L22_split -->
<g id="node1267" class="node">
<title>GPT3_2B_S3_R2_L22_split</title>
<polygon fill="orange" stroke="black" points="19887.7,-1499.13 19221.64,-1499.13 19050.3,-1423.13 19716.36,-1423.13 19887.7,-1499.13"/>
<text text-anchor="middle" x="19469" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="19469" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_norm1 -->
<g id="node1268" class="node">
<title>GPT3_2B_S3_R2_L22_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19469" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L22_split&#45;&gt;GPT3_2B_S3_R2_L22_norm1 -->
<g id="edge1168" class="edge">
<title>GPT3_2B_S3_R2_L22_split&#45;&gt;GPT3_2B_S3_R2_L22_norm1</title>
<path fill="none" stroke="black" d="M19469,-1422.92C19469,-1403.71 19469,-1380.37 19469,-1361.33"/>
<polygon fill="black" stroke="black" points="19472.5,-1361.25 19469,-1351.25 19465.5,-1361.25 19472.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L22_qkv -->
<g id="node1269" class="node">
<title>GPT3_2B_S3_R2_L22_qkv</title>
<polygon fill="lightcoral" stroke="black" points="19611,-1225.39 19327,-1225.39 19327,-1187.39 19611,-1187.39 19611,-1225.39"/>
<text text-anchor="middle" x="19469" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="19469" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_norm1&#45;&gt;GPT3_2B_S3_R2_L22_qkv -->
<g id="edge1169" class="edge">
<title>GPT3_2B_S3_R2_L22_norm1&#45;&gt;GPT3_2B_S3_R2_L22_qkv</title>
<path fill="none" stroke="black" d="M19469,-1297.25C19469,-1278.99 19469,-1254.56 19469,-1235.78"/>
<polygon fill="black" stroke="black" points="19472.5,-1235.74 19469,-1225.74 19465.5,-1235.74 19472.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L22_attn -->
<g id="node1270" class="node">
<title>GPT3_2B_S3_R2_L22_attn</title>
<polygon fill="lightcoral" stroke="black" points="19611,-1115.39 19327,-1115.39 19327,-1077.39 19611,-1077.39 19611,-1115.39"/>
<text text-anchor="middle" x="19469" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="19469" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_qkv&#45;&gt;GPT3_2B_S3_R2_L22_attn -->
<g id="edge1170" class="edge">
<title>GPT3_2B_S3_R2_L22_qkv&#45;&gt;GPT3_2B_S3_R2_L22_attn</title>
<path fill="none" stroke="black" d="M19469,-1187.07C19469,-1170.21 19469,-1144.95 19469,-1125.54"/>
<polygon fill="black" stroke="black" points="19472.5,-1125.44 19469,-1115.44 19465.5,-1125.44 19472.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L22_ar1 -->
<g id="node1271" class="node">
<title>GPT3_2B_S3_R2_L22_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="19469" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_attn&#45;&gt;GPT3_2B_S3_R2_L22_ar1 -->
<g id="edge1171" class="edge">
<title>GPT3_2B_S3_R2_L22_attn&#45;&gt;GPT3_2B_S3_R2_L22_ar1</title>
<path fill="none" stroke="black" d="M19469,-1077.28C19469,-1060.91 19469,-1036.32 19469,-1015.9"/>
<polygon fill="black" stroke="black" points="19472.5,-1015.67 19469,-1005.67 19465.5,-1015.67 19472.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L22_res1 -->
<g id="node1272" class="node">
<title>GPT3_2B_S3_R2_L22_res1</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-879.65 19417.11,-879.65 19381.16,-843.65 19520.89,-843.65 19556.84,-879.65"/>
<text text-anchor="middle" x="19469" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L22_ar1&#45;&gt;GPT3_2B_S3_R2_L22_res1 -->
<g id="edge1172" class="edge">
<title>GPT3_2B_S3_R2_L22_ar1&#45;&gt;GPT3_2B_S3_R2_L22_res1</title>
<path fill="none" stroke="black" d="M19469,-951.45C19469,-933.08 19469,-908.53 19469,-889.9"/>
<polygon fill="black" stroke="black" points="19472.5,-889.71 19469,-879.71 19465.5,-889.71 19472.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L22_norm2 -->
<g id="node1273" class="node">
<title>GPT3_2B_S3_R2_L22_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="19469" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="19469" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L22_res1&#45;&gt;GPT3_2B_S3_R2_L22_norm2 -->
<g id="edge1173" class="edge">
<title>GPT3_2B_S3_R2_L22_res1&#45;&gt;GPT3_2B_S3_R2_L22_norm2</title>
<path fill="none" stroke="black" d="M19469,-843.2C19469,-827.06 19469,-802.56 19469,-782.16"/>
<polygon fill="black" stroke="black" points="19472.5,-781.94 19469,-771.94 19465.5,-781.94 19472.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_up -->
<g id="node1274" class="node">
<title>GPT3_2B_S3_R2_L22_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-645.91 19362.5,-645.91 19362.5,-607.91 19575.5,-607.91 19575.5,-645.91"/>
<text text-anchor="middle" x="19469" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="19469" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_norm2&#45;&gt;GPT3_2B_S3_R2_L22_ffn_up -->
<g id="edge1174" class="edge">
<title>GPT3_2B_S3_R2_L22_norm2&#45;&gt;GPT3_2B_S3_R2_L22_ffn_up</title>
<path fill="none" stroke="black" d="M19469,-717.77C19469,-699.51 19469,-675.08 19469,-656.3"/>
<polygon fill="black" stroke="black" points="19472.5,-656.26 19469,-646.26 19465.5,-656.26 19472.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_gate -->
<g id="node1275" class="node">
<title>GPT3_2B_S3_R2_L22_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-535.91 19362.5,-535.91 19362.5,-497.91 19575.5,-497.91 19575.5,-535.91"/>
<text text-anchor="middle" x="19469" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="19469" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_up&#45;&gt;GPT3_2B_S3_R2_L22_ffn_gate -->
<g id="edge1175" class="edge">
<title>GPT3_2B_S3_R2_L22_ffn_up&#45;&gt;GPT3_2B_S3_R2_L22_ffn_gate</title>
<path fill="none" stroke="black" d="M19469,-607.59C19469,-590.73 19469,-565.47 19469,-546.06"/>
<polygon fill="black" stroke="black" points="19472.5,-545.96 19469,-535.96 19465.5,-545.96 19472.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_down -->
<g id="node1276" class="node">
<title>GPT3_2B_S3_R2_L22_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="19575.5,-425.91 19362.5,-425.91 19362.5,-387.91 19575.5,-387.91 19575.5,-425.91"/>
<text text-anchor="middle" x="19469" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="19469" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L22_ffn_down -->
<g id="edge1176" class="edge">
<title>GPT3_2B_S3_R2_L22_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L22_ffn_down</title>
<path fill="none" stroke="black" d="M19469,-497.59C19469,-480.73 19469,-455.47 19469,-436.06"/>
<polygon fill="black" stroke="black" points="19472.5,-435.96 19469,-425.96 19465.5,-435.96 19472.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L22_ar2 -->
<g id="node1277" class="node">
<title>GPT3_2B_S3_R2_L22_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="19469" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19469" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="19469" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L22_ffn_down&#45;&gt;GPT3_2B_S3_R2_L22_ar2 -->
<g id="edge1177" class="edge">
<title>GPT3_2B_S3_R2_L22_ffn_down&#45;&gt;GPT3_2B_S3_R2_L22_ar2</title>
<path fill="none" stroke="black" d="M19469,-387.8C19469,-371.43 19469,-346.84 19469,-326.42"/>
<polygon fill="black" stroke="black" points="19472.5,-326.19 19469,-316.19 19465.5,-326.19 19472.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L22_res2 -->
<g id="node1278" class="node">
<title>GPT3_2B_S3_R2_L22_res2</title>
<polygon fill="lightyellow" stroke="black" points="19556.84,-190.17 19417.11,-190.17 19381.16,-154.17 19520.89,-154.17 19556.84,-190.17"/>
<text text-anchor="middle" x="19469" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L22_ar2&#45;&gt;GPT3_2B_S3_R2_L22_res2 -->
<g id="edge1178" class="edge">
<title>GPT3_2B_S3_R2_L22_ar2&#45;&gt;GPT3_2B_S3_R2_L22_res2</title>
<path fill="none" stroke="black" d="M19469,-261.97C19469,-243.6 19469,-219.05 19469,-200.42"/>
<polygon fill="black" stroke="black" points="19472.5,-200.23 19469,-190.23 19465.5,-200.23 19472.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L23_split -->
<g id="node1279" class="node">
<title>GPT3_2B_S3_R2_L23_split</title>
<polygon fill="orange" stroke="black" points="19027.7,-1499.13 18361.64,-1499.13 18190.3,-1423.13 18856.36,-1423.13 19027.7,-1499.13"/>
<text text-anchor="middle" x="18609" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="18609" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_norm1 -->
<g id="node1280" class="node">
<title>GPT3_2B_S3_R2_L23_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18609" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L23_split&#45;&gt;GPT3_2B_S3_R2_L23_norm1 -->
<g id="edge1179" class="edge">
<title>GPT3_2B_S3_R2_L23_split&#45;&gt;GPT3_2B_S3_R2_L23_norm1</title>
<path fill="none" stroke="black" d="M18609,-1422.92C18609,-1403.71 18609,-1380.37 18609,-1361.33"/>
<polygon fill="black" stroke="black" points="18612.5,-1361.25 18609,-1351.25 18605.5,-1361.25 18612.5,-1361.25"/>
</g>
<!-- GPT3_2B_S3_R2_L23_qkv -->
<g id="node1281" class="node">
<title>GPT3_2B_S3_R2_L23_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18751,-1225.39 18467,-1225.39 18467,-1187.39 18751,-1187.39 18751,-1225.39"/>
<text text-anchor="middle" x="18609" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="18609" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_norm1&#45;&gt;GPT3_2B_S3_R2_L23_qkv -->
<g id="edge1180" class="edge">
<title>GPT3_2B_S3_R2_L23_norm1&#45;&gt;GPT3_2B_S3_R2_L23_qkv</title>
<path fill="none" stroke="black" d="M18609,-1297.25C18609,-1278.99 18609,-1254.56 18609,-1235.78"/>
<polygon fill="black" stroke="black" points="18612.5,-1235.74 18609,-1225.74 18605.5,-1235.74 18612.5,-1235.74"/>
</g>
<!-- GPT3_2B_S3_R2_L23_attn -->
<g id="node1282" class="node">
<title>GPT3_2B_S3_R2_L23_attn</title>
<polygon fill="lightcoral" stroke="black" points="18751,-1115.39 18467,-1115.39 18467,-1077.39 18751,-1077.39 18751,-1115.39"/>
<text text-anchor="middle" x="18609" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18609" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_qkv&#45;&gt;GPT3_2B_S3_R2_L23_attn -->
<g id="edge1181" class="edge">
<title>GPT3_2B_S3_R2_L23_qkv&#45;&gt;GPT3_2B_S3_R2_L23_attn</title>
<path fill="none" stroke="black" d="M18609,-1187.07C18609,-1170.21 18609,-1144.95 18609,-1125.54"/>
<polygon fill="black" stroke="black" points="18612.5,-1125.44 18609,-1115.44 18605.5,-1125.44 18612.5,-1125.44"/>
</g>
<!-- GPT3_2B_S3_R2_L23_ar1 -->
<g id="node1283" class="node">
<title>GPT3_2B_S3_R2_L23_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18609" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_attn&#45;&gt;GPT3_2B_S3_R2_L23_ar1 -->
<g id="edge1182" class="edge">
<title>GPT3_2B_S3_R2_L23_attn&#45;&gt;GPT3_2B_S3_R2_L23_ar1</title>
<path fill="none" stroke="black" d="M18609,-1077.28C18609,-1060.91 18609,-1036.32 18609,-1015.9"/>
<polygon fill="black" stroke="black" points="18612.5,-1015.67 18609,-1005.67 18605.5,-1015.67 18612.5,-1015.67"/>
</g>
<!-- GPT3_2B_S3_R2_L23_res1 -->
<g id="node1284" class="node">
<title>GPT3_2B_S3_R2_L23_res1</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-879.65 18557.11,-879.65 18521.16,-843.65 18660.89,-843.65 18696.84,-879.65"/>
<text text-anchor="middle" x="18609" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L23_ar1&#45;&gt;GPT3_2B_S3_R2_L23_res1 -->
<g id="edge1183" class="edge">
<title>GPT3_2B_S3_R2_L23_ar1&#45;&gt;GPT3_2B_S3_R2_L23_res1</title>
<path fill="none" stroke="black" d="M18609,-951.45C18609,-933.08 18609,-908.53 18609,-889.9"/>
<polygon fill="black" stroke="black" points="18612.5,-889.71 18609,-879.71 18605.5,-889.71 18612.5,-889.71"/>
</g>
<!-- GPT3_2B_S3_R2_L23_norm2 -->
<g id="node1285" class="node">
<title>GPT3_2B_S3_R2_L23_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18609" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18609" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L23_res1&#45;&gt;GPT3_2B_S3_R2_L23_norm2 -->
<g id="edge1184" class="edge">
<title>GPT3_2B_S3_R2_L23_res1&#45;&gt;GPT3_2B_S3_R2_L23_norm2</title>
<path fill="none" stroke="black" d="M18609,-843.2C18609,-827.06 18609,-802.56 18609,-782.16"/>
<polygon fill="black" stroke="black" points="18612.5,-781.94 18609,-771.94 18605.5,-781.94 18612.5,-781.94"/>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_up -->
<g id="node1286" class="node">
<title>GPT3_2B_S3_R2_L23_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-645.91 18502.5,-645.91 18502.5,-607.91 18715.5,-607.91 18715.5,-645.91"/>
<text text-anchor="middle" x="18609" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18609" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_norm2&#45;&gt;GPT3_2B_S3_R2_L23_ffn_up -->
<g id="edge1185" class="edge">
<title>GPT3_2B_S3_R2_L23_norm2&#45;&gt;GPT3_2B_S3_R2_L23_ffn_up</title>
<path fill="none" stroke="black" d="M18609,-717.77C18609,-699.51 18609,-675.08 18609,-656.3"/>
<polygon fill="black" stroke="black" points="18612.5,-656.26 18609,-646.26 18605.5,-656.26 18612.5,-656.26"/>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_gate -->
<g id="node1287" class="node">
<title>GPT3_2B_S3_R2_L23_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-535.91 18502.5,-535.91 18502.5,-497.91 18715.5,-497.91 18715.5,-535.91"/>
<text text-anchor="middle" x="18609" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18609" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_up&#45;&gt;GPT3_2B_S3_R2_L23_ffn_gate -->
<g id="edge1186" class="edge">
<title>GPT3_2B_S3_R2_L23_ffn_up&#45;&gt;GPT3_2B_S3_R2_L23_ffn_gate</title>
<path fill="none" stroke="black" d="M18609,-607.59C18609,-590.73 18609,-565.47 18609,-546.06"/>
<polygon fill="black" stroke="black" points="18612.5,-545.96 18609,-535.96 18605.5,-545.96 18612.5,-545.96"/>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_down -->
<g id="node1288" class="node">
<title>GPT3_2B_S3_R2_L23_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18715.5,-425.91 18502.5,-425.91 18502.5,-387.91 18715.5,-387.91 18715.5,-425.91"/>
<text text-anchor="middle" x="18609" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18609" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L23_ffn_down -->
<g id="edge1187" class="edge">
<title>GPT3_2B_S3_R2_L23_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L23_ffn_down</title>
<path fill="none" stroke="black" d="M18609,-497.59C18609,-480.73 18609,-455.47 18609,-436.06"/>
<polygon fill="black" stroke="black" points="18612.5,-435.96 18609,-425.96 18605.5,-435.96 18612.5,-435.96"/>
</g>
<!-- GPT3_2B_S3_R2_L23_ar2 -->
<g id="node1289" class="node">
<title>GPT3_2B_S3_R2_L23_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18609" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18609" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18609" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L23_ffn_down&#45;&gt;GPT3_2B_S3_R2_L23_ar2 -->
<g id="edge1188" class="edge">
<title>GPT3_2B_S3_R2_L23_ffn_down&#45;&gt;GPT3_2B_S3_R2_L23_ar2</title>
<path fill="none" stroke="black" d="M18609,-387.8C18609,-371.43 18609,-346.84 18609,-326.42"/>
<polygon fill="black" stroke="black" points="18612.5,-326.19 18609,-316.19 18605.5,-326.19 18612.5,-326.19"/>
</g>
<!-- GPT3_2B_S3_R2_L23_res2 -->
<g id="node1290" class="node">
<title>GPT3_2B_S3_R2_L23_res2</title>
<polygon fill="lightyellow" stroke="black" points="18696.84,-190.17 18557.11,-190.17 18521.16,-154.17 18660.89,-154.17 18696.84,-190.17"/>
<text text-anchor="middle" x="18609" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L23_ar2&#45;&gt;GPT3_2B_S3_R2_L23_res2 -->
<g id="edge1189" class="edge">
<title>GPT3_2B_S3_R2_L23_ar2&#45;&gt;GPT3_2B_S3_R2_L23_res2</title>
<path fill="none" stroke="black" d="M18609,-261.97C18609,-243.6 18609,-219.05 18609,-200.42"/>
<polygon fill="black" stroke="black" points="18612.5,-200.23 18609,-190.23 18605.5,-200.23 18612.5,-200.23"/>
</g>
<!-- GPT3_2B_S3_R2_L24_split -->
<g id="node1291" class="node">
<title>GPT3_2B_S3_R2_L24_split</title>
<polygon fill="orange" stroke="black" points="18167.7,-1499.13 17501.64,-1499.13 17330.3,-1423.13 17996.36,-1423.13 18167.7,-1499.13"/>
<text text-anchor="middle" x="17749" y="-1464.93" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="17749" y="-1449.93" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, hidden=2048]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_norm1 -->
<g id="node1292" class="node">
<title>GPT3_2B_S3_R2_L24_norm1</title>
<ellipse fill="lightgray" stroke="black" cx="17818" cy="-1324.26" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="17818" y="-1328.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17818" y="-1313.06" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L24_split&#45;&gt;GPT3_2B_S3_R2_L24_norm1 -->
<g id="edge1190" class="edge">
<title>GPT3_2B_S3_R2_L24_split&#45;&gt;GPT3_2B_S3_R2_L24_norm1</title>
<path fill="none" stroke="black" d="M17768.04,-1422.92C17778.12,-1403.22 17790.41,-1379.18 17800.29,-1359.88"/>
<polygon fill="black" stroke="black" points="17803.48,-1361.32 17804.92,-1350.83 17797.25,-1358.14 17803.48,-1361.32"/>
</g>
<!-- GPT3_2B_S3_R2_L24_qkv -->
<g id="node1293" class="node">
<title>GPT3_2B_S3_R2_L24_qkv</title>
<polygon fill="lightcoral" stroke="black" points="18030,-1225.39 17746,-1225.39 17746,-1187.39 18030,-1187.39 18030,-1225.39"/>
<text text-anchor="middle" x="17888" y="-1210.19" font-family="Times,serif" font-size="14.00">QKV Proj</text>
<text text-anchor="middle" x="17888" y="-1195.19" font-family="Times,serif" font-size="14.00">[hidden=1024]→[heads=8, dim=128]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_norm1&#45;&gt;GPT3_2B_S3_R2_L24_qkv -->
<g id="edge1191" class="edge">
<title>GPT3_2B_S3_R2_L24_norm1&#45;&gt;GPT3_2B_S3_R2_L24_qkv</title>
<path fill="none" stroke="black" d="M17833.54,-1297.54C17844.89,-1278.75 17860.25,-1253.32 17871.76,-1234.26"/>
<polygon fill="black" stroke="black" points="17874.9,-1235.85 17877.07,-1225.48 17868.91,-1232.23 17874.9,-1235.85"/>
</g>
<!-- GPT3_2B_S3_R2_L24_attn -->
<g id="node1294" class="node">
<title>GPT3_2B_S3_R2_L24_attn</title>
<polygon fill="lightcoral" stroke="black" points="18168,-1115.39 17884,-1115.39 17884,-1077.39 18168,-1077.39 18168,-1115.39"/>
<text text-anchor="middle" x="18026" y="-1100.19" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="18026" y="-1085.19" font-family="Times,serif" font-size="14.00">[heads=8, dim=128]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_qkv&#45;&gt;GPT3_2B_S3_R2_L24_attn -->
<g id="edge1192" class="edge">
<title>GPT3_2B_S3_R2_L24_qkv&#45;&gt;GPT3_2B_S3_R2_L24_attn</title>
<path fill="none" stroke="black" d="M17911.1,-1187.31C17934.08,-1169.32 17969.51,-1141.6 17994.95,-1121.69"/>
<polygon fill="black" stroke="black" points="17997.11,-1124.44 18002.83,-1115.52 17992.79,-1118.93 17997.11,-1124.44"/>
</g>
<!-- GPT3_2B_S3_R2_L24_ar1 -->
<g id="node1295" class="node">
<title>GPT3_2B_S3_R2_L24_ar1</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18031" cy="-978.52" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18031" y="-982.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18031" y="-967.32" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_attn&#45;&gt;GPT3_2B_S3_R2_L24_ar1 -->
<g id="edge1193" class="edge">
<title>GPT3_2B_S3_R2_L24_attn&#45;&gt;GPT3_2B_S3_R2_L24_ar1</title>
<path fill="none" stroke="black" d="M18026.78,-1077.28C18027.49,-1060.91 18028.55,-1036.32 18029.43,-1015.9"/>
<polygon fill="black" stroke="black" points="18032.94,-1015.81 18029.87,-1005.67 18025.94,-1015.51 18032.94,-1015.81"/>
</g>
<!-- GPT3_2B_S3_R2_L24_res1 -->
<g id="node1296" class="node">
<title>GPT3_2B_S3_R2_L24_res1</title>
<polygon fill="lightyellow" stroke="black" points="18292.84,-879.65 18153.11,-879.65 18117.16,-843.65 18256.89,-843.65 18292.84,-879.65"/>
<text text-anchor="middle" x="18205" y="-857.95" font-family="Times,serif" font-size="14.00">Residual 1</text>
</g>
<!-- GPT3_2B_S3_R2_L24_ar1&#45;&gt;GPT3_2B_S3_R2_L24_res1 -->
<g id="edge1194" class="edge">
<title>GPT3_2B_S3_R2_L24_ar1&#45;&gt;GPT3_2B_S3_R2_L24_res1</title>
<path fill="none" stroke="black" d="M18067.05,-953.72C18097.49,-933.62 18140.78,-905.04 18170.71,-885.28"/>
<polygon fill="black" stroke="black" points="18172.74,-888.14 18179.16,-879.71 18168.89,-882.29 18172.74,-888.14"/>
</g>
<!-- GPT3_2B_S3_R2_L24_norm2 -->
<g id="node1297" class="node">
<title>GPT3_2B_S3_R2_L24_norm2</title>
<ellipse fill="lightgray" stroke="black" cx="18216" cy="-744.78" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="18216" y="-748.58" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="18216" y="-733.58" font-family="Times,serif" font-size="14.00">Device: GPU_6</text>
</g>
<!-- GPT3_2B_S3_R2_L24_res1&#45;&gt;GPT3_2B_S3_R2_L24_norm2 -->
<g id="edge1195" class="edge">
<title>GPT3_2B_S3_R2_L24_res1&#45;&gt;GPT3_2B_S3_R2_L24_norm2</title>
<path fill="none" stroke="black" d="M18206.67,-843.2C18208.22,-827.06 18210.56,-802.56 18212.52,-782.16"/>
<polygon fill="black" stroke="black" points="18216.03,-782.22 18213.5,-771.94 18209.06,-781.56 18216.03,-782.22"/>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_up -->
<g id="node1298" class="node">
<title>GPT3_2B_S3_R2_L24_ffn_up</title>
<polygon fill="lightcyan" stroke="black" points="18328.5,-645.91 18115.5,-645.91 18115.5,-607.91 18328.5,-607.91 18328.5,-645.91"/>
<text text-anchor="middle" x="18222" y="-630.71" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="18222" y="-615.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_norm2&#45;&gt;GPT3_2B_S3_R2_L24_ffn_up -->
<g id="edge1196" class="edge">
<title>GPT3_2B_S3_R2_L24_norm2&#45;&gt;GPT3_2B_S3_R2_L24_ffn_up</title>
<path fill="none" stroke="black" d="M18217.35,-717.77C18218.29,-699.51 18219.56,-675.08 18220.53,-656.3"/>
<polygon fill="black" stroke="black" points="18224.03,-656.43 18221.05,-646.26 18217.04,-656.06 18224.03,-656.43"/>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_gate -->
<g id="node1299" class="node">
<title>GPT3_2B_S3_R2_L24_ffn_gate</title>
<polygon fill="lightcyan" stroke="black" points="18415.5,-535.91 18202.5,-535.91 18202.5,-497.91 18415.5,-497.91 18415.5,-535.91"/>
<text text-anchor="middle" x="18309" y="-520.71" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18309" y="-505.71" font-family="Times,serif" font-size="14.00">[hidden=1024]→[ffn=4096]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_up&#45;&gt;GPT3_2B_S3_R2_L24_ffn_gate -->
<g id="edge1197" class="edge">
<title>GPT3_2B_S3_R2_L24_ffn_up&#45;&gt;GPT3_2B_S3_R2_L24_ffn_gate</title>
<path fill="none" stroke="black" d="M18236.76,-607.59C18250.84,-590.1 18272.2,-563.59 18288.04,-543.92"/>
<polygon fill="black" stroke="black" points="18290.91,-545.94 18294.46,-535.96 18285.46,-541.55 18290.91,-545.94"/>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_down -->
<g id="node1300" class="node">
<title>GPT3_2B_S3_R2_L24_ffn_down</title>
<polygon fill="lightcyan" stroke="black" points="18437.5,-425.91 18224.5,-425.91 18224.5,-387.91 18437.5,-387.91 18437.5,-425.91"/>
<text text-anchor="middle" x="18331" y="-410.71" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="18331" y="-395.71" font-family="Times,serif" font-size="14.00">[ffn=4096]→[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L24_ffn_down -->
<g id="edge1198" class="edge">
<title>GPT3_2B_S3_R2_L24_ffn_gate&#45;&gt;GPT3_2B_S3_R2_L24_ffn_down</title>
<path fill="none" stroke="black" d="M18312.73,-497.59C18316.18,-480.65 18321.36,-455.24 18325.32,-435.79"/>
<polygon fill="black" stroke="black" points="18328.76,-436.46 18327.32,-425.96 18321.9,-435.06 18328.76,-436.46"/>
</g>
<!-- GPT3_2B_S3_R2_L24_ar2 -->
<g id="node1301" class="node">
<title>GPT3_2B_S3_R2_L24_ar2</title>
<ellipse fill="yellow" stroke="black" stroke-dasharray="5,2" cx="18351" cy="-289.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18351" y="-292.84" font-family="Times,serif" font-size="14.00">All&#45;Reduce 2</text>
<text text-anchor="middle" x="18351" y="-277.84" font-family="Times,serif" font-size="14.00">[hidden=1024]</text>
</g>
<!-- GPT3_2B_S3_R2_L24_ffn_down&#45;&gt;GPT3_2B_S3_R2_L24_ar2 -->
<g id="edge1199" class="edge">
<title>GPT3_2B_S3_R2_L24_ffn_down&#45;&gt;GPT3_2B_S3_R2_L24_ar2</title>
<path fill="none" stroke="black" d="M18334.12,-387.8C18336.96,-371.36 18341.23,-346.62 18344.77,-326.14"/>
<polygon fill="black" stroke="black" points="18348.23,-326.64 18346.49,-316.19 18341.34,-325.44 18348.23,-326.64"/>
</g>
<!-- GPT3_2B_S3_R2_L24_res2 -->
<g id="node1302" class="node">
<title>GPT3_2B_S3_R2_L24_res2</title>
<polygon fill="lightyellow" stroke="black" points="18459.84,-190.17 18320.11,-190.17 18284.16,-154.17 18423.89,-154.17 18459.84,-190.17"/>
<text text-anchor="middle" x="18372" y="-168.47" font-family="Times,serif" font-size="14.00">Residual 2</text>
</g>
<!-- GPT3_2B_S3_R2_L24_ar2&#45;&gt;GPT3_2B_S3_R2_L24_res2 -->
<g id="edge1200" class="edge">
<title>GPT3_2B_S3_R2_L24_ar2&#45;&gt;GPT3_2B_S3_R2_L24_res2</title>
<path fill="none" stroke="black" d="M18355.77,-261.97C18359.14,-243.52 18363.65,-218.82 18367.06,-200.16"/>
<polygon fill="black" stroke="black" points="18370.53,-200.7 18368.88,-190.23 18363.64,-199.44 18370.53,-200.7"/>
</g>
<!-- GPT3_2B_S3_R2_L24_res2&#45;&gt;GPT3_2B_output -->
<g id="edge1212" class="edge">
<title>GPT3_2B_S3_R2_L24_res2&#45;&gt;GPT3_2B_output</title>
<path fill="none" stroke="black" d="M18418.25,-154.14C18444.72,-145.23 18478.78,-135.16 18510,-130.17 18761.57,-89.93 20467,-62.2 21096.86,-53.22"/>
<polygon fill="black" stroke="black" points="21097.02,-56.72 21106.97,-53.08 21096.92,-49.72 21097.02,-56.72"/>
</g>
<!-- GPT3_2B_comm_1_2&#45;&gt;GPT3_2B_S2_R1_L9_split -->
<g id="edge1202" class="edge">
<title>GPT3_2B_comm_1_2&#45;&gt;GPT3_2B_S2_R1_L9_split</title>
<path fill="none" stroke="black" d="M24235.86,-3227.68C25265.88,-3228.28 29918.9,-3228.49 30221,-3183.04 30334.85,-3165.91 30460.47,-3125.6 30546.38,-3094.57"/>
<polygon fill="black" stroke="black" points="30547.67,-3097.82 30555.88,-3091.12 30545.28,-3091.24 30547.67,-3097.82"/>
</g>
<!-- GPT3_2B_comm_1_2&#45;&gt;GPT3_2B_S2_R2_L9_split -->
<g id="edge1204" class="edge">
<title>GPT3_2B_comm_1_2&#45;&gt;GPT3_2B_S2_R2_L9_split</title>
<path fill="none" stroke="black" d="M23981.17,-3192.41C23938.81,-3164.79 23879.61,-3126.18 23834.5,-3096.76"/>
<polygon fill="black" stroke="black" points="23836.25,-3093.73 23825.97,-3091.19 23832.43,-3099.59 23836.25,-3093.73"/>
</g>
<!-- GPT3_2B_comm_2_3&#45;&gt;GPT3_2B_S3_R1_L17_split -->
<g id="edge1206" class="edge">
<title>GPT3_2B_comm_2_3&#45;&gt;GPT3_2B_S3_R1_L17_split</title>
<path fill="none" stroke="black" d="M24235.86,-1635.76C25265.88,-1636.37 29918.9,-1636.58 30221,-1591.13 30334.85,-1574 30460.47,-1533.69 30546.38,-1502.65"/>
<polygon fill="black" stroke="black" points="30547.67,-1505.91 30555.88,-1499.2 30545.28,-1499.33 30547.67,-1505.91"/>
</g>
<!-- GPT3_2B_comm_2_3&#45;&gt;GPT3_2B_S3_R2_L17_split -->
<g id="edge1208" class="edge">
<title>GPT3_2B_comm_2_3&#45;&gt;GPT3_2B_S3_R2_L17_split</title>
<path fill="none" stroke="black" d="M23981.17,-1600.5C23938.81,-1572.88 23879.61,-1534.27 23834.5,-1504.85"/>
<polygon fill="black" stroke="black" points="23836.25,-1501.81 23825.97,-1499.28 23832.43,-1507.67 23836.25,-1501.81"/>
</g>
<!-- GPT3_2B_input -->
<g id="node1305" class="node">
<title>GPT3_2B_input</title>
<ellipse fill="lightgreen" stroke="black" cx="27210" cy="-4809.83" rx="202.47" ry="26.74"/>
<text text-anchor="middle" x="27210" y="-4813.63" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="27210" y="-4798.63" font-family="Times,serif" font-size="14.00">[batch=12, seq=2048, vocab=50257]</text>
</g>
<!-- GPT3_2B_input&#45;&gt;GPT3_2B_S1_R1_L1_split -->
<g id="edge1209" class="edge">
<title>GPT3_2B_input&#45;&gt;GPT3_2B_S1_R1_L1_split</title>
<path fill="none" stroke="black" d="M27411.94,-4808.11C28064.52,-4805.58 30082.51,-4796.08 30221,-4774.96 30334.63,-4757.63 30460.03,-4717.45 30545.94,-4686.51"/>
<polygon fill="black" stroke="black" points="30547.23,-4689.77 30555.44,-4683.07 30544.84,-4683.18 30547.23,-4689.77"/>
</g>
<!-- GPT3_2B_input&#45;&gt;GPT3_2B_S1_R2_L1_split -->
<g id="edge1210" class="edge">
<title>GPT3_2B_input&#45;&gt;GPT3_2B_S1_R2_L1_split</title>
<path fill="none" stroke="black" d="M27008.06,-4808.11C26355.48,-4805.58 24337.49,-4796.08 24199,-4774.96 24085.37,-4757.63 23959.97,-4717.45 23874.06,-4686.51"/>
<polygon fill="black" stroke="black" points="23875.16,-4683.18 23864.56,-4683.07 23872.77,-4689.77 23875.16,-4683.18"/>
</g>
</g>
</svg>
