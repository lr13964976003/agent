// GPipe Micro-Batch Pipeline
digraph GPipe_Baseline {
	graph [compound=true nodesep=0.2 rankdir=TB ranksep=1.5]
	subgraph cluster_llama_7b_gpipe {
		color=black fillcolor=lightyellow label="LLAMA_7B GPipe Pipeline (4 stages)" style="rounded,filled"
		subgraph cluster_llama_7b_stage_1 {
			color=black fillcolor=lightblue label="Stage 1\nGPU_1\nLayers 1-8" style="rounded,filled"
			llama_7b_stage_1_batch_1_input [label="Micro-batch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_input -> llama_7b_stage_1_batch_1_layer_1_norm1
			llama_7b_stage_1_batch_1_layer_1_norm1 -> llama_7b_stage_1_batch_1_layer_1_qkv
			llama_7b_stage_1_batch_1_layer_1_qkv -> llama_7b_stage_1_batch_1_layer_1_attn
			llama_7b_stage_1_batch_1_layer_1_attn -> llama_7b_stage_1_batch_1_layer_1_attn_out
			llama_7b_stage_1_batch_1_layer_1_attn_out -> llama_7b_stage_1_batch_1_layer_1_attn_res
			llama_7b_stage_1_batch_1_layer_1_attn_res -> llama_7b_stage_1_batch_1_layer_1_norm2
			llama_7b_stage_1_batch_1_layer_1_norm2 -> llama_7b_stage_1_batch_1_layer_1_ffn_up
			llama_7b_stage_1_batch_1_layer_1_ffn_up -> llama_7b_stage_1_batch_1_layer_1_ffn_gate
			llama_7b_stage_1_batch_1_layer_1_ffn_gate -> llama_7b_stage_1_batch_1_layer_1_ffn_down
			llama_7b_stage_1_batch_1_layer_1_ffn_down -> llama_7b_stage_1_batch_1_layer_1_ffn_res
			llama_7b_stage_1_batch_1_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_1_ffn_res -> llama_7b_stage_1_batch_1_layer_2_norm1
			llama_7b_stage_1_batch_1_layer_2_norm1 -> llama_7b_stage_1_batch_1_layer_2_qkv
			llama_7b_stage_1_batch_1_layer_2_qkv -> llama_7b_stage_1_batch_1_layer_2_attn
			llama_7b_stage_1_batch_1_layer_2_attn -> llama_7b_stage_1_batch_1_layer_2_attn_out
			llama_7b_stage_1_batch_1_layer_2_attn_out -> llama_7b_stage_1_batch_1_layer_2_attn_res
			llama_7b_stage_1_batch_1_layer_2_attn_res -> llama_7b_stage_1_batch_1_layer_2_norm2
			llama_7b_stage_1_batch_1_layer_2_norm2 -> llama_7b_stage_1_batch_1_layer_2_ffn_up
			llama_7b_stage_1_batch_1_layer_2_ffn_up -> llama_7b_stage_1_batch_1_layer_2_ffn_gate
			llama_7b_stage_1_batch_1_layer_2_ffn_gate -> llama_7b_stage_1_batch_1_layer_2_ffn_down
			llama_7b_stage_1_batch_1_layer_2_ffn_down -> llama_7b_stage_1_batch_1_layer_2_ffn_res
			llama_7b_stage_1_batch_1_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_2_ffn_res -> llama_7b_stage_1_batch_1_layer_3_norm1
			llama_7b_stage_1_batch_1_layer_3_norm1 -> llama_7b_stage_1_batch_1_layer_3_qkv
			llama_7b_stage_1_batch_1_layer_3_qkv -> llama_7b_stage_1_batch_1_layer_3_attn
			llama_7b_stage_1_batch_1_layer_3_attn -> llama_7b_stage_1_batch_1_layer_3_attn_out
			llama_7b_stage_1_batch_1_layer_3_attn_out -> llama_7b_stage_1_batch_1_layer_3_attn_res
			llama_7b_stage_1_batch_1_layer_3_attn_res -> llama_7b_stage_1_batch_1_layer_3_norm2
			llama_7b_stage_1_batch_1_layer_3_norm2 -> llama_7b_stage_1_batch_1_layer_3_ffn_up
			llama_7b_stage_1_batch_1_layer_3_ffn_up -> llama_7b_stage_1_batch_1_layer_3_ffn_gate
			llama_7b_stage_1_batch_1_layer_3_ffn_gate -> llama_7b_stage_1_batch_1_layer_3_ffn_down
			llama_7b_stage_1_batch_1_layer_3_ffn_down -> llama_7b_stage_1_batch_1_layer_3_ffn_res
			llama_7b_stage_1_batch_1_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_3_ffn_res -> llama_7b_stage_1_batch_1_layer_4_norm1
			llama_7b_stage_1_batch_1_layer_4_norm1 -> llama_7b_stage_1_batch_1_layer_4_qkv
			llama_7b_stage_1_batch_1_layer_4_qkv -> llama_7b_stage_1_batch_1_layer_4_attn
			llama_7b_stage_1_batch_1_layer_4_attn -> llama_7b_stage_1_batch_1_layer_4_attn_out
			llama_7b_stage_1_batch_1_layer_4_attn_out -> llama_7b_stage_1_batch_1_layer_4_attn_res
			llama_7b_stage_1_batch_1_layer_4_attn_res -> llama_7b_stage_1_batch_1_layer_4_norm2
			llama_7b_stage_1_batch_1_layer_4_norm2 -> llama_7b_stage_1_batch_1_layer_4_ffn_up
			llama_7b_stage_1_batch_1_layer_4_ffn_up -> llama_7b_stage_1_batch_1_layer_4_ffn_gate
			llama_7b_stage_1_batch_1_layer_4_ffn_gate -> llama_7b_stage_1_batch_1_layer_4_ffn_down
			llama_7b_stage_1_batch_1_layer_4_ffn_down -> llama_7b_stage_1_batch_1_layer_4_ffn_res
			llama_7b_stage_1_batch_1_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_4_ffn_res -> llama_7b_stage_1_batch_1_layer_5_norm1
			llama_7b_stage_1_batch_1_layer_5_norm1 -> llama_7b_stage_1_batch_1_layer_5_qkv
			llama_7b_stage_1_batch_1_layer_5_qkv -> llama_7b_stage_1_batch_1_layer_5_attn
			llama_7b_stage_1_batch_1_layer_5_attn -> llama_7b_stage_1_batch_1_layer_5_attn_out
			llama_7b_stage_1_batch_1_layer_5_attn_out -> llama_7b_stage_1_batch_1_layer_5_attn_res
			llama_7b_stage_1_batch_1_layer_5_attn_res -> llama_7b_stage_1_batch_1_layer_5_norm2
			llama_7b_stage_1_batch_1_layer_5_norm2 -> llama_7b_stage_1_batch_1_layer_5_ffn_up
			llama_7b_stage_1_batch_1_layer_5_ffn_up -> llama_7b_stage_1_batch_1_layer_5_ffn_gate
			llama_7b_stage_1_batch_1_layer_5_ffn_gate -> llama_7b_stage_1_batch_1_layer_5_ffn_down
			llama_7b_stage_1_batch_1_layer_5_ffn_down -> llama_7b_stage_1_batch_1_layer_5_ffn_res
			llama_7b_stage_1_batch_1_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_5_ffn_res -> llama_7b_stage_1_batch_1_layer_6_norm1
			llama_7b_stage_1_batch_1_layer_6_norm1 -> llama_7b_stage_1_batch_1_layer_6_qkv
			llama_7b_stage_1_batch_1_layer_6_qkv -> llama_7b_stage_1_batch_1_layer_6_attn
			llama_7b_stage_1_batch_1_layer_6_attn -> llama_7b_stage_1_batch_1_layer_6_attn_out
			llama_7b_stage_1_batch_1_layer_6_attn_out -> llama_7b_stage_1_batch_1_layer_6_attn_res
			llama_7b_stage_1_batch_1_layer_6_attn_res -> llama_7b_stage_1_batch_1_layer_6_norm2
			llama_7b_stage_1_batch_1_layer_6_norm2 -> llama_7b_stage_1_batch_1_layer_6_ffn_up
			llama_7b_stage_1_batch_1_layer_6_ffn_up -> llama_7b_stage_1_batch_1_layer_6_ffn_gate
			llama_7b_stage_1_batch_1_layer_6_ffn_gate -> llama_7b_stage_1_batch_1_layer_6_ffn_down
			llama_7b_stage_1_batch_1_layer_6_ffn_down -> llama_7b_stage_1_batch_1_layer_6_ffn_res
			llama_7b_stage_1_batch_1_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_6_ffn_res -> llama_7b_stage_1_batch_1_layer_7_norm1
			llama_7b_stage_1_batch_1_layer_7_norm1 -> llama_7b_stage_1_batch_1_layer_7_qkv
			llama_7b_stage_1_batch_1_layer_7_qkv -> llama_7b_stage_1_batch_1_layer_7_attn
			llama_7b_stage_1_batch_1_layer_7_attn -> llama_7b_stage_1_batch_1_layer_7_attn_out
			llama_7b_stage_1_batch_1_layer_7_attn_out -> llama_7b_stage_1_batch_1_layer_7_attn_res
			llama_7b_stage_1_batch_1_layer_7_attn_res -> llama_7b_stage_1_batch_1_layer_7_norm2
			llama_7b_stage_1_batch_1_layer_7_norm2 -> llama_7b_stage_1_batch_1_layer_7_ffn_up
			llama_7b_stage_1_batch_1_layer_7_ffn_up -> llama_7b_stage_1_batch_1_layer_7_ffn_gate
			llama_7b_stage_1_batch_1_layer_7_ffn_gate -> llama_7b_stage_1_batch_1_layer_7_ffn_down
			llama_7b_stage_1_batch_1_layer_7_ffn_down -> llama_7b_stage_1_batch_1_layer_7_ffn_res
			llama_7b_stage_1_batch_1_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_1_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_1_layer_7_ffn_res -> llama_7b_stage_1_batch_1_layer_8_norm1
			llama_7b_stage_1_batch_1_layer_8_norm1 -> llama_7b_stage_1_batch_1_layer_8_qkv
			llama_7b_stage_1_batch_1_layer_8_qkv -> llama_7b_stage_1_batch_1_layer_8_attn
			llama_7b_stage_1_batch_1_layer_8_attn -> llama_7b_stage_1_batch_1_layer_8_attn_out
			llama_7b_stage_1_batch_1_layer_8_attn_out -> llama_7b_stage_1_batch_1_layer_8_attn_res
			llama_7b_stage_1_batch_1_layer_8_attn_res -> llama_7b_stage_1_batch_1_layer_8_norm2
			llama_7b_stage_1_batch_1_layer_8_norm2 -> llama_7b_stage_1_batch_1_layer_8_ffn_up
			llama_7b_stage_1_batch_1_layer_8_ffn_up -> llama_7b_stage_1_batch_1_layer_8_ffn_gate
			llama_7b_stage_1_batch_1_layer_8_ffn_gate -> llama_7b_stage_1_batch_1_layer_8_ffn_down
			llama_7b_stage_1_batch_1_layer_8_ffn_down -> llama_7b_stage_1_batch_1_layer_8_ffn_res
			llama_7b_stage_1_batch_1_output [label="Stage 1 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_1_layer_8_ffn_res -> llama_7b_stage_1_batch_1_output
			llama_7b_stage_1_batch_2_input [label="Micro-batch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_input -> llama_7b_stage_1_batch_2_layer_1_norm1
			llama_7b_stage_1_batch_2_layer_1_norm1 -> llama_7b_stage_1_batch_2_layer_1_qkv
			llama_7b_stage_1_batch_2_layer_1_qkv -> llama_7b_stage_1_batch_2_layer_1_attn
			llama_7b_stage_1_batch_2_layer_1_attn -> llama_7b_stage_1_batch_2_layer_1_attn_out
			llama_7b_stage_1_batch_2_layer_1_attn_out -> llama_7b_stage_1_batch_2_layer_1_attn_res
			llama_7b_stage_1_batch_2_layer_1_attn_res -> llama_7b_stage_1_batch_2_layer_1_norm2
			llama_7b_stage_1_batch_2_layer_1_norm2 -> llama_7b_stage_1_batch_2_layer_1_ffn_up
			llama_7b_stage_1_batch_2_layer_1_ffn_up -> llama_7b_stage_1_batch_2_layer_1_ffn_gate
			llama_7b_stage_1_batch_2_layer_1_ffn_gate -> llama_7b_stage_1_batch_2_layer_1_ffn_down
			llama_7b_stage_1_batch_2_layer_1_ffn_down -> llama_7b_stage_1_batch_2_layer_1_ffn_res
			llama_7b_stage_1_batch_2_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_1_ffn_res -> llama_7b_stage_1_batch_2_layer_2_norm1
			llama_7b_stage_1_batch_2_layer_2_norm1 -> llama_7b_stage_1_batch_2_layer_2_qkv
			llama_7b_stage_1_batch_2_layer_2_qkv -> llama_7b_stage_1_batch_2_layer_2_attn
			llama_7b_stage_1_batch_2_layer_2_attn -> llama_7b_stage_1_batch_2_layer_2_attn_out
			llama_7b_stage_1_batch_2_layer_2_attn_out -> llama_7b_stage_1_batch_2_layer_2_attn_res
			llama_7b_stage_1_batch_2_layer_2_attn_res -> llama_7b_stage_1_batch_2_layer_2_norm2
			llama_7b_stage_1_batch_2_layer_2_norm2 -> llama_7b_stage_1_batch_2_layer_2_ffn_up
			llama_7b_stage_1_batch_2_layer_2_ffn_up -> llama_7b_stage_1_batch_2_layer_2_ffn_gate
			llama_7b_stage_1_batch_2_layer_2_ffn_gate -> llama_7b_stage_1_batch_2_layer_2_ffn_down
			llama_7b_stage_1_batch_2_layer_2_ffn_down -> llama_7b_stage_1_batch_2_layer_2_ffn_res
			llama_7b_stage_1_batch_2_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_2_ffn_res -> llama_7b_stage_1_batch_2_layer_3_norm1
			llama_7b_stage_1_batch_2_layer_3_norm1 -> llama_7b_stage_1_batch_2_layer_3_qkv
			llama_7b_stage_1_batch_2_layer_3_qkv -> llama_7b_stage_1_batch_2_layer_3_attn
			llama_7b_stage_1_batch_2_layer_3_attn -> llama_7b_stage_1_batch_2_layer_3_attn_out
			llama_7b_stage_1_batch_2_layer_3_attn_out -> llama_7b_stage_1_batch_2_layer_3_attn_res
			llama_7b_stage_1_batch_2_layer_3_attn_res -> llama_7b_stage_1_batch_2_layer_3_norm2
			llama_7b_stage_1_batch_2_layer_3_norm2 -> llama_7b_stage_1_batch_2_layer_3_ffn_up
			llama_7b_stage_1_batch_2_layer_3_ffn_up -> llama_7b_stage_1_batch_2_layer_3_ffn_gate
			llama_7b_stage_1_batch_2_layer_3_ffn_gate -> llama_7b_stage_1_batch_2_layer_3_ffn_down
			llama_7b_stage_1_batch_2_layer_3_ffn_down -> llama_7b_stage_1_batch_2_layer_3_ffn_res
			llama_7b_stage_1_batch_2_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_3_ffn_res -> llama_7b_stage_1_batch_2_layer_4_norm1
			llama_7b_stage_1_batch_2_layer_4_norm1 -> llama_7b_stage_1_batch_2_layer_4_qkv
			llama_7b_stage_1_batch_2_layer_4_qkv -> llama_7b_stage_1_batch_2_layer_4_attn
			llama_7b_stage_1_batch_2_layer_4_attn -> llama_7b_stage_1_batch_2_layer_4_attn_out
			llama_7b_stage_1_batch_2_layer_4_attn_out -> llama_7b_stage_1_batch_2_layer_4_attn_res
			llama_7b_stage_1_batch_2_layer_4_attn_res -> llama_7b_stage_1_batch_2_layer_4_norm2
			llama_7b_stage_1_batch_2_layer_4_norm2 -> llama_7b_stage_1_batch_2_layer_4_ffn_up
			llama_7b_stage_1_batch_2_layer_4_ffn_up -> llama_7b_stage_1_batch_2_layer_4_ffn_gate
			llama_7b_stage_1_batch_2_layer_4_ffn_gate -> llama_7b_stage_1_batch_2_layer_4_ffn_down
			llama_7b_stage_1_batch_2_layer_4_ffn_down -> llama_7b_stage_1_batch_2_layer_4_ffn_res
			llama_7b_stage_1_batch_2_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_4_ffn_res -> llama_7b_stage_1_batch_2_layer_5_norm1
			llama_7b_stage_1_batch_2_layer_5_norm1 -> llama_7b_stage_1_batch_2_layer_5_qkv
			llama_7b_stage_1_batch_2_layer_5_qkv -> llama_7b_stage_1_batch_2_layer_5_attn
			llama_7b_stage_1_batch_2_layer_5_attn -> llama_7b_stage_1_batch_2_layer_5_attn_out
			llama_7b_stage_1_batch_2_layer_5_attn_out -> llama_7b_stage_1_batch_2_layer_5_attn_res
			llama_7b_stage_1_batch_2_layer_5_attn_res -> llama_7b_stage_1_batch_2_layer_5_norm2
			llama_7b_stage_1_batch_2_layer_5_norm2 -> llama_7b_stage_1_batch_2_layer_5_ffn_up
			llama_7b_stage_1_batch_2_layer_5_ffn_up -> llama_7b_stage_1_batch_2_layer_5_ffn_gate
			llama_7b_stage_1_batch_2_layer_5_ffn_gate -> llama_7b_stage_1_batch_2_layer_5_ffn_down
			llama_7b_stage_1_batch_2_layer_5_ffn_down -> llama_7b_stage_1_batch_2_layer_5_ffn_res
			llama_7b_stage_1_batch_2_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_5_ffn_res -> llama_7b_stage_1_batch_2_layer_6_norm1
			llama_7b_stage_1_batch_2_layer_6_norm1 -> llama_7b_stage_1_batch_2_layer_6_qkv
			llama_7b_stage_1_batch_2_layer_6_qkv -> llama_7b_stage_1_batch_2_layer_6_attn
			llama_7b_stage_1_batch_2_layer_6_attn -> llama_7b_stage_1_batch_2_layer_6_attn_out
			llama_7b_stage_1_batch_2_layer_6_attn_out -> llama_7b_stage_1_batch_2_layer_6_attn_res
			llama_7b_stage_1_batch_2_layer_6_attn_res -> llama_7b_stage_1_batch_2_layer_6_norm2
			llama_7b_stage_1_batch_2_layer_6_norm2 -> llama_7b_stage_1_batch_2_layer_6_ffn_up
			llama_7b_stage_1_batch_2_layer_6_ffn_up -> llama_7b_stage_1_batch_2_layer_6_ffn_gate
			llama_7b_stage_1_batch_2_layer_6_ffn_gate -> llama_7b_stage_1_batch_2_layer_6_ffn_down
			llama_7b_stage_1_batch_2_layer_6_ffn_down -> llama_7b_stage_1_batch_2_layer_6_ffn_res
			llama_7b_stage_1_batch_2_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_6_ffn_res -> llama_7b_stage_1_batch_2_layer_7_norm1
			llama_7b_stage_1_batch_2_layer_7_norm1 -> llama_7b_stage_1_batch_2_layer_7_qkv
			llama_7b_stage_1_batch_2_layer_7_qkv -> llama_7b_stage_1_batch_2_layer_7_attn
			llama_7b_stage_1_batch_2_layer_7_attn -> llama_7b_stage_1_batch_2_layer_7_attn_out
			llama_7b_stage_1_batch_2_layer_7_attn_out -> llama_7b_stage_1_batch_2_layer_7_attn_res
			llama_7b_stage_1_batch_2_layer_7_attn_res -> llama_7b_stage_1_batch_2_layer_7_norm2
			llama_7b_stage_1_batch_2_layer_7_norm2 -> llama_7b_stage_1_batch_2_layer_7_ffn_up
			llama_7b_stage_1_batch_2_layer_7_ffn_up -> llama_7b_stage_1_batch_2_layer_7_ffn_gate
			llama_7b_stage_1_batch_2_layer_7_ffn_gate -> llama_7b_stage_1_batch_2_layer_7_ffn_down
			llama_7b_stage_1_batch_2_layer_7_ffn_down -> llama_7b_stage_1_batch_2_layer_7_ffn_res
			llama_7b_stage_1_batch_2_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_2_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_2_layer_7_ffn_res -> llama_7b_stage_1_batch_2_layer_8_norm1
			llama_7b_stage_1_batch_2_layer_8_norm1 -> llama_7b_stage_1_batch_2_layer_8_qkv
			llama_7b_stage_1_batch_2_layer_8_qkv -> llama_7b_stage_1_batch_2_layer_8_attn
			llama_7b_stage_1_batch_2_layer_8_attn -> llama_7b_stage_1_batch_2_layer_8_attn_out
			llama_7b_stage_1_batch_2_layer_8_attn_out -> llama_7b_stage_1_batch_2_layer_8_attn_res
			llama_7b_stage_1_batch_2_layer_8_attn_res -> llama_7b_stage_1_batch_2_layer_8_norm2
			llama_7b_stage_1_batch_2_layer_8_norm2 -> llama_7b_stage_1_batch_2_layer_8_ffn_up
			llama_7b_stage_1_batch_2_layer_8_ffn_up -> llama_7b_stage_1_batch_2_layer_8_ffn_gate
			llama_7b_stage_1_batch_2_layer_8_ffn_gate -> llama_7b_stage_1_batch_2_layer_8_ffn_down
			llama_7b_stage_1_batch_2_layer_8_ffn_down -> llama_7b_stage_1_batch_2_layer_8_ffn_res
			llama_7b_stage_1_batch_2_output [label="Stage 1 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_2_layer_8_ffn_res -> llama_7b_stage_1_batch_2_output
			llama_7b_stage_1_batch_3_input [label="Micro-batch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_input -> llama_7b_stage_1_batch_3_layer_1_norm1
			llama_7b_stage_1_batch_3_layer_1_norm1 -> llama_7b_stage_1_batch_3_layer_1_qkv
			llama_7b_stage_1_batch_3_layer_1_qkv -> llama_7b_stage_1_batch_3_layer_1_attn
			llama_7b_stage_1_batch_3_layer_1_attn -> llama_7b_stage_1_batch_3_layer_1_attn_out
			llama_7b_stage_1_batch_3_layer_1_attn_out -> llama_7b_stage_1_batch_3_layer_1_attn_res
			llama_7b_stage_1_batch_3_layer_1_attn_res -> llama_7b_stage_1_batch_3_layer_1_norm2
			llama_7b_stage_1_batch_3_layer_1_norm2 -> llama_7b_stage_1_batch_3_layer_1_ffn_up
			llama_7b_stage_1_batch_3_layer_1_ffn_up -> llama_7b_stage_1_batch_3_layer_1_ffn_gate
			llama_7b_stage_1_batch_3_layer_1_ffn_gate -> llama_7b_stage_1_batch_3_layer_1_ffn_down
			llama_7b_stage_1_batch_3_layer_1_ffn_down -> llama_7b_stage_1_batch_3_layer_1_ffn_res
			llama_7b_stage_1_batch_3_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_1_ffn_res -> llama_7b_stage_1_batch_3_layer_2_norm1
			llama_7b_stage_1_batch_3_layer_2_norm1 -> llama_7b_stage_1_batch_3_layer_2_qkv
			llama_7b_stage_1_batch_3_layer_2_qkv -> llama_7b_stage_1_batch_3_layer_2_attn
			llama_7b_stage_1_batch_3_layer_2_attn -> llama_7b_stage_1_batch_3_layer_2_attn_out
			llama_7b_stage_1_batch_3_layer_2_attn_out -> llama_7b_stage_1_batch_3_layer_2_attn_res
			llama_7b_stage_1_batch_3_layer_2_attn_res -> llama_7b_stage_1_batch_3_layer_2_norm2
			llama_7b_stage_1_batch_3_layer_2_norm2 -> llama_7b_stage_1_batch_3_layer_2_ffn_up
			llama_7b_stage_1_batch_3_layer_2_ffn_up -> llama_7b_stage_1_batch_3_layer_2_ffn_gate
			llama_7b_stage_1_batch_3_layer_2_ffn_gate -> llama_7b_stage_1_batch_3_layer_2_ffn_down
			llama_7b_stage_1_batch_3_layer_2_ffn_down -> llama_7b_stage_1_batch_3_layer_2_ffn_res
			llama_7b_stage_1_batch_3_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_2_ffn_res -> llama_7b_stage_1_batch_3_layer_3_norm1
			llama_7b_stage_1_batch_3_layer_3_norm1 -> llama_7b_stage_1_batch_3_layer_3_qkv
			llama_7b_stage_1_batch_3_layer_3_qkv -> llama_7b_stage_1_batch_3_layer_3_attn
			llama_7b_stage_1_batch_3_layer_3_attn -> llama_7b_stage_1_batch_3_layer_3_attn_out
			llama_7b_stage_1_batch_3_layer_3_attn_out -> llama_7b_stage_1_batch_3_layer_3_attn_res
			llama_7b_stage_1_batch_3_layer_3_attn_res -> llama_7b_stage_1_batch_3_layer_3_norm2
			llama_7b_stage_1_batch_3_layer_3_norm2 -> llama_7b_stage_1_batch_3_layer_3_ffn_up
			llama_7b_stage_1_batch_3_layer_3_ffn_up -> llama_7b_stage_1_batch_3_layer_3_ffn_gate
			llama_7b_stage_1_batch_3_layer_3_ffn_gate -> llama_7b_stage_1_batch_3_layer_3_ffn_down
			llama_7b_stage_1_batch_3_layer_3_ffn_down -> llama_7b_stage_1_batch_3_layer_3_ffn_res
			llama_7b_stage_1_batch_3_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_3_ffn_res -> llama_7b_stage_1_batch_3_layer_4_norm1
			llama_7b_stage_1_batch_3_layer_4_norm1 -> llama_7b_stage_1_batch_3_layer_4_qkv
			llama_7b_stage_1_batch_3_layer_4_qkv -> llama_7b_stage_1_batch_3_layer_4_attn
			llama_7b_stage_1_batch_3_layer_4_attn -> llama_7b_stage_1_batch_3_layer_4_attn_out
			llama_7b_stage_1_batch_3_layer_4_attn_out -> llama_7b_stage_1_batch_3_layer_4_attn_res
			llama_7b_stage_1_batch_3_layer_4_attn_res -> llama_7b_stage_1_batch_3_layer_4_norm2
			llama_7b_stage_1_batch_3_layer_4_norm2 -> llama_7b_stage_1_batch_3_layer_4_ffn_up
			llama_7b_stage_1_batch_3_layer_4_ffn_up -> llama_7b_stage_1_batch_3_layer_4_ffn_gate
			llama_7b_stage_1_batch_3_layer_4_ffn_gate -> llama_7b_stage_1_batch_3_layer_4_ffn_down
			llama_7b_stage_1_batch_3_layer_4_ffn_down -> llama_7b_stage_1_batch_3_layer_4_ffn_res
			llama_7b_stage_1_batch_3_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_4_ffn_res -> llama_7b_stage_1_batch_3_layer_5_norm1
			llama_7b_stage_1_batch_3_layer_5_norm1 -> llama_7b_stage_1_batch_3_layer_5_qkv
			llama_7b_stage_1_batch_3_layer_5_qkv -> llama_7b_stage_1_batch_3_layer_5_attn
			llama_7b_stage_1_batch_3_layer_5_attn -> llama_7b_stage_1_batch_3_layer_5_attn_out
			llama_7b_stage_1_batch_3_layer_5_attn_out -> llama_7b_stage_1_batch_3_layer_5_attn_res
			llama_7b_stage_1_batch_3_layer_5_attn_res -> llama_7b_stage_1_batch_3_layer_5_norm2
			llama_7b_stage_1_batch_3_layer_5_norm2 -> llama_7b_stage_1_batch_3_layer_5_ffn_up
			llama_7b_stage_1_batch_3_layer_5_ffn_up -> llama_7b_stage_1_batch_3_layer_5_ffn_gate
			llama_7b_stage_1_batch_3_layer_5_ffn_gate -> llama_7b_stage_1_batch_3_layer_5_ffn_down
			llama_7b_stage_1_batch_3_layer_5_ffn_down -> llama_7b_stage_1_batch_3_layer_5_ffn_res
			llama_7b_stage_1_batch_3_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_5_ffn_res -> llama_7b_stage_1_batch_3_layer_6_norm1
			llama_7b_stage_1_batch_3_layer_6_norm1 -> llama_7b_stage_1_batch_3_layer_6_qkv
			llama_7b_stage_1_batch_3_layer_6_qkv -> llama_7b_stage_1_batch_3_layer_6_attn
			llama_7b_stage_1_batch_3_layer_6_attn -> llama_7b_stage_1_batch_3_layer_6_attn_out
			llama_7b_stage_1_batch_3_layer_6_attn_out -> llama_7b_stage_1_batch_3_layer_6_attn_res
			llama_7b_stage_1_batch_3_layer_6_attn_res -> llama_7b_stage_1_batch_3_layer_6_norm2
			llama_7b_stage_1_batch_3_layer_6_norm2 -> llama_7b_stage_1_batch_3_layer_6_ffn_up
			llama_7b_stage_1_batch_3_layer_6_ffn_up -> llama_7b_stage_1_batch_3_layer_6_ffn_gate
			llama_7b_stage_1_batch_3_layer_6_ffn_gate -> llama_7b_stage_1_batch_3_layer_6_ffn_down
			llama_7b_stage_1_batch_3_layer_6_ffn_down -> llama_7b_stage_1_batch_3_layer_6_ffn_res
			llama_7b_stage_1_batch_3_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_6_ffn_res -> llama_7b_stage_1_batch_3_layer_7_norm1
			llama_7b_stage_1_batch_3_layer_7_norm1 -> llama_7b_stage_1_batch_3_layer_7_qkv
			llama_7b_stage_1_batch_3_layer_7_qkv -> llama_7b_stage_1_batch_3_layer_7_attn
			llama_7b_stage_1_batch_3_layer_7_attn -> llama_7b_stage_1_batch_3_layer_7_attn_out
			llama_7b_stage_1_batch_3_layer_7_attn_out -> llama_7b_stage_1_batch_3_layer_7_attn_res
			llama_7b_stage_1_batch_3_layer_7_attn_res -> llama_7b_stage_1_batch_3_layer_7_norm2
			llama_7b_stage_1_batch_3_layer_7_norm2 -> llama_7b_stage_1_batch_3_layer_7_ffn_up
			llama_7b_stage_1_batch_3_layer_7_ffn_up -> llama_7b_stage_1_batch_3_layer_7_ffn_gate
			llama_7b_stage_1_batch_3_layer_7_ffn_gate -> llama_7b_stage_1_batch_3_layer_7_ffn_down
			llama_7b_stage_1_batch_3_layer_7_ffn_down -> llama_7b_stage_1_batch_3_layer_7_ffn_res
			llama_7b_stage_1_batch_3_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_3_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_3_layer_7_ffn_res -> llama_7b_stage_1_batch_3_layer_8_norm1
			llama_7b_stage_1_batch_3_layer_8_norm1 -> llama_7b_stage_1_batch_3_layer_8_qkv
			llama_7b_stage_1_batch_3_layer_8_qkv -> llama_7b_stage_1_batch_3_layer_8_attn
			llama_7b_stage_1_batch_3_layer_8_attn -> llama_7b_stage_1_batch_3_layer_8_attn_out
			llama_7b_stage_1_batch_3_layer_8_attn_out -> llama_7b_stage_1_batch_3_layer_8_attn_res
			llama_7b_stage_1_batch_3_layer_8_attn_res -> llama_7b_stage_1_batch_3_layer_8_norm2
			llama_7b_stage_1_batch_3_layer_8_norm2 -> llama_7b_stage_1_batch_3_layer_8_ffn_up
			llama_7b_stage_1_batch_3_layer_8_ffn_up -> llama_7b_stage_1_batch_3_layer_8_ffn_gate
			llama_7b_stage_1_batch_3_layer_8_ffn_gate -> llama_7b_stage_1_batch_3_layer_8_ffn_down
			llama_7b_stage_1_batch_3_layer_8_ffn_down -> llama_7b_stage_1_batch_3_layer_8_ffn_res
			llama_7b_stage_1_batch_3_output [label="Stage 1 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_3_layer_8_ffn_res -> llama_7b_stage_1_batch_3_output
			llama_7b_stage_1_batch_4_input [label="Micro-batch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_input -> llama_7b_stage_1_batch_4_layer_1_norm1
			llama_7b_stage_1_batch_4_layer_1_norm1 -> llama_7b_stage_1_batch_4_layer_1_qkv
			llama_7b_stage_1_batch_4_layer_1_qkv -> llama_7b_stage_1_batch_4_layer_1_attn
			llama_7b_stage_1_batch_4_layer_1_attn -> llama_7b_stage_1_batch_4_layer_1_attn_out
			llama_7b_stage_1_batch_4_layer_1_attn_out -> llama_7b_stage_1_batch_4_layer_1_attn_res
			llama_7b_stage_1_batch_4_layer_1_attn_res -> llama_7b_stage_1_batch_4_layer_1_norm2
			llama_7b_stage_1_batch_4_layer_1_norm2 -> llama_7b_stage_1_batch_4_layer_1_ffn_up
			llama_7b_stage_1_batch_4_layer_1_ffn_up -> llama_7b_stage_1_batch_4_layer_1_ffn_gate
			llama_7b_stage_1_batch_4_layer_1_ffn_gate -> llama_7b_stage_1_batch_4_layer_1_ffn_down
			llama_7b_stage_1_batch_4_layer_1_ffn_down -> llama_7b_stage_1_batch_4_layer_1_ffn_res
			llama_7b_stage_1_batch_4_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_1_ffn_res -> llama_7b_stage_1_batch_4_layer_2_norm1
			llama_7b_stage_1_batch_4_layer_2_norm1 -> llama_7b_stage_1_batch_4_layer_2_qkv
			llama_7b_stage_1_batch_4_layer_2_qkv -> llama_7b_stage_1_batch_4_layer_2_attn
			llama_7b_stage_1_batch_4_layer_2_attn -> llama_7b_stage_1_batch_4_layer_2_attn_out
			llama_7b_stage_1_batch_4_layer_2_attn_out -> llama_7b_stage_1_batch_4_layer_2_attn_res
			llama_7b_stage_1_batch_4_layer_2_attn_res -> llama_7b_stage_1_batch_4_layer_2_norm2
			llama_7b_stage_1_batch_4_layer_2_norm2 -> llama_7b_stage_1_batch_4_layer_2_ffn_up
			llama_7b_stage_1_batch_4_layer_2_ffn_up -> llama_7b_stage_1_batch_4_layer_2_ffn_gate
			llama_7b_stage_1_batch_4_layer_2_ffn_gate -> llama_7b_stage_1_batch_4_layer_2_ffn_down
			llama_7b_stage_1_batch_4_layer_2_ffn_down -> llama_7b_stage_1_batch_4_layer_2_ffn_res
			llama_7b_stage_1_batch_4_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_2_ffn_res -> llama_7b_stage_1_batch_4_layer_3_norm1
			llama_7b_stage_1_batch_4_layer_3_norm1 -> llama_7b_stage_1_batch_4_layer_3_qkv
			llama_7b_stage_1_batch_4_layer_3_qkv -> llama_7b_stage_1_batch_4_layer_3_attn
			llama_7b_stage_1_batch_4_layer_3_attn -> llama_7b_stage_1_batch_4_layer_3_attn_out
			llama_7b_stage_1_batch_4_layer_3_attn_out -> llama_7b_stage_1_batch_4_layer_3_attn_res
			llama_7b_stage_1_batch_4_layer_3_attn_res -> llama_7b_stage_1_batch_4_layer_3_norm2
			llama_7b_stage_1_batch_4_layer_3_norm2 -> llama_7b_stage_1_batch_4_layer_3_ffn_up
			llama_7b_stage_1_batch_4_layer_3_ffn_up -> llama_7b_stage_1_batch_4_layer_3_ffn_gate
			llama_7b_stage_1_batch_4_layer_3_ffn_gate -> llama_7b_stage_1_batch_4_layer_3_ffn_down
			llama_7b_stage_1_batch_4_layer_3_ffn_down -> llama_7b_stage_1_batch_4_layer_3_ffn_res
			llama_7b_stage_1_batch_4_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_3_ffn_res -> llama_7b_stage_1_batch_4_layer_4_norm1
			llama_7b_stage_1_batch_4_layer_4_norm1 -> llama_7b_stage_1_batch_4_layer_4_qkv
			llama_7b_stage_1_batch_4_layer_4_qkv -> llama_7b_stage_1_batch_4_layer_4_attn
			llama_7b_stage_1_batch_4_layer_4_attn -> llama_7b_stage_1_batch_4_layer_4_attn_out
			llama_7b_stage_1_batch_4_layer_4_attn_out -> llama_7b_stage_1_batch_4_layer_4_attn_res
			llama_7b_stage_1_batch_4_layer_4_attn_res -> llama_7b_stage_1_batch_4_layer_4_norm2
			llama_7b_stage_1_batch_4_layer_4_norm2 -> llama_7b_stage_1_batch_4_layer_4_ffn_up
			llama_7b_stage_1_batch_4_layer_4_ffn_up -> llama_7b_stage_1_batch_4_layer_4_ffn_gate
			llama_7b_stage_1_batch_4_layer_4_ffn_gate -> llama_7b_stage_1_batch_4_layer_4_ffn_down
			llama_7b_stage_1_batch_4_layer_4_ffn_down -> llama_7b_stage_1_batch_4_layer_4_ffn_res
			llama_7b_stage_1_batch_4_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_4_ffn_res -> llama_7b_stage_1_batch_4_layer_5_norm1
			llama_7b_stage_1_batch_4_layer_5_norm1 -> llama_7b_stage_1_batch_4_layer_5_qkv
			llama_7b_stage_1_batch_4_layer_5_qkv -> llama_7b_stage_1_batch_4_layer_5_attn
			llama_7b_stage_1_batch_4_layer_5_attn -> llama_7b_stage_1_batch_4_layer_5_attn_out
			llama_7b_stage_1_batch_4_layer_5_attn_out -> llama_7b_stage_1_batch_4_layer_5_attn_res
			llama_7b_stage_1_batch_4_layer_5_attn_res -> llama_7b_stage_1_batch_4_layer_5_norm2
			llama_7b_stage_1_batch_4_layer_5_norm2 -> llama_7b_stage_1_batch_4_layer_5_ffn_up
			llama_7b_stage_1_batch_4_layer_5_ffn_up -> llama_7b_stage_1_batch_4_layer_5_ffn_gate
			llama_7b_stage_1_batch_4_layer_5_ffn_gate -> llama_7b_stage_1_batch_4_layer_5_ffn_down
			llama_7b_stage_1_batch_4_layer_5_ffn_down -> llama_7b_stage_1_batch_4_layer_5_ffn_res
			llama_7b_stage_1_batch_4_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_5_ffn_res -> llama_7b_stage_1_batch_4_layer_6_norm1
			llama_7b_stage_1_batch_4_layer_6_norm1 -> llama_7b_stage_1_batch_4_layer_6_qkv
			llama_7b_stage_1_batch_4_layer_6_qkv -> llama_7b_stage_1_batch_4_layer_6_attn
			llama_7b_stage_1_batch_4_layer_6_attn -> llama_7b_stage_1_batch_4_layer_6_attn_out
			llama_7b_stage_1_batch_4_layer_6_attn_out -> llama_7b_stage_1_batch_4_layer_6_attn_res
			llama_7b_stage_1_batch_4_layer_6_attn_res -> llama_7b_stage_1_batch_4_layer_6_norm2
			llama_7b_stage_1_batch_4_layer_6_norm2 -> llama_7b_stage_1_batch_4_layer_6_ffn_up
			llama_7b_stage_1_batch_4_layer_6_ffn_up -> llama_7b_stage_1_batch_4_layer_6_ffn_gate
			llama_7b_stage_1_batch_4_layer_6_ffn_gate -> llama_7b_stage_1_batch_4_layer_6_ffn_down
			llama_7b_stage_1_batch_4_layer_6_ffn_down -> llama_7b_stage_1_batch_4_layer_6_ffn_res
			llama_7b_stage_1_batch_4_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_6_ffn_res -> llama_7b_stage_1_batch_4_layer_7_norm1
			llama_7b_stage_1_batch_4_layer_7_norm1 -> llama_7b_stage_1_batch_4_layer_7_qkv
			llama_7b_stage_1_batch_4_layer_7_qkv -> llama_7b_stage_1_batch_4_layer_7_attn
			llama_7b_stage_1_batch_4_layer_7_attn -> llama_7b_stage_1_batch_4_layer_7_attn_out
			llama_7b_stage_1_batch_4_layer_7_attn_out -> llama_7b_stage_1_batch_4_layer_7_attn_res
			llama_7b_stage_1_batch_4_layer_7_attn_res -> llama_7b_stage_1_batch_4_layer_7_norm2
			llama_7b_stage_1_batch_4_layer_7_norm2 -> llama_7b_stage_1_batch_4_layer_7_ffn_up
			llama_7b_stage_1_batch_4_layer_7_ffn_up -> llama_7b_stage_1_batch_4_layer_7_ffn_gate
			llama_7b_stage_1_batch_4_layer_7_ffn_gate -> llama_7b_stage_1_batch_4_layer_7_ffn_down
			llama_7b_stage_1_batch_4_layer_7_ffn_down -> llama_7b_stage_1_batch_4_layer_7_ffn_res
			llama_7b_stage_1_batch_4_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_1_batch_4_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_1_batch_4_layer_7_ffn_res -> llama_7b_stage_1_batch_4_layer_8_norm1
			llama_7b_stage_1_batch_4_layer_8_norm1 -> llama_7b_stage_1_batch_4_layer_8_qkv
			llama_7b_stage_1_batch_4_layer_8_qkv -> llama_7b_stage_1_batch_4_layer_8_attn
			llama_7b_stage_1_batch_4_layer_8_attn -> llama_7b_stage_1_batch_4_layer_8_attn_out
			llama_7b_stage_1_batch_4_layer_8_attn_out -> llama_7b_stage_1_batch_4_layer_8_attn_res
			llama_7b_stage_1_batch_4_layer_8_attn_res -> llama_7b_stage_1_batch_4_layer_8_norm2
			llama_7b_stage_1_batch_4_layer_8_norm2 -> llama_7b_stage_1_batch_4_layer_8_ffn_up
			llama_7b_stage_1_batch_4_layer_8_ffn_up -> llama_7b_stage_1_batch_4_layer_8_ffn_gate
			llama_7b_stage_1_batch_4_layer_8_ffn_gate -> llama_7b_stage_1_batch_4_layer_8_ffn_down
			llama_7b_stage_1_batch_4_layer_8_ffn_down -> llama_7b_stage_1_batch_4_layer_8_ffn_res
			llama_7b_stage_1_batch_4_output [label="Stage 1 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_1_batch_4_layer_8_ffn_res -> llama_7b_stage_1_batch_4_output
		}
		subgraph cluster_llama_7b_stage_2 {
			color=black fillcolor=lightgreen label="Stage 2\nGPU_2\nLayers 9-16" style="rounded,filled"
			llama_7b_stage_2_batch_1_input [label="Micro-batch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_input -> llama_7b_stage_2_batch_1_layer_9_norm1
			llama_7b_stage_2_batch_1_layer_9_norm1 -> llama_7b_stage_2_batch_1_layer_9_qkv
			llama_7b_stage_2_batch_1_layer_9_qkv -> llama_7b_stage_2_batch_1_layer_9_attn
			llama_7b_stage_2_batch_1_layer_9_attn -> llama_7b_stage_2_batch_1_layer_9_attn_out
			llama_7b_stage_2_batch_1_layer_9_attn_out -> llama_7b_stage_2_batch_1_layer_9_attn_res
			llama_7b_stage_2_batch_1_layer_9_attn_res -> llama_7b_stage_2_batch_1_layer_9_norm2
			llama_7b_stage_2_batch_1_layer_9_norm2 -> llama_7b_stage_2_batch_1_layer_9_ffn_up
			llama_7b_stage_2_batch_1_layer_9_ffn_up -> llama_7b_stage_2_batch_1_layer_9_ffn_gate
			llama_7b_stage_2_batch_1_layer_9_ffn_gate -> llama_7b_stage_2_batch_1_layer_9_ffn_down
			llama_7b_stage_2_batch_1_layer_9_ffn_down -> llama_7b_stage_2_batch_1_layer_9_ffn_res
			llama_7b_stage_2_batch_1_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_9_ffn_res -> llama_7b_stage_2_batch_1_layer_10_norm1
			llama_7b_stage_2_batch_1_layer_10_norm1 -> llama_7b_stage_2_batch_1_layer_10_qkv
			llama_7b_stage_2_batch_1_layer_10_qkv -> llama_7b_stage_2_batch_1_layer_10_attn
			llama_7b_stage_2_batch_1_layer_10_attn -> llama_7b_stage_2_batch_1_layer_10_attn_out
			llama_7b_stage_2_batch_1_layer_10_attn_out -> llama_7b_stage_2_batch_1_layer_10_attn_res
			llama_7b_stage_2_batch_1_layer_10_attn_res -> llama_7b_stage_2_batch_1_layer_10_norm2
			llama_7b_stage_2_batch_1_layer_10_norm2 -> llama_7b_stage_2_batch_1_layer_10_ffn_up
			llama_7b_stage_2_batch_1_layer_10_ffn_up -> llama_7b_stage_2_batch_1_layer_10_ffn_gate
			llama_7b_stage_2_batch_1_layer_10_ffn_gate -> llama_7b_stage_2_batch_1_layer_10_ffn_down
			llama_7b_stage_2_batch_1_layer_10_ffn_down -> llama_7b_stage_2_batch_1_layer_10_ffn_res
			llama_7b_stage_2_batch_1_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_10_ffn_res -> llama_7b_stage_2_batch_1_layer_11_norm1
			llama_7b_stage_2_batch_1_layer_11_norm1 -> llama_7b_stage_2_batch_1_layer_11_qkv
			llama_7b_stage_2_batch_1_layer_11_qkv -> llama_7b_stage_2_batch_1_layer_11_attn
			llama_7b_stage_2_batch_1_layer_11_attn -> llama_7b_stage_2_batch_1_layer_11_attn_out
			llama_7b_stage_2_batch_1_layer_11_attn_out -> llama_7b_stage_2_batch_1_layer_11_attn_res
			llama_7b_stage_2_batch_1_layer_11_attn_res -> llama_7b_stage_2_batch_1_layer_11_norm2
			llama_7b_stage_2_batch_1_layer_11_norm2 -> llama_7b_stage_2_batch_1_layer_11_ffn_up
			llama_7b_stage_2_batch_1_layer_11_ffn_up -> llama_7b_stage_2_batch_1_layer_11_ffn_gate
			llama_7b_stage_2_batch_1_layer_11_ffn_gate -> llama_7b_stage_2_batch_1_layer_11_ffn_down
			llama_7b_stage_2_batch_1_layer_11_ffn_down -> llama_7b_stage_2_batch_1_layer_11_ffn_res
			llama_7b_stage_2_batch_1_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_11_ffn_res -> llama_7b_stage_2_batch_1_layer_12_norm1
			llama_7b_stage_2_batch_1_layer_12_norm1 -> llama_7b_stage_2_batch_1_layer_12_qkv
			llama_7b_stage_2_batch_1_layer_12_qkv -> llama_7b_stage_2_batch_1_layer_12_attn
			llama_7b_stage_2_batch_1_layer_12_attn -> llama_7b_stage_2_batch_1_layer_12_attn_out
			llama_7b_stage_2_batch_1_layer_12_attn_out -> llama_7b_stage_2_batch_1_layer_12_attn_res
			llama_7b_stage_2_batch_1_layer_12_attn_res -> llama_7b_stage_2_batch_1_layer_12_norm2
			llama_7b_stage_2_batch_1_layer_12_norm2 -> llama_7b_stage_2_batch_1_layer_12_ffn_up
			llama_7b_stage_2_batch_1_layer_12_ffn_up -> llama_7b_stage_2_batch_1_layer_12_ffn_gate
			llama_7b_stage_2_batch_1_layer_12_ffn_gate -> llama_7b_stage_2_batch_1_layer_12_ffn_down
			llama_7b_stage_2_batch_1_layer_12_ffn_down -> llama_7b_stage_2_batch_1_layer_12_ffn_res
			llama_7b_stage_2_batch_1_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_12_ffn_res -> llama_7b_stage_2_batch_1_layer_13_norm1
			llama_7b_stage_2_batch_1_layer_13_norm1 -> llama_7b_stage_2_batch_1_layer_13_qkv
			llama_7b_stage_2_batch_1_layer_13_qkv -> llama_7b_stage_2_batch_1_layer_13_attn
			llama_7b_stage_2_batch_1_layer_13_attn -> llama_7b_stage_2_batch_1_layer_13_attn_out
			llama_7b_stage_2_batch_1_layer_13_attn_out -> llama_7b_stage_2_batch_1_layer_13_attn_res
			llama_7b_stage_2_batch_1_layer_13_attn_res -> llama_7b_stage_2_batch_1_layer_13_norm2
			llama_7b_stage_2_batch_1_layer_13_norm2 -> llama_7b_stage_2_batch_1_layer_13_ffn_up
			llama_7b_stage_2_batch_1_layer_13_ffn_up -> llama_7b_stage_2_batch_1_layer_13_ffn_gate
			llama_7b_stage_2_batch_1_layer_13_ffn_gate -> llama_7b_stage_2_batch_1_layer_13_ffn_down
			llama_7b_stage_2_batch_1_layer_13_ffn_down -> llama_7b_stage_2_batch_1_layer_13_ffn_res
			llama_7b_stage_2_batch_1_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_13_ffn_res -> llama_7b_stage_2_batch_1_layer_14_norm1
			llama_7b_stage_2_batch_1_layer_14_norm1 -> llama_7b_stage_2_batch_1_layer_14_qkv
			llama_7b_stage_2_batch_1_layer_14_qkv -> llama_7b_stage_2_batch_1_layer_14_attn
			llama_7b_stage_2_batch_1_layer_14_attn -> llama_7b_stage_2_batch_1_layer_14_attn_out
			llama_7b_stage_2_batch_1_layer_14_attn_out -> llama_7b_stage_2_batch_1_layer_14_attn_res
			llama_7b_stage_2_batch_1_layer_14_attn_res -> llama_7b_stage_2_batch_1_layer_14_norm2
			llama_7b_stage_2_batch_1_layer_14_norm2 -> llama_7b_stage_2_batch_1_layer_14_ffn_up
			llama_7b_stage_2_batch_1_layer_14_ffn_up -> llama_7b_stage_2_batch_1_layer_14_ffn_gate
			llama_7b_stage_2_batch_1_layer_14_ffn_gate -> llama_7b_stage_2_batch_1_layer_14_ffn_down
			llama_7b_stage_2_batch_1_layer_14_ffn_down -> llama_7b_stage_2_batch_1_layer_14_ffn_res
			llama_7b_stage_2_batch_1_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_14_ffn_res -> llama_7b_stage_2_batch_1_layer_15_norm1
			llama_7b_stage_2_batch_1_layer_15_norm1 -> llama_7b_stage_2_batch_1_layer_15_qkv
			llama_7b_stage_2_batch_1_layer_15_qkv -> llama_7b_stage_2_batch_1_layer_15_attn
			llama_7b_stage_2_batch_1_layer_15_attn -> llama_7b_stage_2_batch_1_layer_15_attn_out
			llama_7b_stage_2_batch_1_layer_15_attn_out -> llama_7b_stage_2_batch_1_layer_15_attn_res
			llama_7b_stage_2_batch_1_layer_15_attn_res -> llama_7b_stage_2_batch_1_layer_15_norm2
			llama_7b_stage_2_batch_1_layer_15_norm2 -> llama_7b_stage_2_batch_1_layer_15_ffn_up
			llama_7b_stage_2_batch_1_layer_15_ffn_up -> llama_7b_stage_2_batch_1_layer_15_ffn_gate
			llama_7b_stage_2_batch_1_layer_15_ffn_gate -> llama_7b_stage_2_batch_1_layer_15_ffn_down
			llama_7b_stage_2_batch_1_layer_15_ffn_down -> llama_7b_stage_2_batch_1_layer_15_ffn_res
			llama_7b_stage_2_batch_1_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_1_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_1_layer_15_ffn_res -> llama_7b_stage_2_batch_1_layer_16_norm1
			llama_7b_stage_2_batch_1_layer_16_norm1 -> llama_7b_stage_2_batch_1_layer_16_qkv
			llama_7b_stage_2_batch_1_layer_16_qkv -> llama_7b_stage_2_batch_1_layer_16_attn
			llama_7b_stage_2_batch_1_layer_16_attn -> llama_7b_stage_2_batch_1_layer_16_attn_out
			llama_7b_stage_2_batch_1_layer_16_attn_out -> llama_7b_stage_2_batch_1_layer_16_attn_res
			llama_7b_stage_2_batch_1_layer_16_attn_res -> llama_7b_stage_2_batch_1_layer_16_norm2
			llama_7b_stage_2_batch_1_layer_16_norm2 -> llama_7b_stage_2_batch_1_layer_16_ffn_up
			llama_7b_stage_2_batch_1_layer_16_ffn_up -> llama_7b_stage_2_batch_1_layer_16_ffn_gate
			llama_7b_stage_2_batch_1_layer_16_ffn_gate -> llama_7b_stage_2_batch_1_layer_16_ffn_down
			llama_7b_stage_2_batch_1_layer_16_ffn_down -> llama_7b_stage_2_batch_1_layer_16_ffn_res
			llama_7b_stage_2_batch_1_output [label="Stage 2 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_1_layer_16_ffn_res -> llama_7b_stage_2_batch_1_output
			llama_7b_stage_2_batch_2_input [label="Micro-batch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_input -> llama_7b_stage_2_batch_2_layer_9_norm1
			llama_7b_stage_2_batch_2_layer_9_norm1 -> llama_7b_stage_2_batch_2_layer_9_qkv
			llama_7b_stage_2_batch_2_layer_9_qkv -> llama_7b_stage_2_batch_2_layer_9_attn
			llama_7b_stage_2_batch_2_layer_9_attn -> llama_7b_stage_2_batch_2_layer_9_attn_out
			llama_7b_stage_2_batch_2_layer_9_attn_out -> llama_7b_stage_2_batch_2_layer_9_attn_res
			llama_7b_stage_2_batch_2_layer_9_attn_res -> llama_7b_stage_2_batch_2_layer_9_norm2
			llama_7b_stage_2_batch_2_layer_9_norm2 -> llama_7b_stage_2_batch_2_layer_9_ffn_up
			llama_7b_stage_2_batch_2_layer_9_ffn_up -> llama_7b_stage_2_batch_2_layer_9_ffn_gate
			llama_7b_stage_2_batch_2_layer_9_ffn_gate -> llama_7b_stage_2_batch_2_layer_9_ffn_down
			llama_7b_stage_2_batch_2_layer_9_ffn_down -> llama_7b_stage_2_batch_2_layer_9_ffn_res
			llama_7b_stage_2_batch_2_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_9_ffn_res -> llama_7b_stage_2_batch_2_layer_10_norm1
			llama_7b_stage_2_batch_2_layer_10_norm1 -> llama_7b_stage_2_batch_2_layer_10_qkv
			llama_7b_stage_2_batch_2_layer_10_qkv -> llama_7b_stage_2_batch_2_layer_10_attn
			llama_7b_stage_2_batch_2_layer_10_attn -> llama_7b_stage_2_batch_2_layer_10_attn_out
			llama_7b_stage_2_batch_2_layer_10_attn_out -> llama_7b_stage_2_batch_2_layer_10_attn_res
			llama_7b_stage_2_batch_2_layer_10_attn_res -> llama_7b_stage_2_batch_2_layer_10_norm2
			llama_7b_stage_2_batch_2_layer_10_norm2 -> llama_7b_stage_2_batch_2_layer_10_ffn_up
			llama_7b_stage_2_batch_2_layer_10_ffn_up -> llama_7b_stage_2_batch_2_layer_10_ffn_gate
			llama_7b_stage_2_batch_2_layer_10_ffn_gate -> llama_7b_stage_2_batch_2_layer_10_ffn_down
			llama_7b_stage_2_batch_2_layer_10_ffn_down -> llama_7b_stage_2_batch_2_layer_10_ffn_res
			llama_7b_stage_2_batch_2_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_10_ffn_res -> llama_7b_stage_2_batch_2_layer_11_norm1
			llama_7b_stage_2_batch_2_layer_11_norm1 -> llama_7b_stage_2_batch_2_layer_11_qkv
			llama_7b_stage_2_batch_2_layer_11_qkv -> llama_7b_stage_2_batch_2_layer_11_attn
			llama_7b_stage_2_batch_2_layer_11_attn -> llama_7b_stage_2_batch_2_layer_11_attn_out
			llama_7b_stage_2_batch_2_layer_11_attn_out -> llama_7b_stage_2_batch_2_layer_11_attn_res
			llama_7b_stage_2_batch_2_layer_11_attn_res -> llama_7b_stage_2_batch_2_layer_11_norm2
			llama_7b_stage_2_batch_2_layer_11_norm2 -> llama_7b_stage_2_batch_2_layer_11_ffn_up
			llama_7b_stage_2_batch_2_layer_11_ffn_up -> llama_7b_stage_2_batch_2_layer_11_ffn_gate
			llama_7b_stage_2_batch_2_layer_11_ffn_gate -> llama_7b_stage_2_batch_2_layer_11_ffn_down
			llama_7b_stage_2_batch_2_layer_11_ffn_down -> llama_7b_stage_2_batch_2_layer_11_ffn_res
			llama_7b_stage_2_batch_2_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_11_ffn_res -> llama_7b_stage_2_batch_2_layer_12_norm1
			llama_7b_stage_2_batch_2_layer_12_norm1 -> llama_7b_stage_2_batch_2_layer_12_qkv
			llama_7b_stage_2_batch_2_layer_12_qkv -> llama_7b_stage_2_batch_2_layer_12_attn
			llama_7b_stage_2_batch_2_layer_12_attn -> llama_7b_stage_2_batch_2_layer_12_attn_out
			llama_7b_stage_2_batch_2_layer_12_attn_out -> llama_7b_stage_2_batch_2_layer_12_attn_res
			llama_7b_stage_2_batch_2_layer_12_attn_res -> llama_7b_stage_2_batch_2_layer_12_norm2
			llama_7b_stage_2_batch_2_layer_12_norm2 -> llama_7b_stage_2_batch_2_layer_12_ffn_up
			llama_7b_stage_2_batch_2_layer_12_ffn_up -> llama_7b_stage_2_batch_2_layer_12_ffn_gate
			llama_7b_stage_2_batch_2_layer_12_ffn_gate -> llama_7b_stage_2_batch_2_layer_12_ffn_down
			llama_7b_stage_2_batch_2_layer_12_ffn_down -> llama_7b_stage_2_batch_2_layer_12_ffn_res
			llama_7b_stage_2_batch_2_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_12_ffn_res -> llama_7b_stage_2_batch_2_layer_13_norm1
			llama_7b_stage_2_batch_2_layer_13_norm1 -> llama_7b_stage_2_batch_2_layer_13_qkv
			llama_7b_stage_2_batch_2_layer_13_qkv -> llama_7b_stage_2_batch_2_layer_13_attn
			llama_7b_stage_2_batch_2_layer_13_attn -> llama_7b_stage_2_batch_2_layer_13_attn_out
			llama_7b_stage_2_batch_2_layer_13_attn_out -> llama_7b_stage_2_batch_2_layer_13_attn_res
			llama_7b_stage_2_batch_2_layer_13_attn_res -> llama_7b_stage_2_batch_2_layer_13_norm2
			llama_7b_stage_2_batch_2_layer_13_norm2 -> llama_7b_stage_2_batch_2_layer_13_ffn_up
			llama_7b_stage_2_batch_2_layer_13_ffn_up -> llama_7b_stage_2_batch_2_layer_13_ffn_gate
			llama_7b_stage_2_batch_2_layer_13_ffn_gate -> llama_7b_stage_2_batch_2_layer_13_ffn_down
			llama_7b_stage_2_batch_2_layer_13_ffn_down -> llama_7b_stage_2_batch_2_layer_13_ffn_res
			llama_7b_stage_2_batch_2_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_13_ffn_res -> llama_7b_stage_2_batch_2_layer_14_norm1
			llama_7b_stage_2_batch_2_layer_14_norm1 -> llama_7b_stage_2_batch_2_layer_14_qkv
			llama_7b_stage_2_batch_2_layer_14_qkv -> llama_7b_stage_2_batch_2_layer_14_attn
			llama_7b_stage_2_batch_2_layer_14_attn -> llama_7b_stage_2_batch_2_layer_14_attn_out
			llama_7b_stage_2_batch_2_layer_14_attn_out -> llama_7b_stage_2_batch_2_layer_14_attn_res
			llama_7b_stage_2_batch_2_layer_14_attn_res -> llama_7b_stage_2_batch_2_layer_14_norm2
			llama_7b_stage_2_batch_2_layer_14_norm2 -> llama_7b_stage_2_batch_2_layer_14_ffn_up
			llama_7b_stage_2_batch_2_layer_14_ffn_up -> llama_7b_stage_2_batch_2_layer_14_ffn_gate
			llama_7b_stage_2_batch_2_layer_14_ffn_gate -> llama_7b_stage_2_batch_2_layer_14_ffn_down
			llama_7b_stage_2_batch_2_layer_14_ffn_down -> llama_7b_stage_2_batch_2_layer_14_ffn_res
			llama_7b_stage_2_batch_2_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_14_ffn_res -> llama_7b_stage_2_batch_2_layer_15_norm1
			llama_7b_stage_2_batch_2_layer_15_norm1 -> llama_7b_stage_2_batch_2_layer_15_qkv
			llama_7b_stage_2_batch_2_layer_15_qkv -> llama_7b_stage_2_batch_2_layer_15_attn
			llama_7b_stage_2_batch_2_layer_15_attn -> llama_7b_stage_2_batch_2_layer_15_attn_out
			llama_7b_stage_2_batch_2_layer_15_attn_out -> llama_7b_stage_2_batch_2_layer_15_attn_res
			llama_7b_stage_2_batch_2_layer_15_attn_res -> llama_7b_stage_2_batch_2_layer_15_norm2
			llama_7b_stage_2_batch_2_layer_15_norm2 -> llama_7b_stage_2_batch_2_layer_15_ffn_up
			llama_7b_stage_2_batch_2_layer_15_ffn_up -> llama_7b_stage_2_batch_2_layer_15_ffn_gate
			llama_7b_stage_2_batch_2_layer_15_ffn_gate -> llama_7b_stage_2_batch_2_layer_15_ffn_down
			llama_7b_stage_2_batch_2_layer_15_ffn_down -> llama_7b_stage_2_batch_2_layer_15_ffn_res
			llama_7b_stage_2_batch_2_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_2_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_2_layer_15_ffn_res -> llama_7b_stage_2_batch_2_layer_16_norm1
			llama_7b_stage_2_batch_2_layer_16_norm1 -> llama_7b_stage_2_batch_2_layer_16_qkv
			llama_7b_stage_2_batch_2_layer_16_qkv -> llama_7b_stage_2_batch_2_layer_16_attn
			llama_7b_stage_2_batch_2_layer_16_attn -> llama_7b_stage_2_batch_2_layer_16_attn_out
			llama_7b_stage_2_batch_2_layer_16_attn_out -> llama_7b_stage_2_batch_2_layer_16_attn_res
			llama_7b_stage_2_batch_2_layer_16_attn_res -> llama_7b_stage_2_batch_2_layer_16_norm2
			llama_7b_stage_2_batch_2_layer_16_norm2 -> llama_7b_stage_2_batch_2_layer_16_ffn_up
			llama_7b_stage_2_batch_2_layer_16_ffn_up -> llama_7b_stage_2_batch_2_layer_16_ffn_gate
			llama_7b_stage_2_batch_2_layer_16_ffn_gate -> llama_7b_stage_2_batch_2_layer_16_ffn_down
			llama_7b_stage_2_batch_2_layer_16_ffn_down -> llama_7b_stage_2_batch_2_layer_16_ffn_res
			llama_7b_stage_2_batch_2_output [label="Stage 2 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_2_layer_16_ffn_res -> llama_7b_stage_2_batch_2_output
			llama_7b_stage_2_batch_3_input [label="Micro-batch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_input -> llama_7b_stage_2_batch_3_layer_9_norm1
			llama_7b_stage_2_batch_3_layer_9_norm1 -> llama_7b_stage_2_batch_3_layer_9_qkv
			llama_7b_stage_2_batch_3_layer_9_qkv -> llama_7b_stage_2_batch_3_layer_9_attn
			llama_7b_stage_2_batch_3_layer_9_attn -> llama_7b_stage_2_batch_3_layer_9_attn_out
			llama_7b_stage_2_batch_3_layer_9_attn_out -> llama_7b_stage_2_batch_3_layer_9_attn_res
			llama_7b_stage_2_batch_3_layer_9_attn_res -> llama_7b_stage_2_batch_3_layer_9_norm2
			llama_7b_stage_2_batch_3_layer_9_norm2 -> llama_7b_stage_2_batch_3_layer_9_ffn_up
			llama_7b_stage_2_batch_3_layer_9_ffn_up -> llama_7b_stage_2_batch_3_layer_9_ffn_gate
			llama_7b_stage_2_batch_3_layer_9_ffn_gate -> llama_7b_stage_2_batch_3_layer_9_ffn_down
			llama_7b_stage_2_batch_3_layer_9_ffn_down -> llama_7b_stage_2_batch_3_layer_9_ffn_res
			llama_7b_stage_2_batch_3_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_9_ffn_res -> llama_7b_stage_2_batch_3_layer_10_norm1
			llama_7b_stage_2_batch_3_layer_10_norm1 -> llama_7b_stage_2_batch_3_layer_10_qkv
			llama_7b_stage_2_batch_3_layer_10_qkv -> llama_7b_stage_2_batch_3_layer_10_attn
			llama_7b_stage_2_batch_3_layer_10_attn -> llama_7b_stage_2_batch_3_layer_10_attn_out
			llama_7b_stage_2_batch_3_layer_10_attn_out -> llama_7b_stage_2_batch_3_layer_10_attn_res
			llama_7b_stage_2_batch_3_layer_10_attn_res -> llama_7b_stage_2_batch_3_layer_10_norm2
			llama_7b_stage_2_batch_3_layer_10_norm2 -> llama_7b_stage_2_batch_3_layer_10_ffn_up
			llama_7b_stage_2_batch_3_layer_10_ffn_up -> llama_7b_stage_2_batch_3_layer_10_ffn_gate
			llama_7b_stage_2_batch_3_layer_10_ffn_gate -> llama_7b_stage_2_batch_3_layer_10_ffn_down
			llama_7b_stage_2_batch_3_layer_10_ffn_down -> llama_7b_stage_2_batch_3_layer_10_ffn_res
			llama_7b_stage_2_batch_3_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_10_ffn_res -> llama_7b_stage_2_batch_3_layer_11_norm1
			llama_7b_stage_2_batch_3_layer_11_norm1 -> llama_7b_stage_2_batch_3_layer_11_qkv
			llama_7b_stage_2_batch_3_layer_11_qkv -> llama_7b_stage_2_batch_3_layer_11_attn
			llama_7b_stage_2_batch_3_layer_11_attn -> llama_7b_stage_2_batch_3_layer_11_attn_out
			llama_7b_stage_2_batch_3_layer_11_attn_out -> llama_7b_stage_2_batch_3_layer_11_attn_res
			llama_7b_stage_2_batch_3_layer_11_attn_res -> llama_7b_stage_2_batch_3_layer_11_norm2
			llama_7b_stage_2_batch_3_layer_11_norm2 -> llama_7b_stage_2_batch_3_layer_11_ffn_up
			llama_7b_stage_2_batch_3_layer_11_ffn_up -> llama_7b_stage_2_batch_3_layer_11_ffn_gate
			llama_7b_stage_2_batch_3_layer_11_ffn_gate -> llama_7b_stage_2_batch_3_layer_11_ffn_down
			llama_7b_stage_2_batch_3_layer_11_ffn_down -> llama_7b_stage_2_batch_3_layer_11_ffn_res
			llama_7b_stage_2_batch_3_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_11_ffn_res -> llama_7b_stage_2_batch_3_layer_12_norm1
			llama_7b_stage_2_batch_3_layer_12_norm1 -> llama_7b_stage_2_batch_3_layer_12_qkv
			llama_7b_stage_2_batch_3_layer_12_qkv -> llama_7b_stage_2_batch_3_layer_12_attn
			llama_7b_stage_2_batch_3_layer_12_attn -> llama_7b_stage_2_batch_3_layer_12_attn_out
			llama_7b_stage_2_batch_3_layer_12_attn_out -> llama_7b_stage_2_batch_3_layer_12_attn_res
			llama_7b_stage_2_batch_3_layer_12_attn_res -> llama_7b_stage_2_batch_3_layer_12_norm2
			llama_7b_stage_2_batch_3_layer_12_norm2 -> llama_7b_stage_2_batch_3_layer_12_ffn_up
			llama_7b_stage_2_batch_3_layer_12_ffn_up -> llama_7b_stage_2_batch_3_layer_12_ffn_gate
			llama_7b_stage_2_batch_3_layer_12_ffn_gate -> llama_7b_stage_2_batch_3_layer_12_ffn_down
			llama_7b_stage_2_batch_3_layer_12_ffn_down -> llama_7b_stage_2_batch_3_layer_12_ffn_res
			llama_7b_stage_2_batch_3_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_12_ffn_res -> llama_7b_stage_2_batch_3_layer_13_norm1
			llama_7b_stage_2_batch_3_layer_13_norm1 -> llama_7b_stage_2_batch_3_layer_13_qkv
			llama_7b_stage_2_batch_3_layer_13_qkv -> llama_7b_stage_2_batch_3_layer_13_attn
			llama_7b_stage_2_batch_3_layer_13_attn -> llama_7b_stage_2_batch_3_layer_13_attn_out
			llama_7b_stage_2_batch_3_layer_13_attn_out -> llama_7b_stage_2_batch_3_layer_13_attn_res
			llama_7b_stage_2_batch_3_layer_13_attn_res -> llama_7b_stage_2_batch_3_layer_13_norm2
			llama_7b_stage_2_batch_3_layer_13_norm2 -> llama_7b_stage_2_batch_3_layer_13_ffn_up
			llama_7b_stage_2_batch_3_layer_13_ffn_up -> llama_7b_stage_2_batch_3_layer_13_ffn_gate
			llama_7b_stage_2_batch_3_layer_13_ffn_gate -> llama_7b_stage_2_batch_3_layer_13_ffn_down
			llama_7b_stage_2_batch_3_layer_13_ffn_down -> llama_7b_stage_2_batch_3_layer_13_ffn_res
			llama_7b_stage_2_batch_3_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_13_ffn_res -> llama_7b_stage_2_batch_3_layer_14_norm1
			llama_7b_stage_2_batch_3_layer_14_norm1 -> llama_7b_stage_2_batch_3_layer_14_qkv
			llama_7b_stage_2_batch_3_layer_14_qkv -> llama_7b_stage_2_batch_3_layer_14_attn
			llama_7b_stage_2_batch_3_layer_14_attn -> llama_7b_stage_2_batch_3_layer_14_attn_out
			llama_7b_stage_2_batch_3_layer_14_attn_out -> llama_7b_stage_2_batch_3_layer_14_attn_res
			llama_7b_stage_2_batch_3_layer_14_attn_res -> llama_7b_stage_2_batch_3_layer_14_norm2
			llama_7b_stage_2_batch_3_layer_14_norm2 -> llama_7b_stage_2_batch_3_layer_14_ffn_up
			llama_7b_stage_2_batch_3_layer_14_ffn_up -> llama_7b_stage_2_batch_3_layer_14_ffn_gate
			llama_7b_stage_2_batch_3_layer_14_ffn_gate -> llama_7b_stage_2_batch_3_layer_14_ffn_down
			llama_7b_stage_2_batch_3_layer_14_ffn_down -> llama_7b_stage_2_batch_3_layer_14_ffn_res
			llama_7b_stage_2_batch_3_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_14_ffn_res -> llama_7b_stage_2_batch_3_layer_15_norm1
			llama_7b_stage_2_batch_3_layer_15_norm1 -> llama_7b_stage_2_batch_3_layer_15_qkv
			llama_7b_stage_2_batch_3_layer_15_qkv -> llama_7b_stage_2_batch_3_layer_15_attn
			llama_7b_stage_2_batch_3_layer_15_attn -> llama_7b_stage_2_batch_3_layer_15_attn_out
			llama_7b_stage_2_batch_3_layer_15_attn_out -> llama_7b_stage_2_batch_3_layer_15_attn_res
			llama_7b_stage_2_batch_3_layer_15_attn_res -> llama_7b_stage_2_batch_3_layer_15_norm2
			llama_7b_stage_2_batch_3_layer_15_norm2 -> llama_7b_stage_2_batch_3_layer_15_ffn_up
			llama_7b_stage_2_batch_3_layer_15_ffn_up -> llama_7b_stage_2_batch_3_layer_15_ffn_gate
			llama_7b_stage_2_batch_3_layer_15_ffn_gate -> llama_7b_stage_2_batch_3_layer_15_ffn_down
			llama_7b_stage_2_batch_3_layer_15_ffn_down -> llama_7b_stage_2_batch_3_layer_15_ffn_res
			llama_7b_stage_2_batch_3_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_3_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_3_layer_15_ffn_res -> llama_7b_stage_2_batch_3_layer_16_norm1
			llama_7b_stage_2_batch_3_layer_16_norm1 -> llama_7b_stage_2_batch_3_layer_16_qkv
			llama_7b_stage_2_batch_3_layer_16_qkv -> llama_7b_stage_2_batch_3_layer_16_attn
			llama_7b_stage_2_batch_3_layer_16_attn -> llama_7b_stage_2_batch_3_layer_16_attn_out
			llama_7b_stage_2_batch_3_layer_16_attn_out -> llama_7b_stage_2_batch_3_layer_16_attn_res
			llama_7b_stage_2_batch_3_layer_16_attn_res -> llama_7b_stage_2_batch_3_layer_16_norm2
			llama_7b_stage_2_batch_3_layer_16_norm2 -> llama_7b_stage_2_batch_3_layer_16_ffn_up
			llama_7b_stage_2_batch_3_layer_16_ffn_up -> llama_7b_stage_2_batch_3_layer_16_ffn_gate
			llama_7b_stage_2_batch_3_layer_16_ffn_gate -> llama_7b_stage_2_batch_3_layer_16_ffn_down
			llama_7b_stage_2_batch_3_layer_16_ffn_down -> llama_7b_stage_2_batch_3_layer_16_ffn_res
			llama_7b_stage_2_batch_3_output [label="Stage 2 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_3_layer_16_ffn_res -> llama_7b_stage_2_batch_3_output
			llama_7b_stage_2_batch_4_input [label="Micro-batch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_input -> llama_7b_stage_2_batch_4_layer_9_norm1
			llama_7b_stage_2_batch_4_layer_9_norm1 -> llama_7b_stage_2_batch_4_layer_9_qkv
			llama_7b_stage_2_batch_4_layer_9_qkv -> llama_7b_stage_2_batch_4_layer_9_attn
			llama_7b_stage_2_batch_4_layer_9_attn -> llama_7b_stage_2_batch_4_layer_9_attn_out
			llama_7b_stage_2_batch_4_layer_9_attn_out -> llama_7b_stage_2_batch_4_layer_9_attn_res
			llama_7b_stage_2_batch_4_layer_9_attn_res -> llama_7b_stage_2_batch_4_layer_9_norm2
			llama_7b_stage_2_batch_4_layer_9_norm2 -> llama_7b_stage_2_batch_4_layer_9_ffn_up
			llama_7b_stage_2_batch_4_layer_9_ffn_up -> llama_7b_stage_2_batch_4_layer_9_ffn_gate
			llama_7b_stage_2_batch_4_layer_9_ffn_gate -> llama_7b_stage_2_batch_4_layer_9_ffn_down
			llama_7b_stage_2_batch_4_layer_9_ffn_down -> llama_7b_stage_2_batch_4_layer_9_ffn_res
			llama_7b_stage_2_batch_4_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_9_ffn_res -> llama_7b_stage_2_batch_4_layer_10_norm1
			llama_7b_stage_2_batch_4_layer_10_norm1 -> llama_7b_stage_2_batch_4_layer_10_qkv
			llama_7b_stage_2_batch_4_layer_10_qkv -> llama_7b_stage_2_batch_4_layer_10_attn
			llama_7b_stage_2_batch_4_layer_10_attn -> llama_7b_stage_2_batch_4_layer_10_attn_out
			llama_7b_stage_2_batch_4_layer_10_attn_out -> llama_7b_stage_2_batch_4_layer_10_attn_res
			llama_7b_stage_2_batch_4_layer_10_attn_res -> llama_7b_stage_2_batch_4_layer_10_norm2
			llama_7b_stage_2_batch_4_layer_10_norm2 -> llama_7b_stage_2_batch_4_layer_10_ffn_up
			llama_7b_stage_2_batch_4_layer_10_ffn_up -> llama_7b_stage_2_batch_4_layer_10_ffn_gate
			llama_7b_stage_2_batch_4_layer_10_ffn_gate -> llama_7b_stage_2_batch_4_layer_10_ffn_down
			llama_7b_stage_2_batch_4_layer_10_ffn_down -> llama_7b_stage_2_batch_4_layer_10_ffn_res
			llama_7b_stage_2_batch_4_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_10_ffn_res -> llama_7b_stage_2_batch_4_layer_11_norm1
			llama_7b_stage_2_batch_4_layer_11_norm1 -> llama_7b_stage_2_batch_4_layer_11_qkv
			llama_7b_stage_2_batch_4_layer_11_qkv -> llama_7b_stage_2_batch_4_layer_11_attn
			llama_7b_stage_2_batch_4_layer_11_attn -> llama_7b_stage_2_batch_4_layer_11_attn_out
			llama_7b_stage_2_batch_4_layer_11_attn_out -> llama_7b_stage_2_batch_4_layer_11_attn_res
			llama_7b_stage_2_batch_4_layer_11_attn_res -> llama_7b_stage_2_batch_4_layer_11_norm2
			llama_7b_stage_2_batch_4_layer_11_norm2 -> llama_7b_stage_2_batch_4_layer_11_ffn_up
			llama_7b_stage_2_batch_4_layer_11_ffn_up -> llama_7b_stage_2_batch_4_layer_11_ffn_gate
			llama_7b_stage_2_batch_4_layer_11_ffn_gate -> llama_7b_stage_2_batch_4_layer_11_ffn_down
			llama_7b_stage_2_batch_4_layer_11_ffn_down -> llama_7b_stage_2_batch_4_layer_11_ffn_res
			llama_7b_stage_2_batch_4_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_11_ffn_res -> llama_7b_stage_2_batch_4_layer_12_norm1
			llama_7b_stage_2_batch_4_layer_12_norm1 -> llama_7b_stage_2_batch_4_layer_12_qkv
			llama_7b_stage_2_batch_4_layer_12_qkv -> llama_7b_stage_2_batch_4_layer_12_attn
			llama_7b_stage_2_batch_4_layer_12_attn -> llama_7b_stage_2_batch_4_layer_12_attn_out
			llama_7b_stage_2_batch_4_layer_12_attn_out -> llama_7b_stage_2_batch_4_layer_12_attn_res
			llama_7b_stage_2_batch_4_layer_12_attn_res -> llama_7b_stage_2_batch_4_layer_12_norm2
			llama_7b_stage_2_batch_4_layer_12_norm2 -> llama_7b_stage_2_batch_4_layer_12_ffn_up
			llama_7b_stage_2_batch_4_layer_12_ffn_up -> llama_7b_stage_2_batch_4_layer_12_ffn_gate
			llama_7b_stage_2_batch_4_layer_12_ffn_gate -> llama_7b_stage_2_batch_4_layer_12_ffn_down
			llama_7b_stage_2_batch_4_layer_12_ffn_down -> llama_7b_stage_2_batch_4_layer_12_ffn_res
			llama_7b_stage_2_batch_4_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_12_ffn_res -> llama_7b_stage_2_batch_4_layer_13_norm1
			llama_7b_stage_2_batch_4_layer_13_norm1 -> llama_7b_stage_2_batch_4_layer_13_qkv
			llama_7b_stage_2_batch_4_layer_13_qkv -> llama_7b_stage_2_batch_4_layer_13_attn
			llama_7b_stage_2_batch_4_layer_13_attn -> llama_7b_stage_2_batch_4_layer_13_attn_out
			llama_7b_stage_2_batch_4_layer_13_attn_out -> llama_7b_stage_2_batch_4_layer_13_attn_res
			llama_7b_stage_2_batch_4_layer_13_attn_res -> llama_7b_stage_2_batch_4_layer_13_norm2
			llama_7b_stage_2_batch_4_layer_13_norm2 -> llama_7b_stage_2_batch_4_layer_13_ffn_up
			llama_7b_stage_2_batch_4_layer_13_ffn_up -> llama_7b_stage_2_batch_4_layer_13_ffn_gate
			llama_7b_stage_2_batch_4_layer_13_ffn_gate -> llama_7b_stage_2_batch_4_layer_13_ffn_down
			llama_7b_stage_2_batch_4_layer_13_ffn_down -> llama_7b_stage_2_batch_4_layer_13_ffn_res
			llama_7b_stage_2_batch_4_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_13_ffn_res -> llama_7b_stage_2_batch_4_layer_14_norm1
			llama_7b_stage_2_batch_4_layer_14_norm1 -> llama_7b_stage_2_batch_4_layer_14_qkv
			llama_7b_stage_2_batch_4_layer_14_qkv -> llama_7b_stage_2_batch_4_layer_14_attn
			llama_7b_stage_2_batch_4_layer_14_attn -> llama_7b_stage_2_batch_4_layer_14_attn_out
			llama_7b_stage_2_batch_4_layer_14_attn_out -> llama_7b_stage_2_batch_4_layer_14_attn_res
			llama_7b_stage_2_batch_4_layer_14_attn_res -> llama_7b_stage_2_batch_4_layer_14_norm2
			llama_7b_stage_2_batch_4_layer_14_norm2 -> llama_7b_stage_2_batch_4_layer_14_ffn_up
			llama_7b_stage_2_batch_4_layer_14_ffn_up -> llama_7b_stage_2_batch_4_layer_14_ffn_gate
			llama_7b_stage_2_batch_4_layer_14_ffn_gate -> llama_7b_stage_2_batch_4_layer_14_ffn_down
			llama_7b_stage_2_batch_4_layer_14_ffn_down -> llama_7b_stage_2_batch_4_layer_14_ffn_res
			llama_7b_stage_2_batch_4_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_14_ffn_res -> llama_7b_stage_2_batch_4_layer_15_norm1
			llama_7b_stage_2_batch_4_layer_15_norm1 -> llama_7b_stage_2_batch_4_layer_15_qkv
			llama_7b_stage_2_batch_4_layer_15_qkv -> llama_7b_stage_2_batch_4_layer_15_attn
			llama_7b_stage_2_batch_4_layer_15_attn -> llama_7b_stage_2_batch_4_layer_15_attn_out
			llama_7b_stage_2_batch_4_layer_15_attn_out -> llama_7b_stage_2_batch_4_layer_15_attn_res
			llama_7b_stage_2_batch_4_layer_15_attn_res -> llama_7b_stage_2_batch_4_layer_15_norm2
			llama_7b_stage_2_batch_4_layer_15_norm2 -> llama_7b_stage_2_batch_4_layer_15_ffn_up
			llama_7b_stage_2_batch_4_layer_15_ffn_up -> llama_7b_stage_2_batch_4_layer_15_ffn_gate
			llama_7b_stage_2_batch_4_layer_15_ffn_gate -> llama_7b_stage_2_batch_4_layer_15_ffn_down
			llama_7b_stage_2_batch_4_layer_15_ffn_down -> llama_7b_stage_2_batch_4_layer_15_ffn_res
			llama_7b_stage_2_batch_4_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_2_batch_4_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_2_batch_4_layer_15_ffn_res -> llama_7b_stage_2_batch_4_layer_16_norm1
			llama_7b_stage_2_batch_4_layer_16_norm1 -> llama_7b_stage_2_batch_4_layer_16_qkv
			llama_7b_stage_2_batch_4_layer_16_qkv -> llama_7b_stage_2_batch_4_layer_16_attn
			llama_7b_stage_2_batch_4_layer_16_attn -> llama_7b_stage_2_batch_4_layer_16_attn_out
			llama_7b_stage_2_batch_4_layer_16_attn_out -> llama_7b_stage_2_batch_4_layer_16_attn_res
			llama_7b_stage_2_batch_4_layer_16_attn_res -> llama_7b_stage_2_batch_4_layer_16_norm2
			llama_7b_stage_2_batch_4_layer_16_norm2 -> llama_7b_stage_2_batch_4_layer_16_ffn_up
			llama_7b_stage_2_batch_4_layer_16_ffn_up -> llama_7b_stage_2_batch_4_layer_16_ffn_gate
			llama_7b_stage_2_batch_4_layer_16_ffn_gate -> llama_7b_stage_2_batch_4_layer_16_ffn_down
			llama_7b_stage_2_batch_4_layer_16_ffn_down -> llama_7b_stage_2_batch_4_layer_16_ffn_res
			llama_7b_stage_2_batch_4_output [label="Stage 2 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_2_batch_4_layer_16_ffn_res -> llama_7b_stage_2_batch_4_output
		}
		subgraph cluster_llama_7b_stage_3 {
			color=black fillcolor=lightblue label="Stage 3\nGPU_3\nLayers 17-24" style="rounded,filled"
			llama_7b_stage_3_batch_1_input [label="Micro-batch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_input -> llama_7b_stage_3_batch_1_layer_17_norm1
			llama_7b_stage_3_batch_1_layer_17_norm1 -> llama_7b_stage_3_batch_1_layer_17_qkv
			llama_7b_stage_3_batch_1_layer_17_qkv -> llama_7b_stage_3_batch_1_layer_17_attn
			llama_7b_stage_3_batch_1_layer_17_attn -> llama_7b_stage_3_batch_1_layer_17_attn_out
			llama_7b_stage_3_batch_1_layer_17_attn_out -> llama_7b_stage_3_batch_1_layer_17_attn_res
			llama_7b_stage_3_batch_1_layer_17_attn_res -> llama_7b_stage_3_batch_1_layer_17_norm2
			llama_7b_stage_3_batch_1_layer_17_norm2 -> llama_7b_stage_3_batch_1_layer_17_ffn_up
			llama_7b_stage_3_batch_1_layer_17_ffn_up -> llama_7b_stage_3_batch_1_layer_17_ffn_gate
			llama_7b_stage_3_batch_1_layer_17_ffn_gate -> llama_7b_stage_3_batch_1_layer_17_ffn_down
			llama_7b_stage_3_batch_1_layer_17_ffn_down -> llama_7b_stage_3_batch_1_layer_17_ffn_res
			llama_7b_stage_3_batch_1_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_17_ffn_res -> llama_7b_stage_3_batch_1_layer_18_norm1
			llama_7b_stage_3_batch_1_layer_18_norm1 -> llama_7b_stage_3_batch_1_layer_18_qkv
			llama_7b_stage_3_batch_1_layer_18_qkv -> llama_7b_stage_3_batch_1_layer_18_attn
			llama_7b_stage_3_batch_1_layer_18_attn -> llama_7b_stage_3_batch_1_layer_18_attn_out
			llama_7b_stage_3_batch_1_layer_18_attn_out -> llama_7b_stage_3_batch_1_layer_18_attn_res
			llama_7b_stage_3_batch_1_layer_18_attn_res -> llama_7b_stage_3_batch_1_layer_18_norm2
			llama_7b_stage_3_batch_1_layer_18_norm2 -> llama_7b_stage_3_batch_1_layer_18_ffn_up
			llama_7b_stage_3_batch_1_layer_18_ffn_up -> llama_7b_stage_3_batch_1_layer_18_ffn_gate
			llama_7b_stage_3_batch_1_layer_18_ffn_gate -> llama_7b_stage_3_batch_1_layer_18_ffn_down
			llama_7b_stage_3_batch_1_layer_18_ffn_down -> llama_7b_stage_3_batch_1_layer_18_ffn_res
			llama_7b_stage_3_batch_1_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_18_ffn_res -> llama_7b_stage_3_batch_1_layer_19_norm1
			llama_7b_stage_3_batch_1_layer_19_norm1 -> llama_7b_stage_3_batch_1_layer_19_qkv
			llama_7b_stage_3_batch_1_layer_19_qkv -> llama_7b_stage_3_batch_1_layer_19_attn
			llama_7b_stage_3_batch_1_layer_19_attn -> llama_7b_stage_3_batch_1_layer_19_attn_out
			llama_7b_stage_3_batch_1_layer_19_attn_out -> llama_7b_stage_3_batch_1_layer_19_attn_res
			llama_7b_stage_3_batch_1_layer_19_attn_res -> llama_7b_stage_3_batch_1_layer_19_norm2
			llama_7b_stage_3_batch_1_layer_19_norm2 -> llama_7b_stage_3_batch_1_layer_19_ffn_up
			llama_7b_stage_3_batch_1_layer_19_ffn_up -> llama_7b_stage_3_batch_1_layer_19_ffn_gate
			llama_7b_stage_3_batch_1_layer_19_ffn_gate -> llama_7b_stage_3_batch_1_layer_19_ffn_down
			llama_7b_stage_3_batch_1_layer_19_ffn_down -> llama_7b_stage_3_batch_1_layer_19_ffn_res
			llama_7b_stage_3_batch_1_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_19_ffn_res -> llama_7b_stage_3_batch_1_layer_20_norm1
			llama_7b_stage_3_batch_1_layer_20_norm1 -> llama_7b_stage_3_batch_1_layer_20_qkv
			llama_7b_stage_3_batch_1_layer_20_qkv -> llama_7b_stage_3_batch_1_layer_20_attn
			llama_7b_stage_3_batch_1_layer_20_attn -> llama_7b_stage_3_batch_1_layer_20_attn_out
			llama_7b_stage_3_batch_1_layer_20_attn_out -> llama_7b_stage_3_batch_1_layer_20_attn_res
			llama_7b_stage_3_batch_1_layer_20_attn_res -> llama_7b_stage_3_batch_1_layer_20_norm2
			llama_7b_stage_3_batch_1_layer_20_norm2 -> llama_7b_stage_3_batch_1_layer_20_ffn_up
			llama_7b_stage_3_batch_1_layer_20_ffn_up -> llama_7b_stage_3_batch_1_layer_20_ffn_gate
			llama_7b_stage_3_batch_1_layer_20_ffn_gate -> llama_7b_stage_3_batch_1_layer_20_ffn_down
			llama_7b_stage_3_batch_1_layer_20_ffn_down -> llama_7b_stage_3_batch_1_layer_20_ffn_res
			llama_7b_stage_3_batch_1_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_20_ffn_res -> llama_7b_stage_3_batch_1_layer_21_norm1
			llama_7b_stage_3_batch_1_layer_21_norm1 -> llama_7b_stage_3_batch_1_layer_21_qkv
			llama_7b_stage_3_batch_1_layer_21_qkv -> llama_7b_stage_3_batch_1_layer_21_attn
			llama_7b_stage_3_batch_1_layer_21_attn -> llama_7b_stage_3_batch_1_layer_21_attn_out
			llama_7b_stage_3_batch_1_layer_21_attn_out -> llama_7b_stage_3_batch_1_layer_21_attn_res
			llama_7b_stage_3_batch_1_layer_21_attn_res -> llama_7b_stage_3_batch_1_layer_21_norm2
			llama_7b_stage_3_batch_1_layer_21_norm2 -> llama_7b_stage_3_batch_1_layer_21_ffn_up
			llama_7b_stage_3_batch_1_layer_21_ffn_up -> llama_7b_stage_3_batch_1_layer_21_ffn_gate
			llama_7b_stage_3_batch_1_layer_21_ffn_gate -> llama_7b_stage_3_batch_1_layer_21_ffn_down
			llama_7b_stage_3_batch_1_layer_21_ffn_down -> llama_7b_stage_3_batch_1_layer_21_ffn_res
			llama_7b_stage_3_batch_1_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_21_ffn_res -> llama_7b_stage_3_batch_1_layer_22_norm1
			llama_7b_stage_3_batch_1_layer_22_norm1 -> llama_7b_stage_3_batch_1_layer_22_qkv
			llama_7b_stage_3_batch_1_layer_22_qkv -> llama_7b_stage_3_batch_1_layer_22_attn
			llama_7b_stage_3_batch_1_layer_22_attn -> llama_7b_stage_3_batch_1_layer_22_attn_out
			llama_7b_stage_3_batch_1_layer_22_attn_out -> llama_7b_stage_3_batch_1_layer_22_attn_res
			llama_7b_stage_3_batch_1_layer_22_attn_res -> llama_7b_stage_3_batch_1_layer_22_norm2
			llama_7b_stage_3_batch_1_layer_22_norm2 -> llama_7b_stage_3_batch_1_layer_22_ffn_up
			llama_7b_stage_3_batch_1_layer_22_ffn_up -> llama_7b_stage_3_batch_1_layer_22_ffn_gate
			llama_7b_stage_3_batch_1_layer_22_ffn_gate -> llama_7b_stage_3_batch_1_layer_22_ffn_down
			llama_7b_stage_3_batch_1_layer_22_ffn_down -> llama_7b_stage_3_batch_1_layer_22_ffn_res
			llama_7b_stage_3_batch_1_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_22_ffn_res -> llama_7b_stage_3_batch_1_layer_23_norm1
			llama_7b_stage_3_batch_1_layer_23_norm1 -> llama_7b_stage_3_batch_1_layer_23_qkv
			llama_7b_stage_3_batch_1_layer_23_qkv -> llama_7b_stage_3_batch_1_layer_23_attn
			llama_7b_stage_3_batch_1_layer_23_attn -> llama_7b_stage_3_batch_1_layer_23_attn_out
			llama_7b_stage_3_batch_1_layer_23_attn_out -> llama_7b_stage_3_batch_1_layer_23_attn_res
			llama_7b_stage_3_batch_1_layer_23_attn_res -> llama_7b_stage_3_batch_1_layer_23_norm2
			llama_7b_stage_3_batch_1_layer_23_norm2 -> llama_7b_stage_3_batch_1_layer_23_ffn_up
			llama_7b_stage_3_batch_1_layer_23_ffn_up -> llama_7b_stage_3_batch_1_layer_23_ffn_gate
			llama_7b_stage_3_batch_1_layer_23_ffn_gate -> llama_7b_stage_3_batch_1_layer_23_ffn_down
			llama_7b_stage_3_batch_1_layer_23_ffn_down -> llama_7b_stage_3_batch_1_layer_23_ffn_res
			llama_7b_stage_3_batch_1_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_1_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_1_layer_23_ffn_res -> llama_7b_stage_3_batch_1_layer_24_norm1
			llama_7b_stage_3_batch_1_layer_24_norm1 -> llama_7b_stage_3_batch_1_layer_24_qkv
			llama_7b_stage_3_batch_1_layer_24_qkv -> llama_7b_stage_3_batch_1_layer_24_attn
			llama_7b_stage_3_batch_1_layer_24_attn -> llama_7b_stage_3_batch_1_layer_24_attn_out
			llama_7b_stage_3_batch_1_layer_24_attn_out -> llama_7b_stage_3_batch_1_layer_24_attn_res
			llama_7b_stage_3_batch_1_layer_24_attn_res -> llama_7b_stage_3_batch_1_layer_24_norm2
			llama_7b_stage_3_batch_1_layer_24_norm2 -> llama_7b_stage_3_batch_1_layer_24_ffn_up
			llama_7b_stage_3_batch_1_layer_24_ffn_up -> llama_7b_stage_3_batch_1_layer_24_ffn_gate
			llama_7b_stage_3_batch_1_layer_24_ffn_gate -> llama_7b_stage_3_batch_1_layer_24_ffn_down
			llama_7b_stage_3_batch_1_layer_24_ffn_down -> llama_7b_stage_3_batch_1_layer_24_ffn_res
			llama_7b_stage_3_batch_1_output [label="Stage 3 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_1_layer_24_ffn_res -> llama_7b_stage_3_batch_1_output
			llama_7b_stage_3_batch_2_input [label="Micro-batch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_input -> llama_7b_stage_3_batch_2_layer_17_norm1
			llama_7b_stage_3_batch_2_layer_17_norm1 -> llama_7b_stage_3_batch_2_layer_17_qkv
			llama_7b_stage_3_batch_2_layer_17_qkv -> llama_7b_stage_3_batch_2_layer_17_attn
			llama_7b_stage_3_batch_2_layer_17_attn -> llama_7b_stage_3_batch_2_layer_17_attn_out
			llama_7b_stage_3_batch_2_layer_17_attn_out -> llama_7b_stage_3_batch_2_layer_17_attn_res
			llama_7b_stage_3_batch_2_layer_17_attn_res -> llama_7b_stage_3_batch_2_layer_17_norm2
			llama_7b_stage_3_batch_2_layer_17_norm2 -> llama_7b_stage_3_batch_2_layer_17_ffn_up
			llama_7b_stage_3_batch_2_layer_17_ffn_up -> llama_7b_stage_3_batch_2_layer_17_ffn_gate
			llama_7b_stage_3_batch_2_layer_17_ffn_gate -> llama_7b_stage_3_batch_2_layer_17_ffn_down
			llama_7b_stage_3_batch_2_layer_17_ffn_down -> llama_7b_stage_3_batch_2_layer_17_ffn_res
			llama_7b_stage_3_batch_2_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_17_ffn_res -> llama_7b_stage_3_batch_2_layer_18_norm1
			llama_7b_stage_3_batch_2_layer_18_norm1 -> llama_7b_stage_3_batch_2_layer_18_qkv
			llama_7b_stage_3_batch_2_layer_18_qkv -> llama_7b_stage_3_batch_2_layer_18_attn
			llama_7b_stage_3_batch_2_layer_18_attn -> llama_7b_stage_3_batch_2_layer_18_attn_out
			llama_7b_stage_3_batch_2_layer_18_attn_out -> llama_7b_stage_3_batch_2_layer_18_attn_res
			llama_7b_stage_3_batch_2_layer_18_attn_res -> llama_7b_stage_3_batch_2_layer_18_norm2
			llama_7b_stage_3_batch_2_layer_18_norm2 -> llama_7b_stage_3_batch_2_layer_18_ffn_up
			llama_7b_stage_3_batch_2_layer_18_ffn_up -> llama_7b_stage_3_batch_2_layer_18_ffn_gate
			llama_7b_stage_3_batch_2_layer_18_ffn_gate -> llama_7b_stage_3_batch_2_layer_18_ffn_down
			llama_7b_stage_3_batch_2_layer_18_ffn_down -> llama_7b_stage_3_batch_2_layer_18_ffn_res
			llama_7b_stage_3_batch_2_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_18_ffn_res -> llama_7b_stage_3_batch_2_layer_19_norm1
			llama_7b_stage_3_batch_2_layer_19_norm1 -> llama_7b_stage_3_batch_2_layer_19_qkv
			llama_7b_stage_3_batch_2_layer_19_qkv -> llama_7b_stage_3_batch_2_layer_19_attn
			llama_7b_stage_3_batch_2_layer_19_attn -> llama_7b_stage_3_batch_2_layer_19_attn_out
			llama_7b_stage_3_batch_2_layer_19_attn_out -> llama_7b_stage_3_batch_2_layer_19_attn_res
			llama_7b_stage_3_batch_2_layer_19_attn_res -> llama_7b_stage_3_batch_2_layer_19_norm2
			llama_7b_stage_3_batch_2_layer_19_norm2 -> llama_7b_stage_3_batch_2_layer_19_ffn_up
			llama_7b_stage_3_batch_2_layer_19_ffn_up -> llama_7b_stage_3_batch_2_layer_19_ffn_gate
			llama_7b_stage_3_batch_2_layer_19_ffn_gate -> llama_7b_stage_3_batch_2_layer_19_ffn_down
			llama_7b_stage_3_batch_2_layer_19_ffn_down -> llama_7b_stage_3_batch_2_layer_19_ffn_res
			llama_7b_stage_3_batch_2_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_19_ffn_res -> llama_7b_stage_3_batch_2_layer_20_norm1
			llama_7b_stage_3_batch_2_layer_20_norm1 -> llama_7b_stage_3_batch_2_layer_20_qkv
			llama_7b_stage_3_batch_2_layer_20_qkv -> llama_7b_stage_3_batch_2_layer_20_attn
			llama_7b_stage_3_batch_2_layer_20_attn -> llama_7b_stage_3_batch_2_layer_20_attn_out
			llama_7b_stage_3_batch_2_layer_20_attn_out -> llama_7b_stage_3_batch_2_layer_20_attn_res
			llama_7b_stage_3_batch_2_layer_20_attn_res -> llama_7b_stage_3_batch_2_layer_20_norm2
			llama_7b_stage_3_batch_2_layer_20_norm2 -> llama_7b_stage_3_batch_2_layer_20_ffn_up
			llama_7b_stage_3_batch_2_layer_20_ffn_up -> llama_7b_stage_3_batch_2_layer_20_ffn_gate
			llama_7b_stage_3_batch_2_layer_20_ffn_gate -> llama_7b_stage_3_batch_2_layer_20_ffn_down
			llama_7b_stage_3_batch_2_layer_20_ffn_down -> llama_7b_stage_3_batch_2_layer_20_ffn_res
			llama_7b_stage_3_batch_2_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_20_ffn_res -> llama_7b_stage_3_batch_2_layer_21_norm1
			llama_7b_stage_3_batch_2_layer_21_norm1 -> llama_7b_stage_3_batch_2_layer_21_qkv
			llama_7b_stage_3_batch_2_layer_21_qkv -> llama_7b_stage_3_batch_2_layer_21_attn
			llama_7b_stage_3_batch_2_layer_21_attn -> llama_7b_stage_3_batch_2_layer_21_attn_out
			llama_7b_stage_3_batch_2_layer_21_attn_out -> llama_7b_stage_3_batch_2_layer_21_attn_res
			llama_7b_stage_3_batch_2_layer_21_attn_res -> llama_7b_stage_3_batch_2_layer_21_norm2
			llama_7b_stage_3_batch_2_layer_21_norm2 -> llama_7b_stage_3_batch_2_layer_21_ffn_up
			llama_7b_stage_3_batch_2_layer_21_ffn_up -> llama_7b_stage_3_batch_2_layer_21_ffn_gate
			llama_7b_stage_3_batch_2_layer_21_ffn_gate -> llama_7b_stage_3_batch_2_layer_21_ffn_down
			llama_7b_stage_3_batch_2_layer_21_ffn_down -> llama_7b_stage_3_batch_2_layer_21_ffn_res
			llama_7b_stage_3_batch_2_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_21_ffn_res -> llama_7b_stage_3_batch_2_layer_22_norm1
			llama_7b_stage_3_batch_2_layer_22_norm1 -> llama_7b_stage_3_batch_2_layer_22_qkv
			llama_7b_stage_3_batch_2_layer_22_qkv -> llama_7b_stage_3_batch_2_layer_22_attn
			llama_7b_stage_3_batch_2_layer_22_attn -> llama_7b_stage_3_batch_2_layer_22_attn_out
			llama_7b_stage_3_batch_2_layer_22_attn_out -> llama_7b_stage_3_batch_2_layer_22_attn_res
			llama_7b_stage_3_batch_2_layer_22_attn_res -> llama_7b_stage_3_batch_2_layer_22_norm2
			llama_7b_stage_3_batch_2_layer_22_norm2 -> llama_7b_stage_3_batch_2_layer_22_ffn_up
			llama_7b_stage_3_batch_2_layer_22_ffn_up -> llama_7b_stage_3_batch_2_layer_22_ffn_gate
			llama_7b_stage_3_batch_2_layer_22_ffn_gate -> llama_7b_stage_3_batch_2_layer_22_ffn_down
			llama_7b_stage_3_batch_2_layer_22_ffn_down -> llama_7b_stage_3_batch_2_layer_22_ffn_res
			llama_7b_stage_3_batch_2_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_22_ffn_res -> llama_7b_stage_3_batch_2_layer_23_norm1
			llama_7b_stage_3_batch_2_layer_23_norm1 -> llama_7b_stage_3_batch_2_layer_23_qkv
			llama_7b_stage_3_batch_2_layer_23_qkv -> llama_7b_stage_3_batch_2_layer_23_attn
			llama_7b_stage_3_batch_2_layer_23_attn -> llama_7b_stage_3_batch_2_layer_23_attn_out
			llama_7b_stage_3_batch_2_layer_23_attn_out -> llama_7b_stage_3_batch_2_layer_23_attn_res
			llama_7b_stage_3_batch_2_layer_23_attn_res -> llama_7b_stage_3_batch_2_layer_23_norm2
			llama_7b_stage_3_batch_2_layer_23_norm2 -> llama_7b_stage_3_batch_2_layer_23_ffn_up
			llama_7b_stage_3_batch_2_layer_23_ffn_up -> llama_7b_stage_3_batch_2_layer_23_ffn_gate
			llama_7b_stage_3_batch_2_layer_23_ffn_gate -> llama_7b_stage_3_batch_2_layer_23_ffn_down
			llama_7b_stage_3_batch_2_layer_23_ffn_down -> llama_7b_stage_3_batch_2_layer_23_ffn_res
			llama_7b_stage_3_batch_2_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_2_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_2_layer_23_ffn_res -> llama_7b_stage_3_batch_2_layer_24_norm1
			llama_7b_stage_3_batch_2_layer_24_norm1 -> llama_7b_stage_3_batch_2_layer_24_qkv
			llama_7b_stage_3_batch_2_layer_24_qkv -> llama_7b_stage_3_batch_2_layer_24_attn
			llama_7b_stage_3_batch_2_layer_24_attn -> llama_7b_stage_3_batch_2_layer_24_attn_out
			llama_7b_stage_3_batch_2_layer_24_attn_out -> llama_7b_stage_3_batch_2_layer_24_attn_res
			llama_7b_stage_3_batch_2_layer_24_attn_res -> llama_7b_stage_3_batch_2_layer_24_norm2
			llama_7b_stage_3_batch_2_layer_24_norm2 -> llama_7b_stage_3_batch_2_layer_24_ffn_up
			llama_7b_stage_3_batch_2_layer_24_ffn_up -> llama_7b_stage_3_batch_2_layer_24_ffn_gate
			llama_7b_stage_3_batch_2_layer_24_ffn_gate -> llama_7b_stage_3_batch_2_layer_24_ffn_down
			llama_7b_stage_3_batch_2_layer_24_ffn_down -> llama_7b_stage_3_batch_2_layer_24_ffn_res
			llama_7b_stage_3_batch_2_output [label="Stage 3 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_2_layer_24_ffn_res -> llama_7b_stage_3_batch_2_output
			llama_7b_stage_3_batch_3_input [label="Micro-batch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_input -> llama_7b_stage_3_batch_3_layer_17_norm1
			llama_7b_stage_3_batch_3_layer_17_norm1 -> llama_7b_stage_3_batch_3_layer_17_qkv
			llama_7b_stage_3_batch_3_layer_17_qkv -> llama_7b_stage_3_batch_3_layer_17_attn
			llama_7b_stage_3_batch_3_layer_17_attn -> llama_7b_stage_3_batch_3_layer_17_attn_out
			llama_7b_stage_3_batch_3_layer_17_attn_out -> llama_7b_stage_3_batch_3_layer_17_attn_res
			llama_7b_stage_3_batch_3_layer_17_attn_res -> llama_7b_stage_3_batch_3_layer_17_norm2
			llama_7b_stage_3_batch_3_layer_17_norm2 -> llama_7b_stage_3_batch_3_layer_17_ffn_up
			llama_7b_stage_3_batch_3_layer_17_ffn_up -> llama_7b_stage_3_batch_3_layer_17_ffn_gate
			llama_7b_stage_3_batch_3_layer_17_ffn_gate -> llama_7b_stage_3_batch_3_layer_17_ffn_down
			llama_7b_stage_3_batch_3_layer_17_ffn_down -> llama_7b_stage_3_batch_3_layer_17_ffn_res
			llama_7b_stage_3_batch_3_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_17_ffn_res -> llama_7b_stage_3_batch_3_layer_18_norm1
			llama_7b_stage_3_batch_3_layer_18_norm1 -> llama_7b_stage_3_batch_3_layer_18_qkv
			llama_7b_stage_3_batch_3_layer_18_qkv -> llama_7b_stage_3_batch_3_layer_18_attn
			llama_7b_stage_3_batch_3_layer_18_attn -> llama_7b_stage_3_batch_3_layer_18_attn_out
			llama_7b_stage_3_batch_3_layer_18_attn_out -> llama_7b_stage_3_batch_3_layer_18_attn_res
			llama_7b_stage_3_batch_3_layer_18_attn_res -> llama_7b_stage_3_batch_3_layer_18_norm2
			llama_7b_stage_3_batch_3_layer_18_norm2 -> llama_7b_stage_3_batch_3_layer_18_ffn_up
			llama_7b_stage_3_batch_3_layer_18_ffn_up -> llama_7b_stage_3_batch_3_layer_18_ffn_gate
			llama_7b_stage_3_batch_3_layer_18_ffn_gate -> llama_7b_stage_3_batch_3_layer_18_ffn_down
			llama_7b_stage_3_batch_3_layer_18_ffn_down -> llama_7b_stage_3_batch_3_layer_18_ffn_res
			llama_7b_stage_3_batch_3_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_18_ffn_res -> llama_7b_stage_3_batch_3_layer_19_norm1
			llama_7b_stage_3_batch_3_layer_19_norm1 -> llama_7b_stage_3_batch_3_layer_19_qkv
			llama_7b_stage_3_batch_3_layer_19_qkv -> llama_7b_stage_3_batch_3_layer_19_attn
			llama_7b_stage_3_batch_3_layer_19_attn -> llama_7b_stage_3_batch_3_layer_19_attn_out
			llama_7b_stage_3_batch_3_layer_19_attn_out -> llama_7b_stage_3_batch_3_layer_19_attn_res
			llama_7b_stage_3_batch_3_layer_19_attn_res -> llama_7b_stage_3_batch_3_layer_19_norm2
			llama_7b_stage_3_batch_3_layer_19_norm2 -> llama_7b_stage_3_batch_3_layer_19_ffn_up
			llama_7b_stage_3_batch_3_layer_19_ffn_up -> llama_7b_stage_3_batch_3_layer_19_ffn_gate
			llama_7b_stage_3_batch_3_layer_19_ffn_gate -> llama_7b_stage_3_batch_3_layer_19_ffn_down
			llama_7b_stage_3_batch_3_layer_19_ffn_down -> llama_7b_stage_3_batch_3_layer_19_ffn_res
			llama_7b_stage_3_batch_3_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_19_ffn_res -> llama_7b_stage_3_batch_3_layer_20_norm1
			llama_7b_stage_3_batch_3_layer_20_norm1 -> llama_7b_stage_3_batch_3_layer_20_qkv
			llama_7b_stage_3_batch_3_layer_20_qkv -> llama_7b_stage_3_batch_3_layer_20_attn
			llama_7b_stage_3_batch_3_layer_20_attn -> llama_7b_stage_3_batch_3_layer_20_attn_out
			llama_7b_stage_3_batch_3_layer_20_attn_out -> llama_7b_stage_3_batch_3_layer_20_attn_res
			llama_7b_stage_3_batch_3_layer_20_attn_res -> llama_7b_stage_3_batch_3_layer_20_norm2
			llama_7b_stage_3_batch_3_layer_20_norm2 -> llama_7b_stage_3_batch_3_layer_20_ffn_up
			llama_7b_stage_3_batch_3_layer_20_ffn_up -> llama_7b_stage_3_batch_3_layer_20_ffn_gate
			llama_7b_stage_3_batch_3_layer_20_ffn_gate -> llama_7b_stage_3_batch_3_layer_20_ffn_down
			llama_7b_stage_3_batch_3_layer_20_ffn_down -> llama_7b_stage_3_batch_3_layer_20_ffn_res
			llama_7b_stage_3_batch_3_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_20_ffn_res -> llama_7b_stage_3_batch_3_layer_21_norm1
			llama_7b_stage_3_batch_3_layer_21_norm1 -> llama_7b_stage_3_batch_3_layer_21_qkv
			llama_7b_stage_3_batch_3_layer_21_qkv -> llama_7b_stage_3_batch_3_layer_21_attn
			llama_7b_stage_3_batch_3_layer_21_attn -> llama_7b_stage_3_batch_3_layer_21_attn_out
			llama_7b_stage_3_batch_3_layer_21_attn_out -> llama_7b_stage_3_batch_3_layer_21_attn_res
			llama_7b_stage_3_batch_3_layer_21_attn_res -> llama_7b_stage_3_batch_3_layer_21_norm2
			llama_7b_stage_3_batch_3_layer_21_norm2 -> llama_7b_stage_3_batch_3_layer_21_ffn_up
			llama_7b_stage_3_batch_3_layer_21_ffn_up -> llama_7b_stage_3_batch_3_layer_21_ffn_gate
			llama_7b_stage_3_batch_3_layer_21_ffn_gate -> llama_7b_stage_3_batch_3_layer_21_ffn_down
			llama_7b_stage_3_batch_3_layer_21_ffn_down -> llama_7b_stage_3_batch_3_layer_21_ffn_res
			llama_7b_stage_3_batch_3_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_21_ffn_res -> llama_7b_stage_3_batch_3_layer_22_norm1
			llama_7b_stage_3_batch_3_layer_22_norm1 -> llama_7b_stage_3_batch_3_layer_22_qkv
			llama_7b_stage_3_batch_3_layer_22_qkv -> llama_7b_stage_3_batch_3_layer_22_attn
			llama_7b_stage_3_batch_3_layer_22_attn -> llama_7b_stage_3_batch_3_layer_22_attn_out
			llama_7b_stage_3_batch_3_layer_22_attn_out -> llama_7b_stage_3_batch_3_layer_22_attn_res
			llama_7b_stage_3_batch_3_layer_22_attn_res -> llama_7b_stage_3_batch_3_layer_22_norm2
			llama_7b_stage_3_batch_3_layer_22_norm2 -> llama_7b_stage_3_batch_3_layer_22_ffn_up
			llama_7b_stage_3_batch_3_layer_22_ffn_up -> llama_7b_stage_3_batch_3_layer_22_ffn_gate
			llama_7b_stage_3_batch_3_layer_22_ffn_gate -> llama_7b_stage_3_batch_3_layer_22_ffn_down
			llama_7b_stage_3_batch_3_layer_22_ffn_down -> llama_7b_stage_3_batch_3_layer_22_ffn_res
			llama_7b_stage_3_batch_3_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_22_ffn_res -> llama_7b_stage_3_batch_3_layer_23_norm1
			llama_7b_stage_3_batch_3_layer_23_norm1 -> llama_7b_stage_3_batch_3_layer_23_qkv
			llama_7b_stage_3_batch_3_layer_23_qkv -> llama_7b_stage_3_batch_3_layer_23_attn
			llama_7b_stage_3_batch_3_layer_23_attn -> llama_7b_stage_3_batch_3_layer_23_attn_out
			llama_7b_stage_3_batch_3_layer_23_attn_out -> llama_7b_stage_3_batch_3_layer_23_attn_res
			llama_7b_stage_3_batch_3_layer_23_attn_res -> llama_7b_stage_3_batch_3_layer_23_norm2
			llama_7b_stage_3_batch_3_layer_23_norm2 -> llama_7b_stage_3_batch_3_layer_23_ffn_up
			llama_7b_stage_3_batch_3_layer_23_ffn_up -> llama_7b_stage_3_batch_3_layer_23_ffn_gate
			llama_7b_stage_3_batch_3_layer_23_ffn_gate -> llama_7b_stage_3_batch_3_layer_23_ffn_down
			llama_7b_stage_3_batch_3_layer_23_ffn_down -> llama_7b_stage_3_batch_3_layer_23_ffn_res
			llama_7b_stage_3_batch_3_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_3_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_3_layer_23_ffn_res -> llama_7b_stage_3_batch_3_layer_24_norm1
			llama_7b_stage_3_batch_3_layer_24_norm1 -> llama_7b_stage_3_batch_3_layer_24_qkv
			llama_7b_stage_3_batch_3_layer_24_qkv -> llama_7b_stage_3_batch_3_layer_24_attn
			llama_7b_stage_3_batch_3_layer_24_attn -> llama_7b_stage_3_batch_3_layer_24_attn_out
			llama_7b_stage_3_batch_3_layer_24_attn_out -> llama_7b_stage_3_batch_3_layer_24_attn_res
			llama_7b_stage_3_batch_3_layer_24_attn_res -> llama_7b_stage_3_batch_3_layer_24_norm2
			llama_7b_stage_3_batch_3_layer_24_norm2 -> llama_7b_stage_3_batch_3_layer_24_ffn_up
			llama_7b_stage_3_batch_3_layer_24_ffn_up -> llama_7b_stage_3_batch_3_layer_24_ffn_gate
			llama_7b_stage_3_batch_3_layer_24_ffn_gate -> llama_7b_stage_3_batch_3_layer_24_ffn_down
			llama_7b_stage_3_batch_3_layer_24_ffn_down -> llama_7b_stage_3_batch_3_layer_24_ffn_res
			llama_7b_stage_3_batch_3_output [label="Stage 3 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_3_layer_24_ffn_res -> llama_7b_stage_3_batch_3_output
			llama_7b_stage_3_batch_4_input [label="Micro-batch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_input -> llama_7b_stage_3_batch_4_layer_17_norm1
			llama_7b_stage_3_batch_4_layer_17_norm1 -> llama_7b_stage_3_batch_4_layer_17_qkv
			llama_7b_stage_3_batch_4_layer_17_qkv -> llama_7b_stage_3_batch_4_layer_17_attn
			llama_7b_stage_3_batch_4_layer_17_attn -> llama_7b_stage_3_batch_4_layer_17_attn_out
			llama_7b_stage_3_batch_4_layer_17_attn_out -> llama_7b_stage_3_batch_4_layer_17_attn_res
			llama_7b_stage_3_batch_4_layer_17_attn_res -> llama_7b_stage_3_batch_4_layer_17_norm2
			llama_7b_stage_3_batch_4_layer_17_norm2 -> llama_7b_stage_3_batch_4_layer_17_ffn_up
			llama_7b_stage_3_batch_4_layer_17_ffn_up -> llama_7b_stage_3_batch_4_layer_17_ffn_gate
			llama_7b_stage_3_batch_4_layer_17_ffn_gate -> llama_7b_stage_3_batch_4_layer_17_ffn_down
			llama_7b_stage_3_batch_4_layer_17_ffn_down -> llama_7b_stage_3_batch_4_layer_17_ffn_res
			llama_7b_stage_3_batch_4_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_17_ffn_res -> llama_7b_stage_3_batch_4_layer_18_norm1
			llama_7b_stage_3_batch_4_layer_18_norm1 -> llama_7b_stage_3_batch_4_layer_18_qkv
			llama_7b_stage_3_batch_4_layer_18_qkv -> llama_7b_stage_3_batch_4_layer_18_attn
			llama_7b_stage_3_batch_4_layer_18_attn -> llama_7b_stage_3_batch_4_layer_18_attn_out
			llama_7b_stage_3_batch_4_layer_18_attn_out -> llama_7b_stage_3_batch_4_layer_18_attn_res
			llama_7b_stage_3_batch_4_layer_18_attn_res -> llama_7b_stage_3_batch_4_layer_18_norm2
			llama_7b_stage_3_batch_4_layer_18_norm2 -> llama_7b_stage_3_batch_4_layer_18_ffn_up
			llama_7b_stage_3_batch_4_layer_18_ffn_up -> llama_7b_stage_3_batch_4_layer_18_ffn_gate
			llama_7b_stage_3_batch_4_layer_18_ffn_gate -> llama_7b_stage_3_batch_4_layer_18_ffn_down
			llama_7b_stage_3_batch_4_layer_18_ffn_down -> llama_7b_stage_3_batch_4_layer_18_ffn_res
			llama_7b_stage_3_batch_4_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_18_ffn_res -> llama_7b_stage_3_batch_4_layer_19_norm1
			llama_7b_stage_3_batch_4_layer_19_norm1 -> llama_7b_stage_3_batch_4_layer_19_qkv
			llama_7b_stage_3_batch_4_layer_19_qkv -> llama_7b_stage_3_batch_4_layer_19_attn
			llama_7b_stage_3_batch_4_layer_19_attn -> llama_7b_stage_3_batch_4_layer_19_attn_out
			llama_7b_stage_3_batch_4_layer_19_attn_out -> llama_7b_stage_3_batch_4_layer_19_attn_res
			llama_7b_stage_3_batch_4_layer_19_attn_res -> llama_7b_stage_3_batch_4_layer_19_norm2
			llama_7b_stage_3_batch_4_layer_19_norm2 -> llama_7b_stage_3_batch_4_layer_19_ffn_up
			llama_7b_stage_3_batch_4_layer_19_ffn_up -> llama_7b_stage_3_batch_4_layer_19_ffn_gate
			llama_7b_stage_3_batch_4_layer_19_ffn_gate -> llama_7b_stage_3_batch_4_layer_19_ffn_down
			llama_7b_stage_3_batch_4_layer_19_ffn_down -> llama_7b_stage_3_batch_4_layer_19_ffn_res
			llama_7b_stage_3_batch_4_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_19_ffn_res -> llama_7b_stage_3_batch_4_layer_20_norm1
			llama_7b_stage_3_batch_4_layer_20_norm1 -> llama_7b_stage_3_batch_4_layer_20_qkv
			llama_7b_stage_3_batch_4_layer_20_qkv -> llama_7b_stage_3_batch_4_layer_20_attn
			llama_7b_stage_3_batch_4_layer_20_attn -> llama_7b_stage_3_batch_4_layer_20_attn_out
			llama_7b_stage_3_batch_4_layer_20_attn_out -> llama_7b_stage_3_batch_4_layer_20_attn_res
			llama_7b_stage_3_batch_4_layer_20_attn_res -> llama_7b_stage_3_batch_4_layer_20_norm2
			llama_7b_stage_3_batch_4_layer_20_norm2 -> llama_7b_stage_3_batch_4_layer_20_ffn_up
			llama_7b_stage_3_batch_4_layer_20_ffn_up -> llama_7b_stage_3_batch_4_layer_20_ffn_gate
			llama_7b_stage_3_batch_4_layer_20_ffn_gate -> llama_7b_stage_3_batch_4_layer_20_ffn_down
			llama_7b_stage_3_batch_4_layer_20_ffn_down -> llama_7b_stage_3_batch_4_layer_20_ffn_res
			llama_7b_stage_3_batch_4_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_20_ffn_res -> llama_7b_stage_3_batch_4_layer_21_norm1
			llama_7b_stage_3_batch_4_layer_21_norm1 -> llama_7b_stage_3_batch_4_layer_21_qkv
			llama_7b_stage_3_batch_4_layer_21_qkv -> llama_7b_stage_3_batch_4_layer_21_attn
			llama_7b_stage_3_batch_4_layer_21_attn -> llama_7b_stage_3_batch_4_layer_21_attn_out
			llama_7b_stage_3_batch_4_layer_21_attn_out -> llama_7b_stage_3_batch_4_layer_21_attn_res
			llama_7b_stage_3_batch_4_layer_21_attn_res -> llama_7b_stage_3_batch_4_layer_21_norm2
			llama_7b_stage_3_batch_4_layer_21_norm2 -> llama_7b_stage_3_batch_4_layer_21_ffn_up
			llama_7b_stage_3_batch_4_layer_21_ffn_up -> llama_7b_stage_3_batch_4_layer_21_ffn_gate
			llama_7b_stage_3_batch_4_layer_21_ffn_gate -> llama_7b_stage_3_batch_4_layer_21_ffn_down
			llama_7b_stage_3_batch_4_layer_21_ffn_down -> llama_7b_stage_3_batch_4_layer_21_ffn_res
			llama_7b_stage_3_batch_4_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_21_ffn_res -> llama_7b_stage_3_batch_4_layer_22_norm1
			llama_7b_stage_3_batch_4_layer_22_norm1 -> llama_7b_stage_3_batch_4_layer_22_qkv
			llama_7b_stage_3_batch_4_layer_22_qkv -> llama_7b_stage_3_batch_4_layer_22_attn
			llama_7b_stage_3_batch_4_layer_22_attn -> llama_7b_stage_3_batch_4_layer_22_attn_out
			llama_7b_stage_3_batch_4_layer_22_attn_out -> llama_7b_stage_3_batch_4_layer_22_attn_res
			llama_7b_stage_3_batch_4_layer_22_attn_res -> llama_7b_stage_3_batch_4_layer_22_norm2
			llama_7b_stage_3_batch_4_layer_22_norm2 -> llama_7b_stage_3_batch_4_layer_22_ffn_up
			llama_7b_stage_3_batch_4_layer_22_ffn_up -> llama_7b_stage_3_batch_4_layer_22_ffn_gate
			llama_7b_stage_3_batch_4_layer_22_ffn_gate -> llama_7b_stage_3_batch_4_layer_22_ffn_down
			llama_7b_stage_3_batch_4_layer_22_ffn_down -> llama_7b_stage_3_batch_4_layer_22_ffn_res
			llama_7b_stage_3_batch_4_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_22_ffn_res -> llama_7b_stage_3_batch_4_layer_23_norm1
			llama_7b_stage_3_batch_4_layer_23_norm1 -> llama_7b_stage_3_batch_4_layer_23_qkv
			llama_7b_stage_3_batch_4_layer_23_qkv -> llama_7b_stage_3_batch_4_layer_23_attn
			llama_7b_stage_3_batch_4_layer_23_attn -> llama_7b_stage_3_batch_4_layer_23_attn_out
			llama_7b_stage_3_batch_4_layer_23_attn_out -> llama_7b_stage_3_batch_4_layer_23_attn_res
			llama_7b_stage_3_batch_4_layer_23_attn_res -> llama_7b_stage_3_batch_4_layer_23_norm2
			llama_7b_stage_3_batch_4_layer_23_norm2 -> llama_7b_stage_3_batch_4_layer_23_ffn_up
			llama_7b_stage_3_batch_4_layer_23_ffn_up -> llama_7b_stage_3_batch_4_layer_23_ffn_gate
			llama_7b_stage_3_batch_4_layer_23_ffn_gate -> llama_7b_stage_3_batch_4_layer_23_ffn_down
			llama_7b_stage_3_batch_4_layer_23_ffn_down -> llama_7b_stage_3_batch_4_layer_23_ffn_res
			llama_7b_stage_3_batch_4_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_3_batch_4_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_3_batch_4_layer_23_ffn_res -> llama_7b_stage_3_batch_4_layer_24_norm1
			llama_7b_stage_3_batch_4_layer_24_norm1 -> llama_7b_stage_3_batch_4_layer_24_qkv
			llama_7b_stage_3_batch_4_layer_24_qkv -> llama_7b_stage_3_batch_4_layer_24_attn
			llama_7b_stage_3_batch_4_layer_24_attn -> llama_7b_stage_3_batch_4_layer_24_attn_out
			llama_7b_stage_3_batch_4_layer_24_attn_out -> llama_7b_stage_3_batch_4_layer_24_attn_res
			llama_7b_stage_3_batch_4_layer_24_attn_res -> llama_7b_stage_3_batch_4_layer_24_norm2
			llama_7b_stage_3_batch_4_layer_24_norm2 -> llama_7b_stage_3_batch_4_layer_24_ffn_up
			llama_7b_stage_3_batch_4_layer_24_ffn_up -> llama_7b_stage_3_batch_4_layer_24_ffn_gate
			llama_7b_stage_3_batch_4_layer_24_ffn_gate -> llama_7b_stage_3_batch_4_layer_24_ffn_down
			llama_7b_stage_3_batch_4_layer_24_ffn_down -> llama_7b_stage_3_batch_4_layer_24_ffn_res
			llama_7b_stage_3_batch_4_output [label="Stage 3 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_3_batch_4_layer_24_ffn_res -> llama_7b_stage_3_batch_4_output
		}
		subgraph cluster_llama_7b_stage_4 {
			color=black fillcolor=lightgreen label="Stage 4\nGPU_4\nLayers 25-32" style="rounded,filled"
			llama_7b_stage_4_batch_1_input [label="Micro-batch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_25_norm1 [label="L25 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_25_qkv [label="L25 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_attn [label="L25 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_attn_out [label="L25 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_attn_res [label="L25 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_25_norm2 [label="L25 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_25_ffn_up [label="L25 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_ffn_gate [label="L25 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_ffn_down [label="L25 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_25_ffn_res [label="L25 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_input -> llama_7b_stage_4_batch_1_layer_25_norm1
			llama_7b_stage_4_batch_1_layer_25_norm1 -> llama_7b_stage_4_batch_1_layer_25_qkv
			llama_7b_stage_4_batch_1_layer_25_qkv -> llama_7b_stage_4_batch_1_layer_25_attn
			llama_7b_stage_4_batch_1_layer_25_attn -> llama_7b_stage_4_batch_1_layer_25_attn_out
			llama_7b_stage_4_batch_1_layer_25_attn_out -> llama_7b_stage_4_batch_1_layer_25_attn_res
			llama_7b_stage_4_batch_1_layer_25_attn_res -> llama_7b_stage_4_batch_1_layer_25_norm2
			llama_7b_stage_4_batch_1_layer_25_norm2 -> llama_7b_stage_4_batch_1_layer_25_ffn_up
			llama_7b_stage_4_batch_1_layer_25_ffn_up -> llama_7b_stage_4_batch_1_layer_25_ffn_gate
			llama_7b_stage_4_batch_1_layer_25_ffn_gate -> llama_7b_stage_4_batch_1_layer_25_ffn_down
			llama_7b_stage_4_batch_1_layer_25_ffn_down -> llama_7b_stage_4_batch_1_layer_25_ffn_res
			llama_7b_stage_4_batch_1_layer_26_norm1 [label="L26 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_26_qkv [label="L26 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_attn [label="L26 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_attn_out [label="L26 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_attn_res [label="L26 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_26_norm2 [label="L26 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_26_ffn_up [label="L26 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_ffn_gate [label="L26 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_ffn_down [label="L26 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_26_ffn_res [label="L26 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_25_ffn_res -> llama_7b_stage_4_batch_1_layer_26_norm1
			llama_7b_stage_4_batch_1_layer_26_norm1 -> llama_7b_stage_4_batch_1_layer_26_qkv
			llama_7b_stage_4_batch_1_layer_26_qkv -> llama_7b_stage_4_batch_1_layer_26_attn
			llama_7b_stage_4_batch_1_layer_26_attn -> llama_7b_stage_4_batch_1_layer_26_attn_out
			llama_7b_stage_4_batch_1_layer_26_attn_out -> llama_7b_stage_4_batch_1_layer_26_attn_res
			llama_7b_stage_4_batch_1_layer_26_attn_res -> llama_7b_stage_4_batch_1_layer_26_norm2
			llama_7b_stage_4_batch_1_layer_26_norm2 -> llama_7b_stage_4_batch_1_layer_26_ffn_up
			llama_7b_stage_4_batch_1_layer_26_ffn_up -> llama_7b_stage_4_batch_1_layer_26_ffn_gate
			llama_7b_stage_4_batch_1_layer_26_ffn_gate -> llama_7b_stage_4_batch_1_layer_26_ffn_down
			llama_7b_stage_4_batch_1_layer_26_ffn_down -> llama_7b_stage_4_batch_1_layer_26_ffn_res
			llama_7b_stage_4_batch_1_layer_27_norm1 [label="L27 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_27_qkv [label="L27 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_attn [label="L27 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_attn_out [label="L27 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_attn_res [label="L27 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_27_norm2 [label="L27 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_27_ffn_up [label="L27 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_ffn_gate [label="L27 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_ffn_down [label="L27 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_27_ffn_res [label="L27 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_26_ffn_res -> llama_7b_stage_4_batch_1_layer_27_norm1
			llama_7b_stage_4_batch_1_layer_27_norm1 -> llama_7b_stage_4_batch_1_layer_27_qkv
			llama_7b_stage_4_batch_1_layer_27_qkv -> llama_7b_stage_4_batch_1_layer_27_attn
			llama_7b_stage_4_batch_1_layer_27_attn -> llama_7b_stage_4_batch_1_layer_27_attn_out
			llama_7b_stage_4_batch_1_layer_27_attn_out -> llama_7b_stage_4_batch_1_layer_27_attn_res
			llama_7b_stage_4_batch_1_layer_27_attn_res -> llama_7b_stage_4_batch_1_layer_27_norm2
			llama_7b_stage_4_batch_1_layer_27_norm2 -> llama_7b_stage_4_batch_1_layer_27_ffn_up
			llama_7b_stage_4_batch_1_layer_27_ffn_up -> llama_7b_stage_4_batch_1_layer_27_ffn_gate
			llama_7b_stage_4_batch_1_layer_27_ffn_gate -> llama_7b_stage_4_batch_1_layer_27_ffn_down
			llama_7b_stage_4_batch_1_layer_27_ffn_down -> llama_7b_stage_4_batch_1_layer_27_ffn_res
			llama_7b_stage_4_batch_1_layer_28_norm1 [label="L28 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_28_qkv [label="L28 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_attn [label="L28 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_attn_out [label="L28 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_attn_res [label="L28 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_28_norm2 [label="L28 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_28_ffn_up [label="L28 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_ffn_gate [label="L28 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_ffn_down [label="L28 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_28_ffn_res [label="L28 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_27_ffn_res -> llama_7b_stage_4_batch_1_layer_28_norm1
			llama_7b_stage_4_batch_1_layer_28_norm1 -> llama_7b_stage_4_batch_1_layer_28_qkv
			llama_7b_stage_4_batch_1_layer_28_qkv -> llama_7b_stage_4_batch_1_layer_28_attn
			llama_7b_stage_4_batch_1_layer_28_attn -> llama_7b_stage_4_batch_1_layer_28_attn_out
			llama_7b_stage_4_batch_1_layer_28_attn_out -> llama_7b_stage_4_batch_1_layer_28_attn_res
			llama_7b_stage_4_batch_1_layer_28_attn_res -> llama_7b_stage_4_batch_1_layer_28_norm2
			llama_7b_stage_4_batch_1_layer_28_norm2 -> llama_7b_stage_4_batch_1_layer_28_ffn_up
			llama_7b_stage_4_batch_1_layer_28_ffn_up -> llama_7b_stage_4_batch_1_layer_28_ffn_gate
			llama_7b_stage_4_batch_1_layer_28_ffn_gate -> llama_7b_stage_4_batch_1_layer_28_ffn_down
			llama_7b_stage_4_batch_1_layer_28_ffn_down -> llama_7b_stage_4_batch_1_layer_28_ffn_res
			llama_7b_stage_4_batch_1_layer_29_norm1 [label="L29 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_29_qkv [label="L29 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_attn [label="L29 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_attn_out [label="L29 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_attn_res [label="L29 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_29_norm2 [label="L29 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_29_ffn_up [label="L29 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_ffn_gate [label="L29 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_ffn_down [label="L29 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_29_ffn_res [label="L29 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_28_ffn_res -> llama_7b_stage_4_batch_1_layer_29_norm1
			llama_7b_stage_4_batch_1_layer_29_norm1 -> llama_7b_stage_4_batch_1_layer_29_qkv
			llama_7b_stage_4_batch_1_layer_29_qkv -> llama_7b_stage_4_batch_1_layer_29_attn
			llama_7b_stage_4_batch_1_layer_29_attn -> llama_7b_stage_4_batch_1_layer_29_attn_out
			llama_7b_stage_4_batch_1_layer_29_attn_out -> llama_7b_stage_4_batch_1_layer_29_attn_res
			llama_7b_stage_4_batch_1_layer_29_attn_res -> llama_7b_stage_4_batch_1_layer_29_norm2
			llama_7b_stage_4_batch_1_layer_29_norm2 -> llama_7b_stage_4_batch_1_layer_29_ffn_up
			llama_7b_stage_4_batch_1_layer_29_ffn_up -> llama_7b_stage_4_batch_1_layer_29_ffn_gate
			llama_7b_stage_4_batch_1_layer_29_ffn_gate -> llama_7b_stage_4_batch_1_layer_29_ffn_down
			llama_7b_stage_4_batch_1_layer_29_ffn_down -> llama_7b_stage_4_batch_1_layer_29_ffn_res
			llama_7b_stage_4_batch_1_layer_30_norm1 [label="L30 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_30_qkv [label="L30 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_attn [label="L30 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_attn_out [label="L30 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_attn_res [label="L30 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_30_norm2 [label="L30 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_30_ffn_up [label="L30 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_ffn_gate [label="L30 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_ffn_down [label="L30 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_30_ffn_res [label="L30 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_29_ffn_res -> llama_7b_stage_4_batch_1_layer_30_norm1
			llama_7b_stage_4_batch_1_layer_30_norm1 -> llama_7b_stage_4_batch_1_layer_30_qkv
			llama_7b_stage_4_batch_1_layer_30_qkv -> llama_7b_stage_4_batch_1_layer_30_attn
			llama_7b_stage_4_batch_1_layer_30_attn -> llama_7b_stage_4_batch_1_layer_30_attn_out
			llama_7b_stage_4_batch_1_layer_30_attn_out -> llama_7b_stage_4_batch_1_layer_30_attn_res
			llama_7b_stage_4_batch_1_layer_30_attn_res -> llama_7b_stage_4_batch_1_layer_30_norm2
			llama_7b_stage_4_batch_1_layer_30_norm2 -> llama_7b_stage_4_batch_1_layer_30_ffn_up
			llama_7b_stage_4_batch_1_layer_30_ffn_up -> llama_7b_stage_4_batch_1_layer_30_ffn_gate
			llama_7b_stage_4_batch_1_layer_30_ffn_gate -> llama_7b_stage_4_batch_1_layer_30_ffn_down
			llama_7b_stage_4_batch_1_layer_30_ffn_down -> llama_7b_stage_4_batch_1_layer_30_ffn_res
			llama_7b_stage_4_batch_1_layer_31_norm1 [label="L31 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_31_qkv [label="L31 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_attn [label="L31 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_attn_out [label="L31 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_attn_res [label="L31 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_31_norm2 [label="L31 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_31_ffn_up [label="L31 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_ffn_gate [label="L31 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_ffn_down [label="L31 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_31_ffn_res [label="L31 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_30_ffn_res -> llama_7b_stage_4_batch_1_layer_31_norm1
			llama_7b_stage_4_batch_1_layer_31_norm1 -> llama_7b_stage_4_batch_1_layer_31_qkv
			llama_7b_stage_4_batch_1_layer_31_qkv -> llama_7b_stage_4_batch_1_layer_31_attn
			llama_7b_stage_4_batch_1_layer_31_attn -> llama_7b_stage_4_batch_1_layer_31_attn_out
			llama_7b_stage_4_batch_1_layer_31_attn_out -> llama_7b_stage_4_batch_1_layer_31_attn_res
			llama_7b_stage_4_batch_1_layer_31_attn_res -> llama_7b_stage_4_batch_1_layer_31_norm2
			llama_7b_stage_4_batch_1_layer_31_norm2 -> llama_7b_stage_4_batch_1_layer_31_ffn_up
			llama_7b_stage_4_batch_1_layer_31_ffn_up -> llama_7b_stage_4_batch_1_layer_31_ffn_gate
			llama_7b_stage_4_batch_1_layer_31_ffn_gate -> llama_7b_stage_4_batch_1_layer_31_ffn_down
			llama_7b_stage_4_batch_1_layer_31_ffn_down -> llama_7b_stage_4_batch_1_layer_31_ffn_res
			llama_7b_stage_4_batch_1_layer_32_norm1 [label="L32 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_32_qkv [label="L32 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_attn [label="L32 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_attn_out [label="L32 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_attn_res [label="L32 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_32_norm2 [label="L32 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_32_ffn_up [label="L32 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_ffn_gate [label="L32 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_ffn_down [label="L32 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_1_layer_32_ffn_res [label="L32 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_1_layer_31_ffn_res -> llama_7b_stage_4_batch_1_layer_32_norm1
			llama_7b_stage_4_batch_1_layer_32_norm1 -> llama_7b_stage_4_batch_1_layer_32_qkv
			llama_7b_stage_4_batch_1_layer_32_qkv -> llama_7b_stage_4_batch_1_layer_32_attn
			llama_7b_stage_4_batch_1_layer_32_attn -> llama_7b_stage_4_batch_1_layer_32_attn_out
			llama_7b_stage_4_batch_1_layer_32_attn_out -> llama_7b_stage_4_batch_1_layer_32_attn_res
			llama_7b_stage_4_batch_1_layer_32_attn_res -> llama_7b_stage_4_batch_1_layer_32_norm2
			llama_7b_stage_4_batch_1_layer_32_norm2 -> llama_7b_stage_4_batch_1_layer_32_ffn_up
			llama_7b_stage_4_batch_1_layer_32_ffn_up -> llama_7b_stage_4_batch_1_layer_32_ffn_gate
			llama_7b_stage_4_batch_1_layer_32_ffn_gate -> llama_7b_stage_4_batch_1_layer_32_ffn_down
			llama_7b_stage_4_batch_1_layer_32_ffn_down -> llama_7b_stage_4_batch_1_layer_32_ffn_res
			llama_7b_stage_4_batch_1_output [label="Stage 4 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_1_layer_32_ffn_res -> llama_7b_stage_4_batch_1_output
			llama_7b_stage_4_batch_2_input [label="Micro-batch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_25_norm1 [label="L25 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_25_qkv [label="L25 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_attn [label="L25 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_attn_out [label="L25 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_attn_res [label="L25 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_25_norm2 [label="L25 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_25_ffn_up [label="L25 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_ffn_gate [label="L25 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_ffn_down [label="L25 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_25_ffn_res [label="L25 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_input -> llama_7b_stage_4_batch_2_layer_25_norm1
			llama_7b_stage_4_batch_2_layer_25_norm1 -> llama_7b_stage_4_batch_2_layer_25_qkv
			llama_7b_stage_4_batch_2_layer_25_qkv -> llama_7b_stage_4_batch_2_layer_25_attn
			llama_7b_stage_4_batch_2_layer_25_attn -> llama_7b_stage_4_batch_2_layer_25_attn_out
			llama_7b_stage_4_batch_2_layer_25_attn_out -> llama_7b_stage_4_batch_2_layer_25_attn_res
			llama_7b_stage_4_batch_2_layer_25_attn_res -> llama_7b_stage_4_batch_2_layer_25_norm2
			llama_7b_stage_4_batch_2_layer_25_norm2 -> llama_7b_stage_4_batch_2_layer_25_ffn_up
			llama_7b_stage_4_batch_2_layer_25_ffn_up -> llama_7b_stage_4_batch_2_layer_25_ffn_gate
			llama_7b_stage_4_batch_2_layer_25_ffn_gate -> llama_7b_stage_4_batch_2_layer_25_ffn_down
			llama_7b_stage_4_batch_2_layer_25_ffn_down -> llama_7b_stage_4_batch_2_layer_25_ffn_res
			llama_7b_stage_4_batch_2_layer_26_norm1 [label="L26 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_26_qkv [label="L26 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_attn [label="L26 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_attn_out [label="L26 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_attn_res [label="L26 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_26_norm2 [label="L26 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_26_ffn_up [label="L26 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_ffn_gate [label="L26 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_ffn_down [label="L26 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_26_ffn_res [label="L26 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_25_ffn_res -> llama_7b_stage_4_batch_2_layer_26_norm1
			llama_7b_stage_4_batch_2_layer_26_norm1 -> llama_7b_stage_4_batch_2_layer_26_qkv
			llama_7b_stage_4_batch_2_layer_26_qkv -> llama_7b_stage_4_batch_2_layer_26_attn
			llama_7b_stage_4_batch_2_layer_26_attn -> llama_7b_stage_4_batch_2_layer_26_attn_out
			llama_7b_stage_4_batch_2_layer_26_attn_out -> llama_7b_stage_4_batch_2_layer_26_attn_res
			llama_7b_stage_4_batch_2_layer_26_attn_res -> llama_7b_stage_4_batch_2_layer_26_norm2
			llama_7b_stage_4_batch_2_layer_26_norm2 -> llama_7b_stage_4_batch_2_layer_26_ffn_up
			llama_7b_stage_4_batch_2_layer_26_ffn_up -> llama_7b_stage_4_batch_2_layer_26_ffn_gate
			llama_7b_stage_4_batch_2_layer_26_ffn_gate -> llama_7b_stage_4_batch_2_layer_26_ffn_down
			llama_7b_stage_4_batch_2_layer_26_ffn_down -> llama_7b_stage_4_batch_2_layer_26_ffn_res
			llama_7b_stage_4_batch_2_layer_27_norm1 [label="L27 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_27_qkv [label="L27 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_attn [label="L27 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_attn_out [label="L27 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_attn_res [label="L27 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_27_norm2 [label="L27 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_27_ffn_up [label="L27 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_ffn_gate [label="L27 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_ffn_down [label="L27 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_27_ffn_res [label="L27 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_26_ffn_res -> llama_7b_stage_4_batch_2_layer_27_norm1
			llama_7b_stage_4_batch_2_layer_27_norm1 -> llama_7b_stage_4_batch_2_layer_27_qkv
			llama_7b_stage_4_batch_2_layer_27_qkv -> llama_7b_stage_4_batch_2_layer_27_attn
			llama_7b_stage_4_batch_2_layer_27_attn -> llama_7b_stage_4_batch_2_layer_27_attn_out
			llama_7b_stage_4_batch_2_layer_27_attn_out -> llama_7b_stage_4_batch_2_layer_27_attn_res
			llama_7b_stage_4_batch_2_layer_27_attn_res -> llama_7b_stage_4_batch_2_layer_27_norm2
			llama_7b_stage_4_batch_2_layer_27_norm2 -> llama_7b_stage_4_batch_2_layer_27_ffn_up
			llama_7b_stage_4_batch_2_layer_27_ffn_up -> llama_7b_stage_4_batch_2_layer_27_ffn_gate
			llama_7b_stage_4_batch_2_layer_27_ffn_gate -> llama_7b_stage_4_batch_2_layer_27_ffn_down
			llama_7b_stage_4_batch_2_layer_27_ffn_down -> llama_7b_stage_4_batch_2_layer_27_ffn_res
			llama_7b_stage_4_batch_2_layer_28_norm1 [label="L28 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_28_qkv [label="L28 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_attn [label="L28 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_attn_out [label="L28 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_attn_res [label="L28 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_28_norm2 [label="L28 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_28_ffn_up [label="L28 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_ffn_gate [label="L28 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_ffn_down [label="L28 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_28_ffn_res [label="L28 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_27_ffn_res -> llama_7b_stage_4_batch_2_layer_28_norm1
			llama_7b_stage_4_batch_2_layer_28_norm1 -> llama_7b_stage_4_batch_2_layer_28_qkv
			llama_7b_stage_4_batch_2_layer_28_qkv -> llama_7b_stage_4_batch_2_layer_28_attn
			llama_7b_stage_4_batch_2_layer_28_attn -> llama_7b_stage_4_batch_2_layer_28_attn_out
			llama_7b_stage_4_batch_2_layer_28_attn_out -> llama_7b_stage_4_batch_2_layer_28_attn_res
			llama_7b_stage_4_batch_2_layer_28_attn_res -> llama_7b_stage_4_batch_2_layer_28_norm2
			llama_7b_stage_4_batch_2_layer_28_norm2 -> llama_7b_stage_4_batch_2_layer_28_ffn_up
			llama_7b_stage_4_batch_2_layer_28_ffn_up -> llama_7b_stage_4_batch_2_layer_28_ffn_gate
			llama_7b_stage_4_batch_2_layer_28_ffn_gate -> llama_7b_stage_4_batch_2_layer_28_ffn_down
			llama_7b_stage_4_batch_2_layer_28_ffn_down -> llama_7b_stage_4_batch_2_layer_28_ffn_res
			llama_7b_stage_4_batch_2_layer_29_norm1 [label="L29 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_29_qkv [label="L29 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_attn [label="L29 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_attn_out [label="L29 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_attn_res [label="L29 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_29_norm2 [label="L29 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_29_ffn_up [label="L29 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_ffn_gate [label="L29 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_ffn_down [label="L29 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_29_ffn_res [label="L29 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_28_ffn_res -> llama_7b_stage_4_batch_2_layer_29_norm1
			llama_7b_stage_4_batch_2_layer_29_norm1 -> llama_7b_stage_4_batch_2_layer_29_qkv
			llama_7b_stage_4_batch_2_layer_29_qkv -> llama_7b_stage_4_batch_2_layer_29_attn
			llama_7b_stage_4_batch_2_layer_29_attn -> llama_7b_stage_4_batch_2_layer_29_attn_out
			llama_7b_stage_4_batch_2_layer_29_attn_out -> llama_7b_stage_4_batch_2_layer_29_attn_res
			llama_7b_stage_4_batch_2_layer_29_attn_res -> llama_7b_stage_4_batch_2_layer_29_norm2
			llama_7b_stage_4_batch_2_layer_29_norm2 -> llama_7b_stage_4_batch_2_layer_29_ffn_up
			llama_7b_stage_4_batch_2_layer_29_ffn_up -> llama_7b_stage_4_batch_2_layer_29_ffn_gate
			llama_7b_stage_4_batch_2_layer_29_ffn_gate -> llama_7b_stage_4_batch_2_layer_29_ffn_down
			llama_7b_stage_4_batch_2_layer_29_ffn_down -> llama_7b_stage_4_batch_2_layer_29_ffn_res
			llama_7b_stage_4_batch_2_layer_30_norm1 [label="L30 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_30_qkv [label="L30 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_attn [label="L30 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_attn_out [label="L30 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_attn_res [label="L30 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_30_norm2 [label="L30 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_30_ffn_up [label="L30 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_ffn_gate [label="L30 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_ffn_down [label="L30 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_30_ffn_res [label="L30 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_29_ffn_res -> llama_7b_stage_4_batch_2_layer_30_norm1
			llama_7b_stage_4_batch_2_layer_30_norm1 -> llama_7b_stage_4_batch_2_layer_30_qkv
			llama_7b_stage_4_batch_2_layer_30_qkv -> llama_7b_stage_4_batch_2_layer_30_attn
			llama_7b_stage_4_batch_2_layer_30_attn -> llama_7b_stage_4_batch_2_layer_30_attn_out
			llama_7b_stage_4_batch_2_layer_30_attn_out -> llama_7b_stage_4_batch_2_layer_30_attn_res
			llama_7b_stage_4_batch_2_layer_30_attn_res -> llama_7b_stage_4_batch_2_layer_30_norm2
			llama_7b_stage_4_batch_2_layer_30_norm2 -> llama_7b_stage_4_batch_2_layer_30_ffn_up
			llama_7b_stage_4_batch_2_layer_30_ffn_up -> llama_7b_stage_4_batch_2_layer_30_ffn_gate
			llama_7b_stage_4_batch_2_layer_30_ffn_gate -> llama_7b_stage_4_batch_2_layer_30_ffn_down
			llama_7b_stage_4_batch_2_layer_30_ffn_down -> llama_7b_stage_4_batch_2_layer_30_ffn_res
			llama_7b_stage_4_batch_2_layer_31_norm1 [label="L31 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_31_qkv [label="L31 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_attn [label="L31 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_attn_out [label="L31 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_attn_res [label="L31 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_31_norm2 [label="L31 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_31_ffn_up [label="L31 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_ffn_gate [label="L31 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_ffn_down [label="L31 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_31_ffn_res [label="L31 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_30_ffn_res -> llama_7b_stage_4_batch_2_layer_31_norm1
			llama_7b_stage_4_batch_2_layer_31_norm1 -> llama_7b_stage_4_batch_2_layer_31_qkv
			llama_7b_stage_4_batch_2_layer_31_qkv -> llama_7b_stage_4_batch_2_layer_31_attn
			llama_7b_stage_4_batch_2_layer_31_attn -> llama_7b_stage_4_batch_2_layer_31_attn_out
			llama_7b_stage_4_batch_2_layer_31_attn_out -> llama_7b_stage_4_batch_2_layer_31_attn_res
			llama_7b_stage_4_batch_2_layer_31_attn_res -> llama_7b_stage_4_batch_2_layer_31_norm2
			llama_7b_stage_4_batch_2_layer_31_norm2 -> llama_7b_stage_4_batch_2_layer_31_ffn_up
			llama_7b_stage_4_batch_2_layer_31_ffn_up -> llama_7b_stage_4_batch_2_layer_31_ffn_gate
			llama_7b_stage_4_batch_2_layer_31_ffn_gate -> llama_7b_stage_4_batch_2_layer_31_ffn_down
			llama_7b_stage_4_batch_2_layer_31_ffn_down -> llama_7b_stage_4_batch_2_layer_31_ffn_res
			llama_7b_stage_4_batch_2_layer_32_norm1 [label="L32 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_32_qkv [label="L32 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_attn [label="L32 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_attn_out [label="L32 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_attn_res [label="L32 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_32_norm2 [label="L32 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_32_ffn_up [label="L32 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_ffn_gate [label="L32 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_ffn_down [label="L32 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_2_layer_32_ffn_res [label="L32 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_2_layer_31_ffn_res -> llama_7b_stage_4_batch_2_layer_32_norm1
			llama_7b_stage_4_batch_2_layer_32_norm1 -> llama_7b_stage_4_batch_2_layer_32_qkv
			llama_7b_stage_4_batch_2_layer_32_qkv -> llama_7b_stage_4_batch_2_layer_32_attn
			llama_7b_stage_4_batch_2_layer_32_attn -> llama_7b_stage_4_batch_2_layer_32_attn_out
			llama_7b_stage_4_batch_2_layer_32_attn_out -> llama_7b_stage_4_batch_2_layer_32_attn_res
			llama_7b_stage_4_batch_2_layer_32_attn_res -> llama_7b_stage_4_batch_2_layer_32_norm2
			llama_7b_stage_4_batch_2_layer_32_norm2 -> llama_7b_stage_4_batch_2_layer_32_ffn_up
			llama_7b_stage_4_batch_2_layer_32_ffn_up -> llama_7b_stage_4_batch_2_layer_32_ffn_gate
			llama_7b_stage_4_batch_2_layer_32_ffn_gate -> llama_7b_stage_4_batch_2_layer_32_ffn_down
			llama_7b_stage_4_batch_2_layer_32_ffn_down -> llama_7b_stage_4_batch_2_layer_32_ffn_res
			llama_7b_stage_4_batch_2_output [label="Stage 4 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_2_layer_32_ffn_res -> llama_7b_stage_4_batch_2_output
			llama_7b_stage_4_batch_3_input [label="Micro-batch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_25_norm1 [label="L25 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_25_qkv [label="L25 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_attn [label="L25 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_attn_out [label="L25 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_attn_res [label="L25 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_25_norm2 [label="L25 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_25_ffn_up [label="L25 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_ffn_gate [label="L25 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_ffn_down [label="L25 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_25_ffn_res [label="L25 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_input -> llama_7b_stage_4_batch_3_layer_25_norm1
			llama_7b_stage_4_batch_3_layer_25_norm1 -> llama_7b_stage_4_batch_3_layer_25_qkv
			llama_7b_stage_4_batch_3_layer_25_qkv -> llama_7b_stage_4_batch_3_layer_25_attn
			llama_7b_stage_4_batch_3_layer_25_attn -> llama_7b_stage_4_batch_3_layer_25_attn_out
			llama_7b_stage_4_batch_3_layer_25_attn_out -> llama_7b_stage_4_batch_3_layer_25_attn_res
			llama_7b_stage_4_batch_3_layer_25_attn_res -> llama_7b_stage_4_batch_3_layer_25_norm2
			llama_7b_stage_4_batch_3_layer_25_norm2 -> llama_7b_stage_4_batch_3_layer_25_ffn_up
			llama_7b_stage_4_batch_3_layer_25_ffn_up -> llama_7b_stage_4_batch_3_layer_25_ffn_gate
			llama_7b_stage_4_batch_3_layer_25_ffn_gate -> llama_7b_stage_4_batch_3_layer_25_ffn_down
			llama_7b_stage_4_batch_3_layer_25_ffn_down -> llama_7b_stage_4_batch_3_layer_25_ffn_res
			llama_7b_stage_4_batch_3_layer_26_norm1 [label="L26 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_26_qkv [label="L26 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_attn [label="L26 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_attn_out [label="L26 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_attn_res [label="L26 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_26_norm2 [label="L26 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_26_ffn_up [label="L26 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_ffn_gate [label="L26 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_ffn_down [label="L26 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_26_ffn_res [label="L26 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_25_ffn_res -> llama_7b_stage_4_batch_3_layer_26_norm1
			llama_7b_stage_4_batch_3_layer_26_norm1 -> llama_7b_stage_4_batch_3_layer_26_qkv
			llama_7b_stage_4_batch_3_layer_26_qkv -> llama_7b_stage_4_batch_3_layer_26_attn
			llama_7b_stage_4_batch_3_layer_26_attn -> llama_7b_stage_4_batch_3_layer_26_attn_out
			llama_7b_stage_4_batch_3_layer_26_attn_out -> llama_7b_stage_4_batch_3_layer_26_attn_res
			llama_7b_stage_4_batch_3_layer_26_attn_res -> llama_7b_stage_4_batch_3_layer_26_norm2
			llama_7b_stage_4_batch_3_layer_26_norm2 -> llama_7b_stage_4_batch_3_layer_26_ffn_up
			llama_7b_stage_4_batch_3_layer_26_ffn_up -> llama_7b_stage_4_batch_3_layer_26_ffn_gate
			llama_7b_stage_4_batch_3_layer_26_ffn_gate -> llama_7b_stage_4_batch_3_layer_26_ffn_down
			llama_7b_stage_4_batch_3_layer_26_ffn_down -> llama_7b_stage_4_batch_3_layer_26_ffn_res
			llama_7b_stage_4_batch_3_layer_27_norm1 [label="L27 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_27_qkv [label="L27 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_attn [label="L27 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_attn_out [label="L27 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_attn_res [label="L27 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_27_norm2 [label="L27 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_27_ffn_up [label="L27 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_ffn_gate [label="L27 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_ffn_down [label="L27 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_27_ffn_res [label="L27 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_26_ffn_res -> llama_7b_stage_4_batch_3_layer_27_norm1
			llama_7b_stage_4_batch_3_layer_27_norm1 -> llama_7b_stage_4_batch_3_layer_27_qkv
			llama_7b_stage_4_batch_3_layer_27_qkv -> llama_7b_stage_4_batch_3_layer_27_attn
			llama_7b_stage_4_batch_3_layer_27_attn -> llama_7b_stage_4_batch_3_layer_27_attn_out
			llama_7b_stage_4_batch_3_layer_27_attn_out -> llama_7b_stage_4_batch_3_layer_27_attn_res
			llama_7b_stage_4_batch_3_layer_27_attn_res -> llama_7b_stage_4_batch_3_layer_27_norm2
			llama_7b_stage_4_batch_3_layer_27_norm2 -> llama_7b_stage_4_batch_3_layer_27_ffn_up
			llama_7b_stage_4_batch_3_layer_27_ffn_up -> llama_7b_stage_4_batch_3_layer_27_ffn_gate
			llama_7b_stage_4_batch_3_layer_27_ffn_gate -> llama_7b_stage_4_batch_3_layer_27_ffn_down
			llama_7b_stage_4_batch_3_layer_27_ffn_down -> llama_7b_stage_4_batch_3_layer_27_ffn_res
			llama_7b_stage_4_batch_3_layer_28_norm1 [label="L28 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_28_qkv [label="L28 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_attn [label="L28 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_attn_out [label="L28 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_attn_res [label="L28 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_28_norm2 [label="L28 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_28_ffn_up [label="L28 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_ffn_gate [label="L28 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_ffn_down [label="L28 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_28_ffn_res [label="L28 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_27_ffn_res -> llama_7b_stage_4_batch_3_layer_28_norm1
			llama_7b_stage_4_batch_3_layer_28_norm1 -> llama_7b_stage_4_batch_3_layer_28_qkv
			llama_7b_stage_4_batch_3_layer_28_qkv -> llama_7b_stage_4_batch_3_layer_28_attn
			llama_7b_stage_4_batch_3_layer_28_attn -> llama_7b_stage_4_batch_3_layer_28_attn_out
			llama_7b_stage_4_batch_3_layer_28_attn_out -> llama_7b_stage_4_batch_3_layer_28_attn_res
			llama_7b_stage_4_batch_3_layer_28_attn_res -> llama_7b_stage_4_batch_3_layer_28_norm2
			llama_7b_stage_4_batch_3_layer_28_norm2 -> llama_7b_stage_4_batch_3_layer_28_ffn_up
			llama_7b_stage_4_batch_3_layer_28_ffn_up -> llama_7b_stage_4_batch_3_layer_28_ffn_gate
			llama_7b_stage_4_batch_3_layer_28_ffn_gate -> llama_7b_stage_4_batch_3_layer_28_ffn_down
			llama_7b_stage_4_batch_3_layer_28_ffn_down -> llama_7b_stage_4_batch_3_layer_28_ffn_res
			llama_7b_stage_4_batch_3_layer_29_norm1 [label="L29 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_29_qkv [label="L29 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_attn [label="L29 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_attn_out [label="L29 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_attn_res [label="L29 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_29_norm2 [label="L29 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_29_ffn_up [label="L29 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_ffn_gate [label="L29 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_ffn_down [label="L29 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_29_ffn_res [label="L29 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_28_ffn_res -> llama_7b_stage_4_batch_3_layer_29_norm1
			llama_7b_stage_4_batch_3_layer_29_norm1 -> llama_7b_stage_4_batch_3_layer_29_qkv
			llama_7b_stage_4_batch_3_layer_29_qkv -> llama_7b_stage_4_batch_3_layer_29_attn
			llama_7b_stage_4_batch_3_layer_29_attn -> llama_7b_stage_4_batch_3_layer_29_attn_out
			llama_7b_stage_4_batch_3_layer_29_attn_out -> llama_7b_stage_4_batch_3_layer_29_attn_res
			llama_7b_stage_4_batch_3_layer_29_attn_res -> llama_7b_stage_4_batch_3_layer_29_norm2
			llama_7b_stage_4_batch_3_layer_29_norm2 -> llama_7b_stage_4_batch_3_layer_29_ffn_up
			llama_7b_stage_4_batch_3_layer_29_ffn_up -> llama_7b_stage_4_batch_3_layer_29_ffn_gate
			llama_7b_stage_4_batch_3_layer_29_ffn_gate -> llama_7b_stage_4_batch_3_layer_29_ffn_down
			llama_7b_stage_4_batch_3_layer_29_ffn_down -> llama_7b_stage_4_batch_3_layer_29_ffn_res
			llama_7b_stage_4_batch_3_layer_30_norm1 [label="L30 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_30_qkv [label="L30 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_attn [label="L30 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_attn_out [label="L30 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_attn_res [label="L30 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_30_norm2 [label="L30 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_30_ffn_up [label="L30 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_ffn_gate [label="L30 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_ffn_down [label="L30 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_30_ffn_res [label="L30 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_29_ffn_res -> llama_7b_stage_4_batch_3_layer_30_norm1
			llama_7b_stage_4_batch_3_layer_30_norm1 -> llama_7b_stage_4_batch_3_layer_30_qkv
			llama_7b_stage_4_batch_3_layer_30_qkv -> llama_7b_stage_4_batch_3_layer_30_attn
			llama_7b_stage_4_batch_3_layer_30_attn -> llama_7b_stage_4_batch_3_layer_30_attn_out
			llama_7b_stage_4_batch_3_layer_30_attn_out -> llama_7b_stage_4_batch_3_layer_30_attn_res
			llama_7b_stage_4_batch_3_layer_30_attn_res -> llama_7b_stage_4_batch_3_layer_30_norm2
			llama_7b_stage_4_batch_3_layer_30_norm2 -> llama_7b_stage_4_batch_3_layer_30_ffn_up
			llama_7b_stage_4_batch_3_layer_30_ffn_up -> llama_7b_stage_4_batch_3_layer_30_ffn_gate
			llama_7b_stage_4_batch_3_layer_30_ffn_gate -> llama_7b_stage_4_batch_3_layer_30_ffn_down
			llama_7b_stage_4_batch_3_layer_30_ffn_down -> llama_7b_stage_4_batch_3_layer_30_ffn_res
			llama_7b_stage_4_batch_3_layer_31_norm1 [label="L31 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_31_qkv [label="L31 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_attn [label="L31 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_attn_out [label="L31 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_attn_res [label="L31 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_31_norm2 [label="L31 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_31_ffn_up [label="L31 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_ffn_gate [label="L31 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_ffn_down [label="L31 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_31_ffn_res [label="L31 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_30_ffn_res -> llama_7b_stage_4_batch_3_layer_31_norm1
			llama_7b_stage_4_batch_3_layer_31_norm1 -> llama_7b_stage_4_batch_3_layer_31_qkv
			llama_7b_stage_4_batch_3_layer_31_qkv -> llama_7b_stage_4_batch_3_layer_31_attn
			llama_7b_stage_4_batch_3_layer_31_attn -> llama_7b_stage_4_batch_3_layer_31_attn_out
			llama_7b_stage_4_batch_3_layer_31_attn_out -> llama_7b_stage_4_batch_3_layer_31_attn_res
			llama_7b_stage_4_batch_3_layer_31_attn_res -> llama_7b_stage_4_batch_3_layer_31_norm2
			llama_7b_stage_4_batch_3_layer_31_norm2 -> llama_7b_stage_4_batch_3_layer_31_ffn_up
			llama_7b_stage_4_batch_3_layer_31_ffn_up -> llama_7b_stage_4_batch_3_layer_31_ffn_gate
			llama_7b_stage_4_batch_3_layer_31_ffn_gate -> llama_7b_stage_4_batch_3_layer_31_ffn_down
			llama_7b_stage_4_batch_3_layer_31_ffn_down -> llama_7b_stage_4_batch_3_layer_31_ffn_res
			llama_7b_stage_4_batch_3_layer_32_norm1 [label="L32 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_32_qkv [label="L32 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_attn [label="L32 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_attn_out [label="L32 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_attn_res [label="L32 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_32_norm2 [label="L32 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_32_ffn_up [label="L32 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_ffn_gate [label="L32 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_ffn_down [label="L32 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_3_layer_32_ffn_res [label="L32 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_3_layer_31_ffn_res -> llama_7b_stage_4_batch_3_layer_32_norm1
			llama_7b_stage_4_batch_3_layer_32_norm1 -> llama_7b_stage_4_batch_3_layer_32_qkv
			llama_7b_stage_4_batch_3_layer_32_qkv -> llama_7b_stage_4_batch_3_layer_32_attn
			llama_7b_stage_4_batch_3_layer_32_attn -> llama_7b_stage_4_batch_3_layer_32_attn_out
			llama_7b_stage_4_batch_3_layer_32_attn_out -> llama_7b_stage_4_batch_3_layer_32_attn_res
			llama_7b_stage_4_batch_3_layer_32_attn_res -> llama_7b_stage_4_batch_3_layer_32_norm2
			llama_7b_stage_4_batch_3_layer_32_norm2 -> llama_7b_stage_4_batch_3_layer_32_ffn_up
			llama_7b_stage_4_batch_3_layer_32_ffn_up -> llama_7b_stage_4_batch_3_layer_32_ffn_gate
			llama_7b_stage_4_batch_3_layer_32_ffn_gate -> llama_7b_stage_4_batch_3_layer_32_ffn_down
			llama_7b_stage_4_batch_3_layer_32_ffn_down -> llama_7b_stage_4_batch_3_layer_32_ffn_res
			llama_7b_stage_4_batch_3_output [label="Stage 4 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_3_layer_32_ffn_res -> llama_7b_stage_4_batch_3_output
			llama_7b_stage_4_batch_4_input [label="Micro-batch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_25_norm1 [label="L25 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_25_qkv [label="L25 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_attn [label="L25 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_attn_out [label="L25 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_attn_res [label="L25 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_25_norm2 [label="L25 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_25_ffn_up [label="L25 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_ffn_gate [label="L25 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_ffn_down [label="L25 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_25_ffn_res [label="L25 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_input -> llama_7b_stage_4_batch_4_layer_25_norm1
			llama_7b_stage_4_batch_4_layer_25_norm1 -> llama_7b_stage_4_batch_4_layer_25_qkv
			llama_7b_stage_4_batch_4_layer_25_qkv -> llama_7b_stage_4_batch_4_layer_25_attn
			llama_7b_stage_4_batch_4_layer_25_attn -> llama_7b_stage_4_batch_4_layer_25_attn_out
			llama_7b_stage_4_batch_4_layer_25_attn_out -> llama_7b_stage_4_batch_4_layer_25_attn_res
			llama_7b_stage_4_batch_4_layer_25_attn_res -> llama_7b_stage_4_batch_4_layer_25_norm2
			llama_7b_stage_4_batch_4_layer_25_norm2 -> llama_7b_stage_4_batch_4_layer_25_ffn_up
			llama_7b_stage_4_batch_4_layer_25_ffn_up -> llama_7b_stage_4_batch_4_layer_25_ffn_gate
			llama_7b_stage_4_batch_4_layer_25_ffn_gate -> llama_7b_stage_4_batch_4_layer_25_ffn_down
			llama_7b_stage_4_batch_4_layer_25_ffn_down -> llama_7b_stage_4_batch_4_layer_25_ffn_res
			llama_7b_stage_4_batch_4_layer_26_norm1 [label="L26 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_26_qkv [label="L26 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_attn [label="L26 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_attn_out [label="L26 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_attn_res [label="L26 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_26_norm2 [label="L26 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_26_ffn_up [label="L26 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_ffn_gate [label="L26 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_ffn_down [label="L26 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_26_ffn_res [label="L26 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_25_ffn_res -> llama_7b_stage_4_batch_4_layer_26_norm1
			llama_7b_stage_4_batch_4_layer_26_norm1 -> llama_7b_stage_4_batch_4_layer_26_qkv
			llama_7b_stage_4_batch_4_layer_26_qkv -> llama_7b_stage_4_batch_4_layer_26_attn
			llama_7b_stage_4_batch_4_layer_26_attn -> llama_7b_stage_4_batch_4_layer_26_attn_out
			llama_7b_stage_4_batch_4_layer_26_attn_out -> llama_7b_stage_4_batch_4_layer_26_attn_res
			llama_7b_stage_4_batch_4_layer_26_attn_res -> llama_7b_stage_4_batch_4_layer_26_norm2
			llama_7b_stage_4_batch_4_layer_26_norm2 -> llama_7b_stage_4_batch_4_layer_26_ffn_up
			llama_7b_stage_4_batch_4_layer_26_ffn_up -> llama_7b_stage_4_batch_4_layer_26_ffn_gate
			llama_7b_stage_4_batch_4_layer_26_ffn_gate -> llama_7b_stage_4_batch_4_layer_26_ffn_down
			llama_7b_stage_4_batch_4_layer_26_ffn_down -> llama_7b_stage_4_batch_4_layer_26_ffn_res
			llama_7b_stage_4_batch_4_layer_27_norm1 [label="L27 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_27_qkv [label="L27 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_attn [label="L27 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_attn_out [label="L27 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_attn_res [label="L27 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_27_norm2 [label="L27 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_27_ffn_up [label="L27 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_ffn_gate [label="L27 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_ffn_down [label="L27 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_27_ffn_res [label="L27 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_26_ffn_res -> llama_7b_stage_4_batch_4_layer_27_norm1
			llama_7b_stage_4_batch_4_layer_27_norm1 -> llama_7b_stage_4_batch_4_layer_27_qkv
			llama_7b_stage_4_batch_4_layer_27_qkv -> llama_7b_stage_4_batch_4_layer_27_attn
			llama_7b_stage_4_batch_4_layer_27_attn -> llama_7b_stage_4_batch_4_layer_27_attn_out
			llama_7b_stage_4_batch_4_layer_27_attn_out -> llama_7b_stage_4_batch_4_layer_27_attn_res
			llama_7b_stage_4_batch_4_layer_27_attn_res -> llama_7b_stage_4_batch_4_layer_27_norm2
			llama_7b_stage_4_batch_4_layer_27_norm2 -> llama_7b_stage_4_batch_4_layer_27_ffn_up
			llama_7b_stage_4_batch_4_layer_27_ffn_up -> llama_7b_stage_4_batch_4_layer_27_ffn_gate
			llama_7b_stage_4_batch_4_layer_27_ffn_gate -> llama_7b_stage_4_batch_4_layer_27_ffn_down
			llama_7b_stage_4_batch_4_layer_27_ffn_down -> llama_7b_stage_4_batch_4_layer_27_ffn_res
			llama_7b_stage_4_batch_4_layer_28_norm1 [label="L28 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_28_qkv [label="L28 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_attn [label="L28 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_attn_out [label="L28 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_attn_res [label="L28 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_28_norm2 [label="L28 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_28_ffn_up [label="L28 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_ffn_gate [label="L28 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_ffn_down [label="L28 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_28_ffn_res [label="L28 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_27_ffn_res -> llama_7b_stage_4_batch_4_layer_28_norm1
			llama_7b_stage_4_batch_4_layer_28_norm1 -> llama_7b_stage_4_batch_4_layer_28_qkv
			llama_7b_stage_4_batch_4_layer_28_qkv -> llama_7b_stage_4_batch_4_layer_28_attn
			llama_7b_stage_4_batch_4_layer_28_attn -> llama_7b_stage_4_batch_4_layer_28_attn_out
			llama_7b_stage_4_batch_4_layer_28_attn_out -> llama_7b_stage_4_batch_4_layer_28_attn_res
			llama_7b_stage_4_batch_4_layer_28_attn_res -> llama_7b_stage_4_batch_4_layer_28_norm2
			llama_7b_stage_4_batch_4_layer_28_norm2 -> llama_7b_stage_4_batch_4_layer_28_ffn_up
			llama_7b_stage_4_batch_4_layer_28_ffn_up -> llama_7b_stage_4_batch_4_layer_28_ffn_gate
			llama_7b_stage_4_batch_4_layer_28_ffn_gate -> llama_7b_stage_4_batch_4_layer_28_ffn_down
			llama_7b_stage_4_batch_4_layer_28_ffn_down -> llama_7b_stage_4_batch_4_layer_28_ffn_res
			llama_7b_stage_4_batch_4_layer_29_norm1 [label="L29 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_29_qkv [label="L29 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_attn [label="L29 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_attn_out [label="L29 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_attn_res [label="L29 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_29_norm2 [label="L29 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_29_ffn_up [label="L29 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_ffn_gate [label="L29 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_ffn_down [label="L29 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_29_ffn_res [label="L29 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_28_ffn_res -> llama_7b_stage_4_batch_4_layer_29_norm1
			llama_7b_stage_4_batch_4_layer_29_norm1 -> llama_7b_stage_4_batch_4_layer_29_qkv
			llama_7b_stage_4_batch_4_layer_29_qkv -> llama_7b_stage_4_batch_4_layer_29_attn
			llama_7b_stage_4_batch_4_layer_29_attn -> llama_7b_stage_4_batch_4_layer_29_attn_out
			llama_7b_stage_4_batch_4_layer_29_attn_out -> llama_7b_stage_4_batch_4_layer_29_attn_res
			llama_7b_stage_4_batch_4_layer_29_attn_res -> llama_7b_stage_4_batch_4_layer_29_norm2
			llama_7b_stage_4_batch_4_layer_29_norm2 -> llama_7b_stage_4_batch_4_layer_29_ffn_up
			llama_7b_stage_4_batch_4_layer_29_ffn_up -> llama_7b_stage_4_batch_4_layer_29_ffn_gate
			llama_7b_stage_4_batch_4_layer_29_ffn_gate -> llama_7b_stage_4_batch_4_layer_29_ffn_down
			llama_7b_stage_4_batch_4_layer_29_ffn_down -> llama_7b_stage_4_batch_4_layer_29_ffn_res
			llama_7b_stage_4_batch_4_layer_30_norm1 [label="L30 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_30_qkv [label="L30 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_attn [label="L30 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_attn_out [label="L30 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_attn_res [label="L30 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_30_norm2 [label="L30 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_30_ffn_up [label="L30 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_ffn_gate [label="L30 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_ffn_down [label="L30 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_30_ffn_res [label="L30 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_29_ffn_res -> llama_7b_stage_4_batch_4_layer_30_norm1
			llama_7b_stage_4_batch_4_layer_30_norm1 -> llama_7b_stage_4_batch_4_layer_30_qkv
			llama_7b_stage_4_batch_4_layer_30_qkv -> llama_7b_stage_4_batch_4_layer_30_attn
			llama_7b_stage_4_batch_4_layer_30_attn -> llama_7b_stage_4_batch_4_layer_30_attn_out
			llama_7b_stage_4_batch_4_layer_30_attn_out -> llama_7b_stage_4_batch_4_layer_30_attn_res
			llama_7b_stage_4_batch_4_layer_30_attn_res -> llama_7b_stage_4_batch_4_layer_30_norm2
			llama_7b_stage_4_batch_4_layer_30_norm2 -> llama_7b_stage_4_batch_4_layer_30_ffn_up
			llama_7b_stage_4_batch_4_layer_30_ffn_up -> llama_7b_stage_4_batch_4_layer_30_ffn_gate
			llama_7b_stage_4_batch_4_layer_30_ffn_gate -> llama_7b_stage_4_batch_4_layer_30_ffn_down
			llama_7b_stage_4_batch_4_layer_30_ffn_down -> llama_7b_stage_4_batch_4_layer_30_ffn_res
			llama_7b_stage_4_batch_4_layer_31_norm1 [label="L31 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_31_qkv [label="L31 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_attn [label="L31 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_attn_out [label="L31 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_attn_res [label="L31 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_31_norm2 [label="L31 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_31_ffn_up [label="L31 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_ffn_gate [label="L31 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_ffn_down [label="L31 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_31_ffn_res [label="L31 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_30_ffn_res -> llama_7b_stage_4_batch_4_layer_31_norm1
			llama_7b_stage_4_batch_4_layer_31_norm1 -> llama_7b_stage_4_batch_4_layer_31_qkv
			llama_7b_stage_4_batch_4_layer_31_qkv -> llama_7b_stage_4_batch_4_layer_31_attn
			llama_7b_stage_4_batch_4_layer_31_attn -> llama_7b_stage_4_batch_4_layer_31_attn_out
			llama_7b_stage_4_batch_4_layer_31_attn_out -> llama_7b_stage_4_batch_4_layer_31_attn_res
			llama_7b_stage_4_batch_4_layer_31_attn_res -> llama_7b_stage_4_batch_4_layer_31_norm2
			llama_7b_stage_4_batch_4_layer_31_norm2 -> llama_7b_stage_4_batch_4_layer_31_ffn_up
			llama_7b_stage_4_batch_4_layer_31_ffn_up -> llama_7b_stage_4_batch_4_layer_31_ffn_gate
			llama_7b_stage_4_batch_4_layer_31_ffn_gate -> llama_7b_stage_4_batch_4_layer_31_ffn_down
			llama_7b_stage_4_batch_4_layer_31_ffn_down -> llama_7b_stage_4_batch_4_layer_31_ffn_res
			llama_7b_stage_4_batch_4_layer_32_norm1 [label="L32 Norm1\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_32_qkv [label="L32 QKV\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_attn [label="L32 Attention\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_attn_out [label="L32 Attn Out\nDevice: GPU_4" fillcolor=lightcoral shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_attn_res [label="L32 Attn+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_32_norm2 [label="L32 Norm2\nDevice: GPU_4" fillcolor=lightgray shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_32_ffn_up [label="L32 FFN Up\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_ffn_gate [label="L32 FFN Gate\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_ffn_down [label="L32 FFN Down\nDevice: GPU_4" fillcolor=lightcyan shape=rectangle style=filled]
			llama_7b_stage_4_batch_4_layer_32_ffn_res [label="L32 FFN+Res\nDevice: GPU_4" fillcolor=lightyellow shape=parallelogram style=filled]
			llama_7b_stage_4_batch_4_layer_31_ffn_res -> llama_7b_stage_4_batch_4_layer_32_norm1
			llama_7b_stage_4_batch_4_layer_32_norm1 -> llama_7b_stage_4_batch_4_layer_32_qkv
			llama_7b_stage_4_batch_4_layer_32_qkv -> llama_7b_stage_4_batch_4_layer_32_attn
			llama_7b_stage_4_batch_4_layer_32_attn -> llama_7b_stage_4_batch_4_layer_32_attn_out
			llama_7b_stage_4_batch_4_layer_32_attn_out -> llama_7b_stage_4_batch_4_layer_32_attn_res
			llama_7b_stage_4_batch_4_layer_32_attn_res -> llama_7b_stage_4_batch_4_layer_32_norm2
			llama_7b_stage_4_batch_4_layer_32_norm2 -> llama_7b_stage_4_batch_4_layer_32_ffn_up
			llama_7b_stage_4_batch_4_layer_32_ffn_up -> llama_7b_stage_4_batch_4_layer_32_ffn_gate
			llama_7b_stage_4_batch_4_layer_32_ffn_gate -> llama_7b_stage_4_batch_4_layer_32_ffn_down
			llama_7b_stage_4_batch_4_layer_32_ffn_down -> llama_7b_stage_4_batch_4_layer_32_ffn_res
			llama_7b_stage_4_batch_4_output [label="Stage 4 Output\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightgreen shape=ellipse style=filled]
			llama_7b_stage_4_batch_4_layer_32_ffn_res -> llama_7b_stage_4_batch_4_output
		}
		llama_7b_comm_stage_1_to_2_batch_1 [label="Communication\nStage 1  2\nBatch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_1_batch_1_output -> llama_7b_comm_stage_1_to_2_batch_1
		llama_7b_comm_stage_1_to_2_batch_1 -> llama_7b_stage_2_batch_1_input
		llama_7b_comm_stage_1_to_2_batch_2 [label="Communication\nStage 1  2\nBatch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_1_batch_2_output -> llama_7b_comm_stage_1_to_2_batch_2
		llama_7b_comm_stage_1_to_2_batch_2 -> llama_7b_stage_2_batch_2_input
		llama_7b_comm_stage_1_to_2_batch_3 [label="Communication\nStage 1  2\nBatch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_1_batch_3_output -> llama_7b_comm_stage_1_to_2_batch_3
		llama_7b_comm_stage_1_to_2_batch_3 -> llama_7b_stage_2_batch_3_input
		llama_7b_comm_stage_1_to_2_batch_4 [label="Communication\nStage 1  2\nBatch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_1_batch_4_output -> llama_7b_comm_stage_1_to_2_batch_4
		llama_7b_comm_stage_1_to_2_batch_4 -> llama_7b_stage_2_batch_4_input
		llama_7b_comm_stage_2_to_3_batch_1 [label="Communication\nStage 2  3\nBatch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_2_batch_1_output -> llama_7b_comm_stage_2_to_3_batch_1
		llama_7b_comm_stage_2_to_3_batch_1 -> llama_7b_stage_3_batch_1_input
		llama_7b_comm_stage_2_to_3_batch_2 [label="Communication\nStage 2  3\nBatch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_2_batch_2_output -> llama_7b_comm_stage_2_to_3_batch_2
		llama_7b_comm_stage_2_to_3_batch_2 -> llama_7b_stage_3_batch_2_input
		llama_7b_comm_stage_2_to_3_batch_3 [label="Communication\nStage 2  3\nBatch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_2_batch_3_output -> llama_7b_comm_stage_2_to_3_batch_3
		llama_7b_comm_stage_2_to_3_batch_3 -> llama_7b_stage_3_batch_3_input
		llama_7b_comm_stage_2_to_3_batch_4 [label="Communication\nStage 2  3\nBatch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_2_batch_4_output -> llama_7b_comm_stage_2_to_3_batch_4
		llama_7b_comm_stage_2_to_3_batch_4 -> llama_7b_stage_3_batch_4_input
		llama_7b_comm_stage_3_to_4_batch_1 [label="Communication\nStage 3  4\nBatch 1\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_3_batch_1_output -> llama_7b_comm_stage_3_to_4_batch_1
		llama_7b_comm_stage_3_to_4_batch_1 -> llama_7b_stage_4_batch_1_input
		llama_7b_comm_stage_3_to_4_batch_2 [label="Communication\nStage 3  4\nBatch 2\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_3_batch_2_output -> llama_7b_comm_stage_3_to_4_batch_2
		llama_7b_comm_stage_3_to_4_batch_2 -> llama_7b_stage_4_batch_2_input
		llama_7b_comm_stage_3_to_4_batch_3 [label="Communication\nStage 3  4\nBatch 3\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_3_batch_3_output -> llama_7b_comm_stage_3_to_4_batch_3
		llama_7b_comm_stage_3_to_4_batch_3 -> llama_7b_stage_4_batch_3_input
		llama_7b_comm_stage_3_to_4_batch_4 [label="Communication\nStage 3  4\nBatch 4\n[batch=1, seq=2048, hidden=4096]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		llama_7b_stage_3_batch_4_output -> llama_7b_comm_stage_3_to_4_batch_4
		llama_7b_comm_stage_3_to_4_batch_4 -> llama_7b_stage_4_batch_4_input
		llama_7b_gpipe_input [label="Model Input\nLLAMA_7B\n[batch=6, seq=2048, vocab=32000]" fillcolor=orange shape=ellipse style=filled]
		llama_7b_gpipe_output [label="Model Output\nLLAMA_7B\n[batch=6, seq=2048, vocab=32000]" fillcolor=orange shape=doubleoctagon style=filled]
		llama_7b_gpipe_input -> llama_7b_stage_1_batch_1_input
		llama_7b_stage_4_batch_1_output -> llama_7b_gpipe_output
		llama_7b_gpipe_input -> llama_7b_stage_1_batch_2_input
		llama_7b_stage_4_batch_2_output -> llama_7b_gpipe_output
		llama_7b_gpipe_input -> llama_7b_stage_1_batch_3_input
		llama_7b_stage_4_batch_3_output -> llama_7b_gpipe_output
		llama_7b_gpipe_input -> llama_7b_stage_1_batch_4_input
		llama_7b_stage_4_batch_4_output -> llama_7b_gpipe_output
	}
	subgraph cluster_gpt3_2b_gpipe {
		color=black fillcolor=lightyellow label="GPT3_2B GPipe Pipeline (3 stages)" style="rounded,filled"
		subgraph cluster_gpt3_2b_stage_1 {
			color=black fillcolor=lightblue label="Stage 1\nGPU_1\nLayers 1-8" style="rounded,filled"
			gpt3_2b_stage_1_batch_1_input [label="Micro-batch 1\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_input -> gpt3_2b_stage_1_batch_1_layer_1_norm1
			gpt3_2b_stage_1_batch_1_layer_1_norm1 -> gpt3_2b_stage_1_batch_1_layer_1_qkv
			gpt3_2b_stage_1_batch_1_layer_1_qkv -> gpt3_2b_stage_1_batch_1_layer_1_attn
			gpt3_2b_stage_1_batch_1_layer_1_attn -> gpt3_2b_stage_1_batch_1_layer_1_attn_out
			gpt3_2b_stage_1_batch_1_layer_1_attn_out -> gpt3_2b_stage_1_batch_1_layer_1_attn_res
			gpt3_2b_stage_1_batch_1_layer_1_attn_res -> gpt3_2b_stage_1_batch_1_layer_1_norm2
			gpt3_2b_stage_1_batch_1_layer_1_norm2 -> gpt3_2b_stage_1_batch_1_layer_1_ffn_up
			gpt3_2b_stage_1_batch_1_layer_1_ffn_up -> gpt3_2b_stage_1_batch_1_layer_1_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_1_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_1_ffn_down
			gpt3_2b_stage_1_batch_1_layer_1_ffn_down -> gpt3_2b_stage_1_batch_1_layer_1_ffn_res
			gpt3_2b_stage_1_batch_1_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_1_ffn_res -> gpt3_2b_stage_1_batch_1_layer_2_norm1
			gpt3_2b_stage_1_batch_1_layer_2_norm1 -> gpt3_2b_stage_1_batch_1_layer_2_qkv
			gpt3_2b_stage_1_batch_1_layer_2_qkv -> gpt3_2b_stage_1_batch_1_layer_2_attn
			gpt3_2b_stage_1_batch_1_layer_2_attn -> gpt3_2b_stage_1_batch_1_layer_2_attn_out
			gpt3_2b_stage_1_batch_1_layer_2_attn_out -> gpt3_2b_stage_1_batch_1_layer_2_attn_res
			gpt3_2b_stage_1_batch_1_layer_2_attn_res -> gpt3_2b_stage_1_batch_1_layer_2_norm2
			gpt3_2b_stage_1_batch_1_layer_2_norm2 -> gpt3_2b_stage_1_batch_1_layer_2_ffn_up
			gpt3_2b_stage_1_batch_1_layer_2_ffn_up -> gpt3_2b_stage_1_batch_1_layer_2_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_2_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_2_ffn_down
			gpt3_2b_stage_1_batch_1_layer_2_ffn_down -> gpt3_2b_stage_1_batch_1_layer_2_ffn_res
			gpt3_2b_stage_1_batch_1_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_2_ffn_res -> gpt3_2b_stage_1_batch_1_layer_3_norm1
			gpt3_2b_stage_1_batch_1_layer_3_norm1 -> gpt3_2b_stage_1_batch_1_layer_3_qkv
			gpt3_2b_stage_1_batch_1_layer_3_qkv -> gpt3_2b_stage_1_batch_1_layer_3_attn
			gpt3_2b_stage_1_batch_1_layer_3_attn -> gpt3_2b_stage_1_batch_1_layer_3_attn_out
			gpt3_2b_stage_1_batch_1_layer_3_attn_out -> gpt3_2b_stage_1_batch_1_layer_3_attn_res
			gpt3_2b_stage_1_batch_1_layer_3_attn_res -> gpt3_2b_stage_1_batch_1_layer_3_norm2
			gpt3_2b_stage_1_batch_1_layer_3_norm2 -> gpt3_2b_stage_1_batch_1_layer_3_ffn_up
			gpt3_2b_stage_1_batch_1_layer_3_ffn_up -> gpt3_2b_stage_1_batch_1_layer_3_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_3_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_3_ffn_down
			gpt3_2b_stage_1_batch_1_layer_3_ffn_down -> gpt3_2b_stage_1_batch_1_layer_3_ffn_res
			gpt3_2b_stage_1_batch_1_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_3_ffn_res -> gpt3_2b_stage_1_batch_1_layer_4_norm1
			gpt3_2b_stage_1_batch_1_layer_4_norm1 -> gpt3_2b_stage_1_batch_1_layer_4_qkv
			gpt3_2b_stage_1_batch_1_layer_4_qkv -> gpt3_2b_stage_1_batch_1_layer_4_attn
			gpt3_2b_stage_1_batch_1_layer_4_attn -> gpt3_2b_stage_1_batch_1_layer_4_attn_out
			gpt3_2b_stage_1_batch_1_layer_4_attn_out -> gpt3_2b_stage_1_batch_1_layer_4_attn_res
			gpt3_2b_stage_1_batch_1_layer_4_attn_res -> gpt3_2b_stage_1_batch_1_layer_4_norm2
			gpt3_2b_stage_1_batch_1_layer_4_norm2 -> gpt3_2b_stage_1_batch_1_layer_4_ffn_up
			gpt3_2b_stage_1_batch_1_layer_4_ffn_up -> gpt3_2b_stage_1_batch_1_layer_4_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_4_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_4_ffn_down
			gpt3_2b_stage_1_batch_1_layer_4_ffn_down -> gpt3_2b_stage_1_batch_1_layer_4_ffn_res
			gpt3_2b_stage_1_batch_1_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_4_ffn_res -> gpt3_2b_stage_1_batch_1_layer_5_norm1
			gpt3_2b_stage_1_batch_1_layer_5_norm1 -> gpt3_2b_stage_1_batch_1_layer_5_qkv
			gpt3_2b_stage_1_batch_1_layer_5_qkv -> gpt3_2b_stage_1_batch_1_layer_5_attn
			gpt3_2b_stage_1_batch_1_layer_5_attn -> gpt3_2b_stage_1_batch_1_layer_5_attn_out
			gpt3_2b_stage_1_batch_1_layer_5_attn_out -> gpt3_2b_stage_1_batch_1_layer_5_attn_res
			gpt3_2b_stage_1_batch_1_layer_5_attn_res -> gpt3_2b_stage_1_batch_1_layer_5_norm2
			gpt3_2b_stage_1_batch_1_layer_5_norm2 -> gpt3_2b_stage_1_batch_1_layer_5_ffn_up
			gpt3_2b_stage_1_batch_1_layer_5_ffn_up -> gpt3_2b_stage_1_batch_1_layer_5_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_5_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_5_ffn_down
			gpt3_2b_stage_1_batch_1_layer_5_ffn_down -> gpt3_2b_stage_1_batch_1_layer_5_ffn_res
			gpt3_2b_stage_1_batch_1_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_5_ffn_res -> gpt3_2b_stage_1_batch_1_layer_6_norm1
			gpt3_2b_stage_1_batch_1_layer_6_norm1 -> gpt3_2b_stage_1_batch_1_layer_6_qkv
			gpt3_2b_stage_1_batch_1_layer_6_qkv -> gpt3_2b_stage_1_batch_1_layer_6_attn
			gpt3_2b_stage_1_batch_1_layer_6_attn -> gpt3_2b_stage_1_batch_1_layer_6_attn_out
			gpt3_2b_stage_1_batch_1_layer_6_attn_out -> gpt3_2b_stage_1_batch_1_layer_6_attn_res
			gpt3_2b_stage_1_batch_1_layer_6_attn_res -> gpt3_2b_stage_1_batch_1_layer_6_norm2
			gpt3_2b_stage_1_batch_1_layer_6_norm2 -> gpt3_2b_stage_1_batch_1_layer_6_ffn_up
			gpt3_2b_stage_1_batch_1_layer_6_ffn_up -> gpt3_2b_stage_1_batch_1_layer_6_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_6_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_6_ffn_down
			gpt3_2b_stage_1_batch_1_layer_6_ffn_down -> gpt3_2b_stage_1_batch_1_layer_6_ffn_res
			gpt3_2b_stage_1_batch_1_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_6_ffn_res -> gpt3_2b_stage_1_batch_1_layer_7_norm1
			gpt3_2b_stage_1_batch_1_layer_7_norm1 -> gpt3_2b_stage_1_batch_1_layer_7_qkv
			gpt3_2b_stage_1_batch_1_layer_7_qkv -> gpt3_2b_stage_1_batch_1_layer_7_attn
			gpt3_2b_stage_1_batch_1_layer_7_attn -> gpt3_2b_stage_1_batch_1_layer_7_attn_out
			gpt3_2b_stage_1_batch_1_layer_7_attn_out -> gpt3_2b_stage_1_batch_1_layer_7_attn_res
			gpt3_2b_stage_1_batch_1_layer_7_attn_res -> gpt3_2b_stage_1_batch_1_layer_7_norm2
			gpt3_2b_stage_1_batch_1_layer_7_norm2 -> gpt3_2b_stage_1_batch_1_layer_7_ffn_up
			gpt3_2b_stage_1_batch_1_layer_7_ffn_up -> gpt3_2b_stage_1_batch_1_layer_7_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_7_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_7_ffn_down
			gpt3_2b_stage_1_batch_1_layer_7_ffn_down -> gpt3_2b_stage_1_batch_1_layer_7_ffn_res
			gpt3_2b_stage_1_batch_1_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_1_layer_7_ffn_res -> gpt3_2b_stage_1_batch_1_layer_8_norm1
			gpt3_2b_stage_1_batch_1_layer_8_norm1 -> gpt3_2b_stage_1_batch_1_layer_8_qkv
			gpt3_2b_stage_1_batch_1_layer_8_qkv -> gpt3_2b_stage_1_batch_1_layer_8_attn
			gpt3_2b_stage_1_batch_1_layer_8_attn -> gpt3_2b_stage_1_batch_1_layer_8_attn_out
			gpt3_2b_stage_1_batch_1_layer_8_attn_out -> gpt3_2b_stage_1_batch_1_layer_8_attn_res
			gpt3_2b_stage_1_batch_1_layer_8_attn_res -> gpt3_2b_stage_1_batch_1_layer_8_norm2
			gpt3_2b_stage_1_batch_1_layer_8_norm2 -> gpt3_2b_stage_1_batch_1_layer_8_ffn_up
			gpt3_2b_stage_1_batch_1_layer_8_ffn_up -> gpt3_2b_stage_1_batch_1_layer_8_ffn_gate
			gpt3_2b_stage_1_batch_1_layer_8_ffn_gate -> gpt3_2b_stage_1_batch_1_layer_8_ffn_down
			gpt3_2b_stage_1_batch_1_layer_8_ffn_down -> gpt3_2b_stage_1_batch_1_layer_8_ffn_res
			gpt3_2b_stage_1_batch_1_output [label="Stage 1 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_1_layer_8_ffn_res -> gpt3_2b_stage_1_batch_1_output
			gpt3_2b_stage_1_batch_2_input [label="Micro-batch 2\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_input -> gpt3_2b_stage_1_batch_2_layer_1_norm1
			gpt3_2b_stage_1_batch_2_layer_1_norm1 -> gpt3_2b_stage_1_batch_2_layer_1_qkv
			gpt3_2b_stage_1_batch_2_layer_1_qkv -> gpt3_2b_stage_1_batch_2_layer_1_attn
			gpt3_2b_stage_1_batch_2_layer_1_attn -> gpt3_2b_stage_1_batch_2_layer_1_attn_out
			gpt3_2b_stage_1_batch_2_layer_1_attn_out -> gpt3_2b_stage_1_batch_2_layer_1_attn_res
			gpt3_2b_stage_1_batch_2_layer_1_attn_res -> gpt3_2b_stage_1_batch_2_layer_1_norm2
			gpt3_2b_stage_1_batch_2_layer_1_norm2 -> gpt3_2b_stage_1_batch_2_layer_1_ffn_up
			gpt3_2b_stage_1_batch_2_layer_1_ffn_up -> gpt3_2b_stage_1_batch_2_layer_1_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_1_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_1_ffn_down
			gpt3_2b_stage_1_batch_2_layer_1_ffn_down -> gpt3_2b_stage_1_batch_2_layer_1_ffn_res
			gpt3_2b_stage_1_batch_2_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_1_ffn_res -> gpt3_2b_stage_1_batch_2_layer_2_norm1
			gpt3_2b_stage_1_batch_2_layer_2_norm1 -> gpt3_2b_stage_1_batch_2_layer_2_qkv
			gpt3_2b_stage_1_batch_2_layer_2_qkv -> gpt3_2b_stage_1_batch_2_layer_2_attn
			gpt3_2b_stage_1_batch_2_layer_2_attn -> gpt3_2b_stage_1_batch_2_layer_2_attn_out
			gpt3_2b_stage_1_batch_2_layer_2_attn_out -> gpt3_2b_stage_1_batch_2_layer_2_attn_res
			gpt3_2b_stage_1_batch_2_layer_2_attn_res -> gpt3_2b_stage_1_batch_2_layer_2_norm2
			gpt3_2b_stage_1_batch_2_layer_2_norm2 -> gpt3_2b_stage_1_batch_2_layer_2_ffn_up
			gpt3_2b_stage_1_batch_2_layer_2_ffn_up -> gpt3_2b_stage_1_batch_2_layer_2_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_2_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_2_ffn_down
			gpt3_2b_stage_1_batch_2_layer_2_ffn_down -> gpt3_2b_stage_1_batch_2_layer_2_ffn_res
			gpt3_2b_stage_1_batch_2_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_2_ffn_res -> gpt3_2b_stage_1_batch_2_layer_3_norm1
			gpt3_2b_stage_1_batch_2_layer_3_norm1 -> gpt3_2b_stage_1_batch_2_layer_3_qkv
			gpt3_2b_stage_1_batch_2_layer_3_qkv -> gpt3_2b_stage_1_batch_2_layer_3_attn
			gpt3_2b_stage_1_batch_2_layer_3_attn -> gpt3_2b_stage_1_batch_2_layer_3_attn_out
			gpt3_2b_stage_1_batch_2_layer_3_attn_out -> gpt3_2b_stage_1_batch_2_layer_3_attn_res
			gpt3_2b_stage_1_batch_2_layer_3_attn_res -> gpt3_2b_stage_1_batch_2_layer_3_norm2
			gpt3_2b_stage_1_batch_2_layer_3_norm2 -> gpt3_2b_stage_1_batch_2_layer_3_ffn_up
			gpt3_2b_stage_1_batch_2_layer_3_ffn_up -> gpt3_2b_stage_1_batch_2_layer_3_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_3_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_3_ffn_down
			gpt3_2b_stage_1_batch_2_layer_3_ffn_down -> gpt3_2b_stage_1_batch_2_layer_3_ffn_res
			gpt3_2b_stage_1_batch_2_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_3_ffn_res -> gpt3_2b_stage_1_batch_2_layer_4_norm1
			gpt3_2b_stage_1_batch_2_layer_4_norm1 -> gpt3_2b_stage_1_batch_2_layer_4_qkv
			gpt3_2b_stage_1_batch_2_layer_4_qkv -> gpt3_2b_stage_1_batch_2_layer_4_attn
			gpt3_2b_stage_1_batch_2_layer_4_attn -> gpt3_2b_stage_1_batch_2_layer_4_attn_out
			gpt3_2b_stage_1_batch_2_layer_4_attn_out -> gpt3_2b_stage_1_batch_2_layer_4_attn_res
			gpt3_2b_stage_1_batch_2_layer_4_attn_res -> gpt3_2b_stage_1_batch_2_layer_4_norm2
			gpt3_2b_stage_1_batch_2_layer_4_norm2 -> gpt3_2b_stage_1_batch_2_layer_4_ffn_up
			gpt3_2b_stage_1_batch_2_layer_4_ffn_up -> gpt3_2b_stage_1_batch_2_layer_4_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_4_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_4_ffn_down
			gpt3_2b_stage_1_batch_2_layer_4_ffn_down -> gpt3_2b_stage_1_batch_2_layer_4_ffn_res
			gpt3_2b_stage_1_batch_2_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_4_ffn_res -> gpt3_2b_stage_1_batch_2_layer_5_norm1
			gpt3_2b_stage_1_batch_2_layer_5_norm1 -> gpt3_2b_stage_1_batch_2_layer_5_qkv
			gpt3_2b_stage_1_batch_2_layer_5_qkv -> gpt3_2b_stage_1_batch_2_layer_5_attn
			gpt3_2b_stage_1_batch_2_layer_5_attn -> gpt3_2b_stage_1_batch_2_layer_5_attn_out
			gpt3_2b_stage_1_batch_2_layer_5_attn_out -> gpt3_2b_stage_1_batch_2_layer_5_attn_res
			gpt3_2b_stage_1_batch_2_layer_5_attn_res -> gpt3_2b_stage_1_batch_2_layer_5_norm2
			gpt3_2b_stage_1_batch_2_layer_5_norm2 -> gpt3_2b_stage_1_batch_2_layer_5_ffn_up
			gpt3_2b_stage_1_batch_2_layer_5_ffn_up -> gpt3_2b_stage_1_batch_2_layer_5_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_5_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_5_ffn_down
			gpt3_2b_stage_1_batch_2_layer_5_ffn_down -> gpt3_2b_stage_1_batch_2_layer_5_ffn_res
			gpt3_2b_stage_1_batch_2_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_5_ffn_res -> gpt3_2b_stage_1_batch_2_layer_6_norm1
			gpt3_2b_stage_1_batch_2_layer_6_norm1 -> gpt3_2b_stage_1_batch_2_layer_6_qkv
			gpt3_2b_stage_1_batch_2_layer_6_qkv -> gpt3_2b_stage_1_batch_2_layer_6_attn
			gpt3_2b_stage_1_batch_2_layer_6_attn -> gpt3_2b_stage_1_batch_2_layer_6_attn_out
			gpt3_2b_stage_1_batch_2_layer_6_attn_out -> gpt3_2b_stage_1_batch_2_layer_6_attn_res
			gpt3_2b_stage_1_batch_2_layer_6_attn_res -> gpt3_2b_stage_1_batch_2_layer_6_norm2
			gpt3_2b_stage_1_batch_2_layer_6_norm2 -> gpt3_2b_stage_1_batch_2_layer_6_ffn_up
			gpt3_2b_stage_1_batch_2_layer_6_ffn_up -> gpt3_2b_stage_1_batch_2_layer_6_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_6_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_6_ffn_down
			gpt3_2b_stage_1_batch_2_layer_6_ffn_down -> gpt3_2b_stage_1_batch_2_layer_6_ffn_res
			gpt3_2b_stage_1_batch_2_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_6_ffn_res -> gpt3_2b_stage_1_batch_2_layer_7_norm1
			gpt3_2b_stage_1_batch_2_layer_7_norm1 -> gpt3_2b_stage_1_batch_2_layer_7_qkv
			gpt3_2b_stage_1_batch_2_layer_7_qkv -> gpt3_2b_stage_1_batch_2_layer_7_attn
			gpt3_2b_stage_1_batch_2_layer_7_attn -> gpt3_2b_stage_1_batch_2_layer_7_attn_out
			gpt3_2b_stage_1_batch_2_layer_7_attn_out -> gpt3_2b_stage_1_batch_2_layer_7_attn_res
			gpt3_2b_stage_1_batch_2_layer_7_attn_res -> gpt3_2b_stage_1_batch_2_layer_7_norm2
			gpt3_2b_stage_1_batch_2_layer_7_norm2 -> gpt3_2b_stage_1_batch_2_layer_7_ffn_up
			gpt3_2b_stage_1_batch_2_layer_7_ffn_up -> gpt3_2b_stage_1_batch_2_layer_7_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_7_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_7_ffn_down
			gpt3_2b_stage_1_batch_2_layer_7_ffn_down -> gpt3_2b_stage_1_batch_2_layer_7_ffn_res
			gpt3_2b_stage_1_batch_2_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_2_layer_7_ffn_res -> gpt3_2b_stage_1_batch_2_layer_8_norm1
			gpt3_2b_stage_1_batch_2_layer_8_norm1 -> gpt3_2b_stage_1_batch_2_layer_8_qkv
			gpt3_2b_stage_1_batch_2_layer_8_qkv -> gpt3_2b_stage_1_batch_2_layer_8_attn
			gpt3_2b_stage_1_batch_2_layer_8_attn -> gpt3_2b_stage_1_batch_2_layer_8_attn_out
			gpt3_2b_stage_1_batch_2_layer_8_attn_out -> gpt3_2b_stage_1_batch_2_layer_8_attn_res
			gpt3_2b_stage_1_batch_2_layer_8_attn_res -> gpt3_2b_stage_1_batch_2_layer_8_norm2
			gpt3_2b_stage_1_batch_2_layer_8_norm2 -> gpt3_2b_stage_1_batch_2_layer_8_ffn_up
			gpt3_2b_stage_1_batch_2_layer_8_ffn_up -> gpt3_2b_stage_1_batch_2_layer_8_ffn_gate
			gpt3_2b_stage_1_batch_2_layer_8_ffn_gate -> gpt3_2b_stage_1_batch_2_layer_8_ffn_down
			gpt3_2b_stage_1_batch_2_layer_8_ffn_down -> gpt3_2b_stage_1_batch_2_layer_8_ffn_res
			gpt3_2b_stage_1_batch_2_output [label="Stage 1 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_2_layer_8_ffn_res -> gpt3_2b_stage_1_batch_2_output
			gpt3_2b_stage_1_batch_3_input [label="Micro-batch 3\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_norm1 [label="L1 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_qkv [label="L1 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_attn [label="L1 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_attn_out [label="L1 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_attn_res [label="L1 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_norm2 [label="L1 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_ffn_up [label="L1 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_ffn_gate [label="L1 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_ffn_down [label="L1 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_ffn_res [label="L1 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_input -> gpt3_2b_stage_1_batch_3_layer_1_norm1
			gpt3_2b_stage_1_batch_3_layer_1_norm1 -> gpt3_2b_stage_1_batch_3_layer_1_qkv
			gpt3_2b_stage_1_batch_3_layer_1_qkv -> gpt3_2b_stage_1_batch_3_layer_1_attn
			gpt3_2b_stage_1_batch_3_layer_1_attn -> gpt3_2b_stage_1_batch_3_layer_1_attn_out
			gpt3_2b_stage_1_batch_3_layer_1_attn_out -> gpt3_2b_stage_1_batch_3_layer_1_attn_res
			gpt3_2b_stage_1_batch_3_layer_1_attn_res -> gpt3_2b_stage_1_batch_3_layer_1_norm2
			gpt3_2b_stage_1_batch_3_layer_1_norm2 -> gpt3_2b_stage_1_batch_3_layer_1_ffn_up
			gpt3_2b_stage_1_batch_3_layer_1_ffn_up -> gpt3_2b_stage_1_batch_3_layer_1_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_1_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_1_ffn_down
			gpt3_2b_stage_1_batch_3_layer_1_ffn_down -> gpt3_2b_stage_1_batch_3_layer_1_ffn_res
			gpt3_2b_stage_1_batch_3_layer_2_norm1 [label="L2 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_qkv [label="L2 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_attn [label="L2 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_attn_out [label="L2 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_attn_res [label="L2 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_norm2 [label="L2 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_ffn_up [label="L2 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_ffn_gate [label="L2 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_ffn_down [label="L2 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_ffn_res [label="L2 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_1_ffn_res -> gpt3_2b_stage_1_batch_3_layer_2_norm1
			gpt3_2b_stage_1_batch_3_layer_2_norm1 -> gpt3_2b_stage_1_batch_3_layer_2_qkv
			gpt3_2b_stage_1_batch_3_layer_2_qkv -> gpt3_2b_stage_1_batch_3_layer_2_attn
			gpt3_2b_stage_1_batch_3_layer_2_attn -> gpt3_2b_stage_1_batch_3_layer_2_attn_out
			gpt3_2b_stage_1_batch_3_layer_2_attn_out -> gpt3_2b_stage_1_batch_3_layer_2_attn_res
			gpt3_2b_stage_1_batch_3_layer_2_attn_res -> gpt3_2b_stage_1_batch_3_layer_2_norm2
			gpt3_2b_stage_1_batch_3_layer_2_norm2 -> gpt3_2b_stage_1_batch_3_layer_2_ffn_up
			gpt3_2b_stage_1_batch_3_layer_2_ffn_up -> gpt3_2b_stage_1_batch_3_layer_2_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_2_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_2_ffn_down
			gpt3_2b_stage_1_batch_3_layer_2_ffn_down -> gpt3_2b_stage_1_batch_3_layer_2_ffn_res
			gpt3_2b_stage_1_batch_3_layer_3_norm1 [label="L3 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_qkv [label="L3 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_attn [label="L3 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_attn_out [label="L3 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_attn_res [label="L3 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_norm2 [label="L3 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_ffn_up [label="L3 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_ffn_gate [label="L3 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_ffn_down [label="L3 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_ffn_res [label="L3 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_2_ffn_res -> gpt3_2b_stage_1_batch_3_layer_3_norm1
			gpt3_2b_stage_1_batch_3_layer_3_norm1 -> gpt3_2b_stage_1_batch_3_layer_3_qkv
			gpt3_2b_stage_1_batch_3_layer_3_qkv -> gpt3_2b_stage_1_batch_3_layer_3_attn
			gpt3_2b_stage_1_batch_3_layer_3_attn -> gpt3_2b_stage_1_batch_3_layer_3_attn_out
			gpt3_2b_stage_1_batch_3_layer_3_attn_out -> gpt3_2b_stage_1_batch_3_layer_3_attn_res
			gpt3_2b_stage_1_batch_3_layer_3_attn_res -> gpt3_2b_stage_1_batch_3_layer_3_norm2
			gpt3_2b_stage_1_batch_3_layer_3_norm2 -> gpt3_2b_stage_1_batch_3_layer_3_ffn_up
			gpt3_2b_stage_1_batch_3_layer_3_ffn_up -> gpt3_2b_stage_1_batch_3_layer_3_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_3_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_3_ffn_down
			gpt3_2b_stage_1_batch_3_layer_3_ffn_down -> gpt3_2b_stage_1_batch_3_layer_3_ffn_res
			gpt3_2b_stage_1_batch_3_layer_4_norm1 [label="L4 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_qkv [label="L4 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_attn [label="L4 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_attn_out [label="L4 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_attn_res [label="L4 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_norm2 [label="L4 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_ffn_up [label="L4 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_ffn_gate [label="L4 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_ffn_down [label="L4 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_ffn_res [label="L4 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_3_ffn_res -> gpt3_2b_stage_1_batch_3_layer_4_norm1
			gpt3_2b_stage_1_batch_3_layer_4_norm1 -> gpt3_2b_stage_1_batch_3_layer_4_qkv
			gpt3_2b_stage_1_batch_3_layer_4_qkv -> gpt3_2b_stage_1_batch_3_layer_4_attn
			gpt3_2b_stage_1_batch_3_layer_4_attn -> gpt3_2b_stage_1_batch_3_layer_4_attn_out
			gpt3_2b_stage_1_batch_3_layer_4_attn_out -> gpt3_2b_stage_1_batch_3_layer_4_attn_res
			gpt3_2b_stage_1_batch_3_layer_4_attn_res -> gpt3_2b_stage_1_batch_3_layer_4_norm2
			gpt3_2b_stage_1_batch_3_layer_4_norm2 -> gpt3_2b_stage_1_batch_3_layer_4_ffn_up
			gpt3_2b_stage_1_batch_3_layer_4_ffn_up -> gpt3_2b_stage_1_batch_3_layer_4_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_4_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_4_ffn_down
			gpt3_2b_stage_1_batch_3_layer_4_ffn_down -> gpt3_2b_stage_1_batch_3_layer_4_ffn_res
			gpt3_2b_stage_1_batch_3_layer_5_norm1 [label="L5 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_qkv [label="L5 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_attn [label="L5 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_attn_out [label="L5 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_attn_res [label="L5 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_norm2 [label="L5 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_ffn_up [label="L5 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_ffn_gate [label="L5 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_ffn_down [label="L5 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_ffn_res [label="L5 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_4_ffn_res -> gpt3_2b_stage_1_batch_3_layer_5_norm1
			gpt3_2b_stage_1_batch_3_layer_5_norm1 -> gpt3_2b_stage_1_batch_3_layer_5_qkv
			gpt3_2b_stage_1_batch_3_layer_5_qkv -> gpt3_2b_stage_1_batch_3_layer_5_attn
			gpt3_2b_stage_1_batch_3_layer_5_attn -> gpt3_2b_stage_1_batch_3_layer_5_attn_out
			gpt3_2b_stage_1_batch_3_layer_5_attn_out -> gpt3_2b_stage_1_batch_3_layer_5_attn_res
			gpt3_2b_stage_1_batch_3_layer_5_attn_res -> gpt3_2b_stage_1_batch_3_layer_5_norm2
			gpt3_2b_stage_1_batch_3_layer_5_norm2 -> gpt3_2b_stage_1_batch_3_layer_5_ffn_up
			gpt3_2b_stage_1_batch_3_layer_5_ffn_up -> gpt3_2b_stage_1_batch_3_layer_5_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_5_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_5_ffn_down
			gpt3_2b_stage_1_batch_3_layer_5_ffn_down -> gpt3_2b_stage_1_batch_3_layer_5_ffn_res
			gpt3_2b_stage_1_batch_3_layer_6_norm1 [label="L6 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_qkv [label="L6 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_attn [label="L6 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_attn_out [label="L6 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_attn_res [label="L6 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_norm2 [label="L6 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_ffn_up [label="L6 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_ffn_gate [label="L6 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_ffn_down [label="L6 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_ffn_res [label="L6 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_5_ffn_res -> gpt3_2b_stage_1_batch_3_layer_6_norm1
			gpt3_2b_stage_1_batch_3_layer_6_norm1 -> gpt3_2b_stage_1_batch_3_layer_6_qkv
			gpt3_2b_stage_1_batch_3_layer_6_qkv -> gpt3_2b_stage_1_batch_3_layer_6_attn
			gpt3_2b_stage_1_batch_3_layer_6_attn -> gpt3_2b_stage_1_batch_3_layer_6_attn_out
			gpt3_2b_stage_1_batch_3_layer_6_attn_out -> gpt3_2b_stage_1_batch_3_layer_6_attn_res
			gpt3_2b_stage_1_batch_3_layer_6_attn_res -> gpt3_2b_stage_1_batch_3_layer_6_norm2
			gpt3_2b_stage_1_batch_3_layer_6_norm2 -> gpt3_2b_stage_1_batch_3_layer_6_ffn_up
			gpt3_2b_stage_1_batch_3_layer_6_ffn_up -> gpt3_2b_stage_1_batch_3_layer_6_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_6_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_6_ffn_down
			gpt3_2b_stage_1_batch_3_layer_6_ffn_down -> gpt3_2b_stage_1_batch_3_layer_6_ffn_res
			gpt3_2b_stage_1_batch_3_layer_7_norm1 [label="L7 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_qkv [label="L7 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_attn [label="L7 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_attn_out [label="L7 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_attn_res [label="L7 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_norm2 [label="L7 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_ffn_up [label="L7 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_ffn_gate [label="L7 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_ffn_down [label="L7 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_ffn_res [label="L7 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_6_ffn_res -> gpt3_2b_stage_1_batch_3_layer_7_norm1
			gpt3_2b_stage_1_batch_3_layer_7_norm1 -> gpt3_2b_stage_1_batch_3_layer_7_qkv
			gpt3_2b_stage_1_batch_3_layer_7_qkv -> gpt3_2b_stage_1_batch_3_layer_7_attn
			gpt3_2b_stage_1_batch_3_layer_7_attn -> gpt3_2b_stage_1_batch_3_layer_7_attn_out
			gpt3_2b_stage_1_batch_3_layer_7_attn_out -> gpt3_2b_stage_1_batch_3_layer_7_attn_res
			gpt3_2b_stage_1_batch_3_layer_7_attn_res -> gpt3_2b_stage_1_batch_3_layer_7_norm2
			gpt3_2b_stage_1_batch_3_layer_7_norm2 -> gpt3_2b_stage_1_batch_3_layer_7_ffn_up
			gpt3_2b_stage_1_batch_3_layer_7_ffn_up -> gpt3_2b_stage_1_batch_3_layer_7_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_7_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_7_ffn_down
			gpt3_2b_stage_1_batch_3_layer_7_ffn_down -> gpt3_2b_stage_1_batch_3_layer_7_ffn_res
			gpt3_2b_stage_1_batch_3_layer_8_norm1 [label="L8 Norm1\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_qkv [label="L8 QKV\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_attn [label="L8 Attention\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_attn_out [label="L8 Attn Out\nDevice: GPU_1" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_attn_res [label="L8 Attn+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_norm2 [label="L8 Norm2\nDevice: GPU_1" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_ffn_up [label="L8 FFN Up\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_ffn_gate [label="L8 FFN Gate\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_ffn_down [label="L8 FFN Down\nDevice: GPU_1" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_ffn_res [label="L8 FFN+Res\nDevice: GPU_1" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_1_batch_3_layer_7_ffn_res -> gpt3_2b_stage_1_batch_3_layer_8_norm1
			gpt3_2b_stage_1_batch_3_layer_8_norm1 -> gpt3_2b_stage_1_batch_3_layer_8_qkv
			gpt3_2b_stage_1_batch_3_layer_8_qkv -> gpt3_2b_stage_1_batch_3_layer_8_attn
			gpt3_2b_stage_1_batch_3_layer_8_attn -> gpt3_2b_stage_1_batch_3_layer_8_attn_out
			gpt3_2b_stage_1_batch_3_layer_8_attn_out -> gpt3_2b_stage_1_batch_3_layer_8_attn_res
			gpt3_2b_stage_1_batch_3_layer_8_attn_res -> gpt3_2b_stage_1_batch_3_layer_8_norm2
			gpt3_2b_stage_1_batch_3_layer_8_norm2 -> gpt3_2b_stage_1_batch_3_layer_8_ffn_up
			gpt3_2b_stage_1_batch_3_layer_8_ffn_up -> gpt3_2b_stage_1_batch_3_layer_8_ffn_gate
			gpt3_2b_stage_1_batch_3_layer_8_ffn_gate -> gpt3_2b_stage_1_batch_3_layer_8_ffn_down
			gpt3_2b_stage_1_batch_3_layer_8_ffn_down -> gpt3_2b_stage_1_batch_3_layer_8_ffn_res
			gpt3_2b_stage_1_batch_3_output [label="Stage 1 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_1_batch_3_layer_8_ffn_res -> gpt3_2b_stage_1_batch_3_output
		}
		subgraph cluster_gpt3_2b_stage_2 {
			color=black fillcolor=lightgreen label="Stage 2\nGPU_2\nLayers 9-16" style="rounded,filled"
			gpt3_2b_stage_2_batch_1_input [label="Micro-batch 1\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_input -> gpt3_2b_stage_2_batch_1_layer_9_norm1
			gpt3_2b_stage_2_batch_1_layer_9_norm1 -> gpt3_2b_stage_2_batch_1_layer_9_qkv
			gpt3_2b_stage_2_batch_1_layer_9_qkv -> gpt3_2b_stage_2_batch_1_layer_9_attn
			gpt3_2b_stage_2_batch_1_layer_9_attn -> gpt3_2b_stage_2_batch_1_layer_9_attn_out
			gpt3_2b_stage_2_batch_1_layer_9_attn_out -> gpt3_2b_stage_2_batch_1_layer_9_attn_res
			gpt3_2b_stage_2_batch_1_layer_9_attn_res -> gpt3_2b_stage_2_batch_1_layer_9_norm2
			gpt3_2b_stage_2_batch_1_layer_9_norm2 -> gpt3_2b_stage_2_batch_1_layer_9_ffn_up
			gpt3_2b_stage_2_batch_1_layer_9_ffn_up -> gpt3_2b_stage_2_batch_1_layer_9_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_9_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_9_ffn_down
			gpt3_2b_stage_2_batch_1_layer_9_ffn_down -> gpt3_2b_stage_2_batch_1_layer_9_ffn_res
			gpt3_2b_stage_2_batch_1_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_9_ffn_res -> gpt3_2b_stage_2_batch_1_layer_10_norm1
			gpt3_2b_stage_2_batch_1_layer_10_norm1 -> gpt3_2b_stage_2_batch_1_layer_10_qkv
			gpt3_2b_stage_2_batch_1_layer_10_qkv -> gpt3_2b_stage_2_batch_1_layer_10_attn
			gpt3_2b_stage_2_batch_1_layer_10_attn -> gpt3_2b_stage_2_batch_1_layer_10_attn_out
			gpt3_2b_stage_2_batch_1_layer_10_attn_out -> gpt3_2b_stage_2_batch_1_layer_10_attn_res
			gpt3_2b_stage_2_batch_1_layer_10_attn_res -> gpt3_2b_stage_2_batch_1_layer_10_norm2
			gpt3_2b_stage_2_batch_1_layer_10_norm2 -> gpt3_2b_stage_2_batch_1_layer_10_ffn_up
			gpt3_2b_stage_2_batch_1_layer_10_ffn_up -> gpt3_2b_stage_2_batch_1_layer_10_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_10_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_10_ffn_down
			gpt3_2b_stage_2_batch_1_layer_10_ffn_down -> gpt3_2b_stage_2_batch_1_layer_10_ffn_res
			gpt3_2b_stage_2_batch_1_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_10_ffn_res -> gpt3_2b_stage_2_batch_1_layer_11_norm1
			gpt3_2b_stage_2_batch_1_layer_11_norm1 -> gpt3_2b_stage_2_batch_1_layer_11_qkv
			gpt3_2b_stage_2_batch_1_layer_11_qkv -> gpt3_2b_stage_2_batch_1_layer_11_attn
			gpt3_2b_stage_2_batch_1_layer_11_attn -> gpt3_2b_stage_2_batch_1_layer_11_attn_out
			gpt3_2b_stage_2_batch_1_layer_11_attn_out -> gpt3_2b_stage_2_batch_1_layer_11_attn_res
			gpt3_2b_stage_2_batch_1_layer_11_attn_res -> gpt3_2b_stage_2_batch_1_layer_11_norm2
			gpt3_2b_stage_2_batch_1_layer_11_norm2 -> gpt3_2b_stage_2_batch_1_layer_11_ffn_up
			gpt3_2b_stage_2_batch_1_layer_11_ffn_up -> gpt3_2b_stage_2_batch_1_layer_11_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_11_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_11_ffn_down
			gpt3_2b_stage_2_batch_1_layer_11_ffn_down -> gpt3_2b_stage_2_batch_1_layer_11_ffn_res
			gpt3_2b_stage_2_batch_1_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_11_ffn_res -> gpt3_2b_stage_2_batch_1_layer_12_norm1
			gpt3_2b_stage_2_batch_1_layer_12_norm1 -> gpt3_2b_stage_2_batch_1_layer_12_qkv
			gpt3_2b_stage_2_batch_1_layer_12_qkv -> gpt3_2b_stage_2_batch_1_layer_12_attn
			gpt3_2b_stage_2_batch_1_layer_12_attn -> gpt3_2b_stage_2_batch_1_layer_12_attn_out
			gpt3_2b_stage_2_batch_1_layer_12_attn_out -> gpt3_2b_stage_2_batch_1_layer_12_attn_res
			gpt3_2b_stage_2_batch_1_layer_12_attn_res -> gpt3_2b_stage_2_batch_1_layer_12_norm2
			gpt3_2b_stage_2_batch_1_layer_12_norm2 -> gpt3_2b_stage_2_batch_1_layer_12_ffn_up
			gpt3_2b_stage_2_batch_1_layer_12_ffn_up -> gpt3_2b_stage_2_batch_1_layer_12_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_12_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_12_ffn_down
			gpt3_2b_stage_2_batch_1_layer_12_ffn_down -> gpt3_2b_stage_2_batch_1_layer_12_ffn_res
			gpt3_2b_stage_2_batch_1_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_12_ffn_res -> gpt3_2b_stage_2_batch_1_layer_13_norm1
			gpt3_2b_stage_2_batch_1_layer_13_norm1 -> gpt3_2b_stage_2_batch_1_layer_13_qkv
			gpt3_2b_stage_2_batch_1_layer_13_qkv -> gpt3_2b_stage_2_batch_1_layer_13_attn
			gpt3_2b_stage_2_batch_1_layer_13_attn -> gpt3_2b_stage_2_batch_1_layer_13_attn_out
			gpt3_2b_stage_2_batch_1_layer_13_attn_out -> gpt3_2b_stage_2_batch_1_layer_13_attn_res
			gpt3_2b_stage_2_batch_1_layer_13_attn_res -> gpt3_2b_stage_2_batch_1_layer_13_norm2
			gpt3_2b_stage_2_batch_1_layer_13_norm2 -> gpt3_2b_stage_2_batch_1_layer_13_ffn_up
			gpt3_2b_stage_2_batch_1_layer_13_ffn_up -> gpt3_2b_stage_2_batch_1_layer_13_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_13_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_13_ffn_down
			gpt3_2b_stage_2_batch_1_layer_13_ffn_down -> gpt3_2b_stage_2_batch_1_layer_13_ffn_res
			gpt3_2b_stage_2_batch_1_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_13_ffn_res -> gpt3_2b_stage_2_batch_1_layer_14_norm1
			gpt3_2b_stage_2_batch_1_layer_14_norm1 -> gpt3_2b_stage_2_batch_1_layer_14_qkv
			gpt3_2b_stage_2_batch_1_layer_14_qkv -> gpt3_2b_stage_2_batch_1_layer_14_attn
			gpt3_2b_stage_2_batch_1_layer_14_attn -> gpt3_2b_stage_2_batch_1_layer_14_attn_out
			gpt3_2b_stage_2_batch_1_layer_14_attn_out -> gpt3_2b_stage_2_batch_1_layer_14_attn_res
			gpt3_2b_stage_2_batch_1_layer_14_attn_res -> gpt3_2b_stage_2_batch_1_layer_14_norm2
			gpt3_2b_stage_2_batch_1_layer_14_norm2 -> gpt3_2b_stage_2_batch_1_layer_14_ffn_up
			gpt3_2b_stage_2_batch_1_layer_14_ffn_up -> gpt3_2b_stage_2_batch_1_layer_14_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_14_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_14_ffn_down
			gpt3_2b_stage_2_batch_1_layer_14_ffn_down -> gpt3_2b_stage_2_batch_1_layer_14_ffn_res
			gpt3_2b_stage_2_batch_1_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_14_ffn_res -> gpt3_2b_stage_2_batch_1_layer_15_norm1
			gpt3_2b_stage_2_batch_1_layer_15_norm1 -> gpt3_2b_stage_2_batch_1_layer_15_qkv
			gpt3_2b_stage_2_batch_1_layer_15_qkv -> gpt3_2b_stage_2_batch_1_layer_15_attn
			gpt3_2b_stage_2_batch_1_layer_15_attn -> gpt3_2b_stage_2_batch_1_layer_15_attn_out
			gpt3_2b_stage_2_batch_1_layer_15_attn_out -> gpt3_2b_stage_2_batch_1_layer_15_attn_res
			gpt3_2b_stage_2_batch_1_layer_15_attn_res -> gpt3_2b_stage_2_batch_1_layer_15_norm2
			gpt3_2b_stage_2_batch_1_layer_15_norm2 -> gpt3_2b_stage_2_batch_1_layer_15_ffn_up
			gpt3_2b_stage_2_batch_1_layer_15_ffn_up -> gpt3_2b_stage_2_batch_1_layer_15_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_15_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_15_ffn_down
			gpt3_2b_stage_2_batch_1_layer_15_ffn_down -> gpt3_2b_stage_2_batch_1_layer_15_ffn_res
			gpt3_2b_stage_2_batch_1_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_1_layer_15_ffn_res -> gpt3_2b_stage_2_batch_1_layer_16_norm1
			gpt3_2b_stage_2_batch_1_layer_16_norm1 -> gpt3_2b_stage_2_batch_1_layer_16_qkv
			gpt3_2b_stage_2_batch_1_layer_16_qkv -> gpt3_2b_stage_2_batch_1_layer_16_attn
			gpt3_2b_stage_2_batch_1_layer_16_attn -> gpt3_2b_stage_2_batch_1_layer_16_attn_out
			gpt3_2b_stage_2_batch_1_layer_16_attn_out -> gpt3_2b_stage_2_batch_1_layer_16_attn_res
			gpt3_2b_stage_2_batch_1_layer_16_attn_res -> gpt3_2b_stage_2_batch_1_layer_16_norm2
			gpt3_2b_stage_2_batch_1_layer_16_norm2 -> gpt3_2b_stage_2_batch_1_layer_16_ffn_up
			gpt3_2b_stage_2_batch_1_layer_16_ffn_up -> gpt3_2b_stage_2_batch_1_layer_16_ffn_gate
			gpt3_2b_stage_2_batch_1_layer_16_ffn_gate -> gpt3_2b_stage_2_batch_1_layer_16_ffn_down
			gpt3_2b_stage_2_batch_1_layer_16_ffn_down -> gpt3_2b_stage_2_batch_1_layer_16_ffn_res
			gpt3_2b_stage_2_batch_1_output [label="Stage 2 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_1_layer_16_ffn_res -> gpt3_2b_stage_2_batch_1_output
			gpt3_2b_stage_2_batch_2_input [label="Micro-batch 2\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_input -> gpt3_2b_stage_2_batch_2_layer_9_norm1
			gpt3_2b_stage_2_batch_2_layer_9_norm1 -> gpt3_2b_stage_2_batch_2_layer_9_qkv
			gpt3_2b_stage_2_batch_2_layer_9_qkv -> gpt3_2b_stage_2_batch_2_layer_9_attn
			gpt3_2b_stage_2_batch_2_layer_9_attn -> gpt3_2b_stage_2_batch_2_layer_9_attn_out
			gpt3_2b_stage_2_batch_2_layer_9_attn_out -> gpt3_2b_stage_2_batch_2_layer_9_attn_res
			gpt3_2b_stage_2_batch_2_layer_9_attn_res -> gpt3_2b_stage_2_batch_2_layer_9_norm2
			gpt3_2b_stage_2_batch_2_layer_9_norm2 -> gpt3_2b_stage_2_batch_2_layer_9_ffn_up
			gpt3_2b_stage_2_batch_2_layer_9_ffn_up -> gpt3_2b_stage_2_batch_2_layer_9_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_9_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_9_ffn_down
			gpt3_2b_stage_2_batch_2_layer_9_ffn_down -> gpt3_2b_stage_2_batch_2_layer_9_ffn_res
			gpt3_2b_stage_2_batch_2_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_9_ffn_res -> gpt3_2b_stage_2_batch_2_layer_10_norm1
			gpt3_2b_stage_2_batch_2_layer_10_norm1 -> gpt3_2b_stage_2_batch_2_layer_10_qkv
			gpt3_2b_stage_2_batch_2_layer_10_qkv -> gpt3_2b_stage_2_batch_2_layer_10_attn
			gpt3_2b_stage_2_batch_2_layer_10_attn -> gpt3_2b_stage_2_batch_2_layer_10_attn_out
			gpt3_2b_stage_2_batch_2_layer_10_attn_out -> gpt3_2b_stage_2_batch_2_layer_10_attn_res
			gpt3_2b_stage_2_batch_2_layer_10_attn_res -> gpt3_2b_stage_2_batch_2_layer_10_norm2
			gpt3_2b_stage_2_batch_2_layer_10_norm2 -> gpt3_2b_stage_2_batch_2_layer_10_ffn_up
			gpt3_2b_stage_2_batch_2_layer_10_ffn_up -> gpt3_2b_stage_2_batch_2_layer_10_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_10_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_10_ffn_down
			gpt3_2b_stage_2_batch_2_layer_10_ffn_down -> gpt3_2b_stage_2_batch_2_layer_10_ffn_res
			gpt3_2b_stage_2_batch_2_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_10_ffn_res -> gpt3_2b_stage_2_batch_2_layer_11_norm1
			gpt3_2b_stage_2_batch_2_layer_11_norm1 -> gpt3_2b_stage_2_batch_2_layer_11_qkv
			gpt3_2b_stage_2_batch_2_layer_11_qkv -> gpt3_2b_stage_2_batch_2_layer_11_attn
			gpt3_2b_stage_2_batch_2_layer_11_attn -> gpt3_2b_stage_2_batch_2_layer_11_attn_out
			gpt3_2b_stage_2_batch_2_layer_11_attn_out -> gpt3_2b_stage_2_batch_2_layer_11_attn_res
			gpt3_2b_stage_2_batch_2_layer_11_attn_res -> gpt3_2b_stage_2_batch_2_layer_11_norm2
			gpt3_2b_stage_2_batch_2_layer_11_norm2 -> gpt3_2b_stage_2_batch_2_layer_11_ffn_up
			gpt3_2b_stage_2_batch_2_layer_11_ffn_up -> gpt3_2b_stage_2_batch_2_layer_11_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_11_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_11_ffn_down
			gpt3_2b_stage_2_batch_2_layer_11_ffn_down -> gpt3_2b_stage_2_batch_2_layer_11_ffn_res
			gpt3_2b_stage_2_batch_2_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_11_ffn_res -> gpt3_2b_stage_2_batch_2_layer_12_norm1
			gpt3_2b_stage_2_batch_2_layer_12_norm1 -> gpt3_2b_stage_2_batch_2_layer_12_qkv
			gpt3_2b_stage_2_batch_2_layer_12_qkv -> gpt3_2b_stage_2_batch_2_layer_12_attn
			gpt3_2b_stage_2_batch_2_layer_12_attn -> gpt3_2b_stage_2_batch_2_layer_12_attn_out
			gpt3_2b_stage_2_batch_2_layer_12_attn_out -> gpt3_2b_stage_2_batch_2_layer_12_attn_res
			gpt3_2b_stage_2_batch_2_layer_12_attn_res -> gpt3_2b_stage_2_batch_2_layer_12_norm2
			gpt3_2b_stage_2_batch_2_layer_12_norm2 -> gpt3_2b_stage_2_batch_2_layer_12_ffn_up
			gpt3_2b_stage_2_batch_2_layer_12_ffn_up -> gpt3_2b_stage_2_batch_2_layer_12_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_12_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_12_ffn_down
			gpt3_2b_stage_2_batch_2_layer_12_ffn_down -> gpt3_2b_stage_2_batch_2_layer_12_ffn_res
			gpt3_2b_stage_2_batch_2_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_12_ffn_res -> gpt3_2b_stage_2_batch_2_layer_13_norm1
			gpt3_2b_stage_2_batch_2_layer_13_norm1 -> gpt3_2b_stage_2_batch_2_layer_13_qkv
			gpt3_2b_stage_2_batch_2_layer_13_qkv -> gpt3_2b_stage_2_batch_2_layer_13_attn
			gpt3_2b_stage_2_batch_2_layer_13_attn -> gpt3_2b_stage_2_batch_2_layer_13_attn_out
			gpt3_2b_stage_2_batch_2_layer_13_attn_out -> gpt3_2b_stage_2_batch_2_layer_13_attn_res
			gpt3_2b_stage_2_batch_2_layer_13_attn_res -> gpt3_2b_stage_2_batch_2_layer_13_norm2
			gpt3_2b_stage_2_batch_2_layer_13_norm2 -> gpt3_2b_stage_2_batch_2_layer_13_ffn_up
			gpt3_2b_stage_2_batch_2_layer_13_ffn_up -> gpt3_2b_stage_2_batch_2_layer_13_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_13_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_13_ffn_down
			gpt3_2b_stage_2_batch_2_layer_13_ffn_down -> gpt3_2b_stage_2_batch_2_layer_13_ffn_res
			gpt3_2b_stage_2_batch_2_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_13_ffn_res -> gpt3_2b_stage_2_batch_2_layer_14_norm1
			gpt3_2b_stage_2_batch_2_layer_14_norm1 -> gpt3_2b_stage_2_batch_2_layer_14_qkv
			gpt3_2b_stage_2_batch_2_layer_14_qkv -> gpt3_2b_stage_2_batch_2_layer_14_attn
			gpt3_2b_stage_2_batch_2_layer_14_attn -> gpt3_2b_stage_2_batch_2_layer_14_attn_out
			gpt3_2b_stage_2_batch_2_layer_14_attn_out -> gpt3_2b_stage_2_batch_2_layer_14_attn_res
			gpt3_2b_stage_2_batch_2_layer_14_attn_res -> gpt3_2b_stage_2_batch_2_layer_14_norm2
			gpt3_2b_stage_2_batch_2_layer_14_norm2 -> gpt3_2b_stage_2_batch_2_layer_14_ffn_up
			gpt3_2b_stage_2_batch_2_layer_14_ffn_up -> gpt3_2b_stage_2_batch_2_layer_14_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_14_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_14_ffn_down
			gpt3_2b_stage_2_batch_2_layer_14_ffn_down -> gpt3_2b_stage_2_batch_2_layer_14_ffn_res
			gpt3_2b_stage_2_batch_2_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_14_ffn_res -> gpt3_2b_stage_2_batch_2_layer_15_norm1
			gpt3_2b_stage_2_batch_2_layer_15_norm1 -> gpt3_2b_stage_2_batch_2_layer_15_qkv
			gpt3_2b_stage_2_batch_2_layer_15_qkv -> gpt3_2b_stage_2_batch_2_layer_15_attn
			gpt3_2b_stage_2_batch_2_layer_15_attn -> gpt3_2b_stage_2_batch_2_layer_15_attn_out
			gpt3_2b_stage_2_batch_2_layer_15_attn_out -> gpt3_2b_stage_2_batch_2_layer_15_attn_res
			gpt3_2b_stage_2_batch_2_layer_15_attn_res -> gpt3_2b_stage_2_batch_2_layer_15_norm2
			gpt3_2b_stage_2_batch_2_layer_15_norm2 -> gpt3_2b_stage_2_batch_2_layer_15_ffn_up
			gpt3_2b_stage_2_batch_2_layer_15_ffn_up -> gpt3_2b_stage_2_batch_2_layer_15_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_15_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_15_ffn_down
			gpt3_2b_stage_2_batch_2_layer_15_ffn_down -> gpt3_2b_stage_2_batch_2_layer_15_ffn_res
			gpt3_2b_stage_2_batch_2_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_2_layer_15_ffn_res -> gpt3_2b_stage_2_batch_2_layer_16_norm1
			gpt3_2b_stage_2_batch_2_layer_16_norm1 -> gpt3_2b_stage_2_batch_2_layer_16_qkv
			gpt3_2b_stage_2_batch_2_layer_16_qkv -> gpt3_2b_stage_2_batch_2_layer_16_attn
			gpt3_2b_stage_2_batch_2_layer_16_attn -> gpt3_2b_stage_2_batch_2_layer_16_attn_out
			gpt3_2b_stage_2_batch_2_layer_16_attn_out -> gpt3_2b_stage_2_batch_2_layer_16_attn_res
			gpt3_2b_stage_2_batch_2_layer_16_attn_res -> gpt3_2b_stage_2_batch_2_layer_16_norm2
			gpt3_2b_stage_2_batch_2_layer_16_norm2 -> gpt3_2b_stage_2_batch_2_layer_16_ffn_up
			gpt3_2b_stage_2_batch_2_layer_16_ffn_up -> gpt3_2b_stage_2_batch_2_layer_16_ffn_gate
			gpt3_2b_stage_2_batch_2_layer_16_ffn_gate -> gpt3_2b_stage_2_batch_2_layer_16_ffn_down
			gpt3_2b_stage_2_batch_2_layer_16_ffn_down -> gpt3_2b_stage_2_batch_2_layer_16_ffn_res
			gpt3_2b_stage_2_batch_2_output [label="Stage 2 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_2_layer_16_ffn_res -> gpt3_2b_stage_2_batch_2_output
			gpt3_2b_stage_2_batch_3_input [label="Micro-batch 3\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_norm1 [label="L9 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_qkv [label="L9 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_attn [label="L9 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_attn_out [label="L9 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_attn_res [label="L9 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_norm2 [label="L9 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_ffn_up [label="L9 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_ffn_gate [label="L9 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_ffn_down [label="L9 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_ffn_res [label="L9 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_input -> gpt3_2b_stage_2_batch_3_layer_9_norm1
			gpt3_2b_stage_2_batch_3_layer_9_norm1 -> gpt3_2b_stage_2_batch_3_layer_9_qkv
			gpt3_2b_stage_2_batch_3_layer_9_qkv -> gpt3_2b_stage_2_batch_3_layer_9_attn
			gpt3_2b_stage_2_batch_3_layer_9_attn -> gpt3_2b_stage_2_batch_3_layer_9_attn_out
			gpt3_2b_stage_2_batch_3_layer_9_attn_out -> gpt3_2b_stage_2_batch_3_layer_9_attn_res
			gpt3_2b_stage_2_batch_3_layer_9_attn_res -> gpt3_2b_stage_2_batch_3_layer_9_norm2
			gpt3_2b_stage_2_batch_3_layer_9_norm2 -> gpt3_2b_stage_2_batch_3_layer_9_ffn_up
			gpt3_2b_stage_2_batch_3_layer_9_ffn_up -> gpt3_2b_stage_2_batch_3_layer_9_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_9_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_9_ffn_down
			gpt3_2b_stage_2_batch_3_layer_9_ffn_down -> gpt3_2b_stage_2_batch_3_layer_9_ffn_res
			gpt3_2b_stage_2_batch_3_layer_10_norm1 [label="L10 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_qkv [label="L10 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_attn [label="L10 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_attn_out [label="L10 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_attn_res [label="L10 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_norm2 [label="L10 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_ffn_up [label="L10 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_ffn_gate [label="L10 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_ffn_down [label="L10 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_ffn_res [label="L10 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_9_ffn_res -> gpt3_2b_stage_2_batch_3_layer_10_norm1
			gpt3_2b_stage_2_batch_3_layer_10_norm1 -> gpt3_2b_stage_2_batch_3_layer_10_qkv
			gpt3_2b_stage_2_batch_3_layer_10_qkv -> gpt3_2b_stage_2_batch_3_layer_10_attn
			gpt3_2b_stage_2_batch_3_layer_10_attn -> gpt3_2b_stage_2_batch_3_layer_10_attn_out
			gpt3_2b_stage_2_batch_3_layer_10_attn_out -> gpt3_2b_stage_2_batch_3_layer_10_attn_res
			gpt3_2b_stage_2_batch_3_layer_10_attn_res -> gpt3_2b_stage_2_batch_3_layer_10_norm2
			gpt3_2b_stage_2_batch_3_layer_10_norm2 -> gpt3_2b_stage_2_batch_3_layer_10_ffn_up
			gpt3_2b_stage_2_batch_3_layer_10_ffn_up -> gpt3_2b_stage_2_batch_3_layer_10_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_10_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_10_ffn_down
			gpt3_2b_stage_2_batch_3_layer_10_ffn_down -> gpt3_2b_stage_2_batch_3_layer_10_ffn_res
			gpt3_2b_stage_2_batch_3_layer_11_norm1 [label="L11 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_qkv [label="L11 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_attn [label="L11 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_attn_out [label="L11 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_attn_res [label="L11 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_norm2 [label="L11 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_ffn_up [label="L11 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_ffn_gate [label="L11 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_ffn_down [label="L11 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_ffn_res [label="L11 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_10_ffn_res -> gpt3_2b_stage_2_batch_3_layer_11_norm1
			gpt3_2b_stage_2_batch_3_layer_11_norm1 -> gpt3_2b_stage_2_batch_3_layer_11_qkv
			gpt3_2b_stage_2_batch_3_layer_11_qkv -> gpt3_2b_stage_2_batch_3_layer_11_attn
			gpt3_2b_stage_2_batch_3_layer_11_attn -> gpt3_2b_stage_2_batch_3_layer_11_attn_out
			gpt3_2b_stage_2_batch_3_layer_11_attn_out -> gpt3_2b_stage_2_batch_3_layer_11_attn_res
			gpt3_2b_stage_2_batch_3_layer_11_attn_res -> gpt3_2b_stage_2_batch_3_layer_11_norm2
			gpt3_2b_stage_2_batch_3_layer_11_norm2 -> gpt3_2b_stage_2_batch_3_layer_11_ffn_up
			gpt3_2b_stage_2_batch_3_layer_11_ffn_up -> gpt3_2b_stage_2_batch_3_layer_11_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_11_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_11_ffn_down
			gpt3_2b_stage_2_batch_3_layer_11_ffn_down -> gpt3_2b_stage_2_batch_3_layer_11_ffn_res
			gpt3_2b_stage_2_batch_3_layer_12_norm1 [label="L12 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_qkv [label="L12 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_attn [label="L12 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_attn_out [label="L12 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_attn_res [label="L12 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_norm2 [label="L12 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_ffn_up [label="L12 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_ffn_gate [label="L12 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_ffn_down [label="L12 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_ffn_res [label="L12 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_11_ffn_res -> gpt3_2b_stage_2_batch_3_layer_12_norm1
			gpt3_2b_stage_2_batch_3_layer_12_norm1 -> gpt3_2b_stage_2_batch_3_layer_12_qkv
			gpt3_2b_stage_2_batch_3_layer_12_qkv -> gpt3_2b_stage_2_batch_3_layer_12_attn
			gpt3_2b_stage_2_batch_3_layer_12_attn -> gpt3_2b_stage_2_batch_3_layer_12_attn_out
			gpt3_2b_stage_2_batch_3_layer_12_attn_out -> gpt3_2b_stage_2_batch_3_layer_12_attn_res
			gpt3_2b_stage_2_batch_3_layer_12_attn_res -> gpt3_2b_stage_2_batch_3_layer_12_norm2
			gpt3_2b_stage_2_batch_3_layer_12_norm2 -> gpt3_2b_stage_2_batch_3_layer_12_ffn_up
			gpt3_2b_stage_2_batch_3_layer_12_ffn_up -> gpt3_2b_stage_2_batch_3_layer_12_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_12_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_12_ffn_down
			gpt3_2b_stage_2_batch_3_layer_12_ffn_down -> gpt3_2b_stage_2_batch_3_layer_12_ffn_res
			gpt3_2b_stage_2_batch_3_layer_13_norm1 [label="L13 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_qkv [label="L13 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_attn [label="L13 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_attn_out [label="L13 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_attn_res [label="L13 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_norm2 [label="L13 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_ffn_up [label="L13 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_ffn_gate [label="L13 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_ffn_down [label="L13 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_ffn_res [label="L13 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_12_ffn_res -> gpt3_2b_stage_2_batch_3_layer_13_norm1
			gpt3_2b_stage_2_batch_3_layer_13_norm1 -> gpt3_2b_stage_2_batch_3_layer_13_qkv
			gpt3_2b_stage_2_batch_3_layer_13_qkv -> gpt3_2b_stage_2_batch_3_layer_13_attn
			gpt3_2b_stage_2_batch_3_layer_13_attn -> gpt3_2b_stage_2_batch_3_layer_13_attn_out
			gpt3_2b_stage_2_batch_3_layer_13_attn_out -> gpt3_2b_stage_2_batch_3_layer_13_attn_res
			gpt3_2b_stage_2_batch_3_layer_13_attn_res -> gpt3_2b_stage_2_batch_3_layer_13_norm2
			gpt3_2b_stage_2_batch_3_layer_13_norm2 -> gpt3_2b_stage_2_batch_3_layer_13_ffn_up
			gpt3_2b_stage_2_batch_3_layer_13_ffn_up -> gpt3_2b_stage_2_batch_3_layer_13_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_13_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_13_ffn_down
			gpt3_2b_stage_2_batch_3_layer_13_ffn_down -> gpt3_2b_stage_2_batch_3_layer_13_ffn_res
			gpt3_2b_stage_2_batch_3_layer_14_norm1 [label="L14 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_qkv [label="L14 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_attn [label="L14 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_attn_out [label="L14 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_attn_res [label="L14 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_norm2 [label="L14 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_ffn_up [label="L14 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_ffn_gate [label="L14 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_ffn_down [label="L14 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_ffn_res [label="L14 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_13_ffn_res -> gpt3_2b_stage_2_batch_3_layer_14_norm1
			gpt3_2b_stage_2_batch_3_layer_14_norm1 -> gpt3_2b_stage_2_batch_3_layer_14_qkv
			gpt3_2b_stage_2_batch_3_layer_14_qkv -> gpt3_2b_stage_2_batch_3_layer_14_attn
			gpt3_2b_stage_2_batch_3_layer_14_attn -> gpt3_2b_stage_2_batch_3_layer_14_attn_out
			gpt3_2b_stage_2_batch_3_layer_14_attn_out -> gpt3_2b_stage_2_batch_3_layer_14_attn_res
			gpt3_2b_stage_2_batch_3_layer_14_attn_res -> gpt3_2b_stage_2_batch_3_layer_14_norm2
			gpt3_2b_stage_2_batch_3_layer_14_norm2 -> gpt3_2b_stage_2_batch_3_layer_14_ffn_up
			gpt3_2b_stage_2_batch_3_layer_14_ffn_up -> gpt3_2b_stage_2_batch_3_layer_14_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_14_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_14_ffn_down
			gpt3_2b_stage_2_batch_3_layer_14_ffn_down -> gpt3_2b_stage_2_batch_3_layer_14_ffn_res
			gpt3_2b_stage_2_batch_3_layer_15_norm1 [label="L15 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_qkv [label="L15 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_attn [label="L15 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_attn_out [label="L15 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_attn_res [label="L15 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_norm2 [label="L15 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_ffn_up [label="L15 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_ffn_gate [label="L15 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_ffn_down [label="L15 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_ffn_res [label="L15 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_14_ffn_res -> gpt3_2b_stage_2_batch_3_layer_15_norm1
			gpt3_2b_stage_2_batch_3_layer_15_norm1 -> gpt3_2b_stage_2_batch_3_layer_15_qkv
			gpt3_2b_stage_2_batch_3_layer_15_qkv -> gpt3_2b_stage_2_batch_3_layer_15_attn
			gpt3_2b_stage_2_batch_3_layer_15_attn -> gpt3_2b_stage_2_batch_3_layer_15_attn_out
			gpt3_2b_stage_2_batch_3_layer_15_attn_out -> gpt3_2b_stage_2_batch_3_layer_15_attn_res
			gpt3_2b_stage_2_batch_3_layer_15_attn_res -> gpt3_2b_stage_2_batch_3_layer_15_norm2
			gpt3_2b_stage_2_batch_3_layer_15_norm2 -> gpt3_2b_stage_2_batch_3_layer_15_ffn_up
			gpt3_2b_stage_2_batch_3_layer_15_ffn_up -> gpt3_2b_stage_2_batch_3_layer_15_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_15_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_15_ffn_down
			gpt3_2b_stage_2_batch_3_layer_15_ffn_down -> gpt3_2b_stage_2_batch_3_layer_15_ffn_res
			gpt3_2b_stage_2_batch_3_layer_16_norm1 [label="L16 Norm1\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_qkv [label="L16 QKV\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_attn [label="L16 Attention\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_attn_out [label="L16 Attn Out\nDevice: GPU_2" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_attn_res [label="L16 Attn+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_norm2 [label="L16 Norm2\nDevice: GPU_2" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_ffn_up [label="L16 FFN Up\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_ffn_gate [label="L16 FFN Gate\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_ffn_down [label="L16 FFN Down\nDevice: GPU_2" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_ffn_res [label="L16 FFN+Res\nDevice: GPU_2" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_2_batch_3_layer_15_ffn_res -> gpt3_2b_stage_2_batch_3_layer_16_norm1
			gpt3_2b_stage_2_batch_3_layer_16_norm1 -> gpt3_2b_stage_2_batch_3_layer_16_qkv
			gpt3_2b_stage_2_batch_3_layer_16_qkv -> gpt3_2b_stage_2_batch_3_layer_16_attn
			gpt3_2b_stage_2_batch_3_layer_16_attn -> gpt3_2b_stage_2_batch_3_layer_16_attn_out
			gpt3_2b_stage_2_batch_3_layer_16_attn_out -> gpt3_2b_stage_2_batch_3_layer_16_attn_res
			gpt3_2b_stage_2_batch_3_layer_16_attn_res -> gpt3_2b_stage_2_batch_3_layer_16_norm2
			gpt3_2b_stage_2_batch_3_layer_16_norm2 -> gpt3_2b_stage_2_batch_3_layer_16_ffn_up
			gpt3_2b_stage_2_batch_3_layer_16_ffn_up -> gpt3_2b_stage_2_batch_3_layer_16_ffn_gate
			gpt3_2b_stage_2_batch_3_layer_16_ffn_gate -> gpt3_2b_stage_2_batch_3_layer_16_ffn_down
			gpt3_2b_stage_2_batch_3_layer_16_ffn_down -> gpt3_2b_stage_2_batch_3_layer_16_ffn_res
			gpt3_2b_stage_2_batch_3_output [label="Stage 2 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_2_batch_3_layer_16_ffn_res -> gpt3_2b_stage_2_batch_3_output
		}
		subgraph cluster_gpt3_2b_stage_3 {
			color=black fillcolor=lightblue label="Stage 3\nGPU_3\nLayers 17-24" style="rounded,filled"
			gpt3_2b_stage_3_batch_1_input [label="Micro-batch 1\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_input -> gpt3_2b_stage_3_batch_1_layer_17_norm1
			gpt3_2b_stage_3_batch_1_layer_17_norm1 -> gpt3_2b_stage_3_batch_1_layer_17_qkv
			gpt3_2b_stage_3_batch_1_layer_17_qkv -> gpt3_2b_stage_3_batch_1_layer_17_attn
			gpt3_2b_stage_3_batch_1_layer_17_attn -> gpt3_2b_stage_3_batch_1_layer_17_attn_out
			gpt3_2b_stage_3_batch_1_layer_17_attn_out -> gpt3_2b_stage_3_batch_1_layer_17_attn_res
			gpt3_2b_stage_3_batch_1_layer_17_attn_res -> gpt3_2b_stage_3_batch_1_layer_17_norm2
			gpt3_2b_stage_3_batch_1_layer_17_norm2 -> gpt3_2b_stage_3_batch_1_layer_17_ffn_up
			gpt3_2b_stage_3_batch_1_layer_17_ffn_up -> gpt3_2b_stage_3_batch_1_layer_17_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_17_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_17_ffn_down
			gpt3_2b_stage_3_batch_1_layer_17_ffn_down -> gpt3_2b_stage_3_batch_1_layer_17_ffn_res
			gpt3_2b_stage_3_batch_1_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_17_ffn_res -> gpt3_2b_stage_3_batch_1_layer_18_norm1
			gpt3_2b_stage_3_batch_1_layer_18_norm1 -> gpt3_2b_stage_3_batch_1_layer_18_qkv
			gpt3_2b_stage_3_batch_1_layer_18_qkv -> gpt3_2b_stage_3_batch_1_layer_18_attn
			gpt3_2b_stage_3_batch_1_layer_18_attn -> gpt3_2b_stage_3_batch_1_layer_18_attn_out
			gpt3_2b_stage_3_batch_1_layer_18_attn_out -> gpt3_2b_stage_3_batch_1_layer_18_attn_res
			gpt3_2b_stage_3_batch_1_layer_18_attn_res -> gpt3_2b_stage_3_batch_1_layer_18_norm2
			gpt3_2b_stage_3_batch_1_layer_18_norm2 -> gpt3_2b_stage_3_batch_1_layer_18_ffn_up
			gpt3_2b_stage_3_batch_1_layer_18_ffn_up -> gpt3_2b_stage_3_batch_1_layer_18_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_18_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_18_ffn_down
			gpt3_2b_stage_3_batch_1_layer_18_ffn_down -> gpt3_2b_stage_3_batch_1_layer_18_ffn_res
			gpt3_2b_stage_3_batch_1_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_18_ffn_res -> gpt3_2b_stage_3_batch_1_layer_19_norm1
			gpt3_2b_stage_3_batch_1_layer_19_norm1 -> gpt3_2b_stage_3_batch_1_layer_19_qkv
			gpt3_2b_stage_3_batch_1_layer_19_qkv -> gpt3_2b_stage_3_batch_1_layer_19_attn
			gpt3_2b_stage_3_batch_1_layer_19_attn -> gpt3_2b_stage_3_batch_1_layer_19_attn_out
			gpt3_2b_stage_3_batch_1_layer_19_attn_out -> gpt3_2b_stage_3_batch_1_layer_19_attn_res
			gpt3_2b_stage_3_batch_1_layer_19_attn_res -> gpt3_2b_stage_3_batch_1_layer_19_norm2
			gpt3_2b_stage_3_batch_1_layer_19_norm2 -> gpt3_2b_stage_3_batch_1_layer_19_ffn_up
			gpt3_2b_stage_3_batch_1_layer_19_ffn_up -> gpt3_2b_stage_3_batch_1_layer_19_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_19_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_19_ffn_down
			gpt3_2b_stage_3_batch_1_layer_19_ffn_down -> gpt3_2b_stage_3_batch_1_layer_19_ffn_res
			gpt3_2b_stage_3_batch_1_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_19_ffn_res -> gpt3_2b_stage_3_batch_1_layer_20_norm1
			gpt3_2b_stage_3_batch_1_layer_20_norm1 -> gpt3_2b_stage_3_batch_1_layer_20_qkv
			gpt3_2b_stage_3_batch_1_layer_20_qkv -> gpt3_2b_stage_3_batch_1_layer_20_attn
			gpt3_2b_stage_3_batch_1_layer_20_attn -> gpt3_2b_stage_3_batch_1_layer_20_attn_out
			gpt3_2b_stage_3_batch_1_layer_20_attn_out -> gpt3_2b_stage_3_batch_1_layer_20_attn_res
			gpt3_2b_stage_3_batch_1_layer_20_attn_res -> gpt3_2b_stage_3_batch_1_layer_20_norm2
			gpt3_2b_stage_3_batch_1_layer_20_norm2 -> gpt3_2b_stage_3_batch_1_layer_20_ffn_up
			gpt3_2b_stage_3_batch_1_layer_20_ffn_up -> gpt3_2b_stage_3_batch_1_layer_20_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_20_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_20_ffn_down
			gpt3_2b_stage_3_batch_1_layer_20_ffn_down -> gpt3_2b_stage_3_batch_1_layer_20_ffn_res
			gpt3_2b_stage_3_batch_1_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_20_ffn_res -> gpt3_2b_stage_3_batch_1_layer_21_norm1
			gpt3_2b_stage_3_batch_1_layer_21_norm1 -> gpt3_2b_stage_3_batch_1_layer_21_qkv
			gpt3_2b_stage_3_batch_1_layer_21_qkv -> gpt3_2b_stage_3_batch_1_layer_21_attn
			gpt3_2b_stage_3_batch_1_layer_21_attn -> gpt3_2b_stage_3_batch_1_layer_21_attn_out
			gpt3_2b_stage_3_batch_1_layer_21_attn_out -> gpt3_2b_stage_3_batch_1_layer_21_attn_res
			gpt3_2b_stage_3_batch_1_layer_21_attn_res -> gpt3_2b_stage_3_batch_1_layer_21_norm2
			gpt3_2b_stage_3_batch_1_layer_21_norm2 -> gpt3_2b_stage_3_batch_1_layer_21_ffn_up
			gpt3_2b_stage_3_batch_1_layer_21_ffn_up -> gpt3_2b_stage_3_batch_1_layer_21_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_21_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_21_ffn_down
			gpt3_2b_stage_3_batch_1_layer_21_ffn_down -> gpt3_2b_stage_3_batch_1_layer_21_ffn_res
			gpt3_2b_stage_3_batch_1_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_21_ffn_res -> gpt3_2b_stage_3_batch_1_layer_22_norm1
			gpt3_2b_stage_3_batch_1_layer_22_norm1 -> gpt3_2b_stage_3_batch_1_layer_22_qkv
			gpt3_2b_stage_3_batch_1_layer_22_qkv -> gpt3_2b_stage_3_batch_1_layer_22_attn
			gpt3_2b_stage_3_batch_1_layer_22_attn -> gpt3_2b_stage_3_batch_1_layer_22_attn_out
			gpt3_2b_stage_3_batch_1_layer_22_attn_out -> gpt3_2b_stage_3_batch_1_layer_22_attn_res
			gpt3_2b_stage_3_batch_1_layer_22_attn_res -> gpt3_2b_stage_3_batch_1_layer_22_norm2
			gpt3_2b_stage_3_batch_1_layer_22_norm2 -> gpt3_2b_stage_3_batch_1_layer_22_ffn_up
			gpt3_2b_stage_3_batch_1_layer_22_ffn_up -> gpt3_2b_stage_3_batch_1_layer_22_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_22_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_22_ffn_down
			gpt3_2b_stage_3_batch_1_layer_22_ffn_down -> gpt3_2b_stage_3_batch_1_layer_22_ffn_res
			gpt3_2b_stage_3_batch_1_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_22_ffn_res -> gpt3_2b_stage_3_batch_1_layer_23_norm1
			gpt3_2b_stage_3_batch_1_layer_23_norm1 -> gpt3_2b_stage_3_batch_1_layer_23_qkv
			gpt3_2b_stage_3_batch_1_layer_23_qkv -> gpt3_2b_stage_3_batch_1_layer_23_attn
			gpt3_2b_stage_3_batch_1_layer_23_attn -> gpt3_2b_stage_3_batch_1_layer_23_attn_out
			gpt3_2b_stage_3_batch_1_layer_23_attn_out -> gpt3_2b_stage_3_batch_1_layer_23_attn_res
			gpt3_2b_stage_3_batch_1_layer_23_attn_res -> gpt3_2b_stage_3_batch_1_layer_23_norm2
			gpt3_2b_stage_3_batch_1_layer_23_norm2 -> gpt3_2b_stage_3_batch_1_layer_23_ffn_up
			gpt3_2b_stage_3_batch_1_layer_23_ffn_up -> gpt3_2b_stage_3_batch_1_layer_23_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_23_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_23_ffn_down
			gpt3_2b_stage_3_batch_1_layer_23_ffn_down -> gpt3_2b_stage_3_batch_1_layer_23_ffn_res
			gpt3_2b_stage_3_batch_1_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_1_layer_23_ffn_res -> gpt3_2b_stage_3_batch_1_layer_24_norm1
			gpt3_2b_stage_3_batch_1_layer_24_norm1 -> gpt3_2b_stage_3_batch_1_layer_24_qkv
			gpt3_2b_stage_3_batch_1_layer_24_qkv -> gpt3_2b_stage_3_batch_1_layer_24_attn
			gpt3_2b_stage_3_batch_1_layer_24_attn -> gpt3_2b_stage_3_batch_1_layer_24_attn_out
			gpt3_2b_stage_3_batch_1_layer_24_attn_out -> gpt3_2b_stage_3_batch_1_layer_24_attn_res
			gpt3_2b_stage_3_batch_1_layer_24_attn_res -> gpt3_2b_stage_3_batch_1_layer_24_norm2
			gpt3_2b_stage_3_batch_1_layer_24_norm2 -> gpt3_2b_stage_3_batch_1_layer_24_ffn_up
			gpt3_2b_stage_3_batch_1_layer_24_ffn_up -> gpt3_2b_stage_3_batch_1_layer_24_ffn_gate
			gpt3_2b_stage_3_batch_1_layer_24_ffn_gate -> gpt3_2b_stage_3_batch_1_layer_24_ffn_down
			gpt3_2b_stage_3_batch_1_layer_24_ffn_down -> gpt3_2b_stage_3_batch_1_layer_24_ffn_res
			gpt3_2b_stage_3_batch_1_output [label="Stage 3 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_1_layer_24_ffn_res -> gpt3_2b_stage_3_batch_1_output
			gpt3_2b_stage_3_batch_2_input [label="Micro-batch 2\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_input -> gpt3_2b_stage_3_batch_2_layer_17_norm1
			gpt3_2b_stage_3_batch_2_layer_17_norm1 -> gpt3_2b_stage_3_batch_2_layer_17_qkv
			gpt3_2b_stage_3_batch_2_layer_17_qkv -> gpt3_2b_stage_3_batch_2_layer_17_attn
			gpt3_2b_stage_3_batch_2_layer_17_attn -> gpt3_2b_stage_3_batch_2_layer_17_attn_out
			gpt3_2b_stage_3_batch_2_layer_17_attn_out -> gpt3_2b_stage_3_batch_2_layer_17_attn_res
			gpt3_2b_stage_3_batch_2_layer_17_attn_res -> gpt3_2b_stage_3_batch_2_layer_17_norm2
			gpt3_2b_stage_3_batch_2_layer_17_norm2 -> gpt3_2b_stage_3_batch_2_layer_17_ffn_up
			gpt3_2b_stage_3_batch_2_layer_17_ffn_up -> gpt3_2b_stage_3_batch_2_layer_17_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_17_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_17_ffn_down
			gpt3_2b_stage_3_batch_2_layer_17_ffn_down -> gpt3_2b_stage_3_batch_2_layer_17_ffn_res
			gpt3_2b_stage_3_batch_2_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_17_ffn_res -> gpt3_2b_stage_3_batch_2_layer_18_norm1
			gpt3_2b_stage_3_batch_2_layer_18_norm1 -> gpt3_2b_stage_3_batch_2_layer_18_qkv
			gpt3_2b_stage_3_batch_2_layer_18_qkv -> gpt3_2b_stage_3_batch_2_layer_18_attn
			gpt3_2b_stage_3_batch_2_layer_18_attn -> gpt3_2b_stage_3_batch_2_layer_18_attn_out
			gpt3_2b_stage_3_batch_2_layer_18_attn_out -> gpt3_2b_stage_3_batch_2_layer_18_attn_res
			gpt3_2b_stage_3_batch_2_layer_18_attn_res -> gpt3_2b_stage_3_batch_2_layer_18_norm2
			gpt3_2b_stage_3_batch_2_layer_18_norm2 -> gpt3_2b_stage_3_batch_2_layer_18_ffn_up
			gpt3_2b_stage_3_batch_2_layer_18_ffn_up -> gpt3_2b_stage_3_batch_2_layer_18_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_18_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_18_ffn_down
			gpt3_2b_stage_3_batch_2_layer_18_ffn_down -> gpt3_2b_stage_3_batch_2_layer_18_ffn_res
			gpt3_2b_stage_3_batch_2_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_18_ffn_res -> gpt3_2b_stage_3_batch_2_layer_19_norm1
			gpt3_2b_stage_3_batch_2_layer_19_norm1 -> gpt3_2b_stage_3_batch_2_layer_19_qkv
			gpt3_2b_stage_3_batch_2_layer_19_qkv -> gpt3_2b_stage_3_batch_2_layer_19_attn
			gpt3_2b_stage_3_batch_2_layer_19_attn -> gpt3_2b_stage_3_batch_2_layer_19_attn_out
			gpt3_2b_stage_3_batch_2_layer_19_attn_out -> gpt3_2b_stage_3_batch_2_layer_19_attn_res
			gpt3_2b_stage_3_batch_2_layer_19_attn_res -> gpt3_2b_stage_3_batch_2_layer_19_norm2
			gpt3_2b_stage_3_batch_2_layer_19_norm2 -> gpt3_2b_stage_3_batch_2_layer_19_ffn_up
			gpt3_2b_stage_3_batch_2_layer_19_ffn_up -> gpt3_2b_stage_3_batch_2_layer_19_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_19_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_19_ffn_down
			gpt3_2b_stage_3_batch_2_layer_19_ffn_down -> gpt3_2b_stage_3_batch_2_layer_19_ffn_res
			gpt3_2b_stage_3_batch_2_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_19_ffn_res -> gpt3_2b_stage_3_batch_2_layer_20_norm1
			gpt3_2b_stage_3_batch_2_layer_20_norm1 -> gpt3_2b_stage_3_batch_2_layer_20_qkv
			gpt3_2b_stage_3_batch_2_layer_20_qkv -> gpt3_2b_stage_3_batch_2_layer_20_attn
			gpt3_2b_stage_3_batch_2_layer_20_attn -> gpt3_2b_stage_3_batch_2_layer_20_attn_out
			gpt3_2b_stage_3_batch_2_layer_20_attn_out -> gpt3_2b_stage_3_batch_2_layer_20_attn_res
			gpt3_2b_stage_3_batch_2_layer_20_attn_res -> gpt3_2b_stage_3_batch_2_layer_20_norm2
			gpt3_2b_stage_3_batch_2_layer_20_norm2 -> gpt3_2b_stage_3_batch_2_layer_20_ffn_up
			gpt3_2b_stage_3_batch_2_layer_20_ffn_up -> gpt3_2b_stage_3_batch_2_layer_20_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_20_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_20_ffn_down
			gpt3_2b_stage_3_batch_2_layer_20_ffn_down -> gpt3_2b_stage_3_batch_2_layer_20_ffn_res
			gpt3_2b_stage_3_batch_2_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_20_ffn_res -> gpt3_2b_stage_3_batch_2_layer_21_norm1
			gpt3_2b_stage_3_batch_2_layer_21_norm1 -> gpt3_2b_stage_3_batch_2_layer_21_qkv
			gpt3_2b_stage_3_batch_2_layer_21_qkv -> gpt3_2b_stage_3_batch_2_layer_21_attn
			gpt3_2b_stage_3_batch_2_layer_21_attn -> gpt3_2b_stage_3_batch_2_layer_21_attn_out
			gpt3_2b_stage_3_batch_2_layer_21_attn_out -> gpt3_2b_stage_3_batch_2_layer_21_attn_res
			gpt3_2b_stage_3_batch_2_layer_21_attn_res -> gpt3_2b_stage_3_batch_2_layer_21_norm2
			gpt3_2b_stage_3_batch_2_layer_21_norm2 -> gpt3_2b_stage_3_batch_2_layer_21_ffn_up
			gpt3_2b_stage_3_batch_2_layer_21_ffn_up -> gpt3_2b_stage_3_batch_2_layer_21_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_21_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_21_ffn_down
			gpt3_2b_stage_3_batch_2_layer_21_ffn_down -> gpt3_2b_stage_3_batch_2_layer_21_ffn_res
			gpt3_2b_stage_3_batch_2_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_21_ffn_res -> gpt3_2b_stage_3_batch_2_layer_22_norm1
			gpt3_2b_stage_3_batch_2_layer_22_norm1 -> gpt3_2b_stage_3_batch_2_layer_22_qkv
			gpt3_2b_stage_3_batch_2_layer_22_qkv -> gpt3_2b_stage_3_batch_2_layer_22_attn
			gpt3_2b_stage_3_batch_2_layer_22_attn -> gpt3_2b_stage_3_batch_2_layer_22_attn_out
			gpt3_2b_stage_3_batch_2_layer_22_attn_out -> gpt3_2b_stage_3_batch_2_layer_22_attn_res
			gpt3_2b_stage_3_batch_2_layer_22_attn_res -> gpt3_2b_stage_3_batch_2_layer_22_norm2
			gpt3_2b_stage_3_batch_2_layer_22_norm2 -> gpt3_2b_stage_3_batch_2_layer_22_ffn_up
			gpt3_2b_stage_3_batch_2_layer_22_ffn_up -> gpt3_2b_stage_3_batch_2_layer_22_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_22_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_22_ffn_down
			gpt3_2b_stage_3_batch_2_layer_22_ffn_down -> gpt3_2b_stage_3_batch_2_layer_22_ffn_res
			gpt3_2b_stage_3_batch_2_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_22_ffn_res -> gpt3_2b_stage_3_batch_2_layer_23_norm1
			gpt3_2b_stage_3_batch_2_layer_23_norm1 -> gpt3_2b_stage_3_batch_2_layer_23_qkv
			gpt3_2b_stage_3_batch_2_layer_23_qkv -> gpt3_2b_stage_3_batch_2_layer_23_attn
			gpt3_2b_stage_3_batch_2_layer_23_attn -> gpt3_2b_stage_3_batch_2_layer_23_attn_out
			gpt3_2b_stage_3_batch_2_layer_23_attn_out -> gpt3_2b_stage_3_batch_2_layer_23_attn_res
			gpt3_2b_stage_3_batch_2_layer_23_attn_res -> gpt3_2b_stage_3_batch_2_layer_23_norm2
			gpt3_2b_stage_3_batch_2_layer_23_norm2 -> gpt3_2b_stage_3_batch_2_layer_23_ffn_up
			gpt3_2b_stage_3_batch_2_layer_23_ffn_up -> gpt3_2b_stage_3_batch_2_layer_23_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_23_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_23_ffn_down
			gpt3_2b_stage_3_batch_2_layer_23_ffn_down -> gpt3_2b_stage_3_batch_2_layer_23_ffn_res
			gpt3_2b_stage_3_batch_2_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_2_layer_23_ffn_res -> gpt3_2b_stage_3_batch_2_layer_24_norm1
			gpt3_2b_stage_3_batch_2_layer_24_norm1 -> gpt3_2b_stage_3_batch_2_layer_24_qkv
			gpt3_2b_stage_3_batch_2_layer_24_qkv -> gpt3_2b_stage_3_batch_2_layer_24_attn
			gpt3_2b_stage_3_batch_2_layer_24_attn -> gpt3_2b_stage_3_batch_2_layer_24_attn_out
			gpt3_2b_stage_3_batch_2_layer_24_attn_out -> gpt3_2b_stage_3_batch_2_layer_24_attn_res
			gpt3_2b_stage_3_batch_2_layer_24_attn_res -> gpt3_2b_stage_3_batch_2_layer_24_norm2
			gpt3_2b_stage_3_batch_2_layer_24_norm2 -> gpt3_2b_stage_3_batch_2_layer_24_ffn_up
			gpt3_2b_stage_3_batch_2_layer_24_ffn_up -> gpt3_2b_stage_3_batch_2_layer_24_ffn_gate
			gpt3_2b_stage_3_batch_2_layer_24_ffn_gate -> gpt3_2b_stage_3_batch_2_layer_24_ffn_down
			gpt3_2b_stage_3_batch_2_layer_24_ffn_down -> gpt3_2b_stage_3_batch_2_layer_24_ffn_res
			gpt3_2b_stage_3_batch_2_output [label="Stage 3 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_2_layer_24_ffn_res -> gpt3_2b_stage_3_batch_2_output
			gpt3_2b_stage_3_batch_3_input [label="Micro-batch 3\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_norm1 [label="L17 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_qkv [label="L17 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_attn [label="L17 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_attn_out [label="L17 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_attn_res [label="L17 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_norm2 [label="L17 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_ffn_up [label="L17 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_ffn_gate [label="L17 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_ffn_down [label="L17 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_ffn_res [label="L17 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_input -> gpt3_2b_stage_3_batch_3_layer_17_norm1
			gpt3_2b_stage_3_batch_3_layer_17_norm1 -> gpt3_2b_stage_3_batch_3_layer_17_qkv
			gpt3_2b_stage_3_batch_3_layer_17_qkv -> gpt3_2b_stage_3_batch_3_layer_17_attn
			gpt3_2b_stage_3_batch_3_layer_17_attn -> gpt3_2b_stage_3_batch_3_layer_17_attn_out
			gpt3_2b_stage_3_batch_3_layer_17_attn_out -> gpt3_2b_stage_3_batch_3_layer_17_attn_res
			gpt3_2b_stage_3_batch_3_layer_17_attn_res -> gpt3_2b_stage_3_batch_3_layer_17_norm2
			gpt3_2b_stage_3_batch_3_layer_17_norm2 -> gpt3_2b_stage_3_batch_3_layer_17_ffn_up
			gpt3_2b_stage_3_batch_3_layer_17_ffn_up -> gpt3_2b_stage_3_batch_3_layer_17_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_17_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_17_ffn_down
			gpt3_2b_stage_3_batch_3_layer_17_ffn_down -> gpt3_2b_stage_3_batch_3_layer_17_ffn_res
			gpt3_2b_stage_3_batch_3_layer_18_norm1 [label="L18 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_qkv [label="L18 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_attn [label="L18 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_attn_out [label="L18 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_attn_res [label="L18 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_norm2 [label="L18 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_ffn_up [label="L18 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_ffn_gate [label="L18 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_ffn_down [label="L18 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_ffn_res [label="L18 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_17_ffn_res -> gpt3_2b_stage_3_batch_3_layer_18_norm1
			gpt3_2b_stage_3_batch_3_layer_18_norm1 -> gpt3_2b_stage_3_batch_3_layer_18_qkv
			gpt3_2b_stage_3_batch_3_layer_18_qkv -> gpt3_2b_stage_3_batch_3_layer_18_attn
			gpt3_2b_stage_3_batch_3_layer_18_attn -> gpt3_2b_stage_3_batch_3_layer_18_attn_out
			gpt3_2b_stage_3_batch_3_layer_18_attn_out -> gpt3_2b_stage_3_batch_3_layer_18_attn_res
			gpt3_2b_stage_3_batch_3_layer_18_attn_res -> gpt3_2b_stage_3_batch_3_layer_18_norm2
			gpt3_2b_stage_3_batch_3_layer_18_norm2 -> gpt3_2b_stage_3_batch_3_layer_18_ffn_up
			gpt3_2b_stage_3_batch_3_layer_18_ffn_up -> gpt3_2b_stage_3_batch_3_layer_18_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_18_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_18_ffn_down
			gpt3_2b_stage_3_batch_3_layer_18_ffn_down -> gpt3_2b_stage_3_batch_3_layer_18_ffn_res
			gpt3_2b_stage_3_batch_3_layer_19_norm1 [label="L19 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_qkv [label="L19 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_attn [label="L19 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_attn_out [label="L19 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_attn_res [label="L19 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_norm2 [label="L19 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_ffn_up [label="L19 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_ffn_gate [label="L19 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_ffn_down [label="L19 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_ffn_res [label="L19 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_18_ffn_res -> gpt3_2b_stage_3_batch_3_layer_19_norm1
			gpt3_2b_stage_3_batch_3_layer_19_norm1 -> gpt3_2b_stage_3_batch_3_layer_19_qkv
			gpt3_2b_stage_3_batch_3_layer_19_qkv -> gpt3_2b_stage_3_batch_3_layer_19_attn
			gpt3_2b_stage_3_batch_3_layer_19_attn -> gpt3_2b_stage_3_batch_3_layer_19_attn_out
			gpt3_2b_stage_3_batch_3_layer_19_attn_out -> gpt3_2b_stage_3_batch_3_layer_19_attn_res
			gpt3_2b_stage_3_batch_3_layer_19_attn_res -> gpt3_2b_stage_3_batch_3_layer_19_norm2
			gpt3_2b_stage_3_batch_3_layer_19_norm2 -> gpt3_2b_stage_3_batch_3_layer_19_ffn_up
			gpt3_2b_stage_3_batch_3_layer_19_ffn_up -> gpt3_2b_stage_3_batch_3_layer_19_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_19_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_19_ffn_down
			gpt3_2b_stage_3_batch_3_layer_19_ffn_down -> gpt3_2b_stage_3_batch_3_layer_19_ffn_res
			gpt3_2b_stage_3_batch_3_layer_20_norm1 [label="L20 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_qkv [label="L20 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_attn [label="L20 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_attn_out [label="L20 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_attn_res [label="L20 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_norm2 [label="L20 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_ffn_up [label="L20 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_ffn_gate [label="L20 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_ffn_down [label="L20 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_ffn_res [label="L20 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_19_ffn_res -> gpt3_2b_stage_3_batch_3_layer_20_norm1
			gpt3_2b_stage_3_batch_3_layer_20_norm1 -> gpt3_2b_stage_3_batch_3_layer_20_qkv
			gpt3_2b_stage_3_batch_3_layer_20_qkv -> gpt3_2b_stage_3_batch_3_layer_20_attn
			gpt3_2b_stage_3_batch_3_layer_20_attn -> gpt3_2b_stage_3_batch_3_layer_20_attn_out
			gpt3_2b_stage_3_batch_3_layer_20_attn_out -> gpt3_2b_stage_3_batch_3_layer_20_attn_res
			gpt3_2b_stage_3_batch_3_layer_20_attn_res -> gpt3_2b_stage_3_batch_3_layer_20_norm2
			gpt3_2b_stage_3_batch_3_layer_20_norm2 -> gpt3_2b_stage_3_batch_3_layer_20_ffn_up
			gpt3_2b_stage_3_batch_3_layer_20_ffn_up -> gpt3_2b_stage_3_batch_3_layer_20_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_20_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_20_ffn_down
			gpt3_2b_stage_3_batch_3_layer_20_ffn_down -> gpt3_2b_stage_3_batch_3_layer_20_ffn_res
			gpt3_2b_stage_3_batch_3_layer_21_norm1 [label="L21 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_qkv [label="L21 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_attn [label="L21 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_attn_out [label="L21 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_attn_res [label="L21 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_norm2 [label="L21 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_ffn_up [label="L21 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_ffn_gate [label="L21 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_ffn_down [label="L21 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_ffn_res [label="L21 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_20_ffn_res -> gpt3_2b_stage_3_batch_3_layer_21_norm1
			gpt3_2b_stage_3_batch_3_layer_21_norm1 -> gpt3_2b_stage_3_batch_3_layer_21_qkv
			gpt3_2b_stage_3_batch_3_layer_21_qkv -> gpt3_2b_stage_3_batch_3_layer_21_attn
			gpt3_2b_stage_3_batch_3_layer_21_attn -> gpt3_2b_stage_3_batch_3_layer_21_attn_out
			gpt3_2b_stage_3_batch_3_layer_21_attn_out -> gpt3_2b_stage_3_batch_3_layer_21_attn_res
			gpt3_2b_stage_3_batch_3_layer_21_attn_res -> gpt3_2b_stage_3_batch_3_layer_21_norm2
			gpt3_2b_stage_3_batch_3_layer_21_norm2 -> gpt3_2b_stage_3_batch_3_layer_21_ffn_up
			gpt3_2b_stage_3_batch_3_layer_21_ffn_up -> gpt3_2b_stage_3_batch_3_layer_21_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_21_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_21_ffn_down
			gpt3_2b_stage_3_batch_3_layer_21_ffn_down -> gpt3_2b_stage_3_batch_3_layer_21_ffn_res
			gpt3_2b_stage_3_batch_3_layer_22_norm1 [label="L22 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_qkv [label="L22 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_attn [label="L22 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_attn_out [label="L22 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_attn_res [label="L22 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_norm2 [label="L22 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_ffn_up [label="L22 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_ffn_gate [label="L22 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_ffn_down [label="L22 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_ffn_res [label="L22 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_21_ffn_res -> gpt3_2b_stage_3_batch_3_layer_22_norm1
			gpt3_2b_stage_3_batch_3_layer_22_norm1 -> gpt3_2b_stage_3_batch_3_layer_22_qkv
			gpt3_2b_stage_3_batch_3_layer_22_qkv -> gpt3_2b_stage_3_batch_3_layer_22_attn
			gpt3_2b_stage_3_batch_3_layer_22_attn -> gpt3_2b_stage_3_batch_3_layer_22_attn_out
			gpt3_2b_stage_3_batch_3_layer_22_attn_out -> gpt3_2b_stage_3_batch_3_layer_22_attn_res
			gpt3_2b_stage_3_batch_3_layer_22_attn_res -> gpt3_2b_stage_3_batch_3_layer_22_norm2
			gpt3_2b_stage_3_batch_3_layer_22_norm2 -> gpt3_2b_stage_3_batch_3_layer_22_ffn_up
			gpt3_2b_stage_3_batch_3_layer_22_ffn_up -> gpt3_2b_stage_3_batch_3_layer_22_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_22_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_22_ffn_down
			gpt3_2b_stage_3_batch_3_layer_22_ffn_down -> gpt3_2b_stage_3_batch_3_layer_22_ffn_res
			gpt3_2b_stage_3_batch_3_layer_23_norm1 [label="L23 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_qkv [label="L23 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_attn [label="L23 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_attn_out [label="L23 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_attn_res [label="L23 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_norm2 [label="L23 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_ffn_up [label="L23 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_ffn_gate [label="L23 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_ffn_down [label="L23 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_ffn_res [label="L23 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_22_ffn_res -> gpt3_2b_stage_3_batch_3_layer_23_norm1
			gpt3_2b_stage_3_batch_3_layer_23_norm1 -> gpt3_2b_stage_3_batch_3_layer_23_qkv
			gpt3_2b_stage_3_batch_3_layer_23_qkv -> gpt3_2b_stage_3_batch_3_layer_23_attn
			gpt3_2b_stage_3_batch_3_layer_23_attn -> gpt3_2b_stage_3_batch_3_layer_23_attn_out
			gpt3_2b_stage_3_batch_3_layer_23_attn_out -> gpt3_2b_stage_3_batch_3_layer_23_attn_res
			gpt3_2b_stage_3_batch_3_layer_23_attn_res -> gpt3_2b_stage_3_batch_3_layer_23_norm2
			gpt3_2b_stage_3_batch_3_layer_23_norm2 -> gpt3_2b_stage_3_batch_3_layer_23_ffn_up
			gpt3_2b_stage_3_batch_3_layer_23_ffn_up -> gpt3_2b_stage_3_batch_3_layer_23_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_23_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_23_ffn_down
			gpt3_2b_stage_3_batch_3_layer_23_ffn_down -> gpt3_2b_stage_3_batch_3_layer_23_ffn_res
			gpt3_2b_stage_3_batch_3_layer_24_norm1 [label="L24 Norm1\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_qkv [label="L24 QKV\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_attn [label="L24 Attention\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_attn_out [label="L24 Attn Out\nDevice: GPU_3" fillcolor=lightcoral shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_attn_res [label="L24 Attn+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_norm2 [label="L24 Norm2\nDevice: GPU_3" fillcolor=lightgray shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_ffn_up [label="L24 FFN Up\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_ffn_gate [label="L24 FFN Gate\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_ffn_down [label="L24 FFN Down\nDevice: GPU_3" fillcolor=lightcyan shape=rectangle style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_ffn_res [label="L24 FFN+Res\nDevice: GPU_3" fillcolor=lightyellow shape=parallelogram style=filled]
			gpt3_2b_stage_3_batch_3_layer_23_ffn_res -> gpt3_2b_stage_3_batch_3_layer_24_norm1
			gpt3_2b_stage_3_batch_3_layer_24_norm1 -> gpt3_2b_stage_3_batch_3_layer_24_qkv
			gpt3_2b_stage_3_batch_3_layer_24_qkv -> gpt3_2b_stage_3_batch_3_layer_24_attn
			gpt3_2b_stage_3_batch_3_layer_24_attn -> gpt3_2b_stage_3_batch_3_layer_24_attn_out
			gpt3_2b_stage_3_batch_3_layer_24_attn_out -> gpt3_2b_stage_3_batch_3_layer_24_attn_res
			gpt3_2b_stage_3_batch_3_layer_24_attn_res -> gpt3_2b_stage_3_batch_3_layer_24_norm2
			gpt3_2b_stage_3_batch_3_layer_24_norm2 -> gpt3_2b_stage_3_batch_3_layer_24_ffn_up
			gpt3_2b_stage_3_batch_3_layer_24_ffn_up -> gpt3_2b_stage_3_batch_3_layer_24_ffn_gate
			gpt3_2b_stage_3_batch_3_layer_24_ffn_gate -> gpt3_2b_stage_3_batch_3_layer_24_ffn_down
			gpt3_2b_stage_3_batch_3_layer_24_ffn_down -> gpt3_2b_stage_3_batch_3_layer_24_ffn_res
			gpt3_2b_stage_3_batch_3_output [label="Stage 3 Output\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightgreen shape=ellipse style=filled]
			gpt3_2b_stage_3_batch_3_layer_24_ffn_res -> gpt3_2b_stage_3_batch_3_output
		}
		gpt3_2b_comm_stage_1_to_2_batch_1 [label="Communication\nStage 1  2\nBatch 1\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_1_batch_1_output -> gpt3_2b_comm_stage_1_to_2_batch_1
		gpt3_2b_comm_stage_1_to_2_batch_1 -> gpt3_2b_stage_2_batch_1_input
		gpt3_2b_comm_stage_1_to_2_batch_2 [label="Communication\nStage 1  2\nBatch 2\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_1_batch_2_output -> gpt3_2b_comm_stage_1_to_2_batch_2
		gpt3_2b_comm_stage_1_to_2_batch_2 -> gpt3_2b_stage_2_batch_2_input
		gpt3_2b_comm_stage_1_to_2_batch_3 [label="Communication\nStage 1  2\nBatch 3\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_1_batch_3_output -> gpt3_2b_comm_stage_1_to_2_batch_3
		gpt3_2b_comm_stage_1_to_2_batch_3 -> gpt3_2b_stage_2_batch_3_input
		gpt3_2b_comm_stage_2_to_3_batch_1 [label="Communication\nStage 2  3\nBatch 1\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_2_batch_1_output -> gpt3_2b_comm_stage_2_to_3_batch_1
		gpt3_2b_comm_stage_2_to_3_batch_1 -> gpt3_2b_stage_3_batch_1_input
		gpt3_2b_comm_stage_2_to_3_batch_2 [label="Communication\nStage 2  3\nBatch 2\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_2_batch_2_output -> gpt3_2b_comm_stage_2_to_3_batch_2
		gpt3_2b_comm_stage_2_to_3_batch_2 -> gpt3_2b_stage_3_batch_2_input
		gpt3_2b_comm_stage_2_to_3_batch_3 [label="Communication\nStage 2  3\nBatch 3\n[batch=4, seq=2048, hidden=2048]" fillcolor=lightyellow shape=ellipse style="dashed,filled"]
		gpt3_2b_stage_2_batch_3_output -> gpt3_2b_comm_stage_2_to_3_batch_3
		gpt3_2b_comm_stage_2_to_3_batch_3 -> gpt3_2b_stage_3_batch_3_input
		gpt3_2b_gpipe_input [label="Model Input\nGPT3_2B\n[batch=12, seq=2048, vocab=50257]" fillcolor=orange shape=ellipse style=filled]
		gpt3_2b_gpipe_output [label="Model Output\nGPT3_2B\n[batch=12, seq=2048, vocab=50257]" fillcolor=orange shape=doubleoctagon style=filled]
		gpt3_2b_gpipe_input -> gpt3_2b_stage_1_batch_1_input
		gpt3_2b_stage_3_batch_1_output -> gpt3_2b_gpipe_output
		gpt3_2b_gpipe_input -> gpt3_2b_stage_1_batch_2_input
		gpt3_2b_stage_3_batch_2_output -> gpt3_2b_gpipe_output
		gpt3_2b_gpipe_input -> gpt3_2b_stage_1_batch_3_input
		gpt3_2b_stage_3_batch_3_output -> gpt3_2b_gpipe_output
	}
}
