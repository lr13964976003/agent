<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="6518pt" height="32632pt"
 viewBox="0.00 0.00 6518.19 32632.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 32628.49)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-32628.49 6514.19,-32628.49 6514.19,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="4045.69" cy="-32587.01" rx="318.4" ry="37.45"/>
<text text-anchor="middle" x="4045.69" y="-32598.31" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4045.69" y="-32583.31" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-32568.31" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_input -->
<g id="node2" class="node">
<title>stage0_input</title>
<polygon fill="none" stroke="black" points="4512.27,-32513.53 3770.05,-32513.53 3579.11,-32377.53 4321.33,-32377.53 4512.27,-32513.53"/>
<text text-anchor="middle" x="4045.69" y="-32464.33" font-family="Times,serif" font-size="14.00">Stage 0 Input Router</text>
<text text-anchor="middle" x="4045.69" y="-32449.33" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="4045.69" y="-32434.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-32419.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;stage0_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;stage0_input</title>
<path fill="none" stroke="black" d="M4045.69,-32549.36C4045.69,-32541.39 4045.69,-32532.66 4045.69,-32523.77"/>
<polygon fill="black" stroke="black" points="4049.19,-32523.69 4045.69,-32513.69 4042.19,-32523.69 4049.19,-32523.69"/>
</g>
<!-- stage0_layer0_ln -->
<g id="node3" class="node">
<title>stage0_layer0_ln</title>
<polygon fill="none" stroke="black" points="4270.69,-32341.53 3820.69,-32341.53 3820.69,-32273.53 4270.69,-32273.53 4270.69,-32341.53"/>
<text text-anchor="middle" x="4045.69" y="-32326.33" font-family="Times,serif" font-size="14.00">Layer 0 LayerNorm</text>
<text text-anchor="middle" x="4045.69" y="-32311.33" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="4045.69" y="-32296.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-32281.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_input&#45;&gt;stage0_layer0_ln -->
<g id="edge2" class="edge">
<title>stage0_input&#45;&gt;stage0_layer0_ln</title>
<path fill="none" stroke="black" d="M4045.69,-32377.33C4045.69,-32368.58 4045.69,-32359.81 4045.69,-32351.6"/>
<polygon fill="black" stroke="black" points="4049.19,-32351.55 4045.69,-32341.55 4042.19,-32351.55 4049.19,-32351.55"/>
</g>
<!-- stage0_layer0_attn_qkv -->
<g id="node4" class="node">
<title>stage0_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4277.19,-32237.53 3814.19,-32237.53 3814.19,-32169.53 4277.19,-32169.53 4277.19,-32237.53"/>
<text text-anchor="middle" x="4045.69" y="-32222.33" font-family="Times,serif" font-size="14.00">Layer 0 Attention QKV Projection</text>
<text text-anchor="middle" x="4045.69" y="-32207.33" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP: GPU 0&#45;127)</text>
<text text-anchor="middle" x="4045.69" y="-32192.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-32177.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage0_layer0_ln&#45;&gt;stage0_layer0_attn_qkv -->
<g id="edge3" class="edge">
<title>stage0_layer0_ln&#45;&gt;stage0_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M4045.69,-32273.42C4045.69,-32265.31 4045.69,-32256.52 4045.69,-32248.01"/>
<polygon fill="black" stroke="black" points="4049.19,-32247.83 4045.69,-32237.83 4042.19,-32247.83 4049.19,-32247.83"/>
</g>
<!-- stage0_layer0_tp_qkv_comm -->
<g id="node5" class="node">
<title>stage0_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="4045.69" cy="-32085.45" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="4045.69" y="-32104.25" font-family="Times,serif" font-size="14.00">Layer 0 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="4045.69" y="-32089.25" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP pairs)</text>
<text text-anchor="middle" x="4045.69" y="-32074.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4045.69" y="-32059.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage0_layer0_attn_qkv&#45;&gt;stage0_layer0_tp_qkv_comm -->
<g id="edge4" class="edge">
<title>stage0_layer0_attn_qkv&#45;&gt;stage0_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M4045.69,-32169.27C4045.69,-32161.28 4045.69,-32152.51 4045.69,-32143.77"/>
<polygon fill="black" stroke="black" points="4049.19,-32143.56 4045.69,-32133.56 4042.19,-32143.56 4049.19,-32143.56"/>
</g>
<!-- stage0_layer0_attn_head0 -->
<g id="node6" class="node">
<title>stage0_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1854.19,-32001.37 1581.19,-32001.37 1581.19,-31949.37 1854.19,-31949.37 1854.19,-32001.37"/>
<text text-anchor="middle" x="1717.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 0 Attention</text>
<text text-anchor="middle" x="1717.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 0)</text>
<text text-anchor="middle" x="1717.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1717.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head0 -->
<g id="edge5" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3722.67,-32077.42C3210.05,-32065.39 2231.56,-32038.59 1864.38,-32001.47"/>
<polygon fill="black" stroke="black" points="1864.54,-31997.97 1854.23,-32000.43 1863.82,-32004.93 1864.54,-31997.97"/>
</g>
<!-- stage0_layer0_attn_head1 -->
<g id="node7" class="node">
<title>stage0_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="2145.19,-32001.37 1872.19,-32001.37 1872.19,-31949.37 2145.19,-31949.37 2145.19,-32001.37"/>
<text text-anchor="middle" x="2008.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 1 Attention</text>
<text text-anchor="middle" x="2008.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 1)</text>
<text text-anchor="middle" x="2008.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2008.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head1 -->
<g id="edge6" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3718.73,-32082.66C3343.12,-32077.71 2708.43,-32060.5 2155.41,-32001.5"/>
<polygon fill="black" stroke="black" points="2155.55,-31997.99 2145.23,-32000.41 2154.8,-32004.95 2155.55,-31997.99"/>
</g>
<!-- stage0_layer0_attn_head2 -->
<g id="node8" class="node">
<title>stage0_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2436.19,-32001.37 2163.19,-32001.37 2163.19,-31949.37 2436.19,-31949.37 2436.19,-32001.37"/>
<text text-anchor="middle" x="2299.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 2 Attention</text>
<text text-anchor="middle" x="2299.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 2)</text>
<text text-anchor="middle" x="2299.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2299.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head2 -->
<g id="edge7" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3721.26,-32078.91C3399.63,-32070.79 2892.92,-32050.9 2446.44,-32001.51"/>
<polygon fill="black" stroke="black" points="2446.56,-31998 2436.24,-32000.37 2445.79,-32004.96 2446.56,-31998"/>
</g>
<!-- stage0_layer0_attn_head3 -->
<g id="node9" class="node">
<title>stage0_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2727.19,-32001.37 2454.19,-32001.37 2454.19,-31949.37 2727.19,-31949.37 2727.19,-32001.37"/>
<text text-anchor="middle" x="2590.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 3 Attention</text>
<text text-anchor="middle" x="2590.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 3)</text>
<text text-anchor="middle" x="2590.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2590.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head3 -->
<g id="edge8" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3727.84,-32073.85C3464.62,-32062.8 3080.78,-32041.47 2737.39,-32001.52"/>
<polygon fill="black" stroke="black" points="2737.58,-31998.02 2727.24,-32000.33 2736.77,-32004.97 2737.58,-31998.02"/>
</g>
<!-- stage0_layer0_attn_head4 -->
<g id="node10" class="node">
<title>stage0_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="3018.19,-32001.37 2745.19,-32001.37 2745.19,-31949.37 3018.19,-31949.37 3018.19,-32001.37"/>
<text text-anchor="middle" x="2881.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 4 Attention</text>
<text text-anchor="middle" x="2881.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 4)</text>
<text text-anchor="middle" x="2881.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2881.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head4 -->
<g id="edge9" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3743.43,-32066.91C3543.07,-32053.57 3274.29,-32032.39 3028.46,-32001.55"/>
<polygon fill="black" stroke="black" points="3028.61,-31998.04 3018.25,-32000.26 3027.73,-32004.99 3028.61,-31998.04"/>
</g>
<!-- stage0_layer0_attn_head5 -->
<g id="node11" class="node">
<title>stage0_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3309.19,-32001.37 3036.19,-32001.37 3036.19,-31949.37 3309.19,-31949.37 3309.19,-32001.37"/>
<text text-anchor="middle" x="3172.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 5 Attention</text>
<text text-anchor="middle" x="3172.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 5)</text>
<text text-anchor="middle" x="3172.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3172.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head5 -->
<g id="edge10" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3778.12,-32057.61C3643.28,-32043.17 3477.06,-32023.98 3319.62,-32001.62"/>
<polygon fill="black" stroke="black" points="3319.66,-31998.09 3309.27,-32000.14 3318.67,-32005.02 3319.66,-31998.09"/>
</g>
<!-- stage0_layer0_attn_head6 -->
<g id="node12" class="node">
<title>stage0_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3600.19,-32001.37 3327.19,-32001.37 3327.19,-31949.37 3600.19,-31949.37 3600.19,-32001.37"/>
<text text-anchor="middle" x="3463.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 6 Attention</text>
<text text-anchor="middle" x="3463.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 6)</text>
<text text-anchor="middle" x="3463.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3463.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head6 -->
<g id="edge11" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3845.8,-32047.33C3767.89,-32032.86 3680.29,-32016.59 3608.64,-32003.29"/>
<polygon fill="black" stroke="black" points="3609.1,-31999.81 3598.63,-32001.43 3607.83,-32006.69 3609.1,-31999.81"/>
</g>
<!-- stage0_layer0_attn_head7 -->
<g id="node13" class="node">
<title>stage0_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3891.19,-32001.37 3618.19,-32001.37 3618.19,-31949.37 3891.19,-31949.37 3891.19,-32001.37"/>
<text text-anchor="middle" x="3754.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 7 Attention</text>
<text text-anchor="middle" x="3754.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 7)</text>
<text text-anchor="middle" x="3754.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3754.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head7 -->
<g id="edge12" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3927.33,-32040.49C3895.09,-32028.52 3861.02,-32015.86 3831.74,-32004.98"/>
<polygon fill="black" stroke="black" points="3832.59,-32001.57 3822,-32001.37 3830.15,-32008.13 3832.59,-32001.57"/>
</g>
<!-- stage0_layer0_attn_ellipsis -->
<g id="node14" class="node">
<title>stage0_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4182.19,-32001.37 3909.19,-32001.37 3909.19,-31949.37 4182.19,-31949.37 4182.19,-32001.37"/>
<text text-anchor="middle" x="4045.69" y="-31989.37" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="4045.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="4045.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4045.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_ellipsis -->
<g id="edge13" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M4045.69,-32037.36C4045.69,-32028.81 4045.69,-32020.03 4045.69,-32011.89"/>
<polygon fill="black" stroke="black" points="4049.19,-32011.63 4045.69,-32001.63 4042.19,-32011.63 4049.19,-32011.63"/>
</g>
<!-- stage0_layer0_attn_head24 -->
<g id="node15" class="node">
<title>stage0_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4473.19,-32001.37 4200.19,-32001.37 4200.19,-31949.37 4473.19,-31949.37 4473.19,-32001.37"/>
<text text-anchor="middle" x="4336.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 24 Attention</text>
<text text-anchor="middle" x="4336.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 24)</text>
<text text-anchor="middle" x="4336.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4336.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head24 -->
<g id="edge14" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M4164.05,-32040.49C4196.28,-32028.52 4230.36,-32015.86 4259.64,-32004.98"/>
<polygon fill="black" stroke="black" points="4261.22,-32008.13 4269.38,-32001.37 4258.79,-32001.57 4261.22,-32008.13"/>
</g>
<!-- stage0_layer0_attn_head25 -->
<g id="node16" class="node">
<title>stage0_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4764.19,-32001.37 4491.19,-32001.37 4491.19,-31949.37 4764.19,-31949.37 4764.19,-32001.37"/>
<text text-anchor="middle" x="4627.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 25 Attention</text>
<text text-anchor="middle" x="4627.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 25)</text>
<text text-anchor="middle" x="4627.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4627.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head25 -->
<g id="edge15" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M4245.57,-32047.33C4323.48,-32032.86 4411.09,-32016.59 4482.74,-32003.29"/>
<polygon fill="black" stroke="black" points="4483.55,-32006.69 4492.74,-32001.43 4482.27,-31999.81 4483.55,-32006.69"/>
</g>
<!-- stage0_layer0_attn_head26 -->
<g id="node17" class="node">
<title>stage0_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="5055.19,-32001.37 4782.19,-32001.37 4782.19,-31949.37 5055.19,-31949.37 5055.19,-32001.37"/>
<text text-anchor="middle" x="4918.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 26 Attention</text>
<text text-anchor="middle" x="4918.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 26)</text>
<text text-anchor="middle" x="4918.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4918.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head26 -->
<g id="edge16" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4312.45,-32057.57C4447.31,-32043.08 4613.69,-32023.86 4772.01,-32001.43"/>
<polygon fill="black" stroke="black" points="4772.54,-32004.89 4781.95,-32000.02 4771.55,-31997.96 4772.54,-32004.89"/>
</g>
<!-- stage0_layer0_attn_head27 -->
<g id="node18" class="node">
<title>stage0_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5346.19,-32001.37 5073.19,-32001.37 5073.19,-31949.37 5346.19,-31949.37 5346.19,-32001.37"/>
<text text-anchor="middle" x="5209.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 27 Attention</text>
<text text-anchor="middle" x="5209.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 27)</text>
<text text-anchor="middle" x="5209.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5209.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head27 -->
<g id="edge17" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4347.64,-32066.81C4547.8,-32053.42 4816.31,-32032.23 5062.73,-32001.44"/>
<polygon fill="black" stroke="black" points="5063.48,-32004.87 5072.96,-32000.15 5062.61,-31997.93 5063.48,-32004.87"/>
</g>
<!-- stage0_layer0_attn_head28 -->
<g id="node19" class="node">
<title>stage0_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5637.19,-32001.37 5364.19,-32001.37 5364.19,-31949.37 5637.19,-31949.37 5637.19,-32001.37"/>
<text text-anchor="middle" x="5500.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 28 Attention</text>
<text text-anchor="middle" x="5500.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 28)</text>
<text text-anchor="middle" x="5500.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5500.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head28 -->
<g id="edge18" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4363.28,-32073.74C4626.3,-32062.62 5009.83,-32041.26 5353.81,-32001.41"/>
<polygon fill="black" stroke="black" points="5354.45,-32004.86 5363.97,-32000.23 5353.64,-31997.91 5354.45,-32004.86"/>
</g>
<!-- stage0_layer0_attn_head29 -->
<g id="node20" class="node">
<title>stage0_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5928.19,-32001.37 5655.19,-32001.37 5655.19,-31949.37 5928.19,-31949.37 5928.19,-32001.37"/>
<text text-anchor="middle" x="5791.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 29 Attention</text>
<text text-anchor="middle" x="5791.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 29)</text>
<text text-anchor="middle" x="5791.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5791.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head29 -->
<g id="edge19" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4370.28,-32078.78C4691.72,-32070.56 5197.89,-32050.6 5644.77,-32001.41"/>
<polygon fill="black" stroke="black" points="5645.43,-32004.86 5654.98,-32000.28 5644.66,-31997.9 5645.43,-32004.86"/>
</g>
<!-- stage0_layer0_attn_head30 -->
<g id="node21" class="node">
<title>stage0_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="6219.19,-32001.37 5946.19,-32001.37 5946.19,-31949.37 6219.19,-31949.37 6219.19,-32001.37"/>
<text text-anchor="middle" x="6082.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 30 Attention</text>
<text text-anchor="middle" x="6082.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 30)</text>
<text text-anchor="middle" x="6082.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6082.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head30 -->
<g id="edge20" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4372.89,-32082.53C4748.34,-32077.46 5382.41,-32060.14 5935.8,-32001.4"/>
<polygon fill="black" stroke="black" points="5936.41,-32004.85 5945.98,-32000.31 5935.67,-31997.89 5936.41,-32004.85"/>
</g>
<!-- stage0_layer0_attn_head31 -->
<g id="node22" class="node">
<title>stage0_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6510.19,-32001.37 6237.19,-32001.37 6237.19,-31949.37 6510.19,-31949.37 6510.19,-32001.37"/>
<text text-anchor="middle" x="6373.69" y="-31989.37" font-family="Times,serif" font-size="10.00">Layer 0 Head 31 Attention</text>
<text text-anchor="middle" x="6373.69" y="-31978.37" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 31)</text>
<text text-anchor="middle" x="6373.69" y="-31967.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6373.69" y="-31956.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head31 -->
<g id="edge21" class="edge">
<title>stage0_layer0_tp_qkv_comm&#45;&gt;stage0_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4368.55,-32077.38C4880.93,-32065.28 5858.97,-32038.38 6226.81,-32001.38"/>
<polygon fill="black" stroke="black" points="6227.39,-32004.84 6236.99,-32000.34 6226.68,-31997.87 6227.39,-32004.84"/>
</g>
<!-- stage0_layer0_attn_agg -->
<g id="node23" class="node">
<title>stage0_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4513.34,-31913.37 3769.41,-31913.37 3578.04,-31777.37 4321.97,-31777.37 4513.34,-31913.37"/>
<text text-anchor="middle" x="4045.69" y="-31864.17" font-family="Times,serif" font-size="14.00">Layer 0 Attention Aggregate</text>
<text text-anchor="middle" x="4045.69" y="-31849.17" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="4045.69" y="-31834.17" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4045.69" y="-31819.17" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_attn_head0&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge22" class="edge">
<title>stage0_layer0_attn_head0&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1854.23,-31950.34C1857.07,-31950 1859.9,-31949.67 1862.69,-31949.37 2494.18,-31880.3 3233.43,-31857.52 3669.36,-31850.02"/>
<polygon fill="black" stroke="black" points="3669.67,-31853.52 3679.61,-31849.85 3669.55,-31846.52 3669.67,-31853.52"/>
</g>
<!-- stage0_layer0_attn_head1&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge23" class="edge">
<title>stage0_layer0_attn_head1&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2145.24,-31950.37C2148.08,-31950.02 2150.9,-31949.68 2153.69,-31949.37 2679.99,-31889.87 3292.69,-31864.47 3674.91,-31853.81"/>
<polygon fill="black" stroke="black" points="3675.12,-31857.31 3685.02,-31853.53 3674.93,-31850.31 3675.12,-31857.31"/>
</g>
<!-- stage0_layer0_attn_head2&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge24" class="edge">
<title>stage0_layer0_attn_head2&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2436.24,-31950.41C2439.08,-31950.04 2441.9,-31949.7 2444.69,-31949.37 2867.66,-31899.44 3356.57,-31872.41 3681.72,-31858.73"/>
<polygon fill="black" stroke="black" points="3681.93,-31862.23 3691.77,-31858.31 3681.63,-31855.23 3681.93,-31862.23"/>
</g>
<!-- stage0_layer0_attn_head3&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge25" class="edge">
<title>stage0_layer0_attn_head3&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2727.25,-31950.46C2730.08,-31950.08 2732.9,-31949.72 2735.69,-31949.37 3057.79,-31909.02 3426.56,-31881.71 3690.59,-31865.4"/>
<polygon fill="black" stroke="black" points="3690.96,-31868.88 3700.72,-31864.78 3690.53,-31861.9 3690.96,-31868.88"/>
</g>
<!-- stage0_layer0_attn_head4&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge26" class="edge">
<title>stage0_layer0_attn_head4&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3018.26,-31950.55C3021.09,-31950.14 3023.9,-31949.75 3026.69,-31949.37 3251.59,-31918.65 3505.58,-31892.96 3703.72,-31874.91"/>
<polygon fill="black" stroke="black" points="3704.07,-31878.4 3713.71,-31874.01 3703.43,-31871.42 3704.07,-31878.4"/>
</g>
<!-- stage0_layer0_attn_head5&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge27" class="edge">
<title>stage0_layer0_attn_head5&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3309.28,-31950.7C3312.11,-31950.25 3314.91,-31949.8 3317.69,-31949.37 3450.44,-31928.54 3597.12,-31907.42 3723.83,-31889.77"/>
<polygon fill="black" stroke="black" points="3724.65,-31893.19 3734.08,-31888.35 3723.69,-31886.26 3724.65,-31893.19"/>
</g>
<!-- stage0_layer0_attn_head6&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge28" class="edge">
<title>stage0_layer0_attn_head6&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3577.63,-31949.31C3628.21,-31938.18 3690.29,-31924.53 3752.5,-31910.85"/>
<polygon fill="black" stroke="black" points="3753.47,-31914.22 3762.49,-31908.65 3751.97,-31907.38 3753.47,-31914.22"/>
</g>
<!-- stage0_layer0_attn_head7&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge29" class="edge">
<title>stage0_layer0_attn_head7&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3811.83,-31949.23C3833.01,-31939.92 3858.2,-31928.84 3884.08,-31917.45"/>
<polygon fill="black" stroke="black" points="3885.51,-31920.65 3893.25,-31913.42 3882.69,-31914.24 3885.51,-31920.65"/>
</g>
<!-- stage0_layer0_attn_ellipsis&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge30" class="edge">
<title>stage0_layer0_attn_ellipsis&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4045.69,-31949.08C4045.69,-31941.48 4045.69,-31932.72 4045.69,-31923.58"/>
<polygon fill="black" stroke="black" points="4049.19,-31923.55 4045.69,-31913.55 4042.19,-31923.55 4049.19,-31923.55"/>
</g>
<!-- stage0_layer0_attn_head24&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge31" class="edge">
<title>stage0_layer0_attn_head24&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4279.54,-31949.23C4258.37,-31939.92 4233.18,-31928.84 4207.3,-31917.45"/>
<polygon fill="black" stroke="black" points="4208.69,-31914.24 4198.12,-31913.42 4205.87,-31920.65 4208.69,-31914.24"/>
</g>
<!-- stage0_layer0_attn_head25&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge32" class="edge">
<title>stage0_layer0_attn_head25&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4513.74,-31949.31C4469.03,-31939.47 4415.31,-31927.66 4360.45,-31915.59"/>
<polygon fill="black" stroke="black" points="4361.08,-31912.15 4350.56,-31913.42 4359.58,-31918.98 4361.08,-31912.15"/>
</g>
<!-- stage0_layer0_attn_head26&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge33" class="edge">
<title>stage0_layer0_attn_head26&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4781.93,-31950.83C4778.82,-31950.33 4775.74,-31949.84 4772.69,-31949.37 4690.61,-31936.53 4603.21,-31923.55 4518.51,-31911.34"/>
<polygon fill="black" stroke="black" points="4518.86,-31907.85 4508.46,-31909.89 4517.86,-31914.78 4518.86,-31907.85"/>
</g>
<!-- stage0_layer0_attn_head27&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge34" class="edge">
<title>stage0_layer0_attn_head27&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5072.95,-31950.66C5069.84,-31950.21 5066.75,-31949.78 5063.69,-31949.37 4873.01,-31923.43 4661.43,-31901 4480.77,-31883.75"/>
<polygon fill="black" stroke="black" points="4480.84,-31880.24 4470.56,-31882.78 4480.18,-31887.21 4480.84,-31880.24"/>
</g>
<!-- stage0_layer0_attn_head28&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge35" class="edge">
<title>stage0_layer0_attn_head28&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5363.97,-31950.57C5360.85,-31950.15 5357.75,-31949.75 5354.69,-31949.37 5056.68,-31912.21 4718.74,-31886.02 4460.88,-31869.35"/>
<polygon fill="black" stroke="black" points="4460.79,-31865.83 4450.59,-31868.68 4460.34,-31872.82 4460.79,-31865.83"/>
</g>
<!-- stage0_layer0_attn_head29&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge36" class="edge">
<title>stage0_layer0_attn_head29&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5654.97,-31950.51C5651.85,-31950.11 5648.75,-31949.73 5645.69,-31949.37 5239.71,-31901.68 4772.99,-31874.81 4448.82,-31860.56"/>
<polygon fill="black" stroke="black" points="4448.94,-31857.06 4438.79,-31860.12 4448.63,-31864.06 4448.94,-31857.06"/>
</g>
<!-- stage0_layer0_attn_head30&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge37" class="edge">
<title>stage0_layer0_attn_head30&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5945.98,-31950.47C5942.85,-31950.08 5939.75,-31949.71 5936.69,-31949.37 5421.76,-31891.45 4824.15,-31865.81 4440.82,-31854.65"/>
<polygon fill="black" stroke="black" points="4440.77,-31851.15 4430.67,-31854.36 4440.57,-31858.15 4440.77,-31851.15"/>
</g>
<!-- stage0_layer0_attn_head31&#45;&gt;stage0_layer0_attn_agg -->
<g id="edge38" class="edge">
<title>stage0_layer0_attn_head31&#45;&gt;stage0_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6236.98,-31950.44C6233.86,-31950.06 6230.76,-31949.7 6227.69,-31949.37 5602.76,-31881.37 4872.31,-31858.25 4434.99,-31850.39"/>
<polygon fill="black" stroke="black" points="4434.77,-31846.89 4424.71,-31850.21 4434.65,-31853.89 4434.77,-31846.89"/>
</g>
<!-- stage0_layer0_attn_out -->
<g id="node24" class="node">
<title>stage0_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="4270.69,-31741.37 3820.69,-31741.37 3820.69,-31673.37 4270.69,-31673.37 4270.69,-31741.37"/>
<text text-anchor="middle" x="4045.69" y="-31726.17" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Proj</text>
<text text-anchor="middle" x="4045.69" y="-31711.17" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP: GPU 0&#45;127)</text>
<text text-anchor="middle" x="4045.69" y="-31696.17" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-31681.17" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_attn_agg&#45;&gt;stage0_layer0_attn_out -->
<g id="edge39" class="edge">
<title>stage0_layer0_attn_agg&#45;&gt;stage0_layer0_attn_out</title>
<path fill="none" stroke="black" d="M4045.69,-31777.16C4045.69,-31768.41 4045.69,-31759.64 4045.69,-31751.43"/>
<polygon fill="black" stroke="black" points="4049.19,-31751.38 4045.69,-31741.38 4042.19,-31751.38 4049.19,-31751.38"/>
</g>
<!-- stage0_layer0_tp_attn_comm -->
<g id="node25" class="node">
<title>stage0_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="4045.69" cy="-31589.28" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="4045.69" y="-31608.08" font-family="Times,serif" font-size="14.00">Layer 0 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4045.69" y="-31593.08" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP pairs)</text>
<text text-anchor="middle" x="4045.69" y="-31578.08" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4045.69" y="-31563.08" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_attn_out&#45;&gt;stage0_layer0_tp_attn_comm -->
<g id="edge40" class="edge">
<title>stage0_layer0_attn_out&#45;&gt;stage0_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M4045.69,-31673.1C4045.69,-31665.11 4045.69,-31656.34 4045.69,-31647.6"/>
<polygon fill="black" stroke="black" points="4049.19,-31647.39 4045.69,-31637.39 4042.19,-31647.39 4049.19,-31647.39"/>
</g>
<!-- stage0_layer0_expert_router -->
<g id="node26" class="node">
<title>stage0_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3473.88,-31505.2 2751.36,-31505.2 2565.49,-31369.2 3288.02,-31369.2 3473.88,-31505.2"/>
<text text-anchor="middle" x="3019.69" y="-31456" font-family="Times,serif" font-size="14.00">Layer 0 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3019.69" y="-31441" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3019.69" y="-31426" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3019.69" y="-31411" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage0_layer0_tp_attn_comm&#45;&gt;stage0_layer0_expert_router -->
<g id="edge41" class="edge">
<title>stage0_layer0_tp_attn_comm&#45;&gt;stage0_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3820.21,-31555.3C3720.9,-31540.77 3600.35,-31523.14 3483.27,-31506.01"/>
<polygon fill="black" stroke="black" points="3483.44,-31502.5 3473.04,-31504.52 3482.43,-31509.43 3483.44,-31502.5"/>
</g>
<!-- stage0_layer0_output -->
<g id="node89" class="node">
<title>stage0_layer0_output</title>
<polygon fill="none" stroke="black" points="4057.69,-30590.12 3607.69,-30590.12 3607.69,-30522.12 4057.69,-30522.12 4057.69,-30590.12"/>
<text text-anchor="middle" x="3832.69" y="-30574.92" font-family="Times,serif" font-size="14.00">Layer 0 Output</text>
<text text-anchor="middle" x="3832.69" y="-30559.92" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-30544.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-30529.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_tp_attn_comm&#45;&gt;stage0_layer0_output -->
<!-- stage0_layer0_expert0 -->
<g id="node27" class="node">
<title>stage0_layer0_expert0</title>
<polygon fill="none" stroke="black" points="982.69,-31333.2 660.69,-31333.2 660.69,-31281.2 982.69,-31281.2 982.69,-31333.2"/>
<text text-anchor="middle" x="821.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 0</text>
<text text-anchor="middle" x="821.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP pair)</text>
<text text-anchor="middle" x="821.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="821.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert0 -->
<g id="edge42" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2645.04,-31427.64C2237.82,-31415.89 1568.31,-31389.44 993.69,-31333.2 993.46,-31333.18 993.24,-31333.16 993.01,-31333.13"/>
<polygon fill="black" stroke="black" points="993.07,-31329.62 982.77,-31332.08 992.36,-31336.59 993.07,-31329.62"/>
</g>
<!-- stage0_layer0_expert1 -->
<g id="node33" class="node">
<title>stage0_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1324.69,-31333.2 1002.69,-31333.2 1002.69,-31281.2 1324.69,-31281.2 1324.69,-31333.2"/>
<text text-anchor="middle" x="1163.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 1</text>
<text text-anchor="middle" x="1163.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP pair)</text>
<text text-anchor="middle" x="1163.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1163.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert1 -->
<g id="edge48" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2620.53,-31409.64C2315.01,-31389.17 1883.2,-31359.94 1504.69,-31333.2 1449.5,-31329.3 1389.3,-31324.93 1335.05,-31320.94"/>
<polygon fill="black" stroke="black" points="1335.23,-31317.45 1325,-31320.2 1334.71,-31324.43 1335.23,-31317.45"/>
</g>
<!-- stage0_layer0_expert2 -->
<g id="node39" class="node">
<title>stage0_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1835.69,-31333.2 1513.69,-31333.2 1513.69,-31281.2 1835.69,-31281.2 1835.69,-31333.2"/>
<text text-anchor="middle" x="1674.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 2</text>
<text text-anchor="middle" x="1674.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP pair)</text>
<text text-anchor="middle" x="1674.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1674.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert2 -->
<g id="edge54" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2603.38,-31397.12C2400.44,-31378 2152.8,-31354.55 1930.69,-31333.2 1903.25,-31330.56 1874.16,-31327.74 1845.82,-31324.98"/>
<polygon fill="black" stroke="black" points="1846.12,-31321.5 1835.82,-31324.01 1845.44,-31328.46 1846.12,-31321.5"/>
</g>
<!-- stage0_layer0_expert3 -->
<g id="node45" class="node">
<title>stage0_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2261.69,-31333.2 1939.69,-31333.2 1939.69,-31281.2 2261.69,-31281.2 2261.69,-31333.2"/>
<text text-anchor="middle" x="2100.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 3</text>
<text text-anchor="middle" x="2100.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP pair)</text>
<text text-anchor="middle" x="2100.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2100.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert3 -->
<g id="edge60" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2571.63,-31373.79C2464.81,-31358.92 2357.17,-31343.92 2271.81,-31332.03"/>
<polygon fill="black" stroke="black" points="2272.16,-31328.55 2261.77,-31330.64 2271.19,-31335.48 2272.16,-31328.55"/>
</g>
<!-- stage0_layer0_expert31 -->
<g id="node51" class="node">
<title>stage0_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2644.69,-31333.2 2322.69,-31333.2 2322.69,-31281.2 2644.69,-31281.2 2644.69,-31333.2"/>
<text text-anchor="middle" x="2483.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 31</text>
<text text-anchor="middle" x="2483.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP pair)</text>
<text text-anchor="middle" x="2483.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2483.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert31 -->
<g id="edge66" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.74,-31369.11C2689.08,-31357.25 2640.01,-31345.53 2598.38,-31335.59"/>
<polygon fill="black" stroke="black" points="2599.06,-31332.15 2588.52,-31333.23 2597.43,-31338.96 2599.06,-31332.15"/>
</g>
<!-- stage0_layer0_expert32 -->
<g id="node57" class="node">
<title>stage0_layer0_expert32</title>
<polygon fill="none" stroke="black" points="3005.69,-31333.2 2683.69,-31333.2 2683.69,-31281.2 3005.69,-31281.2 3005.69,-31333.2"/>
<text text-anchor="middle" x="2844.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 32</text>
<text text-anchor="middle" x="2844.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP pair)</text>
<text text-anchor="middle" x="2844.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2844.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert32 -->
<g id="edge72" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2927.83,-31369.01C2913.75,-31358.72 2899.82,-31348.53 2887.51,-31339.52"/>
<polygon fill="black" stroke="black" points="2889.39,-31336.56 2879.26,-31333.48 2885.26,-31342.21 2889.39,-31336.56"/>
</g>
<!-- stage0_layer0_expert60 -->
<g id="node63" class="node">
<title>stage0_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3356.69,-31333.2 3034.69,-31333.2 3034.69,-31281.2 3356.69,-31281.2 3356.69,-31333.2"/>
<text text-anchor="middle" x="3195.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 60</text>
<text text-anchor="middle" x="3195.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP pair)</text>
<text text-anchor="middle" x="3195.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3195.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert60 -->
<g id="edge78" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3112.07,-31369.01C3126.23,-31358.72 3140.24,-31348.53 3152.62,-31339.52"/>
<polygon fill="black" stroke="black" points="3154.89,-31342.2 3160.92,-31333.48 3150.78,-31336.54 3154.89,-31342.2"/>
</g>
<!-- stage0_layer0_expert61 -->
<g id="node69" class="node">
<title>stage0_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3708.69,-31333.2 3386.69,-31333.2 3386.69,-31281.2 3708.69,-31281.2 3708.69,-31333.2"/>
<text text-anchor="middle" x="3547.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 61</text>
<text text-anchor="middle" x="3547.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP pair)</text>
<text text-anchor="middle" x="3547.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3547.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert61 -->
<g id="edge84" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3290.26,-31370.61C3341.17,-31358.27 3391.75,-31346 3434.43,-31335.66"/>
<polygon fill="black" stroke="black" points="3435.36,-31339.03 3444.26,-31333.27 3433.71,-31332.23 3435.36,-31339.03"/>
</g>
<!-- stage0_layer0_expert62 -->
<g id="node75" class="node">
<title>stage0_layer0_expert62</title>
<polygon fill="none" stroke="black" points="4054.69,-31333.2 3732.69,-31333.2 3732.69,-31281.2 4054.69,-31281.2 4054.69,-31333.2"/>
<text text-anchor="middle" x="3893.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 62</text>
<text text-anchor="middle" x="3893.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP pair)</text>
<text text-anchor="middle" x="3893.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3893.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert62 -->
<g id="edge90" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3319.86,-31392.24C3454.37,-31372.54 3608.12,-31350.02 3722.6,-31333.26"/>
<polygon fill="black" stroke="black" points="3723.12,-31336.72 3732.51,-31331.81 3722.1,-31329.79 3723.12,-31336.72"/>
</g>
<!-- stage0_layer0_expert63 -->
<g id="node81" class="node">
<title>stage0_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4439.69,-31333.2 4117.69,-31333.2 4117.69,-31281.2 4439.69,-31281.2 4439.69,-31333.2"/>
<text text-anchor="middle" x="4278.69" y="-31321.2" font-family="Times,serif" font-size="10.00">Layer 0 Expert 63</text>
<text text-anchor="middle" x="4278.69" y="-31310.2" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP pair)</text>
<text text-anchor="middle" x="4278.69" y="-31299.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4278.69" y="-31288.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert63 -->
<g id="edge96" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3338.81,-31406.17C3545.59,-31386.35 3820.69,-31359.31 4063.69,-31333.2 4077.88,-31331.68 4092.59,-31330.05 4107.36,-31328.39"/>
<polygon fill="black" stroke="black" points="4108.04,-31331.84 4117.59,-31327.24 4107.26,-31324.88 4108.04,-31331.84"/>
</g>
<!-- stage0_layer0_expert_ellipsis -->
<g id="node87" class="node">
<title>stage0_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4874.69,-31245.2 4552.69,-31245.2 4552.69,-31193.2 4874.69,-31193.2 4874.69,-31245.2"/>
<text text-anchor="middle" x="4713.69" y="-31233.2" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4713.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4713.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4713.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert_ellipsis -->
<g id="edge102" class="edge">
<title>stage0_layer0_expert_router&#45;&gt;stage0_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3363.9,-31424.45C3719.74,-31409.96 4250.45,-31381.19 4448.69,-31333.2 4524.58,-31314.83 4606.47,-31276.84 4658.81,-31249.99"/>
<polygon fill="black" stroke="black" points="4660.64,-31252.98 4667.91,-31245.28 4657.42,-31246.77 4660.64,-31252.98"/>
</g>
<!-- stage0_layer0_expert0_mlp1 -->
<g id="node28" class="node">
<title>stage0_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="795.69,-31245.2 481.69,-31245.2 481.69,-31193.2 795.69,-31193.2 795.69,-31245.2"/>
<text text-anchor="middle" x="638.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="638.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP: Column Parallel)</text>
<text text-anchor="middle" x="638.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="638.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert0&#45;&gt;stage0_layer0_expert0_mlp1 -->
<g id="edge43" class="edge">
<title>stage0_layer0_expert0&#45;&gt;stage0_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M768.27,-31281.09C747.31,-31271.25 723.11,-31259.88 701.34,-31249.64"/>
<polygon fill="black" stroke="black" points="702.72,-31246.42 692.18,-31245.34 699.74,-31252.76 702.72,-31246.42"/>
</g>
<!-- stage0_layer0_expert0_tp1 -->
<g id="node29" class="node">
<title>stage0_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="600.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="600.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="600.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="600.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="600.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert0_mlp1&#45;&gt;stage0_layer0_expert0_tp1 -->
<g id="edge44" class="edge">
<title>stage0_layer0_expert0_mlp1&#45;&gt;stage0_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M628.8,-31193.03C625.64,-31184.96 622.03,-31175.77 618.48,-31166.73"/>
<polygon fill="black" stroke="black" points="621.73,-31165.44 614.82,-31157.41 615.21,-31167.99 621.73,-31165.44"/>
</g>
<!-- stage0_layer0_expert0_act -->
<g id="node30" class="node">
<title>stage0_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="654.19,-31047.66 373.19,-31047.66 373.19,-30995.66 654.19,-30995.66 654.19,-31047.66"/>
<text text-anchor="middle" x="513.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="513.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="513.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="513.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert0_tp1&#45;&gt;stage0_layer0_expert0_act -->
<g id="edge45" class="edge">
<title>stage0_layer0_expert0_tp1&#45;&gt;stage0_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M568.79,-31083.95C560.38,-31074.59 551.34,-31064.54 543.07,-31055.34"/>
<polygon fill="black" stroke="black" points="545.62,-31052.94 536.33,-31047.85 540.41,-31057.62 545.62,-31052.94"/>
</g>
<!-- stage0_layer0_expert0_mlp2 -->
<g id="node31" class="node">
<title>stage0_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="608.69,-30959.66 286.69,-30959.66 286.69,-30907.66 608.69,-30907.66 608.69,-30959.66"/>
<text text-anchor="middle" x="447.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="447.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP: Row Parallel)</text>
<text text-anchor="middle" x="447.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="447.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert0_act&#45;&gt;stage0_layer0_expert0_mlp2 -->
<g id="edge46" class="edge">
<title>stage0_layer0_expert0_act&#45;&gt;stage0_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M494.24,-30995.32C487.66,-30986.75 480.21,-30977.04 473.23,-30967.95"/>
<polygon fill="black" stroke="black" points="475.86,-30965.62 466.99,-30959.82 470.31,-30969.88 475.86,-30965.62"/>
</g>
<!-- stage0_layer0_expert0_tp2 -->
<g id="node32" class="node">
<title>stage0_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="374.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="374.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="374.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="374.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="374.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert0_mlp2&#45;&gt;stage0_layer0_expert0_tp2 -->
<g id="edge47" class="edge">
<title>stage0_layer0_expert0_mlp2&#45;&gt;stage0_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M428.7,-30907.49C422.29,-30899 414.95,-30889.26 407.78,-30879.76"/>
<polygon fill="black" stroke="black" points="410.37,-30877.38 401.55,-30871.5 404.78,-30881.59 410.37,-30877.38"/>
</g>
<!-- stage0_layer0_expert_agg -->
<g id="node88" class="node">
<title>stage0_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3527.22,-30762.12 2651.45,-30762.12 2426.16,-30626.12 3301.93,-30626.12 3527.22,-30762.12"/>
<text text-anchor="middle" x="2976.69" y="-30712.92" font-family="Times,serif" font-size="14.00">Layer 0 Expert Aggregation</text>
<text text-anchor="middle" x="2976.69" y="-30697.92" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="2976.69" y="-30682.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2976.69" y="-30667.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert0_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge103" class="edge">
<title>stage0_layer0_expert0_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M529.9,-30807.95C556.78,-30804.15 584.5,-30800.67 610.69,-30798.12 1281.12,-30732.91 2062.46,-30708.98 2538.17,-30700.2"/>
<polygon fill="black" stroke="black" points="2538.37,-30703.7 2548.3,-30700.02 2538.24,-30696.7 2538.37,-30703.7"/>
</g>
<!-- stage0_layer0_expert1_mlp1 -->
<g id="node34" class="node">
<title>stage0_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1180.69,-31245.2 866.69,-31245.2 866.69,-31193.2 1180.69,-31193.2 1180.69,-31245.2"/>
<text text-anchor="middle" x="1023.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1023.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1023.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1023.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert1&#45;&gt;stage0_layer0_expert1_mlp1 -->
<g id="edge49" class="edge">
<title>stage0_layer0_expert1&#45;&gt;stage0_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1122.82,-31281.09C1107.43,-31271.64 1089.75,-31260.78 1073.63,-31250.88"/>
<polygon fill="black" stroke="black" points="1075.2,-31247.74 1064.85,-31245.49 1071.54,-31253.7 1075.2,-31247.74"/>
</g>
<!-- stage0_layer0_expert1_tp1 -->
<g id="node35" class="node">
<title>stage0_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="1018.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1018.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="1018.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="1018.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1018.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert1_mlp1&#45;&gt;stage0_layer0_expert1_tp1 -->
<g id="edge50" class="edge">
<title>stage0_layer0_expert1_mlp1&#45;&gt;stage0_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M1022.39,-31193.03C1021.98,-31185.22 1021.53,-31176.35 1021.07,-31167.59"/>
<polygon fill="black" stroke="black" points="1024.56,-31167.21 1020.55,-31157.41 1017.57,-31167.57 1024.56,-31167.21"/>
</g>
<!-- stage0_layer0_expert1_act -->
<g id="node36" class="node">
<title>stage0_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="1006.19,-31047.66 725.19,-31047.66 725.19,-30995.66 1006.19,-30995.66 1006.19,-31047.66"/>
<text text-anchor="middle" x="865.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="865.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="865.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="865.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert1_tp1&#45;&gt;stage0_layer0_expert1_act -->
<g id="edge51" class="edge">
<title>stage0_layer0_expert1_tp1&#45;&gt;stage0_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M964.32,-31085.04C947.94,-31074.68 930.08,-31063.39 914.11,-31053.29"/>
<polygon fill="black" stroke="black" points="915.78,-31050.2 905.46,-31047.82 912.04,-31056.12 915.78,-31050.2"/>
</g>
<!-- stage0_layer0_expert1_mlp2 -->
<g id="node37" class="node">
<title>stage0_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="1014.69,-30959.66 692.69,-30959.66 692.69,-30907.66 1014.69,-30907.66 1014.69,-30959.66"/>
<text text-anchor="middle" x="853.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="853.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP: Row Parallel)</text>
<text text-anchor="middle" x="853.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="853.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert1_act&#45;&gt;stage0_layer0_expert1_mlp2 -->
<g id="edge52" class="edge">
<title>stage0_layer0_expert1_act&#45;&gt;stage0_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M862.15,-30995.32C861.04,-30987.36 859.79,-30978.42 858.61,-30969.91"/>
<polygon fill="black" stroke="black" points="862.05,-30969.24 857.2,-30959.82 855.11,-30970.21 862.05,-30969.24"/>
</g>
<!-- stage0_layer0_expert1_tp2 -->
<g id="node38" class="node">
<title>stage0_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="847.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="847.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="847.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="847.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="847.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert1_mlp2&#45;&gt;stage0_layer0_expert1_tp2 -->
<g id="edge53" class="edge">
<title>stage0_layer0_expert1_mlp2&#45;&gt;stage0_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M852.13,-30907.49C851.64,-30899.68 851.09,-30890.81 850.55,-30882.05"/>
<polygon fill="black" stroke="black" points="854.03,-30881.63 849.92,-30871.87 847.04,-30882.07 854.03,-30881.63"/>
</g>
<!-- stage0_layer0_expert1_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge104" class="edge">
<title>stage0_layer0_expert1_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1003.88,-30808.06C1030.46,-30804.28 1057.82,-30800.78 1083.69,-30798.12 1585.29,-30746.58 2164.49,-30719.84 2548.77,-30706.68"/>
<polygon fill="black" stroke="black" points="2549.07,-30710.17 2558.94,-30706.33 2548.83,-30703.17 2549.07,-30710.17"/>
</g>
<!-- stage0_layer0_expert2_mlp1 -->
<g id="node40" class="node">
<title>stage0_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1785.69,-31245.2 1471.69,-31245.2 1471.69,-31193.2 1785.69,-31193.2 1785.69,-31245.2"/>
<text text-anchor="middle" x="1628.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1628.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1628.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1628.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert2&#45;&gt;stage0_layer0_expert2_mlp1 -->
<g id="edge55" class="edge">
<title>stage0_layer0_expert2&#45;&gt;stage0_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1661.14,-31280.86C1656.69,-31272.55 1651.68,-31263.18 1646.94,-31254.32"/>
<polygon fill="black" stroke="black" points="1649.95,-31252.52 1642.14,-31245.36 1643.77,-31255.83 1649.95,-31252.52"/>
</g>
<!-- stage0_layer0_expert2_tp1 -->
<g id="node41" class="node">
<title>stage0_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1498.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1498.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1498.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="1498.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1498.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert2_mlp1&#45;&gt;stage0_layer0_expert2_tp1 -->
<g id="edge56" class="edge">
<title>stage0_layer0_expert2_mlp1&#45;&gt;stage0_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1594.87,-31193.03C1582.29,-31183.67 1567.67,-31172.78 1553.69,-31162.37"/>
<polygon fill="black" stroke="black" points="1555.66,-31159.47 1545.55,-31156.31 1551.48,-31165.09 1555.66,-31159.47"/>
</g>
<!-- stage0_layer0_expert2_act -->
<g id="node42" class="node">
<title>stage0_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1596.19,-31047.66 1315.19,-31047.66 1315.19,-30995.66 1596.19,-30995.66 1596.19,-31047.66"/>
<text text-anchor="middle" x="1455.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1455.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="1455.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1455.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert2_tp1&#45;&gt;stage0_layer0_expert2_act -->
<g id="edge57" class="edge">
<title>stage0_layer0_expert2_tp1&#45;&gt;stage0_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1482.8,-31083.67C1478.94,-31074.99 1474.82,-31065.72 1470.99,-31057.1"/>
<polygon fill="black" stroke="black" points="1474.08,-31055.42 1466.82,-31047.7 1467.68,-31058.26 1474.08,-31055.42"/>
</g>
<!-- stage0_layer0_expert2_mlp2 -->
<g id="node43" class="node">
<title>stage0_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1526.69,-30959.66 1204.69,-30959.66 1204.69,-30907.66 1526.69,-30907.66 1526.69,-30959.66"/>
<text text-anchor="middle" x="1365.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1365.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1365.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1365.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert2_act&#45;&gt;stage0_layer0_expert2_mlp2 -->
<g id="edge58" class="edge">
<title>stage0_layer0_expert2_act&#45;&gt;stage0_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1429.17,-30995.32C1419.83,-30986.4 1409.21,-30976.25 1399.36,-30966.84"/>
<polygon fill="black" stroke="black" points="1401.66,-30964.2 1392.02,-30959.82 1396.83,-30969.26 1401.66,-30964.2"/>
</g>
<!-- stage0_layer0_expert2_tp2 -->
<g id="node44" class="node">
<title>stage0_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1320.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1320.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1320.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="1320.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1320.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert2_mlp2&#45;&gt;stage0_layer0_expert2_tp2 -->
<g id="edge59" class="edge">
<title>stage0_layer0_expert2_mlp2&#45;&gt;stage0_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1353.98,-30907.49C1350.23,-30899.43 1345.96,-30890.24 1341.75,-30881.19"/>
<polygon fill="black" stroke="black" points="1344.81,-30879.46 1337.42,-30871.87 1338.46,-30882.41 1344.81,-30879.46"/>
</g>
<!-- stage0_layer0_expert2_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge105" class="edge">
<title>stage0_layer0_expert2_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1478.19,-30808.28C1504.36,-30804.52 1531.26,-30800.97 1556.69,-30798.12 1895.19,-30760.25 2280.73,-30733.31 2564.58,-30716.5"/>
<polygon fill="black" stroke="black" points="2564.85,-30719.99 2574.63,-30715.9 2564.44,-30713 2564.85,-30719.99"/>
</g>
<!-- stage0_layer0_expert3_mlp1 -->
<g id="node46" class="node">
<title>stage0_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2196.69,-31245.2 1882.69,-31245.2 1882.69,-31193.2 2196.69,-31193.2 2196.69,-31245.2"/>
<text text-anchor="middle" x="2039.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="2039.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2039.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2039.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert3&#45;&gt;stage0_layer0_expert3_mlp1 -->
<g id="edge61" class="edge">
<title>stage0_layer0_expert3&#45;&gt;stage0_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M2082.72,-31280.86C2076.7,-31272.38 2069.89,-31262.78 2063.5,-31253.77"/>
<polygon fill="black" stroke="black" points="2066.17,-31251.49 2057.53,-31245.36 2060.46,-31255.54 2066.17,-31251.49"/>
</g>
<!-- stage0_layer0_expert3_tp1 -->
<g id="node47" class="node">
<title>stage0_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1945.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1945.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1945.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="1945.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1945.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert3_mlp1&#45;&gt;stage0_layer0_expert3_tp1 -->
<g id="edge62" class="edge">
<title>stage0_layer0_expert3_mlp1&#45;&gt;stage0_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M2015.24,-31193.03C2006.65,-31184.19 1996.76,-31174 1987.17,-31164.13"/>
<polygon fill="black" stroke="black" points="1989.4,-31161.41 1979.92,-31156.68 1984.38,-31166.29 1989.4,-31161.41"/>
</g>
<!-- stage0_layer0_expert3_act -->
<g id="node48" class="node">
<title>stage0_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="2066.19,-31047.66 1785.19,-31047.66 1785.19,-30995.66 2066.19,-30995.66 2066.19,-31047.66"/>
<text text-anchor="middle" x="1925.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1925.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="1925.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1925.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert3_tp1&#45;&gt;stage0_layer0_expert3_act -->
<g id="edge63" class="edge">
<title>stage0_layer0_expert3_tp1&#45;&gt;stage0_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1938.3,-31083.67C1936.54,-31075.17 1934.67,-31066.12 1932.92,-31057.66"/>
<polygon fill="black" stroke="black" points="1936.32,-31056.79 1930.86,-31047.7 1929.46,-31058.21 1936.32,-31056.79"/>
</g>
<!-- stage0_layer0_expert3_mlp2 -->
<g id="node49" class="node">
<title>stage0_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="2021.69,-30959.66 1699.69,-30959.66 1699.69,-30907.66 2021.69,-30907.66 2021.69,-30959.66"/>
<text text-anchor="middle" x="1860.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1860.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1860.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1860.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert3_act&#45;&gt;stage0_layer0_expert3_mlp2 -->
<g id="edge64" class="edge">
<title>stage0_layer0_expert3_act&#45;&gt;stage0_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1906.54,-30995.32C1900.06,-30986.75 1892.72,-30977.04 1885.85,-30967.95"/>
<polygon fill="black" stroke="black" points="1888.52,-30965.69 1879.7,-30959.82 1882.94,-30969.91 1888.52,-30965.69"/>
</g>
<!-- stage0_layer0_expert3_tp2 -->
<g id="node50" class="node">
<title>stage0_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1793.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1793.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1793.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="1793.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1793.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert3_mlp2&#45;&gt;stage0_layer0_expert3_tp2 -->
<g id="edge65" class="edge">
<title>stage0_layer0_expert3_mlp2&#45;&gt;stage0_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1843.26,-30907.49C1837.38,-30899 1830.64,-30889.26 1824.06,-30879.76"/>
<polygon fill="black" stroke="black" points="1826.91,-30877.73 1818.34,-30871.5 1821.16,-30881.72 1826.91,-30877.73"/>
</g>
<!-- stage0_layer0_expert3_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge106" class="edge">
<title>stage0_layer0_expert3_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1953.83,-30808.69C1979.19,-30804.97 2005.13,-30801.32 2029.69,-30798.12 2214.29,-30774.1 2419.65,-30751.29 2591.81,-30733.27"/>
<polygon fill="black" stroke="black" points="2592.22,-30736.75 2601.8,-30732.23 2591.49,-30729.79 2592.22,-30736.75"/>
</g>
<!-- stage0_layer0_expert31_mlp1 -->
<g id="node52" class="node">
<title>stage0_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2572.69,-31245.2 2258.69,-31245.2 2258.69,-31193.2 2572.69,-31193.2 2572.69,-31245.2"/>
<text text-anchor="middle" x="2415.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2415.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2415.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2415.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert31&#45;&gt;stage0_layer0_expert31_mlp1 -->
<g id="edge67" class="edge">
<title>stage0_layer0_expert31&#45;&gt;stage0_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2463.65,-31280.86C2456.81,-31272.2 2449.04,-31262.38 2441.79,-31253.21"/>
<polygon fill="black" stroke="black" points="2444.53,-31251.03 2435.58,-31245.36 2439.04,-31255.37 2444.53,-31251.03"/>
</g>
<!-- stage0_layer0_expert31_tp1 -->
<g id="node53" class="node">
<title>stage0_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2365.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2365.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2365.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="2365.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2365.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert31_mlp1&#45;&gt;stage0_layer0_expert31_tp1 -->
<g id="edge68" class="edge">
<title>stage0_layer0_expert31_mlp1&#45;&gt;stage0_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2402.68,-31193.03C2398.47,-31184.88 2393.67,-31175.58 2388.95,-31166.44"/>
<polygon fill="black" stroke="black" points="2391.98,-31164.68 2384.28,-31157.41 2385.76,-31167.9 2391.98,-31164.68"/>
</g>
<!-- stage0_layer0_expert31_act -->
<g id="node54" class="node">
<title>stage0_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2458.19,-31047.66 2177.19,-31047.66 2177.19,-30995.66 2458.19,-30995.66 2458.19,-31047.66"/>
<text text-anchor="middle" x="2317.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2317.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="2317.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2317.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert31_tp1&#45;&gt;stage0_layer0_expert31_act -->
<g id="edge69" class="edge">
<title>stage0_layer0_expert31_tp1&#45;&gt;stage0_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2347.95,-31083.67C2343.6,-31074.89 2338.95,-31065.52 2334.63,-31056.82"/>
<polygon fill="black" stroke="black" points="2337.69,-31055.11 2330.11,-31047.7 2331.42,-31058.22 2337.69,-31055.11"/>
</g>
<!-- stage0_layer0_expert31_mlp2 -->
<g id="node55" class="node">
<title>stage0_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2427.69,-30959.66 2105.69,-30959.66 2105.69,-30907.66 2427.69,-30907.66 2427.69,-30959.66"/>
<text text-anchor="middle" x="2266.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2266.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2266.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2266.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert31_act&#45;&gt;stage0_layer0_expert31_mlp2 -->
<g id="edge70" class="edge">
<title>stage0_layer0_expert31_act&#45;&gt;stage0_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2302.66,-30995.32C2297.68,-30986.93 2292.06,-30977.44 2286.76,-30968.51"/>
<polygon fill="black" stroke="black" points="2289.72,-30966.63 2281.61,-30959.82 2283.7,-30970.2 2289.72,-30966.63"/>
</g>
<!-- stage0_layer0_expert31_tp2 -->
<g id="node56" class="node">
<title>stage0_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2266.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2266.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2266.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="2266.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2266.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert31_mlp2&#45;&gt;stage0_layer0_expert31_tp2 -->
<g id="edge71" class="edge">
<title>stage0_layer0_expert31_mlp2&#45;&gt;stage0_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2266.69,-30907.49C2266.69,-30899.68 2266.69,-30890.81 2266.69,-30882.05"/>
<polygon fill="black" stroke="black" points="2270.19,-30881.87 2266.69,-30871.87 2263.19,-30881.87 2270.19,-30881.87"/>
</g>
<!-- stage0_layer0_expert31_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge107" class="edge">
<title>stage0_layer0_expert31_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2408.66,-30806.14C2474.77,-30793.22 2556.52,-30777.24 2637.2,-30761.48"/>
<polygon fill="black" stroke="black" points="2637.89,-30764.91 2647.03,-30759.55 2636.54,-30758.04 2637.89,-30764.91"/>
</g>
<!-- stage0_layer0_expert32_mlp1 -->
<g id="node58" class="node">
<title>stage0_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2963.69,-31245.2 2649.69,-31245.2 2649.69,-31193.2 2963.69,-31193.2 2963.69,-31245.2"/>
<text text-anchor="middle" x="2806.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2806.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2806.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2806.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert32&#45;&gt;stage0_layer0_expert32_mlp1 -->
<g id="edge73" class="edge">
<title>stage0_layer0_expert32&#45;&gt;stage0_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2833.49,-31280.86C2829.86,-31272.64 2825.76,-31263.37 2821.89,-31254.6"/>
<polygon fill="black" stroke="black" points="2825.05,-31253.09 2817.8,-31245.36 2818.64,-31255.92 2825.05,-31253.09"/>
</g>
<!-- stage0_layer0_expert32_tp1 -->
<g id="node59" class="node">
<title>stage0_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2783.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2783.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2783.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="2783.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2783.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert32_mlp1&#45;&gt;stage0_layer0_expert32_tp1 -->
<g id="edge74" class="edge">
<title>stage0_layer0_expert32_mlp1&#45;&gt;stage0_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2800.71,-31193.03C2798.83,-31185.13 2796.7,-31176.16 2794.59,-31167.3"/>
<polygon fill="black" stroke="black" points="2797.96,-31166.33 2792.24,-31157.41 2791.15,-31167.95 2797.96,-31166.33"/>
</g>
<!-- stage0_layer0_expert32_act -->
<g id="node60" class="node">
<title>stage0_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2901.19,-31047.66 2620.19,-31047.66 2620.19,-30995.66 2901.19,-30995.66 2901.19,-31047.66"/>
<text text-anchor="middle" x="2760.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2760.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="2760.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2760.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert32_tp1&#45;&gt;stage0_layer0_expert32_act -->
<g id="edge75" class="edge">
<title>stage0_layer0_expert32_tp1&#45;&gt;stage0_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2775.19,-31083.67C2773.17,-31075.17 2771.02,-31066.12 2769.01,-31057.66"/>
<polygon fill="black" stroke="black" points="2772.36,-31056.62 2766.64,-31047.7 2765.55,-31058.24 2772.36,-31056.62"/>
</g>
<!-- stage0_layer0_expert32_mlp2 -->
<g id="node61" class="node">
<title>stage0_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2911.69,-30959.66 2589.69,-30959.66 2589.69,-30907.66 2911.69,-30907.66 2911.69,-30959.66"/>
<text text-anchor="middle" x="2750.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2750.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2750.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2750.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert32_act&#45;&gt;stage0_layer0_expert32_mlp2 -->
<g id="edge76" class="edge">
<title>stage0_layer0_expert32_act&#45;&gt;stage0_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2757.74,-30995.32C2756.82,-30987.36 2755.78,-30978.42 2754.79,-30969.91"/>
<polygon fill="black" stroke="black" points="2758.25,-30969.35 2753.61,-30959.82 2751.29,-30970.16 2758.25,-30969.35"/>
</g>
<!-- stage0_layer0_expert32_tp2 -->
<g id="node62" class="node">
<title>stage0_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2739.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2739.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2739.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="2739.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2739.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert32_mlp2&#45;&gt;stage0_layer0_expert32_tp2 -->
<g id="edge77" class="edge">
<title>stage0_layer0_expert32_mlp2&#45;&gt;stage0_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2747.83,-30907.49C2746.94,-30899.68 2745.93,-30890.81 2744.93,-30882.05"/>
<polygon fill="black" stroke="black" points="2748.39,-30881.41 2743.78,-30871.87 2741.43,-30882.2 2748.39,-30881.41"/>
</g>
<!-- stage0_layer0_expert32_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge108" class="edge">
<title>stage0_layer0_expert32_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2798.88,-30799.23C2815.53,-30789.49 2834.28,-30778.51 2853.2,-30767.43"/>
<polygon fill="black" stroke="black" points="2855.03,-30770.41 2861.89,-30762.34 2851.49,-30764.37 2855.03,-30770.41"/>
</g>
<!-- stage0_layer0_expert60_mlp1 -->
<g id="node64" class="node">
<title>stage0_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3353.69,-31245.2 3039.69,-31245.2 3039.69,-31193.2 3353.69,-31193.2 3353.69,-31245.2"/>
<text text-anchor="middle" x="3196.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3196.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3196.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3196.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert60&#45;&gt;stage0_layer0_expert60_mlp1 -->
<g id="edge79" class="edge">
<title>stage0_layer0_expert60&#45;&gt;stage0_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3195.98,-31280.86C3196.08,-31272.9 3196.18,-31263.96 3196.28,-31255.45"/>
<polygon fill="black" stroke="black" points="3199.78,-31255.4 3196.4,-31245.36 3192.78,-31255.32 3199.78,-31255.4"/>
</g>
<!-- stage0_layer0_expert60_tp1 -->
<g id="node65" class="node">
<title>stage0_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3199.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3199.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3199.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="3199.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3199.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert60_mlp1&#45;&gt;stage0_layer0_expert60_tp1 -->
<g id="edge80" class="edge">
<title>stage0_layer0_expert60_mlp1&#45;&gt;stage0_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3197.47,-31193.03C3197.71,-31185.22 3197.99,-31176.35 3198.26,-31167.59"/>
<polygon fill="black" stroke="black" points="3201.76,-31167.51 3198.57,-31157.41 3194.76,-31167.29 3201.76,-31167.51"/>
</g>
<!-- stage0_layer0_expert60_act -->
<g id="node66" class="node">
<title>stage0_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3342.19,-31047.66 3061.19,-31047.66 3061.19,-30995.66 3342.19,-30995.66 3342.19,-31047.66"/>
<text text-anchor="middle" x="3201.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3201.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="3201.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3201.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert60_tp1&#45;&gt;stage0_layer0_expert60_act -->
<g id="edge81" class="edge">
<title>stage0_layer0_expert60_tp1&#45;&gt;stage0_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3200.43,-31083.4C3200.6,-31075.09 3200.79,-31066.25 3200.96,-31057.97"/>
<polygon fill="black" stroke="black" points="3204.46,-31057.93 3201.17,-31047.86 3197.46,-31057.78 3204.46,-31057.93"/>
</g>
<!-- stage0_layer0_expert60_mlp2 -->
<g id="node67" class="node">
<title>stage0_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3372.69,-30959.66 3050.69,-30959.66 3050.69,-30907.66 3372.69,-30907.66 3372.69,-30959.66"/>
<text text-anchor="middle" x="3211.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3211.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3211.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3211.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert60_act&#45;&gt;stage0_layer0_expert60_mlp2 -->
<g id="edge82" class="edge">
<title>stage0_layer0_expert60_act&#45;&gt;stage0_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3204.63,-30995.32C3205.56,-30987.36 3206.6,-30978.42 3207.59,-30969.91"/>
<polygon fill="black" stroke="black" points="3211.08,-30970.16 3208.76,-30959.82 3204.13,-30969.35 3211.08,-30970.16"/>
</g>
<!-- stage0_layer0_expert60_tp2 -->
<g id="node68" class="node">
<title>stage0_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3212.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3212.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3212.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="3212.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3212.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert60_mlp2&#45;&gt;stage0_layer0_expert60_tp2 -->
<g id="edge83" class="edge">
<title>stage0_layer0_expert60_mlp2&#45;&gt;stage0_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3211.95,-30907.49C3212.03,-30899.68 3212.12,-30890.81 3212.21,-30882.05"/>
<polygon fill="black" stroke="black" points="3215.71,-30881.9 3212.32,-30871.87 3208.71,-30881.83 3215.71,-30881.9"/>
</g>
<!-- stage0_layer0_expert60_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge109" class="edge">
<title>stage0_layer0_expert60_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3153.74,-30799.23C3137.17,-30789.49 3118.5,-30778.51 3099.66,-30767.43"/>
<polygon fill="black" stroke="black" points="3101.39,-30764.39 3091,-30762.34 3097.85,-30770.42 3101.39,-30764.39"/>
</g>
<!-- stage0_layer0_expert61_mlp1 -->
<g id="node70" class="node">
<title>stage0_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3717.69,-31245.2 3403.69,-31245.2 3403.69,-31193.2 3717.69,-31193.2 3717.69,-31245.2"/>
<text text-anchor="middle" x="3560.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3560.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3560.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3560.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert61&#45;&gt;stage0_layer0_expert61_mlp1 -->
<g id="edge85" class="edge">
<title>stage0_layer0_expert61&#45;&gt;stage0_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3551.52,-31280.86C3552.72,-31272.9 3554.07,-31263.96 3555.36,-31255.45"/>
<polygon fill="black" stroke="black" points="3558.85,-31255.77 3556.89,-31245.36 3551.93,-31254.72 3558.85,-31255.77"/>
</g>
<!-- stage0_layer0_expert61_tp1 -->
<g id="node71" class="node">
<title>stage0_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3627.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3627.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3627.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="3627.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3627.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert61_mlp1&#45;&gt;stage0_layer0_expert61_tp1 -->
<g id="edge86" class="edge">
<title>stage0_layer0_expert61_mlp1&#45;&gt;stage0_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3578.12,-31193.03C3583.99,-31184.54 3590.74,-31174.8 3597.32,-31165.3"/>
<polygon fill="black" stroke="black" points="3600.22,-31167.26 3603.03,-31157.04 3594.46,-31163.27 3600.22,-31167.26"/>
</g>
<!-- stage0_layer0_expert61_act -->
<g id="node72" class="node">
<title>stage0_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3797.19,-31047.66 3516.19,-31047.66 3516.19,-30995.66 3797.19,-30995.66 3797.19,-31047.66"/>
<text text-anchor="middle" x="3656.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3656.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="3656.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3656.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert61_tp1&#45;&gt;stage0_layer0_expert61_act -->
<g id="edge87" class="edge">
<title>stage0_layer0_expert61_tp1&#45;&gt;stage0_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3638.4,-31083.67C3640.98,-31075.08 3643.72,-31065.92 3646.28,-31057.38"/>
<polygon fill="black" stroke="black" points="3649.67,-31058.29 3649.18,-31047.7 3642.96,-31056.28 3649.67,-31058.29"/>
</g>
<!-- stage0_layer0_expert61_mlp2 -->
<g id="node73" class="node">
<title>stage0_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3836.69,-30959.66 3514.69,-30959.66 3514.69,-30907.66 3836.69,-30907.66 3836.69,-30959.66"/>
<text text-anchor="middle" x="3675.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3675.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3675.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3675.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert61_act&#45;&gt;stage0_layer0_expert61_mlp2 -->
<g id="edge88" class="edge">
<title>stage0_layer0_expert61_act&#45;&gt;stage0_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3662.29,-30995.32C3664.06,-30987.28 3666.06,-30978.23 3667.96,-30969.63"/>
<polygon fill="black" stroke="black" points="3671.39,-30970.34 3670.13,-30959.82 3664.56,-30968.83 3671.39,-30970.34"/>
</g>
<!-- stage0_layer0_expert61_tp2 -->
<g id="node74" class="node">
<title>stage0_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3685.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3685.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3685.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="3685.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3685.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert61_mlp2&#45;&gt;stage0_layer0_expert61_tp2 -->
<g id="edge89" class="edge">
<title>stage0_layer0_expert61_mlp2&#45;&gt;stage0_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3678.29,-30907.49C3679.1,-30899.68 3680.01,-30890.81 3680.92,-30882.05"/>
<polygon fill="black" stroke="black" points="3684.42,-30882.17 3681.97,-30871.87 3677.46,-30881.46 3684.42,-30882.17"/>
</g>
<!-- stage0_layer0_expert61_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge110" class="edge">
<title>stage0_layer0_expert61_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3543.49,-30806.06C3481.3,-30793.89 3405.31,-30779.01 3329.43,-30764.16"/>
<polygon fill="black" stroke="black" points="3329.69,-30760.65 3319.21,-30762.16 3328.35,-30767.52 3329.69,-30760.65"/>
</g>
<!-- stage0_layer0_expert62_mlp1 -->
<g id="node76" class="node">
<title>stage0_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="4063.69,-31245.2 3749.69,-31245.2 3749.69,-31193.2 4063.69,-31193.2 4063.69,-31245.2"/>
<text text-anchor="middle" x="3906.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3906.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3906.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3906.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert62&#45;&gt;stage0_layer0_expert62_mlp1 -->
<g id="edge91" class="edge">
<title>stage0_layer0_expert62&#45;&gt;stage0_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3897.52,-31280.86C3898.72,-31272.9 3900.07,-31263.96 3901.36,-31255.45"/>
<polygon fill="black" stroke="black" points="3904.85,-31255.77 3902.89,-31245.36 3897.93,-31254.72 3904.85,-31255.77"/>
</g>
<!-- stage0_layer0_expert62_tp1 -->
<g id="node77" class="node">
<title>stage0_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="4067.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4067.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="4067.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="4067.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4067.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert62_mlp1&#45;&gt;stage0_layer0_expert62_tp1 -->
<g id="edge92" class="edge">
<title>stage0_layer0_expert62_mlp1&#45;&gt;stage0_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3948.57,-31193.03C3964.82,-31183.26 3983.83,-31171.83 4001.83,-31161.02"/>
<polygon fill="black" stroke="black" points="4003.8,-31163.92 4010.56,-31155.77 4000.19,-31157.92 4003.8,-31163.92"/>
</g>
<!-- stage0_layer0_expert62_act -->
<g id="node78" class="node">
<title>stage0_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4232.19,-31047.66 3951.19,-31047.66 3951.19,-30995.66 4232.19,-30995.66 4232.19,-31047.66"/>
<text text-anchor="middle" x="4091.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="4091.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="4091.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4091.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert62_tp1&#45;&gt;stage0_layer0_expert62_act -->
<g id="edge93" class="edge">
<title>stage0_layer0_expert62_tp1&#45;&gt;stage0_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M4076.56,-31083.67C4078.66,-31075.17 4080.91,-31066.12 4083.01,-31057.66"/>
<polygon fill="black" stroke="black" points="4086.47,-31058.25 4085.48,-31047.7 4079.67,-31056.57 4086.47,-31058.25"/>
</g>
<!-- stage0_layer0_expert62_mlp2 -->
<g id="node79" class="node">
<title>stage0_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4297.69,-30959.66 3975.69,-30959.66 3975.69,-30907.66 4297.69,-30907.66 4297.69,-30959.66"/>
<text text-anchor="middle" x="4136.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4136.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4136.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4136.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert62_act&#45;&gt;stage0_layer0_expert62_mlp2 -->
<g id="edge94" class="edge">
<title>stage0_layer0_expert62_act&#45;&gt;stage0_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4104.95,-30995.32C4109.3,-30987.01 4114.2,-30977.64 4118.83,-30968.79"/>
<polygon fill="black" stroke="black" points="4121.99,-30970.3 4123.53,-30959.82 4115.79,-30967.06 4121.99,-30970.3"/>
</g>
<!-- stage0_layer0_expert62_tp2 -->
<g id="node80" class="node">
<title>stage0_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4158.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4158.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4158.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="4158.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4158.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert62_mlp2&#45;&gt;stage0_layer0_expert62_tp2 -->
<g id="edge95" class="edge">
<title>stage0_layer0_expert62_mlp2&#45;&gt;stage0_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4142.41,-30907.49C4144.21,-30899.6 4146.25,-30890.62 4148.26,-30881.76"/>
<polygon fill="black" stroke="black" points="4151.71,-30882.4 4150.51,-30871.87 4144.88,-30880.84 4151.71,-30882.4"/>
</g>
<!-- stage0_layer0_expert62_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge111" class="edge">
<title>stage0_layer0_expert62_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3998.54,-30808.69C3973.19,-30804.97 3947.24,-30801.32 3922.69,-30798.12 3790.83,-30780.96 3648.38,-30764.41 3515.02,-30749.78"/>
<polygon fill="black" stroke="black" points="3515.35,-30746.29 3505.03,-30748.68 3514.59,-30753.25 3515.35,-30746.29"/>
</g>
<!-- stage0_layer0_expert63_mlp1 -->
<g id="node82" class="node">
<title>stage0_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4488.69,-31245.2 4174.69,-31245.2 4174.69,-31193.2 4488.69,-31193.2 4488.69,-31245.2"/>
<text text-anchor="middle" x="4331.69" y="-31233.2" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4331.69" y="-31222.2" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4331.69" y="-31211.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4331.69" y="-31200.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer0_expert63&#45;&gt;stage0_layer0_expert63_mlp1 -->
<g id="edge97" class="edge">
<title>stage0_layer0_expert63&#45;&gt;stage0_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4294.3,-31280.86C4299.48,-31272.46 4305.33,-31262.98 4310.83,-31254.05"/>
<polygon fill="black" stroke="black" points="4313.92,-31255.71 4316.18,-31245.36 4307.96,-31252.03 4313.92,-31255.71"/>
</g>
<!-- stage0_layer0_expert63_tp1 -->
<g id="node83" class="node">
<title>stage0_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4536.69" cy="-31120.43" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4536.69" y="-31134.43" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4536.69" y="-31123.43" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="4536.69" y="-31112.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4536.69" y="-31101.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert63_mlp1&#45;&gt;stage0_layer0_expert63_tp1 -->
<g id="edge98" class="edge">
<title>stage0_layer0_expert63_mlp1&#45;&gt;stage0_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4384.75,-31193.15C4406.63,-31182.83 4432.46,-31170.63 4456.56,-31159.26"/>
<polygon fill="black" stroke="black" points="4458.15,-31162.37 4465.7,-31154.94 4455.16,-31156.04 4458.15,-31162.37"/>
</g>
<!-- stage0_layer0_expert63_act -->
<g id="node84" class="node">
<title>stage0_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4706.19,-31047.66 4425.19,-31047.66 4425.19,-30995.66 4706.19,-30995.66 4706.19,-31047.66"/>
<text text-anchor="middle" x="4565.69" y="-31035.66" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4565.69" y="-31024.66" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="4565.69" y="-31013.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4565.69" y="-31002.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer0_expert63_tp1&#45;&gt;stage0_layer0_expert63_act -->
<g id="edge99" class="edge">
<title>stage0_layer0_expert63_tp1&#45;&gt;stage0_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4547.4,-31083.67C4549.98,-31075.08 4552.72,-31065.92 4555.28,-31057.38"/>
<polygon fill="black" stroke="black" points="4558.67,-31058.29 4558.18,-31047.7 4551.96,-31056.28 4558.67,-31058.29"/>
</g>
<!-- stage0_layer0_expert63_mlp2 -->
<g id="node85" class="node">
<title>stage0_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4763.69,-30959.66 4441.69,-30959.66 4441.69,-30907.66 4763.69,-30907.66 4763.69,-30959.66"/>
<text text-anchor="middle" x="4602.69" y="-30947.66" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4602.69" y="-30936.66" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4602.69" y="-30925.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4602.69" y="-30914.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert63_act&#45;&gt;stage0_layer0_expert63_mlp2 -->
<g id="edge100" class="edge">
<title>stage0_layer0_expert63_act&#45;&gt;stage0_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4576.59,-30995.32C4580.13,-30987.1 4584.11,-30977.83 4587.89,-30969.07"/>
<polygon fill="black" stroke="black" points="4591.13,-30970.39 4591.87,-30959.82 4584.7,-30967.62 4591.13,-30970.39"/>
</g>
<!-- stage0_layer0_expert63_tp2 -->
<g id="node86" class="node">
<title>stage0_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4631.69" cy="-30834.89" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4631.69" y="-30848.89" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4631.69" y="-30837.89" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="4631.69" y="-30826.89" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4631.69" y="-30815.89" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_expert63_mlp2&#45;&gt;stage0_layer0_expert63_tp2 -->
<g id="edge101" class="edge">
<title>stage0_layer0_expert63_mlp2&#45;&gt;stage0_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4610.23,-30907.49C4612.62,-30899.51 4615.34,-30890.43 4618.03,-30881.48"/>
<polygon fill="black" stroke="black" points="4621.39,-30882.45 4620.91,-30871.87 4614.68,-30880.44 4621.39,-30882.45"/>
</g>
<!-- stage0_layer0_expert63_tp2&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge112" class="edge">
<title>stage0_layer0_expert63_tp2&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4474.18,-30808.28C4448.01,-30804.52 4421.12,-30800.97 4395.69,-30798.12 4088.5,-30763.75 3742.56,-30738.37 3469.16,-30721.4"/>
<polygon fill="black" stroke="black" points="3469.26,-30717.9 3459.06,-30720.78 3468.82,-30724.89 3469.26,-30717.9"/>
</g>
<!-- stage0_layer0_expert_ellipsis&#45;&gt;stage0_layer0_expert_agg -->
<g id="edge113" class="edge">
<title>stage0_layer0_expert_ellipsis&#45;&gt;stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4759.4,-31192.98C4810.96,-31160.79 4887.69,-31099.91 4887.69,-31022.66 4887.69,-31022.66 4887.69,-31022.66 4887.69,-30932.66 4887.69,-30872.27 4913.18,-30838.95 4868.69,-30798.12 4816.79,-30750.5 3987.39,-30720.5 3444.12,-30705.85"/>
<polygon fill="black" stroke="black" points="3443.83,-30702.34 3433.74,-30705.57 3443.64,-30709.34 3443.83,-30702.34"/>
</g>
<!-- stage0_layer0_expert_agg&#45;&gt;stage0_layer0_output -->
<g id="edge114" class="edge">
<title>stage0_layer0_expert_agg&#45;&gt;stage0_layer0_output</title>
<path fill="none" stroke="black" d="M3322.08,-30638.25C3420.95,-30622.54 3525.94,-30605.86 3614.83,-30591.73"/>
<polygon fill="black" stroke="black" points="3615.43,-30595.18 3624.76,-30590.16 3614.34,-30588.27 3615.43,-30595.18"/>
</g>
<!-- stage0_layer1_ln -->
<g id="node90" class="node">
<title>stage0_layer1_ln</title>
<polygon fill="none" stroke="black" points="4057.69,-30486.12 3607.69,-30486.12 3607.69,-30418.12 4057.69,-30418.12 4057.69,-30486.12"/>
<text text-anchor="middle" x="3832.69" y="-30470.92" font-family="Times,serif" font-size="14.00">Layer 1 LayerNorm</text>
<text text-anchor="middle" x="3832.69" y="-30455.92" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-30440.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-30425.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer0_output&#45;&gt;stage0_layer1_ln -->
<g id="edge116" class="edge">
<title>stage0_layer0_output&#45;&gt;stage0_layer1_ln</title>
<path fill="none" stroke="black" d="M3832.69,-30522.01C3832.69,-30513.9 3832.69,-30505.1 3832.69,-30496.59"/>
<polygon fill="black" stroke="black" points="3836.19,-30496.42 3832.69,-30486.42 3829.19,-30496.42 3836.19,-30496.42"/>
</g>
<!-- stage0_layer1_attn_qkv -->
<g id="node91" class="node">
<title>stage0_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4064.19,-30382.12 3601.19,-30382.12 3601.19,-30314.12 4064.19,-30314.12 4064.19,-30382.12"/>
<text text-anchor="middle" x="3832.69" y="-30366.92" font-family="Times,serif" font-size="14.00">Layer 1 Attention QKV Projection</text>
<text text-anchor="middle" x="3832.69" y="-30351.92" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP: GPU 0&#45;127)</text>
<text text-anchor="middle" x="3832.69" y="-30336.92" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-30321.92" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage0_layer1_ln&#45;&gt;stage0_layer1_attn_qkv -->
<g id="edge117" class="edge">
<title>stage0_layer1_ln&#45;&gt;stage0_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3832.69,-30418.01C3832.69,-30409.9 3832.69,-30401.1 3832.69,-30392.59"/>
<polygon fill="black" stroke="black" points="3836.19,-30392.42 3832.69,-30382.42 3829.19,-30392.42 3836.19,-30392.42"/>
</g>
<!-- stage0_layer1_tp_qkv_comm -->
<g id="node92" class="node">
<title>stage0_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-30230.04" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3832.69" y="-30248.84" font-family="Times,serif" font-size="14.00">Layer 1 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3832.69" y="-30233.84" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP pairs)</text>
<text text-anchor="middle" x="3832.69" y="-30218.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-30203.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage0_layer1_attn_qkv&#45;&gt;stage0_layer1_tp_qkv_comm -->
<g id="edge118" class="edge">
<title>stage0_layer1_attn_qkv&#45;&gt;stage0_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3832.69,-30313.86C3832.69,-30305.86 3832.69,-30297.1 3832.69,-30288.35"/>
<polygon fill="black" stroke="black" points="3836.19,-30288.15 3832.69,-30278.15 3829.19,-30288.15 3836.19,-30288.15"/>
</g>
<!-- stage0_layer1_attn_head0 -->
<g id="node93" class="node">
<title>stage0_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1641.19,-30145.96 1368.19,-30145.96 1368.19,-30093.96 1641.19,-30093.96 1641.19,-30145.96"/>
<text text-anchor="middle" x="1504.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 0 Attention</text>
<text text-anchor="middle" x="1504.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 0)</text>
<text text-anchor="middle" x="1504.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1504.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head0 -->
<g id="edge119" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3509.67,-30222.01C2997.05,-30209.98 2018.56,-30183.18 1651.38,-30146.06"/>
<polygon fill="black" stroke="black" points="1651.54,-30142.56 1641.23,-30145.02 1650.82,-30149.52 1651.54,-30142.56"/>
</g>
<!-- stage0_layer1_attn_head1 -->
<g id="node94" class="node">
<title>stage0_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1932.19,-30145.96 1659.19,-30145.96 1659.19,-30093.96 1932.19,-30093.96 1932.19,-30145.96"/>
<text text-anchor="middle" x="1795.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 1 Attention</text>
<text text-anchor="middle" x="1795.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 1)</text>
<text text-anchor="middle" x="1795.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1795.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head1 -->
<g id="edge120" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3505.73,-30227.25C3130.12,-30222.3 2495.43,-30205.09 1942.41,-30146.09"/>
<polygon fill="black" stroke="black" points="1942.55,-30142.58 1932.23,-30144.99 1941.8,-30149.54 1942.55,-30142.58"/>
</g>
<!-- stage0_layer1_attn_head2 -->
<g id="node95" class="node">
<title>stage0_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2223.19,-30145.96 1950.19,-30145.96 1950.19,-30093.96 2223.19,-30093.96 2223.19,-30145.96"/>
<text text-anchor="middle" x="2086.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 2 Attention</text>
<text text-anchor="middle" x="2086.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 2)</text>
<text text-anchor="middle" x="2086.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2086.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head2 -->
<g id="edge121" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3508.26,-30223.5C3186.63,-30215.38 2679.92,-30195.49 2233.44,-30146.1"/>
<polygon fill="black" stroke="black" points="2233.56,-30142.59 2223.24,-30144.96 2232.79,-30149.55 2233.56,-30142.59"/>
</g>
<!-- stage0_layer1_attn_head3 -->
<g id="node96" class="node">
<title>stage0_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2514.19,-30145.96 2241.19,-30145.96 2241.19,-30093.96 2514.19,-30093.96 2514.19,-30145.96"/>
<text text-anchor="middle" x="2377.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 3 Attention</text>
<text text-anchor="middle" x="2377.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 3)</text>
<text text-anchor="middle" x="2377.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2377.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head3 -->
<g id="edge122" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3514.84,-30218.44C3251.62,-30207.39 2867.78,-30186.06 2524.39,-30146.11"/>
<polygon fill="black" stroke="black" points="2524.58,-30142.61 2514.24,-30144.92 2523.77,-30149.56 2524.58,-30142.61"/>
</g>
<!-- stage0_layer1_attn_head4 -->
<g id="node97" class="node">
<title>stage0_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2805.19,-30145.96 2532.19,-30145.96 2532.19,-30093.96 2805.19,-30093.96 2805.19,-30145.96"/>
<text text-anchor="middle" x="2668.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 4 Attention</text>
<text text-anchor="middle" x="2668.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 4)</text>
<text text-anchor="middle" x="2668.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2668.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head4 -->
<g id="edge123" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3530.43,-30211.5C3330.07,-30198.16 3061.29,-30176.97 2815.46,-30146.14"/>
<polygon fill="black" stroke="black" points="2815.61,-30142.63 2805.25,-30144.85 2814.73,-30149.57 2815.61,-30142.63"/>
</g>
<!-- stage0_layer1_attn_head5 -->
<g id="node98" class="node">
<title>stage0_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3096.19,-30145.96 2823.19,-30145.96 2823.19,-30093.96 3096.19,-30093.96 3096.19,-30145.96"/>
<text text-anchor="middle" x="2959.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 5 Attention</text>
<text text-anchor="middle" x="2959.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 5)</text>
<text text-anchor="middle" x="2959.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2959.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head5 -->
<g id="edge124" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3565.12,-30202.2C3430.28,-30187.76 3264.06,-30168.57 3106.62,-30146.2"/>
<polygon fill="black" stroke="black" points="3106.66,-30142.67 3096.27,-30144.73 3105.67,-30149.6 3106.66,-30142.67"/>
</g>
<!-- stage0_layer1_attn_head6 -->
<g id="node99" class="node">
<title>stage0_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3387.19,-30145.96 3114.19,-30145.96 3114.19,-30093.96 3387.19,-30093.96 3387.19,-30145.96"/>
<text text-anchor="middle" x="3250.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 6 Attention</text>
<text text-anchor="middle" x="3250.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 6)</text>
<text text-anchor="middle" x="3250.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3250.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head6 -->
<g id="edge125" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3632.8,-30191.92C3554.89,-30177.45 3467.29,-30161.18 3395.64,-30147.87"/>
<polygon fill="black" stroke="black" points="3396.1,-30144.4 3385.63,-30146.02 3394.83,-30151.28 3396.1,-30144.4"/>
</g>
<!-- stage0_layer1_attn_head7 -->
<g id="node100" class="node">
<title>stage0_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3678.19,-30145.96 3405.19,-30145.96 3405.19,-30093.96 3678.19,-30093.96 3678.19,-30145.96"/>
<text text-anchor="middle" x="3541.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 7 Attention</text>
<text text-anchor="middle" x="3541.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 7)</text>
<text text-anchor="middle" x="3541.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3541.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head7 -->
<g id="edge126" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3714.33,-30185.08C3682.09,-30173.11 3648.02,-30160.45 3618.74,-30149.57"/>
<polygon fill="black" stroke="black" points="3619.59,-30146.16 3609,-30145.96 3617.15,-30152.72 3619.59,-30146.16"/>
</g>
<!-- stage0_layer1_attn_ellipsis -->
<g id="node101" class="node">
<title>stage0_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3969.19,-30145.96 3696.19,-30145.96 3696.19,-30093.96 3969.19,-30093.96 3969.19,-30145.96"/>
<text text-anchor="middle" x="3832.69" y="-30133.96" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3832.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_ellipsis -->
<g id="edge127" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3832.69,-30181.95C3832.69,-30173.4 3832.69,-30164.62 3832.69,-30156.48"/>
<polygon fill="black" stroke="black" points="3836.19,-30156.22 3832.69,-30146.22 3829.19,-30156.22 3836.19,-30156.22"/>
</g>
<!-- stage0_layer1_attn_head24 -->
<g id="node102" class="node">
<title>stage0_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4260.19,-30145.96 3987.19,-30145.96 3987.19,-30093.96 4260.19,-30093.96 4260.19,-30145.96"/>
<text text-anchor="middle" x="4123.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 24 Attention</text>
<text text-anchor="middle" x="4123.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 24)</text>
<text text-anchor="middle" x="4123.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4123.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head24 -->
<g id="edge128" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3951.05,-30185.08C3983.28,-30173.11 4017.36,-30160.45 4046.64,-30149.57"/>
<polygon fill="black" stroke="black" points="4048.22,-30152.72 4056.38,-30145.96 4045.79,-30146.16 4048.22,-30152.72"/>
</g>
<!-- stage0_layer1_attn_head25 -->
<g id="node103" class="node">
<title>stage0_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4551.19,-30145.96 4278.19,-30145.96 4278.19,-30093.96 4551.19,-30093.96 4551.19,-30145.96"/>
<text text-anchor="middle" x="4414.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 25 Attention</text>
<text text-anchor="middle" x="4414.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 25)</text>
<text text-anchor="middle" x="4414.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4414.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head25 -->
<g id="edge129" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M4032.57,-30191.92C4110.48,-30177.45 4198.09,-30161.18 4269.74,-30147.87"/>
<polygon fill="black" stroke="black" points="4270.55,-30151.28 4279.74,-30146.02 4269.27,-30144.4 4270.55,-30151.28"/>
</g>
<!-- stage0_layer1_attn_head26 -->
<g id="node104" class="node">
<title>stage0_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4842.19,-30145.96 4569.19,-30145.96 4569.19,-30093.96 4842.19,-30093.96 4842.19,-30145.96"/>
<text text-anchor="middle" x="4705.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 26 Attention</text>
<text text-anchor="middle" x="4705.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 26)</text>
<text text-anchor="middle" x="4705.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4705.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head26 -->
<g id="edge130" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4099.45,-30202.16C4234.31,-30187.67 4400.69,-30168.45 4559.01,-30146.02"/>
<polygon fill="black" stroke="black" points="4559.54,-30149.48 4568.95,-30144.61 4558.55,-30142.55 4559.54,-30149.48"/>
</g>
<!-- stage0_layer1_attn_head27 -->
<g id="node105" class="node">
<title>stage0_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5133.19,-30145.96 4860.19,-30145.96 4860.19,-30093.96 5133.19,-30093.96 5133.19,-30145.96"/>
<text text-anchor="middle" x="4996.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 27 Attention</text>
<text text-anchor="middle" x="4996.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 27)</text>
<text text-anchor="middle" x="4996.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4996.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head27 -->
<g id="edge131" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4134.64,-30211.4C4334.8,-30198.01 4603.31,-30176.82 4849.73,-30146.03"/>
<polygon fill="black" stroke="black" points="4850.48,-30149.46 4859.96,-30144.74 4849.61,-30142.52 4850.48,-30149.46"/>
</g>
<!-- stage0_layer1_attn_head28 -->
<g id="node106" class="node">
<title>stage0_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5424.19,-30145.96 5151.19,-30145.96 5151.19,-30093.96 5424.19,-30093.96 5424.19,-30145.96"/>
<text text-anchor="middle" x="5287.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 28 Attention</text>
<text text-anchor="middle" x="5287.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 28)</text>
<text text-anchor="middle" x="5287.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5287.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head28 -->
<g id="edge132" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4150.28,-30218.32C4413.3,-30207.21 4796.83,-30185.85 5140.81,-30146"/>
<polygon fill="black" stroke="black" points="5141.45,-30149.45 5150.97,-30144.82 5140.64,-30142.5 5141.45,-30149.45"/>
</g>
<!-- stage0_layer1_attn_head29 -->
<g id="node107" class="node">
<title>stage0_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5715.19,-30145.96 5442.19,-30145.96 5442.19,-30093.96 5715.19,-30093.96 5715.19,-30145.96"/>
<text text-anchor="middle" x="5578.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 29 Attention</text>
<text text-anchor="middle" x="5578.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 29)</text>
<text text-anchor="middle" x="5578.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5578.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head29 -->
<g id="edge133" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4157.28,-30223.37C4478.72,-30215.15 4984.89,-30195.19 5431.77,-30146"/>
<polygon fill="black" stroke="black" points="5432.43,-30149.45 5441.98,-30144.87 5431.66,-30142.49 5432.43,-30149.45"/>
</g>
<!-- stage0_layer1_attn_head30 -->
<g id="node108" class="node">
<title>stage0_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="6006.19,-30145.96 5733.19,-30145.96 5733.19,-30093.96 6006.19,-30093.96 6006.19,-30145.96"/>
<text text-anchor="middle" x="5869.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 30 Attention</text>
<text text-anchor="middle" x="5869.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 30)</text>
<text text-anchor="middle" x="5869.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5869.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head30 -->
<g id="edge134" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4159.89,-30227.12C4535.34,-30222.05 5169.41,-30204.73 5722.8,-30145.99"/>
<polygon fill="black" stroke="black" points="5723.41,-30149.44 5732.98,-30144.9 5722.67,-30142.48 5723.41,-30149.44"/>
</g>
<!-- stage0_layer1_attn_head31 -->
<g id="node109" class="node">
<title>stage0_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6297.19,-30145.96 6024.19,-30145.96 6024.19,-30093.96 6297.19,-30093.96 6297.19,-30145.96"/>
<text text-anchor="middle" x="6160.69" y="-30133.96" font-family="Times,serif" font-size="10.00">Layer 1 Head 31 Attention</text>
<text text-anchor="middle" x="6160.69" y="-30122.96" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Head 31)</text>
<text text-anchor="middle" x="6160.69" y="-30111.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6160.69" y="-30100.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head31 -->
<g id="edge135" class="edge">
<title>stage0_layer1_tp_qkv_comm&#45;&gt;stage0_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4155.55,-30221.96C4667.93,-30209.86 5645.97,-30182.97 6013.81,-30145.97"/>
<polygon fill="black" stroke="black" points="6014.39,-30149.43 6023.99,-30144.92 6013.68,-30142.46 6014.39,-30149.43"/>
</g>
<!-- stage0_layer1_attn_agg -->
<g id="node110" class="node">
<title>stage0_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4300.34,-30057.96 3556.41,-30057.96 3365.04,-29921.96 4108.97,-29921.96 4300.34,-30057.96"/>
<text text-anchor="middle" x="3832.69" y="-30008.76" font-family="Times,serif" font-size="14.00">Layer 1 Attention Aggregate</text>
<text text-anchor="middle" x="3832.69" y="-29993.76" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-29978.76" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-29963.76" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_attn_head0&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge136" class="edge">
<title>stage0_layer1_attn_head0&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1641.23,-30094.93C1644.07,-30094.59 1646.9,-30094.26 1649.69,-30093.96 2281.18,-30024.89 3020.43,-30002.1 3456.36,-29994.61"/>
<polygon fill="black" stroke="black" points="3456.67,-29998.1 3466.61,-29994.43 3456.55,-29991.11 3456.67,-29998.1"/>
</g>
<!-- stage0_layer1_attn_head1&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge137" class="edge">
<title>stage0_layer1_attn_head1&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1932.24,-30094.96C1935.08,-30094.61 1937.9,-30094.27 1940.69,-30093.96 2466.99,-30034.46 3079.69,-30009.06 3461.91,-29998.4"/>
<polygon fill="black" stroke="black" points="3462.12,-30001.9 3472.02,-29998.12 3461.93,-29994.9 3462.12,-30001.9"/>
</g>
<!-- stage0_layer1_attn_head2&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge138" class="edge">
<title>stage0_layer1_attn_head2&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2223.24,-30095C2226.08,-30094.63 2228.9,-30094.29 2231.69,-30093.96 2654.66,-30044.03 3143.57,-30017 3468.72,-30003.32"/>
<polygon fill="black" stroke="black" points="3468.93,-30006.82 3478.77,-30002.9 3468.63,-29999.82 3468.93,-30006.82"/>
</g>
<!-- stage0_layer1_attn_head3&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge139" class="edge">
<title>stage0_layer1_attn_head3&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2514.25,-30095.05C2517.08,-30094.67 2519.9,-30094.3 2522.69,-30093.96 2844.79,-30053.61 3213.56,-30026.3 3477.59,-30009.99"/>
<polygon fill="black" stroke="black" points="3477.96,-30013.47 3487.72,-30009.36 3477.53,-30006.48 3477.96,-30013.47"/>
</g>
<!-- stage0_layer1_attn_head4&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge140" class="edge">
<title>stage0_layer1_attn_head4&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2805.26,-30095.13C2808.09,-30094.73 2810.9,-30094.34 2813.69,-30093.96 3038.59,-30063.24 3292.58,-30037.54 3490.72,-30019.5"/>
<polygon fill="black" stroke="black" points="3491.07,-30022.98 3500.71,-30018.59 3490.43,-30016.01 3491.07,-30022.98"/>
</g>
<!-- stage0_layer1_attn_head5&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge141" class="edge">
<title>stage0_layer1_attn_head5&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3096.28,-30095.29C3099.11,-30094.84 3101.91,-30094.39 3104.69,-30093.96 3237.44,-30073.12 3384.12,-30052.01 3510.83,-30034.36"/>
<polygon fill="black" stroke="black" points="3511.65,-30037.78 3521.08,-30032.94 3510.69,-30030.85 3511.65,-30037.78"/>
</g>
<!-- stage0_layer1_attn_head6&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge142" class="edge">
<title>stage0_layer1_attn_head6&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3364.63,-30093.9C3415.21,-30082.77 3477.29,-30069.12 3539.5,-30055.44"/>
<polygon fill="black" stroke="black" points="3540.47,-30058.81 3549.49,-30053.24 3538.97,-30051.97 3540.47,-30058.81"/>
</g>
<!-- stage0_layer1_attn_head7&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge143" class="edge">
<title>stage0_layer1_attn_head7&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3598.83,-30093.82C3620.01,-30084.51 3645.2,-30073.43 3671.08,-30062.04"/>
<polygon fill="black" stroke="black" points="3672.51,-30065.24 3680.25,-30058.01 3669.69,-30058.83 3672.51,-30065.24"/>
</g>
<!-- stage0_layer1_attn_ellipsis&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge144" class="edge">
<title>stage0_layer1_attn_ellipsis&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3832.69,-30093.67C3832.69,-30086.07 3832.69,-30077.31 3832.69,-30068.17"/>
<polygon fill="black" stroke="black" points="3836.19,-30068.14 3832.69,-30058.14 3829.19,-30068.14 3836.19,-30068.14"/>
</g>
<!-- stage0_layer1_attn_head24&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge145" class="edge">
<title>stage0_layer1_attn_head24&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4066.54,-30093.82C4045.37,-30084.51 4020.18,-30073.43 3994.3,-30062.04"/>
<polygon fill="black" stroke="black" points="3995.69,-30058.83 3985.12,-30058.01 3992.87,-30065.24 3995.69,-30058.83"/>
</g>
<!-- stage0_layer1_attn_head25&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge146" class="edge">
<title>stage0_layer1_attn_head25&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4300.74,-30093.9C4256.03,-30084.06 4202.31,-30072.25 4147.45,-30060.18"/>
<polygon fill="black" stroke="black" points="4148.08,-30056.74 4137.56,-30058.01 4146.58,-30063.57 4148.08,-30056.74"/>
</g>
<!-- stage0_layer1_attn_head26&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge147" class="edge">
<title>stage0_layer1_attn_head26&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4568.93,-30095.42C4565.82,-30094.92 4562.74,-30094.43 4559.69,-30093.96 4477.61,-30081.12 4390.21,-30068.14 4305.51,-30055.93"/>
<polygon fill="black" stroke="black" points="4305.86,-30052.44 4295.46,-30054.48 4304.86,-30059.37 4305.86,-30052.44"/>
</g>
<!-- stage0_layer1_attn_head27&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge148" class="edge">
<title>stage0_layer1_attn_head27&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4859.95,-30095.25C4856.84,-30094.8 4853.75,-30094.37 4850.69,-30093.96 4660.01,-30068.02 4448.43,-30045.59 4267.77,-30028.34"/>
<polygon fill="black" stroke="black" points="4267.84,-30024.83 4257.56,-30027.37 4267.18,-30031.8 4267.84,-30024.83"/>
</g>
<!-- stage0_layer1_attn_head28&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge149" class="edge">
<title>stage0_layer1_attn_head28&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5150.97,-30095.16C5147.85,-30094.74 5144.75,-30094.34 5141.69,-30093.96 4843.68,-30056.8 4505.74,-30030.6 4247.88,-30013.93"/>
<polygon fill="black" stroke="black" points="4247.79,-30010.42 4237.59,-30013.27 4247.34,-30017.41 4247.79,-30010.42"/>
</g>
<!-- stage0_layer1_attn_head29&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge150" class="edge">
<title>stage0_layer1_attn_head29&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5441.97,-30095.1C5438.85,-30094.7 5435.75,-30094.32 5432.69,-30093.96 5026.71,-30046.26 4559.99,-30019.39 4235.82,-30005.15"/>
<polygon fill="black" stroke="black" points="4235.94,-30001.65 4225.79,-30004.71 4235.63,-30008.65 4235.94,-30001.65"/>
</g>
<!-- stage0_layer1_attn_head30&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge151" class="edge">
<title>stage0_layer1_attn_head30&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5732.98,-30095.06C5729.85,-30094.67 5726.75,-30094.3 5723.69,-30093.96 5208.76,-30036.04 4611.15,-30010.4 4227.82,-29999.24"/>
<polygon fill="black" stroke="black" points="4227.77,-29995.74 4217.67,-29998.95 4227.57,-30002.73 4227.77,-29995.74"/>
</g>
<!-- stage0_layer1_attn_head31&#45;&gt;stage0_layer1_attn_agg -->
<g id="edge152" class="edge">
<title>stage0_layer1_attn_head31&#45;&gt;stage0_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M6023.98,-30095.02C6020.86,-30094.65 6017.76,-30094.29 6014.69,-30093.96 5389.76,-30025.96 4659.31,-30002.84 4221.99,-29994.98"/>
<polygon fill="black" stroke="black" points="4221.77,-29991.48 4211.71,-29994.8 4221.65,-29998.48 4221.77,-29991.48"/>
</g>
<!-- stage0_layer1_attn_out -->
<g id="node111" class="node">
<title>stage0_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="4057.69,-29885.96 3607.69,-29885.96 3607.69,-29817.96 4057.69,-29817.96 4057.69,-29885.96"/>
<text text-anchor="middle" x="3832.69" y="-29870.76" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Proj</text>
<text text-anchor="middle" x="3832.69" y="-29855.76" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP: GPU 0&#45;127)</text>
<text text-anchor="middle" x="3832.69" y="-29840.76" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-29825.76" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_attn_agg&#45;&gt;stage0_layer1_attn_out -->
<g id="edge153" class="edge">
<title>stage0_layer1_attn_agg&#45;&gt;stage0_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3832.69,-29921.75C3832.69,-29913 3832.69,-29904.23 3832.69,-29896.02"/>
<polygon fill="black" stroke="black" points="3836.19,-29895.97 3832.69,-29885.97 3829.19,-29895.97 3836.19,-29895.97"/>
</g>
<!-- stage0_layer1_tp_attn_comm -->
<g id="node112" class="node">
<title>stage0_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-29733.87" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3832.69" y="-29752.67" font-family="Times,serif" font-size="14.00">Layer 1 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3832.69" y="-29737.67" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0 (TP pairs)</text>
<text text-anchor="middle" x="3832.69" y="-29722.67" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-29707.67" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_attn_out&#45;&gt;stage0_layer1_tp_attn_comm -->
<g id="edge154" class="edge">
<title>stage0_layer1_attn_out&#45;&gt;stage0_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3832.69,-29817.69C3832.69,-29809.7 3832.69,-29800.93 3832.69,-29792.19"/>
<polygon fill="black" stroke="black" points="3836.19,-29791.98 3832.69,-29781.98 3829.19,-29791.98 3836.19,-29791.98"/>
</g>
<!-- stage0_layer1_expert_router -->
<g id="node113" class="node">
<title>stage0_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4286.88,-29649.79 3564.36,-29649.79 3378.49,-29513.79 4101.02,-29513.79 4286.88,-29649.79"/>
<text text-anchor="middle" x="3832.69" y="-29600.59" font-family="Times,serif" font-size="14.00">Layer 1 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3832.69" y="-29585.59" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-29570.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-29555.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage0_layer1_tp_attn_comm&#45;&gt;stage0_layer1_expert_router -->
<g id="edge155" class="edge">
<title>stage0_layer1_tp_attn_comm&#45;&gt;stage0_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3832.69,-29685.39C3832.69,-29677.3 3832.69,-29668.72 3832.69,-29660.1"/>
<polygon fill="black" stroke="black" points="3836.19,-29659.98 3832.69,-29649.98 3829.19,-29659.98 3836.19,-29659.98"/>
</g>
<!-- stage0_layer1_expert0 -->
<g id="node114" class="node">
<title>stage0_layer1_expert0</title>
<polygon fill="none" stroke="black" points="2001.69,-29477.79 1679.69,-29477.79 1679.69,-29425.79 2001.69,-29425.79 2001.69,-29477.79"/>
<text text-anchor="middle" x="1840.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 0</text>
<text text-anchor="middle" x="1840.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP pair)</text>
<text text-anchor="middle" x="1840.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1840.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert0 -->
<g id="edge156" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3451.96,-29567.56C3086.02,-29552.83 2517.71,-29524.72 2026.69,-29477.79 2021.87,-29477.33 2016.99,-29476.84 2012.07,-29476.32"/>
<polygon fill="black" stroke="black" points="2012.22,-29472.82 2001.91,-29475.23 2011.47,-29479.78 2012.22,-29472.82"/>
</g>
<!-- stage0_layer1_expert1 -->
<g id="node120" class="node">
<title>stage0_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2357.69,-29477.79 2035.69,-29477.79 2035.69,-29425.79 2357.69,-29425.79 2357.69,-29477.79"/>
<text text-anchor="middle" x="2196.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 1</text>
<text text-anchor="middle" x="2196.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP pair)</text>
<text text-anchor="middle" x="2196.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2196.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert1 -->
<g id="edge162" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3426.44,-29549C3086.11,-29522.38 2617.14,-29485.68 2368.16,-29466.2"/>
<polygon fill="black" stroke="black" points="2368.18,-29462.7 2357.93,-29465.4 2367.63,-29469.67 2368.18,-29462.7"/>
</g>
<!-- stage0_layer1_expert2 -->
<g id="node126" class="node">
<title>stage0_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2851.69,-29477.79 2529.69,-29477.79 2529.69,-29425.79 2851.69,-29425.79 2851.69,-29477.79"/>
<text text-anchor="middle" x="2690.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 2</text>
<text text-anchor="middle" x="2690.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP pair)</text>
<text text-anchor="middle" x="2690.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2690.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert2 -->
<g id="edge168" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3404.2,-29532.76C3215.84,-29511.65 3005.38,-29488.06 2862.16,-29472.01"/>
<polygon fill="black" stroke="black" points="2862.29,-29468.5 2851.96,-29470.87 2861.51,-29475.46 2862.29,-29468.5"/>
</g>
<!-- stage0_layer1_expert3 -->
<g id="node132" class="node">
<title>stage0_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3261.69,-29477.79 2939.69,-29477.79 2939.69,-29425.79 3261.69,-29425.79 3261.69,-29477.79"/>
<text text-anchor="middle" x="3100.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 3</text>
<text text-anchor="middle" x="3100.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP pair)</text>
<text text-anchor="middle" x="3100.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3100.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert3 -->
<g id="edge174" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3449.27,-29513.74C3379.98,-29501.63 3311.53,-29489.66 3253.88,-29479.58"/>
<polygon fill="black" stroke="black" points="3254.43,-29476.12 3243.98,-29477.85 3253.23,-29483.02 3254.43,-29476.12"/>
</g>
<!-- stage0_layer1_expert31 -->
<g id="node138" class="node">
<title>stage0_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3636.69,-29477.79 3314.69,-29477.79 3314.69,-29425.79 3636.69,-29425.79 3636.69,-29477.79"/>
<text text-anchor="middle" x="3475.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 31</text>
<text text-anchor="middle" x="3475.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP pair)</text>
<text text-anchor="middle" x="3475.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3475.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert31 -->
<g id="edge180" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3645.56,-29513.7C3613.74,-29502.29 3582.29,-29491.01 3555.26,-29481.32"/>
<polygon fill="black" stroke="black" points="3556.1,-29477.9 3545.51,-29477.82 3553.74,-29484.49 3556.1,-29477.9"/>
</g>
<!-- stage0_layer1_expert32 -->
<g id="node144" class="node">
<title>stage0_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3993.69,-29477.79 3671.69,-29477.79 3671.69,-29425.79 3993.69,-29425.79 3993.69,-29477.79"/>
<text text-anchor="middle" x="3832.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 32</text>
<text text-anchor="middle" x="3832.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP pair)</text>
<text text-anchor="middle" x="3832.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert32 -->
<g id="edge186" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3832.69,-29513.42C3832.69,-29504.72 3832.69,-29496.11 3832.69,-29488.22"/>
<polygon fill="black" stroke="black" points="3836.19,-29487.98 3832.69,-29477.98 3829.19,-29487.98 3836.19,-29487.98"/>
</g>
<!-- stage0_layer1_expert60 -->
<g id="node150" class="node">
<title>stage0_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4372.69,-29477.79 4050.69,-29477.79 4050.69,-29425.79 4372.69,-29425.79 4372.69,-29477.79"/>
<text text-anchor="middle" x="4211.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 60</text>
<text text-anchor="middle" x="4211.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP pair)</text>
<text text-anchor="middle" x="4211.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4211.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert60 -->
<g id="edge192" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4031.35,-29513.7C4065.42,-29502.19 4099.1,-29490.81 4127.97,-29481.06"/>
<polygon fill="black" stroke="black" points="4129.21,-29484.34 4137.56,-29477.82 4126.97,-29477.71 4129.21,-29484.34"/>
</g>
<!-- stage0_layer1_expert61 -->
<g id="node156" class="node">
<title>stage0_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4774.69,-29477.79 4452.69,-29477.79 4452.69,-29425.79 4774.69,-29425.79 4774.69,-29477.79"/>
<text text-anchor="middle" x="4613.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 61</text>
<text text-anchor="middle" x="4613.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP pair)</text>
<text text-anchor="middle" x="4613.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4613.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert61 -->
<g id="edge198" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4126.84,-29532.58C4236.56,-29514.6 4357.11,-29494.84 4450.8,-29479.48"/>
<polygon fill="black" stroke="black" points="4451.63,-29482.9 4460.94,-29477.82 4450.5,-29475.99 4451.63,-29482.9"/>
</g>
<!-- stage0_layer1_expert62 -->
<g id="node162" class="node">
<title>stage0_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5176.69,-29477.79 4854.69,-29477.79 4854.69,-29425.79 5176.69,-29425.79 5176.69,-29477.79"/>
<text text-anchor="middle" x="5015.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 62</text>
<text text-anchor="middle" x="5015.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP pair)</text>
<text text-anchor="middle" x="5015.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5015.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert62 -->
<g id="edge204" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4146.6,-29546.82C4370.15,-29522.64 4662.1,-29491.05 4844.25,-29471.34"/>
<polygon fill="black" stroke="black" points="4844.9,-29474.79 4854.46,-29470.23 4844.14,-29467.83 4844.9,-29474.79"/>
</g>
<!-- stage0_layer1_expert63 -->
<g id="node168" class="node">
<title>stage0_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5547.69,-29477.79 5225.69,-29477.79 5225.69,-29425.79 5547.69,-29425.79 5547.69,-29477.79"/>
<text text-anchor="middle" x="5386.69" y="-29465.79" font-family="Times,serif" font-size="10.00">Layer 1 Expert 63</text>
<text text-anchor="middle" x="5386.69" y="-29454.79" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP pair)</text>
<text text-anchor="middle" x="5386.69" y="-29443.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5386.69" y="-29432.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert63 -->
<g id="edge210" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4164.27,-29559.98C4438.41,-29541.71 4837.75,-29512.65 5185.69,-29477.79 5195.4,-29476.82 5205.36,-29475.76 5215.42,-29474.65"/>
<polygon fill="black" stroke="black" points="5215.94,-29478.11 5225.49,-29473.53 5215.17,-29471.16 5215.94,-29478.11"/>
</g>
<!-- stage0_layer1_expert_ellipsis -->
<g id="node174" class="node">
<title>stage0_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6125.69,-29389.79 5803.69,-29389.79 5803.69,-29337.79 6125.69,-29337.79 6125.69,-29389.79"/>
<text text-anchor="middle" x="5964.69" y="-29377.79" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5964.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: Pipeline 0 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5964.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5964.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert_ellipsis -->
<g id="edge216" class="edge">
<title>stage0_layer1_expert_router&#45;&gt;stage0_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4176.32,-29568.83C4601.46,-29552.53 5300.48,-29520.43 5556.69,-29477.79 5671.82,-29458.63 5801.1,-29419.76 5882.68,-29393"/>
<polygon fill="black" stroke="black" points="5883.99,-29396.26 5892.39,-29389.8 5881.8,-29389.61 5883.99,-29396.26"/>
</g>
<!-- stage0_layer1_expert0_mlp1 -->
<g id="node115" class="node">
<title>stage0_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1851.69,-29389.79 1537.69,-29389.79 1537.69,-29337.79 1851.69,-29337.79 1851.69,-29389.79"/>
<text text-anchor="middle" x="1694.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1694.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1694.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1694.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert0&#45;&gt;stage0_layer1_expert0_mlp1 -->
<g id="edge157" class="edge">
<title>stage0_layer1_expert0&#45;&gt;stage0_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1798.07,-29425.68C1781.8,-29416.1 1763.08,-29405.07 1746.07,-29395.06"/>
<polygon fill="black" stroke="black" points="1747.76,-29391.99 1737.36,-29389.93 1744.2,-29398.02 1747.76,-29391.99"/>
</g>
<!-- stage0_layer1_expert0_tp1 -->
<g id="node116" class="node">
<title>stage0_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1636.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1636.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1636.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="1636.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1636.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert0_mlp1&#45;&gt;stage0_layer1_expert0_tp1 -->
<g id="edge158" class="edge">
<title>stage0_layer1_expert0_mlp1&#45;&gt;stage0_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1679.6,-29337.62C1674.62,-29329.3 1668.91,-29319.78 1663.32,-29310.46"/>
<polygon fill="black" stroke="black" points="1666.17,-29308.41 1658.03,-29301.63 1660.17,-29312.01 1666.17,-29308.41"/>
</g>
<!-- stage0_layer1_expert0_act -->
<g id="node117" class="node">
<title>stage0_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1699.19,-29192.25 1418.19,-29192.25 1418.19,-29140.25 1699.19,-29140.25 1699.19,-29192.25"/>
<text text-anchor="middle" x="1558.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1558.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="1558.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1558.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert0_tp1&#45;&gt;stage0_layer1_expert0_act -->
<g id="edge159" class="edge">
<title>stage0_layer1_expert0_tp1&#45;&gt;stage0_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1608.09,-29228.54C1600.7,-29219.37 1592.77,-29209.53 1585.48,-29200.48"/>
<polygon fill="black" stroke="black" points="1587.99,-29198.03 1578.99,-29192.44 1582.54,-29202.42 1587.99,-29198.03"/>
</g>
<!-- stage0_layer1_expert0_mlp2 -->
<g id="node118" class="node">
<title>stage0_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1699.69,-29104.25 1377.69,-29104.25 1377.69,-29052.25 1699.69,-29052.25 1699.69,-29104.25"/>
<text text-anchor="middle" x="1538.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1538.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1538.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1538.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert0_act&#45;&gt;stage0_layer1_expert0_mlp2 -->
<g id="edge160" class="edge">
<title>stage0_layer1_expert0_act&#45;&gt;stage0_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1552.8,-29139.91C1550.92,-29131.86 1548.82,-29122.82 1546.82,-29114.21"/>
<polygon fill="black" stroke="black" points="1550.21,-29113.35 1544.54,-29104.41 1543.39,-29114.94 1550.21,-29113.35"/>
</g>
<!-- stage0_layer1_expert0_tp2 -->
<g id="node119" class="node">
<title>stage0_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1467.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1467.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1467.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="1467.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1467.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert0_mlp2&#45;&gt;stage0_layer1_expert0_tp2 -->
<g id="edge161" class="edge">
<title>stage0_layer1_expert0_mlp2&#45;&gt;stage0_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1520.22,-29052.08C1513.99,-29043.59 1506.85,-29033.85 1499.87,-29024.35"/>
<polygon fill="black" stroke="black" points="1502.55,-29022.08 1493.82,-29016.09 1496.91,-29026.22 1502.55,-29022.08"/>
</g>
<!-- stage0_layer1_expert_agg -->
<g id="node175" class="node">
<title>stage0_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4383.22,-28906.71 3507.45,-28906.71 3282.16,-28770.71 4157.93,-28770.71 4383.22,-28906.71"/>
<text text-anchor="middle" x="3832.69" y="-28857.51" font-family="Times,serif" font-size="14.00">Layer 1 Expert Aggregation</text>
<text text-anchor="middle" x="3832.69" y="-28842.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-28827.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28812.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert0_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge217" class="edge">
<title>stage0_layer1_expert0_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1623.23,-28952.61C1650.01,-28948.81 1677.61,-28945.31 1703.69,-28942.71 2288.93,-28884.36 2968.1,-28858.76 3398.99,-28847.74"/>
<polygon fill="black" stroke="black" points="3399.22,-28851.23 3409.12,-28847.48 3399.04,-28844.23 3399.22,-28851.23"/>
</g>
<!-- stage0_layer1_expert1_mlp1 -->
<g id="node121" class="node">
<title>stage0_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2228.69,-29389.79 1914.69,-29389.79 1914.69,-29337.79 2228.69,-29337.79 2228.69,-29389.79"/>
<text text-anchor="middle" x="2071.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2071.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2071.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2071.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert1&#45;&gt;stage0_layer1_expert1_mlp1 -->
<g id="edge163" class="edge">
<title>stage0_layer1_expert1&#45;&gt;stage0_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2160.2,-29425.68C2146.71,-29416.4 2131.26,-29405.77 2117.08,-29396.02"/>
<polygon fill="black" stroke="black" points="2118.66,-29392.86 2108.44,-29390.08 2114.7,-29398.63 2118.66,-29392.86"/>
</g>
<!-- stage0_layer1_expert1_tp1 -->
<g id="node122" class="node">
<title>stage0_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2055.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2055.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2055.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="2055.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2055.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert1_mlp1&#45;&gt;stage0_layer1_expert1_tp1 -->
<g id="edge164" class="edge">
<title>stage0_layer1_expert1_mlp1&#45;&gt;stage0_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2067.53,-29337.62C2066.22,-29329.72 2064.74,-29320.75 2063.27,-29311.89"/>
<polygon fill="black" stroke="black" points="2066.72,-29311.29 2061.64,-29302 2059.82,-29312.43 2066.72,-29311.29"/>
</g>
<!-- stage0_layer1_expert1_act -->
<g id="node123" class="node">
<title>stage0_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2140.19,-29192.25 1859.19,-29192.25 1859.19,-29140.25 2140.19,-29140.25 2140.19,-29192.25"/>
<text text-anchor="middle" x="1999.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="1999.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="1999.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1999.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert1_tp1&#45;&gt;stage0_layer1_expert1_act -->
<g id="edge165" class="edge">
<title>stage0_layer1_expert1_tp1&#45;&gt;stage0_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2035,-29228.26C2029.86,-29219.39 2024.38,-29209.91 2019.3,-29201.13"/>
<polygon fill="black" stroke="black" points="2022.22,-29199.2 2014.18,-29192.29 2016.16,-29202.7 2022.22,-29199.2"/>
</g>
<!-- stage0_layer1_expert1_mlp2 -->
<g id="node124" class="node">
<title>stage0_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2105.69,-29104.25 1783.69,-29104.25 1783.69,-29052.25 2105.69,-29052.25 2105.69,-29104.25"/>
<text text-anchor="middle" x="1944.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="1944.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1944.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1944.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert1_act&#45;&gt;stage0_layer1_expert1_mlp2 -->
<g id="edge166" class="edge">
<title>stage0_layer1_expert1_act&#45;&gt;stage0_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M1983.48,-29139.91C1978.11,-29131.51 1972.05,-29122.03 1966.33,-29113.09"/>
<polygon fill="black" stroke="black" points="1969.11,-29110.95 1960.78,-29104.41 1963.22,-29114.72 1969.11,-29110.95"/>
</g>
<!-- stage0_layer1_expert1_tp2 -->
<g id="node125" class="node">
<title>stage0_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1940.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1940.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1940.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 2&#45;3</text>
<text text-anchor="middle" x="1940.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1940.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert1_mlp2&#45;&gt;stage0_layer1_expert1_tp2 -->
<g id="edge167" class="edge">
<title>stage0_layer1_expert1_mlp2&#45;&gt;stage0_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M1943.65,-29052.08C1943.33,-29044.27 1942.96,-29035.4 1942.6,-29026.64"/>
<polygon fill="black" stroke="black" points="1946.09,-29026.3 1942.18,-29016.46 1939.09,-29026.59 1946.09,-29026.3"/>
</g>
<!-- stage0_layer1_expert1_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge218" class="edge">
<title>stage0_layer1_expert1_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2097.22,-28952.77C2123.69,-28949 2150.93,-28945.46 2176.69,-28942.71 2595.55,-28898.03 3076.24,-28870.79 3411.44,-28855.64"/>
<polygon fill="black" stroke="black" points="3411.98,-28859.12 3421.81,-28855.17 3411.67,-28852.12 3411.98,-28859.12"/>
</g>
<!-- stage0_layer1_expert2_mlp1 -->
<g id="node127" class="node">
<title>stage0_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2707.69,-29389.79 2393.69,-29389.79 2393.69,-29337.79 2707.69,-29337.79 2707.69,-29389.79"/>
<text text-anchor="middle" x="2550.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2550.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2550.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2550.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert2&#45;&gt;stage0_layer1_expert2_mlp1 -->
<g id="edge169" class="edge">
<title>stage0_layer1_expert2&#45;&gt;stage0_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2649.82,-29425.68C2634.43,-29416.23 2616.75,-29405.37 2600.63,-29395.47"/>
<polygon fill="black" stroke="black" points="2602.2,-29392.33 2591.85,-29390.08 2598.54,-29398.29 2602.2,-29392.33"/>
</g>
<!-- stage0_layer1_expert2_tp1 -->
<g id="node128" class="node">
<title>stage0_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2532.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2532.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2532.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="2532.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2532.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert2_mlp1&#45;&gt;stage0_layer1_expert2_tp1 -->
<g id="edge170" class="edge">
<title>stage0_layer1_expert2_mlp1&#45;&gt;stage0_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2546.01,-29337.62C2544.54,-29329.72 2542.87,-29320.75 2541.22,-29311.89"/>
<polygon fill="black" stroke="black" points="2544.65,-29311.19 2539.38,-29302 2537.77,-29312.47 2544.65,-29311.19"/>
</g>
<!-- stage0_layer1_expert2_act -->
<g id="node129" class="node">
<title>stage0_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2643.19,-29192.25 2362.19,-29192.25 2362.19,-29140.25 2643.19,-29140.25 2643.19,-29192.25"/>
<text text-anchor="middle" x="2502.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2502.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="2502.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2502.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert2_tp1&#45;&gt;stage0_layer1_expert2_act -->
<g id="edge171" class="edge">
<title>stage0_layer1_expert2_tp1&#45;&gt;stage0_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2521.6,-29228.26C2518.94,-29219.67 2516.1,-29210.51 2513.45,-29201.97"/>
<polygon fill="black" stroke="black" points="2516.76,-29200.81 2510.45,-29192.29 2510.07,-29202.88 2516.76,-29200.81"/>
</g>
<!-- stage0_layer1_expert2_mlp2 -->
<g id="node130" class="node">
<title>stage0_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2633.69,-29104.25 2311.69,-29104.25 2311.69,-29052.25 2633.69,-29052.25 2633.69,-29104.25"/>
<text text-anchor="middle" x="2472.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2472.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2472.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2472.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert2_act&#45;&gt;stage0_layer1_expert2_mlp2 -->
<g id="edge172" class="edge">
<title>stage0_layer1_expert2_act&#45;&gt;stage0_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2493.85,-29139.91C2491.01,-29131.78 2487.82,-29122.62 2484.79,-29113.93"/>
<polygon fill="black" stroke="black" points="2488.06,-29112.7 2481.46,-29104.41 2481.45,-29115 2488.06,-29112.7"/>
</g>
<!-- stage0_layer1_expert2_tp2 -->
<g id="node131" class="node">
<title>stage0_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2413.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2413.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2413.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 4&#45;5</text>
<text text-anchor="middle" x="2413.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2413.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert2_mlp2&#45;&gt;stage0_layer1_expert2_tp2 -->
<g id="edge173" class="edge">
<title>stage0_layer1_expert2_mlp2&#45;&gt;stage0_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2457.34,-29052.08C2452.22,-29043.67 2446.35,-29034.05 2440.61,-29024.63"/>
<polygon fill="black" stroke="black" points="2443.59,-29022.81 2435.4,-29016.09 2437.62,-29026.45 2443.59,-29022.81"/>
</g>
<!-- stage0_layer1_expert2_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge219" class="edge">
<title>stage0_layer1_expert2_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2572.18,-28953.04C2598.05,-28949.3 2624.59,-28945.7 2649.69,-28942.71 2909.52,-28911.74 3202.5,-28886.16 3431.9,-28868.24"/>
<polygon fill="black" stroke="black" points="3432.39,-28871.71 3442.09,-28867.45 3431.84,-28864.73 3432.39,-28871.71"/>
</g>
<!-- stage0_layer1_expert3_mlp1 -->
<g id="node133" class="node">
<title>stage0_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3183.69,-29389.79 2869.69,-29389.79 2869.69,-29337.79 3183.69,-29337.79 3183.69,-29389.79"/>
<text text-anchor="middle" x="3026.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3026.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3026.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3026.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert3&#45;&gt;stage0_layer1_expert3_mlp1 -->
<g id="edge175" class="edge">
<title>stage0_layer1_expert3&#45;&gt;stage0_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3078.89,-29425.45C3071.43,-29416.79 3062.99,-29406.97 3055.09,-29397.8"/>
<polygon fill="black" stroke="black" points="3057.51,-29395.24 3048.33,-29389.95 3052.2,-29399.81 3057.51,-29395.24"/>
</g>
<!-- stage0_layer1_expert3_tp1 -->
<g id="node134" class="node">
<title>stage0_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="2978.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2978.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="2978.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="2978.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2978.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert3_mlp1&#45;&gt;stage0_layer1_expert3_tp1 -->
<g id="edge176" class="edge">
<title>stage0_layer1_expert3_mlp1&#45;&gt;stage0_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M3014.2,-29337.62C3010.16,-29329.47 3005.55,-29320.17 3001.02,-29311.03"/>
<polygon fill="black" stroke="black" points="3004.11,-29309.4 2996.53,-29302 2997.84,-29312.51 3004.11,-29309.4"/>
</g>
<!-- stage0_layer1_expert3_act -->
<g id="node135" class="node">
<title>stage0_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3073.19,-29192.25 2792.19,-29192.25 2792.19,-29140.25 3073.19,-29140.25 3073.19,-29192.25"/>
<text text-anchor="middle" x="2932.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2932.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="2932.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2932.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert3_tp1&#45;&gt;stage0_layer1_expert3_act -->
<g id="edge177" class="edge">
<title>stage0_layer1_expert3_tp1&#45;&gt;stage0_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2961.69,-29228.26C2957.52,-29219.48 2953.06,-29210.11 2948.93,-29201.41"/>
<polygon fill="black" stroke="black" points="2952.05,-29199.82 2944.59,-29192.29 2945.73,-29202.83 2952.05,-29199.82"/>
</g>
<!-- stage0_layer1_expert3_mlp2 -->
<g id="node136" class="node">
<title>stage0_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3070.69,-29104.25 2748.69,-29104.25 2748.69,-29052.25 3070.69,-29052.25 3070.69,-29104.25"/>
<text text-anchor="middle" x="2909.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2909.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2909.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2909.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert3_act&#45;&gt;stage0_layer1_expert3_mlp2 -->
<g id="edge178" class="edge">
<title>stage0_layer1_expert3_act&#45;&gt;stage0_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2925.91,-29139.91C2923.76,-29131.86 2921.34,-29122.82 2919.04,-29114.21"/>
<polygon fill="black" stroke="black" points="2922.38,-29113.16 2916.42,-29104.41 2915.62,-29114.97 2922.38,-29113.16"/>
</g>
<!-- stage0_layer1_expert3_tp2 -->
<g id="node137" class="node">
<title>stage0_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2886.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2886.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2886.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 6&#45;7</text>
<text text-anchor="middle" x="2886.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2886.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert3_mlp2&#45;&gt;stage0_layer1_expert3_tp2 -->
<g id="edge179" class="edge">
<title>stage0_layer1_expert3_mlp2&#45;&gt;stage0_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2903.71,-29052.08C2901.83,-29044.18 2899.7,-29035.21 2897.59,-29026.35"/>
<polygon fill="black" stroke="black" points="2900.96,-29025.38 2895.24,-29016.46 2894.15,-29027 2900.96,-29025.38"/>
</g>
<!-- stage0_layer1_expert3_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge220" class="edge">
<title>stage0_layer1_expert3_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3049.17,-28953.72C3073.8,-28950 3098.91,-28946.24 3122.69,-28942.71 3235.56,-28925.97 3358.57,-28908.02 3470.01,-28891.87"/>
<polygon fill="black" stroke="black" points="3470.67,-28895.31 3480.06,-28890.41 3469.67,-28888.39 3470.67,-28895.31"/>
</g>
<!-- stage0_layer1_expert31_mlp1 -->
<g id="node139" class="node">
<title>stage0_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3591.69,-29389.79 3277.69,-29389.79 3277.69,-29337.79 3591.69,-29337.79 3591.69,-29389.79"/>
<text text-anchor="middle" x="3434.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3434.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3434.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3434.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert31&#45;&gt;stage0_layer1_expert31_mlp1 -->
<g id="edge181" class="edge">
<title>stage0_layer1_expert31&#45;&gt;stage0_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3463.61,-29425.45C3459.69,-29417.23 3455.27,-29407.96 3451.09,-29399.19"/>
<polygon fill="black" stroke="black" points="3454.14,-29397.47 3446.68,-29389.95 3447.83,-29400.48 3454.14,-29397.47"/>
</g>
<!-- stage0_layer1_expert31_tp1 -->
<g id="node140" class="node">
<title>stage0_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3409.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3409.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3409.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="3409.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3409.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert31_mlp1&#45;&gt;stage0_layer1_expert31_tp1 -->
<g id="edge182" class="edge">
<title>stage0_layer1_expert31_mlp1&#45;&gt;stage0_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3428.19,-29337.62C3426.15,-29329.72 3423.83,-29320.75 3421.54,-29311.89"/>
<polygon fill="black" stroke="black" points="3424.87,-29310.8 3418.98,-29302 3418.1,-29312.55 3424.87,-29310.8"/>
</g>
<!-- stage0_layer1_expert31_act -->
<g id="node141" class="node">
<title>stage0_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3537.19,-29192.25 3256.19,-29192.25 3256.19,-29140.25 3537.19,-29140.25 3537.19,-29192.25"/>
<text text-anchor="middle" x="3396.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3396.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="3396.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3396.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert31_tp1&#45;&gt;stage0_layer1_expert31_act -->
<g id="edge183" class="edge">
<title>stage0_layer1_expert31_tp1&#45;&gt;stage0_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3404.85,-29227.99C3403.73,-29219.67 3402.54,-29210.84 3401.43,-29202.56"/>
<polygon fill="black" stroke="black" points="3404.87,-29201.89 3400.07,-29192.45 3397.94,-29202.82 3404.87,-29201.89"/>
</g>
<!-- stage0_layer1_expert31_mlp2 -->
<g id="node142" class="node">
<title>stage0_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3545.69,-29104.25 3223.69,-29104.25 3223.69,-29052.25 3545.69,-29052.25 3545.69,-29104.25"/>
<text text-anchor="middle" x="3384.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3384.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3384.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3384.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert31_act&#45;&gt;stage0_layer1_expert31_mlp2 -->
<g id="edge184" class="edge">
<title>stage0_layer1_expert31_act&#45;&gt;stage0_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3393.15,-29139.91C3392.04,-29131.95 3390.79,-29123.01 3389.61,-29114.49"/>
<polygon fill="black" stroke="black" points="3393.05,-29113.83 3388.2,-29104.41 3386.11,-29114.79 3393.05,-29113.83"/>
</g>
<!-- stage0_layer1_expert31_tp2 -->
<g id="node143" class="node">
<title>stage0_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3359.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3359.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3359.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 62&#45;63</text>
<text text-anchor="middle" x="3359.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3359.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert31_mlp2&#45;&gt;stage0_layer1_expert31_tp2 -->
<g id="edge185" class="edge">
<title>stage0_layer1_expert31_mlp2&#45;&gt;stage0_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3378.19,-29052.08C3376.15,-29044.18 3373.83,-29035.21 3371.54,-29026.35"/>
<polygon fill="black" stroke="black" points="3374.87,-29025.26 3368.98,-29016.46 3368.1,-29027.01 3374.87,-29025.26"/>
</g>
<!-- stage0_layer1_expert31_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge221" class="edge">
<title>stage0_layer1_expert31_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3467.02,-28946.99C3505.11,-28935.82 3549.65,-28922.75 3594.28,-28909.66"/>
<polygon fill="black" stroke="black" points="3595.49,-28912.95 3604.1,-28906.77 3593.52,-28906.23 3595.49,-28912.95"/>
</g>
<!-- stage0_layer1_expert32_mlp1 -->
<g id="node145" class="node">
<title>stage0_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3989.69,-29389.79 3675.69,-29389.79 3675.69,-29337.79 3989.69,-29337.79 3989.69,-29389.79"/>
<text text-anchor="middle" x="3832.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3832.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3832.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert32&#45;&gt;stage0_layer1_expert32_mlp1 -->
<g id="edge187" class="edge">
<title>stage0_layer1_expert32&#45;&gt;stage0_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3832.69,-29425.45C3832.69,-29417.49 3832.69,-29408.55 3832.69,-29400.03"/>
<polygon fill="black" stroke="black" points="3836.19,-29399.95 3832.69,-29389.95 3829.19,-29399.95 3836.19,-29399.95"/>
</g>
<!-- stage0_layer1_expert32_tp1 -->
<g id="node146" class="node">
<title>stage0_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3832.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3832.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="3832.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3832.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert32_mlp1&#45;&gt;stage0_layer1_expert32_tp1 -->
<g id="edge188" class="edge">
<title>stage0_layer1_expert32_mlp1&#45;&gt;stage0_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3832.69,-29337.62C3832.69,-29329.81 3832.69,-29320.94 3832.69,-29312.17"/>
<polygon fill="black" stroke="black" points="3836.19,-29312 3832.69,-29302 3829.19,-29312 3836.19,-29312"/>
</g>
<!-- stage0_layer1_expert32_act -->
<g id="node147" class="node">
<title>stage0_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3973.19,-29192.25 3692.19,-29192.25 3692.19,-29140.25 3973.19,-29140.25 3973.19,-29192.25"/>
<text text-anchor="middle" x="3832.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3832.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="3832.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3832.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert32_tp1&#45;&gt;stage0_layer1_expert32_act -->
<g id="edge189" class="edge">
<title>stage0_layer1_expert32_tp1&#45;&gt;stage0_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3832.69,-29227.99C3832.69,-29219.67 3832.69,-29210.84 3832.69,-29202.56"/>
<polygon fill="black" stroke="black" points="3836.19,-29202.45 3832.69,-29192.45 3829.19,-29202.45 3836.19,-29202.45"/>
</g>
<!-- stage0_layer1_expert32_mlp2 -->
<g id="node148" class="node">
<title>stage0_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3993.69,-29104.25 3671.69,-29104.25 3671.69,-29052.25 3993.69,-29052.25 3993.69,-29104.25"/>
<text text-anchor="middle" x="3832.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3832.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3832.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3832.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert32_act&#45;&gt;stage0_layer1_expert32_mlp2 -->
<g id="edge190" class="edge">
<title>stage0_layer1_expert32_act&#45;&gt;stage0_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3832.69,-29139.91C3832.69,-29131.95 3832.69,-29123.01 3832.69,-29114.49"/>
<polygon fill="black" stroke="black" points="3836.19,-29114.41 3832.69,-29104.41 3829.19,-29114.41 3836.19,-29114.41"/>
</g>
<!-- stage0_layer1_expert32_tp2 -->
<g id="node149" class="node">
<title>stage0_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3832.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3832.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 64&#45;65</text>
<text text-anchor="middle" x="3832.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert32_mlp2&#45;&gt;stage0_layer1_expert32_tp2 -->
<g id="edge191" class="edge">
<title>stage0_layer1_expert32_mlp2&#45;&gt;stage0_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3832.69,-29052.08C3832.69,-29044.27 3832.69,-29035.4 3832.69,-29026.64"/>
<polygon fill="black" stroke="black" points="3836.19,-29026.46 3832.69,-29016.46 3829.19,-29026.46 3836.19,-29026.46"/>
</g>
<!-- stage0_layer1_expert32_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge222" class="edge">
<title>stage0_layer1_expert32_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3832.69,-28942.38C3832.69,-28934.45 3832.69,-28925.75 3832.69,-28916.88"/>
<polygon fill="black" stroke="black" points="3836.19,-28916.83 3832.69,-28906.83 3829.19,-28916.83 3836.19,-28916.83"/>
</g>
<!-- stage0_layer1_expert60_mlp1 -->
<g id="node151" class="node">
<title>stage0_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4387.69,-29389.79 4073.69,-29389.79 4073.69,-29337.79 4387.69,-29337.79 4387.69,-29389.79"/>
<text text-anchor="middle" x="4230.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4230.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4230.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4230.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert60&#45;&gt;stage0_layer1_expert60_mlp1 -->
<g id="edge193" class="edge">
<title>stage0_layer1_expert60&#45;&gt;stage0_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4217.29,-29425.45C4219.06,-29417.4 4221.06,-29408.36 4222.96,-29399.75"/>
<polygon fill="black" stroke="black" points="4226.39,-29400.47 4225.13,-29389.95 4219.56,-29398.96 4226.39,-29400.47"/>
</g>
<!-- stage0_layer1_expert60_tp1 -->
<g id="node152" class="node">
<title>stage0_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4249.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4249.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4249.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="4249.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4249.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert60_mlp1&#45;&gt;stage0_layer1_expert60_tp1 -->
<g id="edge194" class="edge">
<title>stage0_layer1_expert60_mlp1&#45;&gt;stage0_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4235.63,-29337.62C4237.18,-29329.72 4238.94,-29320.75 4240.68,-29311.89"/>
<polygon fill="black" stroke="black" points="4244.13,-29312.48 4242.62,-29302 4237.26,-29311.13 4244.13,-29312.48"/>
</g>
<!-- stage0_layer1_expert60_act -->
<g id="node153" class="node">
<title>stage0_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4419.19,-29192.25 4138.19,-29192.25 4138.19,-29140.25 4419.19,-29140.25 4419.19,-29192.25"/>
<text text-anchor="middle" x="4278.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4278.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="4278.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4278.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert60_tp1&#45;&gt;stage0_layer1_expert60_act -->
<g id="edge195" class="edge">
<title>stage0_layer1_expert60_tp1&#45;&gt;stage0_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4260.4,-29228.26C4262.98,-29219.67 4265.72,-29210.51 4268.28,-29201.97"/>
<polygon fill="black" stroke="black" points="4271.67,-29202.88 4271.18,-29192.29 4264.96,-29200.87 4271.67,-29202.88"/>
</g>
<!-- stage0_layer1_expert60_mlp2 -->
<g id="node154" class="node">
<title>stage0_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4439.69,-29104.25 4117.69,-29104.25 4117.69,-29052.25 4439.69,-29052.25 4439.69,-29104.25"/>
<text text-anchor="middle" x="4278.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4278.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4278.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4278.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert60_act&#45;&gt;stage0_layer1_expert60_mlp2 -->
<g id="edge196" class="edge">
<title>stage0_layer1_expert60_act&#45;&gt;stage0_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4278.69,-29139.91C4278.69,-29131.95 4278.69,-29123.01 4278.69,-29114.49"/>
<polygon fill="black" stroke="black" points="4282.19,-29114.41 4278.69,-29104.41 4275.19,-29114.41 4282.19,-29114.41"/>
</g>
<!-- stage0_layer1_expert60_tp2 -->
<g id="node155" class="node">
<title>stage0_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4305.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4305.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4305.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 120&#45;121</text>
<text text-anchor="middle" x="4305.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4305.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert60_mlp2&#45;&gt;stage0_layer1_expert60_tp2 -->
<g id="edge197" class="edge">
<title>stage0_layer1_expert60_mlp2&#45;&gt;stage0_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4285.71,-29052.08C4287.91,-29044.18 4290.42,-29035.21 4292.89,-29026.35"/>
<polygon fill="black" stroke="black" points="4296.33,-29027.03 4295.65,-29016.46 4289.59,-29025.15 4296.33,-29027.03"/>
</g>
<!-- stage0_layer1_expert60_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge223" class="edge">
<title>stage0_layer1_expert60_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4198.36,-28946.99C4160.27,-28935.82 4115.73,-28922.75 4071.1,-28909.66"/>
<polygon fill="black" stroke="black" points="4071.86,-28906.23 4061.28,-28906.77 4069.89,-28912.95 4071.86,-28906.23"/>
</g>
<!-- stage0_layer1_expert61_mlp1 -->
<g id="node157" class="node">
<title>stage0_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4801.69,-29389.79 4487.69,-29389.79 4487.69,-29337.79 4801.69,-29337.79 4801.69,-29389.79"/>
<text text-anchor="middle" x="4644.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4644.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4644.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4644.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert61&#45;&gt;stage0_layer1_expert61_mlp1 -->
<g id="edge199" class="edge">
<title>stage0_layer1_expert61&#45;&gt;stage0_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4622.82,-29425.45C4625.75,-29417.32 4629.06,-29408.16 4632.19,-29399.47"/>
<polygon fill="black" stroke="black" points="4635.52,-29400.54 4635.62,-29389.95 4628.94,-29398.17 4635.52,-29400.54"/>
</g>
<!-- stage0_layer1_expert61_tp1 -->
<g id="node158" class="node">
<title>stage0_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4675.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4675.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4675.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="4675.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4675.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert61_mlp1&#45;&gt;stage0_layer1_expert61_tp1 -->
<g id="edge200" class="edge">
<title>stage0_layer1_expert61_mlp1&#45;&gt;stage0_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4652.75,-29337.62C4655.31,-29329.64 4658.22,-29320.56 4661.09,-29311.6"/>
<polygon fill="black" stroke="black" points="4664.45,-29312.59 4664.16,-29302 4657.78,-29310.45 4664.45,-29312.59"/>
</g>
<!-- stage0_layer1_expert61_act -->
<g id="node159" class="node">
<title>stage0_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4854.19,-29192.25 4573.19,-29192.25 4573.19,-29140.25 4854.19,-29140.25 4854.19,-29192.25"/>
<text text-anchor="middle" x="4713.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4713.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="4713.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4713.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert61_tp1&#45;&gt;stage0_layer1_expert61_act -->
<g id="edge201" class="edge">
<title>stage0_layer1_expert61_tp1&#45;&gt;stage0_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4689.73,-29228.26C4693.14,-29219.58 4696.78,-29210.31 4700.17,-29201.69"/>
<polygon fill="black" stroke="black" points="4703.46,-29202.88 4703.85,-29192.29 4696.94,-29200.32 4703.46,-29202.88"/>
</g>
<!-- stage0_layer1_expert61_mlp2 -->
<g id="node160" class="node">
<title>stage0_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4903.69,-29104.25 4581.69,-29104.25 4581.69,-29052.25 4903.69,-29052.25 4903.69,-29104.25"/>
<text text-anchor="middle" x="4742.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4742.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4742.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4742.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert61_act&#45;&gt;stage0_layer1_expert61_mlp2 -->
<g id="edge202" class="edge">
<title>stage0_layer1_expert61_act&#45;&gt;stage0_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4722.23,-29139.91C4724.98,-29131.78 4728.06,-29122.62 4730.99,-29113.93"/>
<polygon fill="black" stroke="black" points="4734.33,-29115 4734.21,-29104.41 4727.69,-29112.76 4734.33,-29115"/>
</g>
<!-- stage0_layer1_expert61_tp2 -->
<g id="node161" class="node">
<title>stage0_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4778.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4778.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4778.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 122&#45;123</text>
<text text-anchor="middle" x="4778.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4778.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert61_mlp2&#45;&gt;stage0_layer1_expert61_tp2 -->
<g id="edge203" class="edge">
<title>stage0_layer1_expert61_mlp2&#45;&gt;stage0_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4752.05,-29052.08C4755.02,-29044.1 4758.4,-29035.02 4761.73,-29026.06"/>
<polygon fill="black" stroke="black" points="4765.1,-29027.05 4765.3,-29016.46 4758.54,-29024.61 4765.1,-29027.05"/>
</g>
<!-- stage0_layer1_expert61_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge224" class="edge">
<title>stage0_layer1_expert61_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4616.21,-28953.72C4591.58,-28950 4566.46,-28946.24 4542.69,-28942.71 4466.78,-28931.45 4386.27,-28919.65 4307.79,-28908.21"/>
<polygon fill="black" stroke="black" points="4308.13,-28904.72 4297.73,-28906.74 4307.13,-28911.65 4308.13,-28904.72"/>
</g>
<!-- stage0_layer1_expert62_mlp1 -->
<g id="node163" class="node">
<title>stage0_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5191.69,-29389.79 4877.69,-29389.79 4877.69,-29337.79 5191.69,-29337.79 5191.69,-29389.79"/>
<text text-anchor="middle" x="5034.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="5034.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5034.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5034.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert62&#45;&gt;stage0_layer1_expert62_mlp1 -->
<g id="edge205" class="edge">
<title>stage0_layer1_expert62&#45;&gt;stage0_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M5021.29,-29425.45C5023.06,-29417.4 5025.06,-29408.36 5026.96,-29399.75"/>
<polygon fill="black" stroke="black" points="5030.39,-29400.47 5029.13,-29389.95 5023.56,-29398.96 5030.39,-29400.47"/>
</g>
<!-- stage0_layer1_expert62_tp1 -->
<g id="node164" class="node">
<title>stage0_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5095.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5095.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5095.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="5095.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5095.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert62_mlp1&#45;&gt;stage0_layer1_expert62_tp1 -->
<g id="edge206" class="edge">
<title>stage0_layer1_expert62_mlp1&#45;&gt;stage0_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5050.56,-29337.62C5055.85,-29329.21 5061.92,-29319.59 5067.86,-29310.17"/>
<polygon fill="black" stroke="black" points="5070.87,-29311.96 5073.24,-29301.63 5064.95,-29308.22 5070.87,-29311.96"/>
</g>
<!-- stage0_layer1_expert62_act -->
<g id="node165" class="node">
<title>stage0_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5342.19,-29192.25 5061.19,-29192.25 5061.19,-29140.25 5342.19,-29140.25 5342.19,-29192.25"/>
<text text-anchor="middle" x="5201.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5201.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="5201.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5201.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert62_tp1&#45;&gt;stage0_layer1_expert62_act -->
<g id="edge207" class="edge">
<title>stage0_layer1_expert62_tp1&#45;&gt;stage0_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5134.26,-29228.81C5144.93,-29219.07 5156.44,-29208.56 5166.88,-29199.02"/>
<polygon fill="black" stroke="black" points="5169.24,-29201.61 5174.27,-29192.28 5164.53,-29196.44 5169.24,-29201.61"/>
</g>
<!-- stage0_layer1_expert62_mlp2 -->
<g id="node166" class="node">
<title>stage0_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5391.69,-29104.25 5069.69,-29104.25 5069.69,-29052.25 5391.69,-29052.25 5391.69,-29104.25"/>
<text text-anchor="middle" x="5230.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5230.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5230.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5230.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert62_act&#45;&gt;stage0_layer1_expert62_mlp2 -->
<g id="edge208" class="edge">
<title>stage0_layer1_expert62_act&#45;&gt;stage0_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5210.23,-29139.91C5212.98,-29131.78 5216.06,-29122.62 5218.99,-29113.93"/>
<polygon fill="black" stroke="black" points="5222.33,-29115 5222.21,-29104.41 5215.69,-29112.76 5222.33,-29115"/>
</g>
<!-- stage0_layer1_expert62_tp2 -->
<g id="node167" class="node">
<title>stage0_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5251.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5251.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5251.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 124&#45;125</text>
<text text-anchor="middle" x="5251.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5251.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert62_mlp2&#45;&gt;stage0_layer1_expert62_tp2 -->
<g id="edge209" class="edge">
<title>stage0_layer1_expert62_mlp2&#45;&gt;stage0_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5236.15,-29052.08C5237.86,-29044.18 5239.81,-29035.21 5241.73,-29026.35"/>
<polygon fill="black" stroke="black" points="5245.18,-29026.97 5243.88,-29016.46 5238.34,-29025.49 5245.18,-29026.97"/>
</g>
<!-- stage0_layer1_expert62_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge225" class="edge">
<title>stage0_layer1_expert62_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5093.19,-28953.04C5067.33,-28949.3 5040.79,-28945.7 5015.69,-28942.71 4795.65,-28916.48 4551.82,-28894.12 4342.99,-28877"/>
<polygon fill="black" stroke="black" points="4343,-28873.49 4332.75,-28876.17 4342.43,-28880.47 4343,-28873.49"/>
</g>
<!-- stage0_layer1_expert63_mlp1 -->
<g id="node169" class="node">
<title>stage0_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5559.69,-29389.79 5245.69,-29389.79 5245.69,-29337.79 5559.69,-29337.79 5559.69,-29389.79"/>
<text text-anchor="middle" x="5402.69" y="-29377.79" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5402.69" y="-29366.79" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5402.69" y="-29355.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5402.69" y="-29344.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage0_layer1_expert63&#45;&gt;stage0_layer1_expert63_mlp1 -->
<g id="edge211" class="edge">
<title>stage0_layer1_expert63&#45;&gt;stage0_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5391.4,-29425.45C5392.88,-29417.49 5394.55,-29408.55 5396.13,-29400.03"/>
<polygon fill="black" stroke="black" points="5399.62,-29400.42 5398.01,-29389.95 5392.74,-29399.14 5399.62,-29400.42"/>
</g>
<!-- stage0_layer1_expert63_tp1 -->
<g id="node170" class="node">
<title>stage0_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5513.69" cy="-29265.02" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5513.69" y="-29279.02" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5513.69" y="-29268.02" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="5513.69" y="-29257.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5513.69" y="-29246.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert63_mlp1&#45;&gt;stage0_layer1_expert63_tp1 -->
<g id="edge212" class="edge">
<title>stage0_layer1_expert63_mlp1&#45;&gt;stage0_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5431.56,-29337.62C5442,-29328.52 5454.07,-29317.99 5465.7,-29307.85"/>
<polygon fill="black" stroke="black" points="5468.02,-29310.47 5473.26,-29301.26 5463.42,-29305.2 5468.02,-29310.47"/>
</g>
<!-- stage0_layer1_expert63_act -->
<g id="node171" class="node">
<title>stage0_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5655.19,-29192.25 5374.19,-29192.25 5374.19,-29140.25 5655.19,-29140.25 5655.19,-29192.25"/>
<text text-anchor="middle" x="5514.69" y="-29180.25" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5514.69" y="-29169.25" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="5514.69" y="-29158.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5514.69" y="-29147.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage0_layer1_expert63_tp1&#45;&gt;stage0_layer1_expert63_act -->
<g id="edge213" class="edge">
<title>stage0_layer1_expert63_tp1&#45;&gt;stage0_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5514.06,-29227.99C5514.15,-29219.67 5514.24,-29210.84 5514.32,-29202.56"/>
<polygon fill="black" stroke="black" points="5517.82,-29202.48 5514.43,-29192.45 5510.82,-29202.41 5517.82,-29202.48"/>
</g>
<!-- stage0_layer1_expert63_mlp2 -->
<g id="node172" class="node">
<title>stage0_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5819.69,-29104.25 5497.69,-29104.25 5497.69,-29052.25 5819.69,-29052.25 5819.69,-29104.25"/>
<text text-anchor="middle" x="5658.69" y="-29092.25" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5658.69" y="-29081.25" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5658.69" y="-29070.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5658.69" y="-29059.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert63_act&#45;&gt;stage0_layer1_expert63_mlp2 -->
<g id="edge214" class="edge">
<title>stage0_layer1_expert63_act&#45;&gt;stage0_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5556.73,-29140.14C5572.56,-29130.69 5590.74,-29119.83 5607.32,-29109.93"/>
<polygon fill="black" stroke="black" points="5609.56,-29112.67 5616.35,-29104.54 5605.97,-29106.66 5609.56,-29112.67"/>
</g>
<!-- stage0_layer1_expert63_tp2 -->
<g id="node173" class="node">
<title>stage0_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5724.69" cy="-28979.48" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5724.69" y="-28993.48" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5724.69" y="-28982.48" font-family="Times,serif" font-size="10.00">GPU: 126&#45;127</text>
<text text-anchor="middle" x="5724.69" y="-28971.48" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5724.69" y="-28960.48" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert63_mlp2&#45;&gt;stage0_layer1_expert63_tp2 -->
<g id="edge215" class="edge">
<title>stage0_layer1_expert63_mlp2&#45;&gt;stage0_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5675.86,-29052.08C5681.59,-29043.67 5688.15,-29034.05 5694.57,-29024.63"/>
<polygon fill="black" stroke="black" points="5697.66,-29026.32 5700.4,-29016.09 5691.87,-29022.38 5697.66,-29026.32"/>
</g>
<!-- stage0_layer1_expert63_tp2&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge226" class="edge">
<title>stage0_layer1_expert63_tp2&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5568.16,-28952.77C5541.69,-28949 5514.44,-28945.46 5488.69,-28942.71 5093.75,-28900.58 4643.84,-28873.95 4312.75,-28858.35"/>
<polygon fill="black" stroke="black" points="4312.65,-28854.84 4302.49,-28857.87 4312.32,-28861.84 4312.65,-28854.84"/>
</g>
<!-- stage0_layer1_expert_ellipsis&#45;&gt;stage0_layer1_expert_agg -->
<g id="edge227" class="edge">
<title>stage0_layer1_expert_ellipsis&#45;&gt;stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5968.08,-29337.53C5972.78,-29300.32 5980.69,-29228.56 5980.69,-29167.25 5980.69,-29167.25 5980.69,-29167.25 5980.69,-29077.25 5980.69,-29016.86 6006.31,-28983.4 5961.69,-28942.71 5901.07,-28887.42 4902.4,-28859.3 4294.67,-28847.24"/>
<polygon fill="black" stroke="black" points="4294.48,-28843.74 4284.41,-28847.04 4294.34,-28850.74 4294.48,-28843.74"/>
</g>
<!-- stage0_layer1_output -->
<g id="node176" class="node">
<title>stage0_layer1_output</title>
<polygon fill="none" stroke="black" points="4057.69,-28734.71 3607.69,-28734.71 3607.69,-28666.71 4057.69,-28666.71 4057.69,-28734.71"/>
<text text-anchor="middle" x="3832.69" y="-28719.51" font-family="Times,serif" font-size="14.00">Layer 1 Output</text>
<text text-anchor="middle" x="3832.69" y="-28704.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-28689.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28674.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_expert_agg&#45;&gt;stage0_layer1_output -->
<g id="edge228" class="edge">
<title>stage0_layer1_expert_agg&#45;&gt;stage0_layer1_output</title>
<path fill="none" stroke="black" d="M3832.69,-28770.51C3832.69,-28761.76 3832.69,-28752.99 3832.69,-28744.78"/>
<polygon fill="black" stroke="black" points="3836.19,-28744.73 3832.69,-28734.73 3829.19,-28744.73 3836.19,-28744.73"/>
</g>
<!-- stage0_output -->
<g id="node177" class="node">
<title>stage0_output</title>
<polygon fill="none" stroke="black" points="4299.27,-28630.71 3557.05,-28630.71 3366.11,-28494.71 4108.33,-28494.71 4299.27,-28630.71"/>
<text text-anchor="middle" x="3832.69" y="-28581.51" font-family="Times,serif" font-size="14.00">Stage 0 Output</text>
<text text-anchor="middle" x="3832.69" y="-28566.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 0</text>
<text text-anchor="middle" x="3832.69" y="-28551.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28536.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_layer1_output&#45;&gt;stage0_output -->
<g id="edge229" class="edge">
<title>stage0_layer1_output&#45;&gt;stage0_output</title>
<path fill="none" stroke="black" d="M3832.69,-28666.44C3832.69,-28658.61 3832.69,-28649.95 3832.69,-28641.06"/>
<polygon fill="black" stroke="black" points="3836.19,-28640.97 3832.69,-28630.97 3829.19,-28640.97 3836.19,-28640.97"/>
</g>
<!-- stage1_input -->
<g id="node178" class="node">
<title>stage1_input</title>
<polygon fill="none" stroke="black" points="4299.27,-28458.71 3557.05,-28458.71 3366.11,-28322.71 4108.33,-28322.71 4299.27,-28458.71"/>
<text text-anchor="middle" x="3832.69" y="-28409.51" font-family="Times,serif" font-size="14.00">Stage 1 Input Router</text>
<text text-anchor="middle" x="3832.69" y="-28394.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3832.69" y="-28379.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28364.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage0_output&#45;&gt;stage1_input -->
<g id="edge230" class="edge">
<title>stage0_output&#45;&gt;stage1_input</title>
<path fill="none" stroke="black" d="M3832.69,-28494.52C3832.69,-28486.21 3832.69,-28477.66 3832.69,-28469.21"/>
<polygon fill="black" stroke="black" points="3836.19,-28468.97 3832.69,-28458.97 3829.19,-28468.97 3836.19,-28468.97"/>
</g>
<!-- stage1_layer0_ln -->
<g id="node179" class="node">
<title>stage1_layer0_ln</title>
<polygon fill="none" stroke="black" points="4057.69,-28286.71 3607.69,-28286.71 3607.69,-28218.71 4057.69,-28218.71 4057.69,-28286.71"/>
<text text-anchor="middle" x="3832.69" y="-28271.51" font-family="Times,serif" font-size="14.00">Layer 2 LayerNorm</text>
<text text-anchor="middle" x="3832.69" y="-28256.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3832.69" y="-28241.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28226.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_input&#45;&gt;stage1_layer0_ln -->
<g id="edge231" class="edge">
<title>stage1_input&#45;&gt;stage1_layer0_ln</title>
<path fill="none" stroke="black" d="M3832.69,-28322.51C3832.69,-28313.76 3832.69,-28304.99 3832.69,-28296.78"/>
<polygon fill="black" stroke="black" points="3836.19,-28296.73 3832.69,-28286.73 3829.19,-28296.73 3836.19,-28296.73"/>
</g>
<!-- stage1_layer0_attn_qkv -->
<g id="node180" class="node">
<title>stage1_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4064.19,-28182.71 3601.19,-28182.71 3601.19,-28114.71 4064.19,-28114.71 4064.19,-28182.71"/>
<text text-anchor="middle" x="3832.69" y="-28167.51" font-family="Times,serif" font-size="14.00">Layer 2 Attention QKV Projection</text>
<text text-anchor="middle" x="3832.69" y="-28152.51" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP: GPU 128&#45;255)</text>
<text text-anchor="middle" x="3832.69" y="-28137.51" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-28122.51" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage1_layer0_ln&#45;&gt;stage1_layer0_attn_qkv -->
<g id="edge232" class="edge">
<title>stage1_layer0_ln&#45;&gt;stage1_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3832.69,-28218.59C3832.69,-28210.49 3832.69,-28201.69 3832.69,-28193.18"/>
<polygon fill="black" stroke="black" points="3836.19,-28193.01 3832.69,-28183.01 3829.19,-28193.01 3836.19,-28193.01"/>
</g>
<!-- stage1_layer0_tp_qkv_comm -->
<g id="node181" class="node">
<title>stage1_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-28030.63" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3832.69" y="-28049.43" font-family="Times,serif" font-size="14.00">Layer 2 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3832.69" y="-28034.43" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP pairs)</text>
<text text-anchor="middle" x="3832.69" y="-28019.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-28004.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage1_layer0_attn_qkv&#45;&gt;stage1_layer0_tp_qkv_comm -->
<g id="edge233" class="edge">
<title>stage1_layer0_attn_qkv&#45;&gt;stage1_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3832.69,-28114.45C3832.69,-28106.45 3832.69,-28097.69 3832.69,-28088.94"/>
<polygon fill="black" stroke="black" points="3836.19,-28088.74 3832.69,-28078.74 3829.19,-28088.74 3836.19,-28088.74"/>
</g>
<!-- stage1_layer0_attn_head0 -->
<g id="node182" class="node">
<title>stage1_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1641.19,-27946.54 1368.19,-27946.54 1368.19,-27894.54 1641.19,-27894.54 1641.19,-27946.54"/>
<text text-anchor="middle" x="1504.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 0 Attention</text>
<text text-anchor="middle" x="1504.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 0)</text>
<text text-anchor="middle" x="1504.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1504.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head0 -->
<g id="edge234" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3509.67,-28022.6C2997.05,-28010.57 2018.56,-27983.77 1651.38,-27946.65"/>
<polygon fill="black" stroke="black" points="1651.54,-27943.15 1641.23,-27945.61 1650.82,-27950.11 1651.54,-27943.15"/>
</g>
<!-- stage1_layer0_attn_head1 -->
<g id="node183" class="node">
<title>stage1_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="1932.19,-27946.54 1659.19,-27946.54 1659.19,-27894.54 1932.19,-27894.54 1932.19,-27946.54"/>
<text text-anchor="middle" x="1795.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 1 Attention</text>
<text text-anchor="middle" x="1795.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 1)</text>
<text text-anchor="middle" x="1795.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1795.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head1 -->
<g id="edge235" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3505.73,-28027.84C3130.12,-28022.89 2495.43,-28005.67 1942.41,-27946.67"/>
<polygon fill="black" stroke="black" points="1942.55,-27943.17 1932.23,-27945.58 1941.8,-27950.13 1942.55,-27943.17"/>
</g>
<!-- stage1_layer0_attn_head2 -->
<g id="node184" class="node">
<title>stage1_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2223.19,-27946.54 1950.19,-27946.54 1950.19,-27894.54 2223.19,-27894.54 2223.19,-27946.54"/>
<text text-anchor="middle" x="2086.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 2 Attention</text>
<text text-anchor="middle" x="2086.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 2)</text>
<text text-anchor="middle" x="2086.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2086.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head2 -->
<g id="edge236" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3508.26,-28024.09C3186.63,-28015.97 2679.92,-27996.07 2233.44,-27946.69"/>
<polygon fill="black" stroke="black" points="2233.56,-27943.18 2223.24,-27945.55 2232.79,-27950.14 2233.56,-27943.18"/>
</g>
<!-- stage1_layer0_attn_head3 -->
<g id="node185" class="node">
<title>stage1_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2514.19,-27946.54 2241.19,-27946.54 2241.19,-27894.54 2514.19,-27894.54 2514.19,-27946.54"/>
<text text-anchor="middle" x="2377.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 3 Attention</text>
<text text-anchor="middle" x="2377.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 3)</text>
<text text-anchor="middle" x="2377.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2377.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head3 -->
<g id="edge237" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3514.84,-28019.03C3251.62,-28007.98 2867.78,-27986.65 2524.39,-27946.7"/>
<polygon fill="black" stroke="black" points="2524.58,-27943.19 2514.24,-27945.51 2523.77,-27950.15 2524.58,-27943.19"/>
</g>
<!-- stage1_layer0_attn_head4 -->
<g id="node186" class="node">
<title>stage1_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2805.19,-27946.54 2532.19,-27946.54 2532.19,-27894.54 2805.19,-27894.54 2805.19,-27946.54"/>
<text text-anchor="middle" x="2668.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 4 Attention</text>
<text text-anchor="middle" x="2668.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 4)</text>
<text text-anchor="middle" x="2668.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2668.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head4 -->
<g id="edge238" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3530.43,-28012.09C3330.07,-27998.75 3061.29,-27977.56 2815.46,-27946.73"/>
<polygon fill="black" stroke="black" points="2815.61,-27943.22 2805.25,-27945.44 2814.73,-27950.16 2815.61,-27943.22"/>
</g>
<!-- stage1_layer0_attn_head5 -->
<g id="node187" class="node">
<title>stage1_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3096.19,-27946.54 2823.19,-27946.54 2823.19,-27894.54 3096.19,-27894.54 3096.19,-27946.54"/>
<text text-anchor="middle" x="2959.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 5 Attention</text>
<text text-anchor="middle" x="2959.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 5)</text>
<text text-anchor="middle" x="2959.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2959.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head5 -->
<g id="edge239" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3565.12,-28002.79C3430.28,-27988.35 3264.06,-27969.16 3106.62,-27946.79"/>
<polygon fill="black" stroke="black" points="3106.66,-27943.26 3096.27,-27945.32 3105.67,-27950.19 3106.66,-27943.26"/>
</g>
<!-- stage1_layer0_attn_head6 -->
<g id="node188" class="node">
<title>stage1_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3387.19,-27946.54 3114.19,-27946.54 3114.19,-27894.54 3387.19,-27894.54 3387.19,-27946.54"/>
<text text-anchor="middle" x="3250.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 6 Attention</text>
<text text-anchor="middle" x="3250.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 6)</text>
<text text-anchor="middle" x="3250.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3250.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head6 -->
<g id="edge240" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3632.8,-27992.51C3554.89,-27978.04 3467.29,-27961.77 3395.64,-27948.46"/>
<polygon fill="black" stroke="black" points="3396.1,-27944.99 3385.63,-27946.61 3394.83,-27951.87 3396.1,-27944.99"/>
</g>
<!-- stage1_layer0_attn_head7 -->
<g id="node189" class="node">
<title>stage1_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3678.19,-27946.54 3405.19,-27946.54 3405.19,-27894.54 3678.19,-27894.54 3678.19,-27946.54"/>
<text text-anchor="middle" x="3541.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 7 Attention</text>
<text text-anchor="middle" x="3541.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 7)</text>
<text text-anchor="middle" x="3541.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3541.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head7 -->
<g id="edge241" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3714.33,-27985.67C3682.09,-27973.69 3648.02,-27961.04 3618.74,-27950.16"/>
<polygon fill="black" stroke="black" points="3619.59,-27946.75 3609,-27946.54 3617.15,-27953.31 3619.59,-27946.75"/>
</g>
<!-- stage1_layer0_attn_ellipsis -->
<g id="node190" class="node">
<title>stage1_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3969.19,-27946.54 3696.19,-27946.54 3696.19,-27894.54 3969.19,-27894.54 3969.19,-27946.54"/>
<text text-anchor="middle" x="3832.69" y="-27934.54" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3832.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3832.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_ellipsis -->
<g id="edge242" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3832.69,-27982.54C3832.69,-27973.99 3832.69,-27965.21 3832.69,-27957.07"/>
<polygon fill="black" stroke="black" points="3836.19,-27956.81 3832.69,-27946.81 3829.19,-27956.81 3836.19,-27956.81"/>
</g>
<!-- stage1_layer0_attn_head24 -->
<g id="node191" class="node">
<title>stage1_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4260.19,-27946.54 3987.19,-27946.54 3987.19,-27894.54 4260.19,-27894.54 4260.19,-27946.54"/>
<text text-anchor="middle" x="4123.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 24 Attention</text>
<text text-anchor="middle" x="4123.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 24)</text>
<text text-anchor="middle" x="4123.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4123.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head24 -->
<g id="edge243" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M3951.05,-27985.67C3983.28,-27973.69 4017.36,-27961.04 4046.64,-27950.16"/>
<polygon fill="black" stroke="black" points="4048.22,-27953.31 4056.38,-27946.54 4045.79,-27946.75 4048.22,-27953.31"/>
</g>
<!-- stage1_layer0_attn_head25 -->
<g id="node192" class="node">
<title>stage1_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4551.19,-27946.54 4278.19,-27946.54 4278.19,-27894.54 4551.19,-27894.54 4551.19,-27946.54"/>
<text text-anchor="middle" x="4414.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 25 Attention</text>
<text text-anchor="middle" x="4414.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 25)</text>
<text text-anchor="middle" x="4414.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4414.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head25 -->
<g id="edge244" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M4032.57,-27992.51C4110.48,-27978.04 4198.09,-27961.77 4269.74,-27948.46"/>
<polygon fill="black" stroke="black" points="4270.55,-27951.87 4279.74,-27946.61 4269.27,-27944.99 4270.55,-27951.87"/>
</g>
<!-- stage1_layer0_attn_head26 -->
<g id="node193" class="node">
<title>stage1_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4842.19,-27946.54 4569.19,-27946.54 4569.19,-27894.54 4842.19,-27894.54 4842.19,-27946.54"/>
<text text-anchor="middle" x="4705.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 26 Attention</text>
<text text-anchor="middle" x="4705.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 26)</text>
<text text-anchor="middle" x="4705.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4705.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head26 -->
<g id="edge245" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4099.45,-28002.75C4234.31,-27988.26 4400.69,-27969.04 4559.01,-27946.61"/>
<polygon fill="black" stroke="black" points="4559.54,-27950.07 4568.95,-27945.2 4558.55,-27943.14 4559.54,-27950.07"/>
</g>
<!-- stage1_layer0_attn_head27 -->
<g id="node194" class="node">
<title>stage1_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5133.19,-27946.54 4860.19,-27946.54 4860.19,-27894.54 5133.19,-27894.54 5133.19,-27946.54"/>
<text text-anchor="middle" x="4996.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 27 Attention</text>
<text text-anchor="middle" x="4996.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 27)</text>
<text text-anchor="middle" x="4996.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4996.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head27 -->
<g id="edge246" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4134.64,-28011.99C4334.8,-27998.6 4603.31,-27977.41 4849.73,-27946.62"/>
<polygon fill="black" stroke="black" points="4850.48,-27950.05 4859.96,-27945.33 4849.61,-27943.11 4850.48,-27950.05"/>
</g>
<!-- stage1_layer0_attn_head28 -->
<g id="node195" class="node">
<title>stage1_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5424.19,-27946.54 5151.19,-27946.54 5151.19,-27894.54 5424.19,-27894.54 5424.19,-27946.54"/>
<text text-anchor="middle" x="5287.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 28 Attention</text>
<text text-anchor="middle" x="5287.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 28)</text>
<text text-anchor="middle" x="5287.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5287.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head28 -->
<g id="edge247" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4150.28,-28018.91C4413.3,-28007.8 4796.83,-27986.43 5140.81,-27946.59"/>
<polygon fill="black" stroke="black" points="5141.45,-27950.04 5150.97,-27945.41 5140.64,-27943.09 5141.45,-27950.04"/>
</g>
<!-- stage1_layer0_attn_head29 -->
<g id="node196" class="node">
<title>stage1_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5715.19,-27946.54 5442.19,-27946.54 5442.19,-27894.54 5715.19,-27894.54 5715.19,-27946.54"/>
<text text-anchor="middle" x="5578.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 29 Attention</text>
<text text-anchor="middle" x="5578.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 29)</text>
<text text-anchor="middle" x="5578.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5578.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head29 -->
<g id="edge248" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4157.28,-28023.96C4478.72,-28015.74 4984.89,-27995.78 5431.77,-27946.59"/>
<polygon fill="black" stroke="black" points="5432.43,-27950.03 5441.98,-27945.46 5431.66,-27943.08 5432.43,-27950.03"/>
</g>
<!-- stage1_layer0_attn_head30 -->
<g id="node197" class="node">
<title>stage1_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="6006.19,-27946.54 5733.19,-27946.54 5733.19,-27894.54 6006.19,-27894.54 6006.19,-27946.54"/>
<text text-anchor="middle" x="5869.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 30 Attention</text>
<text text-anchor="middle" x="5869.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 30)</text>
<text text-anchor="middle" x="5869.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5869.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head30 -->
<g id="edge249" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4159.89,-28027.71C4535.34,-28022.64 5169.41,-28005.32 5722.8,-27946.58"/>
<polygon fill="black" stroke="black" points="5723.41,-27950.03 5732.98,-27945.49 5722.67,-27943.07 5723.41,-27950.03"/>
</g>
<!-- stage1_layer0_attn_head31 -->
<g id="node198" class="node">
<title>stage1_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6297.19,-27946.54 6024.19,-27946.54 6024.19,-27894.54 6297.19,-27894.54 6297.19,-27946.54"/>
<text text-anchor="middle" x="6160.69" y="-27934.54" font-family="Times,serif" font-size="10.00">Layer 2 Head 31 Attention</text>
<text text-anchor="middle" x="6160.69" y="-27923.54" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 31)</text>
<text text-anchor="middle" x="6160.69" y="-27912.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6160.69" y="-27901.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head31 -->
<g id="edge250" class="edge">
<title>stage1_layer0_tp_qkv_comm&#45;&gt;stage1_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4155.55,-28022.55C4667.93,-28010.45 5645.97,-27983.56 6013.81,-27946.56"/>
<polygon fill="black" stroke="black" points="6014.39,-27950.01 6023.99,-27945.51 6013.68,-27943.05 6014.39,-27950.01"/>
</g>
<!-- stage1_layer0_attn_agg -->
<g id="node199" class="node">
<title>stage1_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4300.34,-27858.54 3556.41,-27858.54 3365.04,-27722.54 4108.97,-27722.54 4300.34,-27858.54"/>
<text text-anchor="middle" x="3832.69" y="-27809.34" font-family="Times,serif" font-size="14.00">Layer 2 Attention Aggregate</text>
<text text-anchor="middle" x="3832.69" y="-27794.34" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3832.69" y="-27779.34" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3832.69" y="-27764.34" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_attn_head0&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge251" class="edge">
<title>stage1_layer0_attn_head0&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1641.23,-27895.52C1644.07,-27895.18 1646.9,-27894.85 1649.69,-27894.54 2281.18,-27825.47 3020.43,-27802.69 3456.36,-27795.2"/>
<polygon fill="black" stroke="black" points="3456.67,-27798.69 3466.61,-27795.02 3456.55,-27791.69 3456.67,-27798.69"/>
</g>
<!-- stage1_layer0_attn_head1&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge252" class="edge">
<title>stage1_layer0_attn_head1&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1932.24,-27895.55C1935.08,-27895.19 1937.9,-27894.86 1940.69,-27894.54 2466.99,-27835.05 3079.69,-27809.65 3461.91,-27798.99"/>
<polygon fill="black" stroke="black" points="3462.12,-27802.49 3472.02,-27798.71 3461.93,-27795.49 3462.12,-27802.49"/>
</g>
<!-- stage1_layer0_attn_head2&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge253" class="edge">
<title>stage1_layer0_attn_head2&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2223.24,-27895.58C2226.08,-27895.22 2228.9,-27894.87 2231.69,-27894.54 2654.66,-27844.62 3143.57,-27817.59 3468.72,-27803.91"/>
<polygon fill="black" stroke="black" points="3468.93,-27807.41 3478.77,-27803.49 3468.63,-27800.41 3468.93,-27807.41"/>
</g>
<!-- stage1_layer0_attn_head3&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge254" class="edge">
<title>stage1_layer0_attn_head3&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2514.25,-27895.64C2517.08,-27895.26 2519.9,-27894.89 2522.69,-27894.54 2844.79,-27854.2 3213.56,-27826.88 3477.59,-27810.58"/>
<polygon fill="black" stroke="black" points="3477.96,-27814.06 3487.72,-27809.95 3477.53,-27807.07 3477.96,-27814.06"/>
</g>
<!-- stage1_layer0_attn_head4&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge255" class="edge">
<title>stage1_layer0_attn_head4&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2805.26,-27895.72C2808.09,-27895.32 2810.9,-27894.92 2813.69,-27894.54 3038.59,-27863.83 3292.58,-27838.13 3490.72,-27820.09"/>
<polygon fill="black" stroke="black" points="3491.07,-27823.57 3500.71,-27819.18 3490.43,-27816.6 3491.07,-27823.57"/>
</g>
<!-- stage1_layer0_attn_head5&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge256" class="edge">
<title>stage1_layer0_attn_head5&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3096.28,-27895.88C3099.11,-27895.42 3101.91,-27894.98 3104.69,-27894.54 3237.44,-27873.71 3384.12,-27852.6 3510.83,-27834.95"/>
<polygon fill="black" stroke="black" points="3511.65,-27838.37 3521.08,-27833.53 3510.69,-27831.44 3511.65,-27838.37"/>
</g>
<!-- stage1_layer0_attn_head6&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge257" class="edge">
<title>stage1_layer0_attn_head6&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3364.63,-27894.48C3415.21,-27883.36 3477.29,-27869.71 3539.5,-27856.02"/>
<polygon fill="black" stroke="black" points="3540.47,-27859.4 3549.49,-27853.83 3538.97,-27852.56 3540.47,-27859.4"/>
</g>
<!-- stage1_layer0_attn_head7&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge258" class="edge">
<title>stage1_layer0_attn_head7&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3598.83,-27894.41C3620.01,-27885.1 3645.2,-27874.01 3671.08,-27862.63"/>
<polygon fill="black" stroke="black" points="3672.51,-27865.83 3680.25,-27858.59 3669.69,-27859.42 3672.51,-27865.83"/>
</g>
<!-- stage1_layer0_attn_ellipsis&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge259" class="edge">
<title>stage1_layer0_attn_ellipsis&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3832.69,-27894.26C3832.69,-27886.66 3832.69,-27877.89 3832.69,-27868.76"/>
<polygon fill="black" stroke="black" points="3836.19,-27868.73 3832.69,-27858.73 3829.19,-27868.73 3836.19,-27868.73"/>
</g>
<!-- stage1_layer0_attn_head24&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge260" class="edge">
<title>stage1_layer0_attn_head24&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4066.54,-27894.41C4045.37,-27885.1 4020.18,-27874.01 3994.3,-27862.63"/>
<polygon fill="black" stroke="black" points="3995.69,-27859.42 3985.12,-27858.59 3992.87,-27865.83 3995.69,-27859.42"/>
</g>
<!-- stage1_layer0_attn_head25&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge261" class="edge">
<title>stage1_layer0_attn_head25&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4300.74,-27894.48C4256.03,-27884.65 4202.31,-27872.83 4147.45,-27860.77"/>
<polygon fill="black" stroke="black" points="4148.08,-27857.33 4137.56,-27858.6 4146.58,-27864.16 4148.08,-27857.33"/>
</g>
<!-- stage1_layer0_attn_head26&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge262" class="edge">
<title>stage1_layer0_attn_head26&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4568.93,-27896C4565.82,-27895.51 4562.74,-27895.02 4559.69,-27894.54 4477.61,-27881.71 4390.21,-27868.73 4305.51,-27856.52"/>
<polygon fill="black" stroke="black" points="4305.86,-27853.03 4295.46,-27855.07 4304.86,-27859.96 4305.86,-27853.03"/>
</g>
<!-- stage1_layer0_attn_head27&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge263" class="edge">
<title>stage1_layer0_attn_head27&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4859.95,-27895.84C4856.84,-27895.39 4853.75,-27894.96 4850.69,-27894.54 4660.01,-27868.6 4448.43,-27846.17 4267.77,-27828.93"/>
<polygon fill="black" stroke="black" points="4267.84,-27825.42 4257.56,-27827.96 4267.18,-27832.39 4267.84,-27825.42"/>
</g>
<!-- stage1_layer0_attn_head28&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge264" class="edge">
<title>stage1_layer0_attn_head28&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5150.97,-27895.74C5147.85,-27895.33 5144.75,-27894.93 5141.69,-27894.54 4843.68,-27857.38 4505.74,-27831.19 4247.88,-27814.52"/>
<polygon fill="black" stroke="black" points="4247.79,-27811.01 4237.59,-27813.86 4247.34,-27818 4247.79,-27811.01"/>
</g>
<!-- stage1_layer0_attn_head29&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge265" class="edge">
<title>stage1_layer0_attn_head29&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5441.97,-27895.69C5438.85,-27895.29 5435.75,-27894.9 5432.69,-27894.54 5026.71,-27846.85 4559.99,-27819.98 4235.82,-27805.74"/>
<polygon fill="black" stroke="black" points="4235.94,-27802.24 4225.79,-27805.3 4235.63,-27809.24 4235.94,-27802.24"/>
</g>
<!-- stage1_layer0_attn_head30&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge266" class="edge">
<title>stage1_layer0_attn_head30&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5732.98,-27895.64C5729.85,-27895.26 5726.75,-27894.89 5723.69,-27894.54 5208.76,-27836.63 4611.15,-27810.99 4227.82,-27799.83"/>
<polygon fill="black" stroke="black" points="4227.77,-27796.33 4217.67,-27799.54 4227.57,-27803.32 4227.77,-27796.33"/>
</g>
<!-- stage1_layer0_attn_head31&#45;&gt;stage1_layer0_attn_agg -->
<g id="edge267" class="edge">
<title>stage1_layer0_attn_head31&#45;&gt;stage1_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6023.98,-27895.61C6020.86,-27895.24 6017.76,-27894.88 6014.69,-27894.54 5389.76,-27826.55 4659.31,-27803.42 4221.99,-27795.57"/>
<polygon fill="black" stroke="black" points="4221.77,-27792.07 4211.71,-27795.39 4221.65,-27799.06 4221.77,-27792.07"/>
</g>
<!-- stage1_layer0_attn_out -->
<g id="node200" class="node">
<title>stage1_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="4057.69,-27686.54 3607.69,-27686.54 3607.69,-27618.54 4057.69,-27618.54 4057.69,-27686.54"/>
<text text-anchor="middle" x="3832.69" y="-27671.34" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Proj</text>
<text text-anchor="middle" x="3832.69" y="-27656.34" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP: GPU 128&#45;255)</text>
<text text-anchor="middle" x="3832.69" y="-27641.34" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-27626.34" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_attn_agg&#45;&gt;stage1_layer0_attn_out -->
<g id="edge268" class="edge">
<title>stage1_layer0_attn_agg&#45;&gt;stage1_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3832.69,-27722.34C3832.69,-27713.59 3832.69,-27704.82 3832.69,-27696.61"/>
<polygon fill="black" stroke="black" points="3836.19,-27696.56 3832.69,-27686.56 3829.19,-27696.56 3836.19,-27696.56"/>
</g>
<!-- stage1_layer0_tp_attn_comm -->
<g id="node201" class="node">
<title>stage1_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3832.69" cy="-27534.46" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3832.69" y="-27553.26" font-family="Times,serif" font-size="14.00">Layer 2 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3832.69" y="-27538.26" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP pairs)</text>
<text text-anchor="middle" x="3832.69" y="-27523.26" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3832.69" y="-27508.26" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_attn_out&#45;&gt;stage1_layer0_tp_attn_comm -->
<g id="edge269" class="edge">
<title>stage1_layer0_attn_out&#45;&gt;stage1_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3832.69,-27618.28C3832.69,-27610.29 3832.69,-27601.52 3832.69,-27592.78"/>
<polygon fill="black" stroke="black" points="3836.19,-27592.57 3832.69,-27582.57 3829.19,-27592.57 3836.19,-27592.57"/>
</g>
<!-- stage1_layer0_expert_router -->
<g id="node202" class="node">
<title>stage1_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3430.88,-27450.38 2708.36,-27450.38 2522.49,-27314.38 3245.02,-27314.38 3430.88,-27450.38"/>
<text text-anchor="middle" x="2976.69" y="-27401.18" font-family="Times,serif" font-size="14.00">Layer 2 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2976.69" y="-27386.18" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="2976.69" y="-27371.18" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2976.69" y="-27356.18" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage1_layer0_tp_attn_comm&#45;&gt;stage1_layer0_expert_router -->
<g id="edge270" class="edge">
<title>stage1_layer0_tp_attn_comm&#45;&gt;stage1_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3628.2,-27497.61C3550.26,-27483.94 3458.58,-27467.87 3368.99,-27452.16"/>
<polygon fill="black" stroke="black" points="3369.38,-27448.68 3358.93,-27450.4 3368.17,-27455.57 3369.38,-27448.68"/>
</g>
<!-- stage1_layer0_output -->
<g id="node265" class="node">
<title>stage1_layer0_output</title>
<polygon fill="none" stroke="black" points="4063.69,-26535.3 3613.69,-26535.3 3613.69,-26467.3 4063.69,-26467.3 4063.69,-26535.3"/>
<text text-anchor="middle" x="3838.69" y="-26520.1" font-family="Times,serif" font-size="14.00">Layer 2 Output</text>
<text text-anchor="middle" x="3838.69" y="-26505.1" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-26490.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-26475.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_tp_attn_comm&#45;&gt;stage1_layer0_output -->
<!-- stage1_layer0_expert0 -->
<g id="node203" class="node">
<title>stage1_layer0_expert0</title>
<polygon fill="none" stroke="black" points="1003.69,-27278.38 681.69,-27278.38 681.69,-27226.38 1003.69,-27226.38 1003.69,-27278.38"/>
<text text-anchor="middle" x="842.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 0</text>
<text text-anchor="middle" x="842.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP pair)</text>
<text text-anchor="middle" x="842.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="842.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert0 -->
<g id="edge271" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2588.05,-27362.37C2217.67,-27343.58 1644.43,-27312.72 1147.69,-27278.38 1104.29,-27275.38 1057.46,-27271.74 1013.83,-27268.18"/>
<polygon fill="black" stroke="black" points="1013.94,-27264.68 1003.69,-27267.35 1013.37,-27271.65 1013.94,-27264.68"/>
</g>
<!-- stage1_layer0_expert1 -->
<g id="node209" class="node">
<title>stage1_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1478.69,-27278.38 1156.69,-27278.38 1156.69,-27226.38 1478.69,-27226.38 1478.69,-27278.38"/>
<text text-anchor="middle" x="1317.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 1</text>
<text text-anchor="middle" x="1317.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP pair)</text>
<text text-anchor="middle" x="1317.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1317.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert1 -->
<g id="edge277" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2579.04,-27356C2293.97,-27336.97 1900.93,-27309.01 1555.69,-27278.38 1534.06,-27276.46 1511.34,-27274.28 1488.88,-27272.03"/>
<polygon fill="black" stroke="black" points="1489.23,-27268.55 1478.93,-27271.03 1488.53,-27275.51 1489.23,-27268.55"/>
</g>
<!-- stage1_layer0_expert2 -->
<g id="node215" class="node">
<title>stage1_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1886.69,-27278.38 1564.69,-27278.38 1564.69,-27226.38 1886.69,-27226.38 1886.69,-27278.38"/>
<text text-anchor="middle" x="1725.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 2</text>
<text text-anchor="middle" x="1725.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP pair)</text>
<text text-anchor="middle" x="1725.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert2 -->
<g id="edge283" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2561.2,-27342.8C2368.93,-27324.36 2137.56,-27301.34 1929.69,-27278.38 1919.03,-27277.2 1908.06,-27275.96 1897.01,-27274.67"/>
<polygon fill="black" stroke="black" points="1897.17,-27271.17 1886.84,-27273.49 1896.36,-27278.12 1897.17,-27271.17"/>
</g>
<!-- stage1_layer0_expert3 -->
<g id="node221" class="node">
<title>stage1_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2260.69,-27278.38 1938.69,-27278.38 1938.69,-27226.38 2260.69,-27226.38 2260.69,-27278.38"/>
<text text-anchor="middle" x="2099.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 3</text>
<text text-anchor="middle" x="2099.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP pair)</text>
<text text-anchor="middle" x="2099.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2099.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert3 -->
<g id="edge289" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2523.42,-27315.22C2433.51,-27302.1 2344.43,-27289.1 2271.32,-27278.43"/>
<polygon fill="black" stroke="black" points="2271.51,-27274.92 2261.11,-27276.94 2270.5,-27281.85 2271.51,-27274.92"/>
</g>
<!-- stage1_layer0_expert31 -->
<g id="node227" class="node">
<title>stage1_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2617.69,-27278.38 2295.69,-27278.38 2295.69,-27226.38 2617.69,-27226.38 2617.69,-27278.38"/>
<text text-anchor="middle" x="2456.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 31</text>
<text text-anchor="middle" x="2456.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP pair)</text>
<text text-anchor="middle" x="2456.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2456.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert31 -->
<g id="edge295" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2704.12,-27314.29C2656.05,-27302.45 2608.55,-27290.76 2568.22,-27280.83"/>
<polygon fill="black" stroke="black" points="2568.94,-27277.4 2558.39,-27278.41 2567.26,-27284.2 2568.94,-27277.4"/>
</g>
<!-- stage1_layer0_expert32 -->
<g id="node233" class="node">
<title>stage1_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2965.69,-27278.38 2643.69,-27278.38 2643.69,-27226.38 2965.69,-27226.38 2965.69,-27278.38"/>
<text text-anchor="middle" x="2804.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 32</text>
<text text-anchor="middle" x="2804.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP pair)</text>
<text text-anchor="middle" x="2804.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2804.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert32 -->
<g id="edge301" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2886.41,-27314.19C2872.57,-27303.89 2858.88,-27293.7 2846.77,-27284.7"/>
<polygon fill="black" stroke="black" points="2848.78,-27281.82 2838.66,-27278.66 2844.6,-27287.44 2848.78,-27281.82"/>
</g>
<!-- stage1_layer0_expert60 -->
<g id="node239" class="node">
<title>stage1_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3309.69,-27278.38 2987.69,-27278.38 2987.69,-27226.38 3309.69,-27226.38 3309.69,-27278.38"/>
<text text-anchor="middle" x="3148.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 60</text>
<text text-anchor="middle" x="3148.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP pair)</text>
<text text-anchor="middle" x="3148.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3148.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert60 -->
<g id="edge307" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3066.97,-27314.19C3080.81,-27303.89 3094.5,-27293.7 3106.6,-27284.7"/>
<polygon fill="black" stroke="black" points="3108.78,-27287.44 3114.71,-27278.66 3104.6,-27281.82 3108.78,-27287.44"/>
</g>
<!-- stage1_layer0_expert61 -->
<g id="node245" class="node">
<title>stage1_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3708.69,-27278.38 3386.69,-27278.38 3386.69,-27226.38 3708.69,-27226.38 3708.69,-27278.38"/>
<text text-anchor="middle" x="3547.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 61</text>
<text text-anchor="middle" x="3547.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP pair)</text>
<text text-anchor="middle" x="3547.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3547.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert61 -->
<g id="edge313" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3252.57,-27319.53C3313.47,-27305.88 3374.96,-27292.1 3425.93,-27280.67"/>
<polygon fill="black" stroke="black" points="3426.99,-27284.02 3435.98,-27278.42 3425.46,-27277.19 3426.99,-27284.02"/>
</g>
<!-- stage1_layer0_expert62 -->
<g id="node251" class="node">
<title>stage1_layer0_expert62</title>
<polygon fill="none" stroke="black" points="4057.69,-27278.38 3735.69,-27278.38 3735.69,-27226.38 4057.69,-27226.38 4057.69,-27278.38"/>
<text text-anchor="middle" x="3896.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 62</text>
<text text-anchor="middle" x="3896.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP pair)</text>
<text text-anchor="middle" x="3896.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3896.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert62 -->
<g id="edge319" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3279.53,-27339.33C3413.77,-27320.68 3573.61,-27298.45 3717.69,-27278.38 3720.36,-27278.01 3723.06,-27277.63 3725.78,-27277.25"/>
<polygon fill="black" stroke="black" points="3726.26,-27280.72 3735.68,-27275.87 3725.29,-27273.78 3726.26,-27280.72"/>
</g>
<!-- stage1_layer0_expert63 -->
<g id="node257" class="node">
<title>stage1_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4412.69,-27278.38 4090.69,-27278.38 4090.69,-27226.38 4412.69,-27226.38 4412.69,-27278.38"/>
<text text-anchor="middle" x="4251.69" y="-27266.38" font-family="Times,serif" font-size="10.00">Layer 2 Expert 63</text>
<text text-anchor="middle" x="4251.69" y="-27255.38" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP pair)</text>
<text text-anchor="middle" x="4251.69" y="-27244.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4251.69" y="-27233.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert63 -->
<g id="edge325" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3299.58,-27354.29C3516.68,-27335.23 3809.16,-27307.93 4066.69,-27278.38 4071.16,-27277.87 4075.68,-27277.33 4080.25,-27276.79"/>
<polygon fill="black" stroke="black" points="4080.79,-27280.25 4090.3,-27275.57 4079.95,-27273.3 4080.79,-27280.25"/>
</g>
<!-- stage1_layer0_expert_ellipsis -->
<g id="node263" class="node">
<title>stage1_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4874.69,-27190.38 4552.69,-27190.38 4552.69,-27138.38 4874.69,-27138.38 4874.69,-27190.38"/>
<text text-anchor="middle" x="4713.69" y="-27178.38" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4713.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4713.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4713.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert_ellipsis -->
<g id="edge331" class="edge">
<title>stage1_layer0_expert_router&#45;&gt;stage1_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3319.52,-27368.7C3679.1,-27353.3 4219.51,-27323.63 4421.69,-27278.38 4504.85,-27259.76 4595.66,-27221.57 4653.57,-27194.76"/>
<polygon fill="black" stroke="black" points="4655.35,-27197.79 4662.93,-27190.39 4652.39,-27191.45 4655.35,-27197.79"/>
</g>
<!-- stage1_layer0_expert0_mlp1 -->
<g id="node204" class="node">
<title>stage1_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="857.69,-27190.38 543.69,-27190.38 543.69,-27138.38 857.69,-27138.38 857.69,-27190.38"/>
<text text-anchor="middle" x="700.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="700.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP: Column Parallel)</text>
<text text-anchor="middle" x="700.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="700.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert0&#45;&gt;stage1_layer0_expert0_mlp1 -->
<g id="edge272" class="edge">
<title>stage1_layer0_expert0&#45;&gt;stage1_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M801.23,-27226.27C785.62,-27216.82 767.7,-27205.96 751.34,-27196.05"/>
<polygon fill="black" stroke="black" points="752.81,-27192.85 742.44,-27190.66 749.18,-27198.84 752.81,-27192.85"/>
</g>
<!-- stage1_layer0_expert0_tp1 -->
<g id="node205" class="node">
<title>stage1_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="590.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="590.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="590.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="590.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="590.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert0_mlp1&#45;&gt;stage1_layer0_expert0_tp1 -->
<g id="edge273" class="edge">
<title>stage1_layer0_expert0_mlp1&#45;&gt;stage1_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M672.07,-27138.21C661.83,-27129.2 649.99,-27118.78 638.57,-27108.73"/>
<polygon fill="black" stroke="black" points="640.57,-27105.83 630.75,-27101.85 635.95,-27111.09 640.57,-27105.83"/>
</g>
<!-- stage1_layer0_expert0_act -->
<g id="node206" class="node">
<title>stage1_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="644.19,-26992.84 363.19,-26992.84 363.19,-26940.84 644.19,-26940.84 644.19,-26992.84"/>
<text text-anchor="middle" x="503.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="503.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="503.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="503.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert0_tp1&#45;&gt;stage1_layer0_expert0_act -->
<g id="edge274" class="edge">
<title>stage1_layer0_expert0_tp1&#45;&gt;stage1_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M558.79,-27029.12C550.38,-27019.77 541.34,-27009.72 533.07,-27000.52"/>
<polygon fill="black" stroke="black" points="535.62,-26998.12 526.33,-26993.02 530.41,-27002.8 535.62,-26998.12"/>
</g>
<!-- stage1_layer0_expert0_mlp2 -->
<g id="node207" class="node">
<title>stage1_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="607.69,-26904.84 285.69,-26904.84 285.69,-26852.84 607.69,-26852.84 607.69,-26904.84"/>
<text text-anchor="middle" x="446.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="446.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP: Row Parallel)</text>
<text text-anchor="middle" x="446.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="446.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert0_act&#45;&gt;stage1_layer0_expert0_mlp2 -->
<g id="edge275" class="edge">
<title>stage1_layer0_expert0_act&#45;&gt;stage1_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M486.89,-26940.5C481.27,-26932.02 474.91,-26922.42 468.94,-26913.4"/>
<polygon fill="black" stroke="black" points="471.8,-26911.4 463.36,-26905 465.97,-26915.26 471.8,-26911.4"/>
</g>
<!-- stage1_layer0_expert0_tp2 -->
<g id="node208" class="node">
<title>stage1_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="380.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="380.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="380.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="380.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="380.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert0_mlp2&#45;&gt;stage1_layer0_expert0_tp2 -->
<g id="edge276" class="edge">
<title>stage1_layer0_expert0_mlp2&#45;&gt;stage1_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M429.52,-26852.67C423.79,-26844.26 417.22,-26834.63 410.8,-26825.22"/>
<polygon fill="black" stroke="black" points="413.5,-26822.97 404.98,-26816.68 407.72,-26826.91 413.5,-26822.97"/>
</g>
<!-- stage1_layer0_expert_agg -->
<g id="node264" class="node">
<title>stage1_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3533.22,-26707.3 2657.45,-26707.3 2432.16,-26571.3 3307.93,-26571.3 3533.22,-26707.3"/>
<text text-anchor="middle" x="2982.69" y="-26658.1" font-family="Times,serif" font-size="14.00">Layer 2 Expert Aggregation</text>
<text text-anchor="middle" x="2982.69" y="-26643.1" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="2982.69" y="-26628.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2982.69" y="-26613.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert0_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge332" class="edge">
<title>stage1_layer0_expert0_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M535.9,-26753.13C562.78,-26749.33 590.5,-26745.85 616.69,-26743.3 1287.12,-26678.09 2068.46,-26654.16 2544.17,-26645.38"/>
<polygon fill="black" stroke="black" points="2544.37,-26648.88 2554.3,-26645.19 2544.24,-26641.88 2544.37,-26648.88"/>
</g>
<!-- stage1_layer0_expert1_mlp1 -->
<g id="node210" class="node">
<title>stage1_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1264.69,-27190.38 950.69,-27190.38 950.69,-27138.38 1264.69,-27138.38 1264.69,-27190.38"/>
<text text-anchor="middle" x="1107.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1107.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1107.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1107.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert1&#45;&gt;stage1_layer0_expert1_mlp1 -->
<g id="edge278" class="edge">
<title>stage1_layer0_expert1&#45;&gt;stage1_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1256.38,-27226.27C1232.01,-27216.29 1203.83,-27204.75 1178.58,-27194.41"/>
<polygon fill="black" stroke="black" points="1179.65,-27191.07 1169.07,-27190.51 1177,-27197.54 1179.65,-27191.07"/>
</g>
<!-- stage1_layer0_expert1_tp1 -->
<g id="node211" class="node">
<title>stage1_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="1006.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1006.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="1006.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="1006.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1006.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert1_mlp1&#45;&gt;stage1_layer0_expert1_tp1 -->
<g id="edge279" class="edge">
<title>stage1_layer0_expert1_mlp1&#45;&gt;stage1_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M1081.42,-27138.21C1072.1,-27129.28 1061.35,-27118.98 1050.95,-27109.02"/>
<polygon fill="black" stroke="black" points="1053.12,-27106.24 1043.47,-27101.85 1048.27,-27111.3 1053.12,-27106.24"/>
</g>
<!-- stage1_layer0_expert1_act -->
<g id="node212" class="node">
<title>stage1_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="997.19,-26992.84 716.19,-26992.84 716.19,-26940.84 997.19,-26940.84 997.19,-26992.84"/>
<text text-anchor="middle" x="856.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="856.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="856.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="856.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert1_tp1&#45;&gt;stage1_layer0_expert1_act -->
<g id="edge280" class="edge">
<title>stage1_layer0_expert1_tp1&#45;&gt;stage1_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M952.96,-27029.95C936.93,-27019.6 919.49,-27008.35 903.91,-26998.3"/>
<polygon fill="black" stroke="black" points="905.76,-26995.33 895.46,-26992.85 901.97,-27001.21 905.76,-26995.33"/>
</g>
<!-- stage1_layer0_expert1_mlp2 -->
<g id="node213" class="node">
<title>stage1_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="1016.69,-26904.84 694.69,-26904.84 694.69,-26852.84 1016.69,-26852.84 1016.69,-26904.84"/>
<text text-anchor="middle" x="855.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="855.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP: Row Parallel)</text>
<text text-anchor="middle" x="855.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="855.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert1_act&#45;&gt;stage1_layer0_expert1_mlp2 -->
<g id="edge281" class="edge">
<title>stage1_layer0_expert1_act&#45;&gt;stage1_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M856.39,-26940.5C856.3,-26932.54 856.2,-26923.6 856.1,-26915.08"/>
<polygon fill="black" stroke="black" points="859.6,-26914.95 855.98,-26905 852.6,-26915.04 859.6,-26914.95"/>
</g>
<!-- stage1_layer0_expert1_tp2 -->
<g id="node214" class="node">
<title>stage1_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="853.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="853.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="853.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="853.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="853.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert1_mlp2&#45;&gt;stage1_layer0_expert1_tp2 -->
<g id="edge282" class="edge">
<title>stage1_layer0_expert1_mlp2&#45;&gt;stage1_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M855.17,-26852.67C855.01,-26844.86 854.82,-26835.99 854.64,-26827.22"/>
<polygon fill="black" stroke="black" points="858.14,-26826.97 854.43,-26817.05 851.14,-26827.12 858.14,-26826.97"/>
</g>
<!-- stage1_layer0_expert1_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge333" class="edge">
<title>stage1_layer0_expert1_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1009.88,-26753.24C1036.46,-26749.46 1063.82,-26745.96 1089.69,-26743.3 1591.29,-26691.76 2170.49,-26665.02 2554.77,-26651.85"/>
<polygon fill="black" stroke="black" points="2555.07,-26655.35 2564.94,-26651.51 2554.83,-26648.35 2555.07,-26655.35"/>
</g>
<!-- stage1_layer0_expert2_mlp1 -->
<g id="node216" class="node">
<title>stage1_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1637.69,-27190.38 1323.69,-27190.38 1323.69,-27138.38 1637.69,-27138.38 1637.69,-27190.38"/>
<text text-anchor="middle" x="1480.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1480.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1480.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1480.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert2&#45;&gt;stage1_layer0_expert2_mlp1 -->
<g id="edge284" class="edge">
<title>stage1_layer0_expert2&#45;&gt;stage1_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1654.17,-27226.27C1625.24,-27216.12 1591.69,-27204.34 1561.85,-27193.87"/>
<polygon fill="black" stroke="black" points="1562.89,-27190.52 1552.3,-27190.51 1560.58,-27197.13 1562.89,-27190.52"/>
</g>
<!-- stage1_layer0_expert2_tp1 -->
<g id="node217" class="node">
<title>stage1_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1477.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1477.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1477.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="1477.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1477.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert2_mlp1&#45;&gt;stage1_layer0_expert2_tp1 -->
<g id="edge285" class="edge">
<title>stage1_layer0_expert2_mlp1&#45;&gt;stage1_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1479.91,-27138.21C1479.67,-27130.4 1479.39,-27121.53 1479.12,-27112.76"/>
<polygon fill="black" stroke="black" points="1482.61,-27112.47 1478.8,-27102.58 1475.62,-27112.69 1482.61,-27112.47"/>
</g>
<!-- stage1_layer0_expert2_act -->
<g id="node218" class="node">
<title>stage1_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1575.19,-26992.84 1294.19,-26992.84 1294.19,-26940.84 1575.19,-26940.84 1575.19,-26992.84"/>
<text text-anchor="middle" x="1434.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1434.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="1434.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1434.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert2_tp1&#45;&gt;stage1_layer0_expert2_act -->
<g id="edge286" class="edge">
<title>stage1_layer0_expert2_tp1&#45;&gt;stage1_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1461.8,-27028.85C1457.94,-27020.17 1453.82,-27010.9 1449.99,-27002.28"/>
<polygon fill="black" stroke="black" points="1453.08,-27000.6 1445.82,-26992.88 1446.68,-27003.44 1453.08,-27000.6"/>
</g>
<!-- stage1_layer0_expert2_mlp2 -->
<g id="node219" class="node">
<title>stage1_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1553.69,-26904.84 1231.69,-26904.84 1231.69,-26852.84 1553.69,-26852.84 1553.69,-26904.84"/>
<text text-anchor="middle" x="1392.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1392.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1392.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1392.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert2_act&#45;&gt;stage1_layer0_expert2_mlp2 -->
<g id="edge287" class="edge">
<title>stage1_layer0_expert2_act&#45;&gt;stage1_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1422.31,-26940.5C1418.3,-26932.28 1413.77,-26923.01 1409.49,-26914.24"/>
<polygon fill="black" stroke="black" points="1412.51,-26912.45 1404.97,-26905 1406.22,-26915.52 1412.51,-26912.45"/>
</g>
<!-- stage1_layer0_expert2_tp2 -->
<g id="node220" class="node">
<title>stage1_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1326.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1326.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1326.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="1326.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1326.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert2_mlp2&#45;&gt;stage1_layer0_expert2_tp2 -->
<g id="edge288" class="edge">
<title>stage1_layer0_expert2_mlp2&#45;&gt;stage1_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1375.52,-26852.67C1369.79,-26844.26 1363.22,-26834.63 1356.8,-26825.22"/>
<polygon fill="black" stroke="black" points="1359.5,-26822.97 1350.98,-26816.68 1353.72,-26826.91 1359.5,-26822.97"/>
</g>
<!-- stage1_layer0_expert2_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge334" class="edge">
<title>stage1_layer0_expert2_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1484.19,-26753.45C1510.36,-26749.7 1537.26,-26746.14 1562.69,-26743.3 1901.19,-26705.43 2286.73,-26678.48 2570.58,-26661.68"/>
<polygon fill="black" stroke="black" points="2570.85,-26665.17 2580.63,-26661.08 2570.44,-26658.18 2570.85,-26665.17"/>
</g>
<!-- stage1_layer0_expert3_mlp1 -->
<g id="node222" class="node">
<title>stage1_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2231.69,-27190.38 1917.69,-27190.38 1917.69,-27138.38 2231.69,-27138.38 2231.69,-27190.38"/>
<text text-anchor="middle" x="2074.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="2074.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2074.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2074.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert3&#45;&gt;stage1_layer0_expert3_mlp1 -->
<g id="edge290" class="edge">
<title>stage1_layer0_expert3&#45;&gt;stage1_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M2092.32,-27226.04C2089.98,-27217.99 2087.35,-27208.94 2084.85,-27200.34"/>
<polygon fill="black" stroke="black" points="2088.15,-27199.16 2082,-27190.53 2081.43,-27201.11 2088.15,-27199.16"/>
</g>
<!-- stage1_layer0_expert3_tp1 -->
<g id="node223" class="node">
<title>stage1_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1920.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1920.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1920.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="1920.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1920.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert3_mlp1&#45;&gt;stage1_layer0_expert3_tp1 -->
<g id="edge291" class="edge">
<title>stage1_layer0_expert3_mlp1&#45;&gt;stage1_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M2034.63,-27138.21C2019.3,-27128.57 2001.41,-27117.33 1984.41,-27106.65"/>
<polygon fill="black" stroke="black" points="1985.95,-27103.48 1975.62,-27101.12 1982.22,-27109.41 1985.95,-27103.48"/>
</g>
<!-- stage1_layer0_expert3_act -->
<g id="node224" class="node">
<title>stage1_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="2030.19,-26992.84 1749.19,-26992.84 1749.19,-26940.84 2030.19,-26940.84 2030.19,-26992.84"/>
<text text-anchor="middle" x="1889.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1889.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="1889.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1889.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert3_tp1&#45;&gt;stage1_layer0_expert3_act -->
<g id="edge292" class="edge">
<title>stage1_layer0_expert3_tp1&#45;&gt;stage1_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1909.23,-27028.85C1906.48,-27020.26 1903.55,-27011.1 1900.81,-27002.55"/>
<polygon fill="black" stroke="black" points="1904.1,-27001.34 1897.71,-26992.88 1897.43,-27003.47 1904.1,-27001.34"/>
</g>
<!-- stage1_layer0_expert3_mlp2 -->
<g id="node225" class="node">
<title>stage1_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="2020.69,-26904.84 1698.69,-26904.84 1698.69,-26852.84 2020.69,-26852.84 2020.69,-26904.84"/>
<text text-anchor="middle" x="1859.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1859.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1859.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1859.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert3_act&#45;&gt;stage1_layer0_expert3_mlp2 -->
<g id="edge293" class="edge">
<title>stage1_layer0_expert3_act&#45;&gt;stage1_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1880.85,-26940.5C1878.01,-26932.37 1874.82,-26923.21 1871.79,-26914.52"/>
<polygon fill="black" stroke="black" points="1875.06,-26913.28 1868.46,-26905 1868.45,-26915.59 1875.06,-26913.28"/>
</g>
<!-- stage1_layer0_expert3_tp2 -->
<g id="node226" class="node">
<title>stage1_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1799.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1799.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1799.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="1799.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1799.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert3_mlp2&#45;&gt;stage1_layer0_expert3_tp2 -->
<g id="edge294" class="edge">
<title>stage1_layer0_expert3_mlp2&#45;&gt;stage1_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1844.08,-26852.67C1838.87,-26844.26 1832.9,-26834.63 1827.06,-26825.22"/>
<polygon fill="black" stroke="black" points="1830.01,-26823.33 1821.77,-26816.68 1824.06,-26827.02 1830.01,-26823.33"/>
</g>
<!-- stage1_layer0_expert3_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge335" class="edge">
<title>stage1_layer0_expert3_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1959.83,-26753.87C1985.19,-26750.15 2011.13,-26746.49 2035.69,-26743.3 2220.29,-26719.28 2425.65,-26696.47 2597.81,-26678.45"/>
<polygon fill="black" stroke="black" points="2598.22,-26681.93 2607.8,-26677.41 2597.49,-26674.96 2598.22,-26681.93"/>
</g>
<!-- stage1_layer0_expert31_mlp1 -->
<g id="node228" class="node">
<title>stage1_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2597.69,-27190.38 2283.69,-27190.38 2283.69,-27138.38 2597.69,-27138.38 2597.69,-27190.38"/>
<text text-anchor="middle" x="2440.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2440.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2440.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2440.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert31&#45;&gt;stage1_layer0_expert31_mlp1 -->
<g id="edge296" class="edge">
<title>stage1_layer0_expert31&#45;&gt;stage1_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2451.97,-27226.04C2450.49,-27218.08 2448.83,-27209.14 2447.25,-27200.62"/>
<polygon fill="black" stroke="black" points="2450.64,-27199.73 2445.37,-27190.53 2443.76,-27201.01 2450.64,-27199.73"/>
</g>
<!-- stage1_layer0_expert31_tp1 -->
<g id="node229" class="node">
<title>stage1_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2349.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2349.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2349.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="2349.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2349.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert31_mlp1&#45;&gt;stage1_layer0_expert31_tp1 -->
<g id="edge297" class="edge">
<title>stage1_layer0_expert31_mlp1&#45;&gt;stage1_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2417.02,-27138.21C2408.79,-27129.46 2399.32,-27119.39 2390.13,-27109.61"/>
<polygon fill="black" stroke="black" points="2392.58,-27107.11 2383.18,-27102.22 2387.48,-27111.9 2392.58,-27107.11"/>
</g>
<!-- stage1_layer0_expert31_act -->
<g id="node230" class="node">
<title>stage1_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2470.19,-26992.84 2189.19,-26992.84 2189.19,-26940.84 2470.19,-26940.84 2470.19,-26992.84"/>
<text text-anchor="middle" x="2329.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2329.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="2329.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2329.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert31_tp1&#45;&gt;stage1_layer0_expert31_act -->
<g id="edge298" class="edge">
<title>stage1_layer0_expert31_tp1&#45;&gt;stage1_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2342.3,-27028.85C2340.54,-27020.35 2338.67,-27011.3 2336.92,-27002.83"/>
<polygon fill="black" stroke="black" points="2340.32,-27001.97 2334.86,-26992.88 2333.46,-27003.38 2340.32,-27001.97"/>
</g>
<!-- stage1_layer0_expert31_mlp2 -->
<g id="node231" class="node">
<title>stage1_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2471.69,-26904.84 2149.69,-26904.84 2149.69,-26852.84 2471.69,-26852.84 2471.69,-26904.84"/>
<text text-anchor="middle" x="2310.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2310.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2310.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2310.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert31_act&#45;&gt;stage1_layer0_expert31_mlp2 -->
<g id="edge299" class="edge">
<title>stage1_layer0_expert31_act&#45;&gt;stage1_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2324.09,-26940.5C2322.31,-26932.45 2320.31,-26923.41 2318.41,-26914.8"/>
<polygon fill="black" stroke="black" points="2321.82,-26914 2316.25,-26905 2314.99,-26915.51 2321.82,-26914"/>
</g>
<!-- stage1_layer0_expert31_tp2 -->
<g id="node232" class="node">
<title>stage1_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2272.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2272.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2272.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="2272.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2272.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert31_mlp2&#45;&gt;stage1_layer0_expert31_tp2 -->
<g id="edge300" class="edge">
<title>stage1_layer0_expert31_mlp2&#45;&gt;stage1_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2300.8,-26852.67C2297.64,-26844.6 2294.03,-26835.41 2290.48,-26826.37"/>
<polygon fill="black" stroke="black" points="2293.73,-26825.07 2286.82,-26817.05 2287.21,-26827.63 2293.73,-26825.07"/>
</g>
<!-- stage1_layer0_expert31_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge336" class="edge">
<title>stage1_layer0_expert31_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2414.66,-26751.32C2480.77,-26738.4 2562.52,-26722.42 2643.2,-26706.65"/>
<polygon fill="black" stroke="black" points="2643.89,-26710.09 2653.03,-26704.73 2642.54,-26703.22 2643.89,-26710.09"/>
</g>
<!-- stage1_layer0_expert32_mlp1 -->
<g id="node234" class="node">
<title>stage1_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2949.69,-27190.38 2635.69,-27190.38 2635.69,-27138.38 2949.69,-27138.38 2949.69,-27190.38"/>
<text text-anchor="middle" x="2792.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2792.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2792.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2792.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert32&#45;&gt;stage1_layer0_expert32_mlp1 -->
<g id="edge302" class="edge">
<title>stage1_layer0_expert32&#45;&gt;stage1_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2801.15,-27226.04C2800.04,-27218.08 2798.79,-27209.14 2797.61,-27200.62"/>
<polygon fill="black" stroke="black" points="2801.05,-27199.95 2796.2,-27190.53 2794.11,-27200.92 2801.05,-27199.95"/>
</g>
<!-- stage1_layer0_expert32_tp1 -->
<g id="node235" class="node">
<title>stage1_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2771.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2771.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2771.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="2771.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2771.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert32_mlp1&#45;&gt;stage1_layer0_expert32_tp1 -->
<g id="edge303" class="edge">
<title>stage1_layer0_expert32_mlp1&#45;&gt;stage1_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2787.23,-27138.21C2785.51,-27130.31 2783.57,-27121.34 2781.64,-27112.48"/>
<polygon fill="black" stroke="black" points="2785.04,-27111.61 2779.5,-27102.58 2778.2,-27113.1 2785.04,-27111.61"/>
</g>
<!-- stage1_layer0_expert32_act -->
<g id="node236" class="node">
<title>stage1_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2905.19,-26992.84 2624.19,-26992.84 2624.19,-26940.84 2905.19,-26940.84 2905.19,-26992.84"/>
<text text-anchor="middle" x="2764.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2764.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="2764.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2764.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert32_tp1&#45;&gt;stage1_layer0_expert32_act -->
<g id="edge304" class="edge">
<title>stage1_layer0_expert32_tp1&#45;&gt;stage1_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2769.08,-27028.57C2768.48,-27020.26 2767.84,-27011.43 2767.24,-27003.15"/>
<polygon fill="black" stroke="black" points="2770.72,-27002.76 2766.51,-26993.03 2763.74,-27003.26 2770.72,-27002.76"/>
</g>
<!-- stage1_layer0_expert32_mlp2 -->
<g id="node237" class="node">
<title>stage1_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2919.69,-26904.84 2597.69,-26904.84 2597.69,-26852.84 2919.69,-26852.84 2919.69,-26904.84"/>
<text text-anchor="middle" x="2758.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2758.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2758.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2758.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert32_act&#45;&gt;stage1_layer0_expert32_mlp2 -->
<g id="edge305" class="edge">
<title>stage1_layer0_expert32_act&#45;&gt;stage1_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2762.92,-26940.5C2762.37,-26932.54 2761.74,-26923.6 2761.15,-26915.08"/>
<polygon fill="black" stroke="black" points="2764.63,-26914.73 2760.44,-26905 2757.65,-26915.21 2764.63,-26914.73"/>
</g>
<!-- stage1_layer0_expert32_tp2 -->
<g id="node238" class="node">
<title>stage1_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2745.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2745.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2745.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="2745.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2745.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert32_mlp2&#45;&gt;stage1_layer0_expert32_tp2 -->
<g id="edge306" class="edge">
<title>stage1_layer0_expert32_mlp2&#45;&gt;stage1_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2755.31,-26852.67C2754.26,-26844.86 2753.07,-26835.99 2751.89,-26827.22"/>
<polygon fill="black" stroke="black" points="2755.32,-26826.49 2750.52,-26817.05 2748.38,-26827.42 2755.32,-26826.49"/>
</g>
<!-- stage1_layer0_expert32_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge337" class="edge">
<title>stage1_layer0_expert32_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2804.88,-26744.41C2821.53,-26734.66 2840.28,-26723.69 2859.2,-26712.61"/>
<polygon fill="black" stroke="black" points="2861.03,-26715.59 2867.89,-26707.52 2857.49,-26709.55 2861.03,-26715.59"/>
</g>
<!-- stage1_layer0_expert60_mlp1 -->
<g id="node240" class="node">
<title>stage1_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3307.69,-27190.38 2993.69,-27190.38 2993.69,-27138.38 3307.69,-27138.38 3307.69,-27190.38"/>
<text text-anchor="middle" x="3150.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3150.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3150.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3150.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert60&#45;&gt;stage1_layer0_expert60_mlp1 -->
<g id="edge308" class="edge">
<title>stage1_layer0_expert60&#45;&gt;stage1_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3149.28,-27226.04C3149.46,-27218.08 3149.67,-27209.14 3149.87,-27200.62"/>
<polygon fill="black" stroke="black" points="3153.37,-27200.61 3150.1,-27190.53 3146.37,-27200.45 3153.37,-27200.61"/>
</g>
<!-- stage1_layer0_expert60_tp1 -->
<g id="node241" class="node">
<title>stage1_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3189.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3189.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3189.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="3189.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3189.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert60_mlp1&#45;&gt;stage1_layer0_expert60_tp1 -->
<g id="edge309" class="edge">
<title>stage1_layer0_expert60_mlp1&#45;&gt;stage1_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3160.83,-27138.21C3164.08,-27130.14 3167.79,-27120.95 3171.43,-27111.91"/>
<polygon fill="black" stroke="black" points="3174.7,-27113.17 3175.19,-27102.58 3168.2,-27110.55 3174.7,-27113.17"/>
</g>
<!-- stage1_layer0_expert60_act -->
<g id="node242" class="node">
<title>stage1_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3330.19,-26992.84 3049.19,-26992.84 3049.19,-26940.84 3330.19,-26940.84 3330.19,-26992.84"/>
<text text-anchor="middle" x="3189.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3189.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="3189.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3189.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert60_tp1&#45;&gt;stage1_layer0_expert60_act -->
<g id="edge310" class="edge">
<title>stage1_layer0_expert60_tp1&#45;&gt;stage1_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3189.69,-27028.57C3189.69,-27020.26 3189.69,-27011.43 3189.69,-27003.15"/>
<polygon fill="black" stroke="black" points="3193.19,-27003.03 3189.69,-26993.03 3186.19,-27003.03 3193.19,-27003.03"/>
</g>
<!-- stage1_layer0_expert60_mlp2 -->
<g id="node243" class="node">
<title>stage1_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3379.69,-26904.84 3057.69,-26904.84 3057.69,-26852.84 3379.69,-26852.84 3379.69,-26904.84"/>
<text text-anchor="middle" x="3218.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3218.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3218.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3218.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert60_act&#45;&gt;stage1_layer0_expert60_mlp2 -->
<g id="edge311" class="edge">
<title>stage1_layer0_expert60_act&#45;&gt;stage1_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3198.23,-26940.5C3200.98,-26932.37 3204.06,-26923.21 3206.99,-26914.52"/>
<polygon fill="black" stroke="black" points="3210.33,-26915.59 3210.21,-26905 3203.69,-26913.35 3210.33,-26915.59"/>
</g>
<!-- stage1_layer0_expert60_tp2 -->
<g id="node244" class="node">
<title>stage1_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3218.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3218.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3218.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="3218.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3218.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert60_mlp2&#45;&gt;stage1_layer0_expert60_tp2 -->
<g id="edge312" class="edge">
<title>stage1_layer0_expert60_mlp2&#45;&gt;stage1_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3218.69,-26852.67C3218.69,-26844.86 3218.69,-26835.99 3218.69,-26827.22"/>
<polygon fill="black" stroke="black" points="3222.19,-26827.05 3218.69,-26817.05 3215.19,-26827.05 3222.19,-26827.05"/>
</g>
<!-- stage1_layer0_expert60_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge338" class="edge">
<title>stage1_layer0_expert60_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3159.74,-26744.41C3143.17,-26734.66 3124.5,-26723.69 3105.66,-26712.61"/>
<polygon fill="black" stroke="black" points="3107.39,-26709.57 3097,-26707.52 3103.85,-26715.6 3107.39,-26709.57"/>
</g>
<!-- stage1_layer0_expert61_mlp1 -->
<g id="node246" class="node">
<title>stage1_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3716.69,-27190.38 3402.69,-27190.38 3402.69,-27138.38 3716.69,-27138.38 3716.69,-27190.38"/>
<text text-anchor="middle" x="3559.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3559.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3559.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3559.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert61&#45;&gt;stage1_layer0_expert61_mlp1 -->
<g id="edge314" class="edge">
<title>stage1_layer0_expert61&#45;&gt;stage1_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3551.22,-27226.04C3552.33,-27218.08 3553.58,-27209.14 3554.77,-27200.62"/>
<polygon fill="black" stroke="black" points="3558.26,-27200.92 3556.18,-27190.53 3551.33,-27199.95 3558.26,-27200.92"/>
</g>
<!-- stage1_layer0_expert61_tp1 -->
<g id="node247" class="node">
<title>stage1_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3626.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3626.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3626.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="3626.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3626.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert61_mlp1&#45;&gt;stage1_layer0_expert61_tp1 -->
<g id="edge315" class="edge">
<title>stage1_layer0_expert61_mlp1&#45;&gt;stage1_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3577.12,-27138.21C3582.99,-27129.72 3589.74,-27119.98 3596.32,-27110.47"/>
<polygon fill="black" stroke="black" points="3599.22,-27112.43 3602.03,-27102.22 3593.46,-27108.45 3599.22,-27112.43"/>
</g>
<!-- stage1_layer0_expert61_act -->
<g id="node248" class="node">
<title>stage1_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3778.19,-26992.84 3497.19,-26992.84 3497.19,-26940.84 3778.19,-26940.84 3778.19,-26992.84"/>
<text text-anchor="middle" x="3637.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3637.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="3637.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3637.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert61_tp1&#45;&gt;stage1_layer0_expert61_act -->
<g id="edge316" class="edge">
<title>stage1_layer0_expert61_tp1&#45;&gt;stage1_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3630.78,-27028.57C3631.73,-27020.26 3632.73,-27011.43 3633.67,-27003.15"/>
<polygon fill="black" stroke="black" points="3637.17,-27003.37 3634.82,-26993.03 3630.22,-27002.58 3637.17,-27003.37"/>
</g>
<!-- stage1_layer0_expert61_mlp2 -->
<g id="node249" class="node">
<title>stage1_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3841.69,-26904.84 3519.69,-26904.84 3519.69,-26852.84 3841.69,-26852.84 3841.69,-26904.84"/>
<text text-anchor="middle" x="3680.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3680.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3680.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3680.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert61_act&#45;&gt;stage1_layer0_expert61_mlp2 -->
<g id="edge317" class="edge">
<title>stage1_layer0_expert61_act&#45;&gt;stage1_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3650.36,-26940.5C3654.51,-26932.19 3659.2,-26922.81 3663.63,-26913.96"/>
<polygon fill="black" stroke="black" points="3666.77,-26915.5 3668.11,-26905 3660.51,-26912.37 3666.77,-26915.5"/>
</g>
<!-- stage1_layer0_expert61_tp2 -->
<g id="node250" class="node">
<title>stage1_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3691.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3691.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3691.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="3691.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3691.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert61_mlp2&#45;&gt;stage1_layer0_expert61_tp2 -->
<g id="edge318" class="edge">
<title>stage1_layer0_expert61_mlp2&#45;&gt;stage1_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3683.55,-26852.67C3684.44,-26844.86 3685.45,-26835.99 3686.44,-26827.22"/>
<polygon fill="black" stroke="black" points="3689.95,-26827.38 3687.6,-26817.05 3682.99,-26826.59 3689.95,-26827.38"/>
</g>
<!-- stage1_layer0_expert61_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge339" class="edge">
<title>stage1_layer0_expert61_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3549.49,-26751.24C3487.3,-26739.07 3411.31,-26724.19 3335.43,-26709.34"/>
<polygon fill="black" stroke="black" points="3335.69,-26705.83 3325.21,-26707.34 3334.35,-26712.7 3335.69,-26705.83"/>
</g>
<!-- stage1_layer0_expert62_mlp1 -->
<g id="node252" class="node">
<title>stage1_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="4064.69,-27190.38 3750.69,-27190.38 3750.69,-27138.38 4064.69,-27138.38 4064.69,-27190.38"/>
<text text-anchor="middle" x="3907.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3907.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3907.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3907.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert62&#45;&gt;stage1_layer0_expert62_mlp1 -->
<g id="edge320" class="edge">
<title>stage1_layer0_expert62&#45;&gt;stage1_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3899.93,-27226.04C3900.95,-27218.08 3902.09,-27209.14 3903.18,-27200.62"/>
<polygon fill="black" stroke="black" points="3906.67,-27200.9 3904.47,-27190.53 3899.73,-27200.01 3906.67,-27200.9"/>
</g>
<!-- stage1_layer0_expert62_tp1 -->
<g id="node253" class="node">
<title>stage1_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="4060.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4060.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="4060.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="4060.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4060.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert62_mlp1&#45;&gt;stage1_layer0_expert62_tp1 -->
<g id="edge321" class="edge">
<title>stage1_layer0_expert62_mlp1&#45;&gt;stage1_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3947.49,-27138.21C3962.72,-27128.57 3980.49,-27117.33 3997.38,-27106.65"/>
<polygon fill="black" stroke="black" points="3999.53,-27109.43 4006.12,-27101.12 3995.79,-27103.51 3999.53,-27109.43"/>
</g>
<!-- stage1_layer0_expert62_act -->
<g id="node254" class="node">
<title>stage1_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4219.19,-26992.84 3938.19,-26992.84 3938.19,-26940.84 4219.19,-26940.84 4219.19,-26992.84"/>
<text text-anchor="middle" x="4078.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="4078.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="4078.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4078.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert62_tp1&#45;&gt;stage1_layer0_expert62_act -->
<g id="edge322" class="edge">
<title>stage1_layer0_expert62_tp1&#45;&gt;stage1_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M4067.34,-27028.85C4068.92,-27020.35 4070.6,-27011.3 4072.18,-27002.83"/>
<polygon fill="black" stroke="black" points="4075.64,-27003.35 4074.03,-26992.88 4068.76,-27002.07 4075.64,-27003.35"/>
</g>
<!-- stage1_layer0_expert62_mlp2 -->
<g id="node255" class="node">
<title>stage1_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4288.69,-26904.84 3966.69,-26904.84 3966.69,-26852.84 4288.69,-26852.84 4288.69,-26904.84"/>
<text text-anchor="middle" x="4127.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4127.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4127.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4127.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert62_act&#45;&gt;stage1_layer0_expert62_mlp2 -->
<g id="edge323" class="edge">
<title>stage1_layer0_expert62_act&#45;&gt;stage1_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4093.12,-26940.5C4097.86,-26932.19 4103.2,-26922.81 4108.25,-26913.96"/>
<polygon fill="black" stroke="black" points="4111.45,-26915.42 4113.35,-26905 4105.36,-26911.95 4111.45,-26915.42"/>
</g>
<!-- stage1_layer0_expert62_tp2 -->
<g id="node256" class="node">
<title>stage1_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4164.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4164.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4164.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="4164.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4164.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert62_mlp2&#45;&gt;stage1_layer0_expert62_tp2 -->
<g id="edge324" class="edge">
<title>stage1_layer0_expert62_mlp2&#45;&gt;stage1_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4137.31,-26852.67C4140.36,-26844.69 4143.84,-26835.61 4147.26,-26826.65"/>
<polygon fill="black" stroke="black" points="4150.63,-26827.64 4150.93,-26817.05 4144.09,-26825.14 4150.63,-26827.64"/>
</g>
<!-- stage1_layer0_expert62_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge340" class="edge">
<title>stage1_layer0_expert62_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4004.54,-26753.87C3979.19,-26750.15 3953.24,-26746.5 3928.69,-26743.3 3796.83,-26726.14 3654.38,-26709.58 3521.02,-26694.96"/>
<polygon fill="black" stroke="black" points="3521.35,-26691.47 3511.03,-26693.86 3520.59,-26698.43 3521.35,-26691.47"/>
</g>
<!-- stage1_layer0_expert63_mlp1 -->
<g id="node258" class="node">
<title>stage1_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4416.69,-27190.38 4102.69,-27190.38 4102.69,-27138.38 4416.69,-27138.38 4416.69,-27190.38"/>
<text text-anchor="middle" x="4259.69" y="-27178.38" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4259.69" y="-27167.38" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4259.69" y="-27156.38" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4259.69" y="-27145.38" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer0_expert63&#45;&gt;stage1_layer0_expert63_mlp1 -->
<g id="edge326" class="edge">
<title>stage1_layer0_expert63&#45;&gt;stage1_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4254.05,-27226.04C4254.79,-27218.08 4255.62,-27209.14 4256.41,-27200.62"/>
<polygon fill="black" stroke="black" points="4259.91,-27200.82 4257.35,-27190.53 4252.94,-27200.17 4259.91,-27200.82"/>
</g>
<!-- stage1_layer0_expert63_tp1 -->
<g id="node259" class="node">
<title>stage1_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4544.69" cy="-27065.61" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4544.69" y="-27079.61" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4544.69" y="-27068.61" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="4544.69" y="-27057.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4544.69" y="-27046.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert63_mlp1&#45;&gt;stage1_layer0_expert63_tp1 -->
<g id="edge327" class="edge">
<title>stage1_layer0_expert63_mlp1&#45;&gt;stage1_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4333.45,-27138.33C4366.61,-27127.07 4406.3,-27113.6 4442.27,-27101.38"/>
<polygon fill="black" stroke="black" points="4443.48,-27104.67 4451.82,-27098.14 4441.22,-27098.04 4443.48,-27104.67"/>
</g>
<!-- stage1_layer0_expert63_act -->
<g id="node260" class="node">
<title>stage1_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4698.19,-26992.84 4417.19,-26992.84 4417.19,-26940.84 4698.19,-26940.84 4698.19,-26992.84"/>
<text text-anchor="middle" x="4557.69" y="-26980.84" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4557.69" y="-26969.84" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="4557.69" y="-26958.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4557.69" y="-26947.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer0_expert63_tp1&#45;&gt;stage1_layer0_expert63_act -->
<g id="edge328" class="edge">
<title>stage1_layer0_expert63_tp1&#45;&gt;stage1_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4549.53,-27028.57C4550.65,-27020.26 4551.83,-27011.43 4552.94,-27003.15"/>
<polygon fill="black" stroke="black" points="4556.44,-27003.41 4554.3,-26993.03 4549.5,-27002.48 4556.44,-27003.41"/>
</g>
<!-- stage1_layer0_expert63_mlp2 -->
<g id="node261" class="node">
<title>stage1_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4771.69,-26904.84 4449.69,-26904.84 4449.69,-26852.84 4771.69,-26852.84 4771.69,-26904.84"/>
<text text-anchor="middle" x="4610.69" y="-26892.84" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4610.69" y="-26881.84" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4610.69" y="-26870.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4610.69" y="-26859.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert63_act&#45;&gt;stage1_layer0_expert63_mlp2 -->
<g id="edge329" class="edge">
<title>stage1_layer0_expert63_act&#45;&gt;stage1_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4573.3,-26940.5C4578.48,-26932.1 4584.33,-26922.62 4589.83,-26913.68"/>
<polygon fill="black" stroke="black" points="4592.92,-26915.34 4595.18,-26905 4586.96,-26911.67 4592.92,-26915.34"/>
</g>
<!-- stage1_layer0_expert63_tp2 -->
<g id="node262" class="node">
<title>stage1_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4637.69" cy="-26780.07" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4637.69" y="-26794.07" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4637.69" y="-26783.07" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="4637.69" y="-26772.07" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4637.69" y="-26761.07" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_expert63_mlp2&#45;&gt;stage1_layer0_expert63_tp2 -->
<g id="edge330" class="edge">
<title>stage1_layer0_expert63_mlp2&#45;&gt;stage1_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4617.71,-26852.67C4619.91,-26844.77 4622.42,-26835.8 4624.89,-26826.94"/>
<polygon fill="black" stroke="black" points="4628.33,-26827.62 4627.65,-26817.05 4621.59,-26825.74 4628.33,-26827.62"/>
</g>
<!-- stage1_layer0_expert63_tp2&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge341" class="edge">
<title>stage1_layer0_expert63_tp2&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4480.18,-26753.45C4454.01,-26749.7 4427.12,-26746.15 4401.69,-26743.3 4094.5,-26708.92 3748.56,-26683.54 3475.16,-26666.58"/>
<polygon fill="black" stroke="black" points="3475.26,-26663.08 3465.06,-26665.95 3474.82,-26670.06 3475.26,-26663.08"/>
</g>
<!-- stage1_layer0_expert_ellipsis&#45;&gt;stage1_layer0_expert_agg -->
<g id="edge342" class="edge">
<title>stage1_layer0_expert_ellipsis&#45;&gt;stage1_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4761.45,-27138.28C4814.78,-27106.41 4893.69,-27046.05 4893.69,-26967.84 4893.69,-26967.84 4893.69,-26967.84 4893.69,-26877.84 4893.69,-26817.45 4919.18,-26784.13 4874.69,-26743.3 4822.79,-26695.68 3993.39,-26665.68 3450.12,-26651.03"/>
<polygon fill="black" stroke="black" points="3449.83,-26647.52 3439.74,-26650.75 3449.64,-26654.52 3449.83,-26647.52"/>
</g>
<!-- stage1_layer0_expert_agg&#45;&gt;stage1_layer0_output -->
<g id="edge343" class="edge">
<title>stage1_layer0_expert_agg&#45;&gt;stage1_layer0_output</title>
<path fill="none" stroke="black" d="M3328.08,-26583.42C3426.95,-26567.72 3531.94,-26551.04 3620.83,-26536.91"/>
<polygon fill="black" stroke="black" points="3621.43,-26540.36 3630.76,-26535.33 3620.34,-26533.45 3621.43,-26540.36"/>
</g>
<!-- stage1_layer1_ln -->
<g id="node266" class="node">
<title>stage1_layer1_ln</title>
<polygon fill="none" stroke="black" points="4063.69,-26431.3 3613.69,-26431.3 3613.69,-26363.3 4063.69,-26363.3 4063.69,-26431.3"/>
<text text-anchor="middle" x="3838.69" y="-26416.1" font-family="Times,serif" font-size="14.00">Layer 3 LayerNorm</text>
<text text-anchor="middle" x="3838.69" y="-26401.1" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-26386.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-26371.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer0_output&#45;&gt;stage1_layer1_ln -->
<g id="edge345" class="edge">
<title>stage1_layer0_output&#45;&gt;stage1_layer1_ln</title>
<path fill="none" stroke="black" d="M3838.69,-26467.18C3838.69,-26459.08 3838.69,-26450.28 3838.69,-26441.77"/>
<polygon fill="black" stroke="black" points="3842.19,-26441.6 3838.69,-26431.6 3835.19,-26441.6 3842.19,-26441.6"/>
</g>
<!-- stage1_layer1_attn_qkv -->
<g id="node267" class="node">
<title>stage1_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4070.19,-26327.3 3607.19,-26327.3 3607.19,-26259.3 4070.19,-26259.3 4070.19,-26327.3"/>
<text text-anchor="middle" x="3838.69" y="-26312.1" font-family="Times,serif" font-size="14.00">Layer 3 Attention QKV Projection</text>
<text text-anchor="middle" x="3838.69" y="-26297.1" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP: GPU 128&#45;255)</text>
<text text-anchor="middle" x="3838.69" y="-26282.1" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-26267.1" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage1_layer1_ln&#45;&gt;stage1_layer1_attn_qkv -->
<g id="edge346" class="edge">
<title>stage1_layer1_ln&#45;&gt;stage1_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3838.69,-26363.18C3838.69,-26355.08 3838.69,-26346.28 3838.69,-26337.77"/>
<polygon fill="black" stroke="black" points="3842.19,-26337.6 3838.69,-26327.6 3835.19,-26337.6 3842.19,-26337.6"/>
</g>
<!-- stage1_layer1_tp_qkv_comm -->
<g id="node268" class="node">
<title>stage1_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-26175.22" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3838.69" y="-26194.02" font-family="Times,serif" font-size="14.00">Layer 3 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3838.69" y="-26179.02" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP pairs)</text>
<text text-anchor="middle" x="3838.69" y="-26164.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-26149.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage1_layer1_attn_qkv&#45;&gt;stage1_layer1_tp_qkv_comm -->
<g id="edge347" class="edge">
<title>stage1_layer1_attn_qkv&#45;&gt;stage1_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3838.69,-26259.03C3838.69,-26251.04 3838.69,-26242.28 3838.69,-26233.53"/>
<polygon fill="black" stroke="black" points="3842.19,-26233.33 3838.69,-26223.33 3835.19,-26233.33 3842.19,-26233.33"/>
</g>
<!-- stage1_layer1_attn_head0 -->
<g id="node269" class="node">
<title>stage1_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1647.19,-26091.13 1374.19,-26091.13 1374.19,-26039.13 1647.19,-26039.13 1647.19,-26091.13"/>
<text text-anchor="middle" x="1510.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 0 Attention</text>
<text text-anchor="middle" x="1510.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 0)</text>
<text text-anchor="middle" x="1510.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1510.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head0 -->
<g id="edge348" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3515.67,-26167.19C3003.05,-26155.16 2024.56,-26128.36 1657.38,-26091.24"/>
<polygon fill="black" stroke="black" points="1657.54,-26087.74 1647.23,-26090.19 1656.82,-26094.7 1657.54,-26087.74"/>
</g>
<!-- stage1_layer1_attn_head1 -->
<g id="node270" class="node">
<title>stage1_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1938.19,-26091.13 1665.19,-26091.13 1665.19,-26039.13 1938.19,-26039.13 1938.19,-26091.13"/>
<text text-anchor="middle" x="1801.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 1 Attention</text>
<text text-anchor="middle" x="1801.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 1)</text>
<text text-anchor="middle" x="1801.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1801.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head1 -->
<g id="edge349" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3511.73,-26172.42C3136.12,-26167.48 2501.43,-26150.26 1948.41,-26091.26"/>
<polygon fill="black" stroke="black" points="1948.55,-26087.76 1938.23,-26090.17 1947.8,-26094.72 1948.55,-26087.76"/>
</g>
<!-- stage1_layer1_attn_head2 -->
<g id="node271" class="node">
<title>stage1_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2229.19,-26091.13 1956.19,-26091.13 1956.19,-26039.13 2229.19,-26039.13 2229.19,-26091.13"/>
<text text-anchor="middle" x="2092.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 2 Attention</text>
<text text-anchor="middle" x="2092.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 2)</text>
<text text-anchor="middle" x="2092.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2092.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head2 -->
<g id="edge350" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3514.26,-26168.68C3192.63,-26160.55 2685.92,-26140.66 2239.44,-26091.28"/>
<polygon fill="black" stroke="black" points="2239.56,-26087.77 2229.24,-26090.14 2238.79,-26094.73 2239.56,-26087.77"/>
</g>
<!-- stage1_layer1_attn_head3 -->
<g id="node272" class="node">
<title>stage1_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2520.19,-26091.13 2247.19,-26091.13 2247.19,-26039.13 2520.19,-26039.13 2520.19,-26091.13"/>
<text text-anchor="middle" x="2383.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 3 Attention</text>
<text text-anchor="middle" x="2383.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 3)</text>
<text text-anchor="middle" x="2383.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2383.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head3 -->
<g id="edge351" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3520.84,-26163.61C3257.62,-26152.57 2873.78,-26131.24 2530.39,-26091.28"/>
<polygon fill="black" stroke="black" points="2530.58,-26087.78 2520.24,-26090.1 2529.77,-26094.74 2530.58,-26087.78"/>
</g>
<!-- stage1_layer1_attn_head4 -->
<g id="node273" class="node">
<title>stage1_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2811.19,-26091.13 2538.19,-26091.13 2538.19,-26039.13 2811.19,-26039.13 2811.19,-26091.13"/>
<text text-anchor="middle" x="2674.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 4 Attention</text>
<text text-anchor="middle" x="2674.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 4)</text>
<text text-anchor="middle" x="2674.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2674.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head4 -->
<g id="edge352" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3536.43,-26156.68C3336.07,-26143.33 3067.29,-26122.15 2821.46,-26091.32"/>
<polygon fill="black" stroke="black" points="2821.61,-26087.81 2811.25,-26090.03 2820.73,-26094.75 2821.61,-26087.81"/>
</g>
<!-- stage1_layer1_attn_head5 -->
<g id="node274" class="node">
<title>stage1_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3102.19,-26091.13 2829.19,-26091.13 2829.19,-26039.13 3102.19,-26039.13 3102.19,-26091.13"/>
<text text-anchor="middle" x="2965.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 5 Attention</text>
<text text-anchor="middle" x="2965.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 5)</text>
<text text-anchor="middle" x="2965.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2965.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head5 -->
<g id="edge353" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3571.12,-26147.38C3436.28,-26132.93 3270.06,-26113.74 3112.62,-26091.38"/>
<polygon fill="black" stroke="black" points="3112.66,-26087.85 3102.27,-26089.9 3111.67,-26094.78 3112.66,-26087.85"/>
</g>
<!-- stage1_layer1_attn_head6 -->
<g id="node275" class="node">
<title>stage1_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3393.19,-26091.13 3120.19,-26091.13 3120.19,-26039.13 3393.19,-26039.13 3393.19,-26091.13"/>
<text text-anchor="middle" x="3256.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 6 Attention</text>
<text text-anchor="middle" x="3256.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 6)</text>
<text text-anchor="middle" x="3256.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3256.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head6 -->
<g id="edge354" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3638.8,-26137.1C3560.89,-26122.63 3473.29,-26106.36 3401.64,-26093.05"/>
<polygon fill="black" stroke="black" points="3402.1,-26089.58 3391.63,-26091.19 3400.83,-26096.46 3402.1,-26089.58"/>
</g>
<!-- stage1_layer1_attn_head7 -->
<g id="node276" class="node">
<title>stage1_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3684.19,-26091.13 3411.19,-26091.13 3411.19,-26039.13 3684.19,-26039.13 3684.19,-26091.13"/>
<text text-anchor="middle" x="3547.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 7 Attention</text>
<text text-anchor="middle" x="3547.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 7)</text>
<text text-anchor="middle" x="3547.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3547.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head7 -->
<g id="edge355" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3720.33,-26130.25C3688.09,-26118.28 3654.02,-26105.63 3624.74,-26094.75"/>
<polygon fill="black" stroke="black" points="3625.59,-26091.33 3615,-26091.13 3623.15,-26097.9 3625.59,-26091.33"/>
</g>
<!-- stage1_layer1_attn_ellipsis -->
<g id="node277" class="node">
<title>stage1_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3975.19,-26091.13 3702.19,-26091.13 3702.19,-26039.13 3975.19,-26039.13 3975.19,-26091.13"/>
<text text-anchor="middle" x="3838.69" y="-26079.13" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3838.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_ellipsis -->
<g id="edge356" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3838.69,-26127.12C3838.69,-26118.58 3838.69,-26109.8 3838.69,-26101.66"/>
<polygon fill="black" stroke="black" points="3842.19,-26101.4 3838.69,-26091.4 3835.19,-26101.4 3842.19,-26101.4"/>
</g>
<!-- stage1_layer1_attn_head24 -->
<g id="node278" class="node">
<title>stage1_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4266.19,-26091.13 3993.19,-26091.13 3993.19,-26039.13 4266.19,-26039.13 4266.19,-26091.13"/>
<text text-anchor="middle" x="4129.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 24 Attention</text>
<text text-anchor="middle" x="4129.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 24)</text>
<text text-anchor="middle" x="4129.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4129.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head24 -->
<g id="edge357" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3957.05,-26130.25C3989.28,-26118.28 4023.36,-26105.63 4052.64,-26094.75"/>
<polygon fill="black" stroke="black" points="4054.22,-26097.9 4062.38,-26091.13 4051.79,-26091.33 4054.22,-26097.9"/>
</g>
<!-- stage1_layer1_attn_head25 -->
<g id="node279" class="node">
<title>stage1_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4557.19,-26091.13 4284.19,-26091.13 4284.19,-26039.13 4557.19,-26039.13 4557.19,-26091.13"/>
<text text-anchor="middle" x="4420.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 25 Attention</text>
<text text-anchor="middle" x="4420.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 25)</text>
<text text-anchor="middle" x="4420.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4420.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head25 -->
<g id="edge358" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M4038.57,-26137.1C4116.48,-26122.63 4204.09,-26106.36 4275.74,-26093.05"/>
<polygon fill="black" stroke="black" points="4276.55,-26096.46 4285.74,-26091.19 4275.27,-26089.58 4276.55,-26096.46"/>
</g>
<!-- stage1_layer1_attn_head26 -->
<g id="node280" class="node">
<title>stage1_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4848.19,-26091.13 4575.19,-26091.13 4575.19,-26039.13 4848.19,-26039.13 4848.19,-26091.13"/>
<text text-anchor="middle" x="4711.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 26 Attention</text>
<text text-anchor="middle" x="4711.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 26)</text>
<text text-anchor="middle" x="4711.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4711.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head26 -->
<g id="edge359" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4105.45,-26147.33C4240.31,-26132.85 4406.69,-26113.62 4565.01,-26091.2"/>
<polygon fill="black" stroke="black" points="4565.54,-26094.66 4574.95,-26089.79 4564.55,-26087.73 4565.54,-26094.66"/>
</g>
<!-- stage1_layer1_attn_head27 -->
<g id="node281" class="node">
<title>stage1_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5139.19,-26091.13 4866.19,-26091.13 4866.19,-26039.13 5139.19,-26039.13 5139.19,-26091.13"/>
<text text-anchor="middle" x="5002.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 27 Attention</text>
<text text-anchor="middle" x="5002.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 27)</text>
<text text-anchor="middle" x="5002.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5002.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head27 -->
<g id="edge360" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4140.64,-26156.58C4340.8,-26143.19 4609.31,-26121.99 4855.73,-26091.21"/>
<polygon fill="black" stroke="black" points="4856.48,-26094.64 4865.96,-26089.92 4855.61,-26087.69 4856.48,-26094.64"/>
</g>
<!-- stage1_layer1_attn_head28 -->
<g id="node282" class="node">
<title>stage1_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5430.19,-26091.13 5157.19,-26091.13 5157.19,-26039.13 5430.19,-26039.13 5430.19,-26091.13"/>
<text text-anchor="middle" x="5293.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 28 Attention</text>
<text text-anchor="middle" x="5293.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 28)</text>
<text text-anchor="middle" x="5293.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5293.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head28 -->
<g id="edge361" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4156.28,-26163.5C4419.3,-26152.39 4802.83,-26131.02 5146.81,-26091.18"/>
<polygon fill="black" stroke="black" points="5147.45,-26094.63 5156.97,-26090 5146.64,-26087.68 5147.45,-26094.63"/>
</g>
<!-- stage1_layer1_attn_head29 -->
<g id="node283" class="node">
<title>stage1_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5721.19,-26091.13 5448.19,-26091.13 5448.19,-26039.13 5721.19,-26039.13 5721.19,-26091.13"/>
<text text-anchor="middle" x="5584.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 29 Attention</text>
<text text-anchor="middle" x="5584.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 29)</text>
<text text-anchor="middle" x="5584.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5584.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head29 -->
<g id="edge362" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4163.28,-26168.55C4484.72,-26160.33 4990.89,-26140.37 5437.77,-26091.17"/>
<polygon fill="black" stroke="black" points="5438.43,-26094.62 5447.98,-26090.04 5437.66,-26087.67 5438.43,-26094.62"/>
</g>
<!-- stage1_layer1_attn_head30 -->
<g id="node284" class="node">
<title>stage1_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="6012.19,-26091.13 5739.19,-26091.13 5739.19,-26039.13 6012.19,-26039.13 6012.19,-26091.13"/>
<text text-anchor="middle" x="5875.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 30 Attention</text>
<text text-anchor="middle" x="5875.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 30)</text>
<text text-anchor="middle" x="5875.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5875.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head30 -->
<g id="edge363" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4165.89,-26172.3C4541.34,-26167.23 5175.41,-26149.9 5728.8,-26091.16"/>
<polygon fill="black" stroke="black" points="5729.41,-26094.62 5738.98,-26090.08 5728.67,-26087.66 5729.41,-26094.62"/>
</g>
<!-- stage1_layer1_attn_head31 -->
<g id="node285" class="node">
<title>stage1_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6303.19,-26091.13 6030.19,-26091.13 6030.19,-26039.13 6303.19,-26039.13 6303.19,-26091.13"/>
<text text-anchor="middle" x="6166.69" y="-26079.13" font-family="Times,serif" font-size="10.00">Layer 3 Head 31 Attention</text>
<text text-anchor="middle" x="6166.69" y="-26068.13" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Head 31)</text>
<text text-anchor="middle" x="6166.69" y="-26057.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6166.69" y="-26046.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head31 -->
<g id="edge364" class="edge">
<title>stage1_layer1_tp_qkv_comm&#45;&gt;stage1_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4161.55,-26167.14C4673.93,-26155.04 5651.97,-26128.15 6019.81,-26091.14"/>
<polygon fill="black" stroke="black" points="6020.39,-26094.6 6029.99,-26090.1 6019.68,-26087.64 6020.39,-26094.6"/>
</g>
<!-- stage1_layer1_attn_agg -->
<g id="node286" class="node">
<title>stage1_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4306.34,-26003.13 3562.41,-26003.13 3371.04,-25867.13 4114.97,-25867.13 4306.34,-26003.13"/>
<text text-anchor="middle" x="3838.69" y="-25953.93" font-family="Times,serif" font-size="14.00">Layer 3 Attention Aggregate</text>
<text text-anchor="middle" x="3838.69" y="-25938.93" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-25923.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-25908.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_attn_head0&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge365" class="edge">
<title>stage1_layer1_attn_head0&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1647.23,-26040.11C1650.07,-26039.76 1652.9,-26039.44 1655.69,-26039.13 2287.18,-25970.06 3026.43,-25947.28 3462.36,-25939.79"/>
<polygon fill="black" stroke="black" points="3462.67,-25943.28 3472.61,-25939.61 3462.55,-25936.28 3462.67,-25943.28"/>
</g>
<!-- stage1_layer1_attn_head1&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge366" class="edge">
<title>stage1_layer1_attn_head1&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1938.24,-26040.13C1941.08,-26039.78 1943.9,-26039.45 1946.69,-26039.13 2472.99,-25979.64 3085.69,-25954.24 3467.91,-25943.58"/>
<polygon fill="black" stroke="black" points="3468.12,-25947.08 3478.02,-25943.3 3467.93,-25940.08 3468.12,-25947.08"/>
</g>
<!-- stage1_layer1_attn_head2&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge367" class="edge">
<title>stage1_layer1_attn_head2&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2229.24,-26040.17C2232.08,-26039.81 2234.9,-26039.46 2237.69,-26039.13 2660.66,-25989.21 3149.57,-25962.18 3474.72,-25948.5"/>
<polygon fill="black" stroke="black" points="3474.93,-25951.99 3484.77,-25948.08 3474.63,-25945 3474.93,-25951.99"/>
</g>
<!-- stage1_layer1_attn_head3&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge368" class="edge">
<title>stage1_layer1_attn_head3&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2520.25,-26040.23C2523.08,-26039.85 2525.9,-26039.48 2528.69,-26039.13 2850.79,-25998.79 3219.56,-25971.47 3483.59,-25955.17"/>
<polygon fill="black" stroke="black" points="3483.96,-25958.65 3493.72,-25954.54 3483.53,-25951.66 3483.96,-25958.65"/>
</g>
<!-- stage1_layer1_attn_head4&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge369" class="edge">
<title>stage1_layer1_attn_head4&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2811.26,-26040.31C2814.09,-26039.91 2816.9,-26039.51 2819.69,-26039.13 3044.59,-26008.42 3298.58,-25982.72 3496.72,-25964.68"/>
<polygon fill="black" stroke="black" points="3497.07,-25968.16 3506.71,-25963.77 3496.43,-25961.19 3497.07,-25968.16"/>
</g>
<!-- stage1_layer1_attn_head5&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge370" class="edge">
<title>stage1_layer1_attn_head5&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3102.28,-26040.46C3105.11,-26040.01 3107.91,-26039.57 3110.69,-26039.13 3243.44,-26018.3 3390.12,-25997.19 3516.83,-25979.54"/>
<polygon fill="black" stroke="black" points="3517.65,-25982.96 3527.08,-25978.12 3516.69,-25976.03 3517.65,-25982.96"/>
</g>
<!-- stage1_layer1_attn_head6&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge371" class="edge">
<title>stage1_layer1_attn_head6&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3370.63,-26039.07C3421.21,-26027.95 3483.29,-26014.3 3545.5,-26000.61"/>
<polygon fill="black" stroke="black" points="3546.47,-26003.98 3555.49,-25998.42 3544.97,-25997.15 3546.47,-26003.98"/>
</g>
<!-- stage1_layer1_attn_head7&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge372" class="edge">
<title>stage1_layer1_attn_head7&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3604.83,-26039C3626.01,-26029.68 3651.2,-26018.6 3677.08,-26007.22"/>
<polygon fill="black" stroke="black" points="3678.51,-26010.41 3686.25,-26003.18 3675.69,-26004.01 3678.51,-26010.41"/>
</g>
<!-- stage1_layer1_attn_ellipsis&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge373" class="edge">
<title>stage1_layer1_attn_ellipsis&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3838.69,-26038.84C3838.69,-26031.25 3838.69,-26022.48 3838.69,-26013.34"/>
<polygon fill="black" stroke="black" points="3842.19,-26013.32 3838.69,-26003.32 3835.19,-26013.32 3842.19,-26013.32"/>
</g>
<!-- stage1_layer1_attn_head24&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge374" class="edge">
<title>stage1_layer1_attn_head24&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4072.54,-26039C4051.37,-26029.68 4026.18,-26018.6 4000.3,-26007.22"/>
<polygon fill="black" stroke="black" points="4001.69,-26004.01 3991.12,-26003.18 3998.87,-26010.41 4001.69,-26004.01"/>
</g>
<!-- stage1_layer1_attn_head25&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge375" class="edge">
<title>stage1_layer1_attn_head25&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4306.74,-26039.07C4262.03,-26029.24 4208.31,-26017.42 4153.45,-26005.36"/>
<polygon fill="black" stroke="black" points="4154.08,-26001.91 4143.56,-26003.18 4152.58,-26008.75 4154.08,-26001.91"/>
</g>
<!-- stage1_layer1_attn_head26&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge376" class="edge">
<title>stage1_layer1_attn_head26&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4574.93,-26040.59C4571.82,-26040.1 4568.74,-26039.61 4565.69,-26039.13 4483.61,-26026.29 4396.21,-26013.32 4311.51,-26001.1"/>
<polygon fill="black" stroke="black" points="4311.86,-25997.62 4301.46,-25999.66 4310.86,-26004.55 4311.86,-25997.62"/>
</g>
<!-- stage1_layer1_attn_head27&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge377" class="edge">
<title>stage1_layer1_attn_head27&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4865.95,-26040.43C4862.84,-26039.98 4859.75,-26039.55 4856.69,-26039.13 4666.01,-26013.19 4454.43,-25990.76 4273.77,-25973.52"/>
<polygon fill="black" stroke="black" points="4273.84,-25970.01 4263.56,-25972.55 4273.18,-25976.98 4273.84,-25970.01"/>
</g>
<!-- stage1_layer1_attn_head28&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge378" class="edge">
<title>stage1_layer1_attn_head28&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5156.97,-26040.33C5153.85,-26039.92 5150.75,-26039.51 5147.69,-26039.13 4849.68,-26001.97 4511.74,-25975.78 4253.88,-25959.11"/>
<polygon fill="black" stroke="black" points="4253.79,-25955.6 4243.59,-25958.45 4253.34,-25962.58 4253.79,-25955.6"/>
</g>
<!-- stage1_layer1_attn_head29&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge379" class="edge">
<title>stage1_layer1_attn_head29&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5447.97,-26040.27C5444.85,-26039.87 5441.75,-26039.49 5438.69,-26039.13 5032.71,-25991.44 4565.99,-25964.57 4241.82,-25950.33"/>
<polygon fill="black" stroke="black" points="4241.94,-25946.83 4231.79,-25949.89 4241.63,-25953.82 4241.94,-25946.83"/>
</g>
<!-- stage1_layer1_attn_head30&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge380" class="edge">
<title>stage1_layer1_attn_head30&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5738.98,-26040.23C5735.85,-26039.85 5732.75,-26039.48 5729.69,-26039.13 5214.76,-25981.22 4617.15,-25955.57 4233.82,-25944.42"/>
<polygon fill="black" stroke="black" points="4233.77,-25940.91 4223.67,-25944.12 4233.57,-25947.91 4233.77,-25940.91"/>
</g>
<!-- stage1_layer1_attn_head31&#45;&gt;stage1_layer1_attn_agg -->
<g id="edge381" class="edge">
<title>stage1_layer1_attn_head31&#45;&gt;stage1_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M6029.98,-26040.2C6026.86,-26039.82 6023.76,-26039.47 6020.69,-26039.13 5395.76,-25971.14 4665.31,-25948.01 4227.99,-25940.16"/>
<polygon fill="black" stroke="black" points="4227.77,-25936.65 4217.71,-25939.98 4227.65,-25943.65 4227.77,-25936.65"/>
</g>
<!-- stage1_layer1_attn_out -->
<g id="node287" class="node">
<title>stage1_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="4063.69,-25831.13 3613.69,-25831.13 3613.69,-25763.13 4063.69,-25763.13 4063.69,-25831.13"/>
<text text-anchor="middle" x="3838.69" y="-25815.93" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Proj</text>
<text text-anchor="middle" x="3838.69" y="-25800.93" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP: GPU 128&#45;255)</text>
<text text-anchor="middle" x="3838.69" y="-25785.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-25770.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_attn_agg&#45;&gt;stage1_layer1_attn_out -->
<g id="edge382" class="edge">
<title>stage1_layer1_attn_agg&#45;&gt;stage1_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3838.69,-25866.93C3838.69,-25858.18 3838.69,-25849.41 3838.69,-25841.2"/>
<polygon fill="black" stroke="black" points="3842.19,-25841.15 3838.69,-25831.15 3835.19,-25841.15 3842.19,-25841.15"/>
</g>
<!-- stage1_layer1_tp_attn_comm -->
<g id="node288" class="node">
<title>stage1_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-25679.05" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3838.69" y="-25697.85" font-family="Times,serif" font-size="14.00">Layer 3 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3838.69" y="-25682.85" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1 (TP pairs)</text>
<text text-anchor="middle" x="3838.69" y="-25667.85" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-25652.85" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_attn_out&#45;&gt;stage1_layer1_tp_attn_comm -->
<g id="edge383" class="edge">
<title>stage1_layer1_attn_out&#45;&gt;stage1_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3838.69,-25762.87C3838.69,-25754.87 3838.69,-25746.11 3838.69,-25737.37"/>
<polygon fill="black" stroke="black" points="3842.19,-25737.16 3838.69,-25727.16 3835.19,-25737.16 3842.19,-25737.16"/>
</g>
<!-- stage1_layer1_expert_router -->
<g id="node289" class="node">
<title>stage1_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4292.88,-25594.97 3570.36,-25594.97 3384.49,-25458.97 4107.02,-25458.97 4292.88,-25594.97"/>
<text text-anchor="middle" x="3838.69" y="-25545.77" font-family="Times,serif" font-size="14.00">Layer 3 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3838.69" y="-25530.77" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-25515.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-25500.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage1_layer1_tp_attn_comm&#45;&gt;stage1_layer1_expert_router -->
<g id="edge384" class="edge">
<title>stage1_layer1_tp_attn_comm&#45;&gt;stage1_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3838.69,-25630.56C3838.69,-25622.48 3838.69,-25613.89 3838.69,-25605.27"/>
<polygon fill="black" stroke="black" points="3842.19,-25605.16 3838.69,-25595.16 3835.19,-25605.16 3842.19,-25605.16"/>
</g>
<!-- stage1_layer1_expert0 -->
<g id="node290" class="node">
<title>stage1_layer1_expert0</title>
<polygon fill="none" stroke="black" points="1984.69,-25422.97 1662.69,-25422.97 1662.69,-25370.97 1984.69,-25370.97 1984.69,-25422.97"/>
<text text-anchor="middle" x="1823.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 0</text>
<text text-anchor="middle" x="1823.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP pair)</text>
<text text-anchor="middle" x="1823.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1823.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert0 -->
<g id="edge385" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3446.97,-25504.74C3100.48,-25485.39 2581.29,-25455.02 2129.69,-25422.97 2086.03,-25419.87 2038.91,-25416.19 1995.02,-25412.61"/>
<polygon fill="black" stroke="black" points="1995.08,-25409.11 1984.83,-25411.78 1994.51,-25416.08 1995.08,-25409.11"/>
</g>
<!-- stage1_layer1_expert1 -->
<g id="node296" class="node">
<title>stage1_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2460.69,-25422.97 2138.69,-25422.97 2138.69,-25370.97 2460.69,-25370.97 2460.69,-25422.97"/>
<text text-anchor="middle" x="2299.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 1</text>
<text text-anchor="middle" x="2299.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP pair)</text>
<text text-anchor="middle" x="2299.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2299.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert1 -->
<g id="edge391" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3435.91,-25496.76C3178.79,-25477.45 2838.47,-25450.67 2537.69,-25422.97 2516.07,-25420.98 2493.35,-25418.76 2470.89,-25416.48"/>
<polygon fill="black" stroke="black" points="2471.25,-25413 2460.94,-25415.47 2470.54,-25419.96 2471.25,-25413"/>
</g>
<!-- stage1_layer1_expert2 -->
<g id="node302" class="node">
<title>stage1_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2868.69,-25422.97 2546.69,-25422.97 2546.69,-25370.97 2868.69,-25370.97 2868.69,-25422.97"/>
<text text-anchor="middle" x="2707.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 2</text>
<text text-anchor="middle" x="2707.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP pair)</text>
<text text-anchor="middle" x="2707.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2707.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert2 -->
<g id="edge397" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3412.96,-25479.8C3255.15,-25462.4 3074.71,-25442.17 2910.69,-25422.97 2900.4,-25421.76 2889.82,-25420.51 2879.15,-25419.23"/>
<polygon fill="black" stroke="black" points="2879.24,-25415.72 2868.89,-25418 2878.4,-25422.67 2879.24,-25415.72"/>
</g>
<!-- stage1_layer1_expert3 -->
<g id="node308" class="node">
<title>stage1_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3241.69,-25422.97 2919.69,-25422.97 2919.69,-25370.97 3241.69,-25370.97 3241.69,-25422.97"/>
<text text-anchor="middle" x="3080.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 3</text>
<text text-anchor="middle" x="3080.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP pair)</text>
<text text-anchor="middle" x="3080.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3080.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert3 -->
<g id="edge403" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3441.65,-25458.92C3369.76,-25446.78 3298.73,-25434.79 3238.95,-25424.69"/>
<polygon fill="black" stroke="black" points="3239.51,-25421.24 3229.07,-25423.02 3238.35,-25428.14 3239.51,-25421.24"/>
</g>
<!-- stage1_layer1_expert31 -->
<g id="node314" class="node">
<title>stage1_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3640.69,-25422.97 3318.69,-25422.97 3318.69,-25370.97 3640.69,-25370.97 3640.69,-25422.97"/>
<text text-anchor="middle" x="3479.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 31</text>
<text text-anchor="middle" x="3479.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP pair)</text>
<text text-anchor="middle" x="3479.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3479.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert31 -->
<g id="edge409" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3650.51,-25458.87C3618.38,-25447.42 3586.61,-25436.09 3559.35,-25426.37"/>
<polygon fill="black" stroke="black" points="3560.5,-25423.06 3549.9,-25423 3558.15,-25429.66 3560.5,-25423.06"/>
</g>
<!-- stage1_layer1_expert32 -->
<g id="node320" class="node">
<title>stage1_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3999.69,-25422.97 3677.69,-25422.97 3677.69,-25370.97 3999.69,-25370.97 3999.69,-25422.97"/>
<text text-anchor="middle" x="3838.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 32</text>
<text text-anchor="middle" x="3838.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP pair)</text>
<text text-anchor="middle" x="3838.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert32 -->
<g id="edge415" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3838.69,-25458.59C3838.69,-25449.9 3838.69,-25441.29 3838.69,-25433.4"/>
<polygon fill="black" stroke="black" points="3842.19,-25433.16 3838.69,-25423.16 3835.19,-25433.16 3842.19,-25433.16"/>
</g>
<!-- stage1_layer1_expert60 -->
<g id="node326" class="node">
<title>stage1_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4383.69,-25422.97 4061.69,-25422.97 4061.69,-25370.97 4383.69,-25370.97 4383.69,-25422.97"/>
<text text-anchor="middle" x="4222.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 60</text>
<text text-anchor="middle" x="4222.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP pair)</text>
<text text-anchor="middle" x="4222.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4222.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert60 -->
<g id="edge421" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4039.97,-25458.87C4074.49,-25447.37 4108.62,-25435.99 4137.86,-25426.24"/>
<polygon fill="black" stroke="black" points="4139.21,-25429.48 4147.59,-25423 4136.99,-25422.84 4139.21,-25429.48"/>
</g>
<!-- stage1_layer1_expert61 -->
<g id="node332" class="node">
<title>stage1_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4790.69,-25422.97 4468.69,-25422.97 4468.69,-25370.97 4790.69,-25370.97 4790.69,-25422.97"/>
<text text-anchor="middle" x="4629.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 61</text>
<text text-anchor="middle" x="4629.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP pair)</text>
<text text-anchor="middle" x="4629.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4629.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert61 -->
<g id="edge427" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4133.51,-25478.26C4245.58,-25460.12 4369.21,-25440.12 4465.03,-25424.61"/>
<polygon fill="black" stroke="black" points="4465.79,-25428.03 4475.1,-25422.98 4464.67,-25421.12 4465.79,-25428.03"/>
</g>
<!-- stage1_layer1_expert62 -->
<g id="node338" class="node">
<title>stage1_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5187.69,-25422.97 4865.69,-25422.97 4865.69,-25370.97 5187.69,-25370.97 5187.69,-25422.97"/>
<text text-anchor="middle" x="5026.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 62</text>
<text text-anchor="middle" x="5026.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP pair)</text>
<text text-anchor="middle" x="5026.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5026.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert62 -->
<g id="edge433" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4153.04,-25492.51C4340.75,-25472.47 4583.87,-25446.42 4799.69,-25422.97 4817.73,-25421.01 4836.58,-25418.95 4855.37,-25416.89"/>
<polygon fill="black" stroke="black" points="4855.93,-25420.35 4865.48,-25415.78 4855.16,-25413.39 4855.93,-25420.35"/>
</g>
<!-- stage1_layer1_expert63 -->
<g id="node344" class="node">
<title>stage1_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5556.69,-25422.97 5234.69,-25422.97 5234.69,-25370.97 5556.69,-25370.97 5556.69,-25422.97"/>
<text text-anchor="middle" x="5395.69" y="-25410.97" font-family="Times,serif" font-size="10.00">Layer 3 Expert 63</text>
<text text-anchor="middle" x="5395.69" y="-25399.97" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP pair)</text>
<text text-anchor="middle" x="5395.69" y="-25388.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5395.69" y="-25377.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert63 -->
<g id="edge439" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4170.46,-25505.38C4445.66,-25487.21 4847.05,-25458.17 5196.69,-25422.97 5205.72,-25422.06 5214.98,-25421.07 5224.32,-25420.04"/>
<polygon fill="black" stroke="black" points="5224.93,-25423.49 5234.48,-25418.9 5224.15,-25416.54 5224.93,-25423.49"/>
</g>
<!-- stage1_layer1_expert_ellipsis -->
<g id="node350" class="node">
<title>stage1_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6132.69,-25334.97 5810.69,-25334.97 5810.69,-25282.97 6132.69,-25282.97 6132.69,-25334.97"/>
<text text-anchor="middle" x="5971.69" y="-25322.97" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5971.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: Pipeline 1 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5971.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5971.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert_ellipsis -->
<g id="edge445" class="edge">
<title>stage1_layer1_expert_router&#45;&gt;stage1_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4182.47,-25514.09C4608.31,-25497.88 5308.97,-25465.85 5565.69,-25422.97 5680.28,-25403.82 5808.93,-25364.95 5890.1,-25338.19"/>
<polygon fill="black" stroke="black" points="5891.37,-25341.46 5899.76,-25334.99 5889.17,-25334.81 5891.37,-25341.46"/>
</g>
<!-- stage1_layer1_expert0_mlp1 -->
<g id="node291" class="node">
<title>stage1_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1891.69,-25334.97 1577.69,-25334.97 1577.69,-25282.97 1891.69,-25282.97 1891.69,-25334.97"/>
<text text-anchor="middle" x="1734.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1734.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1734.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1734.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert0&#45;&gt;stage1_layer1_expert0_mlp1 -->
<g id="edge386" class="edge">
<title>stage1_layer1_expert0&#45;&gt;stage1_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1797.47,-25370.63C1788.23,-25361.71 1777.73,-25351.55 1767.99,-25342.14"/>
<polygon fill="black" stroke="black" points="1770.35,-25339.56 1760.72,-25335.12 1765.48,-25344.59 1770.35,-25339.56"/>
</g>
<!-- stage1_layer1_expert0_tp1 -->
<g id="node292" class="node">
<title>stage1_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1693.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1693.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1693.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="1693.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1693.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert0_mlp1&#45;&gt;stage1_layer1_expert0_tp1 -->
<g id="edge387" class="edge">
<title>stage1_layer1_expert0_mlp1&#45;&gt;stage1_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1724.02,-25282.79C1720.61,-25274.73 1716.71,-25265.54 1712.88,-25256.49"/>
<polygon fill="black" stroke="black" points="1716.06,-25255.02 1708.93,-25247.17 1709.61,-25257.75 1716.06,-25255.02"/>
</g>
<!-- stage1_layer1_expert0_act -->
<g id="node293" class="node">
<title>stage1_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1689.19,-25137.43 1408.19,-25137.43 1408.19,-25085.43 1689.19,-25085.43 1689.19,-25137.43"/>
<text text-anchor="middle" x="1548.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1548.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="1548.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1548.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert0_tp1&#45;&gt;stage1_layer1_expert0_act -->
<g id="edge388" class="edge">
<title>stage1_layer1_expert0_tp1&#45;&gt;stage1_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1641.75,-25174.53C1626.4,-25164.29 1609.7,-25153.15 1594.75,-25143.17"/>
<polygon fill="black" stroke="black" points="1596.43,-25140.08 1586.17,-25137.44 1592.54,-25145.9 1596.43,-25140.08"/>
</g>
<!-- stage1_layer1_expert0_mlp2 -->
<g id="node294" class="node">
<title>stage1_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1706.69,-25049.43 1384.69,-25049.43 1384.69,-24997.43 1706.69,-24997.43 1706.69,-25049.43"/>
<text text-anchor="middle" x="1545.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1545.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1545.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1545.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert0_act&#45;&gt;stage1_layer1_expert0_mlp2 -->
<g id="edge389" class="edge">
<title>stage1_layer1_expert0_act&#45;&gt;stage1_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1547.8,-25085.09C1547.53,-25077.13 1547.22,-25068.19 1546.92,-25059.67"/>
<polygon fill="black" stroke="black" points="1550.41,-25059.46 1546.57,-25049.58 1543.42,-25059.7 1550.41,-25059.46"/>
</g>
<!-- stage1_layer1_expert0_tp2 -->
<g id="node295" class="node">
<title>stage1_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1473.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1473.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1473.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 128&#45;129</text>
<text text-anchor="middle" x="1473.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1473.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert0_mlp2&#45;&gt;stage1_layer1_expert0_tp2 -->
<g id="edge390" class="edge">
<title>stage1_layer1_expert0_mlp2&#45;&gt;stage1_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1526.96,-24997.26C1520.64,-24988.77 1513.4,-24979.03 1506.33,-24969.52"/>
<polygon fill="black" stroke="black" points="1508.96,-24967.2 1500.18,-24961.27 1503.35,-24971.38 1508.96,-24967.2"/>
</g>
<!-- stage1_layer1_expert_agg -->
<g id="node351" class="node">
<title>stage1_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4389.22,-24851.89 3513.45,-24851.89 3288.16,-24715.89 4163.93,-24715.89 4389.22,-24851.89"/>
<text text-anchor="middle" x="3838.69" y="-24802.69" font-family="Times,serif" font-size="14.00">Layer 3 Expert Aggregation</text>
<text text-anchor="middle" x="3838.69" y="-24787.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-24772.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24757.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert0_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge446" class="edge">
<title>stage1_layer1_expert0_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1629.23,-24897.78C1656.01,-24893.99 1683.61,-24890.49 1709.69,-24887.89 2294.93,-24829.53 2974.1,-24803.94 3404.99,-24792.91"/>
<polygon fill="black" stroke="black" points="3405.22,-24796.41 3415.12,-24792.66 3405.04,-24789.41 3405.22,-24796.41"/>
</g>
<!-- stage1_layer1_expert1_mlp1 -->
<g id="node297" class="node">
<title>stage1_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2351.69,-25334.97 2037.69,-25334.97 2037.69,-25282.97 2351.69,-25282.97 2351.69,-25334.97"/>
<text text-anchor="middle" x="2194.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2194.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2194.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2194.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert1&#45;&gt;stage1_layer1_expert1_mlp1 -->
<g id="edge392" class="edge">
<title>stage1_layer1_expert1&#45;&gt;stage1_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2269.04,-25370.86C2257.92,-25361.76 2245.22,-25351.35 2233.49,-25341.75"/>
<polygon fill="black" stroke="black" points="2235.51,-25338.88 2225.56,-25335.25 2231.08,-25344.3 2235.51,-25338.88"/>
</g>
<!-- stage1_layer1_expert1_tp1 -->
<g id="node298" class="node">
<title>stage1_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2144.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2144.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2144.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="2144.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2144.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert1_mlp1&#45;&gt;stage1_layer1_expert1_tp1 -->
<g id="edge393" class="edge">
<title>stage1_layer1_expert1_mlp1&#45;&gt;stage1_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2181.68,-25282.79C2177.47,-25274.65 2172.67,-25265.35 2167.95,-25256.21"/>
<polygon fill="black" stroke="black" points="2170.98,-25254.45 2163.28,-25247.17 2164.76,-25257.66 2170.98,-25254.45"/>
</g>
<!-- stage1_layer1_expert1_act -->
<g id="node299" class="node">
<title>stage1_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2246.19,-25137.43 1965.19,-25137.43 1965.19,-25085.43 2246.19,-25085.43 2246.19,-25137.43"/>
<text text-anchor="middle" x="2105.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="2105.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="2105.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2105.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert1_tp1&#45;&gt;stage1_layer1_expert1_act -->
<g id="edge394" class="edge">
<title>stage1_layer1_expert1_tp1&#45;&gt;stage1_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2130.28,-25173.44C2126.78,-25164.75 2123.04,-25155.49 2119.57,-25146.87"/>
<polygon fill="black" stroke="black" points="2122.77,-25145.44 2115.78,-25137.47 2116.27,-25148.05 2122.77,-25145.44"/>
</g>
<!-- stage1_layer1_expert1_mlp2 -->
<g id="node300" class="node">
<title>stage1_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2213.69,-25049.43 1891.69,-25049.43 1891.69,-24997.43 2213.69,-24997.43 2213.69,-25049.43"/>
<text text-anchor="middle" x="2052.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="2052.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2052.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2052.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert1_act&#45;&gt;stage1_layer1_expert1_mlp2 -->
<g id="edge395" class="edge">
<title>stage1_layer1_expert1_act&#45;&gt;stage1_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M2090.07,-25085.09C2084.9,-25076.69 2079.05,-25067.21 2073.55,-25058.27"/>
<polygon fill="black" stroke="black" points="2076.42,-25056.26 2068.19,-25049.58 2070.46,-25059.93 2076.42,-25056.26"/>
</g>
<!-- stage1_layer1_expert1_tp2 -->
<g id="node301" class="node">
<title>stage1_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1946.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1946.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1946.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 130&#45;131</text>
<text text-anchor="middle" x="1946.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1946.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert1_mlp2&#45;&gt;stage1_layer1_expert1_tp2 -->
<g id="edge396" class="edge">
<title>stage1_layer1_expert1_mlp2&#45;&gt;stage1_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M2025.11,-24997.26C2015.25,-24988.25 2003.84,-24977.83 1992.83,-24967.78"/>
<polygon fill="black" stroke="black" points="1995.04,-24965.06 1985.3,-24960.9 1990.32,-24970.23 1995.04,-24965.06"/>
</g>
<!-- stage1_layer1_expert1_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge447" class="edge">
<title>stage1_layer1_expert1_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2103.22,-24897.95C2129.69,-24894.17 2156.93,-24890.64 2182.69,-24887.89 2601.55,-24843.21 3082.24,-24815.96 3417.44,-24800.82"/>
<polygon fill="black" stroke="black" points="3417.98,-24804.29 3427.81,-24800.35 3417.67,-24797.3 3417.98,-24804.29"/>
</g>
<!-- stage1_layer1_expert2_mlp1 -->
<g id="node303" class="node">
<title>stage1_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2822.69,-25334.97 2508.69,-25334.97 2508.69,-25282.97 2822.69,-25282.97 2822.69,-25334.97"/>
<text text-anchor="middle" x="2665.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2665.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2665.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2665.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert2&#45;&gt;stage1_layer1_expert2_mlp1 -->
<g id="edge398" class="edge">
<title>stage1_layer1_expert2&#45;&gt;stage1_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2695.31,-25370.63C2691.3,-25362.41 2686.77,-25353.14 2682.49,-25344.37"/>
<polygon fill="black" stroke="black" points="2685.51,-25342.57 2677.97,-25335.12 2679.22,-25345.64 2685.51,-25342.57"/>
</g>
<!-- stage1_layer1_expert2_tp1 -->
<g id="node304" class="node">
<title>stage1_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2577.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2577.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2577.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="2577.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2577.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert2_mlp1&#45;&gt;stage1_layer1_expert2_tp1 -->
<g id="edge399" class="edge">
<title>stage1_layer1_expert2_mlp1&#45;&gt;stage1_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2642.8,-25282.79C2634.92,-25274.13 2625.86,-25264.17 2617.05,-25254.49"/>
<polygon fill="black" stroke="black" points="2619.39,-25251.85 2610.07,-25246.81 2614.21,-25256.56 2619.39,-25251.85"/>
</g>
<!-- stage1_layer1_expert2_act -->
<g id="node305" class="node">
<title>stage1_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2658.19,-25137.43 2377.19,-25137.43 2377.19,-25085.43 2658.19,-25085.43 2658.19,-25137.43"/>
<text text-anchor="middle" x="2517.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2517.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="2517.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2517.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert2_tp1&#45;&gt;stage1_layer1_expert2_act -->
<g id="edge400" class="edge">
<title>stage1_layer1_expert2_tp1&#45;&gt;stage1_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2555.52,-25173.44C2549.96,-25164.47 2544.02,-25154.89 2538.52,-25146.03"/>
<polygon fill="black" stroke="black" points="2541.46,-25144.13 2533.22,-25137.47 2535.51,-25147.81 2541.46,-25144.13"/>
</g>
<!-- stage1_layer1_expert2_mlp2 -->
<g id="node306" class="node">
<title>stage1_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2619.69,-25049.43 2297.69,-25049.43 2297.69,-24997.43 2619.69,-24997.43 2619.69,-25049.43"/>
<text text-anchor="middle" x="2458.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2458.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2458.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2458.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert2_act&#45;&gt;stage1_layer1_expert2_mlp2 -->
<g id="edge401" class="edge">
<title>stage1_layer1_expert2_act&#45;&gt;stage1_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2500.31,-25085.09C2494.48,-25076.6 2487.9,-25067.01 2481.72,-25057.99"/>
<polygon fill="black" stroke="black" points="2484.49,-25055.85 2475.95,-25049.58 2478.72,-25059.81 2484.49,-25055.85"/>
</g>
<!-- stage1_layer1_expert2_tp2 -->
<g id="node307" class="node">
<title>stage1_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2419.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2419.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2419.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 132&#45;133</text>
<text text-anchor="middle" x="2419.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2419.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert2_mlp2&#45;&gt;stage1_layer1_expert2_tp2 -->
<g id="edge402" class="edge">
<title>stage1_layer1_expert2_mlp2&#45;&gt;stage1_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2448.54,-24997.26C2445.29,-24989.19 2441.59,-24980 2437.94,-24970.96"/>
<polygon fill="black" stroke="black" points="2441.17,-24969.6 2434.19,-24961.63 2434.68,-24972.22 2441.17,-24969.6"/>
</g>
<!-- stage1_layer1_expert2_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge448" class="edge">
<title>stage1_layer1_expert2_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2578.18,-24898.22C2604.05,-24894.48 2630.59,-24890.88 2655.69,-24887.89 2915.52,-24856.92 3208.5,-24831.34 3437.9,-24813.42"/>
<polygon fill="black" stroke="black" points="3438.39,-24816.89 3448.09,-24812.62 3437.84,-24809.91 3438.39,-24816.89"/>
</g>
<!-- stage1_layer1_expert3_mlp1 -->
<g id="node309" class="node">
<title>stage1_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3212.69,-25334.97 2898.69,-25334.97 2898.69,-25282.97 3212.69,-25282.97 3212.69,-25334.97"/>
<text text-anchor="middle" x="3055.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3055.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3055.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3055.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert3&#45;&gt;stage1_layer1_expert3_mlp1 -->
<g id="edge404" class="edge">
<title>stage1_layer1_expert3&#45;&gt;stage1_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3073.32,-25370.63C3070.98,-25362.58 3068.35,-25353.53 3065.85,-25344.93"/>
<polygon fill="black" stroke="black" points="3069.15,-25343.75 3063,-25335.12 3062.43,-25345.7 3069.15,-25343.75"/>
</g>
<!-- stage1_layer1_expert3_tp1 -->
<g id="node310" class="node">
<title>stage1_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="3001.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3001.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="3001.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="3001.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3001.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert3_mlp1&#45;&gt;stage1_layer1_expert3_tp1 -->
<g id="edge405" class="edge">
<title>stage1_layer1_expert3_mlp1&#45;&gt;stage1_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M3041.64,-25282.79C3037,-25274.48 3031.69,-25264.96 3026.49,-25255.64"/>
<polygon fill="black" stroke="black" points="3029.49,-25253.83 3021.56,-25246.81 3023.38,-25257.25 3029.49,-25253.83"/>
</g>
<!-- stage1_layer1_expert3_act -->
<g id="node311" class="node">
<title>stage1_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3114.19,-25137.43 2833.19,-25137.43 2833.19,-25085.43 3114.19,-25085.43 3114.19,-25137.43"/>
<text text-anchor="middle" x="2973.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2973.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="2973.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2973.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert3_tp1&#45;&gt;stage1_layer1_expert3_act -->
<g id="edge406" class="edge">
<title>stage1_layer1_expert3_tp1&#45;&gt;stage1_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2991.34,-25173.44C2988.86,-25164.85 2986.21,-25155.69 2983.73,-25147.14"/>
<polygon fill="black" stroke="black" points="2987.08,-25146.1 2980.93,-25137.47 2980.35,-25148.05 2987.08,-25146.1"/>
</g>
<!-- stage1_layer1_expert3_mlp2 -->
<g id="node312" class="node">
<title>stage1_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3107.69,-25049.43 2785.69,-25049.43 2785.69,-24997.43 3107.69,-24997.43 3107.69,-25049.43"/>
<text text-anchor="middle" x="2946.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2946.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2946.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2946.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert3_act&#45;&gt;stage1_layer1_expert3_mlp2 -->
<g id="edge407" class="edge">
<title>stage1_layer1_expert3_act&#45;&gt;stage1_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2965.73,-25085.09C2963.21,-25077.04 2960.37,-25067.99 2957.67,-25059.39"/>
<polygon fill="black" stroke="black" points="2960.92,-25058.08 2954.59,-25049.58 2954.24,-25060.17 2960.92,-25058.08"/>
</g>
<!-- stage1_layer1_expert3_tp2 -->
<g id="node313" class="node">
<title>stage1_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2892.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2892.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2892.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 134&#45;135</text>
<text text-anchor="middle" x="2892.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2892.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert3_mlp2&#45;&gt;stage1_layer1_expert3_tp2 -->
<g id="edge408" class="edge">
<title>stage1_layer1_expert3_mlp2&#45;&gt;stage1_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2932.64,-24997.26C2928.05,-24989.02 2922.8,-24979.61 2917.65,-24970.38"/>
<polygon fill="black" stroke="black" points="2920.69,-24968.66 2912.76,-24961.63 2914.58,-24972.07 2920.69,-24968.66"/>
</g>
<!-- stage1_layer1_expert3_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge449" class="edge">
<title>stage1_layer1_expert3_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3055.17,-24898.89C3079.8,-24895.18 3104.91,-24891.41 3128.69,-24887.89 3241.56,-24871.15 3364.57,-24853.2 3476.01,-24837.05"/>
<polygon fill="black" stroke="black" points="3476.67,-24840.49 3486.06,-24835.59 3475.67,-24833.56 3476.67,-24840.49"/>
</g>
<!-- stage1_layer1_expert31_mlp1 -->
<g id="node315" class="node">
<title>stage1_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3598.69,-25334.97 3284.69,-25334.97 3284.69,-25282.97 3598.69,-25282.97 3598.69,-25334.97"/>
<text text-anchor="middle" x="3441.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3441.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3441.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3441.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert31&#45;&gt;stage1_layer1_expert31_mlp1 -->
<g id="edge410" class="edge">
<title>stage1_layer1_expert31&#45;&gt;stage1_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3468.49,-25370.63C3464.86,-25362.41 3460.76,-25353.14 3456.89,-25344.37"/>
<polygon fill="black" stroke="black" points="3460.05,-25342.86 3452.8,-25335.12 3453.64,-25345.68 3460.05,-25342.86"/>
</g>
<!-- stage1_layer1_expert31_tp1 -->
<g id="node316" class="node">
<title>stage1_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3421.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3421.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3421.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="3421.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3421.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert31_mlp1&#45;&gt;stage1_layer1_expert31_tp1 -->
<g id="edge411" class="edge">
<title>stage1_layer1_expert31_mlp1&#45;&gt;stage1_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3436.49,-25282.79C3434.85,-25274.9 3433,-25265.93 3431.17,-25257.07"/>
<polygon fill="black" stroke="black" points="3434.58,-25256.26 3429.12,-25247.17 3427.72,-25257.67 3434.58,-25256.26"/>
</g>
<!-- stage1_layer1_expert31_act -->
<g id="node317" class="node">
<title>stage1_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3548.19,-25137.43 3267.19,-25137.43 3267.19,-25085.43 3548.19,-25085.43 3548.19,-25137.43"/>
<text text-anchor="middle" x="3407.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3407.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="3407.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3407.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert31_tp1&#45;&gt;stage1_layer1_expert31_act -->
<g id="edge412" class="edge">
<title>stage1_layer1_expert31_tp1&#45;&gt;stage1_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3416.52,-25173.44C3415.29,-25164.94 3413.98,-25155.89 3412.75,-25147.42"/>
<polygon fill="black" stroke="black" points="3416.21,-25146.87 3411.31,-25137.47 3409.28,-25147.87 3416.21,-25146.87"/>
</g>
<!-- stage1_layer1_expert31_mlp2 -->
<g id="node318" class="node">
<title>stage1_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3554.69,-25049.43 3232.69,-25049.43 3232.69,-24997.43 3554.69,-24997.43 3554.69,-25049.43"/>
<text text-anchor="middle" x="3393.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3393.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3393.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3393.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert31_act&#45;&gt;stage1_layer1_expert31_mlp2 -->
<g id="edge413" class="edge">
<title>stage1_layer1_expert31_act&#45;&gt;stage1_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3403.56,-25085.09C3402.27,-25077.13 3400.81,-25068.19 3399.43,-25059.67"/>
<polygon fill="black" stroke="black" points="3402.85,-25058.89 3397.78,-25049.58 3395.94,-25060.02 3402.85,-25058.89"/>
</g>
<!-- stage1_layer1_expert31_tp2 -->
<g id="node319" class="node">
<title>stage1_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3365.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3365.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3365.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 190&#45;191</text>
<text text-anchor="middle" x="3365.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3365.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert31_mlp2&#45;&gt;stage1_layer1_expert31_tp2 -->
<g id="edge414" class="edge">
<title>stage1_layer1_expert31_mlp2&#45;&gt;stage1_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3386.4,-24997.26C3384.1,-24989.28 3381.47,-24980.19 3378.88,-24971.24"/>
<polygon fill="black" stroke="black" points="3382.24,-24970.27 3376.1,-24961.63 3375.52,-24972.21 3382.24,-24970.27"/>
</g>
<!-- stage1_layer1_expert31_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge450" class="edge">
<title>stage1_layer1_expert31_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3473.02,-24892.17C3511.11,-24880.99 3555.65,-24867.93 3600.28,-24854.83"/>
<polygon fill="black" stroke="black" points="3601.49,-24858.13 3610.1,-24851.95 3599.52,-24851.41 3601.49,-24858.13"/>
</g>
<!-- stage1_layer1_expert32_mlp1 -->
<g id="node321" class="node">
<title>stage1_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3995.69,-25334.97 3681.69,-25334.97 3681.69,-25282.97 3995.69,-25282.97 3995.69,-25334.97"/>
<text text-anchor="middle" x="3838.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3838.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3838.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert32&#45;&gt;stage1_layer1_expert32_mlp1 -->
<g id="edge416" class="edge">
<title>stage1_layer1_expert32&#45;&gt;stage1_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3838.69,-25370.63C3838.69,-25362.67 3838.69,-25353.73 3838.69,-25345.21"/>
<polygon fill="black" stroke="black" points="3842.19,-25345.12 3838.69,-25335.12 3835.19,-25345.12 3842.19,-25345.12"/>
</g>
<!-- stage1_layer1_expert32_tp1 -->
<g id="node322" class="node">
<title>stage1_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3838.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3838.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="3838.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3838.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert32_mlp1&#45;&gt;stage1_layer1_expert32_tp1 -->
<g id="edge417" class="edge">
<title>stage1_layer1_expert32_mlp1&#45;&gt;stage1_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3838.69,-25282.79C3838.69,-25274.99 3838.69,-25266.12 3838.69,-25257.35"/>
<polygon fill="black" stroke="black" points="3842.19,-25257.17 3838.69,-25247.17 3835.19,-25257.17 3842.19,-25257.17"/>
</g>
<!-- stage1_layer1_expert32_act -->
<g id="node323" class="node">
<title>stage1_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3979.19,-25137.43 3698.19,-25137.43 3698.19,-25085.43 3979.19,-25085.43 3979.19,-25137.43"/>
<text text-anchor="middle" x="3838.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3838.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="3838.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3838.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert32_tp1&#45;&gt;stage1_layer1_expert32_act -->
<g id="edge418" class="edge">
<title>stage1_layer1_expert32_tp1&#45;&gt;stage1_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3838.69,-25173.16C3838.69,-25164.85 3838.69,-25156.02 3838.69,-25147.74"/>
<polygon fill="black" stroke="black" points="3842.19,-25147.62 3838.69,-25137.62 3835.19,-25147.62 3842.19,-25147.62"/>
</g>
<!-- stage1_layer1_expert32_mlp2 -->
<g id="node324" class="node">
<title>stage1_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3999.69,-25049.43 3677.69,-25049.43 3677.69,-24997.43 3999.69,-24997.43 3999.69,-25049.43"/>
<text text-anchor="middle" x="3838.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3838.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3838.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3838.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert32_act&#45;&gt;stage1_layer1_expert32_mlp2 -->
<g id="edge419" class="edge">
<title>stage1_layer1_expert32_act&#45;&gt;stage1_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3838.69,-25085.09C3838.69,-25077.13 3838.69,-25068.19 3838.69,-25059.67"/>
<polygon fill="black" stroke="black" points="3842.19,-25059.58 3838.69,-25049.58 3835.19,-25059.58 3842.19,-25059.58"/>
</g>
<!-- stage1_layer1_expert32_tp2 -->
<g id="node325" class="node">
<title>stage1_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3838.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3838.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 192&#45;193</text>
<text text-anchor="middle" x="3838.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert32_mlp2&#45;&gt;stage1_layer1_expert32_tp2 -->
<g id="edge420" class="edge">
<title>stage1_layer1_expert32_mlp2&#45;&gt;stage1_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3838.69,-24997.26C3838.69,-24989.45 3838.69,-24980.58 3838.69,-24971.81"/>
<polygon fill="black" stroke="black" points="3842.19,-24971.63 3838.69,-24961.63 3835.19,-24971.63 3842.19,-24971.63"/>
</g>
<!-- stage1_layer1_expert32_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge451" class="edge">
<title>stage1_layer1_expert32_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3838.69,-24887.56C3838.69,-24879.62 3838.69,-24870.93 3838.69,-24862.06"/>
<polygon fill="black" stroke="black" points="3842.19,-24862.01 3838.69,-24852.01 3835.19,-24862.01 3842.19,-24862.01"/>
</g>
<!-- stage1_layer1_expert60_mlp1 -->
<g id="node327" class="node">
<title>stage1_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4401.69,-25334.97 4087.69,-25334.97 4087.69,-25282.97 4401.69,-25282.97 4401.69,-25334.97"/>
<text text-anchor="middle" x="4244.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4244.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4244.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4244.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert60&#45;&gt;stage1_layer1_expert60_mlp1 -->
<g id="edge422" class="edge">
<title>stage1_layer1_expert60&#45;&gt;stage1_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4229.17,-25370.63C4231.23,-25362.58 4233.54,-25353.53 4235.74,-25344.93"/>
<polygon fill="black" stroke="black" points="4239.17,-25345.68 4238.25,-25335.12 4232.38,-25343.94 4239.17,-25345.68"/>
</g>
<!-- stage1_layer1_expert60_tp1 -->
<g id="node328" class="node">
<title>stage1_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4267.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4267.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4267.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="4267.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4267.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert60_mlp1&#45;&gt;stage1_layer1_expert60_tp1 -->
<g id="edge423" class="edge">
<title>stage1_layer1_expert60_mlp1&#45;&gt;stage1_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4250.67,-25282.79C4252.55,-25274.9 4254.68,-25265.93 4256.79,-25257.07"/>
<polygon fill="black" stroke="black" points="4260.23,-25257.71 4259.14,-25247.17 4253.42,-25256.09 4260.23,-25257.71"/>
</g>
<!-- stage1_layer1_expert60_act -->
<g id="node329" class="node">
<title>stage1_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4415.19,-25137.43 4134.19,-25137.43 4134.19,-25085.43 4415.19,-25085.43 4415.19,-25137.43"/>
<text text-anchor="middle" x="4274.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4274.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="4274.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4274.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert60_tp1&#45;&gt;stage1_layer1_expert60_act -->
<g id="edge424" class="edge">
<title>stage1_layer1_expert60_tp1&#45;&gt;stage1_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4270.29,-25173.16C4270.9,-25164.85 4271.54,-25156.02 4272.13,-25147.74"/>
<polygon fill="black" stroke="black" points="4275.64,-25147.85 4272.87,-25137.62 4268.65,-25147.34 4275.64,-25147.85"/>
</g>
<!-- stage1_layer1_expert60_mlp2 -->
<g id="node330" class="node">
<title>stage1_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4464.69,-25049.43 4142.69,-25049.43 4142.69,-24997.43 4464.69,-24997.43 4464.69,-25049.43"/>
<text text-anchor="middle" x="4303.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4303.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4303.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4303.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert60_act&#45;&gt;stage1_layer1_expert60_mlp2 -->
<g id="edge425" class="edge">
<title>stage1_layer1_expert60_act&#45;&gt;stage1_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4283.23,-25085.09C4285.98,-25076.95 4289.06,-25067.8 4291.99,-25059.11"/>
<polygon fill="black" stroke="black" points="4295.33,-25060.18 4295.21,-25049.58 4288.69,-25057.94 4295.33,-25060.18"/>
</g>
<!-- stage1_layer1_expert60_tp2 -->
<g id="node331" class="node">
<title>stage1_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4311.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4311.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4311.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 248&#45;249</text>
<text text-anchor="middle" x="4311.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4311.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert60_mlp2&#45;&gt;stage1_layer1_expert60_tp2 -->
<g id="edge426" class="edge">
<title>stage1_layer1_expert60_mlp2&#45;&gt;stage1_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4305.77,-24997.26C4306.41,-24989.45 4307.15,-24980.58 4307.87,-24971.81"/>
<polygon fill="black" stroke="black" points="4311.38,-24971.89 4308.71,-24961.63 4304.4,-24971.31 4311.38,-24971.89"/>
</g>
<!-- stage1_layer1_expert60_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge452" class="edge">
<title>stage1_layer1_expert60_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4204.36,-24892.17C4166.27,-24880.99 4121.73,-24867.93 4077.1,-24854.83"/>
<polygon fill="black" stroke="black" points="4077.86,-24851.41 4067.28,-24851.95 4075.89,-24858.13 4077.86,-24851.41"/>
</g>
<!-- stage1_layer1_expert61_mlp1 -->
<g id="node333" class="node">
<title>stage1_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4818.69,-25334.97 4504.69,-25334.97 4504.69,-25282.97 4818.69,-25282.97 4818.69,-25334.97"/>
<text text-anchor="middle" x="4661.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4661.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4661.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4661.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert61&#45;&gt;stage1_layer1_expert61_mlp1 -->
<g id="edge428" class="edge">
<title>stage1_layer1_expert61&#45;&gt;stage1_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4639.12,-25370.63C4642.14,-25362.49 4645.55,-25353.34 4648.78,-25344.65"/>
<polygon fill="black" stroke="black" points="4652.12,-25345.72 4652.33,-25335.12 4645.56,-25343.27 4652.12,-25345.72"/>
</g>
<!-- stage1_layer1_expert61_tp1 -->
<g id="node334" class="node">
<title>stage1_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4697.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4697.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4697.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="4697.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4697.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert61_mlp1&#45;&gt;stage1_layer1_expert61_tp1 -->
<g id="edge429" class="edge">
<title>stage1_layer1_expert61_mlp1&#45;&gt;stage1_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4671.05,-25282.79C4674.02,-25274.82 4677.4,-25265.73 4680.73,-25256.78"/>
<polygon fill="black" stroke="black" points="4684.1,-25257.77 4684.3,-25247.17 4677.54,-25255.33 4684.1,-25257.77"/>
</g>
<!-- stage1_layer1_expert61_act -->
<g id="node335" class="node">
<title>stage1_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4853.19,-25137.43 4572.19,-25137.43 4572.19,-25085.43 4853.19,-25085.43 4853.19,-25137.43"/>
<text text-anchor="middle" x="4712.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4712.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="4712.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4712.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert61_tp1&#45;&gt;stage1_layer1_expert61_act -->
<g id="edge430" class="edge">
<title>stage1_layer1_expert61_tp1&#45;&gt;stage1_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4703.23,-25173.44C4704.55,-25164.94 4705.95,-25155.89 4707.26,-25147.42"/>
<polygon fill="black" stroke="black" points="4710.73,-25147.89 4708.81,-25137.47 4703.82,-25146.82 4710.73,-25147.89"/>
</g>
<!-- stage1_layer1_expert61_mlp2 -->
<g id="node336" class="node">
<title>stage1_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4931.69,-25049.43 4609.69,-25049.43 4609.69,-24997.43 4931.69,-24997.43 4931.69,-25049.43"/>
<text text-anchor="middle" x="4770.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4770.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4770.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4770.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert61_act&#45;&gt;stage1_layer1_expert61_mlp2 -->
<g id="edge431" class="edge">
<title>stage1_layer1_expert61_act&#45;&gt;stage1_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4729.78,-25085.09C4735.5,-25076.6 4741.97,-25067.01 4748.05,-25057.99"/>
<polygon fill="black" stroke="black" points="4751.03,-25059.83 4753.72,-25049.58 4745.23,-25055.92 4751.03,-25059.83"/>
</g>
<!-- stage1_layer1_expert61_tp2 -->
<g id="node337" class="node">
<title>stage1_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4784.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4784.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4784.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 250&#45;251</text>
<text text-anchor="middle" x="4784.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4784.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert61_mlp2&#45;&gt;stage1_layer1_expert61_tp2 -->
<g id="edge432" class="edge">
<title>stage1_layer1_expert61_mlp2&#45;&gt;stage1_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4774.33,-24997.26C4775.46,-24989.45 4776.74,-24980.58 4778.01,-24971.81"/>
<polygon fill="black" stroke="black" points="4781.52,-24972.03 4779.48,-24961.63 4774.59,-24971.03 4781.52,-24972.03"/>
</g>
<!-- stage1_layer1_expert61_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge453" class="edge">
<title>stage1_layer1_expert61_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4622.21,-24898.89C4597.58,-24895.18 4572.46,-24891.41 4548.69,-24887.89 4472.78,-24876.63 4392.27,-24864.82 4313.79,-24853.39"/>
<polygon fill="black" stroke="black" points="4314.13,-24849.9 4303.73,-24851.92 4313.13,-24856.83 4314.13,-24849.9"/>
</g>
<!-- stage1_layer1_expert62_mlp1 -->
<g id="node339" class="node">
<title>stage1_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5201.69,-25334.97 4887.69,-25334.97 4887.69,-25282.97 5201.69,-25282.97 5201.69,-25334.97"/>
<text text-anchor="middle" x="5044.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="5044.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5044.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5044.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert62&#45;&gt;stage1_layer1_expert62_mlp1 -->
<g id="edge434" class="edge">
<title>stage1_layer1_expert62&#45;&gt;stage1_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M5031.99,-25370.63C5033.68,-25362.58 5035.57,-25353.53 5037.37,-25344.93"/>
<polygon fill="black" stroke="black" points="5040.8,-25345.63 5039.42,-25335.12 5033.95,-25344.19 5040.8,-25345.63"/>
</g>
<!-- stage1_layer1_expert62_tp1 -->
<g id="node340" class="node">
<title>stage1_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5120.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5120.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5120.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="5120.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5120.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert62_mlp1&#45;&gt;stage1_layer1_expert62_tp1 -->
<g id="edge435" class="edge">
<title>stage1_layer1_expert62_mlp1&#45;&gt;stage1_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5064.46,-25282.79C5071.19,-25274.22 5078.93,-25264.37 5086.46,-25254.77"/>
<polygon fill="black" stroke="black" points="5089.3,-25256.83 5092.72,-25246.81 5083.79,-25252.51 5089.3,-25256.83"/>
</g>
<!-- stage1_layer1_expert62_act -->
<g id="node341" class="node">
<title>stage1_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5268.19,-25137.43 4987.19,-25137.43 4987.19,-25085.43 5268.19,-25085.43 5268.19,-25137.43"/>
<text text-anchor="middle" x="5127.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5127.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="5127.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5127.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert62_tp1&#45;&gt;stage1_layer1_expert62_act -->
<g id="edge436" class="edge">
<title>stage1_layer1_expert62_tp1&#45;&gt;stage1_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5123.29,-25173.16C5123.9,-25164.85 5124.54,-25156.02 5125.13,-25147.74"/>
<polygon fill="black" stroke="black" points="5128.64,-25147.85 5125.87,-25137.62 5121.65,-25147.34 5128.64,-25147.85"/>
</g>
<!-- stage1_layer1_expert62_mlp2 -->
<g id="node342" class="node">
<title>stage1_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5375.69,-25049.43 5053.69,-25049.43 5053.69,-24997.43 5375.69,-24997.43 5375.69,-25049.43"/>
<text text-anchor="middle" x="5214.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5214.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5214.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5214.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert62_act&#45;&gt;stage1_layer1_expert62_mlp2 -->
<g id="edge437" class="edge">
<title>stage1_layer1_expert62_act&#45;&gt;stage1_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5153.32,-25085.09C5162.26,-25076.25 5172.42,-25066.21 5181.86,-25056.88"/>
<polygon fill="black" stroke="black" points="5184.59,-25059.1 5189.24,-25049.58 5179.67,-25054.13 5184.59,-25059.1"/>
</g>
<!-- stage1_layer1_expert62_tp2 -->
<g id="node343" class="node">
<title>stage1_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5257.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5257.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5257.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 252&#45;253</text>
<text text-anchor="middle" x="5257.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5257.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert62_mlp2&#45;&gt;stage1_layer1_expert62_tp2 -->
<g id="edge438" class="edge">
<title>stage1_layer1_expert62_mlp2&#45;&gt;stage1_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5225.87,-24997.26C5229.46,-24989.19 5233.54,-24980 5237.56,-24970.96"/>
<polygon fill="black" stroke="black" points="5240.84,-24972.19 5241.7,-24961.63 5234.44,-24969.35 5240.84,-24972.19"/>
</g>
<!-- stage1_layer1_expert62_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge454" class="edge">
<title>stage1_layer1_expert62_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5099.19,-24898.22C5073.33,-24894.48 5046.79,-24890.88 5021.69,-24887.89 4801.65,-24861.66 4557.82,-24839.3 4348.99,-24822.18"/>
<polygon fill="black" stroke="black" points="4349,-24818.67 4338.75,-24821.34 4348.43,-24825.65 4349,-24818.67"/>
</g>
<!-- stage1_layer1_expert63_mlp1 -->
<g id="node345" class="node">
<title>stage1_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5566.69,-25334.97 5252.69,-25334.97 5252.69,-25282.97 5566.69,-25282.97 5566.69,-25334.97"/>
<text text-anchor="middle" x="5409.69" y="-25322.97" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5409.69" y="-25311.97" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5409.69" y="-25300.97" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5409.69" y="-25289.97" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage1_layer1_expert63&#45;&gt;stage1_layer1_expert63_mlp1 -->
<g id="edge440" class="edge">
<title>stage1_layer1_expert63&#45;&gt;stage1_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5399.81,-25370.63C5401.11,-25362.67 5402.56,-25353.73 5403.95,-25345.21"/>
<polygon fill="black" stroke="black" points="5407.44,-25345.56 5405.59,-25335.12 5400.53,-25344.43 5407.44,-25345.56"/>
</g>
<!-- stage1_layer1_expert63_tp1 -->
<g id="node346" class="node">
<title>stage1_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5571.69" cy="-25210.2" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5571.69" y="-25224.2" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5571.69" y="-25213.2" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="5571.69" y="-25202.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5571.69" y="-25191.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert63_mlp1&#45;&gt;stage1_layer1_expert63_tp1 -->
<g id="edge441" class="edge">
<title>stage1_layer1_expert63_mlp1&#45;&gt;stage1_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5451.83,-25282.79C5468.18,-25273.02 5487.31,-25261.6 5505.42,-25250.78"/>
<polygon fill="black" stroke="black" points="5507.42,-25253.66 5514.21,-25245.53 5503.83,-25247.66 5507.42,-25253.66"/>
</g>
<!-- stage1_layer1_expert63_act -->
<g id="node347" class="node">
<title>stage1_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5784.19,-25137.43 5503.19,-25137.43 5503.19,-25085.43 5784.19,-25085.43 5784.19,-25137.43"/>
<text text-anchor="middle" x="5643.69" y="-25125.43" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5643.69" y="-25114.43" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="5643.69" y="-25103.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5643.69" y="-25092.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage1_layer1_expert63_tp1&#45;&gt;stage1_layer1_expert63_act -->
<g id="edge442" class="edge">
<title>stage1_layer1_expert63_tp1&#45;&gt;stage1_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5598.09,-25173.71C5604.91,-25164.54 5612.23,-25154.71 5618.96,-25145.66"/>
<polygon fill="black" stroke="black" points="5621.79,-25147.73 5624.95,-25137.61 5616.17,-25143.55 5621.79,-25147.73"/>
</g>
<!-- stage1_layer1_expert63_mlp2 -->
<g id="node348" class="node">
<title>stage1_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5862.69,-25049.43 5540.69,-25049.43 5540.69,-24997.43 5862.69,-24997.43 5862.69,-25049.43"/>
<text text-anchor="middle" x="5701.69" y="-25037.43" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5701.69" y="-25026.43" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5701.69" y="-25015.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5701.69" y="-25004.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert63_act&#45;&gt;stage1_layer1_expert63_mlp2 -->
<g id="edge443" class="edge">
<title>stage1_layer1_expert63_act&#45;&gt;stage1_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5660.78,-25085.09C5666.5,-25076.6 5672.97,-25067.01 5679.05,-25057.99"/>
<polygon fill="black" stroke="black" points="5682.03,-25059.83 5684.72,-25049.58 5676.23,-25055.92 5682.03,-25059.83"/>
</g>
<!-- stage1_layer1_expert63_tp2 -->
<g id="node349" class="node">
<title>stage1_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5730.69" cy="-24924.66" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5730.69" y="-24938.66" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5730.69" y="-24927.66" font-family="Times,serif" font-size="10.00">GPU: 254&#45;255</text>
<text text-anchor="middle" x="5730.69" y="-24916.66" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5730.69" y="-24905.66" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert63_mlp2&#45;&gt;stage1_layer1_expert63_tp2 -->
<g id="edge444" class="edge">
<title>stage1_layer1_expert63_mlp2&#45;&gt;stage1_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5709.23,-24997.26C5711.62,-24989.28 5714.34,-24980.19 5717.03,-24971.24"/>
<polygon fill="black" stroke="black" points="5720.39,-24972.22 5719.91,-24961.63 5713.68,-24970.21 5720.39,-24972.22"/>
</g>
<!-- stage1_layer1_expert63_tp2&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge455" class="edge">
<title>stage1_layer1_expert63_tp2&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5574.16,-24897.95C5547.69,-24894.17 5520.44,-24890.64 5494.69,-24887.89 5099.75,-24845.76 4649.84,-24819.13 4318.75,-24803.53"/>
<polygon fill="black" stroke="black" points="4318.65,-24800.02 4308.49,-24803.05 4318.32,-24807.01 4318.65,-24800.02"/>
</g>
<!-- stage1_layer1_expert_ellipsis&#45;&gt;stage1_layer1_expert_agg -->
<g id="edge456" class="edge">
<title>stage1_layer1_expert_ellipsis&#45;&gt;stage1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5974.87,-25282.7C5979.27,-25245.49 5986.69,-25173.71 5986.69,-25112.43 5986.69,-25112.43 5986.69,-25112.43 5986.69,-25022.43 5986.69,-24962.04 6012.31,-24928.58 5967.69,-24887.89 5907.07,-24832.6 4908.4,-24804.48 4300.67,-24792.42"/>
<polygon fill="black" stroke="black" points="4300.48,-24788.92 4290.41,-24792.22 4300.34,-24795.92 4300.48,-24788.92"/>
</g>
<!-- stage1_layer1_output -->
<g id="node352" class="node">
<title>stage1_layer1_output</title>
<polygon fill="none" stroke="black" points="4063.69,-24679.89 3613.69,-24679.89 3613.69,-24611.89 4063.69,-24611.89 4063.69,-24679.89"/>
<text text-anchor="middle" x="3838.69" y="-24664.69" font-family="Times,serif" font-size="14.00">Layer 3 Output</text>
<text text-anchor="middle" x="3838.69" y="-24649.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-24634.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24619.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_expert_agg&#45;&gt;stage1_layer1_output -->
<g id="edge457" class="edge">
<title>stage1_layer1_expert_agg&#45;&gt;stage1_layer1_output</title>
<path fill="none" stroke="black" d="M3838.69,-24715.69C3838.69,-24706.93 3838.69,-24698.16 3838.69,-24689.96"/>
<polygon fill="black" stroke="black" points="3842.19,-24689.91 3838.69,-24679.91 3835.19,-24689.91 3842.19,-24689.91"/>
</g>
<!-- stage1_output -->
<g id="node353" class="node">
<title>stage1_output</title>
<polygon fill="none" stroke="black" points="4305.27,-24575.89 3563.05,-24575.89 3372.11,-24439.89 4114.33,-24439.89 4305.27,-24575.89"/>
<text text-anchor="middle" x="3838.69" y="-24526.69" font-family="Times,serif" font-size="14.00">Stage 1 Output</text>
<text text-anchor="middle" x="3838.69" y="-24511.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 1</text>
<text text-anchor="middle" x="3838.69" y="-24496.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24481.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_layer1_output&#45;&gt;stage1_output -->
<g id="edge458" class="edge">
<title>stage1_layer1_output&#45;&gt;stage1_output</title>
<path fill="none" stroke="black" d="M3838.69,-24611.62C3838.69,-24603.79 3838.69,-24595.12 3838.69,-24586.24"/>
<polygon fill="black" stroke="black" points="3842.19,-24586.15 3838.69,-24576.15 3835.19,-24586.15 3842.19,-24586.15"/>
</g>
<!-- stage2_input -->
<g id="node354" class="node">
<title>stage2_input</title>
<polygon fill="none" stroke="black" points="4305.27,-24403.89 3563.05,-24403.89 3372.11,-24267.89 4114.33,-24267.89 4305.27,-24403.89"/>
<text text-anchor="middle" x="3838.69" y="-24354.69" font-family="Times,serif" font-size="14.00">Stage 2 Input Router</text>
<text text-anchor="middle" x="3838.69" y="-24339.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3838.69" y="-24324.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24309.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage1_output&#45;&gt;stage2_input -->
<g id="edge459" class="edge">
<title>stage1_output&#45;&gt;stage2_input</title>
<path fill="none" stroke="black" d="M3838.69,-24439.7C3838.69,-24431.39 3838.69,-24422.83 3838.69,-24414.38"/>
<polygon fill="black" stroke="black" points="3842.19,-24414.15 3838.69,-24404.15 3835.19,-24414.15 3842.19,-24414.15"/>
</g>
<!-- stage2_layer0_ln -->
<g id="node355" class="node">
<title>stage2_layer0_ln</title>
<polygon fill="none" stroke="black" points="4063.69,-24231.89 3613.69,-24231.89 3613.69,-24163.89 4063.69,-24163.89 4063.69,-24231.89"/>
<text text-anchor="middle" x="3838.69" y="-24216.69" font-family="Times,serif" font-size="14.00">Layer 4 LayerNorm</text>
<text text-anchor="middle" x="3838.69" y="-24201.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3838.69" y="-24186.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24171.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_input&#45;&gt;stage2_layer0_ln -->
<g id="edge460" class="edge">
<title>stage2_input&#45;&gt;stage2_layer0_ln</title>
<path fill="none" stroke="black" d="M3838.69,-24267.69C3838.69,-24258.93 3838.69,-24250.16 3838.69,-24241.96"/>
<polygon fill="black" stroke="black" points="3842.19,-24241.91 3838.69,-24231.91 3835.19,-24241.91 3842.19,-24241.91"/>
</g>
<!-- stage2_layer0_attn_qkv -->
<g id="node356" class="node">
<title>stage2_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4070.19,-24127.89 3607.19,-24127.89 3607.19,-24059.89 4070.19,-24059.89 4070.19,-24127.89"/>
<text text-anchor="middle" x="3838.69" y="-24112.69" font-family="Times,serif" font-size="14.00">Layer 4 Attention QKV Projection</text>
<text text-anchor="middle" x="3838.69" y="-24097.69" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP: GPU 256&#45;383)</text>
<text text-anchor="middle" x="3838.69" y="-24082.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-24067.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage2_layer0_ln&#45;&gt;stage2_layer0_attn_qkv -->
<g id="edge461" class="edge">
<title>stage2_layer0_ln&#45;&gt;stage2_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3838.69,-24163.77C3838.69,-24155.67 3838.69,-24146.87 3838.69,-24138.36"/>
<polygon fill="black" stroke="black" points="3842.19,-24138.19 3838.69,-24128.19 3835.19,-24138.19 3842.19,-24138.19"/>
</g>
<!-- stage2_layer0_tp_qkv_comm -->
<g id="node357" class="node">
<title>stage2_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-23975.81" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3838.69" y="-23994.61" font-family="Times,serif" font-size="14.00">Layer 4 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3838.69" y="-23979.61" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP pairs)</text>
<text text-anchor="middle" x="3838.69" y="-23964.61" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-23949.61" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage2_layer0_attn_qkv&#45;&gt;stage2_layer0_tp_qkv_comm -->
<g id="edge462" class="edge">
<title>stage2_layer0_attn_qkv&#45;&gt;stage2_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3838.69,-24059.62C3838.69,-24051.63 3838.69,-24042.86 3838.69,-24034.12"/>
<polygon fill="black" stroke="black" points="3842.19,-24033.91 3838.69,-24023.91 3835.19,-24033.91 3842.19,-24033.91"/>
</g>
<!-- stage2_layer0_attn_head0 -->
<g id="node358" class="node">
<title>stage2_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1647.19,-23891.72 1374.19,-23891.72 1374.19,-23839.72 1647.19,-23839.72 1647.19,-23891.72"/>
<text text-anchor="middle" x="1510.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 0 Attention</text>
<text text-anchor="middle" x="1510.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 0)</text>
<text text-anchor="middle" x="1510.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1510.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head0 -->
<g id="edge463" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3515.67,-23967.78C3003.05,-23955.75 2024.56,-23928.95 1657.38,-23891.83"/>
<polygon fill="black" stroke="black" points="1657.54,-23888.33 1647.23,-23890.78 1656.82,-23895.29 1657.54,-23888.33"/>
</g>
<!-- stage2_layer0_attn_head1 -->
<g id="node359" class="node">
<title>stage2_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="1938.19,-23891.72 1665.19,-23891.72 1665.19,-23839.72 1938.19,-23839.72 1938.19,-23891.72"/>
<text text-anchor="middle" x="1801.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 1 Attention</text>
<text text-anchor="middle" x="1801.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 1)</text>
<text text-anchor="middle" x="1801.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1801.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head1 -->
<g id="edge464" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3511.73,-23973.01C3136.12,-23968.06 2501.43,-23950.85 1948.41,-23891.85"/>
<polygon fill="black" stroke="black" points="1948.55,-23888.35 1938.23,-23890.76 1947.8,-23895.31 1948.55,-23888.35"/>
</g>
<!-- stage2_layer0_attn_head2 -->
<g id="node360" class="node">
<title>stage2_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2229.19,-23891.72 1956.19,-23891.72 1956.19,-23839.72 2229.19,-23839.72 2229.19,-23891.72"/>
<text text-anchor="middle" x="2092.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 2 Attention</text>
<text text-anchor="middle" x="2092.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 2)</text>
<text text-anchor="middle" x="2092.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2092.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head2 -->
<g id="edge465" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3514.26,-23969.27C3192.63,-23961.14 2685.92,-23941.25 2239.44,-23891.86"/>
<polygon fill="black" stroke="black" points="2239.56,-23888.36 2229.24,-23890.73 2238.79,-23895.31 2239.56,-23888.36"/>
</g>
<!-- stage2_layer0_attn_head3 -->
<g id="node361" class="node">
<title>stage2_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2520.19,-23891.72 2247.19,-23891.72 2247.19,-23839.72 2520.19,-23839.72 2520.19,-23891.72"/>
<text text-anchor="middle" x="2383.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 3 Attention</text>
<text text-anchor="middle" x="2383.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 3)</text>
<text text-anchor="middle" x="2383.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2383.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head3 -->
<g id="edge466" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3520.84,-23964.2C3257.62,-23953.16 2873.78,-23931.83 2530.39,-23891.87"/>
<polygon fill="black" stroke="black" points="2530.58,-23888.37 2520.24,-23890.69 2529.77,-23895.32 2530.58,-23888.37"/>
</g>
<!-- stage2_layer0_attn_head4 -->
<g id="node362" class="node">
<title>stage2_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2811.19,-23891.72 2538.19,-23891.72 2538.19,-23839.72 2811.19,-23839.72 2811.19,-23891.72"/>
<text text-anchor="middle" x="2674.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 4 Attention</text>
<text text-anchor="middle" x="2674.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 4)</text>
<text text-anchor="middle" x="2674.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2674.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head4 -->
<g id="edge467" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3536.43,-23957.27C3336.07,-23943.92 3067.29,-23922.74 2821.46,-23891.9"/>
<polygon fill="black" stroke="black" points="2821.61,-23888.4 2811.25,-23890.62 2820.73,-23895.34 2821.61,-23888.4"/>
</g>
<!-- stage2_layer0_attn_head5 -->
<g id="node363" class="node">
<title>stage2_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3102.19,-23891.72 2829.19,-23891.72 2829.19,-23839.72 3102.19,-23839.72 3102.19,-23891.72"/>
<text text-anchor="middle" x="2965.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 5 Attention</text>
<text text-anchor="middle" x="2965.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 5)</text>
<text text-anchor="middle" x="2965.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2965.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head5 -->
<g id="edge468" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3571.12,-23947.96C3436.28,-23933.52 3270.06,-23914.33 3112.62,-23891.97"/>
<polygon fill="black" stroke="black" points="3112.66,-23888.44 3102.27,-23890.49 3111.67,-23895.37 3112.66,-23888.44"/>
</g>
<!-- stage2_layer0_attn_head6 -->
<g id="node364" class="node">
<title>stage2_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3393.19,-23891.72 3120.19,-23891.72 3120.19,-23839.72 3393.19,-23839.72 3393.19,-23891.72"/>
<text text-anchor="middle" x="3256.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 6 Attention</text>
<text text-anchor="middle" x="3256.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 6)</text>
<text text-anchor="middle" x="3256.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3256.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head6 -->
<g id="edge469" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3638.8,-23937.68C3560.89,-23923.22 3473.29,-23906.95 3401.64,-23893.64"/>
<polygon fill="black" stroke="black" points="3402.1,-23890.17 3391.63,-23891.78 3400.83,-23897.05 3402.1,-23890.17"/>
</g>
<!-- stage2_layer0_attn_head7 -->
<g id="node365" class="node">
<title>stage2_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3684.19,-23891.72 3411.19,-23891.72 3411.19,-23839.72 3684.19,-23839.72 3684.19,-23891.72"/>
<text text-anchor="middle" x="3547.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 7 Attention</text>
<text text-anchor="middle" x="3547.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 7)</text>
<text text-anchor="middle" x="3547.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3547.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head7 -->
<g id="edge470" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3720.33,-23930.84C3688.09,-23918.87 3654.02,-23906.22 3624.74,-23895.34"/>
<polygon fill="black" stroke="black" points="3625.59,-23891.92 3615,-23891.72 3623.15,-23898.48 3625.59,-23891.92"/>
</g>
<!-- stage2_layer0_attn_ellipsis -->
<g id="node366" class="node">
<title>stage2_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3975.19,-23891.72 3702.19,-23891.72 3702.19,-23839.72 3975.19,-23839.72 3975.19,-23891.72"/>
<text text-anchor="middle" x="3838.69" y="-23879.72" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3838.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3838.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_ellipsis -->
<g id="edge471" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3838.69,-23927.71C3838.69,-23919.17 3838.69,-23910.39 3838.69,-23902.25"/>
<polygon fill="black" stroke="black" points="3842.19,-23901.99 3838.69,-23891.99 3835.19,-23901.99 3842.19,-23901.99"/>
</g>
<!-- stage2_layer0_attn_head24 -->
<g id="node367" class="node">
<title>stage2_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4266.19,-23891.72 3993.19,-23891.72 3993.19,-23839.72 4266.19,-23839.72 4266.19,-23891.72"/>
<text text-anchor="middle" x="4129.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 24 Attention</text>
<text text-anchor="middle" x="4129.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 24)</text>
<text text-anchor="middle" x="4129.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4129.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head24 -->
<g id="edge472" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M3957.05,-23930.84C3989.28,-23918.87 4023.36,-23906.22 4052.64,-23895.34"/>
<polygon fill="black" stroke="black" points="4054.22,-23898.48 4062.38,-23891.72 4051.79,-23891.92 4054.22,-23898.48"/>
</g>
<!-- stage2_layer0_attn_head25 -->
<g id="node368" class="node">
<title>stage2_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4557.19,-23891.72 4284.19,-23891.72 4284.19,-23839.72 4557.19,-23839.72 4557.19,-23891.72"/>
<text text-anchor="middle" x="4420.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 25 Attention</text>
<text text-anchor="middle" x="4420.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 25)</text>
<text text-anchor="middle" x="4420.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4420.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head25 -->
<g id="edge473" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M4038.57,-23937.68C4116.48,-23923.22 4204.09,-23906.95 4275.74,-23893.64"/>
<polygon fill="black" stroke="black" points="4276.55,-23897.05 4285.74,-23891.78 4275.27,-23890.17 4276.55,-23897.05"/>
</g>
<!-- stage2_layer0_attn_head26 -->
<g id="node369" class="node">
<title>stage2_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4848.19,-23891.72 4575.19,-23891.72 4575.19,-23839.72 4848.19,-23839.72 4848.19,-23891.72"/>
<text text-anchor="middle" x="4711.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 26 Attention</text>
<text text-anchor="middle" x="4711.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 26)</text>
<text text-anchor="middle" x="4711.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4711.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head26 -->
<g id="edge474" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4105.45,-23947.92C4240.31,-23933.44 4406.69,-23914.21 4565.01,-23891.79"/>
<polygon fill="black" stroke="black" points="4565.54,-23895.25 4574.95,-23890.37 4564.55,-23888.32 4565.54,-23895.25"/>
</g>
<!-- stage2_layer0_attn_head27 -->
<g id="node370" class="node">
<title>stage2_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5139.19,-23891.72 4866.19,-23891.72 4866.19,-23839.72 5139.19,-23839.72 5139.19,-23891.72"/>
<text text-anchor="middle" x="5002.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 27 Attention</text>
<text text-anchor="middle" x="5002.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 27)</text>
<text text-anchor="middle" x="5002.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5002.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head27 -->
<g id="edge475" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4140.64,-23957.16C4340.8,-23943.78 4609.31,-23922.58 4855.73,-23891.8"/>
<polygon fill="black" stroke="black" points="4856.48,-23895.23 4865.96,-23890.51 4855.61,-23888.28 4856.48,-23895.23"/>
</g>
<!-- stage2_layer0_attn_head28 -->
<g id="node371" class="node">
<title>stage2_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5430.19,-23891.72 5157.19,-23891.72 5157.19,-23839.72 5430.19,-23839.72 5430.19,-23891.72"/>
<text text-anchor="middle" x="5293.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 28 Attention</text>
<text text-anchor="middle" x="5293.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 28)</text>
<text text-anchor="middle" x="5293.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5293.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head28 -->
<g id="edge476" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4156.28,-23964.09C4419.3,-23952.98 4802.83,-23931.61 5146.81,-23891.77"/>
<polygon fill="black" stroke="black" points="5147.45,-23895.22 5156.97,-23890.58 5146.64,-23888.27 5147.45,-23895.22"/>
</g>
<!-- stage2_layer0_attn_head29 -->
<g id="node372" class="node">
<title>stage2_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5721.19,-23891.72 5448.19,-23891.72 5448.19,-23839.72 5721.19,-23839.72 5721.19,-23891.72"/>
<text text-anchor="middle" x="5584.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 29 Attention</text>
<text text-anchor="middle" x="5584.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 29)</text>
<text text-anchor="middle" x="5584.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5584.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head29 -->
<g id="edge477" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4163.28,-23969.14C4484.72,-23960.92 4990.89,-23940.96 5437.77,-23891.76"/>
<polygon fill="black" stroke="black" points="5438.43,-23895.21 5447.98,-23890.63 5437.66,-23888.25 5438.43,-23895.21"/>
</g>
<!-- stage2_layer0_attn_head30 -->
<g id="node373" class="node">
<title>stage2_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="6012.19,-23891.72 5739.19,-23891.72 5739.19,-23839.72 6012.19,-23839.72 6012.19,-23891.72"/>
<text text-anchor="middle" x="5875.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 30 Attention</text>
<text text-anchor="middle" x="5875.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 30)</text>
<text text-anchor="middle" x="5875.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5875.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head30 -->
<g id="edge478" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4165.89,-23972.89C4541.34,-23967.82 5175.41,-23950.49 5728.8,-23891.75"/>
<polygon fill="black" stroke="black" points="5729.41,-23895.21 5738.98,-23890.67 5728.67,-23888.25 5729.41,-23895.21"/>
</g>
<!-- stage2_layer0_attn_head31 -->
<g id="node374" class="node">
<title>stage2_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6303.19,-23891.72 6030.19,-23891.72 6030.19,-23839.72 6303.19,-23839.72 6303.19,-23891.72"/>
<text text-anchor="middle" x="6166.69" y="-23879.72" font-family="Times,serif" font-size="10.00">Layer 4 Head 31 Attention</text>
<text text-anchor="middle" x="6166.69" y="-23868.72" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 31)</text>
<text text-anchor="middle" x="6166.69" y="-23857.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6166.69" y="-23846.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head31 -->
<g id="edge479" class="edge">
<title>stage2_layer0_tp_qkv_comm&#45;&gt;stage2_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4161.55,-23967.73C4673.93,-23955.63 5651.97,-23928.73 6019.81,-23891.73"/>
<polygon fill="black" stroke="black" points="6020.39,-23895.19 6029.99,-23890.69 6019.68,-23888.23 6020.39,-23895.19"/>
</g>
<!-- stage2_layer0_attn_agg -->
<g id="node375" class="node">
<title>stage2_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4306.34,-23803.72 3562.41,-23803.72 3371.04,-23667.72 4114.97,-23667.72 4306.34,-23803.72"/>
<text text-anchor="middle" x="3838.69" y="-23754.52" font-family="Times,serif" font-size="14.00">Layer 4 Attention Aggregate</text>
<text text-anchor="middle" x="3838.69" y="-23739.52" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3838.69" y="-23724.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3838.69" y="-23709.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_attn_head0&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge480" class="edge">
<title>stage2_layer0_attn_head0&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1647.23,-23840.7C1650.07,-23840.35 1652.9,-23840.03 1655.69,-23839.72 2287.18,-23770.65 3026.43,-23747.87 3462.36,-23740.38"/>
<polygon fill="black" stroke="black" points="3462.67,-23743.87 3472.61,-23740.2 3462.55,-23736.87 3462.67,-23743.87"/>
</g>
<!-- stage2_layer0_attn_head1&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge481" class="edge">
<title>stage2_layer0_attn_head1&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1938.24,-23840.72C1941.08,-23840.37 1943.9,-23840.04 1946.69,-23839.72 2472.99,-23780.23 3085.69,-23754.83 3467.91,-23744.17"/>
<polygon fill="black" stroke="black" points="3468.12,-23747.66 3478.02,-23743.89 3467.93,-23740.67 3468.12,-23747.66"/>
</g>
<!-- stage2_layer0_attn_head2&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge482" class="edge">
<title>stage2_layer0_attn_head2&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2229.24,-23840.76C2232.08,-23840.4 2234.9,-23840.05 2237.69,-23839.72 2660.66,-23789.8 3149.57,-23762.76 3474.72,-23749.09"/>
<polygon fill="black" stroke="black" points="3474.93,-23752.58 3484.77,-23748.67 3474.63,-23745.59 3474.93,-23752.58"/>
</g>
<!-- stage2_layer0_attn_head3&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge483" class="edge">
<title>stage2_layer0_attn_head3&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2520.25,-23840.82C2523.08,-23840.44 2525.9,-23840.07 2528.69,-23839.72 2850.79,-23799.38 3219.56,-23772.06 3483.59,-23755.75"/>
<polygon fill="black" stroke="black" points="3483.96,-23759.24 3493.72,-23755.13 3483.53,-23752.25 3483.96,-23759.24"/>
</g>
<!-- stage2_layer0_attn_head4&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge484" class="edge">
<title>stage2_layer0_attn_head4&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2811.26,-23840.9C2814.09,-23840.5 2816.9,-23840.1 2819.69,-23839.72 3044.59,-23809.01 3298.58,-23783.31 3496.72,-23765.27"/>
<polygon fill="black" stroke="black" points="3497.07,-23768.75 3506.71,-23764.36 3496.43,-23761.78 3497.07,-23768.75"/>
</g>
<!-- stage2_layer0_attn_head5&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge485" class="edge">
<title>stage2_layer0_attn_head5&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3102.28,-23841.05C3105.11,-23840.6 3107.91,-23840.16 3110.69,-23839.72 3243.44,-23818.89 3390.12,-23797.77 3516.83,-23780.13"/>
<polygon fill="black" stroke="black" points="3517.65,-23783.55 3527.08,-23778.7 3516.69,-23776.62 3517.65,-23783.55"/>
</g>
<!-- stage2_layer0_attn_head6&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge486" class="edge">
<title>stage2_layer0_attn_head6&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3370.63,-23839.66C3421.21,-23828.54 3483.29,-23814.89 3545.5,-23801.2"/>
<polygon fill="black" stroke="black" points="3546.47,-23804.57 3555.49,-23799.01 3544.97,-23797.74 3546.47,-23804.57"/>
</g>
<!-- stage2_layer0_attn_head7&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge487" class="edge">
<title>stage2_layer0_attn_head7&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3604.83,-23839.59C3626.01,-23830.27 3651.2,-23819.19 3677.08,-23807.81"/>
<polygon fill="black" stroke="black" points="3678.51,-23811 3686.25,-23803.77 3675.69,-23804.6 3678.51,-23811"/>
</g>
<!-- stage2_layer0_attn_ellipsis&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge488" class="edge">
<title>stage2_layer0_attn_ellipsis&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3838.69,-23839.43C3838.69,-23831.84 3838.69,-23823.07 3838.69,-23813.93"/>
<polygon fill="black" stroke="black" points="3842.19,-23813.91 3838.69,-23803.91 3835.19,-23813.91 3842.19,-23813.91"/>
</g>
<!-- stage2_layer0_attn_head24&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge489" class="edge">
<title>stage2_layer0_attn_head24&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4072.54,-23839.59C4051.37,-23830.27 4026.18,-23819.19 4000.3,-23807.81"/>
<polygon fill="black" stroke="black" points="4001.69,-23804.6 3991.12,-23803.77 3998.87,-23811 4001.69,-23804.6"/>
</g>
<!-- stage2_layer0_attn_head25&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge490" class="edge">
<title>stage2_layer0_attn_head25&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4306.74,-23839.66C4262.03,-23829.83 4208.31,-23818.01 4153.45,-23805.95"/>
<polygon fill="black" stroke="black" points="4154.08,-23802.5 4143.56,-23803.77 4152.58,-23809.34 4154.08,-23802.5"/>
</g>
<!-- stage2_layer0_attn_head26&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge491" class="edge">
<title>stage2_layer0_attn_head26&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4574.93,-23841.18C4571.82,-23840.69 4568.74,-23840.2 4565.69,-23839.72 4483.61,-23826.88 4396.21,-23813.91 4311.51,-23801.69"/>
<polygon fill="black" stroke="black" points="4311.86,-23798.21 4301.46,-23800.25 4310.86,-23805.14 4311.86,-23798.21"/>
</g>
<!-- stage2_layer0_attn_head27&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge492" class="edge">
<title>stage2_layer0_attn_head27&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4865.95,-23841.02C4862.84,-23840.57 4859.75,-23840.14 4856.69,-23839.72 4666.01,-23813.78 4454.43,-23791.35 4273.77,-23774.11"/>
<polygon fill="black" stroke="black" points="4273.84,-23770.6 4263.56,-23773.13 4273.18,-23777.57 4273.84,-23770.6"/>
</g>
<!-- stage2_layer0_attn_head28&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge493" class="edge">
<title>stage2_layer0_attn_head28&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5156.97,-23840.92C5153.85,-23840.5 5150.75,-23840.1 5147.69,-23839.72 4849.68,-23802.56 4511.74,-23776.37 4253.88,-23759.7"/>
<polygon fill="black" stroke="black" points="4253.79,-23756.19 4243.59,-23759.04 4253.34,-23763.17 4253.79,-23756.19"/>
</g>
<!-- stage2_layer0_attn_head29&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge494" class="edge">
<title>stage2_layer0_attn_head29&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5447.97,-23840.86C5444.85,-23840.46 5441.75,-23840.08 5438.69,-23839.72 5032.71,-23792.03 4565.99,-23765.16 4241.82,-23750.92"/>
<polygon fill="black" stroke="black" points="4241.94,-23747.42 4231.79,-23750.48 4241.63,-23754.41 4241.94,-23747.42"/>
</g>
<!-- stage2_layer0_attn_head30&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge495" class="edge">
<title>stage2_layer0_attn_head30&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5738.98,-23840.82C5735.85,-23840.43 5732.75,-23840.07 5729.69,-23839.72 5214.76,-23781.81 4617.15,-23756.16 4233.82,-23745.01"/>
<polygon fill="black" stroke="black" points="4233.77,-23741.5 4223.67,-23744.71 4233.57,-23748.5 4233.77,-23741.5"/>
</g>
<!-- stage2_layer0_attn_head31&#45;&gt;stage2_layer0_attn_agg -->
<g id="edge496" class="edge">
<title>stage2_layer0_attn_head31&#45;&gt;stage2_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6029.98,-23840.79C6026.86,-23840.41 6023.76,-23840.06 6020.69,-23839.72 5395.76,-23771.73 4665.31,-23748.6 4227.99,-23740.75"/>
<polygon fill="black" stroke="black" points="4227.77,-23737.24 4217.71,-23740.56 4227.65,-23744.24 4227.77,-23737.24"/>
</g>
<!-- stage2_layer0_attn_out -->
<g id="node376" class="node">
<title>stage2_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="4063.69,-23631.72 3613.69,-23631.72 3613.69,-23563.72 4063.69,-23563.72 4063.69,-23631.72"/>
<text text-anchor="middle" x="3838.69" y="-23616.52" font-family="Times,serif" font-size="14.00">Layer 4 Attention Output Proj</text>
<text text-anchor="middle" x="3838.69" y="-23601.52" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP: GPU 256&#45;383)</text>
<text text-anchor="middle" x="3838.69" y="-23586.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-23571.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_attn_agg&#45;&gt;stage2_layer0_attn_out -->
<g id="edge497" class="edge">
<title>stage2_layer0_attn_agg&#45;&gt;stage2_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3838.69,-23667.52C3838.69,-23658.77 3838.69,-23650 3838.69,-23641.79"/>
<polygon fill="black" stroke="black" points="3842.19,-23641.74 3838.69,-23631.74 3835.19,-23641.74 3842.19,-23641.74"/>
</g>
<!-- stage2_layer0_tp_attn_comm -->
<g id="node377" class="node">
<title>stage2_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3838.69" cy="-23479.64" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3838.69" y="-23498.44" font-family="Times,serif" font-size="14.00">Layer 4 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3838.69" y="-23483.44" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP pairs)</text>
<text text-anchor="middle" x="3838.69" y="-23468.44" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3838.69" y="-23453.44" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_attn_out&#45;&gt;stage2_layer0_tp_attn_comm -->
<g id="edge498" class="edge">
<title>stage2_layer0_attn_out&#45;&gt;stage2_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3838.69,-23563.46C3838.69,-23555.46 3838.69,-23546.7 3838.69,-23537.95"/>
<polygon fill="black" stroke="black" points="3842.19,-23537.75 3838.69,-23527.75 3835.19,-23537.75 3842.19,-23537.75"/>
</g>
<!-- stage2_layer0_expert_router -->
<g id="node378" class="node">
<title>stage2_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3266.88,-23395.56 2544.36,-23395.56 2358.49,-23259.56 3081.02,-23259.56 3266.88,-23395.56"/>
<text text-anchor="middle" x="2812.69" y="-23346.36" font-family="Times,serif" font-size="14.00">Layer 4 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2812.69" y="-23331.36" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="2812.69" y="-23316.36" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2812.69" y="-23301.36" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage2_layer0_tp_attn_comm&#45;&gt;stage2_layer0_expert_router -->
<g id="edge499" class="edge">
<title>stage2_layer0_tp_attn_comm&#45;&gt;stage2_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3613.21,-23445.66C3513.9,-23431.13 3393.35,-23413.49 3276.27,-23396.37"/>
<polygon fill="black" stroke="black" points="3276.44,-23392.86 3266.04,-23394.87 3275.43,-23399.78 3276.44,-23392.86"/>
</g>
<!-- stage2_layer0_output -->
<g id="node441" class="node">
<title>stage2_layer0_output</title>
<polygon fill="none" stroke="black" points="4146.69,-22480.48 3696.69,-22480.48 3696.69,-22412.48 4146.69,-22412.48 4146.69,-22480.48"/>
<text text-anchor="middle" x="3921.69" y="-22465.28" font-family="Times,serif" font-size="14.00">Layer 4 Output</text>
<text text-anchor="middle" x="3921.69" y="-22450.28" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-22435.28" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-22420.28" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_tp_attn_comm&#45;&gt;stage2_layer0_output -->
<!-- stage2_layer0_expert0 -->
<g id="node379" class="node">
<title>stage2_layer0_expert0</title>
<polygon fill="none" stroke="black" points="860.69,-23223.56 538.69,-23223.56 538.69,-23171.56 860.69,-23171.56 860.69,-23223.56"/>
<text text-anchor="middle" x="699.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 0</text>
<text text-anchor="middle" x="699.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP pair)</text>
<text text-anchor="middle" x="699.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="699.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert0 -->
<g id="edge500" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2427.14,-23309.83C2051.54,-23292.44 1464.5,-23262.33 956.69,-23223.56 929,-23221.44 899.66,-23218.89 871.1,-23216.23"/>
<polygon fill="black" stroke="black" points="871.31,-23212.73 861.03,-23215.28 870.66,-23219.7 871.31,-23212.73"/>
</g>
<!-- stage2_layer0_expert1 -->
<g id="node385" class="node">
<title>stage2_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1287.69,-23223.56 965.69,-23223.56 965.69,-23171.56 1287.69,-23171.56 1287.69,-23223.56"/>
<text text-anchor="middle" x="1126.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 1</text>
<text text-anchor="middle" x="1126.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP pair)</text>
<text text-anchor="middle" x="1126.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1126.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert1 -->
<g id="edge506" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2416.27,-23301.89C2125.33,-23282.93 1720.69,-23254.75 1365.69,-23223.56 1343.79,-23221.63 1320.77,-23219.44 1298.03,-23217.17"/>
<polygon fill="black" stroke="black" points="1298.26,-23213.68 1287.96,-23216.16 1297.56,-23220.64 1298.26,-23213.68"/>
</g>
<!-- stage2_layer0_expert2 -->
<g id="node391" class="node">
<title>stage2_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1696.69,-23223.56 1374.69,-23223.56 1374.69,-23171.56 1696.69,-23171.56 1696.69,-23223.56"/>
<text text-anchor="middle" x="1535.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 2</text>
<text text-anchor="middle" x="1535.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP pair)</text>
<text text-anchor="middle" x="1535.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1535.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert2 -->
<g id="edge512" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.07,-23289.41C2199.66,-23270.84 1957.12,-23247.31 1739.69,-23223.56 1729.03,-23222.39 1718.06,-23221.16 1707,-23219.88"/>
<polygon fill="black" stroke="black" points="1707.17,-23216.38 1696.83,-23218.7 1706.36,-23223.33 1707.17,-23216.38"/>
</g>
<!-- stage2_layer0_expert3 -->
<g id="node397" class="node">
<title>stage2_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2070.69,-23223.56 1748.69,-23223.56 1748.69,-23171.56 2070.69,-23171.56 2070.69,-23223.56"/>
<text text-anchor="middle" x="1909.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 3</text>
<text text-anchor="middle" x="1909.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP pair)</text>
<text text-anchor="middle" x="1909.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1909.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert3 -->
<g id="edge518" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2362.84,-23262.79C2262.39,-23248.55 2161.82,-23234.3 2081.04,-23222.84"/>
<polygon fill="black" stroke="black" points="2081.18,-23219.33 2070.78,-23221.39 2080.19,-23226.26 2081.18,-23219.33"/>
</g>
<!-- stage2_layer0_expert31 -->
<g id="node403" class="node">
<title>stage2_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2427.69,-23223.56 2105.69,-23223.56 2105.69,-23171.56 2427.69,-23171.56 2427.69,-23223.56"/>
<text text-anchor="middle" x="2266.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 31</text>
<text text-anchor="middle" x="2266.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP pair)</text>
<text text-anchor="middle" x="2266.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2266.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert31 -->
<g id="edge524" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2526.5,-23259.46C2475.8,-23247.58 2425.72,-23235.84 2383.26,-23225.88"/>
<polygon fill="black" stroke="black" points="2384.01,-23222.46 2373.47,-23223.59 2382.41,-23229.28 2384.01,-23222.46"/>
</g>
<!-- stage2_layer0_expert32 -->
<g id="node409" class="node">
<title>stage2_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2799.69,-23223.56 2477.69,-23223.56 2477.69,-23171.56 2799.69,-23171.56 2799.69,-23223.56"/>
<text text-anchor="middle" x="2638.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 32</text>
<text text-anchor="middle" x="2638.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP pair)</text>
<text text-anchor="middle" x="2638.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2638.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert32 -->
<g id="edge530" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2721.36,-23259.37C2707.36,-23249.07 2693.51,-23238.88 2681.26,-23229.87"/>
<polygon fill="black" stroke="black" points="2683.19,-23226.95 2673.06,-23223.84 2679.04,-23232.58 2683.19,-23226.95"/>
</g>
<!-- stage2_layer0_expert60 -->
<g id="node415" class="node">
<title>stage2_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3148.69,-23223.56 2826.69,-23223.56 2826.69,-23171.56 3148.69,-23171.56 3148.69,-23223.56"/>
<text text-anchor="middle" x="2987.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 60</text>
<text text-anchor="middle" x="2987.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP pair)</text>
<text text-anchor="middle" x="2987.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2987.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert60 -->
<g id="edge536" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2904.54,-23259.37C2918.62,-23249.07 2932.55,-23238.88 2944.87,-23229.87"/>
<polygon fill="black" stroke="black" points="2947.11,-23232.57 2953.12,-23223.84 2942.98,-23226.92 2947.11,-23232.57"/>
</g>
<!-- stage2_layer0_expert61 -->
<g id="node421" class="node">
<title>stage2_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3500.69,-23223.56 3178.69,-23223.56 3178.69,-23171.56 3500.69,-23171.56 3500.69,-23223.56"/>
<text text-anchor="middle" x="3339.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 61</text>
<text text-anchor="middle" x="3339.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP pair)</text>
<text text-anchor="middle" x="3339.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3339.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert61 -->
<g id="edge542" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3083.14,-23260.87C3133.9,-23248.54 3184.31,-23236.29 3226.84,-23225.96"/>
<polygon fill="black" stroke="black" points="3227.74,-23229.35 3236.63,-23223.59 3226.09,-23222.54 3227.74,-23229.35"/>
</g>
<!-- stage2_layer0_expert62 -->
<g id="node427" class="node">
<title>stage2_layer0_expert62</title>
<polygon fill="none" stroke="black" points="3874.69,-23223.56 3552.69,-23223.56 3552.69,-23171.56 3874.69,-23171.56 3874.69,-23223.56"/>
<text text-anchor="middle" x="3713.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 62</text>
<text text-anchor="middle" x="3713.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP pair)</text>
<text text-anchor="middle" x="3713.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3713.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert62 -->
<g id="edge548" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3114.27,-23283.71C3256.81,-23263.46 3421.75,-23240.03 3542.49,-23222.88"/>
<polygon fill="black" stroke="black" points="3543.16,-23226.32 3552.57,-23221.44 3542.17,-23219.39 3543.16,-23226.32"/>
</g>
<!-- stage2_layer0_expert63 -->
<g id="node433" class="node">
<title>stage2_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4281.69,-23223.56 3959.69,-23223.56 3959.69,-23171.56 4281.69,-23171.56 4281.69,-23223.56"/>
<text text-anchor="middle" x="4120.69" y="-23211.56" font-family="Times,serif" font-size="10.00">Layer 4 Expert 63</text>
<text text-anchor="middle" x="4120.69" y="-23200.56" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP pair)</text>
<text text-anchor="middle" x="4120.69" y="-23189.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4120.69" y="-23178.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert63 -->
<g id="edge554" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3131.73,-23296.65C3344.72,-23276.49 3631.04,-23249.03 3883.69,-23223.56 3904.93,-23221.41 3927.23,-23219.12 3949.31,-23216.82"/>
<polygon fill="black" stroke="black" points="3949.85,-23220.28 3959.44,-23215.77 3949.13,-23213.32 3949.85,-23220.28"/>
</g>
<!-- stage2_layer0_expert_ellipsis -->
<g id="node439" class="node">
<title>stage2_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4726.69,-23135.56 4404.69,-23135.56 4404.69,-23083.56 4726.69,-23083.56 4726.69,-23135.56"/>
<text text-anchor="middle" x="4565.69" y="-23123.56" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4565.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4565.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4565.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert_ellipsis -->
<g id="edge560" class="edge">
<title>stage2_layer0_expert_router&#45;&gt;stage2_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3157.27,-23315.26C3525.17,-23300.94 4083.2,-23272.08 4290.69,-23223.56 4369.32,-23205.17 4454.55,-23167.05 4508.95,-23140.19"/>
<polygon fill="black" stroke="black" points="4510.68,-23143.23 4518.07,-23135.64 4507.56,-23136.97 4510.68,-23143.23"/>
</g>
<!-- stage2_layer0_expert0_mlp1 -->
<g id="node380" class="node">
<title>stage2_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="706.69,-23135.56 392.69,-23135.56 392.69,-23083.56 706.69,-23083.56 706.69,-23135.56"/>
<text text-anchor="middle" x="549.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="549.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP: Column Parallel)</text>
<text text-anchor="middle" x="549.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="549.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert0&#45;&gt;stage2_layer0_expert0_mlp1 -->
<g id="edge501" class="edge">
<title>stage2_layer0_expert0&#45;&gt;stage2_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M655.9,-23171.45C639.18,-23161.87 619.95,-23150.84 602.48,-23140.82"/>
<polygon fill="black" stroke="black" points="603.95,-23137.63 593.53,-23135.69 600.47,-23143.7 603.95,-23137.63"/>
</g>
<!-- stage2_layer0_expert0_tp1 -->
<g id="node381" class="node">
<title>stage2_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="474.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="474.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="474.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="474.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="474.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert0_mlp1&#45;&gt;stage2_layer0_expert0_tp1 -->
<g id="edge502" class="edge">
<title>stage2_layer0_expert0_mlp1&#45;&gt;stage2_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M530.18,-23083.38C523.53,-23074.81 515.9,-23064.96 508.46,-23055.36"/>
<polygon fill="black" stroke="black" points="511.18,-23053.16 502.29,-23047.4 505.65,-23057.44 511.18,-23053.16"/>
</g>
<!-- stage2_layer0_expert0_act -->
<g id="node382" class="node">
<title>stage2_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="595.19,-22938.02 314.19,-22938.02 314.19,-22886.02 595.19,-22886.02 595.19,-22938.02"/>
<text text-anchor="middle" x="454.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="454.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="454.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="454.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert0_tp1&#45;&gt;stage2_layer0_expert0_act -->
<g id="edge503" class="edge">
<title>stage2_layer0_expert0_tp1&#45;&gt;stage2_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M467.3,-22974.03C465.54,-22965.53 463.67,-22956.47 461.92,-22948.01"/>
<polygon fill="black" stroke="black" points="465.32,-22947.14 459.86,-22938.06 458.46,-22948.56 465.32,-22947.14"/>
</g>
<!-- stage2_layer0_expert0_mlp2 -->
<g id="node383" class="node">
<title>stage2_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="455.69,-22850.02 133.69,-22850.02 133.69,-22798.02 455.69,-22798.02 455.69,-22850.02"/>
<text text-anchor="middle" x="294.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="294.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP: Row Parallel)</text>
<text text-anchor="middle" x="294.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="294.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert0_act&#45;&gt;stage2_layer0_expert0_mlp2 -->
<g id="edge504" class="edge">
<title>stage2_layer0_expert0_act&#45;&gt;stage2_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M407.98,-22885.91C389.99,-22876.24 369.26,-22865.1 350.49,-22855.01"/>
<polygon fill="black" stroke="black" points="351.92,-22851.8 341.46,-22850.15 348.61,-22857.97 351.92,-22851.8"/>
</g>
<!-- stage2_layer0_expert0_tp2 -->
<g id="node384" class="node">
<title>stage2_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="227.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="227.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="227.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="227.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="227.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert0_mlp2&#45;&gt;stage2_layer0_expert0_tp2 -->
<g id="edge505" class="edge">
<title>stage2_layer0_expert0_mlp2&#45;&gt;stage2_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M277.26,-22797.84C271.38,-22789.35 264.64,-22779.62 258.06,-22770.11"/>
<polygon fill="black" stroke="black" points="260.91,-22768.09 252.34,-22761.86 255.16,-22772.07 260.91,-22768.09"/>
</g>
<!-- stage2_layer0_expert_agg -->
<g id="node440" class="node">
<title>stage2_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3379.22,-22652.48 2503.45,-22652.48 2278.16,-22516.48 3153.93,-22516.48 3379.22,-22652.48"/>
<text text-anchor="middle" x="2828.69" y="-22603.28" font-family="Times,serif" font-size="14.00">Layer 4 Expert Aggregation</text>
<text text-anchor="middle" x="2828.69" y="-22588.28" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="2828.69" y="-22573.28" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2828.69" y="-22558.28" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert0_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge561" class="edge">
<title>stage2_layer0_expert0_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M382.9,-22698.31C409.78,-22694.51 437.5,-22691.02 463.69,-22688.48 1133.84,-22623.29 1914.85,-22599.35 2390.36,-22590.57"/>
<polygon fill="black" stroke="black" points="2390.55,-22594.06 2400.48,-22590.38 2390.42,-22587.06 2390.55,-22594.06"/>
</g>
<!-- stage2_layer0_expert1_mlp1 -->
<g id="node386" class="node">
<title>stage2_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1172.69,-23135.56 858.69,-23135.56 858.69,-23083.56 1172.69,-23083.56 1172.69,-23135.56"/>
<text text-anchor="middle" x="1015.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1015.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1015.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1015.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert1&#45;&gt;stage2_layer0_expert1_mlp1 -->
<g id="edge507" class="edge">
<title>stage2_layer0_expert1&#45;&gt;stage2_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1094.28,-23171.45C1082.42,-23162.26 1068.84,-23151.74 1056.35,-23142.06"/>
<polygon fill="black" stroke="black" points="1058.37,-23139.2 1048.33,-23135.84 1054.09,-23144.73 1058.37,-23139.2"/>
</g>
<!-- stage2_layer0_expert1_tp1 -->
<g id="node387" class="node">
<title>stage2_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="923.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="923.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="923.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="923.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="923.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert1_mlp1&#45;&gt;stage2_layer0_expert1_tp1 -->
<g id="edge508" class="edge">
<title>stage2_layer0_expert1_mlp1&#45;&gt;stage2_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M991.76,-23083.38C983.36,-23074.55 973.67,-23064.36 964.29,-23054.49"/>
<polygon fill="black" stroke="black" points="966.62,-23051.87 957.2,-23047.03 961.55,-23056.69 966.62,-23051.87"/>
</g>
<!-- stage2_layer0_expert1_act -->
<g id="node388" class="node">
<title>stage2_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="909.19,-22938.02 628.19,-22938.02 628.19,-22886.02 909.19,-22886.02 909.19,-22938.02"/>
<text text-anchor="middle" x="768.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="768.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="768.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="768.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert1_tp1&#45;&gt;stage2_layer0_expert1_act -->
<g id="edge509" class="edge">
<title>stage2_layer0_expert1_tp1&#45;&gt;stage2_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M868.6,-22975.4C852.01,-22965.04 833.92,-22953.74 817.75,-22943.64"/>
<polygon fill="black" stroke="black" points="819.32,-22940.5 808.98,-22938.17 815.61,-22946.44 819.32,-22940.5"/>
</g>
<!-- stage2_layer0_expert1_mlp2 -->
<g id="node389" class="node">
<title>stage2_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="928.69,-22850.02 606.69,-22850.02 606.69,-22798.02 928.69,-22798.02 928.69,-22850.02"/>
<text text-anchor="middle" x="767.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="767.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP: Row Parallel)</text>
<text text-anchor="middle" x="767.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="767.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert1_act&#45;&gt;stage2_layer0_expert1_mlp2 -->
<g id="edge510" class="edge">
<title>stage2_layer0_expert1_act&#45;&gt;stage2_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M768.39,-22885.68C768.3,-22877.72 768.2,-22868.78 768.1,-22860.26"/>
<polygon fill="black" stroke="black" points="771.6,-22860.13 767.98,-22850.17 764.6,-22860.21 771.6,-22860.13"/>
</g>
<!-- stage2_layer0_expert1_tp2 -->
<g id="node390" class="node">
<title>stage2_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="700.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="700.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="700.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="700.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="700.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert1_mlp2&#45;&gt;stage2_layer0_expert1_tp2 -->
<g id="edge511" class="edge">
<title>stage2_layer0_expert1_mlp2&#45;&gt;stage2_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M750.26,-22797.84C744.38,-22789.35 737.64,-22779.62 731.06,-22770.11"/>
<polygon fill="black" stroke="black" points="733.91,-22768.09 725.34,-22761.86 728.16,-22772.07 733.91,-22768.09"/>
</g>
<!-- stage2_layer0_expert1_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge562" class="edge">
<title>stage2_layer0_expert1_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M856.88,-22698.42C883.46,-22694.64 910.82,-22691.14 936.69,-22688.48 1437.82,-22636.98 2016.45,-22610.24 2400.53,-22597.06"/>
<polygon fill="black" stroke="black" points="2400.82,-22600.55 2410.7,-22596.71 2400.59,-22593.55 2400.82,-22600.55"/>
</g>
<!-- stage2_layer0_expert2_mlp1 -->
<g id="node392" class="node">
<title>stage2_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1554.69,-23135.56 1240.69,-23135.56 1240.69,-23083.56 1554.69,-23083.56 1554.69,-23135.56"/>
<text text-anchor="middle" x="1397.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1397.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1397.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1397.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert2&#45;&gt;stage2_layer0_expert2_mlp1 -->
<g id="edge513" class="edge">
<title>stage2_layer0_expert2&#45;&gt;stage2_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1495.4,-23171.45C1480.23,-23162 1462.81,-23151.14 1446.91,-23141.23"/>
<polygon fill="black" stroke="black" points="1448.6,-23138.16 1438.26,-23135.84 1444.9,-23144.1 1448.6,-23138.16"/>
</g>
<!-- stage2_layer0_expert2_tp1 -->
<g id="node393" class="node">
<title>stage2_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1355.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1355.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1355.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="1355.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1355.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert2_mlp1&#45;&gt;stage2_layer0_expert2_tp1 -->
<g id="edge514" class="edge">
<title>stage2_layer0_expert2_mlp1&#45;&gt;stage2_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1386.76,-23083.38C1383.26,-23075.32 1379.27,-23066.13 1375.35,-23057.08"/>
<polygon fill="black" stroke="black" points="1378.49,-23055.54 1371.3,-23047.76 1372.07,-23058.33 1378.49,-23055.54"/>
</g>
<!-- stage2_layer0_expert2_act -->
<g id="node394" class="node">
<title>stage2_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1401.19,-22938.02 1120.19,-22938.02 1120.19,-22886.02 1401.19,-22886.02 1401.19,-22938.02"/>
<text text-anchor="middle" x="1260.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1260.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="1260.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1260.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert2_tp1&#45;&gt;stage2_layer0_expert2_act -->
<g id="edge515" class="edge">
<title>stage2_layer0_expert2_tp1&#45;&gt;stage2_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1321.12,-22974.58C1311.75,-22965.02 1301.64,-22954.73 1292.43,-22945.35"/>
<polygon fill="black" stroke="black" points="1294.76,-22942.73 1285.26,-22938.05 1289.77,-22947.63 1294.76,-22942.73"/>
</g>
<!-- stage2_layer0_expert2_mlp2 -->
<g id="node395" class="node">
<title>stage2_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1334.69,-22850.02 1012.69,-22850.02 1012.69,-22798.02 1334.69,-22798.02 1334.69,-22850.02"/>
<text text-anchor="middle" x="1173.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1173.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1173.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1173.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert2_act&#45;&gt;stage2_layer0_expert2_mlp2 -->
<g id="edge516" class="edge">
<title>stage2_layer0_expert2_act&#45;&gt;stage2_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1235.06,-22885.68C1226.12,-22876.84 1215.96,-22866.8 1206.52,-22857.47"/>
<polygon fill="black" stroke="black" points="1208.71,-22854.71 1199.14,-22850.17 1203.79,-22859.69 1208.71,-22854.71"/>
</g>
<!-- stage2_layer0_expert2_tp2 -->
<g id="node396" class="node">
<title>stage2_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1173.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1173.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1173.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="1173.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1173.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert2_mlp2&#45;&gt;stage2_layer0_expert2_tp2 -->
<g id="edge517" class="edge">
<title>stage2_layer0_expert2_mlp2&#45;&gt;stage2_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1173.69,-22797.84C1173.69,-22790.04 1173.69,-22781.17 1173.69,-22772.4"/>
<polygon fill="black" stroke="black" points="1177.19,-22772.22 1173.69,-22762.22 1170.19,-22772.22 1177.19,-22772.22"/>
</g>
<!-- stage2_layer0_expert2_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge563" class="edge">
<title>stage2_layer0_expert2_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1331.19,-22698.63C1357.36,-22694.88 1384.26,-22691.32 1409.69,-22688.48 1747.8,-22650.64 2132.87,-22623.7 2416.48,-22606.89"/>
<polygon fill="black" stroke="black" points="2416.75,-22610.38 2426.53,-22606.29 2416.34,-22603.39 2416.75,-22610.38"/>
</g>
<!-- stage2_layer0_expert3_mlp1 -->
<g id="node398" class="node">
<title>stage2_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2027.69,-23135.56 1713.69,-23135.56 1713.69,-23083.56 2027.69,-23083.56 2027.69,-23135.56"/>
<text text-anchor="middle" x="1870.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="1870.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1870.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1870.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert3&#45;&gt;stage2_layer0_expert3_mlp1 -->
<g id="edge519" class="edge">
<title>stage2_layer0_expert3&#45;&gt;stage2_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M1898.2,-23171.22C1894.47,-23162.99 1890.27,-23153.73 1886.29,-23144.96"/>
<polygon fill="black" stroke="black" points="1889.41,-23143.37 1882.1,-23135.71 1883.04,-23146.26 1889.41,-23143.37"/>
</g>
<!-- stage2_layer0_expert3_tp1 -->
<g id="node399" class="node">
<title>stage2_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1778.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1778.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1778.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="1778.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1778.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert3_mlp1&#45;&gt;stage2_layer0_expert3_tp1 -->
<g id="edge520" class="edge">
<title>stage2_layer0_expert3_mlp1&#45;&gt;stage2_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1846.76,-23083.38C1838.36,-23074.55 1828.67,-23064.36 1819.29,-23054.49"/>
<polygon fill="black" stroke="black" points="1821.62,-23051.87 1812.2,-23047.03 1816.55,-23056.69 1821.62,-23051.87"/>
</g>
<!-- stage2_layer0_expert3_act -->
<g id="node400" class="node">
<title>stage2_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1886.19,-22938.02 1605.19,-22938.02 1605.19,-22886.02 1886.19,-22886.02 1886.19,-22938.02"/>
<text text-anchor="middle" x="1745.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1745.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="1745.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1745.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert3_tp1&#45;&gt;stage2_layer0_expert3_act -->
<g id="edge521" class="edge">
<title>stage2_layer0_expert3_tp1&#45;&gt;stage2_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1766.49,-22974.03C1763.56,-22965.44 1760.44,-22956.27 1757.53,-22947.73"/>
<polygon fill="black" stroke="black" points="1760.77,-22946.39 1754.23,-22938.06 1754.14,-22948.65 1760.77,-22946.39"/>
</g>
<!-- stage2_layer0_expert3_mlp2 -->
<g id="node401" class="node">
<title>stage2_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1873.69,-22850.02 1551.69,-22850.02 1551.69,-22798.02 1873.69,-22798.02 1873.69,-22850.02"/>
<text text-anchor="middle" x="1712.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1712.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1712.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1712.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert3_act&#45;&gt;stage2_layer0_expert3_mlp2 -->
<g id="edge522" class="edge">
<title>stage2_layer0_expert3_act&#45;&gt;stage2_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1735.97,-22885.68C1732.84,-22877.54 1729.33,-22868.39 1726,-22859.7"/>
<polygon fill="black" stroke="black" points="1729.19,-22858.26 1722.34,-22850.17 1722.66,-22860.76 1729.19,-22858.26"/>
</g>
<!-- stage2_layer0_expert3_tp2 -->
<g id="node402" class="node">
<title>stage2_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1646.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1646.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1646.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="1646.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1646.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert3_mlp2&#45;&gt;stage2_layer0_expert3_tp2 -->
<g id="edge523" class="edge">
<title>stage2_layer0_expert3_mlp2&#45;&gt;stage2_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1695.52,-22797.84C1689.79,-22789.44 1683.22,-22779.81 1676.8,-22770.4"/>
<polygon fill="black" stroke="black" points="1679.5,-22768.15 1670.98,-22761.86 1673.72,-22772.09 1679.5,-22768.15"/>
</g>
<!-- stage2_layer0_expert3_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge564" class="edge">
<title>stage2_layer0_expert3_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1806.83,-22699.05C1832.19,-22695.33 1858.14,-22691.67 1882.69,-22688.48 2067,-22664.49 2272.01,-22641.69 2443.94,-22623.67"/>
<polygon fill="black" stroke="black" points="2444.33,-22627.15 2453.91,-22622.63 2443.6,-22620.19 2444.33,-22627.15"/>
</g>
<!-- stage2_layer0_expert31_mlp1 -->
<g id="node404" class="node">
<title>stage2_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2391.69,-23135.56 2077.69,-23135.56 2077.69,-23083.56 2391.69,-23083.56 2391.69,-23135.56"/>
<text text-anchor="middle" x="2234.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2234.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2234.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2234.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert31&#45;&gt;stage2_layer0_expert31_mlp1 -->
<g id="edge525" class="edge">
<title>stage2_layer0_expert31&#45;&gt;stage2_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2257.26,-23171.22C2254.23,-23163.08 2250.83,-23153.93 2247.59,-23145.24"/>
<polygon fill="black" stroke="black" points="2250.82,-23143.86 2244.05,-23135.71 2244.26,-23146.3 2250.82,-23143.86"/>
</g>
<!-- stage2_layer0_expert31_tp1 -->
<g id="node405" class="node">
<title>stage2_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2197.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2197.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2197.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="2197.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2197.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert31_mlp1&#45;&gt;stage2_layer0_expert31_tp1 -->
<g id="edge526" class="edge">
<title>stage2_layer0_expert31_mlp1&#45;&gt;stage2_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2225.06,-23083.38C2222.01,-23075.4 2218.54,-23066.32 2215.12,-23057.37"/>
<polygon fill="black" stroke="black" points="2218.28,-23055.85 2211.44,-23047.76 2211.75,-23058.35 2218.28,-23055.85"/>
</g>
<!-- stage2_layer0_expert31_act -->
<g id="node406" class="node">
<title>stage2_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2318.19,-22938.02 2037.19,-22938.02 2037.19,-22886.02 2318.19,-22886.02 2318.19,-22938.02"/>
<text text-anchor="middle" x="2177.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2177.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="2177.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2177.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert31_tp1&#45;&gt;stage2_layer0_expert31_act -->
<g id="edge527" class="edge">
<title>stage2_layer0_expert31_tp1&#45;&gt;stage2_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2190.3,-22974.03C2188.54,-22965.53 2186.67,-22956.47 2184.92,-22948.01"/>
<polygon fill="black" stroke="black" points="2188.32,-22947.14 2182.86,-22938.06 2181.46,-22948.56 2188.32,-22947.14"/>
</g>
<!-- stage2_layer0_expert31_mlp2 -->
<g id="node407" class="node">
<title>stage2_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2319.69,-22850.02 1997.69,-22850.02 1997.69,-22798.02 2319.69,-22798.02 2319.69,-22850.02"/>
<text text-anchor="middle" x="2158.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2158.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2158.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2158.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert31_act&#45;&gt;stage2_layer0_expert31_mlp2 -->
<g id="edge528" class="edge">
<title>stage2_layer0_expert31_act&#45;&gt;stage2_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2172.09,-22885.68C2170.31,-22877.63 2168.31,-22868.58 2166.41,-22859.98"/>
<polygon fill="black" stroke="black" points="2169.82,-22859.18 2164.25,-22850.17 2162.99,-22860.69 2169.82,-22859.18"/>
</g>
<!-- stage2_layer0_expert31_tp2 -->
<g id="node408" class="node">
<title>stage2_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2119.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2119.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2119.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="2119.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2119.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert31_mlp2&#45;&gt;stage2_layer0_expert31_tp2 -->
<g id="edge529" class="edge">
<title>stage2_layer0_expert31_mlp2&#45;&gt;stage2_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2148.54,-22797.84C2145.29,-22789.78 2141.59,-22780.59 2137.94,-22771.54"/>
<polygon fill="black" stroke="black" points="2141.17,-22770.19 2134.19,-22762.22 2134.68,-22772.81 2141.17,-22770.19"/>
</g>
<!-- stage2_layer0_expert31_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge565" class="edge">
<title>stage2_layer0_expert31_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2261.89,-22696.41C2327.6,-22683.55 2408.71,-22667.68 2488.83,-22652"/>
<polygon fill="black" stroke="black" points="2489.96,-22655.34 2499.1,-22649.99 2488.61,-22648.47 2489.96,-22655.34"/>
</g>
<!-- stage2_layer0_expert32_mlp1 -->
<g id="node410" class="node">
<title>stage2_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2776.69,-23135.56 2462.69,-23135.56 2462.69,-23083.56 2776.69,-23083.56 2776.69,-23135.56"/>
<text text-anchor="middle" x="2619.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2619.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2619.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2619.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert32&#45;&gt;stage2_layer0_expert32_mlp1 -->
<g id="edge531" class="edge">
<title>stage2_layer0_expert32&#45;&gt;stage2_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2633.09,-23171.22C2631.31,-23163.17 2629.31,-23154.12 2627.41,-23145.52"/>
<polygon fill="black" stroke="black" points="2630.82,-23144.72 2625.25,-23135.71 2623.99,-23146.23 2630.82,-23144.72"/>
</g>
<!-- stage2_layer0_expert32_tp1 -->
<g id="node411" class="node">
<title>stage2_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2614.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2614.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2614.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="2614.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2614.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert32_mlp1&#45;&gt;stage2_layer0_expert32_tp1 -->
<g id="edge532" class="edge">
<title>stage2_layer0_expert32_mlp1&#45;&gt;stage2_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2618.39,-23083.38C2617.98,-23075.57 2617.53,-23066.71 2617.07,-23057.94"/>
<polygon fill="black" stroke="black" points="2620.56,-23057.57 2616.55,-23047.76 2613.57,-23057.93 2620.56,-23057.57"/>
</g>
<!-- stage2_layer0_expert32_act -->
<g id="node412" class="node">
<title>stage2_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2749.19,-22938.02 2468.19,-22938.02 2468.19,-22886.02 2749.19,-22886.02 2749.19,-22938.02"/>
<text text-anchor="middle" x="2608.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2608.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="2608.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2608.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert32_tp1&#45;&gt;stage2_layer0_expert32_act -->
<g id="edge533" class="edge">
<title>stage2_layer0_expert32_tp1&#45;&gt;stage2_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2612.45,-22973.75C2611.94,-22965.44 2611.39,-22956.61 2610.88,-22948.33"/>
<polygon fill="black" stroke="black" points="2614.36,-22947.98 2610.25,-22938.21 2607.38,-22948.41 2614.36,-22947.98"/>
</g>
<!-- stage2_layer0_expert32_mlp2 -->
<g id="node413" class="node">
<title>stage2_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2764.69,-22850.02 2442.69,-22850.02 2442.69,-22798.02 2764.69,-22798.02 2764.69,-22850.02"/>
<text text-anchor="middle" x="2603.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2603.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2603.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2603.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert32_act&#45;&gt;stage2_layer0_expert32_mlp2 -->
<g id="edge534" class="edge">
<title>stage2_layer0_expert32_act&#45;&gt;stage2_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2607.22,-22885.68C2606.75,-22877.72 2606.23,-22868.78 2605.74,-22860.26"/>
<polygon fill="black" stroke="black" points="2609.23,-22859.95 2605.15,-22850.17 2602.24,-22860.36 2609.23,-22859.95"/>
</g>
<!-- stage2_layer0_expert32_tp2 -->
<g id="node414" class="node">
<title>stage2_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2592.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2592.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2592.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="2592.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2592.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert32_mlp2&#45;&gt;stage2_layer0_expert32_tp2 -->
<g id="edge535" class="edge">
<title>stage2_layer0_expert32_mlp2&#45;&gt;stage2_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2600.83,-22797.84C2599.94,-22790.04 2598.93,-22781.17 2597.93,-22772.4"/>
<polygon fill="black" stroke="black" points="2601.39,-22771.76 2596.78,-22762.22 2594.43,-22772.55 2601.39,-22771.76"/>
</g>
<!-- stage2_layer0_expert32_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge566" class="edge">
<title>stage2_layer0_expert32_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2651.63,-22689.59C2668.21,-22679.84 2686.88,-22668.86 2705.72,-22657.79"/>
<polygon fill="black" stroke="black" points="2707.53,-22660.78 2714.38,-22652.69 2703.98,-22654.74 2707.53,-22660.78"/>
</g>
<!-- stage2_layer0_expert60_mlp1 -->
<g id="node416" class="node">
<title>stage2_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3149.69,-23135.56 2835.69,-23135.56 2835.69,-23083.56 3149.69,-23083.56 3149.69,-23135.56"/>
<text text-anchor="middle" x="2992.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="2992.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2992.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2992.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert60&#45;&gt;stage2_layer0_expert60_mlp1 -->
<g id="edge537" class="edge">
<title>stage2_layer0_expert60&#45;&gt;stage2_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M2989.16,-23171.22C2989.62,-23163.26 2990.14,-23154.32 2990.64,-23145.8"/>
<polygon fill="black" stroke="black" points="2994.14,-23145.9 2991.23,-23135.71 2987.15,-23145.49 2994.14,-23145.9"/>
</g>
<!-- stage2_layer0_expert60_tp1 -->
<g id="node417" class="node">
<title>stage2_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3030.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3030.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3030.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="3030.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3030.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert60_mlp1&#45;&gt;stage2_layer0_expert60_tp1 -->
<g id="edge538" class="edge">
<title>stage2_layer0_expert60_mlp1&#45;&gt;stage2_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3002.57,-23083.38C3005.74,-23075.32 3009.35,-23066.13 3012.9,-23057.08"/>
<polygon fill="black" stroke="black" points="3016.16,-23058.35 3016.56,-23047.76 3009.65,-23055.79 3016.16,-23058.35"/>
</g>
<!-- stage2_layer0_expert60_act -->
<g id="node418" class="node">
<title>stage2_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3172.19,-22938.02 2891.19,-22938.02 2891.19,-22886.02 3172.19,-22886.02 3172.19,-22938.02"/>
<text text-anchor="middle" x="3031.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3031.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="3031.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3031.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert60_tp1&#45;&gt;stage2_layer0_expert60_act -->
<g id="edge539" class="edge">
<title>stage2_layer0_expert60_tp1&#45;&gt;stage2_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3031.06,-22973.75C3031.15,-22965.44 3031.24,-22956.61 3031.32,-22948.33"/>
<polygon fill="black" stroke="black" points="3034.82,-22948.25 3031.43,-22938.21 3027.82,-22948.18 3034.82,-22948.25"/>
</g>
<!-- stage2_layer0_expert60_mlp2 -->
<g id="node419" class="node">
<title>stage2_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3216.69,-22850.02 2894.69,-22850.02 2894.69,-22798.02 3216.69,-22798.02 3216.69,-22850.02"/>
<text text-anchor="middle" x="3055.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3055.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3055.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3055.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert60_act&#45;&gt;stage2_layer0_expert60_mlp2 -->
<g id="edge540" class="edge">
<title>stage2_layer0_expert60_act&#45;&gt;stage2_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3038.76,-22885.68C3041.01,-22877.63 3043.53,-22868.58 3045.93,-22859.98"/>
<polygon fill="black" stroke="black" points="3049.35,-22860.75 3048.67,-22850.17 3042.61,-22858.86 3049.35,-22860.75"/>
</g>
<!-- stage2_layer0_expert60_tp2 -->
<g id="node420" class="node">
<title>stage2_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3065.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3065.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3065.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="3065.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3065.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert60_mlp2&#45;&gt;stage2_layer0_expert60_tp2 -->
<g id="edge541" class="edge">
<title>stage2_layer0_expert60_mlp2&#45;&gt;stage2_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3058.29,-22797.84C3059.1,-22790.04 3060.01,-22781.17 3060.92,-22772.4"/>
<polygon fill="black" stroke="black" points="3064.42,-22772.53 3061.97,-22762.22 3057.46,-22771.81 3064.42,-22772.53"/>
</g>
<!-- stage2_layer0_expert60_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge567" class="edge">
<title>stage2_layer0_expert60_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3006.49,-22689.59C2989.85,-22679.84 2971.1,-22668.86 2952.18,-22657.79"/>
<polygon fill="black" stroke="black" points="2953.88,-22654.73 2943.48,-22652.69 2950.35,-22660.77 2953.88,-22654.73"/>
</g>
<!-- stage2_layer0_expert61_mlp1 -->
<g id="node422" class="node">
<title>stage2_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3559.69,-23135.56 3245.69,-23135.56 3245.69,-23083.56 3559.69,-23083.56 3559.69,-23135.56"/>
<text text-anchor="middle" x="3402.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3402.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3402.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3402.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert61&#45;&gt;stage2_layer0_expert61_mlp1 -->
<g id="edge543" class="edge">
<title>stage2_layer0_expert61&#45;&gt;stage2_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3358.25,-23171.22C3364.53,-23162.64 3371.64,-23152.94 3378.3,-23143.84"/>
<polygon fill="black" stroke="black" points="3381.17,-23145.85 3384.26,-23135.71 3375.53,-23141.71 3381.17,-23145.85"/>
</g>
<!-- stage2_layer0_expert61_tp1 -->
<g id="node423" class="node">
<title>stage2_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3459.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3459.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3459.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="3459.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3459.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert61_mlp1&#45;&gt;stage2_layer0_expert61_tp1 -->
<g id="edge544" class="edge">
<title>stage2_layer0_expert61_mlp1&#45;&gt;stage2_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3417.52,-23083.38C3422.42,-23075.07 3428.02,-23065.55 3433.51,-23056.23"/>
<polygon fill="black" stroke="black" points="3436.65,-23057.79 3438.71,-23047.4 3430.62,-23054.24 3436.65,-23057.79"/>
</g>
<!-- stage2_layer0_expert61_act -->
<g id="node424" class="node">
<title>stage2_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3616.19,-22938.02 3335.19,-22938.02 3335.19,-22886.02 3616.19,-22886.02 3616.19,-22938.02"/>
<text text-anchor="middle" x="3475.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3475.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="3475.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3475.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert61_tp1&#45;&gt;stage2_layer0_expert61_act -->
<g id="edge545" class="edge">
<title>stage2_layer0_expert61_tp1&#45;&gt;stage2_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3465.6,-22974.03C3467.01,-22965.53 3468.5,-22956.47 3469.9,-22948.01"/>
<polygon fill="black" stroke="black" points="3473.37,-22948.5 3471.55,-22938.06 3466.46,-22947.35 3473.37,-22948.5"/>
</g>
<!-- stage2_layer0_expert61_mlp2 -->
<g id="node425" class="node">
<title>stage2_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3665.69,-22850.02 3343.69,-22850.02 3343.69,-22798.02 3665.69,-22798.02 3665.69,-22850.02"/>
<text text-anchor="middle" x="3504.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3504.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3504.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3504.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert61_act&#45;&gt;stage2_layer0_expert61_mlp2 -->
<g id="edge546" class="edge">
<title>stage2_layer0_expert61_act&#45;&gt;stage2_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3484.23,-22885.68C3486.98,-22877.54 3490.06,-22868.39 3492.99,-22859.7"/>
<polygon fill="black" stroke="black" points="3496.33,-22860.77 3496.21,-22850.17 3489.69,-22858.53 3496.33,-22860.77"/>
</g>
<!-- stage2_layer0_expert61_tp2 -->
<g id="node426" class="node">
<title>stage2_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3538.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3538.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3538.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="3538.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3538.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert61_mlp2&#45;&gt;stage2_layer0_expert61_tp2 -->
<g id="edge547" class="edge">
<title>stage2_layer0_expert61_mlp2&#45;&gt;stage2_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3513.53,-22797.84C3516.34,-22789.87 3519.53,-22780.78 3522.67,-22771.83"/>
<polygon fill="black" stroke="black" points="3526.04,-22772.82 3526.05,-22762.22 3519.43,-22770.5 3526.04,-22772.82"/>
</g>
<!-- stage2_layer0_expert61_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge568" class="edge">
<title>stage2_layer0_expert61_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3396.72,-22696.5C3334.36,-22684.31 3258.09,-22669.4 3181.93,-22654.52"/>
<polygon fill="black" stroke="black" points="3182.16,-22651 3171.68,-22652.51 3180.82,-22657.87 3182.16,-22651"/>
</g>
<!-- stage2_layer0_expert62_mlp1 -->
<g id="node428" class="node">
<title>stage2_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="3910.69,-23135.56 3596.69,-23135.56 3596.69,-23083.56 3910.69,-23083.56 3910.69,-23135.56"/>
<text text-anchor="middle" x="3753.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3753.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3753.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3753.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert62&#45;&gt;stage2_layer0_expert62_mlp1 -->
<g id="edge549" class="edge">
<title>stage2_layer0_expert62&#45;&gt;stage2_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3725.47,-23171.22C3729.3,-23162.99 3733.61,-23153.73 3737.69,-23144.96"/>
<polygon fill="black" stroke="black" points="3740.94,-23146.26 3741.99,-23135.71 3734.6,-23143.3 3740.94,-23146.26"/>
</g>
<!-- stage2_layer0_expert62_tp1 -->
<g id="node429" class="node">
<title>stage2_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="3909.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3909.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="3909.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="3909.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3909.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert62_mlp1&#45;&gt;stage2_layer0_expert62_tp1 -->
<g id="edge550" class="edge">
<title>stage2_layer0_expert62_mlp1&#45;&gt;stage2_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3794.27,-23083.38C3809.87,-23073.7 3828.1,-23062.4 3845.4,-23051.67"/>
<polygon fill="black" stroke="black" points="3847.68,-23054.37 3854.34,-23046.12 3843.99,-23048.42 3847.68,-23054.37"/>
</g>
<!-- stage2_layer0_expert62_act -->
<g id="node430" class="node">
<title>stage2_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4072.19,-22938.02 3791.19,-22938.02 3791.19,-22886.02 4072.19,-22886.02 4072.19,-22938.02"/>
<text text-anchor="middle" x="3931.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="3931.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="3931.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3931.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert62_tp1&#45;&gt;stage2_layer0_expert62_act -->
<g id="edge551" class="edge">
<title>stage2_layer0_expert62_tp1&#45;&gt;stage2_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M3917.82,-22974.03C3919.75,-22965.53 3921.81,-22956.47 3923.73,-22948.01"/>
<polygon fill="black" stroke="black" points="3927.19,-22948.59 3925.99,-22938.06 3920.37,-22947.03 3927.19,-22948.59"/>
</g>
<!-- stage2_layer0_expert62_mlp2 -->
<g id="node431" class="node">
<title>stage2_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4137.69,-22850.02 3815.69,-22850.02 3815.69,-22798.02 4137.69,-22798.02 4137.69,-22850.02"/>
<text text-anchor="middle" x="3976.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="3976.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3976.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3976.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert62_act&#45;&gt;stage2_layer0_expert62_mlp2 -->
<g id="edge552" class="edge">
<title>stage2_layer0_expert62_act&#45;&gt;stage2_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M3944.95,-22885.68C3949.3,-22877.37 3954.2,-22867.99 3958.83,-22859.14"/>
<polygon fill="black" stroke="black" points="3961.99,-22860.66 3963.53,-22850.17 3955.79,-22857.41 3961.99,-22860.66"/>
</g>
<!-- stage2_layer0_expert62_tp2 -->
<g id="node432" class="node">
<title>stage2_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4011.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4011.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4011.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="4011.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4011.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert62_mlp2&#45;&gt;stage2_layer0_expert62_tp2 -->
<g id="edge553" class="edge">
<title>stage2_layer0_expert62_mlp2&#45;&gt;stage2_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M3985.79,-22797.84C3988.68,-22789.87 3991.96,-22780.78 3995.2,-22771.83"/>
<polygon fill="black" stroke="black" points="3998.57,-22772.82 3998.68,-22762.22 3991.98,-22770.44 3998.57,-22772.82"/>
</g>
<!-- stage2_layer0_expert62_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge569" class="edge">
<title>stage2_layer0_expert62_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3851.54,-22699.05C3826.19,-22695.32 3800.24,-22691.67 3775.69,-22688.48 3643.49,-22671.28 3500.66,-22654.7 3366.99,-22640.05"/>
<polygon fill="black" stroke="black" points="3367.29,-22636.56 3356.97,-22638.96 3366.53,-22643.52 3367.29,-22636.56"/>
</g>
<!-- stage2_layer0_expert63_mlp1 -->
<g id="node434" class="node">
<title>stage2_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4338.69,-23135.56 4024.69,-23135.56 4024.69,-23083.56 4338.69,-23083.56 4338.69,-23135.56"/>
<text text-anchor="middle" x="4181.69" y="-23123.56" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4181.69" y="-23112.56" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4181.69" y="-23101.56" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4181.69" y="-23090.56" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer0_expert63&#45;&gt;stage2_layer0_expert63_mlp1 -->
<g id="edge555" class="edge">
<title>stage2_layer0_expert63&#45;&gt;stage2_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4138.66,-23171.22C4144.68,-23162.73 4151.49,-23153.14 4157.88,-23144.12"/>
<polygon fill="black" stroke="black" points="4160.91,-23145.89 4163.84,-23135.71 4155.2,-23141.84 4160.91,-23145.89"/>
</g>
<!-- stage2_layer0_expert63_tp1 -->
<g id="node435" class="node">
<title>stage2_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4352.69" cy="-23010.79" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4352.69" y="-23024.79" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4352.69" y="-23013.79" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="4352.69" y="-23002.79" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4352.69" y="-22991.79" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert63_mlp1&#45;&gt;stage2_layer0_expert63_tp1 -->
<g id="edge556" class="edge">
<title>stage2_layer0_expert63_mlp1&#45;&gt;stage2_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4226.17,-23083.38C4243.68,-23073.48 4264.19,-23061.87 4283.54,-23050.92"/>
<polygon fill="black" stroke="black" points="4285.36,-23053.91 4292.34,-23045.94 4281.91,-23047.82 4285.36,-23053.91"/>
</g>
<!-- stage2_layer0_expert63_act -->
<g id="node436" class="node">
<title>stage2_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4547.19,-22938.02 4266.19,-22938.02 4266.19,-22886.02 4547.19,-22886.02 4547.19,-22938.02"/>
<text text-anchor="middle" x="4406.69" y="-22926.02" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4406.69" y="-22915.02" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="4406.69" y="-22904.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4406.69" y="-22893.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer0_expert63_tp1&#45;&gt;stage2_layer0_expert63_act -->
<g id="edge557" class="edge">
<title>stage2_layer0_expert63_tp1&#45;&gt;stage2_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4372.64,-22974.03C4377.59,-22965.16 4382.88,-22955.68 4387.78,-22946.9"/>
<polygon fill="black" stroke="black" points="4390.9,-22948.5 4392.71,-22938.06 4384.78,-22945.09 4390.9,-22948.5"/>
</g>
<!-- stage2_layer0_expert63_mlp2 -->
<g id="node437" class="node">
<title>stage2_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4618.69,-22850.02 4296.69,-22850.02 4296.69,-22798.02 4618.69,-22798.02 4618.69,-22850.02"/>
<text text-anchor="middle" x="4457.69" y="-22838.02" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4457.69" y="-22827.02" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4457.69" y="-22816.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4457.69" y="-22805.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert63_act&#45;&gt;stage2_layer0_expert63_mlp2 -->
<g id="edge558" class="edge">
<title>stage2_layer0_expert63_act&#45;&gt;stage2_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4421.71,-22885.68C4426.69,-22877.28 4432.32,-22867.79 4437.62,-22858.86"/>
<polygon fill="black" stroke="black" points="4440.68,-22860.56 4442.77,-22850.17 4434.66,-22856.99 4440.68,-22860.56"/>
</g>
<!-- stage2_layer0_expert63_tp2 -->
<g id="node438" class="node">
<title>stage2_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4484.69" cy="-22725.25" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4484.69" y="-22739.25" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4484.69" y="-22728.25" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="4484.69" y="-22717.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4484.69" y="-22706.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_expert63_mlp2&#45;&gt;stage2_layer0_expert63_tp2 -->
<g id="edge559" class="edge">
<title>stage2_layer0_expert63_mlp2&#45;&gt;stage2_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4464.71,-22797.84C4466.91,-22789.95 4469.42,-22780.98 4471.89,-22772.12"/>
<polygon fill="black" stroke="black" points="4475.33,-22772.8 4474.65,-22762.22 4468.59,-22770.91 4475.33,-22772.8"/>
</g>
<!-- stage2_layer0_expert63_tp2&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge570" class="edge">
<title>stage2_layer0_expert63_tp2&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4327.18,-22698.63C4301.01,-22694.88 4274.12,-22691.32 4248.69,-22688.48 3941.14,-22654.07 3594.76,-22628.68 3321.1,-22611.72"/>
<polygon fill="black" stroke="black" points="3321.19,-22608.22 3310.99,-22611.09 3320.76,-22615.2 3321.19,-22608.22"/>
</g>
<!-- stage2_layer0_expert_ellipsis&#45;&gt;stage2_layer0_expert_agg -->
<g id="edge571" class="edge">
<title>stage2_layer0_expert_ellipsis&#45;&gt;stage2_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4611.67,-23083.4C4663.52,-23051.28 4740.69,-22990.46 4740.69,-22913.02 4740.69,-22913.02 4740.69,-22913.02 4740.69,-22823.02 4740.69,-22762.63 4766.18,-22729.3 4721.69,-22688.48 4669.76,-22640.83 3839.62,-22610.83 3296.07,-22596.19"/>
<polygon fill="black" stroke="black" points="3295.78,-22592.68 3285.69,-22595.91 3295.59,-22599.68 3295.78,-22592.68"/>
</g>
<!-- stage2_layer0_expert_agg&#45;&gt;stage2_layer0_output -->
<g id="edge572" class="edge">
<title>stage2_layer0_expert_agg&#45;&gt;stage2_layer0_output</title>
<path fill="none" stroke="black" d="M3190.74,-22538.43C3353.86,-22518.13 3541.81,-22494.74 3686.28,-22476.77"/>
<polygon fill="black" stroke="black" points="3687.11,-22480.19 3696.6,-22475.48 3686.25,-22473.25 3687.11,-22480.19"/>
</g>
<!-- stage2_layer1_ln -->
<g id="node442" class="node">
<title>stage2_layer1_ln</title>
<polygon fill="none" stroke="black" points="4146.69,-22376.48 3696.69,-22376.48 3696.69,-22308.48 4146.69,-22308.48 4146.69,-22376.48"/>
<text text-anchor="middle" x="3921.69" y="-22361.28" font-family="Times,serif" font-size="14.00">Layer 5 LayerNorm</text>
<text text-anchor="middle" x="3921.69" y="-22346.28" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-22331.28" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-22316.28" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer0_output&#45;&gt;stage2_layer1_ln -->
<g id="edge574" class="edge">
<title>stage2_layer0_output&#45;&gt;stage2_layer1_ln</title>
<path fill="none" stroke="black" d="M3921.69,-22412.36C3921.69,-22404.25 3921.69,-22395.46 3921.69,-22386.95"/>
<polygon fill="black" stroke="black" points="3925.19,-22386.78 3921.69,-22376.78 3918.19,-22386.78 3925.19,-22386.78"/>
</g>
<!-- stage2_layer1_attn_qkv -->
<g id="node443" class="node">
<title>stage2_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4153.19,-22272.48 3690.19,-22272.48 3690.19,-22204.48 4153.19,-22204.48 4153.19,-22272.48"/>
<text text-anchor="middle" x="3921.69" y="-22257.28" font-family="Times,serif" font-size="14.00">Layer 5 Attention QKV Projection</text>
<text text-anchor="middle" x="3921.69" y="-22242.28" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP: GPU 256&#45;383)</text>
<text text-anchor="middle" x="3921.69" y="-22227.28" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-22212.28" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage2_layer1_ln&#45;&gt;stage2_layer1_attn_qkv -->
<g id="edge575" class="edge">
<title>stage2_layer1_ln&#45;&gt;stage2_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3921.69,-22308.36C3921.69,-22300.25 3921.69,-22291.46 3921.69,-22282.95"/>
<polygon fill="black" stroke="black" points="3925.19,-22282.78 3921.69,-22272.78 3918.19,-22282.78 3925.19,-22282.78"/>
</g>
<!-- stage2_layer1_tp_qkv_comm -->
<g id="node444" class="node">
<title>stage2_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-22120.39" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3921.69" y="-22139.19" font-family="Times,serif" font-size="14.00">Layer 5 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3921.69" y="-22124.19" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP pairs)</text>
<text text-anchor="middle" x="3921.69" y="-22109.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-22094.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage2_layer1_attn_qkv&#45;&gt;stage2_layer1_tp_qkv_comm -->
<g id="edge576" class="edge">
<title>stage2_layer1_attn_qkv&#45;&gt;stage2_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3921.69,-22204.21C3921.69,-22196.22 3921.69,-22187.45 3921.69,-22178.71"/>
<polygon fill="black" stroke="black" points="3925.19,-22178.5 3921.69,-22168.5 3918.19,-22178.5 3925.19,-22178.5"/>
</g>
<!-- stage2_layer1_attn_head0 -->
<g id="node445" class="node">
<title>stage2_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1730.19,-22036.31 1457.19,-22036.31 1457.19,-21984.31 1730.19,-21984.31 1730.19,-22036.31"/>
<text text-anchor="middle" x="1593.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 0 Attention</text>
<text text-anchor="middle" x="1593.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 0)</text>
<text text-anchor="middle" x="1593.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1593.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head0 -->
<g id="edge577" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3598.67,-22112.37C3086.05,-22100.34 2107.56,-22073.54 1740.38,-22036.42"/>
<polygon fill="black" stroke="black" points="1740.54,-22032.91 1730.23,-22035.37 1739.82,-22039.88 1740.54,-22032.91"/>
</g>
<!-- stage2_layer1_attn_head1 -->
<g id="node446" class="node">
<title>stage2_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="2021.19,-22036.31 1748.19,-22036.31 1748.19,-21984.31 2021.19,-21984.31 2021.19,-22036.31"/>
<text text-anchor="middle" x="1884.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 1 Attention</text>
<text text-anchor="middle" x="1884.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 1)</text>
<text text-anchor="middle" x="1884.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1884.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head1 -->
<g id="edge578" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3594.73,-22117.6C3219.12,-22112.65 2584.43,-22095.44 2031.41,-22036.44"/>
<polygon fill="black" stroke="black" points="2031.55,-22032.94 2021.23,-22035.35 2030.8,-22039.9 2031.55,-22032.94"/>
</g>
<!-- stage2_layer1_attn_head2 -->
<g id="node447" class="node">
<title>stage2_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2312.19,-22036.31 2039.19,-22036.31 2039.19,-21984.31 2312.19,-21984.31 2312.19,-22036.31"/>
<text text-anchor="middle" x="2175.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 2 Attention</text>
<text text-anchor="middle" x="2175.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 2)</text>
<text text-anchor="middle" x="2175.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2175.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head2 -->
<g id="edge579" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3597.26,-22113.86C3275.63,-22105.73 2768.92,-22085.84 2322.44,-22036.45"/>
<polygon fill="black" stroke="black" points="2322.56,-22032.95 2312.24,-22035.32 2321.79,-22039.9 2322.56,-22032.95"/>
</g>
<!-- stage2_layer1_attn_head3 -->
<g id="node448" class="node">
<title>stage2_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2603.19,-22036.31 2330.19,-22036.31 2330.19,-21984.31 2603.19,-21984.31 2603.19,-22036.31"/>
<text text-anchor="middle" x="2466.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 3 Attention</text>
<text text-anchor="middle" x="2466.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 3)</text>
<text text-anchor="middle" x="2466.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2466.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head3 -->
<g id="edge580" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3603.84,-22108.79C3340.62,-22097.75 2956.78,-22076.41 2613.39,-22036.46"/>
<polygon fill="black" stroke="black" points="2613.58,-22032.96 2603.24,-22035.27 2612.77,-22039.91 2613.58,-22032.96"/>
</g>
<!-- stage2_layer1_attn_head4 -->
<g id="node449" class="node">
<title>stage2_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2894.19,-22036.31 2621.19,-22036.31 2621.19,-21984.31 2894.19,-21984.31 2894.19,-22036.31"/>
<text text-anchor="middle" x="2757.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 4 Attention</text>
<text text-anchor="middle" x="2757.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 4)</text>
<text text-anchor="middle" x="2757.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2757.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head4 -->
<g id="edge581" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3619.43,-22101.86C3419.07,-22088.51 3150.29,-22067.33 2904.46,-22036.49"/>
<polygon fill="black" stroke="black" points="2904.61,-22032.98 2894.25,-22035.21 2903.73,-22039.93 2904.61,-22032.98"/>
</g>
<!-- stage2_layer1_attn_head5 -->
<g id="node450" class="node">
<title>stage2_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3185.19,-22036.31 2912.19,-22036.31 2912.19,-21984.31 3185.19,-21984.31 3185.19,-22036.31"/>
<text text-anchor="middle" x="3048.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 5 Attention</text>
<text text-anchor="middle" x="3048.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 5)</text>
<text text-anchor="middle" x="3048.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3048.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head5 -->
<g id="edge582" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3654.12,-22092.55C3519.28,-22078.11 3353.06,-22058.92 3195.62,-22036.56"/>
<polygon fill="black" stroke="black" points="3195.66,-22033.03 3185.27,-22035.08 3194.67,-22039.96 3195.66,-22033.03"/>
</g>
<!-- stage2_layer1_attn_head6 -->
<g id="node451" class="node">
<title>stage2_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3476.19,-22036.31 3203.19,-22036.31 3203.19,-21984.31 3476.19,-21984.31 3476.19,-22036.31"/>
<text text-anchor="middle" x="3339.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 6 Attention</text>
<text text-anchor="middle" x="3339.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 6)</text>
<text text-anchor="middle" x="3339.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3339.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head6 -->
<g id="edge583" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3721.8,-22082.27C3643.89,-22067.8 3556.29,-22051.54 3484.64,-22038.23"/>
<polygon fill="black" stroke="black" points="3485.1,-22034.76 3474.63,-22036.37 3483.83,-22041.64 3485.1,-22034.76"/>
</g>
<!-- stage2_layer1_attn_head7 -->
<g id="node452" class="node">
<title>stage2_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3767.19,-22036.31 3494.19,-22036.31 3494.19,-21984.31 3767.19,-21984.31 3767.19,-22036.31"/>
<text text-anchor="middle" x="3630.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 7 Attention</text>
<text text-anchor="middle" x="3630.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 7)</text>
<text text-anchor="middle" x="3630.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3630.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head7 -->
<g id="edge584" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3803.33,-22075.43C3771.09,-22063.46 3737.02,-22050.8 3707.74,-22039.93"/>
<polygon fill="black" stroke="black" points="3708.59,-22036.51 3698,-22036.31 3706.15,-22043.07 3708.59,-22036.51"/>
</g>
<!-- stage2_layer1_attn_ellipsis -->
<g id="node453" class="node">
<title>stage2_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4058.19,-22036.31 3785.19,-22036.31 3785.19,-21984.31 4058.19,-21984.31 4058.19,-22036.31"/>
<text text-anchor="middle" x="3921.69" y="-22024.31" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3921.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_ellipsis -->
<g id="edge585" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3921.69,-22072.3C3921.69,-22063.76 3921.69,-22054.98 3921.69,-22046.84"/>
<polygon fill="black" stroke="black" points="3925.19,-22046.57 3921.69,-22036.57 3918.19,-22046.57 3925.19,-22046.57"/>
</g>
<!-- stage2_layer1_attn_head24 -->
<g id="node454" class="node">
<title>stage2_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4349.19,-22036.31 4076.19,-22036.31 4076.19,-21984.31 4349.19,-21984.31 4349.19,-22036.31"/>
<text text-anchor="middle" x="4212.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 24 Attention</text>
<text text-anchor="middle" x="4212.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 24)</text>
<text text-anchor="middle" x="4212.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4212.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head24 -->
<g id="edge586" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M4040.05,-22075.43C4072.28,-22063.46 4106.36,-22050.8 4135.64,-22039.93"/>
<polygon fill="black" stroke="black" points="4137.22,-22043.07 4145.38,-22036.31 4134.79,-22036.51 4137.22,-22043.07"/>
</g>
<!-- stage2_layer1_attn_head25 -->
<g id="node455" class="node">
<title>stage2_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4640.19,-22036.31 4367.19,-22036.31 4367.19,-21984.31 4640.19,-21984.31 4640.19,-22036.31"/>
<text text-anchor="middle" x="4503.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 25 Attention</text>
<text text-anchor="middle" x="4503.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 25)</text>
<text text-anchor="middle" x="4503.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4503.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head25 -->
<g id="edge587" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M4121.57,-22082.27C4199.48,-22067.8 4287.09,-22051.54 4358.74,-22038.23"/>
<polygon fill="black" stroke="black" points="4359.55,-22041.64 4368.74,-22036.37 4358.27,-22034.76 4359.55,-22041.64"/>
</g>
<!-- stage2_layer1_attn_head26 -->
<g id="node456" class="node">
<title>stage2_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4931.19,-22036.31 4658.19,-22036.31 4658.19,-21984.31 4931.19,-21984.31 4931.19,-22036.31"/>
<text text-anchor="middle" x="4794.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 26 Attention</text>
<text text-anchor="middle" x="4794.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 26)</text>
<text text-anchor="middle" x="4794.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4794.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head26 -->
<g id="edge588" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4188.45,-22092.51C4323.31,-22078.03 4489.69,-22058.8 4648.01,-22036.38"/>
<polygon fill="black" stroke="black" points="4648.54,-22039.84 4657.95,-22034.96 4647.55,-22032.91 4648.54,-22039.84"/>
</g>
<!-- stage2_layer1_attn_head27 -->
<g id="node457" class="node">
<title>stage2_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5222.19,-22036.31 4949.19,-22036.31 4949.19,-21984.31 5222.19,-21984.31 5222.19,-22036.31"/>
<text text-anchor="middle" x="5085.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 27 Attention</text>
<text text-anchor="middle" x="5085.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 27)</text>
<text text-anchor="middle" x="5085.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5085.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head27 -->
<g id="edge589" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4223.64,-22101.75C4423.8,-22088.37 4692.31,-22067.17 4938.73,-22036.38"/>
<polygon fill="black" stroke="black" points="4939.48,-22039.82 4948.96,-22035.1 4938.61,-22032.87 4939.48,-22039.82"/>
</g>
<!-- stage2_layer1_attn_head28 -->
<g id="node458" class="node">
<title>stage2_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5513.19,-22036.31 5240.19,-22036.31 5240.19,-21984.31 5513.19,-21984.31 5513.19,-22036.31"/>
<text text-anchor="middle" x="5376.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 28 Attention</text>
<text text-anchor="middle" x="5376.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 28)</text>
<text text-anchor="middle" x="5376.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5376.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head28 -->
<g id="edge590" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4239.28,-22108.68C4502.3,-22097.57 4885.83,-22076.2 5229.81,-22036.36"/>
<polygon fill="black" stroke="black" points="5230.45,-22039.81 5239.97,-22035.17 5229.64,-22032.85 5230.45,-22039.81"/>
</g>
<!-- stage2_layer1_attn_head29 -->
<g id="node459" class="node">
<title>stage2_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5804.19,-22036.31 5531.19,-22036.31 5531.19,-21984.31 5804.19,-21984.31 5804.19,-22036.31"/>
<text text-anchor="middle" x="5667.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 29 Attention</text>
<text text-anchor="middle" x="5667.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 29)</text>
<text text-anchor="middle" x="5667.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5667.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head29 -->
<g id="edge591" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4246.28,-22113.73C4567.72,-22105.51 5073.89,-22085.55 5520.77,-22036.35"/>
<polygon fill="black" stroke="black" points="5521.43,-22039.8 5530.98,-22035.22 5520.66,-22032.84 5521.43,-22039.8"/>
</g>
<!-- stage2_layer1_attn_head30 -->
<g id="node460" class="node">
<title>stage2_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="6095.19,-22036.31 5822.19,-22036.31 5822.19,-21984.31 6095.19,-21984.31 6095.19,-22036.31"/>
<text text-anchor="middle" x="5958.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 30 Attention</text>
<text text-anchor="middle" x="5958.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 30)</text>
<text text-anchor="middle" x="5958.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5958.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head30 -->
<g id="edge592" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4248.89,-22117.47C4624.34,-22112.41 5258.41,-22095.08 5811.8,-22036.34"/>
<polygon fill="black" stroke="black" points="5812.41,-22039.8 5821.98,-22035.25 5811.67,-22032.84 5812.41,-22039.8"/>
</g>
<!-- stage2_layer1_attn_head31 -->
<g id="node461" class="node">
<title>stage2_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6386.19,-22036.31 6113.19,-22036.31 6113.19,-21984.31 6386.19,-21984.31 6386.19,-22036.31"/>
<text text-anchor="middle" x="6249.69" y="-22024.31" font-family="Times,serif" font-size="10.00">Layer 5 Head 31 Attention</text>
<text text-anchor="middle" x="6249.69" y="-22013.31" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Head 31)</text>
<text text-anchor="middle" x="6249.69" y="-22002.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6249.69" y="-21991.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head31 -->
<g id="edge593" class="edge">
<title>stage2_layer1_tp_qkv_comm&#45;&gt;stage2_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4244.55,-22112.32C4756.93,-22100.22 5734.97,-22073.32 6102.81,-22036.32"/>
<polygon fill="black" stroke="black" points="6103.39,-22039.78 6112.99,-22035.28 6102.68,-22032.82 6103.39,-22039.78"/>
</g>
<!-- stage2_layer1_attn_agg -->
<g id="node462" class="node">
<title>stage2_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4389.34,-21948.31 3645.41,-21948.31 3454.04,-21812.31 4197.97,-21812.31 4389.34,-21948.31"/>
<text text-anchor="middle" x="3921.69" y="-21899.11" font-family="Times,serif" font-size="14.00">Layer 5 Attention Aggregate</text>
<text text-anchor="middle" x="3921.69" y="-21884.11" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-21869.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-21854.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_attn_head0&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge594" class="edge">
<title>stage2_layer1_attn_head0&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1730.23,-21985.28C1733.07,-21984.94 1735.9,-21984.62 1738.69,-21984.31 2370.18,-21915.24 3109.43,-21892.46 3545.36,-21884.96"/>
<polygon fill="black" stroke="black" points="3545.67,-21888.46 3555.61,-21884.79 3545.55,-21881.46 3545.67,-21888.46"/>
</g>
<!-- stage2_layer1_attn_head1&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge595" class="edge">
<title>stage2_layer1_attn_head1&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2021.24,-21985.31C2024.08,-21984.96 2026.9,-21984.63 2029.69,-21984.31 2555.99,-21924.82 3168.69,-21899.42 3550.91,-21888.76"/>
<polygon fill="black" stroke="black" points="3551.12,-21892.25 3561.02,-21888.48 3550.93,-21885.26 3551.12,-21892.25"/>
</g>
<!-- stage2_layer1_attn_head2&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge596" class="edge">
<title>stage2_layer1_attn_head2&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2312.24,-21985.35C2315.08,-21984.99 2317.9,-21984.64 2320.69,-21984.31 2743.66,-21934.39 3232.57,-21907.35 3557.72,-21893.68"/>
<polygon fill="black" stroke="black" points="3557.93,-21897.17 3567.77,-21893.26 3557.63,-21890.18 3557.93,-21897.17"/>
</g>
<!-- stage2_layer1_attn_head3&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge597" class="edge">
<title>stage2_layer1_attn_head3&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2603.25,-21985.4C2606.08,-21985.03 2608.9,-21984.66 2611.69,-21984.31 2933.79,-21943.97 3302.56,-21916.65 3566.59,-21900.34"/>
<polygon fill="black" stroke="black" points="3566.96,-21903.83 3576.72,-21899.72 3566.53,-21896.84 3566.96,-21903.83"/>
</g>
<!-- stage2_layer1_attn_head4&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge598" class="edge">
<title>stage2_layer1_attn_head4&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2894.26,-21985.49C2897.09,-21985.08 2899.9,-21984.69 2902.69,-21984.31 3127.59,-21953.59 3381.58,-21927.9 3579.72,-21909.86"/>
<polygon fill="black" stroke="black" points="3580.07,-21913.34 3589.71,-21908.95 3579.43,-21906.37 3580.07,-21913.34"/>
</g>
<!-- stage2_layer1_attn_head5&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge599" class="edge">
<title>stage2_layer1_attn_head5&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3185.28,-21985.64C3188.11,-21985.19 3190.91,-21984.75 3193.69,-21984.31 3326.44,-21963.48 3473.12,-21942.36 3599.83,-21924.72"/>
<polygon fill="black" stroke="black" points="3600.65,-21928.14 3610.08,-21923.29 3599.69,-21921.2 3600.65,-21928.14"/>
</g>
<!-- stage2_layer1_attn_head6&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge600" class="edge">
<title>stage2_layer1_attn_head6&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3453.63,-21984.25C3504.21,-21973.13 3566.29,-21959.47 3628.5,-21945.79"/>
<polygon fill="black" stroke="black" points="3629.47,-21949.16 3638.49,-21943.59 3627.97,-21942.32 3629.47,-21949.16"/>
</g>
<!-- stage2_layer1_attn_head7&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge601" class="edge">
<title>stage2_layer1_attn_head7&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3687.83,-21984.17C3709.01,-21974.86 3734.2,-21963.78 3760.08,-21952.4"/>
<polygon fill="black" stroke="black" points="3761.51,-21955.59 3769.25,-21948.36 3758.69,-21949.18 3761.51,-21955.59"/>
</g>
<!-- stage2_layer1_attn_ellipsis&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge602" class="edge">
<title>stage2_layer1_attn_ellipsis&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3921.69,-21984.02C3921.69,-21976.42 3921.69,-21967.66 3921.69,-21958.52"/>
<polygon fill="black" stroke="black" points="3925.19,-21958.49 3921.69,-21948.49 3918.19,-21958.49 3925.19,-21958.49"/>
</g>
<!-- stage2_layer1_attn_head24&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge603" class="edge">
<title>stage2_layer1_attn_head24&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4155.54,-21984.17C4134.37,-21974.86 4109.18,-21963.78 4083.3,-21952.4"/>
<polygon fill="black" stroke="black" points="4084.69,-21949.18 4074.12,-21948.36 4081.87,-21955.59 4084.69,-21949.18"/>
</g>
<!-- stage2_layer1_attn_head25&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge604" class="edge">
<title>stage2_layer1_attn_head25&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4389.74,-21984.25C4345.03,-21974.42 4291.31,-21962.6 4236.45,-21950.54"/>
<polygon fill="black" stroke="black" points="4237.08,-21947.09 4226.56,-21948.36 4235.58,-21953.93 4237.08,-21947.09"/>
</g>
<!-- stage2_layer1_attn_head26&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge605" class="edge">
<title>stage2_layer1_attn_head26&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4657.93,-21985.77C4654.82,-21985.27 4651.74,-21984.79 4648.69,-21984.31 4566.61,-21971.47 4479.21,-21958.49 4394.51,-21946.28"/>
<polygon fill="black" stroke="black" points="4394.86,-21942.8 4384.46,-21944.84 4393.86,-21949.72 4394.86,-21942.8"/>
</g>
<!-- stage2_layer1_attn_head27&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge606" class="edge">
<title>stage2_layer1_attn_head27&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4948.95,-21985.6C4945.84,-21985.16 4942.75,-21984.73 4939.69,-21984.31 4749.01,-21958.37 4537.43,-21935.94 4356.77,-21918.7"/>
<polygon fill="black" stroke="black" points="4356.84,-21915.19 4346.56,-21917.72 4356.18,-21922.16 4356.84,-21915.19"/>
</g>
<!-- stage2_layer1_attn_head28&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge607" class="edge">
<title>stage2_layer1_attn_head28&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5239.97,-21985.51C5236.85,-21985.09 5233.75,-21984.69 5230.69,-21984.31 4932.68,-21947.15 4594.74,-21920.96 4336.88,-21904.29"/>
<polygon fill="black" stroke="black" points="4336.79,-21900.78 4326.59,-21903.63 4336.34,-21907.76 4336.79,-21900.78"/>
</g>
<!-- stage2_layer1_attn_head29&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge608" class="edge">
<title>stage2_layer1_attn_head29&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5530.97,-21985.45C5527.85,-21985.05 5524.75,-21984.67 5521.69,-21984.31 5115.71,-21936.62 4648.99,-21909.75 4324.82,-21895.51"/>
<polygon fill="black" stroke="black" points="4324.94,-21892.01 4314.79,-21895.07 4324.63,-21899 4324.94,-21892.01"/>
</g>
<!-- stage2_layer1_attn_head30&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge609" class="edge">
<title>stage2_layer1_attn_head30&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5821.98,-21985.41C5818.85,-21985.02 5815.75,-21984.66 5812.69,-21984.31 5297.76,-21926.4 4700.15,-21900.75 4316.82,-21889.6"/>
<polygon fill="black" stroke="black" points="4316.77,-21886.09 4306.67,-21889.3 4316.57,-21893.09 4316.77,-21886.09"/>
</g>
<!-- stage2_layer1_attn_head31&#45;&gt;stage2_layer1_attn_agg -->
<g id="edge610" class="edge">
<title>stage2_layer1_attn_head31&#45;&gt;stage2_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M6112.98,-21985.38C6109.86,-21985 6106.76,-21984.64 6103.69,-21984.31 5478.76,-21916.31 4748.31,-21893.19 4310.99,-21885.34"/>
<polygon fill="black" stroke="black" points="4310.77,-21881.83 4300.71,-21885.15 4310.65,-21888.83 4310.77,-21881.83"/>
</g>
<!-- stage2_layer1_attn_out -->
<g id="node463" class="node">
<title>stage2_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="4146.69,-21776.31 3696.69,-21776.31 3696.69,-21708.31 4146.69,-21708.31 4146.69,-21776.31"/>
<text text-anchor="middle" x="3921.69" y="-21761.11" font-family="Times,serif" font-size="14.00">Layer 5 Attention Output Proj</text>
<text text-anchor="middle" x="3921.69" y="-21746.11" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP: GPU 256&#45;383)</text>
<text text-anchor="middle" x="3921.69" y="-21731.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-21716.11" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_attn_agg&#45;&gt;stage2_layer1_attn_out -->
<g id="edge611" class="edge">
<title>stage2_layer1_attn_agg&#45;&gt;stage2_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3921.69,-21812.11C3921.69,-21803.36 3921.69,-21794.59 3921.69,-21786.38"/>
<polygon fill="black" stroke="black" points="3925.19,-21786.33 3921.69,-21776.33 3918.19,-21786.33 3925.19,-21786.33"/>
</g>
<!-- stage2_layer1_tp_attn_comm -->
<g id="node464" class="node">
<title>stage2_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-21624.23" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3921.69" y="-21643.03" font-family="Times,serif" font-size="14.00">Layer 5 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3921.69" y="-21628.03" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2 (TP pairs)</text>
<text text-anchor="middle" x="3921.69" y="-21613.03" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-21598.03" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_attn_out&#45;&gt;stage2_layer1_tp_attn_comm -->
<g id="edge612" class="edge">
<title>stage2_layer1_attn_out&#45;&gt;stage2_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3921.69,-21708.05C3921.69,-21700.05 3921.69,-21691.29 3921.69,-21682.54"/>
<polygon fill="black" stroke="black" points="3925.19,-21682.34 3921.69,-21672.34 3918.19,-21682.34 3925.19,-21682.34"/>
</g>
<!-- stage2_layer1_expert_router -->
<g id="node465" class="node">
<title>stage2_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4375.88,-21540.14 3653.36,-21540.14 3467.49,-21404.14 4190.02,-21404.14 4375.88,-21540.14"/>
<text text-anchor="middle" x="3921.69" y="-21490.94" font-family="Times,serif" font-size="14.00">Layer 5 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3921.69" y="-21475.94" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-21460.94" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-21445.94" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage2_layer1_tp_attn_comm&#45;&gt;stage2_layer1_expert_router -->
<g id="edge613" class="edge">
<title>stage2_layer1_tp_attn_comm&#45;&gt;stage2_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3921.69,-21575.74C3921.69,-21567.65 3921.69,-21559.07 3921.69,-21550.45"/>
<polygon fill="black" stroke="black" points="3925.19,-21550.34 3921.69,-21540.34 3918.19,-21550.34 3925.19,-21550.34"/>
</g>
<!-- stage2_layer1_expert0 -->
<g id="node466" class="node">
<title>stage2_layer1_expert0</title>
<polygon fill="none" stroke="black" points="2068.69,-21368.14 1746.69,-21368.14 1746.69,-21316.14 2068.69,-21316.14 2068.69,-21368.14"/>
<text text-anchor="middle" x="1907.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 0</text>
<text text-anchor="middle" x="1907.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP pair)</text>
<text text-anchor="middle" x="1907.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1907.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert0 -->
<g id="edge614" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3528.21,-21448.61C3187.27,-21428.71 2680.79,-21398.26 2239.69,-21368.14 2187.52,-21364.58 2130.76,-21360.42 2079.17,-21356.52"/>
<polygon fill="black" stroke="black" points="2079.16,-21353.01 2068.92,-21355.74 2078.63,-21359.99 2079.16,-21353.01"/>
</g>
<!-- stage2_layer1_expert1 -->
<g id="node472" class="node">
<title>stage2_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2570.69,-21368.14 2248.69,-21368.14 2248.69,-21316.14 2570.69,-21316.14 2570.69,-21368.14"/>
<text text-anchor="middle" x="2409.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 1</text>
<text text-anchor="middle" x="2409.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP pair)</text>
<text text-anchor="middle" x="2409.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2409.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert1 -->
<g id="edge620" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3516.19,-21439.86C3268.89,-21420.33 2946.44,-21394.04 2660.69,-21368.14 2634.97,-21365.81 2607.78,-21363.23 2581.17,-21360.63"/>
<polygon fill="black" stroke="black" points="2581.29,-21357.13 2571,-21359.64 2580.61,-21364.1 2581.29,-21357.13"/>
</g>
<!-- stage2_layer1_expert2 -->
<g id="node478" class="node">
<title>stage2_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2991.69,-21368.14 2669.69,-21368.14 2669.69,-21316.14 2991.69,-21316.14 2991.69,-21368.14"/>
<text text-anchor="middle" x="2830.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 2</text>
<text text-anchor="middle" x="2830.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP pair)</text>
<text text-anchor="middle" x="2830.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2830.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert2 -->
<g id="edge626" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3490.03,-21420.74C3347.29,-21404.05 3187.67,-21385.34 3041.69,-21368.14 3028.84,-21366.63 3015.56,-21365.06 3002.2,-21363.49"/>
<polygon fill="black" stroke="black" points="3002.31,-21359.97 2991.97,-21362.28 3001.49,-21366.93 3002.31,-21359.97"/>
</g>
<!-- stage2_layer1_expert3 -->
<g id="node484" class="node">
<title>stage2_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3372.69,-21368.14 3050.69,-21368.14 3050.69,-21316.14 3372.69,-21316.14 3372.69,-21368.14"/>
<text text-anchor="middle" x="3211.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 3</text>
<text text-anchor="middle" x="3211.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP pair)</text>
<text text-anchor="middle" x="3211.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3211.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert3 -->
<g id="edge632" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3549.79,-21404.1C3482.73,-21392.01 3416.47,-21380.06 3360.62,-21369.99"/>
<polygon fill="black" stroke="black" points="3361.14,-21366.53 3350.67,-21368.2 3359.89,-21373.42 3361.14,-21366.53"/>
</g>
<!-- stage2_layer1_expert31 -->
<g id="node490" class="node">
<title>stage2_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3732.69,-21368.14 3410.69,-21368.14 3410.69,-21316.14 3732.69,-21316.14 3732.69,-21368.14"/>
<text text-anchor="middle" x="3571.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 31</text>
<text text-anchor="middle" x="3571.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP pair)</text>
<text text-anchor="middle" x="3571.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3571.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert31 -->
<g id="edge638" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3738.23,-21404.05C3707.04,-21392.64 3676.2,-21381.37 3649.7,-21371.67"/>
<polygon fill="black" stroke="black" points="3650.73,-21368.33 3640.14,-21368.18 3648.33,-21374.9 3650.73,-21368.33"/>
</g>
<!-- stage2_layer1_expert32 -->
<g id="node496" class="node">
<title>stage2_layer1_expert32</title>
<polygon fill="none" stroke="black" points="4082.69,-21368.14 3760.69,-21368.14 3760.69,-21316.14 4082.69,-21316.14 4082.69,-21368.14"/>
<text text-anchor="middle" x="3921.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 32</text>
<text text-anchor="middle" x="3921.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP pair)</text>
<text text-anchor="middle" x="3921.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert32 -->
<g id="edge644" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3921.69,-21403.77C3921.69,-21395.08 3921.69,-21386.46 3921.69,-21378.58"/>
<polygon fill="black" stroke="black" points="3925.19,-21378.34 3921.69,-21368.34 3918.19,-21378.34 3925.19,-21378.34"/>
</g>
<!-- stage2_layer1_expert60 -->
<g id="node502" class="node">
<title>stage2_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4472.69,-21368.14 4150.69,-21368.14 4150.69,-21316.14 4472.69,-21316.14 4472.69,-21368.14"/>
<text text-anchor="middle" x="4311.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 60</text>
<text text-anchor="middle" x="4311.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP pair)</text>
<text text-anchor="middle" x="4311.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4311.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert60 -->
<g id="edge650" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4126.11,-21404.05C4161.18,-21392.54 4195.84,-21381.17 4225.54,-21371.42"/>
<polygon fill="black" stroke="black" points="4227,-21374.62 4235.41,-21368.18 4224.82,-21367.97 4227,-21374.62"/>
</g>
<!-- stage2_layer1_expert61 -->
<g id="node508" class="node">
<title>stage2_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4837.69,-21368.14 4515.69,-21368.14 4515.69,-21316.14 4837.69,-21316.14 4837.69,-21368.14"/>
<text text-anchor="middle" x="4676.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 61</text>
<text text-anchor="middle" x="4676.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP pair)</text>
<text text-anchor="middle" x="4676.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4676.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert61 -->
<g id="edge656" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4214.13,-21421.56C4317.96,-21403.96 4430.84,-21384.82 4519.1,-21369.86"/>
<polygon fill="black" stroke="black" points="4519.92,-21373.27 4529.19,-21368.15 4518.75,-21366.37 4519.92,-21373.27"/>
</g>
<!-- stage2_layer1_expert62 -->
<g id="node514" class="node">
<title>stage2_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5252.69,-21368.14 4930.69,-21368.14 4930.69,-21316.14 5252.69,-21316.14 5252.69,-21368.14"/>
<text text-anchor="middle" x="5091.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 62</text>
<text text-anchor="middle" x="5091.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP pair)</text>
<text text-anchor="middle" x="5091.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5091.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert62 -->
<g id="edge662" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4234.84,-21436.88C4454.91,-21412.81 4740.97,-21381.51 4920.49,-21361.87"/>
<polygon fill="black" stroke="black" points="4921,-21365.34 4930.56,-21360.77 4920.24,-21358.38 4921,-21365.34"/>
</g>
<!-- stage2_layer1_expert63 -->
<g id="node520" class="node">
<title>stage2_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5630.69,-21368.14 5308.69,-21368.14 5308.69,-21316.14 5630.69,-21316.14 5630.69,-21368.14"/>
<text text-anchor="middle" x="5469.69" y="-21356.14" font-family="Times,serif" font-size="10.00">Layer 5 Expert 63</text>
<text text-anchor="middle" x="5469.69" y="-21345.14" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP pair)</text>
<text text-anchor="middle" x="5469.69" y="-21334.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5469.69" y="-21323.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert63 -->
<g id="edge668" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4252.44,-21449.69C4523.86,-21431.13 4918.03,-21401.99 5261.69,-21368.14 5273.68,-21366.96 5286.06,-21365.67 5298.52,-21364.31"/>
<polygon fill="black" stroke="black" points="5298.96,-21367.78 5308.52,-21363.21 5298.19,-21360.82 5298.96,-21367.78"/>
</g>
<!-- stage2_layer1_expert_ellipsis -->
<g id="node526" class="node">
<title>stage2_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6211.69,-21280.14 5889.69,-21280.14 5889.69,-21228.14 6211.69,-21228.14 6211.69,-21280.14"/>
<text text-anchor="middle" x="6050.69" y="-21268.14" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="6050.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: Pipeline 2 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="6050.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="6050.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert_ellipsis -->
<g id="edge674" class="edge">
<title>stage2_layer1_expert_router&#45;&gt;stage2_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4265.49,-21459.02C4689.26,-21442.58 5384.61,-21410.38 5639.69,-21368.14 5755.62,-21348.95 5885.87,-21310.09 5968.06,-21283.34"/>
<polygon fill="black" stroke="black" points="5969.43,-21286.58 5977.84,-21280.15 5967.25,-21279.93 5969.43,-21286.58"/>
</g>
<!-- stage2_layer1_expert0_mlp1 -->
<g id="node467" class="node">
<title>stage2_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1877.69,-21280.14 1563.69,-21280.14 1563.69,-21228.14 1877.69,-21228.14 1877.69,-21280.14"/>
<text text-anchor="middle" x="1720.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1720.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1720.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1720.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert0&#45;&gt;stage2_layer1_expert0_mlp1 -->
<g id="edge615" class="edge">
<title>stage2_layer1_expert0&#45;&gt;stage2_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1853.1,-21316.04C1831.68,-21306.19 1806.96,-21294.82 1784.71,-21284.59"/>
<polygon fill="black" stroke="black" points="1785.89,-21281.28 1775.35,-21280.28 1782.97,-21287.64 1785.89,-21281.28"/>
</g>
<!-- stage2_layer1_expert0_tp1 -->
<g id="node468" class="node">
<title>stage2_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1709.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1709.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1709.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="1709.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1709.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert0_mlp1&#45;&gt;stage2_layer1_expert0_tp1 -->
<g id="edge616" class="edge">
<title>stage2_layer1_expert0_mlp1&#45;&gt;stage2_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1717.83,-21227.97C1716.94,-21220.16 1715.93,-21211.3 1714.93,-21202.53"/>
<polygon fill="black" stroke="black" points="1718.39,-21201.89 1713.78,-21192.35 1711.43,-21202.68 1718.39,-21201.89"/>
</g>
<!-- stage2_layer1_expert0_act -->
<g id="node469" class="node">
<title>stage2_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1827.19,-21082.6 1546.19,-21082.6 1546.19,-21030.6 1827.19,-21030.6 1827.19,-21082.6"/>
<text text-anchor="middle" x="1686.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1686.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="1686.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1686.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert0_tp1&#45;&gt;stage2_layer1_expert0_act -->
<g id="edge617" class="edge">
<title>stage2_layer1_expert0_tp1&#45;&gt;stage2_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1701.19,-21118.62C1699.17,-21110.12 1697.02,-21101.06 1695.01,-21092.6"/>
<polygon fill="black" stroke="black" points="1698.36,-21091.57 1692.64,-21082.65 1691.55,-21093.19 1698.36,-21091.57"/>
</g>
<!-- stage2_layer1_expert0_mlp2 -->
<g id="node470" class="node">
<title>stage2_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1760.69,-20994.6 1438.69,-20994.6 1438.69,-20942.6 1760.69,-20942.6 1760.69,-20994.6"/>
<text text-anchor="middle" x="1599.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1599.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1599.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1599.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert0_act&#45;&gt;stage2_layer1_expert0_mlp2 -->
<g id="edge618" class="edge">
<title>stage2_layer1_expert0_act&#45;&gt;stage2_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1661.06,-21030.27C1652.12,-21021.43 1641.96,-21011.39 1632.52,-21002.06"/>
<polygon fill="black" stroke="black" points="1634.71,-20999.3 1625.14,-20994.76 1629.79,-21004.28 1634.71,-20999.3"/>
</g>
<!-- stage2_layer1_expert0_tp2 -->
<g id="node471" class="node">
<title>stage2_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1556.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1556.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1556.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 256&#45;257</text>
<text text-anchor="middle" x="1556.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1556.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert0_mlp2&#45;&gt;stage2_layer1_expert0_tp2 -->
<g id="edge619" class="edge">
<title>stage2_layer1_expert0_mlp2&#45;&gt;stage2_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1588.5,-20942.43C1584.92,-20934.37 1580.84,-20925.18 1576.82,-20916.13"/>
<polygon fill="black" stroke="black" points="1579.93,-20914.53 1572.67,-20906.81 1573.54,-20917.37 1579.93,-20914.53"/>
</g>
<!-- stage2_layer1_expert_agg -->
<g id="node527" class="node">
<title>stage2_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4472.22,-20797.07 3596.45,-20797.07 3371.16,-20661.07 4246.93,-20661.07 4472.22,-20797.07"/>
<text text-anchor="middle" x="3921.69" y="-20747.87" font-family="Times,serif" font-size="14.00">Layer 5 Expert Aggregation</text>
<text text-anchor="middle" x="3921.69" y="-20732.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-20717.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20702.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert0_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge675" class="edge">
<title>stage2_layer1_expert0_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1712.23,-20842.96C1739.01,-20839.17 1766.61,-20835.67 1792.69,-20833.07 2377.93,-20774.71 3057.1,-20749.11 3487.99,-20738.09"/>
<polygon fill="black" stroke="black" points="3488.22,-20741.59 3498.12,-20737.83 3488.04,-20734.59 3488.22,-20741.59"/>
</g>
<!-- stage2_layer1_expert1_mlp1 -->
<g id="node473" class="node">
<title>stage2_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2469.69,-21280.14 2155.69,-21280.14 2155.69,-21228.14 2469.69,-21228.14 2469.69,-21280.14"/>
<text text-anchor="middle" x="2312.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2312.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2312.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2312.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert1&#45;&gt;stage2_layer1_expert1_mlp1 -->
<g id="edge621" class="edge">
<title>stage2_layer1_expert1&#45;&gt;stage2_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2381.37,-21316.04C2371.2,-21307.02 2359.59,-21296.73 2348.85,-21287.2"/>
<polygon fill="black" stroke="black" points="2351.01,-21284.45 2341.21,-21280.43 2346.37,-21289.68 2351.01,-21284.45"/>
</g>
<!-- stage2_layer1_expert1_tp1 -->
<g id="node474" class="node">
<title>stage2_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2204.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2204.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2204.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="2204.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2204.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert1_mlp1&#45;&gt;stage2_layer1_expert1_tp1 -->
<g id="edge622" class="edge">
<title>stage2_layer1_expert1_mlp1&#45;&gt;stage2_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2284.59,-21227.97C2274.54,-21218.96 2262.91,-21208.55 2251.7,-21198.5"/>
<polygon fill="black" stroke="black" points="2253.81,-21195.69 2244.02,-21191.62 2249.14,-21200.9 2253.81,-21195.69"/>
</g>
<!-- stage2_layer1_expert1_act -->
<g id="node475" class="node">
<title>stage2_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2301.19,-21082.6 2020.19,-21082.6 2020.19,-21030.6 2301.19,-21030.6 2301.19,-21082.6"/>
<text text-anchor="middle" x="2160.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="2160.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="2160.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2160.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert1_tp1&#45;&gt;stage2_layer1_expert1_act -->
<g id="edge623" class="edge">
<title>stage2_layer1_expert1_tp1&#45;&gt;stage2_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2188.43,-21118.62C2184.44,-21109.84 2180.18,-21100.46 2176.22,-21091.76"/>
<polygon fill="black" stroke="black" points="2179.4,-21090.3 2172.08,-21082.65 2173.03,-21093.2 2179.4,-21090.3"/>
</g>
<!-- stage2_layer1_expert1_mlp2 -->
<g id="node476" class="node">
<title>stage2_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2277.69,-20994.6 1955.69,-20994.6 1955.69,-20942.6 2277.69,-20942.6 2277.69,-20994.6"/>
<text text-anchor="middle" x="2116.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="2116.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2116.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2116.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert1_act&#45;&gt;stage2_layer1_expert1_mlp2 -->
<g id="edge624" class="edge">
<title>stage2_layer1_expert1_act&#45;&gt;stage2_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M2147.72,-21030.27C2143.47,-21021.96 2138.68,-21012.58 2134.15,-21003.73"/>
<polygon fill="black" stroke="black" points="2137.23,-21002.07 2129.56,-20994.76 2131,-21005.26 2137.23,-21002.07"/>
</g>
<!-- stage2_layer1_expert1_tp2 -->
<g id="node477" class="node">
<title>stage2_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="2029.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2029.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2029.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 258&#45;259</text>
<text text-anchor="middle" x="2029.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2029.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert1_mlp2&#45;&gt;stage2_layer1_expert1_tp2 -->
<g id="edge625" class="edge">
<title>stage2_layer1_expert1_mlp2&#45;&gt;stage2_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M2094.06,-20942.43C2086.27,-20933.77 2077.32,-20923.81 2068.61,-20914.12"/>
<polygon fill="black" stroke="black" points="2070.99,-20911.54 2061.7,-20906.45 2065.79,-20916.22 2070.99,-20911.54"/>
</g>
<!-- stage2_layer1_expert1_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge676" class="edge">
<title>stage2_layer1_expert1_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2186.22,-20843.13C2212.69,-20839.35 2239.93,-20835.81 2265.69,-20833.07 2684.55,-20788.39 3165.24,-20761.14 3500.44,-20745.99"/>
<polygon fill="black" stroke="black" points="3500.98,-20749.47 3510.81,-20745.53 3500.67,-20742.48 3500.98,-20749.47"/>
</g>
<!-- stage2_layer1_expert2_mlp1 -->
<g id="node479" class="node">
<title>stage2_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2935.69,-21280.14 2621.69,-21280.14 2621.69,-21228.14 2935.69,-21228.14 2935.69,-21280.14"/>
<text text-anchor="middle" x="2778.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2778.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2778.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2778.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert2&#45;&gt;stage2_layer1_expert2_mlp1 -->
<g id="edge627" class="edge">
<title>stage2_layer1_expert2&#45;&gt;stage2_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2815.37,-21315.81C2810.29,-21307.41 2804.55,-21297.92 2799.15,-21288.99"/>
<polygon fill="black" stroke="black" points="2802.07,-21287.05 2793.9,-21280.3 2796.08,-21290.67 2802.07,-21287.05"/>
</g>
<!-- stage2_layer1_expert2_tp1 -->
<g id="node480" class="node">
<title>stage2_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2659.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2659.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2659.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="2659.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2659.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert2_mlp1&#45;&gt;stage2_layer1_expert2_tp1 -->
<g id="edge628" class="edge">
<title>stage2_layer1_expert2_mlp1&#45;&gt;stage2_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2747.73,-21227.97C2736.55,-21218.88 2723.6,-21208.35 2711.13,-21198.21"/>
<polygon fill="black" stroke="black" points="2713,-21195.21 2703.03,-21191.62 2708.58,-21200.64 2713,-21195.21"/>
</g>
<!-- stage2_layer1_expert2_act -->
<g id="node481" class="node">
<title>stage2_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2800.19,-21082.6 2519.19,-21082.6 2519.19,-21030.6 2800.19,-21030.6 2800.19,-21082.6"/>
<text text-anchor="middle" x="2659.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2659.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="2659.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2659.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert2_tp1&#45;&gt;stage2_layer1_expert2_act -->
<g id="edge629" class="edge">
<title>stage2_layer1_expert2_tp1&#45;&gt;stage2_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2659.69,-21118.34C2659.69,-21110.03 2659.69,-21101.2 2659.69,-21092.91"/>
<polygon fill="black" stroke="black" points="2663.19,-21092.8 2659.69,-21082.8 2656.19,-21092.8 2663.19,-21092.8"/>
</g>
<!-- stage2_layer1_expert2_mlp2 -->
<g id="node482" class="node">
<title>stage2_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2731.69,-20994.6 2409.69,-20994.6 2409.69,-20942.6 2731.69,-20942.6 2731.69,-20994.6"/>
<text text-anchor="middle" x="2570.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2570.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2570.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2570.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert2_act&#45;&gt;stage2_layer1_expert2_mlp2 -->
<g id="edge630" class="edge">
<title>stage2_layer1_expert2_act&#45;&gt;stage2_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2633.47,-21030.27C2624.23,-21021.34 2613.73,-21011.19 2603.99,-21001.78"/>
<polygon fill="black" stroke="black" points="2606.35,-20999.19 2596.72,-20994.76 2601.48,-21004.23 2606.35,-20999.19"/>
</g>
<!-- stage2_layer1_expert2_tp2 -->
<g id="node483" class="node">
<title>stage2_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2502.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2502.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2502.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 260&#45;261</text>
<text text-anchor="middle" x="2502.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2502.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert2_mlp2&#45;&gt;stage2_layer1_expert2_tp2 -->
<g id="edge631" class="edge">
<title>stage2_layer1_expert2_mlp2&#45;&gt;stage2_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2553,-20942.43C2547.03,-20933.94 2540.19,-20924.2 2533.51,-20914.7"/>
<polygon fill="black" stroke="black" points="2536.33,-20912.62 2527.71,-20906.45 2530.6,-20916.64 2536.33,-20912.62"/>
</g>
<!-- stage2_layer1_expert2_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge677" class="edge">
<title>stage2_layer1_expert2_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2661.18,-20843.4C2687.05,-20839.65 2713.59,-20836.06 2738.69,-20833.07 2998.52,-20802.1 3291.5,-20776.52 3520.9,-20758.6"/>
<polygon fill="black" stroke="black" points="3521.39,-20762.07 3531.09,-20757.8 3520.84,-20755.09 3521.39,-20762.07"/>
</g>
<!-- stage2_layer1_expert3_mlp1 -->
<g id="node485" class="node">
<title>stage2_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3338.69,-21280.14 3024.69,-21280.14 3024.69,-21228.14 3338.69,-21228.14 3338.69,-21280.14"/>
<text text-anchor="middle" x="3181.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3181.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3181.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3181.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert3&#45;&gt;stage2_layer1_expert3_mlp1 -->
<g id="edge633" class="edge">
<title>stage2_layer1_expert3&#45;&gt;stage2_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3202.85,-21315.81C3200.01,-21307.67 3196.82,-21298.51 3193.79,-21289.83"/>
<polygon fill="black" stroke="black" points="3197.06,-21288.59 3190.46,-21280.3 3190.45,-21290.9 3197.06,-21288.59"/>
</g>
<!-- stage2_layer1_expert3_tp1 -->
<g id="node486" class="node">
<title>stage2_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="3084.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3084.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="3084.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="3084.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3084.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert3_mlp1&#45;&gt;stage2_layer1_expert3_tp1 -->
<g id="edge634" class="edge">
<title>stage2_layer1_expert3_mlp1&#45;&gt;stage2_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M3156.46,-21227.97C3147.51,-21219.05 3137.19,-21208.75 3127.2,-21198.79"/>
<polygon fill="black" stroke="black" points="3129.57,-21196.2 3120.02,-21191.62 3124.62,-21201.16 3129.57,-21196.2"/>
</g>
<!-- stage2_layer1_expert3_act -->
<g id="node487" class="node">
<title>stage2_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3119.19,-21082.6 2838.19,-21082.6 2838.19,-21030.6 3119.19,-21030.6 3119.19,-21082.6"/>
<text text-anchor="middle" x="2978.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2978.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="2978.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2978.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert3_tp1&#45;&gt;stage2_layer1_expert3_act -->
<g id="edge635" class="edge">
<title>stage2_layer1_expert3_tp1&#45;&gt;stage2_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M3046.12,-21119.16C3035.45,-21109.42 3023.94,-21098.91 3013.49,-21089.38"/>
<polygon fill="black" stroke="black" points="3015.85,-21086.79 3006.11,-21082.64 3011.13,-21091.96 3015.85,-21086.79"/>
</g>
<!-- stage2_layer1_expert3_mlp2 -->
<g id="node488" class="node">
<title>stage2_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3138.69,-20994.6 2816.69,-20994.6 2816.69,-20942.6 3138.69,-20942.6 3138.69,-20994.6"/>
<text text-anchor="middle" x="2977.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2977.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2977.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2977.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert3_act&#45;&gt;stage2_layer1_expert3_mlp2 -->
<g id="edge636" class="edge">
<title>stage2_layer1_expert3_act&#45;&gt;stage2_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2978.39,-21030.27C2978.3,-21022.31 2978.2,-21013.37 2978.1,-21004.85"/>
<polygon fill="black" stroke="black" points="2981.6,-21004.72 2977.98,-20994.76 2974.6,-21004.8 2981.6,-21004.72"/>
</g>
<!-- stage2_layer1_expert3_tp2 -->
<g id="node489" class="node">
<title>stage2_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2975.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2975.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2975.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 262&#45;263</text>
<text text-anchor="middle" x="2975.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2975.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert3_mlp2&#45;&gt;stage2_layer1_expert3_tp2 -->
<g id="edge637" class="edge">
<title>stage2_layer1_expert3_mlp2&#45;&gt;stage2_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2977.17,-20942.43C2977.01,-20934.62 2976.82,-20925.76 2976.64,-20916.99"/>
<polygon fill="black" stroke="black" points="2980.14,-20916.74 2976.43,-20906.81 2973.14,-20916.88 2980.14,-20916.74"/>
</g>
<!-- stage2_layer1_expert3_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge678" class="edge">
<title>stage2_layer1_expert3_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3138.17,-20844.07C3162.8,-20840.36 3187.91,-20836.59 3211.69,-20833.07 3324.56,-20816.33 3447.57,-20798.38 3559.01,-20782.23"/>
<polygon fill="black" stroke="black" points="3559.67,-20785.67 3569.06,-20780.77 3558.67,-20778.74 3559.67,-20785.67"/>
</g>
<!-- stage2_layer1_expert31_mlp1 -->
<g id="node491" class="node">
<title>stage2_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3699.69,-21280.14 3385.69,-21280.14 3385.69,-21228.14 3699.69,-21228.14 3699.69,-21280.14"/>
<text text-anchor="middle" x="3542.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3542.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3542.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3542.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert31&#45;&gt;stage2_layer1_expert31_mlp1 -->
<g id="edge639" class="edge">
<title>stage2_layer1_expert31&#45;&gt;stage2_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3563.14,-21315.81C3560.4,-21307.67 3557.31,-21298.51 3554.38,-21289.83"/>
<polygon fill="black" stroke="black" points="3557.68,-21288.66 3551.17,-21280.3 3551.05,-21290.89 3557.68,-21288.66"/>
</g>
<!-- stage2_layer1_expert31_tp1 -->
<g id="node492" class="node">
<title>stage2_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3504.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3504.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3504.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="3504.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3504.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert31_mlp1&#45;&gt;stage2_layer1_expert31_tp1 -->
<g id="edge640" class="edge">
<title>stage2_layer1_expert31_mlp1&#45;&gt;stage2_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3532.8,-21227.97C3529.64,-21219.91 3526.03,-21210.72 3522.48,-21201.67"/>
<polygon fill="black" stroke="black" points="3525.73,-21200.38 3518.82,-21192.35 3519.21,-21202.94 3525.73,-21200.38"/>
</g>
<!-- stage2_layer1_expert31_act -->
<g id="node493" class="node">
<title>stage2_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3617.19,-21082.6 3336.19,-21082.6 3336.19,-21030.6 3617.19,-21030.6 3617.19,-21082.6"/>
<text text-anchor="middle" x="3476.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3476.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="3476.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3476.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert31_tp1&#45;&gt;stage2_layer1_expert31_act -->
<g id="edge641" class="edge">
<title>stage2_layer1_expert31_tp1&#45;&gt;stage2_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3494.34,-21118.62C3491.86,-21110.03 3489.21,-21100.86 3486.73,-21092.32"/>
<polygon fill="black" stroke="black" points="3490.08,-21091.28 3483.93,-21082.65 3483.35,-21093.23 3490.08,-21091.28"/>
</g>
<!-- stage2_layer1_expert31_mlp2 -->
<g id="node494" class="node">
<title>stage2_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3623.69,-20994.6 3301.69,-20994.6 3301.69,-20942.6 3623.69,-20942.6 3623.69,-20994.6"/>
<text text-anchor="middle" x="3462.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3462.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3462.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3462.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert31_act&#45;&gt;stage2_layer1_expert31_mlp2 -->
<g id="edge642" class="edge">
<title>stage2_layer1_expert31_act&#45;&gt;stage2_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3472.56,-21030.27C3471.27,-21022.31 3469.81,-21013.37 3468.43,-21004.85"/>
<polygon fill="black" stroke="black" points="3471.85,-21004.07 3466.78,-20994.76 3464.94,-21005.19 3471.85,-21004.07"/>
</g>
<!-- stage2_layer1_expert31_tp2 -->
<g id="node495" class="node">
<title>stage2_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3448.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3448.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3448.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 318&#45;319</text>
<text text-anchor="middle" x="3448.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3448.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert31_mlp2&#45;&gt;stage2_layer1_expert31_tp2 -->
<g id="edge643" class="edge">
<title>stage2_layer1_expert31_mlp2&#45;&gt;stage2_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3459.05,-20942.43C3457.92,-20934.62 3456.63,-20925.76 3455.37,-20916.99"/>
<polygon fill="black" stroke="black" points="3458.79,-20916.21 3453.89,-20906.81 3451.86,-20917.21 3458.79,-20916.21"/>
</g>
<!-- stage2_layer1_expert31_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge679" class="edge">
<title>stage2_layer1_expert31_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3556.02,-20837.35C3594.11,-20826.17 3638.65,-20813.1 3683.28,-20800.01"/>
<polygon fill="black" stroke="black" points="3684.49,-20803.3 3693.1,-20797.13 3682.52,-20796.59 3684.49,-20803.3"/>
</g>
<!-- stage2_layer1_expert32_mlp1 -->
<g id="node497" class="node">
<title>stage2_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="4078.69,-21280.14 3764.69,-21280.14 3764.69,-21228.14 4078.69,-21228.14 4078.69,-21280.14"/>
<text text-anchor="middle" x="3921.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3921.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3921.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert32&#45;&gt;stage2_layer1_expert32_mlp1 -->
<g id="edge645" class="edge">
<title>stage2_layer1_expert32&#45;&gt;stage2_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3921.69,-21315.81C3921.69,-21307.85 3921.69,-21298.91 3921.69,-21290.39"/>
<polygon fill="black" stroke="black" points="3925.19,-21290.3 3921.69,-21280.3 3918.19,-21290.3 3925.19,-21290.3"/>
</g>
<!-- stage2_layer1_expert32_tp1 -->
<g id="node498" class="node">
<title>stage2_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3921.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3921.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="3921.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3921.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert32_mlp1&#45;&gt;stage2_layer1_expert32_tp1 -->
<g id="edge646" class="edge">
<title>stage2_layer1_expert32_mlp1&#45;&gt;stage2_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3921.69,-21227.97C3921.69,-21220.16 3921.69,-21211.3 3921.69,-21202.53"/>
<polygon fill="black" stroke="black" points="3925.19,-21202.35 3921.69,-21192.35 3918.19,-21202.35 3925.19,-21202.35"/>
</g>
<!-- stage2_layer1_expert32_act -->
<g id="node499" class="node">
<title>stage2_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="4062.19,-21082.6 3781.19,-21082.6 3781.19,-21030.6 4062.19,-21030.6 4062.19,-21082.6"/>
<text text-anchor="middle" x="3921.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3921.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="3921.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3921.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert32_tp1&#45;&gt;stage2_layer1_expert32_act -->
<g id="edge647" class="edge">
<title>stage2_layer1_expert32_tp1&#45;&gt;stage2_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3921.69,-21118.34C3921.69,-21110.03 3921.69,-21101.2 3921.69,-21092.91"/>
<polygon fill="black" stroke="black" points="3925.19,-21092.8 3921.69,-21082.8 3918.19,-21092.8 3925.19,-21092.8"/>
</g>
<!-- stage2_layer1_expert32_mlp2 -->
<g id="node500" class="node">
<title>stage2_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="4082.69,-20994.6 3760.69,-20994.6 3760.69,-20942.6 4082.69,-20942.6 4082.69,-20994.6"/>
<text text-anchor="middle" x="3921.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3921.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3921.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3921.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert32_act&#45;&gt;stage2_layer1_expert32_mlp2 -->
<g id="edge648" class="edge">
<title>stage2_layer1_expert32_act&#45;&gt;stage2_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3921.69,-21030.27C3921.69,-21022.31 3921.69,-21013.37 3921.69,-21004.85"/>
<polygon fill="black" stroke="black" points="3925.19,-21004.76 3921.69,-20994.76 3918.19,-21004.76 3925.19,-21004.76"/>
</g>
<!-- stage2_layer1_expert32_tp2 -->
<g id="node501" class="node">
<title>stage2_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3921.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3921.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 320&#45;321</text>
<text text-anchor="middle" x="3921.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert32_mlp2&#45;&gt;stage2_layer1_expert32_tp2 -->
<g id="edge649" class="edge">
<title>stage2_layer1_expert32_mlp2&#45;&gt;stage2_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3921.69,-20942.43C3921.69,-20934.62 3921.69,-20925.76 3921.69,-20916.99"/>
<polygon fill="black" stroke="black" points="3925.19,-20916.81 3921.69,-20906.81 3918.19,-20916.81 3925.19,-20916.81"/>
</g>
<!-- stage2_layer1_expert32_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge680" class="edge">
<title>stage2_layer1_expert32_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3921.69,-20832.74C3921.69,-20824.8 3921.69,-20816.11 3921.69,-20807.24"/>
<polygon fill="black" stroke="black" points="3925.19,-20807.18 3921.69,-20797.18 3918.19,-20807.18 3925.19,-20807.18"/>
</g>
<!-- stage2_layer1_expert60_mlp1 -->
<g id="node503" class="node">
<title>stage2_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4503.69,-21280.14 4189.69,-21280.14 4189.69,-21228.14 4503.69,-21228.14 4503.69,-21280.14"/>
<text text-anchor="middle" x="4346.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4346.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4346.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4346.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert60&#45;&gt;stage2_layer1_expert60_mlp1 -->
<g id="edge651" class="edge">
<title>stage2_layer1_expert60&#45;&gt;stage2_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4322,-21315.81C4325.31,-21307.67 4329.04,-21298.51 4332.57,-21289.83"/>
<polygon fill="black" stroke="black" points="4335.92,-21290.88 4336.45,-21280.3 4329.44,-21288.24 4335.92,-21290.88"/>
</g>
<!-- stage2_layer1_expert60_tp1 -->
<g id="node504" class="node">
<title>stage2_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4353.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4353.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4353.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="4353.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4353.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert60_mlp1&#45;&gt;stage2_layer1_expert60_tp1 -->
<g id="edge652" class="edge">
<title>stage2_layer1_expert60_mlp1&#45;&gt;stage2_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4348.51,-21227.97C4349.07,-21220.16 4349.72,-21211.3 4350.35,-21202.53"/>
<polygon fill="black" stroke="black" points="4353.86,-21202.58 4351.09,-21192.35 4346.87,-21202.07 4353.86,-21202.58"/>
</g>
<!-- stage2_layer1_expert60_act -->
<g id="node505" class="node">
<title>stage2_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4523.19,-21082.6 4242.19,-21082.6 4242.19,-21030.6 4523.19,-21030.6 4523.19,-21082.6"/>
<text text-anchor="middle" x="4382.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4382.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="4382.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4382.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert60_tp1&#45;&gt;stage2_layer1_expert60_act -->
<g id="edge653" class="edge">
<title>stage2_layer1_expert60_tp1&#45;&gt;stage2_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4364.4,-21118.62C4366.98,-21110.03 4369.72,-21100.86 4372.28,-21092.32"/>
<polygon fill="black" stroke="black" points="4375.67,-21093.23 4375.18,-21082.65 4368.96,-21091.22 4375.67,-21093.23"/>
</g>
<!-- stage2_layer1_expert60_mlp2 -->
<g id="node506" class="node">
<title>stage2_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4543.69,-20994.6 4221.69,-20994.6 4221.69,-20942.6 4543.69,-20942.6 4543.69,-20994.6"/>
<text text-anchor="middle" x="4382.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4382.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4382.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4382.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert60_act&#45;&gt;stage2_layer1_expert60_mlp2 -->
<g id="edge654" class="edge">
<title>stage2_layer1_expert60_act&#45;&gt;stage2_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4382.69,-21030.27C4382.69,-21022.31 4382.69,-21013.37 4382.69,-21004.85"/>
<polygon fill="black" stroke="black" points="4386.19,-21004.76 4382.69,-20994.76 4379.19,-21004.76 4386.19,-21004.76"/>
</g>
<!-- stage2_layer1_expert60_tp2 -->
<g id="node507" class="node">
<title>stage2_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4394.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4394.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4394.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 376&#45;377</text>
<text text-anchor="middle" x="4394.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4394.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert60_mlp2&#45;&gt;stage2_layer1_expert60_tp2 -->
<g id="edge655" class="edge">
<title>stage2_layer1_expert60_mlp2&#45;&gt;stage2_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4385.81,-20942.43C4386.78,-20934.62 4387.88,-20925.76 4388.96,-20916.99"/>
<polygon fill="black" stroke="black" points="4392.47,-20917.17 4390.23,-20906.81 4385.52,-20916.31 4392.47,-20917.17"/>
</g>
<!-- stage2_layer1_expert60_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge681" class="edge">
<title>stage2_layer1_expert60_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4287.36,-20837.35C4249.27,-20826.17 4204.73,-20813.1 4160.1,-20800.01"/>
<polygon fill="black" stroke="black" points="4160.86,-20796.59 4150.28,-20797.13 4158.89,-20803.3 4160.86,-20796.59"/>
</g>
<!-- stage2_layer1_expert61_mlp1 -->
<g id="node509" class="node">
<title>stage2_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4839.69,-21280.14 4525.69,-21280.14 4525.69,-21228.14 4839.69,-21228.14 4839.69,-21280.14"/>
<text text-anchor="middle" x="4682.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4682.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4682.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4682.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert61&#45;&gt;stage2_layer1_expert61_mlp1 -->
<g id="edge657" class="edge">
<title>stage2_layer1_expert61&#45;&gt;stage2_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4678.46,-21315.81C4679.01,-21307.85 4679.64,-21298.91 4680.23,-21290.39"/>
<polygon fill="black" stroke="black" points="4683.73,-21290.52 4680.93,-21280.3 4676.75,-21290.03 4683.73,-21290.52"/>
</g>
<!-- stage2_layer1_expert61_tp1 -->
<g id="node510" class="node">
<title>stage2_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4790.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4790.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4790.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="4790.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4790.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert61_mlp1&#45;&gt;stage2_layer1_expert61_tp1 -->
<g id="edge658" class="edge">
<title>stage2_layer1_expert61_mlp1&#45;&gt;stage2_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4710.78,-21227.97C4720.84,-21218.96 4732.46,-21208.55 4743.68,-21198.5"/>
<polygon fill="black" stroke="black" points="4746.24,-21200.9 4751.35,-21191.62 4741.57,-21195.69 4746.24,-21200.9"/>
</g>
<!-- stage2_layer1_expert61_act -->
<g id="node511" class="node">
<title>stage2_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4955.19,-21082.6 4674.19,-21082.6 4674.19,-21030.6 4955.19,-21030.6 4955.19,-21082.6"/>
<text text-anchor="middle" x="4814.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4814.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="4814.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4814.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert61_tp1&#45;&gt;stage2_layer1_expert61_act -->
<g id="edge659" class="edge">
<title>stage2_layer1_expert61_tp1&#45;&gt;stage2_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4799.56,-21118.62C4801.66,-21110.12 4803.91,-21101.06 4806.01,-21092.6"/>
<polygon fill="black" stroke="black" points="4809.47,-21093.2 4808.48,-21082.65 4802.67,-21091.51 4809.47,-21093.2"/>
</g>
<!-- stage2_layer1_expert61_mlp2 -->
<g id="node512" class="node">
<title>stage2_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="5004.69,-20994.6 4682.69,-20994.6 4682.69,-20942.6 5004.69,-20942.6 5004.69,-20994.6"/>
<text text-anchor="middle" x="4843.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4843.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4843.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4843.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert61_act&#45;&gt;stage2_layer1_expert61_mlp2 -->
<g id="edge660" class="edge">
<title>stage2_layer1_expert61_act&#45;&gt;stage2_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4823.23,-21030.27C4825.98,-21022.13 4829.06,-21012.97 4831.99,-21004.29"/>
<polygon fill="black" stroke="black" points="4835.33,-21005.36 4835.21,-20994.76 4828.69,-21003.12 4835.33,-21005.36"/>
</g>
<!-- stage2_layer1_expert61_tp2 -->
<g id="node513" class="node">
<title>stage2_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4867.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4867.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4867.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 378&#45;379</text>
<text text-anchor="middle" x="4867.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4867.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert61_mlp2&#45;&gt;stage2_layer1_expert61_tp2 -->
<g id="edge661" class="edge">
<title>stage2_layer1_expert61_mlp2&#45;&gt;stage2_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4849.93,-20942.43C4851.89,-20934.54 4854.11,-20925.57 4856.31,-20916.7"/>
<polygon fill="black" stroke="black" points="4859.76,-20917.36 4858.77,-20906.81 4852.96,-20915.68 4859.76,-20917.36"/>
</g>
<!-- stage2_layer1_expert61_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge682" class="edge">
<title>stage2_layer1_expert61_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4705.21,-20844.07C4680.58,-20840.36 4655.46,-20836.59 4631.69,-20833.07 4555.78,-20821.81 4475.27,-20810 4396.79,-20798.56"/>
<polygon fill="black" stroke="black" points="4397.13,-20795.08 4386.73,-20797.1 4396.13,-20802 4397.13,-20795.08"/>
</g>
<!-- stage2_layer1_expert62_mlp1 -->
<g id="node515" class="node">
<title>stage2_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5309.69,-21280.14 4995.69,-21280.14 4995.69,-21228.14 5309.69,-21228.14 5309.69,-21280.14"/>
<text text-anchor="middle" x="5152.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="5152.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5152.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5152.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert62&#45;&gt;stage2_layer1_expert62_mlp1 -->
<g id="edge663" class="edge">
<title>stage2_layer1_expert62&#45;&gt;stage2_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M5109.66,-21315.81C5115.68,-21307.32 5122.49,-21297.72 5128.88,-21288.71"/>
<polygon fill="black" stroke="black" points="5131.91,-21290.48 5134.84,-21280.3 5126.2,-21286.43 5131.91,-21290.48"/>
</g>
<!-- stage2_layer1_expert62_tp1 -->
<g id="node516" class="node">
<title>stage2_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5216.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5216.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5216.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="5216.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5216.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert62_mlp1&#45;&gt;stage2_layer1_expert62_tp1 -->
<g id="edge664" class="edge">
<title>stage2_layer1_expert62_mlp1&#45;&gt;stage2_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5169.34,-21227.97C5174.89,-21219.57 5181.26,-21209.94 5187.49,-21200.53"/>
<polygon fill="black" stroke="black" points="5190.54,-21202.26 5193.14,-21191.98 5184.7,-21198.4 5190.54,-21202.26"/>
</g>
<!-- stage2_layer1_expert62_act -->
<g id="node517" class="node">
<title>stage2_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5380.19,-21082.6 5099.19,-21082.6 5099.19,-21030.6 5380.19,-21030.6 5380.19,-21082.6"/>
<text text-anchor="middle" x="5239.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5239.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="5239.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5239.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert62_tp1&#45;&gt;stage2_layer1_expert62_act -->
<g id="edge665" class="edge">
<title>stage2_layer1_expert62_tp1&#45;&gt;stage2_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5225.19,-21118.62C5227.21,-21110.12 5229.36,-21101.06 5231.37,-21092.6"/>
<polygon fill="black" stroke="black" points="5234.83,-21093.19 5233.74,-21082.65 5228.02,-21091.57 5234.83,-21093.19"/>
</g>
<!-- stage2_layer1_expert62_mlp2 -->
<g id="node518" class="node">
<title>stage2_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5458.69,-20994.6 5136.69,-20994.6 5136.69,-20942.6 5458.69,-20942.6 5458.69,-20994.6"/>
<text text-anchor="middle" x="5297.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5297.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5297.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5297.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert62_act&#45;&gt;stage2_layer1_expert62_mlp2 -->
<g id="edge666" class="edge">
<title>stage2_layer1_expert62_act&#45;&gt;stage2_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5256.78,-21030.27C5262.5,-21021.78 5268.97,-21012.19 5275.05,-21003.17"/>
<polygon fill="black" stroke="black" points="5278.03,-21005.01 5280.72,-20994.76 5272.23,-21001.1 5278.03,-21005.01"/>
</g>
<!-- stage2_layer1_expert62_tp2 -->
<g id="node519" class="node">
<title>stage2_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5340.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5340.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5340.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 380&#45;381</text>
<text text-anchor="middle" x="5340.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5340.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert62_mlp2&#45;&gt;stage2_layer1_expert62_tp2 -->
<g id="edge667" class="edge">
<title>stage2_layer1_expert62_mlp2&#45;&gt;stage2_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5308.87,-20942.43C5312.46,-20934.37 5316.54,-20925.18 5320.56,-20916.13"/>
<polygon fill="black" stroke="black" points="5323.84,-20917.37 5324.7,-20906.81 5317.44,-20914.53 5323.84,-20917.37"/>
</g>
<!-- stage2_layer1_expert62_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge683" class="edge">
<title>stage2_layer1_expert62_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5182.19,-20843.4C5156.33,-20839.65 5129.79,-20836.06 5104.69,-20833.07 4884.65,-20806.84 4640.82,-20784.48 4431.99,-20767.36"/>
<polygon fill="black" stroke="black" points="4432,-20763.85 4421.75,-20766.52 4431.43,-20770.83 4432,-20763.85"/>
</g>
<!-- stage2_layer1_expert63_mlp1 -->
<g id="node521" class="node">
<title>stage2_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5645.69,-21280.14 5331.69,-21280.14 5331.69,-21228.14 5645.69,-21228.14 5645.69,-21280.14"/>
<text text-anchor="middle" x="5488.69" y="-21268.14" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5488.69" y="-21257.14" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5488.69" y="-21246.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5488.69" y="-21235.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage2_layer1_expert63&#45;&gt;stage2_layer1_expert63_mlp1 -->
<g id="edge669" class="edge">
<title>stage2_layer1_expert63&#45;&gt;stage2_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5475.29,-21315.81C5477.06,-21307.76 5479.06,-21298.71 5480.96,-21290.11"/>
<polygon fill="black" stroke="black" points="5484.39,-21290.82 5483.13,-21280.3 5477.56,-21289.31 5484.39,-21290.82"/>
</g>
<!-- stage2_layer1_expert63_tp1 -->
<g id="node522" class="node">
<title>stage2_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5683.69" cy="-21155.37" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5683.69" y="-21169.37" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5683.69" y="-21158.37" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="5683.69" y="-21147.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5683.69" y="-21136.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert63_mlp1&#45;&gt;stage2_layer1_expert63_tp1 -->
<g id="edge670" class="edge">
<title>stage2_layer1_expert63_mlp1&#45;&gt;stage2_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5539.16,-21228.1C5559.78,-21217.86 5584.09,-21205.8 5606.84,-21194.51"/>
<polygon fill="black" stroke="black" points="5608.4,-21197.65 5615.8,-21190.07 5605.28,-21191.38 5608.4,-21197.65"/>
</g>
<!-- stage2_layer1_expert63_act -->
<g id="node523" class="node">
<title>stage2_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5856.19,-21082.6 5575.19,-21082.6 5575.19,-21030.6 5856.19,-21030.6 5856.19,-21082.6"/>
<text text-anchor="middle" x="5715.69" y="-21070.6" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5715.69" y="-21059.6" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="5715.69" y="-21048.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5715.69" y="-21037.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage2_layer1_expert63_tp1&#45;&gt;stage2_layer1_expert63_act -->
<g id="edge671" class="edge">
<title>stage2_layer1_expert63_tp1&#45;&gt;stage2_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5695.51,-21118.62C5698.35,-21110.03 5701.38,-21100.86 5704.21,-21092.32"/>
<polygon fill="black" stroke="black" points="5707.59,-21093.24 5707.41,-21082.65 5700.94,-21091.04 5707.59,-21093.24"/>
</g>
<!-- stage2_layer1_expert63_mlp2 -->
<g id="node524" class="node">
<title>stage2_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5908.69,-20994.6 5586.69,-20994.6 5586.69,-20942.6 5908.69,-20942.6 5908.69,-20994.6"/>
<text text-anchor="middle" x="5747.69" y="-20982.6" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5747.69" y="-20971.6" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5747.69" y="-20960.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5747.69" y="-20949.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert63_act&#45;&gt;stage2_layer1_expert63_mlp2 -->
<g id="edge672" class="edge">
<title>stage2_layer1_expert63_act&#45;&gt;stage2_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5725.12,-21030.27C5728.14,-21022.13 5731.55,-21012.97 5734.78,-21004.29"/>
<polygon fill="black" stroke="black" points="5738.12,-21005.35 5738.33,-20994.76 5731.56,-21002.91 5738.12,-21005.35"/>
</g>
<!-- stage2_layer1_expert63_tp2 -->
<g id="node525" class="node">
<title>stage2_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5813.69" cy="-20869.84" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5813.69" y="-20883.84" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5813.69" y="-20872.84" font-family="Times,serif" font-size="10.00">GPU: 382&#45;383</text>
<text text-anchor="middle" x="5813.69" y="-20861.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5813.69" y="-20850.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert63_mlp2&#45;&gt;stage2_layer1_expert63_tp2 -->
<g id="edge673" class="edge">
<title>stage2_layer1_expert63_mlp2&#45;&gt;stage2_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5764.86,-20942.43C5770.59,-20934.03 5777.15,-20924.4 5783.57,-20914.99"/>
<polygon fill="black" stroke="black" points="5786.66,-20916.68 5789.4,-20906.45 5780.87,-20912.74 5786.66,-20916.68"/>
</g>
<!-- stage2_layer1_expert63_tp2&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge684" class="edge">
<title>stage2_layer1_expert63_tp2&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5657.16,-20843.13C5630.69,-20839.35 5603.44,-20835.81 5577.69,-20833.07 5182.75,-20790.94 4732.84,-20764.31 4401.75,-20748.71"/>
<polygon fill="black" stroke="black" points="4401.65,-20745.2 4391.49,-20748.23 4401.32,-20752.19 4401.65,-20745.2"/>
</g>
<!-- stage2_layer1_expert_ellipsis&#45;&gt;stage2_layer1_expert_agg -->
<g id="edge685" class="edge">
<title>stage2_layer1_expert_ellipsis&#45;&gt;stage2_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6054.72,-21227.91C6060.3,-21190.73 6069.69,-21119 6069.69,-21057.6 6069.69,-21057.6 6069.69,-21057.6 6069.69,-20967.6 6069.69,-20907.22 6095.31,-20873.76 6050.69,-20833.07 5990.07,-20777.78 4991.4,-20749.66 4383.67,-20737.6"/>
<polygon fill="black" stroke="black" points="4383.48,-20734.1 4373.41,-20737.4 4383.34,-20741.09 4383.48,-20734.1"/>
</g>
<!-- stage2_layer1_output -->
<g id="node528" class="node">
<title>stage2_layer1_output</title>
<polygon fill="none" stroke="black" points="4146.69,-20625.07 3696.69,-20625.07 3696.69,-20557.07 4146.69,-20557.07 4146.69,-20625.07"/>
<text text-anchor="middle" x="3921.69" y="-20609.87" font-family="Times,serif" font-size="14.00">Layer 5 Output</text>
<text text-anchor="middle" x="3921.69" y="-20594.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-20579.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20564.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_expert_agg&#45;&gt;stage2_layer1_output -->
<g id="edge686" class="edge">
<title>stage2_layer1_expert_agg&#45;&gt;stage2_layer1_output</title>
<path fill="none" stroke="black" d="M3921.69,-20660.86C3921.69,-20652.11 3921.69,-20643.34 3921.69,-20635.13"/>
<polygon fill="black" stroke="black" points="3925.19,-20635.08 3921.69,-20625.08 3918.19,-20635.08 3925.19,-20635.08"/>
</g>
<!-- stage2_output -->
<g id="node529" class="node">
<title>stage2_output</title>
<polygon fill="none" stroke="black" points="4388.27,-20521.07 3646.05,-20521.07 3455.11,-20385.07 4197.33,-20385.07 4388.27,-20521.07"/>
<text text-anchor="middle" x="3921.69" y="-20471.87" font-family="Times,serif" font-size="14.00">Stage 2 Output</text>
<text text-anchor="middle" x="3921.69" y="-20456.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 2</text>
<text text-anchor="middle" x="3921.69" y="-20441.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20426.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_layer1_output&#45;&gt;stage2_output -->
<g id="edge687" class="edge">
<title>stage2_layer1_output&#45;&gt;stage2_output</title>
<path fill="none" stroke="black" d="M3921.69,-20556.8C3921.69,-20548.97 3921.69,-20540.3 3921.69,-20531.42"/>
<polygon fill="black" stroke="black" points="3925.19,-20531.33 3921.69,-20521.33 3918.19,-20531.33 3925.19,-20531.33"/>
</g>
<!-- stage3_input -->
<g id="node530" class="node">
<title>stage3_input</title>
<polygon fill="none" stroke="black" points="4388.27,-20349.07 3646.05,-20349.07 3455.11,-20213.07 4197.33,-20213.07 4388.27,-20349.07"/>
<text text-anchor="middle" x="3921.69" y="-20299.87" font-family="Times,serif" font-size="14.00">Stage 3 Input Router</text>
<text text-anchor="middle" x="3921.69" y="-20284.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3921.69" y="-20269.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20254.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage2_output&#45;&gt;stage3_input -->
<g id="edge688" class="edge">
<title>stage2_output&#45;&gt;stage3_input</title>
<path fill="none" stroke="black" d="M3921.69,-20384.88C3921.69,-20376.56 3921.69,-20368.01 3921.69,-20359.56"/>
<polygon fill="black" stroke="black" points="3925.19,-20359.32 3921.69,-20349.32 3918.19,-20359.32 3925.19,-20359.32"/>
</g>
<!-- stage3_layer0_ln -->
<g id="node531" class="node">
<title>stage3_layer0_ln</title>
<polygon fill="none" stroke="black" points="4146.69,-20177.07 3696.69,-20177.07 3696.69,-20109.07 4146.69,-20109.07 4146.69,-20177.07"/>
<text text-anchor="middle" x="3921.69" y="-20161.87" font-family="Times,serif" font-size="14.00">Layer 6 LayerNorm</text>
<text text-anchor="middle" x="3921.69" y="-20146.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3921.69" y="-20131.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20116.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_input&#45;&gt;stage3_layer0_ln -->
<g id="edge689" class="edge">
<title>stage3_input&#45;&gt;stage3_layer0_ln</title>
<path fill="none" stroke="black" d="M3921.69,-20212.86C3921.69,-20204.11 3921.69,-20195.34 3921.69,-20187.13"/>
<polygon fill="black" stroke="black" points="3925.19,-20187.08 3921.69,-20177.08 3918.19,-20187.08 3925.19,-20187.08"/>
</g>
<!-- stage3_layer0_attn_qkv -->
<g id="node532" class="node">
<title>stage3_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4153.19,-20073.07 3690.19,-20073.07 3690.19,-20005.07 4153.19,-20005.07 4153.19,-20073.07"/>
<text text-anchor="middle" x="3921.69" y="-20057.87" font-family="Times,serif" font-size="14.00">Layer 6 Attention QKV Projection</text>
<text text-anchor="middle" x="3921.69" y="-20042.87" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP: GPU 384&#45;511)</text>
<text text-anchor="middle" x="3921.69" y="-20027.87" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-20012.87" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage3_layer0_ln&#45;&gt;stage3_layer0_attn_qkv -->
<g id="edge690" class="edge">
<title>stage3_layer0_ln&#45;&gt;stage3_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3921.69,-20108.95C3921.69,-20100.84 3921.69,-20092.05 3921.69,-20083.54"/>
<polygon fill="black" stroke="black" points="3925.19,-20083.37 3921.69,-20073.37 3918.19,-20083.37 3925.19,-20083.37"/>
</g>
<!-- stage3_layer0_tp_qkv_comm -->
<g id="node533" class="node">
<title>stage3_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-19920.98" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3921.69" y="-19939.78" font-family="Times,serif" font-size="14.00">Layer 6 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3921.69" y="-19924.78" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP pairs)</text>
<text text-anchor="middle" x="3921.69" y="-19909.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-19894.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage3_layer0_attn_qkv&#45;&gt;stage3_layer0_tp_qkv_comm -->
<g id="edge691" class="edge">
<title>stage3_layer0_attn_qkv&#45;&gt;stage3_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3921.69,-20004.8C3921.69,-19996.81 3921.69,-19988.04 3921.69,-19979.3"/>
<polygon fill="black" stroke="black" points="3925.19,-19979.09 3921.69,-19969.09 3918.19,-19979.09 3925.19,-19979.09"/>
</g>
<!-- stage3_layer0_attn_head0 -->
<g id="node534" class="node">
<title>stage3_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1730.19,-19836.9 1457.19,-19836.9 1457.19,-19784.9 1730.19,-19784.9 1730.19,-19836.9"/>
<text text-anchor="middle" x="1593.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 0 Attention</text>
<text text-anchor="middle" x="1593.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 0)</text>
<text text-anchor="middle" x="1593.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1593.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head0 -->
<g id="edge692" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3598.67,-19912.96C3086.05,-19900.92 2107.56,-19874.12 1740.38,-19837.01"/>
<polygon fill="black" stroke="black" points="1740.54,-19833.5 1730.23,-19835.96 1739.82,-19840.47 1740.54,-19833.5"/>
</g>
<!-- stage3_layer0_attn_head1 -->
<g id="node535" class="node">
<title>stage3_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="2021.19,-19836.9 1748.19,-19836.9 1748.19,-19784.9 2021.19,-19784.9 2021.19,-19836.9"/>
<text text-anchor="middle" x="1884.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 1 Attention</text>
<text text-anchor="middle" x="1884.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 1)</text>
<text text-anchor="middle" x="1884.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1884.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head1 -->
<g id="edge693" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3594.73,-19918.19C3219.12,-19913.24 2584.43,-19896.03 2031.41,-19837.03"/>
<polygon fill="black" stroke="black" points="2031.55,-19833.52 2021.23,-19835.94 2030.8,-19840.48 2031.55,-19833.52"/>
</g>
<!-- stage3_layer0_attn_head2 -->
<g id="node536" class="node">
<title>stage3_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2312.19,-19836.9 2039.19,-19836.9 2039.19,-19784.9 2312.19,-19784.9 2312.19,-19836.9"/>
<text text-anchor="middle" x="2175.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 2 Attention</text>
<text text-anchor="middle" x="2175.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 2)</text>
<text text-anchor="middle" x="2175.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2175.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head2 -->
<g id="edge694" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3597.26,-19914.44C3275.63,-19906.32 2768.92,-19886.43 2322.44,-19837.04"/>
<polygon fill="black" stroke="black" points="2322.56,-19833.53 2312.24,-19835.91 2321.79,-19840.49 2322.56,-19833.53"/>
</g>
<!-- stage3_layer0_attn_head3 -->
<g id="node537" class="node">
<title>stage3_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2603.19,-19836.9 2330.19,-19836.9 2330.19,-19784.9 2603.19,-19784.9 2603.19,-19836.9"/>
<text text-anchor="middle" x="2466.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 3 Attention</text>
<text text-anchor="middle" x="2466.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 3)</text>
<text text-anchor="middle" x="2466.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2466.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head3 -->
<g id="edge695" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3603.84,-19909.38C3340.62,-19898.33 2956.78,-19877 2613.39,-19837.05"/>
<polygon fill="black" stroke="black" points="2613.58,-19833.55 2603.24,-19835.86 2612.77,-19840.5 2613.58,-19833.55"/>
</g>
<!-- stage3_layer0_attn_head4 -->
<g id="node538" class="node">
<title>stage3_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2894.19,-19836.9 2621.19,-19836.9 2621.19,-19784.9 2894.19,-19784.9 2894.19,-19836.9"/>
<text text-anchor="middle" x="2757.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 4 Attention</text>
<text text-anchor="middle" x="2757.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 4)</text>
<text text-anchor="middle" x="2757.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2757.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head4 -->
<g id="edge696" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3619.43,-19902.45C3419.07,-19889.1 3150.29,-19867.92 2904.46,-19837.08"/>
<polygon fill="black" stroke="black" points="2904.61,-19833.57 2894.25,-19835.79 2903.73,-19840.52 2904.61,-19833.57"/>
</g>
<!-- stage3_layer0_attn_head5 -->
<g id="node539" class="node">
<title>stage3_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3185.19,-19836.9 2912.19,-19836.9 2912.19,-19784.9 3185.19,-19784.9 3185.19,-19836.9"/>
<text text-anchor="middle" x="3048.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 5 Attention</text>
<text text-anchor="middle" x="3048.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 5)</text>
<text text-anchor="middle" x="3048.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3048.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head5 -->
<g id="edge697" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3654.12,-19893.14C3519.28,-19878.7 3353.06,-19859.51 3195.62,-19837.15"/>
<polygon fill="black" stroke="black" points="3195.66,-19833.62 3185.27,-19835.67 3194.67,-19840.55 3195.66,-19833.62"/>
</g>
<!-- stage3_layer0_attn_head6 -->
<g id="node540" class="node">
<title>stage3_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3476.19,-19836.9 3203.19,-19836.9 3203.19,-19784.9 3476.19,-19784.9 3476.19,-19836.9"/>
<text text-anchor="middle" x="3339.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 6 Attention</text>
<text text-anchor="middle" x="3339.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 6)</text>
<text text-anchor="middle" x="3339.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3339.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head6 -->
<g id="edge698" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3721.8,-19882.86C3643.89,-19868.39 3556.29,-19852.12 3484.64,-19838.82"/>
<polygon fill="black" stroke="black" points="3485.1,-19835.34 3474.63,-19836.96 3483.83,-19842.23 3485.1,-19835.34"/>
</g>
<!-- stage3_layer0_attn_head7 -->
<g id="node541" class="node">
<title>stage3_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3767.19,-19836.9 3494.19,-19836.9 3494.19,-19784.9 3767.19,-19784.9 3767.19,-19836.9"/>
<text text-anchor="middle" x="3630.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 7 Attention</text>
<text text-anchor="middle" x="3630.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 7)</text>
<text text-anchor="middle" x="3630.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3630.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head7 -->
<g id="edge699" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3803.33,-19876.02C3771.09,-19864.05 3737.02,-19851.39 3707.74,-19840.52"/>
<polygon fill="black" stroke="black" points="3708.59,-19837.1 3698,-19836.9 3706.15,-19843.66 3708.59,-19837.1"/>
</g>
<!-- stage3_layer0_attn_ellipsis -->
<g id="node542" class="node">
<title>stage3_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4058.19,-19836.9 3785.19,-19836.9 3785.19,-19784.9 4058.19,-19784.9 4058.19,-19836.9"/>
<text text-anchor="middle" x="3921.69" y="-19824.9" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3921.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3921.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_ellipsis -->
<g id="edge700" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3921.69,-19872.89C3921.69,-19864.35 3921.69,-19855.57 3921.69,-19847.43"/>
<polygon fill="black" stroke="black" points="3925.19,-19847.16 3921.69,-19837.16 3918.19,-19847.16 3925.19,-19847.16"/>
</g>
<!-- stage3_layer0_attn_head24 -->
<g id="node543" class="node">
<title>stage3_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4349.19,-19836.9 4076.19,-19836.9 4076.19,-19784.9 4349.19,-19784.9 4349.19,-19836.9"/>
<text text-anchor="middle" x="4212.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 24 Attention</text>
<text text-anchor="middle" x="4212.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 24)</text>
<text text-anchor="middle" x="4212.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4212.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head24 -->
<g id="edge701" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M4040.05,-19876.02C4072.28,-19864.05 4106.36,-19851.39 4135.64,-19840.52"/>
<polygon fill="black" stroke="black" points="4137.22,-19843.66 4145.38,-19836.9 4134.79,-19837.1 4137.22,-19843.66"/>
</g>
<!-- stage3_layer0_attn_head25 -->
<g id="node544" class="node">
<title>stage3_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4640.19,-19836.9 4367.19,-19836.9 4367.19,-19784.9 4640.19,-19784.9 4640.19,-19836.9"/>
<text text-anchor="middle" x="4503.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 25 Attention</text>
<text text-anchor="middle" x="4503.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 25)</text>
<text text-anchor="middle" x="4503.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4503.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head25 -->
<g id="edge702" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M4121.57,-19882.86C4199.48,-19868.39 4287.09,-19852.12 4358.74,-19838.82"/>
<polygon fill="black" stroke="black" points="4359.55,-19842.23 4368.74,-19836.96 4358.27,-19835.34 4359.55,-19842.23"/>
</g>
<!-- stage3_layer0_attn_head26 -->
<g id="node545" class="node">
<title>stage3_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4931.19,-19836.9 4658.19,-19836.9 4658.19,-19784.9 4931.19,-19784.9 4931.19,-19836.9"/>
<text text-anchor="middle" x="4794.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 26 Attention</text>
<text text-anchor="middle" x="4794.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 26)</text>
<text text-anchor="middle" x="4794.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4794.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head26 -->
<g id="edge703" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4188.45,-19893.1C4323.31,-19878.62 4489.69,-19859.39 4648.01,-19836.96"/>
<polygon fill="black" stroke="black" points="4648.54,-19840.43 4657.95,-19835.55 4647.55,-19833.5 4648.54,-19840.43"/>
</g>
<!-- stage3_layer0_attn_head27 -->
<g id="node546" class="node">
<title>stage3_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5222.19,-19836.9 4949.19,-19836.9 4949.19,-19784.9 5222.19,-19784.9 5222.19,-19836.9"/>
<text text-anchor="middle" x="5085.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 27 Attention</text>
<text text-anchor="middle" x="5085.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 27)</text>
<text text-anchor="middle" x="5085.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5085.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head27 -->
<g id="edge704" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4223.64,-19902.34C4423.8,-19888.95 4692.31,-19867.76 4938.73,-19836.97"/>
<polygon fill="black" stroke="black" points="4939.48,-19840.41 4948.96,-19835.69 4938.61,-19833.46 4939.48,-19840.41"/>
</g>
<!-- stage3_layer0_attn_head28 -->
<g id="node547" class="node">
<title>stage3_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5513.19,-19836.9 5240.19,-19836.9 5240.19,-19784.9 5513.19,-19784.9 5513.19,-19836.9"/>
<text text-anchor="middle" x="5376.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 28 Attention</text>
<text text-anchor="middle" x="5376.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 28)</text>
<text text-anchor="middle" x="5376.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5376.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head28 -->
<g id="edge705" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4239.28,-19909.27C4502.3,-19898.15 4885.83,-19876.79 5229.81,-19836.95"/>
<polygon fill="black" stroke="black" points="5230.45,-19840.4 5239.97,-19835.76 5229.64,-19833.44 5230.45,-19840.4"/>
</g>
<!-- stage3_layer0_attn_head29 -->
<g id="node548" class="node">
<title>stage3_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5804.19,-19836.9 5531.19,-19836.9 5531.19,-19784.9 5804.19,-19784.9 5804.19,-19836.9"/>
<text text-anchor="middle" x="5667.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 29 Attention</text>
<text text-anchor="middle" x="5667.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 29)</text>
<text text-anchor="middle" x="5667.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5667.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head29 -->
<g id="edge706" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4246.28,-19914.32C4567.72,-19906.1 5073.89,-19886.14 5520.77,-19836.94"/>
<polygon fill="black" stroke="black" points="5521.43,-19840.39 5530.98,-19835.81 5520.66,-19833.43 5521.43,-19840.39"/>
</g>
<!-- stage3_layer0_attn_head30 -->
<g id="node549" class="node">
<title>stage3_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="6095.19,-19836.9 5822.19,-19836.9 5822.19,-19784.9 6095.19,-19784.9 6095.19,-19836.9"/>
<text text-anchor="middle" x="5958.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 30 Attention</text>
<text text-anchor="middle" x="5958.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 30)</text>
<text text-anchor="middle" x="5958.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5958.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head30 -->
<g id="edge707" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4248.89,-19918.06C4624.34,-19912.99 5258.41,-19895.67 5811.8,-19836.93"/>
<polygon fill="black" stroke="black" points="5812.41,-19840.38 5821.98,-19835.84 5811.67,-19833.42 5812.41,-19840.38"/>
</g>
<!-- stage3_layer0_attn_head31 -->
<g id="node550" class="node">
<title>stage3_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6386.19,-19836.9 6113.19,-19836.9 6113.19,-19784.9 6386.19,-19784.9 6386.19,-19836.9"/>
<text text-anchor="middle" x="6249.69" y="-19824.9" font-family="Times,serif" font-size="10.00">Layer 6 Head 31 Attention</text>
<text text-anchor="middle" x="6249.69" y="-19813.9" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 31)</text>
<text text-anchor="middle" x="6249.69" y="-19802.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6249.69" y="-19791.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head31 -->
<g id="edge708" class="edge">
<title>stage3_layer0_tp_qkv_comm&#45;&gt;stage3_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4244.55,-19912.91C4756.93,-19900.81 5734.97,-19873.91 6102.81,-19836.91"/>
<polygon fill="black" stroke="black" points="6103.39,-19840.37 6112.99,-19835.87 6102.68,-19833.41 6103.39,-19840.37"/>
</g>
<!-- stage3_layer0_attn_agg -->
<g id="node551" class="node">
<title>stage3_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4389.34,-19748.9 3645.41,-19748.9 3454.04,-19612.9 4197.97,-19612.9 4389.34,-19748.9"/>
<text text-anchor="middle" x="3921.69" y="-19699.7" font-family="Times,serif" font-size="14.00">Layer 6 Attention Aggregate</text>
<text text-anchor="middle" x="3921.69" y="-19684.7" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3921.69" y="-19669.7" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3921.69" y="-19654.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_attn_head0&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge709" class="edge">
<title>stage3_layer0_attn_head0&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1730.23,-19785.87C1733.07,-19785.53 1735.9,-19785.2 1738.69,-19784.9 2370.18,-19715.83 3109.43,-19693.05 3545.36,-19685.55"/>
<polygon fill="black" stroke="black" points="3545.67,-19689.05 3555.61,-19685.38 3545.55,-19682.05 3545.67,-19689.05"/>
</g>
<!-- stage3_layer0_attn_head1&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge710" class="edge">
<title>stage3_layer0_attn_head1&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2021.24,-19785.9C2024.08,-19785.55 2026.9,-19785.21 2029.69,-19784.9 2555.99,-19725.41 3168.69,-19700.01 3550.91,-19689.35"/>
<polygon fill="black" stroke="black" points="3551.12,-19692.84 3561.02,-19689.07 3550.93,-19685.84 3551.12,-19692.84"/>
</g>
<!-- stage3_layer0_attn_head2&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge711" class="edge">
<title>stage3_layer0_attn_head2&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2312.24,-19785.94C2315.08,-19785.58 2317.9,-19785.23 2320.69,-19784.9 2743.66,-19734.97 3232.57,-19707.94 3557.72,-19694.27"/>
<polygon fill="black" stroke="black" points="3557.93,-19697.76 3567.77,-19693.85 3557.63,-19690.77 3557.93,-19697.76"/>
</g>
<!-- stage3_layer0_attn_head3&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge712" class="edge">
<title>stage3_layer0_attn_head3&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2603.25,-19785.99C2606.08,-19785.61 2608.9,-19785.25 2611.69,-19784.9 2933.79,-19744.56 3302.56,-19717.24 3566.59,-19700.93"/>
<polygon fill="black" stroke="black" points="3566.96,-19704.42 3576.72,-19700.31 3566.53,-19697.43 3566.96,-19704.42"/>
</g>
<!-- stage3_layer0_attn_head4&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge713" class="edge">
<title>stage3_layer0_attn_head4&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2894.26,-19786.08C2897.09,-19785.67 2899.9,-19785.28 2902.69,-19784.9 3127.59,-19754.18 3381.58,-19728.49 3579.72,-19710.45"/>
<polygon fill="black" stroke="black" points="3580.07,-19713.93 3589.71,-19709.54 3579.43,-19706.96 3580.07,-19713.93"/>
</g>
<!-- stage3_layer0_attn_head5&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge714" class="edge">
<title>stage3_layer0_attn_head5&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3185.28,-19786.23C3188.11,-19785.78 3190.91,-19785.33 3193.69,-19784.9 3326.44,-19764.07 3473.12,-19742.95 3599.83,-19725.31"/>
<polygon fill="black" stroke="black" points="3600.65,-19728.73 3610.08,-19723.88 3599.69,-19721.79 3600.65,-19728.73"/>
</g>
<!-- stage3_layer0_attn_head6&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge715" class="edge">
<title>stage3_layer0_attn_head6&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3453.63,-19784.84C3504.21,-19773.72 3566.29,-19760.06 3628.5,-19746.38"/>
<polygon fill="black" stroke="black" points="3629.47,-19749.75 3638.49,-19744.18 3627.97,-19742.91 3629.47,-19749.75"/>
</g>
<!-- stage3_layer0_attn_head7&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge716" class="edge">
<title>stage3_layer0_attn_head7&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3687.83,-19784.76C3709.01,-19775.45 3734.2,-19764.37 3760.08,-19752.99"/>
<polygon fill="black" stroke="black" points="3761.51,-19756.18 3769.25,-19748.95 3758.69,-19749.77 3761.51,-19756.18"/>
</g>
<!-- stage3_layer0_attn_ellipsis&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge717" class="edge">
<title>stage3_layer0_attn_ellipsis&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3921.69,-19784.61C3921.69,-19777.01 3921.69,-19768.25 3921.69,-19759.11"/>
<polygon fill="black" stroke="black" points="3925.19,-19759.08 3921.69,-19749.08 3918.19,-19759.08 3925.19,-19759.08"/>
</g>
<!-- stage3_layer0_attn_head24&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge718" class="edge">
<title>stage3_layer0_attn_head24&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4155.54,-19784.76C4134.37,-19775.45 4109.18,-19764.37 4083.3,-19752.99"/>
<polygon fill="black" stroke="black" points="4084.69,-19749.77 4074.12,-19748.95 4081.87,-19756.18 4084.69,-19749.77"/>
</g>
<!-- stage3_layer0_attn_head25&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge719" class="edge">
<title>stage3_layer0_attn_head25&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4389.74,-19784.84C4345.03,-19775 4291.31,-19763.19 4236.45,-19751.13"/>
<polygon fill="black" stroke="black" points="4237.08,-19747.68 4226.56,-19748.95 4235.58,-19754.52 4237.08,-19747.68"/>
</g>
<!-- stage3_layer0_attn_head26&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge720" class="edge">
<title>stage3_layer0_attn_head26&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4657.93,-19786.36C4654.82,-19785.86 4651.74,-19785.38 4648.69,-19784.9 4566.61,-19772.06 4479.21,-19759.08 4394.51,-19746.87"/>
<polygon fill="black" stroke="black" points="4394.86,-19743.39 4384.46,-19745.42 4393.86,-19750.31 4394.86,-19743.39"/>
</g>
<!-- stage3_layer0_attn_head27&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge721" class="edge">
<title>stage3_layer0_attn_head27&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4948.95,-19786.19C4945.84,-19785.75 4942.75,-19785.32 4939.69,-19784.9 4749.01,-19758.96 4537.43,-19736.53 4356.77,-19719.28"/>
<polygon fill="black" stroke="black" points="4356.84,-19715.78 4346.56,-19718.31 4356.18,-19722.74 4356.84,-19715.78"/>
</g>
<!-- stage3_layer0_attn_head28&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge722" class="edge">
<title>stage3_layer0_attn_head28&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5239.97,-19786.1C5236.85,-19785.68 5233.75,-19785.28 5230.69,-19784.9 4932.68,-19747.74 4594.74,-19721.55 4336.88,-19704.88"/>
<polygon fill="black" stroke="black" points="4336.79,-19701.36 4326.59,-19704.21 4336.34,-19708.35 4336.79,-19701.36"/>
</g>
<!-- stage3_layer0_attn_head29&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge723" class="edge">
<title>stage3_layer0_attn_head29&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5530.97,-19786.04C5527.85,-19785.64 5524.75,-19785.26 5521.69,-19784.9 5115.71,-19737.21 4648.99,-19710.34 4324.82,-19696.1"/>
<polygon fill="black" stroke="black" points="4324.94,-19692.6 4314.79,-19695.66 4324.63,-19699.59 4324.94,-19692.6"/>
</g>
<!-- stage3_layer0_attn_head30&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge724" class="edge">
<title>stage3_layer0_attn_head30&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5821.98,-19786C5818.85,-19785.61 5815.75,-19785.24 5812.69,-19784.9 5297.76,-19726.98 4700.15,-19701.34 4316.82,-19690.18"/>
<polygon fill="black" stroke="black" points="4316.77,-19686.68 4306.67,-19689.89 4316.57,-19693.68 4316.77,-19686.68"/>
</g>
<!-- stage3_layer0_attn_head31&#45;&gt;stage3_layer0_attn_agg -->
<g id="edge725" class="edge">
<title>stage3_layer0_attn_head31&#45;&gt;stage3_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6112.98,-19785.97C6109.86,-19785.59 6106.76,-19785.23 6103.69,-19784.9 5478.76,-19716.9 4748.31,-19693.78 4310.99,-19685.92"/>
<polygon fill="black" stroke="black" points="4310.77,-19682.42 4300.71,-19685.74 4310.65,-19689.42 4310.77,-19682.42"/>
</g>
<!-- stage3_layer0_attn_out -->
<g id="node552" class="node">
<title>stage3_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="4146.69,-19576.9 3696.69,-19576.9 3696.69,-19508.9 4146.69,-19508.9 4146.69,-19576.9"/>
<text text-anchor="middle" x="3921.69" y="-19561.7" font-family="Times,serif" font-size="14.00">Layer 6 Attention Output Proj</text>
<text text-anchor="middle" x="3921.69" y="-19546.7" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP: GPU 384&#45;511)</text>
<text text-anchor="middle" x="3921.69" y="-19531.7" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-19516.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_attn_agg&#45;&gt;stage3_layer0_attn_out -->
<g id="edge726" class="edge">
<title>stage3_layer0_attn_agg&#45;&gt;stage3_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3921.69,-19612.7C3921.69,-19603.94 3921.69,-19595.17 3921.69,-19586.97"/>
<polygon fill="black" stroke="black" points="3925.19,-19586.92 3921.69,-19576.92 3918.19,-19586.92 3925.19,-19586.92"/>
</g>
<!-- stage3_layer0_tp_attn_comm -->
<g id="node553" class="node">
<title>stage3_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3921.69" cy="-19424.82" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3921.69" y="-19443.62" font-family="Times,serif" font-size="14.00">Layer 6 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3921.69" y="-19428.62" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP pairs)</text>
<text text-anchor="middle" x="3921.69" y="-19413.62" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3921.69" y="-19398.62" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_attn_out&#45;&gt;stage3_layer0_tp_attn_comm -->
<g id="edge727" class="edge">
<title>stage3_layer0_attn_out&#45;&gt;stage3_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3921.69,-19508.63C3921.69,-19500.64 3921.69,-19491.88 3921.69,-19483.13"/>
<polygon fill="black" stroke="black" points="3925.19,-19482.93 3921.69,-19472.93 3918.19,-19482.93 3925.19,-19482.93"/>
</g>
<!-- stage3_layer0_expert_router -->
<g id="node554" class="node">
<title>stage3_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3349.88,-19340.73 2627.36,-19340.73 2441.49,-19204.73 3164.02,-19204.73 3349.88,-19340.73"/>
<text text-anchor="middle" x="2895.69" y="-19291.53" font-family="Times,serif" font-size="14.00">Layer 6 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2895.69" y="-19276.53" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="2895.69" y="-19261.53" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2895.69" y="-19246.53" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage3_layer0_tp_attn_comm&#45;&gt;stage3_layer0_expert_router -->
<g id="edge728" class="edge">
<title>stage3_layer0_tp_attn_comm&#45;&gt;stage3_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3696.21,-19390.83C3596.9,-19376.31 3476.35,-19358.67 3359.27,-19341.55"/>
<polygon fill="black" stroke="black" points="3359.44,-19338.03 3349.04,-19340.05 3358.43,-19344.96 3359.44,-19338.03"/>
</g>
<!-- stage3_layer0_output -->
<g id="node617" class="node">
<title>stage3_layer0_output</title>
<polygon fill="none" stroke="black" points="3983.69,-18425.65 3533.69,-18425.65 3533.69,-18357.65 3983.69,-18357.65 3983.69,-18425.65"/>
<text text-anchor="middle" x="3758.69" y="-18410.45" font-family="Times,serif" font-size="14.00">Layer 6 Output</text>
<text text-anchor="middle" x="3758.69" y="-18395.45" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-18380.45" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-18365.45" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_tp_attn_comm&#45;&gt;stage3_layer0_output -->
<!-- stage3_layer0_expert0 -->
<g id="node555" class="node">
<title>stage3_layer0_expert0</title>
<polygon fill="none" stroke="black" points="861.69,-19168.73 539.69,-19168.73 539.69,-19116.73 861.69,-19116.73 861.69,-19168.73"/>
<text text-anchor="middle" x="700.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 0</text>
<text text-anchor="middle" x="700.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP pair)</text>
<text text-anchor="middle" x="700.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="700.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert0 -->
<g id="edge729" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2511.05,-19255.66C2121.89,-19238.35 1503.09,-19207.92 968.69,-19168.73 937.46,-19166.44 904.23,-19163.64 872.17,-19160.75"/>
<polygon fill="black" stroke="black" points="872.08,-19157.23 861.81,-19159.81 871.45,-19164.2 872.08,-19157.23"/>
</g>
<!-- stage3_layer0_expert1 -->
<g id="node561" class="node">
<title>stage3_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1299.69,-19168.73 977.69,-19168.73 977.69,-19116.73 1299.69,-19116.73 1299.69,-19168.73"/>
<text text-anchor="middle" x="1138.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 1</text>
<text text-anchor="middle" x="1138.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP pair)</text>
<text text-anchor="middle" x="1138.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1138.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert1 -->
<g id="edge735" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2503.76,-19250.56C2192.72,-19232.53 1746.98,-19203.97 1357.69,-19168.73 1342.14,-19167.33 1325.99,-19165.73 1309.83,-19164.05"/>
<polygon fill="black" stroke="black" points="1310.07,-19160.56 1299.76,-19162.99 1309.34,-19167.52 1310.07,-19160.56"/>
</g>
<!-- stage3_layer0_expert2 -->
<g id="node567" class="node">
<title>stage3_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1688.69,-19168.73 1366.69,-19168.73 1366.69,-19116.73 1688.69,-19116.73 1688.69,-19168.73"/>
<text text-anchor="middle" x="1527.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 2</text>
<text text-anchor="middle" x="1527.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP pair)</text>
<text text-anchor="middle" x="1527.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1527.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert2 -->
<g id="edge741" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2482.79,-19235.13C2269.76,-19215.95 2005.73,-19191.72 1769.69,-19168.73 1746.79,-19166.5 1722.68,-19164.09 1698.91,-19161.67"/>
<polygon fill="black" stroke="black" points="1699.05,-19158.17 1688.75,-19160.64 1698.34,-19165.13 1699.05,-19158.17"/>
</g>
<!-- stage3_layer0_expert3 -->
<g id="node573" class="node">
<title>stage3_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2100.69,-19168.73 1778.69,-19168.73 1778.69,-19116.73 2100.69,-19116.73 2100.69,-19168.73"/>
<text text-anchor="middle" x="1939.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 3</text>
<text text-anchor="middle" x="1939.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP pair)</text>
<text text-anchor="middle" x="1939.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1939.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert3 -->
<g id="edge747" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2451.62,-19212.28C2330.54,-19196.06 2206.54,-19179.46 2110.91,-19166.66"/>
<polygon fill="black" stroke="black" points="2111.24,-19163.17 2100.86,-19165.31 2110.31,-19170.11 2111.24,-19163.17"/>
</g>
<!-- stage3_layer0_expert31 -->
<g id="node579" class="node">
<title>stage3_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2521.69,-19168.73 2199.69,-19168.73 2199.69,-19116.73 2521.69,-19116.73 2521.69,-19168.73"/>
<text text-anchor="middle" x="2360.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 31</text>
<text text-anchor="middle" x="2360.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP pair)</text>
<text text-anchor="middle" x="2360.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2360.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert31 -->
<g id="edge753" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2615.26,-19204.64C2565.7,-19192.78 2516.72,-19181.06 2475.17,-19171.12"/>
<polygon fill="black" stroke="black" points="2475.86,-19167.69 2465.32,-19168.77 2474.23,-19174.5 2475.86,-19167.69"/>
</g>
<!-- stage3_layer0_expert32 -->
<g id="node585" class="node">
<title>stage3_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2876.69,-19168.73 2554.69,-19168.73 2554.69,-19116.73 2876.69,-19116.73 2876.69,-19168.73"/>
<text text-anchor="middle" x="2715.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 32</text>
<text text-anchor="middle" x="2715.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP pair)</text>
<text text-anchor="middle" x="2715.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2715.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert32 -->
<g id="edge759" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2801.21,-19204.55C2786.73,-19194.25 2772.4,-19184.06 2759.73,-19175.05"/>
<polygon fill="black" stroke="black" points="2761.42,-19171.96 2751.24,-19169.02 2757.37,-19177.66 2761.42,-19171.96"/>
</g>
<!-- stage3_layer0_expert60 -->
<g id="node591" class="node">
<title>stage3_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3236.69,-19168.73 2914.69,-19168.73 2914.69,-19116.73 3236.69,-19116.73 3236.69,-19168.73"/>
<text text-anchor="middle" x="3075.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 60</text>
<text text-anchor="middle" x="3075.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP pair)</text>
<text text-anchor="middle" x="3075.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3075.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert60 -->
<g id="edge765" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2990.17,-19204.55C3004.65,-19194.25 3018.98,-19184.06 3031.65,-19175.05"/>
<polygon fill="black" stroke="black" points="3034.01,-19177.66 3040.13,-19169.02 3029.95,-19171.96 3034.01,-19177.66"/>
</g>
<!-- stage3_layer0_expert61 -->
<g id="node597" class="node">
<title>stage3_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3616.69,-19168.73 3294.69,-19168.73 3294.69,-19116.73 3616.69,-19116.73 3616.69,-19168.73"/>
<text text-anchor="middle" x="3455.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 61</text>
<text text-anchor="middle" x="3455.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP pair)</text>
<text text-anchor="middle" x="3455.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3455.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert61 -->
<g id="edge771" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3169.95,-19209.05C3228.41,-19195.68 3287.21,-19182.24 3336.14,-19171.06"/>
<polygon fill="black" stroke="black" points="3337.14,-19174.42 3346.11,-19168.78 3335.58,-19167.6 3337.14,-19174.42"/>
</g>
<!-- stage3_layer0_expert62 -->
<g id="node603" class="node">
<title>stage3_layer0_expert62</title>
<polygon fill="none" stroke="black" points="4030.69,-19168.73 3708.69,-19168.73 3708.69,-19116.73 4030.69,-19116.73 4030.69,-19168.73"/>
<text text-anchor="middle" x="3869.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 62</text>
<text text-anchor="middle" x="3869.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP pair)</text>
<text text-anchor="middle" x="3869.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3869.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert62 -->
<g id="edge777" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3200.86,-19231.63C3364.85,-19210.08 3560.94,-19184.31 3698.26,-19166.26"/>
<polygon fill="black" stroke="black" points="3699,-19169.69 3708.45,-19164.92 3698.08,-19162.75 3699,-19169.69"/>
</g>
<!-- stage3_layer0_expert63 -->
<g id="node609" class="node">
<title>stage3_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4412.69,-19168.73 4090.69,-19168.73 4090.69,-19116.73 4412.69,-19116.73 4412.69,-19168.73"/>
<text text-anchor="middle" x="4251.69" y="-19156.73" font-family="Times,serif" font-size="10.00">Layer 6 Expert 63</text>
<text text-anchor="middle" x="4251.69" y="-19145.73" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP pair)</text>
<text text-anchor="middle" x="4251.69" y="-19134.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4251.69" y="-19123.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert63 -->
<g id="edge783" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3219.21,-19245C3448.44,-19225.47 3763.12,-19197.48 4039.69,-19168.73 4052.96,-19167.35 4066.7,-19165.87 4080.5,-19164.33"/>
<polygon fill="black" stroke="black" points="4081.01,-19167.8 4090.56,-19163.2 4080.23,-19160.84 4081.01,-19167.8"/>
</g>
<!-- stage3_layer0_expert_ellipsis -->
<g id="node615" class="node">
<title>stage3_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4819.69,-19080.73 4497.69,-19080.73 4497.69,-19028.73 4819.69,-19028.73 4819.69,-19080.73"/>
<text text-anchor="middle" x="4658.69" y="-19068.73" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4658.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4658.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4658.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert_ellipsis -->
<g id="edge789" class="edge">
<title>stage3_layer0_expert_router&#45;&gt;stage3_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3244.27,-19263.37C3624.47,-19251.56 4207.44,-19224.84 4421.69,-19168.73 4490.25,-19150.78 4562.95,-19112.95 4609.47,-19086.01"/>
<polygon fill="black" stroke="black" points="4611.27,-19089.02 4618.14,-19080.95 4607.74,-19082.97 4611.27,-19089.02"/>
</g>
<!-- stage3_layer0_expert0_mlp1 -->
<g id="node556" class="node">
<title>stage3_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="771.69,-19080.73 457.69,-19080.73 457.69,-19028.73 771.69,-19028.73 771.69,-19080.73"/>
<text text-anchor="middle" x="614.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="614.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP: Column Parallel)</text>
<text text-anchor="middle" x="614.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="614.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert0&#45;&gt;stage3_layer0_expert0_mlp1 -->
<g id="edge730" class="edge">
<title>stage3_layer0_expert0&#45;&gt;stage3_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M675.35,-19116.4C666.52,-19107.56 656.48,-19097.52 647.14,-19088.19"/>
<polygon fill="black" stroke="black" points="649.39,-19085.49 639.84,-19080.89 644.44,-19090.44 649.39,-19085.49"/>
</g>
<!-- stage3_layer0_expert0_tp1 -->
<g id="node557" class="node">
<title>stage3_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="486.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="486.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="486.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="486.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="486.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert0_mlp1&#45;&gt;stage3_layer0_expert0_tp1 -->
<g id="edge731" class="edge">
<title>stage3_layer0_expert0_mlp1&#45;&gt;stage3_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M581.39,-19028.56C569.01,-19019.2 554.61,-19008.32 540.84,-18997.9"/>
<polygon fill="black" stroke="black" points="542.91,-18995.08 532.83,-18991.84 538.69,-19000.67 542.91,-18995.08"/>
</g>
<!-- stage3_layer0_expert0_act -->
<g id="node558" class="node">
<title>stage3_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="563.19,-18883.19 282.19,-18883.19 282.19,-18831.19 563.19,-18831.19 563.19,-18883.19"/>
<text text-anchor="middle" x="422.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="422.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="422.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="422.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert0_tp1&#45;&gt;stage3_layer0_expert0_act -->
<g id="edge732" class="edge">
<title>stage3_layer0_expert0_tp1&#45;&gt;stage3_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M463.04,-18919.2C457.11,-18910.24 450.77,-18900.65 444.91,-18891.8"/>
<polygon fill="black" stroke="black" points="447.69,-18889.65 439.25,-18883.24 441.85,-18893.51 447.69,-18889.65"/>
</g>
<!-- stage3_layer0_expert0_mlp2 -->
<g id="node559" class="node">
<title>stage3_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="527.69,-18795.19 205.69,-18795.19 205.69,-18743.19 527.69,-18743.19 527.69,-18795.19"/>
<text text-anchor="middle" x="366.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="366.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP: Row Parallel)</text>
<text text-anchor="middle" x="366.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="366.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert0_act&#45;&gt;stage3_layer0_expert0_mlp2 -->
<g id="edge733" class="edge">
<title>stage3_layer0_expert0_act&#45;&gt;stage3_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M406.19,-18830.86C400.66,-18822.37 394.42,-18812.77 388.55,-18803.76"/>
<polygon fill="black" stroke="black" points="391.46,-18801.82 383.07,-18795.35 385.59,-18805.64 391.46,-18801.82"/>
</g>
<!-- stage3_layer0_expert0_tp2 -->
<g id="node560" class="node">
<title>stage3_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="300.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="300.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="300.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="300.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="300.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert0_mlp2&#45;&gt;stage3_layer0_expert0_tp2 -->
<g id="edge734" class="edge">
<title>stage3_layer0_expert0_mlp2&#45;&gt;stage3_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M349.52,-18743.02C343.79,-18734.62 337.22,-18724.99 330.8,-18715.58"/>
<polygon fill="black" stroke="black" points="333.5,-18713.32 324.98,-18707.03 327.72,-18717.27 333.5,-18713.32"/>
</g>
<!-- stage3_layer0_expert_agg -->
<g id="node616" class="node">
<title>stage3_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3453.22,-18597.65 2577.45,-18597.65 2352.16,-18461.65 3227.93,-18461.65 3453.22,-18597.65"/>
<text text-anchor="middle" x="2902.69" y="-18548.45" font-family="Times,serif" font-size="14.00">Layer 6 Expert Aggregation</text>
<text text-anchor="middle" x="2902.69" y="-18533.45" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="2902.69" y="-18518.45" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2902.69" y="-18503.45" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert0_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge790" class="edge">
<title>stage3_layer0_expert0_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M455.9,-18643.49C482.78,-18639.69 510.5,-18636.2 536.69,-18633.65 1207.12,-18568.44 1988.46,-18544.51 2464.17,-18535.74"/>
<polygon fill="black" stroke="black" points="2464.37,-18539.23 2474.3,-18535.55 2464.24,-18532.23 2464.37,-18539.23"/>
</g>
<!-- stage3_layer0_expert1_mlp1 -->
<g id="node562" class="node">
<title>stage3_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1159.69,-19080.73 845.69,-19080.73 845.69,-19028.73 1159.69,-19028.73 1159.69,-19080.73"/>
<text text-anchor="middle" x="1002.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1002.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1002.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1002.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert1&#45;&gt;stage3_layer0_expert1_mlp1 -->
<g id="edge736" class="edge">
<title>stage3_layer0_expert1&#45;&gt;stage3_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1098.99,-19116.63C1084.04,-19107.17 1066.86,-19096.31 1051.2,-19086.41"/>
<polygon fill="black" stroke="black" points="1053,-19083.41 1042.68,-19081.02 1049.26,-19089.32 1053,-19083.41"/>
</g>
<!-- stage3_layer0_expert1_tp1 -->
<g id="node563" class="node">
<title>stage3_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="942.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="942.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="942.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="942.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="942.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert1_mlp1&#45;&gt;stage3_layer0_expert1_tp1 -->
<g id="edge737" class="edge">
<title>stage3_layer0_expert1_mlp1&#45;&gt;stage3_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M987.08,-19028.56C981.87,-19020.16 975.9,-19010.53 970.06,-19001.12"/>
<polygon fill="black" stroke="black" points="973.01,-18999.23 964.77,-18992.57 967.06,-19002.92 973.01,-18999.23"/>
</g>
<!-- stage3_layer0_expert1_act -->
<g id="node564" class="node">
<title>stage3_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="916.19,-18883.19 635.19,-18883.19 635.19,-18831.19 916.19,-18831.19 916.19,-18883.19"/>
<text text-anchor="middle" x="775.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="775.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="775.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="775.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert1_tp1&#45;&gt;stage3_layer0_expert1_act -->
<g id="edge738" class="edge">
<title>stage3_layer0_expert1_tp1&#45;&gt;stage3_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M883.34,-18920.57C865.22,-18910.07 845.43,-18898.61 827.83,-18888.41"/>
<polygon fill="black" stroke="black" points="829.25,-18885.18 818.84,-18883.2 825.74,-18891.24 829.25,-18885.18"/>
</g>
<!-- stage3_layer0_expert1_mlp2 -->
<g id="node565" class="node">
<title>stage3_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="935.69,-18795.19 613.69,-18795.19 613.69,-18743.19 935.69,-18743.19 935.69,-18795.19"/>
<text text-anchor="middle" x="774.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="774.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP: Row Parallel)</text>
<text text-anchor="middle" x="774.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="774.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert1_act&#45;&gt;stage3_layer0_expert1_mlp2 -->
<g id="edge739" class="edge">
<title>stage3_layer0_expert1_act&#45;&gt;stage3_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M775.39,-18830.86C775.3,-18822.9 775.2,-18813.96 775.1,-18805.44"/>
<polygon fill="black" stroke="black" points="778.6,-18805.31 774.98,-18795.35 771.6,-18805.39 778.6,-18805.31"/>
</g>
<!-- stage3_layer0_expert1_tp2 -->
<g id="node566" class="node">
<title>stage3_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="773.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="773.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="773.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="773.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="773.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert1_mlp2&#45;&gt;stage3_layer0_expert1_tp2 -->
<g id="edge740" class="edge">
<title>stage3_layer0_expert1_mlp2&#45;&gt;stage3_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M774.43,-18743.02C774.35,-18735.21 774.26,-18726.35 774.17,-18717.58"/>
<polygon fill="black" stroke="black" points="777.66,-18717.36 774.06,-18707.4 770.66,-18717.44 777.66,-18717.36"/>
</g>
<!-- stage3_layer0_expert1_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge791" class="edge">
<title>stage3_layer0_expert1_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M929.88,-18643.59C956.46,-18639.82 983.82,-18636.31 1009.69,-18633.65 1511.29,-18582.12 2090.49,-18555.37 2474.77,-18542.21"/>
<polygon fill="black" stroke="black" points="2475.07,-18545.7 2484.94,-18541.86 2474.83,-18538.71 2475.07,-18545.7"/>
</g>
<!-- stage3_layer0_expert2_mlp1 -->
<g id="node568" class="node">
<title>stage3_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1595.69,-19080.73 1281.69,-19080.73 1281.69,-19028.73 1595.69,-19028.73 1595.69,-19080.73"/>
<text text-anchor="middle" x="1438.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1438.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1438.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1438.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert2&#45;&gt;stage3_layer0_expert2_mlp1 -->
<g id="edge742" class="edge">
<title>stage3_layer0_expert2&#45;&gt;stage3_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1501.47,-19116.4C1492.23,-19107.47 1481.73,-19097.32 1471.99,-19087.91"/>
<polygon fill="black" stroke="black" points="1474.35,-19085.32 1464.72,-19080.89 1469.48,-19090.36 1474.35,-19085.32"/>
</g>
<!-- stage3_layer0_expert2_tp1 -->
<g id="node569" class="node">
<title>stage3_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1395.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1395.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1395.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="1395.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1395.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert2_mlp1&#45;&gt;stage3_layer0_expert2_tp1 -->
<g id="edge743" class="edge">
<title>stage3_layer0_expert2_mlp1&#45;&gt;stage3_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1427.5,-19028.56C1423.92,-19020.5 1419.84,-19011.31 1415.82,-19002.26"/>
<polygon fill="black" stroke="black" points="1418.93,-19000.66 1411.67,-18992.94 1412.54,-19003.5 1418.93,-19000.66"/>
</g>
<!-- stage3_layer0_expert2_act -->
<g id="node570" class="node">
<title>stage3_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1497.19,-18883.19 1216.19,-18883.19 1216.19,-18831.19 1497.19,-18831.19 1497.19,-18883.19"/>
<text text-anchor="middle" x="1356.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1356.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="1356.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1356.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert2_tp1&#45;&gt;stage3_layer0_expert2_act -->
<g id="edge744" class="edge">
<title>stage3_layer0_expert2_tp1&#45;&gt;stage3_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1381.28,-18919.2C1377.78,-18910.52 1374.04,-18901.25 1370.57,-18892.63"/>
<polygon fill="black" stroke="black" points="1373.77,-18891.2 1366.78,-18883.24 1367.27,-18893.82 1373.77,-18891.2"/>
</g>
<!-- stage3_layer0_expert2_mlp2 -->
<g id="node571" class="node">
<title>stage3_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1473.69,-18795.19 1151.69,-18795.19 1151.69,-18743.19 1473.69,-18743.19 1473.69,-18795.19"/>
<text text-anchor="middle" x="1312.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1312.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1312.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1312.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert2_act&#45;&gt;stage3_layer0_expert2_mlp2 -->
<g id="edge745" class="edge">
<title>stage3_layer0_expert2_act&#45;&gt;stage3_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1343.72,-18830.86C1339.47,-18822.55 1334.68,-18813.17 1330.15,-18804.32"/>
<polygon fill="black" stroke="black" points="1333.23,-18802.66 1325.56,-18795.35 1327,-18805.85 1333.23,-18802.66"/>
</g>
<!-- stage3_layer0_expert2_tp2 -->
<g id="node572" class="node">
<title>stage3_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1246.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1246.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1246.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="1246.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1246.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert2_mlp2&#45;&gt;stage3_layer0_expert2_tp2 -->
<g id="edge746" class="edge">
<title>stage3_layer0_expert2_mlp2&#45;&gt;stage3_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1295.52,-18743.02C1289.79,-18734.62 1283.22,-18724.99 1276.8,-18715.58"/>
<polygon fill="black" stroke="black" points="1279.5,-18713.32 1270.98,-18707.03 1273.72,-18717.27 1279.5,-18713.32"/>
</g>
<!-- stage3_layer0_expert2_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge792" class="edge">
<title>stage3_layer0_expert2_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1404.19,-18643.81C1430.36,-18640.05 1457.26,-18636.5 1482.69,-18633.65 1821.19,-18595.78 2206.73,-18568.84 2490.58,-18552.03"/>
<polygon fill="black" stroke="black" points="2490.85,-18555.52 2500.63,-18551.44 2490.44,-18548.53 2490.85,-18555.52"/>
</g>
<!-- stage3_layer0_expert3_mlp1 -->
<g id="node574" class="node">
<title>stage3_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2026.69,-19080.73 1712.69,-19080.73 1712.69,-19028.73 2026.69,-19028.73 2026.69,-19080.73"/>
<text text-anchor="middle" x="1869.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="1869.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1869.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1869.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert3&#45;&gt;stage3_layer0_expert3_mlp1 -->
<g id="edge748" class="edge">
<title>stage3_layer0_expert3&#45;&gt;stage3_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M1919.06,-19116.4C1912.02,-19107.73 1904.02,-19097.92 1896.56,-19088.74"/>
<polygon fill="black" stroke="black" points="1899.19,-19086.44 1890.16,-19080.89 1893.76,-19090.85 1899.19,-19086.44"/>
</g>
<!-- stage3_layer0_expert3_tp1 -->
<g id="node575" class="node">
<title>stage3_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1829.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1829.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1829.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="1829.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1829.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert3_mlp1&#45;&gt;stage3_layer0_expert3_tp1 -->
<g id="edge749" class="edge">
<title>stage3_layer0_expert3_mlp1&#45;&gt;stage3_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1859.28,-19028.56C1855.95,-19020.5 1852.15,-19011.31 1848.41,-19002.26"/>
<polygon fill="black" stroke="black" points="1851.61,-19000.84 1844.56,-18992.94 1845.14,-19003.52 1851.61,-19000.84"/>
</g>
<!-- stage3_layer0_expert3_act -->
<g id="node576" class="node">
<title>stage3_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1883.19,-18883.19 1602.19,-18883.19 1602.19,-18831.19 1883.19,-18831.19 1883.19,-18883.19"/>
<text text-anchor="middle" x="1742.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1742.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="1742.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1742.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert3_tp1&#45;&gt;stage3_layer0_expert3_act -->
<g id="edge750" class="edge">
<title>stage3_layer0_expert3_tp1&#45;&gt;stage3_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1797.79,-18919.48C1789.38,-18910.12 1780.34,-18900.07 1772.07,-18890.87"/>
<polygon fill="black" stroke="black" points="1774.62,-18888.48 1765.33,-18883.38 1769.41,-18893.16 1774.62,-18888.48"/>
</g>
<!-- stage3_layer0_expert3_mlp2 -->
<g id="node577" class="node">
<title>stage3_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1894.69,-18795.19 1572.69,-18795.19 1572.69,-18743.19 1894.69,-18743.19 1894.69,-18795.19"/>
<text text-anchor="middle" x="1733.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1733.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1733.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1733.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert3_act&#45;&gt;stage3_layer0_expert3_mlp2 -->
<g id="edge751" class="edge">
<title>stage3_layer0_expert3_act&#45;&gt;stage3_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1740.04,-18830.86C1739.2,-18822.9 1738.27,-18813.96 1737.38,-18805.44"/>
<polygon fill="black" stroke="black" points="1740.84,-18804.93 1736.32,-18795.35 1733.88,-18805.66 1740.84,-18804.93"/>
</g>
<!-- stage3_layer0_expert3_tp2 -->
<g id="node578" class="node">
<title>stage3_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1719.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1719.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1719.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="1719.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1719.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert3_mlp2&#45;&gt;stage3_layer0_expert3_tp2 -->
<g id="edge752" class="edge">
<title>stage3_layer0_expert3_mlp2&#45;&gt;stage3_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1730.05,-18743.02C1728.92,-18735.21 1727.63,-18726.35 1726.37,-18717.58"/>
<polygon fill="black" stroke="black" points="1729.79,-18716.8 1724.89,-18707.4 1722.86,-18717.8 1729.79,-18716.8"/>
</g>
<!-- stage3_layer0_expert3_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge793" class="edge">
<title>stage3_layer0_expert3_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1879.83,-18644.22C1905.19,-18640.5 1931.13,-18636.85 1955.69,-18633.65 2140.29,-18609.64 2345.65,-18586.83 2517.81,-18568.8"/>
<polygon fill="black" stroke="black" points="2518.22,-18572.28 2527.8,-18567.76 2517.49,-18565.32 2518.22,-18572.28"/>
</g>
<!-- stage3_layer0_expert31_mlp1 -->
<g id="node580" class="node">
<title>stage3_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2439.69,-19080.73 2125.69,-19080.73 2125.69,-19028.73 2439.69,-19028.73 2439.69,-19080.73"/>
<text text-anchor="middle" x="2282.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2282.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2282.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2282.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert31&#45;&gt;stage3_layer0_expert31_mlp1 -->
<g id="edge754" class="edge">
<title>stage3_layer0_expert31&#45;&gt;stage3_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2337.71,-19116.4C2329.77,-19107.65 2320.77,-19097.72 2312.37,-19088.46"/>
<polygon fill="black" stroke="black" points="2314.82,-19085.95 2305.5,-19080.89 2309.63,-19090.65 2314.82,-19085.95"/>
</g>
<!-- stage3_layer0_expert31_tp1 -->
<g id="node581" class="node">
<title>stage3_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2253.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2253.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2253.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="2253.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2253.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert31_mlp1&#45;&gt;stage3_layer0_expert31_tp1 -->
<g id="edge755" class="edge">
<title>stage3_layer0_expert31_mlp1&#45;&gt;stage3_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2275.14,-19028.56C2272.75,-19020.58 2270.03,-19011.5 2267.35,-19002.55"/>
<polygon fill="black" stroke="black" points="2270.69,-19001.51 2264.47,-18992.94 2263.99,-19003.52 2270.69,-19001.51"/>
</g>
<!-- stage3_layer0_expert31_act -->
<g id="node582" class="node">
<title>stage3_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2361.19,-18883.19 2080.19,-18883.19 2080.19,-18831.19 2361.19,-18831.19 2361.19,-18883.19"/>
<text text-anchor="middle" x="2220.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2220.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="2220.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2220.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert31_tp1&#45;&gt;stage3_layer0_expert31_act -->
<g id="edge756" class="edge">
<title>stage3_layer0_expert31_tp1&#45;&gt;stage3_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2241.49,-18919.2C2238.56,-18910.61 2235.44,-18901.45 2232.53,-18892.91"/>
<polygon fill="black" stroke="black" points="2235.77,-18891.57 2229.23,-18883.24 2229.14,-18893.83 2235.77,-18891.57"/>
</g>
<!-- stage3_layer0_expert31_mlp2 -->
<g id="node583" class="node">
<title>stage3_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2367.69,-18795.19 2045.69,-18795.19 2045.69,-18743.19 2367.69,-18743.19 2367.69,-18795.19"/>
<text text-anchor="middle" x="2206.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2206.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2206.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2206.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert31_act&#45;&gt;stage3_layer0_expert31_mlp2 -->
<g id="edge757" class="edge">
<title>stage3_layer0_expert31_act&#45;&gt;stage3_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2216.56,-18830.86C2215.27,-18822.9 2213.81,-18813.96 2212.43,-18805.44"/>
<polygon fill="black" stroke="black" points="2215.85,-18804.66 2210.78,-18795.35 2208.94,-18805.78 2215.85,-18804.66"/>
</g>
<!-- stage3_layer0_expert31_tp2 -->
<g id="node584" class="node">
<title>stage3_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2192.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2192.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2192.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="2192.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2192.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert31_mlp2&#45;&gt;stage3_layer0_expert31_tp2 -->
<g id="edge758" class="edge">
<title>stage3_layer0_expert31_mlp2&#45;&gt;stage3_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2203.05,-18743.02C2201.92,-18735.21 2200.63,-18726.35 2199.37,-18717.58"/>
<polygon fill="black" stroke="black" points="2202.79,-18716.8 2197.89,-18707.4 2195.86,-18717.8 2202.79,-18716.8"/>
</g>
<!-- stage3_layer0_expert31_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge794" class="edge">
<title>stage3_layer0_expert31_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2334.66,-18641.68C2400.77,-18628.75 2482.52,-18612.78 2563.2,-18597.01"/>
<polygon fill="black" stroke="black" points="2563.89,-18600.44 2573.03,-18595.09 2562.54,-18593.57 2563.89,-18600.44"/>
</g>
<!-- stage3_layer0_expert32_mlp1 -->
<g id="node586" class="node">
<title>stage3_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2832.69,-19080.73 2518.69,-19080.73 2518.69,-19028.73 2832.69,-19028.73 2832.69,-19080.73"/>
<text text-anchor="middle" x="2675.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2675.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2675.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2675.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert32&#45;&gt;stage3_layer0_expert32_mlp1 -->
<g id="edge760" class="edge">
<title>stage3_layer0_expert32&#45;&gt;stage3_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2703.9,-19116.4C2700.08,-19108.17 2695.77,-19098.91 2691.69,-19090.14"/>
<polygon fill="black" stroke="black" points="2694.78,-19088.48 2687.39,-19080.89 2688.43,-19091.43 2694.78,-19088.48"/>
</g>
<!-- stage3_layer0_expert32_tp1 -->
<g id="node587" class="node">
<title>stage3_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2670.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2670.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2670.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="2670.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2670.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert32_mlp1&#45;&gt;stage3_layer0_expert32_tp1 -->
<g id="edge761" class="edge">
<title>stage3_layer0_expert32_mlp1&#45;&gt;stage3_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2674.39,-19028.56C2673.98,-19020.75 2673.53,-19011.89 2673.07,-19003.12"/>
<polygon fill="black" stroke="black" points="2676.56,-19002.75 2672.55,-18992.94 2669.57,-19003.11 2676.56,-19002.75"/>
</g>
<!-- stage3_layer0_expert32_act -->
<g id="node588" class="node">
<title>stage3_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2809.19,-18883.19 2528.19,-18883.19 2528.19,-18831.19 2809.19,-18831.19 2809.19,-18883.19"/>
<text text-anchor="middle" x="2668.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2668.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="2668.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2668.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert32_tp1&#45;&gt;stage3_layer0_expert32_act -->
<g id="edge762" class="edge">
<title>stage3_layer0_expert32_tp1&#45;&gt;stage3_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2669.94,-18918.93C2669.77,-18910.62 2669.59,-18901.78 2669.42,-18893.5"/>
<polygon fill="black" stroke="black" points="2672.92,-18893.32 2669.21,-18883.39 2665.92,-18893.46 2672.92,-18893.32"/>
</g>
<!-- stage3_layer0_expert32_mlp2 -->
<g id="node589" class="node">
<title>stage3_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2828.69,-18795.19 2506.69,-18795.19 2506.69,-18743.19 2828.69,-18743.19 2828.69,-18795.19"/>
<text text-anchor="middle" x="2667.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2667.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2667.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2667.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert32_act&#45;&gt;stage3_layer0_expert32_mlp2 -->
<g id="edge763" class="edge">
<title>stage3_layer0_expert32_act&#45;&gt;stage3_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2668.39,-18830.86C2668.3,-18822.9 2668.2,-18813.96 2668.1,-18805.44"/>
<polygon fill="black" stroke="black" points="2671.6,-18805.31 2667.98,-18795.35 2664.6,-18805.39 2671.6,-18805.31"/>
</g>
<!-- stage3_layer0_expert32_tp2 -->
<g id="node590" class="node">
<title>stage3_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2665.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2665.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2665.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="2665.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2665.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert32_mlp2&#45;&gt;stage3_layer0_expert32_tp2 -->
<g id="edge764" class="edge">
<title>stage3_layer0_expert32_mlp2&#45;&gt;stage3_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2667.17,-18743.02C2667.01,-18735.21 2666.82,-18726.35 2666.64,-18717.58"/>
<polygon fill="black" stroke="black" points="2670.14,-18717.33 2666.43,-18707.4 2663.14,-18717.47 2670.14,-18717.33"/>
</g>
<!-- stage3_layer0_expert32_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge795" class="edge">
<title>stage3_layer0_expert32_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2724.88,-18634.76C2741.53,-18625.02 2760.28,-18614.04 2779.2,-18602.96"/>
<polygon fill="black" stroke="black" points="2781.03,-18605.94 2787.89,-18597.87 2777.49,-18599.9 2781.03,-18605.94"/>
</g>
<!-- stage3_layer0_expert60_mlp1 -->
<g id="node592" class="node">
<title>stage3_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3237.69,-19080.73 2923.69,-19080.73 2923.69,-19028.73 3237.69,-19028.73 3237.69,-19080.73"/>
<text text-anchor="middle" x="3080.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3080.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3080.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3080.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert60&#45;&gt;stage3_layer0_expert60_mlp1 -->
<g id="edge766" class="edge">
<title>stage3_layer0_expert60&#45;&gt;stage3_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3077.16,-19116.4C3077.62,-19108.43 3078.14,-19099.5 3078.64,-19090.98"/>
<polygon fill="black" stroke="black" points="3082.14,-19091.08 3079.23,-19080.89 3075.15,-19090.67 3082.14,-19091.08"/>
</g>
<!-- stage3_layer0_expert60_tp1 -->
<g id="node593" class="node">
<title>stage3_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3090.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3090.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3090.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="3090.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3090.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert60_mlp1&#45;&gt;stage3_layer0_expert60_tp1 -->
<g id="edge767" class="edge">
<title>stage3_layer0_expert60_mlp1&#45;&gt;stage3_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3083.29,-19028.56C3084.1,-19020.75 3085.01,-19011.89 3085.92,-19003.12"/>
<polygon fill="black" stroke="black" points="3089.42,-19003.25 3086.97,-18992.94 3082.46,-19002.53 3089.42,-19003.25"/>
</g>
<!-- stage3_layer0_expert60_act -->
<g id="node594" class="node">
<title>stage3_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3260.19,-18883.19 2979.19,-18883.19 2979.19,-18831.19 3260.19,-18831.19 3260.19,-18883.19"/>
<text text-anchor="middle" x="3119.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3119.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="3119.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3119.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert60_tp1&#45;&gt;stage3_layer0_expert60_act -->
<g id="edge768" class="edge">
<title>stage3_layer0_expert60_tp1&#45;&gt;stage3_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3101.4,-18919.2C3103.98,-18910.61 3106.72,-18901.45 3109.28,-18892.91"/>
<polygon fill="black" stroke="black" points="3112.67,-18893.82 3112.18,-18883.24 3105.96,-18891.81 3112.67,-18893.82"/>
</g>
<!-- stage3_layer0_expert60_mlp2 -->
<g id="node595" class="node">
<title>stage3_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3294.69,-18795.19 2972.69,-18795.19 2972.69,-18743.19 3294.69,-18743.19 3294.69,-18795.19"/>
<text text-anchor="middle" x="3133.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3133.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3133.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3133.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert60_act&#45;&gt;stage3_layer0_expert60_mlp2 -->
<g id="edge769" class="edge">
<title>stage3_layer0_expert60_act&#45;&gt;stage3_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3123.81,-18830.86C3125.11,-18822.9 3126.56,-18813.96 3127.95,-18805.44"/>
<polygon fill="black" stroke="black" points="3131.44,-18805.78 3129.59,-18795.35 3124.53,-18804.66 3131.44,-18805.78"/>
</g>
<!-- stage3_layer0_expert60_tp2 -->
<g id="node596" class="node">
<title>stage3_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3138.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3138.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3138.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="3138.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3138.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert60_mlp2&#45;&gt;stage3_layer0_expert60_tp2 -->
<g id="edge770" class="edge">
<title>stage3_layer0_expert60_mlp2&#45;&gt;stage3_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3134.99,-18743.02C3135.39,-18735.21 3135.85,-18726.35 3136.3,-18717.58"/>
<polygon fill="black" stroke="black" points="3139.81,-18717.57 3136.83,-18707.4 3132.82,-18717.21 3139.81,-18717.57"/>
</g>
<!-- stage3_layer0_expert60_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge796" class="edge">
<title>stage3_layer0_expert60_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3079.74,-18634.76C3063.17,-18625.02 3044.5,-18614.04 3025.66,-18602.96"/>
<polygon fill="black" stroke="black" points="3027.39,-18599.92 3017,-18597.87 3023.85,-18605.96 3027.39,-18599.92"/>
</g>
<!-- stage3_layer0_expert61_mlp1 -->
<g id="node598" class="node">
<title>stage3_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3654.69,-19080.73 3340.69,-19080.73 3340.69,-19028.73 3654.69,-19028.73 3654.69,-19080.73"/>
<text text-anchor="middle" x="3497.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3497.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3497.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3497.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert61&#45;&gt;stage3_layer0_expert61_mlp1 -->
<g id="edge772" class="edge">
<title>stage3_layer0_expert61&#45;&gt;stage3_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3468.06,-19116.4C3472.08,-19108.17 3476.6,-19098.91 3480.89,-19090.14"/>
<polygon fill="black" stroke="black" points="3484.16,-19091.41 3485.4,-19080.89 3477.87,-19088.34 3484.16,-19091.41"/>
</g>
<!-- stage3_layer0_expert61_tp1 -->
<g id="node599" class="node">
<title>stage3_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3539.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3539.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3539.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="3539.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3539.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert61_mlp1&#45;&gt;stage3_layer0_expert61_tp1 -->
<g id="edge773" class="edge">
<title>stage3_layer0_expert61_mlp1&#45;&gt;stage3_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3508.61,-19028.56C3512.11,-19020.5 3516.1,-19011.31 3520.03,-19002.26"/>
<polygon fill="black" stroke="black" points="3523.3,-19003.51 3524.07,-18992.94 3516.88,-19000.72 3523.3,-19003.51"/>
</g>
<!-- stage3_layer0_expert61_act -->
<g id="node600" class="node">
<title>stage3_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3708.19,-18883.19 3427.19,-18883.19 3427.19,-18831.19 3708.19,-18831.19 3708.19,-18883.19"/>
<text text-anchor="middle" x="3567.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3567.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="3567.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3567.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert61_tp1&#45;&gt;stage3_layer0_expert61_act -->
<g id="edge774" class="edge">
<title>stage3_layer0_expert61_tp1&#45;&gt;stage3_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3550.03,-18919.2C3552.52,-18910.61 3555.17,-18901.45 3557.64,-18892.91"/>
<polygon fill="black" stroke="black" points="3561.02,-18893.82 3560.44,-18883.24 3554.3,-18891.87 3561.02,-18893.82"/>
</g>
<!-- stage3_layer0_expert61_mlp2 -->
<g id="node601" class="node">
<title>stage3_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3744.69,-18795.19 3422.69,-18795.19 3422.69,-18743.19 3744.69,-18743.19 3744.69,-18795.19"/>
<text text-anchor="middle" x="3583.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3583.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3583.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3583.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert61_act&#45;&gt;stage3_layer0_expert61_mlp2 -->
<g id="edge775" class="edge">
<title>stage3_layer0_expert61_act&#45;&gt;stage3_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3572.4,-18830.86C3573.88,-18822.9 3575.55,-18813.96 3577.13,-18805.44"/>
<polygon fill="black" stroke="black" points="3580.62,-18805.82 3579.01,-18795.35 3573.74,-18804.54 3580.62,-18805.82"/>
</g>
<!-- stage3_layer0_expert61_tp2 -->
<g id="node602" class="node">
<title>stage3_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3611.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3611.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3611.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="3611.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3611.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert61_mlp2&#45;&gt;stage3_layer0_expert61_tp2 -->
<g id="edge776" class="edge">
<title>stage3_layer0_expert61_mlp2&#45;&gt;stage3_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3590.97,-18743.02C3593.28,-18735.04 3595.91,-18725.96 3598.5,-18717.01"/>
<polygon fill="black" stroke="black" points="3601.86,-18717.98 3601.28,-18707.4 3595.14,-18716.03 3601.86,-18717.98"/>
</g>
<!-- stage3_layer0_expert61_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge797" class="edge">
<title>stage3_layer0_expert61_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3469.49,-18641.59C3407.3,-18629.42 3331.31,-18614.55 3255.43,-18599.69"/>
<polygon fill="black" stroke="black" points="3255.69,-18596.18 3245.21,-18597.69 3254.35,-18603.05 3255.69,-18596.18"/>
</g>
<!-- stage3_layer0_expert62_mlp1 -->
<g id="node604" class="node">
<title>stage3_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="4121.69,-19080.73 3807.69,-19080.73 3807.69,-19028.73 4121.69,-19028.73 4121.69,-19080.73"/>
<text text-anchor="middle" x="3964.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3964.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3964.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3964.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert62&#45;&gt;stage3_layer0_expert62_mlp1 -->
<g id="edge778" class="edge">
<title>stage3_layer0_expert62&#45;&gt;stage3_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3897.42,-19116.63C3907.38,-19107.61 3918.75,-19097.32 3929.28,-19087.79"/>
<polygon fill="black" stroke="black" points="3931.69,-19090.32 3936.76,-19081.02 3926.99,-19085.14 3931.69,-19090.32"/>
</g>
<!-- stage3_layer0_expert62_tp1 -->
<g id="node605" class="node">
<title>stage3_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="3988.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3988.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="3988.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="3988.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3988.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert62_mlp1&#45;&gt;stage3_layer0_expert62_tp1 -->
<g id="edge779" class="edge">
<title>stage3_layer0_expert62_mlp1&#45;&gt;stage3_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3970.93,-19028.56C3972.89,-19020.67 3975.11,-19011.69 3977.31,-19002.83"/>
<polygon fill="black" stroke="black" points="3980.76,-19003.49 3979.77,-18992.94 3973.96,-19001.8 3980.76,-19003.49"/>
</g>
<!-- stage3_layer0_expert62_act -->
<g id="node606" class="node">
<title>stage3_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4154.19,-18883.19 3873.19,-18883.19 3873.19,-18831.19 4154.19,-18831.19 4154.19,-18883.19"/>
<text text-anchor="middle" x="4013.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="4013.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="4013.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4013.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert62_tp1&#45;&gt;stage3_layer0_expert62_act -->
<g id="edge780" class="edge">
<title>stage3_layer0_expert62_tp1&#45;&gt;stage3_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M3997.93,-18919.2C4000.12,-18910.71 4002.46,-18901.65 4004.65,-18893.19"/>
<polygon fill="black" stroke="black" points="4008.11,-18893.79 4007.22,-18883.24 4001.33,-18892.04 4008.11,-18893.79"/>
</g>
<!-- stage3_layer0_expert62_mlp2 -->
<g id="node607" class="node">
<title>stage3_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4219.69,-18795.19 3897.69,-18795.19 3897.69,-18743.19 4219.69,-18743.19 4219.69,-18795.19"/>
<text text-anchor="middle" x="4058.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4058.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4058.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4058.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert62_act&#45;&gt;stage3_layer0_expert62_mlp2 -->
<g id="edge781" class="edge">
<title>stage3_layer0_expert62_act&#45;&gt;stage3_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4026.95,-18830.86C4031.3,-18822.55 4036.2,-18813.17 4040.83,-18804.32"/>
<polygon fill="black" stroke="black" points="4043.99,-18805.83 4045.53,-18795.35 4037.79,-18802.59 4043.99,-18805.83"/>
</g>
<!-- stage3_layer0_expert62_tp2 -->
<g id="node608" class="node">
<title>stage3_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4084.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4084.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4084.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="4084.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4084.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert62_mlp2&#45;&gt;stage3_layer0_expert62_tp2 -->
<g id="edge782" class="edge">
<title>stage3_layer0_expert62_mlp2&#45;&gt;stage3_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4065.45,-18743.02C4067.57,-18735.13 4069.98,-18726.15 4072.36,-18717.29"/>
<polygon fill="black" stroke="black" points="4075.81,-18717.97 4075.02,-18707.4 4069.05,-18716.15 4075.81,-18717.97"/>
</g>
<!-- stage3_layer0_expert62_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge798" class="edge">
<title>stage3_layer0_expert62_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3924.54,-18644.23C3899.19,-18640.5 3873.24,-18636.85 3848.69,-18633.65 3716.83,-18616.49 3574.38,-18599.94 3441.02,-18585.31"/>
<polygon fill="black" stroke="black" points="3441.35,-18581.83 3431.03,-18584.22 3440.59,-18588.78 3441.35,-18581.83"/>
</g>
<!-- stage3_layer0_expert63_mlp1 -->
<g id="node610" class="node">
<title>stage3_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4470.69,-19080.73 4156.69,-19080.73 4156.69,-19028.73 4470.69,-19028.73 4470.69,-19080.73"/>
<text text-anchor="middle" x="4313.69" y="-19068.73" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4313.69" y="-19057.73" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4313.69" y="-19046.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4313.69" y="-19035.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer0_expert63&#45;&gt;stage3_layer0_expert63_mlp1 -->
<g id="edge784" class="edge">
<title>stage3_layer0_expert63&#45;&gt;stage3_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4269.96,-19116.4C4276.14,-19107.82 4283.13,-19098.12 4289.69,-19089.02"/>
<polygon fill="black" stroke="black" points="4292.54,-19091.05 4295.55,-19080.89 4286.87,-19086.95 4292.54,-19091.05"/>
</g>
<!-- stage3_layer0_expert63_tp1 -->
<g id="node611" class="node">
<title>stage3_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4440.69" cy="-18955.96" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4440.69" y="-18969.96" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4440.69" y="-18958.96" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="4440.69" y="-18947.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4440.69" y="-18936.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert63_mlp1&#45;&gt;stage3_layer0_expert63_tp1 -->
<g id="edge785" class="edge">
<title>stage3_layer0_expert63_mlp1&#45;&gt;stage3_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4346.72,-19028.56C4358.9,-19019.29 4373.03,-19008.52 4386.57,-18998.2"/>
<polygon fill="black" stroke="black" points="4389.08,-19000.69 4394.91,-18991.84 4384.84,-18995.12 4389.08,-19000.69"/>
</g>
<!-- stage3_layer0_expert63_act -->
<g id="node612" class="node">
<title>stage3_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4606.19,-18883.19 4325.19,-18883.19 4325.19,-18831.19 4606.19,-18831.19 4606.19,-18883.19"/>
<text text-anchor="middle" x="4465.69" y="-18871.19" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4465.69" y="-18860.19" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="4465.69" y="-18849.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4465.69" y="-18838.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer0_expert63_tp1&#45;&gt;stage3_layer0_expert63_act -->
<g id="edge786" class="edge">
<title>stage3_layer0_expert63_tp1&#45;&gt;stage3_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4449.93,-18919.2C4452.12,-18910.71 4454.46,-18901.65 4456.65,-18893.19"/>
<polygon fill="black" stroke="black" points="4460.11,-18893.79 4459.22,-18883.24 4453.33,-18892.04 4460.11,-18893.79"/>
</g>
<!-- stage3_layer0_expert63_mlp2 -->
<g id="node613" class="node">
<title>stage3_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4700.69,-18795.19 4378.69,-18795.19 4378.69,-18743.19 4700.69,-18743.19 4700.69,-18795.19"/>
<text text-anchor="middle" x="4539.69" y="-18783.19" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4539.69" y="-18772.19" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4539.69" y="-18761.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4539.69" y="-18750.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert63_act&#45;&gt;stage3_layer0_expert63_mlp2 -->
<g id="edge787" class="edge">
<title>stage3_layer0_expert63_act&#45;&gt;stage3_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4487.49,-18830.86C4494.94,-18822.2 4503.39,-18812.38 4511.29,-18803.2"/>
<polygon fill="black" stroke="black" points="4514.17,-18805.21 4518.04,-18795.35 4508.87,-18800.65 4514.17,-18805.21"/>
</g>
<!-- stage3_layer0_expert63_tp2 -->
<g id="node614" class="node">
<title>stage3_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4557.69" cy="-18670.42" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4557.69" y="-18684.42" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4557.69" y="-18673.42" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="4557.69" y="-18662.42" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4557.69" y="-18651.42" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_expert63_mlp2&#45;&gt;stage3_layer0_expert63_tp2 -->
<g id="edge788" class="edge">
<title>stage3_layer0_expert63_mlp2&#45;&gt;stage3_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4544.37,-18743.02C4545.84,-18735.13 4547.51,-18726.15 4549.16,-18717.29"/>
<polygon fill="black" stroke="black" points="4552.61,-18717.87 4551,-18707.4 4545.73,-18716.59 4552.61,-18717.87"/>
</g>
<!-- stage3_layer0_expert63_tp2&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge799" class="edge">
<title>stage3_layer0_expert63_tp2&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4400.18,-18643.81C4374.01,-18640.05 4347.12,-18636.5 4321.69,-18633.65 4014.5,-18599.28 3668.56,-18573.9 3395.16,-18556.93"/>
<polygon fill="black" stroke="black" points="3395.26,-18553.43 3385.06,-18556.31 3394.82,-18560.42 3395.26,-18553.43"/>
</g>
<!-- stage3_layer0_expert_ellipsis&#45;&gt;stage3_layer0_expert_agg -->
<g id="edge800" class="edge">
<title>stage3_layer0_expert_ellipsis&#45;&gt;stage3_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4697.8,-19028.46C4743.72,-18995.36 4813.69,-18932.7 4813.69,-18858.19 4813.69,-18858.19 4813.69,-18858.19 4813.69,-18768.19 4813.69,-18707.81 4839.18,-18674.48 4794.69,-18633.65 4742.79,-18586.04 3913.39,-18556.03 3370.12,-18541.38"/>
<polygon fill="black" stroke="black" points="3369.83,-18537.88 3359.74,-18541.11 3369.64,-18544.87 3369.83,-18537.88"/>
</g>
<!-- stage3_layer0_expert_agg&#45;&gt;stage3_layer0_output -->
<g id="edge801" class="edge">
<title>stage3_layer0_expert_agg&#45;&gt;stage3_layer0_output</title>
<path fill="none" stroke="black" d="M3248.08,-18473.78C3346.95,-18458.07 3451.94,-18441.39 3540.83,-18427.27"/>
<polygon fill="black" stroke="black" points="3541.43,-18430.72 3550.76,-18425.69 3540.34,-18423.8 3541.43,-18430.72"/>
</g>
<!-- stage3_layer1_ln -->
<g id="node618" class="node">
<title>stage3_layer1_ln</title>
<polygon fill="none" stroke="black" points="3983.69,-18321.65 3533.69,-18321.65 3533.69,-18253.65 3983.69,-18253.65 3983.69,-18321.65"/>
<text text-anchor="middle" x="3758.69" y="-18306.45" font-family="Times,serif" font-size="14.00">Layer 7 LayerNorm</text>
<text text-anchor="middle" x="3758.69" y="-18291.45" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-18276.45" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-18261.45" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer0_output&#45;&gt;stage3_layer1_ln -->
<g id="edge803" class="edge">
<title>stage3_layer0_output&#45;&gt;stage3_layer1_ln</title>
<path fill="none" stroke="black" d="M3758.69,-18357.54C3758.69,-18349.43 3758.69,-18340.64 3758.69,-18332.13"/>
<polygon fill="black" stroke="black" points="3762.19,-18331.95 3758.69,-18321.95 3755.19,-18331.95 3762.19,-18331.95"/>
</g>
<!-- stage3_layer1_attn_qkv -->
<g id="node619" class="node">
<title>stage3_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="3990.19,-18217.65 3527.19,-18217.65 3527.19,-18149.65 3990.19,-18149.65 3990.19,-18217.65"/>
<text text-anchor="middle" x="3758.69" y="-18202.45" font-family="Times,serif" font-size="14.00">Layer 7 Attention QKV Projection</text>
<text text-anchor="middle" x="3758.69" y="-18187.45" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP: GPU 384&#45;511)</text>
<text text-anchor="middle" x="3758.69" y="-18172.45" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-18157.45" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage3_layer1_ln&#45;&gt;stage3_layer1_attn_qkv -->
<g id="edge804" class="edge">
<title>stage3_layer1_ln&#45;&gt;stage3_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3758.69,-18253.54C3758.69,-18245.43 3758.69,-18236.64 3758.69,-18228.13"/>
<polygon fill="black" stroke="black" points="3762.19,-18227.95 3758.69,-18217.95 3755.19,-18227.95 3762.19,-18227.95"/>
</g>
<!-- stage3_layer1_tp_qkv_comm -->
<g id="node620" class="node">
<title>stage3_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-18065.57" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3758.69" y="-18084.37" font-family="Times,serif" font-size="14.00">Layer 7 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3758.69" y="-18069.37" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP pairs)</text>
<text text-anchor="middle" x="3758.69" y="-18054.37" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-18039.37" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage3_layer1_attn_qkv&#45;&gt;stage3_layer1_tp_qkv_comm -->
<g id="edge805" class="edge">
<title>stage3_layer1_attn_qkv&#45;&gt;stage3_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3758.69,-18149.39C3758.69,-18141.4 3758.69,-18132.63 3758.69,-18123.89"/>
<polygon fill="black" stroke="black" points="3762.19,-18123.68 3758.69,-18113.68 3755.19,-18123.68 3762.19,-18123.68"/>
</g>
<!-- stage3_layer1_attn_head0 -->
<g id="node621" class="node">
<title>stage3_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1567.19,-17981.49 1294.19,-17981.49 1294.19,-17929.49 1567.19,-17929.49 1567.19,-17981.49"/>
<text text-anchor="middle" x="1430.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 0 Attention</text>
<text text-anchor="middle" x="1430.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 0)</text>
<text text-anchor="middle" x="1430.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1430.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head0 -->
<g id="edge806" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3435.67,-18057.55C2923.05,-18045.51 1944.56,-18018.71 1577.38,-17981.59"/>
<polygon fill="black" stroke="black" points="1577.54,-17978.09 1567.23,-17980.55 1576.82,-17985.06 1577.54,-17978.09"/>
</g>
<!-- stage3_layer1_attn_head1 -->
<g id="node622" class="node">
<title>stage3_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1858.19,-17981.49 1585.19,-17981.49 1585.19,-17929.49 1858.19,-17929.49 1858.19,-17981.49"/>
<text text-anchor="middle" x="1721.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 1 Attention</text>
<text text-anchor="middle" x="1721.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 1)</text>
<text text-anchor="middle" x="1721.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1721.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head1 -->
<g id="edge807" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3431.73,-18062.78C3056.12,-18057.83 2421.43,-18040.62 1868.41,-17981.62"/>
<polygon fill="black" stroke="black" points="1868.55,-17978.11 1858.23,-17980.53 1867.8,-17985.07 1868.55,-17978.11"/>
</g>
<!-- stage3_layer1_attn_head2 -->
<g id="node623" class="node">
<title>stage3_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2149.19,-17981.49 1876.19,-17981.49 1876.19,-17929.49 2149.19,-17929.49 2149.19,-17981.49"/>
<text text-anchor="middle" x="2012.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 2 Attention</text>
<text text-anchor="middle" x="2012.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 2)</text>
<text text-anchor="middle" x="2012.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2012.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head2 -->
<g id="edge808" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3434.26,-18059.03C3112.63,-18050.91 2605.92,-18031.02 2159.44,-17981.63"/>
<polygon fill="black" stroke="black" points="2159.56,-17978.12 2149.24,-17980.5 2158.79,-17985.08 2159.56,-17978.12"/>
</g>
<!-- stage3_layer1_attn_head3 -->
<g id="node624" class="node">
<title>stage3_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2440.19,-17981.49 2167.19,-17981.49 2167.19,-17929.49 2440.19,-17929.49 2440.19,-17981.49"/>
<text text-anchor="middle" x="2303.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 3 Attention</text>
<text text-anchor="middle" x="2303.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 3)</text>
<text text-anchor="middle" x="2303.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2303.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head3 -->
<g id="edge809" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3440.84,-18053.97C3177.62,-18042.92 2793.78,-18021.59 2450.39,-17981.64"/>
<polygon fill="black" stroke="black" points="2450.58,-17978.14 2440.24,-17980.45 2449.77,-17985.09 2450.58,-17978.14"/>
</g>
<!-- stage3_layer1_attn_head4 -->
<g id="node625" class="node">
<title>stage3_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2731.19,-17981.49 2458.19,-17981.49 2458.19,-17929.49 2731.19,-17929.49 2731.19,-17981.49"/>
<text text-anchor="middle" x="2594.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 4 Attention</text>
<text text-anchor="middle" x="2594.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 4)</text>
<text text-anchor="middle" x="2594.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2594.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head4 -->
<g id="edge810" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3456.43,-18047.03C3256.07,-18033.69 2987.29,-18012.51 2741.46,-17981.67"/>
<polygon fill="black" stroke="black" points="2741.61,-17978.16 2731.25,-17980.38 2740.73,-17985.11 2741.61,-17978.16"/>
</g>
<!-- stage3_layer1_attn_head5 -->
<g id="node626" class="node">
<title>stage3_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3022.19,-17981.49 2749.19,-17981.49 2749.19,-17929.49 3022.19,-17929.49 3022.19,-17981.49"/>
<text text-anchor="middle" x="2885.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 5 Attention</text>
<text text-anchor="middle" x="2885.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 5)</text>
<text text-anchor="middle" x="2885.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2885.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head5 -->
<g id="edge811" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3491.12,-18037.73C3356.28,-18023.29 3190.06,-18004.1 3032.62,-17981.74"/>
<polygon fill="black" stroke="black" points="3032.66,-17978.21 3022.27,-17980.26 3031.67,-17985.14 3032.66,-17978.21"/>
</g>
<!-- stage3_layer1_attn_head6 -->
<g id="node627" class="node">
<title>stage3_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3313.19,-17981.49 3040.19,-17981.49 3040.19,-17929.49 3313.19,-17929.49 3313.19,-17981.49"/>
<text text-anchor="middle" x="3176.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 6 Attention</text>
<text text-anchor="middle" x="3176.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 6)</text>
<text text-anchor="middle" x="3176.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3176.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head6 -->
<g id="edge812" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3558.8,-18027.45C3480.89,-18012.98 3393.29,-17996.71 3321.64,-17983.41"/>
<polygon fill="black" stroke="black" points="3322.1,-17979.93 3311.63,-17981.55 3320.83,-17986.82 3322.1,-17979.93"/>
</g>
<!-- stage3_layer1_attn_head7 -->
<g id="node628" class="node">
<title>stage3_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3604.19,-17981.49 3331.19,-17981.49 3331.19,-17929.49 3604.19,-17929.49 3604.19,-17981.49"/>
<text text-anchor="middle" x="3467.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 7 Attention</text>
<text text-anchor="middle" x="3467.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 7)</text>
<text text-anchor="middle" x="3467.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3467.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head7 -->
<g id="edge813" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3640.33,-18020.61C3608.09,-18008.64 3574.02,-17995.98 3544.74,-17985.11"/>
<polygon fill="black" stroke="black" points="3545.59,-17981.69 3535,-17981.49 3543.15,-17988.25 3545.59,-17981.69"/>
</g>
<!-- stage3_layer1_attn_ellipsis -->
<g id="node629" class="node">
<title>stage3_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3895.19,-17981.49 3622.19,-17981.49 3622.19,-17929.49 3895.19,-17929.49 3895.19,-17981.49"/>
<text text-anchor="middle" x="3758.69" y="-17969.49" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3758.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_ellipsis -->
<g id="edge814" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3758.69,-18017.48C3758.69,-18008.94 3758.69,-18000.16 3758.69,-17992.01"/>
<polygon fill="black" stroke="black" points="3762.19,-17991.75 3758.69,-17981.75 3755.19,-17991.75 3762.19,-17991.75"/>
</g>
<!-- stage3_layer1_attn_head24 -->
<g id="node630" class="node">
<title>stage3_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4186.19,-17981.49 3913.19,-17981.49 3913.19,-17929.49 4186.19,-17929.49 4186.19,-17981.49"/>
<text text-anchor="middle" x="4049.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 24 Attention</text>
<text text-anchor="middle" x="4049.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 24)</text>
<text text-anchor="middle" x="4049.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4049.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head24 -->
<g id="edge815" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3877.05,-18020.61C3909.28,-18008.64 3943.36,-17995.98 3972.64,-17985.11"/>
<polygon fill="black" stroke="black" points="3974.22,-17988.25 3982.38,-17981.49 3971.79,-17981.69 3974.22,-17988.25"/>
</g>
<!-- stage3_layer1_attn_head25 -->
<g id="node631" class="node">
<title>stage3_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4477.19,-17981.49 4204.19,-17981.49 4204.19,-17929.49 4477.19,-17929.49 4477.19,-17981.49"/>
<text text-anchor="middle" x="4340.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 25 Attention</text>
<text text-anchor="middle" x="4340.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 25)</text>
<text text-anchor="middle" x="4340.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4340.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head25 -->
<g id="edge816" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M3958.57,-18027.45C4036.48,-18012.98 4124.09,-17996.71 4195.74,-17983.41"/>
<polygon fill="black" stroke="black" points="4196.55,-17986.82 4205.74,-17981.55 4195.27,-17979.93 4196.55,-17986.82"/>
</g>
<!-- stage3_layer1_attn_head26 -->
<g id="node632" class="node">
<title>stage3_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4768.19,-17981.49 4495.19,-17981.49 4495.19,-17929.49 4768.19,-17929.49 4768.19,-17981.49"/>
<text text-anchor="middle" x="4631.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 26 Attention</text>
<text text-anchor="middle" x="4631.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 26)</text>
<text text-anchor="middle" x="4631.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4631.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head26 -->
<g id="edge817" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4025.45,-18037.69C4160.31,-18023.21 4326.69,-18003.98 4485.01,-17981.55"/>
<polygon fill="black" stroke="black" points="4485.54,-17985.01 4494.95,-17980.14 4484.55,-17978.08 4485.54,-17985.01"/>
</g>
<!-- stage3_layer1_attn_head27 -->
<g id="node633" class="node">
<title>stage3_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5059.19,-17981.49 4786.19,-17981.49 4786.19,-17929.49 5059.19,-17929.49 5059.19,-17981.49"/>
<text text-anchor="middle" x="4922.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 27 Attention</text>
<text text-anchor="middle" x="4922.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 27)</text>
<text text-anchor="middle" x="4922.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4922.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head27 -->
<g id="edge818" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4060.64,-18046.93C4260.8,-18033.54 4529.31,-18012.35 4775.73,-17981.56"/>
<polygon fill="black" stroke="black" points="4776.48,-17985 4785.96,-17980.28 4775.61,-17978.05 4776.48,-17985"/>
</g>
<!-- stage3_layer1_attn_head28 -->
<g id="node634" class="node">
<title>stage3_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5350.19,-17981.49 5077.19,-17981.49 5077.19,-17929.49 5350.19,-17929.49 5350.19,-17981.49"/>
<text text-anchor="middle" x="5213.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 28 Attention</text>
<text text-anchor="middle" x="5213.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 28)</text>
<text text-anchor="middle" x="5213.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5213.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head28 -->
<g id="edge819" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4076.28,-18053.86C4339.3,-18042.74 4722.83,-18021.38 5066.81,-17981.54"/>
<polygon fill="black" stroke="black" points="5067.45,-17984.98 5076.97,-17980.35 5066.64,-17978.03 5067.45,-17984.98"/>
</g>
<!-- stage3_layer1_attn_head29 -->
<g id="node635" class="node">
<title>stage3_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5641.19,-17981.49 5368.19,-17981.49 5368.19,-17929.49 5641.19,-17929.49 5641.19,-17981.49"/>
<text text-anchor="middle" x="5504.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 29 Attention</text>
<text text-anchor="middle" x="5504.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 29)</text>
<text text-anchor="middle" x="5504.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5504.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head29 -->
<g id="edge820" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4083.28,-18058.91C4404.72,-18050.69 4910.89,-18030.72 5357.77,-17981.53"/>
<polygon fill="black" stroke="black" points="5358.43,-17984.98 5367.98,-17980.4 5357.66,-17978.02 5358.43,-17984.98"/>
</g>
<!-- stage3_layer1_attn_head30 -->
<g id="node636" class="node">
<title>stage3_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="5932.19,-17981.49 5659.19,-17981.49 5659.19,-17929.49 5932.19,-17929.49 5932.19,-17981.49"/>
<text text-anchor="middle" x="5795.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 30 Attention</text>
<text text-anchor="middle" x="5795.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 30)</text>
<text text-anchor="middle" x="5795.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5795.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head30 -->
<g id="edge821" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4085.89,-18062.65C4461.34,-18057.58 5095.41,-18040.26 5648.8,-17981.52"/>
<polygon fill="black" stroke="black" points="5649.41,-17984.97 5658.98,-17980.43 5648.67,-17978.01 5649.41,-17984.97"/>
</g>
<!-- stage3_layer1_attn_head31 -->
<g id="node637" class="node">
<title>stage3_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6223.19,-17981.49 5950.19,-17981.49 5950.19,-17929.49 6223.19,-17929.49 6223.19,-17981.49"/>
<text text-anchor="middle" x="6086.69" y="-17969.49" font-family="Times,serif" font-size="10.00">Layer 7 Head 31 Attention</text>
<text text-anchor="middle" x="6086.69" y="-17958.49" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Head 31)</text>
<text text-anchor="middle" x="6086.69" y="-17947.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6086.69" y="-17936.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head31 -->
<g id="edge822" class="edge">
<title>stage3_layer1_tp_qkv_comm&#45;&gt;stage3_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4081.55,-18057.5C4593.93,-18045.4 5571.97,-18018.5 5939.81,-17981.5"/>
<polygon fill="black" stroke="black" points="5940.39,-17984.96 5949.99,-17980.46 5939.68,-17977.99 5940.39,-17984.96"/>
</g>
<!-- stage3_layer1_attn_agg -->
<g id="node638" class="node">
<title>stage3_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4226.34,-17893.49 3482.41,-17893.49 3291.04,-17757.49 4034.97,-17757.49 4226.34,-17893.49"/>
<text text-anchor="middle" x="3758.69" y="-17844.29" font-family="Times,serif" font-size="14.00">Layer 7 Attention Aggregate</text>
<text text-anchor="middle" x="3758.69" y="-17829.29" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-17814.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-17799.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_attn_head0&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge823" class="edge">
<title>stage3_layer1_attn_head0&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1567.23,-17930.46C1570.07,-17930.12 1572.9,-17929.79 1575.69,-17929.49 2207.18,-17860.42 2946.43,-17837.64 3382.36,-17830.14"/>
<polygon fill="black" stroke="black" points="3382.67,-17833.64 3392.61,-17829.97 3382.55,-17826.64 3382.67,-17833.64"/>
</g>
<!-- stage3_layer1_attn_head1&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge824" class="edge">
<title>stage3_layer1_attn_head1&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1858.24,-17930.49C1861.08,-17930.14 1863.9,-17929.8 1866.69,-17929.49 2392.99,-17870 3005.69,-17844.59 3387.91,-17833.93"/>
<polygon fill="black" stroke="black" points="3388.12,-17837.43 3398.02,-17833.65 3387.93,-17830.43 3388.12,-17837.43"/>
</g>
<!-- stage3_layer1_attn_head2&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge825" class="edge">
<title>stage3_layer1_attn_head2&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2149.24,-17930.53C2152.08,-17930.16 2154.9,-17929.82 2157.69,-17929.49 2580.66,-17879.56 3069.57,-17852.53 3394.72,-17838.86"/>
<polygon fill="black" stroke="black" points="3394.93,-17842.35 3404.77,-17838.43 3394.63,-17835.36 3394.93,-17842.35"/>
</g>
<!-- stage3_layer1_attn_head3&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge826" class="edge">
<title>stage3_layer1_attn_head3&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2440.25,-17930.58C2443.08,-17930.2 2445.9,-17929.84 2448.69,-17929.49 2770.79,-17889.14 3139.56,-17861.83 3403.59,-17845.52"/>
<polygon fill="black" stroke="black" points="3403.96,-17849 3413.72,-17844.9 3403.53,-17842.02 3403.96,-17849"/>
</g>
<!-- stage3_layer1_attn_head4&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge827" class="edge">
<title>stage3_layer1_attn_head4&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2731.26,-17930.67C2734.09,-17930.26 2736.9,-17929.87 2739.69,-17929.49 2964.59,-17898.77 3218.58,-17873.08 3416.72,-17855.03"/>
<polygon fill="black" stroke="black" points="3417.07,-17858.52 3426.71,-17854.13 3416.43,-17851.55 3417.07,-17858.52"/>
</g>
<!-- stage3_layer1_attn_head5&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge828" class="edge">
<title>stage3_layer1_attn_head5&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3022.28,-17930.82C3025.11,-17930.37 3027.91,-17929.92 3030.69,-17929.49 3163.44,-17908.66 3310.12,-17887.54 3436.83,-17869.9"/>
<polygon fill="black" stroke="black" points="3437.65,-17873.31 3447.08,-17868.47 3436.69,-17866.38 3437.65,-17873.31"/>
</g>
<!-- stage3_layer1_attn_head6&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge829" class="edge">
<title>stage3_layer1_attn_head6&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3290.63,-17929.43C3341.21,-17918.31 3403.29,-17904.65 3465.5,-17890.97"/>
<polygon fill="black" stroke="black" points="3466.47,-17894.34 3475.49,-17888.77 3464.97,-17887.5 3466.47,-17894.34"/>
</g>
<!-- stage3_layer1_attn_head7&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge830" class="edge">
<title>stage3_layer1_attn_head7&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3524.83,-17929.35C3546.01,-17920.04 3571.2,-17908.96 3597.08,-17897.58"/>
<polygon fill="black" stroke="black" points="3598.51,-17900.77 3606.25,-17893.54 3595.69,-17894.36 3598.51,-17900.77"/>
</g>
<!-- stage3_layer1_attn_ellipsis&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge831" class="edge">
<title>stage3_layer1_attn_ellipsis&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3758.69,-17929.2C3758.69,-17921.6 3758.69,-17912.84 3758.69,-17903.7"/>
<polygon fill="black" stroke="black" points="3762.19,-17903.67 3758.69,-17893.67 3755.19,-17903.67 3762.19,-17903.67"/>
</g>
<!-- stage3_layer1_attn_head24&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge832" class="edge">
<title>stage3_layer1_attn_head24&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3992.54,-17929.35C3971.37,-17920.04 3946.18,-17908.96 3920.3,-17897.58"/>
<polygon fill="black" stroke="black" points="3921.69,-17894.36 3911.12,-17893.54 3918.87,-17900.77 3921.69,-17894.36"/>
</g>
<!-- stage3_layer1_attn_head25&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge833" class="edge">
<title>stage3_layer1_attn_head25&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4226.74,-17929.43C4182.03,-17919.59 4128.31,-17907.78 4073.45,-17895.71"/>
<polygon fill="black" stroke="black" points="4074.08,-17892.27 4063.56,-17893.54 4072.58,-17899.11 4074.08,-17892.27"/>
</g>
<!-- stage3_layer1_attn_head26&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge834" class="edge">
<title>stage3_layer1_attn_head26&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4494.93,-17930.95C4491.82,-17930.45 4488.74,-17929.97 4485.69,-17929.49 4403.61,-17916.65 4316.21,-17903.67 4231.51,-17891.46"/>
<polygon fill="black" stroke="black" points="4231.86,-17887.97 4221.46,-17890.01 4230.86,-17894.9 4231.86,-17887.97"/>
</g>
<!-- stage3_layer1_attn_head27&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge835" class="edge">
<title>stage3_layer1_attn_head27&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4785.95,-17930.78C4782.84,-17930.34 4779.75,-17929.9 4776.69,-17929.49 4586.01,-17903.55 4374.43,-17881.12 4193.77,-17863.87"/>
<polygon fill="black" stroke="black" points="4193.84,-17860.36 4183.56,-17862.9 4193.18,-17867.33 4193.84,-17860.36"/>
</g>
<!-- stage3_layer1_attn_head28&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge836" class="edge">
<title>stage3_layer1_attn_head28&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5076.97,-17930.69C5073.85,-17930.27 5070.75,-17929.87 5067.69,-17929.49 4769.68,-17892.33 4431.74,-17866.14 4173.88,-17849.47"/>
<polygon fill="black" stroke="black" points="4173.79,-17845.95 4163.59,-17848.8 4173.34,-17852.94 4173.79,-17845.95"/>
</g>
<!-- stage3_layer1_attn_head29&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge837" class="edge">
<title>stage3_layer1_attn_head29&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5367.97,-17930.63C5364.85,-17930.23 5361.75,-17929.85 5358.69,-17929.49 4952.71,-17881.8 4485.99,-17854.93 4161.82,-17840.68"/>
<polygon fill="black" stroke="black" points="4161.94,-17837.19 4151.79,-17840.25 4161.63,-17844.18 4161.94,-17837.19"/>
</g>
<!-- stage3_layer1_attn_head30&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge838" class="edge">
<title>stage3_layer1_attn_head30&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5658.98,-17930.59C5655.85,-17930.2 5652.75,-17929.83 5649.69,-17929.49 5134.76,-17871.57 4537.15,-17845.93 4153.82,-17834.77"/>
<polygon fill="black" stroke="black" points="4153.77,-17831.27 4143.67,-17834.48 4153.57,-17838.27 4153.77,-17831.27"/>
</g>
<!-- stage3_layer1_attn_head31&#45;&gt;stage3_layer1_attn_agg -->
<g id="edge839" class="edge">
<title>stage3_layer1_attn_head31&#45;&gt;stage3_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5949.98,-17930.56C5946.86,-17930.18 5943.76,-17929.82 5940.69,-17929.49 5315.76,-17861.49 4585.31,-17838.37 4147.99,-17830.51"/>
<polygon fill="black" stroke="black" points="4147.77,-17827.01 4137.71,-17830.33 4147.65,-17834.01 4147.77,-17827.01"/>
</g>
<!-- stage3_layer1_attn_out -->
<g id="node639" class="node">
<title>stage3_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="3983.69,-17721.49 3533.69,-17721.49 3533.69,-17653.49 3983.69,-17653.49 3983.69,-17721.49"/>
<text text-anchor="middle" x="3758.69" y="-17706.29" font-family="Times,serif" font-size="14.00">Layer 7 Attention Output Proj</text>
<text text-anchor="middle" x="3758.69" y="-17691.29" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP: GPU 384&#45;511)</text>
<text text-anchor="middle" x="3758.69" y="-17676.29" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-17661.29" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_attn_agg&#45;&gt;stage3_layer1_attn_out -->
<g id="edge840" class="edge">
<title>stage3_layer1_attn_agg&#45;&gt;stage3_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3758.69,-17757.28C3758.69,-17748.53 3758.69,-17739.76 3758.69,-17731.56"/>
<polygon fill="black" stroke="black" points="3762.19,-17731.5 3758.69,-17721.5 3755.19,-17731.5 3762.19,-17731.5"/>
</g>
<!-- stage3_layer1_tp_attn_comm -->
<g id="node640" class="node">
<title>stage3_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-17569.4" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3758.69" y="-17588.2" font-family="Times,serif" font-size="14.00">Layer 7 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3758.69" y="-17573.2" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3 (TP pairs)</text>
<text text-anchor="middle" x="3758.69" y="-17558.2" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-17543.2" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_attn_out&#45;&gt;stage3_layer1_tp_attn_comm -->
<g id="edge841" class="edge">
<title>stage3_layer1_attn_out&#45;&gt;stage3_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3758.69,-17653.22C3758.69,-17645.23 3758.69,-17636.46 3758.69,-17627.72"/>
<polygon fill="black" stroke="black" points="3762.19,-17627.51 3758.69,-17617.51 3755.19,-17627.51 3762.19,-17627.51"/>
</g>
<!-- stage3_layer1_expert_router -->
<g id="node641" class="node">
<title>stage3_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4212.88,-17485.32 3490.36,-17485.32 3304.49,-17349.32 4027.02,-17349.32 4212.88,-17485.32"/>
<text text-anchor="middle" x="3758.69" y="-17436.12" font-family="Times,serif" font-size="14.00">Layer 7 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3758.69" y="-17421.12" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-17406.12" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-17391.12" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage3_layer1_tp_attn_comm&#45;&gt;stage3_layer1_expert_router -->
<g id="edge842" class="edge">
<title>stage3_layer1_tp_attn_comm&#45;&gt;stage3_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3758.69,-17520.92C3758.69,-17512.83 3758.69,-17504.25 3758.69,-17495.63"/>
<polygon fill="black" stroke="black" points="3762.19,-17495.52 3758.69,-17485.52 3755.19,-17495.52 3762.19,-17495.52"/>
</g>
<!-- stage3_layer1_expert0 -->
<g id="node642" class="node">
<title>stage3_layer1_expert0</title>
<polygon fill="none" stroke="black" points="1984.69,-17313.32 1662.69,-17313.32 1662.69,-17261.32 1984.69,-17261.32 1984.69,-17313.32"/>
<text text-anchor="middle" x="1823.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 0</text>
<text text-anchor="middle" x="1823.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP pair)</text>
<text text-anchor="middle" x="1823.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1823.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert0 -->
<g id="edge843" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3362.31,-17391.66C3039.76,-17371.37 2572.76,-17341.46 2164.69,-17313.32 2109.5,-17309.52 2049.29,-17305.17 1995.05,-17301.18"/>
<polygon fill="black" stroke="black" points="1995.22,-17297.68 1984.99,-17300.43 1994.7,-17304.66 1995.22,-17297.68"/>
</g>
<!-- stage3_layer1_expert1 -->
<g id="node648" class="node">
<title>stage3_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2495.69,-17313.32 2173.69,-17313.32 2173.69,-17261.32 2495.69,-17261.32 2495.69,-17313.32"/>
<text text-anchor="middle" x="2334.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 1</text>
<text text-anchor="middle" x="2334.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP pair)</text>
<text text-anchor="middle" x="2334.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2334.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert1 -->
<g id="edge849" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3354.44,-17386.04C3116.7,-17367.27 2810.38,-17341.43 2538.69,-17313.32 2528.02,-17312.22 2517.05,-17311.03 2505.99,-17309.79"/>
<polygon fill="black" stroke="black" points="2506.14,-17306.29 2495.81,-17308.64 2505.36,-17313.24 2506.14,-17306.29"/>
</g>
<!-- stage3_layer1_expert2 -->
<g id="node654" class="node">
<title>stage3_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2869.69,-17313.32 2547.69,-17313.32 2547.69,-17261.32 2869.69,-17261.32 2869.69,-17313.32"/>
<text text-anchor="middle" x="2708.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 2</text>
<text text-anchor="middle" x="2708.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP pair)</text>
<text text-anchor="middle" x="2708.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2708.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert2 -->
<g id="edge855" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3327.25,-17366.04C3189.32,-17349.64 3036.03,-17331.08 2895.69,-17313.32 2890.54,-17312.67 2885.31,-17312 2880.04,-17311.33"/>
<polygon fill="black" stroke="black" points="2880.2,-17307.82 2869.83,-17310.01 2879.3,-17314.76 2880.2,-17307.82"/>
</g>
<!-- stage3_layer1_expert3 -->
<g id="node660" class="node">
<title>stage3_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3226.69,-17313.32 2904.69,-17313.32 2904.69,-17261.32 3226.69,-17261.32 3226.69,-17313.32"/>
<text text-anchor="middle" x="3065.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 3</text>
<text text-anchor="middle" x="3065.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP pair)</text>
<text text-anchor="middle" x="3065.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3065.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert3 -->
<g id="edge861" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3395.7,-17349.28C3330.37,-17337.21 3265.83,-17325.29 3211.39,-17315.23"/>
<polygon fill="black" stroke="black" points="3211.81,-17311.75 3201.35,-17313.38 3210.54,-17318.64 3211.81,-17311.75"/>
</g>
<!-- stage3_layer1_expert31 -->
<g id="node666" class="node">
<title>stage3_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3575.69,-17313.32 3253.69,-17313.32 3253.69,-17261.32 3575.69,-17261.32 3575.69,-17313.32"/>
<text text-anchor="middle" x="3414.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 31</text>
<text text-anchor="middle" x="3414.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP pair)</text>
<text text-anchor="middle" x="3414.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3414.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert31 -->
<g id="edge867" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3578.38,-17349.23C3547.72,-17337.82 3517.41,-17326.54 3491.36,-17316.85"/>
<polygon fill="black" stroke="black" points="3492.56,-17313.56 3481.97,-17313.36 3490.12,-17320.12 3492.56,-17313.56"/>
</g>
<!-- stage3_layer1_expert32 -->
<g id="node672" class="node">
<title>stage3_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3919.69,-17313.32 3597.69,-17313.32 3597.69,-17261.32 3919.69,-17261.32 3919.69,-17313.32"/>
<text text-anchor="middle" x="3758.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 32</text>
<text text-anchor="middle" x="3758.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP pair)</text>
<text text-anchor="middle" x="3758.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert32 -->
<g id="edge873" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3758.69,-17348.95C3758.69,-17340.25 3758.69,-17331.64 3758.69,-17323.76"/>
<polygon fill="black" stroke="black" points="3762.19,-17323.52 3758.69,-17313.52 3755.19,-17323.52 3762.19,-17323.52"/>
</g>
<!-- stage3_layer1_expert60 -->
<g id="node678" class="node">
<title>stage3_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4303.69,-17313.32 3981.69,-17313.32 3981.69,-17261.32 4303.69,-17261.32 4303.69,-17313.32"/>
<text text-anchor="middle" x="4142.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 60</text>
<text text-anchor="middle" x="4142.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP pair)</text>
<text text-anchor="middle" x="4142.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4142.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert60 -->
<g id="edge879" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3959.97,-17349.23C3994.49,-17337.72 4028.62,-17326.35 4057.86,-17316.6"/>
<polygon fill="black" stroke="black" points="4059.21,-17319.84 4067.59,-17313.36 4056.99,-17313.2 4059.21,-17319.84"/>
</g>
<!-- stage3_layer1_expert61 -->
<g id="node684" class="node">
<title>stage3_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4706.69,-17313.32 4384.69,-17313.32 4384.69,-17261.32 4706.69,-17261.32 4706.69,-17313.32"/>
<text text-anchor="middle" x="4545.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 61</text>
<text text-anchor="middle" x="4545.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP pair)</text>
<text text-anchor="middle" x="4545.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4545.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert61 -->
<g id="edge885" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4053.14,-17368.43C4164.33,-17350.35 4286.8,-17330.43 4381.8,-17314.98"/>
<polygon fill="black" stroke="black" points="4382.48,-17318.41 4391.79,-17313.35 4381.35,-17311.5 4382.48,-17318.41"/>
</g>
<!-- stage3_layer1_expert62 -->
<g id="node690" class="node">
<title>stage3_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5105.69,-17313.32 4783.69,-17313.32 4783.69,-17261.32 5105.69,-17261.32 5105.69,-17313.32"/>
<text text-anchor="middle" x="4944.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 62</text>
<text text-anchor="middle" x="4944.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP pair)</text>
<text text-anchor="middle" x="4944.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4944.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert62 -->
<g id="edge891" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4072.81,-17382.64C4259.58,-17362.58 4501.17,-17336.58 4715.69,-17313.32 4734.4,-17311.29 4753.96,-17309.17 4773.44,-17307.05"/>
<polygon fill="black" stroke="black" points="4774.05,-17310.5 4783.61,-17305.94 4773.29,-17303.54 4774.05,-17310.5"/>
</g>
<!-- stage3_layer1_expert63 -->
<g id="node696" class="node">
<title>stage3_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5475.69,-17313.32 5153.69,-17313.32 5153.69,-17261.32 5475.69,-17261.32 5475.69,-17313.32"/>
<text text-anchor="middle" x="5314.69" y="-17301.32" font-family="Times,serif" font-size="10.00">Layer 7 Expert 63</text>
<text text-anchor="middle" x="5314.69" y="-17290.32" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP pair)</text>
<text text-anchor="middle" x="5314.69" y="-17279.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5314.69" y="-17268.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert63 -->
<g id="edge897" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4090.66,-17395.62C4365.43,-17377.4 4765.84,-17348.35 5114.69,-17313.32 5124.06,-17312.38 5133.66,-17311.36 5143.36,-17310.29"/>
<polygon fill="black" stroke="black" points="5143.93,-17313.75 5153.48,-17309.16 5143.16,-17306.79 5143.93,-17313.75"/>
</g>
<!-- stage3_layer1_expert_ellipsis -->
<g id="node702" class="node">
<title>stage3_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6052.69,-17225.32 5730.69,-17225.32 5730.69,-17173.32 6052.69,-17173.32 6052.69,-17225.32"/>
<text text-anchor="middle" x="5891.69" y="-17213.32" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5891.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: Pipeline 3 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5891.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5891.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert_ellipsis -->
<g id="edge903" class="edge">
<title>stage3_layer1_expert_router&#45;&gt;stage3_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4102.73,-17404.4C4528.36,-17388.14 5228.19,-17356.09 5484.69,-17313.32 5599.55,-17294.17 5728.52,-17255.3 5809.89,-17228.54"/>
<polygon fill="black" stroke="black" points="5811.18,-17231.8 5819.58,-17225.34 5808.98,-17225.16 5811.18,-17231.8"/>
</g>
<!-- stage3_layer1_expert0_mlp1 -->
<g id="node643" class="node">
<title>stage3_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1872.69,-17225.32 1558.69,-17225.32 1558.69,-17173.32 1872.69,-17173.32 1872.69,-17225.32"/>
<text text-anchor="middle" x="1715.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1715.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1715.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1715.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert0&#45;&gt;stage3_layer1_expert0_mlp1 -->
<g id="edge844" class="edge">
<title>stage3_layer1_expert0&#45;&gt;stage3_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1792.16,-17261.22C1780.73,-17252.11 1767.66,-17241.71 1755.6,-17232.1"/>
<polygon fill="black" stroke="black" points="1757.45,-17229.1 1747.44,-17225.61 1753.09,-17234.57 1757.45,-17229.1"/>
</g>
<!-- stage3_layer1_expert0_tp1 -->
<g id="node644" class="node">
<title>stage3_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1528.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1528.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1528.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="1528.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1528.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert0_mlp1&#45;&gt;stage3_layer1_expert0_tp1 -->
<g id="edge845" class="edge">
<title>stage3_layer1_expert0_mlp1&#45;&gt;stage3_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1667.04,-17173.15C1647.54,-17163.05 1624.62,-17151.19 1603.11,-17140.06"/>
<polygon fill="black" stroke="black" points="1604.48,-17136.83 1593.99,-17135.34 1601.26,-17143.05 1604.48,-17136.83"/>
</g>
<!-- stage3_layer1_expert0_act -->
<g id="node645" class="node">
<title>stage3_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1664.19,-17027.78 1383.19,-17027.78 1383.19,-16975.78 1664.19,-16975.78 1664.19,-17027.78"/>
<text text-anchor="middle" x="1523.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1523.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="1523.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1523.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert0_tp1&#45;&gt;stage3_layer1_expert0_act -->
<g id="edge846" class="edge">
<title>stage3_layer1_expert0_tp1&#45;&gt;stage3_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1526.83,-17063.52C1526.4,-17055.21 1525.94,-17046.37 1525.51,-17038.09"/>
<polygon fill="black" stroke="black" points="1529,-17037.78 1524.99,-17027.98 1522.01,-17038.15 1529,-17037.78"/>
</g>
<!-- stage3_layer1_expert0_mlp2 -->
<g id="node646" class="node">
<title>stage3_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1597.69,-16939.78 1275.69,-16939.78 1275.69,-16887.78 1597.69,-16887.78 1597.69,-16939.78"/>
<text text-anchor="middle" x="1436.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1436.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1436.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1436.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert0_act&#45;&gt;stage3_layer1_expert0_mlp2 -->
<g id="edge847" class="edge">
<title>stage3_layer1_expert0_act&#45;&gt;stage3_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1498.06,-16975.44C1489.12,-16966.61 1478.96,-16956.57 1469.52,-16947.24"/>
<polygon fill="black" stroke="black" points="1471.71,-16944.48 1462.14,-16939.94 1466.79,-16949.46 1471.71,-16944.48"/>
</g>
<!-- stage3_layer1_expert0_tp2 -->
<g id="node647" class="node">
<title>stage3_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1393.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1393.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1393.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 384&#45;385</text>
<text text-anchor="middle" x="1393.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1393.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert0_mlp2&#45;&gt;stage3_layer1_expert0_tp2 -->
<g id="edge848" class="edge">
<title>stage3_layer1_expert0_mlp2&#45;&gt;stage3_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1425.5,-16887.61C1421.92,-16879.55 1417.84,-16870.36 1413.82,-16861.31"/>
<polygon fill="black" stroke="black" points="1416.93,-16859.71 1409.67,-16851.99 1410.54,-16862.55 1416.93,-16859.71"/>
</g>
<!-- stage3_layer1_expert_agg -->
<g id="node703" class="node">
<title>stage3_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4309.22,-16742.24 3433.45,-16742.24 3208.16,-16606.24 4083.93,-16606.24 4309.22,-16742.24"/>
<text text-anchor="middle" x="3758.69" y="-16693.04" font-family="Times,serif" font-size="14.00">Layer 7 Expert Aggregation</text>
<text text-anchor="middle" x="3758.69" y="-16678.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-16663.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16648.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert0_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge904" class="edge">
<title>stage3_layer1_expert0_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1549.23,-16788.14C1576.01,-16784.34 1603.61,-16780.84 1629.69,-16778.24 2214.93,-16719.89 2894.1,-16694.29 3324.99,-16683.27"/>
<polygon fill="black" stroke="black" points="3325.22,-16686.77 3335.12,-16683.01 3325.04,-16679.77 3325.22,-16686.77"/>
</g>
<!-- stage3_layer1_expert1_mlp1 -->
<g id="node649" class="node">
<title>stage3_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2463.69,-17225.32 2149.69,-17225.32 2149.69,-17173.32 2463.69,-17173.32 2463.69,-17225.32"/>
<text text-anchor="middle" x="2306.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2306.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2306.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2306.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert1&#45;&gt;stage3_layer1_expert1_mlp1 -->
<g id="edge850" class="edge">
<title>stage3_layer1_expert1&#45;&gt;stage3_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2326.44,-17260.98C2323.79,-17252.85 2320.81,-17243.69 2317.98,-17235.01"/>
<polygon fill="black" stroke="black" points="2321.3,-17233.9 2314.88,-17225.48 2314.65,-17236.07 2321.3,-17233.9"/>
</g>
<!-- stage3_layer1_expert1_tp1 -->
<g id="node650" class="node">
<title>stage3_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2023.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2023.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2023.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="2023.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2023.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert1_mlp1&#45;&gt;stage3_layer1_expert1_tp1 -->
<g id="edge851" class="edge">
<title>stage3_layer1_expert1_mlp1&#45;&gt;stage3_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2233.44,-17173.28C2200.59,-17162.04 2161.29,-17148.6 2125.63,-17136.41"/>
<polygon fill="black" stroke="black" points="2126.76,-17133.1 2116.17,-17133.17 2124.5,-17139.72 2126.76,-17133.1"/>
</g>
<!-- stage3_layer1_expert1_act -->
<g id="node651" class="node">
<title>stage3_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2118.19,-17027.78 1837.19,-17027.78 1837.19,-16975.78 2118.19,-16975.78 2118.19,-17027.78"/>
<text text-anchor="middle" x="1977.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="1977.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="1977.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1977.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert1_tp1&#45;&gt;stage3_layer1_expert1_act -->
<g id="edge852" class="edge">
<title>stage3_layer1_expert1_tp1&#45;&gt;stage3_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2006.69,-17063.79C2002.52,-17055.02 1998.06,-17045.64 1993.93,-17036.94"/>
<polygon fill="black" stroke="black" points="1997.05,-17035.35 1989.59,-17027.83 1990.73,-17038.36 1997.05,-17035.35"/>
</g>
<!-- stage3_layer1_expert1_mlp2 -->
<g id="node652" class="node">
<title>stage3_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2093.69,-16939.78 1771.69,-16939.78 1771.69,-16887.78 2093.69,-16887.78 2093.69,-16939.78"/>
<text text-anchor="middle" x="1932.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="1932.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1932.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1932.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert1_act&#45;&gt;stage3_layer1_expert1_mlp2 -->
<g id="edge853" class="edge">
<title>stage3_layer1_expert1_act&#45;&gt;stage3_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M1964.43,-16975.44C1960.08,-16967.13 1955.18,-16957.76 1950.54,-16948.91"/>
<polygon fill="black" stroke="black" points="1953.59,-16947.18 1945.85,-16939.94 1947.39,-16950.42 1953.59,-16947.18"/>
</g>
<!-- stage3_layer1_expert1_tp2 -->
<g id="node653" class="node">
<title>stage3_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1866.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1866.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1866.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 386&#45;387</text>
<text text-anchor="middle" x="1866.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1866.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert1_mlp2&#45;&gt;stage3_layer1_expert1_tp2 -->
<g id="edge854" class="edge">
<title>stage3_layer1_expert1_mlp2&#45;&gt;stage3_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M1915.52,-16887.61C1909.79,-16879.21 1903.22,-16869.58 1896.8,-16860.17"/>
<polygon fill="black" stroke="black" points="1899.5,-16857.91 1890.98,-16851.62 1893.72,-16861.86 1899.5,-16857.91"/>
</g>
<!-- stage3_layer1_expert1_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge905" class="edge">
<title>stage3_layer1_expert1_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2023.22,-16788.31C2049.69,-16784.53 2076.93,-16780.99 2102.69,-16778.24 2521.55,-16733.56 3002.24,-16706.32 3337.44,-16691.17"/>
<polygon fill="black" stroke="black" points="3337.98,-16694.65 3347.81,-16690.7 3337.67,-16687.66 3337.98,-16694.65"/>
</g>
<!-- stage3_layer1_expert2_mlp1 -->
<g id="node655" class="node">
<title>stage3_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2813.69,-17225.32 2499.69,-17225.32 2499.69,-17173.32 2813.69,-17173.32 2813.69,-17225.32"/>
<text text-anchor="middle" x="2656.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2656.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2656.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2656.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert2&#45;&gt;stage3_layer1_expert2_mlp1 -->
<g id="edge856" class="edge">
<title>stage3_layer1_expert2&#45;&gt;stage3_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2693.37,-17260.98C2688.29,-17252.59 2682.55,-17243.1 2677.15,-17234.17"/>
<polygon fill="black" stroke="black" points="2680.07,-17232.22 2671.9,-17225.48 2674.08,-17235.85 2680.07,-17232.22"/>
</g>
<!-- stage3_layer1_expert2_tp1 -->
<g id="node656" class="node">
<title>stage3_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2478.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2478.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2478.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="2478.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2478.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert2_mlp1&#45;&gt;stage3_layer1_expert2_tp1 -->
<g id="edge857" class="edge">
<title>stage3_layer1_expert2_mlp1&#45;&gt;stage3_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2610.39,-17173.15C2591.99,-17163.15 2570.41,-17151.41 2550.1,-17140.37"/>
<polygon fill="black" stroke="black" points="2551.63,-17137.23 2541.18,-17135.52 2548.29,-17143.38 2551.63,-17137.23"/>
</g>
<!-- stage3_layer1_expert2_act -->
<g id="node657" class="node">
<title>stage3_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2584.19,-17027.78 2303.19,-17027.78 2303.19,-16975.78 2584.19,-16975.78 2584.19,-17027.78"/>
<text text-anchor="middle" x="2443.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2443.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="2443.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2443.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert2_tp1&#45;&gt;stage3_layer1_expert2_act -->
<g id="edge858" class="edge">
<title>stage3_layer1_expert2_tp1&#45;&gt;stage3_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2465.76,-17063.79C2462.65,-17055.2 2459.33,-17046.04 2456.24,-17037.5"/>
<polygon fill="black" stroke="black" points="2459.44,-17036.04 2452.75,-17027.83 2452.86,-17038.42 2459.44,-17036.04"/>
</g>
<!-- stage3_layer1_expert2_mlp2 -->
<g id="node658" class="node">
<title>stage3_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2569.69,-16939.78 2247.69,-16939.78 2247.69,-16887.78 2569.69,-16887.78 2569.69,-16939.78"/>
<text text-anchor="middle" x="2408.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2408.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2408.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2408.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert2_act&#45;&gt;stage3_layer1_expert2_mlp2 -->
<g id="edge859" class="edge">
<title>stage3_layer1_expert2_act&#45;&gt;stage3_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2433.38,-16975.44C2430.07,-16967.31 2426.34,-16958.15 2422.8,-16949.47"/>
<polygon fill="black" stroke="black" points="2425.94,-16947.88 2418.93,-16939.94 2419.45,-16950.52 2425.94,-16947.88"/>
</g>
<!-- stage3_layer1_expert2_tp2 -->
<g id="node659" class="node">
<title>stage3_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2339.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2339.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2339.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 388&#45;389</text>
<text text-anchor="middle" x="2339.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2339.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert2_mlp2&#45;&gt;stage3_layer1_expert2_tp2 -->
<g id="edge860" class="edge">
<title>stage3_layer1_expert2_mlp2&#45;&gt;stage3_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2390.74,-16887.61C2384.69,-16879.12 2377.74,-16869.38 2370.97,-16859.88"/>
<polygon fill="black" stroke="black" points="2373.74,-16857.73 2365.08,-16851.62 2368.04,-16861.8 2373.74,-16857.73"/>
</g>
<!-- stage3_layer1_expert2_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge906" class="edge">
<title>stage3_layer1_expert2_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2498.18,-16788.58C2524.05,-16784.83 2550.59,-16781.24 2575.69,-16778.24 2835.52,-16747.27 3128.5,-16721.69 3357.9,-16703.77"/>
<polygon fill="black" stroke="black" points="3358.39,-16707.25 3368.09,-16702.98 3357.84,-16700.27 3358.39,-16707.25"/>
</g>
<!-- stage3_layer1_expert3_mlp1 -->
<g id="node661" class="node">
<title>stage3_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3158.69,-17225.32 2844.69,-17225.32 2844.69,-17173.32 3158.69,-17173.32 3158.69,-17225.32"/>
<text text-anchor="middle" x="3001.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3001.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3001.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3001.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert3&#45;&gt;stage3_layer1_expert3_mlp1 -->
<g id="edge862" class="edge">
<title>stage3_layer1_expert3&#45;&gt;stage3_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3046.83,-17260.98C3040.45,-17252.41 3033.23,-17242.7 3026.46,-17233.61"/>
<polygon fill="black" stroke="black" points="3029.19,-17231.41 3020.41,-17225.48 3023.57,-17235.59 3029.19,-17231.41"/>
</g>
<!-- stage3_layer1_expert3_tp1 -->
<g id="node662" class="node">
<title>stage3_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="2913.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2913.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="2913.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="2913.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2913.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert3_mlp1&#45;&gt;stage3_layer1_expert3_tp1 -->
<g id="edge863" class="edge">
<title>stage3_layer1_expert3_mlp1&#45;&gt;stage3_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M2978.8,-17173.15C2970.92,-17164.49 2961.86,-17154.53 2953.05,-17144.84"/>
<polygon fill="black" stroke="black" points="2955.39,-17142.21 2946.07,-17137.16 2950.21,-17146.92 2955.39,-17142.21"/>
</g>
<!-- stage3_layer1_expert3_act -->
<g id="node663" class="node">
<title>stage3_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="2996.19,-17027.78 2715.19,-17027.78 2715.19,-16975.78 2996.19,-16975.78 2996.19,-17027.78"/>
<text text-anchor="middle" x="2855.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2855.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="2855.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2855.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert3_tp1&#45;&gt;stage3_layer1_expert3_act -->
<g id="edge864" class="edge">
<title>stage3_layer1_expert3_tp1&#45;&gt;stage3_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2892.26,-17063.79C2886.94,-17054.92 2881.26,-17045.44 2876,-17036.66"/>
<polygon fill="black" stroke="black" points="2878.84,-17034.6 2870.7,-17027.83 2872.84,-17038.2 2878.84,-17034.6"/>
</g>
<!-- stage3_layer1_expert3_mlp2 -->
<g id="node664" class="node">
<title>stage3_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="2995.69,-16939.78 2673.69,-16939.78 2673.69,-16887.78 2995.69,-16887.78 2995.69,-16939.78"/>
<text text-anchor="middle" x="2834.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2834.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2834.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2834.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert3_act&#45;&gt;stage3_layer1_expert3_mlp2 -->
<g id="edge865" class="edge">
<title>stage3_layer1_expert3_act&#45;&gt;stage3_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2849.5,-16975.44C2847.54,-16967.4 2845.33,-16958.35 2843.23,-16949.75"/>
<polygon fill="black" stroke="black" points="2846.6,-16948.82 2840.83,-16939.94 2839.8,-16950.48 2846.6,-16948.82"/>
</g>
<!-- stage3_layer1_expert3_tp2 -->
<g id="node665" class="node">
<title>stage3_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2812.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2812.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2812.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 390&#45;391</text>
<text text-anchor="middle" x="2812.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2812.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert3_mlp2&#45;&gt;stage3_layer1_expert3_tp2 -->
<g id="edge866" class="edge">
<title>stage3_layer1_expert3_mlp2&#45;&gt;stage3_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2828.97,-16887.61C2827.17,-16879.72 2825.13,-16870.74 2823.12,-16861.88"/>
<polygon fill="black" stroke="black" points="2826.5,-16860.96 2820.87,-16851.99 2819.67,-16862.52 2826.5,-16860.96"/>
</g>
<!-- stage3_layer1_expert3_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge907" class="edge">
<title>stage3_layer1_expert3_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2975.17,-16789.25C2999.8,-16785.53 3024.91,-16781.77 3048.69,-16778.24 3161.56,-16761.5 3284.57,-16743.55 3396.01,-16727.4"/>
<polygon fill="black" stroke="black" points="3396.67,-16730.85 3406.06,-16725.95 3395.67,-16723.92 3396.67,-16730.85"/>
</g>
<!-- stage3_layer1_expert31_mlp1 -->
<g id="node667" class="node">
<title>stage3_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3500.69,-17225.32 3186.69,-17225.32 3186.69,-17173.32 3500.69,-17173.32 3500.69,-17225.32"/>
<text text-anchor="middle" x="3343.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3343.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3343.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3343.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert31&#45;&gt;stage3_layer1_expert31_mlp1 -->
<g id="edge868" class="edge">
<title>stage3_layer1_expert31&#45;&gt;stage3_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3393.77,-17260.98C3386.62,-17252.32 3378.51,-17242.51 3370.94,-17233.33"/>
<polygon fill="black" stroke="black" points="3373.52,-17230.96 3364.46,-17225.48 3368.12,-17235.42 3373.52,-17230.96"/>
</g>
<!-- stage3_layer1_expert31_tp1 -->
<g id="node668" class="node">
<title>stage3_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3338.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3338.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3338.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="3338.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3338.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert31_mlp1&#45;&gt;stage3_layer1_expert31_tp1 -->
<g id="edge869" class="edge">
<title>stage3_layer1_expert31_mlp1&#45;&gt;stage3_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3342.39,-17173.15C3341.98,-17165.34 3341.53,-17156.47 3341.07,-17147.71"/>
<polygon fill="black" stroke="black" points="3344.56,-17147.33 3340.55,-17137.53 3337.57,-17147.7 3344.56,-17147.33"/>
</g>
<!-- stage3_layer1_expert31_act -->
<g id="node669" class="node">
<title>stage3_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3465.19,-17027.78 3184.19,-17027.78 3184.19,-16975.78 3465.19,-16975.78 3465.19,-17027.78"/>
<text text-anchor="middle" x="3324.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3324.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="3324.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3324.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert31_tp1&#45;&gt;stage3_layer1_expert31_act -->
<g id="edge870" class="edge">
<title>stage3_layer1_expert31_tp1&#45;&gt;stage3_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3333.52,-17063.79C3332.29,-17055.3 3330.98,-17046.24 3329.75,-17037.78"/>
<polygon fill="black" stroke="black" points="3333.21,-17037.22 3328.31,-17027.83 3326.28,-17038.22 3333.21,-17037.22"/>
</g>
<!-- stage3_layer1_expert31_mlp2 -->
<g id="node670" class="node">
<title>stage3_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3472.69,-16939.78 3150.69,-16939.78 3150.69,-16887.78 3472.69,-16887.78 3472.69,-16939.78"/>
<text text-anchor="middle" x="3311.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3311.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3311.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3311.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert31_act&#45;&gt;stage3_layer1_expert31_mlp2 -->
<g id="edge871" class="edge">
<title>stage3_layer1_expert31_act&#45;&gt;stage3_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3320.86,-16975.44C3319.65,-16967.48 3318.3,-16958.55 3317.02,-16950.03"/>
<polygon fill="black" stroke="black" points="3320.45,-16949.3 3315.49,-16939.94 3313.53,-16950.35 3320.45,-16949.3"/>
</g>
<!-- stage3_layer1_expert31_tp2 -->
<g id="node671" class="node">
<title>stage3_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3285.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3285.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3285.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 446&#45;447</text>
<text text-anchor="middle" x="3285.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3285.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert31_mlp2&#45;&gt;stage3_layer1_expert31_tp2 -->
<g id="edge872" class="edge">
<title>stage3_layer1_expert31_mlp2&#45;&gt;stage3_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3304.93,-16887.61C3302.8,-16879.72 3300.39,-16870.74 3298.01,-16861.88"/>
<polygon fill="black" stroke="black" points="3301.33,-16860.74 3295.35,-16851.99 3294.57,-16862.56 3301.33,-16860.74"/>
</g>
<!-- stage3_layer1_expert31_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge908" class="edge">
<title>stage3_layer1_expert31_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3393.02,-16782.52C3431.11,-16771.35 3475.65,-16758.28 3520.28,-16745.19"/>
<polygon fill="black" stroke="black" points="3521.49,-16748.48 3530.1,-16742.31 3519.52,-16741.76 3521.49,-16748.48"/>
</g>
<!-- stage3_layer1_expert32_mlp1 -->
<g id="node673" class="node">
<title>stage3_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3915.69,-17225.32 3601.69,-17225.32 3601.69,-17173.32 3915.69,-17173.32 3915.69,-17225.32"/>
<text text-anchor="middle" x="3758.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3758.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3758.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert32&#45;&gt;stage3_layer1_expert32_mlp1 -->
<g id="edge874" class="edge">
<title>stage3_layer1_expert32&#45;&gt;stage3_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3758.69,-17260.98C3758.69,-17253.02 3758.69,-17244.08 3758.69,-17235.57"/>
<polygon fill="black" stroke="black" points="3762.19,-17235.48 3758.69,-17225.48 3755.19,-17235.48 3762.19,-17235.48"/>
</g>
<!-- stage3_layer1_expert32_tp1 -->
<g id="node674" class="node">
<title>stage3_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3758.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3758.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="3758.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3758.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert32_mlp1&#45;&gt;stage3_layer1_expert32_tp1 -->
<g id="edge875" class="edge">
<title>stage3_layer1_expert32_mlp1&#45;&gt;stage3_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3758.69,-17173.15C3758.69,-17165.34 3758.69,-17156.47 3758.69,-17147.71"/>
<polygon fill="black" stroke="black" points="3762.19,-17147.53 3758.69,-17137.53 3755.19,-17147.53 3762.19,-17147.53"/>
</g>
<!-- stage3_layer1_expert32_act -->
<g id="node675" class="node">
<title>stage3_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3899.19,-17027.78 3618.19,-17027.78 3618.19,-16975.78 3899.19,-16975.78 3899.19,-17027.78"/>
<text text-anchor="middle" x="3758.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3758.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="3758.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3758.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert32_tp1&#45;&gt;stage3_layer1_expert32_act -->
<g id="edge876" class="edge">
<title>stage3_layer1_expert32_tp1&#45;&gt;stage3_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3758.69,-17063.52C3758.69,-17055.21 3758.69,-17046.37 3758.69,-17038.09"/>
<polygon fill="black" stroke="black" points="3762.19,-17037.98 3758.69,-17027.98 3755.19,-17037.98 3762.19,-17037.98"/>
</g>
<!-- stage3_layer1_expert32_mlp2 -->
<g id="node676" class="node">
<title>stage3_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3919.69,-16939.78 3597.69,-16939.78 3597.69,-16887.78 3919.69,-16887.78 3919.69,-16939.78"/>
<text text-anchor="middle" x="3758.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3758.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3758.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3758.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert32_act&#45;&gt;stage3_layer1_expert32_mlp2 -->
<g id="edge877" class="edge">
<title>stage3_layer1_expert32_act&#45;&gt;stage3_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3758.69,-16975.44C3758.69,-16967.48 3758.69,-16958.55 3758.69,-16950.03"/>
<polygon fill="black" stroke="black" points="3762.19,-16949.94 3758.69,-16939.94 3755.19,-16949.94 3762.19,-16949.94"/>
</g>
<!-- stage3_layer1_expert32_tp2 -->
<g id="node677" class="node">
<title>stage3_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3758.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3758.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 448&#45;449</text>
<text text-anchor="middle" x="3758.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert32_mlp2&#45;&gt;stage3_layer1_expert32_tp2 -->
<g id="edge878" class="edge">
<title>stage3_layer1_expert32_mlp2&#45;&gt;stage3_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3758.69,-16887.61C3758.69,-16879.8 3758.69,-16870.94 3758.69,-16862.17"/>
<polygon fill="black" stroke="black" points="3762.19,-16861.99 3758.69,-16851.99 3755.19,-16861.99 3762.19,-16861.99"/>
</g>
<!-- stage3_layer1_expert32_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge909" class="edge">
<title>stage3_layer1_expert32_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3758.69,-16777.92C3758.69,-16769.98 3758.69,-16761.28 3758.69,-16752.41"/>
<polygon fill="black" stroke="black" points="3762.19,-16752.36 3758.69,-16742.36 3755.19,-16752.36 3762.19,-16752.36"/>
</g>
<!-- stage3_layer1_expert60_mlp1 -->
<g id="node679" class="node">
<title>stage3_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4321.69,-17225.32 4007.69,-17225.32 4007.69,-17173.32 4321.69,-17173.32 4321.69,-17225.32"/>
<text text-anchor="middle" x="4164.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4164.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4164.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4164.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert60&#45;&gt;stage3_layer1_expert60_mlp1 -->
<g id="edge880" class="edge">
<title>stage3_layer1_expert60&#45;&gt;stage3_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4149.17,-17260.98C4151.23,-17252.94 4153.54,-17243.89 4155.74,-17235.29"/>
<polygon fill="black" stroke="black" points="4159.17,-17236.03 4158.25,-17225.48 4152.38,-17234.3 4159.17,-17236.03"/>
</g>
<!-- stage3_layer1_expert60_tp1 -->
<g id="node680" class="node">
<title>stage3_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4187.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4187.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4187.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="4187.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4187.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert60_mlp1&#45;&gt;stage3_layer1_expert60_tp1 -->
<g id="edge881" class="edge">
<title>stage3_layer1_expert60_mlp1&#45;&gt;stage3_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4170.67,-17173.15C4172.55,-17165.26 4174.68,-17156.28 4176.79,-17147.42"/>
<polygon fill="black" stroke="black" points="4180.23,-17148.07 4179.14,-17137.53 4173.42,-17146.45 4180.23,-17148.07"/>
</g>
<!-- stage3_layer1_expert60_act -->
<g id="node681" class="node">
<title>stage3_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4335.19,-17027.78 4054.19,-17027.78 4054.19,-16975.78 4335.19,-16975.78 4335.19,-17027.78"/>
<text text-anchor="middle" x="4194.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4194.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="4194.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4194.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert60_tp1&#45;&gt;stage3_layer1_expert60_act -->
<g id="edge882" class="edge">
<title>stage3_layer1_expert60_tp1&#45;&gt;stage3_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4190.29,-17063.52C4190.9,-17055.21 4191.54,-17046.37 4192.13,-17038.09"/>
<polygon fill="black" stroke="black" points="4195.64,-17038.21 4192.87,-17027.98 4188.65,-17037.7 4195.64,-17038.21"/>
</g>
<!-- stage3_layer1_expert60_mlp2 -->
<g id="node682" class="node">
<title>stage3_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4384.69,-16939.78 4062.69,-16939.78 4062.69,-16887.78 4384.69,-16887.78 4384.69,-16939.78"/>
<text text-anchor="middle" x="4223.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4223.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4223.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4223.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert60_act&#45;&gt;stage3_layer1_expert60_mlp2 -->
<g id="edge883" class="edge">
<title>stage3_layer1_expert60_act&#45;&gt;stage3_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4203.23,-16975.44C4205.98,-16967.31 4209.06,-16958.15 4211.99,-16949.47"/>
<polygon fill="black" stroke="black" points="4215.33,-16950.53 4215.21,-16939.94 4208.69,-16948.3 4215.33,-16950.53"/>
</g>
<!-- stage3_layer1_expert60_tp2 -->
<g id="node683" class="node">
<title>stage3_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4231.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4231.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4231.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 504&#45;505</text>
<text text-anchor="middle" x="4231.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4231.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert60_mlp2&#45;&gt;stage3_layer1_expert60_tp2 -->
<g id="edge884" class="edge">
<title>stage3_layer1_expert60_mlp2&#45;&gt;stage3_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4225.77,-16887.61C4226.41,-16879.8 4227.15,-16870.94 4227.87,-16862.17"/>
<polygon fill="black" stroke="black" points="4231.38,-16862.24 4228.71,-16851.99 4224.4,-16861.67 4231.38,-16862.24"/>
</g>
<!-- stage3_layer1_expert60_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge910" class="edge">
<title>stage3_layer1_expert60_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4124.36,-16782.52C4086.27,-16771.35 4041.73,-16758.28 3997.1,-16745.19"/>
<polygon fill="black" stroke="black" points="3997.86,-16741.76 3987.28,-16742.31 3995.89,-16748.48 3997.86,-16741.76"/>
</g>
<!-- stage3_layer1_expert61_mlp1 -->
<g id="node685" class="node">
<title>stage3_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4734.69,-17225.32 4420.69,-17225.32 4420.69,-17173.32 4734.69,-17173.32 4734.69,-17225.32"/>
<text text-anchor="middle" x="4577.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4577.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4577.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4577.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert61&#45;&gt;stage3_layer1_expert61_mlp1 -->
<g id="edge886" class="edge">
<title>stage3_layer1_expert61&#45;&gt;stage3_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4555.12,-17260.98C4558.14,-17252.85 4561.55,-17243.69 4564.78,-17235.01"/>
<polygon fill="black" stroke="black" points="4568.12,-17236.07 4568.33,-17225.48 4561.56,-17233.63 4568.12,-17236.07"/>
</g>
<!-- stage3_layer1_expert61_tp1 -->
<g id="node686" class="node">
<title>stage3_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4609.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4609.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4609.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="4609.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4609.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert61_mlp1&#45;&gt;stage3_layer1_expert61_tp1 -->
<g id="edge887" class="edge">
<title>stage3_layer1_expert61_mlp1&#45;&gt;stage3_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4586.01,-17173.15C4588.65,-17165.17 4591.65,-17156.09 4594.61,-17147.14"/>
<polygon fill="black" stroke="black" points="4597.97,-17148.12 4597.79,-17137.53 4591.33,-17145.92 4597.97,-17148.12"/>
</g>
<!-- stage3_layer1_expert61_act -->
<g id="node687" class="node">
<title>stage3_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4758.19,-17027.78 4477.19,-17027.78 4477.19,-16975.78 4758.19,-16975.78 4758.19,-17027.78"/>
<text text-anchor="middle" x="4617.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4617.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="4617.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4617.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert61_tp1&#45;&gt;stage3_layer1_expert61_act -->
<g id="edge888" class="edge">
<title>stage3_layer1_expert61_tp1&#45;&gt;stage3_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4612.67,-17063.52C4613.35,-17055.21 4614.08,-17046.37 4614.77,-17038.09"/>
<polygon fill="black" stroke="black" points="4618.27,-17038.23 4615.61,-17027.98 4611.29,-17037.66 4618.27,-17038.23"/>
</g>
<!-- stage3_layer1_expert61_mlp2 -->
<g id="node688" class="node">
<title>stage3_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4807.69,-16939.78 4485.69,-16939.78 4485.69,-16887.78 4807.69,-16887.78 4807.69,-16939.78"/>
<text text-anchor="middle" x="4646.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4646.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4646.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4646.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert61_act&#45;&gt;stage3_layer1_expert61_mlp2 -->
<g id="edge889" class="edge">
<title>stage3_layer1_expert61_act&#45;&gt;stage3_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4626.23,-16975.44C4628.98,-16967.31 4632.06,-16958.15 4634.99,-16949.47"/>
<polygon fill="black" stroke="black" points="4638.33,-16950.53 4638.21,-16939.94 4631.69,-16948.3 4638.33,-16950.53"/>
</g>
<!-- stage3_layer1_expert61_tp2 -->
<g id="node689" class="node">
<title>stage3_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4704.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4704.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4704.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 506&#45;507</text>
<text text-anchor="middle" x="4704.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4704.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert61_mlp2&#45;&gt;stage3_layer1_expert61_tp2 -->
<g id="edge890" class="edge">
<title>stage3_layer1_expert61_mlp2&#45;&gt;stage3_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4661.78,-16887.61C4666.76,-16879.29 4672.47,-16869.77 4678.05,-16860.45"/>
<polygon fill="black" stroke="black" points="4681.21,-16862 4683.34,-16851.62 4675.2,-16858.4 4681.21,-16862"/>
</g>
<!-- stage3_layer1_expert61_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge911" class="edge">
<title>stage3_layer1_expert61_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4542.21,-16789.25C4517.58,-16785.53 4492.46,-16781.77 4468.69,-16778.24 4392.78,-16766.98 4312.27,-16755.18 4233.79,-16743.74"/>
<polygon fill="black" stroke="black" points="4234.13,-16740.25 4223.73,-16742.28 4233.13,-16747.18 4234.13,-16740.25"/>
</g>
<!-- stage3_layer1_expert62_mlp1 -->
<g id="node691" class="node">
<title>stage3_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5150.69,-17225.32 4836.69,-17225.32 4836.69,-17173.32 5150.69,-17173.32 5150.69,-17225.32"/>
<text text-anchor="middle" x="4993.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="4993.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4993.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4993.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert62&#45;&gt;stage3_layer1_expert62_mlp1 -->
<g id="edge892" class="edge">
<title>stage3_layer1_expert62&#45;&gt;stage3_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M4959.12,-17260.98C4963.86,-17252.67 4969.2,-17243.3 4974.25,-17234.45"/>
<polygon fill="black" stroke="black" points="4977.45,-17235.9 4979.35,-17225.48 4971.36,-17232.43 4977.45,-17235.9"/>
</g>
<!-- stage3_layer1_expert62_tp1 -->
<g id="node692" class="node">
<title>stage3_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5036.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5036.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5036.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="5036.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5036.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert62_mlp1&#45;&gt;stage3_layer1_expert62_tp1 -->
<g id="edge893" class="edge">
<title>stage3_layer1_expert62_mlp1&#45;&gt;stage3_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5004.87,-17173.15C5008.46,-17165.09 5012.54,-17155.9 5016.56,-17146.85"/>
<polygon fill="black" stroke="black" points="5019.84,-17148.09 5020.7,-17137.53 5013.44,-17145.25 5019.84,-17148.09"/>
</g>
<!-- stage3_layer1_expert62_act -->
<g id="node693" class="node">
<title>stage3_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5264.19,-17027.78 4983.19,-17027.78 4983.19,-16975.78 5264.19,-16975.78 5264.19,-17027.78"/>
<text text-anchor="middle" x="5123.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5123.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="5123.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5123.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert62_tp1&#45;&gt;stage3_layer1_expert62_act -->
<g id="edge894" class="edge">
<title>stage3_layer1_expert62_tp1&#45;&gt;stage3_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5068.59,-17064.07C5077,-17054.71 5086.04,-17044.66 5094.31,-17035.46"/>
<polygon fill="black" stroke="black" points="5096.96,-17037.75 5101.04,-17027.97 5091.76,-17033.07 5096.96,-17037.75"/>
</g>
<!-- stage3_layer1_expert62_mlp2 -->
<g id="node694" class="node">
<title>stage3_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5327.69,-16939.78 5005.69,-16939.78 5005.69,-16887.78 5327.69,-16887.78 5327.69,-16939.78"/>
<text text-anchor="middle" x="5166.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5166.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5166.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5166.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert62_act&#45;&gt;stage3_layer1_expert62_mlp2 -->
<g id="edge895" class="edge">
<title>stage3_layer1_expert62_act&#45;&gt;stage3_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5136.36,-16975.44C5140.51,-16967.13 5145.2,-16957.76 5149.63,-16948.91"/>
<polygon fill="black" stroke="black" points="5152.77,-16950.45 5154.11,-16939.94 5146.51,-16947.32 5152.77,-16950.45"/>
</g>
<!-- stage3_layer1_expert62_tp2 -->
<g id="node695" class="node">
<title>stage3_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5177.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5177.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5177.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 508&#45;509</text>
<text text-anchor="middle" x="5177.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5177.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert62_mlp2&#45;&gt;stage3_layer1_expert62_tp2 -->
<g id="edge896" class="edge">
<title>stage3_layer1_expert62_mlp2&#45;&gt;stage3_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5169.55,-16887.61C5170.44,-16879.8 5171.45,-16870.94 5172.44,-16862.17"/>
<polygon fill="black" stroke="black" points="5175.95,-16862.32 5173.6,-16851.99 5168.99,-16861.53 5175.95,-16862.32"/>
</g>
<!-- stage3_layer1_expert62_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge912" class="edge">
<title>stage3_layer1_expert62_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5019.19,-16788.58C4993.33,-16784.83 4966.79,-16781.24 4941.69,-16778.24 4721.65,-16752.02 4477.82,-16729.65 4268.99,-16712.54"/>
<polygon fill="black" stroke="black" points="4269,-16709.03 4258.75,-16711.7 4268.43,-16716 4269,-16709.03"/>
</g>
<!-- stage3_layer1_expert63_mlp1 -->
<g id="node697" class="node">
<title>stage3_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5486.69,-17225.32 5172.69,-17225.32 5172.69,-17173.32 5486.69,-17173.32 5486.69,-17225.32"/>
<text text-anchor="middle" x="5329.69" y="-17213.32" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5329.69" y="-17202.32" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5329.69" y="-17191.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5329.69" y="-17180.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage3_layer1_expert63&#45;&gt;stage3_layer1_expert63_mlp1 -->
<g id="edge898" class="edge">
<title>stage3_layer1_expert63&#45;&gt;stage3_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5319.11,-17260.98C5320.5,-17253.02 5322.06,-17244.08 5323.54,-17235.57"/>
<polygon fill="black" stroke="black" points="5327.03,-17235.93 5325.3,-17225.48 5320.13,-17234.73 5327.03,-17235.93"/>
</g>
<!-- stage3_layer1_expert63_tp1 -->
<g id="node698" class="node">
<title>stage3_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5478.69" cy="-17100.55" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5478.69" y="-17114.55" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5478.69" y="-17103.55" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="5478.69" y="-17092.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5478.69" y="-17081.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert63_mlp1&#45;&gt;stage3_layer1_expert63_tp1 -->
<g id="edge899" class="edge">
<title>stage3_layer1_expert63_mlp1&#45;&gt;stage3_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5368.45,-17173.15C5383.28,-17163.52 5400.59,-17152.27 5417.04,-17141.59"/>
<polygon fill="black" stroke="black" points="5419.06,-17144.45 5425.54,-17136.07 5415.25,-17138.58 5419.06,-17144.45"/>
</g>
<!-- stage3_layer1_expert63_act -->
<g id="node699" class="node">
<title>stage3_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5645.19,-17027.78 5364.19,-17027.78 5364.19,-16975.78 5645.19,-16975.78 5645.19,-17027.78"/>
<text text-anchor="middle" x="5504.69" y="-17015.78" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5504.69" y="-17004.78" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="5504.69" y="-16993.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5504.69" y="-16982.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage3_layer1_expert63_tp1&#45;&gt;stage3_layer1_expert63_act -->
<g id="edge900" class="edge">
<title>stage3_layer1_expert63_tp1&#45;&gt;stage3_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5488.3,-17063.79C5490.6,-17055.2 5493.07,-17046.04 5495.36,-17037.5"/>
<polygon fill="black" stroke="black" points="5498.74,-17038.39 5497.96,-17027.83 5491.98,-17036.58 5498.74,-17038.39"/>
</g>
<!-- stage3_layer1_expert63_mlp2 -->
<g id="node700" class="node">
<title>stage3_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5759.69,-16939.78 5437.69,-16939.78 5437.69,-16887.78 5759.69,-16887.78 5759.69,-16939.78"/>
<text text-anchor="middle" x="5598.69" y="-16927.78" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5598.69" y="-16916.78" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5598.69" y="-16905.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5598.69" y="-16894.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert63_act&#45;&gt;stage3_layer1_expert63_mlp2 -->
<g id="edge901" class="edge">
<title>stage3_layer1_expert63_act&#45;&gt;stage3_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5532.13,-16975.68C5541.98,-16966.66 5553.24,-16956.37 5563.65,-16946.84"/>
<polygon fill="black" stroke="black" points="5566.03,-16949.4 5571.05,-16940.07 5561.31,-16944.24 5566.03,-16949.4"/>
</g>
<!-- stage3_layer1_expert63_tp2 -->
<g id="node701" class="node">
<title>stage3_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5650.69" cy="-16815.01" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5650.69" y="-16829.01" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5650.69" y="-16818.01" font-family="Times,serif" font-size="10.00">GPU: 510&#45;511</text>
<text text-anchor="middle" x="5650.69" y="-16807.01" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5650.69" y="-16796.01" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert63_mlp2&#45;&gt;stage3_layer1_expert63_tp2 -->
<g id="edge902" class="edge">
<title>stage3_layer1_expert63_mlp2&#45;&gt;stage3_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5612.22,-16887.61C5616.59,-16879.46 5621.59,-16870.16 5626.5,-16861.02"/>
<polygon fill="black" stroke="black" points="5629.71,-16862.45 5631.36,-16851.99 5623.54,-16859.14 5629.71,-16862.45"/>
</g>
<!-- stage3_layer1_expert63_tp2&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge913" class="edge">
<title>stage3_layer1_expert63_tp2&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5494.16,-16788.31C5467.69,-16784.53 5440.44,-16780.99 5414.69,-16778.24 5019.75,-16736.11 4569.84,-16709.49 4238.75,-16693.88"/>
<polygon fill="black" stroke="black" points="4238.65,-16690.38 4228.49,-16693.4 4238.32,-16697.37 4238.65,-16690.38"/>
</g>
<!-- stage3_layer1_expert_ellipsis&#45;&gt;stage3_layer1_expert_agg -->
<g id="edge914" class="edge">
<title>stage3_layer1_expert_ellipsis&#45;&gt;stage3_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5894.87,-17173.06C5899.27,-17135.84 5906.69,-17064.07 5906.69,-17002.78 5906.69,-17002.78 5906.69,-17002.78 5906.69,-16912.78 5906.69,-16852.39 5932.31,-16818.94 5887.69,-16778.24 5827.07,-16722.96 4828.4,-16694.84 4220.67,-16682.78"/>
<polygon fill="black" stroke="black" points="4220.48,-16679.27 4210.41,-16682.57 4220.34,-16686.27 4220.48,-16679.27"/>
</g>
<!-- stage3_layer1_output -->
<g id="node704" class="node">
<title>stage3_layer1_output</title>
<polygon fill="none" stroke="black" points="3983.69,-16570.24 3533.69,-16570.24 3533.69,-16502.24 3983.69,-16502.24 3983.69,-16570.24"/>
<text text-anchor="middle" x="3758.69" y="-16555.04" font-family="Times,serif" font-size="14.00">Layer 7 Output</text>
<text text-anchor="middle" x="3758.69" y="-16540.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-16525.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16510.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_expert_agg&#45;&gt;stage3_layer1_output -->
<g id="edge915" class="edge">
<title>stage3_layer1_expert_agg&#45;&gt;stage3_layer1_output</title>
<path fill="none" stroke="black" d="M3758.69,-16606.04C3758.69,-16597.29 3758.69,-16588.52 3758.69,-16580.31"/>
<polygon fill="black" stroke="black" points="3762.19,-16580.26 3758.69,-16570.26 3755.19,-16580.26 3762.19,-16580.26"/>
</g>
<!-- stage3_output -->
<g id="node705" class="node">
<title>stage3_output</title>
<polygon fill="none" stroke="black" points="4225.27,-16466.24 3483.05,-16466.24 3292.11,-16330.24 4034.33,-16330.24 4225.27,-16466.24"/>
<text text-anchor="middle" x="3758.69" y="-16417.04" font-family="Times,serif" font-size="14.00">Stage 3 Output</text>
<text text-anchor="middle" x="3758.69" y="-16402.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 3</text>
<text text-anchor="middle" x="3758.69" y="-16387.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16372.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_layer1_output&#45;&gt;stage3_output -->
<g id="edge916" class="edge">
<title>stage3_layer1_output&#45;&gt;stage3_output</title>
<path fill="none" stroke="black" d="M3758.69,-16501.97C3758.69,-16494.15 3758.69,-16485.48 3758.69,-16476.6"/>
<polygon fill="black" stroke="black" points="3762.19,-16476.51 3758.69,-16466.51 3755.19,-16476.51 3762.19,-16476.51"/>
</g>
<!-- stage4_input -->
<g id="node706" class="node">
<title>stage4_input</title>
<polygon fill="none" stroke="black" points="4225.27,-16294.24 3483.05,-16294.24 3292.11,-16158.24 4034.33,-16158.24 4225.27,-16294.24"/>
<text text-anchor="middle" x="3758.69" y="-16245.04" font-family="Times,serif" font-size="14.00">Stage 4 Input Router</text>
<text text-anchor="middle" x="3758.69" y="-16230.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3758.69" y="-16215.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16200.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage3_output&#45;&gt;stage4_input -->
<g id="edge917" class="edge">
<title>stage3_output&#45;&gt;stage4_input</title>
<path fill="none" stroke="black" d="M3758.69,-16330.05C3758.69,-16321.74 3758.69,-16313.19 3758.69,-16304.74"/>
<polygon fill="black" stroke="black" points="3762.19,-16304.5 3758.69,-16294.5 3755.19,-16304.5 3762.19,-16304.5"/>
</g>
<!-- stage4_layer0_ln -->
<g id="node707" class="node">
<title>stage4_layer0_ln</title>
<polygon fill="none" stroke="black" points="3983.69,-16122.24 3533.69,-16122.24 3533.69,-16054.24 3983.69,-16054.24 3983.69,-16122.24"/>
<text text-anchor="middle" x="3758.69" y="-16107.04" font-family="Times,serif" font-size="14.00">Layer 8 LayerNorm</text>
<text text-anchor="middle" x="3758.69" y="-16092.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3758.69" y="-16077.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-16062.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_input&#45;&gt;stage4_layer0_ln -->
<g id="edge918" class="edge">
<title>stage4_input&#45;&gt;stage4_layer0_ln</title>
<path fill="none" stroke="black" d="M3758.69,-16158.04C3758.69,-16149.29 3758.69,-16140.52 3758.69,-16132.31"/>
<polygon fill="black" stroke="black" points="3762.19,-16132.26 3758.69,-16122.26 3755.19,-16132.26 3762.19,-16132.26"/>
</g>
<!-- stage4_layer0_attn_qkv -->
<g id="node708" class="node">
<title>stage4_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="3990.19,-16018.24 3527.19,-16018.24 3527.19,-15950.24 3990.19,-15950.24 3990.19,-16018.24"/>
<text text-anchor="middle" x="3758.69" y="-16003.04" font-family="Times,serif" font-size="14.00">Layer 8 Attention QKV Projection</text>
<text text-anchor="middle" x="3758.69" y="-15988.04" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP: GPU 512&#45;639)</text>
<text text-anchor="middle" x="3758.69" y="-15973.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-15958.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage4_layer0_ln&#45;&gt;stage4_layer0_attn_qkv -->
<g id="edge919" class="edge">
<title>stage4_layer0_ln&#45;&gt;stage4_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3758.69,-16054.13C3758.69,-16046.02 3758.69,-16037.23 3758.69,-16028.72"/>
<polygon fill="black" stroke="black" points="3762.19,-16028.54 3758.69,-16018.54 3755.19,-16028.54 3762.19,-16028.54"/>
</g>
<!-- stage4_layer0_tp_qkv_comm -->
<g id="node709" class="node">
<title>stage4_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-15866.16" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3758.69" y="-15884.96" font-family="Times,serif" font-size="14.00">Layer 8 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3758.69" y="-15869.96" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP pairs)</text>
<text text-anchor="middle" x="3758.69" y="-15854.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-15839.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage4_layer0_attn_qkv&#45;&gt;stage4_layer0_tp_qkv_comm -->
<g id="edge920" class="edge">
<title>stage4_layer0_attn_qkv&#45;&gt;stage4_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3758.69,-15949.98C3758.69,-15941.98 3758.69,-15933.22 3758.69,-15924.48"/>
<polygon fill="black" stroke="black" points="3762.19,-15924.27 3758.69,-15914.27 3755.19,-15924.27 3762.19,-15924.27"/>
</g>
<!-- stage4_layer0_attn_head0 -->
<g id="node710" class="node">
<title>stage4_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1567.19,-15782.08 1294.19,-15782.08 1294.19,-15730.08 1567.19,-15730.08 1567.19,-15782.08"/>
<text text-anchor="middle" x="1430.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 0 Attention</text>
<text text-anchor="middle" x="1430.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 0)</text>
<text text-anchor="middle" x="1430.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1430.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head0 -->
<g id="edge921" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3435.67,-15858.13C2923.05,-15846.1 1944.56,-15819.3 1577.38,-15782.18"/>
<polygon fill="black" stroke="black" points="1577.54,-15778.68 1567.23,-15781.14 1576.82,-15785.64 1577.54,-15778.68"/>
</g>
<!-- stage4_layer0_attn_head1 -->
<g id="node711" class="node">
<title>stage4_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="1858.19,-15782.08 1585.19,-15782.08 1585.19,-15730.08 1858.19,-15730.08 1858.19,-15782.08"/>
<text text-anchor="middle" x="1721.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 1 Attention</text>
<text text-anchor="middle" x="1721.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 1)</text>
<text text-anchor="middle" x="1721.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1721.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head1 -->
<g id="edge922" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3431.73,-15863.37C3056.12,-15858.42 2421.43,-15841.21 1868.41,-15782.21"/>
<polygon fill="black" stroke="black" points="1868.55,-15778.7 1858.23,-15781.12 1867.8,-15785.66 1868.55,-15778.7"/>
</g>
<!-- stage4_layer0_attn_head2 -->
<g id="node712" class="node">
<title>stage4_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2149.19,-15782.08 1876.19,-15782.08 1876.19,-15730.08 2149.19,-15730.08 2149.19,-15782.08"/>
<text text-anchor="middle" x="2012.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 2 Attention</text>
<text text-anchor="middle" x="2012.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 2)</text>
<text text-anchor="middle" x="2012.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2012.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head2 -->
<g id="edge923" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3434.26,-15859.62C3112.63,-15851.5 2605.92,-15831.61 2159.44,-15782.22"/>
<polygon fill="black" stroke="black" points="2159.56,-15778.71 2149.24,-15781.08 2158.79,-15785.67 2159.56,-15778.71"/>
</g>
<!-- stage4_layer0_attn_head3 -->
<g id="node713" class="node">
<title>stage4_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2440.19,-15782.08 2167.19,-15782.08 2167.19,-15730.08 2440.19,-15730.08 2440.19,-15782.08"/>
<text text-anchor="middle" x="2303.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 3 Attention</text>
<text text-anchor="middle" x="2303.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 3)</text>
<text text-anchor="middle" x="2303.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2303.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head3 -->
<g id="edge924" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3440.84,-15854.56C3177.62,-15843.51 2793.78,-15822.18 2450.39,-15782.23"/>
<polygon fill="black" stroke="black" points="2450.58,-15778.73 2440.24,-15781.04 2449.77,-15785.68 2450.58,-15778.73"/>
</g>
<!-- stage4_layer0_attn_head4 -->
<g id="node714" class="node">
<title>stage4_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2731.19,-15782.08 2458.19,-15782.08 2458.19,-15730.08 2731.19,-15730.08 2731.19,-15782.08"/>
<text text-anchor="middle" x="2594.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 4 Attention</text>
<text text-anchor="middle" x="2594.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 4)</text>
<text text-anchor="middle" x="2594.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2594.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head4 -->
<g id="edge925" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3456.43,-15847.62C3256.07,-15834.28 2987.29,-15813.1 2741.46,-15782.26"/>
<polygon fill="black" stroke="black" points="2741.61,-15778.75 2731.25,-15780.97 2740.73,-15785.7 2741.61,-15778.75"/>
</g>
<!-- stage4_layer0_attn_head5 -->
<g id="node715" class="node">
<title>stage4_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3022.19,-15782.08 2749.19,-15782.08 2749.19,-15730.08 3022.19,-15730.08 3022.19,-15782.08"/>
<text text-anchor="middle" x="2885.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 5 Attention</text>
<text text-anchor="middle" x="2885.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 5)</text>
<text text-anchor="middle" x="2885.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2885.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head5 -->
<g id="edge926" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3491.12,-15838.32C3356.28,-15823.88 3190.06,-15804.69 3032.62,-15782.33"/>
<polygon fill="black" stroke="black" points="3032.66,-15778.8 3022.27,-15780.85 3031.67,-15785.73 3032.66,-15778.8"/>
</g>
<!-- stage4_layer0_attn_head6 -->
<g id="node716" class="node">
<title>stage4_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3313.19,-15782.08 3040.19,-15782.08 3040.19,-15730.08 3313.19,-15730.08 3313.19,-15782.08"/>
<text text-anchor="middle" x="3176.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 6 Attention</text>
<text text-anchor="middle" x="3176.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 6)</text>
<text text-anchor="middle" x="3176.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3176.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head6 -->
<g id="edge927" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3558.8,-15828.04C3480.89,-15813.57 3393.29,-15797.3 3321.64,-15784"/>
<polygon fill="black" stroke="black" points="3322.1,-15780.52 3311.63,-15782.14 3320.83,-15787.4 3322.1,-15780.52"/>
</g>
<!-- stage4_layer0_attn_head7 -->
<g id="node717" class="node">
<title>stage4_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3604.19,-15782.08 3331.19,-15782.08 3331.19,-15730.08 3604.19,-15730.08 3604.19,-15782.08"/>
<text text-anchor="middle" x="3467.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 7 Attention</text>
<text text-anchor="middle" x="3467.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 7)</text>
<text text-anchor="middle" x="3467.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3467.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head7 -->
<g id="edge928" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3640.33,-15821.2C3608.09,-15809.23 3574.02,-15796.57 3544.74,-15785.69"/>
<polygon fill="black" stroke="black" points="3545.59,-15782.28 3535,-15782.08 3543.15,-15788.84 3545.59,-15782.28"/>
</g>
<!-- stage4_layer0_attn_ellipsis -->
<g id="node718" class="node">
<title>stage4_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3895.19,-15782.08 3622.19,-15782.08 3622.19,-15730.08 3895.19,-15730.08 3895.19,-15782.08"/>
<text text-anchor="middle" x="3758.69" y="-15770.08" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3758.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3758.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_ellipsis -->
<g id="edge929" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3758.69,-15818.07C3758.69,-15809.52 3758.69,-15800.74 3758.69,-15792.6"/>
<polygon fill="black" stroke="black" points="3762.19,-15792.34 3758.69,-15782.34 3755.19,-15792.34 3762.19,-15792.34"/>
</g>
<!-- stage4_layer0_attn_head24 -->
<g id="node719" class="node">
<title>stage4_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4186.19,-15782.08 3913.19,-15782.08 3913.19,-15730.08 4186.19,-15730.08 4186.19,-15782.08"/>
<text text-anchor="middle" x="4049.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 24 Attention</text>
<text text-anchor="middle" x="4049.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 24)</text>
<text text-anchor="middle" x="4049.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4049.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head24 -->
<g id="edge930" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M3877.05,-15821.2C3909.28,-15809.23 3943.36,-15796.57 3972.64,-15785.69"/>
<polygon fill="black" stroke="black" points="3974.22,-15788.84 3982.38,-15782.08 3971.79,-15782.28 3974.22,-15788.84"/>
</g>
<!-- stage4_layer0_attn_head25 -->
<g id="node720" class="node">
<title>stage4_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4477.19,-15782.08 4204.19,-15782.08 4204.19,-15730.08 4477.19,-15730.08 4477.19,-15782.08"/>
<text text-anchor="middle" x="4340.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 25 Attention</text>
<text text-anchor="middle" x="4340.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 25)</text>
<text text-anchor="middle" x="4340.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4340.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head25 -->
<g id="edge931" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M3958.57,-15828.04C4036.48,-15813.57 4124.09,-15797.3 4195.74,-15784"/>
<polygon fill="black" stroke="black" points="4196.55,-15787.4 4205.74,-15782.14 4195.27,-15780.52 4196.55,-15787.4"/>
</g>
<!-- stage4_layer0_attn_head26 -->
<g id="node721" class="node">
<title>stage4_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4768.19,-15782.08 4495.19,-15782.08 4495.19,-15730.08 4768.19,-15730.08 4768.19,-15782.08"/>
<text text-anchor="middle" x="4631.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 26 Attention</text>
<text text-anchor="middle" x="4631.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 26)</text>
<text text-anchor="middle" x="4631.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4631.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head26 -->
<g id="edge932" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4025.45,-15838.28C4160.31,-15823.79 4326.69,-15804.57 4485.01,-15782.14"/>
<polygon fill="black" stroke="black" points="4485.54,-15785.6 4494.95,-15780.73 4484.55,-15778.67 4485.54,-15785.6"/>
</g>
<!-- stage4_layer0_attn_head27 -->
<g id="node722" class="node">
<title>stage4_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5059.19,-15782.08 4786.19,-15782.08 4786.19,-15730.08 5059.19,-15730.08 5059.19,-15782.08"/>
<text text-anchor="middle" x="4922.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 27 Attention</text>
<text text-anchor="middle" x="4922.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 27)</text>
<text text-anchor="middle" x="4922.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4922.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head27 -->
<g id="edge933" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4060.64,-15847.52C4260.8,-15834.13 4529.31,-15812.94 4775.73,-15782.15"/>
<polygon fill="black" stroke="black" points="4776.48,-15785.58 4785.96,-15780.86 4775.61,-15778.64 4776.48,-15785.58"/>
</g>
<!-- stage4_layer0_attn_head28 -->
<g id="node723" class="node">
<title>stage4_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5350.19,-15782.08 5077.19,-15782.08 5077.19,-15730.08 5350.19,-15730.08 5350.19,-15782.08"/>
<text text-anchor="middle" x="5213.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 28 Attention</text>
<text text-anchor="middle" x="5213.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 28)</text>
<text text-anchor="middle" x="5213.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5213.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head28 -->
<g id="edge934" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4076.28,-15854.45C4339.3,-15843.33 4722.83,-15821.97 5066.81,-15782.12"/>
<polygon fill="black" stroke="black" points="5067.45,-15785.57 5076.97,-15780.94 5066.64,-15778.62 5067.45,-15785.57"/>
</g>
<!-- stage4_layer0_attn_head29 -->
<g id="node724" class="node">
<title>stage4_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5641.19,-15782.08 5368.19,-15782.08 5368.19,-15730.08 5641.19,-15730.08 5641.19,-15782.08"/>
<text text-anchor="middle" x="5504.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 29 Attention</text>
<text text-anchor="middle" x="5504.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 29)</text>
<text text-anchor="middle" x="5504.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5504.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head29 -->
<g id="edge935" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4083.28,-15859.49C4404.72,-15851.27 4910.89,-15831.31 5357.77,-15782.12"/>
<polygon fill="black" stroke="black" points="5358.43,-15785.57 5367.98,-15780.99 5357.66,-15778.61 5358.43,-15785.57"/>
</g>
<!-- stage4_layer0_attn_head30 -->
<g id="node725" class="node">
<title>stage4_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="5932.19,-15782.08 5659.19,-15782.08 5659.19,-15730.08 5932.19,-15730.08 5932.19,-15782.08"/>
<text text-anchor="middle" x="5795.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 30 Attention</text>
<text text-anchor="middle" x="5795.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 30)</text>
<text text-anchor="middle" x="5795.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5795.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head30 -->
<g id="edge936" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4085.89,-15863.24C4461.34,-15858.17 5095.41,-15840.85 5648.8,-15782.11"/>
<polygon fill="black" stroke="black" points="5649.41,-15785.56 5658.98,-15781.02 5648.67,-15778.6 5649.41,-15785.56"/>
</g>
<!-- stage4_layer0_attn_head31 -->
<g id="node726" class="node">
<title>stage4_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6223.19,-15782.08 5950.19,-15782.08 5950.19,-15730.08 6223.19,-15730.08 6223.19,-15782.08"/>
<text text-anchor="middle" x="6086.69" y="-15770.08" font-family="Times,serif" font-size="10.00">Layer 8 Head 31 Attention</text>
<text text-anchor="middle" x="6086.69" y="-15759.08" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 31)</text>
<text text-anchor="middle" x="6086.69" y="-15748.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6086.69" y="-15737.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head31 -->
<g id="edge937" class="edge">
<title>stage4_layer0_tp_qkv_comm&#45;&gt;stage4_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4081.55,-15858.09C4593.93,-15845.99 5571.97,-15819.09 5939.81,-15782.09"/>
<polygon fill="black" stroke="black" points="5940.39,-15785.55 5949.99,-15781.05 5939.68,-15778.58 5940.39,-15785.55"/>
</g>
<!-- stage4_layer0_attn_agg -->
<g id="node727" class="node">
<title>stage4_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4226.34,-15694.08 3482.41,-15694.08 3291.04,-15558.08 4034.97,-15558.08 4226.34,-15694.08"/>
<text text-anchor="middle" x="3758.69" y="-15644.88" font-family="Times,serif" font-size="14.00">Layer 8 Attention Aggregate</text>
<text text-anchor="middle" x="3758.69" y="-15629.88" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3758.69" y="-15614.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3758.69" y="-15599.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_attn_head0&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge938" class="edge">
<title>stage4_layer0_attn_head0&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1567.23,-15731.05C1570.07,-15730.71 1572.9,-15730.38 1575.69,-15730.08 2207.18,-15661.01 2946.43,-15638.23 3382.36,-15630.73"/>
<polygon fill="black" stroke="black" points="3382.67,-15634.23 3392.61,-15630.56 3382.55,-15627.23 3382.67,-15634.23"/>
</g>
<!-- stage4_layer0_attn_head1&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge939" class="edge">
<title>stage4_layer0_attn_head1&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1858.24,-15731.08C1861.08,-15730.73 1863.9,-15730.39 1866.69,-15730.08 2392.99,-15670.58 3005.69,-15645.18 3387.91,-15634.52"/>
<polygon fill="black" stroke="black" points="3388.12,-15638.02 3398.02,-15634.24 3387.93,-15631.02 3388.12,-15638.02"/>
</g>
<!-- stage4_layer0_attn_head2&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge940" class="edge">
<title>stage4_layer0_attn_head2&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2149.24,-15731.12C2152.08,-15730.75 2154.9,-15730.41 2157.69,-15730.08 2580.66,-15680.15 3069.57,-15653.12 3394.72,-15639.44"/>
<polygon fill="black" stroke="black" points="3394.93,-15642.94 3404.77,-15639.02 3394.63,-15635.94 3394.93,-15642.94"/>
</g>
<!-- stage4_layer0_attn_head3&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge941" class="edge">
<title>stage4_layer0_attn_head3&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2440.25,-15731.17C2443.08,-15730.79 2445.9,-15730.43 2448.69,-15730.08 2770.79,-15689.73 3139.56,-15662.42 3403.59,-15646.11"/>
<polygon fill="black" stroke="black" points="3403.96,-15649.59 3413.72,-15645.49 3403.53,-15642.61 3403.96,-15649.59"/>
</g>
<!-- stage4_layer0_attn_head4&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge942" class="edge">
<title>stage4_layer0_attn_head4&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2731.26,-15731.26C2734.09,-15730.85 2736.9,-15730.46 2739.69,-15730.08 2964.59,-15699.36 3218.58,-15673.67 3416.72,-15655.62"/>
<polygon fill="black" stroke="black" points="3417.07,-15659.11 3426.71,-15654.72 3416.43,-15652.13 3417.07,-15659.11"/>
</g>
<!-- stage4_layer0_attn_head5&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge943" class="edge">
<title>stage4_layer0_attn_head5&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3022.28,-15731.41C3025.11,-15730.96 3027.91,-15730.51 3030.69,-15730.08 3163.44,-15709.25 3310.12,-15688.13 3436.83,-15670.48"/>
<polygon fill="black" stroke="black" points="3437.65,-15673.9 3447.08,-15669.06 3436.69,-15666.97 3437.65,-15673.9"/>
</g>
<!-- stage4_layer0_attn_head6&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge944" class="edge">
<title>stage4_layer0_attn_head6&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3290.63,-15730.02C3341.21,-15718.89 3403.29,-15705.24 3465.5,-15691.56"/>
<polygon fill="black" stroke="black" points="3466.47,-15694.93 3475.49,-15689.36 3464.97,-15688.09 3466.47,-15694.93"/>
</g>
<!-- stage4_layer0_attn_head7&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge945" class="edge">
<title>stage4_layer0_attn_head7&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3524.83,-15729.94C3546.01,-15720.63 3571.2,-15709.55 3597.08,-15698.16"/>
<polygon fill="black" stroke="black" points="3598.51,-15701.36 3606.25,-15694.13 3595.69,-15694.95 3598.51,-15701.36"/>
</g>
<!-- stage4_layer0_attn_ellipsis&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge946" class="edge">
<title>stage4_layer0_attn_ellipsis&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3758.69,-15729.79C3758.69,-15722.19 3758.69,-15713.43 3758.69,-15704.29"/>
<polygon fill="black" stroke="black" points="3762.19,-15704.26 3758.69,-15694.26 3755.19,-15704.26 3762.19,-15704.26"/>
</g>
<!-- stage4_layer0_attn_head24&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge947" class="edge">
<title>stage4_layer0_attn_head24&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3992.54,-15729.94C3971.37,-15720.63 3946.18,-15709.55 3920.3,-15698.16"/>
<polygon fill="black" stroke="black" points="3921.69,-15694.95 3911.12,-15694.13 3918.87,-15701.36 3921.69,-15694.95"/>
</g>
<!-- stage4_layer0_attn_head25&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge948" class="edge">
<title>stage4_layer0_attn_head25&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4226.74,-15730.02C4182.03,-15720.18 4128.31,-15708.37 4073.45,-15696.3"/>
<polygon fill="black" stroke="black" points="4074.08,-15692.86 4063.56,-15694.13 4072.58,-15699.69 4074.08,-15692.86"/>
</g>
<!-- stage4_layer0_attn_head26&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge949" class="edge">
<title>stage4_layer0_attn_head26&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4494.93,-15731.54C4491.82,-15731.04 4488.74,-15730.55 4485.69,-15730.08 4403.61,-15717.24 4316.21,-15704.26 4231.51,-15692.05"/>
<polygon fill="black" stroke="black" points="4231.86,-15688.56 4221.46,-15690.6 4230.86,-15695.49 4231.86,-15688.56"/>
</g>
<!-- stage4_layer0_attn_head27&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge950" class="edge">
<title>stage4_layer0_attn_head27&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4785.95,-15731.37C4782.84,-15730.92 4779.75,-15730.49 4776.69,-15730.08 4586.01,-15704.14 4374.43,-15681.71 4193.77,-15664.46"/>
<polygon fill="black" stroke="black" points="4193.84,-15660.95 4183.56,-15663.49 4193.18,-15667.92 4193.84,-15660.95"/>
</g>
<!-- stage4_layer0_attn_head28&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge951" class="edge">
<title>stage4_layer0_attn_head28&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5076.97,-15731.28C5073.85,-15730.86 5070.75,-15730.46 5067.69,-15730.08 4769.68,-15692.92 4431.74,-15666.73 4173.88,-15650.05"/>
<polygon fill="black" stroke="black" points="4173.79,-15646.54 4163.59,-15649.39 4173.34,-15653.53 4173.79,-15646.54"/>
</g>
<!-- stage4_layer0_attn_head29&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge952" class="edge">
<title>stage4_layer0_attn_head29&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5367.97,-15731.22C5364.85,-15730.82 5361.75,-15730.44 5358.69,-15730.08 4952.71,-15682.39 4485.99,-15655.52 4161.82,-15641.27"/>
<polygon fill="black" stroke="black" points="4161.94,-15637.77 4151.79,-15640.83 4161.63,-15644.77 4161.94,-15637.77"/>
</g>
<!-- stage4_layer0_attn_head30&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge953" class="edge">
<title>stage4_layer0_attn_head30&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5658.98,-15731.18C5655.85,-15730.79 5652.75,-15730.42 5649.69,-15730.08 5134.76,-15672.16 4537.15,-15646.52 4153.82,-15635.36"/>
<polygon fill="black" stroke="black" points="4153.77,-15631.86 4143.67,-15635.07 4153.57,-15638.86 4153.77,-15631.86"/>
</g>
<!-- stage4_layer0_attn_head31&#45;&gt;stage4_layer0_attn_agg -->
<g id="edge954" class="edge">
<title>stage4_layer0_attn_head31&#45;&gt;stage4_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5949.98,-15731.15C5946.86,-15730.77 5943.76,-15730.41 5940.69,-15730.08 5315.76,-15662.08 4585.31,-15638.96 4147.99,-15631.1"/>
<polygon fill="black" stroke="black" points="4147.77,-15627.6 4137.71,-15630.92 4147.65,-15634.6 4147.77,-15627.6"/>
</g>
<!-- stage4_layer0_attn_out -->
<g id="node728" class="node">
<title>stage4_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="3983.69,-15522.08 3533.69,-15522.08 3533.69,-15454.08 3983.69,-15454.08 3983.69,-15522.08"/>
<text text-anchor="middle" x="3758.69" y="-15506.88" font-family="Times,serif" font-size="14.00">Layer 8 Attention Output Proj</text>
<text text-anchor="middle" x="3758.69" y="-15491.88" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP: GPU 512&#45;639)</text>
<text text-anchor="middle" x="3758.69" y="-15476.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-15461.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_attn_agg&#45;&gt;stage4_layer0_attn_out -->
<g id="edge955" class="edge">
<title>stage4_layer0_attn_agg&#45;&gt;stage4_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3758.69,-15557.87C3758.69,-15549.12 3758.69,-15540.35 3758.69,-15532.14"/>
<polygon fill="black" stroke="black" points="3762.19,-15532.09 3758.69,-15522.09 3755.19,-15532.09 3762.19,-15532.09"/>
</g>
<!-- stage4_layer0_tp_attn_comm -->
<g id="node729" class="node">
<title>stage4_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3758.69" cy="-15369.99" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3758.69" y="-15388.79" font-family="Times,serif" font-size="14.00">Layer 8 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3758.69" y="-15373.79" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP pairs)</text>
<text text-anchor="middle" x="3758.69" y="-15358.79" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3758.69" y="-15343.79" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_attn_out&#45;&gt;stage4_layer0_tp_attn_comm -->
<g id="edge956" class="edge">
<title>stage4_layer0_attn_out&#45;&gt;stage4_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3758.69,-15453.81C3758.69,-15445.82 3758.69,-15437.05 3758.69,-15428.31"/>
<polygon fill="black" stroke="black" points="3762.19,-15428.1 3758.69,-15418.1 3755.19,-15428.1 3762.19,-15428.1"/>
</g>
<!-- stage4_layer0_expert_router -->
<g id="node730" class="node">
<title>stage4_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3356.88,-15285.91 2634.36,-15285.91 2448.49,-15149.91 3171.02,-15149.91 3356.88,-15285.91"/>
<text text-anchor="middle" x="2902.69" y="-15236.71" font-family="Times,serif" font-size="14.00">Layer 8 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2902.69" y="-15221.71" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="2902.69" y="-15206.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2902.69" y="-15191.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage4_layer0_tp_attn_comm&#45;&gt;stage4_layer0_expert_router -->
<g id="edge957" class="edge">
<title>stage4_layer0_tp_attn_comm&#45;&gt;stage4_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3554.2,-15333.14C3476.26,-15319.48 3384.58,-15303.4 3294.99,-15287.69"/>
<polygon fill="black" stroke="black" points="3295.38,-15284.21 3284.93,-15285.93 3294.17,-15291.1 3295.38,-15284.21"/>
</g>
<!-- stage4_layer0_output -->
<g id="node793" class="node">
<title>stage4_layer0_output</title>
<polygon fill="none" stroke="black" points="4187.69,-14370.83 3737.69,-14370.83 3737.69,-14302.83 4187.69,-14302.83 4187.69,-14370.83"/>
<text text-anchor="middle" x="3962.69" y="-14355.63" font-family="Times,serif" font-size="14.00">Layer 8 Output</text>
<text text-anchor="middle" x="3962.69" y="-14340.63" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-14325.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-14310.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_tp_attn_comm&#45;&gt;stage4_layer0_output -->
<!-- stage4_layer0_expert0 -->
<g id="node731" class="node">
<title>stage4_layer0_expert0</title>
<polygon fill="none" stroke="black" points="748.69,-15113.91 426.69,-15113.91 426.69,-15061.91 748.69,-15061.91 748.69,-15113.91"/>
<text text-anchor="middle" x="587.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 0</text>
<text text-anchor="middle" x="587.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP pair)</text>
<text text-anchor="middle" x="587.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="587.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert0 -->
<g id="edge958" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2513.82,-15197.81C2122.08,-15178.21 1500.32,-15146.1 962.69,-15113.91 896.07,-15109.92 822.83,-15105.13 758.89,-15100.81"/>
<polygon fill="black" stroke="black" points="758.92,-15097.31 748.71,-15100.12 758.45,-15104.29 758.92,-15097.31"/>
</g>
<!-- stage4_layer0_expert1 -->
<g id="node737" class="node">
<title>stage4_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1293.69,-15113.91 971.69,-15113.91 971.69,-15061.91 1293.69,-15061.91 1293.69,-15113.91"/>
<text text-anchor="middle" x="1132.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 1</text>
<text text-anchor="middle" x="1132.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP pair)</text>
<text text-anchor="middle" x="1132.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1132.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert1 -->
<g id="edge964" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2505.89,-15192.12C2203.85,-15172.65 1777.89,-15143.89 1404.69,-15113.91 1372.13,-15111.3 1337.41,-15108.28 1304.03,-15105.26"/>
<polygon fill="black" stroke="black" points="1304,-15101.75 1293.72,-15104.33 1303.37,-15108.72 1304,-15101.75"/>
</g>
<!-- stage4_layer0_expert2 -->
<g id="node743" class="node">
<title>stage4_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1735.69,-15113.91 1413.69,-15113.91 1413.69,-15061.91 1735.69,-15061.91 1735.69,-15113.91"/>
<text text-anchor="middle" x="1574.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 2</text>
<text text-anchor="middle" x="1574.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP pair)</text>
<text text-anchor="middle" x="1574.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1574.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert2 -->
<g id="edge970" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2497.93,-15186.13C2276.33,-15167.94 1997.06,-15142.82 1748.69,-15113.91 1747.76,-15113.8 1746.83,-15113.69 1745.9,-15113.58"/>
<polygon fill="black" stroke="black" points="1746.15,-15110.09 1735.81,-15112.37 1745.32,-15117.04 1746.15,-15110.09"/>
</g>
<!-- stage4_layer0_expert3 -->
<g id="node749" class="node">
<title>stage4_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2079.69,-15113.91 1757.69,-15113.91 1757.69,-15061.91 2079.69,-15061.91 2079.69,-15113.91"/>
<text text-anchor="middle" x="1918.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 3</text>
<text text-anchor="middle" x="1918.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP pair)</text>
<text text-anchor="middle" x="1918.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1918.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert3 -->
<g id="edge976" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2461.42,-15159.51C2329.72,-15142.38 2193.12,-15124.61 2089.91,-15111.18"/>
<polygon fill="black" stroke="black" points="2090.08,-15107.68 2079.71,-15109.86 2089.18,-15114.62 2090.08,-15107.68"/>
</g>
<!-- stage4_layer0_expert31 -->
<g id="node755" class="node">
<title>stage4_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2504.69,-15113.91 2182.69,-15113.91 2182.69,-15061.91 2504.69,-15061.91 2504.69,-15113.91"/>
<text text-anchor="middle" x="2343.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 31</text>
<text text-anchor="middle" x="2343.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP pair)</text>
<text text-anchor="middle" x="2343.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2343.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert31 -->
<g id="edge982" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2609.68,-15149.82C2557.78,-15137.93 2506.51,-15126.19 2463.03,-15116.24"/>
<polygon fill="black" stroke="black" points="2463.55,-15112.76 2453.02,-15113.94 2461.98,-15119.59 2463.55,-15112.76"/>
</g>
<!-- stage4_layer0_expert32 -->
<g id="node761" class="node">
<title>stage4_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2883.69,-15113.91 2561.69,-15113.91 2561.69,-15061.91 2883.69,-15061.91 2883.69,-15113.91"/>
<text text-anchor="middle" x="2722.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 32</text>
<text text-anchor="middle" x="2722.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP pair)</text>
<text text-anchor="middle" x="2722.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2722.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert32 -->
<g id="edge988" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2808.21,-15149.72C2793.73,-15139.43 2779.4,-15129.24 2766.73,-15120.23"/>
<polygon fill="black" stroke="black" points="2768.42,-15117.14 2758.24,-15114.19 2764.37,-15122.84 2768.42,-15117.14"/>
</g>
<!-- stage4_layer0_expert60 -->
<g id="node767" class="node">
<title>stage4_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3242.69,-15113.91 2920.69,-15113.91 2920.69,-15061.91 3242.69,-15061.91 3242.69,-15113.91"/>
<text text-anchor="middle" x="3081.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 60</text>
<text text-anchor="middle" x="3081.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP pair)</text>
<text text-anchor="middle" x="3081.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3081.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert60 -->
<g id="edge994" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2996.64,-15149.72C3011.05,-15139.43 3025.29,-15129.24 3037.89,-15120.23"/>
<polygon fill="black" stroke="black" points="3040.23,-15122.86 3046.33,-15114.19 3036.16,-15117.16 3040.23,-15122.86"/>
</g>
<!-- stage4_layer0_expert61 -->
<g id="node773" class="node">
<title>stage4_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3594.69,-15113.91 3272.69,-15113.91 3272.69,-15061.91 3594.69,-15061.91 3594.69,-15113.91"/>
<text text-anchor="middle" x="3433.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 61</text>
<text text-anchor="middle" x="3433.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP pair)</text>
<text text-anchor="middle" x="3433.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3433.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert61 -->
<g id="edge1000" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3173.63,-15151.6C3225.23,-15139.16 3276.54,-15126.79 3319.79,-15116.37"/>
<polygon fill="black" stroke="black" points="3320.85,-15119.71 3329.75,-15113.97 3319.2,-15112.91 3320.85,-15119.71"/>
</g>
<!-- stage4_layer0_expert62 -->
<g id="node779" class="node">
<title>stage4_layer0_expert62</title>
<polygon fill="none" stroke="black" points="3940.69,-15113.91 3618.69,-15113.91 3618.69,-15061.91 3940.69,-15061.91 3940.69,-15113.91"/>
<text text-anchor="middle" x="3779.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 62</text>
<text text-anchor="middle" x="3779.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP pair)</text>
<text text-anchor="middle" x="3779.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3779.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert62 -->
<g id="edge1006" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3202.97,-15173.08C3338.38,-15153.32 3493.38,-15130.7 3608.57,-15113.89"/>
<polygon fill="black" stroke="black" points="3609.15,-15117.34 3618.54,-15112.43 3608.14,-15110.41 3609.15,-15117.34"/>
</g>
<!-- stage4_layer0_expert63 -->
<g id="node785" class="node">
<title>stage4_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4326.69,-15113.91 4004.69,-15113.91 4004.69,-15061.91 4326.69,-15061.91 4326.69,-15113.91"/>
<text text-anchor="middle" x="4165.69" y="-15101.91" font-family="Times,serif" font-size="10.00">Layer 8 Expert 63</text>
<text text-anchor="middle" x="4165.69" y="-15090.91" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP pair)</text>
<text text-anchor="middle" x="4165.69" y="-15079.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4165.69" y="-15068.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert63 -->
<g id="edge1012" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3221.86,-15186.94C3429.33,-15167.11 3705.65,-15140.03 3949.69,-15113.91 3964.24,-15112.35 3979.33,-15110.69 3994.47,-15109"/>
<polygon fill="black" stroke="black" points="3994.88,-15112.48 4004.43,-15107.88 3994.1,-15105.52 3994.88,-15112.48"/>
</g>
<!-- stage4_layer0_expert_ellipsis -->
<g id="node791" class="node">
<title>stage4_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4767.69,-15025.91 4445.69,-15025.91 4445.69,-14973.91 4767.69,-14973.91 4767.69,-15025.91"/>
<text text-anchor="middle" x="4606.69" y="-15013.91" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4606.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4606.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4606.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert_ellipsis -->
<g id="edge1018" class="edge">
<title>stage4_layer0_expert_router&#45;&gt;stage4_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3246.57,-15204.94C3603.35,-15190.25 4136.48,-15161.27 4335.69,-15113.91 4413.28,-15095.46 4497.24,-15057.36 4550.82,-15030.52"/>
<polygon fill="black" stroke="black" points="4552.46,-15033.61 4559.8,-15025.98 4549.3,-15027.36 4552.46,-15033.61"/>
</g>
<!-- stage4_layer0_expert0_mlp1 -->
<g id="node732" class="node">
<title>stage4_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="628.69,-15025.91 314.69,-15025.91 314.69,-14973.91 628.69,-14973.91 628.69,-15025.91"/>
<text text-anchor="middle" x="471.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="471.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP: Column Parallel)</text>
<text text-anchor="middle" x="471.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="471.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert0&#45;&gt;stage4_layer0_expert0_mlp1 -->
<g id="edge959" class="edge">
<title>stage4_layer0_expert0&#45;&gt;stage4_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M553.82,-15061.8C541.43,-15052.61 527.24,-15042.09 514.18,-15032.41"/>
<polygon fill="black" stroke="black" points="515.91,-15029.34 505.8,-15026.2 511.74,-15034.96 515.91,-15029.34"/>
</g>
<!-- stage4_layer0_expert0_tp1 -->
<g id="node733" class="node">
<title>stage4_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="430.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="430.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="430.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="430.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="430.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert0_mlp1&#45;&gt;stage4_layer0_expert0_tp1 -->
<g id="edge960" class="edge">
<title>stage4_layer0_expert0_mlp1&#45;&gt;stage4_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M461.02,-14973.74C457.61,-14965.67 453.71,-14956.48 449.88,-14947.44"/>
<polygon fill="black" stroke="black" points="453.06,-14945.96 445.93,-14938.12 446.61,-14948.69 453.06,-14945.96"/>
</g>
<!-- stage4_layer0_expert0_act -->
<g id="node734" class="node">
<title>stage4_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="570.19,-14828.37 289.19,-14828.37 289.19,-14776.37 570.19,-14776.37 570.19,-14828.37"/>
<text text-anchor="middle" x="429.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="429.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="429.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="429.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert0_tp1&#45;&gt;stage4_layer0_expert0_act -->
<g id="edge961" class="edge">
<title>stage4_layer0_expert0_tp1&#45;&gt;stage4_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M430.32,-14864.11C430.23,-14855.8 430.14,-14846.96 430.05,-14838.68"/>
<polygon fill="black" stroke="black" points="433.55,-14838.53 429.95,-14828.57 426.55,-14838.6 433.55,-14838.53"/>
</g>
<!-- stage4_layer0_expert0_mlp2 -->
<g id="node735" class="node">
<title>stage4_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="497.69,-14740.37 175.69,-14740.37 175.69,-14688.37 497.69,-14688.37 497.69,-14740.37"/>
<text text-anchor="middle" x="336.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="336.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP: Row Parallel)</text>
<text text-anchor="middle" x="336.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="336.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert0_act&#45;&gt;stage4_layer0_expert0_mlp2 -->
<g id="edge962" class="edge">
<title>stage4_layer0_expert0_act&#45;&gt;stage4_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M402.29,-14776.03C392.64,-14767.11 381.66,-14756.96 371.48,-14747.55"/>
<polygon fill="black" stroke="black" points="373.61,-14744.75 363.89,-14740.53 368.86,-14749.89 373.61,-14744.75"/>
</g>
<!-- stage4_layer0_expert0_tp2 -->
<g id="node736" class="node">
<title>stage4_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="268.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="268.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="268.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="268.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="268.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert0_mlp2&#45;&gt;stage4_layer0_expert0_tp2 -->
<g id="edge963" class="edge">
<title>stage4_layer0_expert0_mlp2&#45;&gt;stage4_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M319,-14688.2C313.03,-14679.71 306.19,-14669.97 299.51,-14660.47"/>
<polygon fill="black" stroke="black" points="302.33,-14658.38 293.71,-14652.21 296.6,-14662.41 302.33,-14658.38"/>
</g>
<!-- stage4_layer0_expert_agg -->
<g id="node792" class="node">
<title>stage4_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3420.22,-14542.83 2544.45,-14542.83 2319.16,-14406.83 3194.93,-14406.83 3420.22,-14542.83"/>
<text text-anchor="middle" x="2869.69" y="-14493.63" font-family="Times,serif" font-size="14.00">Layer 8 Expert Aggregation</text>
<text text-anchor="middle" x="2869.69" y="-14478.63" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="2869.69" y="-14463.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2869.69" y="-14448.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert0_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1019" class="edge">
<title>stage4_layer0_expert0_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M423.9,-14588.66C450.78,-14584.86 478.5,-14581.38 504.69,-14578.83 1174.84,-14513.64 1955.85,-14489.71 2431.36,-14480.92"/>
<polygon fill="black" stroke="black" points="2431.55,-14484.42 2441.48,-14480.74 2431.42,-14477.42 2431.55,-14484.42"/>
</g>
<!-- stage4_layer0_expert1_mlp1 -->
<g id="node738" class="node">
<title>stage4_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1178.69,-15025.91 864.69,-15025.91 864.69,-14973.91 1178.69,-14973.91 1178.69,-15025.91"/>
<text text-anchor="middle" x="1021.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1021.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1021.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1021.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert1&#45;&gt;stage4_layer0_expert1_mlp1 -->
<g id="edge965" class="edge">
<title>stage4_layer0_expert1&#45;&gt;stage4_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1100.28,-15061.8C1088.42,-15052.61 1074.84,-15042.09 1062.35,-15032.41"/>
<polygon fill="black" stroke="black" points="1064.37,-15029.55 1054.33,-15026.2 1060.09,-15035.09 1064.37,-15029.55"/>
</g>
<!-- stage4_layer0_expert1_tp1 -->
<g id="node739" class="node">
<title>stage4_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="932.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="932.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="932.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="932.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="932.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert1_mlp1&#45;&gt;stage4_layer0_expert1_tp1 -->
<g id="edge966" class="edge">
<title>stage4_layer0_expert1_mlp1&#45;&gt;stage4_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M998.54,-14973.74C990.49,-14964.99 981.23,-14954.92 972.24,-14945.14"/>
<polygon fill="black" stroke="black" points="974.79,-14942.74 965.44,-14937.75 969.63,-14947.48 974.79,-14942.74"/>
</g>
<!-- stage4_layer0_expert1_act -->
<g id="node740" class="node">
<title>stage4_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="928.19,-14828.37 647.19,-14828.37 647.19,-14776.37 928.19,-14776.37 928.19,-14828.37"/>
<text text-anchor="middle" x="787.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="787.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="787.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="787.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert1_tp1&#45;&gt;stage4_layer0_expert1_act -->
<g id="edge967" class="edge">
<title>stage4_layer0_expert1_tp1&#45;&gt;stage4_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M880.75,-14865.48C865.4,-14855.23 848.7,-14844.09 833.75,-14834.11"/>
<polygon fill="black" stroke="black" points="835.43,-14831.03 825.17,-14828.39 831.54,-14836.85 835.43,-14831.03"/>
</g>
<!-- stage4_layer0_expert1_mlp2 -->
<g id="node741" class="node">
<title>stage4_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="903.69,-14740.37 581.69,-14740.37 581.69,-14688.37 903.69,-14688.37 903.69,-14740.37"/>
<text text-anchor="middle" x="742.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="742.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP: Row Parallel)</text>
<text text-anchor="middle" x="742.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="742.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert1_act&#45;&gt;stage4_layer0_expert1_mlp2 -->
<g id="edge968" class="edge">
<title>stage4_layer0_expert1_act&#45;&gt;stage4_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M774.43,-14776.03C770.08,-14767.72 765.18,-14758.35 760.54,-14749.5"/>
<polygon fill="black" stroke="black" points="763.59,-14747.77 755.85,-14740.53 757.39,-14751.01 763.59,-14747.77"/>
</g>
<!-- stage4_layer0_expert1_tp2 -->
<g id="node742" class="node">
<title>stage4_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="741.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="741.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="741.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="741.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="741.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert1_mlp2&#45;&gt;stage4_layer0_expert1_tp2 -->
<g id="edge969" class="edge">
<title>stage4_layer0_expert1_mlp2&#45;&gt;stage4_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M742.43,-14688.2C742.35,-14680.39 742.26,-14671.52 742.17,-14662.76"/>
<polygon fill="black" stroke="black" points="745.66,-14662.54 742.06,-14652.58 738.66,-14662.61 745.66,-14662.54"/>
</g>
<!-- stage4_layer0_expert1_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1020" class="edge">
<title>stage4_layer0_expert1_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M897.88,-14588.77C924.46,-14584.99 951.82,-14581.49 977.69,-14578.83 1478.82,-14527.33 2057.45,-14500.59 2441.53,-14487.41"/>
<polygon fill="black" stroke="black" points="2441.82,-14490.9 2451.7,-14487.07 2441.59,-14483.91 2441.82,-14490.9"/>
</g>
<!-- stage4_layer0_expert2_mlp1 -->
<g id="node744" class="node">
<title>stage4_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1613.69,-15025.91 1299.69,-15025.91 1299.69,-14973.91 1613.69,-14973.91 1613.69,-15025.91"/>
<text text-anchor="middle" x="1456.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1456.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1456.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1456.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert2&#45;&gt;stage4_layer0_expert2_mlp1 -->
<g id="edge971" class="edge">
<title>stage4_layer0_expert2&#45;&gt;stage4_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1540.24,-15061.8C1527.51,-15052.53 1512.92,-15041.89 1499.54,-15032.14"/>
<polygon fill="black" stroke="black" points="1501.53,-15029.26 1491.38,-15026.2 1497.4,-15034.91 1501.53,-15029.26"/>
</g>
<!-- stage4_layer0_expert2_tp1 -->
<g id="node745" class="node">
<title>stage4_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1390.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1390.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1390.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="1390.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1390.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert2_mlp1&#45;&gt;stage4_layer0_expert2_tp1 -->
<g id="edge972" class="edge">
<title>stage4_layer0_expert2_mlp1&#45;&gt;stage4_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1439.52,-14973.74C1433.79,-14965.33 1427.22,-14955.71 1420.8,-14946.29"/>
<polygon fill="black" stroke="black" points="1423.5,-14944.04 1414.98,-14937.75 1417.72,-14947.98 1423.5,-14944.04"/>
</g>
<!-- stage4_layer0_expert2_act -->
<g id="node746" class="node">
<title>stage4_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1526.19,-14828.37 1245.19,-14828.37 1245.19,-14776.37 1526.19,-14776.37 1526.19,-14828.37"/>
<text text-anchor="middle" x="1385.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1385.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="1385.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1385.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert2_tp1&#45;&gt;stage4_layer0_expert2_act -->
<g id="edge973" class="edge">
<title>stage4_layer0_expert2_tp1&#45;&gt;stage4_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1388.83,-14864.11C1388.4,-14855.8 1387.94,-14846.96 1387.51,-14838.68"/>
<polygon fill="black" stroke="black" points="1391,-14838.37 1386.99,-14828.57 1384.01,-14838.73 1391,-14838.37"/>
</g>
<!-- stage4_layer0_expert2_mlp2 -->
<g id="node747" class="node">
<title>stage4_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1447.69,-14740.37 1125.69,-14740.37 1125.69,-14688.37 1447.69,-14688.37 1447.69,-14740.37"/>
<text text-anchor="middle" x="1286.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1286.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1286.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1286.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert2_act&#45;&gt;stage4_layer0_expert2_mlp2 -->
<g id="edge974" class="edge">
<title>stage4_layer0_expert2_act&#45;&gt;stage4_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1356.79,-14776.27C1346.41,-14767.25 1334.56,-14756.96 1323.59,-14747.43"/>
<polygon fill="black" stroke="black" points="1325.64,-14744.57 1315.8,-14740.66 1321.05,-14749.86 1325.64,-14744.57"/>
</g>
<!-- stage4_layer0_expert2_tp2 -->
<g id="node748" class="node">
<title>stage4_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1214.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1214.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1214.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="1214.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1214.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert2_mlp2&#45;&gt;stage4_layer0_expert2_tp2 -->
<g id="edge975" class="edge">
<title>stage4_layer0_expert2_mlp2&#45;&gt;stage4_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1267.96,-14688.2C1261.64,-14679.71 1254.4,-14669.97 1247.33,-14660.47"/>
<polygon fill="black" stroke="black" points="1249.96,-14658.15 1241.18,-14652.21 1244.35,-14662.32 1249.96,-14658.15"/>
</g>
<!-- stage4_layer0_expert2_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1021" class="edge">
<title>stage4_layer0_expert2_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1372.19,-14588.99C1398.36,-14585.23 1425.26,-14581.68 1450.69,-14578.83 1788.8,-14541 2173.87,-14514.06 2457.48,-14497.24"/>
<polygon fill="black" stroke="black" points="2457.75,-14500.73 2467.53,-14496.65 2457.34,-14493.74 2457.75,-14500.73"/>
</g>
<!-- stage4_layer0_expert3_mlp1 -->
<g id="node750" class="node">
<title>stage4_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="1997.69,-15025.91 1683.69,-15025.91 1683.69,-14973.91 1997.69,-14973.91 1997.69,-15025.91"/>
<text text-anchor="middle" x="1840.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="1840.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1840.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1840.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert3&#45;&gt;stage4_layer0_expert3_mlp1 -->
<g id="edge977" class="edge">
<title>stage4_layer0_expert3&#45;&gt;stage4_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M1895.71,-15061.57C1887.77,-15052.82 1878.77,-15042.9 1870.37,-15033.64"/>
<polygon fill="black" stroke="black" points="1872.82,-15031.12 1863.5,-15026.07 1867.63,-15035.83 1872.82,-15031.12"/>
</g>
<!-- stage4_layer0_expert3_tp1 -->
<g id="node751" class="node">
<title>stage4_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1827.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1827.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1827.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="1827.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1827.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert3_mlp1&#45;&gt;stage4_layer0_expert3_tp1 -->
<g id="edge978" class="edge">
<title>stage4_layer0_expert3_mlp1&#45;&gt;stage4_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1837.31,-14973.74C1836.26,-14965.93 1835.07,-14957.06 1833.89,-14948.3"/>
<polygon fill="black" stroke="black" points="1837.32,-14947.56 1832.52,-14938.12 1830.38,-14948.49 1837.32,-14947.56"/>
</g>
<!-- stage4_layer0_expert3_act -->
<g id="node752" class="node">
<title>stage4_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1845.19,-14828.37 1564.19,-14828.37 1564.19,-14776.37 1845.19,-14776.37 1845.19,-14828.37"/>
<text text-anchor="middle" x="1704.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1704.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="1704.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1704.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert3_tp1&#45;&gt;stage4_layer0_expert3_act -->
<g id="edge979" class="edge">
<title>stage4_layer0_expert3_tp1&#45;&gt;stage4_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1783.28,-14865.2C1770.64,-14855.26 1756.95,-14844.49 1744.59,-14834.76"/>
<polygon fill="black" stroke="black" points="1746.71,-14831.98 1736.68,-14828.54 1742.38,-14837.48 1746.71,-14831.98"/>
</g>
<!-- stage4_layer0_expert3_mlp2 -->
<g id="node753" class="node">
<title>stage4_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1859.69,-14740.37 1537.69,-14740.37 1537.69,-14688.37 1859.69,-14688.37 1859.69,-14740.37"/>
<text text-anchor="middle" x="1698.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1698.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1698.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1698.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert3_act&#45;&gt;stage4_layer0_expert3_mlp2 -->
<g id="edge980" class="edge">
<title>stage4_layer0_expert3_act&#45;&gt;stage4_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1702.92,-14776.03C1702.37,-14768.07 1701.74,-14759.13 1701.15,-14750.62"/>
<polygon fill="black" stroke="black" points="1704.63,-14750.26 1700.44,-14740.53 1697.65,-14750.75 1704.63,-14750.26"/>
</g>
<!-- stage4_layer0_expert3_tp2 -->
<g id="node754" class="node">
<title>stage4_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1687.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1687.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1687.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="1687.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1687.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert3_mlp2&#45;&gt;stage4_layer0_expert3_tp2 -->
<g id="edge981" class="edge">
<title>stage4_layer0_expert3_mlp2&#45;&gt;stage4_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1695.83,-14688.2C1694.94,-14680.39 1693.93,-14671.52 1692.93,-14662.76"/>
<polygon fill="black" stroke="black" points="1696.39,-14662.12 1691.78,-14652.58 1689.43,-14662.91 1696.39,-14662.12"/>
</g>
<!-- stage4_layer0_expert3_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1022" class="edge">
<title>stage4_layer0_expert3_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1847.83,-14589.4C1873.19,-14585.68 1899.14,-14582.03 1923.69,-14578.83 2108,-14554.84 2313.01,-14532.04 2484.94,-14514.03"/>
<polygon fill="black" stroke="black" points="2485.33,-14517.5 2494.91,-14512.98 2484.6,-14510.54 2485.33,-14517.5"/>
</g>
<!-- stage4_layer0_expert31_mlp1 -->
<g id="node756" class="node">
<title>stage4_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2421.69,-15025.91 2107.69,-15025.91 2107.69,-14973.91 2421.69,-14973.91 2421.69,-15025.91"/>
<text text-anchor="middle" x="2264.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2264.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2264.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2264.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert31&#45;&gt;stage4_layer0_expert31_mlp1 -->
<g id="edge983" class="edge">
<title>stage4_layer0_expert31&#45;&gt;stage4_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2320.41,-15061.57C2312.38,-15052.82 2303.26,-15042.9 2294.76,-15033.64"/>
<polygon fill="black" stroke="black" points="2297.14,-15031.06 2287.8,-15026.07 2291.98,-15035.8 2297.14,-15031.06"/>
</g>
<!-- stage4_layer0_expert31_tp1 -->
<g id="node757" class="node">
<title>stage4_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2253.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2253.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2253.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="2253.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2253.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert31_mlp1&#45;&gt;stage4_layer0_expert31_tp1 -->
<g id="edge984" class="edge">
<title>stage4_layer0_expert31_mlp1&#45;&gt;stage4_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2261.83,-14973.74C2260.94,-14965.93 2259.93,-14957.06 2258.93,-14948.3"/>
<polygon fill="black" stroke="black" points="2262.39,-14947.66 2257.78,-14938.12 2255.43,-14948.45 2262.39,-14947.66"/>
</g>
<!-- stage4_layer0_expert31_act -->
<g id="node758" class="node">
<title>stage4_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2371.19,-14828.37 2090.19,-14828.37 2090.19,-14776.37 2371.19,-14776.37 2371.19,-14828.37"/>
<text text-anchor="middle" x="2230.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2230.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="2230.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2230.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert31_tp1&#45;&gt;stage4_layer0_expert31_act -->
<g id="edge985" class="edge">
<title>stage4_layer0_expert31_tp1&#45;&gt;stage4_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2245.19,-14864.38C2243.17,-14855.88 2241.02,-14846.83 2239.01,-14838.37"/>
<polygon fill="black" stroke="black" points="2242.36,-14837.33 2236.64,-14828.41 2235.55,-14838.95 2242.36,-14837.33"/>
</g>
<!-- stage4_layer0_expert31_mlp2 -->
<g id="node759" class="node">
<title>stage4_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2368.69,-14740.37 2046.69,-14740.37 2046.69,-14688.37 2368.69,-14688.37 2368.69,-14740.37"/>
<text text-anchor="middle" x="2207.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2207.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2207.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2207.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert31_act&#45;&gt;stage4_layer0_expert31_mlp2 -->
<g id="edge986" class="edge">
<title>stage4_layer0_expert31_act&#45;&gt;stage4_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2223.91,-14776.03C2221.76,-14767.99 2219.34,-14758.94 2217.04,-14750.34"/>
<polygon fill="black" stroke="black" points="2220.38,-14749.28 2214.42,-14740.53 2213.62,-14751.09 2220.38,-14749.28"/>
</g>
<!-- stage4_layer0_expert31_tp2 -->
<g id="node760" class="node">
<title>stage4_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2160.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2160.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2160.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="2160.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2160.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert31_mlp2&#45;&gt;stage4_layer0_expert31_tp2 -->
<g id="edge987" class="edge">
<title>stage4_layer0_expert31_mlp2&#45;&gt;stage4_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2195.46,-14688.2C2191.5,-14680.05 2186.99,-14670.75 2182.55,-14661.61"/>
<polygon fill="black" stroke="black" points="2185.68,-14660.04 2178.16,-14652.58 2179.38,-14663.1 2185.68,-14660.04"/>
</g>
<!-- stage4_layer0_expert31_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1023" class="edge">
<title>stage4_layer0_expert31_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2302.89,-14586.77C2368.6,-14573.91 2449.71,-14558.03 2529.83,-14542.35"/>
<polygon fill="black" stroke="black" points="2530.96,-14545.7 2540.1,-14540.34 2529.61,-14538.83 2530.96,-14545.7"/>
</g>
<!-- stage4_layer0_expert32_mlp1 -->
<g id="node762" class="node">
<title>stage4_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2840.69,-15025.91 2526.69,-15025.91 2526.69,-14973.91 2840.69,-14973.91 2840.69,-15025.91"/>
<text text-anchor="middle" x="2683.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2683.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2683.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2683.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert32&#45;&gt;stage4_layer0_expert32_mlp1 -->
<g id="edge989" class="edge">
<title>stage4_layer0_expert32&#45;&gt;stage4_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2711.2,-15061.57C2707.47,-15053.35 2703.27,-15044.08 2699.29,-15035.31"/>
<polygon fill="black" stroke="black" points="2702.41,-15033.73 2695.1,-15026.07 2696.04,-15036.62 2702.41,-15033.73"/>
</g>
<!-- stage4_layer0_expert32_tp1 -->
<g id="node763" class="node">
<title>stage4_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2673.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2673.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2673.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="2673.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2673.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert32_mlp1&#45;&gt;stage4_layer0_expert32_tp1 -->
<g id="edge990" class="edge">
<title>stage4_layer0_expert32_mlp1&#45;&gt;stage4_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2681.09,-14973.74C2680.28,-14965.93 2679.36,-14957.06 2678.46,-14948.3"/>
<polygon fill="black" stroke="black" points="2681.92,-14947.7 2677.41,-14938.12 2674.95,-14948.42 2681.92,-14947.7"/>
</g>
<!-- stage4_layer0_expert32_act -->
<g id="node764" class="node">
<title>stage4_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2785.19,-14828.37 2504.19,-14828.37 2504.19,-14776.37 2785.19,-14776.37 2785.19,-14828.37"/>
<text text-anchor="middle" x="2644.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2644.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="2644.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2644.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert32_tp1&#45;&gt;stage4_layer0_expert32_act -->
<g id="edge991" class="edge">
<title>stage4_layer0_expert32_tp1&#45;&gt;stage4_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2662.97,-14864.38C2660.4,-14855.79 2657.65,-14846.63 2655.09,-14838.09"/>
<polygon fill="black" stroke="black" points="2658.42,-14836.99 2652.19,-14828.41 2651.71,-14839 2658.42,-14836.99"/>
</g>
<!-- stage4_layer0_expert32_mlp2 -->
<g id="node765" class="node">
<title>stage4_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2800.69,-14740.37 2478.69,-14740.37 2478.69,-14688.37 2800.69,-14688.37 2800.69,-14740.37"/>
<text text-anchor="middle" x="2639.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2639.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2639.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2639.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert32_act&#45;&gt;stage4_layer0_expert32_mlp2 -->
<g id="edge992" class="edge">
<title>stage4_layer0_expert32_act&#45;&gt;stage4_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2643.22,-14776.03C2642.75,-14768.07 2642.23,-14759.13 2641.74,-14750.62"/>
<polygon fill="black" stroke="black" points="2645.23,-14750.31 2641.15,-14740.53 2638.24,-14750.71 2645.23,-14750.31"/>
</g>
<!-- stage4_layer0_expert32_tp2 -->
<g id="node766" class="node">
<title>stage4_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2633.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2633.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2633.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="2633.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2633.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert32_mlp2&#45;&gt;stage4_layer0_expert32_tp2 -->
<g id="edge993" class="edge">
<title>stage4_layer0_expert32_mlp2&#45;&gt;stage4_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2638.13,-14688.2C2637.64,-14680.39 2637.09,-14671.52 2636.55,-14662.76"/>
<polygon fill="black" stroke="black" points="2640.03,-14662.34 2635.92,-14652.58 2633.04,-14662.78 2640.03,-14662.34"/>
</g>
<!-- stage4_layer0_expert32_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1024" class="edge">
<title>stage4_layer0_expert32_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2692.63,-14579.94C2709.21,-14570.2 2727.88,-14559.22 2746.72,-14548.14"/>
<polygon fill="black" stroke="black" points="2748.53,-14551.13 2755.38,-14543.05 2744.98,-14545.1 2748.53,-14551.13"/>
</g>
<!-- stage4_layer0_expert60_mlp1 -->
<g id="node768" class="node">
<title>stage4_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3241.69,-15025.91 2927.69,-15025.91 2927.69,-14973.91 3241.69,-14973.91 3241.69,-15025.91"/>
<text text-anchor="middle" x="3084.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3084.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3084.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3084.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert60&#45;&gt;stage4_layer0_expert60_mlp1 -->
<g id="edge995" class="edge">
<title>stage4_layer0_expert60&#45;&gt;stage4_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3082.57,-15061.57C3082.85,-15053.61 3083.16,-15044.67 3083.46,-15036.16"/>
<polygon fill="black" stroke="black" points="3086.96,-15036.18 3083.81,-15026.07 3079.96,-15035.94 3086.96,-15036.18"/>
</g>
<!-- stage4_layer0_expert60_tp1 -->
<g id="node769" class="node">
<title>stage4_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3091.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3091.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3091.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="3091.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3091.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert60_mlp1&#45;&gt;stage4_layer0_expert60_tp1 -->
<g id="edge996" class="edge">
<title>stage4_layer0_expert60_mlp1&#45;&gt;stage4_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3086.51,-14973.74C3087.07,-14965.93 3087.72,-14957.06 3088.35,-14948.3"/>
<polygon fill="black" stroke="black" points="3091.86,-14948.34 3089.09,-14938.12 3084.87,-14947.84 3091.86,-14948.34"/>
</g>
<!-- stage4_layer0_expert60_act -->
<g id="node770" class="node">
<title>stage4_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3232.19,-14828.37 2951.19,-14828.37 2951.19,-14776.37 3232.19,-14776.37 3232.19,-14828.37"/>
<text text-anchor="middle" x="3091.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3091.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="3091.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3091.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert60_tp1&#45;&gt;stage4_layer0_expert60_act -->
<g id="edge997" class="edge">
<title>stage4_layer0_expert60_tp1&#45;&gt;stage4_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3091.69,-14864.11C3091.69,-14855.8 3091.69,-14846.96 3091.69,-14838.68"/>
<polygon fill="black" stroke="black" points="3095.19,-14838.57 3091.69,-14828.57 3088.19,-14838.57 3095.19,-14838.57"/>
</g>
<!-- stage4_layer0_expert60_mlp2 -->
<g id="node771" class="node">
<title>stage4_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3266.69,-14740.37 2944.69,-14740.37 2944.69,-14688.37 3266.69,-14688.37 3266.69,-14740.37"/>
<text text-anchor="middle" x="3105.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3105.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3105.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3105.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert60_act&#45;&gt;stage4_layer0_expert60_mlp2 -->
<g id="edge998" class="edge">
<title>stage4_layer0_expert60_act&#45;&gt;stage4_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3095.81,-14776.03C3097.11,-14768.07 3098.56,-14759.13 3099.95,-14750.62"/>
<polygon fill="black" stroke="black" points="3103.44,-14750.96 3101.59,-14740.53 3096.53,-14749.84 3103.44,-14750.96"/>
</g>
<!-- stage4_layer0_expert60_tp2 -->
<g id="node772" class="node">
<title>stage4_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3106.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3106.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3106.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="3106.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3106.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert60_mlp2&#45;&gt;stage4_layer0_expert60_tp2 -->
<g id="edge999" class="edge">
<title>stage4_layer0_expert60_mlp2&#45;&gt;stage4_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3105.95,-14688.2C3106.03,-14680.39 3106.12,-14671.52 3106.21,-14662.76"/>
<polygon fill="black" stroke="black" points="3109.71,-14662.61 3106.32,-14652.58 3102.71,-14662.54 3109.71,-14662.61"/>
</g>
<!-- stage4_layer0_expert60_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1025" class="edge">
<title>stage4_layer0_expert60_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3047.49,-14579.94C3030.85,-14570.2 3012.1,-14559.22 2993.18,-14548.14"/>
<polygon fill="black" stroke="black" points="2994.88,-14545.08 2984.48,-14543.05 2991.35,-14551.12 2994.88,-14545.08"/>
</g>
<!-- stage4_layer0_expert61_mlp1 -->
<g id="node774" class="node">
<title>stage4_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3605.69,-15025.91 3291.69,-15025.91 3291.69,-14973.91 3605.69,-14973.91 3605.69,-15025.91"/>
<text text-anchor="middle" x="3448.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3448.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3448.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3448.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert61&#45;&gt;stage4_layer0_expert61_mlp1 -->
<g id="edge1001" class="edge">
<title>stage4_layer0_expert61&#45;&gt;stage4_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3438.11,-15061.57C3439.5,-15053.61 3441.06,-15044.67 3442.54,-15036.16"/>
<polygon fill="black" stroke="black" points="3446.03,-15036.52 3444.3,-15026.07 3439.13,-15035.32 3446.03,-15036.52"/>
</g>
<!-- stage4_layer0_expert61_tp1 -->
<g id="node775" class="node">
<title>stage4_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3524.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3524.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3524.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="3524.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3524.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert61_mlp1&#45;&gt;stage4_layer0_expert61_tp1 -->
<g id="edge1002" class="edge">
<title>stage4_layer0_expert61_mlp1&#45;&gt;stage4_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3468.46,-14973.74C3475.19,-14965.16 3482.93,-14955.31 3490.46,-14945.72"/>
<polygon fill="black" stroke="black" points="3493.3,-14947.78 3496.72,-14937.75 3487.79,-14943.45 3493.3,-14947.78"/>
</g>
<!-- stage4_layer0_expert61_act -->
<g id="node776" class="node">
<title>stage4_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3674.19,-14828.37 3393.19,-14828.37 3393.19,-14776.37 3674.19,-14776.37 3674.19,-14828.37"/>
<text text-anchor="middle" x="3533.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3533.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="3533.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3533.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert61_tp1&#45;&gt;stage4_layer0_expert61_act -->
<g id="edge1003" class="edge">
<title>stage4_layer0_expert61_tp1&#45;&gt;stage4_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3528.04,-14864.11C3528.81,-14855.8 3529.63,-14846.96 3530.4,-14838.68"/>
<polygon fill="black" stroke="black" points="3533.9,-14838.85 3531.35,-14828.57 3526.93,-14838.2 3533.9,-14838.85"/>
</g>
<!-- stage4_layer0_expert61_mlp2 -->
<g id="node777" class="node">
<title>stage4_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3730.69,-14740.37 3408.69,-14740.37 3408.69,-14688.37 3730.69,-14688.37 3730.69,-14740.37"/>
<text text-anchor="middle" x="3569.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3569.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3569.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3569.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert61_act&#45;&gt;stage4_layer0_expert61_mlp2 -->
<g id="edge1004" class="edge">
<title>stage4_layer0_expert61_act&#45;&gt;stage4_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3544.29,-14776.03C3547.74,-14767.81 3551.62,-14758.54 3555.29,-14749.78"/>
<polygon fill="black" stroke="black" points="3558.52,-14751.1 3559.16,-14740.53 3552.07,-14748.4 3558.52,-14751.1"/>
</g>
<!-- stage4_layer0_expert61_tp2 -->
<g id="node778" class="node">
<title>stage4_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3579.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3579.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3579.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="3579.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3579.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert61_mlp2&#45;&gt;stage4_layer0_expert61_tp2 -->
<g id="edge1005" class="edge">
<title>stage4_layer0_expert61_mlp2&#45;&gt;stage4_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3572.29,-14688.2C3573.1,-14680.39 3574.01,-14671.52 3574.92,-14662.76"/>
<polygon fill="black" stroke="black" points="3578.42,-14662.88 3575.97,-14652.58 3571.46,-14662.17 3578.42,-14662.88"/>
</g>
<!-- stage4_layer0_expert61_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1026" class="edge">
<title>stage4_layer0_expert61_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3437.72,-14586.85C3375.36,-14574.67 3299.09,-14559.76 3222.93,-14544.87"/>
<polygon fill="black" stroke="black" points="3223.16,-14541.35 3212.68,-14542.87 3221.82,-14548.22 3223.16,-14541.35"/>
</g>
<!-- stage4_layer0_expert62_mlp1 -->
<g id="node780" class="node">
<title>stage4_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="3953.69,-15025.91 3639.69,-15025.91 3639.69,-14973.91 3953.69,-14973.91 3953.69,-15025.91"/>
<text text-anchor="middle" x="3796.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3796.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3796.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3796.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert62&#45;&gt;stage4_layer0_expert62_mlp1 -->
<g id="edge1007" class="edge">
<title>stage4_layer0_expert62&#45;&gt;stage4_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3784.7,-15061.57C3786.27,-15053.61 3788.04,-15044.67 3789.72,-15036.16"/>
<polygon fill="black" stroke="black" points="3793.21,-15036.56 3791.72,-15026.07 3786.34,-15035.2 3793.21,-15036.56"/>
</g>
<!-- stage4_layer0_expert62_tp1 -->
<g id="node781" class="node">
<title>stage4_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3962.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="3962.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="3962.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3962.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert62_mlp1&#45;&gt;stage4_layer0_expert62_tp1 -->
<g id="edge1008" class="edge">
<title>stage4_layer0_expert62_mlp1&#45;&gt;stage4_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3839.87,-14973.74C3856.79,-14963.88 3876.6,-14952.33 3895.31,-14941.42"/>
<polygon fill="black" stroke="black" points="3897.22,-14944.35 3904.1,-14936.29 3893.7,-14938.31 3897.22,-14944.35"/>
</g>
<!-- stage4_layer0_expert62_act -->
<g id="node782" class="node">
<title>stage4_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4126.19,-14828.37 3845.19,-14828.37 3845.19,-14776.37 4126.19,-14776.37 4126.19,-14828.37"/>
<text text-anchor="middle" x="3985.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="3985.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="3985.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3985.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert62_tp1&#45;&gt;stage4_layer0_expert62_act -->
<g id="edge1009" class="edge">
<title>stage4_layer0_expert62_tp1&#45;&gt;stage4_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M3971.19,-14864.38C3973.21,-14855.88 3975.36,-14846.83 3977.37,-14838.37"/>
<polygon fill="black" stroke="black" points="3980.83,-14838.95 3979.74,-14828.41 3974.02,-14837.33 3980.83,-14838.95"/>
</g>
<!-- stage4_layer0_expert62_mlp2 -->
<g id="node783" class="node">
<title>stage4_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4191.69,-14740.37 3869.69,-14740.37 3869.69,-14688.37 4191.69,-14688.37 4191.69,-14740.37"/>
<text text-anchor="middle" x="4030.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4030.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4030.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4030.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert62_act&#45;&gt;stage4_layer0_expert62_mlp2 -->
<g id="edge1010" class="edge">
<title>stage4_layer0_expert62_act&#45;&gt;stage4_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M3998.95,-14776.03C4003.3,-14767.72 4008.2,-14758.35 4012.83,-14749.5"/>
<polygon fill="black" stroke="black" points="4015.99,-14751.01 4017.53,-14740.53 4009.79,-14747.77 4015.99,-14751.01"/>
</g>
<!-- stage4_layer0_expert62_tp2 -->
<g id="node784" class="node">
<title>stage4_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4052.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4052.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4052.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="4052.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4052.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert62_mlp2&#45;&gt;stage4_layer0_expert62_tp2 -->
<g id="edge1011" class="edge">
<title>stage4_layer0_expert62_mlp2&#45;&gt;stage4_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4036.41,-14688.2C4038.21,-14680.31 4040.25,-14671.33 4042.26,-14662.47"/>
<polygon fill="black" stroke="black" points="4045.71,-14663.11 4044.51,-14652.58 4038.88,-14661.55 4045.71,-14663.11"/>
</g>
<!-- stage4_layer0_expert62_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1027" class="edge">
<title>stage4_layer0_expert62_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3892.54,-14589.4C3867.19,-14585.68 3841.24,-14582.03 3816.69,-14578.83 3684.49,-14561.63 3541.66,-14545.05 3407.99,-14530.41"/>
<polygon fill="black" stroke="black" points="3408.29,-14526.92 3397.97,-14529.31 3407.53,-14533.88 3408.29,-14526.92"/>
</g>
<!-- stage4_layer0_expert63_mlp1 -->
<g id="node786" class="node">
<title>stage4_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4380.69,-15025.91 4066.69,-15025.91 4066.69,-14973.91 4380.69,-14973.91 4380.69,-15025.91"/>
<text text-anchor="middle" x="4223.69" y="-15013.91" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4223.69" y="-15002.91" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4223.69" y="-14991.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4223.69" y="-14980.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer0_expert63&#45;&gt;stage4_layer0_expert63_mlp1 -->
<g id="edge1013" class="edge">
<title>stage4_layer0_expert63&#45;&gt;stage4_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4182.78,-15061.57C4188.5,-15053.09 4194.97,-15043.49 4201.05,-15034.48"/>
<polygon fill="black" stroke="black" points="4204.03,-15036.31 4206.72,-15026.07 4198.23,-15032.4 4204.03,-15036.31"/>
</g>
<!-- stage4_layer0_expert63_tp1 -->
<g id="node787" class="node">
<title>stage4_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4430.69" cy="-14901.14" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4430.69" y="-14915.14" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4430.69" y="-14904.14" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="4430.69" y="-14893.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4430.69" y="-14882.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert63_mlp1&#45;&gt;stage4_layer0_expert63_tp1 -->
<g id="edge1014" class="edge">
<title>stage4_layer0_expert63_mlp1&#45;&gt;stage4_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4277.27,-14973.86C4299.47,-14963.49 4325.7,-14951.22 4350.13,-14939.8"/>
<polygon fill="black" stroke="black" points="4351.82,-14942.88 4359.39,-14935.47 4348.85,-14936.53 4351.82,-14942.88"/>
</g>
<!-- stage4_layer0_expert63_act -->
<g id="node788" class="node">
<title>stage4_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4600.19,-14828.37 4319.19,-14828.37 4319.19,-14776.37 4600.19,-14776.37 4600.19,-14828.37"/>
<text text-anchor="middle" x="4459.69" y="-14816.37" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4459.69" y="-14805.37" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="4459.69" y="-14794.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4459.69" y="-14783.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer0_expert63_tp1&#45;&gt;stage4_layer0_expert63_act -->
<g id="edge1015" class="edge">
<title>stage4_layer0_expert63_tp1&#45;&gt;stage4_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4441.4,-14864.38C4443.98,-14855.79 4446.72,-14846.63 4449.28,-14838.09"/>
<polygon fill="black" stroke="black" points="4452.67,-14839 4452.18,-14828.41 4445.96,-14836.99 4452.67,-14839"/>
</g>
<!-- stage4_layer0_expert63_mlp2 -->
<g id="node789" class="node">
<title>stage4_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4657.69,-14740.37 4335.69,-14740.37 4335.69,-14688.37 4657.69,-14688.37 4657.69,-14740.37"/>
<text text-anchor="middle" x="4496.69" y="-14728.37" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4496.69" y="-14717.37" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4496.69" y="-14706.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4496.69" y="-14695.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert63_act&#45;&gt;stage4_layer0_expert63_mlp2 -->
<g id="edge1016" class="edge">
<title>stage4_layer0_expert63_act&#45;&gt;stage4_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4470.59,-14776.03C4474.13,-14767.81 4478.11,-14758.54 4481.89,-14749.78"/>
<polygon fill="black" stroke="black" points="4485.13,-14751.1 4485.87,-14740.53 4478.7,-14748.33 4485.13,-14751.1"/>
</g>
<!-- stage4_layer0_expert63_tp2 -->
<g id="node790" class="node">
<title>stage4_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4525.69" cy="-14615.6" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4525.69" y="-14629.6" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4525.69" y="-14618.6" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="4525.69" y="-14607.6" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4525.69" y="-14596.6" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_expert63_mlp2&#45;&gt;stage4_layer0_expert63_tp2 -->
<g id="edge1017" class="edge">
<title>stage4_layer0_expert63_mlp2&#45;&gt;stage4_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4504.23,-14688.2C4506.62,-14680.22 4509.34,-14671.14 4512.03,-14662.18"/>
<polygon fill="black" stroke="black" points="4515.39,-14663.16 4514.91,-14652.58 4508.68,-14661.15 4515.39,-14663.16"/>
</g>
<!-- stage4_layer0_expert63_tp2&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1028" class="edge">
<title>stage4_layer0_expert63_tp2&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4368.18,-14588.99C4342.01,-14585.23 4315.12,-14581.68 4289.69,-14578.83 3982.14,-14544.42 3635.76,-14519.04 3362.1,-14502.07"/>
<polygon fill="black" stroke="black" points="3362.19,-14498.57 3351.99,-14501.45 3361.76,-14505.56 3362.19,-14498.57"/>
</g>
<!-- stage4_layer0_expert_ellipsis&#45;&gt;stage4_layer0_expert_agg -->
<g id="edge1029" class="edge">
<title>stage4_layer0_expert_ellipsis&#45;&gt;stage4_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4652.67,-14973.76C4704.52,-14941.64 4781.69,-14880.82 4781.69,-14803.37 4781.69,-14803.37 4781.69,-14803.37 4781.69,-14713.37 4781.69,-14652.98 4807.18,-14619.66 4762.69,-14578.83 4710.76,-14531.18 3880.62,-14501.18 3337.07,-14486.55"/>
<polygon fill="black" stroke="black" points="3336.78,-14483.04 3326.69,-14486.27 3336.59,-14490.03 3336.78,-14483.04"/>
</g>
<!-- stage4_layer0_expert_agg&#45;&gt;stage4_layer0_output -->
<g id="edge1030" class="edge">
<title>stage4_layer0_expert_agg&#45;&gt;stage4_layer0_output</title>
<path fill="none" stroke="black" d="M3231.74,-14428.78C3394.86,-14408.49 3582.81,-14385.1 3727.28,-14367.12"/>
<polygon fill="black" stroke="black" points="3728.11,-14370.55 3737.6,-14365.84 3727.25,-14363.6 3728.11,-14370.55"/>
</g>
<!-- stage4_layer1_ln -->
<g id="node794" class="node">
<title>stage4_layer1_ln</title>
<polygon fill="none" stroke="black" points="4187.69,-14266.83 3737.69,-14266.83 3737.69,-14198.83 4187.69,-14198.83 4187.69,-14266.83"/>
<text text-anchor="middle" x="3962.69" y="-14251.63" font-family="Times,serif" font-size="14.00">Layer 9 LayerNorm</text>
<text text-anchor="middle" x="3962.69" y="-14236.63" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-14221.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-14206.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer0_output&#45;&gt;stage4_layer1_ln -->
<g id="edge1032" class="edge">
<title>stage4_layer0_output&#45;&gt;stage4_layer1_ln</title>
<path fill="none" stroke="black" d="M3962.69,-14302.72C3962.69,-14294.61 3962.69,-14285.81 3962.69,-14277.3"/>
<polygon fill="black" stroke="black" points="3966.19,-14277.13 3962.69,-14267.13 3959.19,-14277.13 3966.19,-14277.13"/>
</g>
<!-- stage4_layer1_attn_qkv -->
<g id="node795" class="node">
<title>stage4_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4194.19,-14162.83 3731.19,-14162.83 3731.19,-14094.83 4194.19,-14094.83 4194.19,-14162.83"/>
<text text-anchor="middle" x="3962.69" y="-14147.63" font-family="Times,serif" font-size="14.00">Layer 9 Attention QKV Projection</text>
<text text-anchor="middle" x="3962.69" y="-14132.63" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP: GPU 512&#45;639)</text>
<text text-anchor="middle" x="3962.69" y="-14117.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-14102.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage4_layer1_ln&#45;&gt;stage4_layer1_attn_qkv -->
<g id="edge1033" class="edge">
<title>stage4_layer1_ln&#45;&gt;stage4_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3962.69,-14198.72C3962.69,-14190.61 3962.69,-14181.81 3962.69,-14173.3"/>
<polygon fill="black" stroke="black" points="3966.19,-14173.13 3962.69,-14163.13 3959.19,-14173.13 3966.19,-14173.13"/>
</g>
<!-- stage4_layer1_tp_qkv_comm -->
<g id="node796" class="node">
<title>stage4_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-14010.75" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3962.69" y="-14029.55" font-family="Times,serif" font-size="14.00">Layer 9 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3962.69" y="-14014.55" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP pairs)</text>
<text text-anchor="middle" x="3962.69" y="-13999.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-13984.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage4_layer1_attn_qkv&#45;&gt;stage4_layer1_tp_qkv_comm -->
<g id="edge1034" class="edge">
<title>stage4_layer1_attn_qkv&#45;&gt;stage4_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3962.69,-14094.57C3962.69,-14086.57 3962.69,-14077.81 3962.69,-14069.06"/>
<polygon fill="black" stroke="black" points="3966.19,-14068.86 3962.69,-14058.86 3959.19,-14068.86 3966.19,-14068.86"/>
</g>
<!-- stage4_layer1_attn_head0 -->
<g id="node797" class="node">
<title>stage4_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1771.19,-13926.67 1498.19,-13926.67 1498.19,-13874.67 1771.19,-13874.67 1771.19,-13926.67"/>
<text text-anchor="middle" x="1634.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 0 Attention</text>
<text text-anchor="middle" x="1634.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 0)</text>
<text text-anchor="middle" x="1634.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1634.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head0 -->
<g id="edge1035" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3639.67,-14002.72C3127.05,-13990.69 2148.56,-13963.89 1781.38,-13926.77"/>
<polygon fill="black" stroke="black" points="1781.54,-13923.27 1771.23,-13925.73 1780.82,-13930.23 1781.54,-13923.27"/>
</g>
<!-- stage4_layer1_attn_head1 -->
<g id="node798" class="node">
<title>stage4_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="2062.19,-13926.67 1789.19,-13926.67 1789.19,-13874.67 2062.19,-13874.67 2062.19,-13926.67"/>
<text text-anchor="middle" x="1925.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 1 Attention</text>
<text text-anchor="middle" x="1925.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 1)</text>
<text text-anchor="middle" x="1925.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1925.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head1 -->
<g id="edge1036" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3635.73,-14007.96C3260.12,-14003.01 2625.43,-13985.8 2072.41,-13926.8"/>
<polygon fill="black" stroke="black" points="2072.55,-13923.29 2062.23,-13925.7 2071.8,-13930.25 2072.55,-13923.29"/>
</g>
<!-- stage4_layer1_attn_head2 -->
<g id="node799" class="node">
<title>stage4_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2353.19,-13926.67 2080.19,-13926.67 2080.19,-13874.67 2353.19,-13874.67 2353.19,-13926.67"/>
<text text-anchor="middle" x="2216.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 2 Attention</text>
<text text-anchor="middle" x="2216.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 2)</text>
<text text-anchor="middle" x="2216.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2216.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head2 -->
<g id="edge1037" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3638.26,-14004.21C3316.63,-13996.09 2809.92,-13976.2 2363.44,-13926.81"/>
<polygon fill="black" stroke="black" points="2363.56,-13923.3 2353.24,-13925.67 2362.79,-13930.26 2363.56,-13923.3"/>
</g>
<!-- stage4_layer1_attn_head3 -->
<g id="node800" class="node">
<title>stage4_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2644.19,-13926.67 2371.19,-13926.67 2371.19,-13874.67 2644.19,-13874.67 2644.19,-13926.67"/>
<text text-anchor="middle" x="2507.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 3 Attention</text>
<text text-anchor="middle" x="2507.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 3)</text>
<text text-anchor="middle" x="2507.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2507.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head3 -->
<g id="edge1038" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3644.84,-13999.15C3381.62,-13988.1 2997.78,-13966.77 2654.39,-13926.82"/>
<polygon fill="black" stroke="black" points="2654.58,-13923.32 2644.24,-13925.63 2653.77,-13930.27 2654.58,-13923.32"/>
</g>
<!-- stage4_layer1_attn_head4 -->
<g id="node801" class="node">
<title>stage4_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2935.19,-13926.67 2662.19,-13926.67 2662.19,-13874.67 2935.19,-13874.67 2935.19,-13926.67"/>
<text text-anchor="middle" x="2798.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 4 Attention</text>
<text text-anchor="middle" x="2798.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 4)</text>
<text text-anchor="middle" x="2798.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2798.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head4 -->
<g id="edge1039" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3660.43,-13992.21C3460.07,-13978.87 3191.29,-13957.68 2945.46,-13926.85"/>
<polygon fill="black" stroke="black" points="2945.61,-13923.34 2935.25,-13925.56 2944.73,-13930.28 2945.61,-13923.34"/>
</g>
<!-- stage4_layer1_attn_head5 -->
<g id="node802" class="node">
<title>stage4_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3226.19,-13926.67 2953.19,-13926.67 2953.19,-13874.67 3226.19,-13874.67 3226.19,-13926.67"/>
<text text-anchor="middle" x="3089.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 5 Attention</text>
<text text-anchor="middle" x="3089.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 5)</text>
<text text-anchor="middle" x="3089.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3089.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head5 -->
<g id="edge1040" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3695.12,-13982.91C3560.28,-13968.47 3394.06,-13949.28 3236.62,-13926.91"/>
<polygon fill="black" stroke="black" points="3236.66,-13923.38 3226.27,-13925.44 3235.67,-13930.31 3236.66,-13923.38"/>
</g>
<!-- stage4_layer1_attn_head6 -->
<g id="node803" class="node">
<title>stage4_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3517.19,-13926.67 3244.19,-13926.67 3244.19,-13874.67 3517.19,-13874.67 3517.19,-13926.67"/>
<text text-anchor="middle" x="3380.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 6 Attention</text>
<text text-anchor="middle" x="3380.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 6)</text>
<text text-anchor="middle" x="3380.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3380.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head6 -->
<g id="edge1041" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3762.8,-13972.63C3684.89,-13958.16 3597.29,-13941.89 3525.64,-13928.58"/>
<polygon fill="black" stroke="black" points="3526.1,-13925.11 3515.63,-13926.73 3524.83,-13931.99 3526.1,-13925.11"/>
</g>
<!-- stage4_layer1_attn_head7 -->
<g id="node804" class="node">
<title>stage4_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3808.19,-13926.67 3535.19,-13926.67 3535.19,-13874.67 3808.19,-13874.67 3808.19,-13926.67"/>
<text text-anchor="middle" x="3671.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 7 Attention</text>
<text text-anchor="middle" x="3671.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 7)</text>
<text text-anchor="middle" x="3671.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3671.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head7 -->
<g id="edge1042" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3844.33,-13965.79C3812.09,-13953.82 3778.02,-13941.16 3748.74,-13930.28"/>
<polygon fill="black" stroke="black" points="3749.59,-13926.87 3739,-13926.67 3747.15,-13933.43 3749.59,-13926.87"/>
</g>
<!-- stage4_layer1_attn_ellipsis -->
<g id="node805" class="node">
<title>stage4_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4099.19,-13926.67 3826.19,-13926.67 3826.19,-13874.67 4099.19,-13874.67 4099.19,-13926.67"/>
<text text-anchor="middle" x="3962.69" y="-13914.67" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3962.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_ellipsis -->
<g id="edge1043" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3962.69,-13962.66C3962.69,-13954.11 3962.69,-13945.33 3962.69,-13937.19"/>
<polygon fill="black" stroke="black" points="3966.19,-13936.93 3962.69,-13926.93 3959.19,-13936.93 3966.19,-13936.93"/>
</g>
<!-- stage4_layer1_attn_head24 -->
<g id="node806" class="node">
<title>stage4_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4390.19,-13926.67 4117.19,-13926.67 4117.19,-13874.67 4390.19,-13874.67 4390.19,-13926.67"/>
<text text-anchor="middle" x="4253.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 24 Attention</text>
<text text-anchor="middle" x="4253.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 24)</text>
<text text-anchor="middle" x="4253.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4253.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head24 -->
<g id="edge1044" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M4081.05,-13965.79C4113.28,-13953.82 4147.36,-13941.16 4176.64,-13930.28"/>
<polygon fill="black" stroke="black" points="4178.22,-13933.43 4186.38,-13926.67 4175.79,-13926.87 4178.22,-13933.43"/>
</g>
<!-- stage4_layer1_attn_head25 -->
<g id="node807" class="node">
<title>stage4_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4681.19,-13926.67 4408.19,-13926.67 4408.19,-13874.67 4681.19,-13874.67 4681.19,-13926.67"/>
<text text-anchor="middle" x="4544.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 25 Attention</text>
<text text-anchor="middle" x="4544.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 25)</text>
<text text-anchor="middle" x="4544.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4544.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head25 -->
<g id="edge1045" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M4162.57,-13972.63C4240.48,-13958.16 4328.09,-13941.89 4399.74,-13928.58"/>
<polygon fill="black" stroke="black" points="4400.55,-13931.99 4409.74,-13926.73 4399.27,-13925.11 4400.55,-13931.99"/>
</g>
<!-- stage4_layer1_attn_head26 -->
<g id="node808" class="node">
<title>stage4_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4972.19,-13926.67 4699.19,-13926.67 4699.19,-13874.67 4972.19,-13874.67 4972.19,-13926.67"/>
<text text-anchor="middle" x="4835.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 26 Attention</text>
<text text-anchor="middle" x="4835.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 26)</text>
<text text-anchor="middle" x="4835.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4835.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head26 -->
<g id="edge1046" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4229.45,-13982.87C4364.31,-13968.38 4530.69,-13949.16 4689.01,-13926.73"/>
<polygon fill="black" stroke="black" points="4689.54,-13930.19 4698.95,-13925.32 4688.55,-13923.26 4689.54,-13930.19"/>
</g>
<!-- stage4_layer1_attn_head27 -->
<g id="node809" class="node">
<title>stage4_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5263.19,-13926.67 4990.19,-13926.67 4990.19,-13874.67 5263.19,-13874.67 5263.19,-13926.67"/>
<text text-anchor="middle" x="5126.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 27 Attention</text>
<text text-anchor="middle" x="5126.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 27)</text>
<text text-anchor="middle" x="5126.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5126.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head27 -->
<g id="edge1047" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4264.64,-13992.11C4464.8,-13978.72 4733.31,-13957.53 4979.73,-13926.74"/>
<polygon fill="black" stroke="black" points="4980.48,-13930.17 4989.96,-13925.45 4979.61,-13923.23 4980.48,-13930.17"/>
</g>
<!-- stage4_layer1_attn_head28 -->
<g id="node810" class="node">
<title>stage4_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5554.19,-13926.67 5281.19,-13926.67 5281.19,-13874.67 5554.19,-13874.67 5554.19,-13926.67"/>
<text text-anchor="middle" x="5417.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 28 Attention</text>
<text text-anchor="middle" x="5417.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 28)</text>
<text text-anchor="middle" x="5417.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5417.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head28 -->
<g id="edge1048" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4280.28,-13999.03C4543.3,-13987.92 4926.83,-13966.56 5270.81,-13926.71"/>
<polygon fill="black" stroke="black" points="5271.45,-13930.16 5280.97,-13925.53 5270.64,-13923.21 5271.45,-13930.16"/>
</g>
<!-- stage4_layer1_attn_head29 -->
<g id="node811" class="node">
<title>stage4_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5845.19,-13926.67 5572.19,-13926.67 5572.19,-13874.67 5845.19,-13874.67 5845.19,-13926.67"/>
<text text-anchor="middle" x="5708.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 29 Attention</text>
<text text-anchor="middle" x="5708.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 29)</text>
<text text-anchor="middle" x="5708.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5708.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head29 -->
<g id="edge1049" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4287.28,-14004.08C4608.72,-13995.86 5114.89,-13975.9 5561.77,-13926.71"/>
<polygon fill="black" stroke="black" points="5562.43,-13930.16 5571.98,-13925.58 5561.66,-13923.2 5562.43,-13930.16"/>
</g>
<!-- stage4_layer1_attn_head30 -->
<g id="node812" class="node">
<title>stage4_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="6136.19,-13926.67 5863.19,-13926.67 5863.19,-13874.67 6136.19,-13874.67 6136.19,-13926.67"/>
<text text-anchor="middle" x="5999.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 30 Attention</text>
<text text-anchor="middle" x="5999.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 30)</text>
<text text-anchor="middle" x="5999.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5999.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head30 -->
<g id="edge1050" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4289.89,-14007.83C4665.34,-14002.76 5299.41,-13985.44 5852.8,-13926.7"/>
<polygon fill="black" stroke="black" points="5853.41,-13930.15 5862.98,-13925.61 5852.67,-13923.19 5853.41,-13930.15"/>
</g>
<!-- stage4_layer1_attn_head31 -->
<g id="node813" class="node">
<title>stage4_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6427.19,-13926.67 6154.19,-13926.67 6154.19,-13874.67 6427.19,-13874.67 6427.19,-13926.67"/>
<text text-anchor="middle" x="6290.69" y="-13914.67" font-family="Times,serif" font-size="10.00">Layer 9 Head 31 Attention</text>
<text text-anchor="middle" x="6290.69" y="-13903.67" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Head 31)</text>
<text text-anchor="middle" x="6290.69" y="-13892.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6290.69" y="-13881.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head31 -->
<g id="edge1051" class="edge">
<title>stage4_layer1_tp_qkv_comm&#45;&gt;stage4_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4285.55,-14002.67C4797.93,-13990.57 5775.97,-13963.68 6143.81,-13926.68"/>
<polygon fill="black" stroke="black" points="6144.39,-13930.14 6153.99,-13925.63 6143.68,-13923.17 6144.39,-13930.14"/>
</g>
<!-- stage4_layer1_attn_agg -->
<g id="node814" class="node">
<title>stage4_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4430.34,-13838.67 3686.41,-13838.67 3495.04,-13702.67 4238.97,-13702.67 4430.34,-13838.67"/>
<text text-anchor="middle" x="3962.69" y="-13789.47" font-family="Times,serif" font-size="14.00">Layer 9 Attention Aggregate</text>
<text text-anchor="middle" x="3962.69" y="-13774.47" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-13759.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-13744.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_attn_head0&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1052" class="edge">
<title>stage4_layer1_attn_head0&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1771.23,-13875.64C1774.07,-13875.3 1776.9,-13874.97 1779.69,-13874.67 2411.18,-13805.6 3150.43,-13782.81 3586.36,-13775.32"/>
<polygon fill="black" stroke="black" points="3586.67,-13778.81 3596.61,-13775.14 3586.55,-13771.82 3586.67,-13778.81"/>
</g>
<!-- stage4_layer1_attn_head1&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1053" class="edge">
<title>stage4_layer1_attn_head1&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2062.24,-13875.67C2065.08,-13875.32 2067.9,-13874.98 2070.69,-13874.67 2596.99,-13815.17 3209.69,-13789.77 3591.91,-13779.11"/>
<polygon fill="black" stroke="black" points="3592.12,-13782.61 3602.02,-13778.83 3591.93,-13775.61 3592.12,-13782.61"/>
</g>
<!-- stage4_layer1_attn_head2&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1054" class="edge">
<title>stage4_layer1_attn_head2&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2353.24,-13875.71C2356.08,-13875.34 2358.9,-13874.99 2361.69,-13874.67 2784.66,-13824.74 3273.57,-13797.71 3598.72,-13784.03"/>
<polygon fill="black" stroke="black" points="3598.93,-13787.53 3608.77,-13783.61 3598.63,-13780.53 3598.93,-13787.53"/>
</g>
<!-- stage4_layer1_attn_head3&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1055" class="edge">
<title>stage4_layer1_attn_head3&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2644.25,-13875.76C2647.08,-13875.38 2649.9,-13875.01 2652.69,-13874.67 2974.79,-13834.32 3343.56,-13807.01 3607.59,-13790.7"/>
<polygon fill="black" stroke="black" points="3607.96,-13794.18 3617.72,-13790.07 3607.53,-13787.19 3607.96,-13794.18"/>
</g>
<!-- stage4_layer1_attn_head4&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1056" class="edge">
<title>stage4_layer1_attn_head4&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2935.26,-13875.84C2938.09,-13875.44 2940.9,-13875.05 2943.69,-13874.67 3168.59,-13843.95 3422.58,-13818.25 3620.72,-13800.21"/>
<polygon fill="black" stroke="black" points="3621.07,-13803.69 3630.71,-13799.3 3620.43,-13796.72 3621.07,-13803.69"/>
</g>
<!-- stage4_layer1_attn_head5&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1057" class="edge">
<title>stage4_layer1_attn_head5&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3226.28,-13876C3229.11,-13875.55 3231.91,-13875.1 3234.69,-13874.67 3367.44,-13853.83 3514.12,-13832.72 3640.83,-13815.07"/>
<polygon fill="black" stroke="black" points="3641.65,-13818.49 3651.08,-13813.65 3640.69,-13811.56 3641.65,-13818.49"/>
</g>
<!-- stage4_layer1_attn_head6&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1058" class="edge">
<title>stage4_layer1_attn_head6&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3494.63,-13874.61C3545.21,-13863.48 3607.29,-13849.83 3669.5,-13836.15"/>
<polygon fill="black" stroke="black" points="3670.47,-13839.52 3679.49,-13833.95 3668.97,-13832.68 3670.47,-13839.52"/>
</g>
<!-- stage4_layer1_attn_head7&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1059" class="edge">
<title>stage4_layer1_attn_head7&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3728.83,-13874.53C3750.01,-13865.22 3775.2,-13854.14 3801.08,-13842.75"/>
<polygon fill="black" stroke="black" points="3802.51,-13845.95 3810.25,-13838.72 3799.69,-13839.54 3802.51,-13845.95"/>
</g>
<!-- stage4_layer1_attn_ellipsis&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1060" class="edge">
<title>stage4_layer1_attn_ellipsis&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3962.69,-13874.38C3962.69,-13866.78 3962.69,-13858.02 3962.69,-13848.88"/>
<polygon fill="black" stroke="black" points="3966.19,-13848.85 3962.69,-13838.85 3959.19,-13848.85 3966.19,-13848.85"/>
</g>
<!-- stage4_layer1_attn_head24&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1061" class="edge">
<title>stage4_layer1_attn_head24&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4196.54,-13874.53C4175.37,-13865.22 4150.18,-13854.14 4124.3,-13842.75"/>
<polygon fill="black" stroke="black" points="4125.69,-13839.54 4115.12,-13838.72 4122.87,-13845.95 4125.69,-13839.54"/>
</g>
<!-- stage4_layer1_attn_head25&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1062" class="edge">
<title>stage4_layer1_attn_head25&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4430.74,-13874.61C4386.03,-13864.77 4332.31,-13852.96 4277.45,-13840.89"/>
<polygon fill="black" stroke="black" points="4278.08,-13837.45 4267.56,-13838.72 4276.58,-13844.28 4278.08,-13837.45"/>
</g>
<!-- stage4_layer1_attn_head26&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1063" class="edge">
<title>stage4_layer1_attn_head26&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4698.93,-13876.12C4695.82,-13875.63 4692.74,-13875.14 4689.69,-13874.67 4607.61,-13861.83 4520.21,-13848.85 4435.51,-13836.64"/>
<polygon fill="black" stroke="black" points="4435.86,-13833.15 4425.46,-13835.19 4434.86,-13840.08 4435.86,-13833.15"/>
</g>
<!-- stage4_layer1_attn_head27&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1064" class="edge">
<title>stage4_layer1_attn_head27&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4989.95,-13875.96C4986.84,-13875.51 4983.75,-13875.08 4980.69,-13874.67 4790.01,-13848.73 4578.43,-13826.3 4397.77,-13809.05"/>
<polygon fill="black" stroke="black" points="4397.84,-13805.54 4387.56,-13808.08 4397.18,-13812.51 4397.84,-13805.54"/>
</g>
<!-- stage4_layer1_attn_head28&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1065" class="edge">
<title>stage4_layer1_attn_head28&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5280.97,-13875.87C5277.85,-13875.45 5274.75,-13875.05 5271.69,-13874.67 4973.68,-13837.51 4635.74,-13811.31 4377.88,-13794.64"/>
<polygon fill="black" stroke="black" points="4377.79,-13791.13 4367.59,-13793.98 4377.34,-13798.12 4377.79,-13791.13"/>
</g>
<!-- stage4_layer1_attn_head29&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1066" class="edge">
<title>stage4_layer1_attn_head29&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5571.97,-13875.81C5568.85,-13875.41 5565.75,-13875.03 5562.69,-13874.67 5156.71,-13826.97 4689.99,-13800.1 4365.82,-13785.86"/>
<polygon fill="black" stroke="black" points="4365.94,-13782.36 4355.79,-13785.42 4365.63,-13789.36 4365.94,-13782.36"/>
</g>
<!-- stage4_layer1_attn_head30&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1067" class="edge">
<title>stage4_layer1_attn_head30&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5862.98,-13875.77C5859.85,-13875.38 5856.75,-13875.01 5853.69,-13874.67 5338.76,-13816.75 4741.15,-13791.11 4357.82,-13779.95"/>
<polygon fill="black" stroke="black" points="4357.77,-13776.45 4347.67,-13779.66 4357.57,-13783.44 4357.77,-13776.45"/>
</g>
<!-- stage4_layer1_attn_head31&#45;&gt;stage4_layer1_attn_agg -->
<g id="edge1068" class="edge">
<title>stage4_layer1_attn_head31&#45;&gt;stage4_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M6153.98,-13875.73C6150.86,-13875.36 6147.76,-13875 6144.69,-13874.67 5519.76,-13806.67 4789.31,-13783.55 4351.99,-13775.69"/>
<polygon fill="black" stroke="black" points="4351.77,-13772.19 4341.71,-13775.51 4351.65,-13779.19 4351.77,-13772.19"/>
</g>
<!-- stage4_layer1_attn_out -->
<g id="node815" class="node">
<title>stage4_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="4187.69,-13666.67 3737.69,-13666.67 3737.69,-13598.67 4187.69,-13598.67 4187.69,-13666.67"/>
<text text-anchor="middle" x="3962.69" y="-13651.47" font-family="Times,serif" font-size="14.00">Layer 9 Attention Output Proj</text>
<text text-anchor="middle" x="3962.69" y="-13636.47" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP: GPU 512&#45;639)</text>
<text text-anchor="middle" x="3962.69" y="-13621.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-13606.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_attn_agg&#45;&gt;stage4_layer1_attn_out -->
<g id="edge1069" class="edge">
<title>stage4_layer1_attn_agg&#45;&gt;stage4_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3962.69,-13702.46C3962.69,-13693.71 3962.69,-13684.94 3962.69,-13676.73"/>
<polygon fill="black" stroke="black" points="3966.19,-13676.68 3962.69,-13666.68 3959.19,-13676.68 3966.19,-13676.68"/>
</g>
<!-- stage4_layer1_tp_attn_comm -->
<g id="node816" class="node">
<title>stage4_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-13514.58" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3962.69" y="-13533.38" font-family="Times,serif" font-size="14.00">Layer 9 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3962.69" y="-13518.38" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4 (TP pairs)</text>
<text text-anchor="middle" x="3962.69" y="-13503.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-13488.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_attn_out&#45;&gt;stage4_layer1_tp_attn_comm -->
<g id="edge1070" class="edge">
<title>stage4_layer1_attn_out&#45;&gt;stage4_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3962.69,-13598.4C3962.69,-13590.41 3962.69,-13581.64 3962.69,-13572.9"/>
<polygon fill="black" stroke="black" points="3966.19,-13572.69 3962.69,-13562.69 3959.19,-13572.69 3966.19,-13572.69"/>
</g>
<!-- stage4_layer1_expert_router -->
<g id="node817" class="node">
<title>stage4_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4416.88,-13430.5 3694.36,-13430.5 3508.49,-13294.5 4231.02,-13294.5 4416.88,-13430.5"/>
<text text-anchor="middle" x="3962.69" y="-13381.3" font-family="Times,serif" font-size="14.00">Layer 9 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3962.69" y="-13366.3" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-13351.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-13336.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage4_layer1_tp_attn_comm&#45;&gt;stage4_layer1_expert_router -->
<g id="edge1071" class="edge">
<title>stage4_layer1_tp_attn_comm&#45;&gt;stage4_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3962.69,-13466.1C3962.69,-13458.01 3962.69,-13449.43 3962.69,-13440.81"/>
<polygon fill="black" stroke="black" points="3966.19,-13440.69 3962.69,-13430.69 3959.19,-13440.69 3966.19,-13440.69"/>
</g>
<!-- stage4_layer1_expert0 -->
<g id="node818" class="node">
<title>stage4_layer1_expert0</title>
<polygon fill="none" stroke="black" points="2206.69,-13258.5 1884.69,-13258.5 1884.69,-13206.5 2206.69,-13206.5 2206.69,-13258.5"/>
<text text-anchor="middle" x="2045.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 0</text>
<text text-anchor="middle" x="2045.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP pair)</text>
<text text-anchor="middle" x="2045.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2045.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert0 -->
<g id="edge1072" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3580,-13347.08C3228.41,-13331.85 2693.15,-13303.69 2229.69,-13258.5 2225.65,-13258.11 2221.57,-13257.69 2217.45,-13257.26"/>
<polygon fill="black" stroke="black" points="2217.48,-13253.74 2207.16,-13256.14 2216.72,-13260.7 2217.48,-13253.74"/>
</g>
<!-- stage4_layer1_expert1 -->
<g id="node824" class="node">
<title>stage4_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2560.69,-13258.5 2238.69,-13258.5 2238.69,-13206.5 2560.69,-13206.5 2560.69,-13258.5"/>
<text text-anchor="middle" x="2399.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 1</text>
<text text-anchor="middle" x="2399.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP pair)</text>
<text text-anchor="middle" x="2399.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2399.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert1 -->
<g id="edge1078" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3556.77,-13329.98C3303.86,-13310.08 2971.77,-13283.51 2677.69,-13258.5 2643.3,-13255.57 2606.53,-13252.34 2571.36,-13249.2"/>
<polygon fill="black" stroke="black" points="2571.27,-13245.68 2561,-13248.27 2570.65,-13252.65 2571.27,-13245.68"/>
</g>
<!-- stage4_layer1_expert2 -->
<g id="node830" class="node">
<title>stage4_layer1_expert2</title>
<polygon fill="none" stroke="black" points="3008.69,-13258.5 2686.69,-13258.5 2686.69,-13206.5 3008.69,-13206.5 3008.69,-13258.5"/>
<text text-anchor="middle" x="2847.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 2</text>
<text text-anchor="middle" x="2847.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP pair)</text>
<text text-anchor="middle" x="2847.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2847.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert2 -->
<g id="edge1084" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3532.4,-13312.1C3353.24,-13291.54 3155.58,-13268.84 3018.87,-13253.15"/>
<polygon fill="black" stroke="black" points="3019.06,-13249.65 3008.72,-13251.99 3018.26,-13256.6 3019.06,-13249.65"/>
</g>
<!-- stage4_layer1_expert3 -->
<g id="node836" class="node">
<title>stage4_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3402.69,-13258.5 3080.69,-13258.5 3080.69,-13206.5 3402.69,-13206.5 3402.69,-13258.5"/>
<text text-anchor="middle" x="3241.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 3</text>
<text text-anchor="middle" x="3241.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP pair)</text>
<text text-anchor="middle" x="3241.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3241.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert3 -->
<g id="edge1090" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3585.03,-13294.45C3516.93,-13282.36 3449.64,-13270.42 3392.93,-13260.35"/>
<polygon fill="black" stroke="black" points="3393.28,-13256.86 3382.83,-13258.56 3392.06,-13263.75 3393.28,-13256.86"/>
</g>
<!-- stage4_layer1_expert31 -->
<g id="node842" class="node">
<title>stage4_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3769.69,-13258.5 3447.69,-13258.5 3447.69,-13206.5 3769.69,-13206.5 3769.69,-13258.5"/>
<text text-anchor="middle" x="3608.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 31</text>
<text text-anchor="middle" x="3608.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP pair)</text>
<text text-anchor="middle" x="3608.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3608.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert31 -->
<g id="edge1096" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3777.14,-13294.41C3745.58,-13283 3714.39,-13271.72 3687.59,-13262.03"/>
<polygon fill="black" stroke="black" points="3688.52,-13258.64 3677.92,-13258.53 3686.14,-13265.23 3688.52,-13258.64"/>
</g>
<!-- stage4_layer1_expert32 -->
<g id="node848" class="node">
<title>stage4_layer1_expert32</title>
<polygon fill="none" stroke="black" points="4123.69,-13258.5 3801.69,-13258.5 3801.69,-13206.5 4123.69,-13206.5 4123.69,-13258.5"/>
<text text-anchor="middle" x="3962.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 32</text>
<text text-anchor="middle" x="3962.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP pair)</text>
<text text-anchor="middle" x="3962.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert32 -->
<g id="edge1102" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3962.69,-13294.13C3962.69,-13285.43 3962.69,-13276.82 3962.69,-13268.93"/>
<polygon fill="black" stroke="black" points="3966.19,-13268.69 3962.69,-13258.69 3959.19,-13268.69 3966.19,-13268.69"/>
</g>
<!-- stage4_layer1_expert60 -->
<g id="node854" class="node">
<title>stage4_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4506.69,-13258.5 4184.69,-13258.5 4184.69,-13206.5 4506.69,-13206.5 4506.69,-13258.5"/>
<text text-anchor="middle" x="4345.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 60</text>
<text text-anchor="middle" x="4345.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP pair)</text>
<text text-anchor="middle" x="4345.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4345.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert60 -->
<g id="edge1108" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4163.44,-13294.41C4197.88,-13282.9 4231.91,-13271.52 4261.08,-13261.77"/>
<polygon fill="black" stroke="black" points="4262.41,-13265.02 4270.78,-13258.53 4260.19,-13258.38 4262.41,-13265.02"/>
</g>
<!-- stage4_layer1_expert61 -->
<g id="node860" class="node">
<title>stage4_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4867.69,-13258.5 4545.69,-13258.5 4545.69,-13206.5 4867.69,-13206.5 4867.69,-13258.5"/>
<text text-anchor="middle" x="4706.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 61</text>
<text text-anchor="middle" x="4706.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP pair)</text>
<text text-anchor="middle" x="4706.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4706.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert61 -->
<g id="edge1114" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4254.33,-13311.32C4355.59,-13293.9 4465.19,-13275.05 4551.14,-13260.26"/>
<polygon fill="black" stroke="black" points="4551.98,-13263.67 4561.24,-13258.52 4550.79,-13256.77 4551.98,-13263.67"/>
</g>
<!-- stage4_layer1_expert62 -->
<g id="node866" class="node">
<title>stage4_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5218.69,-13258.5 4896.69,-13258.5 4896.69,-13206.5 5218.69,-13206.5 5218.69,-13258.5"/>
<text text-anchor="middle" x="5057.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 62</text>
<text text-anchor="middle" x="5057.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP pair)</text>
<text text-anchor="middle" x="5057.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5057.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert62 -->
<g id="edge1120" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4277,-13328.04C4453.4,-13308.77 4677.44,-13283.48 4876.69,-13258.5 4879.81,-13258.11 4882.97,-13257.71 4886.15,-13257.3"/>
<polygon fill="black" stroke="black" points="4886.89,-13260.74 4896.37,-13255.99 4886,-13253.79 4886.89,-13260.74"/>
</g>
<!-- stage4_layer1_expert63 -->
<g id="node872" class="node">
<title>stage4_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5563.69,-13258.5 5241.69,-13258.5 5241.69,-13206.5 5563.69,-13206.5 5563.69,-13258.5"/>
<text text-anchor="middle" x="5402.69" y="-13246.5" font-family="Times,serif" font-size="10.00">Layer 9 Expert 63</text>
<text text-anchor="middle" x="5402.69" y="-13235.5" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP pair)</text>
<text text-anchor="middle" x="5402.69" y="-13224.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5402.69" y="-13213.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert63 -->
<g id="edge1126" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4293.49,-13340.08C4549.02,-13322.2 4911.27,-13293.95 5227.69,-13258.5 5228.98,-13258.35 5230.27,-13258.21 5231.56,-13258.06"/>
<polygon fill="black" stroke="black" points="5232.06,-13261.53 5241.58,-13256.89 5231.25,-13254.57 5232.06,-13261.53"/>
</g>
<!-- stage4_layer1_expert_ellipsis -->
<g id="node878" class="node">
<title>stage4_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6128.69,-13170.5 5806.69,-13170.5 5806.69,-13118.5 6128.69,-13118.5 6128.69,-13170.5"/>
<text text-anchor="middle" x="5967.69" y="-13158.5" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5967.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: Pipeline 4 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5967.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5967.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert_ellipsis -->
<g id="edge1132" class="edge">
<title>stage4_layer1_expert_router&#45;&gt;stage4_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4304.52,-13348.25C4703.23,-13331.27 5337.75,-13299.13 5572.69,-13258.5 5683.9,-13239.26 5808.54,-13200.64 5887.52,-13173.94"/>
<polygon fill="black" stroke="black" points="5889.06,-13177.11 5897.4,-13170.58 5886.8,-13170.48 5889.06,-13177.11"/>
</g>
<!-- stage4_layer1_expert0_mlp1 -->
<g id="node819" class="node">
<title>stage4_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="2015.69,-13170.5 1701.69,-13170.5 1701.69,-13118.5 2015.69,-13118.5 2015.69,-13170.5"/>
<text text-anchor="middle" x="1858.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1858.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1858.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1858.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert0&#45;&gt;stage4_layer1_expert0_mlp1 -->
<g id="edge1073" class="edge">
<title>stage4_layer1_expert0&#45;&gt;stage4_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1991.1,-13206.39C1969.68,-13196.55 1944.96,-13185.17 1922.71,-13174.94"/>
<polygon fill="black" stroke="black" points="1923.89,-13171.63 1913.35,-13170.64 1920.97,-13177.99 1923.89,-13171.63"/>
</g>
<!-- stage4_layer1_expert0_tp1 -->
<g id="node820" class="node">
<title>stage4_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1817.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1817.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1817.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="1817.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1817.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert0_mlp1&#45;&gt;stage4_layer1_expert0_tp1 -->
<g id="edge1074" class="edge">
<title>stage4_layer1_expert0_mlp1&#45;&gt;stage4_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1848.02,-13118.33C1844.61,-13110.26 1840.71,-13101.07 1836.88,-13092.03"/>
<polygon fill="black" stroke="black" points="1840.06,-13090.55 1832.93,-13082.71 1833.61,-13093.28 1840.06,-13090.55"/>
</g>
<!-- stage4_layer1_expert0_act -->
<g id="node821" class="node">
<title>stage4_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1955.19,-12972.96 1674.19,-12972.96 1674.19,-12920.96 1955.19,-12920.96 1955.19,-12972.96"/>
<text text-anchor="middle" x="1814.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1814.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="1814.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1814.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert0_tp1&#45;&gt;stage4_layer1_expert0_act -->
<g id="edge1075" class="edge">
<title>stage4_layer1_expert0_tp1&#45;&gt;stage4_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1816.57,-13008.7C1816.31,-13000.38 1816.04,-12991.55 1815.78,-12983.27"/>
<polygon fill="black" stroke="black" points="1819.28,-12983.04 1815.47,-12973.16 1812.28,-12983.26 1819.28,-12983.04"/>
</g>
<!-- stage4_layer1_expert0_mlp2 -->
<g id="node822" class="node">
<title>stage4_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1830.69,-12884.96 1508.69,-12884.96 1508.69,-12832.96 1830.69,-12832.96 1830.69,-12884.96"/>
<text text-anchor="middle" x="1669.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1669.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1669.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1669.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert0_act&#45;&gt;stage4_layer1_expert0_mlp2 -->
<g id="edge1076" class="edge">
<title>stage4_layer1_expert0_act&#45;&gt;stage4_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1772.36,-12920.85C1756.2,-12911.27 1737.61,-12900.24 1720.72,-12890.23"/>
<polygon fill="black" stroke="black" points="1722.46,-12887.19 1712.07,-12885.1 1718.89,-12893.21 1722.46,-12887.19"/>
</g>
<!-- stage4_layer1_expert0_tp2 -->
<g id="node823" class="node">
<title>stage4_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1597.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1597.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1597.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 512&#45;513</text>
<text text-anchor="middle" x="1597.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1597.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert0_mlp2&#45;&gt;stage4_layer1_expert0_tp2 -->
<g id="edge1077" class="edge">
<title>stage4_layer1_expert0_mlp2&#45;&gt;stage4_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1650.96,-12832.79C1644.64,-12824.3 1637.4,-12814.56 1630.33,-12805.06"/>
<polygon fill="black" stroke="black" points="1632.96,-12802.73 1624.18,-12796.8 1627.35,-12806.91 1632.96,-12802.73"/>
</g>
<!-- stage4_layer1_expert_agg -->
<g id="node879" class="node">
<title>stage4_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4513.22,-12687.42 3637.45,-12687.42 3412.16,-12551.42 4287.93,-12551.42 4513.22,-12687.42"/>
<text text-anchor="middle" x="3962.69" y="-12638.22" font-family="Times,serif" font-size="14.00">Layer 9 Expert Aggregation</text>
<text text-anchor="middle" x="3962.69" y="-12623.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-12608.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12593.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert0_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1133" class="edge">
<title>stage4_layer1_expert0_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1753.23,-12733.32C1780.01,-12729.52 1807.61,-12726.02 1833.69,-12723.42 2418.93,-12665.07 3098.1,-12639.47 3528.99,-12628.45"/>
<polygon fill="black" stroke="black" points="3529.22,-12631.94 3539.12,-12628.19 3529.04,-12624.94 3529.22,-12631.94"/>
</g>
<!-- stage4_layer1_expert1_mlp1 -->
<g id="node825" class="node">
<title>stage4_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2475.69,-13170.5 2161.69,-13170.5 2161.69,-13118.5 2475.69,-13118.5 2475.69,-13170.5"/>
<text text-anchor="middle" x="2318.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2318.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2318.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2318.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert1&#45;&gt;stage4_layer1_expert1_mlp1 -->
<g id="edge1079" class="edge">
<title>stage4_layer1_expert1&#45;&gt;stage4_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2375.82,-13206.16C2367.5,-13197.33 2358.05,-13187.29 2349.26,-13177.95"/>
<polygon fill="black" stroke="black" points="2351.79,-13175.54 2342.38,-13170.66 2346.69,-13180.33 2351.79,-13175.54"/>
</g>
<!-- stage4_layer1_expert1_tp1 -->
<g id="node826" class="node">
<title>stage4_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2268.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2268.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2268.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="2268.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2268.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert1_mlp1&#45;&gt;stage4_layer1_expert1_tp1 -->
<g id="edge1080" class="edge">
<title>stage4_layer1_expert1_mlp1&#45;&gt;stage4_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2305.68,-13118.33C2301.47,-13110.18 2296.67,-13100.88 2291.95,-13091.74"/>
<polygon fill="black" stroke="black" points="2294.98,-13089.98 2287.28,-13082.71 2288.76,-13093.2 2294.98,-13089.98"/>
</g>
<!-- stage4_layer1_expert1_act -->
<g id="node827" class="node">
<title>stage4_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2315.19,-12972.96 2034.19,-12972.96 2034.19,-12920.96 2315.19,-12920.96 2315.19,-12972.96"/>
<text text-anchor="middle" x="2174.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="2174.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="2174.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2174.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert1_tp1&#45;&gt;stage4_layer1_expert1_act -->
<g id="edge1081" class="edge">
<title>stage4_layer1_expert1_tp1&#45;&gt;stage4_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2234.22,-13009.25C2225.04,-12999.8 2215.17,-12989.64 2206.17,-12980.36"/>
<polygon fill="black" stroke="black" points="2208.63,-12977.88 2199.15,-12973.15 2203.61,-12982.76 2208.63,-12977.88"/>
</g>
<!-- stage4_layer1_expert1_mlp2 -->
<g id="node828" class="node">
<title>stage4_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2283.69,-12884.96 1961.69,-12884.96 1961.69,-12832.96 2283.69,-12832.96 2283.69,-12884.96"/>
<text text-anchor="middle" x="2122.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="2122.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2122.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2122.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert1_act&#45;&gt;stage4_layer1_expert1_mlp2 -->
<g id="edge1082" class="edge">
<title>stage4_layer1_expert1_act&#45;&gt;stage4_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M2159.37,-12920.62C2154.29,-12912.22 2148.55,-12902.74 2143.15,-12893.8"/>
<polygon fill="black" stroke="black" points="2146.07,-12891.86 2137.9,-12885.12 2140.08,-12895.48 2146.07,-12891.86"/>
</g>
<!-- stage4_layer1_expert1_tp2 -->
<g id="node829" class="node">
<title>stage4_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="2070.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2070.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2070.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 514&#45;515</text>
<text text-anchor="middle" x="2070.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2070.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert1_mlp2&#45;&gt;stage4_layer1_expert1_tp2 -->
<g id="edge1083" class="edge">
<title>stage4_layer1_expert1_mlp2&#45;&gt;stage4_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M2109.16,-12832.79C2104.78,-12824.64 2099.79,-12815.34 2094.88,-12806.2"/>
<polygon fill="black" stroke="black" points="2097.84,-12804.32 2090.02,-12797.17 2091.67,-12807.63 2097.84,-12804.32"/>
</g>
<!-- stage4_layer1_expert1_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1134" class="edge">
<title>stage4_layer1_expert1_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2227.22,-12733.48C2253.69,-12729.71 2280.93,-12726.17 2306.69,-12723.42 2725.55,-12678.74 3206.24,-12651.5 3541.44,-12636.35"/>
<polygon fill="black" stroke="black" points="3541.98,-12639.83 3551.81,-12635.88 3541.67,-12632.83 3541.98,-12639.83"/>
</g>
<!-- stage4_layer1_expert2_mlp1 -->
<g id="node831" class="node">
<title>stage4_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2923.69,-13170.5 2609.69,-13170.5 2609.69,-13118.5 2923.69,-13118.5 2923.69,-13170.5"/>
<text text-anchor="middle" x="2766.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2766.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2766.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2766.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert2&#45;&gt;stage4_layer1_expert2_mlp1 -->
<g id="edge1085" class="edge">
<title>stage4_layer1_expert2&#45;&gt;stage4_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2823.82,-13206.16C2815.5,-13197.33 2806.05,-13187.29 2797.26,-13177.95"/>
<polygon fill="black" stroke="black" points="2799.79,-13175.54 2790.38,-13170.66 2794.69,-13180.33 2799.79,-13175.54"/>
</g>
<!-- stage4_layer1_expert2_tp1 -->
<g id="node832" class="node">
<title>stage4_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2701.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2701.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2701.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="2701.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2701.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert2_mlp1&#45;&gt;stage4_layer1_expert2_tp1 -->
<g id="edge1086" class="edge">
<title>stage4_layer1_expert2_mlp1&#45;&gt;stage4_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2749.78,-13118.33C2744.14,-13109.92 2737.67,-13100.3 2731.35,-13090.88"/>
<polygon fill="black" stroke="black" points="2734.09,-13088.69 2725.61,-13082.34 2728.28,-13092.59 2734.09,-13088.69"/>
</g>
<!-- stage4_layer1_expert2_act -->
<g id="node833" class="node">
<title>stage4_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2758.19,-12972.96 2477.19,-12972.96 2477.19,-12920.96 2758.19,-12920.96 2758.19,-12972.96"/>
<text text-anchor="middle" x="2617.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2617.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="2617.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2617.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert2_tp1&#45;&gt;stage4_layer1_expert2_act -->
<g id="edge1087" class="edge">
<title>stage4_layer1_expert2_tp1&#45;&gt;stage4_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2670.89,-13009.25C2662.85,-12999.98 2654.22,-12990.04 2646.3,-12980.92"/>
<polygon fill="black" stroke="black" points="2648.75,-12978.4 2639.55,-12973.15 2643.46,-12982.99 2648.75,-12978.4"/>
</g>
<!-- stage4_layer1_expert2_mlp2 -->
<g id="node834" class="node">
<title>stage4_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2741.69,-12884.96 2419.69,-12884.96 2419.69,-12832.96 2741.69,-12832.96 2741.69,-12884.96"/>
<text text-anchor="middle" x="2580.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2580.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2580.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2580.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert2_act&#45;&gt;stage4_layer1_expert2_mlp2 -->
<g id="edge1088" class="edge">
<title>stage4_layer1_expert2_act&#45;&gt;stage4_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2606.79,-12920.62C2603.25,-12912.4 2599.26,-12903.13 2595.49,-12894.36"/>
<polygon fill="black" stroke="black" points="2598.68,-12892.92 2591.51,-12885.12 2592.25,-12895.69 2598.68,-12892.92"/>
</g>
<!-- stage4_layer1_expert2_tp2 -->
<g id="node835" class="node">
<title>stage4_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2543.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2543.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2543.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 516&#45;517</text>
<text text-anchor="middle" x="2543.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2543.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert2_mlp2&#45;&gt;stage4_layer1_expert2_tp2 -->
<g id="edge1089" class="edge">
<title>stage4_layer1_expert2_mlp2&#45;&gt;stage4_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2571.06,-12832.79C2568.01,-12824.81 2564.54,-12815.73 2561.12,-12806.77"/>
<polygon fill="black" stroke="black" points="2564.28,-12805.26 2557.44,-12797.17 2557.75,-12807.76 2564.28,-12805.26"/>
</g>
<!-- stage4_layer1_expert2_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1135" class="edge">
<title>stage4_layer1_expert2_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2702.18,-12733.75C2728.05,-12730.01 2754.59,-12726.41 2779.69,-12723.42 3039.52,-12692.45 3332.5,-12666.87 3561.9,-12648.95"/>
<polygon fill="black" stroke="black" points="3562.39,-12652.42 3572.09,-12648.16 3561.84,-12645.44 3562.39,-12652.42"/>
</g>
<!-- stage4_layer1_expert3_mlp1 -->
<g id="node837" class="node">
<title>stage4_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3320.69,-13170.5 3006.69,-13170.5 3006.69,-13118.5 3320.69,-13118.5 3320.69,-13170.5"/>
<text text-anchor="middle" x="3163.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3163.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3163.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3163.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert3&#45;&gt;stage4_layer1_expert3_mlp1 -->
<g id="edge1091" class="edge">
<title>stage4_layer1_expert3&#45;&gt;stage4_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3218.71,-13206.16C3210.77,-13197.41 3201.77,-13187.48 3193.37,-13178.23"/>
<polygon fill="black" stroke="black" points="3195.82,-13175.71 3186.5,-13170.66 3190.63,-13180.41 3195.82,-13175.71"/>
</g>
<!-- stage4_layer1_expert3_tp1 -->
<g id="node838" class="node">
<title>stage4_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="3125.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3125.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="3125.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="3125.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3125.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert3_mlp1&#45;&gt;stage4_layer1_expert3_tp1 -->
<g id="edge1092" class="edge">
<title>stage4_layer1_expert3_mlp1&#45;&gt;stage4_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M3153.8,-13118.33C3150.64,-13110.26 3147.03,-13101.07 3143.48,-13092.03"/>
<polygon fill="black" stroke="black" points="3146.73,-13090.73 3139.82,-13082.71 3140.21,-13093.29 3146.73,-13090.73"/>
</g>
<!-- stage4_layer1_expert3_act -->
<g id="node839" class="node">
<title>stage4_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3208.19,-12972.96 2927.19,-12972.96 2927.19,-12920.96 3208.19,-12920.96 3208.19,-12972.96"/>
<text text-anchor="middle" x="3067.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="3067.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="3067.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3067.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert3_tp1&#45;&gt;stage4_layer1_expert3_act -->
<g id="edge1093" class="edge">
<title>stage4_layer1_expert3_tp1&#45;&gt;stage4_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M3104.26,-13008.97C3098.94,-13000.1 3093.26,-12990.62 3088,-12981.84"/>
<polygon fill="black" stroke="black" points="3090.84,-12979.78 3082.7,-12973 3084.84,-12983.38 3090.84,-12979.78"/>
</g>
<!-- stage4_layer1_expert3_mlp2 -->
<g id="node840" class="node">
<title>stage4_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3203.69,-12884.96 2881.69,-12884.96 2881.69,-12832.96 3203.69,-12832.96 3203.69,-12884.96"/>
<text text-anchor="middle" x="3042.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="3042.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3042.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3042.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert3_act&#45;&gt;stage4_layer1_expert3_mlp2 -->
<g id="edge1094" class="edge">
<title>stage4_layer1_expert3_act&#45;&gt;stage4_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M3060.32,-12920.62C3057.98,-12912.57 3055.35,-12903.53 3052.85,-12894.92"/>
<polygon fill="black" stroke="black" points="3056.15,-12893.74 3050,-12885.12 3049.43,-12895.7 3056.15,-12893.74"/>
</g>
<!-- stage4_layer1_expert3_tp2 -->
<g id="node841" class="node">
<title>stage4_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="3016.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3016.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3016.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 518&#45;519</text>
<text text-anchor="middle" x="3016.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3016.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert3_mlp2&#45;&gt;stage4_layer1_expert3_tp2 -->
<g id="edge1095" class="edge">
<title>stage4_layer1_expert3_mlp2&#45;&gt;stage4_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M3035.93,-12832.79C3033.8,-12824.89 3031.39,-12815.92 3029.01,-12807.06"/>
<polygon fill="black" stroke="black" points="3032.33,-12805.92 3026.35,-12797.17 3025.57,-12807.73 3032.33,-12805.92"/>
</g>
<!-- stage4_layer1_expert3_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1136" class="edge">
<title>stage4_layer1_expert3_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3179.17,-12734.43C3203.8,-12730.71 3228.91,-12726.95 3252.69,-12723.42 3365.56,-12706.68 3488.57,-12688.73 3600.01,-12672.58"/>
<polygon fill="black" stroke="black" points="3600.67,-12676.02 3610.06,-12671.12 3599.67,-12669.09 3600.67,-12676.02"/>
</g>
<!-- stage4_layer1_expert31_mlp1 -->
<g id="node843" class="node">
<title>stage4_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3727.69,-13170.5 3413.69,-13170.5 3413.69,-13118.5 3727.69,-13118.5 3727.69,-13170.5"/>
<text text-anchor="middle" x="3570.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3570.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3570.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3570.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert31&#45;&gt;stage4_layer1_expert31_mlp1 -->
<g id="edge1097" class="edge">
<title>stage4_layer1_expert31&#45;&gt;stage4_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3597.49,-13206.16C3593.86,-13197.94 3589.76,-13188.67 3585.89,-13179.9"/>
<polygon fill="black" stroke="black" points="3589.05,-13178.39 3581.8,-13170.66 3582.64,-13181.22 3589.05,-13178.39"/>
</g>
<!-- stage4_layer1_expert31_tp1 -->
<g id="node844" class="node">
<title>stage4_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3545.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3545.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3545.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="3545.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3545.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert31_mlp1&#45;&gt;stage4_layer1_expert31_tp1 -->
<g id="edge1098" class="edge">
<title>stage4_layer1_expert31_mlp1&#45;&gt;stage4_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3564.19,-13118.33C3562.15,-13110.43 3559.83,-13101.46 3557.54,-13092.6"/>
<polygon fill="black" stroke="black" points="3560.87,-13091.51 3554.98,-13082.71 3554.1,-13093.26 3560.87,-13091.51"/>
</g>
<!-- stage4_layer1_expert31_act -->
<g id="node845" class="node">
<title>stage4_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3672.19,-12972.96 3391.19,-12972.96 3391.19,-12920.96 3672.19,-12920.96 3672.19,-12972.96"/>
<text text-anchor="middle" x="3531.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3531.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="3531.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3531.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert31_tp1&#45;&gt;stage4_layer1_expert31_act -->
<g id="edge1099" class="edge">
<title>stage4_layer1_expert31_tp1&#45;&gt;stage4_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3540.52,-13008.97C3539.29,-13000.47 3537.98,-12991.42 3536.75,-12982.95"/>
<polygon fill="black" stroke="black" points="3540.21,-12982.4 3535.31,-12973 3533.28,-12983.4 3540.21,-12982.4"/>
</g>
<!-- stage4_layer1_expert31_mlp2 -->
<g id="node846" class="node">
<title>stage4_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3678.69,-12884.96 3356.69,-12884.96 3356.69,-12832.96 3678.69,-12832.96 3678.69,-12884.96"/>
<text text-anchor="middle" x="3517.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3517.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3517.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3517.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert31_act&#45;&gt;stage4_layer1_expert31_mlp2 -->
<g id="edge1100" class="edge">
<title>stage4_layer1_expert31_act&#45;&gt;stage4_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3527.56,-12920.62C3526.27,-12912.66 3524.81,-12903.72 3523.43,-12895.2"/>
<polygon fill="black" stroke="black" points="3526.85,-12894.42 3521.78,-12885.12 3519.94,-12895.55 3526.85,-12894.42"/>
</g>
<!-- stage4_layer1_expert31_tp2 -->
<g id="node847" class="node">
<title>stage4_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3489.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3489.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3489.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 574&#45;575</text>
<text text-anchor="middle" x="3489.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3489.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert31_mlp2&#45;&gt;stage4_layer1_expert31_tp2 -->
<g id="edge1101" class="edge">
<title>stage4_layer1_expert31_mlp2&#45;&gt;stage4_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3510.4,-12832.79C3508.1,-12824.81 3505.47,-12815.73 3502.88,-12806.77"/>
<polygon fill="black" stroke="black" points="3506.24,-12805.8 3500.1,-12797.17 3499.52,-12807.75 3506.24,-12805.8"/>
</g>
<!-- stage4_layer1_expert31_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1137" class="edge">
<title>stage4_layer1_expert31_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3597.02,-12727.7C3635.11,-12716.53 3679.65,-12703.46 3724.28,-12690.37"/>
<polygon fill="black" stroke="black" points="3725.49,-12693.66 3734.1,-12687.48 3723.52,-12686.94 3725.49,-12693.66"/>
</g>
<!-- stage4_layer1_expert32_mlp1 -->
<g id="node849" class="node">
<title>stage4_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="4119.69,-13170.5 3805.69,-13170.5 3805.69,-13118.5 4119.69,-13118.5 4119.69,-13170.5"/>
<text text-anchor="middle" x="3962.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3962.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3962.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert32&#45;&gt;stage4_layer1_expert32_mlp1 -->
<g id="edge1103" class="edge">
<title>stage4_layer1_expert32&#45;&gt;stage4_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3962.69,-13206.16C3962.69,-13198.2 3962.69,-13189.26 3962.69,-13180.74"/>
<polygon fill="black" stroke="black" points="3966.19,-13180.66 3962.69,-13170.66 3959.19,-13180.66 3966.19,-13180.66"/>
</g>
<!-- stage4_layer1_expert32_tp1 -->
<g id="node850" class="node">
<title>stage4_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3962.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3962.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="3962.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3962.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert32_mlp1&#45;&gt;stage4_layer1_expert32_tp1 -->
<g id="edge1104" class="edge">
<title>stage4_layer1_expert32_mlp1&#45;&gt;stage4_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3962.69,-13118.33C3962.69,-13110.52 3962.69,-13101.65 3962.69,-13092.88"/>
<polygon fill="black" stroke="black" points="3966.19,-13092.71 3962.69,-13082.71 3959.19,-13092.71 3966.19,-13092.71"/>
</g>
<!-- stage4_layer1_expert32_act -->
<g id="node851" class="node">
<title>stage4_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="4103.19,-12972.96 3822.19,-12972.96 3822.19,-12920.96 4103.19,-12920.96 4103.19,-12972.96"/>
<text text-anchor="middle" x="3962.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3962.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="3962.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3962.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert32_tp1&#45;&gt;stage4_layer1_expert32_act -->
<g id="edge1105" class="edge">
<title>stage4_layer1_expert32_tp1&#45;&gt;stage4_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3962.69,-13008.7C3962.69,-13000.38 3962.69,-12991.55 3962.69,-12983.27"/>
<polygon fill="black" stroke="black" points="3966.19,-12983.16 3962.69,-12973.16 3959.19,-12983.16 3966.19,-12983.16"/>
</g>
<!-- stage4_layer1_expert32_mlp2 -->
<g id="node852" class="node">
<title>stage4_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="4123.69,-12884.96 3801.69,-12884.96 3801.69,-12832.96 4123.69,-12832.96 4123.69,-12884.96"/>
<text text-anchor="middle" x="3962.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3962.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3962.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3962.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert32_act&#45;&gt;stage4_layer1_expert32_mlp2 -->
<g id="edge1106" class="edge">
<title>stage4_layer1_expert32_act&#45;&gt;stage4_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3962.69,-12920.62C3962.69,-12912.66 3962.69,-12903.72 3962.69,-12895.2"/>
<polygon fill="black" stroke="black" points="3966.19,-12895.12 3962.69,-12885.12 3959.19,-12895.12 3966.19,-12895.12"/>
</g>
<!-- stage4_layer1_expert32_tp2 -->
<g id="node853" class="node">
<title>stage4_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3962.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3962.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 576&#45;577</text>
<text text-anchor="middle" x="3962.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert32_mlp2&#45;&gt;stage4_layer1_expert32_tp2 -->
<g id="edge1107" class="edge">
<title>stage4_layer1_expert32_mlp2&#45;&gt;stage4_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3962.69,-12832.79C3962.69,-12824.98 3962.69,-12816.11 3962.69,-12807.35"/>
<polygon fill="black" stroke="black" points="3966.19,-12807.17 3962.69,-12797.17 3959.19,-12807.17 3966.19,-12807.17"/>
</g>
<!-- stage4_layer1_expert32_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1138" class="edge">
<title>stage4_layer1_expert32_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3962.69,-12723.09C3962.69,-12715.16 3962.69,-12706.46 3962.69,-12697.59"/>
<polygon fill="black" stroke="black" points="3966.19,-12697.54 3962.69,-12687.54 3959.19,-12697.54 3966.19,-12697.54"/>
</g>
<!-- stage4_layer1_expert60_mlp1 -->
<g id="node855" class="node">
<title>stage4_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4545.69,-13170.5 4231.69,-13170.5 4231.69,-13118.5 4545.69,-13118.5 4545.69,-13170.5"/>
<text text-anchor="middle" x="4388.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4388.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4388.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4388.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert60&#45;&gt;stage4_layer1_expert60_mlp1 -->
<g id="edge1109" class="edge">
<title>stage4_layer1_expert60&#45;&gt;stage4_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4358.36,-13206.16C4362.51,-13197.85 4367.2,-13188.47 4371.63,-13179.62"/>
<polygon fill="black" stroke="black" points="4374.77,-13181.17 4376.11,-13170.66 4368.51,-13178.03 4374.77,-13181.17"/>
</g>
<!-- stage4_layer1_expert60_tp1 -->
<g id="node856" class="node">
<title>stage4_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4391.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4391.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4391.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="4391.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4391.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert60_mlp1&#45;&gt;stage4_layer1_expert60_tp1 -->
<g id="edge1110" class="edge">
<title>stage4_layer1_expert60_mlp1&#45;&gt;stage4_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4389.47,-13118.33C4389.71,-13110.52 4389.99,-13101.65 4390.26,-13092.88"/>
<polygon fill="black" stroke="black" points="4393.76,-13092.81 4390.57,-13082.71 4386.76,-13092.59 4393.76,-13092.81"/>
</g>
<!-- stage4_layer1_expert60_act -->
<g id="node857" class="node">
<title>stage4_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4540.19,-12972.96 4259.19,-12972.96 4259.19,-12920.96 4540.19,-12920.96 4540.19,-12972.96"/>
<text text-anchor="middle" x="4399.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4399.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="4399.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4399.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert60_tp1&#45;&gt;stage4_layer1_expert60_act -->
<g id="edge1111" class="edge">
<title>stage4_layer1_expert60_tp1&#45;&gt;stage4_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4394.67,-13008.7C4395.35,-13000.38 4396.08,-12991.55 4396.77,-12983.27"/>
<polygon fill="black" stroke="black" points="4400.27,-12983.41 4397.61,-12973.16 4393.29,-12982.83 4400.27,-12983.41"/>
</g>
<!-- stage4_layer1_expert60_mlp2 -->
<g id="node858" class="node">
<title>stage4_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4589.69,-12884.96 4267.69,-12884.96 4267.69,-12832.96 4589.69,-12832.96 4589.69,-12884.96"/>
<text text-anchor="middle" x="4428.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4428.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4428.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4428.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert60_act&#45;&gt;stage4_layer1_expert60_mlp2 -->
<g id="edge1112" class="edge">
<title>stage4_layer1_expert60_act&#45;&gt;stage4_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4408.23,-12920.62C4410.98,-12912.49 4414.06,-12903.33 4416.99,-12894.64"/>
<polygon fill="black" stroke="black" points="4420.33,-12895.71 4420.21,-12885.12 4413.69,-12893.47 4420.33,-12895.71"/>
</g>
<!-- stage4_layer1_expert60_tp2 -->
<g id="node859" class="node">
<title>stage4_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4435.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4435.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4435.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 632&#45;633</text>
<text text-anchor="middle" x="4435.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4435.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert60_mlp2&#45;&gt;stage4_layer1_expert60_tp2 -->
<g id="edge1113" class="edge">
<title>stage4_layer1_expert60_mlp2&#45;&gt;stage4_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4430.51,-12832.79C4431.07,-12824.98 4431.72,-12816.11 4432.35,-12807.35"/>
<polygon fill="black" stroke="black" points="4435.86,-12807.39 4433.09,-12797.17 4428.87,-12806.89 4435.86,-12807.39"/>
</g>
<!-- stage4_layer1_expert60_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1139" class="edge">
<title>stage4_layer1_expert60_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4328.36,-12727.7C4290.27,-12716.53 4245.73,-12703.46 4201.1,-12690.37"/>
<polygon fill="black" stroke="black" points="4201.86,-12686.94 4191.28,-12687.48 4199.89,-12693.66 4201.86,-12686.94"/>
</g>
<!-- stage4_layer1_expert61_mlp1 -->
<g id="node861" class="node">
<title>stage4_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4889.69,-13170.5 4575.69,-13170.5 4575.69,-13118.5 4889.69,-13118.5 4889.69,-13170.5"/>
<text text-anchor="middle" x="4732.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4732.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4732.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4732.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert61&#45;&gt;stage4_layer1_expert61_mlp1 -->
<g id="edge1115" class="edge">
<title>stage4_layer1_expert61&#45;&gt;stage4_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4714.35,-13206.16C4716.78,-13198.11 4719.52,-13189.07 4722.12,-13180.46"/>
<polygon fill="black" stroke="black" points="4725.54,-13181.24 4725.08,-13170.66 4718.84,-13179.21 4725.54,-13181.24"/>
</g>
<!-- stage4_layer1_expert61_tp1 -->
<g id="node862" class="node">
<title>stage4_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4818.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4818.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4818.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="4818.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4818.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert61_mlp1&#45;&gt;stage4_layer1_expert61_tp1 -->
<g id="edge1116" class="edge">
<title>stage4_layer1_expert61_mlp1&#45;&gt;stage4_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4755.06,-13118.33C4762.76,-13109.67 4771.61,-13099.7 4780.22,-13090.02"/>
<polygon fill="black" stroke="black" points="4783.01,-13092.14 4787.04,-13082.34 4777.78,-13087.49 4783.01,-13092.14"/>
</g>
<!-- stage4_layer1_expert61_act -->
<g id="node863" class="node">
<title>stage4_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="5026.19,-12972.96 4745.19,-12972.96 4745.19,-12920.96 5026.19,-12920.96 5026.19,-12972.96"/>
<text text-anchor="middle" x="4885.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4885.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="4885.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4885.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert61_tp1&#45;&gt;stage4_layer1_expert61_act -->
<g id="edge1117" class="edge">
<title>stage4_layer1_expert61_tp1&#45;&gt;stage4_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4843.45,-13008.97C4849.72,-12999.91 4856.43,-12990.22 4862.61,-12981.29"/>
<polygon fill="black" stroke="black" points="4865.53,-12983.22 4868.35,-12973 4859.78,-12979.23 4865.53,-12983.22"/>
</g>
<!-- stage4_layer1_expert61_mlp2 -->
<g id="node864" class="node">
<title>stage4_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="5065.69,-12884.96 4743.69,-12884.96 4743.69,-12832.96 5065.69,-12832.96 5065.69,-12884.96"/>
<text text-anchor="middle" x="4904.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4904.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4904.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4904.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert61_act&#45;&gt;stage4_layer1_expert61_mlp2 -->
<g id="edge1118" class="edge">
<title>stage4_layer1_expert61_act&#45;&gt;stage4_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4891.29,-12920.62C4893.06,-12912.57 4895.06,-12903.53 4896.96,-12894.92"/>
<polygon fill="black" stroke="black" points="4900.39,-12895.64 4899.13,-12885.12 4893.56,-12894.13 4900.39,-12895.64"/>
</g>
<!-- stage4_layer1_expert61_tp2 -->
<g id="node865" class="node">
<title>stage4_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4908.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4908.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4908.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 634&#45;635</text>
<text text-anchor="middle" x="4908.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4908.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert61_mlp2&#45;&gt;stage4_layer1_expert61_tp2 -->
<g id="edge1119" class="edge">
<title>stage4_layer1_expert61_mlp2&#45;&gt;stage4_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4905.73,-12832.79C4906.05,-12824.98 4906.42,-12816.11 4906.78,-12807.35"/>
<polygon fill="black" stroke="black" points="4910.29,-12807.3 4907.2,-12797.17 4903.29,-12807.01 4910.29,-12807.3"/>
</g>
<!-- stage4_layer1_expert61_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1140" class="edge">
<title>stage4_layer1_expert61_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4746.21,-12734.43C4721.58,-12730.71 4696.46,-12726.95 4672.69,-12723.42 4596.78,-12712.16 4516.27,-12700.36 4437.79,-12688.92"/>
<polygon fill="black" stroke="black" points="4438.13,-12685.43 4427.73,-12687.45 4437.13,-12692.36 4438.13,-12685.43"/>
</g>
<!-- stage4_layer1_expert62_mlp1 -->
<g id="node867" class="node">
<title>stage4_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5227.69,-13170.5 4913.69,-13170.5 4913.69,-13118.5 5227.69,-13118.5 5227.69,-13170.5"/>
<text text-anchor="middle" x="5070.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="5070.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5070.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5070.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert62&#45;&gt;stage4_layer1_expert62_mlp1 -->
<g id="edge1121" class="edge">
<title>stage4_layer1_expert62&#45;&gt;stage4_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M5061.52,-13206.16C5062.72,-13198.2 5064.07,-13189.26 5065.36,-13180.74"/>
<polygon fill="black" stroke="black" points="5068.85,-13181.07 5066.89,-13170.66 5061.93,-13180.02 5068.85,-13181.07"/>
</g>
<!-- stage4_layer1_expert62_tp1 -->
<g id="node868" class="node">
<title>stage4_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5239.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5239.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5239.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="5239.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5239.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert62_mlp1&#45;&gt;stage4_layer1_expert62_tp1 -->
<g id="edge1122" class="edge">
<title>stage4_layer1_expert62_mlp1&#45;&gt;stage4_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5114.65,-13118.33C5131.95,-13108.42 5152.22,-13096.81 5171.35,-13085.86"/>
<polygon fill="black" stroke="black" points="5173.1,-13088.89 5180.04,-13080.88 5169.62,-13082.81 5173.1,-13088.89"/>
</g>
<!-- stage4_layer1_expert62_act -->
<g id="node869" class="node">
<title>stage4_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5383.19,-12972.96 5102.19,-12972.96 5102.19,-12920.96 5383.19,-12920.96 5383.19,-12972.96"/>
<text text-anchor="middle" x="5242.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5242.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="5242.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5242.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert62_tp1&#45;&gt;stage4_layer1_expert62_act -->
<g id="edge1123" class="edge">
<title>stage4_layer1_expert62_tp1&#45;&gt;stage4_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5240.81,-13008.7C5241.06,-13000.38 5241.34,-12991.55 5241.59,-12983.27"/>
<polygon fill="black" stroke="black" points="5245.1,-12983.26 5241.91,-12973.16 5238.1,-12983.04 5245.1,-12983.26"/>
</g>
<!-- stage4_layer1_expert62_mlp2 -->
<g id="node870" class="node">
<title>stage4_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5442.69,-12884.96 5120.69,-12884.96 5120.69,-12832.96 5442.69,-12832.96 5442.69,-12884.96"/>
<text text-anchor="middle" x="5281.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5281.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5281.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5281.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert62_act&#45;&gt;stage4_layer1_expert62_mlp2 -->
<g id="edge1124" class="edge">
<title>stage4_layer1_expert62_act&#45;&gt;stage4_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5254.18,-12920.62C5257.91,-12912.4 5262.11,-12903.13 5266.09,-12894.36"/>
<polygon fill="black" stroke="black" points="5269.34,-12895.67 5270.28,-12885.12 5262.96,-12892.78 5269.34,-12895.67"/>
</g>
<!-- stage4_layer1_expert62_tp2 -->
<g id="node871" class="node">
<title>stage4_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5381.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5381.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5381.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 636&#45;637</text>
<text text-anchor="middle" x="5381.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5381.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert62_mlp2&#45;&gt;stage4_layer1_expert62_tp2 -->
<g id="edge1125" class="edge">
<title>stage4_layer1_expert62_mlp2&#45;&gt;stage4_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5307.7,-12832.79C5316.83,-12823.96 5327.35,-12813.77 5337.55,-12803.9"/>
<polygon fill="black" stroke="black" points="5340.14,-12806.27 5344.89,-12796.8 5335.27,-12801.24 5340.14,-12806.27"/>
</g>
<!-- stage4_layer1_expert62_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1141" class="edge">
<title>stage4_layer1_expert62_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5223.19,-12733.75C5197.33,-12730.01 5170.79,-12726.41 5145.69,-12723.42 4925.65,-12697.19 4681.82,-12674.83 4472.99,-12657.71"/>
<polygon fill="black" stroke="black" points="4473,-12654.2 4462.75,-12656.88 4472.43,-12661.18 4473,-12654.2"/>
</g>
<!-- stage4_layer1_expert63_mlp1 -->
<g id="node873" class="node">
<title>stage4_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5562.69,-13170.5 5248.69,-13170.5 5248.69,-13118.5 5562.69,-13118.5 5562.69,-13170.5"/>
<text text-anchor="middle" x="5405.69" y="-13158.5" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5405.69" y="-13147.5" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5405.69" y="-13136.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5405.69" y="-13125.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage4_layer1_expert63&#45;&gt;stage4_layer1_expert63_mlp1 -->
<g id="edge1127" class="edge">
<title>stage4_layer1_expert63&#45;&gt;stage4_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5403.57,-13206.16C5403.85,-13198.2 5404.16,-13189.26 5404.46,-13180.74"/>
<polygon fill="black" stroke="black" points="5407.96,-13180.77 5404.81,-13170.66 5400.96,-13180.53 5407.96,-13180.77"/>
</g>
<!-- stage4_layer1_expert63_tp1 -->
<g id="node874" class="node">
<title>stage4_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5696.69" cy="-13045.73" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5696.69" y="-13059.73" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5696.69" y="-13048.73" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="5696.69" y="-13037.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5696.69" y="-13026.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert63_mlp1&#45;&gt;stage4_layer1_expert63_tp1 -->
<g id="edge1128" class="edge">
<title>stage4_layer1_expert63_mlp1&#45;&gt;stage4_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5481.01,-13118.45C5514.94,-13107.17 5555.57,-13093.66 5592.37,-13081.42"/>
<polygon fill="black" stroke="black" points="5593.75,-13084.65 5602.13,-13078.17 5591.54,-13078.01 5593.75,-13084.65"/>
</g>
<!-- stage4_layer1_expert63_act -->
<g id="node875" class="node">
<title>stage4_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5858.19,-12972.96 5577.19,-12972.96 5577.19,-12920.96 5858.19,-12920.96 5858.19,-12972.96"/>
<text text-anchor="middle" x="5717.69" y="-12960.96" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5717.69" y="-12949.96" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="5717.69" y="-12938.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5717.69" y="-12927.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage4_layer1_expert63_tp1&#45;&gt;stage4_layer1_expert63_act -->
<g id="edge1129" class="edge">
<title>stage4_layer1_expert63_tp1&#45;&gt;stage4_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5704.45,-13008.97C5706.29,-13000.47 5708.26,-12991.42 5710.09,-12982.95"/>
<polygon fill="black" stroke="black" points="5713.55,-12983.52 5712.25,-12973 5706.71,-12982.03 5713.55,-12983.52"/>
</g>
<!-- stage4_layer1_expert63_mlp2 -->
<g id="node876" class="node">
<title>stage4_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5994.69,-12884.96 5672.69,-12884.96 5672.69,-12832.96 5994.69,-12832.96 5994.69,-12884.96"/>
<text text-anchor="middle" x="5833.69" y="-12872.96" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5833.69" y="-12861.96" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5833.69" y="-12850.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5833.69" y="-12839.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert63_act&#45;&gt;stage4_layer1_expert63_mlp2 -->
<g id="edge1130" class="edge">
<title>stage4_layer1_expert63_act&#45;&gt;stage4_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5751.55,-12920.85C5763.95,-12911.66 5778.14,-12901.14 5791.2,-12891.46"/>
<polygon fill="black" stroke="black" points="5793.63,-12894.01 5799.58,-12885.25 5789.46,-12888.39 5793.63,-12894.01"/>
</g>
<!-- stage4_layer1_expert63_tp2 -->
<g id="node877" class="node">
<title>stage4_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5854.69" cy="-12760.19" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5854.69" y="-12774.19" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5854.69" y="-12763.19" font-family="Times,serif" font-size="10.00">GPU: 638&#45;639</text>
<text text-anchor="middle" x="5854.69" y="-12752.19" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5854.69" y="-12741.19" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert63_mlp2&#45;&gt;stage4_layer1_expert63_tp2 -->
<g id="edge1131" class="edge">
<title>stage4_layer1_expert63_mlp2&#45;&gt;stage4_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5839.15,-12832.79C5840.86,-12824.89 5842.81,-12815.92 5844.73,-12807.06"/>
<polygon fill="black" stroke="black" points="5848.18,-12807.68 5846.88,-12797.17 5841.34,-12806.2 5848.18,-12807.68"/>
</g>
<!-- stage4_layer1_expert63_tp2&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1142" class="edge">
<title>stage4_layer1_expert63_tp2&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5698.16,-12733.48C5671.69,-12729.71 5644.44,-12726.17 5618.69,-12723.42 5223.75,-12681.29 4773.84,-12654.66 4442.75,-12639.06"/>
<polygon fill="black" stroke="black" points="4442.65,-12635.55 4432.49,-12638.58 4442.32,-12642.55 4442.65,-12635.55"/>
</g>
<!-- stage4_layer1_expert_ellipsis&#45;&gt;stage4_layer1_expert_agg -->
<g id="edge1143" class="edge">
<title>stage4_layer1_expert_ellipsis&#45;&gt;stage4_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6002.67,-13118.4C6045.01,-13084.81 6110.69,-13020.93 6110.69,-12947.96 6110.69,-12947.96 6110.69,-12947.96 6110.69,-12857.96 6110.69,-12797.57 6136.31,-12764.11 6091.69,-12723.42 6031.07,-12668.13 5032.4,-12640.01 4424.67,-12627.95"/>
<polygon fill="black" stroke="black" points="4424.48,-12624.45 4414.41,-12627.75 4424.34,-12631.45 4424.48,-12624.45"/>
</g>
<!-- stage4_layer1_output -->
<g id="node880" class="node">
<title>stage4_layer1_output</title>
<polygon fill="none" stroke="black" points="4187.69,-12515.42 3737.69,-12515.42 3737.69,-12447.42 4187.69,-12447.42 4187.69,-12515.42"/>
<text text-anchor="middle" x="3962.69" y="-12500.22" font-family="Times,serif" font-size="14.00">Layer 9 Output</text>
<text text-anchor="middle" x="3962.69" y="-12485.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-12470.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12455.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_expert_agg&#45;&gt;stage4_layer1_output -->
<g id="edge1144" class="edge">
<title>stage4_layer1_expert_agg&#45;&gt;stage4_layer1_output</title>
<path fill="none" stroke="black" d="M3962.69,-12551.22C3962.69,-12542.47 3962.69,-12533.7 3962.69,-12525.49"/>
<polygon fill="black" stroke="black" points="3966.19,-12525.44 3962.69,-12515.44 3959.19,-12525.44 3966.19,-12525.44"/>
</g>
<!-- stage4_output -->
<g id="node881" class="node">
<title>stage4_output</title>
<polygon fill="none" stroke="black" points="4429.27,-12411.42 3687.05,-12411.42 3496.11,-12275.42 4238.33,-12275.42 4429.27,-12411.42"/>
<text text-anchor="middle" x="3962.69" y="-12362.22" font-family="Times,serif" font-size="14.00">Stage 4 Output</text>
<text text-anchor="middle" x="3962.69" y="-12347.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 4</text>
<text text-anchor="middle" x="3962.69" y="-12332.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12317.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_layer1_output&#45;&gt;stage4_output -->
<g id="edge1145" class="edge">
<title>stage4_layer1_output&#45;&gt;stage4_output</title>
<path fill="none" stroke="black" d="M3962.69,-12447.15C3962.69,-12439.32 3962.69,-12430.66 3962.69,-12421.77"/>
<polygon fill="black" stroke="black" points="3966.19,-12421.68 3962.69,-12411.68 3959.19,-12421.68 3966.19,-12421.68"/>
</g>
<!-- stage5_input -->
<g id="node882" class="node">
<title>stage5_input</title>
<polygon fill="none" stroke="black" points="4429.27,-12239.42 3687.05,-12239.42 3496.11,-12103.42 4238.33,-12103.42 4429.27,-12239.42"/>
<text text-anchor="middle" x="3962.69" y="-12190.22" font-family="Times,serif" font-size="14.00">Stage 5 Input Router</text>
<text text-anchor="middle" x="3962.69" y="-12175.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3962.69" y="-12160.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12145.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage4_output&#45;&gt;stage5_input -->
<g id="edge1146" class="edge">
<title>stage4_output&#45;&gt;stage5_input</title>
<path fill="none" stroke="black" d="M3962.69,-12275.23C3962.69,-12266.92 3962.69,-12258.37 3962.69,-12249.92"/>
<polygon fill="black" stroke="black" points="3966.19,-12249.68 3962.69,-12239.68 3959.19,-12249.68 3966.19,-12249.68"/>
</g>
<!-- stage5_layer0_ln -->
<g id="node883" class="node">
<title>stage5_layer0_ln</title>
<polygon fill="none" stroke="black" points="4187.69,-12067.42 3737.69,-12067.42 3737.69,-11999.42 4187.69,-11999.42 4187.69,-12067.42"/>
<text text-anchor="middle" x="3962.69" y="-12052.22" font-family="Times,serif" font-size="14.00">Layer 10 LayerNorm</text>
<text text-anchor="middle" x="3962.69" y="-12037.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3962.69" y="-12022.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-12007.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_input&#45;&gt;stage5_layer0_ln -->
<g id="edge1147" class="edge">
<title>stage5_input&#45;&gt;stage5_layer0_ln</title>
<path fill="none" stroke="black" d="M3962.69,-12103.22C3962.69,-12094.47 3962.69,-12085.7 3962.69,-12077.49"/>
<polygon fill="black" stroke="black" points="3966.19,-12077.44 3962.69,-12067.44 3959.19,-12077.44 3966.19,-12077.44"/>
</g>
<!-- stage5_layer0_attn_qkv -->
<g id="node884" class="node">
<title>stage5_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4194.19,-11963.42 3731.19,-11963.42 3731.19,-11895.42 4194.19,-11895.42 4194.19,-11963.42"/>
<text text-anchor="middle" x="3962.69" y="-11948.22" font-family="Times,serif" font-size="14.00">Layer 10 Attention QKV Projection</text>
<text text-anchor="middle" x="3962.69" y="-11933.22" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP: GPU 640&#45;767)</text>
<text text-anchor="middle" x="3962.69" y="-11918.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-11903.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage5_layer0_ln&#45;&gt;stage5_layer0_attn_qkv -->
<g id="edge1148" class="edge">
<title>stage5_layer0_ln&#45;&gt;stage5_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3962.69,-11999.3C3962.69,-11991.2 3962.69,-11982.4 3962.69,-11973.89"/>
<polygon fill="black" stroke="black" points="3966.19,-11973.72 3962.69,-11963.72 3959.19,-11973.72 3966.19,-11973.72"/>
</g>
<!-- stage5_layer0_tp_qkv_comm -->
<g id="node885" class="node">
<title>stage5_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-11811.34" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3962.69" y="-11830.14" font-family="Times,serif" font-size="14.00">Layer 10 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3962.69" y="-11815.14" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP pairs)</text>
<text text-anchor="middle" x="3962.69" y="-11800.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-11785.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage5_layer0_attn_qkv&#45;&gt;stage5_layer0_tp_qkv_comm -->
<g id="edge1149" class="edge">
<title>stage5_layer0_attn_qkv&#45;&gt;stage5_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3962.69,-11895.16C3962.69,-11887.16 3962.69,-11878.4 3962.69,-11869.65"/>
<polygon fill="black" stroke="black" points="3966.19,-11869.45 3962.69,-11859.45 3959.19,-11869.45 3966.19,-11869.45"/>
</g>
<!-- stage5_layer0_attn_head0 -->
<g id="node886" class="node">
<title>stage5_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1771.19,-11727.25 1498.19,-11727.25 1498.19,-11675.25 1771.19,-11675.25 1771.19,-11727.25"/>
<text text-anchor="middle" x="1634.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 0 Attention</text>
<text text-anchor="middle" x="1634.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 0)</text>
<text text-anchor="middle" x="1634.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1634.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head0 -->
<g id="edge1150" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3639.67,-11803.31C3127.05,-11791.28 2148.56,-11764.48 1781.38,-11727.36"/>
<polygon fill="black" stroke="black" points="1781.54,-11723.86 1771.23,-11726.32 1780.82,-11730.82 1781.54,-11723.86"/>
</g>
<!-- stage5_layer0_attn_head1 -->
<g id="node887" class="node">
<title>stage5_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="2062.19,-11727.25 1789.19,-11727.25 1789.19,-11675.25 2062.19,-11675.25 2062.19,-11727.25"/>
<text text-anchor="middle" x="1925.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 1 Attention</text>
<text text-anchor="middle" x="1925.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 1)</text>
<text text-anchor="middle" x="1925.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1925.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head1 -->
<g id="edge1151" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3635.73,-11808.55C3260.12,-11803.6 2625.43,-11786.38 2072.41,-11727.38"/>
<polygon fill="black" stroke="black" points="2072.55,-11723.88 2062.23,-11726.29 2071.8,-11730.84 2072.55,-11723.88"/>
</g>
<!-- stage5_layer0_attn_head2 -->
<g id="node888" class="node">
<title>stage5_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2353.19,-11727.25 2080.19,-11727.25 2080.19,-11675.25 2353.19,-11675.25 2353.19,-11727.25"/>
<text text-anchor="middle" x="2216.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 2 Attention</text>
<text text-anchor="middle" x="2216.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 2)</text>
<text text-anchor="middle" x="2216.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2216.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head2 -->
<g id="edge1152" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3638.26,-11804.8C3316.63,-11796.68 2809.92,-11776.78 2363.44,-11727.4"/>
<polygon fill="black" stroke="black" points="2363.56,-11723.89 2353.24,-11726.26 2362.79,-11730.85 2363.56,-11723.89"/>
</g>
<!-- stage5_layer0_attn_head3 -->
<g id="node889" class="node">
<title>stage5_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2644.19,-11727.25 2371.19,-11727.25 2371.19,-11675.25 2644.19,-11675.25 2644.19,-11727.25"/>
<text text-anchor="middle" x="2507.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 3 Attention</text>
<text text-anchor="middle" x="2507.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 3)</text>
<text text-anchor="middle" x="2507.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2507.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head3 -->
<g id="edge1153" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3644.84,-11799.74C3381.62,-11788.69 2997.78,-11767.36 2654.39,-11727.41"/>
<polygon fill="black" stroke="black" points="2654.58,-11723.9 2644.24,-11726.22 2653.77,-11730.86 2654.58,-11723.9"/>
</g>
<!-- stage5_layer0_attn_head4 -->
<g id="node890" class="node">
<title>stage5_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2935.19,-11727.25 2662.19,-11727.25 2662.19,-11675.25 2935.19,-11675.25 2935.19,-11727.25"/>
<text text-anchor="middle" x="2798.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 4 Attention</text>
<text text-anchor="middle" x="2798.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 4)</text>
<text text-anchor="middle" x="2798.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2798.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head4 -->
<g id="edge1154" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3660.43,-11792.8C3460.07,-11779.46 3191.29,-11758.27 2945.46,-11727.44"/>
<polygon fill="black" stroke="black" points="2945.61,-11723.93 2935.25,-11726.15 2944.73,-11730.87 2945.61,-11723.93"/>
</g>
<!-- stage5_layer0_attn_head5 -->
<g id="node891" class="node">
<title>stage5_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3226.19,-11727.25 2953.19,-11727.25 2953.19,-11675.25 3226.19,-11675.25 3226.19,-11727.25"/>
<text text-anchor="middle" x="3089.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 5 Attention</text>
<text text-anchor="middle" x="3089.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 5)</text>
<text text-anchor="middle" x="3089.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3089.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head5 -->
<g id="edge1155" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3695.12,-11783.5C3560.28,-11769.06 3394.06,-11749.87 3236.62,-11727.5"/>
<polygon fill="black" stroke="black" points="3236.66,-11723.97 3226.27,-11726.03 3235.67,-11730.9 3236.66,-11723.97"/>
</g>
<!-- stage5_layer0_attn_head6 -->
<g id="node892" class="node">
<title>stage5_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3517.19,-11727.25 3244.19,-11727.25 3244.19,-11675.25 3517.19,-11675.25 3517.19,-11727.25"/>
<text text-anchor="middle" x="3380.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 6 Attention</text>
<text text-anchor="middle" x="3380.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 6)</text>
<text text-anchor="middle" x="3380.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3380.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head6 -->
<g id="edge1156" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3762.8,-11773.22C3684.89,-11758.75 3597.29,-11742.48 3525.64,-11729.17"/>
<polygon fill="black" stroke="black" points="3526.1,-11725.7 3515.63,-11727.32 3524.83,-11732.58 3526.1,-11725.7"/>
</g>
<!-- stage5_layer0_attn_head7 -->
<g id="node893" class="node">
<title>stage5_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3808.19,-11727.25 3535.19,-11727.25 3535.19,-11675.25 3808.19,-11675.25 3808.19,-11727.25"/>
<text text-anchor="middle" x="3671.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 7 Attention</text>
<text text-anchor="middle" x="3671.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 7)</text>
<text text-anchor="middle" x="3671.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3671.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head7 -->
<g id="edge1157" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3844.33,-11766.38C3812.09,-11754.4 3778.02,-11741.75 3748.74,-11730.87"/>
<polygon fill="black" stroke="black" points="3749.59,-11727.46 3739,-11727.25 3747.15,-11734.02 3749.59,-11727.46"/>
</g>
<!-- stage5_layer0_attn_ellipsis -->
<g id="node894" class="node">
<title>stage5_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4099.19,-11727.25 3826.19,-11727.25 3826.19,-11675.25 4099.19,-11675.25 4099.19,-11727.25"/>
<text text-anchor="middle" x="3962.69" y="-11715.25" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3962.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3962.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_ellipsis -->
<g id="edge1158" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3962.69,-11763.25C3962.69,-11754.7 3962.69,-11745.92 3962.69,-11737.78"/>
<polygon fill="black" stroke="black" points="3966.19,-11737.52 3962.69,-11727.52 3959.19,-11737.52 3966.19,-11737.52"/>
</g>
<!-- stage5_layer0_attn_head24 -->
<g id="node895" class="node">
<title>stage5_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4390.19,-11727.25 4117.19,-11727.25 4117.19,-11675.25 4390.19,-11675.25 4390.19,-11727.25"/>
<text text-anchor="middle" x="4253.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 24 Attention</text>
<text text-anchor="middle" x="4253.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 24)</text>
<text text-anchor="middle" x="4253.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4253.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head24 -->
<g id="edge1159" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M4081.05,-11766.38C4113.28,-11754.4 4147.36,-11741.75 4176.64,-11730.87"/>
<polygon fill="black" stroke="black" points="4178.22,-11734.02 4186.38,-11727.25 4175.79,-11727.46 4178.22,-11734.02"/>
</g>
<!-- stage5_layer0_attn_head25 -->
<g id="node896" class="node">
<title>stage5_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4681.19,-11727.25 4408.19,-11727.25 4408.19,-11675.25 4681.19,-11675.25 4681.19,-11727.25"/>
<text text-anchor="middle" x="4544.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 25 Attention</text>
<text text-anchor="middle" x="4544.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 25)</text>
<text text-anchor="middle" x="4544.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4544.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head25 -->
<g id="edge1160" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M4162.57,-11773.22C4240.48,-11758.75 4328.09,-11742.48 4399.74,-11729.17"/>
<polygon fill="black" stroke="black" points="4400.55,-11732.58 4409.74,-11727.32 4399.27,-11725.7 4400.55,-11732.58"/>
</g>
<!-- stage5_layer0_attn_head26 -->
<g id="node897" class="node">
<title>stage5_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4972.19,-11727.25 4699.19,-11727.25 4699.19,-11675.25 4972.19,-11675.25 4972.19,-11727.25"/>
<text text-anchor="middle" x="4835.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 26 Attention</text>
<text text-anchor="middle" x="4835.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 26)</text>
<text text-anchor="middle" x="4835.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4835.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head26 -->
<g id="edge1161" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4229.45,-11783.46C4364.31,-11768.97 4530.69,-11749.75 4689.01,-11727.32"/>
<polygon fill="black" stroke="black" points="4689.54,-11730.78 4698.95,-11725.91 4688.55,-11723.85 4689.54,-11730.78"/>
</g>
<!-- stage5_layer0_attn_head27 -->
<g id="node898" class="node">
<title>stage5_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5263.19,-11727.25 4990.19,-11727.25 4990.19,-11675.25 5263.19,-11675.25 5263.19,-11727.25"/>
<text text-anchor="middle" x="5126.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 27 Attention</text>
<text text-anchor="middle" x="5126.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 27)</text>
<text text-anchor="middle" x="5126.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5126.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head27 -->
<g id="edge1162" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4264.64,-11792.7C4464.8,-11779.31 4733.31,-11758.12 4979.73,-11727.33"/>
<polygon fill="black" stroke="black" points="4980.48,-11730.76 4989.96,-11726.04 4979.61,-11723.82 4980.48,-11730.76"/>
</g>
<!-- stage5_layer0_attn_head28 -->
<g id="node899" class="node">
<title>stage5_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5554.19,-11727.25 5281.19,-11727.25 5281.19,-11675.25 5554.19,-11675.25 5554.19,-11727.25"/>
<text text-anchor="middle" x="5417.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 28 Attention</text>
<text text-anchor="middle" x="5417.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 28)</text>
<text text-anchor="middle" x="5417.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5417.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head28 -->
<g id="edge1163" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4280.28,-11799.62C4543.3,-11788.51 4926.83,-11767.14 5270.81,-11727.3"/>
<polygon fill="black" stroke="black" points="5271.45,-11730.75 5280.97,-11726.12 5270.64,-11723.8 5271.45,-11730.75"/>
</g>
<!-- stage5_layer0_attn_head29 -->
<g id="node900" class="node">
<title>stage5_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5845.19,-11727.25 5572.19,-11727.25 5572.19,-11675.25 5845.19,-11675.25 5845.19,-11727.25"/>
<text text-anchor="middle" x="5708.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 29 Attention</text>
<text text-anchor="middle" x="5708.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 29)</text>
<text text-anchor="middle" x="5708.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5708.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head29 -->
<g id="edge1164" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4287.28,-11804.67C4608.72,-11796.45 5114.89,-11776.49 5561.77,-11727.3"/>
<polygon fill="black" stroke="black" points="5562.43,-11730.74 5571.98,-11726.17 5561.66,-11723.79 5562.43,-11730.74"/>
</g>
<!-- stage5_layer0_attn_head30 -->
<g id="node901" class="node">
<title>stage5_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="6136.19,-11727.25 5863.19,-11727.25 5863.19,-11675.25 6136.19,-11675.25 6136.19,-11727.25"/>
<text text-anchor="middle" x="5999.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 30 Attention</text>
<text text-anchor="middle" x="5999.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 30)</text>
<text text-anchor="middle" x="5999.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5999.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head30 -->
<g id="edge1165" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4289.89,-11808.42C4665.34,-11803.35 5299.41,-11786.03 5852.8,-11727.29"/>
<polygon fill="black" stroke="black" points="5853.41,-11730.74 5862.98,-11726.2 5852.67,-11723.78 5853.41,-11730.74"/>
</g>
<!-- stage5_layer0_attn_head31 -->
<g id="node902" class="node">
<title>stage5_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6427.19,-11727.25 6154.19,-11727.25 6154.19,-11675.25 6427.19,-11675.25 6427.19,-11727.25"/>
<text text-anchor="middle" x="6290.69" y="-11715.25" font-family="Times,serif" font-size="10.00">Layer 10 Head 31 Attention</text>
<text text-anchor="middle" x="6290.69" y="-11704.25" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 31)</text>
<text text-anchor="middle" x="6290.69" y="-11693.25" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6290.69" y="-11682.25" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head31 -->
<g id="edge1166" class="edge">
<title>stage5_layer0_tp_qkv_comm&#45;&gt;stage5_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4285.55,-11803.26C4797.93,-11791.16 5775.97,-11764.27 6143.81,-11727.27"/>
<polygon fill="black" stroke="black" points="6144.39,-11730.72 6153.99,-11726.22 6143.68,-11723.76 6144.39,-11730.72"/>
</g>
<!-- stage5_layer0_attn_agg -->
<g id="node903" class="node">
<title>stage5_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4430.34,-11639.25 3686.41,-11639.25 3495.04,-11503.25 4238.97,-11503.25 4430.34,-11639.25"/>
<text text-anchor="middle" x="3962.69" y="-11590.05" font-family="Times,serif" font-size="14.00">Layer 10 Attention Aggregate</text>
<text text-anchor="middle" x="3962.69" y="-11575.05" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3962.69" y="-11560.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3962.69" y="-11545.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_attn_head0&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1167" class="edge">
<title>stage5_layer0_attn_head0&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1771.23,-11676.23C1774.07,-11675.89 1776.9,-11675.56 1779.69,-11675.25 2411.18,-11606.18 3150.43,-11583.4 3586.36,-11575.91"/>
<polygon fill="black" stroke="black" points="3586.67,-11579.4 3596.61,-11575.73 3586.55,-11572.4 3586.67,-11579.4"/>
</g>
<!-- stage5_layer0_attn_head1&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1168" class="edge">
<title>stage5_layer0_attn_head1&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2062.24,-11676.26C2065.08,-11675.9 2067.9,-11675.57 2070.69,-11675.25 2596.99,-11615.76 3209.69,-11590.36 3591.91,-11579.7"/>
<polygon fill="black" stroke="black" points="3592.12,-11583.2 3602.02,-11579.42 3591.93,-11576.2 3592.12,-11583.2"/>
</g>
<!-- stage5_layer0_attn_head2&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1169" class="edge">
<title>stage5_layer0_attn_head2&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2353.24,-11676.29C2356.08,-11675.93 2358.9,-11675.58 2361.69,-11675.25 2784.66,-11625.33 3273.57,-11598.3 3598.72,-11584.62"/>
<polygon fill="black" stroke="black" points="3598.93,-11588.12 3608.77,-11584.2 3598.63,-11581.12 3598.93,-11588.12"/>
</g>
<!-- stage5_layer0_attn_head3&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1170" class="edge">
<title>stage5_layer0_attn_head3&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2644.25,-11676.35C2647.08,-11675.97 2649.9,-11675.6 2652.69,-11675.25 2974.79,-11634.91 3343.56,-11607.59 3607.59,-11591.29"/>
<polygon fill="black" stroke="black" points="3607.96,-11594.77 3617.72,-11590.66 3607.53,-11587.78 3607.96,-11594.77"/>
</g>
<!-- stage5_layer0_attn_head4&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1171" class="edge">
<title>stage5_layer0_attn_head4&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2935.26,-11676.43C2938.09,-11676.03 2940.9,-11675.63 2943.69,-11675.25 3168.59,-11644.54 3422.58,-11618.84 3620.72,-11600.8"/>
<polygon fill="black" stroke="black" points="3621.07,-11604.28 3630.71,-11599.89 3620.43,-11597.31 3621.07,-11604.28"/>
</g>
<!-- stage5_layer0_attn_head5&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1172" class="edge">
<title>stage5_layer0_attn_head5&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3226.28,-11676.59C3229.11,-11676.13 3231.91,-11675.69 3234.69,-11675.25 3367.44,-11654.42 3514.12,-11633.31 3640.83,-11615.66"/>
<polygon fill="black" stroke="black" points="3641.65,-11619.08 3651.08,-11614.24 3640.69,-11612.15 3641.65,-11619.08"/>
</g>
<!-- stage5_layer0_attn_head6&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1173" class="edge">
<title>stage5_layer0_attn_head6&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3494.63,-11675.19C3545.21,-11664.07 3607.29,-11650.42 3669.5,-11636.73"/>
<polygon fill="black" stroke="black" points="3670.47,-11640.1 3679.49,-11634.54 3668.97,-11633.27 3670.47,-11640.1"/>
</g>
<!-- stage5_layer0_attn_head7&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1174" class="edge">
<title>stage5_layer0_attn_head7&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3728.83,-11675.12C3750.01,-11665.81 3775.2,-11654.72 3801.08,-11643.34"/>
<polygon fill="black" stroke="black" points="3802.51,-11646.54 3810.25,-11639.3 3799.69,-11640.13 3802.51,-11646.54"/>
</g>
<!-- stage5_layer0_attn_ellipsis&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1175" class="edge">
<title>stage5_layer0_attn_ellipsis&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3962.69,-11674.97C3962.69,-11667.37 3962.69,-11658.6 3962.69,-11649.47"/>
<polygon fill="black" stroke="black" points="3966.19,-11649.44 3962.69,-11639.44 3959.19,-11649.44 3966.19,-11649.44"/>
</g>
<!-- stage5_layer0_attn_head24&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1176" class="edge">
<title>stage5_layer0_attn_head24&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4196.54,-11675.12C4175.37,-11665.81 4150.18,-11654.72 4124.3,-11643.34"/>
<polygon fill="black" stroke="black" points="4125.69,-11640.13 4115.12,-11639.3 4122.87,-11646.54 4125.69,-11640.13"/>
</g>
<!-- stage5_layer0_attn_head25&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1177" class="edge">
<title>stage5_layer0_attn_head25&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4430.74,-11675.19C4386.03,-11665.36 4332.31,-11653.54 4277.45,-11641.48"/>
<polygon fill="black" stroke="black" points="4278.08,-11638.04 4267.56,-11639.31 4276.58,-11644.87 4278.08,-11638.04"/>
</g>
<!-- stage5_layer0_attn_head26&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1178" class="edge">
<title>stage5_layer0_attn_head26&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4698.93,-11676.71C4695.82,-11676.22 4692.74,-11675.73 4689.69,-11675.25 4607.61,-11662.42 4520.21,-11649.44 4435.51,-11637.23"/>
<polygon fill="black" stroke="black" points="4435.86,-11633.74 4425.46,-11635.78 4434.86,-11640.67 4435.86,-11633.74"/>
</g>
<!-- stage5_layer0_attn_head27&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1179" class="edge">
<title>stage5_layer0_attn_head27&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4989.95,-11676.55C4986.84,-11676.1 4983.75,-11675.67 4980.69,-11675.25 4790.01,-11649.31 4578.43,-11626.88 4397.77,-11609.64"/>
<polygon fill="black" stroke="black" points="4397.84,-11606.13 4387.56,-11608.67 4397.18,-11613.1 4397.84,-11606.13"/>
</g>
<!-- stage5_layer0_attn_head28&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1180" class="edge">
<title>stage5_layer0_attn_head28&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5280.97,-11676.45C5277.85,-11676.04 5274.75,-11675.64 5271.69,-11675.25 4973.68,-11638.09 4635.74,-11611.9 4377.88,-11595.23"/>
<polygon fill="black" stroke="black" points="4377.79,-11591.72 4367.59,-11594.57 4377.34,-11598.71 4377.79,-11591.72"/>
</g>
<!-- stage5_layer0_attn_head29&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1181" class="edge">
<title>stage5_layer0_attn_head29&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5571.97,-11676.4C5568.85,-11676 5565.75,-11675.61 5562.69,-11675.25 5156.71,-11627.56 4689.99,-11600.69 4365.82,-11586.45"/>
<polygon fill="black" stroke="black" points="4365.94,-11582.95 4355.79,-11586.01 4365.63,-11589.95 4365.94,-11582.95"/>
</g>
<!-- stage5_layer0_attn_head30&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1182" class="edge">
<title>stage5_layer0_attn_head30&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5862.98,-11676.35C5859.85,-11675.97 5856.75,-11675.6 5853.69,-11675.25 5338.76,-11617.34 4741.15,-11591.7 4357.82,-11580.54"/>
<polygon fill="black" stroke="black" points="4357.77,-11577.04 4347.67,-11580.25 4357.57,-11584.03 4357.77,-11577.04"/>
</g>
<!-- stage5_layer0_attn_head31&#45;&gt;stage5_layer0_attn_agg -->
<g id="edge1183" class="edge">
<title>stage5_layer0_attn_head31&#45;&gt;stage5_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6153.98,-11676.32C6150.86,-11675.95 6147.76,-11675.59 6144.69,-11675.25 5519.76,-11607.26 4789.31,-11584.13 4351.99,-11576.28"/>
<polygon fill="black" stroke="black" points="4351.77,-11572.78 4341.71,-11576.1 4351.65,-11579.77 4351.77,-11572.78"/>
</g>
<!-- stage5_layer0_attn_out -->
<g id="node904" class="node">
<title>stage5_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="4187.69,-11467.25 3737.69,-11467.25 3737.69,-11399.25 4187.69,-11399.25 4187.69,-11467.25"/>
<text text-anchor="middle" x="3962.69" y="-11452.05" font-family="Times,serif" font-size="14.00">Layer 10 Attention Output Proj</text>
<text text-anchor="middle" x="3962.69" y="-11437.05" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP: GPU 640&#45;767)</text>
<text text-anchor="middle" x="3962.69" y="-11422.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-11407.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_attn_agg&#45;&gt;stage5_layer0_attn_out -->
<g id="edge1184" class="edge">
<title>stage5_layer0_attn_agg&#45;&gt;stage5_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3962.69,-11503.05C3962.69,-11494.3 3962.69,-11485.53 3962.69,-11477.32"/>
<polygon fill="black" stroke="black" points="3966.19,-11477.27 3962.69,-11467.27 3959.19,-11477.27 3966.19,-11477.27"/>
</g>
<!-- stage5_layer0_tp_attn_comm -->
<g id="node905" class="node">
<title>stage5_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3962.69" cy="-11315.17" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3962.69" y="-11333.97" font-family="Times,serif" font-size="14.00">Layer 10 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3962.69" y="-11318.97" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP pairs)</text>
<text text-anchor="middle" x="3962.69" y="-11303.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3962.69" y="-11288.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_attn_out&#45;&gt;stage5_layer0_tp_attn_comm -->
<g id="edge1185" class="edge">
<title>stage5_layer0_attn_out&#45;&gt;stage5_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3962.69,-11398.99C3962.69,-11391 3962.69,-11382.23 3962.69,-11373.49"/>
<polygon fill="black" stroke="black" points="3966.19,-11373.28 3962.69,-11363.28 3959.19,-11373.28 3966.19,-11373.28"/>
</g>
<!-- stage5_layer0_expert_router -->
<g id="node906" class="node">
<title>stage5_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3382.88,-11231.09 2660.36,-11231.09 2474.49,-11095.09 3197.02,-11095.09 3382.88,-11231.09"/>
<text text-anchor="middle" x="2928.69" y="-11181.89" font-family="Times,serif" font-size="14.00">Layer 10 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2928.69" y="-11166.89" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="2928.69" y="-11151.89" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2928.69" y="-11136.89" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage5_layer0_tp_attn_comm&#45;&gt;stage5_layer0_expert_router -->
<g id="edge1186" class="edge">
<title>stage5_layer0_tp_attn_comm&#45;&gt;stage5_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3736.41,-11281.33C3634.81,-11266.58 3511.01,-11248.61 3391.17,-11231.22"/>
<polygon fill="black" stroke="black" points="3391.47,-11227.72 3381.07,-11229.75 3390.47,-11234.65 3391.47,-11227.72"/>
</g>
<!-- stage5_layer0_output -->
<g id="node969" class="node">
<title>stage5_layer0_output</title>
<polygon fill="none" stroke="black" points="3993.69,-10316.01 3543.69,-10316.01 3543.69,-10248.01 3993.69,-10248.01 3993.69,-10316.01"/>
<text text-anchor="middle" x="3768.69" y="-10300.81" font-family="Times,serif" font-size="14.00">Layer 10 Output</text>
<text text-anchor="middle" x="3768.69" y="-10285.81" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-10270.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-10255.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_tp_attn_comm&#45;&gt;stage5_layer0_output -->
<!-- stage5_layer0_expert0 -->
<g id="node907" class="node">
<title>stage5_layer0_expert0</title>
<polygon fill="none" stroke="black" points="1039.69,-11059.09 717.69,-11059.09 717.69,-11007.09 1039.69,-11007.09 1039.69,-11059.09"/>
<text text-anchor="middle" x="878.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 0</text>
<text text-anchor="middle" x="878.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP pair)</text>
<text text-anchor="middle" x="878.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="878.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert0 -->
<g id="edge1187" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2538.98,-11142.42C2182,-11123.65 1639.04,-11093.25 1167.69,-11059.09 1129.65,-11056.33 1088.82,-11053.02 1050.19,-11049.72"/>
<polygon fill="black" stroke="black" points="1050.15,-11046.2 1039.89,-11048.83 1049.55,-11053.18 1050.15,-11046.2"/>
</g>
<!-- stage5_layer0_expert1 -->
<g id="node913" class="node">
<title>stage5_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1498.69,-11059.09 1176.69,-11059.09 1176.69,-11007.09 1498.69,-11007.09 1498.69,-11059.09"/>
<text text-anchor="middle" x="1337.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 1</text>
<text text-anchor="middle" x="1337.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP pair)</text>
<text text-anchor="middle" x="1337.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1337.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert1 -->
<g id="edge1193" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2532.71,-11137.91C2254.58,-11119.67 1874.02,-11092.15 1539.69,-11059.09 1529.63,-11058.09 1519.29,-11057.01 1508.87,-11055.87"/>
<polygon fill="black" stroke="black" points="1509.19,-11052.38 1498.86,-11054.75 1508.41,-11059.34 1509.19,-11052.38"/>
</g>
<!-- stage5_layer0_expert2 -->
<g id="node919" class="node">
<title>stage5_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1870.69,-11059.09 1548.69,-11059.09 1548.69,-11007.09 1870.69,-11007.09 1870.69,-11059.09"/>
<text text-anchor="middle" x="1709.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 2</text>
<text text-anchor="middle" x="1709.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP pair)</text>
<text text-anchor="middle" x="1709.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1709.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert2 -->
<g id="edge1199" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2513.97,-11124.01C2325.18,-11105.83 2098.97,-11082.88 1895.69,-11059.09 1890.84,-11058.52 1885.92,-11057.93 1880.95,-11057.33"/>
<polygon fill="black" stroke="black" points="1881.05,-11053.82 1870.7,-11056.08 1880.2,-11060.77 1881.05,-11053.82"/>
</g>
<!-- stage5_layer0_expert3 -->
<g id="node925" class="node">
<title>stage5_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2226.69,-11059.09 1904.69,-11059.09 1904.69,-11007.09 2226.69,-11007.09 2226.69,-11059.09"/>
<text text-anchor="middle" x="2065.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 3</text>
<text text-anchor="middle" x="2065.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP pair)</text>
<text text-anchor="middle" x="2065.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2065.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert3 -->
<g id="edge1205" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2476.65,-11095.04C2391.18,-11082.37 2306.79,-11069.85 2236.93,-11059.49"/>
<polygon fill="black" stroke="black" points="2237.13,-11055.98 2226.73,-11057.97 2236.11,-11062.9 2237.13,-11055.98"/>
</g>
<!-- stage5_layer0_expert31 -->
<g id="node931" class="node">
<title>stage5_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2574.69,-11059.09 2252.69,-11059.09 2252.69,-11007.09 2574.69,-11007.09 2574.69,-11059.09"/>
<text text-anchor="middle" x="2413.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 31</text>
<text text-anchor="middle" x="2413.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP pair)</text>
<text text-anchor="middle" x="2413.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2413.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert31 -->
<g id="edge1211" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2658.75,-11095C2611.13,-11083.16 2564.09,-11071.47 2524.14,-11061.54"/>
<polygon fill="black" stroke="black" points="2524.96,-11058.14 2514.41,-11059.12 2523.27,-11064.93 2524.96,-11058.14"/>
</g>
<!-- stage5_layer0_expert32 -->
<g id="node937" class="node">
<title>stage5_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2918.69,-11059.09 2596.69,-11059.09 2596.69,-11007.09 2918.69,-11007.09 2918.69,-11059.09"/>
<text text-anchor="middle" x="2757.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 32</text>
<text text-anchor="middle" x="2757.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP pair)</text>
<text text-anchor="middle" x="2757.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2757.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert32 -->
<g id="edge1217" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2838.93,-11094.9C2825.17,-11084.6 2811.56,-11074.41 2799.53,-11065.41"/>
<polygon fill="black" stroke="black" points="2801.57,-11062.56 2791.47,-11059.37 2797.38,-11068.17 2801.57,-11062.56"/>
</g>
<!-- stage5_layer0_expert60 -->
<g id="node943" class="node">
<title>stage5_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3260.69,-11059.09 2938.69,-11059.09 2938.69,-11007.09 3260.69,-11007.09 3260.69,-11059.09"/>
<text text-anchor="middle" x="3099.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 60</text>
<text text-anchor="middle" x="3099.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP pair)</text>
<text text-anchor="middle" x="3099.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3099.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert60 -->
<g id="edge1223" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3018.45,-11094.9C3032.2,-11084.6 3045.81,-11074.41 3057.85,-11065.41"/>
<polygon fill="black" stroke="black" points="3060,-11068.17 3065.91,-11059.37 3055.81,-11062.56 3060,-11068.17"/>
</g>
<!-- stage5_layer0_expert61 -->
<g id="node949" class="node">
<title>stage5_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3601.69,-11059.09 3279.69,-11059.09 3279.69,-11007.09 3601.69,-11007.09 3601.69,-11059.09"/>
<text text-anchor="middle" x="3440.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 61</text>
<text text-anchor="middle" x="3440.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP pair)</text>
<text text-anchor="middle" x="3440.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3440.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert61 -->
<g id="edge1229" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3197.06,-11095C3244.29,-11083.19 3290.97,-11071.52 3330.62,-11061.6"/>
<polygon fill="black" stroke="black" points="3331.7,-11064.94 3340.55,-11059.12 3330,-11058.15 3331.7,-11064.94"/>
</g>
<!-- stage5_layer0_expert62 -->
<g id="node955" class="node">
<title>stage5_layer0_expert62</title>
<polygon fill="none" stroke="black" points="3942.69,-11059.09 3620.69,-11059.09 3620.69,-11007.09 3942.69,-11007.09 3942.69,-11059.09"/>
<text text-anchor="middle" x="3781.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 62</text>
<text text-anchor="middle" x="3781.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP pair)</text>
<text text-anchor="middle" x="3781.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3781.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert62 -->
<g id="edge1235" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3227.63,-11117.23C3355.81,-11097.99 3500.92,-11076.22 3610.48,-11059.78"/>
<polygon fill="black" stroke="black" points="3611.27,-11063.2 3620.64,-11058.26 3610.23,-11056.28 3611.27,-11063.2"/>
</g>
<!-- stage5_layer0_expert63 -->
<g id="node961" class="node">
<title>stage5_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4309.69,-11059.09 3987.69,-11059.09 3987.69,-11007.09 4309.69,-11007.09 4309.69,-11059.09"/>
<text text-anchor="middle" x="4148.69" y="-11047.09" font-family="Times,serif" font-size="10.00">Layer 10 Expert 63</text>
<text text-anchor="middle" x="4148.69" y="-11036.09" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP pair)</text>
<text text-anchor="middle" x="4148.69" y="-11025.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4148.69" y="-11014.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert63 -->
<g id="edge1241" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3247.72,-11132.11C3449.65,-11112.6 3716.13,-11085.89 3951.69,-11059.09 3960.06,-11058.14 3968.63,-11057.14 3977.28,-11056.11"/>
<polygon fill="black" stroke="black" points="3977.95,-11059.55 3987.47,-11054.89 3977.12,-11052.6 3977.95,-11059.55"/>
</g>
<!-- stage5_layer0_expert_ellipsis -->
<g id="node967" class="node">
<title>stage5_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4779.69,-10971.09 4457.69,-10971.09 4457.69,-10919.09 4779.69,-10919.09 4779.69,-10971.09"/>
<text text-anchor="middle" x="4618.69" y="-10959.09" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4618.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4618.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4618.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert_ellipsis -->
<g id="edge1247" class="edge">
<title>stage5_layer0_expert_router&#45;&gt;stage5_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3269.49,-11148C3615.24,-11131.71 4126.1,-11101.57 4318.69,-11059.09 4403.94,-11040.28 4497.35,-11002.1 4556.91,-10975.34"/>
<polygon fill="black" stroke="black" points="4558.51,-10978.46 4566.18,-10971.15 4555.62,-10972.09 4558.51,-10978.46"/>
</g>
<!-- stage5_layer0_expert0_mlp1 -->
<g id="node908" class="node">
<title>stage5_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="982.69,-10971.09 668.69,-10971.09 668.69,-10919.09 982.69,-10919.09 982.69,-10971.09"/>
<text text-anchor="middle" x="825.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="825.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP: Column Parallel)</text>
<text text-anchor="middle" x="825.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="825.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert0&#45;&gt;stage5_layer0_expert0_mlp1 -->
<g id="edge1188" class="edge">
<title>stage5_layer0_expert0&#45;&gt;stage5_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M863.07,-11006.75C857.9,-10998.35 852.05,-10988.87 846.55,-10979.93"/>
<polygon fill="black" stroke="black" points="849.42,-10977.92 841.19,-10971.24 843.46,-10981.59 849.42,-10977.92"/>
</g>
<!-- stage5_layer0_expert0_tp1 -->
<g id="node909" class="node">
<title>stage5_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="521.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="521.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="521.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="521.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="521.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert0_mlp1&#45;&gt;stage5_layer0_expert0_tp1 -->
<g id="edge1189" class="edge">
<title>stage5_layer0_expert0_mlp1&#45;&gt;stage5_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M747.01,-10919.04C711.08,-10907.61 667.97,-10893.88 629.13,-10881.52"/>
<polygon fill="black" stroke="black" points="629.94,-10878.1 619.35,-10878.41 627.82,-10884.77 629.94,-10878.1"/>
</g>
<!-- stage5_layer0_expert0_act -->
<g id="node910" class="node">
<title>stage5_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="575.19,-10773.55 294.19,-10773.55 294.19,-10721.55 575.19,-10721.55 575.19,-10773.55"/>
<text text-anchor="middle" x="434.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="434.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="434.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="434.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert0_tp1&#45;&gt;stage5_layer0_expert0_act -->
<g id="edge1190" class="edge">
<title>stage5_layer0_expert0_tp1&#45;&gt;stage5_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M489.79,-10809.83C481.38,-10800.48 472.34,-10790.43 464.07,-10781.23"/>
<polygon fill="black" stroke="black" points="466.62,-10778.83 457.33,-10773.73 461.41,-10783.51 466.62,-10778.83"/>
</g>
<!-- stage5_layer0_expert0_mlp2 -->
<g id="node911" class="node">
<title>stage5_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="540.69,-10685.55 218.69,-10685.55 218.69,-10633.55 540.69,-10633.55 540.69,-10685.55"/>
<text text-anchor="middle" x="379.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="379.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP: Row Parallel)</text>
<text text-anchor="middle" x="379.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="379.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert0_act&#45;&gt;stage5_layer0_expert0_mlp2 -->
<g id="edge1191" class="edge">
<title>stage5_layer0_expert0_act&#45;&gt;stage5_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M418.48,-10721.21C413.11,-10712.81 407.05,-10703.33 401.33,-10694.39"/>
<polygon fill="black" stroke="black" points="404.11,-10692.24 395.78,-10685.71 398.22,-10696.02 404.11,-10692.24"/>
</g>
<!-- stage5_layer0_expert0_tp2 -->
<g id="node912" class="node">
<title>stage5_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="310.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="310.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="310.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="310.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="310.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert0_mlp2&#45;&gt;stage5_layer0_expert0_tp2 -->
<g id="edge1192" class="edge">
<title>stage5_layer0_expert0_mlp2&#45;&gt;stage5_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M361.74,-10633.38C355.69,-10624.89 348.74,-10615.15 341.97,-10605.64"/>
<polygon fill="black" stroke="black" points="344.74,-10603.5 336.08,-10597.39 339.04,-10607.56 344.74,-10603.5"/>
</g>
<!-- stage5_layer0_expert_agg -->
<g id="node968" class="node">
<title>stage5_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3463.22,-10488.01 2587.45,-10488.01 2362.16,-10352.01 3237.93,-10352.01 3463.22,-10488.01"/>
<text text-anchor="middle" x="2912.69" y="-10438.81" font-family="Times,serif" font-size="14.00">Layer 10 Expert Aggregation</text>
<text text-anchor="middle" x="2912.69" y="-10423.81" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="2912.69" y="-10408.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2912.69" y="-10393.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert0_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1248" class="edge">
<title>stage5_layer0_expert0_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M465.9,-10533.84C492.78,-10530.04 520.5,-10526.56 546.69,-10524.01 1217.12,-10458.8 1998.46,-10434.87 2474.17,-10426.09"/>
<polygon fill="black" stroke="black" points="2474.37,-10429.59 2484.3,-10425.9 2474.24,-10422.59 2474.37,-10429.59"/>
</g>
<!-- stage5_layer0_expert1_mlp1 -->
<g id="node914" class="node">
<title>stage5_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1479.69,-10971.09 1165.69,-10971.09 1165.69,-10919.09 1479.69,-10919.09 1479.69,-10971.09"/>
<text text-anchor="middle" x="1322.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1322.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1322.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1322.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert1&#45;&gt;stage5_layer0_expert1_mlp1 -->
<g id="edge1194" class="edge">
<title>stage5_layer0_expert1&#45;&gt;stage5_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1333.27,-11006.75C1331.88,-10998.79 1330.32,-10989.85 1328.84,-10981.33"/>
<polygon fill="black" stroke="black" points="1332.24,-10980.49 1327.08,-10971.24 1325.35,-10981.7 1332.24,-10980.49"/>
</g>
<!-- stage5_layer0_expert1_tp1 -->
<g id="node915" class="node">
<title>stage5_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="937.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="937.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="937.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="937.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="937.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert1_mlp1&#45;&gt;stage5_layer0_expert1_tp1 -->
<g id="edge1195" class="edge">
<title>stage5_layer0_expert1_mlp1&#45;&gt;stage5_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M1223.04,-10919.04C1174.17,-10906.76 1114.79,-10891.83 1062.89,-10878.79"/>
<polygon fill="black" stroke="black" points="1063.5,-10875.33 1052.95,-10876.29 1061.79,-10882.12 1063.5,-10875.33"/>
</g>
<!-- stage5_layer0_expert1_act -->
<g id="node916" class="node">
<title>stage5_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="927.19,-10773.55 646.19,-10773.55 646.19,-10721.55 927.19,-10721.55 927.19,-10773.55"/>
<text text-anchor="middle" x="786.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="786.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="786.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="786.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert1_tp1&#45;&gt;stage5_layer0_expert1_act -->
<g id="edge1196" class="edge">
<title>stage5_layer0_expert1_tp1&#45;&gt;stage5_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M883.6,-10810.66C867.46,-10800.31 849.9,-10789.06 834.22,-10779.01"/>
<polygon fill="black" stroke="black" points="836.03,-10776.01 825.72,-10773.56 832.25,-10781.91 836.03,-10776.01"/>
</g>
<!-- stage5_layer0_expert1_mlp2 -->
<g id="node917" class="node">
<title>stage5_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="946.69,-10685.55 624.69,-10685.55 624.69,-10633.55 946.69,-10633.55 946.69,-10685.55"/>
<text text-anchor="middle" x="785.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="785.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP: Row Parallel)</text>
<text text-anchor="middle" x="785.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="785.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert1_act&#45;&gt;stage5_layer0_expert1_mlp2 -->
<g id="edge1197" class="edge">
<title>stage5_layer0_expert1_act&#45;&gt;stage5_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M786.39,-10721.21C786.3,-10713.25 786.2,-10704.31 786.1,-10695.79"/>
<polygon fill="black" stroke="black" points="789.6,-10695.66 785.98,-10685.71 782.6,-10695.75 789.6,-10695.66"/>
</g>
<!-- stage5_layer0_expert1_tp2 -->
<g id="node918" class="node">
<title>stage5_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="783.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="783.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="783.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="783.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="783.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert1_mlp2&#45;&gt;stage5_layer0_expert1_tp2 -->
<g id="edge1198" class="edge">
<title>stage5_layer0_expert1_mlp2&#45;&gt;stage5_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M785.17,-10633.38C785.01,-10625.57 784.82,-10616.7 784.64,-10607.93"/>
<polygon fill="black" stroke="black" points="788.14,-10607.68 784.43,-10597.76 781.14,-10607.83 788.14,-10607.68"/>
</g>
<!-- stage5_layer0_expert1_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1249" class="edge">
<title>stage5_layer0_expert1_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M939.88,-10533.95C966.46,-10530.17 993.82,-10526.67 1019.69,-10524.01 1521.29,-10472.47 2100.49,-10445.73 2484.77,-10432.56"/>
<polygon fill="black" stroke="black" points="2485.07,-10436.06 2494.94,-10432.22 2484.83,-10429.06 2485.07,-10436.06"/>
</g>
<!-- stage5_layer0_expert2_mlp1 -->
<g id="node920" class="node">
<title>stage5_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1822.69,-10971.09 1508.69,-10971.09 1508.69,-10919.09 1822.69,-10919.09 1822.69,-10971.09"/>
<text text-anchor="middle" x="1665.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1665.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1665.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1665.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert2&#45;&gt;stage5_layer0_expert2_mlp1 -->
<g id="edge1200" class="edge">
<title>stage5_layer0_expert2&#45;&gt;stage5_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1696.72,-11006.75C1692.47,-10998.44 1687.68,-10989.06 1683.15,-10980.21"/>
<polygon fill="black" stroke="black" points="1686.23,-10978.55 1678.56,-10971.24 1680,-10981.74 1686.23,-10978.55"/>
</g>
<!-- stage5_layer0_expert2_tp1 -->
<g id="node921" class="node">
<title>stage5_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1400.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1400.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1400.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="1400.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1400.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert2_mlp1&#45;&gt;stage5_layer0_expert2_tp1 -->
<g id="edge1201" class="edge">
<title>stage5_layer0_expert2_mlp1&#45;&gt;stage5_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1597.1,-10919.04C1566.95,-10908.03 1531,-10894.9 1498.14,-10882.9"/>
<polygon fill="black" stroke="black" points="1499.1,-10879.53 1488.51,-10879.39 1496.7,-10886.11 1499.1,-10879.53"/>
</g>
<!-- stage5_layer0_expert2_act -->
<g id="node922" class="node">
<title>stage5_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1502.19,-10773.55 1221.19,-10773.55 1221.19,-10721.55 1502.19,-10721.55 1502.19,-10773.55"/>
<text text-anchor="middle" x="1361.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1361.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="1361.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1361.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert2_tp1&#45;&gt;stage5_layer0_expert2_act -->
<g id="edge1202" class="edge">
<title>stage5_layer0_expert2_tp1&#45;&gt;stage5_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1386.28,-10809.56C1382.78,-10800.88 1379.04,-10791.61 1375.57,-10782.99"/>
<polygon fill="black" stroke="black" points="1378.77,-10781.56 1371.78,-10773.59 1372.27,-10784.18 1378.77,-10781.56"/>
</g>
<!-- stage5_layer0_expert2_mlp2 -->
<g id="node923" class="node">
<title>stage5_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1483.69,-10685.55 1161.69,-10685.55 1161.69,-10633.55 1483.69,-10633.55 1483.69,-10685.55"/>
<text text-anchor="middle" x="1322.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1322.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1322.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1322.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert2_act&#45;&gt;stage5_layer0_expert2_mlp2 -->
<g id="edge1203" class="edge">
<title>stage5_layer0_expert2_act&#45;&gt;stage5_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1350.2,-10721.21C1346.47,-10712.99 1342.27,-10703.72 1338.29,-10694.95"/>
<polygon fill="black" stroke="black" points="1341.41,-10693.37 1334.1,-10685.71 1335.04,-10696.26 1341.41,-10693.37"/>
</g>
<!-- stage5_layer0_expert2_tp2 -->
<g id="node924" class="node">
<title>stage5_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1256.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1256.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1256.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="1256.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1256.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert2_mlp2&#45;&gt;stage5_layer0_expert2_tp2 -->
<g id="edge1204" class="edge">
<title>stage5_layer0_expert2_mlp2&#45;&gt;stage5_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1305.52,-10633.38C1299.79,-10624.97 1293.22,-10615.34 1286.8,-10605.93"/>
<polygon fill="black" stroke="black" points="1289.5,-10603.68 1280.98,-10597.39 1283.72,-10607.62 1289.5,-10603.68"/>
</g>
<!-- stage5_layer0_expert2_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1250" class="edge">
<title>stage5_layer0_expert2_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1414.19,-10534.16C1440.36,-10530.41 1467.26,-10526.85 1492.69,-10524.01 1831.19,-10486.14 2216.73,-10459.19 2500.58,-10442.39"/>
<polygon fill="black" stroke="black" points="2500.85,-10445.88 2510.63,-10441.79 2500.44,-10438.89 2500.85,-10445.88"/>
</g>
<!-- stage5_layer0_expert3_mlp1 -->
<g id="node926" class="node">
<title>stage5_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2164.69,-10971.09 1850.69,-10971.09 1850.69,-10919.09 2164.69,-10919.09 2164.69,-10971.09"/>
<text text-anchor="middle" x="2007.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="2007.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2007.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2007.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert3&#45;&gt;stage5_layer0_expert3_mlp1 -->
<g id="edge1206" class="edge">
<title>stage5_layer0_expert3&#45;&gt;stage5_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M2048.6,-11006.75C2042.88,-10998.26 2036.41,-10988.67 2030.33,-10979.65"/>
<polygon fill="black" stroke="black" points="2033.15,-10977.58 2024.65,-10971.24 2027.34,-10981.49 2033.15,-10977.58"/>
</g>
<!-- stage5_layer0_expert3_tp1 -->
<g id="node927" class="node">
<title>stage5_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1839.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1839.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1839.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="1839.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1839.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert3_mlp1&#45;&gt;stage5_layer0_expert3_tp1 -->
<g id="edge1207" class="edge">
<title>stage5_layer0_expert3_mlp1&#45;&gt;stage5_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1963.99,-10918.92C1946.87,-10909.05 1926.82,-10897.5 1907.88,-10886.6"/>
<polygon fill="black" stroke="black" points="1909.39,-10883.43 1898.98,-10881.47 1905.9,-10889.5 1909.39,-10883.43"/>
</g>
<!-- stage5_layer0_expert3_act -->
<g id="node928" class="node">
<title>stage5_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1952.19,-10773.55 1671.19,-10773.55 1671.19,-10721.55 1952.19,-10721.55 1952.19,-10773.55"/>
<text text-anchor="middle" x="1811.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1811.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="1811.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1811.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert3_tp1&#45;&gt;stage5_layer0_expert3_act -->
<g id="edge1208" class="edge">
<title>stage5_layer0_expert3_tp1&#45;&gt;stage5_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1829.34,-10809.56C1826.86,-10800.97 1824.21,-10791.81 1821.73,-10783.26"/>
<polygon fill="black" stroke="black" points="1825.08,-10782.23 1818.93,-10773.59 1818.35,-10784.17 1825.08,-10782.23"/>
</g>
<!-- stage5_layer0_expert3_mlp2 -->
<g id="node929" class="node">
<title>stage5_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1945.69,-10685.55 1623.69,-10685.55 1623.69,-10633.55 1945.69,-10633.55 1945.69,-10685.55"/>
<text text-anchor="middle" x="1784.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1784.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1784.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1784.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert3_act&#45;&gt;stage5_layer0_expert3_mlp2 -->
<g id="edge1209" class="edge">
<title>stage5_layer0_expert3_act&#45;&gt;stage5_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1803.73,-10721.21C1801.21,-10713.16 1798.37,-10704.12 1795.67,-10695.51"/>
<polygon fill="black" stroke="black" points="1798.92,-10694.2 1792.59,-10685.71 1792.24,-10696.29 1798.92,-10694.2"/>
</g>
<!-- stage5_layer0_expert3_tp2 -->
<g id="node930" class="node">
<title>stage5_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1729.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1729.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1729.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="1729.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1729.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert3_mlp2&#45;&gt;stage5_layer0_expert3_tp2 -->
<g id="edge1210" class="edge">
<title>stage5_layer0_expert3_mlp2&#45;&gt;stage5_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1770.38,-10633.38C1765.7,-10625.14 1760.35,-10615.74 1755.11,-10606.51"/>
<polygon fill="black" stroke="black" points="1758.12,-10604.72 1750.14,-10597.76 1752.03,-10608.18 1758.12,-10604.72"/>
</g>
<!-- stage5_layer0_expert3_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1251" class="edge">
<title>stage5_layer0_expert3_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1889.83,-10534.58C1915.19,-10530.86 1941.13,-10527.2 1965.69,-10524.01 2150.29,-10499.99 2355.65,-10477.18 2527.81,-10459.16"/>
<polygon fill="black" stroke="black" points="2528.22,-10462.64 2537.8,-10458.12 2527.49,-10455.67 2528.22,-10462.64"/>
</g>
<!-- stage5_layer0_expert31_mlp1 -->
<g id="node932" class="node">
<title>stage5_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2505.69,-10971.09 2191.69,-10971.09 2191.69,-10919.09 2505.69,-10919.09 2505.69,-10971.09"/>
<text text-anchor="middle" x="2348.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2348.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2348.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2348.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert31&#45;&gt;stage5_layer0_expert31_mlp1 -->
<g id="edge1212" class="edge">
<title>stage5_layer0_expert31&#45;&gt;stage5_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2394.54,-11006.75C2388.06,-10998.18 2380.72,-10988.47 2373.85,-10979.38"/>
<polygon fill="black" stroke="black" points="2376.52,-10977.11 2367.7,-10971.24 2370.94,-10981.33 2376.52,-10977.11"/>
</g>
<!-- stage5_layer0_expert31_tp1 -->
<g id="node933" class="node">
<title>stage5_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2266.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2266.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2266.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="2266.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2266.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert31_mlp1&#45;&gt;stage5_layer0_expert31_tp1 -->
<g id="edge1213" class="edge">
<title>stage5_layer0_expert31_mlp1&#45;&gt;stage5_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2327.36,-10918.92C2320.02,-10910.25 2311.58,-10900.29 2303.37,-10890.61"/>
<polygon fill="black" stroke="black" points="2306,-10888.3 2296.86,-10882.93 2300.66,-10892.82 2306,-10888.3"/>
</g>
<!-- stage5_layer0_expert31_act -->
<g id="node934" class="node">
<title>stage5_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2391.19,-10773.55 2110.19,-10773.55 2110.19,-10721.55 2391.19,-10721.55 2391.19,-10773.55"/>
<text text-anchor="middle" x="2250.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2250.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="2250.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2250.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert31_tp1&#45;&gt;stage5_layer0_expert31_act -->
<g id="edge1214" class="edge">
<title>stage5_layer0_expert31_tp1&#45;&gt;stage5_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2260.78,-10809.56C2259.37,-10801.06 2257.87,-10792.01 2256.47,-10783.54"/>
<polygon fill="black" stroke="black" points="2259.91,-10782.89 2254.83,-10773.59 2253.01,-10784.03 2259.91,-10782.89"/>
</g>
<!-- stage5_layer0_expert31_mlp2 -->
<g id="node935" class="node">
<title>stage5_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2395.69,-10685.55 2073.69,-10685.55 2073.69,-10633.55 2395.69,-10633.55 2395.69,-10685.55"/>
<text text-anchor="middle" x="2234.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2234.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2234.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2234.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert31_act&#45;&gt;stage5_layer0_expert31_mlp2 -->
<g id="edge1215" class="edge">
<title>stage5_layer0_expert31_act&#45;&gt;stage5_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2245.97,-10721.21C2244.49,-10713.25 2242.83,-10704.31 2241.25,-10695.79"/>
<polygon fill="black" stroke="black" points="2244.64,-10694.9 2239.37,-10685.71 2237.76,-10696.18 2244.64,-10694.9"/>
</g>
<!-- stage5_layer0_expert31_tp2 -->
<g id="node936" class="node">
<title>stage5_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2202.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2202.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2202.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="2202.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2202.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert31_mlp2&#45;&gt;stage5_layer0_expert31_tp2 -->
<g id="edge1216" class="edge">
<title>stage5_layer0_expert31_mlp2&#45;&gt;stage5_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2226.36,-10633.38C2223.73,-10625.4 2220.72,-10616.32 2217.76,-10607.36"/>
<polygon fill="black" stroke="black" points="2221.05,-10606.15 2214.59,-10597.76 2214.4,-10608.35 2221.05,-10606.15"/>
</g>
<!-- stage5_layer0_expert31_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1252" class="edge">
<title>stage5_layer0_expert31_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2344.66,-10532.03C2410.77,-10519.11 2492.52,-10503.13 2573.2,-10487.36"/>
<polygon fill="black" stroke="black" points="2573.89,-10490.79 2583.03,-10485.44 2572.54,-10483.92 2573.89,-10490.79"/>
</g>
<!-- stage5_layer0_expert32_mlp1 -->
<g id="node938" class="node">
<title>stage5_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2845.69,-10971.09 2531.69,-10971.09 2531.69,-10919.09 2845.69,-10919.09 2845.69,-10971.09"/>
<text text-anchor="middle" x="2688.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2688.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2688.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2688.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert32&#45;&gt;stage5_layer0_expert32_mlp1 -->
<g id="edge1218" class="edge">
<title>stage5_layer0_expert32&#45;&gt;stage5_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2737.36,-11006.75C2730.41,-10998.09 2722.53,-10988.27 2715.17,-10979.1"/>
<polygon fill="black" stroke="black" points="2717.86,-10976.85 2708.87,-10971.24 2712.4,-10981.23 2717.86,-10976.85"/>
</g>
<!-- stage5_layer0_expert32_tp1 -->
<g id="node939" class="node">
<title>stage5_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2687.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2687.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2687.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="2687.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2687.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert32_mlp1&#45;&gt;stage5_layer0_expert32_tp1 -->
<g id="edge1219" class="edge">
<title>stage5_layer0_expert32_mlp1&#45;&gt;stage5_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2688.43,-10918.92C2688.35,-10911.11 2688.26,-10902.24 2688.17,-10893.47"/>
<polygon fill="black" stroke="black" points="2691.66,-10893.26 2688.06,-10883.29 2684.66,-10893.33 2691.66,-10893.26"/>
</g>
<!-- stage5_layer0_expert32_act -->
<g id="node940" class="node">
<title>stage5_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2825.19,-10773.55 2544.19,-10773.55 2544.19,-10721.55 2825.19,-10721.55 2825.19,-10773.55"/>
<text text-anchor="middle" x="2684.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2684.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="2684.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2684.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert32_tp1&#45;&gt;stage5_layer0_expert32_act -->
<g id="edge1220" class="edge">
<title>stage5_layer0_expert32_tp1&#45;&gt;stage5_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2686.57,-10809.28C2686.31,-10800.97 2686.04,-10792.14 2685.78,-10783.86"/>
<polygon fill="black" stroke="black" points="2689.28,-10783.63 2685.47,-10773.74 2682.28,-10783.85 2689.28,-10783.63"/>
</g>
<!-- stage5_layer0_expert32_mlp2 -->
<g id="node941" class="node">
<title>stage5_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2842.69,-10685.55 2520.69,-10685.55 2520.69,-10633.55 2842.69,-10633.55 2842.69,-10685.55"/>
<text text-anchor="middle" x="2681.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2681.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2681.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2681.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert32_act&#45;&gt;stage5_layer0_expert32_mlp2 -->
<g id="edge1221" class="edge">
<title>stage5_layer0_expert32_act&#45;&gt;stage5_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2683.8,-10721.21C2683.53,-10713.25 2683.22,-10704.31 2682.92,-10695.79"/>
<polygon fill="black" stroke="black" points="2686.41,-10695.58 2682.57,-10685.71 2679.42,-10695.82 2686.41,-10695.58"/>
</g>
<!-- stage5_layer0_expert32_tp2 -->
<g id="node942" class="node">
<title>stage5_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2675.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2675.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2675.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="2675.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2675.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert32_mlp2&#45;&gt;stage5_layer0_expert32_tp2 -->
<g id="edge1222" class="edge">
<title>stage5_layer0_expert32_mlp2&#45;&gt;stage5_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2680.13,-10633.38C2679.64,-10625.57 2679.09,-10616.7 2678.55,-10607.93"/>
<polygon fill="black" stroke="black" points="2682.03,-10607.52 2677.92,-10597.76 2675.04,-10607.95 2682.03,-10607.52"/>
</g>
<!-- stage5_layer0_expert32_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1253" class="edge">
<title>stage5_layer0_expert32_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2734.88,-10525.12C2751.53,-10515.37 2770.28,-10504.4 2789.2,-10493.32"/>
<polygon fill="black" stroke="black" points="2791.03,-10496.3 2797.89,-10488.23 2787.49,-10490.26 2791.03,-10496.3"/>
</g>
<!-- stage5_layer0_expert60_mlp1 -->
<g id="node944" class="node">
<title>stage5_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3262.69,-10971.09 2948.69,-10971.09 2948.69,-10919.09 3262.69,-10919.09 3262.69,-10971.09"/>
<text text-anchor="middle" x="3105.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3105.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3105.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3105.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert60&#45;&gt;stage5_layer0_expert60_mlp1 -->
<g id="edge1224" class="edge">
<title>stage5_layer0_expert60&#45;&gt;stage5_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3101.46,-11006.75C3102.01,-10998.79 3102.64,-10989.85 3103.23,-10981.33"/>
<polygon fill="black" stroke="black" points="3106.73,-10981.46 3103.93,-10971.24 3099.75,-10980.98 3106.73,-10981.46"/>
</g>
<!-- stage5_layer0_expert60_tp1 -->
<g id="node945" class="node">
<title>stage5_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3105.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3105.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3105.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="3105.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3105.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert60_mlp1&#45;&gt;stage5_layer0_expert60_tp1 -->
<g id="edge1225" class="edge">
<title>stage5_layer0_expert60_mlp1&#45;&gt;stage5_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3105.69,-10918.92C3105.69,-10911.11 3105.69,-10902.24 3105.69,-10893.47"/>
<polygon fill="black" stroke="black" points="3109.19,-10893.29 3105.69,-10883.29 3102.19,-10893.29 3109.19,-10893.29"/>
</g>
<!-- stage5_layer0_expert60_act -->
<g id="node946" class="node">
<title>stage5_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3246.19,-10773.55 2965.19,-10773.55 2965.19,-10721.55 3246.19,-10721.55 3246.19,-10773.55"/>
<text text-anchor="middle" x="3105.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3105.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="3105.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3105.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert60_tp1&#45;&gt;stage5_layer0_expert60_act -->
<g id="edge1226" class="edge">
<title>stage5_layer0_expert60_tp1&#45;&gt;stage5_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3105.69,-10809.28C3105.69,-10800.97 3105.69,-10792.14 3105.69,-10783.86"/>
<polygon fill="black" stroke="black" points="3109.19,-10783.74 3105.69,-10773.74 3102.19,-10783.74 3109.19,-10783.74"/>
</g>
<!-- stage5_layer0_expert60_mlp2 -->
<g id="node947" class="node">
<title>stage5_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3280.69,-10685.55 2958.69,-10685.55 2958.69,-10633.55 3280.69,-10633.55 3280.69,-10685.55"/>
<text text-anchor="middle" x="3119.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3119.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3119.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3119.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert60_act&#45;&gt;stage5_layer0_expert60_mlp2 -->
<g id="edge1227" class="edge">
<title>stage5_layer0_expert60_act&#45;&gt;stage5_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3109.81,-10721.21C3111.11,-10713.25 3112.56,-10704.31 3113.95,-10695.79"/>
<polygon fill="black" stroke="black" points="3117.44,-10696.14 3115.59,-10685.71 3110.53,-10695.01 3117.44,-10696.14"/>
</g>
<!-- stage5_layer0_expert60_tp2 -->
<g id="node948" class="node">
<title>stage5_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3148.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3148.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3148.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="3148.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3148.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert60_mlp2&#45;&gt;stage5_layer0_expert60_tp2 -->
<g id="edge1228" class="edge">
<title>stage5_layer0_expert60_mlp2&#45;&gt;stage5_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3127.23,-10633.38C3129.62,-10625.4 3132.34,-10616.32 3135.03,-10607.36"/>
<polygon fill="black" stroke="black" points="3138.39,-10608.34 3137.91,-10597.76 3131.68,-10606.33 3138.39,-10608.34"/>
</g>
<!-- stage5_layer0_expert60_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1254" class="edge">
<title>stage5_layer0_expert60_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3089.74,-10525.12C3073.17,-10515.37 3054.5,-10504.4 3035.66,-10493.32"/>
<polygon fill="black" stroke="black" points="3037.39,-10490.28 3027,-10488.23 3033.85,-10496.31 3037.39,-10490.28"/>
</g>
<!-- stage5_layer0_expert61_mlp1 -->
<g id="node950" class="node">
<title>stage5_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3602.69,-10971.09 3288.69,-10971.09 3288.69,-10919.09 3602.69,-10919.09 3602.69,-10971.09"/>
<text text-anchor="middle" x="3445.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3445.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3445.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3445.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert61&#45;&gt;stage5_layer0_expert61_mlp1 -->
<g id="edge1230" class="edge">
<title>stage5_layer0_expert61&#45;&gt;stage5_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3442.16,-11006.75C3442.62,-10998.79 3443.14,-10989.85 3443.64,-10981.33"/>
<polygon fill="black" stroke="black" points="3447.14,-10981.43 3444.23,-10971.24 3440.15,-10981.02 3447.14,-10981.43"/>
</g>
<!-- stage5_layer0_expert61_tp1 -->
<g id="node951" class="node">
<title>stage5_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3533.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3533.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3533.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="3533.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3533.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert61_mlp1&#45;&gt;stage5_layer0_expert61_tp1 -->
<g id="edge1231" class="edge">
<title>stage5_layer0_expert61_mlp1&#45;&gt;stage5_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3468.58,-10918.92C3476.46,-10910.25 3485.51,-10900.29 3494.32,-10890.61"/>
<polygon fill="black" stroke="black" points="3497.17,-10892.68 3501.31,-10882.93 3491.99,-10887.97 3497.17,-10892.68"/>
</g>
<!-- stage5_layer0_expert61_act -->
<g id="node952" class="node">
<title>stage5_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3693.19,-10773.55 3412.19,-10773.55 3412.19,-10721.55 3693.19,-10721.55 3693.19,-10773.55"/>
<text text-anchor="middle" x="3552.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3552.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="3552.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3552.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert61_tp1&#45;&gt;stage5_layer0_expert61_act -->
<g id="edge1232" class="edge">
<title>stage5_layer0_expert61_tp1&#45;&gt;stage5_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3540.71,-10809.56C3542.38,-10801.06 3544.16,-10792.01 3545.82,-10783.54"/>
<polygon fill="black" stroke="black" points="3549.28,-10784.08 3547.77,-10773.59 3542.41,-10782.73 3549.28,-10784.08"/>
</g>
<!-- stage5_layer0_expert61_mlp2 -->
<g id="node953" class="node">
<title>stage5_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3763.69,-10685.55 3441.69,-10685.55 3441.69,-10633.55 3763.69,-10633.55 3763.69,-10685.55"/>
<text text-anchor="middle" x="3602.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3602.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3602.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3602.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert61_act&#45;&gt;stage5_layer0_expert61_mlp2 -->
<g id="edge1233" class="edge">
<title>stage5_layer0_expert61_act&#45;&gt;stage5_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3567.42,-10721.21C3572.3,-10712.81 3577.82,-10703.33 3583.01,-10694.39"/>
<polygon fill="black" stroke="black" points="3586.06,-10696.11 3588.06,-10685.71 3580.01,-10692.59 3586.06,-10696.11"/>
</g>
<!-- stage5_layer0_expert61_tp2 -->
<g id="node954" class="node">
<title>stage5_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3621.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3621.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3621.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="3621.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3621.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert61_mlp2&#45;&gt;stage5_layer0_expert61_tp2 -->
<g id="edge1234" class="edge">
<title>stage5_layer0_expert61_mlp2&#45;&gt;stage5_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3607.63,-10633.38C3609.18,-10625.48 3610.94,-10616.51 3612.68,-10607.65"/>
<polygon fill="black" stroke="black" points="3616.13,-10608.24 3614.62,-10597.76 3609.26,-10606.89 3616.13,-10608.24"/>
</g>
<!-- stage5_layer0_expert61_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1255" class="edge">
<title>stage5_layer0_expert61_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3479.49,-10531.95C3417.3,-10519.78 3341.31,-10504.9 3265.43,-10490.05"/>
<polygon fill="black" stroke="black" points="3265.69,-10486.54 3255.21,-10488.05 3264.35,-10493.41 3265.69,-10486.54"/>
</g>
<!-- stage5_layer0_expert62_mlp1 -->
<g id="node956" class="node">
<title>stage5_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="3938.69,-10971.09 3624.69,-10971.09 3624.69,-10919.09 3938.69,-10919.09 3938.69,-10971.09"/>
<text text-anchor="middle" x="3781.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3781.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3781.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3781.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert62&#45;&gt;stage5_layer0_expert62_mlp1 -->
<g id="edge1236" class="edge">
<title>stage5_layer0_expert62&#45;&gt;stage5_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3781.69,-11006.75C3781.69,-10998.79 3781.69,-10989.85 3781.69,-10981.33"/>
<polygon fill="black" stroke="black" points="3785.19,-10981.24 3781.69,-10971.24 3778.19,-10981.24 3785.19,-10981.24"/>
</g>
<!-- stage5_layer0_expert62_tp1 -->
<g id="node957" class="node">
<title>stage5_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="3961.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3961.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="3961.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="3961.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3961.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert62_mlp1&#45;&gt;stage5_layer0_expert62_tp1 -->
<g id="edge1237" class="edge">
<title>stage5_layer0_expert62_mlp1&#45;&gt;stage5_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3828.51,-10918.92C3847.11,-10908.92 3868.94,-10897.18 3889.48,-10886.14"/>
<polygon fill="black" stroke="black" points="3891.35,-10889.11 3898.5,-10881.29 3888.03,-10882.94 3891.35,-10889.11"/>
</g>
<!-- stage5_layer0_expert62_act -->
<g id="node958" class="node">
<title>stage5_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4127.19,-10773.55 3846.19,-10773.55 3846.19,-10721.55 4127.19,-10721.55 4127.19,-10773.55"/>
<text text-anchor="middle" x="3986.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="3986.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="3986.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3986.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert62_tp1&#45;&gt;stage5_layer0_expert62_act -->
<g id="edge1238" class="edge">
<title>stage5_layer0_expert62_tp1&#45;&gt;stage5_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M3970.93,-10809.56C3973.12,-10801.06 3975.46,-10792.01 3977.65,-10783.54"/>
<polygon fill="black" stroke="black" points="3981.11,-10784.15 3980.22,-10773.59 3974.33,-10782.4 3981.11,-10784.15"/>
</g>
<!-- stage5_layer0_expert62_mlp2 -->
<g id="node959" class="node">
<title>stage5_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4197.69,-10685.55 3875.69,-10685.55 3875.69,-10633.55 4197.69,-10633.55 4197.69,-10685.55"/>
<text text-anchor="middle" x="4036.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4036.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4036.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4036.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert62_act&#45;&gt;stage5_layer0_expert62_mlp2 -->
<g id="edge1239" class="edge">
<title>stage5_layer0_expert62_act&#45;&gt;stage5_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4001.42,-10721.21C4006.3,-10712.81 4011.82,-10703.33 4017.01,-10694.39"/>
<polygon fill="black" stroke="black" points="4020.06,-10696.11 4022.06,-10685.71 4014.01,-10692.59 4020.06,-10696.11"/>
</g>
<!-- stage5_layer0_expert62_tp2 -->
<g id="node960" class="node">
<title>stage5_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4094.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4094.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4094.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="4094.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4094.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert62_mlp2&#45;&gt;stage5_layer0_expert62_tp2 -->
<g id="edge1240" class="edge">
<title>stage5_layer0_expert62_mlp2&#45;&gt;stage5_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4051.78,-10633.38C4056.76,-10625.06 4062.47,-10615.54 4068.05,-10606.22"/>
<polygon fill="black" stroke="black" points="4071.21,-10607.77 4073.34,-10597.39 4065.2,-10604.17 4071.21,-10607.77"/>
</g>
<!-- stage5_layer0_expert62_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1256" class="edge">
<title>stage5_layer0_expert62_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3934.54,-10534.58C3909.19,-10530.86 3883.24,-10527.21 3858.69,-10524.01 3726.83,-10506.85 3584.38,-10490.29 3451.02,-10475.67"/>
<polygon fill="black" stroke="black" points="3451.35,-10472.18 3441.03,-10474.57 3450.59,-10479.14 3451.35,-10472.18"/>
</g>
<!-- stage5_layer0_expert63_mlp1 -->
<g id="node962" class="node">
<title>stage5_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4332.69,-10971.09 4018.69,-10971.09 4018.69,-10919.09 4332.69,-10919.09 4332.69,-10971.09"/>
<text text-anchor="middle" x="4175.69" y="-10959.09" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4175.69" y="-10948.09" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4175.69" y="-10937.09" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4175.69" y="-10926.09" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer0_expert63&#45;&gt;stage5_layer0_expert63_mlp1 -->
<g id="edge1242" class="edge">
<title>stage5_layer0_expert63&#45;&gt;stage5_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4156.64,-11006.75C4159.17,-10998.7 4162.01,-10989.65 4164.71,-10981.05"/>
<polygon fill="black" stroke="black" points="4168.13,-10981.83 4167.79,-10971.24 4161.46,-10979.74 4168.13,-10981.83"/>
</g>
<!-- stage5_layer0_expert63_tp1 -->
<g id="node963" class="node">
<title>stage5_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4416.69" cy="-10846.32" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4416.69" y="-10860.32" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4416.69" y="-10849.32" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="4416.69" y="-10838.32" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4416.69" y="-10827.32" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert63_mlp1&#45;&gt;stage5_layer0_expert63_tp1 -->
<g id="edge1243" class="edge">
<title>stage5_layer0_expert63_mlp1&#45;&gt;stage5_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4238.07,-10919.04C4264.87,-10908.28 4296.72,-10895.49 4326.05,-10883.71"/>
<polygon fill="black" stroke="black" points="4327.5,-10886.9 4335.48,-10879.93 4324.9,-10880.4 4327.5,-10886.9"/>
</g>
<!-- stage5_layer0_expert63_act -->
<g id="node964" class="node">
<title>stage5_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4615.19,-10773.55 4334.19,-10773.55 4334.19,-10721.55 4615.19,-10721.55 4615.19,-10773.55"/>
<text text-anchor="middle" x="4474.69" y="-10761.55" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4474.69" y="-10750.55" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="4474.69" y="-10739.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4474.69" y="-10728.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer0_expert63_tp1&#45;&gt;stage5_layer0_expert63_act -->
<g id="edge1244" class="edge">
<title>stage5_layer0_expert63_tp1&#45;&gt;stage5_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4438.12,-10809.56C4443.44,-10800.69 4449.12,-10791.21 4454.38,-10782.43"/>
<polygon fill="black" stroke="black" points="4457.54,-10783.97 4459.68,-10773.59 4451.54,-10780.37 4457.54,-10783.97"/>
</g>
<!-- stage5_layer0_expert63_mlp2 -->
<g id="node965" class="node">
<title>stage5_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4689.69,-10685.55 4367.69,-10685.55 4367.69,-10633.55 4689.69,-10633.55 4689.69,-10685.55"/>
<text text-anchor="middle" x="4528.69" y="-10673.55" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4528.69" y="-10662.55" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4528.69" y="-10651.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4528.69" y="-10640.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert63_act&#45;&gt;stage5_layer0_expert63_mlp2 -->
<g id="edge1245" class="edge">
<title>stage5_layer0_expert63_act&#45;&gt;stage5_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4490.6,-10721.21C4495.87,-10712.81 4501.83,-10703.33 4507.44,-10694.39"/>
<polygon fill="black" stroke="black" points="4510.54,-10696.04 4512.89,-10685.71 4504.61,-10692.31 4510.54,-10696.04"/>
</g>
<!-- stage5_layer0_expert63_tp2 -->
<g id="node966" class="node">
<title>stage5_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4567.69" cy="-10560.78" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4567.69" y="-10574.78" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4567.69" y="-10563.78" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="4567.69" y="-10552.78" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4567.69" y="-10541.78" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_expert63_mlp2&#45;&gt;stage5_layer0_expert63_tp2 -->
<g id="edge1246" class="edge">
<title>stage5_layer0_expert63_mlp2&#45;&gt;stage5_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4538.83,-10633.38C4542.08,-10625.31 4545.79,-10616.12 4549.43,-10607.08"/>
<polygon fill="black" stroke="black" points="4552.7,-10608.34 4553.19,-10597.76 4546.2,-10605.72 4552.7,-10608.34"/>
</g>
<!-- stage5_layer0_expert63_tp2&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1257" class="edge">
<title>stage5_layer0_expert63_tp2&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4410.18,-10534.16C4384.01,-10530.41 4357.12,-10526.86 4331.69,-10524.01 4024.5,-10489.63 3678.56,-10464.25 3405.16,-10447.29"/>
<polygon fill="black" stroke="black" points="3405.26,-10443.79 3395.06,-10446.66 3404.82,-10450.77 3405.26,-10443.79"/>
</g>
<!-- stage5_layer0_expert_ellipsis&#45;&gt;stage5_layer0_expert_agg -->
<g id="edge1258" class="edge">
<title>stage5_layer0_expert_ellipsis&#45;&gt;stage5_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4676.61,-10918.99C4737.23,-10888.35 4823.69,-10830.32 4823.69,-10748.55 4823.69,-10748.55 4823.69,-10748.55 4823.69,-10658.55 4823.69,-10598.16 4849.18,-10564.84 4804.69,-10524.01 4752.79,-10476.39 3923.39,-10446.39 3380.12,-10431.74"/>
<polygon fill="black" stroke="black" points="3379.83,-10428.23 3369.74,-10431.46 3379.64,-10435.23 3379.83,-10428.23"/>
</g>
<!-- stage5_layer0_expert_agg&#45;&gt;stage5_layer0_output -->
<g id="edge1259" class="edge">
<title>stage5_layer0_expert_agg&#45;&gt;stage5_layer0_output</title>
<path fill="none" stroke="black" d="M3258.08,-10364.13C3356.95,-10348.43 3461.94,-10331.75 3550.83,-10317.62"/>
<polygon fill="black" stroke="black" points="3551.43,-10321.07 3560.76,-10316.04 3550.34,-10314.16 3551.43,-10321.07"/>
</g>
<!-- stage5_layer1_ln -->
<g id="node970" class="node">
<title>stage5_layer1_ln</title>
<polygon fill="none" stroke="black" points="3993.69,-10212.01 3543.69,-10212.01 3543.69,-10144.01 3993.69,-10144.01 3993.69,-10212.01"/>
<text text-anchor="middle" x="3768.69" y="-10196.81" font-family="Times,serif" font-size="14.00">Layer 11 LayerNorm</text>
<text text-anchor="middle" x="3768.69" y="-10181.81" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-10166.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-10151.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer0_output&#45;&gt;stage5_layer1_ln -->
<g id="edge1261" class="edge">
<title>stage5_layer0_output&#45;&gt;stage5_layer1_ln</title>
<path fill="none" stroke="black" d="M3768.69,-10247.89C3768.69,-10239.79 3768.69,-10230.99 3768.69,-10222.48"/>
<polygon fill="black" stroke="black" points="3772.19,-10222.31 3768.69,-10212.31 3765.19,-10222.31 3772.19,-10222.31"/>
</g>
<!-- stage5_layer1_attn_qkv -->
<g id="node971" class="node">
<title>stage5_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4000.19,-10108.01 3537.19,-10108.01 3537.19,-10040.01 4000.19,-10040.01 4000.19,-10108.01"/>
<text text-anchor="middle" x="3768.69" y="-10092.81" font-family="Times,serif" font-size="14.00">Layer 11 Attention QKV Projection</text>
<text text-anchor="middle" x="3768.69" y="-10077.81" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP: GPU 640&#45;767)</text>
<text text-anchor="middle" x="3768.69" y="-10062.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-10047.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage5_layer1_ln&#45;&gt;stage5_layer1_attn_qkv -->
<g id="edge1262" class="edge">
<title>stage5_layer1_ln&#45;&gt;stage5_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3768.69,-10143.89C3768.69,-10135.79 3768.69,-10126.99 3768.69,-10118.48"/>
<polygon fill="black" stroke="black" points="3772.19,-10118.31 3768.69,-10108.31 3765.19,-10118.31 3772.19,-10118.31"/>
</g>
<!-- stage5_layer1_tp_qkv_comm -->
<g id="node972" class="node">
<title>stage5_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-9955.93" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3768.69" y="-9974.73" font-family="Times,serif" font-size="14.00">Layer 11 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3768.69" y="-9959.73" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP pairs)</text>
<text text-anchor="middle" x="3768.69" y="-9944.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-9929.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage5_layer1_attn_qkv&#45;&gt;stage5_layer1_tp_qkv_comm -->
<g id="edge1263" class="edge">
<title>stage5_layer1_attn_qkv&#45;&gt;stage5_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3768.69,-10039.74C3768.69,-10031.75 3768.69,-10022.99 3768.69,-10014.24"/>
<polygon fill="black" stroke="black" points="3772.19,-10014.04 3768.69,-10004.04 3765.19,-10014.04 3772.19,-10014.04"/>
</g>
<!-- stage5_layer1_attn_head0 -->
<g id="node973" class="node">
<title>stage5_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1577.19,-9871.84 1304.19,-9871.84 1304.19,-9819.84 1577.19,-9819.84 1577.19,-9871.84"/>
<text text-anchor="middle" x="1440.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 0 Attention</text>
<text text-anchor="middle" x="1440.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 0)</text>
<text text-anchor="middle" x="1440.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1440.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head0 -->
<g id="edge1264" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3445.67,-9947.9C2933.05,-9935.87 1954.56,-9909.07 1587.38,-9871.95"/>
<polygon fill="black" stroke="black" points="1587.54,-9868.45 1577.23,-9870.9 1586.82,-9875.41 1587.54,-9868.45"/>
</g>
<!-- stage5_layer1_attn_head1 -->
<g id="node974" class="node">
<title>stage5_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1868.19,-9871.84 1595.19,-9871.84 1595.19,-9819.84 1868.19,-9819.84 1868.19,-9871.84"/>
<text text-anchor="middle" x="1731.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 1 Attention</text>
<text text-anchor="middle" x="1731.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 1)</text>
<text text-anchor="middle" x="1731.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1731.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head1 -->
<g id="edge1265" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3441.73,-9953.13C3066.12,-9948.19 2431.43,-9930.97 1878.41,-9871.97"/>
<polygon fill="black" stroke="black" points="1878.55,-9868.47 1868.23,-9870.88 1877.8,-9875.43 1878.55,-9868.47"/>
</g>
<!-- stage5_layer1_attn_head2 -->
<g id="node975" class="node">
<title>stage5_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2159.19,-9871.84 1886.19,-9871.84 1886.19,-9819.84 2159.19,-9819.84 2159.19,-9871.84"/>
<text text-anchor="middle" x="2022.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 2 Attention</text>
<text text-anchor="middle" x="2022.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 2)</text>
<text text-anchor="middle" x="2022.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2022.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head2 -->
<g id="edge1266" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3444.26,-9949.39C3122.63,-9941.26 2615.92,-9921.37 2169.44,-9871.99"/>
<polygon fill="black" stroke="black" points="2169.56,-9868.48 2159.24,-9870.85 2168.79,-9875.44 2169.56,-9868.48"/>
</g>
<!-- stage5_layer1_attn_head3 -->
<g id="node976" class="node">
<title>stage5_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2450.19,-9871.84 2177.19,-9871.84 2177.19,-9819.84 2450.19,-9819.84 2450.19,-9871.84"/>
<text text-anchor="middle" x="2313.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 3 Attention</text>
<text text-anchor="middle" x="2313.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 3)</text>
<text text-anchor="middle" x="2313.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2313.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head3 -->
<g id="edge1267" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3450.84,-9944.32C3187.62,-9933.28 2803.78,-9911.95 2460.39,-9871.99"/>
<polygon fill="black" stroke="black" points="2460.58,-9868.49 2450.24,-9870.81 2459.77,-9875.45 2460.58,-9868.49"/>
</g>
<!-- stage5_layer1_attn_head4 -->
<g id="node977" class="node">
<title>stage5_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2741.19,-9871.84 2468.19,-9871.84 2468.19,-9819.84 2741.19,-9819.84 2741.19,-9871.84"/>
<text text-anchor="middle" x="2604.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 4 Attention</text>
<text text-anchor="middle" x="2604.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 4)</text>
<text text-anchor="middle" x="2604.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2604.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head4 -->
<g id="edge1268" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3466.43,-9937.39C3266.07,-9924.04 2997.29,-9902.86 2751.46,-9872.03"/>
<polygon fill="black" stroke="black" points="2751.61,-9868.52 2741.25,-9870.74 2750.73,-9875.46 2751.61,-9868.52"/>
</g>
<!-- stage5_layer1_attn_head5 -->
<g id="node978" class="node">
<title>stage5_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3032.19,-9871.84 2759.19,-9871.84 2759.19,-9819.84 3032.19,-9819.84 3032.19,-9871.84"/>
<text text-anchor="middle" x="2895.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 5 Attention</text>
<text text-anchor="middle" x="2895.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 5)</text>
<text text-anchor="middle" x="2895.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2895.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head5 -->
<g id="edge1269" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3501.12,-9928.09C3366.28,-9913.64 3200.06,-9894.45 3042.62,-9872.09"/>
<polygon fill="black" stroke="black" points="3042.66,-9868.56 3032.27,-9870.61 3041.67,-9875.49 3042.66,-9868.56"/>
</g>
<!-- stage5_layer1_attn_head6 -->
<g id="node979" class="node">
<title>stage5_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3323.19,-9871.84 3050.19,-9871.84 3050.19,-9819.84 3323.19,-9819.84 3323.19,-9871.84"/>
<text text-anchor="middle" x="3186.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 6 Attention</text>
<text text-anchor="middle" x="3186.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 6)</text>
<text text-anchor="middle" x="3186.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3186.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head6 -->
<g id="edge1270" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3568.8,-9917.81C3490.89,-9903.34 3403.29,-9887.07 3331.64,-9873.76"/>
<polygon fill="black" stroke="black" points="3332.1,-9870.29 3321.63,-9871.9 3330.83,-9877.17 3332.1,-9870.29"/>
</g>
<!-- stage5_layer1_attn_head7 -->
<g id="node980" class="node">
<title>stage5_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3614.19,-9871.84 3341.19,-9871.84 3341.19,-9819.84 3614.19,-9819.84 3614.19,-9871.84"/>
<text text-anchor="middle" x="3477.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 7 Attention</text>
<text text-anchor="middle" x="3477.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 7)</text>
<text text-anchor="middle" x="3477.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3477.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head7 -->
<g id="edge1271" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3650.33,-9910.96C3618.09,-9898.99 3584.02,-9886.34 3554.74,-9875.46"/>
<polygon fill="black" stroke="black" points="3555.59,-9872.04 3545,-9871.84 3553.15,-9878.61 3555.59,-9872.04"/>
</g>
<!-- stage5_layer1_attn_ellipsis -->
<g id="node981" class="node">
<title>stage5_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3905.19,-9871.84 3632.19,-9871.84 3632.19,-9819.84 3905.19,-9819.84 3905.19,-9871.84"/>
<text text-anchor="middle" x="3768.69" y="-9859.84" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3768.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_ellipsis -->
<g id="edge1272" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3768.69,-9907.83C3768.69,-9899.29 3768.69,-9890.51 3768.69,-9882.37"/>
<polygon fill="black" stroke="black" points="3772.19,-9882.11 3768.69,-9872.11 3765.19,-9882.11 3772.19,-9882.11"/>
</g>
<!-- stage5_layer1_attn_head24 -->
<g id="node982" class="node">
<title>stage5_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4196.19,-9871.84 3923.19,-9871.84 3923.19,-9819.84 4196.19,-9819.84 4196.19,-9871.84"/>
<text text-anchor="middle" x="4059.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 24 Attention</text>
<text text-anchor="middle" x="4059.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 24)</text>
<text text-anchor="middle" x="4059.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4059.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head24 -->
<g id="edge1273" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3887.05,-9910.96C3919.28,-9898.99 3953.36,-9886.34 3982.64,-9875.46"/>
<polygon fill="black" stroke="black" points="3984.22,-9878.61 3992.38,-9871.84 3981.79,-9872.04 3984.22,-9878.61"/>
</g>
<!-- stage5_layer1_attn_head25 -->
<g id="node983" class="node">
<title>stage5_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4487.19,-9871.84 4214.19,-9871.84 4214.19,-9819.84 4487.19,-9819.84 4487.19,-9871.84"/>
<text text-anchor="middle" x="4350.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 25 Attention</text>
<text text-anchor="middle" x="4350.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 25)</text>
<text text-anchor="middle" x="4350.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4350.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head25 -->
<g id="edge1274" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M3968.57,-9917.81C4046.48,-9903.34 4134.09,-9887.07 4205.74,-9873.76"/>
<polygon fill="black" stroke="black" points="4206.55,-9877.17 4215.74,-9871.9 4205.27,-9870.29 4206.55,-9877.17"/>
</g>
<!-- stage5_layer1_attn_head26 -->
<g id="node984" class="node">
<title>stage5_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4778.19,-9871.84 4505.19,-9871.84 4505.19,-9819.84 4778.19,-9819.84 4778.19,-9871.84"/>
<text text-anchor="middle" x="4641.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 26 Attention</text>
<text text-anchor="middle" x="4641.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 26)</text>
<text text-anchor="middle" x="4641.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4641.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head26 -->
<g id="edge1275" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4035.45,-9928.04C4170.31,-9913.56 4336.69,-9894.33 4495.01,-9871.91"/>
<polygon fill="black" stroke="black" points="4495.54,-9875.37 4504.95,-9870.5 4494.55,-9868.44 4495.54,-9875.37"/>
</g>
<!-- stage5_layer1_attn_head27 -->
<g id="node985" class="node">
<title>stage5_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5069.19,-9871.84 4796.19,-9871.84 4796.19,-9819.84 5069.19,-9819.84 5069.19,-9871.84"/>
<text text-anchor="middle" x="4932.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 27 Attention</text>
<text text-anchor="middle" x="4932.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 27)</text>
<text text-anchor="middle" x="4932.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4932.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head27 -->
<g id="edge1276" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4070.64,-9937.29C4270.8,-9923.9 4539.31,-9902.7 4785.73,-9871.92"/>
<polygon fill="black" stroke="black" points="4786.48,-9875.35 4795.96,-9870.63 4785.61,-9868.4 4786.48,-9875.35"/>
</g>
<!-- stage5_layer1_attn_head28 -->
<g id="node986" class="node">
<title>stage5_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5360.19,-9871.84 5087.19,-9871.84 5087.19,-9819.84 5360.19,-9819.84 5360.19,-9871.84"/>
<text text-anchor="middle" x="5223.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 28 Attention</text>
<text text-anchor="middle" x="5223.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 28)</text>
<text text-anchor="middle" x="5223.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5223.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head28 -->
<g id="edge1277" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4086.28,-9944.21C4349.3,-9933.1 4732.83,-9911.73 5076.81,-9871.89"/>
<polygon fill="black" stroke="black" points="5077.45,-9875.34 5086.97,-9870.71 5076.64,-9868.39 5077.45,-9875.34"/>
</g>
<!-- stage5_layer1_attn_head29 -->
<g id="node987" class="node">
<title>stage5_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5651.19,-9871.84 5378.19,-9871.84 5378.19,-9819.84 5651.19,-9819.84 5651.19,-9871.84"/>
<text text-anchor="middle" x="5514.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 29 Attention</text>
<text text-anchor="middle" x="5514.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 29)</text>
<text text-anchor="middle" x="5514.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5514.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head29 -->
<g id="edge1278" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4093.28,-9949.26C4414.72,-9941.04 4920.89,-9921.08 5367.77,-9871.88"/>
<polygon fill="black" stroke="black" points="5368.43,-9875.33 5377.98,-9870.75 5367.66,-9868.38 5368.43,-9875.33"/>
</g>
<!-- stage5_layer1_attn_head30 -->
<g id="node988" class="node">
<title>stage5_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="5942.19,-9871.84 5669.19,-9871.84 5669.19,-9819.84 5942.19,-9819.84 5942.19,-9871.84"/>
<text text-anchor="middle" x="5805.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 30 Attention</text>
<text text-anchor="middle" x="5805.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 30)</text>
<text text-anchor="middle" x="5805.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5805.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head30 -->
<g id="edge1279" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4095.89,-9953.01C4471.34,-9947.94 5105.41,-9930.61 5658.8,-9871.87"/>
<polygon fill="black" stroke="black" points="5659.41,-9875.33 5668.98,-9870.79 5658.67,-9868.37 5659.41,-9875.33"/>
</g>
<!-- stage5_layer1_attn_head31 -->
<g id="node989" class="node">
<title>stage5_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6233.19,-9871.84 5960.19,-9871.84 5960.19,-9819.84 6233.19,-9819.84 6233.19,-9871.84"/>
<text text-anchor="middle" x="6096.69" y="-9859.84" font-family="Times,serif" font-size="10.00">Layer 11 Head 31 Attention</text>
<text text-anchor="middle" x="6096.69" y="-9848.84" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Head 31)</text>
<text text-anchor="middle" x="6096.69" y="-9837.84" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6096.69" y="-9826.84" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head31 -->
<g id="edge1280" class="edge">
<title>stage5_layer1_tp_qkv_comm&#45;&gt;stage5_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4091.55,-9947.85C4603.93,-9935.75 5581.97,-9908.86 5949.81,-9871.85"/>
<polygon fill="black" stroke="black" points="5950.39,-9875.31 5959.99,-9870.81 5949.68,-9868.35 5950.39,-9875.31"/>
</g>
<!-- stage5_layer1_attn_agg -->
<g id="node990" class="node">
<title>stage5_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4236.34,-9783.84 3492.41,-9783.84 3301.04,-9647.84 4044.97,-9647.84 4236.34,-9783.84"/>
<text text-anchor="middle" x="3768.69" y="-9734.64" font-family="Times,serif" font-size="14.00">Layer 11 Attention Aggregate</text>
<text text-anchor="middle" x="3768.69" y="-9719.64" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-9704.64" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-9689.64" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_attn_head0&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1281" class="edge">
<title>stage5_layer1_attn_head0&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1577.23,-9820.82C1580.07,-9820.47 1582.9,-9820.15 1585.69,-9819.84 2217.18,-9750.77 2956.43,-9727.99 3392.36,-9720.5"/>
<polygon fill="black" stroke="black" points="3392.67,-9723.99 3402.61,-9720.32 3392.55,-9716.99 3392.67,-9723.99"/>
</g>
<!-- stage5_layer1_attn_head1&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1282" class="edge">
<title>stage5_layer1_attn_head1&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1868.24,-9820.84C1871.08,-9820.49 1873.9,-9820.16 1876.69,-9819.84 2402.99,-9760.35 3015.69,-9734.95 3397.91,-9724.29"/>
<polygon fill="black" stroke="black" points="3398.12,-9727.79 3408.02,-9724.01 3397.93,-9720.79 3398.12,-9727.79"/>
</g>
<!-- stage5_layer1_attn_head2&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1283" class="edge">
<title>stage5_layer1_attn_head2&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2159.24,-9820.88C2162.08,-9820.52 2164.9,-9820.17 2167.69,-9819.84 2590.66,-9769.92 3079.57,-9742.89 3404.72,-9729.21"/>
<polygon fill="black" stroke="black" points="3404.93,-9732.7 3414.77,-9728.79 3404.63,-9725.71 3404.93,-9732.7"/>
</g>
<!-- stage5_layer1_attn_head3&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1284" class="edge">
<title>stage5_layer1_attn_head3&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2450.25,-9820.94C2453.08,-9820.56 2455.9,-9820.19 2458.69,-9819.84 2780.79,-9779.5 3149.56,-9752.18 3413.59,-9735.88"/>
<polygon fill="black" stroke="black" points="3413.96,-9739.36 3423.72,-9735.25 3413.53,-9732.37 3413.96,-9739.36"/>
</g>
<!-- stage5_layer1_attn_head4&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1285" class="edge">
<title>stage5_layer1_attn_head4&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2741.26,-9821.02C2744.09,-9820.62 2746.9,-9820.22 2749.69,-9819.84 2974.59,-9789.13 3228.58,-9763.43 3426.72,-9745.39"/>
<polygon fill="black" stroke="black" points="3427.07,-9748.87 3436.71,-9744.48 3426.43,-9741.9 3427.07,-9748.87"/>
</g>
<!-- stage5_layer1_attn_head5&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1286" class="edge">
<title>stage5_layer1_attn_head5&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3032.28,-9821.17C3035.11,-9820.72 3037.91,-9820.28 3040.69,-9819.84 3173.44,-9799.01 3320.12,-9777.9 3446.83,-9760.25"/>
<polygon fill="black" stroke="black" points="3447.65,-9763.67 3457.08,-9758.83 3446.69,-9756.74 3447.65,-9763.67"/>
</g>
<!-- stage5_layer1_attn_head6&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1287" class="edge">
<title>stage5_layer1_attn_head6&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3300.63,-9819.78C3351.21,-9808.66 3413.29,-9795.01 3475.5,-9781.32"/>
<polygon fill="black" stroke="black" points="3476.47,-9784.69 3485.49,-9779.13 3474.97,-9777.86 3476.47,-9784.69"/>
</g>
<!-- stage5_layer1_attn_head7&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1288" class="edge">
<title>stage5_layer1_attn_head7&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3534.83,-9819.71C3556.01,-9810.39 3581.2,-9799.31 3607.08,-9787.93"/>
<polygon fill="black" stroke="black" points="3608.51,-9791.12 3616.25,-9783.89 3605.69,-9784.72 3608.51,-9791.12"/>
</g>
<!-- stage5_layer1_attn_ellipsis&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1289" class="edge">
<title>stage5_layer1_attn_ellipsis&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3768.69,-9819.55C3768.69,-9811.96 3768.69,-9803.19 3768.69,-9794.05"/>
<polygon fill="black" stroke="black" points="3772.19,-9794.03 3768.69,-9784.03 3765.19,-9794.03 3772.19,-9794.03"/>
</g>
<!-- stage5_layer1_attn_head24&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1290" class="edge">
<title>stage5_layer1_attn_head24&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4002.54,-9819.71C3981.37,-9810.39 3956.18,-9799.31 3930.3,-9787.93"/>
<polygon fill="black" stroke="black" points="3931.69,-9784.72 3921.12,-9783.89 3928.87,-9791.12 3931.69,-9784.72"/>
</g>
<!-- stage5_layer1_attn_head25&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1291" class="edge">
<title>stage5_layer1_attn_head25&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4236.74,-9819.78C4192.03,-9809.95 4138.31,-9798.13 4083.45,-9786.07"/>
<polygon fill="black" stroke="black" points="4084.08,-9782.62 4073.56,-9783.89 4082.58,-9789.46 4084.08,-9782.62"/>
</g>
<!-- stage5_layer1_attn_head26&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1292" class="edge">
<title>stage5_layer1_attn_head26&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4504.93,-9821.3C4501.82,-9820.81 4498.74,-9820.32 4495.69,-9819.84 4413.61,-9807 4326.21,-9794.03 4241.51,-9781.81"/>
<polygon fill="black" stroke="black" points="4241.86,-9778.33 4231.46,-9780.37 4240.86,-9785.26 4241.86,-9778.33"/>
</g>
<!-- stage5_layer1_attn_head27&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1293" class="edge">
<title>stage5_layer1_attn_head27&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4795.95,-9821.14C4792.84,-9820.69 4789.75,-9820.26 4786.69,-9819.84 4596.01,-9793.9 4384.43,-9771.47 4203.77,-9754.23"/>
<polygon fill="black" stroke="black" points="4203.84,-9750.72 4193.56,-9753.26 4203.18,-9757.69 4203.84,-9750.72"/>
</g>
<!-- stage5_layer1_attn_head28&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1294" class="edge">
<title>stage5_layer1_attn_head28&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5086.97,-9821.04C5083.85,-9820.63 5080.75,-9820.22 5077.69,-9819.84 4779.68,-9782.68 4441.74,-9756.49 4183.88,-9739.82"/>
<polygon fill="black" stroke="black" points="4183.79,-9736.31 4173.59,-9739.16 4183.34,-9743.29 4183.79,-9736.31"/>
</g>
<!-- stage5_layer1_attn_head29&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1295" class="edge">
<title>stage5_layer1_attn_head29&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5377.97,-9820.98C5374.85,-9820.58 5371.75,-9820.2 5368.69,-9819.84 4962.71,-9772.15 4495.99,-9745.28 4171.82,-9731.04"/>
<polygon fill="black" stroke="black" points="4171.94,-9727.54 4161.79,-9730.6 4171.63,-9734.53 4171.94,-9727.54"/>
</g>
<!-- stage5_layer1_attn_head30&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1296" class="edge">
<title>stage5_layer1_attn_head30&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5668.98,-9820.94C5665.85,-9820.56 5662.75,-9820.19 5659.69,-9819.84 5144.76,-9761.93 4547.15,-9736.28 4163.82,-9725.13"/>
<polygon fill="black" stroke="black" points="4163.77,-9721.62 4153.67,-9724.83 4163.57,-9728.62 4163.77,-9721.62"/>
</g>
<!-- stage5_layer1_attn_head31&#45;&gt;stage5_layer1_attn_agg -->
<g id="edge1297" class="edge">
<title>stage5_layer1_attn_head31&#45;&gt;stage5_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5959.98,-9820.91C5956.86,-9820.53 5953.76,-9820.18 5950.69,-9819.84 5325.76,-9751.85 4595.31,-9728.72 4157.99,-9720.87"/>
<polygon fill="black" stroke="black" points="4157.77,-9717.36 4147.71,-9720.69 4157.65,-9724.36 4157.77,-9717.36"/>
</g>
<!-- stage5_layer1_attn_out -->
<g id="node991" class="node">
<title>stage5_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="3993.69,-9611.84 3543.69,-9611.84 3543.69,-9543.84 3993.69,-9543.84 3993.69,-9611.84"/>
<text text-anchor="middle" x="3768.69" y="-9596.64" font-family="Times,serif" font-size="14.00">Layer 11 Attention Output Proj</text>
<text text-anchor="middle" x="3768.69" y="-9581.64" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP: GPU 640&#45;767)</text>
<text text-anchor="middle" x="3768.69" y="-9566.64" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-9551.64" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_attn_agg&#45;&gt;stage5_layer1_attn_out -->
<g id="edge1298" class="edge">
<title>stage5_layer1_attn_agg&#45;&gt;stage5_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3768.69,-9647.64C3768.69,-9638.89 3768.69,-9630.12 3768.69,-9621.91"/>
<polygon fill="black" stroke="black" points="3772.19,-9621.86 3768.69,-9611.86 3765.19,-9621.86 3772.19,-9621.86"/>
</g>
<!-- stage5_layer1_tp_attn_comm -->
<g id="node992" class="node">
<title>stage5_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-9459.76" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3768.69" y="-9478.56" font-family="Times,serif" font-size="14.00">Layer 11 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3768.69" y="-9463.56" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5 (TP pairs)</text>
<text text-anchor="middle" x="3768.69" y="-9448.56" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-9433.56" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_attn_out&#45;&gt;stage5_layer1_tp_attn_comm -->
<g id="edge1299" class="edge">
<title>stage5_layer1_attn_out&#45;&gt;stage5_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3768.69,-9543.58C3768.69,-9535.58 3768.69,-9526.82 3768.69,-9518.08"/>
<polygon fill="black" stroke="black" points="3772.19,-9517.87 3768.69,-9507.87 3765.19,-9517.87 3772.19,-9517.87"/>
</g>
<!-- stage5_layer1_expert_router -->
<g id="node993" class="node">
<title>stage5_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4222.88,-9375.68 3500.36,-9375.68 3314.49,-9239.68 4037.02,-9239.68 4222.88,-9375.68"/>
<text text-anchor="middle" x="3768.69" y="-9326.48" font-family="Times,serif" font-size="14.00">Layer 11 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3768.69" y="-9311.48" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-9296.48" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-9281.48" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage5_layer1_tp_attn_comm&#45;&gt;stage5_layer1_expert_router -->
<g id="edge1300" class="edge">
<title>stage5_layer1_tp_attn_comm&#45;&gt;stage5_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3768.69,-9411.27C3768.69,-9403.19 3768.69,-9394.6 3768.69,-9385.98"/>
<polygon fill="black" stroke="black" points="3772.19,-9385.87 3768.69,-9375.87 3765.19,-9385.87 3772.19,-9385.87"/>
</g>
<!-- stage5_layer1_expert0 -->
<g id="node994" class="node">
<title>stage5_layer1_expert0</title>
<polygon fill="none" stroke="black" points="2013.69,-9203.68 1691.69,-9203.68 1691.69,-9151.68 2013.69,-9151.68 2013.69,-9203.68"/>
<text text-anchor="middle" x="1852.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 0</text>
<text text-anchor="middle" x="1852.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP pair)</text>
<text text-anchor="middle" x="1852.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1852.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert0 -->
<g id="edge1301" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3384.13,-9290.77C3035.79,-9274.66 2508.68,-9246.04 2051.69,-9203.68 2042.65,-9202.84 2033.39,-9201.91 2024.04,-9200.92"/>
<polygon fill="black" stroke="black" points="2024.19,-9197.42 2013.88,-9199.83 2023.44,-9204.38 2024.19,-9197.42"/>
</g>
<!-- stage5_layer1_expert1 -->
<g id="node1000" class="node">
<title>stage5_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2382.69,-9203.68 2060.69,-9203.68 2060.69,-9151.68 2382.69,-9151.68 2382.69,-9203.68"/>
<text text-anchor="middle" x="2221.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 1</text>
<text text-anchor="middle" x="2221.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP pair)</text>
<text text-anchor="middle" x="2221.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2221.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert1 -->
<g id="edge1307" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3360.65,-9273.55C3115.18,-9253.54 2796.49,-9227.39 2513.69,-9203.68 2474.54,-9200.39 2432.45,-9196.82 2392.75,-9193.42"/>
<polygon fill="black" stroke="black" points="2392.97,-9189.93 2382.71,-9192.56 2392.37,-9196.9 2392.97,-9189.93"/>
</g>
<!-- stage5_layer1_expert2 -->
<g id="node1006" class="node">
<title>stage5_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2844.69,-9203.68 2522.69,-9203.68 2522.69,-9151.68 2844.69,-9151.68 2844.69,-9203.68"/>
<text text-anchor="middle" x="2683.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 2</text>
<text text-anchor="middle" x="2683.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP pair)</text>
<text text-anchor="middle" x="2683.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2683.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert2 -->
<g id="edge1313" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3337.15,-9256.35C3194.95,-9239.69 3036.04,-9220.98 2890.69,-9203.68 2879.03,-9202.29 2867.01,-9200.85 2854.9,-9199.4"/>
<polygon fill="black" stroke="black" points="2855.06,-9195.89 2844.71,-9198.18 2854.23,-9202.84 2855.06,-9195.89"/>
</g>
<!-- stage5_layer1_expert3 -->
<g id="node1012" class="node">
<title>stage5_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3221.69,-9203.68 2899.69,-9203.68 2899.69,-9151.68 3221.69,-9151.68 3221.69,-9203.68"/>
<text text-anchor="middle" x="3060.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 3</text>
<text text-anchor="middle" x="3060.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP pair)</text>
<text text-anchor="middle" x="3060.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3060.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert3 -->
<g id="edge1319" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3397.84,-9239.63C3330.96,-9227.54 3264.89,-9215.59 3209.2,-9205.53"/>
<polygon fill="black" stroke="black" points="3209.74,-9202.07 3199.28,-9203.73 3208.5,-9208.96 3209.74,-9202.07"/>
</g>
<!-- stage5_layer1_expert31 -->
<g id="node1018" class="node">
<title>stage5_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3580.69,-9203.68 3258.69,-9203.68 3258.69,-9151.68 3580.69,-9151.68 3580.69,-9203.68"/>
<text text-anchor="middle" x="3419.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 31</text>
<text text-anchor="middle" x="3419.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP pair)</text>
<text text-anchor="middle" x="3419.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3419.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert31 -->
<g id="edge1325" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3585.76,-9239.58C3554.65,-9228.18 3523.9,-9216.9 3497.48,-9207.21"/>
<polygon fill="black" stroke="black" points="3498.54,-9203.87 3487.95,-9203.71 3496.13,-9210.44 3498.54,-9203.87"/>
</g>
<!-- stage5_layer1_expert32 -->
<g id="node1024" class="node">
<title>stage5_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3929.69,-9203.68 3607.69,-9203.68 3607.69,-9151.68 3929.69,-9151.68 3929.69,-9203.68"/>
<text text-anchor="middle" x="3768.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 32</text>
<text text-anchor="middle" x="3768.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP pair)</text>
<text text-anchor="middle" x="3768.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert32 -->
<g id="edge1331" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3768.69,-9239.3C3768.69,-9230.61 3768.69,-9222 3768.69,-9214.11"/>
<polygon fill="black" stroke="black" points="3772.19,-9213.87 3768.69,-9203.87 3765.19,-9213.87 3772.19,-9213.87"/>
</g>
<!-- stage5_layer1_expert60 -->
<g id="node1030" class="node">
<title>stage5_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4313.69,-9203.68 3991.69,-9203.68 3991.69,-9151.68 4313.69,-9151.68 4313.69,-9203.68"/>
<text text-anchor="middle" x="4152.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 60</text>
<text text-anchor="middle" x="4152.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP pair)</text>
<text text-anchor="middle" x="4152.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4152.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert60 -->
<g id="edge1337" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3969.97,-9239.58C4004.49,-9228.08 4038.62,-9216.7 4067.86,-9206.95"/>
<polygon fill="black" stroke="black" points="4069.21,-9210.19 4077.59,-9203.71 4066.99,-9203.55 4069.21,-9210.19"/>
</g>
<!-- stage5_layer1_expert61 -->
<g id="node1036" class="node">
<title>stage5_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4718.69,-9203.68 4396.69,-9203.68 4396.69,-9151.68 4718.69,-9151.68 4718.69,-9203.68"/>
<text text-anchor="middle" x="4557.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 61</text>
<text text-anchor="middle" x="4557.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP pair)</text>
<text text-anchor="middle" x="4557.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4557.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert61 -->
<g id="edge1343" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4063.32,-9258.88C4174.96,-9240.77 4298.01,-9220.8 4393.42,-9205.33"/>
<polygon fill="black" stroke="black" points="4394.13,-9208.76 4403.44,-9203.7 4393.01,-9201.85 4394.13,-9208.76"/>
</g>
<!-- stage5_layer1_expert62 -->
<g id="node1042" class="node">
<title>stage5_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5091.69,-9203.68 4769.69,-9203.68 4769.69,-9151.68 5091.69,-9151.68 5091.69,-9203.68"/>
<text text-anchor="middle" x="4930.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 62</text>
<text text-anchor="middle" x="4930.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP pair)</text>
<text text-anchor="middle" x="4930.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4930.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert62 -->
<g id="edge1349" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4084.13,-9274.04C4271.26,-9254.37 4513.1,-9228.41 4727.69,-9203.68 4737.98,-9202.49 4748.56,-9201.25 4759.24,-9199.98"/>
<polygon fill="black" stroke="black" points="4759.98,-9203.42 4769.49,-9198.76 4759.15,-9196.47 4759.98,-9203.42"/>
</g>
<!-- stage5_layer1_expert63 -->
<g id="node1048" class="node">
<title>stage5_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5447.69,-9203.68 5125.69,-9203.68 5125.69,-9151.68 5447.69,-9151.68 5447.69,-9203.68"/>
<text text-anchor="middle" x="5286.69" y="-9191.68" font-family="Times,serif" font-size="10.00">Layer 11 Expert 63</text>
<text text-anchor="middle" x="5286.69" y="-9180.68" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP pair)</text>
<text text-anchor="middle" x="5286.69" y="-9169.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5286.69" y="-9158.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert63 -->
<g id="edge1355" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4100.68,-9286.23C4370.45,-9268.35 4760.62,-9239.65 5100.69,-9203.68 5105.5,-9203.17 5110.38,-9202.63 5115.3,-9202.08"/>
<polygon fill="black" stroke="black" points="5115.91,-9205.53 5125.45,-9200.91 5115.12,-9198.58 5115.91,-9205.53"/>
</g>
<!-- stage5_layer1_expert_ellipsis -->
<g id="node1054" class="node">
<title>stage5_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6017.69,-9115.68 5695.69,-9115.68 5695.69,-9063.68 6017.69,-9063.68 6017.69,-9115.68"/>
<text text-anchor="middle" x="5856.69" y="-9103.68" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5856.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: Pipeline 5 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5856.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5856.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert_ellipsis -->
<g id="edge1361" class="edge">
<title>stage5_layer1_expert_router&#45;&gt;stage5_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4111.97,-9294.42C4528.87,-9278.02 5207.3,-9246.01 5456.69,-9203.68 5569.66,-9184.5 5696.39,-9145.64 5776.34,-9118.89"/>
<polygon fill="black" stroke="black" points="5777.49,-9122.19 5785.85,-9115.69 5775.26,-9115.56 5777.49,-9122.19"/>
</g>
<!-- stage5_layer1_expert0_mlp1 -->
<g id="node995" class="node">
<title>stage5_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1863.69,-9115.68 1549.69,-9115.68 1549.69,-9063.68 1863.69,-9063.68 1863.69,-9115.68"/>
<text text-anchor="middle" x="1706.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1706.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1706.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1706.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert0&#45;&gt;stage5_layer1_expert0_mlp1 -->
<g id="edge1302" class="edge">
<title>stage5_layer1_expert0&#45;&gt;stage5_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1810.07,-9151.57C1793.8,-9141.99 1775.08,-9130.96 1758.07,-9120.95"/>
<polygon fill="black" stroke="black" points="1759.76,-9117.87 1749.36,-9115.81 1756.2,-9123.9 1759.76,-9117.87"/>
</g>
<!-- stage5_layer1_expert0_tp1 -->
<g id="node996" class="node">
<title>stage5_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1617.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1617.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1617.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="1617.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1617.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert0_mlp1&#45;&gt;stage5_layer1_expert0_tp1 -->
<g id="edge1303" class="edge">
<title>stage5_layer1_expert0_mlp1&#45;&gt;stage5_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1683.54,-9063.5C1675.49,-9054.76 1666.23,-9044.68 1657.24,-9034.91"/>
<polygon fill="black" stroke="black" points="1659.79,-9032.51 1650.44,-9027.52 1654.63,-9037.25 1659.79,-9032.51"/>
</g>
<!-- stage5_layer1_expert0_act -->
<g id="node997" class="node">
<title>stage5_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1755.19,-8918.14 1474.19,-8918.14 1474.19,-8866.14 1755.19,-8866.14 1755.19,-8918.14"/>
<text text-anchor="middle" x="1614.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1614.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="1614.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1614.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert0_tp1&#45;&gt;stage5_layer1_expert0_act -->
<g id="edge1304" class="edge">
<title>stage5_layer1_expert0_tp1&#45;&gt;stage5_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1616.57,-8953.87C1616.31,-8945.56 1616.04,-8936.73 1615.78,-8928.45"/>
<polygon fill="black" stroke="black" points="1619.28,-8928.22 1615.47,-8918.33 1612.28,-8928.44 1619.28,-8928.22"/>
</g>
<!-- stage5_layer1_expert0_mlp2 -->
<g id="node998" class="node">
<title>stage5_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1630.69,-8830.14 1308.69,-8830.14 1308.69,-8778.14 1630.69,-8778.14 1630.69,-8830.14"/>
<text text-anchor="middle" x="1469.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1469.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1469.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1469.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert0_act&#45;&gt;stage5_layer1_expert0_mlp2 -->
<g id="edge1305" class="edge">
<title>stage5_layer1_expert0_act&#45;&gt;stage5_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1572.36,-8866.03C1556.2,-8856.45 1537.61,-8845.42 1520.72,-8835.41"/>
<polygon fill="black" stroke="black" points="1522.46,-8832.37 1512.07,-8830.27 1518.89,-8838.39 1522.46,-8832.37"/>
</g>
<!-- stage5_layer1_expert0_tp2 -->
<g id="node999" class="node">
<title>stage5_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1403.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1403.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1403.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 640&#45;641</text>
<text text-anchor="middle" x="1403.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1403.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert0_mlp2&#45;&gt;stage5_layer1_expert0_tp2 -->
<g id="edge1306" class="edge">
<title>stage5_layer1_expert0_mlp2&#45;&gt;stage5_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1452.52,-8777.96C1446.79,-8769.56 1440.22,-8759.93 1433.8,-8750.52"/>
<polygon fill="black" stroke="black" points="1436.5,-8748.27 1427.98,-8741.98 1430.72,-8752.21 1436.5,-8748.27"/>
</g>
<!-- stage5_layer1_expert_agg -->
<g id="node1055" class="node">
<title>stage5_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4319.22,-8632.6 3443.45,-8632.6 3218.16,-8496.6 4093.93,-8496.6 4319.22,-8632.6"/>
<text text-anchor="middle" x="3768.69" y="-8583.4" font-family="Times,serif" font-size="14.00">Layer 11 Expert Aggregation</text>
<text text-anchor="middle" x="3768.69" y="-8568.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-8553.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-8538.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert0_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1362" class="edge">
<title>stage5_layer1_expert0_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1559.23,-8678.49C1586.01,-8674.7 1613.61,-8671.2 1639.69,-8668.6 2224.93,-8610.24 2904.1,-8584.65 3334.99,-8573.62"/>
<polygon fill="black" stroke="black" points="3335.22,-8577.12 3345.12,-8573.37 3335.04,-8570.12 3335.22,-8577.12"/>
</g>
<!-- stage5_layer1_expert1_mlp1 -->
<g id="node1001" class="node">
<title>stage5_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2256.69,-9115.68 1942.69,-9115.68 1942.69,-9063.68 2256.69,-9063.68 2256.69,-9115.68"/>
<text text-anchor="middle" x="2099.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2099.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2099.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2099.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert1&#45;&gt;stage5_layer1_expert1_mlp1 -->
<g id="edge1308" class="edge">
<title>stage5_layer1_expert1&#45;&gt;stage5_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2186.07,-9151.57C2172.91,-9142.29 2157.83,-9131.66 2143.99,-9121.9"/>
<polygon fill="black" stroke="black" points="2145.75,-9118.86 2135.56,-9115.96 2141.72,-9124.58 2145.75,-9118.86"/>
</g>
<!-- stage5_layer1_expert1_tp1 -->
<g id="node1002" class="node">
<title>stage5_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2071.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2071.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2071.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="2071.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2071.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert1_mlp1&#45;&gt;stage5_layer1_expert1_tp1 -->
<g id="edge1309" class="edge">
<title>stage5_layer1_expert1_mlp1&#45;&gt;stage5_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2092.4,-9063.5C2090.1,-9055.53 2087.47,-9046.44 2084.88,-9037.49"/>
<polygon fill="black" stroke="black" points="2088.24,-9036.52 2082.1,-9027.88 2081.52,-9038.46 2088.24,-9036.52"/>
</g>
<!-- stage5_layer1_expert1_act -->
<g id="node1003" class="node">
<title>stage5_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2183.19,-8918.14 1902.19,-8918.14 1902.19,-8866.14 2183.19,-8866.14 2183.19,-8918.14"/>
<text text-anchor="middle" x="2042.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="2042.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="2042.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2042.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert1_tp1&#45;&gt;stage5_layer1_expert1_act -->
<g id="edge1310" class="edge">
<title>stage5_layer1_expert1_tp1&#45;&gt;stage5_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2060.97,-8954.15C2058.4,-8945.56 2055.65,-8936.4 2053.09,-8927.85"/>
<polygon fill="black" stroke="black" points="2056.42,-8926.76 2050.19,-8918.18 2049.71,-8928.76 2056.42,-8926.76"/>
</g>
<!-- stage5_layer1_expert1_mlp2 -->
<g id="node1004" class="node">
<title>stage5_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2120.69,-8830.14 1798.69,-8830.14 1798.69,-8778.14 2120.69,-8778.14 2120.69,-8830.14"/>
<text text-anchor="middle" x="1959.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="1959.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1959.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1959.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert1_act&#45;&gt;stage5_layer1_expert1_mlp2 -->
<g id="edge1311" class="edge">
<title>stage5_layer1_expert1_act&#45;&gt;stage5_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M2018.23,-8865.8C2009.71,-8856.96 2000.02,-8846.92 1991.01,-8837.59"/>
<polygon fill="black" stroke="black" points="1993.43,-8835.06 1983.97,-8830.29 1988.39,-8839.92 1993.43,-8835.06"/>
</g>
<!-- stage5_layer1_expert1_tp2 -->
<g id="node1005" class="node">
<title>stage5_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1876.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1876.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1876.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 642&#45;643</text>
<text text-anchor="middle" x="1876.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1876.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert1_mlp2&#45;&gt;stage5_layer1_expert1_tp2 -->
<g id="edge1312" class="edge">
<title>stage5_layer1_expert1_mlp2&#45;&gt;stage5_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M1938.1,-8777.96C1930.67,-8769.3 1922.13,-8759.34 1913.82,-8749.66"/>
<polygon fill="black" stroke="black" points="1916.4,-8747.29 1907.23,-8741.98 1911.09,-8751.85 1916.4,-8747.29"/>
</g>
<!-- stage5_layer1_expert1_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1363" class="edge">
<title>stage5_layer1_expert1_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2033.22,-8678.66C2059.69,-8674.88 2086.93,-8671.35 2112.69,-8668.6 2531.55,-8623.92 3012.24,-8596.67 3347.44,-8581.53"/>
<polygon fill="black" stroke="black" points="3347.98,-8585 3357.81,-8581.06 3347.67,-8578.01 3347.98,-8585"/>
</g>
<!-- stage5_layer1_expert2_mlp1 -->
<g id="node1007" class="node">
<title>stage5_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2766.69,-9115.68 2452.69,-9115.68 2452.69,-9063.68 2766.69,-9063.68 2766.69,-9115.68"/>
<text text-anchor="middle" x="2609.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2609.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2609.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2609.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert2&#45;&gt;stage5_layer1_expert2_mlp1 -->
<g id="edge1314" class="edge">
<title>stage5_layer1_expert2&#45;&gt;stage5_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2661.89,-9151.34C2654.43,-9142.68 2645.99,-9132.86 2638.09,-9123.69"/>
<polygon fill="black" stroke="black" points="2640.51,-9121.13 2631.33,-9115.83 2635.2,-9125.7 2640.51,-9121.13"/>
</g>
<!-- stage5_layer1_expert2_tp1 -->
<g id="node1008" class="node">
<title>stage5_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2506.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2506.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2506.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="2506.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2506.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert2_mlp1&#45;&gt;stage5_layer1_expert2_tp1 -->
<g id="edge1315" class="edge">
<title>stage5_layer1_expert2_mlp1&#45;&gt;stage5_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2582.9,-9063.5C2573.31,-9054.49 2562.22,-9044.08 2551.52,-9034.03"/>
<polygon fill="black" stroke="black" points="2553.89,-9031.45 2544.2,-9027.15 2549.09,-9036.55 2553.89,-9031.45"/>
</g>
<!-- stage5_layer1_expert2_act -->
<g id="node1009" class="node">
<title>stage5_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2554.19,-8918.14 2273.19,-8918.14 2273.19,-8866.14 2554.19,-8866.14 2554.19,-8918.14"/>
<text text-anchor="middle" x="2413.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2413.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="2413.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2413.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert2_tp1&#45;&gt;stage5_layer1_expert2_act -->
<g id="edge1316" class="edge">
<title>stage5_layer1_expert2_tp1&#45;&gt;stage5_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2472.59,-8954.42C2463.51,-8944.97 2453.74,-8934.82 2444.83,-8925.54"/>
<polygon fill="black" stroke="black" points="2447.35,-8923.11 2437.89,-8918.32 2442.3,-8927.96 2447.35,-8923.11"/>
</g>
<!-- stage5_layer1_expert2_mlp2 -->
<g id="node1010" class="node">
<title>stage5_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2542.69,-8830.14 2220.69,-8830.14 2220.69,-8778.14 2542.69,-8778.14 2542.69,-8830.14"/>
<text text-anchor="middle" x="2381.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2381.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2381.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2381.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert2_act&#45;&gt;stage5_layer1_expert2_mlp2 -->
<g id="edge1317" class="edge">
<title>stage5_layer1_expert2_act&#45;&gt;stage5_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2404.26,-8865.8C2401.23,-8857.66 2397.83,-8848.51 2394.59,-8839.82"/>
<polygon fill="black" stroke="black" points="2397.82,-8838.45 2391.05,-8830.29 2391.26,-8840.89 2397.82,-8838.45"/>
</g>
<!-- stage5_layer1_expert2_tp2 -->
<g id="node1011" class="node">
<title>stage5_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2349.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2349.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2349.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 644&#45;645</text>
<text text-anchor="middle" x="2349.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2349.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert2_mlp2&#45;&gt;stage5_layer1_expert2_tp2 -->
<g id="edge1318" class="edge">
<title>stage5_layer1_expert2_mlp2&#45;&gt;stage5_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2373.36,-8777.96C2370.73,-8769.99 2367.72,-8760.9 2364.76,-8751.95"/>
<polygon fill="black" stroke="black" points="2368.05,-8750.74 2361.59,-8742.34 2361.4,-8752.94 2368.05,-8750.74"/>
</g>
<!-- stage5_layer1_expert2_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1364" class="edge">
<title>stage5_layer1_expert2_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2508.18,-8678.93C2534.05,-8675.19 2560.59,-8671.59 2585.69,-8668.6 2845.52,-8637.63 3138.5,-8612.05 3367.9,-8594.13"/>
<polygon fill="black" stroke="black" points="3368.39,-8597.6 3378.09,-8593.33 3367.84,-8590.62 3368.39,-8597.6"/>
</g>
<!-- stage5_layer1_expert3_mlp1 -->
<g id="node1013" class="node">
<title>stage5_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3152.69,-9115.68 2838.69,-9115.68 2838.69,-9063.68 3152.69,-9063.68 3152.69,-9115.68"/>
<text text-anchor="middle" x="2995.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="2995.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2995.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2995.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert3&#45;&gt;stage5_layer1_expert3_mlp1 -->
<g id="edge1320" class="edge">
<title>stage5_layer1_expert3&#45;&gt;stage5_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3041.54,-9151.34C3035.06,-9142.77 3027.72,-9133.06 3020.85,-9123.96"/>
<polygon fill="black" stroke="black" points="3023.52,-9121.7 3014.7,-9115.83 3017.94,-9125.92 3023.52,-9121.7"/>
</g>
<!-- stage5_layer1_expert3_tp1 -->
<g id="node1014" class="node">
<title>stage5_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="2931.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2931.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="2931.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="2931.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2931.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert3_mlp1&#45;&gt;stage5_layer1_expert3_tp1 -->
<g id="edge1321" class="edge">
<title>stage5_layer1_expert3_mlp1&#45;&gt;stage5_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M2979.04,-9063.5C2973.48,-9055.1 2967.11,-9045.47 2960.89,-9036.06"/>
<polygon fill="black" stroke="black" points="2963.68,-9033.93 2955.24,-9027.52 2957.84,-9037.79 2963.68,-9033.93"/>
</g>
<!-- stage5_layer1_expert3_act -->
<g id="node1015" class="node">
<title>stage5_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3014.19,-8918.14 2733.19,-8918.14 2733.19,-8866.14 3014.19,-8866.14 3014.19,-8918.14"/>
<text text-anchor="middle" x="2873.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2873.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="2873.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2873.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert3_tp1&#45;&gt;stage5_layer1_expert3_act -->
<g id="edge1322" class="edge">
<title>stage5_layer1_expert3_tp1&#45;&gt;stage5_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2910.26,-8954.15C2904.94,-8945.28 2899.26,-8935.8 2894,-8927.02"/>
<polygon fill="black" stroke="black" points="2896.84,-8924.96 2888.7,-8918.18 2890.84,-8928.56 2896.84,-8924.96"/>
</g>
<!-- stage5_layer1_expert3_mlp2 -->
<g id="node1016" class="node">
<title>stage5_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3009.69,-8830.14 2687.69,-8830.14 2687.69,-8778.14 3009.69,-8778.14 3009.69,-8830.14"/>
<text text-anchor="middle" x="2848.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2848.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2848.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2848.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert3_act&#45;&gt;stage5_layer1_expert3_mlp2 -->
<g id="edge1323" class="edge">
<title>stage5_layer1_expert3_act&#45;&gt;stage5_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2866.32,-8865.8C2863.98,-8857.75 2861.35,-8848.7 2858.85,-8840.1"/>
<polygon fill="black" stroke="black" points="2862.15,-8838.92 2856,-8830.29 2855.43,-8840.87 2862.15,-8838.92"/>
</g>
<!-- stage5_layer1_expert3_tp2 -->
<g id="node1017" class="node">
<title>stage5_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2822.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2822.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2822.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 646&#45;647</text>
<text text-anchor="middle" x="2822.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2822.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert3_mlp2&#45;&gt;stage5_layer1_expert3_tp2 -->
<g id="edge1324" class="edge">
<title>stage5_layer1_expert3_mlp2&#45;&gt;stage5_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2841.93,-8777.96C2839.8,-8770.07 2837.39,-8761.1 2835.01,-8752.24"/>
<polygon fill="black" stroke="black" points="2838.33,-8751.09 2832.35,-8742.34 2831.57,-8752.91 2838.33,-8751.09"/>
</g>
<!-- stage5_layer1_expert3_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1365" class="edge">
<title>stage5_layer1_expert3_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2985.17,-8679.6C3009.8,-8675.89 3034.91,-8672.12 3058.69,-8668.6 3171.56,-8651.86 3294.57,-8633.91 3406.01,-8617.76"/>
<polygon fill="black" stroke="black" points="3406.67,-8621.2 3416.06,-8616.3 3405.67,-8614.27 3406.67,-8621.2"/>
</g>
<!-- stage5_layer1_expert31_mlp1 -->
<g id="node1019" class="node">
<title>stage5_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3538.69,-9115.68 3224.69,-9115.68 3224.69,-9063.68 3538.69,-9063.68 3538.69,-9115.68"/>
<text text-anchor="middle" x="3381.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3381.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3381.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3381.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert31&#45;&gt;stage5_layer1_expert31_mlp1 -->
<g id="edge1326" class="edge">
<title>stage5_layer1_expert31&#45;&gt;stage5_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3408.49,-9151.34C3404.86,-9143.12 3400.76,-9133.85 3396.89,-9125.08"/>
<polygon fill="black" stroke="black" points="3400.05,-9123.57 3392.8,-9115.83 3393.64,-9126.39 3400.05,-9123.57"/>
</g>
<!-- stage5_layer1_expert31_tp1 -->
<g id="node1020" class="node">
<title>stage5_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3351.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3351.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3351.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="3351.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3351.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert31_mlp1&#45;&gt;stage5_layer1_expert31_tp1 -->
<g id="edge1327" class="edge">
<title>stage5_layer1_expert31_mlp1&#45;&gt;stage5_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3373.88,-9063.5C3371.41,-9055.53 3368.6,-9046.44 3365.82,-9037.49"/>
<polygon fill="black" stroke="black" points="3369.15,-9036.4 3362.84,-9027.88 3362.46,-9038.47 3369.15,-9036.4"/>
</g>
<!-- stage5_layer1_expert31_act -->
<g id="node1021" class="node">
<title>stage5_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3478.19,-8918.14 3197.19,-8918.14 3197.19,-8866.14 3478.19,-8866.14 3478.19,-8918.14"/>
<text text-anchor="middle" x="3337.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3337.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="3337.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3337.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert31_tp1&#45;&gt;stage5_layer1_expert31_act -->
<g id="edge1328" class="edge">
<title>stage5_layer1_expert31_tp1&#45;&gt;stage5_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3346.52,-8954.15C3345.29,-8945.65 3343.98,-8936.59 3342.75,-8928.13"/>
<polygon fill="black" stroke="black" points="3346.21,-8927.58 3341.31,-8918.18 3339.28,-8928.58 3346.21,-8927.58"/>
</g>
<!-- stage5_layer1_expert31_mlp2 -->
<g id="node1022" class="node">
<title>stage5_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3484.69,-8830.14 3162.69,-8830.14 3162.69,-8778.14 3484.69,-8778.14 3484.69,-8830.14"/>
<text text-anchor="middle" x="3323.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3323.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3323.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3323.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert31_act&#45;&gt;stage5_layer1_expert31_mlp2 -->
<g id="edge1329" class="edge">
<title>stage5_layer1_expert31_act&#45;&gt;stage5_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3333.56,-8865.8C3332.27,-8857.84 3330.81,-8848.9 3329.43,-8840.38"/>
<polygon fill="black" stroke="black" points="3332.85,-8839.6 3327.78,-8830.29 3325.94,-8840.73 3332.85,-8839.6"/>
</g>
<!-- stage5_layer1_expert31_tp2 -->
<g id="node1023" class="node">
<title>stage5_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3295.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3295.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3295.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 702&#45;703</text>
<text text-anchor="middle" x="3295.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3295.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert31_mlp2&#45;&gt;stage5_layer1_expert31_tp2 -->
<g id="edge1330" class="edge">
<title>stage5_layer1_expert31_mlp2&#45;&gt;stage5_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3316.4,-8777.96C3314.1,-8769.99 3311.47,-8760.9 3308.88,-8751.95"/>
<polygon fill="black" stroke="black" points="3312.24,-8750.98 3306.1,-8742.34 3305.52,-8752.92 3312.24,-8750.98"/>
</g>
<!-- stage5_layer1_expert31_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1366" class="edge">
<title>stage5_layer1_expert31_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3403.02,-8672.88C3441.11,-8661.7 3485.65,-8648.64 3530.28,-8635.54"/>
<polygon fill="black" stroke="black" points="3531.49,-8638.84 3540.1,-8632.66 3529.52,-8632.12 3531.49,-8638.84"/>
</g>
<!-- stage5_layer1_expert32_mlp1 -->
<g id="node1025" class="node">
<title>stage5_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3925.69,-9115.68 3611.69,-9115.68 3611.69,-9063.68 3925.69,-9063.68 3925.69,-9115.68"/>
<text text-anchor="middle" x="3768.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3768.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3768.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert32&#45;&gt;stage5_layer1_expert32_mlp1 -->
<g id="edge1332" class="edge">
<title>stage5_layer1_expert32&#45;&gt;stage5_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3768.69,-9151.34C3768.69,-9143.38 3768.69,-9134.44 3768.69,-9125.92"/>
<polygon fill="black" stroke="black" points="3772.19,-9125.83 3768.69,-9115.83 3765.19,-9125.83 3772.19,-9125.83"/>
</g>
<!-- stage5_layer1_expert32_tp1 -->
<g id="node1026" class="node">
<title>stage5_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3768.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3768.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="3768.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3768.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert32_mlp1&#45;&gt;stage5_layer1_expert32_tp1 -->
<g id="edge1333" class="edge">
<title>stage5_layer1_expert32_mlp1&#45;&gt;stage5_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3768.69,-9063.5C3768.69,-9055.7 3768.69,-9046.83 3768.69,-9038.06"/>
<polygon fill="black" stroke="black" points="3772.19,-9037.88 3768.69,-9027.88 3765.19,-9037.88 3772.19,-9037.88"/>
</g>
<!-- stage5_layer1_expert32_act -->
<g id="node1027" class="node">
<title>stage5_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3909.19,-8918.14 3628.19,-8918.14 3628.19,-8866.14 3909.19,-8866.14 3909.19,-8918.14"/>
<text text-anchor="middle" x="3768.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3768.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="3768.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3768.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert32_tp1&#45;&gt;stage5_layer1_expert32_act -->
<g id="edge1334" class="edge">
<title>stage5_layer1_expert32_tp1&#45;&gt;stage5_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3768.69,-8953.87C3768.69,-8945.56 3768.69,-8936.73 3768.69,-8928.45"/>
<polygon fill="black" stroke="black" points="3772.19,-8928.33 3768.69,-8918.33 3765.19,-8928.33 3772.19,-8928.33"/>
</g>
<!-- stage5_layer1_expert32_mlp2 -->
<g id="node1028" class="node">
<title>stage5_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3929.69,-8830.14 3607.69,-8830.14 3607.69,-8778.14 3929.69,-8778.14 3929.69,-8830.14"/>
<text text-anchor="middle" x="3768.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3768.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3768.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3768.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert32_act&#45;&gt;stage5_layer1_expert32_mlp2 -->
<g id="edge1335" class="edge">
<title>stage5_layer1_expert32_act&#45;&gt;stage5_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3768.69,-8865.8C3768.69,-8857.84 3768.69,-8848.9 3768.69,-8840.38"/>
<polygon fill="black" stroke="black" points="3772.19,-8840.29 3768.69,-8830.29 3765.19,-8840.29 3772.19,-8840.29"/>
</g>
<!-- stage5_layer1_expert32_tp2 -->
<g id="node1029" class="node">
<title>stage5_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3768.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3768.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 704&#45;705</text>
<text text-anchor="middle" x="3768.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert32_mlp2&#45;&gt;stage5_layer1_expert32_tp2 -->
<g id="edge1336" class="edge">
<title>stage5_layer1_expert32_mlp2&#45;&gt;stage5_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3768.69,-8777.96C3768.69,-8770.16 3768.69,-8761.29 3768.69,-8752.52"/>
<polygon fill="black" stroke="black" points="3772.19,-8752.34 3768.69,-8742.34 3765.19,-8752.34 3772.19,-8752.34"/>
</g>
<!-- stage5_layer1_expert32_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1367" class="edge">
<title>stage5_layer1_expert32_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3768.69,-8668.27C3768.69,-8660.33 3768.69,-8651.64 3768.69,-8642.77"/>
<polygon fill="black" stroke="black" points="3772.19,-8642.72 3768.69,-8632.72 3765.19,-8642.72 3772.19,-8642.72"/>
</g>
<!-- stage5_layer1_expert60_mlp1 -->
<g id="node1031" class="node">
<title>stage5_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4331.69,-9115.68 4017.69,-9115.68 4017.69,-9063.68 4331.69,-9063.68 4331.69,-9115.68"/>
<text text-anchor="middle" x="4174.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4174.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4174.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4174.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert60&#45;&gt;stage5_layer1_expert60_mlp1 -->
<g id="edge1338" class="edge">
<title>stage5_layer1_expert60&#45;&gt;stage5_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4159.17,-9151.34C4161.23,-9143.29 4163.54,-9134.24 4165.74,-9125.64"/>
<polygon fill="black" stroke="black" points="4169.17,-9126.39 4168.25,-9115.83 4162.38,-9124.65 4169.17,-9126.39"/>
</g>
<!-- stage5_layer1_expert60_tp1 -->
<g id="node1032" class="node">
<title>stage5_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4197.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4197.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4197.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="4197.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4197.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert60_mlp1&#45;&gt;stage5_layer1_expert60_tp1 -->
<g id="edge1339" class="edge">
<title>stage5_layer1_expert60_mlp1&#45;&gt;stage5_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4180.67,-9063.5C4182.55,-9055.61 4184.68,-9046.64 4186.79,-9037.78"/>
<polygon fill="black" stroke="black" points="4190.23,-9038.42 4189.14,-9027.88 4183.42,-9036.8 4190.23,-9038.42"/>
</g>
<!-- stage5_layer1_expert60_act -->
<g id="node1033" class="node">
<title>stage5_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4345.19,-8918.14 4064.19,-8918.14 4064.19,-8866.14 4345.19,-8866.14 4345.19,-8918.14"/>
<text text-anchor="middle" x="4204.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4204.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="4204.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4204.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert60_tp1&#45;&gt;stage5_layer1_expert60_act -->
<g id="edge1340" class="edge">
<title>stage5_layer1_expert60_tp1&#45;&gt;stage5_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4200.29,-8953.87C4200.9,-8945.56 4201.54,-8936.73 4202.13,-8928.45"/>
<polygon fill="black" stroke="black" points="4205.64,-8928.56 4202.87,-8918.33 4198.65,-8928.05 4205.64,-8928.56"/>
</g>
<!-- stage5_layer1_expert60_mlp2 -->
<g id="node1034" class="node">
<title>stage5_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4394.69,-8830.14 4072.69,-8830.14 4072.69,-8778.14 4394.69,-8778.14 4394.69,-8830.14"/>
<text text-anchor="middle" x="4233.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4233.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4233.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4233.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert60_act&#45;&gt;stage5_layer1_expert60_mlp2 -->
<g id="edge1341" class="edge">
<title>stage5_layer1_expert60_act&#45;&gt;stage5_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4213.23,-8865.8C4215.98,-8857.66 4219.06,-8848.51 4221.99,-8839.82"/>
<polygon fill="black" stroke="black" points="4225.33,-8840.89 4225.21,-8830.29 4218.69,-8838.65 4225.33,-8840.89"/>
</g>
<!-- stage5_layer1_expert60_tp2 -->
<g id="node1035" class="node">
<title>stage5_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4241.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4241.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4241.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 760&#45;761</text>
<text text-anchor="middle" x="4241.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4241.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert60_mlp2&#45;&gt;stage5_layer1_expert60_tp2 -->
<g id="edge1342" class="edge">
<title>stage5_layer1_expert60_mlp2&#45;&gt;stage5_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4235.77,-8777.96C4236.41,-8770.16 4237.15,-8761.29 4237.87,-8752.52"/>
<polygon fill="black" stroke="black" points="4241.38,-8752.6 4238.71,-8742.34 4234.4,-8752.02 4241.38,-8752.6"/>
</g>
<!-- stage5_layer1_expert60_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1368" class="edge">
<title>stage5_layer1_expert60_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4134.36,-8672.88C4096.27,-8661.7 4051.73,-8648.64 4007.1,-8635.54"/>
<polygon fill="black" stroke="black" points="4007.86,-8632.12 3997.28,-8632.66 4005.89,-8638.84 4007.86,-8632.12"/>
</g>
<!-- stage5_layer1_expert61_mlp1 -->
<g id="node1037" class="node">
<title>stage5_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4775.69,-9115.68 4461.69,-9115.68 4461.69,-9063.68 4775.69,-9063.68 4775.69,-9115.68"/>
<text text-anchor="middle" x="4618.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4618.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4618.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4618.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert61&#45;&gt;stage5_layer1_expert61_mlp1 -->
<g id="edge1344" class="edge">
<title>stage5_layer1_expert61&#45;&gt;stage5_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4575.66,-9151.34C4581.68,-9142.85 4588.49,-9133.26 4594.88,-9124.24"/>
<polygon fill="black" stroke="black" points="4597.91,-9126.01 4600.84,-9115.83 4592.2,-9121.96 4597.91,-9126.01"/>
</g>
<!-- stage5_layer1_expert61_tp1 -->
<g id="node1038" class="node">
<title>stage5_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4627.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4627.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4627.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="4627.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4627.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert61_mlp1&#45;&gt;stage5_layer1_expert61_tp1 -->
<g id="edge1345" class="edge">
<title>stage5_layer1_expert61_mlp1&#45;&gt;stage5_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4621.03,-9063.5C4621.76,-9055.7 4622.58,-9046.83 4623.4,-9038.06"/>
<polygon fill="black" stroke="black" points="4626.9,-9038.16 4624.34,-9027.88 4619.93,-9037.52 4626.9,-9038.16"/>
</g>
<!-- stage5_layer1_expert61_act -->
<g id="node1039" class="node">
<title>stage5_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4783.19,-8918.14 4502.19,-8918.14 4502.19,-8866.14 4783.19,-8866.14 4783.19,-8918.14"/>
<text text-anchor="middle" x="4642.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4642.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="4642.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4642.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert61_tp1&#45;&gt;stage5_layer1_expert61_act -->
<g id="edge1346" class="edge">
<title>stage5_layer1_expert61_tp1&#45;&gt;stage5_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4633.23,-8954.15C4634.55,-8945.65 4635.95,-8936.59 4637.26,-8928.13"/>
<polygon fill="black" stroke="black" points="4640.73,-8928.6 4638.81,-8918.18 4633.82,-8927.53 4640.73,-8928.6"/>
</g>
<!-- stage5_layer1_expert61_mlp2 -->
<g id="node1040" class="node">
<title>stage5_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4861.69,-8830.14 4539.69,-8830.14 4539.69,-8778.14 4861.69,-8778.14 4861.69,-8830.14"/>
<text text-anchor="middle" x="4700.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4700.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4700.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4700.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert61_act&#45;&gt;stage5_layer1_expert61_mlp2 -->
<g id="edge1347" class="edge">
<title>stage5_layer1_expert61_act&#45;&gt;stage5_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4659.78,-8865.8C4665.5,-8857.31 4671.97,-8847.72 4678.05,-8838.7"/>
<polygon fill="black" stroke="black" points="4681.03,-8840.54 4683.72,-8830.29 4675.23,-8836.63 4681.03,-8840.54"/>
</g>
<!-- stage5_layer1_expert61_tp2 -->
<g id="node1041" class="node">
<title>stage5_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4714.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4714.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4714.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 762&#45;763</text>
<text text-anchor="middle" x="4714.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4714.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert61_mlp2&#45;&gt;stage5_layer1_expert61_tp2 -->
<g id="edge1348" class="edge">
<title>stage5_layer1_expert61_mlp2&#45;&gt;stage5_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4704.33,-8777.96C4705.46,-8770.16 4706.74,-8761.29 4708.01,-8752.52"/>
<polygon fill="black" stroke="black" points="4711.52,-8752.74 4709.48,-8742.34 4704.59,-8751.74 4711.52,-8752.74"/>
</g>
<!-- stage5_layer1_expert61_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1369" class="edge">
<title>stage5_layer1_expert61_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4552.21,-8679.6C4527.58,-8675.89 4502.46,-8672.12 4478.69,-8668.6 4402.78,-8657.34 4322.27,-8645.53 4243.79,-8634.1"/>
<polygon fill="black" stroke="black" points="4244.13,-8630.61 4233.73,-8632.63 4243.13,-8637.54 4244.13,-8630.61"/>
</g>
<!-- stage5_layer1_expert62_mlp1 -->
<g id="node1043" class="node">
<title>stage5_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5115.69,-9115.68 4801.69,-9115.68 4801.69,-9063.68 5115.69,-9063.68 5115.69,-9115.68"/>
<text text-anchor="middle" x="4958.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="4958.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4958.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4958.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert62&#45;&gt;stage5_layer1_expert62_mlp1 -->
<g id="edge1350" class="edge">
<title>stage5_layer1_expert62&#45;&gt;stage5_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M4938.94,-9151.34C4941.59,-9143.2 4944.57,-9134.05 4947.4,-9125.36"/>
<polygon fill="black" stroke="black" points="4950.73,-9126.43 4950.5,-9115.83 4944.07,-9124.26 4950.73,-9126.43"/>
</g>
<!-- stage5_layer1_expert62_tp1 -->
<g id="node1044" class="node">
<title>stage5_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5050.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5050.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5050.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="5050.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5050.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert62_mlp1&#45;&gt;stage5_layer1_expert62_tp1 -->
<g id="edge1351" class="edge">
<title>stage5_layer1_expert62_mlp1&#45;&gt;stage5_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M4982.62,-9063.5C4991.02,-9054.67 5000.71,-9044.48 5010.09,-9034.61"/>
<polygon fill="black" stroke="black" points="5012.83,-9036.81 5017.18,-9027.15 5007.75,-9031.99 5012.83,-9036.81"/>
</g>
<!-- stage5_layer1_expert62_act -->
<g id="node1045" class="node">
<title>stage5_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5278.19,-8918.14 4997.19,-8918.14 4997.19,-8866.14 5278.19,-8866.14 5278.19,-8918.14"/>
<text text-anchor="middle" x="5137.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5137.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="5137.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5137.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert62_tp1&#45;&gt;stage5_layer1_expert62_act -->
<g id="edge1352" class="edge">
<title>stage5_layer1_expert62_tp1&#45;&gt;stage5_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5082.59,-8954.42C5091,-8945.07 5100.04,-8935.02 5108.31,-8925.82"/>
<polygon fill="black" stroke="black" points="5110.96,-8928.1 5115.04,-8918.32 5105.76,-8923.42 5110.96,-8928.1"/>
</g>
<!-- stage5_layer1_expert62_mlp2 -->
<g id="node1046" class="node">
<title>stage5_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5341.69,-8830.14 5019.69,-8830.14 5019.69,-8778.14 5341.69,-8778.14 5341.69,-8830.14"/>
<text text-anchor="middle" x="5180.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5180.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5180.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5180.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert62_act&#45;&gt;stage5_layer1_expert62_mlp2 -->
<g id="edge1353" class="edge">
<title>stage5_layer1_expert62_act&#45;&gt;stage5_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5150.36,-8865.8C5154.51,-8857.49 5159.2,-8848.11 5163.63,-8839.26"/>
<polygon fill="black" stroke="black" points="5166.77,-8840.8 5168.11,-8830.29 5160.51,-8837.67 5166.77,-8840.8"/>
</g>
<!-- stage5_layer1_expert62_tp2 -->
<g id="node1047" class="node">
<title>stage5_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5187.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5187.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5187.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 764&#45;765</text>
<text text-anchor="middle" x="5187.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5187.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert62_mlp2&#45;&gt;stage5_layer1_expert62_tp2 -->
<g id="edge1354" class="edge">
<title>stage5_layer1_expert62_mlp2&#45;&gt;stage5_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5182.51,-8777.96C5183.07,-8770.16 5183.72,-8761.29 5184.35,-8752.52"/>
<polygon fill="black" stroke="black" points="5187.86,-8752.57 5185.09,-8742.34 5180.87,-8752.07 5187.86,-8752.57"/>
</g>
<!-- stage5_layer1_expert62_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1370" class="edge">
<title>stage5_layer1_expert62_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5029.19,-8678.93C5003.33,-8675.19 4976.79,-8671.59 4951.69,-8668.6 4731.65,-8642.37 4487.82,-8620.01 4278.99,-8602.89"/>
<polygon fill="black" stroke="black" points="4279,-8599.38 4268.75,-8602.05 4278.43,-8606.36 4279,-8599.38"/>
</g>
<!-- stage5_layer1_expert63_mlp1 -->
<g id="node1049" class="node">
<title>stage5_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5451.69,-9115.68 5137.69,-9115.68 5137.69,-9063.68 5451.69,-9063.68 5451.69,-9115.68"/>
<text text-anchor="middle" x="5294.69" y="-9103.68" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5294.69" y="-9092.68" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5294.69" y="-9081.68" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5294.69" y="-9070.68" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage5_layer1_expert63&#45;&gt;stage5_layer1_expert63_mlp1 -->
<g id="edge1356" class="edge">
<title>stage5_layer1_expert63&#45;&gt;stage5_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5289.05,-9151.34C5289.79,-9143.38 5290.62,-9134.44 5291.41,-9125.92"/>
<polygon fill="black" stroke="black" points="5294.91,-9126.11 5292.35,-9115.83 5287.94,-9125.47 5294.91,-9126.11"/>
</g>
<!-- stage5_layer1_expert63_tp1 -->
<g id="node1050" class="node">
<title>stage5_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5498.69" cy="-8990.91" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5498.69" y="-9004.91" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5498.69" y="-8993.91" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="5498.69" y="-8982.91" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5498.69" y="-8971.91" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert63_mlp1&#45;&gt;stage5_layer1_expert63_tp1 -->
<g id="edge1357" class="edge">
<title>stage5_layer1_expert63_mlp1&#45;&gt;stage5_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5347.49,-9063.63C5369.26,-9053.3 5394.97,-9041.11 5418.95,-9029.73"/>
<polygon fill="black" stroke="black" points="5420.51,-9032.87 5428.05,-9025.42 5417.51,-9026.54 5420.51,-9032.87"/>
</g>
<!-- stage5_layer1_expert63_act -->
<g id="node1051" class="node">
<title>stage5_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5711.19,-8918.14 5430.19,-8918.14 5430.19,-8866.14 5711.19,-8866.14 5711.19,-8918.14"/>
<text text-anchor="middle" x="5570.69" y="-8906.14" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5570.69" y="-8895.14" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="5570.69" y="-8884.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5570.69" y="-8873.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage5_layer1_expert63_tp1&#45;&gt;stage5_layer1_expert63_act -->
<g id="edge1358" class="edge">
<title>stage5_layer1_expert63_tp1&#45;&gt;stage5_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5525.09,-8954.42C5531.91,-8945.25 5539.23,-8935.42 5545.96,-8926.37"/>
<polygon fill="black" stroke="black" points="5548.79,-8928.44 5551.95,-8918.32 5543.17,-8924.26 5548.79,-8928.44"/>
</g>
<!-- stage5_layer1_expert63_mlp2 -->
<g id="node1052" class="node">
<title>stage5_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5789.69,-8830.14 5467.69,-8830.14 5467.69,-8778.14 5789.69,-8778.14 5789.69,-8830.14"/>
<text text-anchor="middle" x="5628.69" y="-8818.14" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5628.69" y="-8807.14" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5628.69" y="-8796.14" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5628.69" y="-8785.14" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert63_act&#45;&gt;stage5_layer1_expert63_mlp2 -->
<g id="edge1359" class="edge">
<title>stage5_layer1_expert63_act&#45;&gt;stage5_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5587.78,-8865.8C5593.5,-8857.31 5599.97,-8847.72 5606.05,-8838.7"/>
<polygon fill="black" stroke="black" points="5609.03,-8840.54 5611.72,-8830.29 5603.23,-8836.63 5609.03,-8840.54"/>
</g>
<!-- stage5_layer1_expert63_tp2 -->
<g id="node1053" class="node">
<title>stage5_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5660.69" cy="-8705.37" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5660.69" y="-8719.37" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5660.69" y="-8708.37" font-family="Times,serif" font-size="10.00">GPU: 766&#45;767</text>
<text text-anchor="middle" x="5660.69" y="-8697.37" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5660.69" y="-8686.37" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert63_mlp2&#45;&gt;stage5_layer1_expert63_tp2 -->
<g id="edge1360" class="edge">
<title>stage5_layer1_expert63_mlp2&#45;&gt;stage5_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5637.01,-8777.96C5639.65,-8769.99 5642.65,-8760.9 5645.61,-8751.95"/>
<polygon fill="black" stroke="black" points="5648.97,-8752.94 5648.79,-8742.34 5642.33,-8750.74 5648.97,-8752.94"/>
</g>
<!-- stage5_layer1_expert63_tp2&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1371" class="edge">
<title>stage5_layer1_expert63_tp2&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5504.16,-8678.66C5477.69,-8674.88 5450.44,-8671.35 5424.69,-8668.6 5029.75,-8626.47 4579.84,-8599.84 4248.75,-8584.24"/>
<polygon fill="black" stroke="black" points="4248.65,-8580.73 4238.49,-8583.76 4248.32,-8587.72 4248.65,-8580.73"/>
</g>
<!-- stage5_layer1_expert_ellipsis&#45;&gt;stage5_layer1_expert_agg -->
<g id="edge1372" class="edge">
<title>stage5_layer1_expert_ellipsis&#45;&gt;stage5_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5869.71,-9063.5C5887.35,-9026.97 5916.69,-8956.7 5916.69,-8893.14 5916.69,-8893.14 5916.69,-8893.14 5916.69,-8803.14 5916.69,-8742.75 5942.31,-8709.29 5897.69,-8668.6 5837.07,-8613.31 4838.4,-8585.19 4230.67,-8573.13"/>
<polygon fill="black" stroke="black" points="4230.48,-8569.63 4220.41,-8572.93 4230.34,-8576.63 4230.48,-8569.63"/>
</g>
<!-- stage5_layer1_output -->
<g id="node1056" class="node">
<title>stage5_layer1_output</title>
<polygon fill="none" stroke="black" points="3993.69,-8460.6 3543.69,-8460.6 3543.69,-8392.6 3993.69,-8392.6 3993.69,-8460.6"/>
<text text-anchor="middle" x="3768.69" y="-8445.4" font-family="Times,serif" font-size="14.00">Layer 11 Output</text>
<text text-anchor="middle" x="3768.69" y="-8430.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-8415.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-8400.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_expert_agg&#45;&gt;stage5_layer1_output -->
<g id="edge1373" class="edge">
<title>stage5_layer1_expert_agg&#45;&gt;stage5_layer1_output</title>
<path fill="none" stroke="black" d="M3768.69,-8496.4C3768.69,-8487.64 3768.69,-8478.87 3768.69,-8470.67"/>
<polygon fill="black" stroke="black" points="3772.19,-8470.62 3768.69,-8460.62 3765.19,-8470.62 3772.19,-8470.62"/>
</g>
<!-- stage5_output -->
<g id="node1057" class="node">
<title>stage5_output</title>
<polygon fill="none" stroke="black" points="4235.27,-8356.6 3493.05,-8356.6 3302.11,-8220.6 4044.33,-8220.6 4235.27,-8356.6"/>
<text text-anchor="middle" x="3768.69" y="-8307.4" font-family="Times,serif" font-size="14.00">Stage 5 Output</text>
<text text-anchor="middle" x="3768.69" y="-8292.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 5</text>
<text text-anchor="middle" x="3768.69" y="-8277.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-8262.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_layer1_output&#45;&gt;stage5_output -->
<g id="edge1374" class="edge">
<title>stage5_layer1_output&#45;&gt;stage5_output</title>
<path fill="none" stroke="black" d="M3768.69,-8392.33C3768.69,-8384.5 3768.69,-8375.83 3768.69,-8366.95"/>
<polygon fill="black" stroke="black" points="3772.19,-8366.86 3768.69,-8356.86 3765.19,-8366.86 3772.19,-8366.86"/>
</g>
<!-- stage6_input -->
<g id="node1058" class="node">
<title>stage6_input</title>
<polygon fill="none" stroke="black" points="4235.27,-8184.6 3493.05,-8184.6 3302.11,-8048.6 4044.33,-8048.6 4235.27,-8184.6"/>
<text text-anchor="middle" x="3768.69" y="-8135.4" font-family="Times,serif" font-size="14.00">Stage 6 Input Router</text>
<text text-anchor="middle" x="3768.69" y="-8120.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3768.69" y="-8105.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-8090.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage5_output&#45;&gt;stage6_input -->
<g id="edge1375" class="edge">
<title>stage5_output&#45;&gt;stage6_input</title>
<path fill="none" stroke="black" d="M3768.69,-8220.41C3768.69,-8212.1 3768.69,-8203.54 3768.69,-8195.09"/>
<polygon fill="black" stroke="black" points="3772.19,-8194.86 3768.69,-8184.86 3765.19,-8194.86 3772.19,-8194.86"/>
</g>
<!-- stage6_layer0_ln -->
<g id="node1059" class="node">
<title>stage6_layer0_ln</title>
<polygon fill="none" stroke="black" points="3993.69,-8012.6 3543.69,-8012.6 3543.69,-7944.6 3993.69,-7944.6 3993.69,-8012.6"/>
<text text-anchor="middle" x="3768.69" y="-7997.4" font-family="Times,serif" font-size="14.00">Layer 12 LayerNorm</text>
<text text-anchor="middle" x="3768.69" y="-7982.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3768.69" y="-7967.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-7952.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_input&#45;&gt;stage6_layer0_ln -->
<g id="edge1376" class="edge">
<title>stage6_input&#45;&gt;stage6_layer0_ln</title>
<path fill="none" stroke="black" d="M3768.69,-8048.4C3768.69,-8039.64 3768.69,-8030.87 3768.69,-8022.67"/>
<polygon fill="black" stroke="black" points="3772.19,-8022.62 3768.69,-8012.62 3765.19,-8022.62 3772.19,-8022.62"/>
</g>
<!-- stage6_layer0_attn_qkv -->
<g id="node1060" class="node">
<title>stage6_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="4000.19,-7908.6 3537.19,-7908.6 3537.19,-7840.6 4000.19,-7840.6 4000.19,-7908.6"/>
<text text-anchor="middle" x="3768.69" y="-7893.4" font-family="Times,serif" font-size="14.00">Layer 12 Attention QKV Projection</text>
<text text-anchor="middle" x="3768.69" y="-7878.4" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP: GPU 768&#45;895)</text>
<text text-anchor="middle" x="3768.69" y="-7863.4" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-7848.4" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage6_layer0_ln&#45;&gt;stage6_layer0_attn_qkv -->
<g id="edge1377" class="edge">
<title>stage6_layer0_ln&#45;&gt;stage6_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3768.69,-7944.48C3768.69,-7936.38 3768.69,-7927.58 3768.69,-7919.07"/>
<polygon fill="black" stroke="black" points="3772.19,-7918.9 3768.69,-7908.9 3765.19,-7918.9 3772.19,-7918.9"/>
</g>
<!-- stage6_layer0_tp_qkv_comm -->
<g id="node1061" class="node">
<title>stage6_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-7756.52" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3768.69" y="-7775.32" font-family="Times,serif" font-size="14.00">Layer 12 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3768.69" y="-7760.32" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP pairs)</text>
<text text-anchor="middle" x="3768.69" y="-7745.32" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-7730.32" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage6_layer0_attn_qkv&#45;&gt;stage6_layer0_tp_qkv_comm -->
<g id="edge1378" class="edge">
<title>stage6_layer0_attn_qkv&#45;&gt;stage6_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3768.69,-7840.33C3768.69,-7832.34 3768.69,-7823.57 3768.69,-7814.83"/>
<polygon fill="black" stroke="black" points="3772.19,-7814.62 3768.69,-7804.62 3765.19,-7814.62 3772.19,-7814.62"/>
</g>
<!-- stage6_layer0_attn_head0 -->
<g id="node1062" class="node">
<title>stage6_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1577.19,-7672.43 1304.19,-7672.43 1304.19,-7620.43 1577.19,-7620.43 1577.19,-7672.43"/>
<text text-anchor="middle" x="1440.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 0 Attention</text>
<text text-anchor="middle" x="1440.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 0)</text>
<text text-anchor="middle" x="1440.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1440.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head0 -->
<g id="edge1379" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3445.67,-7748.49C2933.05,-7736.46 1954.56,-7709.66 1587.38,-7672.54"/>
<polygon fill="black" stroke="black" points="1587.54,-7669.04 1577.23,-7671.49 1586.82,-7676 1587.54,-7669.04"/>
</g>
<!-- stage6_layer0_attn_head1 -->
<g id="node1063" class="node">
<title>stage6_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="1868.19,-7672.43 1595.19,-7672.43 1595.19,-7620.43 1868.19,-7620.43 1868.19,-7672.43"/>
<text text-anchor="middle" x="1731.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 1 Attention</text>
<text text-anchor="middle" x="1731.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 1)</text>
<text text-anchor="middle" x="1731.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1731.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head1 -->
<g id="edge1380" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3441.73,-7753.72C3066.12,-7748.77 2431.43,-7731.56 1878.41,-7672.56"/>
<polygon fill="black" stroke="black" points="1878.55,-7669.06 1868.23,-7671.47 1877.8,-7676.02 1878.55,-7669.06"/>
</g>
<!-- stage6_layer0_attn_head2 -->
<g id="node1064" class="node">
<title>stage6_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2159.19,-7672.43 1886.19,-7672.43 1886.19,-7620.43 2159.19,-7620.43 2159.19,-7672.43"/>
<text text-anchor="middle" x="2022.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 2 Attention</text>
<text text-anchor="middle" x="2022.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 2)</text>
<text text-anchor="middle" x="2022.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2022.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head2 -->
<g id="edge1381" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3444.26,-7749.98C3122.63,-7741.85 2615.92,-7721.96 2169.44,-7672.57"/>
<polygon fill="black" stroke="black" points="2169.56,-7669.07 2159.24,-7671.44 2168.79,-7676.02 2169.56,-7669.07"/>
</g>
<!-- stage6_layer0_attn_head3 -->
<g id="node1065" class="node">
<title>stage6_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2450.19,-7672.43 2177.19,-7672.43 2177.19,-7620.43 2450.19,-7620.43 2450.19,-7672.43"/>
<text text-anchor="middle" x="2313.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 3 Attention</text>
<text text-anchor="middle" x="2313.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 3)</text>
<text text-anchor="middle" x="2313.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2313.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head3 -->
<g id="edge1382" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3450.84,-7744.91C3187.62,-7733.87 2803.78,-7712.54 2460.39,-7672.58"/>
<polygon fill="black" stroke="black" points="2460.58,-7669.08 2450.24,-7671.4 2459.77,-7676.03 2460.58,-7669.08"/>
</g>
<!-- stage6_layer0_attn_head4 -->
<g id="node1066" class="node">
<title>stage6_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2741.19,-7672.43 2468.19,-7672.43 2468.19,-7620.43 2741.19,-7620.43 2741.19,-7672.43"/>
<text text-anchor="middle" x="2604.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 4 Attention</text>
<text text-anchor="middle" x="2604.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 4)</text>
<text text-anchor="middle" x="2604.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2604.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head4 -->
<g id="edge1383" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3466.43,-7737.98C3266.07,-7724.63 2997.29,-7703.45 2751.46,-7672.61"/>
<polygon fill="black" stroke="black" points="2751.61,-7669.11 2741.25,-7671.33 2750.73,-7676.05 2751.61,-7669.11"/>
</g>
<!-- stage6_layer0_attn_head5 -->
<g id="node1067" class="node">
<title>stage6_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3032.19,-7672.43 2759.19,-7672.43 2759.19,-7620.43 3032.19,-7620.43 3032.19,-7672.43"/>
<text text-anchor="middle" x="2895.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 5 Attention</text>
<text text-anchor="middle" x="2895.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 5)</text>
<text text-anchor="middle" x="2895.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2895.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head5 -->
<g id="edge1384" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3501.12,-7728.67C3366.28,-7714.23 3200.06,-7695.04 3042.62,-7672.68"/>
<polygon fill="black" stroke="black" points="3042.66,-7669.15 3032.27,-7671.2 3041.67,-7676.08 3042.66,-7669.15"/>
</g>
<!-- stage6_layer0_attn_head6 -->
<g id="node1068" class="node">
<title>stage6_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3323.19,-7672.43 3050.19,-7672.43 3050.19,-7620.43 3323.19,-7620.43 3323.19,-7672.43"/>
<text text-anchor="middle" x="3186.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 6 Attention</text>
<text text-anchor="middle" x="3186.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 6)</text>
<text text-anchor="middle" x="3186.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3186.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head6 -->
<g id="edge1385" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3568.8,-7718.39C3490.89,-7703.93 3403.29,-7687.66 3331.64,-7674.35"/>
<polygon fill="black" stroke="black" points="3332.1,-7670.88 3321.63,-7672.49 3330.83,-7677.76 3332.1,-7670.88"/>
</g>
<!-- stage6_layer0_attn_head7 -->
<g id="node1069" class="node">
<title>stage6_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3614.19,-7672.43 3341.19,-7672.43 3341.19,-7620.43 3614.19,-7620.43 3614.19,-7672.43"/>
<text text-anchor="middle" x="3477.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 7 Attention</text>
<text text-anchor="middle" x="3477.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 7)</text>
<text text-anchor="middle" x="3477.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3477.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head7 -->
<g id="edge1386" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3650.33,-7711.55C3618.09,-7699.58 3584.02,-7686.93 3554.74,-7676.05"/>
<polygon fill="black" stroke="black" points="3555.59,-7672.63 3545,-7672.43 3553.15,-7679.19 3555.59,-7672.63"/>
</g>
<!-- stage6_layer0_attn_ellipsis -->
<g id="node1070" class="node">
<title>stage6_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3905.19,-7672.43 3632.19,-7672.43 3632.19,-7620.43 3905.19,-7620.43 3905.19,-7672.43"/>
<text text-anchor="middle" x="3768.69" y="-7660.43" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3768.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3768.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_ellipsis -->
<g id="edge1387" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3768.69,-7708.42C3768.69,-7699.88 3768.69,-7691.1 3768.69,-7682.96"/>
<polygon fill="black" stroke="black" points="3772.19,-7682.7 3768.69,-7672.7 3765.19,-7682.7 3772.19,-7682.7"/>
</g>
<!-- stage6_layer0_attn_head24 -->
<g id="node1071" class="node">
<title>stage6_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4196.19,-7672.43 3923.19,-7672.43 3923.19,-7620.43 4196.19,-7620.43 4196.19,-7672.43"/>
<text text-anchor="middle" x="4059.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 24 Attention</text>
<text text-anchor="middle" x="4059.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 24)</text>
<text text-anchor="middle" x="4059.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4059.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head24 -->
<g id="edge1388" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M3887.05,-7711.55C3919.28,-7699.58 3953.36,-7686.93 3982.64,-7676.05"/>
<polygon fill="black" stroke="black" points="3984.22,-7679.19 3992.38,-7672.43 3981.79,-7672.63 3984.22,-7679.19"/>
</g>
<!-- stage6_layer0_attn_head25 -->
<g id="node1072" class="node">
<title>stage6_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4487.19,-7672.43 4214.19,-7672.43 4214.19,-7620.43 4487.19,-7620.43 4487.19,-7672.43"/>
<text text-anchor="middle" x="4350.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 25 Attention</text>
<text text-anchor="middle" x="4350.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 25)</text>
<text text-anchor="middle" x="4350.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4350.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head25 -->
<g id="edge1389" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M3968.57,-7718.39C4046.48,-7703.93 4134.09,-7687.66 4205.74,-7674.35"/>
<polygon fill="black" stroke="black" points="4206.55,-7677.76 4215.74,-7672.49 4205.27,-7670.88 4206.55,-7677.76"/>
</g>
<!-- stage6_layer0_attn_head26 -->
<g id="node1073" class="node">
<title>stage6_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4778.19,-7672.43 4505.19,-7672.43 4505.19,-7620.43 4778.19,-7620.43 4778.19,-7672.43"/>
<text text-anchor="middle" x="4641.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 26 Attention</text>
<text text-anchor="middle" x="4641.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 26)</text>
<text text-anchor="middle" x="4641.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4641.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head26 -->
<g id="edge1390" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4035.45,-7728.63C4170.31,-7714.15 4336.69,-7694.92 4495.01,-7672.5"/>
<polygon fill="black" stroke="black" points="4495.54,-7675.96 4504.95,-7671.08 4494.55,-7669.03 4495.54,-7675.96"/>
</g>
<!-- stage6_layer0_attn_head27 -->
<g id="node1074" class="node">
<title>stage6_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5069.19,-7672.43 4796.19,-7672.43 4796.19,-7620.43 5069.19,-7620.43 5069.19,-7672.43"/>
<text text-anchor="middle" x="4932.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 27 Attention</text>
<text text-anchor="middle" x="4932.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 27)</text>
<text text-anchor="middle" x="4932.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4932.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head27 -->
<g id="edge1391" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4070.64,-7737.87C4270.8,-7724.49 4539.31,-7703.29 4785.73,-7672.51"/>
<polygon fill="black" stroke="black" points="4786.48,-7675.94 4795.96,-7671.22 4785.61,-7668.99 4786.48,-7675.94"/>
</g>
<!-- stage6_layer0_attn_head28 -->
<g id="node1075" class="node">
<title>stage6_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5360.19,-7672.43 5087.19,-7672.43 5087.19,-7620.43 5360.19,-7620.43 5360.19,-7672.43"/>
<text text-anchor="middle" x="5223.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 28 Attention</text>
<text text-anchor="middle" x="5223.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 28)</text>
<text text-anchor="middle" x="5223.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5223.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head28 -->
<g id="edge1392" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4086.28,-7744.8C4349.3,-7733.69 4732.83,-7712.32 5076.81,-7672.48"/>
<polygon fill="black" stroke="black" points="5077.45,-7675.93 5086.97,-7671.29 5076.64,-7668.98 5077.45,-7675.93"/>
</g>
<!-- stage6_layer0_attn_head29 -->
<g id="node1076" class="node">
<title>stage6_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5651.19,-7672.43 5378.19,-7672.43 5378.19,-7620.43 5651.19,-7620.43 5651.19,-7672.43"/>
<text text-anchor="middle" x="5514.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 29 Attention</text>
<text text-anchor="middle" x="5514.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 29)</text>
<text text-anchor="middle" x="5514.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5514.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head29 -->
<g id="edge1393" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4093.28,-7749.85C4414.72,-7741.63 4920.89,-7721.67 5367.77,-7672.47"/>
<polygon fill="black" stroke="black" points="5368.43,-7675.92 5377.98,-7671.34 5367.66,-7668.96 5368.43,-7675.92"/>
</g>
<!-- stage6_layer0_attn_head30 -->
<g id="node1077" class="node">
<title>stage6_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="5942.19,-7672.43 5669.19,-7672.43 5669.19,-7620.43 5942.19,-7620.43 5942.19,-7672.43"/>
<text text-anchor="middle" x="5805.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 30 Attention</text>
<text text-anchor="middle" x="5805.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 30)</text>
<text text-anchor="middle" x="5805.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5805.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head30 -->
<g id="edge1394" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4095.89,-7753.6C4471.34,-7748.53 5105.41,-7731.2 5658.8,-7672.46"/>
<polygon fill="black" stroke="black" points="5659.41,-7675.92 5668.98,-7671.38 5658.67,-7668.96 5659.41,-7675.92"/>
</g>
<!-- stage6_layer0_attn_head31 -->
<g id="node1078" class="node">
<title>stage6_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6233.19,-7672.43 5960.19,-7672.43 5960.19,-7620.43 6233.19,-7620.43 6233.19,-7672.43"/>
<text text-anchor="middle" x="6096.69" y="-7660.43" font-family="Times,serif" font-size="10.00">Layer 12 Head 31 Attention</text>
<text text-anchor="middle" x="6096.69" y="-7649.43" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 31)</text>
<text text-anchor="middle" x="6096.69" y="-7638.43" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6096.69" y="-7627.43" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head31 -->
<g id="edge1395" class="edge">
<title>stage6_layer0_tp_qkv_comm&#45;&gt;stage6_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4091.55,-7748.44C4603.93,-7736.34 5581.97,-7709.44 5949.81,-7672.44"/>
<polygon fill="black" stroke="black" points="5950.39,-7675.9 5959.99,-7671.4 5949.68,-7668.94 5950.39,-7675.9"/>
</g>
<!-- stage6_layer0_attn_agg -->
<g id="node1079" class="node">
<title>stage6_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4236.34,-7584.43 3492.41,-7584.43 3301.04,-7448.43 4044.97,-7448.43 4236.34,-7584.43"/>
<text text-anchor="middle" x="3768.69" y="-7535.23" font-family="Times,serif" font-size="14.00">Layer 12 Attention Aggregate</text>
<text text-anchor="middle" x="3768.69" y="-7520.23" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3768.69" y="-7505.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3768.69" y="-7490.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_attn_head0&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1396" class="edge">
<title>stage6_layer0_attn_head0&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1577.23,-7621.41C1580.07,-7621.06 1582.9,-7620.74 1585.69,-7620.43 2217.18,-7551.36 2956.43,-7528.58 3392.36,-7521.09"/>
<polygon fill="black" stroke="black" points="3392.67,-7524.58 3402.61,-7520.91 3392.55,-7517.58 3392.67,-7524.58"/>
</g>
<!-- stage6_layer0_attn_head1&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1397" class="edge">
<title>stage6_layer0_attn_head1&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1868.24,-7621.43C1871.08,-7621.08 1873.9,-7620.75 1876.69,-7620.43 2402.99,-7560.94 3015.69,-7535.54 3397.91,-7524.88"/>
<polygon fill="black" stroke="black" points="3398.12,-7528.37 3408.02,-7524.6 3397.93,-7521.38 3398.12,-7528.37"/>
</g>
<!-- stage6_layer0_attn_head2&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1398" class="edge">
<title>stage6_layer0_attn_head2&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2159.24,-7621.47C2162.08,-7621.11 2164.9,-7620.76 2167.69,-7620.43 2590.66,-7570.51 3079.57,-7543.47 3404.72,-7529.8"/>
<polygon fill="black" stroke="black" points="3404.93,-7533.29 3414.77,-7529.38 3404.63,-7526.3 3404.93,-7533.29"/>
</g>
<!-- stage6_layer0_attn_head3&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1399" class="edge">
<title>stage6_layer0_attn_head3&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2450.25,-7621.53C2453.08,-7621.15 2455.9,-7620.78 2458.69,-7620.43 2780.79,-7580.09 3149.56,-7552.77 3413.59,-7536.46"/>
<polygon fill="black" stroke="black" points="3413.96,-7539.95 3423.72,-7535.84 3413.53,-7532.96 3413.96,-7539.95"/>
</g>
<!-- stage6_layer0_attn_head4&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1400" class="edge">
<title>stage6_layer0_attn_head4&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2741.26,-7621.61C2744.09,-7621.21 2746.9,-7620.81 2749.69,-7620.43 2974.59,-7589.72 3228.58,-7564.02 3426.72,-7545.98"/>
<polygon fill="black" stroke="black" points="3427.07,-7549.46 3436.71,-7545.07 3426.43,-7542.49 3427.07,-7549.46"/>
</g>
<!-- stage6_layer0_attn_head5&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1401" class="edge">
<title>stage6_layer0_attn_head5&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3032.28,-7621.76C3035.11,-7621.31 3037.91,-7620.87 3040.69,-7620.43 3173.44,-7599.6 3320.12,-7578.48 3446.83,-7560.84"/>
<polygon fill="black" stroke="black" points="3447.65,-7564.26 3457.08,-7559.41 3446.69,-7557.33 3447.65,-7564.26"/>
</g>
<!-- stage6_layer0_attn_head6&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1402" class="edge">
<title>stage6_layer0_attn_head6&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3300.63,-7620.37C3351.21,-7609.25 3413.29,-7595.6 3475.5,-7581.91"/>
<polygon fill="black" stroke="black" points="3476.47,-7585.28 3485.49,-7579.72 3474.97,-7578.45 3476.47,-7585.28"/>
</g>
<!-- stage6_layer0_attn_head7&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1403" class="edge">
<title>stage6_layer0_attn_head7&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3534.83,-7620.3C3556.01,-7610.98 3581.2,-7599.9 3607.08,-7588.52"/>
<polygon fill="black" stroke="black" points="3608.51,-7591.71 3616.25,-7584.48 3605.69,-7585.31 3608.51,-7591.71"/>
</g>
<!-- stage6_layer0_attn_ellipsis&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1404" class="edge">
<title>stage6_layer0_attn_ellipsis&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3768.69,-7620.14C3768.69,-7612.55 3768.69,-7603.78 3768.69,-7594.64"/>
<polygon fill="black" stroke="black" points="3772.19,-7594.62 3768.69,-7584.62 3765.19,-7594.62 3772.19,-7594.62"/>
</g>
<!-- stage6_layer0_attn_head24&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1405" class="edge">
<title>stage6_layer0_attn_head24&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4002.54,-7620.3C3981.37,-7610.98 3956.18,-7599.9 3930.3,-7588.52"/>
<polygon fill="black" stroke="black" points="3931.69,-7585.31 3921.12,-7584.48 3928.87,-7591.71 3931.69,-7585.31"/>
</g>
<!-- stage6_layer0_attn_head25&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1406" class="edge">
<title>stage6_layer0_attn_head25&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4236.74,-7620.37C4192.03,-7610.54 4138.31,-7598.72 4083.45,-7586.66"/>
<polygon fill="black" stroke="black" points="4084.08,-7583.21 4073.56,-7584.48 4082.58,-7590.05 4084.08,-7583.21"/>
</g>
<!-- stage6_layer0_attn_head26&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1407" class="edge">
<title>stage6_layer0_attn_head26&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4504.93,-7621.89C4501.82,-7621.4 4498.74,-7620.91 4495.69,-7620.43 4413.61,-7607.59 4326.21,-7594.62 4241.51,-7582.4"/>
<polygon fill="black" stroke="black" points="4241.86,-7578.92 4231.46,-7580.96 4240.86,-7585.85 4241.86,-7578.92"/>
</g>
<!-- stage6_layer0_attn_head27&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1408" class="edge">
<title>stage6_layer0_attn_head27&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4795.95,-7621.73C4792.84,-7621.28 4789.75,-7620.85 4786.69,-7620.43 4596.01,-7594.49 4384.43,-7572.06 4203.77,-7554.82"/>
<polygon fill="black" stroke="black" points="4203.84,-7551.31 4193.56,-7553.84 4203.18,-7558.28 4203.84,-7551.31"/>
</g>
<!-- stage6_layer0_attn_head28&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1409" class="edge">
<title>stage6_layer0_attn_head28&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5086.97,-7621.63C5083.85,-7621.21 5080.75,-7620.81 5077.69,-7620.43 4779.68,-7583.27 4441.74,-7557.08 4183.88,-7540.41"/>
<polygon fill="black" stroke="black" points="4183.79,-7536.9 4173.59,-7539.75 4183.34,-7543.88 4183.79,-7536.9"/>
</g>
<!-- stage6_layer0_attn_head29&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1410" class="edge">
<title>stage6_layer0_attn_head29&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5377.97,-7621.57C5374.85,-7621.17 5371.75,-7620.79 5368.69,-7620.43 4962.71,-7572.74 4495.99,-7545.87 4171.82,-7531.63"/>
<polygon fill="black" stroke="black" points="4171.94,-7528.13 4161.79,-7531.19 4171.63,-7535.12 4171.94,-7528.13"/>
</g>
<!-- stage6_layer0_attn_head30&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1411" class="edge">
<title>stage6_layer0_attn_head30&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5668.98,-7621.53C5665.85,-7621.14 5662.75,-7620.78 5659.69,-7620.43 5144.76,-7562.52 4547.15,-7536.87 4163.82,-7525.72"/>
<polygon fill="black" stroke="black" points="4163.77,-7522.21 4153.67,-7525.42 4163.57,-7529.21 4163.77,-7522.21"/>
</g>
<!-- stage6_layer0_attn_head31&#45;&gt;stage6_layer0_attn_agg -->
<g id="edge1412" class="edge">
<title>stage6_layer0_attn_head31&#45;&gt;stage6_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5959.98,-7621.5C5956.86,-7621.12 5953.76,-7620.77 5950.69,-7620.43 5325.76,-7552.44 4595.31,-7529.31 4157.99,-7521.46"/>
<polygon fill="black" stroke="black" points="4157.77,-7517.95 4147.71,-7521.27 4157.65,-7524.95 4157.77,-7517.95"/>
</g>
<!-- stage6_layer0_attn_out -->
<g id="node1080" class="node">
<title>stage6_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="3993.69,-7412.43 3543.69,-7412.43 3543.69,-7344.43 3993.69,-7344.43 3993.69,-7412.43"/>
<text text-anchor="middle" x="3768.69" y="-7397.23" font-family="Times,serif" font-size="14.00">Layer 12 Attention Output Proj</text>
<text text-anchor="middle" x="3768.69" y="-7382.23" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP: GPU 768&#45;895)</text>
<text text-anchor="middle" x="3768.69" y="-7367.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-7352.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_attn_agg&#45;&gt;stage6_layer0_attn_out -->
<g id="edge1413" class="edge">
<title>stage6_layer0_attn_agg&#45;&gt;stage6_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3768.69,-7448.23C3768.69,-7439.48 3768.69,-7430.71 3768.69,-7422.5"/>
<polygon fill="black" stroke="black" points="3772.19,-7422.45 3768.69,-7412.45 3765.19,-7422.45 3772.19,-7422.45"/>
</g>
<!-- stage6_layer0_tp_attn_comm -->
<g id="node1081" class="node">
<title>stage6_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3768.69" cy="-7260.35" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3768.69" y="-7279.15" font-family="Times,serif" font-size="14.00">Layer 12 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3768.69" y="-7264.15" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP pairs)</text>
<text text-anchor="middle" x="3768.69" y="-7249.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3768.69" y="-7234.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_attn_out&#45;&gt;stage6_layer0_tp_attn_comm -->
<g id="edge1414" class="edge">
<title>stage6_layer0_attn_out&#45;&gt;stage6_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3768.69,-7344.17C3768.69,-7336.17 3768.69,-7327.41 3768.69,-7318.66"/>
<polygon fill="black" stroke="black" points="3772.19,-7318.46 3768.69,-7308.46 3765.19,-7318.46 3772.19,-7318.46"/>
</g>
<!-- stage6_layer0_expert_router -->
<g id="node1082" class="node">
<title>stage6_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3366.88,-7176.27 2644.36,-7176.27 2458.49,-7040.27 3181.02,-7040.27 3366.88,-7176.27"/>
<text text-anchor="middle" x="2912.69" y="-7127.07" font-family="Times,serif" font-size="14.00">Layer 12 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2912.69" y="-7112.07" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="2912.69" y="-7097.07" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2912.69" y="-7082.07" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage6_layer0_tp_attn_comm&#45;&gt;stage6_layer0_expert_router -->
<g id="edge1415" class="edge">
<title>stage6_layer0_tp_attn_comm&#45;&gt;stage6_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3564.2,-7223.5C3486.26,-7209.83 3394.58,-7193.76 3304.99,-7178.05"/>
<polygon fill="black" stroke="black" points="3305.38,-7174.56 3294.93,-7176.28 3304.17,-7181.46 3305.38,-7174.56"/>
</g>
<!-- stage6_layer0_output -->
<g id="node1145" class="node">
<title>stage6_layer0_output</title>
<polygon fill="none" stroke="black" points="3980.69,-6261.19 3530.69,-6261.19 3530.69,-6193.19 3980.69,-6193.19 3980.69,-6261.19"/>
<text text-anchor="middle" x="3755.69" y="-6245.99" font-family="Times,serif" font-size="14.00">Layer 12 Output</text>
<text text-anchor="middle" x="3755.69" y="-6230.99" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-6215.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-6200.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_tp_attn_comm&#45;&gt;stage6_layer0_output -->
<!-- stage6_layer0_expert0 -->
<g id="node1083" class="node">
<title>stage6_layer0_expert0</title>
<polygon fill="none" stroke="black" points="864.69,-7004.27 542.69,-7004.27 542.69,-6952.27 864.69,-6952.27 864.69,-7004.27"/>
<text text-anchor="middle" x="703.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 0</text>
<text text-anchor="middle" x="703.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP pair)</text>
<text text-anchor="middle" x="703.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="703.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert0 -->
<g id="edge1416" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2524.41,-7088.51C2143.58,-7069.53 1546.48,-7038.21 1029.69,-7004.27 979.48,-7000.97 924.96,-6996.96 875.12,-6993.12"/>
<polygon fill="black" stroke="black" points="875.13,-6989.61 864.89,-6992.33 874.6,-6996.59 875.13,-6989.61"/>
</g>
<!-- stage6_layer0_expert1 -->
<g id="node1089" class="node">
<title>stage6_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1360.69,-7004.27 1038.69,-7004.27 1038.69,-6952.27 1360.69,-6952.27 1360.69,-7004.27"/>
<text text-anchor="middle" x="1199.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 1</text>
<text text-anchor="middle" x="1199.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP pair)</text>
<text text-anchor="middle" x="1199.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1199.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert1 -->
<g id="edge1422" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2516.44,-7082.66C2221.53,-7063.56 1809.22,-7035.19 1447.69,-7004.27 1422.85,-7002.14 1396.64,-6999.71 1370.92,-6997.21"/>
<polygon fill="black" stroke="black" points="1371,-6993.7 1360.71,-6996.21 1370.32,-7000.67 1371,-6993.7"/>
</g>
<!-- stage6_layer0_expert2 -->
<g id="node1095" class="node">
<title>stage6_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1778.69,-7004.27 1456.69,-7004.27 1456.69,-6952.27 1778.69,-6952.27 1778.69,-7004.27"/>
<text text-anchor="middle" x="1617.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 2</text>
<text text-anchor="middle" x="1617.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP pair)</text>
<text text-anchor="middle" x="1617.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1617.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert2 -->
<g id="edge1428" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2499.57,-7070.48C2296.72,-7051.81 2048.77,-7028.08 1826.69,-7004.27 1814.43,-7002.95 1801.78,-7001.55 1789.04,-7000.11"/>
<polygon fill="black" stroke="black" points="1789.15,-6996.6 1778.81,-6998.94 1788.35,-7003.55 1789.15,-6996.6"/>
</g>
<!-- stage6_layer0_expert3 -->
<g id="node1101" class="node">
<title>stage6_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2157.69,-7004.27 1835.69,-7004.27 1835.69,-6952.27 2157.69,-6952.27 2157.69,-7004.27"/>
<text text-anchor="middle" x="1996.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 3</text>
<text text-anchor="middle" x="1996.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP pair)</text>
<text text-anchor="middle" x="1996.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1996.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert3 -->
<g id="edge1434" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2464.42,-7044.62C2358.74,-7029.86 2252.37,-7014.99 2167.83,-7003.18"/>
<polygon fill="black" stroke="black" points="2168.28,-6999.71 2157.89,-7001.79 2167.31,-7006.64 2168.28,-6999.71"/>
</g>
<!-- stage6_layer0_expert31 -->
<g id="node1107" class="node">
<title>stage6_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2516.69,-7004.27 2194.69,-7004.27 2194.69,-6952.27 2516.69,-6952.27 2516.69,-7004.27"/>
<text text-anchor="middle" x="2355.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 31</text>
<text text-anchor="middle" x="2355.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP pair)</text>
<text text-anchor="middle" x="2355.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2355.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert31 -->
<g id="edge1440" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2620.73,-7040.17C2569.02,-7028.29 2517.92,-7016.55 2474.6,-7006.59"/>
<polygon fill="black" stroke="black" points="2475.16,-7003.13 2464.63,-7004.3 2473.59,-7009.95 2475.16,-7003.13"/>
</g>
<!-- stage6_layer0_expert32 -->
<g id="node1113" class="node">
<title>stage6_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2893.69,-7004.27 2571.69,-7004.27 2571.69,-6952.27 2893.69,-6952.27 2893.69,-7004.27"/>
<text text-anchor="middle" x="2732.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 32</text>
<text text-anchor="middle" x="2732.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP pair)</text>
<text text-anchor="middle" x="2732.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2732.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert32 -->
<g id="edge1446" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2818.21,-7040.08C2803.73,-7029.78 2789.4,-7019.59 2776.73,-7010.58"/>
<polygon fill="black" stroke="black" points="2778.42,-7007.49 2768.24,-7004.55 2774.37,-7013.2 2778.42,-7007.49"/>
</g>
<!-- stage6_layer0_expert60 -->
<g id="node1119" class="node">
<title>stage6_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3252.69,-7004.27 2930.69,-7004.27 2930.69,-6952.27 3252.69,-6952.27 3252.69,-7004.27"/>
<text text-anchor="middle" x="3091.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 60</text>
<text text-anchor="middle" x="3091.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP pair)</text>
<text text-anchor="middle" x="3091.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3091.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert60 -->
<g id="edge1452" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3006.64,-7040.08C3021.05,-7029.78 3035.29,-7019.59 3047.89,-7010.58"/>
<polygon fill="black" stroke="black" points="3050.23,-7013.21 3056.33,-7004.55 3046.16,-7007.52 3050.23,-7013.21"/>
</g>
<!-- stage6_layer0_expert61 -->
<g id="node1125" class="node">
<title>stage6_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3620.69,-7004.27 3298.69,-7004.27 3298.69,-6952.27 3620.69,-6952.27 3620.69,-7004.27"/>
<text text-anchor="middle" x="3459.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 61</text>
<text text-anchor="middle" x="3459.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP pair)</text>
<text text-anchor="middle" x="3459.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3459.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert61 -->
<g id="edge1458" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3185.39,-7043.45C3240.85,-7030.47 3296.36,-7017.48 3342.79,-7006.62"/>
<polygon fill="black" stroke="black" points="3343.61,-7010.02 3352.55,-7004.34 3342.02,-7003.21 3343.61,-7010.02"/>
</g>
<!-- stage6_layer0_expert62 -->
<g id="node1131" class="node">
<title>stage6_layer0_expert62</title>
<polygon fill="none" stroke="black" points="4111.69,-7004.27 3789.69,-7004.27 3789.69,-6952.27 4111.69,-6952.27 4111.69,-7004.27"/>
<text text-anchor="middle" x="3950.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 62</text>
<text text-anchor="middle" x="3950.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP pair)</text>
<text text-anchor="middle" x="3950.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3950.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert62 -->
<g id="edge1464" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3220.96,-7069.25C3403.39,-7046.76 3627.66,-7019.1 3779.04,-7000.43"/>
<polygon fill="black" stroke="black" points="3779.86,-7003.86 3789.36,-6999.16 3779.01,-6996.91 3779.86,-7003.86"/>
</g>
<!-- stage6_layer0_expert63 -->
<g id="node1137" class="node">
<title>stage6_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4454.69,-7004.27 4132.69,-7004.27 4132.69,-6952.27 4454.69,-6952.27 4454.69,-7004.27"/>
<text text-anchor="middle" x="4293.69" y="-6992.27" font-family="Times,serif" font-size="10.00">Layer 12 Expert 63</text>
<text text-anchor="middle" x="4293.69" y="-6981.27" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP pair)</text>
<text text-anchor="middle" x="4293.69" y="-6970.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4293.69" y="-6959.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert63 -->
<g id="edge1470" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3241.66,-7084.43C3484.85,-7066.29 3823.88,-7038.33 4120.69,-7004.27 4121.3,-7004.19 4121.91,-7004.12 4122.53,-7004.05"/>
<polygon fill="black" stroke="black" points="4123.06,-7007.52 4132.58,-7002.86 4122.23,-7000.56 4123.06,-7007.52"/>
</g>
<!-- stage6_layer0_expert_ellipsis -->
<g id="node1143" class="node">
<title>stage6_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4814.69,-6916.27 4492.69,-6916.27 4492.69,-6864.27 4814.69,-6864.27 4814.69,-6916.27"/>
<text text-anchor="middle" x="4653.69" y="-6904.27" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4653.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4653.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4653.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert_ellipsis -->
<g id="edge1476" class="edge">
<title>stage6_layer0_expert_router&#45;&gt;stage6_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3266.71,-7102.83C3654.04,-7094.61 4248.51,-7071.16 4463.69,-7004.27 4520.01,-6986.75 4577.18,-6949.55 4613.89,-6922.6"/>
<polygon fill="black" stroke="black" points="4616.38,-6925.11 4622.31,-6916.33 4612.2,-6919.49 4616.38,-6925.11"/>
</g>
<!-- stage6_layer0_expert0_mlp1 -->
<g id="node1084" class="node">
<title>stage6_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="757.69,-6916.27 443.69,-6916.27 443.69,-6864.27 757.69,-6864.27 757.69,-6916.27"/>
<text text-anchor="middle" x="600.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="600.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP: Column Parallel)</text>
<text text-anchor="middle" x="600.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="600.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert0&#45;&gt;stage6_layer0_expert0_mlp1 -->
<g id="edge1417" class="edge">
<title>stage6_layer0_expert0&#45;&gt;stage6_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M673.62,-6952.16C662.72,-6943.06 650.25,-6932.65 638.75,-6923.05"/>
<polygon fill="black" stroke="black" points="640.89,-6920.27 630.97,-6916.55 636.41,-6925.65 640.89,-6920.27"/>
</g>
<!-- stage6_layer0_expert0_tp1 -->
<g id="node1085" class="node">
<title>stage6_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="559.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="559.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="559.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="559.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="559.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert0_mlp1&#45;&gt;stage6_layer0_expert0_tp1 -->
<g id="edge1418" class="edge">
<title>stage6_layer0_expert0_mlp1&#45;&gt;stage6_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M590.02,-6864.09C586.61,-6856.03 582.71,-6846.84 578.88,-6837.79"/>
<polygon fill="black" stroke="black" points="582.06,-6836.31 574.93,-6828.47 575.61,-6839.05 582.06,-6836.31"/>
</g>
<!-- stage6_layer0_expert0_act -->
<g id="node1086" class="node">
<title>stage6_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="699.19,-6718.73 418.19,-6718.73 418.19,-6666.73 699.19,-6666.73 699.19,-6718.73"/>
<text text-anchor="middle" x="558.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="558.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="558.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="558.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert0_tp1&#45;&gt;stage6_layer0_expert0_act -->
<g id="edge1419" class="edge">
<title>stage6_layer0_expert0_tp1&#45;&gt;stage6_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M559.32,-6754.46C559.23,-6746.15 559.14,-6737.32 559.05,-6729.04"/>
<polygon fill="black" stroke="black" points="562.55,-6728.89 558.95,-6718.92 555.55,-6728.96 562.55,-6728.89"/>
</g>
<!-- stage6_layer0_expert0_mlp2 -->
<g id="node1087" class="node">
<title>stage6_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="545.69,-6630.73 223.69,-6630.73 223.69,-6578.73 545.69,-6578.73 545.69,-6630.73"/>
<text text-anchor="middle" x="384.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="384.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP: Row Parallel)</text>
<text text-anchor="middle" x="384.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="384.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert0_act&#45;&gt;stage6_layer0_expert0_mlp2 -->
<g id="edge1420" class="edge">
<title>stage6_layer0_expert0_act&#45;&gt;stage6_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M507.89,-6666.62C488.06,-6656.82 465.17,-6645.5 444.54,-6635.31"/>
<polygon fill="black" stroke="black" points="446.06,-6632.16 435.55,-6630.86 442.96,-6638.43 446.06,-6632.16"/>
</g>
<!-- stage6_layer0_expert0_tp2 -->
<g id="node1088" class="node">
<title>stage6_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="297.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="297.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="297.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="297.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="297.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert0_mlp2&#45;&gt;stage6_layer0_expert0_tp2 -->
<g id="edge1421" class="edge">
<title>stage6_layer0_expert0_mlp2&#45;&gt;stage6_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M362.06,-6578.55C354.27,-6569.89 345.32,-6559.93 336.61,-6550.25"/>
<polygon fill="black" stroke="black" points="338.99,-6547.66 329.7,-6542.57 333.79,-6552.34 338.99,-6547.66"/>
</g>
<!-- stage6_layer0_expert_agg -->
<g id="node1144" class="node">
<title>stage6_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3450.22,-6433.19 2574.45,-6433.19 2349.16,-6297.19 3224.93,-6297.19 3450.22,-6433.19"/>
<text text-anchor="middle" x="2899.69" y="-6383.99" font-family="Times,serif" font-size="14.00">Layer 12 Expert Aggregation</text>
<text text-anchor="middle" x="2899.69" y="-6368.99" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="2899.69" y="-6353.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2899.69" y="-6338.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert0_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1477" class="edge">
<title>stage6_layer0_expert0_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M452.9,-6479.02C479.78,-6475.22 507.5,-6471.73 533.69,-6469.19 1204.12,-6403.97 1985.46,-6380.05 2461.17,-6371.27"/>
<polygon fill="black" stroke="black" points="2461.37,-6374.76 2471.3,-6371.08 2461.24,-6367.77 2461.37,-6374.76"/>
</g>
<!-- stage6_layer0_expert1_mlp1 -->
<g id="node1090" class="node">
<title>stage6_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1207.69,-6916.27 893.69,-6916.27 893.69,-6864.27 1207.69,-6864.27 1207.69,-6916.27"/>
<text text-anchor="middle" x="1050.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1050.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1050.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1050.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert1&#45;&gt;stage6_layer0_expert1_mlp1 -->
<g id="edge1423" class="edge">
<title>stage6_layer0_expert1&#45;&gt;stage6_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1156.19,-6952.16C1139.59,-6942.58 1120.48,-6931.55 1103.13,-6921.53"/>
<polygon fill="black" stroke="black" points="1104.65,-6918.37 1094.24,-6916.4 1101.15,-6924.43 1104.65,-6918.37"/>
</g>
<!-- stage6_layer0_expert1_tp1 -->
<g id="node1091" class="node">
<title>stage6_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="1002.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1002.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="1002.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="1002.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1002.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert1_mlp1&#45;&gt;stage6_layer0_expert1_tp1 -->
<g id="edge1424" class="edge">
<title>stage6_layer0_expert1_mlp1&#45;&gt;stage6_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M1038.2,-6864.09C1034.16,-6855.94 1029.55,-6846.65 1025.02,-6837.51"/>
<polygon fill="black" stroke="black" points="1028.11,-6835.88 1020.53,-6828.47 1021.84,-6838.99 1028.11,-6835.88"/>
</g>
<!-- stage6_layer0_expert1_act -->
<g id="node1092" class="node">
<title>stage6_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="1068.19,-6718.73 787.19,-6718.73 787.19,-6666.73 1068.19,-6666.73 1068.19,-6718.73"/>
<text text-anchor="middle" x="927.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="927.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="927.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="927.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert1_tp1&#45;&gt;stage6_layer0_expert1_act -->
<g id="edge1425" class="edge">
<title>stage6_layer0_expert1_tp1&#45;&gt;stage6_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M975.19,-6755.01C968.08,-6745.84 960.46,-6736.01 953.45,-6726.96"/>
<polygon fill="black" stroke="black" points="956.1,-6724.67 947.21,-6718.91 950.57,-6728.96 956.1,-6724.67"/>
</g>
<!-- stage6_layer0_expert1_mlp2 -->
<g id="node1093" class="node">
<title>stage6_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="1027.69,-6630.73 705.69,-6630.73 705.69,-6578.73 1027.69,-6578.73 1027.69,-6630.73"/>
<text text-anchor="middle" x="866.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="866.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP: Row Parallel)</text>
<text text-anchor="middle" x="866.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="866.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert1_act&#45;&gt;stage6_layer0_expert1_mlp2 -->
<g id="edge1426" class="edge">
<title>stage6_layer0_expert1_act&#45;&gt;stage6_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M909.72,-6666.39C903.7,-6657.9 896.89,-6648.31 890.5,-6639.29"/>
<polygon fill="black" stroke="black" points="893.17,-6637.01 884.53,-6630.88 887.46,-6641.06 893.17,-6637.01"/>
</g>
<!-- stage6_layer0_expert1_tp2 -->
<g id="node1094" class="node">
<title>stage6_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="770.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="770.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="770.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="770.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="770.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert1_mlp2&#45;&gt;stage6_layer0_expert1_tp2 -->
<g id="edge1427" class="edge">
<title>stage6_layer0_expert1_mlp2&#45;&gt;stage6_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M841.72,-6578.55C832.95,-6569.72 822.85,-6559.54 813.06,-6549.67"/>
<polygon fill="black" stroke="black" points="815.54,-6547.2 806.02,-6542.57 810.57,-6552.13 815.54,-6547.2"/>
</g>
<!-- stage6_layer0_expert1_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1478" class="edge">
<title>stage6_layer0_expert1_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M926.88,-6479.12C953.46,-6475.35 980.82,-6471.84 1006.69,-6469.19 1508.29,-6417.65 2087.49,-6390.91 2471.77,-6377.74"/>
<polygon fill="black" stroke="black" points="2472.07,-6381.23 2481.94,-6377.4 2471.83,-6374.24 2472.07,-6381.23"/>
</g>
<!-- stage6_layer0_expert2_mlp1 -->
<g id="node1096" class="node">
<title>stage6_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1639.69,-6916.27 1325.69,-6916.27 1325.69,-6864.27 1639.69,-6864.27 1639.69,-6916.27"/>
<text text-anchor="middle" x="1482.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1482.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1482.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1482.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert2&#45;&gt;stage6_layer0_expert2_mlp1 -->
<g id="edge1429" class="edge">
<title>stage6_layer0_expert2&#45;&gt;stage6_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1578.28,-6952.16C1563.44,-6942.71 1546.39,-6931.85 1530.84,-6921.94"/>
<polygon fill="black" stroke="black" points="1532.7,-6918.97 1522.38,-6916.55 1528.94,-6924.88 1532.7,-6918.97"/>
</g>
<!-- stage6_layer0_expert2_tp1 -->
<g id="node1097" class="node">
<title>stage6_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1431.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1431.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1431.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="1431.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1431.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert2_mlp1&#45;&gt;stage6_layer0_expert2_tp1 -->
<g id="edge1430" class="edge">
<title>stage6_layer0_expert2_mlp1&#45;&gt;stage6_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1469.42,-6864.09C1465.08,-6855.86 1460.13,-6846.45 1455.26,-6837.23"/>
<polygon fill="black" stroke="black" points="1458.21,-6835.32 1450.46,-6828.11 1452.02,-6838.58 1458.21,-6835.32"/>
</g>
<!-- stage6_layer0_expert2_act -->
<g id="node1098" class="node">
<title>stage6_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1427.19,-6718.73 1146.19,-6718.73 1146.19,-6666.73 1427.19,-6666.73 1427.19,-6718.73"/>
<text text-anchor="middle" x="1286.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1286.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="1286.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1286.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert2_tp1&#45;&gt;stage6_layer0_expert2_act -->
<g id="edge1431" class="edge">
<title>stage6_layer0_expert2_tp1&#45;&gt;stage6_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1379.75,-6755.83C1364.4,-6745.59 1347.7,-6734.45 1332.75,-6724.47"/>
<polygon fill="black" stroke="black" points="1334.43,-6721.38 1324.17,-6718.74 1330.54,-6727.2 1334.43,-6721.38"/>
</g>
<!-- stage6_layer0_expert2_mlp2 -->
<g id="node1099" class="node">
<title>stage6_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1433.69,-6630.73 1111.69,-6630.73 1111.69,-6578.73 1433.69,-6578.73 1433.69,-6630.73"/>
<text text-anchor="middle" x="1272.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1272.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1272.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1272.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert2_act&#45;&gt;stage6_layer0_expert2_mlp2 -->
<g id="edge1432" class="edge">
<title>stage6_layer0_expert2_act&#45;&gt;stage6_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1282.56,-6666.39C1281.27,-6658.43 1279.81,-6649.49 1278.43,-6640.97"/>
<polygon fill="black" stroke="black" points="1281.85,-6640.19 1276.78,-6630.88 1274.94,-6641.32 1281.85,-6640.19"/>
</g>
<!-- stage6_layer0_expert2_tp2 -->
<g id="node1100" class="node">
<title>stage6_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1243.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1243.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1243.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="1243.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1243.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert2_mlp2&#45;&gt;stage6_layer0_expert2_tp2 -->
<g id="edge1433" class="edge">
<title>stage6_layer0_expert2_mlp2&#45;&gt;stage6_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1265.14,-6578.55C1262.75,-6570.58 1260.03,-6561.49 1257.35,-6552.54"/>
<polygon fill="black" stroke="black" points="1260.69,-6551.51 1254.47,-6542.93 1253.99,-6553.52 1260.69,-6551.51"/>
</g>
<!-- stage6_layer0_expert2_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1479" class="edge">
<title>stage6_layer0_expert2_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1401.19,-6479.34C1427.36,-6475.59 1454.26,-6472.03 1479.69,-6469.19 1818.19,-6431.32 2203.73,-6404.37 2487.58,-6387.56"/>
<polygon fill="black" stroke="black" points="2487.85,-6391.05 2497.63,-6386.97 2487.44,-6384.06 2487.85,-6391.05"/>
</g>
<!-- stage6_layer0_expert3_mlp1 -->
<g id="node1102" class="node">
<title>stage6_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2114.69,-6916.27 1800.69,-6916.27 1800.69,-6864.27 2114.69,-6864.27 2114.69,-6916.27"/>
<text text-anchor="middle" x="1957.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="1957.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1957.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1957.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert3&#45;&gt;stage6_layer0_expert3_mlp1 -->
<g id="edge1435" class="edge">
<title>stage6_layer0_expert3&#45;&gt;stage6_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M1985.2,-6951.93C1981.47,-6943.7 1977.27,-6934.44 1973.29,-6925.67"/>
<polygon fill="black" stroke="black" points="1976.41,-6924.08 1969.1,-6916.42 1970.04,-6926.97 1976.41,-6924.08"/>
</g>
<!-- stage6_layer0_expert3_tp1 -->
<g id="node1103" class="node">
<title>stage6_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1853.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1853.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1853.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="1853.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1853.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert3_mlp1&#45;&gt;stage6_layer0_expert3_tp1 -->
<g id="edge1436" class="edge">
<title>stage6_layer0_expert3_mlp1&#45;&gt;stage6_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1930.64,-6864.09C1920.95,-6855.08 1909.76,-6844.67 1898.96,-6834.62"/>
<polygon fill="black" stroke="black" points="1901.27,-6831.99 1891.57,-6827.74 1896.5,-6837.12 1901.27,-6831.99"/>
</g>
<!-- stage6_layer0_expert3_act -->
<g id="node1104" class="node">
<title>stage6_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1926.19,-6718.73 1645.19,-6718.73 1645.19,-6666.73 1926.19,-6666.73 1926.19,-6718.73"/>
<text text-anchor="middle" x="1785.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1785.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="1785.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1785.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert3_tp1&#45;&gt;stage6_layer0_expert3_act -->
<g id="edge1437" class="edge">
<title>stage6_layer0_expert3_tp1&#45;&gt;stage6_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1828.75,-6755.01C1822.38,-6745.94 1815.54,-6736.21 1809.24,-6727.24"/>
<polygon fill="black" stroke="black" points="1812,-6725.08 1803.39,-6718.91 1806.27,-6729.11 1812,-6725.08"/>
</g>
<!-- stage6_layer0_expert3_mlp2 -->
<g id="node1105" class="node">
<title>stage6_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1944.69,-6630.73 1622.69,-6630.73 1622.69,-6578.73 1944.69,-6578.73 1944.69,-6630.73"/>
<text text-anchor="middle" x="1783.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1783.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1783.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1783.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert3_act&#45;&gt;stage6_layer0_expert3_mlp2 -->
<g id="edge1438" class="edge">
<title>stage6_layer0_expert3_act&#45;&gt;stage6_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1785.1,-6666.39C1784.91,-6658.43 1784.71,-6649.49 1784.51,-6640.97"/>
<polygon fill="black" stroke="black" points="1788.01,-6640.8 1784.27,-6630.88 1781.01,-6640.96 1788.01,-6640.8"/>
</g>
<!-- stage6_layer0_expert3_tp2 -->
<g id="node1106" class="node">
<title>stage6_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1716.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1716.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1716.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="1716.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1716.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert3_mlp2&#45;&gt;stage6_layer0_expert3_tp2 -->
<g id="edge1439" class="edge">
<title>stage6_layer0_expert3_mlp2&#45;&gt;stage6_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1766.26,-6578.55C1760.38,-6570.06 1753.64,-6560.33 1747.06,-6550.82"/>
<polygon fill="black" stroke="black" points="1749.91,-6548.8 1741.34,-6542.57 1744.16,-6552.78 1749.91,-6548.8"/>
</g>
<!-- stage6_layer0_expert3_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1480" class="edge">
<title>stage6_layer0_expert3_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1876.83,-6479.76C1902.19,-6476.03 1928.13,-6472.38 1952.69,-6469.19 2137.29,-6445.17 2342.65,-6422.36 2514.81,-6404.34"/>
<polygon fill="black" stroke="black" points="2515.22,-6407.81 2524.8,-6403.29 2514.49,-6400.85 2515.22,-6407.81"/>
</g>
<!-- stage6_layer0_expert31_mlp1 -->
<g id="node1108" class="node">
<title>stage6_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2479.69,-6916.27 2165.69,-6916.27 2165.69,-6864.27 2479.69,-6864.27 2479.69,-6916.27"/>
<text text-anchor="middle" x="2322.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2322.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2322.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2322.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert31&#45;&gt;stage6_layer0_expert31_mlp1 -->
<g id="edge1441" class="edge">
<title>stage6_layer0_expert31&#45;&gt;stage6_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2345.97,-6951.93C2342.84,-6943.79 2339.33,-6934.64 2336,-6925.95"/>
<polygon fill="black" stroke="black" points="2339.19,-6924.5 2332.34,-6916.42 2332.66,-6927.01 2339.19,-6924.5"/>
</g>
<!-- stage6_layer0_expert31_tp1 -->
<g id="node1109" class="node">
<title>stage6_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2272.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2272.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2272.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="2272.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2272.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert31_mlp1&#45;&gt;stage6_layer0_expert31_tp1 -->
<g id="edge1442" class="edge">
<title>stage6_layer0_expert31_mlp1&#45;&gt;stage6_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2309.68,-6864.09C2305.47,-6855.94 2300.67,-6846.65 2295.95,-6837.51"/>
<polygon fill="black" stroke="black" points="2298.98,-6835.75 2291.28,-6828.47 2292.76,-6838.96 2298.98,-6835.75"/>
</g>
<!-- stage6_layer0_expert31_act -->
<g id="node1110" class="node">
<title>stage6_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2372.19,-6718.73 2091.19,-6718.73 2091.19,-6666.73 2372.19,-6666.73 2372.19,-6718.73"/>
<text text-anchor="middle" x="2231.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2231.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="2231.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2231.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert31_tp1&#45;&gt;stage6_layer0_expert31_act -->
<g id="edge1443" class="edge">
<title>stage6_layer0_expert31_tp1&#45;&gt;stage6_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2257.54,-6754.74C2253.86,-6746.05 2249.93,-6736.79 2246.28,-6728.16"/>
<polygon fill="black" stroke="black" points="2249.42,-6726.61 2242.3,-6718.77 2242.98,-6729.34 2249.42,-6726.61"/>
</g>
<!-- stage6_layer0_expert31_mlp2 -->
<g id="node1111" class="node">
<title>stage6_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2351.69,-6630.73 2029.69,-6630.73 2029.69,-6578.73 2351.69,-6578.73 2351.69,-6630.73"/>
<text text-anchor="middle" x="2190.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2190.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2190.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2190.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert31_act&#45;&gt;stage6_layer0_expert31_mlp2 -->
<g id="edge1444" class="edge">
<title>stage6_layer0_expert31_act&#45;&gt;stage6_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2219.61,-6666.39C2215.69,-6658.17 2211.27,-6648.9 2207.09,-6640.13"/>
<polygon fill="black" stroke="black" points="2210.14,-6638.4 2202.68,-6630.88 2203.83,-6641.42 2210.14,-6638.4"/>
</g>
<!-- stage6_layer0_expert31_tp2 -->
<g id="node1112" class="node">
<title>stage6_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2189.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2189.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2189.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="2189.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2189.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert31_mlp2&#45;&gt;stage6_layer0_expert31_tp2 -->
<g id="edge1445" class="edge">
<title>stage6_layer0_expert31_mlp2&#45;&gt;stage6_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2190.43,-6578.55C2190.35,-6570.75 2190.26,-6561.88 2190.17,-6553.11"/>
<polygon fill="black" stroke="black" points="2193.66,-6552.9 2190.06,-6542.93 2186.66,-6552.97 2193.66,-6552.9"/>
</g>
<!-- stage6_layer0_expert31_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1481" class="edge">
<title>stage6_layer0_expert31_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2331.66,-6477.21C2397.77,-6464.29 2479.52,-6448.31 2560.2,-6432.54"/>
<polygon fill="black" stroke="black" points="2560.89,-6435.97 2570.03,-6430.62 2559.54,-6429.1 2560.89,-6435.97"/>
</g>
<!-- stage6_layer0_expert32_mlp1 -->
<g id="node1114" class="node">
<title>stage6_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2851.69,-6916.27 2537.69,-6916.27 2537.69,-6864.27 2851.69,-6864.27 2851.69,-6916.27"/>
<text text-anchor="middle" x="2694.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2694.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2694.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2694.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert32&#45;&gt;stage6_layer0_expert32_mlp1 -->
<g id="edge1447" class="edge">
<title>stage6_layer0_expert32&#45;&gt;stage6_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2721.49,-6951.93C2717.86,-6943.7 2713.76,-6934.44 2709.89,-6925.67"/>
<polygon fill="black" stroke="black" points="2713.05,-6924.15 2705.8,-6916.42 2706.64,-6926.98 2713.05,-6924.15"/>
</g>
<!-- stage6_layer0_expert32_tp1 -->
<g id="node1115" class="node">
<title>stage6_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2689.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2689.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2689.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="2689.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2689.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert32_mlp1&#45;&gt;stage6_layer0_expert32_tp1 -->
<g id="edge1448" class="edge">
<title>stage6_layer0_expert32_mlp1&#45;&gt;stage6_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2693.39,-6864.09C2692.98,-6856.28 2692.53,-6847.42 2692.07,-6838.65"/>
<polygon fill="black" stroke="black" points="2695.56,-6838.28 2691.55,-6828.47 2688.57,-6838.64 2695.56,-6838.28"/>
</g>
<!-- stage6_layer0_expert32_act -->
<g id="node1116" class="node">
<title>stage6_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2816.19,-6718.73 2535.19,-6718.73 2535.19,-6666.73 2816.19,-6666.73 2816.19,-6718.73"/>
<text text-anchor="middle" x="2675.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2675.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="2675.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2675.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert32_tp1&#45;&gt;stage6_layer0_expert32_act -->
<g id="edge1449" class="edge">
<title>stage6_layer0_expert32_tp1&#45;&gt;stage6_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2684.52,-6754.74C2683.29,-6746.24 2681.98,-6737.18 2680.75,-6728.72"/>
<polygon fill="black" stroke="black" points="2684.21,-6728.17 2679.31,-6718.77 2677.28,-6729.17 2684.21,-6728.17"/>
</g>
<!-- stage6_layer0_expert32_mlp2 -->
<g id="node1117" class="node">
<title>stage6_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2830.69,-6630.73 2508.69,-6630.73 2508.69,-6578.73 2830.69,-6578.73 2830.69,-6630.73"/>
<text text-anchor="middle" x="2669.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2669.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2669.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2669.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert32_act&#45;&gt;stage6_layer0_expert32_mlp2 -->
<g id="edge1450" class="edge">
<title>stage6_layer0_expert32_act&#45;&gt;stage6_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2673.92,-6666.39C2673.37,-6658.43 2672.74,-6649.49 2672.15,-6640.97"/>
<polygon fill="black" stroke="black" points="2675.63,-6640.61 2671.44,-6630.88 2668.65,-6641.1 2675.63,-6640.61"/>
</g>
<!-- stage6_layer0_expert32_tp2 -->
<g id="node1118" class="node">
<title>stage6_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2662.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2662.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2662.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="2662.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2662.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert32_mlp2&#45;&gt;stage6_layer0_expert32_tp2 -->
<g id="edge1451" class="edge">
<title>stage6_layer0_expert32_mlp2&#45;&gt;stage6_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2667.87,-6578.55C2667.3,-6570.75 2666.66,-6561.88 2666.03,-6553.11"/>
<polygon fill="black" stroke="black" points="2669.5,-6552.65 2665.29,-6542.93 2662.52,-6553.16 2669.5,-6552.65"/>
</g>
<!-- stage6_layer0_expert32_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1482" class="edge">
<title>stage6_layer0_expert32_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2721.88,-6470.3C2738.53,-6460.55 2757.28,-6449.57 2776.2,-6438.5"/>
<polygon fill="black" stroke="black" points="2778.03,-6441.48 2784.89,-6433.4 2774.49,-6435.44 2778.03,-6441.48"/>
</g>
<!-- stage6_layer0_expert60_mlp1 -->
<g id="node1120" class="node">
<title>stage6_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3253.69,-6916.27 2939.69,-6916.27 2939.69,-6864.27 3253.69,-6864.27 3253.69,-6916.27"/>
<text text-anchor="middle" x="3096.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3096.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3096.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3096.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert60&#45;&gt;stage6_layer0_expert60_mlp1 -->
<g id="edge1453" class="edge">
<title>stage6_layer0_expert60&#45;&gt;stage6_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3093.16,-6951.93C3093.62,-6943.97 3094.14,-6935.03 3094.64,-6926.51"/>
<polygon fill="black" stroke="black" points="3098.14,-6926.61 3095.23,-6916.42 3091.15,-6926.2 3098.14,-6926.61"/>
</g>
<!-- stage6_layer0_expert60_tp1 -->
<g id="node1121" class="node">
<title>stage6_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3105.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3105.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3105.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="3105.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3105.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert60_mlp1&#45;&gt;stage6_layer0_expert60_tp1 -->
<g id="edge1454" class="edge">
<title>stage6_layer0_expert60_mlp1&#45;&gt;stage6_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3099.03,-6864.09C3099.76,-6856.28 3100.58,-6847.42 3101.4,-6838.65"/>
<polygon fill="black" stroke="black" points="3104.9,-6838.75 3102.34,-6828.47 3097.93,-6838.11 3104.9,-6838.75"/>
</g>
<!-- stage6_layer0_expert60_act -->
<g id="node1122" class="node">
<title>stage6_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3246.19,-6718.73 2965.19,-6718.73 2965.19,-6666.73 3246.19,-6666.73 3246.19,-6718.73"/>
<text text-anchor="middle" x="3105.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3105.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="3105.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3105.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert60_tp1&#45;&gt;stage6_layer0_expert60_act -->
<g id="edge1455" class="edge">
<title>stage6_layer0_expert60_tp1&#45;&gt;stage6_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3105.69,-6754.46C3105.69,-6746.15 3105.69,-6737.32 3105.69,-6729.04"/>
<polygon fill="black" stroke="black" points="3109.19,-6728.92 3105.69,-6718.92 3102.19,-6728.92 3109.19,-6728.92"/>
</g>
<!-- stage6_layer0_expert60_mlp2 -->
<g id="node1123" class="node">
<title>stage6_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3276.69,-6630.73 2954.69,-6630.73 2954.69,-6578.73 3276.69,-6578.73 3276.69,-6630.73"/>
<text text-anchor="middle" x="3115.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3115.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3115.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3115.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert60_act&#45;&gt;stage6_layer0_expert60_mlp2 -->
<g id="edge1456" class="edge">
<title>stage6_layer0_expert60_act&#45;&gt;stage6_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3108.63,-6666.39C3109.56,-6658.43 3110.6,-6649.49 3111.59,-6640.97"/>
<polygon fill="black" stroke="black" points="3115.08,-6641.22 3112.76,-6630.88 3108.13,-6640.41 3115.08,-6641.22"/>
</g>
<!-- stage6_layer0_expert60_tp2 -->
<g id="node1124" class="node">
<title>stage6_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3135.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3135.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3135.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="3135.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3135.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert60_mlp2&#45;&gt;stage6_layer0_expert60_tp2 -->
<g id="edge1457" class="edge">
<title>stage6_layer0_expert60_mlp2&#45;&gt;stage6_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3120.89,-6578.55C3122.52,-6570.66 3124.38,-6561.69 3126.21,-6552.83"/>
<polygon fill="black" stroke="black" points="3129.66,-6553.43 3128.25,-6542.93 3122.8,-6552.02 3129.66,-6553.43"/>
</g>
<!-- stage6_layer0_expert60_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1483" class="edge">
<title>stage6_layer0_expert60_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3076.74,-6470.3C3060.17,-6460.55 3041.5,-6449.57 3022.66,-6438.5"/>
<polygon fill="black" stroke="black" points="3024.39,-6435.45 3014,-6433.4 3020.85,-6441.49 3024.39,-6435.45"/>
</g>
<!-- stage6_layer0_expert61_mlp1 -->
<g id="node1126" class="node">
<title>stage6_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3650.69,-6916.27 3336.69,-6916.27 3336.69,-6864.27 3650.69,-6864.27 3650.69,-6916.27"/>
<text text-anchor="middle" x="3493.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3493.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3493.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3493.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert61&#45;&gt;stage6_layer0_expert61_mlp1 -->
<g id="edge1459" class="edge">
<title>stage6_layer0_expert61&#45;&gt;stage6_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3469.71,-6951.93C3472.92,-6943.79 3476.54,-6934.64 3479.98,-6925.95"/>
<polygon fill="black" stroke="black" points="3483.32,-6927.01 3483.74,-6916.42 3476.81,-6924.43 3483.32,-6927.01"/>
</g>
<!-- stage6_layer0_expert61_tp1 -->
<g id="node1127" class="node">
<title>stage6_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3533.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3533.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3533.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="3533.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3533.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert61_mlp1&#45;&gt;stage6_layer0_expert61_tp1 -->
<g id="edge1460" class="edge">
<title>stage6_layer0_expert61_mlp1&#45;&gt;stage6_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3504.09,-6864.09C3507.43,-6856.03 3511.23,-6846.84 3514.96,-6837.79"/>
<polygon fill="black" stroke="black" points="3518.23,-6839.05 3518.82,-6828.47 3511.76,-6836.38 3518.23,-6839.05"/>
</g>
<!-- stage6_layer0_expert61_act -->
<g id="node1128" class="node">
<title>stage6_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3719.19,-6718.73 3438.19,-6718.73 3438.19,-6666.73 3719.19,-6666.73 3719.19,-6718.73"/>
<text text-anchor="middle" x="3578.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3578.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="3578.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3578.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert61_tp1&#45;&gt;stage6_layer0_expert61_act -->
<g id="edge1461" class="edge">
<title>stage6_layer0_expert61_tp1&#45;&gt;stage6_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3550.32,-6754.74C3554.4,-6745.96 3558.76,-6736.59 3562.8,-6727.89"/>
<polygon fill="black" stroke="black" points="3566,-6729.31 3567.04,-6718.77 3559.65,-6726.36 3566,-6729.31"/>
</g>
<!-- stage6_layer0_expert61_mlp2 -->
<g id="node1129" class="node">
<title>stage6_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3749.69,-6630.73 3427.69,-6630.73 3427.69,-6578.73 3749.69,-6578.73 3749.69,-6630.73"/>
<text text-anchor="middle" x="3588.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3588.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3588.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3588.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert61_act&#45;&gt;stage6_layer0_expert61_mlp2 -->
<g id="edge1462" class="edge">
<title>stage6_layer0_expert61_act&#45;&gt;stage6_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3581.63,-6666.39C3582.56,-6658.43 3583.6,-6649.49 3584.59,-6640.97"/>
<polygon fill="black" stroke="black" points="3588.08,-6641.22 3585.76,-6630.88 3581.13,-6640.41 3588.08,-6641.22"/>
</g>
<!-- stage6_layer0_expert61_tp2 -->
<g id="node1130" class="node">
<title>stage6_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3608.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3608.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3608.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="3608.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3608.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert61_mlp2&#45;&gt;stage6_layer0_expert61_tp2 -->
<g id="edge1463" class="edge">
<title>stage6_layer0_expert61_mlp2&#45;&gt;stage6_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3593.89,-6578.55C3595.52,-6570.66 3597.38,-6561.69 3599.21,-6552.83"/>
<polygon fill="black" stroke="black" points="3602.66,-6553.43 3601.25,-6542.93 3595.8,-6552.02 3602.66,-6553.43"/>
</g>
<!-- stage6_layer0_expert61_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1484" class="edge">
<title>stage6_layer0_expert61_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3466.49,-6477.12C3404.3,-6464.95 3328.31,-6450.08 3252.43,-6435.23"/>
<polygon fill="black" stroke="black" points="3252.69,-6431.71 3242.21,-6433.23 3251.35,-6438.58 3252.69,-6431.71"/>
</g>
<!-- stage6_layer0_expert62_mlp1 -->
<g id="node1132" class="node">
<title>stage6_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="4112.69,-6916.27 3798.69,-6916.27 3798.69,-6864.27 4112.69,-6864.27 4112.69,-6916.27"/>
<text text-anchor="middle" x="3955.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3955.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3955.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3955.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert62&#45;&gt;stage6_layer0_expert62_mlp1 -->
<g id="edge1465" class="edge">
<title>stage6_layer0_expert62&#45;&gt;stage6_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3952.16,-6951.93C3952.62,-6943.97 3953.14,-6935.03 3953.64,-6926.51"/>
<polygon fill="black" stroke="black" points="3957.14,-6926.61 3954.23,-6916.42 3950.15,-6926.2 3957.14,-6926.61"/>
</g>
<!-- stage6_layer0_expert62_tp1 -->
<g id="node1133" class="node">
<title>stage6_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="3972.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3972.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="3972.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="3972.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3972.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert62_mlp1&#45;&gt;stage6_layer0_expert62_tp1 -->
<g id="edge1466" class="edge">
<title>stage6_layer0_expert62_mlp1&#45;&gt;stage6_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3960.11,-6864.09C3961.5,-6856.2 3963.07,-6847.23 3964.63,-6838.36"/>
<polygon fill="black" stroke="black" points="3968.09,-6838.93 3966.37,-6828.47 3961.19,-6837.72 3968.09,-6838.93"/>
</g>
<!-- stage6_layer0_expert62_act -->
<g id="node1134" class="node">
<title>stage6_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4138.19,-6718.73 3857.19,-6718.73 3857.19,-6666.73 4138.19,-6666.73 4138.19,-6718.73"/>
<text text-anchor="middle" x="3997.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="3997.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="3997.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3997.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert62_tp1&#45;&gt;stage6_layer0_expert62_act -->
<g id="edge1467" class="edge">
<title>stage6_layer0_expert62_tp1&#45;&gt;stage6_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M3981.93,-6754.74C3984.12,-6746.24 3986.46,-6737.18 3988.65,-6728.72"/>
<polygon fill="black" stroke="black" points="3992.11,-6729.33 3991.22,-6718.77 3985.33,-6727.58 3992.11,-6729.33"/>
</g>
<!-- stage6_layer0_expert62_mlp2 -->
<g id="node1135" class="node">
<title>stage6_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4207.69,-6630.73 3885.69,-6630.73 3885.69,-6578.73 4207.69,-6578.73 4207.69,-6630.73"/>
<text text-anchor="middle" x="4046.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4046.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4046.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4046.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert62_act&#45;&gt;stage6_layer0_expert62_mlp2 -->
<g id="edge1468" class="edge">
<title>stage6_layer0_expert62_act&#45;&gt;stage6_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4012.12,-6666.39C4016.86,-6658.08 4022.2,-6648.7 4027.25,-6639.85"/>
<polygon fill="black" stroke="black" points="4030.45,-6641.3 4032.35,-6630.88 4024.36,-6637.84 4030.45,-6641.3"/>
</g>
<!-- stage6_layer0_expert62_tp2 -->
<g id="node1136" class="node">
<title>stage6_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4081.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4081.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4081.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="4081.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4081.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert62_mlp2&#45;&gt;stage6_layer0_expert62_tp2 -->
<g id="edge1469" class="edge">
<title>stage6_layer0_expert62_mlp2&#45;&gt;stage6_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4055.79,-6578.55C4058.68,-6570.58 4061.96,-6561.49 4065.2,-6552.54"/>
<polygon fill="black" stroke="black" points="4068.57,-6553.53 4068.68,-6542.93 4061.98,-6551.15 4068.57,-6553.53"/>
</g>
<!-- stage6_layer0_expert62_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1485" class="edge">
<title>stage6_layer0_expert62_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3921.54,-6479.76C3896.19,-6476.04 3870.24,-6472.38 3845.69,-6469.19 3713.83,-6452.02 3571.38,-6435.47 3438.02,-6420.84"/>
<polygon fill="black" stroke="black" points="3438.35,-6417.36 3428.03,-6419.75 3437.59,-6424.32 3438.35,-6417.36"/>
</g>
<!-- stage6_layer0_expert63_mlp1 -->
<g id="node1138" class="node">
<title>stage6_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4462.69,-6916.27 4148.69,-6916.27 4148.69,-6864.27 4462.69,-6864.27 4462.69,-6916.27"/>
<text text-anchor="middle" x="4305.69" y="-6904.27" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4305.69" y="-6893.27" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4305.69" y="-6882.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4305.69" y="-6871.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer0_expert63&#45;&gt;stage6_layer0_expert63_mlp1 -->
<g id="edge1471" class="edge">
<title>stage6_layer0_expert63&#45;&gt;stage6_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4297.22,-6951.93C4298.33,-6943.97 4299.58,-6935.03 4300.77,-6926.51"/>
<polygon fill="black" stroke="black" points="4304.26,-6926.81 4302.18,-6916.42 4297.33,-6925.84 4304.26,-6926.81"/>
</g>
<!-- stage6_layer0_expert63_tp1 -->
<g id="node1139" class="node">
<title>stage6_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4418.69" cy="-6791.5" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4418.69" y="-6805.5" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4418.69" y="-6794.5" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="4418.69" y="-6783.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4418.69" y="-6772.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert63_mlp1&#45;&gt;stage6_layer0_expert63_tp1 -->
<g id="edge1472" class="edge">
<title>stage6_layer0_expert63_mlp1&#45;&gt;stage6_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4335.08,-6864.09C4345.7,-6855 4358,-6844.47 4369.84,-6834.33"/>
<polygon fill="black" stroke="black" points="4372.21,-6836.9 4377.53,-6827.74 4367.66,-6831.59 4372.21,-6836.9"/>
</g>
<!-- stage6_layer0_expert63_act -->
<g id="node1140" class="node">
<title>stage6_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4578.19,-6718.73 4297.19,-6718.73 4297.19,-6666.73 4578.19,-6666.73 4578.19,-6718.73"/>
<text text-anchor="middle" x="4437.69" y="-6706.73" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4437.69" y="-6695.73" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="4437.69" y="-6684.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4437.69" y="-6673.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer0_expert63_tp1&#45;&gt;stage6_layer0_expert63_act -->
<g id="edge1473" class="edge">
<title>stage6_layer0_expert63_tp1&#45;&gt;stage6_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4425.71,-6754.74C4427.38,-6746.24 4429.16,-6737.18 4430.82,-6728.72"/>
<polygon fill="black" stroke="black" points="4434.28,-6729.26 4432.77,-6718.77 4427.41,-6727.91 4434.28,-6729.26"/>
</g>
<!-- stage6_layer0_expert63_mlp2 -->
<g id="node1141" class="node">
<title>stage6_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4676.69,-6630.73 4354.69,-6630.73 4354.69,-6578.73 4676.69,-6578.73 4676.69,-6630.73"/>
<text text-anchor="middle" x="4515.69" y="-6618.73" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4515.69" y="-6607.73" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4515.69" y="-6596.73" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4515.69" y="-6585.73" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert63_act&#45;&gt;stage6_layer0_expert63_mlp2 -->
<g id="edge1474" class="edge">
<title>stage6_layer0_expert63_act&#45;&gt;stage6_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4460.67,-6666.39C4468.6,-6657.64 4477.61,-6647.71 4486,-6638.46"/>
<polygon fill="black" stroke="black" points="4488.75,-6640.64 4492.87,-6630.88 4483.56,-6635.94 4488.75,-6640.64"/>
</g>
<!-- stage6_layer0_expert63_tp2 -->
<g id="node1142" class="node">
<title>stage6_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4554.69" cy="-6505.96" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4554.69" y="-6519.96" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4554.69" y="-6508.96" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="4554.69" y="-6497.96" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4554.69" y="-6486.96" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_expert63_mlp2&#45;&gt;stage6_layer0_expert63_tp2 -->
<g id="edge1475" class="edge">
<title>stage6_layer0_expert63_mlp2&#45;&gt;stage6_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4525.83,-6578.55C4529.08,-6570.49 4532.79,-6561.3 4536.43,-6552.25"/>
<polygon fill="black" stroke="black" points="4539.7,-6553.52 4540.19,-6542.93 4533.2,-6550.9 4539.7,-6553.52"/>
</g>
<!-- stage6_layer0_expert63_tp2&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1486" class="edge">
<title>stage6_layer0_expert63_tp2&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4397.18,-6479.34C4371.01,-6475.59 4344.12,-6472.03 4318.69,-6469.19 4011.5,-6434.81 3665.56,-6409.43 3392.16,-6392.47"/>
<polygon fill="black" stroke="black" points="3392.26,-6388.97 3382.06,-6391.84 3391.82,-6395.95 3392.26,-6388.97"/>
</g>
<!-- stage6_layer0_expert_ellipsis&#45;&gt;stage6_layer0_expert_agg -->
<g id="edge1487" class="edge">
<title>stage6_layer0_expert_ellipsis&#45;&gt;stage6_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4693.31,-6864.11C4739.82,-6831.14 4810.69,-6768.61 4810.69,-6693.73 4810.69,-6693.73 4810.69,-6693.73 4810.69,-6603.73 4810.69,-6543.34 4836.18,-6510.02 4791.69,-6469.19 4739.79,-6421.57 3910.39,-6391.56 3367.12,-6376.92"/>
<polygon fill="black" stroke="black" points="3366.83,-6373.41 3356.74,-6376.64 3366.64,-6380.41 3366.83,-6373.41"/>
</g>
<!-- stage6_layer0_expert_agg&#45;&gt;stage6_layer0_output -->
<g id="edge1488" class="edge">
<title>stage6_layer0_expert_agg&#45;&gt;stage6_layer0_output</title>
<path fill="none" stroke="black" d="M3245.08,-6309.31C3343.95,-6293.6 3448.94,-6276.92 3537.83,-6262.8"/>
<polygon fill="black" stroke="black" points="3538.43,-6266.25 3547.76,-6261.22 3537.34,-6259.33 3538.43,-6266.25"/>
</g>
<!-- stage6_layer1_ln -->
<g id="node1146" class="node">
<title>stage6_layer1_ln</title>
<polygon fill="none" stroke="black" points="3980.69,-6157.19 3530.69,-6157.19 3530.69,-6089.19 3980.69,-6089.19 3980.69,-6157.19"/>
<text text-anchor="middle" x="3755.69" y="-6141.99" font-family="Times,serif" font-size="14.00">Layer 13 LayerNorm</text>
<text text-anchor="middle" x="3755.69" y="-6126.99" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-6111.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-6096.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer0_output&#45;&gt;stage6_layer1_ln -->
<g id="edge1490" class="edge">
<title>stage6_layer0_output&#45;&gt;stage6_layer1_ln</title>
<path fill="none" stroke="black" d="M3755.69,-6193.07C3755.69,-6184.96 3755.69,-6176.17 3755.69,-6167.66"/>
<polygon fill="black" stroke="black" points="3759.19,-6167.49 3755.69,-6157.49 3752.19,-6167.49 3759.19,-6167.49"/>
</g>
<!-- stage6_layer1_attn_qkv -->
<g id="node1147" class="node">
<title>stage6_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="3987.19,-6053.19 3524.19,-6053.19 3524.19,-5985.19 3987.19,-5985.19 3987.19,-6053.19"/>
<text text-anchor="middle" x="3755.69" y="-6037.99" font-family="Times,serif" font-size="14.00">Layer 13 Attention QKV Projection</text>
<text text-anchor="middle" x="3755.69" y="-6022.99" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP: GPU 768&#45;895)</text>
<text text-anchor="middle" x="3755.69" y="-6007.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5992.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage6_layer1_ln&#45;&gt;stage6_layer1_attn_qkv -->
<g id="edge1491" class="edge">
<title>stage6_layer1_ln&#45;&gt;stage6_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3755.69,-6089.07C3755.69,-6080.96 3755.69,-6072.17 3755.69,-6063.66"/>
<polygon fill="black" stroke="black" points="3759.19,-6063.49 3755.69,-6053.49 3752.19,-6063.49 3759.19,-6063.49"/>
</g>
<!-- stage6_layer1_tp_qkv_comm -->
<g id="node1148" class="node">
<title>stage6_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-5901.1" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3755.69" y="-5919.9" font-family="Times,serif" font-size="14.00">Layer 13 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3755.69" y="-5904.9" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP pairs)</text>
<text text-anchor="middle" x="3755.69" y="-5889.9" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-5874.9" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage6_layer1_attn_qkv&#45;&gt;stage6_layer1_tp_qkv_comm -->
<g id="edge1492" class="edge">
<title>stage6_layer1_attn_qkv&#45;&gt;stage6_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3755.69,-5984.92C3755.69,-5976.93 3755.69,-5968.16 3755.69,-5959.42"/>
<polygon fill="black" stroke="black" points="3759.19,-5959.21 3755.69,-5949.21 3752.19,-5959.21 3759.19,-5959.21"/>
</g>
<!-- stage6_layer1_attn_head0 -->
<g id="node1149" class="node">
<title>stage6_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1564.19,-5817.02 1291.19,-5817.02 1291.19,-5765.02 1564.19,-5765.02 1564.19,-5817.02"/>
<text text-anchor="middle" x="1427.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 0 Attention</text>
<text text-anchor="middle" x="1427.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 0)</text>
<text text-anchor="middle" x="1427.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1427.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head0 -->
<g id="edge1493" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3432.67,-5893.08C2920.05,-5881.05 1941.56,-5854.25 1574.38,-5817.13"/>
<polygon fill="black" stroke="black" points="1574.54,-5813.62 1564.23,-5816.08 1573.82,-5820.59 1574.54,-5813.62"/>
</g>
<!-- stage6_layer1_attn_head1 -->
<g id="node1150" class="node">
<title>stage6_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1855.19,-5817.02 1582.19,-5817.02 1582.19,-5765.02 1855.19,-5765.02 1855.19,-5817.02"/>
<text text-anchor="middle" x="1718.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 1 Attention</text>
<text text-anchor="middle" x="1718.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 1)</text>
<text text-anchor="middle" x="1718.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1718.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head1 -->
<g id="edge1494" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3428.73,-5898.31C3053.12,-5893.36 2418.43,-5876.15 1865.41,-5817.15"/>
<polygon fill="black" stroke="black" points="1865.55,-5813.65 1855.23,-5816.06 1864.8,-5820.61 1865.55,-5813.65"/>
</g>
<!-- stage6_layer1_attn_head2 -->
<g id="node1151" class="node">
<title>stage6_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2146.19,-5817.02 1873.19,-5817.02 1873.19,-5765.02 2146.19,-5765.02 2146.19,-5817.02"/>
<text text-anchor="middle" x="2009.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 2 Attention</text>
<text text-anchor="middle" x="2009.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 2)</text>
<text text-anchor="middle" x="2009.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2009.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head2 -->
<g id="edge1495" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3431.26,-5894.57C3109.63,-5886.44 2602.92,-5866.55 2156.44,-5817.16"/>
<polygon fill="black" stroke="black" points="2156.56,-5813.66 2146.24,-5816.03 2155.79,-5820.61 2156.56,-5813.66"/>
</g>
<!-- stage6_layer1_attn_head3 -->
<g id="node1152" class="node">
<title>stage6_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2437.19,-5817.02 2164.19,-5817.02 2164.19,-5765.02 2437.19,-5765.02 2437.19,-5817.02"/>
<text text-anchor="middle" x="2300.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 3 Attention</text>
<text text-anchor="middle" x="2300.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 3)</text>
<text text-anchor="middle" x="2300.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2300.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head3 -->
<g id="edge1496" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3437.84,-5889.5C3174.62,-5878.46 2790.78,-5857.12 2447.39,-5817.17"/>
<polygon fill="black" stroke="black" points="2447.58,-5813.67 2437.24,-5815.98 2446.77,-5820.62 2447.58,-5813.67"/>
</g>
<!-- stage6_layer1_attn_head4 -->
<g id="node1153" class="node">
<title>stage6_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2728.19,-5817.02 2455.19,-5817.02 2455.19,-5765.02 2728.19,-5765.02 2728.19,-5817.02"/>
<text text-anchor="middle" x="2591.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 4 Attention</text>
<text text-anchor="middle" x="2591.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 4)</text>
<text text-anchor="middle" x="2591.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2591.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head4 -->
<g id="edge1497" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3453.43,-5882.57C3253.07,-5869.22 2984.29,-5848.04 2738.46,-5817.2"/>
<polygon fill="black" stroke="black" points="2738.61,-5813.69 2728.25,-5815.92 2737.73,-5820.64 2738.61,-5813.69"/>
</g>
<!-- stage6_layer1_attn_head5 -->
<g id="node1154" class="node">
<title>stage6_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3019.19,-5817.02 2746.19,-5817.02 2746.19,-5765.02 3019.19,-5765.02 3019.19,-5817.02"/>
<text text-anchor="middle" x="2882.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 5 Attention</text>
<text text-anchor="middle" x="2882.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 5)</text>
<text text-anchor="middle" x="2882.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2882.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head5 -->
<g id="edge1498" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3488.12,-5873.26C3353.28,-5858.82 3187.06,-5839.63 3029.62,-5817.27"/>
<polygon fill="black" stroke="black" points="3029.66,-5813.74 3019.27,-5815.79 3028.67,-5820.67 3029.66,-5813.74"/>
</g>
<!-- stage6_layer1_attn_head6 -->
<g id="node1155" class="node">
<title>stage6_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3310.19,-5817.02 3037.19,-5817.02 3037.19,-5765.02 3310.19,-5765.02 3310.19,-5817.02"/>
<text text-anchor="middle" x="3173.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 6 Attention</text>
<text text-anchor="middle" x="3173.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 6)</text>
<text text-anchor="middle" x="3173.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3173.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head6 -->
<g id="edge1499" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3555.8,-5862.98C3477.89,-5848.51 3390.29,-5832.25 3318.64,-5818.94"/>
<polygon fill="black" stroke="black" points="3319.1,-5815.47 3308.63,-5817.08 3317.83,-5822.35 3319.1,-5815.47"/>
</g>
<!-- stage6_layer1_attn_head7 -->
<g id="node1156" class="node">
<title>stage6_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3601.19,-5817.02 3328.19,-5817.02 3328.19,-5765.02 3601.19,-5765.02 3601.19,-5817.02"/>
<text text-anchor="middle" x="3464.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 7 Attention</text>
<text text-anchor="middle" x="3464.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 7)</text>
<text text-anchor="middle" x="3464.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3464.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head7 -->
<g id="edge1500" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3637.33,-5856.14C3605.09,-5844.17 3571.02,-5831.51 3541.74,-5820.64"/>
<polygon fill="black" stroke="black" points="3542.59,-5817.22 3532,-5817.02 3540.15,-5823.78 3542.59,-5817.22"/>
</g>
<!-- stage6_layer1_attn_ellipsis -->
<g id="node1157" class="node">
<title>stage6_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3892.19,-5817.02 3619.19,-5817.02 3619.19,-5765.02 3892.19,-5765.02 3892.19,-5817.02"/>
<text text-anchor="middle" x="3755.69" y="-5805.02" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3755.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_ellipsis -->
<g id="edge1501" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3755.69,-5853.01C3755.69,-5844.47 3755.69,-5835.69 3755.69,-5827.55"/>
<polygon fill="black" stroke="black" points="3759.19,-5827.28 3755.69,-5817.28 3752.19,-5827.28 3759.19,-5827.28"/>
</g>
<!-- stage6_layer1_attn_head24 -->
<g id="node1158" class="node">
<title>stage6_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4183.19,-5817.02 3910.19,-5817.02 3910.19,-5765.02 4183.19,-5765.02 4183.19,-5817.02"/>
<text text-anchor="middle" x="4046.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 24 Attention</text>
<text text-anchor="middle" x="4046.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 24)</text>
<text text-anchor="middle" x="4046.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4046.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head24 -->
<g id="edge1502" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3874.05,-5856.14C3906.28,-5844.17 3940.36,-5831.51 3969.64,-5820.64"/>
<polygon fill="black" stroke="black" points="3971.22,-5823.78 3979.38,-5817.02 3968.79,-5817.22 3971.22,-5823.78"/>
</g>
<!-- stage6_layer1_attn_head25 -->
<g id="node1159" class="node">
<title>stage6_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4474.19,-5817.02 4201.19,-5817.02 4201.19,-5765.02 4474.19,-5765.02 4474.19,-5817.02"/>
<text text-anchor="middle" x="4337.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 25 Attention</text>
<text text-anchor="middle" x="4337.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 25)</text>
<text text-anchor="middle" x="4337.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4337.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head25 -->
<g id="edge1503" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M3955.57,-5862.98C4033.48,-5848.51 4121.09,-5832.25 4192.74,-5818.94"/>
<polygon fill="black" stroke="black" points="4193.55,-5822.35 4202.74,-5817.08 4192.27,-5815.47 4193.55,-5822.35"/>
</g>
<!-- stage6_layer1_attn_head26 -->
<g id="node1160" class="node">
<title>stage6_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4765.19,-5817.02 4492.19,-5817.02 4492.19,-5765.02 4765.19,-5765.02 4765.19,-5817.02"/>
<text text-anchor="middle" x="4628.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 26 Attention</text>
<text text-anchor="middle" x="4628.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 26)</text>
<text text-anchor="middle" x="4628.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4628.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head26 -->
<g id="edge1504" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4022.45,-5873.22C4157.31,-5858.74 4323.69,-5839.51 4482.01,-5817.09"/>
<polygon fill="black" stroke="black" points="4482.54,-5820.55 4491.95,-5815.67 4481.55,-5813.62 4482.54,-5820.55"/>
</g>
<!-- stage6_layer1_attn_head27 -->
<g id="node1161" class="node">
<title>stage6_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5056.19,-5817.02 4783.19,-5817.02 4783.19,-5765.02 5056.19,-5765.02 5056.19,-5817.02"/>
<text text-anchor="middle" x="4919.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 27 Attention</text>
<text text-anchor="middle" x="4919.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 27)</text>
<text text-anchor="middle" x="4919.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4919.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head27 -->
<g id="edge1505" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4057.64,-5882.46C4257.8,-5869.08 4526.31,-5847.88 4772.73,-5817.09"/>
<polygon fill="black" stroke="black" points="4773.48,-5820.53 4782.96,-5815.81 4772.61,-5813.58 4773.48,-5820.53"/>
</g>
<!-- stage6_layer1_attn_head28 -->
<g id="node1162" class="node">
<title>stage6_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5347.19,-5817.02 5074.19,-5817.02 5074.19,-5765.02 5347.19,-5765.02 5347.19,-5817.02"/>
<text text-anchor="middle" x="5210.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 28 Attention</text>
<text text-anchor="middle" x="5210.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 28)</text>
<text text-anchor="middle" x="5210.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5210.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head28 -->
<g id="edge1506" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4073.28,-5889.39C4336.3,-5878.28 4719.83,-5856.91 5063.81,-5817.07"/>
<polygon fill="black" stroke="black" points="5064.45,-5820.52 5073.97,-5815.88 5063.64,-5813.56 5064.45,-5820.52"/>
</g>
<!-- stage6_layer1_attn_head29 -->
<g id="node1163" class="node">
<title>stage6_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5638.19,-5817.02 5365.19,-5817.02 5365.19,-5765.02 5638.19,-5765.02 5638.19,-5817.02"/>
<text text-anchor="middle" x="5501.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 29 Attention</text>
<text text-anchor="middle" x="5501.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 29)</text>
<text text-anchor="middle" x="5501.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5501.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head29 -->
<g id="edge1507" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4080.28,-5894.44C4401.72,-5886.22 4907.89,-5866.26 5354.77,-5817.06"/>
<polygon fill="black" stroke="black" points="5355.43,-5820.51 5364.98,-5815.93 5354.66,-5813.55 5355.43,-5820.51"/>
</g>
<!-- stage6_layer1_attn_head30 -->
<g id="node1164" class="node">
<title>stage6_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="5929.19,-5817.02 5656.19,-5817.02 5656.19,-5765.02 5929.19,-5765.02 5929.19,-5817.02"/>
<text text-anchor="middle" x="5792.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 30 Attention</text>
<text text-anchor="middle" x="5792.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 30)</text>
<text text-anchor="middle" x="5792.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5792.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head30 -->
<g id="edge1508" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4082.89,-5898.18C4458.34,-5893.12 5092.41,-5875.79 5645.8,-5817.05"/>
<polygon fill="black" stroke="black" points="5646.41,-5820.51 5655.98,-5815.96 5645.67,-5813.55 5646.41,-5820.51"/>
</g>
<!-- stage6_layer1_attn_head31 -->
<g id="node1165" class="node">
<title>stage6_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6220.19,-5817.02 5947.19,-5817.02 5947.19,-5765.02 6220.19,-5765.02 6220.19,-5817.02"/>
<text text-anchor="middle" x="6083.69" y="-5805.02" font-family="Times,serif" font-size="10.00">Layer 13 Head 31 Attention</text>
<text text-anchor="middle" x="6083.69" y="-5794.02" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Head 31)</text>
<text text-anchor="middle" x="6083.69" y="-5783.02" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6083.69" y="-5772.02" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head31 -->
<g id="edge1509" class="edge">
<title>stage6_layer1_tp_qkv_comm&#45;&gt;stage6_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4078.55,-5893.03C4590.93,-5880.93 5568.97,-5854.03 5936.81,-5817.03"/>
<polygon fill="black" stroke="black" points="5937.39,-5820.49 5946.99,-5815.99 5936.68,-5813.53 5937.39,-5820.49"/>
</g>
<!-- stage6_layer1_attn_agg -->
<g id="node1166" class="node">
<title>stage6_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4223.34,-5729.02 3479.41,-5729.02 3288.04,-5593.02 4031.97,-5593.02 4223.34,-5729.02"/>
<text text-anchor="middle" x="3755.69" y="-5679.82" font-family="Times,serif" font-size="14.00">Layer 13 Attention Aggregate</text>
<text text-anchor="middle" x="3755.69" y="-5664.82" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-5649.82" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-5634.82" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_attn_head0&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1510" class="edge">
<title>stage6_layer1_attn_head0&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1564.23,-5765.99C1567.07,-5765.65 1569.9,-5765.33 1572.69,-5765.02 2204.18,-5695.95 2943.43,-5673.17 3379.36,-5665.67"/>
<polygon fill="black" stroke="black" points="3379.67,-5669.17 3389.61,-5665.5 3379.55,-5662.17 3379.67,-5669.17"/>
</g>
<!-- stage6_layer1_attn_head1&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1511" class="edge">
<title>stage6_layer1_attn_head1&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1855.24,-5766.02C1858.08,-5765.67 1860.9,-5765.34 1863.69,-5765.02 2389.99,-5705.53 3002.69,-5680.13 3384.91,-5669.47"/>
<polygon fill="black" stroke="black" points="3385.12,-5672.96 3395.02,-5669.19 3384.93,-5665.97 3385.12,-5672.96"/>
</g>
<!-- stage6_layer1_attn_head2&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1512" class="edge">
<title>stage6_layer1_attn_head2&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2146.24,-5766.06C2149.08,-5765.7 2151.9,-5765.35 2154.69,-5765.02 2577.66,-5715.1 3066.57,-5688.06 3391.72,-5674.39"/>
<polygon fill="black" stroke="black" points="3391.93,-5677.88 3401.77,-5673.97 3391.63,-5670.89 3391.93,-5677.88"/>
</g>
<!-- stage6_layer1_attn_head3&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1513" class="edge">
<title>stage6_layer1_attn_head3&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2437.25,-5766.11C2440.08,-5765.74 2442.9,-5765.37 2445.69,-5765.02 2767.79,-5724.68 3136.56,-5697.36 3400.59,-5681.05"/>
<polygon fill="black" stroke="black" points="3400.96,-5684.54 3410.72,-5680.43 3400.53,-5677.55 3400.96,-5684.54"/>
</g>
<!-- stage6_layer1_attn_head4&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1514" class="edge">
<title>stage6_layer1_attn_head4&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2728.26,-5766.2C2731.09,-5765.79 2733.9,-5765.4 2736.69,-5765.02 2961.59,-5734.3 3215.58,-5708.61 3413.72,-5690.57"/>
<polygon fill="black" stroke="black" points="3414.07,-5694.05 3423.71,-5689.66 3413.43,-5687.08 3414.07,-5694.05"/>
</g>
<!-- stage6_layer1_attn_head5&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1515" class="edge">
<title>stage6_layer1_attn_head5&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3019.28,-5766.35C3022.11,-5765.9 3024.91,-5765.46 3027.69,-5765.02 3160.44,-5744.19 3307.12,-5723.07 3433.83,-5705.43"/>
<polygon fill="black" stroke="black" points="3434.65,-5708.85 3444.08,-5704 3433.69,-5701.91 3434.65,-5708.85"/>
</g>
<!-- stage6_layer1_attn_head6&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1516" class="edge">
<title>stage6_layer1_attn_head6&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3287.63,-5764.96C3338.21,-5753.84 3400.29,-5740.18 3462.5,-5726.5"/>
<polygon fill="black" stroke="black" points="3463.47,-5729.87 3472.49,-5724.3 3461.97,-5723.03 3463.47,-5729.87"/>
</g>
<!-- stage6_layer1_attn_head7&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1517" class="edge">
<title>stage6_layer1_attn_head7&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3521.83,-5764.88C3543.01,-5755.57 3568.2,-5744.49 3594.08,-5733.11"/>
<polygon fill="black" stroke="black" points="3595.51,-5736.3 3603.25,-5729.07 3592.69,-5729.89 3595.51,-5736.3"/>
</g>
<!-- stage6_layer1_attn_ellipsis&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1518" class="edge">
<title>stage6_layer1_attn_ellipsis&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3755.69,-5764.73C3755.69,-5757.13 3755.69,-5748.37 3755.69,-5739.23"/>
<polygon fill="black" stroke="black" points="3759.19,-5739.2 3755.69,-5729.2 3752.19,-5739.2 3759.19,-5739.2"/>
</g>
<!-- stage6_layer1_attn_head24&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1519" class="edge">
<title>stage6_layer1_attn_head24&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3989.54,-5764.88C3968.37,-5755.57 3943.18,-5744.49 3917.3,-5733.11"/>
<polygon fill="black" stroke="black" points="3918.69,-5729.89 3908.12,-5729.07 3915.87,-5736.3 3918.69,-5729.89"/>
</g>
<!-- stage6_layer1_attn_head25&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1520" class="edge">
<title>stage6_layer1_attn_head25&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4223.74,-5764.96C4179.03,-5755.13 4125.31,-5743.31 4070.45,-5731.25"/>
<polygon fill="black" stroke="black" points="4071.08,-5727.8 4060.56,-5729.07 4069.58,-5734.64 4071.08,-5727.8"/>
</g>
<!-- stage6_layer1_attn_head26&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1521" class="edge">
<title>stage6_layer1_attn_head26&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4491.93,-5766.48C4488.82,-5765.98 4485.74,-5765.5 4482.69,-5765.02 4400.61,-5752.18 4313.21,-5739.2 4228.51,-5726.99"/>
<polygon fill="black" stroke="black" points="4228.86,-5723.51 4218.46,-5725.54 4227.86,-5730.43 4228.86,-5723.51"/>
</g>
<!-- stage6_layer1_attn_head27&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1522" class="edge">
<title>stage6_layer1_attn_head27&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4782.95,-5766.31C4779.84,-5765.87 4776.75,-5765.44 4773.69,-5765.02 4583.01,-5739.08 4371.43,-5716.65 4190.77,-5699.41"/>
<polygon fill="black" stroke="black" points="4190.84,-5695.9 4180.56,-5698.43 4190.18,-5702.87 4190.84,-5695.9"/>
</g>
<!-- stage6_layer1_attn_head28&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1523" class="edge">
<title>stage6_layer1_attn_head28&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5073.97,-5766.22C5070.85,-5765.8 5067.75,-5765.4 5064.69,-5765.02 4766.68,-5727.86 4428.74,-5701.67 4170.88,-5685"/>
<polygon fill="black" stroke="black" points="4170.79,-5681.49 4160.59,-5684.34 4170.34,-5688.47 4170.79,-5681.49"/>
</g>
<!-- stage6_layer1_attn_head29&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1524" class="edge">
<title>stage6_layer1_attn_head29&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5364.97,-5766.16C5361.85,-5765.76 5358.75,-5765.38 5355.69,-5765.02 4949.71,-5717.33 4482.99,-5690.46 4158.82,-5676.22"/>
<polygon fill="black" stroke="black" points="4158.94,-5672.72 4148.79,-5675.78 4158.63,-5679.71 4158.94,-5672.72"/>
</g>
<!-- stage6_layer1_attn_head30&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1525" class="edge">
<title>stage6_layer1_attn_head30&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5655.98,-5766.12C5652.85,-5765.73 5649.75,-5765.37 5646.69,-5765.02 5131.76,-5707.11 4534.15,-5681.46 4150.82,-5670.31"/>
<polygon fill="black" stroke="black" points="4150.77,-5666.8 4140.67,-5670.01 4150.57,-5673.8 4150.77,-5666.8"/>
</g>
<!-- stage6_layer1_attn_head31&#45;&gt;stage6_layer1_attn_agg -->
<g id="edge1526" class="edge">
<title>stage6_layer1_attn_head31&#45;&gt;stage6_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5946.98,-5766.09C5943.86,-5765.71 5940.76,-5765.35 5937.69,-5765.02 5312.76,-5697.02 4582.31,-5673.9 4144.99,-5666.05"/>
<polygon fill="black" stroke="black" points="4144.77,-5662.54 4134.71,-5665.86 4144.65,-5669.54 4144.77,-5662.54"/>
</g>
<!-- stage6_layer1_attn_out -->
<g id="node1167" class="node">
<title>stage6_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="3980.69,-5557.02 3530.69,-5557.02 3530.69,-5489.02 3980.69,-5489.02 3980.69,-5557.02"/>
<text text-anchor="middle" x="3755.69" y="-5541.82" font-family="Times,serif" font-size="14.00">Layer 13 Attention Output Proj</text>
<text text-anchor="middle" x="3755.69" y="-5526.82" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP: GPU 768&#45;895)</text>
<text text-anchor="middle" x="3755.69" y="-5511.82" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5496.82" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_attn_agg&#45;&gt;stage6_layer1_attn_out -->
<g id="edge1527" class="edge">
<title>stage6_layer1_attn_agg&#45;&gt;stage6_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3755.69,-5592.82C3755.69,-5584.07 3755.69,-5575.3 3755.69,-5567.09"/>
<polygon fill="black" stroke="black" points="3759.19,-5567.04 3755.69,-5557.04 3752.19,-5567.04 3759.19,-5567.04"/>
</g>
<!-- stage6_layer1_tp_attn_comm -->
<g id="node1168" class="node">
<title>stage6_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-5404.94" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3755.69" y="-5423.74" font-family="Times,serif" font-size="14.00">Layer 13 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3755.69" y="-5408.74" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6 (TP pairs)</text>
<text text-anchor="middle" x="3755.69" y="-5393.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5378.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_attn_out&#45;&gt;stage6_layer1_tp_attn_comm -->
<g id="edge1528" class="edge">
<title>stage6_layer1_attn_out&#45;&gt;stage6_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3755.69,-5488.76C3755.69,-5480.76 3755.69,-5472 3755.69,-5463.25"/>
<polygon fill="black" stroke="black" points="3759.19,-5463.05 3755.69,-5453.05 3752.19,-5463.05 3759.19,-5463.05"/>
</g>
<!-- stage6_layer1_expert_router -->
<g id="node1169" class="node">
<title>stage6_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4209.88,-5320.85 3487.36,-5320.85 3301.49,-5184.85 4024.02,-5184.85 4209.88,-5320.85"/>
<text text-anchor="middle" x="3755.69" y="-5271.65" font-family="Times,serif" font-size="14.00">Layer 13 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3755.69" y="-5256.65" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-5241.65" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5226.65" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage6_layer1_tp_attn_comm&#45;&gt;stage6_layer1_expert_router -->
<g id="edge1529" class="edge">
<title>stage6_layer1_tp_attn_comm&#45;&gt;stage6_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3755.69,-5356.45C3755.69,-5348.36 3755.69,-5339.78 3755.69,-5331.16"/>
<polygon fill="black" stroke="black" points="3759.19,-5331.05 3755.69,-5321.05 3752.19,-5331.05 3759.19,-5331.05"/>
</g>
<!-- stage6_layer1_expert0 -->
<g id="node1170" class="node">
<title>stage6_layer1_expert0</title>
<polygon fill="none" stroke="black" points="1908.69,-5148.85 1586.69,-5148.85 1586.69,-5096.85 1908.69,-5096.85 1908.69,-5148.85"/>
<text text-anchor="middle" x="1747.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 0</text>
<text text-anchor="middle" x="1747.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP pair)</text>
<text text-anchor="middle" x="1747.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1747.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert0 -->
<g id="edge1530" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3361.92,-5229.19C3022.22,-5209.27 2518.5,-5178.86 2079.69,-5148.85 2027.52,-5145.29 1970.76,-5141.12 1919.17,-5137.22"/>
<polygon fill="black" stroke="black" points="1919.16,-5133.71 1908.92,-5136.44 1918.63,-5140.69 1919.16,-5133.71"/>
</g>
<!-- stage6_layer1_expert1 -->
<g id="node1176" class="node">
<title>stage6_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2410.69,-5148.85 2088.69,-5148.85 2088.69,-5096.85 2410.69,-5096.85 2410.69,-5148.85"/>
<text text-anchor="middle" x="2249.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 1</text>
<text text-anchor="middle" x="2249.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP pair)</text>
<text text-anchor="middle" x="2249.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2249.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert1 -->
<g id="edge1536" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3350.97,-5221.11C3102.84,-5201.71 2778.75,-5175.37 2491.69,-5148.85 2468.78,-5146.74 2444.66,-5144.39 2420.89,-5142.01"/>
<polygon fill="black" stroke="black" points="2421.03,-5138.5 2410.73,-5140.98 2420.33,-5145.47 2421.03,-5138.5"/>
</g>
<!-- stage6_layer1_expert2 -->
<g id="node1182" class="node">
<title>stage6_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2822.69,-5148.85 2500.69,-5148.85 2500.69,-5096.85 2822.69,-5096.85 2822.69,-5148.85"/>
<text text-anchor="middle" x="2661.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 2</text>
<text text-anchor="middle" x="2661.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP pair)</text>
<text text-anchor="middle" x="2661.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2661.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert2 -->
<g id="edge1542" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3324.17,-5201.56C3180.83,-5184.83 3020.39,-5166.07 2873.69,-5148.85 2860.43,-5147.3 2846.71,-5145.69 2832.92,-5144.06"/>
<polygon fill="black" stroke="black" points="2833.21,-5140.57 2822.87,-5142.88 2832.39,-5147.53 2833.21,-5140.57"/>
</g>
<!-- stage6_layer1_expert3 -->
<g id="node1188" class="node">
<title>stage6_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3204.69,-5148.85 2882.69,-5148.85 2882.69,-5096.85 3204.69,-5096.85 3204.69,-5148.85"/>
<text text-anchor="middle" x="3043.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 3</text>
<text text-anchor="middle" x="3043.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP pair)</text>
<text text-anchor="middle" x="3043.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3043.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert3 -->
<g id="edge1548" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3382.75,-5184.81C3315.49,-5172.72 3249.05,-5160.77 3193.04,-5150.7"/>
<polygon fill="black" stroke="black" points="3193.53,-5147.24 3183.06,-5148.91 3192.29,-5154.12 3193.53,-5147.24"/>
</g>
<!-- stage6_layer1_expert31 -->
<g id="node1194" class="node">
<title>stage6_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3565.69,-5148.85 3243.69,-5148.85 3243.69,-5096.85 3565.69,-5096.85 3565.69,-5148.85"/>
<text text-anchor="middle" x="3404.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 31</text>
<text text-anchor="middle" x="3404.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP pair)</text>
<text text-anchor="middle" x="3404.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3404.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert31 -->
<g id="edge1554" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3571.71,-5184.76C3540.42,-5173.35 3509.5,-5162.08 3482.92,-5152.38"/>
<polygon fill="black" stroke="black" points="3483.93,-5149.03 3473.34,-5148.89 3481.53,-5155.6 3483.93,-5149.03"/>
</g>
<!-- stage6_layer1_expert32 -->
<g id="node1200" class="node">
<title>stage6_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3916.69,-5148.85 3594.69,-5148.85 3594.69,-5096.85 3916.69,-5096.85 3916.69,-5148.85"/>
<text text-anchor="middle" x="3755.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 32</text>
<text text-anchor="middle" x="3755.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP pair)</text>
<text text-anchor="middle" x="3755.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert32 -->
<g id="edge1560" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3755.69,-5184.48C3755.69,-5175.78 3755.69,-5167.17 3755.69,-5159.29"/>
<polygon fill="black" stroke="black" points="3759.19,-5159.05 3755.69,-5149.05 3752.19,-5159.05 3759.19,-5159.05"/>
</g>
<!-- stage6_layer1_expert60 -->
<g id="node1206" class="node">
<title>stage6_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4300.69,-5148.85 3978.69,-5148.85 3978.69,-5096.85 4300.69,-5096.85 4300.69,-5148.85"/>
<text text-anchor="middle" x="4139.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 60</text>
<text text-anchor="middle" x="4139.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP pair)</text>
<text text-anchor="middle" x="4139.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4139.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert60 -->
<g id="edge1566" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3956.97,-5184.76C3991.49,-5173.25 4025.62,-5161.88 4054.86,-5152.13"/>
<polygon fill="black" stroke="black" points="4056.21,-5155.37 4064.59,-5148.89 4053.99,-5148.73 4056.21,-5155.37"/>
</g>
<!-- stage6_layer1_expert61 -->
<g id="node1212" class="node">
<title>stage6_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4707.69,-5148.85 4385.69,-5148.85 4385.69,-5096.85 4707.69,-5096.85 4707.69,-5148.85"/>
<text text-anchor="middle" x="4546.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 61</text>
<text text-anchor="middle" x="4546.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP pair)</text>
<text text-anchor="middle" x="4546.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4546.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert61 -->
<g id="edge1572" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.51,-5204.15C4162.58,-5186.01 4286.21,-5166 4382.03,-5150.5"/>
<polygon fill="black" stroke="black" points="4382.79,-5153.92 4392.1,-5148.87 4381.67,-5147.01 4382.79,-5153.92"/>
</g>
<!-- stage6_layer1_expert62 -->
<g id="node1218" class="node">
<title>stage6_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5104.69,-5148.85 4782.69,-5148.85 4782.69,-5096.85 5104.69,-5096.85 5104.69,-5148.85"/>
<text text-anchor="middle" x="4943.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 62</text>
<text text-anchor="middle" x="4943.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP pair)</text>
<text text-anchor="middle" x="4943.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4943.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert62 -->
<g id="edge1578" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4070.04,-5218.4C4257.75,-5198.36 4500.87,-5172.3 4716.69,-5148.85 4734.73,-5146.89 4753.58,-5144.84 4772.37,-5142.78"/>
<polygon fill="black" stroke="black" points="4772.93,-5146.24 4782.48,-5141.67 4772.16,-5139.28 4772.93,-5146.24"/>
</g>
<!-- stage6_layer1_expert63 -->
<g id="node1224" class="node">
<title>stage6_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5473.69,-5148.85 5151.69,-5148.85 5151.69,-5096.85 5473.69,-5096.85 5473.69,-5148.85"/>
<text text-anchor="middle" x="5312.69" y="-5136.85" font-family="Times,serif" font-size="10.00">Layer 13 Expert 63</text>
<text text-anchor="middle" x="5312.69" y="-5125.85" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP pair)</text>
<text text-anchor="middle" x="5312.69" y="-5114.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5312.69" y="-5103.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert63 -->
<g id="edge1584" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4087.46,-5231.27C4362.66,-5213.1 4764.05,-5184.05 5113.69,-5148.85 5122.72,-5147.94 5131.98,-5146.96 5141.32,-5145.93"/>
<polygon fill="black" stroke="black" points="5141.93,-5149.38 5151.48,-5144.79 5141.15,-5142.43 5141.93,-5149.38"/>
</g>
<!-- stage6_layer1_expert_ellipsis -->
<g id="node1230" class="node">
<title>stage6_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6049.69,-5060.85 5727.69,-5060.85 5727.69,-5008.85 6049.69,-5008.85 6049.69,-5060.85"/>
<text text-anchor="middle" x="5888.69" y="-5048.85" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5888.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: Pipeline 6 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5888.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5888.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert_ellipsis -->
<g id="edge1590" class="edge">
<title>stage6_layer1_expert_router&#45;&gt;stage6_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4099.47,-5239.98C4525.31,-5223.76 5225.97,-5191.74 5482.69,-5148.85 5597.28,-5129.71 5725.93,-5090.84 5807.1,-5064.08"/>
<polygon fill="black" stroke="black" points="5808.37,-5067.35 5816.76,-5060.88 5806.17,-5060.7 5808.37,-5067.35"/>
</g>
<!-- stage6_layer1_expert0_mlp1 -->
<g id="node1171" class="node">
<title>stage6_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1784.69,-5060.85 1470.69,-5060.85 1470.69,-5008.85 1784.69,-5008.85 1784.69,-5060.85"/>
<text text-anchor="middle" x="1627.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1627.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1627.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1627.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert0&#45;&gt;stage6_layer1_expert0_mlp1 -->
<g id="edge1531" class="edge">
<title>stage6_layer1_expert0&#45;&gt;stage6_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1712.66,-5096.75C1699.71,-5087.47 1684.87,-5076.84 1671.26,-5067.08"/>
<polygon fill="black" stroke="black" points="1673.14,-5064.12 1662.97,-5061.14 1669.06,-5069.81 1673.14,-5064.12"/>
</g>
<!-- stage6_layer1_expert0_tp1 -->
<g id="node1172" class="node">
<title>stage6_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1525.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1525.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1525.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="1525.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1525.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert0_mlp1&#45;&gt;stage6_layer1_expert0_tp1 -->
<g id="edge1532" class="edge">
<title>stage6_layer1_expert0_mlp1&#45;&gt;stage6_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1601.16,-5008.68C1591.75,-4999.76 1580.89,-4989.46 1570.39,-4979.5"/>
<polygon fill="black" stroke="black" points="1572.5,-4976.67 1562.84,-4972.33 1567.68,-4981.75 1572.5,-4976.67"/>
</g>
<!-- stage6_layer1_expert0_act -->
<g id="node1173" class="node">
<title>stage6_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1661.19,-4863.31 1380.19,-4863.31 1380.19,-4811.31 1661.19,-4811.31 1661.19,-4863.31"/>
<text text-anchor="middle" x="1520.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1520.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="1520.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1520.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert0_tp1&#45;&gt;stage6_layer1_expert0_act -->
<g id="edge1533" class="edge">
<title>stage6_layer1_expert0_tp1&#45;&gt;stage6_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1523.83,-4899.05C1523.4,-4890.74 1522.94,-4881.91 1522.51,-4873.62"/>
<polygon fill="black" stroke="black" points="1526,-4873.32 1521.99,-4863.51 1519.01,-4873.68 1526,-4873.32"/>
</g>
<!-- stage6_layer1_expert0_mlp2 -->
<g id="node1174" class="node">
<title>stage6_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1594.69,-4775.31 1272.69,-4775.31 1272.69,-4723.31 1594.69,-4723.31 1594.69,-4775.31"/>
<text text-anchor="middle" x="1433.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1433.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1433.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1433.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert0_act&#45;&gt;stage6_layer1_expert0_mlp2 -->
<g id="edge1534" class="edge">
<title>stage6_layer1_expert0_act&#45;&gt;stage6_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1495.06,-4810.98C1486.12,-4802.14 1475.96,-4792.1 1466.52,-4782.77"/>
<polygon fill="black" stroke="black" points="1468.71,-4780.01 1459.14,-4775.47 1463.79,-4784.99 1468.71,-4780.01"/>
</g>
<!-- stage6_layer1_expert0_tp2 -->
<g id="node1175" class="node">
<title>stage6_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1390.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1390.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1390.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 768&#45;769</text>
<text text-anchor="middle" x="1390.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1390.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert0_mlp2&#45;&gt;stage6_layer1_expert0_tp2 -->
<g id="edge1535" class="edge">
<title>stage6_layer1_expert0_mlp2&#45;&gt;stage6_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1422.5,-4723.14C1418.92,-4715.08 1414.84,-4705.89 1410.82,-4696.84"/>
<polygon fill="black" stroke="black" points="1413.93,-4695.24 1406.67,-4687.52 1407.54,-4698.08 1413.93,-4695.24"/>
</g>
<!-- stage6_layer1_expert_agg -->
<g id="node1231" class="node">
<title>stage6_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4306.22,-4577.78 3430.45,-4577.78 3205.16,-4441.78 4080.93,-4441.78 4306.22,-4577.78"/>
<text text-anchor="middle" x="3755.69" y="-4528.58" font-family="Times,serif" font-size="14.00">Layer 13 Expert Aggregation</text>
<text text-anchor="middle" x="3755.69" y="-4513.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-4498.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-4483.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert0_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1591" class="edge">
<title>stage6_layer1_expert0_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1546.23,-4623.67C1573.01,-4619.88 1600.61,-4616.38 1626.69,-4613.78 2211.93,-4555.42 2891.1,-4529.82 3321.99,-4518.8"/>
<polygon fill="black" stroke="black" points="3322.22,-4522.3 3332.12,-4518.54 3322.04,-4515.3 3322.22,-4522.3"/>
</g>
<!-- stage6_layer1_expert1_mlp1 -->
<g id="node1177" class="node">
<title>stage6_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2342.69,-5060.85 2028.69,-5060.85 2028.69,-5008.85 2342.69,-5008.85 2342.69,-5060.85"/>
<text text-anchor="middle" x="2185.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2185.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2185.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2185.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert1&#45;&gt;stage6_layer1_expert1_mlp1 -->
<g id="edge1537" class="edge">
<title>stage6_layer1_expert1&#45;&gt;stage6_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2230.83,-5096.52C2224.45,-5087.94 2217.23,-5078.24 2210.46,-5069.14"/>
<polygon fill="black" stroke="black" points="2213.19,-5066.94 2204.41,-5061.01 2207.57,-5071.12 2213.19,-5066.94"/>
</g>
<!-- stage6_layer1_expert1_tp1 -->
<g id="node1178" class="node">
<title>stage6_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2020.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2020.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2020.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="2020.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2020.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert1_mlp1&#45;&gt;stage6_layer1_expert1_tp1 -->
<g id="edge1538" class="edge">
<title>stage6_layer1_expert1_mlp1&#45;&gt;stage6_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2142.77,-5008.68C2126.03,-4998.87 2106.45,-4987.38 2087.94,-4976.52"/>
<polygon fill="black" stroke="black" points="2089.63,-4973.46 2079.23,-4971.42 2086.09,-4979.5 2089.63,-4973.46"/>
</g>
<!-- stage6_layer1_expert1_act -->
<g id="node1179" class="node">
<title>stage6_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2115.19,-4863.31 1834.19,-4863.31 1834.19,-4811.31 2115.19,-4811.31 2115.19,-4863.31"/>
<text text-anchor="middle" x="1974.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="1974.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="1974.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1974.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert1_tp1&#45;&gt;stage6_layer1_expert1_act -->
<g id="edge1539" class="edge">
<title>stage6_layer1_expert1_tp1&#45;&gt;stage6_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2003.69,-4899.33C1999.52,-4890.55 1995.06,-4881.17 1990.93,-4872.47"/>
<polygon fill="black" stroke="black" points="1994.05,-4870.89 1986.59,-4863.36 1987.73,-4873.89 1994.05,-4870.89"/>
</g>
<!-- stage6_layer1_expert1_mlp2 -->
<g id="node1180" class="node">
<title>stage6_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2090.69,-4775.31 1768.69,-4775.31 1768.69,-4723.31 2090.69,-4723.31 2090.69,-4775.31"/>
<text text-anchor="middle" x="1929.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="1929.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1929.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1929.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert1_act&#45;&gt;stage6_layer1_expert1_mlp2 -->
<g id="edge1540" class="edge">
<title>stage6_layer1_expert1_act&#45;&gt;stage6_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M1961.43,-4810.98C1957.08,-4802.67 1952.18,-4793.29 1947.54,-4784.44"/>
<polygon fill="black" stroke="black" points="1950.59,-4782.71 1942.85,-4775.47 1944.39,-4785.95 1950.59,-4782.71"/>
</g>
<!-- stage6_layer1_expert1_tp2 -->
<g id="node1181" class="node">
<title>stage6_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1863.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1863.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1863.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 770&#45;771</text>
<text text-anchor="middle" x="1863.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1863.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert1_mlp2&#45;&gt;stage6_layer1_expert1_tp2 -->
<g id="edge1541" class="edge">
<title>stage6_layer1_expert1_mlp2&#45;&gt;stage6_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M1912.52,-4723.14C1906.79,-4714.74 1900.22,-4705.11 1893.8,-4695.7"/>
<polygon fill="black" stroke="black" points="1896.5,-4693.45 1887.98,-4687.16 1890.72,-4697.39 1896.5,-4693.45"/>
</g>
<!-- stage6_layer1_expert1_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1592" class="edge">
<title>stage6_layer1_expert1_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2020.22,-4623.84C2046.69,-4620.06 2073.93,-4616.52 2099.69,-4613.78 2518.55,-4569.1 2999.24,-4541.85 3334.44,-4526.7"/>
<polygon fill="black" stroke="black" points="3334.98,-4530.18 3344.81,-4526.24 3334.67,-4523.19 3334.98,-4530.18"/>
</g>
<!-- stage6_layer1_expert2_mlp1 -->
<g id="node1183" class="node">
<title>stage6_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2755.69,-5060.85 2441.69,-5060.85 2441.69,-5008.85 2755.69,-5008.85 2755.69,-5060.85"/>
<text text-anchor="middle" x="2598.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2598.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2598.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2598.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert2&#45;&gt;stage6_layer1_expert2_mlp1 -->
<g id="edge1543" class="edge">
<title>stage6_layer1_expert2&#45;&gt;stage6_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2643.13,-5096.52C2636.85,-5087.94 2629.74,-5078.24 2623.07,-5069.14"/>
<polygon fill="black" stroke="black" points="2625.85,-5067.01 2617.12,-5061.01 2620.2,-5071.15 2625.85,-5067.01"/>
</g>
<!-- stage6_layer1_expert2_tp1 -->
<g id="node1184" class="node">
<title>stage6_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2475.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2475.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2475.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="2475.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2475.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert2_mlp1&#45;&gt;stage6_layer1_expert2_tp1 -->
<g id="edge1544" class="edge">
<title>stage6_layer1_expert2_mlp1&#45;&gt;stage6_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2566.69,-5008.68C2554.9,-4999.41 2541.22,-4988.64 2528.1,-4978.32"/>
<polygon fill="black" stroke="black" points="2530.05,-4975.4 2520.02,-4971.96 2525.72,-4980.9 2530.05,-4975.4"/>
</g>
<!-- stage6_layer1_expert2_act -->
<g id="node1185" class="node">
<title>stage6_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2581.19,-4863.31 2300.19,-4863.31 2300.19,-4811.31 2581.19,-4811.31 2581.19,-4863.31"/>
<text text-anchor="middle" x="2440.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2440.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="2440.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2440.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert2_tp1&#45;&gt;stage6_layer1_expert2_act -->
<g id="edge1545" class="edge">
<title>stage6_layer1_expert2_tp1&#45;&gt;stage6_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2462.76,-4899.33C2459.65,-4890.74 2456.33,-4881.57 2453.24,-4873.03"/>
<polygon fill="black" stroke="black" points="2456.44,-4871.57 2449.75,-4863.36 2449.86,-4873.95 2456.44,-4871.57"/>
</g>
<!-- stage6_layer1_expert2_mlp2 -->
<g id="node1186" class="node">
<title>stage6_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2566.69,-4775.31 2244.69,-4775.31 2244.69,-4723.31 2566.69,-4723.31 2566.69,-4775.31"/>
<text text-anchor="middle" x="2405.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2405.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2405.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2405.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert2_act&#45;&gt;stage6_layer1_expert2_mlp2 -->
<g id="edge1546" class="edge">
<title>stage6_layer1_expert2_act&#45;&gt;stage6_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2430.38,-4810.98C2427.07,-4802.84 2423.34,-4793.68 2419.8,-4785"/>
<polygon fill="black" stroke="black" points="2422.94,-4783.41 2415.93,-4775.47 2416.45,-4786.05 2422.94,-4783.41"/>
</g>
<!-- stage6_layer1_expert2_tp2 -->
<g id="node1187" class="node">
<title>stage6_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2336.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2336.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2336.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 772&#45;773</text>
<text text-anchor="middle" x="2336.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2336.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert2_mlp2&#45;&gt;stage6_layer1_expert2_tp2 -->
<g id="edge1547" class="edge">
<title>stage6_layer1_expert2_mlp2&#45;&gt;stage6_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2387.74,-4723.14C2381.69,-4714.65 2374.74,-4704.91 2367.97,-4695.41"/>
<polygon fill="black" stroke="black" points="2370.74,-4693.27 2362.08,-4687.16 2365.04,-4697.33 2370.74,-4693.27"/>
</g>
<!-- stage6_layer1_expert2_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1593" class="edge">
<title>stage6_layer1_expert2_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2495.18,-4624.11C2521.05,-4620.36 2547.59,-4616.77 2572.69,-4613.78 2832.52,-4582.81 3125.5,-4557.23 3354.9,-4539.31"/>
<polygon fill="black" stroke="black" points="3355.39,-4542.78 3365.09,-4538.51 3354.84,-4535.8 3355.39,-4542.78"/>
</g>
<!-- stage6_layer1_expert3_mlp1 -->
<g id="node1189" class="node">
<title>stage6_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3128.69,-5060.85 2814.69,-5060.85 2814.69,-5008.85 3128.69,-5008.85 3128.69,-5060.85"/>
<text text-anchor="middle" x="2971.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="2971.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2971.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2971.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert3&#45;&gt;stage6_layer1_expert3_mlp1 -->
<g id="edge1549" class="edge">
<title>stage6_layer1_expert3&#45;&gt;stage6_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3022.48,-5096.52C3015.22,-5087.86 3007.01,-5078.04 2999.32,-5068.86"/>
<polygon fill="black" stroke="black" points="3001.85,-5066.43 2992.75,-5061.01 2996.49,-5070.93 3001.85,-5066.43"/>
</g>
<!-- stage6_layer1_expert3_tp1 -->
<g id="node1190" class="node">
<title>stage6_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="2910.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2910.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="2910.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="2910.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2910.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert3_mlp1&#45;&gt;stage6_layer1_expert3_tp1 -->
<g id="edge1550" class="edge">
<title>stage6_layer1_expert3_mlp1&#45;&gt;stage6_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M2955.82,-5008.68C2950.52,-5000.28 2944.45,-4990.65 2938.52,-4981.24"/>
<polygon fill="black" stroke="black" points="2941.43,-4979.29 2933.14,-4972.69 2935.51,-4983.02 2941.43,-4979.29"/>
</g>
<!-- stage6_layer1_expert3_act -->
<g id="node1191" class="node">
<title>stage6_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="2993.19,-4863.31 2712.19,-4863.31 2712.19,-4811.31 2993.19,-4811.31 2993.19,-4863.31"/>
<text text-anchor="middle" x="2852.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2852.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="2852.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2852.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert3_tp1&#45;&gt;stage6_layer1_expert3_act -->
<g id="edge1551" class="edge">
<title>stage6_layer1_expert3_tp1&#45;&gt;stage6_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2889.26,-4899.33C2883.94,-4890.46 2878.26,-4880.98 2873,-4872.2"/>
<polygon fill="black" stroke="black" points="2875.84,-4870.14 2867.7,-4863.36 2869.84,-4873.74 2875.84,-4870.14"/>
</g>
<!-- stage6_layer1_expert3_mlp2 -->
<g id="node1192" class="node">
<title>stage6_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="2992.69,-4775.31 2670.69,-4775.31 2670.69,-4723.31 2992.69,-4723.31 2992.69,-4775.31"/>
<text text-anchor="middle" x="2831.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2831.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2831.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2831.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert3_act&#45;&gt;stage6_layer1_expert3_mlp2 -->
<g id="edge1552" class="edge">
<title>stage6_layer1_expert3_act&#45;&gt;stage6_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2846.5,-4810.98C2844.54,-4802.93 2842.33,-4793.88 2840.23,-4785.28"/>
<polygon fill="black" stroke="black" points="2843.6,-4784.36 2837.83,-4775.47 2836.8,-4786.02 2843.6,-4784.36"/>
</g>
<!-- stage6_layer1_expert3_tp2 -->
<g id="node1193" class="node">
<title>stage6_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2809.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2809.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2809.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 774&#45;775</text>
<text text-anchor="middle" x="2809.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2809.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert3_mlp2&#45;&gt;stage6_layer1_expert3_tp2 -->
<g id="edge1553" class="edge">
<title>stage6_layer1_expert3_mlp2&#45;&gt;stage6_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2825.97,-4723.14C2824.17,-4715.25 2822.13,-4706.28 2820.12,-4697.41"/>
<polygon fill="black" stroke="black" points="2823.5,-4696.5 2817.87,-4687.52 2816.67,-4698.05 2823.5,-4696.5"/>
</g>
<!-- stage6_layer1_expert3_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1594" class="edge">
<title>stage6_layer1_expert3_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2972.17,-4624.78C2996.8,-4621.07 3021.91,-4617.3 3045.69,-4613.78 3158.56,-4597.04 3281.57,-4579.09 3393.01,-4562.94"/>
<polygon fill="black" stroke="black" points="3393.67,-4566.38 3403.06,-4561.48 3392.67,-4559.45 3393.67,-4566.38"/>
</g>
<!-- stage6_layer1_expert31_mlp1 -->
<g id="node1195" class="node">
<title>stage6_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3521.69,-5060.85 3207.69,-5060.85 3207.69,-5008.85 3521.69,-5008.85 3521.69,-5060.85"/>
<text text-anchor="middle" x="3364.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3364.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3364.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3364.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert31&#45;&gt;stage6_layer1_expert31_mlp1 -->
<g id="edge1555" class="edge">
<title>stage6_layer1_expert31&#45;&gt;stage6_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3392.9,-5096.52C3389.08,-5088.29 3384.77,-5079.03 3380.69,-5070.26"/>
<polygon fill="black" stroke="black" points="3383.78,-5068.6 3376.39,-5061.01 3377.43,-5071.55 3383.78,-5068.6"/>
</g>
<!-- stage6_layer1_expert31_tp1 -->
<g id="node1196" class="node">
<title>stage6_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3335.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3335.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3335.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="3335.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3335.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert31_mlp1&#45;&gt;stage6_layer1_expert31_tp1 -->
<g id="edge1556" class="edge">
<title>stage6_layer1_expert31_mlp1&#45;&gt;stage6_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3357.14,-5008.68C3354.75,-5000.7 3352.03,-4991.62 3349.35,-4982.67"/>
<polygon fill="black" stroke="black" points="3352.69,-4981.64 3346.47,-4973.06 3345.99,-4983.64 3352.69,-4981.64"/>
</g>
<!-- stage6_layer1_expert31_act -->
<g id="node1197" class="node">
<title>stage6_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3447.19,-4863.31 3166.19,-4863.31 3166.19,-4811.31 3447.19,-4811.31 3447.19,-4863.31"/>
<text text-anchor="middle" x="3306.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3306.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="3306.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3306.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert31_tp1&#45;&gt;stage6_layer1_expert31_act -->
<g id="edge1557" class="edge">
<title>stage6_layer1_expert31_tp1&#45;&gt;stage6_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3324.97,-4899.33C3322.4,-4890.74 3319.65,-4881.57 3317.09,-4873.03"/>
<polygon fill="black" stroke="black" points="3320.42,-4871.93 3314.19,-4863.36 3313.71,-4873.94 3320.42,-4871.93"/>
</g>
<!-- stage6_layer1_expert31_mlp2 -->
<g id="node1198" class="node">
<title>stage6_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3455.69,-4775.31 3133.69,-4775.31 3133.69,-4723.31 3455.69,-4723.31 3455.69,-4775.31"/>
<text text-anchor="middle" x="3294.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3294.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3294.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3294.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert31_act&#45;&gt;stage6_layer1_expert31_mlp2 -->
<g id="edge1558" class="edge">
<title>stage6_layer1_expert31_act&#45;&gt;stage6_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3303.15,-4810.98C3302.04,-4803.02 3300.79,-4794.08 3299.61,-4785.56"/>
<polygon fill="black" stroke="black" points="3303.05,-4784.89 3298.2,-4775.47 3296.11,-4785.86 3303.05,-4784.89"/>
</g>
<!-- stage6_layer1_expert31_tp2 -->
<g id="node1199" class="node">
<title>stage6_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3282.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3282.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3282.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 830&#45;831</text>
<text text-anchor="middle" x="3282.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3282.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert31_mlp2&#45;&gt;stage6_layer1_expert31_tp2 -->
<g id="edge1559" class="edge">
<title>stage6_layer1_expert31_mlp2&#45;&gt;stage6_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3291.57,-4723.14C3290.6,-4715.33 3289.5,-4706.47 3288.41,-4697.7"/>
<polygon fill="black" stroke="black" points="3291.85,-4697.02 3287.15,-4687.52 3284.91,-4697.88 3291.85,-4697.02"/>
</g>
<!-- stage6_layer1_expert31_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1595" class="edge">
<title>stage6_layer1_expert31_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3390.02,-4618.06C3428.11,-4606.88 3472.65,-4593.81 3517.28,-4580.72"/>
<polygon fill="black" stroke="black" points="3518.49,-4584.01 3527.1,-4577.84 3516.52,-4577.3 3518.49,-4584.01"/>
</g>
<!-- stage6_layer1_expert32_mlp1 -->
<g id="node1201" class="node">
<title>stage6_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3912.69,-5060.85 3598.69,-5060.85 3598.69,-5008.85 3912.69,-5008.85 3912.69,-5060.85"/>
<text text-anchor="middle" x="3755.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3755.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3755.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert32&#45;&gt;stage6_layer1_expert32_mlp1 -->
<g id="edge1561" class="edge">
<title>stage6_layer1_expert32&#45;&gt;stage6_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3755.69,-5096.52C3755.69,-5088.56 3755.69,-5079.62 3755.69,-5071.1"/>
<polygon fill="black" stroke="black" points="3759.19,-5071.01 3755.69,-5061.01 3752.19,-5071.01 3759.19,-5071.01"/>
</g>
<!-- stage6_layer1_expert32_tp1 -->
<g id="node1202" class="node">
<title>stage6_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3755.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3755.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="3755.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3755.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert32_mlp1&#45;&gt;stage6_layer1_expert32_tp1 -->
<g id="edge1562" class="edge">
<title>stage6_layer1_expert32_mlp1&#45;&gt;stage6_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3755.69,-5008.68C3755.69,-5000.87 3755.69,-4992.01 3755.69,-4983.24"/>
<polygon fill="black" stroke="black" points="3759.19,-4983.06 3755.69,-4973.06 3752.19,-4983.06 3759.19,-4983.06"/>
</g>
<!-- stage6_layer1_expert32_act -->
<g id="node1203" class="node">
<title>stage6_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3896.19,-4863.31 3615.19,-4863.31 3615.19,-4811.31 3896.19,-4811.31 3896.19,-4863.31"/>
<text text-anchor="middle" x="3755.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3755.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="3755.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3755.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert32_tp1&#45;&gt;stage6_layer1_expert32_act -->
<g id="edge1563" class="edge">
<title>stage6_layer1_expert32_tp1&#45;&gt;stage6_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3755.69,-4899.05C3755.69,-4890.74 3755.69,-4881.91 3755.69,-4873.62"/>
<polygon fill="black" stroke="black" points="3759.19,-4873.51 3755.69,-4863.51 3752.19,-4873.51 3759.19,-4873.51"/>
</g>
<!-- stage6_layer1_expert32_mlp2 -->
<g id="node1204" class="node">
<title>stage6_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3916.69,-4775.31 3594.69,-4775.31 3594.69,-4723.31 3916.69,-4723.31 3916.69,-4775.31"/>
<text text-anchor="middle" x="3755.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3755.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3755.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3755.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert32_act&#45;&gt;stage6_layer1_expert32_mlp2 -->
<g id="edge1564" class="edge">
<title>stage6_layer1_expert32_act&#45;&gt;stage6_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3755.69,-4810.98C3755.69,-4803.02 3755.69,-4794.08 3755.69,-4785.56"/>
<polygon fill="black" stroke="black" points="3759.19,-4785.47 3755.69,-4775.47 3752.19,-4785.47 3759.19,-4785.47"/>
</g>
<!-- stage6_layer1_expert32_tp2 -->
<g id="node1205" class="node">
<title>stage6_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3755.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3755.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 832&#45;833</text>
<text text-anchor="middle" x="3755.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert32_mlp2&#45;&gt;stage6_layer1_expert32_tp2 -->
<g id="edge1565" class="edge">
<title>stage6_layer1_expert32_mlp2&#45;&gt;stage6_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3755.69,-4723.14C3755.69,-4715.33 3755.69,-4706.47 3755.69,-4697.7"/>
<polygon fill="black" stroke="black" points="3759.19,-4697.52 3755.69,-4687.52 3752.19,-4697.52 3759.19,-4697.52"/>
</g>
<!-- stage6_layer1_expert32_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1596" class="edge">
<title>stage6_layer1_expert32_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3755.69,-4613.45C3755.69,-4605.51 3755.69,-4596.82 3755.69,-4587.95"/>
<polygon fill="black" stroke="black" points="3759.19,-4587.89 3755.69,-4577.89 3752.19,-4587.89 3759.19,-4587.89"/>
</g>
<!-- stage6_layer1_expert60_mlp1 -->
<g id="node1207" class="node">
<title>stage6_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4318.69,-5060.85 4004.69,-5060.85 4004.69,-5008.85 4318.69,-5008.85 4318.69,-5060.85"/>
<text text-anchor="middle" x="4161.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4161.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4161.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4161.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert60&#45;&gt;stage6_layer1_expert60_mlp1 -->
<g id="edge1567" class="edge">
<title>stage6_layer1_expert60&#45;&gt;stage6_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4146.17,-5096.52C4148.23,-5088.47 4150.54,-5079.42 4152.74,-5070.82"/>
<polygon fill="black" stroke="black" points="4156.17,-5071.57 4155.25,-5061.01 4149.38,-5069.83 4156.17,-5071.57"/>
</g>
<!-- stage6_layer1_expert60_tp1 -->
<g id="node1208" class="node">
<title>stage6_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4184.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4184.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4184.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="4184.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4184.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert60_mlp1&#45;&gt;stage6_layer1_expert60_tp1 -->
<g id="edge1568" class="edge">
<title>stage6_layer1_expert60_mlp1&#45;&gt;stage6_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4167.67,-5008.68C4169.55,-5000.79 4171.68,-4991.81 4173.79,-4982.95"/>
<polygon fill="black" stroke="black" points="4177.23,-4983.6 4176.14,-4973.06 4170.42,-4981.98 4177.23,-4983.6"/>
</g>
<!-- stage6_layer1_expert60_act -->
<g id="node1209" class="node">
<title>stage6_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4332.19,-4863.31 4051.19,-4863.31 4051.19,-4811.31 4332.19,-4811.31 4332.19,-4863.31"/>
<text text-anchor="middle" x="4191.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4191.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="4191.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4191.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert60_tp1&#45;&gt;stage6_layer1_expert60_act -->
<g id="edge1569" class="edge">
<title>stage6_layer1_expert60_tp1&#45;&gt;stage6_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4187.29,-4899.05C4187.9,-4890.74 4188.54,-4881.91 4189.13,-4873.62"/>
<polygon fill="black" stroke="black" points="4192.64,-4873.74 4189.87,-4863.51 4185.65,-4873.23 4192.64,-4873.74"/>
</g>
<!-- stage6_layer1_expert60_mlp2 -->
<g id="node1210" class="node">
<title>stage6_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4381.69,-4775.31 4059.69,-4775.31 4059.69,-4723.31 4381.69,-4723.31 4381.69,-4775.31"/>
<text text-anchor="middle" x="4220.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4220.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4220.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4220.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert60_act&#45;&gt;stage6_layer1_expert60_mlp2 -->
<g id="edge1570" class="edge">
<title>stage6_layer1_expert60_act&#45;&gt;stage6_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4200.23,-4810.98C4202.98,-4802.84 4206.06,-4793.68 4208.99,-4785"/>
<polygon fill="black" stroke="black" points="4212.33,-4786.07 4212.21,-4775.47 4205.69,-4783.83 4212.33,-4786.07"/>
</g>
<!-- stage6_layer1_expert60_tp2 -->
<g id="node1211" class="node">
<title>stage6_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4228.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4228.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4228.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 888&#45;889</text>
<text text-anchor="middle" x="4228.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4228.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert60_mlp2&#45;&gt;stage6_layer1_expert60_tp2 -->
<g id="edge1571" class="edge">
<title>stage6_layer1_expert60_mlp2&#45;&gt;stage6_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4222.77,-4723.14C4223.41,-4715.33 4224.15,-4706.47 4224.87,-4697.7"/>
<polygon fill="black" stroke="black" points="4228.38,-4697.78 4225.71,-4687.52 4221.4,-4697.2 4228.38,-4697.78"/>
</g>
<!-- stage6_layer1_expert60_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1597" class="edge">
<title>stage6_layer1_expert60_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4121.36,-4618.06C4083.27,-4606.88 4038.73,-4593.81 3994.1,-4580.72"/>
<polygon fill="black" stroke="black" points="3994.86,-4577.3 3984.28,-4577.84 3992.89,-4584.01 3994.86,-4577.3"/>
</g>
<!-- stage6_layer1_expert61_mlp1 -->
<g id="node1213" class="node">
<title>stage6_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4736.69,-5060.85 4422.69,-5060.85 4422.69,-5008.85 4736.69,-5008.85 4736.69,-5060.85"/>
<text text-anchor="middle" x="4579.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4579.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4579.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4579.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert61&#45;&gt;stage6_layer1_expert61_mlp1 -->
<g id="edge1573" class="edge">
<title>stage6_layer1_expert61&#45;&gt;stage6_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4556.41,-5096.52C4559.53,-5088.38 4563.05,-5079.22 4566.38,-5070.54"/>
<polygon fill="black" stroke="black" points="4569.72,-5071.6 4570.04,-5061.01 4563.19,-5069.09 4569.72,-5071.6"/>
</g>
<!-- stage6_layer1_expert61_tp1 -->
<g id="node1214" class="node">
<title>stage6_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4613.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4613.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4613.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="4613.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4613.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert61_mlp1&#45;&gt;stage6_layer1_expert61_tp1 -->
<g id="edge1574" class="edge">
<title>stage6_layer1_expert61_mlp1&#45;&gt;stage6_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4588.53,-5008.68C4591.34,-5000.7 4594.53,-4991.62 4597.67,-4982.67"/>
<polygon fill="black" stroke="black" points="4601.04,-4983.66 4601.05,-4973.06 4594.43,-4981.34 4601.04,-4983.66"/>
</g>
<!-- stage6_layer1_expert61_act -->
<g id="node1215" class="node">
<title>stage6_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4830.19,-4863.31 4549.19,-4863.31 4549.19,-4811.31 4830.19,-4811.31 4830.19,-4863.31"/>
<text text-anchor="middle" x="4689.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4689.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="4689.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4689.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert61_tp1&#45;&gt;stage6_layer1_expert61_act -->
<g id="edge1575" class="edge">
<title>stage6_layer1_expert61_tp1&#45;&gt;stage6_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4641.56,-4899.6C4648.76,-4890.43 4656.48,-4880.6 4663.59,-4871.55"/>
<polygon fill="black" stroke="black" points="4666.48,-4873.53 4669.91,-4863.5 4660.98,-4869.2 4666.48,-4873.53"/>
</g>
<!-- stage6_layer1_expert61_mlp2 -->
<g id="node1216" class="node">
<title>stage6_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4850.69,-4775.31 4528.69,-4775.31 4528.69,-4723.31 4850.69,-4723.31 4850.69,-4775.31"/>
<text text-anchor="middle" x="4689.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4689.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4689.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4689.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert61_act&#45;&gt;stage6_layer1_expert61_mlp2 -->
<g id="edge1576" class="edge">
<title>stage6_layer1_expert61_act&#45;&gt;stage6_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4689.69,-4810.98C4689.69,-4803.02 4689.69,-4794.08 4689.69,-4785.56"/>
<polygon fill="black" stroke="black" points="4693.19,-4785.47 4689.69,-4775.47 4686.19,-4785.47 4693.19,-4785.47"/>
</g>
<!-- stage6_layer1_expert61_tp2 -->
<g id="node1217" class="node">
<title>stage6_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4701.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4701.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4701.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 890&#45;891</text>
<text text-anchor="middle" x="4701.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4701.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert61_mlp2&#45;&gt;stage6_layer1_expert61_tp2 -->
<g id="edge1577" class="edge">
<title>stage6_layer1_expert61_mlp2&#45;&gt;stage6_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4692.81,-4723.14C4693.78,-4715.33 4694.88,-4706.47 4695.96,-4697.7"/>
<polygon fill="black" stroke="black" points="4699.47,-4697.88 4697.23,-4687.52 4692.52,-4697.02 4699.47,-4697.88"/>
</g>
<!-- stage6_layer1_expert61_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1598" class="edge">
<title>stage6_layer1_expert61_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4539.21,-4624.78C4514.58,-4621.07 4489.46,-4617.3 4465.69,-4613.78 4389.78,-4602.52 4309.27,-4590.71 4230.79,-4579.27"/>
<polygon fill="black" stroke="black" points="4231.13,-4575.79 4220.73,-4577.81 4230.13,-4582.71 4231.13,-4575.79"/>
</g>
<!-- stage6_layer1_expert62_mlp1 -->
<g id="node1219" class="node">
<title>stage6_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5147.69,-5060.85 4833.69,-5060.85 4833.69,-5008.85 5147.69,-5008.85 5147.69,-5060.85"/>
<text text-anchor="middle" x="4990.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="4990.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4990.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4990.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert62&#45;&gt;stage6_layer1_expert62_mlp1 -->
<g id="edge1579" class="edge">
<title>stage6_layer1_expert62&#45;&gt;stage6_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M4957.54,-5096.52C4962.08,-5088.21 4967.2,-5078.83 4972.04,-5069.98"/>
<polygon fill="black" stroke="black" points="4975.22,-5071.46 4976.94,-5061.01 4969.07,-5068.11 4975.22,-5071.46"/>
</g>
<!-- stage6_layer1_expert62_tp1 -->
<g id="node1220" class="node">
<title>stage6_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5035.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5035.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5035.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="5035.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5035.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert62_mlp1&#45;&gt;stage6_layer1_expert62_tp1 -->
<g id="edge1580" class="edge">
<title>stage6_layer1_expert62_mlp1&#45;&gt;stage6_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5002.39,-5008.68C5006.14,-5000.62 5010.42,-4991.43 5014.62,-4982.38"/>
<polygon fill="black" stroke="black" points="5017.92,-4983.6 5018.96,-4973.06 5011.57,-4980.65 5017.92,-4983.6"/>
</g>
<!-- stage6_layer1_expert62_act -->
<g id="node1221" class="node">
<title>stage6_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5187.19,-4863.31 4906.19,-4863.31 4906.19,-4811.31 5187.19,-4811.31 5187.19,-4863.31"/>
<text text-anchor="middle" x="5046.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5046.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="5046.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5046.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert62_tp1&#45;&gt;stage6_layer1_expert62_act -->
<g id="edge1581" class="edge">
<title>stage6_layer1_expert62_tp1&#45;&gt;stage6_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5039.78,-4899.05C5040.73,-4890.74 5041.73,-4881.91 5042.67,-4873.62"/>
<polygon fill="black" stroke="black" points="5046.17,-4873.84 5043.82,-4863.51 5039.22,-4873.05 5046.17,-4873.84"/>
</g>
<!-- stage6_layer1_expert62_mlp2 -->
<g id="node1222" class="node">
<title>stage6_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5266.69,-4775.31 4944.69,-4775.31 4944.69,-4723.31 5266.69,-4723.31 5266.69,-4775.31"/>
<text text-anchor="middle" x="5105.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5105.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5105.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5105.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert62_act&#45;&gt;stage6_layer1_expert62_mlp2 -->
<g id="edge1582" class="edge">
<title>stage6_layer1_expert62_act&#45;&gt;stage6_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5064.07,-4810.98C5069.89,-4802.49 5076.48,-4792.9 5082.66,-4783.88"/>
<polygon fill="black" stroke="black" points="5085.66,-4785.7 5088.43,-4775.47 5079.89,-4781.74 5085.66,-4785.7"/>
</g>
<!-- stage6_layer1_expert62_tp2 -->
<g id="node1223" class="node">
<title>stage6_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5174.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5174.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5174.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 892&#45;893</text>
<text text-anchor="middle" x="5174.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5174.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert62_mlp2&#45;&gt;stage6_layer1_expert62_tp2 -->
<g id="edge1583" class="edge">
<title>stage6_layer1_expert62_mlp2&#45;&gt;stage6_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5123.64,-4723.14C5129.69,-4714.65 5136.63,-4704.91 5143.41,-4695.41"/>
<polygon fill="black" stroke="black" points="5146.34,-4697.33 5149.3,-4687.16 5140.64,-4693.27 5146.34,-4697.33"/>
</g>
<!-- stage6_layer1_expert62_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1599" class="edge">
<title>stage6_layer1_expert62_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5016.19,-4624.11C4990.33,-4620.36 4963.79,-4616.77 4938.69,-4613.78 4718.65,-4587.55 4474.82,-4565.19 4265.99,-4548.07"/>
<polygon fill="black" stroke="black" points="4266,-4544.56 4255.75,-4547.23 4265.43,-4551.54 4266,-4544.56"/>
</g>
<!-- stage6_layer1_expert63_mlp1 -->
<g id="node1225" class="node">
<title>stage6_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5483.69,-5060.85 5169.69,-5060.85 5169.69,-5008.85 5483.69,-5008.85 5483.69,-5060.85"/>
<text text-anchor="middle" x="5326.69" y="-5048.85" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5326.69" y="-5037.85" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5326.69" y="-5026.85" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5326.69" y="-5015.85" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage6_layer1_expert63&#45;&gt;stage6_layer1_expert63_mlp1 -->
<g id="edge1585" class="edge">
<title>stage6_layer1_expert63&#45;&gt;stage6_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5316.81,-5096.52C5318.11,-5088.56 5319.56,-5079.62 5320.95,-5071.1"/>
<polygon fill="black" stroke="black" points="5324.44,-5071.44 5322.59,-5061.01 5317.53,-5070.32 5324.44,-5071.44"/>
</g>
<!-- stage6_layer1_expert63_tp1 -->
<g id="node1226" class="node">
<title>stage6_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5457.69" cy="-4936.08" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5457.69" y="-4950.08" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5457.69" y="-4939.08" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="5457.69" y="-4928.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5457.69" y="-4917.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert63_mlp1&#45;&gt;stage6_layer1_expert63_tp1 -->
<g id="edge1586" class="edge">
<title>stage6_layer1_expert63_mlp1&#45;&gt;stage6_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5360.77,-5008.68C5373.44,-4999.32 5388.17,-4988.44 5402.27,-4978.03"/>
<polygon fill="black" stroke="black" points="5404.51,-4980.72 5410.47,-4971.96 5400.35,-4975.09 5404.51,-4980.72"/>
</g>
<!-- stage6_layer1_expert63_act -->
<g id="node1227" class="node">
<title>stage6_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5681.19,-4863.31 5400.19,-4863.31 5400.19,-4811.31 5681.19,-4811.31 5681.19,-4863.31"/>
<text text-anchor="middle" x="5540.69" y="-4851.31" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5540.69" y="-4840.31" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="5540.69" y="-4829.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5540.69" y="-4818.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage6_layer1_expert63_tp1&#45;&gt;stage6_layer1_expert63_act -->
<g id="edge1587" class="edge">
<title>stage6_layer1_expert63_tp1&#45;&gt;stage6_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5488.12,-4899.6C5496.07,-4890.34 5504.59,-4880.4 5512.42,-4871.27"/>
<polygon fill="black" stroke="black" points="5515.23,-4873.37 5519.09,-4863.5 5509.92,-4868.81 5515.23,-4873.37"/>
</g>
<!-- stage6_layer1_expert63_mlp2 -->
<g id="node1228" class="node">
<title>stage6_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5742.69,-4775.31 5420.69,-4775.31 5420.69,-4723.31 5742.69,-4723.31 5742.69,-4775.31"/>
<text text-anchor="middle" x="5581.69" y="-4763.31" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5581.69" y="-4752.31" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5581.69" y="-4741.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5581.69" y="-4730.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert63_act&#45;&gt;stage6_layer1_expert63_mlp2 -->
<g id="edge1588" class="edge">
<title>stage6_layer1_expert63_act&#45;&gt;stage6_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5552.77,-4810.98C5556.69,-4802.75 5561.11,-4793.49 5565.29,-4784.72"/>
<polygon fill="black" stroke="black" points="5568.55,-4786 5569.7,-4775.47 5562.23,-4782.99 5568.55,-4786"/>
</g>
<!-- stage6_layer1_expert63_tp2 -->
<g id="node1229" class="node">
<title>stage6_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5647.69" cy="-4650.55" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5647.69" y="-4664.55" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5647.69" y="-4653.55" font-family="Times,serif" font-size="10.00">GPU: 894&#45;895</text>
<text text-anchor="middle" x="5647.69" y="-4642.55" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5647.69" y="-4631.55" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert63_mlp2&#45;&gt;stage6_layer1_expert63_tp2 -->
<g id="edge1589" class="edge">
<title>stage6_layer1_expert63_mlp2&#45;&gt;stage6_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5598.86,-4723.14C5604.59,-4714.74 5611.15,-4705.11 5617.57,-4695.7"/>
<polygon fill="black" stroke="black" points="5620.66,-4697.39 5623.4,-4687.16 5614.87,-4693.45 5620.66,-4697.39"/>
</g>
<!-- stage6_layer1_expert63_tp2&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1600" class="edge">
<title>stage6_layer1_expert63_tp2&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5491.16,-4623.84C5464.69,-4620.06 5437.44,-4616.52 5411.69,-4613.78 5016.75,-4571.65 4566.84,-4545.02 4235.75,-4529.42"/>
<polygon fill="black" stroke="black" points="4235.65,-4525.91 4225.49,-4528.94 4235.32,-4532.9 4235.65,-4525.91"/>
</g>
<!-- stage6_layer1_expert_ellipsis&#45;&gt;stage6_layer1_expert_agg -->
<g id="edge1601" class="edge">
<title>stage6_layer1_expert_ellipsis&#45;&gt;stage6_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5891.87,-5008.59C5896.27,-4971.37 5903.69,-4899.6 5903.69,-4838.31 5903.69,-4838.31 5903.69,-4838.31 5903.69,-4748.31 5903.69,-4687.93 5929.31,-4654.47 5884.69,-4613.78 5824.07,-4558.49 4825.4,-4530.37 4217.67,-4518.31"/>
<polygon fill="black" stroke="black" points="4217.48,-4514.81 4207.41,-4518.11 4217.34,-4521.8 4217.48,-4514.81"/>
</g>
<!-- stage6_layer1_output -->
<g id="node1232" class="node">
<title>stage6_layer1_output</title>
<polygon fill="none" stroke="black" points="3980.69,-4405.78 3530.69,-4405.78 3530.69,-4337.78 3980.69,-4337.78 3980.69,-4405.78"/>
<text text-anchor="middle" x="3755.69" y="-4390.58" font-family="Times,serif" font-size="14.00">Layer 13 Output</text>
<text text-anchor="middle" x="3755.69" y="-4375.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-4360.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-4345.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_expert_agg&#45;&gt;stage6_layer1_output -->
<g id="edge1602" class="edge">
<title>stage6_layer1_expert_agg&#45;&gt;stage6_layer1_output</title>
<path fill="none" stroke="black" d="M3755.69,-4441.57C3755.69,-4432.82 3755.69,-4424.05 3755.69,-4415.84"/>
<polygon fill="black" stroke="black" points="3759.19,-4415.79 3755.69,-4405.79 3752.19,-4415.79 3759.19,-4415.79"/>
</g>
<!-- stage6_output -->
<g id="node1233" class="node">
<title>stage6_output</title>
<polygon fill="none" stroke="black" points="4222.27,-4301.78 3480.05,-4301.78 3289.11,-4165.78 4031.33,-4165.78 4222.27,-4301.78"/>
<text text-anchor="middle" x="3755.69" y="-4252.58" font-family="Times,serif" font-size="14.00">Stage 6 Output</text>
<text text-anchor="middle" x="3755.69" y="-4237.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 6</text>
<text text-anchor="middle" x="3755.69" y="-4222.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-4207.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_layer1_output&#45;&gt;stage6_output -->
<g id="edge1603" class="edge">
<title>stage6_layer1_output&#45;&gt;stage6_output</title>
<path fill="none" stroke="black" d="M3755.69,-4337.51C3755.69,-4329.68 3755.69,-4321.01 3755.69,-4312.13"/>
<polygon fill="black" stroke="black" points="3759.19,-4312.04 3755.69,-4302.04 3752.19,-4312.04 3759.19,-4312.04"/>
</g>
<!-- stage7_input -->
<g id="node1234" class="node">
<title>stage7_input</title>
<polygon fill="none" stroke="black" points="4222.27,-4129.78 3480.05,-4129.78 3289.11,-3993.78 4031.33,-3993.78 4222.27,-4129.78"/>
<text text-anchor="middle" x="3755.69" y="-4080.58" font-family="Times,serif" font-size="14.00">Stage 7 Input Router</text>
<text text-anchor="middle" x="3755.69" y="-4065.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3755.69" y="-4050.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-4035.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage6_output&#45;&gt;stage7_input -->
<g id="edge1604" class="edge">
<title>stage6_output&#45;&gt;stage7_input</title>
<path fill="none" stroke="black" d="M3755.69,-4165.59C3755.69,-4157.27 3755.69,-4148.72 3755.69,-4140.27"/>
<polygon fill="black" stroke="black" points="3759.19,-4140.03 3755.69,-4130.03 3752.19,-4140.03 3759.19,-4140.03"/>
</g>
<!-- stage7_layer0_ln -->
<g id="node1235" class="node">
<title>stage7_layer0_ln</title>
<polygon fill="none" stroke="black" points="3980.69,-3957.78 3530.69,-3957.78 3530.69,-3889.78 3980.69,-3889.78 3980.69,-3957.78"/>
<text text-anchor="middle" x="3755.69" y="-3942.58" font-family="Times,serif" font-size="14.00">Layer 14 LayerNorm</text>
<text text-anchor="middle" x="3755.69" y="-3927.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3755.69" y="-3912.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-3897.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_input&#45;&gt;stage7_layer0_ln -->
<g id="edge1605" class="edge">
<title>stage7_input&#45;&gt;stage7_layer0_ln</title>
<path fill="none" stroke="black" d="M3755.69,-3993.57C3755.69,-3984.82 3755.69,-3976.05 3755.69,-3967.84"/>
<polygon fill="black" stroke="black" points="3759.19,-3967.79 3755.69,-3957.79 3752.19,-3967.79 3759.19,-3967.79"/>
</g>
<!-- stage7_layer0_attn_qkv -->
<g id="node1236" class="node">
<title>stage7_layer0_attn_qkv</title>
<polygon fill="none" stroke="black" points="3987.19,-3853.78 3524.19,-3853.78 3524.19,-3785.78 3987.19,-3785.78 3987.19,-3853.78"/>
<text text-anchor="middle" x="3755.69" y="-3838.58" font-family="Times,serif" font-size="14.00">Layer 14 Attention QKV Projection</text>
<text text-anchor="middle" x="3755.69" y="-3823.58" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP: GPU 896&#45;1023)</text>
<text text-anchor="middle" x="3755.69" y="-3808.58" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-3793.58" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage7_layer0_ln&#45;&gt;stage7_layer0_attn_qkv -->
<g id="edge1606" class="edge">
<title>stage7_layer0_ln&#45;&gt;stage7_layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M3755.69,-3889.66C3755.69,-3881.55 3755.69,-3872.76 3755.69,-3864.25"/>
<polygon fill="black" stroke="black" points="3759.19,-3864.08 3755.69,-3854.08 3752.19,-3864.08 3759.19,-3864.08"/>
</g>
<!-- stage7_layer0_tp_qkv_comm -->
<g id="node1237" class="node">
<title>stage7_layer0_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-3701.69" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3755.69" y="-3720.49" font-family="Times,serif" font-size="14.00">Layer 14 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3755.69" y="-3705.49" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP pairs)</text>
<text text-anchor="middle" x="3755.69" y="-3690.49" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-3675.49" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage7_layer0_attn_qkv&#45;&gt;stage7_layer0_tp_qkv_comm -->
<g id="edge1607" class="edge">
<title>stage7_layer0_attn_qkv&#45;&gt;stage7_layer0_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3755.69,-3785.51C3755.69,-3777.52 3755.69,-3768.75 3755.69,-3760.01"/>
<polygon fill="black" stroke="black" points="3759.19,-3759.8 3755.69,-3749.8 3752.19,-3759.8 3759.19,-3759.8"/>
</g>
<!-- stage7_layer0_attn_head0 -->
<g id="node1238" class="node">
<title>stage7_layer0_attn_head0</title>
<polygon fill="none" stroke="black" points="1564.19,-3617.61 1291.19,-3617.61 1291.19,-3565.61 1564.19,-3565.61 1564.19,-3617.61"/>
<text text-anchor="middle" x="1427.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 0 Attention</text>
<text text-anchor="middle" x="1427.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 0)</text>
<text text-anchor="middle" x="1427.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1427.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head0 -->
<g id="edge1608" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head0</title>
<path fill="none" stroke="black" d="M3432.67,-3693.67C2920.05,-3681.63 1941.56,-3654.83 1574.38,-3617.72"/>
<polygon fill="black" stroke="black" points="1574.54,-3614.21 1564.23,-3616.67 1573.82,-3621.18 1574.54,-3614.21"/>
</g>
<!-- stage7_layer0_attn_head1 -->
<g id="node1239" class="node">
<title>stage7_layer0_attn_head1</title>
<polygon fill="none" stroke="black" points="1855.19,-3617.61 1582.19,-3617.61 1582.19,-3565.61 1855.19,-3565.61 1855.19,-3617.61"/>
<text text-anchor="middle" x="1718.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 1 Attention</text>
<text text-anchor="middle" x="1718.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 1)</text>
<text text-anchor="middle" x="1718.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1718.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head1 -->
<g id="edge1609" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head1</title>
<path fill="none" stroke="black" d="M3428.73,-3698.9C3053.12,-3693.95 2418.43,-3676.74 1865.41,-3617.74"/>
<polygon fill="black" stroke="black" points="1865.55,-3614.23 1855.23,-3616.65 1864.8,-3621.19 1865.55,-3614.23"/>
</g>
<!-- stage7_layer0_attn_head2 -->
<g id="node1240" class="node">
<title>stage7_layer0_attn_head2</title>
<polygon fill="none" stroke="black" points="2146.19,-3617.61 1873.19,-3617.61 1873.19,-3565.61 2146.19,-3565.61 2146.19,-3617.61"/>
<text text-anchor="middle" x="2009.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 2 Attention</text>
<text text-anchor="middle" x="2009.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 2)</text>
<text text-anchor="middle" x="2009.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2009.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head2 -->
<g id="edge1610" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head2</title>
<path fill="none" stroke="black" d="M3431.26,-3695.15C3109.63,-3687.03 2602.92,-3667.14 2156.44,-3617.75"/>
<polygon fill="black" stroke="black" points="2156.56,-3614.24 2146.24,-3616.62 2155.79,-3621.2 2156.56,-3614.24"/>
</g>
<!-- stage7_layer0_attn_head3 -->
<g id="node1241" class="node">
<title>stage7_layer0_attn_head3</title>
<polygon fill="none" stroke="black" points="2437.19,-3617.61 2164.19,-3617.61 2164.19,-3565.61 2437.19,-3565.61 2437.19,-3617.61"/>
<text text-anchor="middle" x="2300.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 3 Attention</text>
<text text-anchor="middle" x="2300.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 3)</text>
<text text-anchor="middle" x="2300.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2300.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head3 -->
<g id="edge1611" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head3</title>
<path fill="none" stroke="black" d="M3437.84,-3690.09C3174.62,-3679.04 2790.78,-3657.71 2447.39,-3617.76"/>
<polygon fill="black" stroke="black" points="2447.58,-3614.26 2437.24,-3616.57 2446.77,-3621.21 2447.58,-3614.26"/>
</g>
<!-- stage7_layer0_attn_head4 -->
<g id="node1242" class="node">
<title>stage7_layer0_attn_head4</title>
<polygon fill="none" stroke="black" points="2728.19,-3617.61 2455.19,-3617.61 2455.19,-3565.61 2728.19,-3565.61 2728.19,-3617.61"/>
<text text-anchor="middle" x="2591.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 4 Attention</text>
<text text-anchor="middle" x="2591.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 4)</text>
<text text-anchor="middle" x="2591.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2591.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head4 -->
<g id="edge1612" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head4</title>
<path fill="none" stroke="black" d="M3453.43,-3683.16C3253.07,-3669.81 2984.29,-3648.63 2738.46,-3617.79"/>
<polygon fill="black" stroke="black" points="2738.61,-3614.28 2728.25,-3616.5 2737.73,-3621.23 2738.61,-3614.28"/>
</g>
<!-- stage7_layer0_attn_head5 -->
<g id="node1243" class="node">
<title>stage7_layer0_attn_head5</title>
<polygon fill="none" stroke="black" points="3019.19,-3617.61 2746.19,-3617.61 2746.19,-3565.61 3019.19,-3565.61 3019.19,-3617.61"/>
<text text-anchor="middle" x="2882.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 5 Attention</text>
<text text-anchor="middle" x="2882.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 5)</text>
<text text-anchor="middle" x="2882.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2882.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head5 -->
<g id="edge1613" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head5</title>
<path fill="none" stroke="black" d="M3488.12,-3673.85C3353.28,-3659.41 3187.06,-3640.22 3029.62,-3617.86"/>
<polygon fill="black" stroke="black" points="3029.66,-3614.33 3019.27,-3616.38 3028.67,-3621.26 3029.66,-3614.33"/>
</g>
<!-- stage7_layer0_attn_head6 -->
<g id="node1244" class="node">
<title>stage7_layer0_attn_head6</title>
<polygon fill="none" stroke="black" points="3310.19,-3617.61 3037.19,-3617.61 3037.19,-3565.61 3310.19,-3565.61 3310.19,-3617.61"/>
<text text-anchor="middle" x="3173.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 6 Attention</text>
<text text-anchor="middle" x="3173.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 6)</text>
<text text-anchor="middle" x="3173.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3173.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head6 -->
<g id="edge1614" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head6</title>
<path fill="none" stroke="black" d="M3555.8,-3663.57C3477.89,-3649.1 3390.29,-3632.83 3318.64,-3619.53"/>
<polygon fill="black" stroke="black" points="3319.1,-3616.05 3308.63,-3617.67 3317.83,-3622.94 3319.1,-3616.05"/>
</g>
<!-- stage7_layer0_attn_head7 -->
<g id="node1245" class="node">
<title>stage7_layer0_attn_head7</title>
<polygon fill="none" stroke="black" points="3601.19,-3617.61 3328.19,-3617.61 3328.19,-3565.61 3601.19,-3565.61 3601.19,-3617.61"/>
<text text-anchor="middle" x="3464.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 7 Attention</text>
<text text-anchor="middle" x="3464.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 7)</text>
<text text-anchor="middle" x="3464.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3464.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head7 -->
<g id="edge1615" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head7</title>
<path fill="none" stroke="black" d="M3637.33,-3656.73C3605.09,-3644.76 3571.02,-3632.1 3541.74,-3621.23"/>
<polygon fill="black" stroke="black" points="3542.59,-3617.81 3532,-3617.61 3540.15,-3624.37 3542.59,-3617.81"/>
</g>
<!-- stage7_layer0_attn_ellipsis -->
<g id="node1246" class="node">
<title>stage7_layer0_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3892.19,-3617.61 3619.19,-3617.61 3619.19,-3565.61 3892.19,-3565.61 3892.19,-3617.61"/>
<text text-anchor="middle" x="3755.69" y="-3605.61" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3755.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3755.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_ellipsis -->
<g id="edge1616" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3755.69,-3653.6C3755.69,-3645.06 3755.69,-3636.28 3755.69,-3628.14"/>
<polygon fill="black" stroke="black" points="3759.19,-3627.87 3755.69,-3617.87 3752.19,-3627.87 3759.19,-3627.87"/>
</g>
<!-- stage7_layer0_attn_head24 -->
<g id="node1247" class="node">
<title>stage7_layer0_attn_head24</title>
<polygon fill="none" stroke="black" points="4183.19,-3617.61 3910.19,-3617.61 3910.19,-3565.61 4183.19,-3565.61 4183.19,-3617.61"/>
<text text-anchor="middle" x="4046.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 24 Attention</text>
<text text-anchor="middle" x="4046.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 24)</text>
<text text-anchor="middle" x="4046.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4046.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head24 -->
<g id="edge1617" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head24</title>
<path fill="none" stroke="black" d="M3874.05,-3656.73C3906.28,-3644.76 3940.36,-3632.1 3969.64,-3621.23"/>
<polygon fill="black" stroke="black" points="3971.22,-3624.37 3979.38,-3617.61 3968.79,-3617.81 3971.22,-3624.37"/>
</g>
<!-- stage7_layer0_attn_head25 -->
<g id="node1248" class="node">
<title>stage7_layer0_attn_head25</title>
<polygon fill="none" stroke="black" points="4474.19,-3617.61 4201.19,-3617.61 4201.19,-3565.61 4474.19,-3565.61 4474.19,-3617.61"/>
<text text-anchor="middle" x="4337.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 25 Attention</text>
<text text-anchor="middle" x="4337.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 25)</text>
<text text-anchor="middle" x="4337.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4337.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head25 -->
<g id="edge1618" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head25</title>
<path fill="none" stroke="black" d="M3955.57,-3663.57C4033.48,-3649.1 4121.09,-3632.83 4192.74,-3619.53"/>
<polygon fill="black" stroke="black" points="4193.55,-3622.94 4202.74,-3617.67 4192.27,-3616.05 4193.55,-3622.94"/>
</g>
<!-- stage7_layer0_attn_head26 -->
<g id="node1249" class="node">
<title>stage7_layer0_attn_head26</title>
<polygon fill="none" stroke="black" points="4765.19,-3617.61 4492.19,-3617.61 4492.19,-3565.61 4765.19,-3565.61 4765.19,-3617.61"/>
<text text-anchor="middle" x="4628.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 26 Attention</text>
<text text-anchor="middle" x="4628.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 26)</text>
<text text-anchor="middle" x="4628.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4628.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head26 -->
<g id="edge1619" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head26</title>
<path fill="none" stroke="black" d="M4022.45,-3673.81C4157.31,-3659.33 4323.69,-3640.1 4482.01,-3617.67"/>
<polygon fill="black" stroke="black" points="4482.54,-3621.14 4491.95,-3616.26 4481.55,-3614.21 4482.54,-3621.14"/>
</g>
<!-- stage7_layer0_attn_head27 -->
<g id="node1250" class="node">
<title>stage7_layer0_attn_head27</title>
<polygon fill="none" stroke="black" points="5056.19,-3617.61 4783.19,-3617.61 4783.19,-3565.61 5056.19,-3565.61 5056.19,-3617.61"/>
<text text-anchor="middle" x="4919.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 27 Attention</text>
<text text-anchor="middle" x="4919.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 27)</text>
<text text-anchor="middle" x="4919.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4919.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head27 -->
<g id="edge1620" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head27</title>
<path fill="none" stroke="black" d="M4057.64,-3683.05C4257.8,-3669.66 4526.31,-3648.47 4772.73,-3617.68"/>
<polygon fill="black" stroke="black" points="4773.48,-3621.12 4782.96,-3616.4 4772.61,-3614.17 4773.48,-3621.12"/>
</g>
<!-- stage7_layer0_attn_head28 -->
<g id="node1251" class="node">
<title>stage7_layer0_attn_head28</title>
<polygon fill="none" stroke="black" points="5347.19,-3617.61 5074.19,-3617.61 5074.19,-3565.61 5347.19,-3565.61 5347.19,-3617.61"/>
<text text-anchor="middle" x="5210.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 28 Attention</text>
<text text-anchor="middle" x="5210.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 28)</text>
<text text-anchor="middle" x="5210.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5210.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head28 -->
<g id="edge1621" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head28</title>
<path fill="none" stroke="black" d="M4073.28,-3689.98C4336.3,-3678.86 4719.83,-3657.5 5063.81,-3617.66"/>
<polygon fill="black" stroke="black" points="5064.45,-3621.11 5073.97,-3616.47 5063.64,-3614.15 5064.45,-3621.11"/>
</g>
<!-- stage7_layer0_attn_head29 -->
<g id="node1252" class="node">
<title>stage7_layer0_attn_head29</title>
<polygon fill="none" stroke="black" points="5638.19,-3617.61 5365.19,-3617.61 5365.19,-3565.61 5638.19,-3565.61 5638.19,-3617.61"/>
<text text-anchor="middle" x="5501.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 29 Attention</text>
<text text-anchor="middle" x="5501.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 29)</text>
<text text-anchor="middle" x="5501.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5501.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head29 -->
<g id="edge1622" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head29</title>
<path fill="none" stroke="black" d="M4080.28,-3695.03C4401.72,-3686.81 4907.89,-3666.85 5354.77,-3617.65"/>
<polygon fill="black" stroke="black" points="5355.43,-3621.1 5364.98,-3616.52 5354.66,-3614.14 5355.43,-3621.1"/>
</g>
<!-- stage7_layer0_attn_head30 -->
<g id="node1253" class="node">
<title>stage7_layer0_attn_head30</title>
<polygon fill="none" stroke="black" points="5929.19,-3617.61 5656.19,-3617.61 5656.19,-3565.61 5929.19,-3565.61 5929.19,-3617.61"/>
<text text-anchor="middle" x="5792.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 30 Attention</text>
<text text-anchor="middle" x="5792.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 30)</text>
<text text-anchor="middle" x="5792.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5792.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head30 -->
<g id="edge1623" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head30</title>
<path fill="none" stroke="black" d="M4082.89,-3698.77C4458.34,-3693.7 5092.41,-3676.38 5645.8,-3617.64"/>
<polygon fill="black" stroke="black" points="5646.41,-3621.09 5655.98,-3616.55 5645.67,-3614.13 5646.41,-3621.09"/>
</g>
<!-- stage7_layer0_attn_head31 -->
<g id="node1254" class="node">
<title>stage7_layer0_attn_head31</title>
<polygon fill="none" stroke="black" points="6220.19,-3617.61 5947.19,-3617.61 5947.19,-3565.61 6220.19,-3565.61 6220.19,-3617.61"/>
<text text-anchor="middle" x="6083.69" y="-3605.61" font-family="Times,serif" font-size="10.00">Layer 14 Head 31 Attention</text>
<text text-anchor="middle" x="6083.69" y="-3594.61" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 31)</text>
<text text-anchor="middle" x="6083.69" y="-3583.61" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6083.69" y="-3572.61" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head31 -->
<g id="edge1624" class="edge">
<title>stage7_layer0_tp_qkv_comm&#45;&gt;stage7_layer0_attn_head31</title>
<path fill="none" stroke="black" d="M4078.55,-3693.62C4590.93,-3681.52 5568.97,-3654.62 5936.81,-3617.62"/>
<polygon fill="black" stroke="black" points="5937.39,-3621.08 5946.99,-3616.58 5936.68,-3614.12 5937.39,-3621.08"/>
</g>
<!-- stage7_layer0_attn_agg -->
<g id="node1255" class="node">
<title>stage7_layer0_attn_agg</title>
<polygon fill="none" stroke="black" points="4223.34,-3529.61 3479.41,-3529.61 3288.04,-3393.61 4031.97,-3393.61 4223.34,-3529.61"/>
<text text-anchor="middle" x="3755.69" y="-3480.41" font-family="Times,serif" font-size="14.00">Layer 14 Attention Aggregate</text>
<text text-anchor="middle" x="3755.69" y="-3465.41" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3755.69" y="-3450.41" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3755.69" y="-3435.41" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_attn_head0&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1625" class="edge">
<title>stage7_layer0_attn_head0&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1564.23,-3566.58C1567.07,-3566.24 1569.9,-3565.91 1572.69,-3565.61 2204.18,-3496.54 2943.43,-3473.76 3379.36,-3466.26"/>
<polygon fill="black" stroke="black" points="3379.67,-3469.76 3389.61,-3466.09 3379.55,-3462.76 3379.67,-3469.76"/>
</g>
<!-- stage7_layer0_attn_head1&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1626" class="edge">
<title>stage7_layer0_attn_head1&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1855.24,-3566.61C1858.08,-3566.26 1860.9,-3565.92 1863.69,-3565.61 2389.99,-3506.12 3002.69,-3480.72 3384.91,-3470.06"/>
<polygon fill="black" stroke="black" points="3385.12,-3473.55 3395.02,-3469.78 3384.93,-3466.55 3385.12,-3473.55"/>
</g>
<!-- stage7_layer0_attn_head2&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1627" class="edge">
<title>stage7_layer0_attn_head2&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2146.24,-3566.65C2149.08,-3566.29 2151.9,-3565.94 2154.69,-3565.61 2577.66,-3515.68 3066.57,-3488.65 3391.72,-3474.98"/>
<polygon fill="black" stroke="black" points="3391.93,-3478.47 3401.77,-3474.56 3391.63,-3471.48 3391.93,-3478.47"/>
</g>
<!-- stage7_layer0_attn_head3&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1628" class="edge">
<title>stage7_layer0_attn_head3&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2437.25,-3566.7C2440.08,-3566.32 2442.9,-3565.96 2445.69,-3565.61 2767.79,-3525.27 3136.56,-3497.95 3400.59,-3481.64"/>
<polygon fill="black" stroke="black" points="3400.96,-3485.13 3410.72,-3481.02 3400.53,-3478.14 3400.96,-3485.13"/>
</g>
<!-- stage7_layer0_attn_head4&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1629" class="edge">
<title>stage7_layer0_attn_head4&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2728.26,-3566.79C2731.09,-3566.38 2733.9,-3565.99 2736.69,-3565.61 2961.59,-3534.89 3215.58,-3509.2 3413.72,-3491.16"/>
<polygon fill="black" stroke="black" points="3414.07,-3494.64 3423.71,-3490.25 3413.43,-3487.67 3414.07,-3494.64"/>
</g>
<!-- stage7_layer0_attn_head5&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1630" class="edge">
<title>stage7_layer0_attn_head5&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3019.28,-3566.94C3022.11,-3566.49 3024.91,-3566.04 3027.69,-3565.61 3160.44,-3544.78 3307.12,-3523.66 3433.83,-3506.02"/>
<polygon fill="black" stroke="black" points="3434.65,-3509.44 3444.08,-3504.59 3433.69,-3502.5 3434.65,-3509.44"/>
</g>
<!-- stage7_layer0_attn_head6&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1631" class="edge">
<title>stage7_layer0_attn_head6&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3287.63,-3565.55C3338.21,-3554.43 3400.29,-3540.77 3462.5,-3527.09"/>
<polygon fill="black" stroke="black" points="3463.47,-3530.46 3472.49,-3524.89 3461.97,-3523.62 3463.47,-3530.46"/>
</g>
<!-- stage7_layer0_attn_head7&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1632" class="edge">
<title>stage7_layer0_attn_head7&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3521.83,-3565.47C3543.01,-3556.16 3568.2,-3545.08 3594.08,-3533.7"/>
<polygon fill="black" stroke="black" points="3595.51,-3536.89 3603.25,-3529.66 3592.69,-3530.48 3595.51,-3536.89"/>
</g>
<!-- stage7_layer0_attn_ellipsis&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1633" class="edge">
<title>stage7_layer0_attn_ellipsis&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3755.69,-3565.32C3755.69,-3557.72 3755.69,-3548.96 3755.69,-3539.82"/>
<polygon fill="black" stroke="black" points="3759.19,-3539.79 3755.69,-3529.79 3752.19,-3539.79 3759.19,-3539.79"/>
</g>
<!-- stage7_layer0_attn_head24&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1634" class="edge">
<title>stage7_layer0_attn_head24&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3989.54,-3565.47C3968.37,-3556.16 3943.18,-3545.08 3917.3,-3533.7"/>
<polygon fill="black" stroke="black" points="3918.69,-3530.48 3908.12,-3529.66 3915.87,-3536.89 3918.69,-3530.48"/>
</g>
<!-- stage7_layer0_attn_head25&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1635" class="edge">
<title>stage7_layer0_attn_head25&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4223.74,-3565.55C4179.03,-3555.71 4125.31,-3543.9 4070.45,-3531.84"/>
<polygon fill="black" stroke="black" points="4071.08,-3528.39 4060.56,-3529.66 4069.58,-3535.23 4071.08,-3528.39"/>
</g>
<!-- stage7_layer0_attn_head26&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1636" class="edge">
<title>stage7_layer0_attn_head26&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4491.93,-3567.07C4488.82,-3566.57 4485.74,-3566.09 4482.69,-3565.61 4400.61,-3552.77 4313.21,-3539.79 4228.51,-3527.58"/>
<polygon fill="black" stroke="black" points="4228.86,-3524.1 4218.46,-3526.13 4227.86,-3531.02 4228.86,-3524.1"/>
</g>
<!-- stage7_layer0_attn_head27&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1637" class="edge">
<title>stage7_layer0_attn_head27&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4782.95,-3566.9C4779.84,-3566.46 4776.75,-3566.03 4773.69,-3565.61 4583.01,-3539.67 4371.43,-3517.24 4190.77,-3499.99"/>
<polygon fill="black" stroke="black" points="4190.84,-3496.49 4180.56,-3499.02 4190.18,-3503.45 4190.84,-3496.49"/>
</g>
<!-- stage7_layer0_attn_head28&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1638" class="edge">
<title>stage7_layer0_attn_head28&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5073.97,-3566.81C5070.85,-3566.39 5067.75,-3565.99 5064.69,-3565.61 4766.68,-3528.45 4428.74,-3502.26 4170.88,-3485.59"/>
<polygon fill="black" stroke="black" points="4170.79,-3482.07 4160.59,-3484.92 4170.34,-3489.06 4170.79,-3482.07"/>
</g>
<!-- stage7_layer0_attn_head29&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1639" class="edge">
<title>stage7_layer0_attn_head29&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5364.97,-3566.75C5361.85,-3566.35 5358.75,-3565.97 5355.69,-3565.61 4949.71,-3517.92 4482.99,-3491.05 4158.82,-3476.81"/>
<polygon fill="black" stroke="black" points="4158.94,-3473.31 4148.79,-3476.37 4158.63,-3480.3 4158.94,-3473.31"/>
</g>
<!-- stage7_layer0_attn_head30&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1640" class="edge">
<title>stage7_layer0_attn_head30&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5655.98,-3566.71C5652.85,-3566.32 5649.75,-3565.95 5646.69,-3565.61 5131.76,-3507.69 4534.15,-3482.05 4150.82,-3470.89"/>
<polygon fill="black" stroke="black" points="4150.77,-3467.39 4140.67,-3470.6 4150.57,-3474.39 4150.77,-3467.39"/>
</g>
<!-- stage7_layer0_attn_head31&#45;&gt;stage7_layer0_attn_agg -->
<g id="edge1641" class="edge">
<title>stage7_layer0_attn_head31&#45;&gt;stage7_layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5946.98,-3566.68C5943.86,-3566.3 5940.76,-3565.94 5937.69,-3565.61 5312.76,-3497.61 4582.31,-3474.49 4144.99,-3466.63"/>
<polygon fill="black" stroke="black" points="4144.77,-3463.13 4134.71,-3466.45 4144.65,-3470.13 4144.77,-3463.13"/>
</g>
<!-- stage7_layer0_attn_out -->
<g id="node1256" class="node">
<title>stage7_layer0_attn_out</title>
<polygon fill="none" stroke="black" points="3980.69,-3357.61 3530.69,-3357.61 3530.69,-3289.61 3980.69,-3289.61 3980.69,-3357.61"/>
<text text-anchor="middle" x="3755.69" y="-3342.41" font-family="Times,serif" font-size="14.00">Layer 14 Attention Output Proj</text>
<text text-anchor="middle" x="3755.69" y="-3327.41" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP: GPU 896&#45;1023)</text>
<text text-anchor="middle" x="3755.69" y="-3312.41" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-3297.41" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_attn_agg&#45;&gt;stage7_layer0_attn_out -->
<g id="edge1642" class="edge">
<title>stage7_layer0_attn_agg&#45;&gt;stage7_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3755.69,-3393.41C3755.69,-3384.65 3755.69,-3375.88 3755.69,-3367.68"/>
<polygon fill="black" stroke="black" points="3759.19,-3367.63 3755.69,-3357.63 3752.19,-3367.63 3759.19,-3367.63"/>
</g>
<!-- stage7_layer0_tp_attn_comm -->
<g id="node1257" class="node">
<title>stage7_layer0_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3755.69" cy="-3205.53" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3755.69" y="-3224.33" font-family="Times,serif" font-size="14.00">Layer 14 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3755.69" y="-3209.33" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP pairs)</text>
<text text-anchor="middle" x="3755.69" y="-3194.33" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3755.69" y="-3179.33" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_attn_out&#45;&gt;stage7_layer0_tp_attn_comm -->
<g id="edge1643" class="edge">
<title>stage7_layer0_attn_out&#45;&gt;stage7_layer0_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3755.69,-3289.34C3755.69,-3281.35 3755.69,-3272.59 3755.69,-3263.84"/>
<polygon fill="black" stroke="black" points="3759.19,-3263.64 3755.69,-3253.64 3752.19,-3263.64 3759.19,-3263.64"/>
</g>
<!-- stage7_layer0_expert_router -->
<g id="node1258" class="node">
<title>stage7_layer0_expert_router</title>
<polygon fill="none" stroke="black" points="3353.88,-3121.44 2631.36,-3121.44 2445.49,-2985.44 3168.02,-2985.44 3353.88,-3121.44"/>
<text text-anchor="middle" x="2899.69" y="-3072.24" font-family="Times,serif" font-size="14.00">Layer 14 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="2899.69" y="-3057.24" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="2899.69" y="-3042.24" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2899.69" y="-3027.24" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage7_layer0_tp_attn_comm&#45;&gt;stage7_layer0_expert_router -->
<g id="edge1644" class="edge">
<title>stage7_layer0_tp_attn_comm&#45;&gt;stage7_layer0_expert_router</title>
<path fill="none" stroke="black" d="M3551.2,-3168.67C3473.26,-3155.01 3381.58,-3138.93 3291.99,-3123.23"/>
<polygon fill="black" stroke="black" points="3292.38,-3119.74 3281.93,-3121.46 3291.17,-3126.64 3292.38,-3119.74"/>
</g>
<!-- stage7_layer0_output -->
<g id="node1321" class="node">
<title>stage7_layer0_output</title>
<polygon fill="none" stroke="black" points="4018.69,-2206.36 3568.69,-2206.36 3568.69,-2138.36 4018.69,-2138.36 4018.69,-2206.36"/>
<text text-anchor="middle" x="3793.69" y="-2191.16" font-family="Times,serif" font-size="14.00">Layer 14 Output</text>
<text text-anchor="middle" x="3793.69" y="-2176.16" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-2161.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-2146.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_tp_attn_comm&#45;&gt;stage7_layer0_output -->
<!-- stage7_layer0_expert0 -->
<g id="node1259" class="node">
<title>stage7_layer0_expert0</title>
<polygon fill="none" stroke="black" points="1003.69,-2949.44 681.69,-2949.44 681.69,-2897.44 1003.69,-2897.44 1003.69,-2949.44"/>
<text text-anchor="middle" x="842.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 0</text>
<text text-anchor="middle" x="842.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP pair)</text>
<text text-anchor="middle" x="842.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="842.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert0 -->
<g id="edge1645" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2521.55,-3041.34C2141.2,-3027.91 1538.24,-3000.47 1018.69,-2949.44 1017.15,-2949.29 1015.61,-2949.14 1014.06,-2948.98"/>
<polygon fill="black" stroke="black" points="1014.07,-2945.46 1003.75,-2947.89 1013.33,-2952.42 1014.07,-2945.46"/>
</g>
<!-- stage7_layer0_expert1 -->
<g id="node1265" class="node">
<title>stage7_layer0_expert1</title>
<polygon fill="none" stroke="black" points="1349.69,-2949.44 1027.69,-2949.44 1027.69,-2897.44 1349.69,-2897.44 1349.69,-2949.44"/>
<text text-anchor="middle" x="1188.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 1</text>
<text text-anchor="middle" x="1188.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP pair)</text>
<text text-anchor="middle" x="1188.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1188.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert1 -->
<g id="edge1651" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2501.33,-3026.54C2210.8,-3007.04 1807.66,-2978.74 1453.69,-2949.44 1423.35,-2946.93 1391.08,-2944.06 1359.88,-2941.17"/>
<polygon fill="black" stroke="black" points="1360.08,-2937.68 1349.79,-2940.24 1359.43,-2944.65 1360.08,-2937.68"/>
</g>
<!-- stage7_layer0_expert2 -->
<g id="node1271" class="node">
<title>stage7_layer0_expert2</title>
<polygon fill="none" stroke="black" points="1784.69,-2949.44 1462.69,-2949.44 1462.69,-2897.44 1784.69,-2897.44 1784.69,-2949.44"/>
<text text-anchor="middle" x="1623.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 2</text>
<text text-anchor="middle" x="1623.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP pair)</text>
<text text-anchor="middle" x="1623.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1623.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert2 -->
<g id="edge1657" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2483.95,-3013.73C2288.62,-2995.1 2052.62,-2971.96 1840.69,-2949.44 1825.84,-2947.87 1810.43,-2946.18 1794.97,-2944.46"/>
<polygon fill="black" stroke="black" points="1795.14,-2940.96 1784.81,-2943.33 1794.36,-2947.92 1795.14,-2940.96"/>
</g>
<!-- stage7_layer0_expert3 -->
<g id="node1277" class="node">
<title>stage7_layer0_expert3</title>
<polygon fill="none" stroke="black" points="2171.69,-2949.44 1849.69,-2949.44 1849.69,-2897.44 2171.69,-2897.44 2171.69,-2949.44"/>
<text text-anchor="middle" x="2010.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 3</text>
<text text-anchor="middle" x="2010.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP pair)</text>
<text text-anchor="middle" x="2010.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2010.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert3 -->
<g id="edge1663" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2448.03,-2987.41C2353.21,-2973.76 2258.82,-2960.17 2182.14,-2949.13"/>
<polygon fill="black" stroke="black" points="2182.31,-2945.62 2171.92,-2947.66 2181.31,-2952.55 2182.31,-2945.62"/>
</g>
<!-- stage7_layer0_expert31 -->
<g id="node1283" class="node">
<title>stage7_layer0_expert31</title>
<polygon fill="none" stroke="black" points="2535.69,-2949.44 2213.69,-2949.44 2213.69,-2897.44 2535.69,-2897.44 2535.69,-2949.44"/>
<text text-anchor="middle" x="2374.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 31</text>
<text text-anchor="middle" x="2374.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP pair)</text>
<text text-anchor="middle" x="2374.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2374.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert31 -->
<g id="edge1669" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2624.5,-2985.35C2575.97,-2973.52 2528.01,-2961.82 2487.29,-2951.9"/>
<polygon fill="black" stroke="black" points="2487.91,-2948.45 2477.37,-2949.48 2486.25,-2955.25 2487.91,-2948.45"/>
</g>
<!-- stage7_layer0_expert32 -->
<g id="node1289" class="node">
<title>stage7_layer0_expert32</title>
<polygon fill="none" stroke="black" points="2887.69,-2949.44 2565.69,-2949.44 2565.69,-2897.44 2887.69,-2897.44 2887.69,-2949.44"/>
<text text-anchor="middle" x="2726.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 32</text>
<text text-anchor="middle" x="2726.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP pair)</text>
<text text-anchor="middle" x="2726.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2726.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert32 -->
<g id="edge1675" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2808.88,-2985.26C2794.96,-2974.96 2781.19,-2964.77 2769.02,-2955.76"/>
<polygon fill="black" stroke="black" points="2770.98,-2952.86 2760.86,-2949.73 2766.82,-2958.49 2770.98,-2952.86"/>
</g>
<!-- stage7_layer0_expert60 -->
<g id="node1295" class="node">
<title>stage7_layer0_expert60</title>
<polygon fill="none" stroke="black" points="3233.69,-2949.44 2911.69,-2949.44 2911.69,-2897.44 3233.69,-2897.44 3233.69,-2949.44"/>
<text text-anchor="middle" x="3072.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 60</text>
<text text-anchor="middle" x="3072.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP pair)</text>
<text text-anchor="middle" x="3072.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3072.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert60 -->
<g id="edge1681" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2990.49,-2985.26C3004.41,-2974.96 3018.18,-2964.77 3030.36,-2955.76"/>
<polygon fill="black" stroke="black" points="3032.56,-2958.49 3038.51,-2949.73 3028.39,-2952.86 3032.56,-2958.49"/>
</g>
<!-- stage7_layer0_expert61 -->
<g id="node1301" class="node">
<title>stage7_layer0_expert61</title>
<polygon fill="none" stroke="black" points="3633.69,-2949.44 3311.69,-2949.44 3311.69,-2897.44 3633.69,-2897.44 3633.69,-2949.44"/>
<text text-anchor="middle" x="3472.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 61</text>
<text text-anchor="middle" x="3472.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP pair)</text>
<text text-anchor="middle" x="3472.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3472.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert61 -->
<g id="edge1687" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3175.7,-2990.79C3237.19,-2977.05 3299.32,-2963.17 3350.75,-2951.68"/>
<polygon fill="black" stroke="black" points="3351.56,-2955.09 3360.56,-2949.49 3350.04,-2948.25 3351.56,-2955.09"/>
</g>
<!-- stage7_layer0_expert62 -->
<g id="node1307" class="node">
<title>stage7_layer0_expert62</title>
<polygon fill="none" stroke="black" points="3996.69,-2949.44 3674.69,-2949.44 3674.69,-2897.44 3996.69,-2897.44 3996.69,-2949.44"/>
<text text-anchor="middle" x="3835.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 62</text>
<text text-anchor="middle" x="3835.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP pair)</text>
<text text-anchor="middle" x="3835.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3835.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert62 -->
<g id="edge1693" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3202.93,-3010.97C3355.93,-2990.05 3535.86,-2965.45 3664.65,-2947.83"/>
<polygon fill="black" stroke="black" points="3665.18,-2951.29 3674.62,-2946.47 3664.23,-2944.36 3665.18,-2951.29"/>
</g>
<!-- stage7_layer0_expert63 -->
<g id="node1313" class="node">
<title>stage7_layer0_expert63</title>
<polygon fill="none" stroke="black" points="4358.69,-2949.44 4036.69,-2949.44 4036.69,-2897.44 4358.69,-2897.44 4358.69,-2949.44"/>
<text text-anchor="middle" x="4197.69" y="-2937.44" font-family="Times,serif" font-size="10.00">Layer 14 Expert 63</text>
<text text-anchor="middle" x="4197.69" y="-2926.44" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP pair)</text>
<text text-anchor="middle" x="4197.69" y="-2915.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4197.69" y="-2904.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert63 -->
<g id="edge1699" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3223.05,-3025.47C3443.75,-3006.29 3742.64,-2978.81 4005.69,-2949.44 4012.48,-2948.68 4019.4,-2947.89 4026.39,-2947.07"/>
<polygon fill="black" stroke="black" points="4027.16,-2950.5 4036.67,-2945.85 4026.33,-2943.55 4027.16,-2950.5"/>
</g>
<!-- stage7_layer0_expert_ellipsis -->
<g id="node1319" class="node">
<title>stage7_layer0_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4818.69,-2861.44 4496.69,-2861.44 4496.69,-2809.44 4818.69,-2809.44 4818.69,-2861.44"/>
<text text-anchor="middle" x="4657.69" y="-2849.44" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="4657.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="4657.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4657.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert_ellipsis -->
<g id="edge1705" class="edge">
<title>stage7_layer0_expert_router&#45;&gt;stage7_layer0_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3243.02,-3040.29C3608.3,-3025.23 4161.41,-2995.75 4367.69,-2949.44 4450.34,-2930.89 4540.52,-2892.68 4598.01,-2865.85"/>
<polygon fill="black" stroke="black" points="4599.74,-2868.9 4607.3,-2861.48 4596.76,-2862.57 4599.74,-2868.9"/>
</g>
<!-- stage7_layer0_expert0_mlp1 -->
<g id="node1260" class="node">
<title>stage7_layer0_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="774.69,-2861.44 460.69,-2861.44 460.69,-2809.44 774.69,-2809.44 774.69,-2861.44"/>
<text text-anchor="middle" x="617.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="617.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP: Column Parallel)</text>
<text text-anchor="middle" x="617.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="617.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert0&#45;&gt;stage7_layer0_expert0_mlp1 -->
<g id="edge1646" class="edge">
<title>stage7_layer0_expert0&#45;&gt;stage7_layer0_expert0_mlp1</title>
<path fill="none" stroke="black" d="M777,-2897.34C750.67,-2887.27 720.16,-2875.61 692.93,-2865.2"/>
<polygon fill="black" stroke="black" points="694.04,-2861.88 683.45,-2861.58 691.55,-2868.42 694.04,-2861.88"/>
</g>
<!-- stage7_layer0_expert0_tp1 -->
<g id="node1261" class="node">
<title>stage7_layer0_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="576.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="576.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="576.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="576.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="576.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert0_mlp1&#45;&gt;stage7_layer0_expert0_tp1 -->
<g id="edge1647" class="edge">
<title>stage7_layer0_expert0_mlp1&#45;&gt;stage7_layer0_expert0_tp1</title>
<path fill="none" stroke="black" d="M607.02,-2809.27C603.61,-2801.21 599.71,-2792.02 595.88,-2782.97"/>
<polygon fill="black" stroke="black" points="599.06,-2781.49 591.93,-2773.65 592.61,-2784.22 599.06,-2781.49"/>
</g>
<!-- stage7_layer0_expert0_act -->
<g id="node1262" class="node">
<title>stage7_layer0_expert0_act</title>
<polygon fill="none" stroke="black" points="716.19,-2663.9 435.19,-2663.9 435.19,-2611.9 716.19,-2611.9 716.19,-2663.9"/>
<text text-anchor="middle" x="575.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="575.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="575.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="575.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert0_tp1&#45;&gt;stage7_layer0_expert0_act -->
<g id="edge1648" class="edge">
<title>stage7_layer0_expert0_tp1&#45;&gt;stage7_layer0_expert0_act</title>
<path fill="none" stroke="black" d="M576.32,-2699.64C576.23,-2691.33 576.14,-2682.49 576.05,-2674.21"/>
<polygon fill="black" stroke="black" points="579.55,-2674.06 575.95,-2664.1 572.55,-2674.14 579.55,-2674.06"/>
</g>
<!-- stage7_layer0_expert0_mlp2 -->
<g id="node1263" class="node">
<title>stage7_layer0_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="562.69,-2575.9 240.69,-2575.9 240.69,-2523.9 562.69,-2523.9 562.69,-2575.9"/>
<text text-anchor="middle" x="401.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="401.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP: Row Parallel)</text>
<text text-anchor="middle" x="401.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="401.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert0_act&#45;&gt;stage7_layer0_expert0_mlp2 -->
<g id="edge1649" class="edge">
<title>stage7_layer0_expert0_act&#45;&gt;stage7_layer0_expert0_mlp2</title>
<path fill="none" stroke="black" d="M524.89,-2611.8C505.06,-2601.99 482.17,-2590.68 461.54,-2580.49"/>
<polygon fill="black" stroke="black" points="463.06,-2577.33 452.55,-2576.04 459.96,-2583.61 463.06,-2577.33"/>
</g>
<!-- stage7_layer0_expert0_tp2 -->
<g id="node1264" class="node">
<title>stage7_layer0_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="335.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="335.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="335.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="335.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="335.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert0_mlp2&#45;&gt;stage7_layer0_expert0_tp2 -->
<g id="edge1650" class="edge">
<title>stage7_layer0_expert0_mlp2&#45;&gt;stage7_layer0_expert0_tp2</title>
<path fill="none" stroke="black" d="M384.52,-2523.73C378.79,-2515.33 372.22,-2505.7 365.8,-2496.29"/>
<polygon fill="black" stroke="black" points="368.5,-2494.03 359.98,-2487.74 362.72,-2497.98 368.5,-2494.03"/>
</g>
<!-- stage7_layer0_expert_agg -->
<g id="node1320" class="node">
<title>stage7_layer0_expert_agg</title>
<polygon fill="none" stroke="black" points="3488.22,-2378.36 2612.45,-2378.36 2387.16,-2242.36 3262.93,-2242.36 3488.22,-2378.36"/>
<text text-anchor="middle" x="2937.69" y="-2329.16" font-family="Times,serif" font-size="14.00">Layer 14 Expert Aggregation</text>
<text text-anchor="middle" x="2937.69" y="-2314.16" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="2937.69" y="-2299.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="2937.69" y="-2284.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert0_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1706" class="edge">
<title>stage7_layer0_expert0_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M490.9,-2424.2C517.78,-2420.4 545.5,-2416.91 571.69,-2414.36 1242.12,-2349.15 2023.46,-2325.22 2499.17,-2316.45"/>
<polygon fill="black" stroke="black" points="2499.37,-2319.94 2509.3,-2316.26 2499.24,-2312.94 2499.37,-2319.94"/>
</g>
<!-- stage7_layer0_expert1_mlp1 -->
<g id="node1266" class="node">
<title>stage7_layer0_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="1229.69,-2861.44 915.69,-2861.44 915.69,-2809.44 1229.69,-2809.44 1229.69,-2861.44"/>
<text text-anchor="middle" x="1072.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="1072.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1072.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1072.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert1&#45;&gt;stage7_layer0_expert1_mlp1 -->
<g id="edge1652" class="edge">
<title>stage7_layer0_expert1&#45;&gt;stage7_layer0_expert1_mlp1</title>
<path fill="none" stroke="black" d="M1154.82,-2897.34C1142.43,-2888.15 1128.24,-2877.63 1115.18,-2867.95"/>
<polygon fill="black" stroke="black" points="1116.91,-2864.87 1106.8,-2861.73 1112.74,-2870.5 1116.91,-2864.87"/>
</g>
<!-- stage7_layer0_expert1_tp1 -->
<g id="node1267" class="node">
<title>stage7_layer0_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="1023.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1023.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="1023.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="1023.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1023.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert1_mlp1&#45;&gt;stage7_layer0_expert1_tp1 -->
<g id="edge1653" class="edge">
<title>stage7_layer0_expert1_mlp1&#45;&gt;stage7_layer0_expert1_tp1</title>
<path fill="none" stroke="black" d="M1059.94,-2809.27C1055.82,-2801.12 1051.11,-2791.82 1046.48,-2782.69"/>
<polygon fill="black" stroke="black" points="1049.55,-2780.99 1041.91,-2773.65 1043.3,-2784.15 1049.55,-2780.99"/>
</g>
<!-- stage7_layer0_expert1_act -->
<g id="node1268" class="node">
<title>stage7_layer0_expert1_act</title>
<polygon fill="none" stroke="black" points="1141.19,-2663.9 860.19,-2663.9 860.19,-2611.9 1141.19,-2611.9 1141.19,-2663.9"/>
<text text-anchor="middle" x="1000.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="1000.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="1000.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1000.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert1_tp1&#45;&gt;stage7_layer0_expert1_act -->
<g id="edge1654" class="edge">
<title>stage7_layer0_expert1_tp1&#45;&gt;stage7_layer0_expert1_act</title>
<path fill="none" stroke="black" d="M1015.19,-2699.91C1013.17,-2691.42 1011.02,-2682.36 1009.01,-2673.9"/>
<polygon fill="black" stroke="black" points="1012.36,-2672.87 1006.64,-2663.95 1005.55,-2674.49 1012.36,-2672.87"/>
</g>
<!-- stage7_layer0_expert1_mlp2 -->
<g id="node1269" class="node">
<title>stage7_layer0_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="1029.69,-2575.9 707.69,-2575.9 707.69,-2523.9 1029.69,-2523.9 1029.69,-2575.9"/>
<text text-anchor="middle" x="868.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="868.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP: Row Parallel)</text>
<text text-anchor="middle" x="868.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="868.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert1_act&#45;&gt;stage7_layer0_expert1_mlp2 -->
<g id="edge1655" class="edge">
<title>stage7_layer0_expert1_act&#45;&gt;stage7_layer0_expert1_mlp2</title>
<path fill="none" stroke="black" d="M962.15,-2611.8C947.78,-2602.43 931.28,-2591.69 916.2,-2581.86"/>
<polygon fill="black" stroke="black" points="917.79,-2578.72 907.5,-2576.19 913.97,-2584.58 917.79,-2578.72"/>
</g>
<!-- stage7_layer0_expert1_tp2 -->
<g id="node1270" class="node">
<title>stage7_layer0_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="808.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="808.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="808.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="808.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="808.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert1_mlp2&#45;&gt;stage7_layer0_expert1_tp2 -->
<g id="edge1656" class="edge">
<title>stage7_layer0_expert1_mlp2&#45;&gt;stage7_layer0_expert1_tp2</title>
<path fill="none" stroke="black" d="M853.08,-2523.73C847.87,-2515.33 841.9,-2505.7 836.06,-2496.29"/>
<polygon fill="black" stroke="black" points="839.01,-2494.4 830.77,-2487.74 833.06,-2498.09 839.01,-2494.4"/>
</g>
<!-- stage7_layer0_expert1_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1707" class="edge">
<title>stage7_layer0_expert1_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M964.88,-2424.3C991.46,-2420.53 1018.82,-2417.02 1044.69,-2414.36 1546.29,-2362.83 2125.49,-2336.08 2509.77,-2322.92"/>
<polygon fill="black" stroke="black" points="2510.07,-2326.41 2519.94,-2322.57 2509.83,-2319.42 2510.07,-2326.41"/>
</g>
<!-- stage7_layer0_expert2_mlp1 -->
<g id="node1272" class="node">
<title>stage7_layer0_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="1656.69,-2861.44 1342.69,-2861.44 1342.69,-2809.44 1656.69,-2809.44 1656.69,-2861.44"/>
<text text-anchor="middle" x="1499.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="1499.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1499.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1499.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert2&#45;&gt;stage7_layer0_expert2_mlp1 -->
<g id="edge1658" class="edge">
<title>stage7_layer0_expert2&#45;&gt;stage7_layer0_expert2_mlp1</title>
<path fill="none" stroke="black" d="M1587.49,-2897.34C1574.11,-2888.06 1558.78,-2877.43 1544.71,-2867.67"/>
<polygon fill="black" stroke="black" points="1546.36,-2864.55 1536.15,-2861.73 1542.37,-2870.3 1546.36,-2864.55"/>
</g>
<!-- stage7_layer0_expert2_tp1 -->
<g id="node1273" class="node">
<title>stage7_layer0_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="1454.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1454.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="1454.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="1454.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1454.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert2_mlp1&#45;&gt;stage7_layer0_expert2_tp1 -->
<g id="edge1659" class="edge">
<title>stage7_layer0_expert2_mlp1&#45;&gt;stage7_layer0_expert2_tp1</title>
<path fill="none" stroke="black" d="M1487.98,-2809.27C1484.23,-2801.21 1479.96,-2792.02 1475.75,-2782.97"/>
<polygon fill="black" stroke="black" points="1478.81,-2781.24 1471.42,-2773.65 1472.46,-2784.19 1478.81,-2781.24"/>
</g>
<!-- stage7_layer0_expert2_act -->
<g id="node1274" class="node">
<title>stage7_layer0_expert2_act</title>
<polygon fill="none" stroke="black" points="1494.19,-2663.9 1213.19,-2663.9 1213.19,-2611.9 1494.19,-2611.9 1494.19,-2663.9"/>
<text text-anchor="middle" x="1353.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="1353.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="1353.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1353.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert2_tp1&#45;&gt;stage7_layer0_expert2_act -->
<g id="edge1660" class="edge">
<title>stage7_layer0_expert2_tp1&#45;&gt;stage7_layer0_expert2_act</title>
<path fill="none" stroke="black" d="M1417.94,-2700.46C1407.87,-2690.82 1397.01,-2680.41 1387.14,-2670.96"/>
<polygon fill="black" stroke="black" points="1389.46,-2668.33 1379.81,-2663.93 1384.61,-2673.38 1389.46,-2668.33"/>
</g>
<!-- stage7_layer0_expert2_mlp2 -->
<g id="node1275" class="node">
<title>stage7_layer0_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="1490.69,-2575.9 1168.69,-2575.9 1168.69,-2523.9 1490.69,-2523.9 1490.69,-2575.9"/>
<text text-anchor="middle" x="1329.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="1329.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1329.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1329.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert2_act&#45;&gt;stage7_layer0_expert2_mlp2 -->
<g id="edge1661" class="edge">
<title>stage7_layer0_expert2_act&#45;&gt;stage7_layer0_expert2_mlp2</title>
<path fill="none" stroke="black" d="M1346.62,-2611.57C1344.37,-2603.52 1341.85,-2594.47 1339.45,-2585.87"/>
<polygon fill="black" stroke="black" points="1342.77,-2584.75 1336.71,-2576.06 1336.03,-2586.63 1342.77,-2584.75"/>
</g>
<!-- stage7_layer0_expert2_tp2 -->
<g id="node1276" class="node">
<title>stage7_layer0_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="1281.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1281.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1281.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="1281.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1281.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert2_mlp2&#45;&gt;stage7_layer0_expert2_tp2 -->
<g id="edge1662" class="edge">
<title>stage7_layer0_expert2_mlp2&#45;&gt;stage7_layer0_expert2_tp2</title>
<path fill="none" stroke="black" d="M1317.2,-2523.73C1313.16,-2515.58 1308.55,-2506.28 1304.02,-2497.15"/>
<polygon fill="black" stroke="black" points="1307.11,-2495.51 1299.53,-2488.11 1300.84,-2498.62 1307.11,-2495.51"/>
</g>
<!-- stage7_layer0_expert2_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1708" class="edge">
<title>stage7_layer0_expert2_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1439.19,-2424.52C1465.36,-2420.76 1492.26,-2417.21 1517.69,-2414.36 1856.19,-2376.49 2241.73,-2349.55 2525.58,-2332.74"/>
<polygon fill="black" stroke="black" points="2525.85,-2336.23 2535.63,-2332.15 2525.44,-2329.24 2525.85,-2336.23"/>
</g>
<!-- stage7_layer0_expert3_mlp1 -->
<g id="node1278" class="node">
<title>stage7_layer0_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="2077.69,-2861.44 1763.69,-2861.44 1763.69,-2809.44 2077.69,-2809.44 2077.69,-2861.44"/>
<text text-anchor="middle" x="1920.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="1920.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1920.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1920.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert3&#45;&gt;stage7_layer0_expert3_mlp1 -->
<g id="edge1664" class="edge">
<title>stage7_layer0_expert3&#45;&gt;stage7_layer0_expert3_mlp1</title>
<path fill="none" stroke="black" d="M1984.17,-2897.11C1974.83,-2888.18 1964.21,-2878.03 1954.36,-2868.62"/>
<polygon fill="black" stroke="black" points="1956.66,-2865.98 1947.02,-2861.6 1951.83,-2871.04 1956.66,-2865.98"/>
</g>
<!-- stage7_layer0_expert3_tp1 -->
<g id="node1279" class="node">
<title>stage7_layer0_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="1877.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1877.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="1877.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="1877.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1877.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert3_mlp1&#45;&gt;stage7_layer0_expert3_tp1 -->
<g id="edge1665" class="edge">
<title>stage7_layer0_expert3_mlp1&#45;&gt;stage7_layer0_expert3_tp1</title>
<path fill="none" stroke="black" d="M1909.5,-2809.27C1905.92,-2801.21 1901.84,-2792.02 1897.82,-2782.97"/>
<polygon fill="black" stroke="black" points="1900.93,-2781.37 1893.67,-2773.65 1894.54,-2784.21 1900.93,-2781.37"/>
</g>
<!-- stage7_layer0_expert3_act -->
<g id="node1280" class="node">
<title>stage7_layer0_expert3_act</title>
<polygon fill="none" stroke="black" points="1988.19,-2663.9 1707.19,-2663.9 1707.19,-2611.9 1988.19,-2611.9 1988.19,-2663.9"/>
<text text-anchor="middle" x="1847.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="1847.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="1847.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1847.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert3_tp1&#45;&gt;stage7_layer0_expert3_act -->
<g id="edge1666" class="edge">
<title>stage7_layer0_expert3_tp1&#45;&gt;stage7_layer0_expert3_act</title>
<path fill="none" stroke="black" d="M1866.6,-2699.91C1863.94,-2691.32 1861.1,-2682.16 1858.45,-2673.62"/>
<polygon fill="black" stroke="black" points="1861.76,-2672.46 1855.45,-2663.95 1855.07,-2674.54 1861.76,-2672.46"/>
</g>
<!-- stage7_layer0_expert3_mlp2 -->
<g id="node1281" class="node">
<title>stage7_layer0_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="1977.69,-2575.9 1655.69,-2575.9 1655.69,-2523.9 1977.69,-2523.9 1977.69,-2575.9"/>
<text text-anchor="middle" x="1816.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="1816.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1816.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1816.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert3_act&#45;&gt;stage7_layer0_expert3_mlp2 -->
<g id="edge1667" class="edge">
<title>stage7_layer0_expert3_act&#45;&gt;stage7_layer0_expert3_mlp2</title>
<path fill="none" stroke="black" d="M1838.56,-2611.57C1835.62,-2603.43 1832.32,-2594.27 1829.19,-2585.59"/>
<polygon fill="black" stroke="black" points="1832.44,-2584.28 1825.76,-2576.06 1825.85,-2586.65 1832.44,-2584.28"/>
</g>
<!-- stage7_layer0_expert3_tp2 -->
<g id="node1282" class="node">
<title>stage7_layer0_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="1754.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1754.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1754.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="1754.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1754.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert3_mlp2&#45;&gt;stage7_layer0_expert3_tp2 -->
<g id="edge1668" class="edge">
<title>stage7_layer0_expert3_mlp2&#45;&gt;stage7_layer0_expert3_tp2</title>
<path fill="none" stroke="black" d="M1800.56,-2523.73C1795.18,-2515.33 1789.01,-2505.7 1782.98,-2496.29"/>
<polygon fill="black" stroke="black" points="1785.85,-2494.28 1777.5,-2487.74 1779.95,-2498.05 1785.85,-2494.28"/>
</g>
<!-- stage7_layer0_expert3_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1709" class="edge">
<title>stage7_layer0_expert3_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1914.83,-2424.93C1940.19,-2421.21 1966.13,-2417.56 1990.69,-2414.36 2175.29,-2390.35 2380.65,-2367.54 2552.81,-2349.51"/>
<polygon fill="black" stroke="black" points="2553.22,-2352.99 2562.8,-2348.47 2552.49,-2346.03 2553.22,-2352.99"/>
</g>
<!-- stage7_layer0_expert31_mlp1 -->
<g id="node1284" class="node">
<title>stage7_layer0_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="2492.69,-2861.44 2178.69,-2861.44 2178.69,-2809.44 2492.69,-2809.44 2492.69,-2861.44"/>
<text text-anchor="middle" x="2335.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="2335.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2335.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2335.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert31&#45;&gt;stage7_layer0_expert31_mlp1 -->
<g id="edge1670" class="edge">
<title>stage7_layer0_expert31&#45;&gt;stage7_layer0_expert31_mlp1</title>
<path fill="none" stroke="black" d="M2363.2,-2897.11C2359.47,-2888.88 2355.27,-2879.62 2351.29,-2870.85"/>
<polygon fill="black" stroke="black" points="2354.41,-2869.26 2347.1,-2861.6 2348.04,-2872.15 2354.41,-2869.26"/>
</g>
<!-- stage7_layer0_expert31_tp1 -->
<g id="node1285" class="node">
<title>stage7_layer0_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="2296.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2296.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="2296.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="2296.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2296.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert31_mlp1&#45;&gt;stage7_layer0_expert31_tp1 -->
<g id="edge1671" class="edge">
<title>stage7_layer0_expert31_mlp1&#45;&gt;stage7_layer0_expert31_tp1</title>
<path fill="none" stroke="black" d="M2325.54,-2809.27C2322.29,-2801.21 2318.59,-2792.02 2314.94,-2782.97"/>
<polygon fill="black" stroke="black" points="2318.17,-2781.62 2311.19,-2773.65 2311.68,-2784.23 2318.17,-2781.62"/>
</g>
<!-- stage7_layer0_expert31_act -->
<g id="node1286" class="node">
<title>stage7_layer0_expert31_act</title>
<polygon fill="none" stroke="black" points="2394.19,-2663.9 2113.19,-2663.9 2113.19,-2611.9 2394.19,-2611.9 2394.19,-2663.9"/>
<text text-anchor="middle" x="2253.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="2253.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="2253.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2253.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert31_tp1&#45;&gt;stage7_layer0_expert31_act -->
<g id="edge1672" class="edge">
<title>stage7_layer0_expert31_tp1&#45;&gt;stage7_layer0_expert31_act</title>
<path fill="none" stroke="black" d="M2280.8,-2699.91C2276.94,-2691.23 2272.82,-2681.96 2268.99,-2673.34"/>
<polygon fill="black" stroke="black" points="2272.08,-2671.66 2264.82,-2663.95 2265.68,-2674.51 2272.08,-2671.66"/>
</g>
<!-- stage7_layer0_expert31_mlp2 -->
<g id="node1287" class="node">
<title>stage7_layer0_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="2401.69,-2575.9 2079.69,-2575.9 2079.69,-2523.9 2401.69,-2523.9 2401.69,-2575.9"/>
<text text-anchor="middle" x="2240.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="2240.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2240.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2240.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert31_act&#45;&gt;stage7_layer0_expert31_mlp2 -->
<g id="edge1673" class="edge">
<title>stage7_layer0_expert31_act&#45;&gt;stage7_layer0_expert31_mlp2</title>
<path fill="none" stroke="black" d="M2249.86,-2611.57C2248.65,-2603.61 2247.3,-2594.67 2246.02,-2586.15"/>
<polygon fill="black" stroke="black" points="2249.45,-2585.42 2244.49,-2576.06 2242.53,-2586.47 2249.45,-2585.42"/>
</g>
<!-- stage7_layer0_expert31_tp2 -->
<g id="node1288" class="node">
<title>stage7_layer0_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="2227.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2227.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2227.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="2227.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2227.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert31_mlp2&#45;&gt;stage7_layer0_expert31_tp2 -->
<g id="edge1674" class="edge">
<title>stage7_layer0_expert31_mlp2&#45;&gt;stage7_layer0_expert31_tp2</title>
<path fill="none" stroke="black" d="M2237.31,-2523.73C2236.26,-2515.92 2235.07,-2507.06 2233.89,-2498.29"/>
<polygon fill="black" stroke="black" points="2237.32,-2497.56 2232.52,-2488.11 2230.38,-2498.49 2237.32,-2497.56"/>
</g>
<!-- stage7_layer0_expert31_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1710" class="edge">
<title>stage7_layer0_expert31_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2369.66,-2422.39C2435.77,-2409.46 2517.52,-2393.49 2598.2,-2377.72"/>
<polygon fill="black" stroke="black" points="2598.89,-2381.15 2608.03,-2375.8 2597.54,-2374.28 2598.89,-2381.15"/>
</g>
<!-- stage7_layer0_expert32_mlp1 -->
<g id="node1290" class="node">
<title>stage7_layer0_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="2876.69,-2861.44 2562.69,-2861.44 2562.69,-2809.44 2876.69,-2809.44 2876.69,-2861.44"/>
<text text-anchor="middle" x="2719.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="2719.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2719.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2719.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert32&#45;&gt;stage7_layer0_expert32_mlp1 -->
<g id="edge1676" class="edge">
<title>stage7_layer0_expert32&#45;&gt;stage7_layer0_expert32_mlp1</title>
<path fill="none" stroke="black" d="M2724.63,-2897.11C2723.98,-2889.14 2723.25,-2880.21 2722.56,-2871.69"/>
<polygon fill="black" stroke="black" points="2726.04,-2871.28 2721.74,-2861.6 2719.06,-2871.85 2726.04,-2871.28"/>
</g>
<!-- stage7_layer0_expert32_tp1 -->
<g id="node1291" class="node">
<title>stage7_layer0_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="2713.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2713.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="2713.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="2713.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2713.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert32_mlp1&#45;&gt;stage7_layer0_expert32_tp1 -->
<g id="edge1677" class="edge">
<title>stage7_layer0_expert32_mlp1&#45;&gt;stage7_layer0_expert32_tp1</title>
<path fill="none" stroke="black" d="M2718.13,-2809.27C2717.64,-2801.46 2717.09,-2792.6 2716.55,-2783.83"/>
<polygon fill="black" stroke="black" points="2720.03,-2783.41 2715.92,-2773.65 2713.04,-2783.85 2720.03,-2783.41"/>
</g>
<!-- stage7_layer0_expert32_act -->
<g id="node1292" class="node">
<title>stage7_layer0_expert32_act</title>
<polygon fill="none" stroke="black" points="2851.19,-2663.9 2570.19,-2663.9 2570.19,-2611.9 2851.19,-2611.9 2851.19,-2663.9"/>
<text text-anchor="middle" x="2710.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="2710.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="2710.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2710.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert32_tp1&#45;&gt;stage7_layer0_expert32_act -->
<g id="edge1678" class="edge">
<title>stage7_layer0_expert32_tp1&#45;&gt;stage7_layer0_expert32_act</title>
<path fill="none" stroke="black" d="M2712.57,-2699.64C2712.31,-2691.33 2712.04,-2682.49 2711.78,-2674.21"/>
<polygon fill="black" stroke="black" points="2715.28,-2673.99 2711.47,-2664.1 2708.28,-2674.2 2715.28,-2673.99"/>
</g>
<!-- stage7_layer0_expert32_mlp2 -->
<g id="node1293" class="node">
<title>stage7_layer0_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="2868.69,-2575.9 2546.69,-2575.9 2546.69,-2523.9 2868.69,-2523.9 2868.69,-2575.9"/>
<text text-anchor="middle" x="2707.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="2707.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2707.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2707.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert32_act&#45;&gt;stage7_layer0_expert32_mlp2 -->
<g id="edge1679" class="edge">
<title>stage7_layer0_expert32_act&#45;&gt;stage7_layer0_expert32_mlp2</title>
<path fill="none" stroke="black" d="M2709.8,-2611.57C2709.53,-2603.61 2709.22,-2594.67 2708.92,-2586.15"/>
<polygon fill="black" stroke="black" points="2712.41,-2585.93 2708.57,-2576.06 2705.42,-2586.18 2712.41,-2585.93"/>
</g>
<!-- stage7_layer0_expert32_tp2 -->
<g id="node1294" class="node">
<title>stage7_layer0_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="2700.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2700.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2700.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="2700.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2700.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert32_mlp2&#45;&gt;stage7_layer0_expert32_tp2 -->
<g id="edge1680" class="edge">
<title>stage7_layer0_expert32_mlp2&#45;&gt;stage7_layer0_expert32_tp2</title>
<path fill="none" stroke="black" d="M2705.87,-2523.73C2705.3,-2515.92 2704.66,-2507.06 2704.03,-2498.29"/>
<polygon fill="black" stroke="black" points="2707.5,-2497.83 2703.29,-2488.11 2700.52,-2498.34 2707.5,-2497.83"/>
</g>
<!-- stage7_layer0_expert32_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1711" class="edge">
<title>stage7_layer0_expert32_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M2759.88,-2415.47C2776.53,-2405.73 2795.28,-2394.75 2814.2,-2383.67"/>
<polygon fill="black" stroke="black" points="2816.03,-2386.65 2822.89,-2378.58 2812.49,-2380.61 2816.03,-2386.65"/>
</g>
<!-- stage7_layer0_expert60_mlp1 -->
<g id="node1296" class="node">
<title>stage7_layer0_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="3248.69,-2861.44 2934.69,-2861.44 2934.69,-2809.44 3248.69,-2809.44 3248.69,-2861.44"/>
<text text-anchor="middle" x="3091.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="3091.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3091.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3091.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert60&#45;&gt;stage7_layer0_expert60_mlp1 -->
<g id="edge1682" class="edge">
<title>stage7_layer0_expert60&#45;&gt;stage7_layer0_expert60_mlp1</title>
<path fill="none" stroke="black" d="M3078.29,-2897.11C3080.06,-2889.06 3082.06,-2880.01 3083.96,-2871.41"/>
<polygon fill="black" stroke="black" points="3087.39,-2872.12 3086.13,-2861.6 3080.56,-2870.61 3087.39,-2872.12"/>
</g>
<!-- stage7_layer0_expert60_tp1 -->
<g id="node1297" class="node">
<title>stage7_layer0_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="3129.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3129.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="3129.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="3129.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3129.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert60_mlp1&#45;&gt;stage7_layer0_expert60_tp1 -->
<g id="edge1683" class="edge">
<title>stage7_layer0_expert60_mlp1&#45;&gt;stage7_layer0_expert60_tp1</title>
<path fill="none" stroke="black" d="M3101.57,-2809.27C3104.74,-2801.21 3108.35,-2792.02 3111.9,-2782.97"/>
<polygon fill="black" stroke="black" points="3115.16,-2784.24 3115.56,-2773.65 3108.65,-2781.68 3115.16,-2784.24"/>
</g>
<!-- stage7_layer0_expert60_act -->
<g id="node1298" class="node">
<title>stage7_layer0_expert60_act</title>
<polygon fill="none" stroke="black" points="3271.19,-2663.9 2990.19,-2663.9 2990.19,-2611.9 3271.19,-2611.9 3271.19,-2663.9"/>
<text text-anchor="middle" x="3130.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="3130.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="3130.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3130.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert60_tp1&#45;&gt;stage7_layer0_expert60_act -->
<g id="edge1684" class="edge">
<title>stage7_layer0_expert60_tp1&#45;&gt;stage7_layer0_expert60_act</title>
<path fill="none" stroke="black" d="M3130.06,-2699.64C3130.15,-2691.33 3130.24,-2682.49 3130.32,-2674.21"/>
<polygon fill="black" stroke="black" points="3133.82,-2674.14 3130.43,-2664.1 3126.82,-2674.06 3133.82,-2674.14"/>
</g>
<!-- stage7_layer0_expert60_mlp2 -->
<g id="node1299" class="node">
<title>stage7_layer0_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="3305.69,-2575.9 2983.69,-2575.9 2983.69,-2523.9 3305.69,-2523.9 3305.69,-2575.9"/>
<text text-anchor="middle" x="3144.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="3144.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3144.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3144.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert60_act&#45;&gt;stage7_layer0_expert60_mlp2 -->
<g id="edge1685" class="edge">
<title>stage7_layer0_expert60_act&#45;&gt;stage7_layer0_expert60_mlp2</title>
<path fill="none" stroke="black" d="M3134.81,-2611.57C3136.11,-2603.61 3137.56,-2594.67 3138.95,-2586.15"/>
<polygon fill="black" stroke="black" points="3142.44,-2586.49 3140.59,-2576.06 3135.53,-2585.37 3142.44,-2586.49"/>
</g>
<!-- stage7_layer0_expert60_tp2 -->
<g id="node1300" class="node">
<title>stage7_layer0_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="3173.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3173.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3173.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="3173.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3173.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert60_mlp2&#45;&gt;stage7_layer0_expert60_tp2 -->
<g id="edge1686" class="edge">
<title>stage7_layer0_expert60_mlp2&#45;&gt;stage7_layer0_expert60_tp2</title>
<path fill="none" stroke="black" d="M3152.23,-2523.73C3154.62,-2515.75 3157.34,-2506.67 3160.03,-2497.72"/>
<polygon fill="black" stroke="black" points="3163.39,-2498.69 3162.91,-2488.11 3156.68,-2496.68 3163.39,-2498.69"/>
</g>
<!-- stage7_layer0_expert60_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1712" class="edge">
<title>stage7_layer0_expert60_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3114.74,-2415.47C3098.17,-2405.73 3079.5,-2394.75 3060.66,-2383.67"/>
<polygon fill="black" stroke="black" points="3062.39,-2380.63 3052,-2378.58 3058.85,-2386.67 3062.39,-2380.63"/>
</g>
<!-- stage7_layer0_expert61_mlp1 -->
<g id="node1302" class="node">
<title>stage7_layer0_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="3689.69,-2861.44 3375.69,-2861.44 3375.69,-2809.44 3689.69,-2809.44 3689.69,-2861.44"/>
<text text-anchor="middle" x="3532.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="3532.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3532.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3532.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert61&#45;&gt;stage7_layer0_expert61_mlp1 -->
<g id="edge1688" class="edge">
<title>stage7_layer0_expert61&#45;&gt;stage7_layer0_expert61_mlp1</title>
<path fill="none" stroke="black" d="M3490.37,-2897.11C3496.29,-2888.62 3502.98,-2879.02 3509.27,-2870.01"/>
<polygon fill="black" stroke="black" points="3512.29,-2871.8 3515.14,-2861.6 3506.54,-2867.8 3512.29,-2871.8"/>
</g>
<!-- stage7_layer0_expert61_tp1 -->
<g id="node1303" class="node">
<title>stage7_layer0_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="3569.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3569.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="3569.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="3569.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3569.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert61_mlp1&#45;&gt;stage7_layer0_expert61_tp1 -->
<g id="edge1689" class="edge">
<title>stage7_layer0_expert61_mlp1&#45;&gt;stage7_layer0_expert61_tp1</title>
<path fill="none" stroke="black" d="M3542.31,-2809.27C3545.36,-2801.29 3548.84,-2792.21 3552.26,-2783.26"/>
<polygon fill="black" stroke="black" points="3555.63,-2784.24 3555.93,-2773.65 3549.09,-2781.74 3555.63,-2784.24"/>
</g>
<!-- stage7_layer0_expert61_act -->
<g id="node1304" class="node">
<title>stage7_layer0_expert61_act</title>
<polygon fill="none" stroke="black" points="3723.19,-2663.9 3442.19,-2663.9 3442.19,-2611.9 3723.19,-2611.9 3723.19,-2663.9"/>
<text text-anchor="middle" x="3582.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="3582.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="3582.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3582.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert61_tp1&#45;&gt;stage7_layer0_expert61_act -->
<g id="edge1690" class="edge">
<title>stage7_layer0_expert61_tp1&#45;&gt;stage7_layer0_expert61_act</title>
<path fill="none" stroke="black" d="M3574.53,-2699.64C3575.65,-2691.33 3576.83,-2682.49 3577.94,-2674.21"/>
<polygon fill="black" stroke="black" points="3581.44,-2674.48 3579.3,-2664.1 3574.5,-2673.54 3581.44,-2674.48"/>
</g>
<!-- stage7_layer0_expert61_mlp2 -->
<g id="node1305" class="node">
<title>stage7_layer0_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="3793.69,-2575.9 3471.69,-2575.9 3471.69,-2523.9 3793.69,-2523.9 3793.69,-2575.9"/>
<text text-anchor="middle" x="3632.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="3632.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3632.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3632.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert61_act&#45;&gt;stage7_layer0_expert61_mlp2 -->
<g id="edge1691" class="edge">
<title>stage7_layer0_expert61_act&#45;&gt;stage7_layer0_expert61_mlp2</title>
<path fill="none" stroke="black" d="M3597.42,-2611.57C3602.3,-2603.17 3607.82,-2593.68 3613.01,-2584.75"/>
<polygon fill="black" stroke="black" points="3616.06,-2586.46 3618.06,-2576.06 3610.01,-2582.95 3616.06,-2586.46"/>
</g>
<!-- stage7_layer0_expert61_tp2 -->
<g id="node1306" class="node">
<title>stage7_layer0_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="3646.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3646.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3646.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="3646.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3646.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert61_mlp2&#45;&gt;stage7_layer0_expert61_tp2 -->
<g id="edge1692" class="edge">
<title>stage7_layer0_expert61_mlp2&#45;&gt;stage7_layer0_expert61_tp2</title>
<path fill="none" stroke="black" d="M3636.33,-2523.73C3637.46,-2515.92 3638.74,-2507.06 3640.01,-2498.29"/>
<polygon fill="black" stroke="black" points="3643.52,-2498.51 3641.48,-2488.11 3636.59,-2497.51 3643.52,-2498.51"/>
</g>
<!-- stage7_layer0_expert61_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1713" class="edge">
<title>stage7_layer0_expert61_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3504.49,-2422.3C3442.3,-2410.13 3366.31,-2395.26 3290.43,-2380.4"/>
<polygon fill="black" stroke="black" points="3290.69,-2376.89 3280.21,-2378.4 3289.35,-2383.76 3290.69,-2376.89"/>
</g>
<!-- stage7_layer0_expert62_mlp1 -->
<g id="node1308" class="node">
<title>stage7_layer0_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="4062.69,-2861.44 3748.69,-2861.44 3748.69,-2809.44 4062.69,-2809.44 4062.69,-2861.44"/>
<text text-anchor="middle" x="3905.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="3905.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3905.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3905.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert62&#45;&gt;stage7_layer0_expert62_mlp1 -->
<g id="edge1694" class="edge">
<title>stage7_layer0_expert62&#45;&gt;stage7_layer0_expert62_mlp1</title>
<path fill="none" stroke="black" d="M3856.31,-2897.11C3863.36,-2888.44 3871.35,-2878.63 3878.82,-2869.45"/>
<polygon fill="black" stroke="black" points="3881.61,-2871.56 3885.21,-2861.6 3876.18,-2867.15 3881.61,-2871.56"/>
</g>
<!-- stage7_layer0_expert62_tp1 -->
<g id="node1309" class="node">
<title>stage7_layer0_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="4018.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4018.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="4018.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="4018.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4018.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert62_mlp1&#45;&gt;stage7_layer0_expert62_tp1 -->
<g id="edge1695" class="edge">
<title>stage7_layer0_expert62_mlp1&#45;&gt;stage7_layer0_expert62_tp1</title>
<path fill="none" stroke="black" d="M3935.08,-2809.27C3945.7,-2800.17 3958,-2789.64 3969.84,-2779.51"/>
<polygon fill="black" stroke="black" points="3972.21,-2782.08 3977.53,-2772.92 3967.66,-2776.76 3972.21,-2782.08"/>
</g>
<!-- stage7_layer0_expert62_act -->
<g id="node1310" class="node">
<title>stage7_layer0_expert62_act</title>
<polygon fill="none" stroke="black" points="4193.19,-2663.9 3912.19,-2663.9 3912.19,-2611.9 4193.19,-2611.9 4193.19,-2663.9"/>
<text text-anchor="middle" x="4052.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="4052.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="4052.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4052.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert62_tp1&#45;&gt;stage7_layer0_expert62_act -->
<g id="edge1696" class="edge">
<title>stage7_layer0_expert62_tp1&#45;&gt;stage7_layer0_expert62_act</title>
<path fill="none" stroke="black" d="M4031.25,-2699.91C4034.27,-2691.32 4037.49,-2682.16 4040.49,-2673.62"/>
<polygon fill="black" stroke="black" points="4043.88,-2674.54 4043.89,-2663.95 4037.27,-2672.22 4043.88,-2674.54"/>
</g>
<!-- stage7_layer0_expert62_mlp2 -->
<g id="node1311" class="node">
<title>stage7_layer0_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="4235.69,-2575.9 3913.69,-2575.9 3913.69,-2523.9 4235.69,-2523.9 4235.69,-2575.9"/>
<text text-anchor="middle" x="4074.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="4074.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4074.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4074.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert62_act&#45;&gt;stage7_layer0_expert62_mlp2 -->
<g id="edge1697" class="edge">
<title>stage7_layer0_expert62_act&#45;&gt;stage7_layer0_expert62_mlp2</title>
<path fill="none" stroke="black" d="M4059.17,-2611.57C4061.23,-2603.52 4063.54,-2594.47 4065.74,-2585.87"/>
<polygon fill="black" stroke="black" points="4069.17,-2586.62 4068.25,-2576.06 4062.38,-2584.88 4069.17,-2586.62"/>
</g>
<!-- stage7_layer0_expert62_tp2 -->
<g id="node1312" class="node">
<title>stage7_layer0_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="4119.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4119.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4119.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="4119.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4119.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert62_mlp2&#45;&gt;stage7_layer0_expert62_tp2 -->
<g id="edge1698" class="edge">
<title>stage7_layer0_expert62_mlp2&#45;&gt;stage7_layer0_expert62_tp2</title>
<path fill="none" stroke="black" d="M4086.39,-2523.73C4090.14,-2515.67 4094.42,-2506.48 4098.62,-2497.43"/>
<polygon fill="black" stroke="black" points="4101.92,-2498.65 4102.96,-2488.11 4095.57,-2495.7 4101.92,-2498.65"/>
</g>
<!-- stage7_layer0_expert62_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1714" class="edge">
<title>stage7_layer0_expert62_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3959.54,-2424.94C3934.19,-2421.21 3908.24,-2417.56 3883.69,-2414.36 3751.83,-2397.2 3609.38,-2380.65 3476.02,-2366.02"/>
<polygon fill="black" stroke="black" points="3476.35,-2362.54 3466.03,-2364.93 3475.59,-2369.49 3476.35,-2362.54"/>
</g>
<!-- stage7_layer0_expert63_mlp1 -->
<g id="node1314" class="node">
<title>stage7_layer0_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="4398.69,-2861.44 4084.69,-2861.44 4084.69,-2809.44 4398.69,-2809.44 4398.69,-2861.44"/>
<text text-anchor="middle" x="4241.69" y="-2849.44" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="4241.69" y="-2838.44" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4241.69" y="-2827.44" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4241.69" y="-2816.44" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer0_expert63&#45;&gt;stage7_layer0_expert63_mlp1 -->
<g id="edge1700" class="edge">
<title>stage7_layer0_expert63&#45;&gt;stage7_layer0_expert63_mlp1</title>
<path fill="none" stroke="black" d="M4210.65,-2897.11C4214.9,-2888.79 4219.7,-2879.42 4224.23,-2870.57"/>
<polygon fill="black" stroke="black" points="4227.38,-2872.1 4228.82,-2861.6 4221.15,-2868.91 4227.38,-2872.1"/>
</g>
<!-- stage7_layer0_expert63_tp1 -->
<g id="node1315" class="node">
<title>stage7_layer0_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="4466.69" cy="-2736.67" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4466.69" y="-2750.67" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="4466.69" y="-2739.67" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="4466.69" y="-2728.67" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4466.69" y="-2717.67" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert63_mlp1&#45;&gt;stage7_layer0_expert63_tp1 -->
<g id="edge1701" class="edge">
<title>stage7_layer0_expert63_mlp1&#45;&gt;stage7_layer0_expert63_tp1</title>
<path fill="none" stroke="black" d="M4299.92,-2809.4C4324.5,-2798.83 4353.62,-2786.3 4380.59,-2774.7"/>
<polygon fill="black" stroke="black" points="4382.23,-2777.81 4390.03,-2770.64 4379.46,-2771.38 4382.23,-2777.81"/>
</g>
<!-- stage7_layer0_expert63_act -->
<g id="node1316" class="node">
<title>stage7_layer0_expert63_act</title>
<polygon fill="none" stroke="black" points="4640.19,-2663.9 4359.19,-2663.9 4359.19,-2611.9 4640.19,-2611.9 4640.19,-2663.9"/>
<text text-anchor="middle" x="4499.69" y="-2651.9" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="4499.69" y="-2640.9" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="4499.69" y="-2629.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4499.69" y="-2618.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer0_expert63_tp1&#45;&gt;stage7_layer0_expert63_act -->
<g id="edge1702" class="edge">
<title>stage7_layer0_expert63_tp1&#45;&gt;stage7_layer0_expert63_act</title>
<path fill="none" stroke="black" d="M4478.88,-2699.91C4481.81,-2691.32 4484.94,-2682.16 4487.85,-2673.62"/>
<polygon fill="black" stroke="black" points="4491.23,-2674.54 4491.15,-2663.95 4484.61,-2672.28 4491.23,-2674.54"/>
</g>
<!-- stage7_layer0_expert63_mlp2 -->
<g id="node1317" class="node">
<title>stage7_layer0_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="4722.69,-2575.9 4400.69,-2575.9 4400.69,-2523.9 4722.69,-2523.9 4722.69,-2575.9"/>
<text text-anchor="middle" x="4561.69" y="-2563.9" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="4561.69" y="-2552.9" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4561.69" y="-2541.9" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4561.69" y="-2530.9" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert63_act&#45;&gt;stage7_layer0_expert63_mlp2 -->
<g id="edge1703" class="edge">
<title>stage7_layer0_expert63_act&#45;&gt;stage7_layer0_expert63_mlp2</title>
<path fill="none" stroke="black" d="M4517.96,-2611.57C4524.14,-2602.99 4531.13,-2593.29 4537.69,-2584.19"/>
<polygon fill="black" stroke="black" points="4540.54,-2586.22 4543.55,-2576.06 4534.87,-2582.13 4540.54,-2586.22"/>
</g>
<!-- stage7_layer0_expert63_tp2 -->
<g id="node1318" class="node">
<title>stage7_layer0_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="4592.69" cy="-2451.13" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4592.69" y="-2465.13" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4592.69" y="-2454.13" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="4592.69" y="-2443.13" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4592.69" y="-2432.13" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_expert63_mlp2&#45;&gt;stage7_layer0_expert63_tp2 -->
<g id="edge1704" class="edge">
<title>stage7_layer0_expert63_mlp2&#45;&gt;stage7_layer0_expert63_tp2</title>
<path fill="none" stroke="black" d="M4569.75,-2523.73C4572.31,-2515.75 4575.22,-2506.67 4578.09,-2497.72"/>
<polygon fill="black" stroke="black" points="4581.45,-2498.7 4581.16,-2488.11 4574.78,-2496.57 4581.45,-2498.7"/>
</g>
<!-- stage7_layer0_expert63_tp2&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1715" class="edge">
<title>stage7_layer0_expert63_tp2&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4435.18,-2424.52C4409.01,-2420.76 4382.12,-2417.21 4356.69,-2414.36 4049.5,-2379.99 3703.56,-2354.61 3430.16,-2337.64"/>
<polygon fill="black" stroke="black" points="3430.26,-2334.14 3420.06,-2337.02 3429.82,-2341.13 3430.26,-2334.14"/>
</g>
<!-- stage7_layer0_expert_ellipsis&#45;&gt;stage7_layer0_expert_agg -->
<g id="edge1716" class="edge">
<title>stage7_layer0_expert_ellipsis&#45;&gt;stage7_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M4709.63,-2809.41C4766.19,-2778.1 4848.69,-2718.75 4848.69,-2638.9 4848.69,-2638.9 4848.69,-2638.9 4848.69,-2548.9 4848.69,-2488.52 4874.18,-2455.19 4829.69,-2414.36 4777.79,-2366.75 3948.39,-2336.74 3405.12,-2322.09"/>
<polygon fill="black" stroke="black" points="3404.83,-2318.59 3394.74,-2321.82 3404.64,-2325.58 3404.83,-2318.59"/>
</g>
<!-- stage7_layer0_expert_agg&#45;&gt;stage7_layer0_output -->
<g id="edge1717" class="edge">
<title>stage7_layer0_expert_agg&#45;&gt;stage7_layer0_output</title>
<path fill="none" stroke="black" d="M3283.08,-2254.49C3381.95,-2238.78 3486.94,-2222.1 3575.83,-2207.98"/>
<polygon fill="black" stroke="black" points="3576.43,-2211.43 3585.76,-2206.4 3575.34,-2204.51 3576.43,-2211.43"/>
</g>
<!-- stage7_layer1_ln -->
<g id="node1322" class="node">
<title>stage7_layer1_ln</title>
<polygon fill="none" stroke="black" points="4018.69,-2102.36 3568.69,-2102.36 3568.69,-2034.36 4018.69,-2034.36 4018.69,-2102.36"/>
<text text-anchor="middle" x="3793.69" y="-2087.16" font-family="Times,serif" font-size="14.00">Layer 15 LayerNorm</text>
<text text-anchor="middle" x="3793.69" y="-2072.16" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-2057.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-2042.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer0_output&#45;&gt;stage7_layer1_ln -->
<g id="edge1719" class="edge">
<title>stage7_layer0_output&#45;&gt;stage7_layer1_ln</title>
<path fill="none" stroke="black" d="M3793.69,-2138.25C3793.69,-2130.14 3793.69,-2121.35 3793.69,-2112.84"/>
<polygon fill="black" stroke="black" points="3797.19,-2112.66 3793.69,-2102.66 3790.19,-2112.66 3797.19,-2112.66"/>
</g>
<!-- stage7_layer1_attn_qkv -->
<g id="node1323" class="node">
<title>stage7_layer1_attn_qkv</title>
<polygon fill="none" stroke="black" points="4025.19,-1998.36 3562.19,-1998.36 3562.19,-1930.36 4025.19,-1930.36 4025.19,-1998.36"/>
<text text-anchor="middle" x="3793.69" y="-1983.16" font-family="Times,serif" font-size="14.00">Layer 15 Attention QKV Projection</text>
<text text-anchor="middle" x="3793.69" y="-1968.16" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP: GPU 896&#45;1023)</text>
<text text-anchor="middle" x="3793.69" y="-1953.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-1938.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage7_layer1_ln&#45;&gt;stage7_layer1_attn_qkv -->
<g id="edge1720" class="edge">
<title>stage7_layer1_ln&#45;&gt;stage7_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M3793.69,-2034.25C3793.69,-2026.14 3793.69,-2017.35 3793.69,-2008.84"/>
<polygon fill="black" stroke="black" points="3797.19,-2008.66 3793.69,-1998.66 3790.19,-2008.66 3797.19,-2008.66"/>
</g>
<!-- stage7_layer1_tp_qkv_comm -->
<g id="node1324" class="node">
<title>stage7_layer1_tp_qkv_comm</title>
<ellipse fill="none" stroke="black" cx="3793.69" cy="-1846.28" rx="327.28" ry="48.17"/>
<text text-anchor="middle" x="3793.69" y="-1865.08" font-family="Times,serif" font-size="14.00">Layer 15 TP QKV All&#45;Gather</text>
<text text-anchor="middle" x="3793.69" y="-1850.08" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP pairs)</text>
<text text-anchor="middle" x="3793.69" y="-1835.08" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3793.69" y="-1820.08" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
</g>
<!-- stage7_layer1_attn_qkv&#45;&gt;stage7_layer1_tp_qkv_comm -->
<g id="edge1721" class="edge">
<title>stage7_layer1_attn_qkv&#45;&gt;stage7_layer1_tp_qkv_comm</title>
<path fill="none" stroke="black" d="M3793.69,-1930.1C3793.69,-1922.11 3793.69,-1913.34 3793.69,-1904.6"/>
<polygon fill="black" stroke="black" points="3797.19,-1904.39 3793.69,-1894.39 3790.19,-1904.39 3797.19,-1904.39"/>
</g>
<!-- stage7_layer1_attn_head0 -->
<g id="node1325" class="node">
<title>stage7_layer1_attn_head0</title>
<polygon fill="none" stroke="black" points="1602.19,-1762.2 1329.19,-1762.2 1329.19,-1710.2 1602.19,-1710.2 1602.19,-1762.2"/>
<text text-anchor="middle" x="1465.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 0 Attention</text>
<text text-anchor="middle" x="1465.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 0)</text>
<text text-anchor="middle" x="1465.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1465.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head0 -->
<g id="edge1722" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head0</title>
<path fill="none" stroke="black" d="M3470.67,-1838.26C2958.05,-1826.22 1979.56,-1799.42 1612.38,-1762.3"/>
<polygon fill="black" stroke="black" points="1612.54,-1758.8 1602.23,-1761.26 1611.82,-1765.76 1612.54,-1758.8"/>
</g>
<!-- stage7_layer1_attn_head1 -->
<g id="node1326" class="node">
<title>stage7_layer1_attn_head1</title>
<polygon fill="none" stroke="black" points="1893.19,-1762.2 1620.19,-1762.2 1620.19,-1710.2 1893.19,-1710.2 1893.19,-1762.2"/>
<text text-anchor="middle" x="1756.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 1 Attention</text>
<text text-anchor="middle" x="1756.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 1)</text>
<text text-anchor="middle" x="1756.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="1756.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head1 -->
<g id="edge1723" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head1</title>
<path fill="none" stroke="black" d="M3466.73,-1843.49C3091.12,-1838.54 2456.43,-1821.33 1903.41,-1762.33"/>
<polygon fill="black" stroke="black" points="1903.55,-1758.82 1893.23,-1761.24 1902.8,-1765.78 1903.55,-1758.82"/>
</g>
<!-- stage7_layer1_attn_head2 -->
<g id="node1327" class="node">
<title>stage7_layer1_attn_head2</title>
<polygon fill="none" stroke="black" points="2184.19,-1762.2 1911.19,-1762.2 1911.19,-1710.2 2184.19,-1710.2 2184.19,-1762.2"/>
<text text-anchor="middle" x="2047.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 2 Attention</text>
<text text-anchor="middle" x="2047.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 2)</text>
<text text-anchor="middle" x="2047.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2047.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head2 -->
<g id="edge1724" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head2</title>
<path fill="none" stroke="black" d="M3469.26,-1839.74C3147.63,-1831.62 2640.92,-1811.73 2194.44,-1762.34"/>
<polygon fill="black" stroke="black" points="2194.56,-1758.83 2184.24,-1761.21 2193.79,-1765.79 2194.56,-1758.83"/>
</g>
<!-- stage7_layer1_attn_head3 -->
<g id="node1328" class="node">
<title>stage7_layer1_attn_head3</title>
<polygon fill="none" stroke="black" points="2475.19,-1762.2 2202.19,-1762.2 2202.19,-1710.2 2475.19,-1710.2 2475.19,-1762.2"/>
<text text-anchor="middle" x="2338.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 3 Attention</text>
<text text-anchor="middle" x="2338.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 3)</text>
<text text-anchor="middle" x="2338.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2338.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head3 -->
<g id="edge1725" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head3</title>
<path fill="none" stroke="black" d="M3475.84,-1834.68C3212.62,-1823.63 2828.78,-1802.3 2485.39,-1762.35"/>
<polygon fill="black" stroke="black" points="2485.58,-1758.85 2475.24,-1761.16 2484.77,-1765.8 2485.58,-1758.85"/>
</g>
<!-- stage7_layer1_attn_head4 -->
<g id="node1329" class="node">
<title>stage7_layer1_attn_head4</title>
<polygon fill="none" stroke="black" points="2766.19,-1762.2 2493.19,-1762.2 2493.19,-1710.2 2766.19,-1710.2 2766.19,-1762.2"/>
<text text-anchor="middle" x="2629.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 4 Attention</text>
<text text-anchor="middle" x="2629.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 4)</text>
<text text-anchor="middle" x="2629.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2629.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head4 -->
<g id="edge1726" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head4</title>
<path fill="none" stroke="black" d="M3491.43,-1827.74C3291.07,-1814.4 3022.29,-1793.22 2776.46,-1762.38"/>
<polygon fill="black" stroke="black" points="2776.61,-1758.87 2766.25,-1761.09 2775.73,-1765.82 2776.61,-1758.87"/>
</g>
<!-- stage7_layer1_attn_head5 -->
<g id="node1330" class="node">
<title>stage7_layer1_attn_head5</title>
<polygon fill="none" stroke="black" points="3057.19,-1762.2 2784.19,-1762.2 2784.19,-1710.2 3057.19,-1710.2 3057.19,-1762.2"/>
<text text-anchor="middle" x="2920.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 5 Attention</text>
<text text-anchor="middle" x="2920.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 5)</text>
<text text-anchor="middle" x="2920.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="2920.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head5 -->
<g id="edge1727" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head5</title>
<path fill="none" stroke="black" d="M3526.12,-1818.44C3391.28,-1804 3225.06,-1784.81 3067.62,-1762.45"/>
<polygon fill="black" stroke="black" points="3067.66,-1758.92 3057.27,-1760.97 3066.67,-1765.85 3067.66,-1758.92"/>
</g>
<!-- stage7_layer1_attn_head6 -->
<g id="node1331" class="node">
<title>stage7_layer1_attn_head6</title>
<polygon fill="none" stroke="black" points="3348.19,-1762.2 3075.19,-1762.2 3075.19,-1710.2 3348.19,-1710.2 3348.19,-1762.2"/>
<text text-anchor="middle" x="3211.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 6 Attention</text>
<text text-anchor="middle" x="3211.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 6)</text>
<text text-anchor="middle" x="3211.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3211.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head6 -->
<g id="edge1728" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head6</title>
<path fill="none" stroke="black" d="M3593.8,-1808.16C3515.89,-1793.69 3428.29,-1777.42 3356.64,-1764.12"/>
<polygon fill="black" stroke="black" points="3357.1,-1760.64 3346.63,-1762.26 3355.83,-1767.53 3357.1,-1760.64"/>
</g>
<!-- stage7_layer1_attn_head7 -->
<g id="node1332" class="node">
<title>stage7_layer1_attn_head7</title>
<polygon fill="none" stroke="black" points="3639.19,-1762.2 3366.19,-1762.2 3366.19,-1710.2 3639.19,-1710.2 3639.19,-1762.2"/>
<text text-anchor="middle" x="3502.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 7 Attention</text>
<text text-anchor="middle" x="3502.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 7)</text>
<text text-anchor="middle" x="3502.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3502.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head7 -->
<g id="edge1729" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head7</title>
<path fill="none" stroke="black" d="M3675.33,-1801.32C3643.09,-1789.35 3609.02,-1776.69 3579.74,-1765.81"/>
<polygon fill="black" stroke="black" points="3580.59,-1762.4 3570,-1762.2 3578.15,-1768.96 3580.59,-1762.4"/>
</g>
<!-- stage7_layer1_attn_ellipsis -->
<g id="node1333" class="node">
<title>stage7_layer1_attn_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3930.19,-1762.2 3657.19,-1762.2 3657.19,-1710.2 3930.19,-1710.2 3930.19,-1762.2"/>
<text text-anchor="middle" x="3793.69" y="-1750.2" font-family="Times,serif" font-size="10.00">... 16 more heads ...</text>
<text text-anchor="middle" x="3793.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="3793.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_ellipsis -->
<g id="edge1730" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_ellipsis</title>
<path fill="none" stroke="black" d="M3793.69,-1798.19C3793.69,-1789.65 3793.69,-1780.87 3793.69,-1772.72"/>
<polygon fill="black" stroke="black" points="3797.19,-1772.46 3793.69,-1762.46 3790.19,-1772.46 3797.19,-1772.46"/>
</g>
<!-- stage7_layer1_attn_head24 -->
<g id="node1334" class="node">
<title>stage7_layer1_attn_head24</title>
<polygon fill="none" stroke="black" points="4221.19,-1762.2 3948.19,-1762.2 3948.19,-1710.2 4221.19,-1710.2 4221.19,-1762.2"/>
<text text-anchor="middle" x="4084.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 24 Attention</text>
<text text-anchor="middle" x="4084.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 24)</text>
<text text-anchor="middle" x="4084.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4084.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head24 -->
<g id="edge1731" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head24</title>
<path fill="none" stroke="black" d="M3912.05,-1801.32C3944.28,-1789.35 3978.36,-1776.69 4007.64,-1765.81"/>
<polygon fill="black" stroke="black" points="4009.22,-1768.96 4017.38,-1762.2 4006.79,-1762.4 4009.22,-1768.96"/>
</g>
<!-- stage7_layer1_attn_head25 -->
<g id="node1335" class="node">
<title>stage7_layer1_attn_head25</title>
<polygon fill="none" stroke="black" points="4512.19,-1762.2 4239.19,-1762.2 4239.19,-1710.2 4512.19,-1710.2 4512.19,-1762.2"/>
<text text-anchor="middle" x="4375.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 25 Attention</text>
<text text-anchor="middle" x="4375.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 25)</text>
<text text-anchor="middle" x="4375.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4375.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head25 -->
<g id="edge1732" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head25</title>
<path fill="none" stroke="black" d="M3993.57,-1808.16C4071.48,-1793.69 4159.09,-1777.42 4230.74,-1764.12"/>
<polygon fill="black" stroke="black" points="4231.55,-1767.53 4240.74,-1762.26 4230.27,-1760.64 4231.55,-1767.53"/>
</g>
<!-- stage7_layer1_attn_head26 -->
<g id="node1336" class="node">
<title>stage7_layer1_attn_head26</title>
<polygon fill="none" stroke="black" points="4803.19,-1762.2 4530.19,-1762.2 4530.19,-1710.2 4803.19,-1710.2 4803.19,-1762.2"/>
<text text-anchor="middle" x="4666.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 26 Attention</text>
<text text-anchor="middle" x="4666.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 26)</text>
<text text-anchor="middle" x="4666.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4666.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head26 -->
<g id="edge1733" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head26</title>
<path fill="none" stroke="black" d="M4060.45,-1818.4C4195.31,-1803.92 4361.69,-1784.69 4520.01,-1762.26"/>
<polygon fill="black" stroke="black" points="4520.54,-1765.72 4529.95,-1760.85 4519.55,-1758.79 4520.54,-1765.72"/>
</g>
<!-- stage7_layer1_attn_head27 -->
<g id="node1337" class="node">
<title>stage7_layer1_attn_head27</title>
<polygon fill="none" stroke="black" points="5094.19,-1762.2 4821.19,-1762.2 4821.19,-1710.2 5094.19,-1710.2 5094.19,-1762.2"/>
<text text-anchor="middle" x="4957.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 27 Attention</text>
<text text-anchor="middle" x="4957.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 27)</text>
<text text-anchor="middle" x="4957.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="4957.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head27 -->
<g id="edge1734" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head27</title>
<path fill="none" stroke="black" d="M4095.64,-1827.64C4295.8,-1814.25 4564.31,-1793.06 4810.73,-1762.27"/>
<polygon fill="black" stroke="black" points="4811.48,-1765.7 4820.96,-1760.99 4810.61,-1758.76 4811.48,-1765.7"/>
</g>
<!-- stage7_layer1_attn_head28 -->
<g id="node1338" class="node">
<title>stage7_layer1_attn_head28</title>
<polygon fill="none" stroke="black" points="5385.19,-1762.2 5112.19,-1762.2 5112.19,-1710.2 5385.19,-1710.2 5385.19,-1762.2"/>
<text text-anchor="middle" x="5248.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 28 Attention</text>
<text text-anchor="middle" x="5248.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 28)</text>
<text text-anchor="middle" x="5248.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5248.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head28 -->
<g id="edge1735" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head28</title>
<path fill="none" stroke="black" d="M4111.28,-1834.57C4374.3,-1823.45 4757.83,-1802.09 5101.81,-1762.25"/>
<polygon fill="black" stroke="black" points="5102.45,-1765.69 5111.97,-1761.06 5101.64,-1758.74 5102.45,-1765.69"/>
</g>
<!-- stage7_layer1_attn_head29 -->
<g id="node1339" class="node">
<title>stage7_layer1_attn_head29</title>
<polygon fill="none" stroke="black" points="5676.19,-1762.2 5403.19,-1762.2 5403.19,-1710.2 5676.19,-1710.2 5676.19,-1762.2"/>
<text text-anchor="middle" x="5539.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 29 Attention</text>
<text text-anchor="middle" x="5539.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 29)</text>
<text text-anchor="middle" x="5539.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5539.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head29 -->
<g id="edge1736" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head29</title>
<path fill="none" stroke="black" d="M4118.28,-1839.62C4439.72,-1831.4 4945.89,-1811.43 5392.77,-1762.24"/>
<polygon fill="black" stroke="black" points="5393.43,-1765.69 5402.98,-1761.11 5392.66,-1758.73 5393.43,-1765.69"/>
</g>
<!-- stage7_layer1_attn_head30 -->
<g id="node1340" class="node">
<title>stage7_layer1_attn_head30</title>
<polygon fill="none" stroke="black" points="5967.19,-1762.2 5694.19,-1762.2 5694.19,-1710.2 5967.19,-1710.2 5967.19,-1762.2"/>
<text text-anchor="middle" x="5830.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 30 Attention</text>
<text text-anchor="middle" x="5830.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 30)</text>
<text text-anchor="middle" x="5830.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="5830.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head30 -->
<g id="edge1737" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head30</title>
<path fill="none" stroke="black" d="M4120.89,-1843.36C4496.34,-1838.29 5130.41,-1820.97 5683.8,-1762.23"/>
<polygon fill="black" stroke="black" points="5684.41,-1765.68 5693.98,-1761.14 5683.67,-1758.72 5684.41,-1765.68"/>
</g>
<!-- stage7_layer1_attn_head31 -->
<g id="node1341" class="node">
<title>stage7_layer1_attn_head31</title>
<polygon fill="none" stroke="black" points="6258.19,-1762.2 5985.19,-1762.2 5985.19,-1710.2 6258.19,-1710.2 6258.19,-1762.2"/>
<text text-anchor="middle" x="6121.69" y="-1750.2" font-family="Times,serif" font-size="10.00">Layer 15 Head 31 Attention</text>
<text text-anchor="middle" x="6121.69" y="-1739.2" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Head 31)</text>
<text text-anchor="middle" x="6121.69" y="-1728.2" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_k=128]</text>
<text text-anchor="middle" x="6121.69" y="-1717.2" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_k=128]</text>
</g>
<!-- stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head31 -->
<g id="edge1738" class="edge">
<title>stage7_layer1_tp_qkv_comm&#45;&gt;stage7_layer1_attn_head31</title>
<path fill="none" stroke="black" d="M4116.55,-1838.21C4628.93,-1826.11 5606.97,-1799.21 5974.81,-1762.21"/>
<polygon fill="black" stroke="black" points="5975.39,-1765.67 5984.99,-1761.17 5974.68,-1758.7 5975.39,-1765.67"/>
</g>
<!-- stage7_layer1_attn_agg -->
<g id="node1342" class="node">
<title>stage7_layer1_attn_agg</title>
<polygon fill="none" stroke="black" points="4261.34,-1674.2 3517.41,-1674.2 3326.04,-1538.2 4069.97,-1538.2 4261.34,-1674.2"/>
<text text-anchor="middle" x="3793.69" y="-1625" font-family="Times,serif" font-size="14.00">Layer 15 Attention Aggregate</text>
<text text-anchor="middle" x="3793.69" y="-1610" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-1595" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3793.69" y="-1580" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_attn_head0&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1739" class="edge">
<title>stage7_layer1_attn_head0&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1602.23,-1711.17C1605.07,-1710.83 1607.9,-1710.5 1610.69,-1710.2 2242.18,-1641.13 2981.43,-1618.35 3417.36,-1610.85"/>
<polygon fill="black" stroke="black" points="3417.67,-1614.35 3427.61,-1610.68 3417.55,-1607.35 3417.67,-1614.35"/>
</g>
<!-- stage7_layer1_attn_head1&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1740" class="edge">
<title>stage7_layer1_attn_head1&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M1893.24,-1711.2C1896.08,-1710.85 1898.9,-1710.51 1901.69,-1710.2 2427.99,-1650.71 3040.69,-1625.3 3422.91,-1614.64"/>
<polygon fill="black" stroke="black" points="3423.12,-1618.14 3433.02,-1614.36 3422.93,-1611.14 3423.12,-1618.14"/>
</g>
<!-- stage7_layer1_attn_head2&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1741" class="edge">
<title>stage7_layer1_attn_head2&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2184.24,-1711.24C2187.08,-1710.87 2189.9,-1710.53 2192.69,-1710.2 2615.66,-1660.27 3104.57,-1633.24 3429.72,-1619.57"/>
<polygon fill="black" stroke="black" points="3429.93,-1623.06 3439.77,-1619.14 3429.63,-1616.07 3429.93,-1623.06"/>
</g>
<!-- stage7_layer1_attn_head3&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1742" class="edge">
<title>stage7_layer1_attn_head3&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2475.25,-1711.29C2478.08,-1710.91 2480.9,-1710.55 2483.69,-1710.2 2805.79,-1669.85 3174.56,-1642.54 3438.59,-1626.23"/>
<polygon fill="black" stroke="black" points="3438.96,-1629.71 3448.72,-1625.61 3438.53,-1622.73 3438.96,-1629.71"/>
</g>
<!-- stage7_layer1_attn_head4&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1743" class="edge">
<title>stage7_layer1_attn_head4&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M2766.26,-1711.38C2769.09,-1710.97 2771.9,-1710.58 2774.69,-1710.2 2999.59,-1679.48 3253.58,-1653.79 3451.72,-1635.74"/>
<polygon fill="black" stroke="black" points="3452.07,-1639.23 3461.71,-1634.84 3451.43,-1632.26 3452.07,-1639.23"/>
</g>
<!-- stage7_layer1_attn_head5&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1744" class="edge">
<title>stage7_layer1_attn_head5&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3057.28,-1711.53C3060.11,-1711.08 3062.91,-1710.63 3065.69,-1710.2 3198.44,-1689.37 3345.12,-1668.25 3471.83,-1650.61"/>
<polygon fill="black" stroke="black" points="3472.65,-1654.02 3482.08,-1649.18 3471.69,-1647.09 3472.65,-1654.02"/>
</g>
<!-- stage7_layer1_attn_head6&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1745" class="edge">
<title>stage7_layer1_attn_head6&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3325.63,-1710.14C3376.21,-1699.02 3438.29,-1685.36 3500.5,-1671.68"/>
<polygon fill="black" stroke="black" points="3501.47,-1675.05 3510.49,-1669.48 3499.97,-1668.21 3501.47,-1675.05"/>
</g>
<!-- stage7_layer1_attn_head7&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1746" class="edge">
<title>stage7_layer1_attn_head7&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3559.83,-1710.06C3581.01,-1700.75 3606.2,-1689.67 3632.08,-1678.29"/>
<polygon fill="black" stroke="black" points="3633.51,-1681.48 3641.25,-1674.25 3630.69,-1675.07 3633.51,-1681.48"/>
</g>
<!-- stage7_layer1_attn_ellipsis&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1747" class="edge">
<title>stage7_layer1_attn_ellipsis&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M3793.69,-1709.91C3793.69,-1702.31 3793.69,-1693.55 3793.69,-1684.41"/>
<polygon fill="black" stroke="black" points="3797.19,-1684.38 3793.69,-1674.38 3790.19,-1684.38 3797.19,-1684.38"/>
</g>
<!-- stage7_layer1_attn_head24&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1748" class="edge">
<title>stage7_layer1_attn_head24&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4027.54,-1710.06C4006.37,-1700.75 3981.18,-1689.67 3955.3,-1678.29"/>
<polygon fill="black" stroke="black" points="3956.69,-1675.07 3946.12,-1674.25 3953.87,-1681.48 3956.69,-1675.07"/>
</g>
<!-- stage7_layer1_attn_head25&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1749" class="edge">
<title>stage7_layer1_attn_head25&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4261.74,-1710.14C4217.03,-1700.3 4163.31,-1688.49 4108.45,-1676.42"/>
<polygon fill="black" stroke="black" points="4109.08,-1672.98 4098.56,-1674.25 4107.58,-1679.82 4109.08,-1672.98"/>
</g>
<!-- stage7_layer1_attn_head26&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1750" class="edge">
<title>stage7_layer1_attn_head26&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4529.93,-1711.66C4526.82,-1711.16 4523.74,-1710.67 4520.69,-1710.2 4438.61,-1697.36 4351.21,-1684.38 4266.51,-1672.17"/>
<polygon fill="black" stroke="black" points="4266.86,-1668.68 4256.46,-1670.72 4265.86,-1675.61 4266.86,-1668.68"/>
</g>
<!-- stage7_layer1_attn_head27&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1751" class="edge">
<title>stage7_layer1_attn_head27&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M4820.95,-1711.49C4817.84,-1711.05 4814.75,-1710.61 4811.69,-1710.2 4621.01,-1684.26 4409.43,-1661.83 4228.77,-1644.58"/>
<polygon fill="black" stroke="black" points="4228.84,-1641.07 4218.56,-1643.61 4228.18,-1648.04 4228.84,-1641.07"/>
</g>
<!-- stage7_layer1_attn_head28&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1752" class="edge">
<title>stage7_layer1_attn_head28&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5111.97,-1711.4C5108.85,-1710.98 5105.75,-1710.58 5102.69,-1710.2 4804.68,-1673.04 4466.74,-1646.85 4208.88,-1630.18"/>
<polygon fill="black" stroke="black" points="4208.79,-1626.66 4198.59,-1629.51 4208.34,-1633.65 4208.79,-1626.66"/>
</g>
<!-- stage7_layer1_attn_head29&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1753" class="edge">
<title>stage7_layer1_attn_head29&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5402.97,-1711.34C5399.85,-1710.94 5396.75,-1710.56 5393.69,-1710.2 4987.71,-1662.51 4520.99,-1635.64 4196.82,-1621.39"/>
<polygon fill="black" stroke="black" points="4196.94,-1617.9 4186.79,-1620.96 4196.63,-1624.89 4196.94,-1617.9"/>
</g>
<!-- stage7_layer1_attn_head30&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1754" class="edge">
<title>stage7_layer1_attn_head30&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5693.98,-1711.3C5690.85,-1710.91 5687.75,-1710.54 5684.69,-1710.2 5169.76,-1652.28 4572.15,-1626.64 4188.82,-1615.48"/>
<polygon fill="black" stroke="black" points="4188.77,-1611.98 4178.67,-1615.19 4188.57,-1618.98 4188.77,-1611.98"/>
</g>
<!-- stage7_layer1_attn_head31&#45;&gt;stage7_layer1_attn_agg -->
<g id="edge1755" class="edge">
<title>stage7_layer1_attn_head31&#45;&gt;stage7_layer1_attn_agg</title>
<path fill="none" stroke="black" d="M5984.98,-1711.27C5981.86,-1710.89 5978.76,-1710.53 5975.69,-1710.2 5350.76,-1642.2 4620.31,-1619.08 4182.99,-1611.22"/>
<polygon fill="black" stroke="black" points="4182.77,-1607.72 4172.71,-1611.04 4182.65,-1614.72 4182.77,-1607.72"/>
</g>
<!-- stage7_layer1_attn_out -->
<g id="node1343" class="node">
<title>stage7_layer1_attn_out</title>
<polygon fill="none" stroke="black" points="4018.69,-1502.2 3568.69,-1502.2 3568.69,-1434.2 4018.69,-1434.2 4018.69,-1502.2"/>
<text text-anchor="middle" x="3793.69" y="-1487" font-family="Times,serif" font-size="14.00">Layer 15 Attention Output Proj</text>
<text text-anchor="middle" x="3793.69" y="-1472" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP: GPU 896&#45;1023)</text>
<text text-anchor="middle" x="3793.69" y="-1457" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-1442" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_attn_agg&#45;&gt;stage7_layer1_attn_out -->
<g id="edge1756" class="edge">
<title>stage7_layer1_attn_agg&#45;&gt;stage7_layer1_attn_out</title>
<path fill="none" stroke="black" d="M3793.69,-1537.99C3793.69,-1529.24 3793.69,-1520.47 3793.69,-1512.27"/>
<polygon fill="black" stroke="black" points="3797.19,-1512.21 3793.69,-1502.21 3790.19,-1512.21 3797.19,-1512.21"/>
</g>
<!-- stage7_layer1_tp_attn_comm -->
<g id="node1344" class="node">
<title>stage7_layer1_tp_attn_comm</title>
<ellipse fill="none" stroke="black" cx="3793.69" cy="-1350.11" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3793.69" y="-1368.91" font-family="Times,serif" font-size="14.00">Layer 15 TP Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3793.69" y="-1353.91" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7 (TP pairs)</text>
<text text-anchor="middle" x="3793.69" y="-1338.91" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-1323.91" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_attn_out&#45;&gt;stage7_layer1_tp_attn_comm -->
<g id="edge1757" class="edge">
<title>stage7_layer1_attn_out&#45;&gt;stage7_layer1_tp_attn_comm</title>
<path fill="none" stroke="black" d="M3793.69,-1433.93C3793.69,-1425.94 3793.69,-1417.17 3793.69,-1408.43"/>
<polygon fill="black" stroke="black" points="3797.19,-1408.22 3793.69,-1398.22 3790.19,-1408.22 3797.19,-1408.22"/>
</g>
<!-- stage7_layer1_expert_router -->
<g id="node1345" class="node">
<title>stage7_layer1_expert_router</title>
<polygon fill="none" stroke="black" points="4247.88,-1266.03 3525.36,-1266.03 3339.49,-1130.03 4062.02,-1130.03 4247.88,-1266.03"/>
<text text-anchor="middle" x="3793.69" y="-1216.83" font-family="Times,serif" font-size="14.00">Layer 15 Expert Router (Top&#45;k)</text>
<text text-anchor="middle" x="3793.69" y="-1201.83" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-1186.83" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-1171.83" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, experts=64]</text>
</g>
<!-- stage7_layer1_tp_attn_comm&#45;&gt;stage7_layer1_expert_router -->
<g id="edge1758" class="edge">
<title>stage7_layer1_tp_attn_comm&#45;&gt;stage7_layer1_expert_router</title>
<path fill="none" stroke="black" d="M3793.69,-1301.63C3793.69,-1293.54 3793.69,-1284.96 3793.69,-1276.34"/>
<polygon fill="black" stroke="black" points="3797.19,-1276.23 3793.69,-1266.23 3790.19,-1276.23 3797.19,-1276.23"/>
</g>
<!-- stage7_layer1_expert0 -->
<g id="node1346" class="node">
<title>stage7_layer1_expert0</title>
<polygon fill="none" stroke="black" points="2032.69,-1094.03 1710.69,-1094.03 1710.69,-1042.03 2032.69,-1042.03 2032.69,-1094.03"/>
<text text-anchor="middle" x="1871.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 0</text>
<text text-anchor="middle" x="1871.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP pair)</text>
<text text-anchor="middle" x="1871.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1871.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert0 -->
<g id="edge1759" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3411.01,-1182.41C3059.04,-1167.04 2522.92,-1138.78 2058.69,-1094.03 2053.52,-1093.53 2048.28,-1093 2042.99,-1092.44"/>
<polygon fill="black" stroke="black" points="2043.09,-1088.93 2032.77,-1091.33 2042.33,-1095.89 2043.09,-1088.93"/>
</g>
<!-- stage7_layer1_expert1 -->
<g id="node1352" class="node">
<title>stage7_layer1_expert1</title>
<polygon fill="none" stroke="black" points="2389.69,-1094.03 2067.69,-1094.03 2067.69,-1042.03 2389.69,-1042.03 2389.69,-1094.03"/>
<text text-anchor="middle" x="2228.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 1</text>
<text text-anchor="middle" x="2228.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP pair)</text>
<text text-anchor="middle" x="2228.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2228.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert1 -->
<g id="edge1765" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3386.71,-1164.78C3136.09,-1144.77 2808.24,-1118.32 2517.69,-1094.03 2479.68,-1090.85 2438.87,-1087.37 2400.24,-1084.04"/>
<polygon fill="black" stroke="black" points="2400.2,-1080.52 2389.94,-1083.15 2399.6,-1087.49 2400.2,-1080.52"/>
</g>
<!-- stage7_layer1_expert2 -->
<g id="node1358" class="node">
<title>stage7_layer1_expert2</title>
<polygon fill="none" stroke="black" points="2848.69,-1094.03 2526.69,-1094.03 2526.69,-1042.03 2848.69,-1042.03 2848.69,-1094.03"/>
<text text-anchor="middle" x="2687.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 2</text>
<text text-anchor="middle" x="2687.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP pair)</text>
<text text-anchor="middle" x="2687.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2687.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert2 -->
<g id="edge1771" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3362.91,-1147.18C3186.87,-1126.8 2993.44,-1104.42 2858.9,-1088.85"/>
<polygon fill="black" stroke="black" points="2859.25,-1085.36 2848.91,-1087.69 2858.44,-1092.32 2859.25,-1085.36"/>
</g>
<!-- stage7_layer1_expert3 -->
<g id="node1364" class="node">
<title>stage7_layer1_expert3</title>
<polygon fill="none" stroke="black" points="3248.69,-1094.03 2926.69,-1094.03 2926.69,-1042.03 3248.69,-1042.03 3248.69,-1094.03"/>
<text text-anchor="middle" x="3087.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 3</text>
<text text-anchor="middle" x="3087.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP pair)</text>
<text text-anchor="middle" x="3087.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3087.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert3 -->
<g id="edge1777" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3423.89,-1129.99C3357.2,-1117.9 3291.32,-1105.95 3235.78,-1095.88"/>
<polygon fill="black" stroke="black" points="3236.35,-1092.43 3225.89,-1094.09 3235.11,-1099.32 3236.35,-1092.43"/>
</g>
<!-- stage7_layer1_expert31 -->
<g id="node1370" class="node">
<title>stage7_layer1_expert31</title>
<polygon fill="none" stroke="black" points="3605.69,-1094.03 3283.69,-1094.03 3283.69,-1042.03 3605.69,-1042.03 3605.69,-1094.03"/>
<text text-anchor="middle" x="3444.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 31</text>
<text text-anchor="middle" x="3444.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP pair)</text>
<text text-anchor="middle" x="3444.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3444.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert31 -->
<g id="edge1783" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3610.76,-1129.94C3579.65,-1118.53 3548.9,-1107.25 3522.48,-1097.56"/>
<polygon fill="black" stroke="black" points="3523.54,-1094.22 3512.95,-1094.07 3521.13,-1100.8 3523.54,-1094.22"/>
</g>
<!-- stage7_layer1_expert32 -->
<g id="node1376" class="node">
<title>stage7_layer1_expert32</title>
<polygon fill="none" stroke="black" points="3954.69,-1094.03 3632.69,-1094.03 3632.69,-1042.03 3954.69,-1042.03 3954.69,-1094.03"/>
<text text-anchor="middle" x="3793.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 32</text>
<text text-anchor="middle" x="3793.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP pair)</text>
<text text-anchor="middle" x="3793.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert32 -->
<g id="edge1789" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert32</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3793.69,-1129.66C3793.69,-1120.96 3793.69,-1112.35 3793.69,-1104.47"/>
<polygon fill="black" stroke="black" points="3797.19,-1104.23 3793.69,-1094.23 3790.19,-1104.23 3797.19,-1104.23"/>
</g>
<!-- stage7_layer1_expert60 -->
<g id="node1382" class="node">
<title>stage7_layer1_expert60</title>
<polygon fill="none" stroke="black" points="4332.69,-1094.03 4010.69,-1094.03 4010.69,-1042.03 4332.69,-1042.03 4332.69,-1094.03"/>
<text text-anchor="middle" x="4171.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 60</text>
<text text-anchor="middle" x="4171.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP pair)</text>
<text text-anchor="middle" x="4171.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4171.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert60 -->
<g id="edge1795" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert60</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3991.82,-1129.94C4025.81,-1118.43 4059.4,-1107.06 4088.19,-1097.31"/>
<polygon fill="black" stroke="black" points="4089.41,-1100.59 4097.76,-1094.07 4087.17,-1093.96 4089.41,-1100.59"/>
</g>
<!-- stage7_layer1_expert61 -->
<g id="node1388" class="node">
<title>stage7_layer1_expert61</title>
<polygon fill="none" stroke="black" points="4691.69,-1094.03 4369.69,-1094.03 4369.69,-1042.03 4691.69,-1042.03 4691.69,-1094.03"/>
<text text-anchor="middle" x="4530.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 61</text>
<text text-anchor="middle" x="4530.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP pair)</text>
<text text-anchor="middle" x="4530.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4530.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert61 -->
<g id="edge1801" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert61</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4084.71,-1146.49C4184.49,-1129.16 4292.21,-1110.45 4376.79,-1095.76"/>
<polygon fill="black" stroke="black" points="4377.47,-1099.19 4386.73,-1094.03 4376.27,-1092.3 4377.47,-1099.19"/>
</g>
<!-- stage7_layer1_expert62 -->
<g id="node1394" class="node">
<title>stage7_layer1_expert62</title>
<polygon fill="none" stroke="black" points="5115.69,-1094.03 4793.69,-1094.03 4793.69,-1042.03 5115.69,-1042.03 5115.69,-1094.03"/>
<text text-anchor="middle" x="4954.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 62</text>
<text text-anchor="middle" x="4954.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP pair)</text>
<text text-anchor="middle" x="4954.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4954.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert62 -->
<g id="edge1807" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert62</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4106.72,-1162.52C4324.24,-1138.54 4605.88,-1107.49 4783.48,-1087.91"/>
<polygon fill="black" stroke="black" points="4783.88,-1091.38 4793.44,-1086.81 4783.11,-1084.43 4783.88,-1091.38"/>
</g>
<!-- stage7_layer1_expert63 -->
<g id="node1400" class="node">
<title>stage7_layer1_expert63</title>
<polygon fill="none" stroke="black" points="5497.69,-1094.03 5175.69,-1094.03 5175.69,-1042.03 5497.69,-1042.03 5497.69,-1094.03"/>
<text text-anchor="middle" x="5336.69" y="-1082.03" font-family="Times,serif" font-size="10.00">Layer 15 Expert 63</text>
<text text-anchor="middle" x="5336.69" y="-1071.03" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP pair)</text>
<text text-anchor="middle" x="5336.69" y="-1060.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5336.69" y="-1049.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert63 -->
<g id="edge1813" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert63</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4123.91,-1175.18C4393.43,-1156.45 4784.02,-1127.29 5124.69,-1094.03 5137.97,-1092.73 5151.71,-1091.31 5165.52,-1089.81"/>
<polygon fill="black" stroke="black" points="5166.02,-1093.28 5175.58,-1088.72 5165.26,-1086.32 5166.02,-1093.28"/>
</g>
<!-- stage7_layer1_expert_ellipsis -->
<g id="node1406" class="node">
<title>stage7_layer1_expert_ellipsis</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6080.69,-1006.03 5758.69,-1006.03 5758.69,-954.03 6080.69,-954.03 6080.69,-1006.03"/>
<text text-anchor="middle" x="5919.69" y="-994.03" font-family="Times,serif" font-size="10.00">... 54 more experts ...</text>
<text text-anchor="middle" x="5919.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: Pipeline 7 (Experts 4&#45;59)</text>
<text text-anchor="middle" x="5919.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5919.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert_ellipsis -->
<g id="edge1819" class="edge">
<title>stage7_layer1_expert_router&#45;&gt;stage7_layer1_expert_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4136.94,-1184.8C4559.52,-1168.28 5252.42,-1136 5506.69,-1094.03 5623.1,-1074.82 5753.91,-1035.99 5836.52,-1009.26"/>
<polygon fill="black" stroke="black" points="5837.68,-1012.57 5846.11,-1006.14 5835.51,-1005.91 5837.68,-1012.57"/>
</g>
<!-- stage7_layer1_expert0_mlp1 -->
<g id="node1347" class="node">
<title>stage7_layer1_expert0_mlp1</title>
<polygon fill="none" stroke="black" points="1882.69,-1006.03 1568.69,-1006.03 1568.69,-954.03 1882.69,-954.03 1882.69,-1006.03"/>
<text text-anchor="middle" x="1725.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 1</text>
<text text-anchor="middle" x="1725.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP: Column Parallel)</text>
<text text-anchor="middle" x="1725.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert0&#45;&gt;stage7_layer1_expert0_mlp1 -->
<g id="edge1760" class="edge">
<title>stage7_layer1_expert0&#45;&gt;stage7_layer1_expert0_mlp1</title>
<path fill="none" stroke="black" d="M1829.07,-1041.93C1812.8,-1032.34 1794.08,-1021.31 1777.07,-1011.3"/>
<polygon fill="black" stroke="black" points="1778.76,-1008.23 1768.36,-1006.17 1775.2,-1014.26 1778.76,-1008.23"/>
</g>
<!-- stage7_layer1_expert0_tp1 -->
<g id="node1348" class="node">
<title>stage7_layer1_expert0_tp1</title>
<ellipse fill="none" stroke="black" cx="1648.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1648.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Gather</text>
<text text-anchor="middle" x="1648.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="1648.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="1648.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert0_mlp1&#45;&gt;stage7_layer1_expert0_tp1 -->
<g id="edge1761" class="edge">
<title>stage7_layer1_expert0_mlp1&#45;&gt;stage7_layer1_expert0_tp1</title>
<path fill="none" stroke="black" d="M1705.66,-953.86C1698.84,-945.28 1691,-935.43 1683.36,-925.84"/>
<polygon fill="black" stroke="black" points="1685.99,-923.52 1677.02,-917.87 1680.51,-927.88 1685.99,-923.52"/>
</g>
<!-- stage7_layer1_expert0_act -->
<g id="node1349" class="node">
<title>stage7_layer1_expert0_act</title>
<polygon fill="none" stroke="black" points="1786.19,-808.49 1505.19,-808.49 1505.19,-756.49 1786.19,-756.49 1786.19,-808.49"/>
<text text-anchor="middle" x="1645.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="1645.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="1645.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1645.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert0_tp1&#45;&gt;stage7_layer1_expert0_act -->
<g id="edge1762" class="edge">
<title>stage7_layer1_expert0_tp1&#45;&gt;stage7_layer1_expert0_act</title>
<path fill="none" stroke="black" d="M1647.57,-844.23C1647.31,-835.92 1647.04,-827.08 1646.78,-818.8"/>
<polygon fill="black" stroke="black" points="1650.28,-818.58 1646.47,-808.69 1643.28,-818.79 1650.28,-818.58"/>
</g>
<!-- stage7_layer1_expert0_mlp2 -->
<g id="node1350" class="node">
<title>stage7_layer1_expert0_mlp2</title>
<polygon fill="none" stroke="black" points="1661.69,-720.49 1339.69,-720.49 1339.69,-668.49 1661.69,-668.49 1661.69,-720.49"/>
<text text-anchor="middle" x="1500.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 0 MLP Layer 2</text>
<text text-anchor="middle" x="1500.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1500.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1500.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert0_act&#45;&gt;stage7_layer1_expert0_mlp2 -->
<g id="edge1763" class="edge">
<title>stage7_layer1_expert0_act&#45;&gt;stage7_layer1_expert0_mlp2</title>
<path fill="none" stroke="black" d="M1603.36,-756.39C1587.2,-746.8 1568.61,-735.78 1551.72,-725.76"/>
<polygon fill="black" stroke="black" points="1553.46,-722.72 1543.07,-720.63 1549.89,-728.74 1553.46,-722.72"/>
</g>
<!-- stage7_layer1_expert0_tp2 -->
<g id="node1351" class="node">
<title>stage7_layer1_expert0_tp2</title>
<ellipse fill="none" stroke="black" cx="1428.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1428.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 0 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1428.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 896&#45;897</text>
<text text-anchor="middle" x="1428.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1428.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert0_mlp2&#45;&gt;stage7_layer1_expert0_tp2 -->
<g id="edge1764" class="edge">
<title>stage7_layer1_expert0_mlp2&#45;&gt;stage7_layer1_expert0_tp2</title>
<path fill="none" stroke="black" d="M1481.96,-668.32C1475.64,-659.83 1468.4,-650.09 1461.33,-640.59"/>
<polygon fill="black" stroke="black" points="1463.96,-638.27 1455.18,-632.33 1458.35,-642.45 1463.96,-638.27"/>
</g>
<!-- stage7_layer1_expert_agg -->
<g id="node1407" class="node">
<title>stage7_layer1_expert_agg</title>
<polygon fill="none" stroke="black" points="4344.22,-522.95 3468.45,-522.95 3243.16,-386.95 4118.93,-386.95 4344.22,-522.95"/>
<text text-anchor="middle" x="3793.69" y="-473.75" font-family="Times,serif" font-size="14.00">Layer 15 Expert Aggregation</text>
<text text-anchor="middle" x="3793.69" y="-458.75" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-443.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, experts=64, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-428.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert0_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1820" class="edge">
<title>stage7_layer1_expert0_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1584.23,-568.85C1611.01,-565.05 1638.61,-561.55 1664.69,-558.95 2249.93,-500.6 2929.1,-475 3359.99,-463.98"/>
<polygon fill="black" stroke="black" points="3360.22,-467.48 3370.12,-463.72 3360.04,-460.48 3360.22,-467.48"/>
</g>
<!-- stage7_layer1_expert1_mlp1 -->
<g id="node1353" class="node">
<title>stage7_layer1_expert1_mlp1</title>
<polygon fill="none" stroke="black" points="2273.69,-1006.03 1959.69,-1006.03 1959.69,-954.03 2273.69,-954.03 2273.69,-1006.03"/>
<text text-anchor="middle" x="2116.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 1</text>
<text text-anchor="middle" x="2116.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2116.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2116.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert1&#45;&gt;stage7_layer1_expert1_mlp1 -->
<g id="edge1766" class="edge">
<title>stage7_layer1_expert1&#45;&gt;stage7_layer1_expert1_mlp1</title>
<path fill="none" stroke="black" d="M2195.99,-1041.93C2184.02,-1032.73 2170.32,-1022.22 2157.72,-1012.54"/>
<polygon fill="black" stroke="black" points="2159.68,-1009.63 2149.62,-1006.32 2155.42,-1015.18 2159.68,-1009.63"/>
</g>
<!-- stage7_layer1_expert1_tp1 -->
<g id="node1354" class="node">
<title>stage7_layer1_expert1_tp1</title>
<ellipse fill="none" stroke="black" cx="2099.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2099.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Gather</text>
<text text-anchor="middle" x="2099.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="2099.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2099.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert1_mlp1&#45;&gt;stage7_layer1_expert1_tp1 -->
<g id="edge1767" class="edge">
<title>stage7_layer1_expert1_mlp1&#45;&gt;stage7_layer1_expert1_tp1</title>
<path fill="none" stroke="black" d="M2112.27,-953.86C2110.88,-945.97 2109.3,-936.99 2107.75,-928.13"/>
<polygon fill="black" stroke="black" points="2111.19,-927.48 2106.01,-918.24 2104.29,-928.69 2111.19,-927.48"/>
</g>
<!-- stage7_layer1_expert1_act -->
<g id="node1355" class="node">
<title>stage7_layer1_expert1_act</title>
<polygon fill="none" stroke="black" points="2191.19,-808.49 1910.19,-808.49 1910.19,-756.49 2191.19,-756.49 2191.19,-808.49"/>
<text text-anchor="middle" x="2050.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="2050.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="2050.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2050.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert1_tp1&#45;&gt;stage7_layer1_expert1_act -->
<g id="edge1768" class="edge">
<title>stage7_layer1_expert1_tp1&#45;&gt;stage7_layer1_expert1_act</title>
<path fill="none" stroke="black" d="M2081.58,-844.5C2077.14,-835.73 2072.39,-826.35 2067.99,-817.65"/>
<polygon fill="black" stroke="black" points="2071.01,-815.88 2063.37,-808.54 2064.76,-819.04 2071.01,-815.88"/>
</g>
<!-- stage7_layer1_expert1_mlp2 -->
<g id="node1356" class="node">
<title>stage7_layer1_expert1_mlp2</title>
<polygon fill="none" stroke="black" points="2133.69,-720.49 1811.69,-720.49 1811.69,-668.49 2133.69,-668.49 2133.69,-720.49"/>
<text text-anchor="middle" x="1972.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 1 MLP Layer 2</text>
<text text-anchor="middle" x="1972.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899 (TP: Row Parallel)</text>
<text text-anchor="middle" x="1972.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="1972.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert1_act&#45;&gt;stage7_layer1_expert1_mlp2 -->
<g id="edge1769" class="edge">
<title>stage7_layer1_expert1_act&#45;&gt;stage7_layer1_expert1_mlp2</title>
<path fill="none" stroke="black" d="M2027.71,-756.15C2019.77,-747.41 2010.77,-737.48 2002.37,-728.22"/>
<polygon fill="black" stroke="black" points="2004.82,-725.7 1995.5,-720.65 1999.63,-730.41 2004.82,-725.7"/>
</g>
<!-- stage7_layer1_expert1_tp2 -->
<g id="node1357" class="node">
<title>stage7_layer1_expert1_tp2</title>
<ellipse fill="none" stroke="black" cx="1901.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="1901.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 1 TP All&#45;Reduce</text>
<text text-anchor="middle" x="1901.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 898&#45;899</text>
<text text-anchor="middle" x="1901.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="1901.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert1_mlp2&#45;&gt;stage7_layer1_expert1_tp2 -->
<g id="edge1770" class="edge">
<title>stage7_layer1_expert1_mlp2&#45;&gt;stage7_layer1_expert1_tp2</title>
<path fill="none" stroke="black" d="M1954.22,-668.32C1947.99,-659.83 1940.85,-650.09 1933.87,-640.59"/>
<polygon fill="black" stroke="black" points="1936.55,-638.33 1927.82,-632.33 1930.91,-642.47 1936.55,-638.33"/>
</g>
<!-- stage7_layer1_expert1_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1821" class="edge">
<title>stage7_layer1_expert1_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2058.22,-569.02C2084.69,-565.24 2111.93,-561.7 2137.69,-558.95 2556.55,-514.27 3037.24,-487.03 3372.44,-471.88"/>
<polygon fill="black" stroke="black" points="3372.98,-475.36 3382.81,-471.41 3372.67,-468.37 3372.98,-475.36"/>
</g>
<!-- stage7_layer1_expert2_mlp1 -->
<g id="node1359" class="node">
<title>stage7_layer1_expert2_mlp1</title>
<polygon fill="none" stroke="black" points="2766.69,-1006.03 2452.69,-1006.03 2452.69,-954.03 2766.69,-954.03 2766.69,-1006.03"/>
<text text-anchor="middle" x="2609.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 1</text>
<text text-anchor="middle" x="2609.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP: Column Parallel)</text>
<text text-anchor="middle" x="2609.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2609.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert2&#45;&gt;stage7_layer1_expert2_mlp1 -->
<g id="edge1772" class="edge">
<title>stage7_layer1_expert2&#45;&gt;stage7_layer1_expert2_mlp1</title>
<path fill="none" stroke="black" d="M2664.71,-1041.69C2656.77,-1032.95 2647.77,-1023.02 2639.37,-1013.76"/>
<polygon fill="black" stroke="black" points="2641.82,-1011.24 2632.5,-1006.19 2636.63,-1015.95 2641.82,-1011.24"/>
</g>
<!-- stage7_layer1_expert2_tp1 -->
<g id="node1360" class="node">
<title>stage7_layer1_expert2_tp1</title>
<ellipse fill="none" stroke="black" cx="2532.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2532.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Gather</text>
<text text-anchor="middle" x="2532.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="2532.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2532.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert2_mlp1&#45;&gt;stage7_layer1_expert2_tp1 -->
<g id="edge1773" class="edge">
<title>stage7_layer1_expert2_mlp1&#45;&gt;stage7_layer1_expert2_tp1</title>
<path fill="none" stroke="black" d="M2589.66,-953.86C2582.84,-945.28 2575,-935.43 2567.36,-925.84"/>
<polygon fill="black" stroke="black" points="2569.99,-923.52 2561.02,-917.87 2564.51,-927.88 2569.99,-923.52"/>
</g>
<!-- stage7_layer1_expert2_act -->
<g id="node1361" class="node">
<title>stage7_layer1_expert2_act</title>
<polygon fill="none" stroke="black" points="2591.19,-808.49 2310.19,-808.49 2310.19,-756.49 2591.19,-756.49 2591.19,-808.49"/>
<text text-anchor="middle" x="2450.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2450.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="2450.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2450.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert2_tp1&#45;&gt;stage7_layer1_expert2_act -->
<g id="edge1774" class="edge">
<title>stage7_layer1_expert2_tp1&#45;&gt;stage7_layer1_expert2_act</title>
<path fill="none" stroke="black" d="M2502.62,-844.78C2494.77,-835.52 2486.35,-825.57 2478.62,-816.45"/>
<polygon fill="black" stroke="black" points="2481.17,-814.05 2472.03,-808.68 2475.83,-818.57 2481.17,-814.05"/>
</g>
<!-- stage7_layer1_expert2_mlp2 -->
<g id="node1362" class="node">
<title>stage7_layer1_expert2_mlp2</title>
<polygon fill="none" stroke="black" points="2543.69,-720.49 2221.69,-720.49 2221.69,-668.49 2543.69,-668.49 2543.69,-720.49"/>
<text text-anchor="middle" x="2382.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 2 MLP Layer 2</text>
<text text-anchor="middle" x="2382.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2382.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2382.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert2_act&#45;&gt;stage7_layer1_expert2_mlp2 -->
<g id="edge1775" class="edge">
<title>stage7_layer1_expert2_act&#45;&gt;stage7_layer1_expert2_mlp2</title>
<path fill="none" stroke="black" d="M2430.65,-756.15C2423.81,-747.49 2416.04,-737.68 2408.79,-728.5"/>
<polygon fill="black" stroke="black" points="2411.53,-726.32 2402.58,-720.65 2406.04,-730.66 2411.53,-726.32"/>
</g>
<!-- stage7_layer1_expert2_tp2 -->
<g id="node1363" class="node">
<title>stage7_layer1_expert2_tp2</title>
<ellipse fill="none" stroke="black" cx="2374.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2374.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 2 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2374.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 900&#45;901</text>
<text text-anchor="middle" x="2374.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2374.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert2_mlp2&#45;&gt;stage7_layer1_expert2_tp2 -->
<g id="edge1776" class="edge">
<title>stage7_layer1_expert2_mlp2&#45;&gt;stage7_layer1_expert2_tp2</title>
<path fill="none" stroke="black" d="M2380.61,-668.32C2379.96,-660.51 2379.23,-651.65 2378.5,-642.88"/>
<polygon fill="black" stroke="black" points="2381.97,-642.38 2377.66,-632.7 2375,-642.95 2381.97,-642.38"/>
</g>
<!-- stage7_layer1_expert2_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1822" class="edge">
<title>stage7_layer1_expert2_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2533.18,-569.29C2559.05,-565.54 2585.59,-561.95 2610.69,-558.95 2870.52,-527.98 3163.5,-502.4 3392.9,-484.48"/>
<polygon fill="black" stroke="black" points="3393.39,-487.96 3403.09,-483.69 3392.84,-480.98 3393.39,-487.96"/>
</g>
<!-- stage7_layer1_expert3_mlp1 -->
<g id="node1365" class="node">
<title>stage7_layer1_expert3_mlp1</title>
<polygon fill="none" stroke="black" points="3210.69,-1006.03 2896.69,-1006.03 2896.69,-954.03 3210.69,-954.03 3210.69,-1006.03"/>
<text text-anchor="middle" x="3053.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 1</text>
<text text-anchor="middle" x="3053.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3053.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3053.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert3&#45;&gt;stage7_layer1_expert3_mlp1 -->
<g id="edge1778" class="edge">
<title>stage7_layer1_expert3&#45;&gt;stage7_layer1_expert3_mlp1</title>
<path fill="none" stroke="black" d="M3077.67,-1041.69C3074.45,-1033.56 3070.83,-1024.4 3067.4,-1015.72"/>
<polygon fill="black" stroke="black" points="3070.57,-1014.2 3063.63,-1006.19 3064.06,-1016.77 3070.57,-1014.2"/>
</g>
<!-- stage7_layer1_expert3_tp1 -->
<g id="node1366" class="node">
<title>stage7_layer1_expert3_tp1</title>
<ellipse fill="none" stroke="black" cx="2956.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="2956.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Gather</text>
<text text-anchor="middle" x="2956.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="2956.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="2956.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert3_mlp1&#45;&gt;stage7_layer1_expert3_tp1 -->
<g id="edge1779" class="edge">
<title>stage7_layer1_expert3_mlp1&#45;&gt;stage7_layer1_expert3_tp1</title>
<path fill="none" stroke="black" d="M3028.46,-953.86C3019.51,-944.94 3009.19,-934.63 2999.2,-924.67"/>
<polygon fill="black" stroke="black" points="3001.57,-922.09 2992.02,-917.51 2996.62,-927.05 3001.57,-922.09"/>
</g>
<!-- stage7_layer1_expert3_act -->
<g id="node1367" class="node">
<title>stage7_layer1_expert3_act</title>
<polygon fill="none" stroke="black" points="3039.19,-808.49 2758.19,-808.49 2758.19,-756.49 3039.19,-756.49 3039.19,-808.49"/>
<text text-anchor="middle" x="2898.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2898.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="2898.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2898.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert3_tp1&#45;&gt;stage7_layer1_expert3_act -->
<g id="edge1780" class="edge">
<title>stage7_layer1_expert3_tp1&#45;&gt;stage7_layer1_expert3_act</title>
<path fill="none" stroke="black" d="M2935.26,-844.5C2929.94,-835.63 2924.26,-826.15 2919,-817.37"/>
<polygon fill="black" stroke="black" points="2921.84,-815.31 2913.7,-808.54 2915.84,-818.91 2921.84,-815.31"/>
</g>
<!-- stage7_layer1_expert3_mlp2 -->
<g id="node1368" class="node">
<title>stage7_layer1_expert3_mlp2</title>
<polygon fill="none" stroke="black" points="3034.69,-720.49 2712.69,-720.49 2712.69,-668.49 3034.69,-668.49 3034.69,-720.49"/>
<text text-anchor="middle" x="2873.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 3 MLP Layer 2</text>
<text text-anchor="middle" x="2873.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903 (TP: Row Parallel)</text>
<text text-anchor="middle" x="2873.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="2873.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert3_act&#45;&gt;stage7_layer1_expert3_mlp2 -->
<g id="edge1781" class="edge">
<title>stage7_layer1_expert3_act&#45;&gt;stage7_layer1_expert3_mlp2</title>
<path fill="none" stroke="black" d="M2891.32,-756.15C2888.98,-748.11 2886.35,-739.06 2883.85,-730.46"/>
<polygon fill="black" stroke="black" points="2887.15,-729.27 2881,-720.65 2880.43,-731.23 2887.15,-729.27"/>
</g>
<!-- stage7_layer1_expert3_tp2 -->
<g id="node1369" class="node">
<title>stage7_layer1_expert3_tp2</title>
<ellipse fill="none" stroke="black" cx="2847.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="2847.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 3 TP All&#45;Reduce</text>
<text text-anchor="middle" x="2847.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 902&#45;903</text>
<text text-anchor="middle" x="2847.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="2847.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert3_mlp2&#45;&gt;stage7_layer1_expert3_tp2 -->
<g id="edge1782" class="edge">
<title>stage7_layer1_expert3_mlp2&#45;&gt;stage7_layer1_expert3_tp2</title>
<path fill="none" stroke="black" d="M2866.93,-668.32C2864.8,-660.43 2862.39,-651.45 2860.01,-642.59"/>
<polygon fill="black" stroke="black" points="2863.33,-641.45 2857.35,-632.7 2856.57,-643.27 2863.33,-641.45"/>
</g>
<!-- stage7_layer1_expert3_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1823" class="edge">
<title>stage7_layer1_expert3_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3010.17,-569.96C3034.8,-566.24 3059.91,-562.48 3083.69,-558.95 3196.56,-542.21 3319.57,-524.26 3431.01,-508.11"/>
<polygon fill="black" stroke="black" points="3431.67,-511.56 3441.06,-506.66 3430.67,-504.63 3431.67,-511.56"/>
</g>
<!-- stage7_layer1_expert31_mlp1 -->
<g id="node1371" class="node">
<title>stage7_layer1_expert31_mlp1</title>
<polygon fill="none" stroke="black" points="3571.69,-1006.03 3257.69,-1006.03 3257.69,-954.03 3571.69,-954.03 3571.69,-1006.03"/>
<text text-anchor="middle" x="3414.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 1</text>
<text text-anchor="middle" x="3414.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3414.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3414.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert31&#45;&gt;stage7_layer1_expert31_mlp1 -->
<g id="edge1784" class="edge">
<title>stage7_layer1_expert31&#45;&gt;stage7_layer1_expert31_mlp1</title>
<path fill="none" stroke="black" d="M3435.85,-1041.69C3433.01,-1033.56 3429.82,-1024.4 3426.79,-1015.72"/>
<polygon fill="black" stroke="black" points="3430.06,-1014.48 3423.46,-1006.19 3423.45,-1016.78 3430.06,-1014.48"/>
</g>
<!-- stage7_layer1_expert31_tp1 -->
<g id="node1372" class="node">
<title>stage7_layer1_expert31_tp1</title>
<ellipse fill="none" stroke="black" cx="3376.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3376.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Gather</text>
<text text-anchor="middle" x="3376.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="3376.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3376.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert31_mlp1&#45;&gt;stage7_layer1_expert31_tp1 -->
<g id="edge1785" class="edge">
<title>stage7_layer1_expert31_mlp1&#45;&gt;stage7_layer1_expert31_tp1</title>
<path fill="none" stroke="black" d="M3404.8,-953.86C3401.64,-945.8 3398.03,-936.61 3394.48,-927.56"/>
<polygon fill="black" stroke="black" points="3397.73,-926.27 3390.82,-918.24 3391.21,-928.83 3397.73,-926.27"/>
</g>
<!-- stage7_layer1_expert31_act -->
<g id="node1373" class="node">
<title>stage7_layer1_expert31_act</title>
<polygon fill="none" stroke="black" points="3488.19,-808.49 3207.19,-808.49 3207.19,-756.49 3488.19,-756.49 3488.19,-808.49"/>
<text text-anchor="middle" x="3347.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 31 GELU Activation</text>
<text text-anchor="middle" x="3347.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="3347.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3347.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert31_tp1&#45;&gt;stage7_layer1_expert31_act -->
<g id="edge1786" class="edge">
<title>stage7_layer1_expert31_tp1&#45;&gt;stage7_layer1_expert31_act</title>
<path fill="none" stroke="black" d="M3365.97,-844.5C3363.4,-835.91 3360.65,-826.75 3358.09,-818.21"/>
<polygon fill="black" stroke="black" points="3361.42,-817.11 3355.19,-808.54 3354.71,-819.12 3361.42,-817.11"/>
</g>
<!-- stage7_layer1_expert31_mlp2 -->
<g id="node1374" class="node">
<title>stage7_layer1_expert31_mlp2</title>
<polygon fill="none" stroke="black" points="3495.69,-720.49 3173.69,-720.49 3173.69,-668.49 3495.69,-668.49 3495.69,-720.49"/>
<text text-anchor="middle" x="3334.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 31 MLP Layer 2</text>
<text text-anchor="middle" x="3334.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3334.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3334.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert31_act&#45;&gt;stage7_layer1_expert31_mlp2 -->
<g id="edge1787" class="edge">
<title>stage7_layer1_expert31_act&#45;&gt;stage7_layer1_expert31_mlp2</title>
<path fill="none" stroke="black" d="M3343.86,-756.15C3342.65,-748.19 3341.3,-739.26 3340.02,-730.74"/>
<polygon fill="black" stroke="black" points="3343.45,-730.01 3338.49,-720.65 3336.53,-731.06 3343.45,-730.01"/>
</g>
<!-- stage7_layer1_expert31_tp2 -->
<g id="node1375" class="node">
<title>stage7_layer1_expert31_tp2</title>
<ellipse fill="none" stroke="black" cx="3320.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3320.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 31 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3320.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 958&#45;959</text>
<text text-anchor="middle" x="3320.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3320.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert31_mlp2&#45;&gt;stage7_layer1_expert31_tp2 -->
<g id="edge1788" class="edge">
<title>stage7_layer1_expert31_mlp2&#45;&gt;stage7_layer1_expert31_tp2</title>
<path fill="none" stroke="black" d="M3331.05,-668.32C3329.92,-660.51 3328.63,-651.65 3327.37,-642.88"/>
<polygon fill="black" stroke="black" points="3330.79,-642.1 3325.89,-632.7 3323.86,-643.1 3330.79,-642.1"/>
</g>
<!-- stage7_layer1_expert31_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1824" class="edge">
<title>stage7_layer1_expert31_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3428.02,-563.23C3466.11,-552.06 3510.65,-538.99 3555.28,-525.9"/>
<polygon fill="black" stroke="black" points="3556.49,-529.19 3565.1,-523.02 3554.52,-522.47 3556.49,-529.19"/>
</g>
<!-- stage7_layer1_expert32_mlp1 -->
<g id="node1377" class="node">
<title>stage7_layer1_expert32_mlp1</title>
<polygon fill="none" stroke="black" points="3950.69,-1006.03 3636.69,-1006.03 3636.69,-954.03 3950.69,-954.03 3950.69,-1006.03"/>
<text text-anchor="middle" x="3793.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 1</text>
<text text-anchor="middle" x="3793.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP: Column Parallel)</text>
<text text-anchor="middle" x="3793.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert32&#45;&gt;stage7_layer1_expert32_mlp1 -->
<g id="edge1790" class="edge">
<title>stage7_layer1_expert32&#45;&gt;stage7_layer1_expert32_mlp1</title>
<path fill="none" stroke="black" d="M3793.69,-1041.69C3793.69,-1033.73 3793.69,-1024.79 3793.69,-1016.28"/>
<polygon fill="black" stroke="black" points="3797.19,-1016.19 3793.69,-1006.19 3790.19,-1016.19 3797.19,-1016.19"/>
</g>
<!-- stage7_layer1_expert32_tp1 -->
<g id="node1378" class="node">
<title>stage7_layer1_expert32_tp1</title>
<ellipse fill="none" stroke="black" cx="3793.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="3793.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Gather</text>
<text text-anchor="middle" x="3793.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="3793.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="3793.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert32_mlp1&#45;&gt;stage7_layer1_expert32_tp1 -->
<g id="edge1791" class="edge">
<title>stage7_layer1_expert32_mlp1&#45;&gt;stage7_layer1_expert32_tp1</title>
<path fill="none" stroke="black" d="M3793.69,-953.86C3793.69,-946.05 3793.69,-937.18 3793.69,-928.42"/>
<polygon fill="black" stroke="black" points="3797.19,-928.24 3793.69,-918.24 3790.19,-928.24 3797.19,-928.24"/>
</g>
<!-- stage7_layer1_expert32_act -->
<g id="node1379" class="node">
<title>stage7_layer1_expert32_act</title>
<polygon fill="none" stroke="black" points="3934.19,-808.49 3653.19,-808.49 3653.19,-756.49 3934.19,-756.49 3934.19,-808.49"/>
<text text-anchor="middle" x="3793.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 32 GELU Activation</text>
<text text-anchor="middle" x="3793.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="3793.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3793.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert32_tp1&#45;&gt;stage7_layer1_expert32_act -->
<g id="edge1792" class="edge">
<title>stage7_layer1_expert32_tp1&#45;&gt;stage7_layer1_expert32_act</title>
<path fill="none" stroke="black" d="M3793.69,-844.23C3793.69,-835.92 3793.69,-827.08 3793.69,-818.8"/>
<polygon fill="black" stroke="black" points="3797.19,-818.69 3793.69,-808.69 3790.19,-818.69 3797.19,-818.69"/>
</g>
<!-- stage7_layer1_expert32_mlp2 -->
<g id="node1380" class="node">
<title>stage7_layer1_expert32_mlp2</title>
<polygon fill="none" stroke="black" points="3954.69,-720.49 3632.69,-720.49 3632.69,-668.49 3954.69,-668.49 3954.69,-720.49"/>
<text text-anchor="middle" x="3793.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 32 MLP Layer 2</text>
<text text-anchor="middle" x="3793.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961 (TP: Row Parallel)</text>
<text text-anchor="middle" x="3793.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="3793.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert32_act&#45;&gt;stage7_layer1_expert32_mlp2 -->
<g id="edge1793" class="edge">
<title>stage7_layer1_expert32_act&#45;&gt;stage7_layer1_expert32_mlp2</title>
<path fill="none" stroke="black" d="M3793.69,-756.15C3793.69,-748.19 3793.69,-739.26 3793.69,-730.74"/>
<polygon fill="black" stroke="black" points="3797.19,-730.65 3793.69,-720.65 3790.19,-730.65 3797.19,-730.65"/>
</g>
<!-- stage7_layer1_expert32_tp2 -->
<g id="node1381" class="node">
<title>stage7_layer1_expert32_tp2</title>
<ellipse fill="none" stroke="black" cx="3793.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="3793.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 32 TP All&#45;Reduce</text>
<text text-anchor="middle" x="3793.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 960&#45;961</text>
<text text-anchor="middle" x="3793.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert32_mlp2&#45;&gt;stage7_layer1_expert32_tp2 -->
<g id="edge1794" class="edge">
<title>stage7_layer1_expert32_mlp2&#45;&gt;stage7_layer1_expert32_tp2</title>
<path fill="none" stroke="black" d="M3793.69,-668.32C3793.69,-660.51 3793.69,-651.65 3793.69,-642.88"/>
<polygon fill="black" stroke="black" points="3797.19,-642.7 3793.69,-632.7 3790.19,-642.7 3797.19,-642.7"/>
</g>
<!-- stage7_layer1_expert32_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1825" class="edge">
<title>stage7_layer1_expert32_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3793.69,-558.63C3793.69,-550.69 3793.69,-541.99 3793.69,-533.12"/>
<polygon fill="black" stroke="black" points="3797.19,-533.07 3793.69,-523.07 3790.19,-533.07 3797.19,-533.07"/>
</g>
<!-- stage7_layer1_expert60_mlp1 -->
<g id="node1383" class="node">
<title>stage7_layer1_expert60_mlp1</title>
<polygon fill="none" stroke="black" points="4359.69,-1006.03 4045.69,-1006.03 4045.69,-954.03 4359.69,-954.03 4359.69,-1006.03"/>
<text text-anchor="middle" x="4202.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 1</text>
<text text-anchor="middle" x="4202.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4202.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4202.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert60&#45;&gt;stage7_layer1_expert60_mlp1 -->
<g id="edge1796" class="edge">
<title>stage7_layer1_expert60&#45;&gt;stage7_layer1_expert60_mlp1</title>
<path fill="none" stroke="black" d="M4180.82,-1041.69C4183.75,-1033.56 4187.06,-1024.4 4190.19,-1015.72"/>
<polygon fill="black" stroke="black" points="4193.52,-1016.78 4193.62,-1006.19 4186.94,-1014.41 4193.52,-1016.78"/>
</g>
<!-- stage7_layer1_expert60_tp1 -->
<g id="node1384" class="node">
<title>stage7_layer1_expert60_tp1</title>
<ellipse fill="none" stroke="black" cx="4222.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4222.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Gather</text>
<text text-anchor="middle" x="4222.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="4222.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4222.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert60_mlp1&#45;&gt;stage7_layer1_expert60_tp1 -->
<g id="edge1797" class="edge">
<title>stage7_layer1_expert60_mlp1&#45;&gt;stage7_layer1_expert60_tp1</title>
<path fill="none" stroke="black" d="M4207.89,-953.86C4209.52,-945.97 4211.38,-936.99 4213.21,-928.13"/>
<polygon fill="black" stroke="black" points="4216.66,-928.74 4215.25,-918.24 4209.8,-927.32 4216.66,-928.74"/>
</g>
<!-- stage7_layer1_expert60_act -->
<g id="node1385" class="node">
<title>stage7_layer1_expert60_act</title>
<polygon fill="none" stroke="black" points="4370.19,-808.49 4089.19,-808.49 4089.19,-756.49 4370.19,-756.49 4370.19,-808.49"/>
<text text-anchor="middle" x="4229.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 60 GELU Activation</text>
<text text-anchor="middle" x="4229.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="4229.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4229.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert60_tp1&#45;&gt;stage7_layer1_expert60_act -->
<g id="edge1798" class="edge">
<title>stage7_layer1_expert60_tp1&#45;&gt;stage7_layer1_expert60_act</title>
<path fill="none" stroke="black" d="M4225.29,-844.23C4225.9,-835.92 4226.54,-827.08 4227.13,-818.8"/>
<polygon fill="black" stroke="black" points="4230.64,-818.92 4227.87,-808.69 4223.65,-818.41 4230.64,-818.92"/>
</g>
<!-- stage7_layer1_expert60_mlp2 -->
<g id="node1386" class="node">
<title>stage7_layer1_expert60_mlp2</title>
<polygon fill="none" stroke="black" points="4419.69,-720.49 4097.69,-720.49 4097.69,-668.49 4419.69,-668.49 4419.69,-720.49"/>
<text text-anchor="middle" x="4258.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 60 MLP Layer 2</text>
<text text-anchor="middle" x="4258.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4258.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4258.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert60_act&#45;&gt;stage7_layer1_expert60_mlp2 -->
<g id="edge1799" class="edge">
<title>stage7_layer1_expert60_act&#45;&gt;stage7_layer1_expert60_mlp2</title>
<path fill="none" stroke="black" d="M4238.23,-756.15C4240.98,-748.02 4244.06,-738.86 4246.99,-730.18"/>
<polygon fill="black" stroke="black" points="4250.33,-731.24 4250.21,-720.65 4243.69,-729.01 4250.33,-731.24"/>
</g>
<!-- stage7_layer1_expert60_tp2 -->
<g id="node1387" class="node">
<title>stage7_layer1_expert60_tp2</title>
<ellipse fill="none" stroke="black" cx="4266.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4266.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 60 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4266.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 1016&#45;1017</text>
<text text-anchor="middle" x="4266.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4266.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert60_mlp2&#45;&gt;stage7_layer1_expert60_tp2 -->
<g id="edge1800" class="edge">
<title>stage7_layer1_expert60_mlp2&#45;&gt;stage7_layer1_expert60_tp2</title>
<path fill="none" stroke="black" d="M4260.77,-668.32C4261.41,-660.51 4262.15,-651.65 4262.87,-642.88"/>
<polygon fill="black" stroke="black" points="4266.38,-642.95 4263.71,-632.7 4259.4,-642.38 4266.38,-642.95"/>
</g>
<!-- stage7_layer1_expert60_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1826" class="edge">
<title>stage7_layer1_expert60_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4159.36,-563.23C4121.27,-552.06 4076.73,-538.99 4032.1,-525.9"/>
<polygon fill="black" stroke="black" points="4032.86,-522.47 4022.28,-523.02 4030.89,-529.19 4032.86,-522.47"/>
</g>
<!-- stage7_layer1_expert61_mlp1 -->
<g id="node1389" class="node">
<title>stage7_layer1_expert61_mlp1</title>
<polygon fill="none" stroke="black" points="4695.69,-1006.03 4381.69,-1006.03 4381.69,-954.03 4695.69,-954.03 4695.69,-1006.03"/>
<text text-anchor="middle" x="4538.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 1</text>
<text text-anchor="middle" x="4538.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP: Column Parallel)</text>
<text text-anchor="middle" x="4538.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4538.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert61&#45;&gt;stage7_layer1_expert61_mlp1 -->
<g id="edge1802" class="edge">
<title>stage7_layer1_expert61&#45;&gt;stage7_layer1_expert61_mlp1</title>
<path fill="none" stroke="black" d="M4533.05,-1041.69C4533.79,-1033.73 4534.62,-1024.79 4535.41,-1016.28"/>
<polygon fill="black" stroke="black" points="4538.91,-1016.47 4536.35,-1006.19 4531.94,-1015.82 4538.91,-1016.47"/>
</g>
<!-- stage7_layer1_expert61_tp1 -->
<g id="node1390" class="node">
<title>stage7_layer1_expert61_tp1</title>
<ellipse fill="none" stroke="black" cx="4651.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4651.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Gather</text>
<text text-anchor="middle" x="4651.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="4651.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="4651.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert61_mlp1&#45;&gt;stage7_layer1_expert61_tp1 -->
<g id="edge1803" class="edge">
<title>stage7_layer1_expert61_mlp1&#45;&gt;stage7_layer1_expert61_tp1</title>
<path fill="none" stroke="black" d="M4568.08,-953.86C4578.7,-944.76 4591,-934.23 4602.84,-924.09"/>
<polygon fill="black" stroke="black" points="4605.21,-926.67 4610.53,-917.51 4600.66,-921.35 4605.21,-926.67"/>
</g>
<!-- stage7_layer1_expert61_act -->
<g id="node1391" class="node">
<title>stage7_layer1_expert61_act</title>
<polygon fill="none" stroke="black" points="4868.19,-808.49 4587.19,-808.49 4587.19,-756.49 4868.19,-756.49 4868.19,-808.49"/>
<text text-anchor="middle" x="4727.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 61 GELU Activation</text>
<text text-anchor="middle" x="4727.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="4727.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4727.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert61_tp1&#45;&gt;stage7_layer1_expert61_act -->
<g id="edge1804" class="edge">
<title>stage7_layer1_expert61_tp1&#45;&gt;stage7_layer1_expert61_act</title>
<path fill="none" stroke="black" d="M4679.56,-844.78C4686.76,-835.61 4694.48,-825.77 4701.59,-816.73"/>
<polygon fill="black" stroke="black" points="4704.48,-818.7 4707.91,-808.68 4698.98,-814.38 4704.48,-818.7"/>
</g>
<!-- stage7_layer1_expert61_mlp2 -->
<g id="node1392" class="node">
<title>stage7_layer1_expert61_mlp2</title>
<polygon fill="none" stroke="black" points="4888.69,-720.49 4566.69,-720.49 4566.69,-668.49 4888.69,-668.49 4888.69,-720.49"/>
<text text-anchor="middle" x="4727.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 61 MLP Layer 2</text>
<text text-anchor="middle" x="4727.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019 (TP: Row Parallel)</text>
<text text-anchor="middle" x="4727.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="4727.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert61_act&#45;&gt;stage7_layer1_expert61_mlp2 -->
<g id="edge1805" class="edge">
<title>stage7_layer1_expert61_act&#45;&gt;stage7_layer1_expert61_mlp2</title>
<path fill="none" stroke="black" d="M4727.69,-756.15C4727.69,-748.19 4727.69,-739.26 4727.69,-730.74"/>
<polygon fill="black" stroke="black" points="4731.19,-730.65 4727.69,-720.65 4724.19,-730.65 4731.19,-730.65"/>
</g>
<!-- stage7_layer1_expert61_tp2 -->
<g id="node1393" class="node">
<title>stage7_layer1_expert61_tp2</title>
<ellipse fill="none" stroke="black" cx="4739.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="4739.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 61 TP All&#45;Reduce</text>
<text text-anchor="middle" x="4739.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 1018&#45;1019</text>
<text text-anchor="middle" x="4739.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="4739.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert61_mlp2&#45;&gt;stage7_layer1_expert61_tp2 -->
<g id="edge1806" class="edge">
<title>stage7_layer1_expert61_mlp2&#45;&gt;stage7_layer1_expert61_tp2</title>
<path fill="none" stroke="black" d="M4730.81,-668.32C4731.78,-660.51 4732.88,-651.65 4733.96,-642.88"/>
<polygon fill="black" stroke="black" points="4737.47,-643.05 4735.23,-632.7 4730.52,-642.19 4737.47,-643.05"/>
</g>
<!-- stage7_layer1_expert61_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1827" class="edge">
<title>stage7_layer1_expert61_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4577.21,-569.96C4552.58,-566.24 4527.46,-562.48 4503.69,-558.95 4427.78,-547.69 4347.27,-535.89 4268.79,-524.45"/>
<polygon fill="black" stroke="black" points="4269.13,-520.96 4258.73,-522.99 4268.13,-527.89 4269.13,-520.96"/>
</g>
<!-- stage7_layer1_expert62_mlp1 -->
<g id="node1395" class="node">
<title>stage7_layer1_expert62_mlp1</title>
<polygon fill="none" stroke="black" points="5178.69,-1006.03 4864.69,-1006.03 4864.69,-954.03 5178.69,-954.03 5178.69,-1006.03"/>
<text text-anchor="middle" x="5021.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 1</text>
<text text-anchor="middle" x="5021.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5021.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5021.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert62&#45;&gt;stage7_layer1_expert62_mlp1 -->
<g id="edge1808" class="edge">
<title>stage7_layer1_expert62&#45;&gt;stage7_layer1_expert62_mlp1</title>
<path fill="none" stroke="black" d="M4974.43,-1041.69C4981.11,-1033.12 4988.67,-1023.41 4995.76,-1014.32"/>
<polygon fill="black" stroke="black" points="4998.7,-1016.23 5002.09,-1006.19 4993.18,-1011.93 4998.7,-1016.23"/>
</g>
<!-- stage7_layer1_expert62_tp1 -->
<g id="node1396" class="node">
<title>stage7_layer1_expert62_tp1</title>
<ellipse fill="none" stroke="black" cx="5073.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5073.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Gather</text>
<text text-anchor="middle" x="5073.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="5073.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5073.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert62_mlp1&#45;&gt;stage7_layer1_expert62_tp1 -->
<g id="edge1809" class="edge">
<title>stage7_layer1_expert62_mlp1&#45;&gt;stage7_layer1_expert62_tp1</title>
<path fill="none" stroke="black" d="M5035.22,-953.86C5039.68,-945.54 5044.8,-936.02 5049.81,-926.7"/>
<polygon fill="black" stroke="black" points="5052.9,-928.34 5054.55,-917.87 5046.74,-925.02 5052.9,-928.34"/>
</g>
<!-- stage7_layer1_expert62_act -->
<g id="node1397" class="node">
<title>stage7_layer1_expert62_act</title>
<polygon fill="none" stroke="black" points="5225.19,-808.49 4944.19,-808.49 4944.19,-756.49 5225.19,-756.49 5225.19,-808.49"/>
<text text-anchor="middle" x="5084.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 62 GELU Activation</text>
<text text-anchor="middle" x="5084.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="5084.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5084.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert62_tp1&#45;&gt;stage7_layer1_expert62_act -->
<g id="edge1810" class="edge">
<title>stage7_layer1_expert62_tp1&#45;&gt;stage7_layer1_expert62_act</title>
<path fill="none" stroke="black" d="M5077.78,-844.23C5078.73,-835.92 5079.73,-827.08 5080.67,-818.8"/>
<polygon fill="black" stroke="black" points="5084.17,-819.02 5081.82,-808.69 5077.22,-818.23 5084.17,-819.02"/>
</g>
<!-- stage7_layer1_expert62_mlp2 -->
<g id="node1398" class="node">
<title>stage7_layer1_expert62_mlp2</title>
<polygon fill="none" stroke="black" points="5304.69,-720.49 4982.69,-720.49 4982.69,-668.49 5304.69,-668.49 5304.69,-720.49"/>
<text text-anchor="middle" x="5143.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 62 MLP Layer 2</text>
<text text-anchor="middle" x="5143.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5143.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5143.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert62_act&#45;&gt;stage7_layer1_expert62_mlp2 -->
<g id="edge1811" class="edge">
<title>stage7_layer1_expert62_act&#45;&gt;stage7_layer1_expert62_mlp2</title>
<path fill="none" stroke="black" d="M5102.07,-756.15C5107.89,-747.67 5114.48,-738.07 5120.66,-729.06"/>
<polygon fill="black" stroke="black" points="5123.66,-730.88 5126.43,-720.65 5117.89,-726.92 5123.66,-730.88"/>
</g>
<!-- stage7_layer1_expert62_tp2 -->
<g id="node1399" class="node">
<title>stage7_layer1_expert62_tp2</title>
<ellipse fill="none" stroke="black" cx="5212.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5212.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 62 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5212.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 1020&#45;1021</text>
<text text-anchor="middle" x="5212.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5212.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert62_mlp2&#45;&gt;stage7_layer1_expert62_tp2 -->
<g id="edge1812" class="edge">
<title>stage7_layer1_expert62_mlp2&#45;&gt;stage7_layer1_expert62_tp2</title>
<path fill="none" stroke="black" d="M5161.64,-668.32C5167.69,-659.83 5174.63,-650.09 5181.41,-640.59"/>
<polygon fill="black" stroke="black" points="5184.34,-642.51 5187.3,-632.33 5178.64,-638.44 5184.34,-642.51"/>
</g>
<!-- stage7_layer1_expert62_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1828" class="edge">
<title>stage7_layer1_expert62_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5054.19,-569.29C5028.33,-565.54 5001.79,-561.95 4976.69,-558.95 4756.65,-532.73 4512.82,-510.36 4303.99,-493.25"/>
<polygon fill="black" stroke="black" points="4304,-489.74 4293.75,-492.41 4303.43,-496.71 4304,-489.74"/>
</g>
<!-- stage7_layer1_expert63_mlp1 -->
<g id="node1401" class="node">
<title>stage7_layer1_expert63_mlp1</title>
<polygon fill="none" stroke="black" points="5514.69,-1006.03 5200.69,-1006.03 5200.69,-954.03 5514.69,-954.03 5514.69,-1006.03"/>
<text text-anchor="middle" x="5357.69" y="-994.03" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 1</text>
<text text-anchor="middle" x="5357.69" y="-983.03" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP: Column Parallel)</text>
<text text-anchor="middle" x="5357.69" y="-972.03" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5357.69" y="-961.03" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=8192]</text>
</g>
<!-- stage7_layer1_expert63&#45;&gt;stage7_layer1_expert63_mlp1 -->
<g id="edge1814" class="edge">
<title>stage7_layer1_expert63&#45;&gt;stage7_layer1_expert63_mlp1</title>
<path fill="none" stroke="black" d="M5342.88,-1041.69C5344.84,-1033.65 5347.05,-1024.6 5349.15,-1016"/>
<polygon fill="black" stroke="black" points="5352.57,-1016.73 5351.55,-1006.19 5345.77,-1015.07 5352.57,-1016.73"/>
</g>
<!-- stage7_layer1_expert63_tp1 -->
<g id="node1402" class="node">
<title>stage7_layer1_expert63_tp1</title>
<ellipse fill="none" stroke="black" cx="5495.69" cy="-881.26" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="5495.69" y="-895.26" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Gather</text>
<text text-anchor="middle" x="5495.69" y="-884.26" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="5495.69" y="-873.26" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=8192]</text>
<text text-anchor="middle" x="5495.69" y="-862.26" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert63_mlp1&#45;&gt;stage7_layer1_expert63_tp1 -->
<g id="edge1815" class="edge">
<title>stage7_layer1_expert63_mlp1&#45;&gt;stage7_layer1_expert63_tp1</title>
<path fill="none" stroke="black" d="M5393.59,-953.86C5407.13,-944.36 5422.9,-933.3 5437.94,-922.75"/>
<polygon fill="black" stroke="black" points="5440.03,-925.57 5446.21,-916.96 5436.01,-919.84 5440.03,-925.57"/>
</g>
<!-- stage7_layer1_expert63_act -->
<g id="node1403" class="node">
<title>stage7_layer1_expert63_act</title>
<polygon fill="none" stroke="black" points="5719.19,-808.49 5438.19,-808.49 5438.19,-756.49 5719.19,-756.49 5719.19,-808.49"/>
<text text-anchor="middle" x="5578.69" y="-796.49" font-family="Times,serif" font-size="10.00">Expert 63 GELU Activation</text>
<text text-anchor="middle" x="5578.69" y="-785.49" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="5578.69" y="-774.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5578.69" y="-763.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, ffn=16384]</text>
</g>
<!-- stage7_layer1_expert63_tp1&#45;&gt;stage7_layer1_expert63_act -->
<g id="edge1816" class="edge">
<title>stage7_layer1_expert63_tp1&#45;&gt;stage7_layer1_expert63_act</title>
<path fill="none" stroke="black" d="M5526.12,-844.78C5534.07,-835.52 5542.59,-825.57 5550.42,-816.45"/>
<polygon fill="black" stroke="black" points="5553.23,-818.55 5557.09,-808.68 5547.92,-813.99 5553.23,-818.55"/>
</g>
<!-- stage7_layer1_expert63_mlp2 -->
<g id="node1404" class="node">
<title>stage7_layer1_expert63_mlp2</title>
<polygon fill="none" stroke="black" points="5780.69,-720.49 5458.69,-720.49 5458.69,-668.49 5780.69,-668.49 5780.69,-720.49"/>
<text text-anchor="middle" x="5619.69" y="-708.49" font-family="Times,serif" font-size="10.00">Expert 63 MLP Layer 2</text>
<text text-anchor="middle" x="5619.69" y="-697.49" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023 (TP: Row Parallel)</text>
<text text-anchor="middle" x="5619.69" y="-686.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, ffn=16384]</text>
<text text-anchor="middle" x="5619.69" y="-675.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert63_act&#45;&gt;stage7_layer1_expert63_mlp2 -->
<g id="edge1817" class="edge">
<title>stage7_layer1_expert63_act&#45;&gt;stage7_layer1_expert63_mlp2</title>
<path fill="none" stroke="black" d="M5590.77,-756.15C5594.69,-747.93 5599.11,-738.67 5603.29,-729.9"/>
<polygon fill="black" stroke="black" points="5606.55,-731.18 5607.7,-720.65 5600.23,-728.17 5606.55,-731.18"/>
</g>
<!-- stage7_layer1_expert63_tp2 -->
<g id="node1405" class="node">
<title>stage7_layer1_expert63_tp2</title>
<ellipse fill="none" stroke="black" cx="5685.69" cy="-595.72" rx="227.88" ry="36.54"/>
<text text-anchor="middle" x="5685.69" y="-609.72" font-family="Times,serif" font-size="10.00">Expert 63 TP All&#45;Reduce</text>
<text text-anchor="middle" x="5685.69" y="-598.72" font-family="Times,serif" font-size="10.00">GPU: 1022&#45;1023</text>
<text text-anchor="middle" x="5685.69" y="-587.72" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="5685.69" y="-576.72" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert63_mlp2&#45;&gt;stage7_layer1_expert63_tp2 -->
<g id="edge1818" class="edge">
<title>stage7_layer1_expert63_mlp2&#45;&gt;stage7_layer1_expert63_tp2</title>
<path fill="none" stroke="black" d="M5636.86,-668.32C5642.59,-659.92 5649.15,-650.29 5655.57,-640.88"/>
<polygon fill="black" stroke="black" points="5658.66,-642.57 5661.4,-632.33 5652.87,-638.62 5658.66,-642.57"/>
</g>
<!-- stage7_layer1_expert63_tp2&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1829" class="edge">
<title>stage7_layer1_expert63_tp2&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5529.16,-569.02C5502.69,-565.24 5475.44,-561.7 5449.69,-558.95 5054.75,-516.82 4604.84,-490.2 4273.75,-474.59"/>
<polygon fill="black" stroke="black" points="4273.65,-471.09 4263.49,-474.11 4273.32,-478.08 4273.65,-471.09"/>
</g>
<!-- stage7_layer1_expert_ellipsis&#45;&gt;stage7_layer1_expert_agg -->
<g id="edge1830" class="edge">
<title>stage7_layer1_expert_ellipsis&#45;&gt;stage7_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5924.35,-953.82C5930.81,-916.67 5941.69,-844.98 5941.69,-783.49 5941.69,-783.49 5941.69,-783.49 5941.69,-693.49 5941.69,-633.1 5967.31,-599.65 5922.69,-558.95 5862.07,-503.67 4863.4,-475.55 4255.67,-463.49"/>
<polygon fill="black" stroke="black" points="4255.48,-459.98 4245.41,-463.28 4255.34,-466.98 4255.48,-459.98"/>
</g>
<!-- stage7_layer1_output -->
<g id="node1408" class="node">
<title>stage7_layer1_output</title>
<polygon fill="none" stroke="black" points="4018.69,-350.95 3568.69,-350.95 3568.69,-282.95 4018.69,-282.95 4018.69,-350.95"/>
<text text-anchor="middle" x="3793.69" y="-335.75" font-family="Times,serif" font-size="14.00">Layer 15 Output</text>
<text text-anchor="middle" x="3793.69" y="-320.75" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-305.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-290.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_expert_agg&#45;&gt;stage7_layer1_output -->
<g id="edge1831" class="edge">
<title>stage7_layer1_expert_agg&#45;&gt;stage7_layer1_output</title>
<path fill="none" stroke="black" d="M3793.69,-386.75C3793.69,-378 3793.69,-369.23 3793.69,-361.02"/>
<polygon fill="black" stroke="black" points="3797.19,-360.97 3793.69,-350.97 3790.19,-360.97 3797.19,-360.97"/>
</g>
<!-- stage7_output -->
<g id="node1409" class="node">
<title>stage7_output</title>
<polygon fill="none" stroke="black" points="4260.27,-246.95 3518.05,-246.95 3327.11,-110.95 4069.33,-110.95 4260.27,-246.95"/>
<text text-anchor="middle" x="3793.69" y="-197.75" font-family="Times,serif" font-size="14.00">Stage 7 Output</text>
<text text-anchor="middle" x="3793.69" y="-182.75" font-family="Times,serif" font-size="14.00">GPU: Pipeline 7</text>
<text text-anchor="middle" x="3793.69" y="-167.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-152.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_layer1_output&#45;&gt;stage7_output -->
<g id="edge1832" class="edge">
<title>stage7_layer1_output&#45;&gt;stage7_output</title>
<path fill="none" stroke="black" d="M3793.69,-282.68C3793.69,-274.86 3793.69,-266.19 3793.69,-257.31"/>
<polygon fill="black" stroke="black" points="3797.19,-257.22 3793.69,-247.22 3790.19,-257.22 3797.19,-257.22"/>
</g>
<!-- output -->
<g id="node1410" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="3793.69" cy="-37.48" rx="318.4" ry="37.45"/>
<text text-anchor="middle" x="3793.69" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3793.69" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
<text text-anchor="middle" x="3793.69" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=4096]</text>
</g>
<!-- stage7_output&#45;&gt;output -->
<g id="edge1833" class="edge">
<title>stage7_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3793.69,-110.67C3793.69,-102.05 3793.69,-93.37 3793.69,-85.18"/>
<polygon fill="black" stroke="black" points="3797.19,-85.1 3793.69,-75.1 3790.19,-85.1 3797.19,-85.1"/>
</g>
</g>
</svg>
