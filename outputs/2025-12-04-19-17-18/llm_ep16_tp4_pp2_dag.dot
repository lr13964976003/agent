// LLM EP16_TP4_PP2_Hybrid Strategy DAG
digraph {
	rankdir=TB size="20,30"
	node [fontsize=10]
	input [label="Input Layer\nGPU: 0-127\nInput: [batch_size=128, seq_len=1024, hidden=1024]\nOutput: [batch_size=128, seq_len=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_0_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_0_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_0_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_0_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_0_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_0_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_0_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_0_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_0_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_0_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_0_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_0_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_0 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_0 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_0 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_0_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_0_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_0_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_0_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_0_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_0_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_0 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_0_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_0_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_0_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_0_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_0 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_0 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_1_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_1_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_1_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_1_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_1_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_1_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_1_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_1_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_1_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_1_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_1_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_1_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_1 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_1 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_1 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_1_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_1_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_1_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_1_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_1_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_1_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_1 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_1_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_1_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_1_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_1_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_1 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_1 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_2_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_2_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_2_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_2_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_2_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_2_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_2_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_2_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_2_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_2_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_2_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_2_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_2 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_2 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_2 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_2_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_2_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_2_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_2_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_2_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_2_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_2 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_2_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_2_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_2_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_2_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_2 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_2 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_3_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_3_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_3_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_3_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_3_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_3_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_3_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_3_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_3_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_3_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_3_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_3_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_3 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_3 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_3 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_3_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_3_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_3_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_3_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_3_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_3_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_3 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_3_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_3_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_3_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_3_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_3 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_3 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_4_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_4_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_4_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_4_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_4_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_4_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_4_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_4_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_4_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_4_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_4_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_4_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_4 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_4 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_4 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_4_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_4_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_4_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_4_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_4_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_4_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_4 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_4_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_4_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_4_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_4_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_4 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_4 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_5_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_5_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_5_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_5_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_5_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_5_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_5_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_5_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_5_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_5_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_5_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_5_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_5 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_5 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_5 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_5_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_5_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_5_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_5_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_5_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_5_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_5 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_5_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_5_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_5_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_5_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_5 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_5 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_6_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_6_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_6_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_6_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_6_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_6_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_6_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_6_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_6_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_6_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_6_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_6_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_6 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_6 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_6 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_6_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_6_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_6_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_6_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_6_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_6_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_6 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_6_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_6_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_6_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_6_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_6 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_6 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_7_tp0 [label="QKV Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_7_tp1 [label="QKV Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_7_tp2 [label="QKV Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_7_tp3 [label="QKV Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_7_tp0 [label="Attention Computation\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_7_tp1 [label="Attention Computation\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_7_tp2 [label="Attention Computation\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_7_tp3 [label="Attention Computation\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_7_tp0 [label="Attention Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_7_tp1 [label="Attention Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_7_tp2 [label="Attention Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_7_tp3 [label="Attention Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_7 [label="All-Reduce Attention\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_7 [label="Gate Network\nGPU: 0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_7 [label="Expert Selection\nGPU: 0\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_7_ep0_exp0 [label="Expert 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep0_exp1 [label="Expert 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep0_exp2 [label="Expert 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep0_exp3 [label="Expert 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep1_exp0 [label="Expert 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep1_exp1 [label="Expert 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep1_exp2 [label="Expert 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep1_exp3 [label="Expert 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep2_exp0 [label="Expert 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep2_exp1 [label="Expert 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep2_exp2 [label="Expert 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep2_exp3 [label="Expert 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep3_exp0 [label="Expert 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep3_exp1 [label="Expert 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep3_exp2 [label="Expert 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep3_exp3 [label="Expert 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep4_exp0 [label="Expert 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep4_exp1 [label="Expert 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep4_exp2 [label="Expert 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep4_exp3 [label="Expert 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep5_exp0 [label="Expert 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep5_exp1 [label="Expert 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep5_exp2 [label="Expert 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep5_exp3 [label="Expert 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep6_exp0 [label="Expert 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep6_exp1 [label="Expert 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep6_exp2 [label="Expert 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep6_exp3 [label="Expert 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep7_exp0 [label="Expert 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep7_exp1 [label="Expert 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep7_exp2 [label="Expert 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep7_exp3 [label="Expert 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep8_exp0 [label="Expert 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep8_exp1 [label="Expert 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep8_exp2 [label="Expert 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep8_exp3 [label="Expert 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep9_exp0 [label="Expert 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep9_exp1 [label="Expert 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep9_exp2 [label="Expert 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep9_exp3 [label="Expert 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep10_exp0 [label="Expert 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep10_exp1 [label="Expert 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep10_exp2 [label="Expert 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep10_exp3 [label="Expert 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep11_exp0 [label="Expert 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep11_exp1 [label="Expert 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep11_exp2 [label="Expert 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep11_exp3 [label="Expert 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep12_exp0 [label="Expert 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep12_exp1 [label="Expert 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep12_exp2 [label="Expert 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep12_exp3 [label="Expert 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep13_exp0 [label="Expert 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep13_exp1 [label="Expert 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep13_exp2 [label="Expert 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep13_exp3 [label="Expert 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep14_exp0 [label="Expert 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep14_exp1 [label="Expert 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep14_exp2 [label="Expert 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep14_exp3 [label="Expert 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep15_exp0 [label="Expert 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep15_exp1 [label="Expert 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep15_exp2 [label="Expert 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_7_ep15_exp3 [label="Expert 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_7_ep0 [label="Token Routing EP0\nGPU: 0-3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep1 [label="Token Routing EP1\nGPU: 4-7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep2 [label="Token Routing EP2\nGPU: 8-11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep3 [label="Token Routing EP3\nGPU: 12-15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep4 [label="Token Routing EP4\nGPU: 16-19\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep5 [label="Token Routing EP5\nGPU: 20-23\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep6 [label="Token Routing EP6\nGPU: 24-27\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep7 [label="Token Routing EP7\nGPU: 28-31\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep8 [label="Token Routing EP8\nGPU: 32-35\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep9 [label="Token Routing EP9\nGPU: 36-39\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep10 [label="Token Routing EP10\nGPU: 40-43\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep11 [label="Token Routing EP11\nGPU: 44-47\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep12 [label="Token Routing EP12\nGPU: 48-51\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep13 [label="Token Routing EP13\nGPU: 52-55\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep14 [label="Token Routing EP14\nGPU: 56-59\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_7_ep15 [label="Token Routing EP15\nGPU: 60-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_7_ep0_exp0 [label="Expert FFN 0\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep0_exp1 [label="Expert FFN 1\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep0_exp2 [label="Expert FFN 2\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep0_exp3 [label="Expert FFN 3\nGPU: 0\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep1_exp0 [label="Expert FFN 4\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep1_exp1 [label="Expert FFN 5\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep1_exp2 [label="Expert FFN 6\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep1_exp3 [label="Expert FFN 7\nGPU: 4\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep2_exp0 [label="Expert FFN 8\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep2_exp1 [label="Expert FFN 9\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep2_exp2 [label="Expert FFN 10\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep2_exp3 [label="Expert FFN 11\nGPU: 8\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep3_exp0 [label="Expert FFN 12\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep3_exp1 [label="Expert FFN 13\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep3_exp2 [label="Expert FFN 14\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep3_exp3 [label="Expert FFN 15\nGPU: 12\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep4_exp0 [label="Expert FFN 16\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep4_exp1 [label="Expert FFN 17\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep4_exp2 [label="Expert FFN 18\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep4_exp3 [label="Expert FFN 19\nGPU: 16\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep5_exp0 [label="Expert FFN 20\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep5_exp1 [label="Expert FFN 21\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep5_exp2 [label="Expert FFN 22\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep5_exp3 [label="Expert FFN 23\nGPU: 20\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep6_exp0 [label="Expert FFN 24\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep6_exp1 [label="Expert FFN 25\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep6_exp2 [label="Expert FFN 26\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep6_exp3 [label="Expert FFN 27\nGPU: 24\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep7_exp0 [label="Expert FFN 28\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep7_exp1 [label="Expert FFN 29\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep7_exp2 [label="Expert FFN 30\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep7_exp3 [label="Expert FFN 31\nGPU: 28\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep8_exp0 [label="Expert FFN 32\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep8_exp1 [label="Expert FFN 33\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep8_exp2 [label="Expert FFN 34\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep8_exp3 [label="Expert FFN 35\nGPU: 32\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep9_exp0 [label="Expert FFN 36\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep9_exp1 [label="Expert FFN 37\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep9_exp2 [label="Expert FFN 38\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep9_exp3 [label="Expert FFN 39\nGPU: 36\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep10_exp0 [label="Expert FFN 40\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep10_exp1 [label="Expert FFN 41\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep10_exp2 [label="Expert FFN 42\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep10_exp3 [label="Expert FFN 43\nGPU: 40\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep11_exp0 [label="Expert FFN 44\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep11_exp1 [label="Expert FFN 45\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep11_exp2 [label="Expert FFN 46\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep11_exp3 [label="Expert FFN 47\nGPU: 44\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep12_exp0 [label="Expert FFN 48\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep12_exp1 [label="Expert FFN 49\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep12_exp2 [label="Expert FFN 50\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep12_exp3 [label="Expert FFN 51\nGPU: 48\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep13_exp0 [label="Expert FFN 52\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep13_exp1 [label="Expert FFN 53\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep13_exp2 [label="Expert FFN 54\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep13_exp3 [label="Expert FFN 55\nGPU: 52\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep14_exp0 [label="Expert FFN 56\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep14_exp1 [label="Expert FFN 57\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep14_exp2 [label="Expert FFN 58\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep14_exp3 [label="Expert FFN 59\nGPU: 56\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep15_exp0 [label="Expert FFN 60\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep15_exp1 [label="Expert FFN 61\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep15_exp2 [label="Expert FFN 62\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_7_ep15_exp3 [label="Expert FFN 63\nGPU: 60\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_7 [label="Expert Output Aggregation\nGPU: 0-63\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_7_tp0 [label="MoE Output Linear\nGPU: 0\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_7_tp1 [label="MoE Output Linear\nGPU: 1\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_7_tp2 [label="MoE Output Linear\nGPU: 2\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_7_tp3 [label="MoE Output Linear\nGPU: 3\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_7 [label="All-Reduce MoE\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_7 [label="Layer Normalization\nGPU: 0-63\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_8_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_8_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_8_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_8_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_8_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_8_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_8_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_8_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_8_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_8_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_8_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_8_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_8 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_8 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_8 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_8_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_8_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_8_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_8_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_8_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_8_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_8 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_8_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_8_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_8_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_8_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_8 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_8 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_9_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_9_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_9_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_9_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_9_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_9_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_9_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_9_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_9_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_9_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_9_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_9_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_9 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_9 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_9 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_9_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_9_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_9_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_9_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_9_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_9_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_9 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_9_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_9_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_9_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_9_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_9 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_9 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_10_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_10_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_10_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_10_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_10_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_10_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_10_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_10_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_10_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_10_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_10_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_10_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_10 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_10 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_10 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_10_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_10_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_10_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_10_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_10_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_10_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_10 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_10_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_10_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_10_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_10_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_10 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_10 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_11_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_11_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_11_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_11_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_11_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_11_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_11_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_11_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_11_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_11_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_11_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_11_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_11 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_11 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_11 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_11_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_11_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_11_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_11_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_11_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_11_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_11 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_11_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_11_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_11_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_11_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_11 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_11 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_12_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_12_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_12_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_12_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_12_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_12_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_12_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_12_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_12_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_12_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_12_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_12_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_12 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_12 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_12 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_12_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_12_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_12_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_12_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_12_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_12_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_12 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_12_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_12_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_12_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_12_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_12 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_12 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_13_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_13_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_13_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_13_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_13_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_13_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_13_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_13_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_13_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_13_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_13_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_13_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_13 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_13 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_13 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_13_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_13_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_13_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_13_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_13_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_13_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_13 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_13_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_13_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_13_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_13_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_13 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_13 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_14_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_14_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_14_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_14_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_14_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_14_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_14_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_14_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_14_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_14_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_14_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_14_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_14 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_14 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_14 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_14_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_14_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_14_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_14_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_14_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_14_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_14 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_14_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_14_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_14_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_14_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_14 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_14 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_15_tp0 [label="QKV Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_15_tp1 [label="QKV Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_15_tp2 [label="QKV Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	qkv_linear_15_tp3 [label="QKV Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_15_tp0 [label="Attention Computation\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_15_tp1 [label="Attention Computation\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_15_tp2 [label="Attention Computation\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	attention_15_tp3 [label="Attention Computation\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, heads=32, d_k=32]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_15_tp0 [label="Attention Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_15_tp1 [label="Attention Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_15_tp2 [label="Attention Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	att_out_linear_15_tp3 [label="Attention Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, heads=32, d_k=32]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_att_15 [label="All-Reduce Attention\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	gate_15 [label="Gate Network\nGPU: 64\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, experts=64]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_select_15 [label="Expert Selection\nGPU: 64\nInput: [batch=128, seq=1024, experts=64]\nOutput: [batch=128, seq=1024, selected_experts=8]" fillcolor=lightyellow shape=parallelogram style=filled]
	expert_15_ep0_exp0 [label="Expert 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep0_exp1 [label="Expert 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep0_exp2 [label="Expert 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep0_exp3 [label="Expert 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep1_exp0 [label="Expert 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep1_exp1 [label="Expert 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep1_exp2 [label="Expert 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep1_exp3 [label="Expert 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep2_exp0 [label="Expert 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep2_exp1 [label="Expert 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep2_exp2 [label="Expert 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep2_exp3 [label="Expert 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep3_exp0 [label="Expert 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep3_exp1 [label="Expert 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep3_exp2 [label="Expert 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep3_exp3 [label="Expert 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep4_exp0 [label="Expert 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep4_exp1 [label="Expert 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep4_exp2 [label="Expert 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep4_exp3 [label="Expert 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep5_exp0 [label="Expert 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep5_exp1 [label="Expert 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep5_exp2 [label="Expert 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep5_exp3 [label="Expert 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep6_exp0 [label="Expert 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep6_exp1 [label="Expert 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep6_exp2 [label="Expert 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep6_exp3 [label="Expert 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep7_exp0 [label="Expert 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep7_exp1 [label="Expert 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep7_exp2 [label="Expert 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep7_exp3 [label="Expert 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep8_exp0 [label="Expert 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep8_exp1 [label="Expert 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep8_exp2 [label="Expert 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep8_exp3 [label="Expert 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep9_exp0 [label="Expert 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep9_exp1 [label="Expert 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep9_exp2 [label="Expert 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep9_exp3 [label="Expert 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep10_exp0 [label="Expert 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep10_exp1 [label="Expert 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep10_exp2 [label="Expert 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep10_exp3 [label="Expert 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep11_exp0 [label="Expert 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep11_exp1 [label="Expert 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep11_exp2 [label="Expert 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep11_exp3 [label="Expert 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep12_exp0 [label="Expert 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep12_exp1 [label="Expert 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep12_exp2 [label="Expert 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep12_exp3 [label="Expert 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep13_exp0 [label="Expert 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep13_exp1 [label="Expert 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep13_exp2 [label="Expert 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep13_exp3 [label="Expert 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep14_exp0 [label="Expert 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep14_exp1 [label="Expert 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep14_exp2 [label="Expert 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep14_exp3 [label="Expert 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep15_exp0 [label="Expert 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep15_exp1 [label="Expert 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep15_exp2 [label="Expert 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_15_ep15_exp3 [label="Expert 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	token_route_15_ep0 [label="Token Routing EP0\nGPU: 64-67\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep1 [label="Token Routing EP1\nGPU: 68-71\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep2 [label="Token Routing EP2\nGPU: 72-75\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep3 [label="Token Routing EP3\nGPU: 76-79\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep4 [label="Token Routing EP4\nGPU: 80-83\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep5 [label="Token Routing EP5\nGPU: 84-87\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep6 [label="Token Routing EP6\nGPU: 88-91\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep7 [label="Token Routing EP7\nGPU: 92-95\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep8 [label="Token Routing EP8\nGPU: 96-99\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep9 [label="Token Routing EP9\nGPU: 100-103\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep10 [label="Token Routing EP10\nGPU: 104-107\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep11 [label="Token Routing EP11\nGPU: 108-111\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep12 [label="Token Routing EP12\nGPU: 112-115\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep13 [label="Token Routing EP13\nGPU: 116-119\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep14 [label="Token Routing EP14\nGPU: 120-123\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	token_route_15_ep15 [label="Token Routing EP15\nGPU: 124-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	expert_comp_15_ep0_exp0 [label="Expert FFN 0\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep0_exp1 [label="Expert FFN 1\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep0_exp2 [label="Expert FFN 2\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep0_exp3 [label="Expert FFN 3\nGPU: 64\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep1_exp0 [label="Expert FFN 4\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep1_exp1 [label="Expert FFN 5\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep1_exp2 [label="Expert FFN 6\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep1_exp3 [label="Expert FFN 7\nGPU: 68\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep2_exp0 [label="Expert FFN 8\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep2_exp1 [label="Expert FFN 9\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep2_exp2 [label="Expert FFN 10\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep2_exp3 [label="Expert FFN 11\nGPU: 72\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep3_exp0 [label="Expert FFN 12\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep3_exp1 [label="Expert FFN 13\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep3_exp2 [label="Expert FFN 14\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep3_exp3 [label="Expert FFN 15\nGPU: 76\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep4_exp0 [label="Expert FFN 16\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep4_exp1 [label="Expert FFN 17\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep4_exp2 [label="Expert FFN 18\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep4_exp3 [label="Expert FFN 19\nGPU: 80\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep5_exp0 [label="Expert FFN 20\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep5_exp1 [label="Expert FFN 21\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep5_exp2 [label="Expert FFN 22\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep5_exp3 [label="Expert FFN 23\nGPU: 84\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep6_exp0 [label="Expert FFN 24\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep6_exp1 [label="Expert FFN 25\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep6_exp2 [label="Expert FFN 26\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep6_exp3 [label="Expert FFN 27\nGPU: 88\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep7_exp0 [label="Expert FFN 28\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep7_exp1 [label="Expert FFN 29\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep7_exp2 [label="Expert FFN 30\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep7_exp3 [label="Expert FFN 31\nGPU: 92\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep8_exp0 [label="Expert FFN 32\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep8_exp1 [label="Expert FFN 33\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep8_exp2 [label="Expert FFN 34\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep8_exp3 [label="Expert FFN 35\nGPU: 96\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep9_exp0 [label="Expert FFN 36\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep9_exp1 [label="Expert FFN 37\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep9_exp2 [label="Expert FFN 38\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep9_exp3 [label="Expert FFN 39\nGPU: 100\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep10_exp0 [label="Expert FFN 40\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep10_exp1 [label="Expert FFN 41\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep10_exp2 [label="Expert FFN 42\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep10_exp3 [label="Expert FFN 43\nGPU: 104\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep11_exp0 [label="Expert FFN 44\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep11_exp1 [label="Expert FFN 45\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep11_exp2 [label="Expert FFN 46\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep11_exp3 [label="Expert FFN 47\nGPU: 108\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep12_exp0 [label="Expert FFN 48\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep12_exp1 [label="Expert FFN 49\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep12_exp2 [label="Expert FFN 50\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep12_exp3 [label="Expert FFN 51\nGPU: 112\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep13_exp0 [label="Expert FFN 52\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep13_exp1 [label="Expert FFN 53\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep13_exp2 [label="Expert FFN 54\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep13_exp3 [label="Expert FFN 55\nGPU: 116\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep14_exp0 [label="Expert FFN 56\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep14_exp1 [label="Expert FFN 57\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep14_exp2 [label="Expert FFN 58\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep14_exp3 [label="Expert FFN 59\nGPU: 120\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep15_exp0 [label="Expert FFN 60\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep15_exp1 [label="Expert FFN 61\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep15_exp2 [label="Expert FFN 62\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_comp_15_ep15_exp3 [label="Expert FFN 63\nGPU: 124\nInput: [batch=16, seq=1024, hidden=1024]\nOutput: [batch=16, seq=1024, hidden=2048]" fillcolor=lightblue shape=rectangle style=filled]
	expert_agg_15 [label="Expert Output Aggregation\nGPU: 64-127\nInput: [batch=16, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=2048]" fillcolor=lightyellow shape=parallelogram style=filled]
	moe_out_linear_15_tp0 [label="MoE Output Linear\nGPU: 64\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_15_tp1 [label="MoE Output Linear\nGPU: 65\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_15_tp2 [label="MoE Output Linear\nGPU: 66\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	moe_out_linear_15_tp3 [label="MoE Output Linear\nGPU: 67\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	allreduce_moe_15 [label="All-Reduce MoE\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightgreen shape=ellipse style=filled]
	layernorm_15 [label="Layer Normalization\nGPU: 64-127\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]" fillcolor=lightblue shape=rectangle style=filled]
	output [label="Output Layer\nGPU: 0-127\nInput: [batch_size=128, seq_len=1024, hidden=1024]\nOutput: [batch_size=128, seq_len=1024, vocab_size=50000]" fillcolor=lightblue shape=rectangle style=filled]
	input -> qkv_linear_0_tp0 [style=solid]
	qkv_linear_0_tp0 -> attention_0_tp0
	attention_0_tp0 -> att_out_linear_0_tp0
	att_out_linear_0_tp0 -> allreduce_att_0
	qkv_linear_0_tp1 -> attention_0_tp1
	attention_0_tp1 -> att_out_linear_0_tp1
	att_out_linear_0_tp1 -> allreduce_att_0
	qkv_linear_0_tp2 -> attention_0_tp2
	attention_0_tp2 -> att_out_linear_0_tp2
	att_out_linear_0_tp2 -> allreduce_att_0
	qkv_linear_0_tp3 -> attention_0_tp3
	attention_0_tp3 -> att_out_linear_0_tp3
	att_out_linear_0_tp3 -> allreduce_att_0
	qkv_linear_1_tp0 -> attention_1_tp0
	attention_1_tp0 -> att_out_linear_1_tp0
	att_out_linear_1_tp0 -> allreduce_att_1
	qkv_linear_1_tp1 -> attention_1_tp1
	attention_1_tp1 -> att_out_linear_1_tp1
	att_out_linear_1_tp1 -> allreduce_att_1
	qkv_linear_1_tp2 -> attention_1_tp2
	attention_1_tp2 -> att_out_linear_1_tp2
	att_out_linear_1_tp2 -> allreduce_att_1
	qkv_linear_1_tp3 -> attention_1_tp3
	attention_1_tp3 -> att_out_linear_1_tp3
	att_out_linear_1_tp3 -> allreduce_att_1
	qkv_linear_2_tp0 -> attention_2_tp0
	attention_2_tp0 -> att_out_linear_2_tp0
	att_out_linear_2_tp0 -> allreduce_att_2
	qkv_linear_2_tp1 -> attention_2_tp1
	attention_2_tp1 -> att_out_linear_2_tp1
	att_out_linear_2_tp1 -> allreduce_att_2
	qkv_linear_2_tp2 -> attention_2_tp2
	attention_2_tp2 -> att_out_linear_2_tp2
	att_out_linear_2_tp2 -> allreduce_att_2
	qkv_linear_2_tp3 -> attention_2_tp3
	attention_2_tp3 -> att_out_linear_2_tp3
	att_out_linear_2_tp3 -> allreduce_att_2
	qkv_linear_3_tp0 -> attention_3_tp0
	attention_3_tp0 -> att_out_linear_3_tp0
	att_out_linear_3_tp0 -> allreduce_att_3
	qkv_linear_3_tp1 -> attention_3_tp1
	attention_3_tp1 -> att_out_linear_3_tp1
	att_out_linear_3_tp1 -> allreduce_att_3
	qkv_linear_3_tp2 -> attention_3_tp2
	attention_3_tp2 -> att_out_linear_3_tp2
	att_out_linear_3_tp2 -> allreduce_att_3
	qkv_linear_3_tp3 -> attention_3_tp3
	attention_3_tp3 -> att_out_linear_3_tp3
	att_out_linear_3_tp3 -> allreduce_att_3
	qkv_linear_4_tp0 -> attention_4_tp0
	attention_4_tp0 -> att_out_linear_4_tp0
	att_out_linear_4_tp0 -> allreduce_att_4
	qkv_linear_4_tp1 -> attention_4_tp1
	attention_4_tp1 -> att_out_linear_4_tp1
	att_out_linear_4_tp1 -> allreduce_att_4
	qkv_linear_4_tp2 -> attention_4_tp2
	attention_4_tp2 -> att_out_linear_4_tp2
	att_out_linear_4_tp2 -> allreduce_att_4
	qkv_linear_4_tp3 -> attention_4_tp3
	attention_4_tp3 -> att_out_linear_4_tp3
	att_out_linear_4_tp3 -> allreduce_att_4
	qkv_linear_5_tp0 -> attention_5_tp0
	attention_5_tp0 -> att_out_linear_5_tp0
	att_out_linear_5_tp0 -> allreduce_att_5
	qkv_linear_5_tp1 -> attention_5_tp1
	attention_5_tp1 -> att_out_linear_5_tp1
	att_out_linear_5_tp1 -> allreduce_att_5
	qkv_linear_5_tp2 -> attention_5_tp2
	attention_5_tp2 -> att_out_linear_5_tp2
	att_out_linear_5_tp2 -> allreduce_att_5
	qkv_linear_5_tp3 -> attention_5_tp3
	attention_5_tp3 -> att_out_linear_5_tp3
	att_out_linear_5_tp3 -> allreduce_att_5
	qkv_linear_6_tp0 -> attention_6_tp0
	attention_6_tp0 -> att_out_linear_6_tp0
	att_out_linear_6_tp0 -> allreduce_att_6
	qkv_linear_6_tp1 -> attention_6_tp1
	attention_6_tp1 -> att_out_linear_6_tp1
	att_out_linear_6_tp1 -> allreduce_att_6
	qkv_linear_6_tp2 -> attention_6_tp2
	attention_6_tp2 -> att_out_linear_6_tp2
	att_out_linear_6_tp2 -> allreduce_att_6
	qkv_linear_6_tp3 -> attention_6_tp3
	attention_6_tp3 -> att_out_linear_6_tp3
	att_out_linear_6_tp3 -> allreduce_att_6
	qkv_linear_7_tp0 -> attention_7_tp0
	attention_7_tp0 -> att_out_linear_7_tp0
	att_out_linear_7_tp0 -> allreduce_att_7
	qkv_linear_7_tp1 -> attention_7_tp1
	attention_7_tp1 -> att_out_linear_7_tp1
	att_out_linear_7_tp1 -> allreduce_att_7
	qkv_linear_7_tp2 -> attention_7_tp2
	attention_7_tp2 -> att_out_linear_7_tp2
	att_out_linear_7_tp2 -> allreduce_att_7
	qkv_linear_7_tp3 -> attention_7_tp3
	attention_7_tp3 -> att_out_linear_7_tp3
	att_out_linear_7_tp3 -> allreduce_att_7
	qkv_linear_8_tp0 -> attention_8_tp0
	attention_8_tp0 -> att_out_linear_8_tp0
	att_out_linear_8_tp0 -> allreduce_att_8
	qkv_linear_8_tp1 -> attention_8_tp1
	attention_8_tp1 -> att_out_linear_8_tp1
	att_out_linear_8_tp1 -> allreduce_att_8
	qkv_linear_8_tp2 -> attention_8_tp2
	attention_8_tp2 -> att_out_linear_8_tp2
	att_out_linear_8_tp2 -> allreduce_att_8
	qkv_linear_8_tp3 -> attention_8_tp3
	attention_8_tp3 -> att_out_linear_8_tp3
	att_out_linear_8_tp3 -> allreduce_att_8
	qkv_linear_9_tp0 -> attention_9_tp0
	attention_9_tp0 -> att_out_linear_9_tp0
	att_out_linear_9_tp0 -> allreduce_att_9
	qkv_linear_9_tp1 -> attention_9_tp1
	attention_9_tp1 -> att_out_linear_9_tp1
	att_out_linear_9_tp1 -> allreduce_att_9
	qkv_linear_9_tp2 -> attention_9_tp2
	attention_9_tp2 -> att_out_linear_9_tp2
	att_out_linear_9_tp2 -> allreduce_att_9
	qkv_linear_9_tp3 -> attention_9_tp3
	attention_9_tp3 -> att_out_linear_9_tp3
	att_out_linear_9_tp3 -> allreduce_att_9
	qkv_linear_10_tp0 -> attention_10_tp0
	attention_10_tp0 -> att_out_linear_10_tp0
	att_out_linear_10_tp0 -> allreduce_att_10
	qkv_linear_10_tp1 -> attention_10_tp1
	attention_10_tp1 -> att_out_linear_10_tp1
	att_out_linear_10_tp1 -> allreduce_att_10
	qkv_linear_10_tp2 -> attention_10_tp2
	attention_10_tp2 -> att_out_linear_10_tp2
	att_out_linear_10_tp2 -> allreduce_att_10
	qkv_linear_10_tp3 -> attention_10_tp3
	attention_10_tp3 -> att_out_linear_10_tp3
	att_out_linear_10_tp3 -> allreduce_att_10
	qkv_linear_11_tp0 -> attention_11_tp0
	attention_11_tp0 -> att_out_linear_11_tp0
	att_out_linear_11_tp0 -> allreduce_att_11
	qkv_linear_11_tp1 -> attention_11_tp1
	attention_11_tp1 -> att_out_linear_11_tp1
	att_out_linear_11_tp1 -> allreduce_att_11
	qkv_linear_11_tp2 -> attention_11_tp2
	attention_11_tp2 -> att_out_linear_11_tp2
	att_out_linear_11_tp2 -> allreduce_att_11
	qkv_linear_11_tp3 -> attention_11_tp3
	attention_11_tp3 -> att_out_linear_11_tp3
	att_out_linear_11_tp3 -> allreduce_att_11
	qkv_linear_12_tp0 -> attention_12_tp0
	attention_12_tp0 -> att_out_linear_12_tp0
	att_out_linear_12_tp0 -> allreduce_att_12
	qkv_linear_12_tp1 -> attention_12_tp1
	attention_12_tp1 -> att_out_linear_12_tp1
	att_out_linear_12_tp1 -> allreduce_att_12
	qkv_linear_12_tp2 -> attention_12_tp2
	attention_12_tp2 -> att_out_linear_12_tp2
	att_out_linear_12_tp2 -> allreduce_att_12
	qkv_linear_12_tp3 -> attention_12_tp3
	attention_12_tp3 -> att_out_linear_12_tp3
	att_out_linear_12_tp3 -> allreduce_att_12
	qkv_linear_13_tp0 -> attention_13_tp0
	attention_13_tp0 -> att_out_linear_13_tp0
	att_out_linear_13_tp0 -> allreduce_att_13
	qkv_linear_13_tp1 -> attention_13_tp1
	attention_13_tp1 -> att_out_linear_13_tp1
	att_out_linear_13_tp1 -> allreduce_att_13
	qkv_linear_13_tp2 -> attention_13_tp2
	attention_13_tp2 -> att_out_linear_13_tp2
	att_out_linear_13_tp2 -> allreduce_att_13
	qkv_linear_13_tp3 -> attention_13_tp3
	attention_13_tp3 -> att_out_linear_13_tp3
	att_out_linear_13_tp3 -> allreduce_att_13
	qkv_linear_14_tp0 -> attention_14_tp0
	attention_14_tp0 -> att_out_linear_14_tp0
	att_out_linear_14_tp0 -> allreduce_att_14
	qkv_linear_14_tp1 -> attention_14_tp1
	attention_14_tp1 -> att_out_linear_14_tp1
	att_out_linear_14_tp1 -> allreduce_att_14
	qkv_linear_14_tp2 -> attention_14_tp2
	attention_14_tp2 -> att_out_linear_14_tp2
	att_out_linear_14_tp2 -> allreduce_att_14
	qkv_linear_14_tp3 -> attention_14_tp3
	attention_14_tp3 -> att_out_linear_14_tp3
	att_out_linear_14_tp3 -> allreduce_att_14
	qkv_linear_15_tp0 -> attention_15_tp0
	attention_15_tp0 -> att_out_linear_15_tp0
	att_out_linear_15_tp0 -> allreduce_att_15
	qkv_linear_15_tp1 -> attention_15_tp1
	attention_15_tp1 -> att_out_linear_15_tp1
	att_out_linear_15_tp1 -> allreduce_att_15
	qkv_linear_15_tp2 -> attention_15_tp2
	attention_15_tp2 -> att_out_linear_15_tp2
	att_out_linear_15_tp2 -> allreduce_att_15
	qkv_linear_15_tp3 -> attention_15_tp3
	attention_15_tp3 -> att_out_linear_15_tp3
	att_out_linear_15_tp3 -> allreduce_att_15
	allreduce_att_0 -> gate_0 [style=dashed]
	gate_0 -> expert_select_0
	expert_select_0 -> token_route_0_ep0
	token_route_0_ep0 -> expert_0_ep0_exp0
	expert_0_ep0_exp0 -> expert_comp_0_ep0_exp0
	expert_comp_0_ep0_exp0 -> expert_agg_0
	token_route_0_ep0 -> expert_0_ep0_exp1
	expert_0_ep0_exp1 -> expert_comp_0_ep0_exp1
	expert_comp_0_ep0_exp1 -> expert_agg_0
	token_route_0_ep0 -> expert_0_ep0_exp2
	expert_0_ep0_exp2 -> expert_comp_0_ep0_exp2
	expert_comp_0_ep0_exp2 -> expert_agg_0
	token_route_0_ep0 -> expert_0_ep0_exp3
	expert_0_ep0_exp3 -> expert_comp_0_ep0_exp3
	expert_comp_0_ep0_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep1
	token_route_0_ep1 -> expert_0_ep1_exp0
	expert_0_ep1_exp0 -> expert_comp_0_ep1_exp0
	expert_comp_0_ep1_exp0 -> expert_agg_0
	token_route_0_ep1 -> expert_0_ep1_exp1
	expert_0_ep1_exp1 -> expert_comp_0_ep1_exp1
	expert_comp_0_ep1_exp1 -> expert_agg_0
	token_route_0_ep1 -> expert_0_ep1_exp2
	expert_0_ep1_exp2 -> expert_comp_0_ep1_exp2
	expert_comp_0_ep1_exp2 -> expert_agg_0
	token_route_0_ep1 -> expert_0_ep1_exp3
	expert_0_ep1_exp3 -> expert_comp_0_ep1_exp3
	expert_comp_0_ep1_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep2
	token_route_0_ep2 -> expert_0_ep2_exp0
	expert_0_ep2_exp0 -> expert_comp_0_ep2_exp0
	expert_comp_0_ep2_exp0 -> expert_agg_0
	token_route_0_ep2 -> expert_0_ep2_exp1
	expert_0_ep2_exp1 -> expert_comp_0_ep2_exp1
	expert_comp_0_ep2_exp1 -> expert_agg_0
	token_route_0_ep2 -> expert_0_ep2_exp2
	expert_0_ep2_exp2 -> expert_comp_0_ep2_exp2
	expert_comp_0_ep2_exp2 -> expert_agg_0
	token_route_0_ep2 -> expert_0_ep2_exp3
	expert_0_ep2_exp3 -> expert_comp_0_ep2_exp3
	expert_comp_0_ep2_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep3
	token_route_0_ep3 -> expert_0_ep3_exp0
	expert_0_ep3_exp0 -> expert_comp_0_ep3_exp0
	expert_comp_0_ep3_exp0 -> expert_agg_0
	token_route_0_ep3 -> expert_0_ep3_exp1
	expert_0_ep3_exp1 -> expert_comp_0_ep3_exp1
	expert_comp_0_ep3_exp1 -> expert_agg_0
	token_route_0_ep3 -> expert_0_ep3_exp2
	expert_0_ep3_exp2 -> expert_comp_0_ep3_exp2
	expert_comp_0_ep3_exp2 -> expert_agg_0
	token_route_0_ep3 -> expert_0_ep3_exp3
	expert_0_ep3_exp3 -> expert_comp_0_ep3_exp3
	expert_comp_0_ep3_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep4
	token_route_0_ep4 -> expert_0_ep4_exp0
	expert_0_ep4_exp0 -> expert_comp_0_ep4_exp0
	expert_comp_0_ep4_exp0 -> expert_agg_0
	token_route_0_ep4 -> expert_0_ep4_exp1
	expert_0_ep4_exp1 -> expert_comp_0_ep4_exp1
	expert_comp_0_ep4_exp1 -> expert_agg_0
	token_route_0_ep4 -> expert_0_ep4_exp2
	expert_0_ep4_exp2 -> expert_comp_0_ep4_exp2
	expert_comp_0_ep4_exp2 -> expert_agg_0
	token_route_0_ep4 -> expert_0_ep4_exp3
	expert_0_ep4_exp3 -> expert_comp_0_ep4_exp3
	expert_comp_0_ep4_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep5
	token_route_0_ep5 -> expert_0_ep5_exp0
	expert_0_ep5_exp0 -> expert_comp_0_ep5_exp0
	expert_comp_0_ep5_exp0 -> expert_agg_0
	token_route_0_ep5 -> expert_0_ep5_exp1
	expert_0_ep5_exp1 -> expert_comp_0_ep5_exp1
	expert_comp_0_ep5_exp1 -> expert_agg_0
	token_route_0_ep5 -> expert_0_ep5_exp2
	expert_0_ep5_exp2 -> expert_comp_0_ep5_exp2
	expert_comp_0_ep5_exp2 -> expert_agg_0
	token_route_0_ep5 -> expert_0_ep5_exp3
	expert_0_ep5_exp3 -> expert_comp_0_ep5_exp3
	expert_comp_0_ep5_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep6
	token_route_0_ep6 -> expert_0_ep6_exp0
	expert_0_ep6_exp0 -> expert_comp_0_ep6_exp0
	expert_comp_0_ep6_exp0 -> expert_agg_0
	token_route_0_ep6 -> expert_0_ep6_exp1
	expert_0_ep6_exp1 -> expert_comp_0_ep6_exp1
	expert_comp_0_ep6_exp1 -> expert_agg_0
	token_route_0_ep6 -> expert_0_ep6_exp2
	expert_0_ep6_exp2 -> expert_comp_0_ep6_exp2
	expert_comp_0_ep6_exp2 -> expert_agg_0
	token_route_0_ep6 -> expert_0_ep6_exp3
	expert_0_ep6_exp3 -> expert_comp_0_ep6_exp3
	expert_comp_0_ep6_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep7
	token_route_0_ep7 -> expert_0_ep7_exp0
	expert_0_ep7_exp0 -> expert_comp_0_ep7_exp0
	expert_comp_0_ep7_exp0 -> expert_agg_0
	token_route_0_ep7 -> expert_0_ep7_exp1
	expert_0_ep7_exp1 -> expert_comp_0_ep7_exp1
	expert_comp_0_ep7_exp1 -> expert_agg_0
	token_route_0_ep7 -> expert_0_ep7_exp2
	expert_0_ep7_exp2 -> expert_comp_0_ep7_exp2
	expert_comp_0_ep7_exp2 -> expert_agg_0
	token_route_0_ep7 -> expert_0_ep7_exp3
	expert_0_ep7_exp3 -> expert_comp_0_ep7_exp3
	expert_comp_0_ep7_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep8
	token_route_0_ep8 -> expert_0_ep8_exp0
	expert_0_ep8_exp0 -> expert_comp_0_ep8_exp0
	expert_comp_0_ep8_exp0 -> expert_agg_0
	token_route_0_ep8 -> expert_0_ep8_exp1
	expert_0_ep8_exp1 -> expert_comp_0_ep8_exp1
	expert_comp_0_ep8_exp1 -> expert_agg_0
	token_route_0_ep8 -> expert_0_ep8_exp2
	expert_0_ep8_exp2 -> expert_comp_0_ep8_exp2
	expert_comp_0_ep8_exp2 -> expert_agg_0
	token_route_0_ep8 -> expert_0_ep8_exp3
	expert_0_ep8_exp3 -> expert_comp_0_ep8_exp3
	expert_comp_0_ep8_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep9
	token_route_0_ep9 -> expert_0_ep9_exp0
	expert_0_ep9_exp0 -> expert_comp_0_ep9_exp0
	expert_comp_0_ep9_exp0 -> expert_agg_0
	token_route_0_ep9 -> expert_0_ep9_exp1
	expert_0_ep9_exp1 -> expert_comp_0_ep9_exp1
	expert_comp_0_ep9_exp1 -> expert_agg_0
	token_route_0_ep9 -> expert_0_ep9_exp2
	expert_0_ep9_exp2 -> expert_comp_0_ep9_exp2
	expert_comp_0_ep9_exp2 -> expert_agg_0
	token_route_0_ep9 -> expert_0_ep9_exp3
	expert_0_ep9_exp3 -> expert_comp_0_ep9_exp3
	expert_comp_0_ep9_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep10
	token_route_0_ep10 -> expert_0_ep10_exp0
	expert_0_ep10_exp0 -> expert_comp_0_ep10_exp0
	expert_comp_0_ep10_exp0 -> expert_agg_0
	token_route_0_ep10 -> expert_0_ep10_exp1
	expert_0_ep10_exp1 -> expert_comp_0_ep10_exp1
	expert_comp_0_ep10_exp1 -> expert_agg_0
	token_route_0_ep10 -> expert_0_ep10_exp2
	expert_0_ep10_exp2 -> expert_comp_0_ep10_exp2
	expert_comp_0_ep10_exp2 -> expert_agg_0
	token_route_0_ep10 -> expert_0_ep10_exp3
	expert_0_ep10_exp3 -> expert_comp_0_ep10_exp3
	expert_comp_0_ep10_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep11
	token_route_0_ep11 -> expert_0_ep11_exp0
	expert_0_ep11_exp0 -> expert_comp_0_ep11_exp0
	expert_comp_0_ep11_exp0 -> expert_agg_0
	token_route_0_ep11 -> expert_0_ep11_exp1
	expert_0_ep11_exp1 -> expert_comp_0_ep11_exp1
	expert_comp_0_ep11_exp1 -> expert_agg_0
	token_route_0_ep11 -> expert_0_ep11_exp2
	expert_0_ep11_exp2 -> expert_comp_0_ep11_exp2
	expert_comp_0_ep11_exp2 -> expert_agg_0
	token_route_0_ep11 -> expert_0_ep11_exp3
	expert_0_ep11_exp3 -> expert_comp_0_ep11_exp3
	expert_comp_0_ep11_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep12
	token_route_0_ep12 -> expert_0_ep12_exp0
	expert_0_ep12_exp0 -> expert_comp_0_ep12_exp0
	expert_comp_0_ep12_exp0 -> expert_agg_0
	token_route_0_ep12 -> expert_0_ep12_exp1
	expert_0_ep12_exp1 -> expert_comp_0_ep12_exp1
	expert_comp_0_ep12_exp1 -> expert_agg_0
	token_route_0_ep12 -> expert_0_ep12_exp2
	expert_0_ep12_exp2 -> expert_comp_0_ep12_exp2
	expert_comp_0_ep12_exp2 -> expert_agg_0
	token_route_0_ep12 -> expert_0_ep12_exp3
	expert_0_ep12_exp3 -> expert_comp_0_ep12_exp3
	expert_comp_0_ep12_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep13
	token_route_0_ep13 -> expert_0_ep13_exp0
	expert_0_ep13_exp0 -> expert_comp_0_ep13_exp0
	expert_comp_0_ep13_exp0 -> expert_agg_0
	token_route_0_ep13 -> expert_0_ep13_exp1
	expert_0_ep13_exp1 -> expert_comp_0_ep13_exp1
	expert_comp_0_ep13_exp1 -> expert_agg_0
	token_route_0_ep13 -> expert_0_ep13_exp2
	expert_0_ep13_exp2 -> expert_comp_0_ep13_exp2
	expert_comp_0_ep13_exp2 -> expert_agg_0
	token_route_0_ep13 -> expert_0_ep13_exp3
	expert_0_ep13_exp3 -> expert_comp_0_ep13_exp3
	expert_comp_0_ep13_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep14
	token_route_0_ep14 -> expert_0_ep14_exp0
	expert_0_ep14_exp0 -> expert_comp_0_ep14_exp0
	expert_comp_0_ep14_exp0 -> expert_agg_0
	token_route_0_ep14 -> expert_0_ep14_exp1
	expert_0_ep14_exp1 -> expert_comp_0_ep14_exp1
	expert_comp_0_ep14_exp1 -> expert_agg_0
	token_route_0_ep14 -> expert_0_ep14_exp2
	expert_0_ep14_exp2 -> expert_comp_0_ep14_exp2
	expert_comp_0_ep14_exp2 -> expert_agg_0
	token_route_0_ep14 -> expert_0_ep14_exp3
	expert_0_ep14_exp3 -> expert_comp_0_ep14_exp3
	expert_comp_0_ep14_exp3 -> expert_agg_0
	expert_select_0 -> token_route_0_ep15
	token_route_0_ep15 -> expert_0_ep15_exp0
	expert_0_ep15_exp0 -> expert_comp_0_ep15_exp0
	expert_comp_0_ep15_exp0 -> expert_agg_0
	token_route_0_ep15 -> expert_0_ep15_exp1
	expert_0_ep15_exp1 -> expert_comp_0_ep15_exp1
	expert_comp_0_ep15_exp1 -> expert_agg_0
	token_route_0_ep15 -> expert_0_ep15_exp2
	expert_0_ep15_exp2 -> expert_comp_0_ep15_exp2
	expert_comp_0_ep15_exp2 -> expert_agg_0
	token_route_0_ep15 -> expert_0_ep15_exp3
	expert_0_ep15_exp3 -> expert_comp_0_ep15_exp3
	expert_comp_0_ep15_exp3 -> expert_agg_0
	expert_agg_0 -> moe_out_linear_0_tp0
	moe_out_linear_0_tp0 -> allreduce_moe_0
	moe_out_linear_0_tp1 -> allreduce_moe_0
	moe_out_linear_0_tp2 -> allreduce_moe_0
	moe_out_linear_0_tp3 -> allreduce_moe_0
	allreduce_moe_0 -> layernorm_0
	layernorm_0 -> qkv_linear_1_tp0
	allreduce_att_1 -> gate_1 [style=dashed]
	gate_1 -> expert_select_1
	expert_select_1 -> token_route_1_ep0
	token_route_1_ep0 -> expert_1_ep0_exp0
	expert_1_ep0_exp0 -> expert_comp_1_ep0_exp0
	expert_comp_1_ep0_exp0 -> expert_agg_1
	token_route_1_ep0 -> expert_1_ep0_exp1
	expert_1_ep0_exp1 -> expert_comp_1_ep0_exp1
	expert_comp_1_ep0_exp1 -> expert_agg_1
	token_route_1_ep0 -> expert_1_ep0_exp2
	expert_1_ep0_exp2 -> expert_comp_1_ep0_exp2
	expert_comp_1_ep0_exp2 -> expert_agg_1
	token_route_1_ep0 -> expert_1_ep0_exp3
	expert_1_ep0_exp3 -> expert_comp_1_ep0_exp3
	expert_comp_1_ep0_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep1
	token_route_1_ep1 -> expert_1_ep1_exp0
	expert_1_ep1_exp0 -> expert_comp_1_ep1_exp0
	expert_comp_1_ep1_exp0 -> expert_agg_1
	token_route_1_ep1 -> expert_1_ep1_exp1
	expert_1_ep1_exp1 -> expert_comp_1_ep1_exp1
	expert_comp_1_ep1_exp1 -> expert_agg_1
	token_route_1_ep1 -> expert_1_ep1_exp2
	expert_1_ep1_exp2 -> expert_comp_1_ep1_exp2
	expert_comp_1_ep1_exp2 -> expert_agg_1
	token_route_1_ep1 -> expert_1_ep1_exp3
	expert_1_ep1_exp3 -> expert_comp_1_ep1_exp3
	expert_comp_1_ep1_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep2
	token_route_1_ep2 -> expert_1_ep2_exp0
	expert_1_ep2_exp0 -> expert_comp_1_ep2_exp0
	expert_comp_1_ep2_exp0 -> expert_agg_1
	token_route_1_ep2 -> expert_1_ep2_exp1
	expert_1_ep2_exp1 -> expert_comp_1_ep2_exp1
	expert_comp_1_ep2_exp1 -> expert_agg_1
	token_route_1_ep2 -> expert_1_ep2_exp2
	expert_1_ep2_exp2 -> expert_comp_1_ep2_exp2
	expert_comp_1_ep2_exp2 -> expert_agg_1
	token_route_1_ep2 -> expert_1_ep2_exp3
	expert_1_ep2_exp3 -> expert_comp_1_ep2_exp3
	expert_comp_1_ep2_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep3
	token_route_1_ep3 -> expert_1_ep3_exp0
	expert_1_ep3_exp0 -> expert_comp_1_ep3_exp0
	expert_comp_1_ep3_exp0 -> expert_agg_1
	token_route_1_ep3 -> expert_1_ep3_exp1
	expert_1_ep3_exp1 -> expert_comp_1_ep3_exp1
	expert_comp_1_ep3_exp1 -> expert_agg_1
	token_route_1_ep3 -> expert_1_ep3_exp2
	expert_1_ep3_exp2 -> expert_comp_1_ep3_exp2
	expert_comp_1_ep3_exp2 -> expert_agg_1
	token_route_1_ep3 -> expert_1_ep3_exp3
	expert_1_ep3_exp3 -> expert_comp_1_ep3_exp3
	expert_comp_1_ep3_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep4
	token_route_1_ep4 -> expert_1_ep4_exp0
	expert_1_ep4_exp0 -> expert_comp_1_ep4_exp0
	expert_comp_1_ep4_exp0 -> expert_agg_1
	token_route_1_ep4 -> expert_1_ep4_exp1
	expert_1_ep4_exp1 -> expert_comp_1_ep4_exp1
	expert_comp_1_ep4_exp1 -> expert_agg_1
	token_route_1_ep4 -> expert_1_ep4_exp2
	expert_1_ep4_exp2 -> expert_comp_1_ep4_exp2
	expert_comp_1_ep4_exp2 -> expert_agg_1
	token_route_1_ep4 -> expert_1_ep4_exp3
	expert_1_ep4_exp3 -> expert_comp_1_ep4_exp3
	expert_comp_1_ep4_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep5
	token_route_1_ep5 -> expert_1_ep5_exp0
	expert_1_ep5_exp0 -> expert_comp_1_ep5_exp0
	expert_comp_1_ep5_exp0 -> expert_agg_1
	token_route_1_ep5 -> expert_1_ep5_exp1
	expert_1_ep5_exp1 -> expert_comp_1_ep5_exp1
	expert_comp_1_ep5_exp1 -> expert_agg_1
	token_route_1_ep5 -> expert_1_ep5_exp2
	expert_1_ep5_exp2 -> expert_comp_1_ep5_exp2
	expert_comp_1_ep5_exp2 -> expert_agg_1
	token_route_1_ep5 -> expert_1_ep5_exp3
	expert_1_ep5_exp3 -> expert_comp_1_ep5_exp3
	expert_comp_1_ep5_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep6
	token_route_1_ep6 -> expert_1_ep6_exp0
	expert_1_ep6_exp0 -> expert_comp_1_ep6_exp0
	expert_comp_1_ep6_exp0 -> expert_agg_1
	token_route_1_ep6 -> expert_1_ep6_exp1
	expert_1_ep6_exp1 -> expert_comp_1_ep6_exp1
	expert_comp_1_ep6_exp1 -> expert_agg_1
	token_route_1_ep6 -> expert_1_ep6_exp2
	expert_1_ep6_exp2 -> expert_comp_1_ep6_exp2
	expert_comp_1_ep6_exp2 -> expert_agg_1
	token_route_1_ep6 -> expert_1_ep6_exp3
	expert_1_ep6_exp3 -> expert_comp_1_ep6_exp3
	expert_comp_1_ep6_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep7
	token_route_1_ep7 -> expert_1_ep7_exp0
	expert_1_ep7_exp0 -> expert_comp_1_ep7_exp0
	expert_comp_1_ep7_exp0 -> expert_agg_1
	token_route_1_ep7 -> expert_1_ep7_exp1
	expert_1_ep7_exp1 -> expert_comp_1_ep7_exp1
	expert_comp_1_ep7_exp1 -> expert_agg_1
	token_route_1_ep7 -> expert_1_ep7_exp2
	expert_1_ep7_exp2 -> expert_comp_1_ep7_exp2
	expert_comp_1_ep7_exp2 -> expert_agg_1
	token_route_1_ep7 -> expert_1_ep7_exp3
	expert_1_ep7_exp3 -> expert_comp_1_ep7_exp3
	expert_comp_1_ep7_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep8
	token_route_1_ep8 -> expert_1_ep8_exp0
	expert_1_ep8_exp0 -> expert_comp_1_ep8_exp0
	expert_comp_1_ep8_exp0 -> expert_agg_1
	token_route_1_ep8 -> expert_1_ep8_exp1
	expert_1_ep8_exp1 -> expert_comp_1_ep8_exp1
	expert_comp_1_ep8_exp1 -> expert_agg_1
	token_route_1_ep8 -> expert_1_ep8_exp2
	expert_1_ep8_exp2 -> expert_comp_1_ep8_exp2
	expert_comp_1_ep8_exp2 -> expert_agg_1
	token_route_1_ep8 -> expert_1_ep8_exp3
	expert_1_ep8_exp3 -> expert_comp_1_ep8_exp3
	expert_comp_1_ep8_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep9
	token_route_1_ep9 -> expert_1_ep9_exp0
	expert_1_ep9_exp0 -> expert_comp_1_ep9_exp0
	expert_comp_1_ep9_exp0 -> expert_agg_1
	token_route_1_ep9 -> expert_1_ep9_exp1
	expert_1_ep9_exp1 -> expert_comp_1_ep9_exp1
	expert_comp_1_ep9_exp1 -> expert_agg_1
	token_route_1_ep9 -> expert_1_ep9_exp2
	expert_1_ep9_exp2 -> expert_comp_1_ep9_exp2
	expert_comp_1_ep9_exp2 -> expert_agg_1
	token_route_1_ep9 -> expert_1_ep9_exp3
	expert_1_ep9_exp3 -> expert_comp_1_ep9_exp3
	expert_comp_1_ep9_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep10
	token_route_1_ep10 -> expert_1_ep10_exp0
	expert_1_ep10_exp0 -> expert_comp_1_ep10_exp0
	expert_comp_1_ep10_exp0 -> expert_agg_1
	token_route_1_ep10 -> expert_1_ep10_exp1
	expert_1_ep10_exp1 -> expert_comp_1_ep10_exp1
	expert_comp_1_ep10_exp1 -> expert_agg_1
	token_route_1_ep10 -> expert_1_ep10_exp2
	expert_1_ep10_exp2 -> expert_comp_1_ep10_exp2
	expert_comp_1_ep10_exp2 -> expert_agg_1
	token_route_1_ep10 -> expert_1_ep10_exp3
	expert_1_ep10_exp3 -> expert_comp_1_ep10_exp3
	expert_comp_1_ep10_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep11
	token_route_1_ep11 -> expert_1_ep11_exp0
	expert_1_ep11_exp0 -> expert_comp_1_ep11_exp0
	expert_comp_1_ep11_exp0 -> expert_agg_1
	token_route_1_ep11 -> expert_1_ep11_exp1
	expert_1_ep11_exp1 -> expert_comp_1_ep11_exp1
	expert_comp_1_ep11_exp1 -> expert_agg_1
	token_route_1_ep11 -> expert_1_ep11_exp2
	expert_1_ep11_exp2 -> expert_comp_1_ep11_exp2
	expert_comp_1_ep11_exp2 -> expert_agg_1
	token_route_1_ep11 -> expert_1_ep11_exp3
	expert_1_ep11_exp3 -> expert_comp_1_ep11_exp3
	expert_comp_1_ep11_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep12
	token_route_1_ep12 -> expert_1_ep12_exp0
	expert_1_ep12_exp0 -> expert_comp_1_ep12_exp0
	expert_comp_1_ep12_exp0 -> expert_agg_1
	token_route_1_ep12 -> expert_1_ep12_exp1
	expert_1_ep12_exp1 -> expert_comp_1_ep12_exp1
	expert_comp_1_ep12_exp1 -> expert_agg_1
	token_route_1_ep12 -> expert_1_ep12_exp2
	expert_1_ep12_exp2 -> expert_comp_1_ep12_exp2
	expert_comp_1_ep12_exp2 -> expert_agg_1
	token_route_1_ep12 -> expert_1_ep12_exp3
	expert_1_ep12_exp3 -> expert_comp_1_ep12_exp3
	expert_comp_1_ep12_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep13
	token_route_1_ep13 -> expert_1_ep13_exp0
	expert_1_ep13_exp0 -> expert_comp_1_ep13_exp0
	expert_comp_1_ep13_exp0 -> expert_agg_1
	token_route_1_ep13 -> expert_1_ep13_exp1
	expert_1_ep13_exp1 -> expert_comp_1_ep13_exp1
	expert_comp_1_ep13_exp1 -> expert_agg_1
	token_route_1_ep13 -> expert_1_ep13_exp2
	expert_1_ep13_exp2 -> expert_comp_1_ep13_exp2
	expert_comp_1_ep13_exp2 -> expert_agg_1
	token_route_1_ep13 -> expert_1_ep13_exp3
	expert_1_ep13_exp3 -> expert_comp_1_ep13_exp3
	expert_comp_1_ep13_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep14
	token_route_1_ep14 -> expert_1_ep14_exp0
	expert_1_ep14_exp0 -> expert_comp_1_ep14_exp0
	expert_comp_1_ep14_exp0 -> expert_agg_1
	token_route_1_ep14 -> expert_1_ep14_exp1
	expert_1_ep14_exp1 -> expert_comp_1_ep14_exp1
	expert_comp_1_ep14_exp1 -> expert_agg_1
	token_route_1_ep14 -> expert_1_ep14_exp2
	expert_1_ep14_exp2 -> expert_comp_1_ep14_exp2
	expert_comp_1_ep14_exp2 -> expert_agg_1
	token_route_1_ep14 -> expert_1_ep14_exp3
	expert_1_ep14_exp3 -> expert_comp_1_ep14_exp3
	expert_comp_1_ep14_exp3 -> expert_agg_1
	expert_select_1 -> token_route_1_ep15
	token_route_1_ep15 -> expert_1_ep15_exp0
	expert_1_ep15_exp0 -> expert_comp_1_ep15_exp0
	expert_comp_1_ep15_exp0 -> expert_agg_1
	token_route_1_ep15 -> expert_1_ep15_exp1
	expert_1_ep15_exp1 -> expert_comp_1_ep15_exp1
	expert_comp_1_ep15_exp1 -> expert_agg_1
	token_route_1_ep15 -> expert_1_ep15_exp2
	expert_1_ep15_exp2 -> expert_comp_1_ep15_exp2
	expert_comp_1_ep15_exp2 -> expert_agg_1
	token_route_1_ep15 -> expert_1_ep15_exp3
	expert_1_ep15_exp3 -> expert_comp_1_ep15_exp3
	expert_comp_1_ep15_exp3 -> expert_agg_1
	expert_agg_1 -> moe_out_linear_1_tp0
	moe_out_linear_1_tp0 -> allreduce_moe_1
	moe_out_linear_1_tp1 -> allreduce_moe_1
	moe_out_linear_1_tp2 -> allreduce_moe_1
	moe_out_linear_1_tp3 -> allreduce_moe_1
	allreduce_moe_1 -> layernorm_1
	layernorm_1 -> qkv_linear_2_tp0
	allreduce_att_2 -> gate_2 [style=dashed]
	gate_2 -> expert_select_2
	expert_select_2 -> token_route_2_ep0
	token_route_2_ep0 -> expert_2_ep0_exp0
	expert_2_ep0_exp0 -> expert_comp_2_ep0_exp0
	expert_comp_2_ep0_exp0 -> expert_agg_2
	token_route_2_ep0 -> expert_2_ep0_exp1
	expert_2_ep0_exp1 -> expert_comp_2_ep0_exp1
	expert_comp_2_ep0_exp1 -> expert_agg_2
	token_route_2_ep0 -> expert_2_ep0_exp2
	expert_2_ep0_exp2 -> expert_comp_2_ep0_exp2
	expert_comp_2_ep0_exp2 -> expert_agg_2
	token_route_2_ep0 -> expert_2_ep0_exp3
	expert_2_ep0_exp3 -> expert_comp_2_ep0_exp3
	expert_comp_2_ep0_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep1
	token_route_2_ep1 -> expert_2_ep1_exp0
	expert_2_ep1_exp0 -> expert_comp_2_ep1_exp0
	expert_comp_2_ep1_exp0 -> expert_agg_2
	token_route_2_ep1 -> expert_2_ep1_exp1
	expert_2_ep1_exp1 -> expert_comp_2_ep1_exp1
	expert_comp_2_ep1_exp1 -> expert_agg_2
	token_route_2_ep1 -> expert_2_ep1_exp2
	expert_2_ep1_exp2 -> expert_comp_2_ep1_exp2
	expert_comp_2_ep1_exp2 -> expert_agg_2
	token_route_2_ep1 -> expert_2_ep1_exp3
	expert_2_ep1_exp3 -> expert_comp_2_ep1_exp3
	expert_comp_2_ep1_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep2
	token_route_2_ep2 -> expert_2_ep2_exp0
	expert_2_ep2_exp0 -> expert_comp_2_ep2_exp0
	expert_comp_2_ep2_exp0 -> expert_agg_2
	token_route_2_ep2 -> expert_2_ep2_exp1
	expert_2_ep2_exp1 -> expert_comp_2_ep2_exp1
	expert_comp_2_ep2_exp1 -> expert_agg_2
	token_route_2_ep2 -> expert_2_ep2_exp2
	expert_2_ep2_exp2 -> expert_comp_2_ep2_exp2
	expert_comp_2_ep2_exp2 -> expert_agg_2
	token_route_2_ep2 -> expert_2_ep2_exp3
	expert_2_ep2_exp3 -> expert_comp_2_ep2_exp3
	expert_comp_2_ep2_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep3
	token_route_2_ep3 -> expert_2_ep3_exp0
	expert_2_ep3_exp0 -> expert_comp_2_ep3_exp0
	expert_comp_2_ep3_exp0 -> expert_agg_2
	token_route_2_ep3 -> expert_2_ep3_exp1
	expert_2_ep3_exp1 -> expert_comp_2_ep3_exp1
	expert_comp_2_ep3_exp1 -> expert_agg_2
	token_route_2_ep3 -> expert_2_ep3_exp2
	expert_2_ep3_exp2 -> expert_comp_2_ep3_exp2
	expert_comp_2_ep3_exp2 -> expert_agg_2
	token_route_2_ep3 -> expert_2_ep3_exp3
	expert_2_ep3_exp3 -> expert_comp_2_ep3_exp3
	expert_comp_2_ep3_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep4
	token_route_2_ep4 -> expert_2_ep4_exp0
	expert_2_ep4_exp0 -> expert_comp_2_ep4_exp0
	expert_comp_2_ep4_exp0 -> expert_agg_2
	token_route_2_ep4 -> expert_2_ep4_exp1
	expert_2_ep4_exp1 -> expert_comp_2_ep4_exp1
	expert_comp_2_ep4_exp1 -> expert_agg_2
	token_route_2_ep4 -> expert_2_ep4_exp2
	expert_2_ep4_exp2 -> expert_comp_2_ep4_exp2
	expert_comp_2_ep4_exp2 -> expert_agg_2
	token_route_2_ep4 -> expert_2_ep4_exp3
	expert_2_ep4_exp3 -> expert_comp_2_ep4_exp3
	expert_comp_2_ep4_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep5
	token_route_2_ep5 -> expert_2_ep5_exp0
	expert_2_ep5_exp0 -> expert_comp_2_ep5_exp0
	expert_comp_2_ep5_exp0 -> expert_agg_2
	token_route_2_ep5 -> expert_2_ep5_exp1
	expert_2_ep5_exp1 -> expert_comp_2_ep5_exp1
	expert_comp_2_ep5_exp1 -> expert_agg_2
	token_route_2_ep5 -> expert_2_ep5_exp2
	expert_2_ep5_exp2 -> expert_comp_2_ep5_exp2
	expert_comp_2_ep5_exp2 -> expert_agg_2
	token_route_2_ep5 -> expert_2_ep5_exp3
	expert_2_ep5_exp3 -> expert_comp_2_ep5_exp3
	expert_comp_2_ep5_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep6
	token_route_2_ep6 -> expert_2_ep6_exp0
	expert_2_ep6_exp0 -> expert_comp_2_ep6_exp0
	expert_comp_2_ep6_exp0 -> expert_agg_2
	token_route_2_ep6 -> expert_2_ep6_exp1
	expert_2_ep6_exp1 -> expert_comp_2_ep6_exp1
	expert_comp_2_ep6_exp1 -> expert_agg_2
	token_route_2_ep6 -> expert_2_ep6_exp2
	expert_2_ep6_exp2 -> expert_comp_2_ep6_exp2
	expert_comp_2_ep6_exp2 -> expert_agg_2
	token_route_2_ep6 -> expert_2_ep6_exp3
	expert_2_ep6_exp3 -> expert_comp_2_ep6_exp3
	expert_comp_2_ep6_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep7
	token_route_2_ep7 -> expert_2_ep7_exp0
	expert_2_ep7_exp0 -> expert_comp_2_ep7_exp0
	expert_comp_2_ep7_exp0 -> expert_agg_2
	token_route_2_ep7 -> expert_2_ep7_exp1
	expert_2_ep7_exp1 -> expert_comp_2_ep7_exp1
	expert_comp_2_ep7_exp1 -> expert_agg_2
	token_route_2_ep7 -> expert_2_ep7_exp2
	expert_2_ep7_exp2 -> expert_comp_2_ep7_exp2
	expert_comp_2_ep7_exp2 -> expert_agg_2
	token_route_2_ep7 -> expert_2_ep7_exp3
	expert_2_ep7_exp3 -> expert_comp_2_ep7_exp3
	expert_comp_2_ep7_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep8
	token_route_2_ep8 -> expert_2_ep8_exp0
	expert_2_ep8_exp0 -> expert_comp_2_ep8_exp0
	expert_comp_2_ep8_exp0 -> expert_agg_2
	token_route_2_ep8 -> expert_2_ep8_exp1
	expert_2_ep8_exp1 -> expert_comp_2_ep8_exp1
	expert_comp_2_ep8_exp1 -> expert_agg_2
	token_route_2_ep8 -> expert_2_ep8_exp2
	expert_2_ep8_exp2 -> expert_comp_2_ep8_exp2
	expert_comp_2_ep8_exp2 -> expert_agg_2
	token_route_2_ep8 -> expert_2_ep8_exp3
	expert_2_ep8_exp3 -> expert_comp_2_ep8_exp3
	expert_comp_2_ep8_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep9
	token_route_2_ep9 -> expert_2_ep9_exp0
	expert_2_ep9_exp0 -> expert_comp_2_ep9_exp0
	expert_comp_2_ep9_exp0 -> expert_agg_2
	token_route_2_ep9 -> expert_2_ep9_exp1
	expert_2_ep9_exp1 -> expert_comp_2_ep9_exp1
	expert_comp_2_ep9_exp1 -> expert_agg_2
	token_route_2_ep9 -> expert_2_ep9_exp2
	expert_2_ep9_exp2 -> expert_comp_2_ep9_exp2
	expert_comp_2_ep9_exp2 -> expert_agg_2
	token_route_2_ep9 -> expert_2_ep9_exp3
	expert_2_ep9_exp3 -> expert_comp_2_ep9_exp3
	expert_comp_2_ep9_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep10
	token_route_2_ep10 -> expert_2_ep10_exp0
	expert_2_ep10_exp0 -> expert_comp_2_ep10_exp0
	expert_comp_2_ep10_exp0 -> expert_agg_2
	token_route_2_ep10 -> expert_2_ep10_exp1
	expert_2_ep10_exp1 -> expert_comp_2_ep10_exp1
	expert_comp_2_ep10_exp1 -> expert_agg_2
	token_route_2_ep10 -> expert_2_ep10_exp2
	expert_2_ep10_exp2 -> expert_comp_2_ep10_exp2
	expert_comp_2_ep10_exp2 -> expert_agg_2
	token_route_2_ep10 -> expert_2_ep10_exp3
	expert_2_ep10_exp3 -> expert_comp_2_ep10_exp3
	expert_comp_2_ep10_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep11
	token_route_2_ep11 -> expert_2_ep11_exp0
	expert_2_ep11_exp0 -> expert_comp_2_ep11_exp0
	expert_comp_2_ep11_exp0 -> expert_agg_2
	token_route_2_ep11 -> expert_2_ep11_exp1
	expert_2_ep11_exp1 -> expert_comp_2_ep11_exp1
	expert_comp_2_ep11_exp1 -> expert_agg_2
	token_route_2_ep11 -> expert_2_ep11_exp2
	expert_2_ep11_exp2 -> expert_comp_2_ep11_exp2
	expert_comp_2_ep11_exp2 -> expert_agg_2
	token_route_2_ep11 -> expert_2_ep11_exp3
	expert_2_ep11_exp3 -> expert_comp_2_ep11_exp3
	expert_comp_2_ep11_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep12
	token_route_2_ep12 -> expert_2_ep12_exp0
	expert_2_ep12_exp0 -> expert_comp_2_ep12_exp0
	expert_comp_2_ep12_exp0 -> expert_agg_2
	token_route_2_ep12 -> expert_2_ep12_exp1
	expert_2_ep12_exp1 -> expert_comp_2_ep12_exp1
	expert_comp_2_ep12_exp1 -> expert_agg_2
	token_route_2_ep12 -> expert_2_ep12_exp2
	expert_2_ep12_exp2 -> expert_comp_2_ep12_exp2
	expert_comp_2_ep12_exp2 -> expert_agg_2
	token_route_2_ep12 -> expert_2_ep12_exp3
	expert_2_ep12_exp3 -> expert_comp_2_ep12_exp3
	expert_comp_2_ep12_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep13
	token_route_2_ep13 -> expert_2_ep13_exp0
	expert_2_ep13_exp0 -> expert_comp_2_ep13_exp0
	expert_comp_2_ep13_exp0 -> expert_agg_2
	token_route_2_ep13 -> expert_2_ep13_exp1
	expert_2_ep13_exp1 -> expert_comp_2_ep13_exp1
	expert_comp_2_ep13_exp1 -> expert_agg_2
	token_route_2_ep13 -> expert_2_ep13_exp2
	expert_2_ep13_exp2 -> expert_comp_2_ep13_exp2
	expert_comp_2_ep13_exp2 -> expert_agg_2
	token_route_2_ep13 -> expert_2_ep13_exp3
	expert_2_ep13_exp3 -> expert_comp_2_ep13_exp3
	expert_comp_2_ep13_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep14
	token_route_2_ep14 -> expert_2_ep14_exp0
	expert_2_ep14_exp0 -> expert_comp_2_ep14_exp0
	expert_comp_2_ep14_exp0 -> expert_agg_2
	token_route_2_ep14 -> expert_2_ep14_exp1
	expert_2_ep14_exp1 -> expert_comp_2_ep14_exp1
	expert_comp_2_ep14_exp1 -> expert_agg_2
	token_route_2_ep14 -> expert_2_ep14_exp2
	expert_2_ep14_exp2 -> expert_comp_2_ep14_exp2
	expert_comp_2_ep14_exp2 -> expert_agg_2
	token_route_2_ep14 -> expert_2_ep14_exp3
	expert_2_ep14_exp3 -> expert_comp_2_ep14_exp3
	expert_comp_2_ep14_exp3 -> expert_agg_2
	expert_select_2 -> token_route_2_ep15
	token_route_2_ep15 -> expert_2_ep15_exp0
	expert_2_ep15_exp0 -> expert_comp_2_ep15_exp0
	expert_comp_2_ep15_exp0 -> expert_agg_2
	token_route_2_ep15 -> expert_2_ep15_exp1
	expert_2_ep15_exp1 -> expert_comp_2_ep15_exp1
	expert_comp_2_ep15_exp1 -> expert_agg_2
	token_route_2_ep15 -> expert_2_ep15_exp2
	expert_2_ep15_exp2 -> expert_comp_2_ep15_exp2
	expert_comp_2_ep15_exp2 -> expert_agg_2
	token_route_2_ep15 -> expert_2_ep15_exp3
	expert_2_ep15_exp3 -> expert_comp_2_ep15_exp3
	expert_comp_2_ep15_exp3 -> expert_agg_2
	expert_agg_2 -> moe_out_linear_2_tp0
	moe_out_linear_2_tp0 -> allreduce_moe_2
	moe_out_linear_2_tp1 -> allreduce_moe_2
	moe_out_linear_2_tp2 -> allreduce_moe_2
	moe_out_linear_2_tp3 -> allreduce_moe_2
	allreduce_moe_2 -> layernorm_2
	layernorm_2 -> qkv_linear_3_tp0
	allreduce_att_3 -> gate_3 [style=dashed]
	gate_3 -> expert_select_3
	expert_select_3 -> token_route_3_ep0
	token_route_3_ep0 -> expert_3_ep0_exp0
	expert_3_ep0_exp0 -> expert_comp_3_ep0_exp0
	expert_comp_3_ep0_exp0 -> expert_agg_3
	token_route_3_ep0 -> expert_3_ep0_exp1
	expert_3_ep0_exp1 -> expert_comp_3_ep0_exp1
	expert_comp_3_ep0_exp1 -> expert_agg_3
	token_route_3_ep0 -> expert_3_ep0_exp2
	expert_3_ep0_exp2 -> expert_comp_3_ep0_exp2
	expert_comp_3_ep0_exp2 -> expert_agg_3
	token_route_3_ep0 -> expert_3_ep0_exp3
	expert_3_ep0_exp3 -> expert_comp_3_ep0_exp3
	expert_comp_3_ep0_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep1
	token_route_3_ep1 -> expert_3_ep1_exp0
	expert_3_ep1_exp0 -> expert_comp_3_ep1_exp0
	expert_comp_3_ep1_exp0 -> expert_agg_3
	token_route_3_ep1 -> expert_3_ep1_exp1
	expert_3_ep1_exp1 -> expert_comp_3_ep1_exp1
	expert_comp_3_ep1_exp1 -> expert_agg_3
	token_route_3_ep1 -> expert_3_ep1_exp2
	expert_3_ep1_exp2 -> expert_comp_3_ep1_exp2
	expert_comp_3_ep1_exp2 -> expert_agg_3
	token_route_3_ep1 -> expert_3_ep1_exp3
	expert_3_ep1_exp3 -> expert_comp_3_ep1_exp3
	expert_comp_3_ep1_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep2
	token_route_3_ep2 -> expert_3_ep2_exp0
	expert_3_ep2_exp0 -> expert_comp_3_ep2_exp0
	expert_comp_3_ep2_exp0 -> expert_agg_3
	token_route_3_ep2 -> expert_3_ep2_exp1
	expert_3_ep2_exp1 -> expert_comp_3_ep2_exp1
	expert_comp_3_ep2_exp1 -> expert_agg_3
	token_route_3_ep2 -> expert_3_ep2_exp2
	expert_3_ep2_exp2 -> expert_comp_3_ep2_exp2
	expert_comp_3_ep2_exp2 -> expert_agg_3
	token_route_3_ep2 -> expert_3_ep2_exp3
	expert_3_ep2_exp3 -> expert_comp_3_ep2_exp3
	expert_comp_3_ep2_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep3
	token_route_3_ep3 -> expert_3_ep3_exp0
	expert_3_ep3_exp0 -> expert_comp_3_ep3_exp0
	expert_comp_3_ep3_exp0 -> expert_agg_3
	token_route_3_ep3 -> expert_3_ep3_exp1
	expert_3_ep3_exp1 -> expert_comp_3_ep3_exp1
	expert_comp_3_ep3_exp1 -> expert_agg_3
	token_route_3_ep3 -> expert_3_ep3_exp2
	expert_3_ep3_exp2 -> expert_comp_3_ep3_exp2
	expert_comp_3_ep3_exp2 -> expert_agg_3
	token_route_3_ep3 -> expert_3_ep3_exp3
	expert_3_ep3_exp3 -> expert_comp_3_ep3_exp3
	expert_comp_3_ep3_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep4
	token_route_3_ep4 -> expert_3_ep4_exp0
	expert_3_ep4_exp0 -> expert_comp_3_ep4_exp0
	expert_comp_3_ep4_exp0 -> expert_agg_3
	token_route_3_ep4 -> expert_3_ep4_exp1
	expert_3_ep4_exp1 -> expert_comp_3_ep4_exp1
	expert_comp_3_ep4_exp1 -> expert_agg_3
	token_route_3_ep4 -> expert_3_ep4_exp2
	expert_3_ep4_exp2 -> expert_comp_3_ep4_exp2
	expert_comp_3_ep4_exp2 -> expert_agg_3
	token_route_3_ep4 -> expert_3_ep4_exp3
	expert_3_ep4_exp3 -> expert_comp_3_ep4_exp3
	expert_comp_3_ep4_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep5
	token_route_3_ep5 -> expert_3_ep5_exp0
	expert_3_ep5_exp0 -> expert_comp_3_ep5_exp0
	expert_comp_3_ep5_exp0 -> expert_agg_3
	token_route_3_ep5 -> expert_3_ep5_exp1
	expert_3_ep5_exp1 -> expert_comp_3_ep5_exp1
	expert_comp_3_ep5_exp1 -> expert_agg_3
	token_route_3_ep5 -> expert_3_ep5_exp2
	expert_3_ep5_exp2 -> expert_comp_3_ep5_exp2
	expert_comp_3_ep5_exp2 -> expert_agg_3
	token_route_3_ep5 -> expert_3_ep5_exp3
	expert_3_ep5_exp3 -> expert_comp_3_ep5_exp3
	expert_comp_3_ep5_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep6
	token_route_3_ep6 -> expert_3_ep6_exp0
	expert_3_ep6_exp0 -> expert_comp_3_ep6_exp0
	expert_comp_3_ep6_exp0 -> expert_agg_3
	token_route_3_ep6 -> expert_3_ep6_exp1
	expert_3_ep6_exp1 -> expert_comp_3_ep6_exp1
	expert_comp_3_ep6_exp1 -> expert_agg_3
	token_route_3_ep6 -> expert_3_ep6_exp2
	expert_3_ep6_exp2 -> expert_comp_3_ep6_exp2
	expert_comp_3_ep6_exp2 -> expert_agg_3
	token_route_3_ep6 -> expert_3_ep6_exp3
	expert_3_ep6_exp3 -> expert_comp_3_ep6_exp3
	expert_comp_3_ep6_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep7
	token_route_3_ep7 -> expert_3_ep7_exp0
	expert_3_ep7_exp0 -> expert_comp_3_ep7_exp0
	expert_comp_3_ep7_exp0 -> expert_agg_3
	token_route_3_ep7 -> expert_3_ep7_exp1
	expert_3_ep7_exp1 -> expert_comp_3_ep7_exp1
	expert_comp_3_ep7_exp1 -> expert_agg_3
	token_route_3_ep7 -> expert_3_ep7_exp2
	expert_3_ep7_exp2 -> expert_comp_3_ep7_exp2
	expert_comp_3_ep7_exp2 -> expert_agg_3
	token_route_3_ep7 -> expert_3_ep7_exp3
	expert_3_ep7_exp3 -> expert_comp_3_ep7_exp3
	expert_comp_3_ep7_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep8
	token_route_3_ep8 -> expert_3_ep8_exp0
	expert_3_ep8_exp0 -> expert_comp_3_ep8_exp0
	expert_comp_3_ep8_exp0 -> expert_agg_3
	token_route_3_ep8 -> expert_3_ep8_exp1
	expert_3_ep8_exp1 -> expert_comp_3_ep8_exp1
	expert_comp_3_ep8_exp1 -> expert_agg_3
	token_route_3_ep8 -> expert_3_ep8_exp2
	expert_3_ep8_exp2 -> expert_comp_3_ep8_exp2
	expert_comp_3_ep8_exp2 -> expert_agg_3
	token_route_3_ep8 -> expert_3_ep8_exp3
	expert_3_ep8_exp3 -> expert_comp_3_ep8_exp3
	expert_comp_3_ep8_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep9
	token_route_3_ep9 -> expert_3_ep9_exp0
	expert_3_ep9_exp0 -> expert_comp_3_ep9_exp0
	expert_comp_3_ep9_exp0 -> expert_agg_3
	token_route_3_ep9 -> expert_3_ep9_exp1
	expert_3_ep9_exp1 -> expert_comp_3_ep9_exp1
	expert_comp_3_ep9_exp1 -> expert_agg_3
	token_route_3_ep9 -> expert_3_ep9_exp2
	expert_3_ep9_exp2 -> expert_comp_3_ep9_exp2
	expert_comp_3_ep9_exp2 -> expert_agg_3
	token_route_3_ep9 -> expert_3_ep9_exp3
	expert_3_ep9_exp3 -> expert_comp_3_ep9_exp3
	expert_comp_3_ep9_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep10
	token_route_3_ep10 -> expert_3_ep10_exp0
	expert_3_ep10_exp0 -> expert_comp_3_ep10_exp0
	expert_comp_3_ep10_exp0 -> expert_agg_3
	token_route_3_ep10 -> expert_3_ep10_exp1
	expert_3_ep10_exp1 -> expert_comp_3_ep10_exp1
	expert_comp_3_ep10_exp1 -> expert_agg_3
	token_route_3_ep10 -> expert_3_ep10_exp2
	expert_3_ep10_exp2 -> expert_comp_3_ep10_exp2
	expert_comp_3_ep10_exp2 -> expert_agg_3
	token_route_3_ep10 -> expert_3_ep10_exp3
	expert_3_ep10_exp3 -> expert_comp_3_ep10_exp3
	expert_comp_3_ep10_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep11
	token_route_3_ep11 -> expert_3_ep11_exp0
	expert_3_ep11_exp0 -> expert_comp_3_ep11_exp0
	expert_comp_3_ep11_exp0 -> expert_agg_3
	token_route_3_ep11 -> expert_3_ep11_exp1
	expert_3_ep11_exp1 -> expert_comp_3_ep11_exp1
	expert_comp_3_ep11_exp1 -> expert_agg_3
	token_route_3_ep11 -> expert_3_ep11_exp2
	expert_3_ep11_exp2 -> expert_comp_3_ep11_exp2
	expert_comp_3_ep11_exp2 -> expert_agg_3
	token_route_3_ep11 -> expert_3_ep11_exp3
	expert_3_ep11_exp3 -> expert_comp_3_ep11_exp3
	expert_comp_3_ep11_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep12
	token_route_3_ep12 -> expert_3_ep12_exp0
	expert_3_ep12_exp0 -> expert_comp_3_ep12_exp0
	expert_comp_3_ep12_exp0 -> expert_agg_3
	token_route_3_ep12 -> expert_3_ep12_exp1
	expert_3_ep12_exp1 -> expert_comp_3_ep12_exp1
	expert_comp_3_ep12_exp1 -> expert_agg_3
	token_route_3_ep12 -> expert_3_ep12_exp2
	expert_3_ep12_exp2 -> expert_comp_3_ep12_exp2
	expert_comp_3_ep12_exp2 -> expert_agg_3
	token_route_3_ep12 -> expert_3_ep12_exp3
	expert_3_ep12_exp3 -> expert_comp_3_ep12_exp3
	expert_comp_3_ep12_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep13
	token_route_3_ep13 -> expert_3_ep13_exp0
	expert_3_ep13_exp0 -> expert_comp_3_ep13_exp0
	expert_comp_3_ep13_exp0 -> expert_agg_3
	token_route_3_ep13 -> expert_3_ep13_exp1
	expert_3_ep13_exp1 -> expert_comp_3_ep13_exp1
	expert_comp_3_ep13_exp1 -> expert_agg_3
	token_route_3_ep13 -> expert_3_ep13_exp2
	expert_3_ep13_exp2 -> expert_comp_3_ep13_exp2
	expert_comp_3_ep13_exp2 -> expert_agg_3
	token_route_3_ep13 -> expert_3_ep13_exp3
	expert_3_ep13_exp3 -> expert_comp_3_ep13_exp3
	expert_comp_3_ep13_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep14
	token_route_3_ep14 -> expert_3_ep14_exp0
	expert_3_ep14_exp0 -> expert_comp_3_ep14_exp0
	expert_comp_3_ep14_exp0 -> expert_agg_3
	token_route_3_ep14 -> expert_3_ep14_exp1
	expert_3_ep14_exp1 -> expert_comp_3_ep14_exp1
	expert_comp_3_ep14_exp1 -> expert_agg_3
	token_route_3_ep14 -> expert_3_ep14_exp2
	expert_3_ep14_exp2 -> expert_comp_3_ep14_exp2
	expert_comp_3_ep14_exp2 -> expert_agg_3
	token_route_3_ep14 -> expert_3_ep14_exp3
	expert_3_ep14_exp3 -> expert_comp_3_ep14_exp3
	expert_comp_3_ep14_exp3 -> expert_agg_3
	expert_select_3 -> token_route_3_ep15
	token_route_3_ep15 -> expert_3_ep15_exp0
	expert_3_ep15_exp0 -> expert_comp_3_ep15_exp0
	expert_comp_3_ep15_exp0 -> expert_agg_3
	token_route_3_ep15 -> expert_3_ep15_exp1
	expert_3_ep15_exp1 -> expert_comp_3_ep15_exp1
	expert_comp_3_ep15_exp1 -> expert_agg_3
	token_route_3_ep15 -> expert_3_ep15_exp2
	expert_3_ep15_exp2 -> expert_comp_3_ep15_exp2
	expert_comp_3_ep15_exp2 -> expert_agg_3
	token_route_3_ep15 -> expert_3_ep15_exp3
	expert_3_ep15_exp3 -> expert_comp_3_ep15_exp3
	expert_comp_3_ep15_exp3 -> expert_agg_3
	expert_agg_3 -> moe_out_linear_3_tp0
	moe_out_linear_3_tp0 -> allreduce_moe_3
	moe_out_linear_3_tp1 -> allreduce_moe_3
	moe_out_linear_3_tp2 -> allreduce_moe_3
	moe_out_linear_3_tp3 -> allreduce_moe_3
	allreduce_moe_3 -> layernorm_3
	layernorm_3 -> qkv_linear_4_tp0
	allreduce_att_4 -> gate_4 [style=dashed]
	gate_4 -> expert_select_4
	expert_select_4 -> token_route_4_ep0
	token_route_4_ep0 -> expert_4_ep0_exp0
	expert_4_ep0_exp0 -> expert_comp_4_ep0_exp0
	expert_comp_4_ep0_exp0 -> expert_agg_4
	token_route_4_ep0 -> expert_4_ep0_exp1
	expert_4_ep0_exp1 -> expert_comp_4_ep0_exp1
	expert_comp_4_ep0_exp1 -> expert_agg_4
	token_route_4_ep0 -> expert_4_ep0_exp2
	expert_4_ep0_exp2 -> expert_comp_4_ep0_exp2
	expert_comp_4_ep0_exp2 -> expert_agg_4
	token_route_4_ep0 -> expert_4_ep0_exp3
	expert_4_ep0_exp3 -> expert_comp_4_ep0_exp3
	expert_comp_4_ep0_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep1
	token_route_4_ep1 -> expert_4_ep1_exp0
	expert_4_ep1_exp0 -> expert_comp_4_ep1_exp0
	expert_comp_4_ep1_exp0 -> expert_agg_4
	token_route_4_ep1 -> expert_4_ep1_exp1
	expert_4_ep1_exp1 -> expert_comp_4_ep1_exp1
	expert_comp_4_ep1_exp1 -> expert_agg_4
	token_route_4_ep1 -> expert_4_ep1_exp2
	expert_4_ep1_exp2 -> expert_comp_4_ep1_exp2
	expert_comp_4_ep1_exp2 -> expert_agg_4
	token_route_4_ep1 -> expert_4_ep1_exp3
	expert_4_ep1_exp3 -> expert_comp_4_ep1_exp3
	expert_comp_4_ep1_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep2
	token_route_4_ep2 -> expert_4_ep2_exp0
	expert_4_ep2_exp0 -> expert_comp_4_ep2_exp0
	expert_comp_4_ep2_exp0 -> expert_agg_4
	token_route_4_ep2 -> expert_4_ep2_exp1
	expert_4_ep2_exp1 -> expert_comp_4_ep2_exp1
	expert_comp_4_ep2_exp1 -> expert_agg_4
	token_route_4_ep2 -> expert_4_ep2_exp2
	expert_4_ep2_exp2 -> expert_comp_4_ep2_exp2
	expert_comp_4_ep2_exp2 -> expert_agg_4
	token_route_4_ep2 -> expert_4_ep2_exp3
	expert_4_ep2_exp3 -> expert_comp_4_ep2_exp3
	expert_comp_4_ep2_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep3
	token_route_4_ep3 -> expert_4_ep3_exp0
	expert_4_ep3_exp0 -> expert_comp_4_ep3_exp0
	expert_comp_4_ep3_exp0 -> expert_agg_4
	token_route_4_ep3 -> expert_4_ep3_exp1
	expert_4_ep3_exp1 -> expert_comp_4_ep3_exp1
	expert_comp_4_ep3_exp1 -> expert_agg_4
	token_route_4_ep3 -> expert_4_ep3_exp2
	expert_4_ep3_exp2 -> expert_comp_4_ep3_exp2
	expert_comp_4_ep3_exp2 -> expert_agg_4
	token_route_4_ep3 -> expert_4_ep3_exp3
	expert_4_ep3_exp3 -> expert_comp_4_ep3_exp3
	expert_comp_4_ep3_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep4
	token_route_4_ep4 -> expert_4_ep4_exp0
	expert_4_ep4_exp0 -> expert_comp_4_ep4_exp0
	expert_comp_4_ep4_exp0 -> expert_agg_4
	token_route_4_ep4 -> expert_4_ep4_exp1
	expert_4_ep4_exp1 -> expert_comp_4_ep4_exp1
	expert_comp_4_ep4_exp1 -> expert_agg_4
	token_route_4_ep4 -> expert_4_ep4_exp2
	expert_4_ep4_exp2 -> expert_comp_4_ep4_exp2
	expert_comp_4_ep4_exp2 -> expert_agg_4
	token_route_4_ep4 -> expert_4_ep4_exp3
	expert_4_ep4_exp3 -> expert_comp_4_ep4_exp3
	expert_comp_4_ep4_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep5
	token_route_4_ep5 -> expert_4_ep5_exp0
	expert_4_ep5_exp0 -> expert_comp_4_ep5_exp0
	expert_comp_4_ep5_exp0 -> expert_agg_4
	token_route_4_ep5 -> expert_4_ep5_exp1
	expert_4_ep5_exp1 -> expert_comp_4_ep5_exp1
	expert_comp_4_ep5_exp1 -> expert_agg_4
	token_route_4_ep5 -> expert_4_ep5_exp2
	expert_4_ep5_exp2 -> expert_comp_4_ep5_exp2
	expert_comp_4_ep5_exp2 -> expert_agg_4
	token_route_4_ep5 -> expert_4_ep5_exp3
	expert_4_ep5_exp3 -> expert_comp_4_ep5_exp3
	expert_comp_4_ep5_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep6
	token_route_4_ep6 -> expert_4_ep6_exp0
	expert_4_ep6_exp0 -> expert_comp_4_ep6_exp0
	expert_comp_4_ep6_exp0 -> expert_agg_4
	token_route_4_ep6 -> expert_4_ep6_exp1
	expert_4_ep6_exp1 -> expert_comp_4_ep6_exp1
	expert_comp_4_ep6_exp1 -> expert_agg_4
	token_route_4_ep6 -> expert_4_ep6_exp2
	expert_4_ep6_exp2 -> expert_comp_4_ep6_exp2
	expert_comp_4_ep6_exp2 -> expert_agg_4
	token_route_4_ep6 -> expert_4_ep6_exp3
	expert_4_ep6_exp3 -> expert_comp_4_ep6_exp3
	expert_comp_4_ep6_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep7
	token_route_4_ep7 -> expert_4_ep7_exp0
	expert_4_ep7_exp0 -> expert_comp_4_ep7_exp0
	expert_comp_4_ep7_exp0 -> expert_agg_4
	token_route_4_ep7 -> expert_4_ep7_exp1
	expert_4_ep7_exp1 -> expert_comp_4_ep7_exp1
	expert_comp_4_ep7_exp1 -> expert_agg_4
	token_route_4_ep7 -> expert_4_ep7_exp2
	expert_4_ep7_exp2 -> expert_comp_4_ep7_exp2
	expert_comp_4_ep7_exp2 -> expert_agg_4
	token_route_4_ep7 -> expert_4_ep7_exp3
	expert_4_ep7_exp3 -> expert_comp_4_ep7_exp3
	expert_comp_4_ep7_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep8
	token_route_4_ep8 -> expert_4_ep8_exp0
	expert_4_ep8_exp0 -> expert_comp_4_ep8_exp0
	expert_comp_4_ep8_exp0 -> expert_agg_4
	token_route_4_ep8 -> expert_4_ep8_exp1
	expert_4_ep8_exp1 -> expert_comp_4_ep8_exp1
	expert_comp_4_ep8_exp1 -> expert_agg_4
	token_route_4_ep8 -> expert_4_ep8_exp2
	expert_4_ep8_exp2 -> expert_comp_4_ep8_exp2
	expert_comp_4_ep8_exp2 -> expert_agg_4
	token_route_4_ep8 -> expert_4_ep8_exp3
	expert_4_ep8_exp3 -> expert_comp_4_ep8_exp3
	expert_comp_4_ep8_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep9
	token_route_4_ep9 -> expert_4_ep9_exp0
	expert_4_ep9_exp0 -> expert_comp_4_ep9_exp0
	expert_comp_4_ep9_exp0 -> expert_agg_4
	token_route_4_ep9 -> expert_4_ep9_exp1
	expert_4_ep9_exp1 -> expert_comp_4_ep9_exp1
	expert_comp_4_ep9_exp1 -> expert_agg_4
	token_route_4_ep9 -> expert_4_ep9_exp2
	expert_4_ep9_exp2 -> expert_comp_4_ep9_exp2
	expert_comp_4_ep9_exp2 -> expert_agg_4
	token_route_4_ep9 -> expert_4_ep9_exp3
	expert_4_ep9_exp3 -> expert_comp_4_ep9_exp3
	expert_comp_4_ep9_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep10
	token_route_4_ep10 -> expert_4_ep10_exp0
	expert_4_ep10_exp0 -> expert_comp_4_ep10_exp0
	expert_comp_4_ep10_exp0 -> expert_agg_4
	token_route_4_ep10 -> expert_4_ep10_exp1
	expert_4_ep10_exp1 -> expert_comp_4_ep10_exp1
	expert_comp_4_ep10_exp1 -> expert_agg_4
	token_route_4_ep10 -> expert_4_ep10_exp2
	expert_4_ep10_exp2 -> expert_comp_4_ep10_exp2
	expert_comp_4_ep10_exp2 -> expert_agg_4
	token_route_4_ep10 -> expert_4_ep10_exp3
	expert_4_ep10_exp3 -> expert_comp_4_ep10_exp3
	expert_comp_4_ep10_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep11
	token_route_4_ep11 -> expert_4_ep11_exp0
	expert_4_ep11_exp0 -> expert_comp_4_ep11_exp0
	expert_comp_4_ep11_exp0 -> expert_agg_4
	token_route_4_ep11 -> expert_4_ep11_exp1
	expert_4_ep11_exp1 -> expert_comp_4_ep11_exp1
	expert_comp_4_ep11_exp1 -> expert_agg_4
	token_route_4_ep11 -> expert_4_ep11_exp2
	expert_4_ep11_exp2 -> expert_comp_4_ep11_exp2
	expert_comp_4_ep11_exp2 -> expert_agg_4
	token_route_4_ep11 -> expert_4_ep11_exp3
	expert_4_ep11_exp3 -> expert_comp_4_ep11_exp3
	expert_comp_4_ep11_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep12
	token_route_4_ep12 -> expert_4_ep12_exp0
	expert_4_ep12_exp0 -> expert_comp_4_ep12_exp0
	expert_comp_4_ep12_exp0 -> expert_agg_4
	token_route_4_ep12 -> expert_4_ep12_exp1
	expert_4_ep12_exp1 -> expert_comp_4_ep12_exp1
	expert_comp_4_ep12_exp1 -> expert_agg_4
	token_route_4_ep12 -> expert_4_ep12_exp2
	expert_4_ep12_exp2 -> expert_comp_4_ep12_exp2
	expert_comp_4_ep12_exp2 -> expert_agg_4
	token_route_4_ep12 -> expert_4_ep12_exp3
	expert_4_ep12_exp3 -> expert_comp_4_ep12_exp3
	expert_comp_4_ep12_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep13
	token_route_4_ep13 -> expert_4_ep13_exp0
	expert_4_ep13_exp0 -> expert_comp_4_ep13_exp0
	expert_comp_4_ep13_exp0 -> expert_agg_4
	token_route_4_ep13 -> expert_4_ep13_exp1
	expert_4_ep13_exp1 -> expert_comp_4_ep13_exp1
	expert_comp_4_ep13_exp1 -> expert_agg_4
	token_route_4_ep13 -> expert_4_ep13_exp2
	expert_4_ep13_exp2 -> expert_comp_4_ep13_exp2
	expert_comp_4_ep13_exp2 -> expert_agg_4
	token_route_4_ep13 -> expert_4_ep13_exp3
	expert_4_ep13_exp3 -> expert_comp_4_ep13_exp3
	expert_comp_4_ep13_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep14
	token_route_4_ep14 -> expert_4_ep14_exp0
	expert_4_ep14_exp0 -> expert_comp_4_ep14_exp0
	expert_comp_4_ep14_exp0 -> expert_agg_4
	token_route_4_ep14 -> expert_4_ep14_exp1
	expert_4_ep14_exp1 -> expert_comp_4_ep14_exp1
	expert_comp_4_ep14_exp1 -> expert_agg_4
	token_route_4_ep14 -> expert_4_ep14_exp2
	expert_4_ep14_exp2 -> expert_comp_4_ep14_exp2
	expert_comp_4_ep14_exp2 -> expert_agg_4
	token_route_4_ep14 -> expert_4_ep14_exp3
	expert_4_ep14_exp3 -> expert_comp_4_ep14_exp3
	expert_comp_4_ep14_exp3 -> expert_agg_4
	expert_select_4 -> token_route_4_ep15
	token_route_4_ep15 -> expert_4_ep15_exp0
	expert_4_ep15_exp0 -> expert_comp_4_ep15_exp0
	expert_comp_4_ep15_exp0 -> expert_agg_4
	token_route_4_ep15 -> expert_4_ep15_exp1
	expert_4_ep15_exp1 -> expert_comp_4_ep15_exp1
	expert_comp_4_ep15_exp1 -> expert_agg_4
	token_route_4_ep15 -> expert_4_ep15_exp2
	expert_4_ep15_exp2 -> expert_comp_4_ep15_exp2
	expert_comp_4_ep15_exp2 -> expert_agg_4
	token_route_4_ep15 -> expert_4_ep15_exp3
	expert_4_ep15_exp3 -> expert_comp_4_ep15_exp3
	expert_comp_4_ep15_exp3 -> expert_agg_4
	expert_agg_4 -> moe_out_linear_4_tp0
	moe_out_linear_4_tp0 -> allreduce_moe_4
	moe_out_linear_4_tp1 -> allreduce_moe_4
	moe_out_linear_4_tp2 -> allreduce_moe_4
	moe_out_linear_4_tp3 -> allreduce_moe_4
	allreduce_moe_4 -> layernorm_4
	layernorm_4 -> qkv_linear_5_tp0
	allreduce_att_5 -> gate_5 [style=dashed]
	gate_5 -> expert_select_5
	expert_select_5 -> token_route_5_ep0
	token_route_5_ep0 -> expert_5_ep0_exp0
	expert_5_ep0_exp0 -> expert_comp_5_ep0_exp0
	expert_comp_5_ep0_exp0 -> expert_agg_5
	token_route_5_ep0 -> expert_5_ep0_exp1
	expert_5_ep0_exp1 -> expert_comp_5_ep0_exp1
	expert_comp_5_ep0_exp1 -> expert_agg_5
	token_route_5_ep0 -> expert_5_ep0_exp2
	expert_5_ep0_exp2 -> expert_comp_5_ep0_exp2
	expert_comp_5_ep0_exp2 -> expert_agg_5
	token_route_5_ep0 -> expert_5_ep0_exp3
	expert_5_ep0_exp3 -> expert_comp_5_ep0_exp3
	expert_comp_5_ep0_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep1
	token_route_5_ep1 -> expert_5_ep1_exp0
	expert_5_ep1_exp0 -> expert_comp_5_ep1_exp0
	expert_comp_5_ep1_exp0 -> expert_agg_5
	token_route_5_ep1 -> expert_5_ep1_exp1
	expert_5_ep1_exp1 -> expert_comp_5_ep1_exp1
	expert_comp_5_ep1_exp1 -> expert_agg_5
	token_route_5_ep1 -> expert_5_ep1_exp2
	expert_5_ep1_exp2 -> expert_comp_5_ep1_exp2
	expert_comp_5_ep1_exp2 -> expert_agg_5
	token_route_5_ep1 -> expert_5_ep1_exp3
	expert_5_ep1_exp3 -> expert_comp_5_ep1_exp3
	expert_comp_5_ep1_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep2
	token_route_5_ep2 -> expert_5_ep2_exp0
	expert_5_ep2_exp0 -> expert_comp_5_ep2_exp0
	expert_comp_5_ep2_exp0 -> expert_agg_5
	token_route_5_ep2 -> expert_5_ep2_exp1
	expert_5_ep2_exp1 -> expert_comp_5_ep2_exp1
	expert_comp_5_ep2_exp1 -> expert_agg_5
	token_route_5_ep2 -> expert_5_ep2_exp2
	expert_5_ep2_exp2 -> expert_comp_5_ep2_exp2
	expert_comp_5_ep2_exp2 -> expert_agg_5
	token_route_5_ep2 -> expert_5_ep2_exp3
	expert_5_ep2_exp3 -> expert_comp_5_ep2_exp3
	expert_comp_5_ep2_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep3
	token_route_5_ep3 -> expert_5_ep3_exp0
	expert_5_ep3_exp0 -> expert_comp_5_ep3_exp0
	expert_comp_5_ep3_exp0 -> expert_agg_5
	token_route_5_ep3 -> expert_5_ep3_exp1
	expert_5_ep3_exp1 -> expert_comp_5_ep3_exp1
	expert_comp_5_ep3_exp1 -> expert_agg_5
	token_route_5_ep3 -> expert_5_ep3_exp2
	expert_5_ep3_exp2 -> expert_comp_5_ep3_exp2
	expert_comp_5_ep3_exp2 -> expert_agg_5
	token_route_5_ep3 -> expert_5_ep3_exp3
	expert_5_ep3_exp3 -> expert_comp_5_ep3_exp3
	expert_comp_5_ep3_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep4
	token_route_5_ep4 -> expert_5_ep4_exp0
	expert_5_ep4_exp0 -> expert_comp_5_ep4_exp0
	expert_comp_5_ep4_exp0 -> expert_agg_5
	token_route_5_ep4 -> expert_5_ep4_exp1
	expert_5_ep4_exp1 -> expert_comp_5_ep4_exp1
	expert_comp_5_ep4_exp1 -> expert_agg_5
	token_route_5_ep4 -> expert_5_ep4_exp2
	expert_5_ep4_exp2 -> expert_comp_5_ep4_exp2
	expert_comp_5_ep4_exp2 -> expert_agg_5
	token_route_5_ep4 -> expert_5_ep4_exp3
	expert_5_ep4_exp3 -> expert_comp_5_ep4_exp3
	expert_comp_5_ep4_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep5
	token_route_5_ep5 -> expert_5_ep5_exp0
	expert_5_ep5_exp0 -> expert_comp_5_ep5_exp0
	expert_comp_5_ep5_exp0 -> expert_agg_5
	token_route_5_ep5 -> expert_5_ep5_exp1
	expert_5_ep5_exp1 -> expert_comp_5_ep5_exp1
	expert_comp_5_ep5_exp1 -> expert_agg_5
	token_route_5_ep5 -> expert_5_ep5_exp2
	expert_5_ep5_exp2 -> expert_comp_5_ep5_exp2
	expert_comp_5_ep5_exp2 -> expert_agg_5
	token_route_5_ep5 -> expert_5_ep5_exp3
	expert_5_ep5_exp3 -> expert_comp_5_ep5_exp3
	expert_comp_5_ep5_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep6
	token_route_5_ep6 -> expert_5_ep6_exp0
	expert_5_ep6_exp0 -> expert_comp_5_ep6_exp0
	expert_comp_5_ep6_exp0 -> expert_agg_5
	token_route_5_ep6 -> expert_5_ep6_exp1
	expert_5_ep6_exp1 -> expert_comp_5_ep6_exp1
	expert_comp_5_ep6_exp1 -> expert_agg_5
	token_route_5_ep6 -> expert_5_ep6_exp2
	expert_5_ep6_exp2 -> expert_comp_5_ep6_exp2
	expert_comp_5_ep6_exp2 -> expert_agg_5
	token_route_5_ep6 -> expert_5_ep6_exp3
	expert_5_ep6_exp3 -> expert_comp_5_ep6_exp3
	expert_comp_5_ep6_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep7
	token_route_5_ep7 -> expert_5_ep7_exp0
	expert_5_ep7_exp0 -> expert_comp_5_ep7_exp0
	expert_comp_5_ep7_exp0 -> expert_agg_5
	token_route_5_ep7 -> expert_5_ep7_exp1
	expert_5_ep7_exp1 -> expert_comp_5_ep7_exp1
	expert_comp_5_ep7_exp1 -> expert_agg_5
	token_route_5_ep7 -> expert_5_ep7_exp2
	expert_5_ep7_exp2 -> expert_comp_5_ep7_exp2
	expert_comp_5_ep7_exp2 -> expert_agg_5
	token_route_5_ep7 -> expert_5_ep7_exp3
	expert_5_ep7_exp3 -> expert_comp_5_ep7_exp3
	expert_comp_5_ep7_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep8
	token_route_5_ep8 -> expert_5_ep8_exp0
	expert_5_ep8_exp0 -> expert_comp_5_ep8_exp0
	expert_comp_5_ep8_exp0 -> expert_agg_5
	token_route_5_ep8 -> expert_5_ep8_exp1
	expert_5_ep8_exp1 -> expert_comp_5_ep8_exp1
	expert_comp_5_ep8_exp1 -> expert_agg_5
	token_route_5_ep8 -> expert_5_ep8_exp2
	expert_5_ep8_exp2 -> expert_comp_5_ep8_exp2
	expert_comp_5_ep8_exp2 -> expert_agg_5
	token_route_5_ep8 -> expert_5_ep8_exp3
	expert_5_ep8_exp3 -> expert_comp_5_ep8_exp3
	expert_comp_5_ep8_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep9
	token_route_5_ep9 -> expert_5_ep9_exp0
	expert_5_ep9_exp0 -> expert_comp_5_ep9_exp0
	expert_comp_5_ep9_exp0 -> expert_agg_5
	token_route_5_ep9 -> expert_5_ep9_exp1
	expert_5_ep9_exp1 -> expert_comp_5_ep9_exp1
	expert_comp_5_ep9_exp1 -> expert_agg_5
	token_route_5_ep9 -> expert_5_ep9_exp2
	expert_5_ep9_exp2 -> expert_comp_5_ep9_exp2
	expert_comp_5_ep9_exp2 -> expert_agg_5
	token_route_5_ep9 -> expert_5_ep9_exp3
	expert_5_ep9_exp3 -> expert_comp_5_ep9_exp3
	expert_comp_5_ep9_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep10
	token_route_5_ep10 -> expert_5_ep10_exp0
	expert_5_ep10_exp0 -> expert_comp_5_ep10_exp0
	expert_comp_5_ep10_exp0 -> expert_agg_5
	token_route_5_ep10 -> expert_5_ep10_exp1
	expert_5_ep10_exp1 -> expert_comp_5_ep10_exp1
	expert_comp_5_ep10_exp1 -> expert_agg_5
	token_route_5_ep10 -> expert_5_ep10_exp2
	expert_5_ep10_exp2 -> expert_comp_5_ep10_exp2
	expert_comp_5_ep10_exp2 -> expert_agg_5
	token_route_5_ep10 -> expert_5_ep10_exp3
	expert_5_ep10_exp3 -> expert_comp_5_ep10_exp3
	expert_comp_5_ep10_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep11
	token_route_5_ep11 -> expert_5_ep11_exp0
	expert_5_ep11_exp0 -> expert_comp_5_ep11_exp0
	expert_comp_5_ep11_exp0 -> expert_agg_5
	token_route_5_ep11 -> expert_5_ep11_exp1
	expert_5_ep11_exp1 -> expert_comp_5_ep11_exp1
	expert_comp_5_ep11_exp1 -> expert_agg_5
	token_route_5_ep11 -> expert_5_ep11_exp2
	expert_5_ep11_exp2 -> expert_comp_5_ep11_exp2
	expert_comp_5_ep11_exp2 -> expert_agg_5
	token_route_5_ep11 -> expert_5_ep11_exp3
	expert_5_ep11_exp3 -> expert_comp_5_ep11_exp3
	expert_comp_5_ep11_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep12
	token_route_5_ep12 -> expert_5_ep12_exp0
	expert_5_ep12_exp0 -> expert_comp_5_ep12_exp0
	expert_comp_5_ep12_exp0 -> expert_agg_5
	token_route_5_ep12 -> expert_5_ep12_exp1
	expert_5_ep12_exp1 -> expert_comp_5_ep12_exp1
	expert_comp_5_ep12_exp1 -> expert_agg_5
	token_route_5_ep12 -> expert_5_ep12_exp2
	expert_5_ep12_exp2 -> expert_comp_5_ep12_exp2
	expert_comp_5_ep12_exp2 -> expert_agg_5
	token_route_5_ep12 -> expert_5_ep12_exp3
	expert_5_ep12_exp3 -> expert_comp_5_ep12_exp3
	expert_comp_5_ep12_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep13
	token_route_5_ep13 -> expert_5_ep13_exp0
	expert_5_ep13_exp0 -> expert_comp_5_ep13_exp0
	expert_comp_5_ep13_exp0 -> expert_agg_5
	token_route_5_ep13 -> expert_5_ep13_exp1
	expert_5_ep13_exp1 -> expert_comp_5_ep13_exp1
	expert_comp_5_ep13_exp1 -> expert_agg_5
	token_route_5_ep13 -> expert_5_ep13_exp2
	expert_5_ep13_exp2 -> expert_comp_5_ep13_exp2
	expert_comp_5_ep13_exp2 -> expert_agg_5
	token_route_5_ep13 -> expert_5_ep13_exp3
	expert_5_ep13_exp3 -> expert_comp_5_ep13_exp3
	expert_comp_5_ep13_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep14
	token_route_5_ep14 -> expert_5_ep14_exp0
	expert_5_ep14_exp0 -> expert_comp_5_ep14_exp0
	expert_comp_5_ep14_exp0 -> expert_agg_5
	token_route_5_ep14 -> expert_5_ep14_exp1
	expert_5_ep14_exp1 -> expert_comp_5_ep14_exp1
	expert_comp_5_ep14_exp1 -> expert_agg_5
	token_route_5_ep14 -> expert_5_ep14_exp2
	expert_5_ep14_exp2 -> expert_comp_5_ep14_exp2
	expert_comp_5_ep14_exp2 -> expert_agg_5
	token_route_5_ep14 -> expert_5_ep14_exp3
	expert_5_ep14_exp3 -> expert_comp_5_ep14_exp3
	expert_comp_5_ep14_exp3 -> expert_agg_5
	expert_select_5 -> token_route_5_ep15
	token_route_5_ep15 -> expert_5_ep15_exp0
	expert_5_ep15_exp0 -> expert_comp_5_ep15_exp0
	expert_comp_5_ep15_exp0 -> expert_agg_5
	token_route_5_ep15 -> expert_5_ep15_exp1
	expert_5_ep15_exp1 -> expert_comp_5_ep15_exp1
	expert_comp_5_ep15_exp1 -> expert_agg_5
	token_route_5_ep15 -> expert_5_ep15_exp2
	expert_5_ep15_exp2 -> expert_comp_5_ep15_exp2
	expert_comp_5_ep15_exp2 -> expert_agg_5
	token_route_5_ep15 -> expert_5_ep15_exp3
	expert_5_ep15_exp3 -> expert_comp_5_ep15_exp3
	expert_comp_5_ep15_exp3 -> expert_agg_5
	expert_agg_5 -> moe_out_linear_5_tp0
	moe_out_linear_5_tp0 -> allreduce_moe_5
	moe_out_linear_5_tp1 -> allreduce_moe_5
	moe_out_linear_5_tp2 -> allreduce_moe_5
	moe_out_linear_5_tp3 -> allreduce_moe_5
	allreduce_moe_5 -> layernorm_5
	layernorm_5 -> qkv_linear_6_tp0
	allreduce_att_6 -> gate_6 [style=dashed]
	gate_6 -> expert_select_6
	expert_select_6 -> token_route_6_ep0
	token_route_6_ep0 -> expert_6_ep0_exp0
	expert_6_ep0_exp0 -> expert_comp_6_ep0_exp0
	expert_comp_6_ep0_exp0 -> expert_agg_6
	token_route_6_ep0 -> expert_6_ep0_exp1
	expert_6_ep0_exp1 -> expert_comp_6_ep0_exp1
	expert_comp_6_ep0_exp1 -> expert_agg_6
	token_route_6_ep0 -> expert_6_ep0_exp2
	expert_6_ep0_exp2 -> expert_comp_6_ep0_exp2
	expert_comp_6_ep0_exp2 -> expert_agg_6
	token_route_6_ep0 -> expert_6_ep0_exp3
	expert_6_ep0_exp3 -> expert_comp_6_ep0_exp3
	expert_comp_6_ep0_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep1
	token_route_6_ep1 -> expert_6_ep1_exp0
	expert_6_ep1_exp0 -> expert_comp_6_ep1_exp0
	expert_comp_6_ep1_exp0 -> expert_agg_6
	token_route_6_ep1 -> expert_6_ep1_exp1
	expert_6_ep1_exp1 -> expert_comp_6_ep1_exp1
	expert_comp_6_ep1_exp1 -> expert_agg_6
	token_route_6_ep1 -> expert_6_ep1_exp2
	expert_6_ep1_exp2 -> expert_comp_6_ep1_exp2
	expert_comp_6_ep1_exp2 -> expert_agg_6
	token_route_6_ep1 -> expert_6_ep1_exp3
	expert_6_ep1_exp3 -> expert_comp_6_ep1_exp3
	expert_comp_6_ep1_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep2
	token_route_6_ep2 -> expert_6_ep2_exp0
	expert_6_ep2_exp0 -> expert_comp_6_ep2_exp0
	expert_comp_6_ep2_exp0 -> expert_agg_6
	token_route_6_ep2 -> expert_6_ep2_exp1
	expert_6_ep2_exp1 -> expert_comp_6_ep2_exp1
	expert_comp_6_ep2_exp1 -> expert_agg_6
	token_route_6_ep2 -> expert_6_ep2_exp2
	expert_6_ep2_exp2 -> expert_comp_6_ep2_exp2
	expert_comp_6_ep2_exp2 -> expert_agg_6
	token_route_6_ep2 -> expert_6_ep2_exp3
	expert_6_ep2_exp3 -> expert_comp_6_ep2_exp3
	expert_comp_6_ep2_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep3
	token_route_6_ep3 -> expert_6_ep3_exp0
	expert_6_ep3_exp0 -> expert_comp_6_ep3_exp0
	expert_comp_6_ep3_exp0 -> expert_agg_6
	token_route_6_ep3 -> expert_6_ep3_exp1
	expert_6_ep3_exp1 -> expert_comp_6_ep3_exp1
	expert_comp_6_ep3_exp1 -> expert_agg_6
	token_route_6_ep3 -> expert_6_ep3_exp2
	expert_6_ep3_exp2 -> expert_comp_6_ep3_exp2
	expert_comp_6_ep3_exp2 -> expert_agg_6
	token_route_6_ep3 -> expert_6_ep3_exp3
	expert_6_ep3_exp3 -> expert_comp_6_ep3_exp3
	expert_comp_6_ep3_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep4
	token_route_6_ep4 -> expert_6_ep4_exp0
	expert_6_ep4_exp0 -> expert_comp_6_ep4_exp0
	expert_comp_6_ep4_exp0 -> expert_agg_6
	token_route_6_ep4 -> expert_6_ep4_exp1
	expert_6_ep4_exp1 -> expert_comp_6_ep4_exp1
	expert_comp_6_ep4_exp1 -> expert_agg_6
	token_route_6_ep4 -> expert_6_ep4_exp2
	expert_6_ep4_exp2 -> expert_comp_6_ep4_exp2
	expert_comp_6_ep4_exp2 -> expert_agg_6
	token_route_6_ep4 -> expert_6_ep4_exp3
	expert_6_ep4_exp3 -> expert_comp_6_ep4_exp3
	expert_comp_6_ep4_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep5
	token_route_6_ep5 -> expert_6_ep5_exp0
	expert_6_ep5_exp0 -> expert_comp_6_ep5_exp0
	expert_comp_6_ep5_exp0 -> expert_agg_6
	token_route_6_ep5 -> expert_6_ep5_exp1
	expert_6_ep5_exp1 -> expert_comp_6_ep5_exp1
	expert_comp_6_ep5_exp1 -> expert_agg_6
	token_route_6_ep5 -> expert_6_ep5_exp2
	expert_6_ep5_exp2 -> expert_comp_6_ep5_exp2
	expert_comp_6_ep5_exp2 -> expert_agg_6
	token_route_6_ep5 -> expert_6_ep5_exp3
	expert_6_ep5_exp3 -> expert_comp_6_ep5_exp3
	expert_comp_6_ep5_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep6
	token_route_6_ep6 -> expert_6_ep6_exp0
	expert_6_ep6_exp0 -> expert_comp_6_ep6_exp0
	expert_comp_6_ep6_exp0 -> expert_agg_6
	token_route_6_ep6 -> expert_6_ep6_exp1
	expert_6_ep6_exp1 -> expert_comp_6_ep6_exp1
	expert_comp_6_ep6_exp1 -> expert_agg_6
	token_route_6_ep6 -> expert_6_ep6_exp2
	expert_6_ep6_exp2 -> expert_comp_6_ep6_exp2
	expert_comp_6_ep6_exp2 -> expert_agg_6
	token_route_6_ep6 -> expert_6_ep6_exp3
	expert_6_ep6_exp3 -> expert_comp_6_ep6_exp3
	expert_comp_6_ep6_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep7
	token_route_6_ep7 -> expert_6_ep7_exp0
	expert_6_ep7_exp0 -> expert_comp_6_ep7_exp0
	expert_comp_6_ep7_exp0 -> expert_agg_6
	token_route_6_ep7 -> expert_6_ep7_exp1
	expert_6_ep7_exp1 -> expert_comp_6_ep7_exp1
	expert_comp_6_ep7_exp1 -> expert_agg_6
	token_route_6_ep7 -> expert_6_ep7_exp2
	expert_6_ep7_exp2 -> expert_comp_6_ep7_exp2
	expert_comp_6_ep7_exp2 -> expert_agg_6
	token_route_6_ep7 -> expert_6_ep7_exp3
	expert_6_ep7_exp3 -> expert_comp_6_ep7_exp3
	expert_comp_6_ep7_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep8
	token_route_6_ep8 -> expert_6_ep8_exp0
	expert_6_ep8_exp0 -> expert_comp_6_ep8_exp0
	expert_comp_6_ep8_exp0 -> expert_agg_6
	token_route_6_ep8 -> expert_6_ep8_exp1
	expert_6_ep8_exp1 -> expert_comp_6_ep8_exp1
	expert_comp_6_ep8_exp1 -> expert_agg_6
	token_route_6_ep8 -> expert_6_ep8_exp2
	expert_6_ep8_exp2 -> expert_comp_6_ep8_exp2
	expert_comp_6_ep8_exp2 -> expert_agg_6
	token_route_6_ep8 -> expert_6_ep8_exp3
	expert_6_ep8_exp3 -> expert_comp_6_ep8_exp3
	expert_comp_6_ep8_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep9
	token_route_6_ep9 -> expert_6_ep9_exp0
	expert_6_ep9_exp0 -> expert_comp_6_ep9_exp0
	expert_comp_6_ep9_exp0 -> expert_agg_6
	token_route_6_ep9 -> expert_6_ep9_exp1
	expert_6_ep9_exp1 -> expert_comp_6_ep9_exp1
	expert_comp_6_ep9_exp1 -> expert_agg_6
	token_route_6_ep9 -> expert_6_ep9_exp2
	expert_6_ep9_exp2 -> expert_comp_6_ep9_exp2
	expert_comp_6_ep9_exp2 -> expert_agg_6
	token_route_6_ep9 -> expert_6_ep9_exp3
	expert_6_ep9_exp3 -> expert_comp_6_ep9_exp3
	expert_comp_6_ep9_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep10
	token_route_6_ep10 -> expert_6_ep10_exp0
	expert_6_ep10_exp0 -> expert_comp_6_ep10_exp0
	expert_comp_6_ep10_exp0 -> expert_agg_6
	token_route_6_ep10 -> expert_6_ep10_exp1
	expert_6_ep10_exp1 -> expert_comp_6_ep10_exp1
	expert_comp_6_ep10_exp1 -> expert_agg_6
	token_route_6_ep10 -> expert_6_ep10_exp2
	expert_6_ep10_exp2 -> expert_comp_6_ep10_exp2
	expert_comp_6_ep10_exp2 -> expert_agg_6
	token_route_6_ep10 -> expert_6_ep10_exp3
	expert_6_ep10_exp3 -> expert_comp_6_ep10_exp3
	expert_comp_6_ep10_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep11
	token_route_6_ep11 -> expert_6_ep11_exp0
	expert_6_ep11_exp0 -> expert_comp_6_ep11_exp0
	expert_comp_6_ep11_exp0 -> expert_agg_6
	token_route_6_ep11 -> expert_6_ep11_exp1
	expert_6_ep11_exp1 -> expert_comp_6_ep11_exp1
	expert_comp_6_ep11_exp1 -> expert_agg_6
	token_route_6_ep11 -> expert_6_ep11_exp2
	expert_6_ep11_exp2 -> expert_comp_6_ep11_exp2
	expert_comp_6_ep11_exp2 -> expert_agg_6
	token_route_6_ep11 -> expert_6_ep11_exp3
	expert_6_ep11_exp3 -> expert_comp_6_ep11_exp3
	expert_comp_6_ep11_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep12
	token_route_6_ep12 -> expert_6_ep12_exp0
	expert_6_ep12_exp0 -> expert_comp_6_ep12_exp0
	expert_comp_6_ep12_exp0 -> expert_agg_6
	token_route_6_ep12 -> expert_6_ep12_exp1
	expert_6_ep12_exp1 -> expert_comp_6_ep12_exp1
	expert_comp_6_ep12_exp1 -> expert_agg_6
	token_route_6_ep12 -> expert_6_ep12_exp2
	expert_6_ep12_exp2 -> expert_comp_6_ep12_exp2
	expert_comp_6_ep12_exp2 -> expert_agg_6
	token_route_6_ep12 -> expert_6_ep12_exp3
	expert_6_ep12_exp3 -> expert_comp_6_ep12_exp3
	expert_comp_6_ep12_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep13
	token_route_6_ep13 -> expert_6_ep13_exp0
	expert_6_ep13_exp0 -> expert_comp_6_ep13_exp0
	expert_comp_6_ep13_exp0 -> expert_agg_6
	token_route_6_ep13 -> expert_6_ep13_exp1
	expert_6_ep13_exp1 -> expert_comp_6_ep13_exp1
	expert_comp_6_ep13_exp1 -> expert_agg_6
	token_route_6_ep13 -> expert_6_ep13_exp2
	expert_6_ep13_exp2 -> expert_comp_6_ep13_exp2
	expert_comp_6_ep13_exp2 -> expert_agg_6
	token_route_6_ep13 -> expert_6_ep13_exp3
	expert_6_ep13_exp3 -> expert_comp_6_ep13_exp3
	expert_comp_6_ep13_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep14
	token_route_6_ep14 -> expert_6_ep14_exp0
	expert_6_ep14_exp0 -> expert_comp_6_ep14_exp0
	expert_comp_6_ep14_exp0 -> expert_agg_6
	token_route_6_ep14 -> expert_6_ep14_exp1
	expert_6_ep14_exp1 -> expert_comp_6_ep14_exp1
	expert_comp_6_ep14_exp1 -> expert_agg_6
	token_route_6_ep14 -> expert_6_ep14_exp2
	expert_6_ep14_exp2 -> expert_comp_6_ep14_exp2
	expert_comp_6_ep14_exp2 -> expert_agg_6
	token_route_6_ep14 -> expert_6_ep14_exp3
	expert_6_ep14_exp3 -> expert_comp_6_ep14_exp3
	expert_comp_6_ep14_exp3 -> expert_agg_6
	expert_select_6 -> token_route_6_ep15
	token_route_6_ep15 -> expert_6_ep15_exp0
	expert_6_ep15_exp0 -> expert_comp_6_ep15_exp0
	expert_comp_6_ep15_exp0 -> expert_agg_6
	token_route_6_ep15 -> expert_6_ep15_exp1
	expert_6_ep15_exp1 -> expert_comp_6_ep15_exp1
	expert_comp_6_ep15_exp1 -> expert_agg_6
	token_route_6_ep15 -> expert_6_ep15_exp2
	expert_6_ep15_exp2 -> expert_comp_6_ep15_exp2
	expert_comp_6_ep15_exp2 -> expert_agg_6
	token_route_6_ep15 -> expert_6_ep15_exp3
	expert_6_ep15_exp3 -> expert_comp_6_ep15_exp3
	expert_comp_6_ep15_exp3 -> expert_agg_6
	expert_agg_6 -> moe_out_linear_6_tp0
	moe_out_linear_6_tp0 -> allreduce_moe_6
	moe_out_linear_6_tp1 -> allreduce_moe_6
	moe_out_linear_6_tp2 -> allreduce_moe_6
	moe_out_linear_6_tp3 -> allreduce_moe_6
	allreduce_moe_6 -> layernorm_6
	layernorm_6 -> qkv_linear_7_tp0
	allreduce_att_7 -> gate_7 [style=dashed]
	gate_7 -> expert_select_7
	expert_select_7 -> token_route_7_ep0
	token_route_7_ep0 -> expert_7_ep0_exp0
	expert_7_ep0_exp0 -> expert_comp_7_ep0_exp0
	expert_comp_7_ep0_exp0 -> expert_agg_7
	token_route_7_ep0 -> expert_7_ep0_exp1
	expert_7_ep0_exp1 -> expert_comp_7_ep0_exp1
	expert_comp_7_ep0_exp1 -> expert_agg_7
	token_route_7_ep0 -> expert_7_ep0_exp2
	expert_7_ep0_exp2 -> expert_comp_7_ep0_exp2
	expert_comp_7_ep0_exp2 -> expert_agg_7
	token_route_7_ep0 -> expert_7_ep0_exp3
	expert_7_ep0_exp3 -> expert_comp_7_ep0_exp3
	expert_comp_7_ep0_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep1
	token_route_7_ep1 -> expert_7_ep1_exp0
	expert_7_ep1_exp0 -> expert_comp_7_ep1_exp0
	expert_comp_7_ep1_exp0 -> expert_agg_7
	token_route_7_ep1 -> expert_7_ep1_exp1
	expert_7_ep1_exp1 -> expert_comp_7_ep1_exp1
	expert_comp_7_ep1_exp1 -> expert_agg_7
	token_route_7_ep1 -> expert_7_ep1_exp2
	expert_7_ep1_exp2 -> expert_comp_7_ep1_exp2
	expert_comp_7_ep1_exp2 -> expert_agg_7
	token_route_7_ep1 -> expert_7_ep1_exp3
	expert_7_ep1_exp3 -> expert_comp_7_ep1_exp3
	expert_comp_7_ep1_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep2
	token_route_7_ep2 -> expert_7_ep2_exp0
	expert_7_ep2_exp0 -> expert_comp_7_ep2_exp0
	expert_comp_7_ep2_exp0 -> expert_agg_7
	token_route_7_ep2 -> expert_7_ep2_exp1
	expert_7_ep2_exp1 -> expert_comp_7_ep2_exp1
	expert_comp_7_ep2_exp1 -> expert_agg_7
	token_route_7_ep2 -> expert_7_ep2_exp2
	expert_7_ep2_exp2 -> expert_comp_7_ep2_exp2
	expert_comp_7_ep2_exp2 -> expert_agg_7
	token_route_7_ep2 -> expert_7_ep2_exp3
	expert_7_ep2_exp3 -> expert_comp_7_ep2_exp3
	expert_comp_7_ep2_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep3
	token_route_7_ep3 -> expert_7_ep3_exp0
	expert_7_ep3_exp0 -> expert_comp_7_ep3_exp0
	expert_comp_7_ep3_exp0 -> expert_agg_7
	token_route_7_ep3 -> expert_7_ep3_exp1
	expert_7_ep3_exp1 -> expert_comp_7_ep3_exp1
	expert_comp_7_ep3_exp1 -> expert_agg_7
	token_route_7_ep3 -> expert_7_ep3_exp2
	expert_7_ep3_exp2 -> expert_comp_7_ep3_exp2
	expert_comp_7_ep3_exp2 -> expert_agg_7
	token_route_7_ep3 -> expert_7_ep3_exp3
	expert_7_ep3_exp3 -> expert_comp_7_ep3_exp3
	expert_comp_7_ep3_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep4
	token_route_7_ep4 -> expert_7_ep4_exp0
	expert_7_ep4_exp0 -> expert_comp_7_ep4_exp0
	expert_comp_7_ep4_exp0 -> expert_agg_7
	token_route_7_ep4 -> expert_7_ep4_exp1
	expert_7_ep4_exp1 -> expert_comp_7_ep4_exp1
	expert_comp_7_ep4_exp1 -> expert_agg_7
	token_route_7_ep4 -> expert_7_ep4_exp2
	expert_7_ep4_exp2 -> expert_comp_7_ep4_exp2
	expert_comp_7_ep4_exp2 -> expert_agg_7
	token_route_7_ep4 -> expert_7_ep4_exp3
	expert_7_ep4_exp3 -> expert_comp_7_ep4_exp3
	expert_comp_7_ep4_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep5
	token_route_7_ep5 -> expert_7_ep5_exp0
	expert_7_ep5_exp0 -> expert_comp_7_ep5_exp0
	expert_comp_7_ep5_exp0 -> expert_agg_7
	token_route_7_ep5 -> expert_7_ep5_exp1
	expert_7_ep5_exp1 -> expert_comp_7_ep5_exp1
	expert_comp_7_ep5_exp1 -> expert_agg_7
	token_route_7_ep5 -> expert_7_ep5_exp2
	expert_7_ep5_exp2 -> expert_comp_7_ep5_exp2
	expert_comp_7_ep5_exp2 -> expert_agg_7
	token_route_7_ep5 -> expert_7_ep5_exp3
	expert_7_ep5_exp3 -> expert_comp_7_ep5_exp3
	expert_comp_7_ep5_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep6
	token_route_7_ep6 -> expert_7_ep6_exp0
	expert_7_ep6_exp0 -> expert_comp_7_ep6_exp0
	expert_comp_7_ep6_exp0 -> expert_agg_7
	token_route_7_ep6 -> expert_7_ep6_exp1
	expert_7_ep6_exp1 -> expert_comp_7_ep6_exp1
	expert_comp_7_ep6_exp1 -> expert_agg_7
	token_route_7_ep6 -> expert_7_ep6_exp2
	expert_7_ep6_exp2 -> expert_comp_7_ep6_exp2
	expert_comp_7_ep6_exp2 -> expert_agg_7
	token_route_7_ep6 -> expert_7_ep6_exp3
	expert_7_ep6_exp3 -> expert_comp_7_ep6_exp3
	expert_comp_7_ep6_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep7
	token_route_7_ep7 -> expert_7_ep7_exp0
	expert_7_ep7_exp0 -> expert_comp_7_ep7_exp0
	expert_comp_7_ep7_exp0 -> expert_agg_7
	token_route_7_ep7 -> expert_7_ep7_exp1
	expert_7_ep7_exp1 -> expert_comp_7_ep7_exp1
	expert_comp_7_ep7_exp1 -> expert_agg_7
	token_route_7_ep7 -> expert_7_ep7_exp2
	expert_7_ep7_exp2 -> expert_comp_7_ep7_exp2
	expert_comp_7_ep7_exp2 -> expert_agg_7
	token_route_7_ep7 -> expert_7_ep7_exp3
	expert_7_ep7_exp3 -> expert_comp_7_ep7_exp3
	expert_comp_7_ep7_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep8
	token_route_7_ep8 -> expert_7_ep8_exp0
	expert_7_ep8_exp0 -> expert_comp_7_ep8_exp0
	expert_comp_7_ep8_exp0 -> expert_agg_7
	token_route_7_ep8 -> expert_7_ep8_exp1
	expert_7_ep8_exp1 -> expert_comp_7_ep8_exp1
	expert_comp_7_ep8_exp1 -> expert_agg_7
	token_route_7_ep8 -> expert_7_ep8_exp2
	expert_7_ep8_exp2 -> expert_comp_7_ep8_exp2
	expert_comp_7_ep8_exp2 -> expert_agg_7
	token_route_7_ep8 -> expert_7_ep8_exp3
	expert_7_ep8_exp3 -> expert_comp_7_ep8_exp3
	expert_comp_7_ep8_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep9
	token_route_7_ep9 -> expert_7_ep9_exp0
	expert_7_ep9_exp0 -> expert_comp_7_ep9_exp0
	expert_comp_7_ep9_exp0 -> expert_agg_7
	token_route_7_ep9 -> expert_7_ep9_exp1
	expert_7_ep9_exp1 -> expert_comp_7_ep9_exp1
	expert_comp_7_ep9_exp1 -> expert_agg_7
	token_route_7_ep9 -> expert_7_ep9_exp2
	expert_7_ep9_exp2 -> expert_comp_7_ep9_exp2
	expert_comp_7_ep9_exp2 -> expert_agg_7
	token_route_7_ep9 -> expert_7_ep9_exp3
	expert_7_ep9_exp3 -> expert_comp_7_ep9_exp3
	expert_comp_7_ep9_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep10
	token_route_7_ep10 -> expert_7_ep10_exp0
	expert_7_ep10_exp0 -> expert_comp_7_ep10_exp0
	expert_comp_7_ep10_exp0 -> expert_agg_7
	token_route_7_ep10 -> expert_7_ep10_exp1
	expert_7_ep10_exp1 -> expert_comp_7_ep10_exp1
	expert_comp_7_ep10_exp1 -> expert_agg_7
	token_route_7_ep10 -> expert_7_ep10_exp2
	expert_7_ep10_exp2 -> expert_comp_7_ep10_exp2
	expert_comp_7_ep10_exp2 -> expert_agg_7
	token_route_7_ep10 -> expert_7_ep10_exp3
	expert_7_ep10_exp3 -> expert_comp_7_ep10_exp3
	expert_comp_7_ep10_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep11
	token_route_7_ep11 -> expert_7_ep11_exp0
	expert_7_ep11_exp0 -> expert_comp_7_ep11_exp0
	expert_comp_7_ep11_exp0 -> expert_agg_7
	token_route_7_ep11 -> expert_7_ep11_exp1
	expert_7_ep11_exp1 -> expert_comp_7_ep11_exp1
	expert_comp_7_ep11_exp1 -> expert_agg_7
	token_route_7_ep11 -> expert_7_ep11_exp2
	expert_7_ep11_exp2 -> expert_comp_7_ep11_exp2
	expert_comp_7_ep11_exp2 -> expert_agg_7
	token_route_7_ep11 -> expert_7_ep11_exp3
	expert_7_ep11_exp3 -> expert_comp_7_ep11_exp3
	expert_comp_7_ep11_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep12
	token_route_7_ep12 -> expert_7_ep12_exp0
	expert_7_ep12_exp0 -> expert_comp_7_ep12_exp0
	expert_comp_7_ep12_exp0 -> expert_agg_7
	token_route_7_ep12 -> expert_7_ep12_exp1
	expert_7_ep12_exp1 -> expert_comp_7_ep12_exp1
	expert_comp_7_ep12_exp1 -> expert_agg_7
	token_route_7_ep12 -> expert_7_ep12_exp2
	expert_7_ep12_exp2 -> expert_comp_7_ep12_exp2
	expert_comp_7_ep12_exp2 -> expert_agg_7
	token_route_7_ep12 -> expert_7_ep12_exp3
	expert_7_ep12_exp3 -> expert_comp_7_ep12_exp3
	expert_comp_7_ep12_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep13
	token_route_7_ep13 -> expert_7_ep13_exp0
	expert_7_ep13_exp0 -> expert_comp_7_ep13_exp0
	expert_comp_7_ep13_exp0 -> expert_agg_7
	token_route_7_ep13 -> expert_7_ep13_exp1
	expert_7_ep13_exp1 -> expert_comp_7_ep13_exp1
	expert_comp_7_ep13_exp1 -> expert_agg_7
	token_route_7_ep13 -> expert_7_ep13_exp2
	expert_7_ep13_exp2 -> expert_comp_7_ep13_exp2
	expert_comp_7_ep13_exp2 -> expert_agg_7
	token_route_7_ep13 -> expert_7_ep13_exp3
	expert_7_ep13_exp3 -> expert_comp_7_ep13_exp3
	expert_comp_7_ep13_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep14
	token_route_7_ep14 -> expert_7_ep14_exp0
	expert_7_ep14_exp0 -> expert_comp_7_ep14_exp0
	expert_comp_7_ep14_exp0 -> expert_agg_7
	token_route_7_ep14 -> expert_7_ep14_exp1
	expert_7_ep14_exp1 -> expert_comp_7_ep14_exp1
	expert_comp_7_ep14_exp1 -> expert_agg_7
	token_route_7_ep14 -> expert_7_ep14_exp2
	expert_7_ep14_exp2 -> expert_comp_7_ep14_exp2
	expert_comp_7_ep14_exp2 -> expert_agg_7
	token_route_7_ep14 -> expert_7_ep14_exp3
	expert_7_ep14_exp3 -> expert_comp_7_ep14_exp3
	expert_comp_7_ep14_exp3 -> expert_agg_7
	expert_select_7 -> token_route_7_ep15
	token_route_7_ep15 -> expert_7_ep15_exp0
	expert_7_ep15_exp0 -> expert_comp_7_ep15_exp0
	expert_comp_7_ep15_exp0 -> expert_agg_7
	token_route_7_ep15 -> expert_7_ep15_exp1
	expert_7_ep15_exp1 -> expert_comp_7_ep15_exp1
	expert_comp_7_ep15_exp1 -> expert_agg_7
	token_route_7_ep15 -> expert_7_ep15_exp2
	expert_7_ep15_exp2 -> expert_comp_7_ep15_exp2
	expert_comp_7_ep15_exp2 -> expert_agg_7
	token_route_7_ep15 -> expert_7_ep15_exp3
	expert_7_ep15_exp3 -> expert_comp_7_ep15_exp3
	expert_comp_7_ep15_exp3 -> expert_agg_7
	expert_agg_7 -> moe_out_linear_7_tp0
	moe_out_linear_7_tp0 -> allreduce_moe_7
	moe_out_linear_7_tp1 -> allreduce_moe_7
	moe_out_linear_7_tp2 -> allreduce_moe_7
	moe_out_linear_7_tp3 -> allreduce_moe_7
	allreduce_moe_7 -> layernorm_7
	layernorm_7 -> qkv_linear_8_tp0
	allreduce_att_8 -> gate_8 [style=dashed]
	gate_8 -> expert_select_8
	expert_select_8 -> token_route_8_ep0
	token_route_8_ep0 -> expert_8_ep0_exp0
	expert_8_ep0_exp0 -> expert_comp_8_ep0_exp0
	expert_comp_8_ep0_exp0 -> expert_agg_8
	token_route_8_ep0 -> expert_8_ep0_exp1
	expert_8_ep0_exp1 -> expert_comp_8_ep0_exp1
	expert_comp_8_ep0_exp1 -> expert_agg_8
	token_route_8_ep0 -> expert_8_ep0_exp2
	expert_8_ep0_exp2 -> expert_comp_8_ep0_exp2
	expert_comp_8_ep0_exp2 -> expert_agg_8
	token_route_8_ep0 -> expert_8_ep0_exp3
	expert_8_ep0_exp3 -> expert_comp_8_ep0_exp3
	expert_comp_8_ep0_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep1
	token_route_8_ep1 -> expert_8_ep1_exp0
	expert_8_ep1_exp0 -> expert_comp_8_ep1_exp0
	expert_comp_8_ep1_exp0 -> expert_agg_8
	token_route_8_ep1 -> expert_8_ep1_exp1
	expert_8_ep1_exp1 -> expert_comp_8_ep1_exp1
	expert_comp_8_ep1_exp1 -> expert_agg_8
	token_route_8_ep1 -> expert_8_ep1_exp2
	expert_8_ep1_exp2 -> expert_comp_8_ep1_exp2
	expert_comp_8_ep1_exp2 -> expert_agg_8
	token_route_8_ep1 -> expert_8_ep1_exp3
	expert_8_ep1_exp3 -> expert_comp_8_ep1_exp3
	expert_comp_8_ep1_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep2
	token_route_8_ep2 -> expert_8_ep2_exp0
	expert_8_ep2_exp0 -> expert_comp_8_ep2_exp0
	expert_comp_8_ep2_exp0 -> expert_agg_8
	token_route_8_ep2 -> expert_8_ep2_exp1
	expert_8_ep2_exp1 -> expert_comp_8_ep2_exp1
	expert_comp_8_ep2_exp1 -> expert_agg_8
	token_route_8_ep2 -> expert_8_ep2_exp2
	expert_8_ep2_exp2 -> expert_comp_8_ep2_exp2
	expert_comp_8_ep2_exp2 -> expert_agg_8
	token_route_8_ep2 -> expert_8_ep2_exp3
	expert_8_ep2_exp3 -> expert_comp_8_ep2_exp3
	expert_comp_8_ep2_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep3
	token_route_8_ep3 -> expert_8_ep3_exp0
	expert_8_ep3_exp0 -> expert_comp_8_ep3_exp0
	expert_comp_8_ep3_exp0 -> expert_agg_8
	token_route_8_ep3 -> expert_8_ep3_exp1
	expert_8_ep3_exp1 -> expert_comp_8_ep3_exp1
	expert_comp_8_ep3_exp1 -> expert_agg_8
	token_route_8_ep3 -> expert_8_ep3_exp2
	expert_8_ep3_exp2 -> expert_comp_8_ep3_exp2
	expert_comp_8_ep3_exp2 -> expert_agg_8
	token_route_8_ep3 -> expert_8_ep3_exp3
	expert_8_ep3_exp3 -> expert_comp_8_ep3_exp3
	expert_comp_8_ep3_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep4
	token_route_8_ep4 -> expert_8_ep4_exp0
	expert_8_ep4_exp0 -> expert_comp_8_ep4_exp0
	expert_comp_8_ep4_exp0 -> expert_agg_8
	token_route_8_ep4 -> expert_8_ep4_exp1
	expert_8_ep4_exp1 -> expert_comp_8_ep4_exp1
	expert_comp_8_ep4_exp1 -> expert_agg_8
	token_route_8_ep4 -> expert_8_ep4_exp2
	expert_8_ep4_exp2 -> expert_comp_8_ep4_exp2
	expert_comp_8_ep4_exp2 -> expert_agg_8
	token_route_8_ep4 -> expert_8_ep4_exp3
	expert_8_ep4_exp3 -> expert_comp_8_ep4_exp3
	expert_comp_8_ep4_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep5
	token_route_8_ep5 -> expert_8_ep5_exp0
	expert_8_ep5_exp0 -> expert_comp_8_ep5_exp0
	expert_comp_8_ep5_exp0 -> expert_agg_8
	token_route_8_ep5 -> expert_8_ep5_exp1
	expert_8_ep5_exp1 -> expert_comp_8_ep5_exp1
	expert_comp_8_ep5_exp1 -> expert_agg_8
	token_route_8_ep5 -> expert_8_ep5_exp2
	expert_8_ep5_exp2 -> expert_comp_8_ep5_exp2
	expert_comp_8_ep5_exp2 -> expert_agg_8
	token_route_8_ep5 -> expert_8_ep5_exp3
	expert_8_ep5_exp3 -> expert_comp_8_ep5_exp3
	expert_comp_8_ep5_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep6
	token_route_8_ep6 -> expert_8_ep6_exp0
	expert_8_ep6_exp0 -> expert_comp_8_ep6_exp0
	expert_comp_8_ep6_exp0 -> expert_agg_8
	token_route_8_ep6 -> expert_8_ep6_exp1
	expert_8_ep6_exp1 -> expert_comp_8_ep6_exp1
	expert_comp_8_ep6_exp1 -> expert_agg_8
	token_route_8_ep6 -> expert_8_ep6_exp2
	expert_8_ep6_exp2 -> expert_comp_8_ep6_exp2
	expert_comp_8_ep6_exp2 -> expert_agg_8
	token_route_8_ep6 -> expert_8_ep6_exp3
	expert_8_ep6_exp3 -> expert_comp_8_ep6_exp3
	expert_comp_8_ep6_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep7
	token_route_8_ep7 -> expert_8_ep7_exp0
	expert_8_ep7_exp0 -> expert_comp_8_ep7_exp0
	expert_comp_8_ep7_exp0 -> expert_agg_8
	token_route_8_ep7 -> expert_8_ep7_exp1
	expert_8_ep7_exp1 -> expert_comp_8_ep7_exp1
	expert_comp_8_ep7_exp1 -> expert_agg_8
	token_route_8_ep7 -> expert_8_ep7_exp2
	expert_8_ep7_exp2 -> expert_comp_8_ep7_exp2
	expert_comp_8_ep7_exp2 -> expert_agg_8
	token_route_8_ep7 -> expert_8_ep7_exp3
	expert_8_ep7_exp3 -> expert_comp_8_ep7_exp3
	expert_comp_8_ep7_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep8
	token_route_8_ep8 -> expert_8_ep8_exp0
	expert_8_ep8_exp0 -> expert_comp_8_ep8_exp0
	expert_comp_8_ep8_exp0 -> expert_agg_8
	token_route_8_ep8 -> expert_8_ep8_exp1
	expert_8_ep8_exp1 -> expert_comp_8_ep8_exp1
	expert_comp_8_ep8_exp1 -> expert_agg_8
	token_route_8_ep8 -> expert_8_ep8_exp2
	expert_8_ep8_exp2 -> expert_comp_8_ep8_exp2
	expert_comp_8_ep8_exp2 -> expert_agg_8
	token_route_8_ep8 -> expert_8_ep8_exp3
	expert_8_ep8_exp3 -> expert_comp_8_ep8_exp3
	expert_comp_8_ep8_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep9
	token_route_8_ep9 -> expert_8_ep9_exp0
	expert_8_ep9_exp0 -> expert_comp_8_ep9_exp0
	expert_comp_8_ep9_exp0 -> expert_agg_8
	token_route_8_ep9 -> expert_8_ep9_exp1
	expert_8_ep9_exp1 -> expert_comp_8_ep9_exp1
	expert_comp_8_ep9_exp1 -> expert_agg_8
	token_route_8_ep9 -> expert_8_ep9_exp2
	expert_8_ep9_exp2 -> expert_comp_8_ep9_exp2
	expert_comp_8_ep9_exp2 -> expert_agg_8
	token_route_8_ep9 -> expert_8_ep9_exp3
	expert_8_ep9_exp3 -> expert_comp_8_ep9_exp3
	expert_comp_8_ep9_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep10
	token_route_8_ep10 -> expert_8_ep10_exp0
	expert_8_ep10_exp0 -> expert_comp_8_ep10_exp0
	expert_comp_8_ep10_exp0 -> expert_agg_8
	token_route_8_ep10 -> expert_8_ep10_exp1
	expert_8_ep10_exp1 -> expert_comp_8_ep10_exp1
	expert_comp_8_ep10_exp1 -> expert_agg_8
	token_route_8_ep10 -> expert_8_ep10_exp2
	expert_8_ep10_exp2 -> expert_comp_8_ep10_exp2
	expert_comp_8_ep10_exp2 -> expert_agg_8
	token_route_8_ep10 -> expert_8_ep10_exp3
	expert_8_ep10_exp3 -> expert_comp_8_ep10_exp3
	expert_comp_8_ep10_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep11
	token_route_8_ep11 -> expert_8_ep11_exp0
	expert_8_ep11_exp0 -> expert_comp_8_ep11_exp0
	expert_comp_8_ep11_exp0 -> expert_agg_8
	token_route_8_ep11 -> expert_8_ep11_exp1
	expert_8_ep11_exp1 -> expert_comp_8_ep11_exp1
	expert_comp_8_ep11_exp1 -> expert_agg_8
	token_route_8_ep11 -> expert_8_ep11_exp2
	expert_8_ep11_exp2 -> expert_comp_8_ep11_exp2
	expert_comp_8_ep11_exp2 -> expert_agg_8
	token_route_8_ep11 -> expert_8_ep11_exp3
	expert_8_ep11_exp3 -> expert_comp_8_ep11_exp3
	expert_comp_8_ep11_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep12
	token_route_8_ep12 -> expert_8_ep12_exp0
	expert_8_ep12_exp0 -> expert_comp_8_ep12_exp0
	expert_comp_8_ep12_exp0 -> expert_agg_8
	token_route_8_ep12 -> expert_8_ep12_exp1
	expert_8_ep12_exp1 -> expert_comp_8_ep12_exp1
	expert_comp_8_ep12_exp1 -> expert_agg_8
	token_route_8_ep12 -> expert_8_ep12_exp2
	expert_8_ep12_exp2 -> expert_comp_8_ep12_exp2
	expert_comp_8_ep12_exp2 -> expert_agg_8
	token_route_8_ep12 -> expert_8_ep12_exp3
	expert_8_ep12_exp3 -> expert_comp_8_ep12_exp3
	expert_comp_8_ep12_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep13
	token_route_8_ep13 -> expert_8_ep13_exp0
	expert_8_ep13_exp0 -> expert_comp_8_ep13_exp0
	expert_comp_8_ep13_exp0 -> expert_agg_8
	token_route_8_ep13 -> expert_8_ep13_exp1
	expert_8_ep13_exp1 -> expert_comp_8_ep13_exp1
	expert_comp_8_ep13_exp1 -> expert_agg_8
	token_route_8_ep13 -> expert_8_ep13_exp2
	expert_8_ep13_exp2 -> expert_comp_8_ep13_exp2
	expert_comp_8_ep13_exp2 -> expert_agg_8
	token_route_8_ep13 -> expert_8_ep13_exp3
	expert_8_ep13_exp3 -> expert_comp_8_ep13_exp3
	expert_comp_8_ep13_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep14
	token_route_8_ep14 -> expert_8_ep14_exp0
	expert_8_ep14_exp0 -> expert_comp_8_ep14_exp0
	expert_comp_8_ep14_exp0 -> expert_agg_8
	token_route_8_ep14 -> expert_8_ep14_exp1
	expert_8_ep14_exp1 -> expert_comp_8_ep14_exp1
	expert_comp_8_ep14_exp1 -> expert_agg_8
	token_route_8_ep14 -> expert_8_ep14_exp2
	expert_8_ep14_exp2 -> expert_comp_8_ep14_exp2
	expert_comp_8_ep14_exp2 -> expert_agg_8
	token_route_8_ep14 -> expert_8_ep14_exp3
	expert_8_ep14_exp3 -> expert_comp_8_ep14_exp3
	expert_comp_8_ep14_exp3 -> expert_agg_8
	expert_select_8 -> token_route_8_ep15
	token_route_8_ep15 -> expert_8_ep15_exp0
	expert_8_ep15_exp0 -> expert_comp_8_ep15_exp0
	expert_comp_8_ep15_exp0 -> expert_agg_8
	token_route_8_ep15 -> expert_8_ep15_exp1
	expert_8_ep15_exp1 -> expert_comp_8_ep15_exp1
	expert_comp_8_ep15_exp1 -> expert_agg_8
	token_route_8_ep15 -> expert_8_ep15_exp2
	expert_8_ep15_exp2 -> expert_comp_8_ep15_exp2
	expert_comp_8_ep15_exp2 -> expert_agg_8
	token_route_8_ep15 -> expert_8_ep15_exp3
	expert_8_ep15_exp3 -> expert_comp_8_ep15_exp3
	expert_comp_8_ep15_exp3 -> expert_agg_8
	expert_agg_8 -> moe_out_linear_8_tp0
	moe_out_linear_8_tp0 -> allreduce_moe_8
	moe_out_linear_8_tp1 -> allreduce_moe_8
	moe_out_linear_8_tp2 -> allreduce_moe_8
	moe_out_linear_8_tp3 -> allreduce_moe_8
	allreduce_moe_8 -> layernorm_8
	layernorm_8 -> qkv_linear_9_tp0
	allreduce_att_9 -> gate_9 [style=dashed]
	gate_9 -> expert_select_9
	expert_select_9 -> token_route_9_ep0
	token_route_9_ep0 -> expert_9_ep0_exp0
	expert_9_ep0_exp0 -> expert_comp_9_ep0_exp0
	expert_comp_9_ep0_exp0 -> expert_agg_9
	token_route_9_ep0 -> expert_9_ep0_exp1
	expert_9_ep0_exp1 -> expert_comp_9_ep0_exp1
	expert_comp_9_ep0_exp1 -> expert_agg_9
	token_route_9_ep0 -> expert_9_ep0_exp2
	expert_9_ep0_exp2 -> expert_comp_9_ep0_exp2
	expert_comp_9_ep0_exp2 -> expert_agg_9
	token_route_9_ep0 -> expert_9_ep0_exp3
	expert_9_ep0_exp3 -> expert_comp_9_ep0_exp3
	expert_comp_9_ep0_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep1
	token_route_9_ep1 -> expert_9_ep1_exp0
	expert_9_ep1_exp0 -> expert_comp_9_ep1_exp0
	expert_comp_9_ep1_exp0 -> expert_agg_9
	token_route_9_ep1 -> expert_9_ep1_exp1
	expert_9_ep1_exp1 -> expert_comp_9_ep1_exp1
	expert_comp_9_ep1_exp1 -> expert_agg_9
	token_route_9_ep1 -> expert_9_ep1_exp2
	expert_9_ep1_exp2 -> expert_comp_9_ep1_exp2
	expert_comp_9_ep1_exp2 -> expert_agg_9
	token_route_9_ep1 -> expert_9_ep1_exp3
	expert_9_ep1_exp3 -> expert_comp_9_ep1_exp3
	expert_comp_9_ep1_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep2
	token_route_9_ep2 -> expert_9_ep2_exp0
	expert_9_ep2_exp0 -> expert_comp_9_ep2_exp0
	expert_comp_9_ep2_exp0 -> expert_agg_9
	token_route_9_ep2 -> expert_9_ep2_exp1
	expert_9_ep2_exp1 -> expert_comp_9_ep2_exp1
	expert_comp_9_ep2_exp1 -> expert_agg_9
	token_route_9_ep2 -> expert_9_ep2_exp2
	expert_9_ep2_exp2 -> expert_comp_9_ep2_exp2
	expert_comp_9_ep2_exp2 -> expert_agg_9
	token_route_9_ep2 -> expert_9_ep2_exp3
	expert_9_ep2_exp3 -> expert_comp_9_ep2_exp3
	expert_comp_9_ep2_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep3
	token_route_9_ep3 -> expert_9_ep3_exp0
	expert_9_ep3_exp0 -> expert_comp_9_ep3_exp0
	expert_comp_9_ep3_exp0 -> expert_agg_9
	token_route_9_ep3 -> expert_9_ep3_exp1
	expert_9_ep3_exp1 -> expert_comp_9_ep3_exp1
	expert_comp_9_ep3_exp1 -> expert_agg_9
	token_route_9_ep3 -> expert_9_ep3_exp2
	expert_9_ep3_exp2 -> expert_comp_9_ep3_exp2
	expert_comp_9_ep3_exp2 -> expert_agg_9
	token_route_9_ep3 -> expert_9_ep3_exp3
	expert_9_ep3_exp3 -> expert_comp_9_ep3_exp3
	expert_comp_9_ep3_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep4
	token_route_9_ep4 -> expert_9_ep4_exp0
	expert_9_ep4_exp0 -> expert_comp_9_ep4_exp0
	expert_comp_9_ep4_exp0 -> expert_agg_9
	token_route_9_ep4 -> expert_9_ep4_exp1
	expert_9_ep4_exp1 -> expert_comp_9_ep4_exp1
	expert_comp_9_ep4_exp1 -> expert_agg_9
	token_route_9_ep4 -> expert_9_ep4_exp2
	expert_9_ep4_exp2 -> expert_comp_9_ep4_exp2
	expert_comp_9_ep4_exp2 -> expert_agg_9
	token_route_9_ep4 -> expert_9_ep4_exp3
	expert_9_ep4_exp3 -> expert_comp_9_ep4_exp3
	expert_comp_9_ep4_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep5
	token_route_9_ep5 -> expert_9_ep5_exp0
	expert_9_ep5_exp0 -> expert_comp_9_ep5_exp0
	expert_comp_9_ep5_exp0 -> expert_agg_9
	token_route_9_ep5 -> expert_9_ep5_exp1
	expert_9_ep5_exp1 -> expert_comp_9_ep5_exp1
	expert_comp_9_ep5_exp1 -> expert_agg_9
	token_route_9_ep5 -> expert_9_ep5_exp2
	expert_9_ep5_exp2 -> expert_comp_9_ep5_exp2
	expert_comp_9_ep5_exp2 -> expert_agg_9
	token_route_9_ep5 -> expert_9_ep5_exp3
	expert_9_ep5_exp3 -> expert_comp_9_ep5_exp3
	expert_comp_9_ep5_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep6
	token_route_9_ep6 -> expert_9_ep6_exp0
	expert_9_ep6_exp0 -> expert_comp_9_ep6_exp0
	expert_comp_9_ep6_exp0 -> expert_agg_9
	token_route_9_ep6 -> expert_9_ep6_exp1
	expert_9_ep6_exp1 -> expert_comp_9_ep6_exp1
	expert_comp_9_ep6_exp1 -> expert_agg_9
	token_route_9_ep6 -> expert_9_ep6_exp2
	expert_9_ep6_exp2 -> expert_comp_9_ep6_exp2
	expert_comp_9_ep6_exp2 -> expert_agg_9
	token_route_9_ep6 -> expert_9_ep6_exp3
	expert_9_ep6_exp3 -> expert_comp_9_ep6_exp3
	expert_comp_9_ep6_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep7
	token_route_9_ep7 -> expert_9_ep7_exp0
	expert_9_ep7_exp0 -> expert_comp_9_ep7_exp0
	expert_comp_9_ep7_exp0 -> expert_agg_9
	token_route_9_ep7 -> expert_9_ep7_exp1
	expert_9_ep7_exp1 -> expert_comp_9_ep7_exp1
	expert_comp_9_ep7_exp1 -> expert_agg_9
	token_route_9_ep7 -> expert_9_ep7_exp2
	expert_9_ep7_exp2 -> expert_comp_9_ep7_exp2
	expert_comp_9_ep7_exp2 -> expert_agg_9
	token_route_9_ep7 -> expert_9_ep7_exp3
	expert_9_ep7_exp3 -> expert_comp_9_ep7_exp3
	expert_comp_9_ep7_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep8
	token_route_9_ep8 -> expert_9_ep8_exp0
	expert_9_ep8_exp0 -> expert_comp_9_ep8_exp0
	expert_comp_9_ep8_exp0 -> expert_agg_9
	token_route_9_ep8 -> expert_9_ep8_exp1
	expert_9_ep8_exp1 -> expert_comp_9_ep8_exp1
	expert_comp_9_ep8_exp1 -> expert_agg_9
	token_route_9_ep8 -> expert_9_ep8_exp2
	expert_9_ep8_exp2 -> expert_comp_9_ep8_exp2
	expert_comp_9_ep8_exp2 -> expert_agg_9
	token_route_9_ep8 -> expert_9_ep8_exp3
	expert_9_ep8_exp3 -> expert_comp_9_ep8_exp3
	expert_comp_9_ep8_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep9
	token_route_9_ep9 -> expert_9_ep9_exp0
	expert_9_ep9_exp0 -> expert_comp_9_ep9_exp0
	expert_comp_9_ep9_exp0 -> expert_agg_9
	token_route_9_ep9 -> expert_9_ep9_exp1
	expert_9_ep9_exp1 -> expert_comp_9_ep9_exp1
	expert_comp_9_ep9_exp1 -> expert_agg_9
	token_route_9_ep9 -> expert_9_ep9_exp2
	expert_9_ep9_exp2 -> expert_comp_9_ep9_exp2
	expert_comp_9_ep9_exp2 -> expert_agg_9
	token_route_9_ep9 -> expert_9_ep9_exp3
	expert_9_ep9_exp3 -> expert_comp_9_ep9_exp3
	expert_comp_9_ep9_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep10
	token_route_9_ep10 -> expert_9_ep10_exp0
	expert_9_ep10_exp0 -> expert_comp_9_ep10_exp0
	expert_comp_9_ep10_exp0 -> expert_agg_9
	token_route_9_ep10 -> expert_9_ep10_exp1
	expert_9_ep10_exp1 -> expert_comp_9_ep10_exp1
	expert_comp_9_ep10_exp1 -> expert_agg_9
	token_route_9_ep10 -> expert_9_ep10_exp2
	expert_9_ep10_exp2 -> expert_comp_9_ep10_exp2
	expert_comp_9_ep10_exp2 -> expert_agg_9
	token_route_9_ep10 -> expert_9_ep10_exp3
	expert_9_ep10_exp3 -> expert_comp_9_ep10_exp3
	expert_comp_9_ep10_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep11
	token_route_9_ep11 -> expert_9_ep11_exp0
	expert_9_ep11_exp0 -> expert_comp_9_ep11_exp0
	expert_comp_9_ep11_exp0 -> expert_agg_9
	token_route_9_ep11 -> expert_9_ep11_exp1
	expert_9_ep11_exp1 -> expert_comp_9_ep11_exp1
	expert_comp_9_ep11_exp1 -> expert_agg_9
	token_route_9_ep11 -> expert_9_ep11_exp2
	expert_9_ep11_exp2 -> expert_comp_9_ep11_exp2
	expert_comp_9_ep11_exp2 -> expert_agg_9
	token_route_9_ep11 -> expert_9_ep11_exp3
	expert_9_ep11_exp3 -> expert_comp_9_ep11_exp3
	expert_comp_9_ep11_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep12
	token_route_9_ep12 -> expert_9_ep12_exp0
	expert_9_ep12_exp0 -> expert_comp_9_ep12_exp0
	expert_comp_9_ep12_exp0 -> expert_agg_9
	token_route_9_ep12 -> expert_9_ep12_exp1
	expert_9_ep12_exp1 -> expert_comp_9_ep12_exp1
	expert_comp_9_ep12_exp1 -> expert_agg_9
	token_route_9_ep12 -> expert_9_ep12_exp2
	expert_9_ep12_exp2 -> expert_comp_9_ep12_exp2
	expert_comp_9_ep12_exp2 -> expert_agg_9
	token_route_9_ep12 -> expert_9_ep12_exp3
	expert_9_ep12_exp3 -> expert_comp_9_ep12_exp3
	expert_comp_9_ep12_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep13
	token_route_9_ep13 -> expert_9_ep13_exp0
	expert_9_ep13_exp0 -> expert_comp_9_ep13_exp0
	expert_comp_9_ep13_exp0 -> expert_agg_9
	token_route_9_ep13 -> expert_9_ep13_exp1
	expert_9_ep13_exp1 -> expert_comp_9_ep13_exp1
	expert_comp_9_ep13_exp1 -> expert_agg_9
	token_route_9_ep13 -> expert_9_ep13_exp2
	expert_9_ep13_exp2 -> expert_comp_9_ep13_exp2
	expert_comp_9_ep13_exp2 -> expert_agg_9
	token_route_9_ep13 -> expert_9_ep13_exp3
	expert_9_ep13_exp3 -> expert_comp_9_ep13_exp3
	expert_comp_9_ep13_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep14
	token_route_9_ep14 -> expert_9_ep14_exp0
	expert_9_ep14_exp0 -> expert_comp_9_ep14_exp0
	expert_comp_9_ep14_exp0 -> expert_agg_9
	token_route_9_ep14 -> expert_9_ep14_exp1
	expert_9_ep14_exp1 -> expert_comp_9_ep14_exp1
	expert_comp_9_ep14_exp1 -> expert_agg_9
	token_route_9_ep14 -> expert_9_ep14_exp2
	expert_9_ep14_exp2 -> expert_comp_9_ep14_exp2
	expert_comp_9_ep14_exp2 -> expert_agg_9
	token_route_9_ep14 -> expert_9_ep14_exp3
	expert_9_ep14_exp3 -> expert_comp_9_ep14_exp3
	expert_comp_9_ep14_exp3 -> expert_agg_9
	expert_select_9 -> token_route_9_ep15
	token_route_9_ep15 -> expert_9_ep15_exp0
	expert_9_ep15_exp0 -> expert_comp_9_ep15_exp0
	expert_comp_9_ep15_exp0 -> expert_agg_9
	token_route_9_ep15 -> expert_9_ep15_exp1
	expert_9_ep15_exp1 -> expert_comp_9_ep15_exp1
	expert_comp_9_ep15_exp1 -> expert_agg_9
	token_route_9_ep15 -> expert_9_ep15_exp2
	expert_9_ep15_exp2 -> expert_comp_9_ep15_exp2
	expert_comp_9_ep15_exp2 -> expert_agg_9
	token_route_9_ep15 -> expert_9_ep15_exp3
	expert_9_ep15_exp3 -> expert_comp_9_ep15_exp3
	expert_comp_9_ep15_exp3 -> expert_agg_9
	expert_agg_9 -> moe_out_linear_9_tp0
	moe_out_linear_9_tp0 -> allreduce_moe_9
	moe_out_linear_9_tp1 -> allreduce_moe_9
	moe_out_linear_9_tp2 -> allreduce_moe_9
	moe_out_linear_9_tp3 -> allreduce_moe_9
	allreduce_moe_9 -> layernorm_9
	layernorm_9 -> qkv_linear_10_tp0
	allreduce_att_10 -> gate_10 [style=dashed]
	gate_10 -> expert_select_10
	expert_select_10 -> token_route_10_ep0
	token_route_10_ep0 -> expert_10_ep0_exp0
	expert_10_ep0_exp0 -> expert_comp_10_ep0_exp0
	expert_comp_10_ep0_exp0 -> expert_agg_10
	token_route_10_ep0 -> expert_10_ep0_exp1
	expert_10_ep0_exp1 -> expert_comp_10_ep0_exp1
	expert_comp_10_ep0_exp1 -> expert_agg_10
	token_route_10_ep0 -> expert_10_ep0_exp2
	expert_10_ep0_exp2 -> expert_comp_10_ep0_exp2
	expert_comp_10_ep0_exp2 -> expert_agg_10
	token_route_10_ep0 -> expert_10_ep0_exp3
	expert_10_ep0_exp3 -> expert_comp_10_ep0_exp3
	expert_comp_10_ep0_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep1
	token_route_10_ep1 -> expert_10_ep1_exp0
	expert_10_ep1_exp0 -> expert_comp_10_ep1_exp0
	expert_comp_10_ep1_exp0 -> expert_agg_10
	token_route_10_ep1 -> expert_10_ep1_exp1
	expert_10_ep1_exp1 -> expert_comp_10_ep1_exp1
	expert_comp_10_ep1_exp1 -> expert_agg_10
	token_route_10_ep1 -> expert_10_ep1_exp2
	expert_10_ep1_exp2 -> expert_comp_10_ep1_exp2
	expert_comp_10_ep1_exp2 -> expert_agg_10
	token_route_10_ep1 -> expert_10_ep1_exp3
	expert_10_ep1_exp3 -> expert_comp_10_ep1_exp3
	expert_comp_10_ep1_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep2
	token_route_10_ep2 -> expert_10_ep2_exp0
	expert_10_ep2_exp0 -> expert_comp_10_ep2_exp0
	expert_comp_10_ep2_exp0 -> expert_agg_10
	token_route_10_ep2 -> expert_10_ep2_exp1
	expert_10_ep2_exp1 -> expert_comp_10_ep2_exp1
	expert_comp_10_ep2_exp1 -> expert_agg_10
	token_route_10_ep2 -> expert_10_ep2_exp2
	expert_10_ep2_exp2 -> expert_comp_10_ep2_exp2
	expert_comp_10_ep2_exp2 -> expert_agg_10
	token_route_10_ep2 -> expert_10_ep2_exp3
	expert_10_ep2_exp3 -> expert_comp_10_ep2_exp3
	expert_comp_10_ep2_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep3
	token_route_10_ep3 -> expert_10_ep3_exp0
	expert_10_ep3_exp0 -> expert_comp_10_ep3_exp0
	expert_comp_10_ep3_exp0 -> expert_agg_10
	token_route_10_ep3 -> expert_10_ep3_exp1
	expert_10_ep3_exp1 -> expert_comp_10_ep3_exp1
	expert_comp_10_ep3_exp1 -> expert_agg_10
	token_route_10_ep3 -> expert_10_ep3_exp2
	expert_10_ep3_exp2 -> expert_comp_10_ep3_exp2
	expert_comp_10_ep3_exp2 -> expert_agg_10
	token_route_10_ep3 -> expert_10_ep3_exp3
	expert_10_ep3_exp3 -> expert_comp_10_ep3_exp3
	expert_comp_10_ep3_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep4
	token_route_10_ep4 -> expert_10_ep4_exp0
	expert_10_ep4_exp0 -> expert_comp_10_ep4_exp0
	expert_comp_10_ep4_exp0 -> expert_agg_10
	token_route_10_ep4 -> expert_10_ep4_exp1
	expert_10_ep4_exp1 -> expert_comp_10_ep4_exp1
	expert_comp_10_ep4_exp1 -> expert_agg_10
	token_route_10_ep4 -> expert_10_ep4_exp2
	expert_10_ep4_exp2 -> expert_comp_10_ep4_exp2
	expert_comp_10_ep4_exp2 -> expert_agg_10
	token_route_10_ep4 -> expert_10_ep4_exp3
	expert_10_ep4_exp3 -> expert_comp_10_ep4_exp3
	expert_comp_10_ep4_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep5
	token_route_10_ep5 -> expert_10_ep5_exp0
	expert_10_ep5_exp0 -> expert_comp_10_ep5_exp0
	expert_comp_10_ep5_exp0 -> expert_agg_10
	token_route_10_ep5 -> expert_10_ep5_exp1
	expert_10_ep5_exp1 -> expert_comp_10_ep5_exp1
	expert_comp_10_ep5_exp1 -> expert_agg_10
	token_route_10_ep5 -> expert_10_ep5_exp2
	expert_10_ep5_exp2 -> expert_comp_10_ep5_exp2
	expert_comp_10_ep5_exp2 -> expert_agg_10
	token_route_10_ep5 -> expert_10_ep5_exp3
	expert_10_ep5_exp3 -> expert_comp_10_ep5_exp3
	expert_comp_10_ep5_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep6
	token_route_10_ep6 -> expert_10_ep6_exp0
	expert_10_ep6_exp0 -> expert_comp_10_ep6_exp0
	expert_comp_10_ep6_exp0 -> expert_agg_10
	token_route_10_ep6 -> expert_10_ep6_exp1
	expert_10_ep6_exp1 -> expert_comp_10_ep6_exp1
	expert_comp_10_ep6_exp1 -> expert_agg_10
	token_route_10_ep6 -> expert_10_ep6_exp2
	expert_10_ep6_exp2 -> expert_comp_10_ep6_exp2
	expert_comp_10_ep6_exp2 -> expert_agg_10
	token_route_10_ep6 -> expert_10_ep6_exp3
	expert_10_ep6_exp3 -> expert_comp_10_ep6_exp3
	expert_comp_10_ep6_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep7
	token_route_10_ep7 -> expert_10_ep7_exp0
	expert_10_ep7_exp0 -> expert_comp_10_ep7_exp0
	expert_comp_10_ep7_exp0 -> expert_agg_10
	token_route_10_ep7 -> expert_10_ep7_exp1
	expert_10_ep7_exp1 -> expert_comp_10_ep7_exp1
	expert_comp_10_ep7_exp1 -> expert_agg_10
	token_route_10_ep7 -> expert_10_ep7_exp2
	expert_10_ep7_exp2 -> expert_comp_10_ep7_exp2
	expert_comp_10_ep7_exp2 -> expert_agg_10
	token_route_10_ep7 -> expert_10_ep7_exp3
	expert_10_ep7_exp3 -> expert_comp_10_ep7_exp3
	expert_comp_10_ep7_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep8
	token_route_10_ep8 -> expert_10_ep8_exp0
	expert_10_ep8_exp0 -> expert_comp_10_ep8_exp0
	expert_comp_10_ep8_exp0 -> expert_agg_10
	token_route_10_ep8 -> expert_10_ep8_exp1
	expert_10_ep8_exp1 -> expert_comp_10_ep8_exp1
	expert_comp_10_ep8_exp1 -> expert_agg_10
	token_route_10_ep8 -> expert_10_ep8_exp2
	expert_10_ep8_exp2 -> expert_comp_10_ep8_exp2
	expert_comp_10_ep8_exp2 -> expert_agg_10
	token_route_10_ep8 -> expert_10_ep8_exp3
	expert_10_ep8_exp3 -> expert_comp_10_ep8_exp3
	expert_comp_10_ep8_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep9
	token_route_10_ep9 -> expert_10_ep9_exp0
	expert_10_ep9_exp0 -> expert_comp_10_ep9_exp0
	expert_comp_10_ep9_exp0 -> expert_agg_10
	token_route_10_ep9 -> expert_10_ep9_exp1
	expert_10_ep9_exp1 -> expert_comp_10_ep9_exp1
	expert_comp_10_ep9_exp1 -> expert_agg_10
	token_route_10_ep9 -> expert_10_ep9_exp2
	expert_10_ep9_exp2 -> expert_comp_10_ep9_exp2
	expert_comp_10_ep9_exp2 -> expert_agg_10
	token_route_10_ep9 -> expert_10_ep9_exp3
	expert_10_ep9_exp3 -> expert_comp_10_ep9_exp3
	expert_comp_10_ep9_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep10
	token_route_10_ep10 -> expert_10_ep10_exp0
	expert_10_ep10_exp0 -> expert_comp_10_ep10_exp0
	expert_comp_10_ep10_exp0 -> expert_agg_10
	token_route_10_ep10 -> expert_10_ep10_exp1
	expert_10_ep10_exp1 -> expert_comp_10_ep10_exp1
	expert_comp_10_ep10_exp1 -> expert_agg_10
	token_route_10_ep10 -> expert_10_ep10_exp2
	expert_10_ep10_exp2 -> expert_comp_10_ep10_exp2
	expert_comp_10_ep10_exp2 -> expert_agg_10
	token_route_10_ep10 -> expert_10_ep10_exp3
	expert_10_ep10_exp3 -> expert_comp_10_ep10_exp3
	expert_comp_10_ep10_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep11
	token_route_10_ep11 -> expert_10_ep11_exp0
	expert_10_ep11_exp0 -> expert_comp_10_ep11_exp0
	expert_comp_10_ep11_exp0 -> expert_agg_10
	token_route_10_ep11 -> expert_10_ep11_exp1
	expert_10_ep11_exp1 -> expert_comp_10_ep11_exp1
	expert_comp_10_ep11_exp1 -> expert_agg_10
	token_route_10_ep11 -> expert_10_ep11_exp2
	expert_10_ep11_exp2 -> expert_comp_10_ep11_exp2
	expert_comp_10_ep11_exp2 -> expert_agg_10
	token_route_10_ep11 -> expert_10_ep11_exp3
	expert_10_ep11_exp3 -> expert_comp_10_ep11_exp3
	expert_comp_10_ep11_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep12
	token_route_10_ep12 -> expert_10_ep12_exp0
	expert_10_ep12_exp0 -> expert_comp_10_ep12_exp0
	expert_comp_10_ep12_exp0 -> expert_agg_10
	token_route_10_ep12 -> expert_10_ep12_exp1
	expert_10_ep12_exp1 -> expert_comp_10_ep12_exp1
	expert_comp_10_ep12_exp1 -> expert_agg_10
	token_route_10_ep12 -> expert_10_ep12_exp2
	expert_10_ep12_exp2 -> expert_comp_10_ep12_exp2
	expert_comp_10_ep12_exp2 -> expert_agg_10
	token_route_10_ep12 -> expert_10_ep12_exp3
	expert_10_ep12_exp3 -> expert_comp_10_ep12_exp3
	expert_comp_10_ep12_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep13
	token_route_10_ep13 -> expert_10_ep13_exp0
	expert_10_ep13_exp0 -> expert_comp_10_ep13_exp0
	expert_comp_10_ep13_exp0 -> expert_agg_10
	token_route_10_ep13 -> expert_10_ep13_exp1
	expert_10_ep13_exp1 -> expert_comp_10_ep13_exp1
	expert_comp_10_ep13_exp1 -> expert_agg_10
	token_route_10_ep13 -> expert_10_ep13_exp2
	expert_10_ep13_exp2 -> expert_comp_10_ep13_exp2
	expert_comp_10_ep13_exp2 -> expert_agg_10
	token_route_10_ep13 -> expert_10_ep13_exp3
	expert_10_ep13_exp3 -> expert_comp_10_ep13_exp3
	expert_comp_10_ep13_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep14
	token_route_10_ep14 -> expert_10_ep14_exp0
	expert_10_ep14_exp0 -> expert_comp_10_ep14_exp0
	expert_comp_10_ep14_exp0 -> expert_agg_10
	token_route_10_ep14 -> expert_10_ep14_exp1
	expert_10_ep14_exp1 -> expert_comp_10_ep14_exp1
	expert_comp_10_ep14_exp1 -> expert_agg_10
	token_route_10_ep14 -> expert_10_ep14_exp2
	expert_10_ep14_exp2 -> expert_comp_10_ep14_exp2
	expert_comp_10_ep14_exp2 -> expert_agg_10
	token_route_10_ep14 -> expert_10_ep14_exp3
	expert_10_ep14_exp3 -> expert_comp_10_ep14_exp3
	expert_comp_10_ep14_exp3 -> expert_agg_10
	expert_select_10 -> token_route_10_ep15
	token_route_10_ep15 -> expert_10_ep15_exp0
	expert_10_ep15_exp0 -> expert_comp_10_ep15_exp0
	expert_comp_10_ep15_exp0 -> expert_agg_10
	token_route_10_ep15 -> expert_10_ep15_exp1
	expert_10_ep15_exp1 -> expert_comp_10_ep15_exp1
	expert_comp_10_ep15_exp1 -> expert_agg_10
	token_route_10_ep15 -> expert_10_ep15_exp2
	expert_10_ep15_exp2 -> expert_comp_10_ep15_exp2
	expert_comp_10_ep15_exp2 -> expert_agg_10
	token_route_10_ep15 -> expert_10_ep15_exp3
	expert_10_ep15_exp3 -> expert_comp_10_ep15_exp3
	expert_comp_10_ep15_exp3 -> expert_agg_10
	expert_agg_10 -> moe_out_linear_10_tp0
	moe_out_linear_10_tp0 -> allreduce_moe_10
	moe_out_linear_10_tp1 -> allreduce_moe_10
	moe_out_linear_10_tp2 -> allreduce_moe_10
	moe_out_linear_10_tp3 -> allreduce_moe_10
	allreduce_moe_10 -> layernorm_10
	layernorm_10 -> qkv_linear_11_tp0
	allreduce_att_11 -> gate_11 [style=dashed]
	gate_11 -> expert_select_11
	expert_select_11 -> token_route_11_ep0
	token_route_11_ep0 -> expert_11_ep0_exp0
	expert_11_ep0_exp0 -> expert_comp_11_ep0_exp0
	expert_comp_11_ep0_exp0 -> expert_agg_11
	token_route_11_ep0 -> expert_11_ep0_exp1
	expert_11_ep0_exp1 -> expert_comp_11_ep0_exp1
	expert_comp_11_ep0_exp1 -> expert_agg_11
	token_route_11_ep0 -> expert_11_ep0_exp2
	expert_11_ep0_exp2 -> expert_comp_11_ep0_exp2
	expert_comp_11_ep0_exp2 -> expert_agg_11
	token_route_11_ep0 -> expert_11_ep0_exp3
	expert_11_ep0_exp3 -> expert_comp_11_ep0_exp3
	expert_comp_11_ep0_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep1
	token_route_11_ep1 -> expert_11_ep1_exp0
	expert_11_ep1_exp0 -> expert_comp_11_ep1_exp0
	expert_comp_11_ep1_exp0 -> expert_agg_11
	token_route_11_ep1 -> expert_11_ep1_exp1
	expert_11_ep1_exp1 -> expert_comp_11_ep1_exp1
	expert_comp_11_ep1_exp1 -> expert_agg_11
	token_route_11_ep1 -> expert_11_ep1_exp2
	expert_11_ep1_exp2 -> expert_comp_11_ep1_exp2
	expert_comp_11_ep1_exp2 -> expert_agg_11
	token_route_11_ep1 -> expert_11_ep1_exp3
	expert_11_ep1_exp3 -> expert_comp_11_ep1_exp3
	expert_comp_11_ep1_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep2
	token_route_11_ep2 -> expert_11_ep2_exp0
	expert_11_ep2_exp0 -> expert_comp_11_ep2_exp0
	expert_comp_11_ep2_exp0 -> expert_agg_11
	token_route_11_ep2 -> expert_11_ep2_exp1
	expert_11_ep2_exp1 -> expert_comp_11_ep2_exp1
	expert_comp_11_ep2_exp1 -> expert_agg_11
	token_route_11_ep2 -> expert_11_ep2_exp2
	expert_11_ep2_exp2 -> expert_comp_11_ep2_exp2
	expert_comp_11_ep2_exp2 -> expert_agg_11
	token_route_11_ep2 -> expert_11_ep2_exp3
	expert_11_ep2_exp3 -> expert_comp_11_ep2_exp3
	expert_comp_11_ep2_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep3
	token_route_11_ep3 -> expert_11_ep3_exp0
	expert_11_ep3_exp0 -> expert_comp_11_ep3_exp0
	expert_comp_11_ep3_exp0 -> expert_agg_11
	token_route_11_ep3 -> expert_11_ep3_exp1
	expert_11_ep3_exp1 -> expert_comp_11_ep3_exp1
	expert_comp_11_ep3_exp1 -> expert_agg_11
	token_route_11_ep3 -> expert_11_ep3_exp2
	expert_11_ep3_exp2 -> expert_comp_11_ep3_exp2
	expert_comp_11_ep3_exp2 -> expert_agg_11
	token_route_11_ep3 -> expert_11_ep3_exp3
	expert_11_ep3_exp3 -> expert_comp_11_ep3_exp3
	expert_comp_11_ep3_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep4
	token_route_11_ep4 -> expert_11_ep4_exp0
	expert_11_ep4_exp0 -> expert_comp_11_ep4_exp0
	expert_comp_11_ep4_exp0 -> expert_agg_11
	token_route_11_ep4 -> expert_11_ep4_exp1
	expert_11_ep4_exp1 -> expert_comp_11_ep4_exp1
	expert_comp_11_ep4_exp1 -> expert_agg_11
	token_route_11_ep4 -> expert_11_ep4_exp2
	expert_11_ep4_exp2 -> expert_comp_11_ep4_exp2
	expert_comp_11_ep4_exp2 -> expert_agg_11
	token_route_11_ep4 -> expert_11_ep4_exp3
	expert_11_ep4_exp3 -> expert_comp_11_ep4_exp3
	expert_comp_11_ep4_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep5
	token_route_11_ep5 -> expert_11_ep5_exp0
	expert_11_ep5_exp0 -> expert_comp_11_ep5_exp0
	expert_comp_11_ep5_exp0 -> expert_agg_11
	token_route_11_ep5 -> expert_11_ep5_exp1
	expert_11_ep5_exp1 -> expert_comp_11_ep5_exp1
	expert_comp_11_ep5_exp1 -> expert_agg_11
	token_route_11_ep5 -> expert_11_ep5_exp2
	expert_11_ep5_exp2 -> expert_comp_11_ep5_exp2
	expert_comp_11_ep5_exp2 -> expert_agg_11
	token_route_11_ep5 -> expert_11_ep5_exp3
	expert_11_ep5_exp3 -> expert_comp_11_ep5_exp3
	expert_comp_11_ep5_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep6
	token_route_11_ep6 -> expert_11_ep6_exp0
	expert_11_ep6_exp0 -> expert_comp_11_ep6_exp0
	expert_comp_11_ep6_exp0 -> expert_agg_11
	token_route_11_ep6 -> expert_11_ep6_exp1
	expert_11_ep6_exp1 -> expert_comp_11_ep6_exp1
	expert_comp_11_ep6_exp1 -> expert_agg_11
	token_route_11_ep6 -> expert_11_ep6_exp2
	expert_11_ep6_exp2 -> expert_comp_11_ep6_exp2
	expert_comp_11_ep6_exp2 -> expert_agg_11
	token_route_11_ep6 -> expert_11_ep6_exp3
	expert_11_ep6_exp3 -> expert_comp_11_ep6_exp3
	expert_comp_11_ep6_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep7
	token_route_11_ep7 -> expert_11_ep7_exp0
	expert_11_ep7_exp0 -> expert_comp_11_ep7_exp0
	expert_comp_11_ep7_exp0 -> expert_agg_11
	token_route_11_ep7 -> expert_11_ep7_exp1
	expert_11_ep7_exp1 -> expert_comp_11_ep7_exp1
	expert_comp_11_ep7_exp1 -> expert_agg_11
	token_route_11_ep7 -> expert_11_ep7_exp2
	expert_11_ep7_exp2 -> expert_comp_11_ep7_exp2
	expert_comp_11_ep7_exp2 -> expert_agg_11
	token_route_11_ep7 -> expert_11_ep7_exp3
	expert_11_ep7_exp3 -> expert_comp_11_ep7_exp3
	expert_comp_11_ep7_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep8
	token_route_11_ep8 -> expert_11_ep8_exp0
	expert_11_ep8_exp0 -> expert_comp_11_ep8_exp0
	expert_comp_11_ep8_exp0 -> expert_agg_11
	token_route_11_ep8 -> expert_11_ep8_exp1
	expert_11_ep8_exp1 -> expert_comp_11_ep8_exp1
	expert_comp_11_ep8_exp1 -> expert_agg_11
	token_route_11_ep8 -> expert_11_ep8_exp2
	expert_11_ep8_exp2 -> expert_comp_11_ep8_exp2
	expert_comp_11_ep8_exp2 -> expert_agg_11
	token_route_11_ep8 -> expert_11_ep8_exp3
	expert_11_ep8_exp3 -> expert_comp_11_ep8_exp3
	expert_comp_11_ep8_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep9
	token_route_11_ep9 -> expert_11_ep9_exp0
	expert_11_ep9_exp0 -> expert_comp_11_ep9_exp0
	expert_comp_11_ep9_exp0 -> expert_agg_11
	token_route_11_ep9 -> expert_11_ep9_exp1
	expert_11_ep9_exp1 -> expert_comp_11_ep9_exp1
	expert_comp_11_ep9_exp1 -> expert_agg_11
	token_route_11_ep9 -> expert_11_ep9_exp2
	expert_11_ep9_exp2 -> expert_comp_11_ep9_exp2
	expert_comp_11_ep9_exp2 -> expert_agg_11
	token_route_11_ep9 -> expert_11_ep9_exp3
	expert_11_ep9_exp3 -> expert_comp_11_ep9_exp3
	expert_comp_11_ep9_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep10
	token_route_11_ep10 -> expert_11_ep10_exp0
	expert_11_ep10_exp0 -> expert_comp_11_ep10_exp0
	expert_comp_11_ep10_exp0 -> expert_agg_11
	token_route_11_ep10 -> expert_11_ep10_exp1
	expert_11_ep10_exp1 -> expert_comp_11_ep10_exp1
	expert_comp_11_ep10_exp1 -> expert_agg_11
	token_route_11_ep10 -> expert_11_ep10_exp2
	expert_11_ep10_exp2 -> expert_comp_11_ep10_exp2
	expert_comp_11_ep10_exp2 -> expert_agg_11
	token_route_11_ep10 -> expert_11_ep10_exp3
	expert_11_ep10_exp3 -> expert_comp_11_ep10_exp3
	expert_comp_11_ep10_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep11
	token_route_11_ep11 -> expert_11_ep11_exp0
	expert_11_ep11_exp0 -> expert_comp_11_ep11_exp0
	expert_comp_11_ep11_exp0 -> expert_agg_11
	token_route_11_ep11 -> expert_11_ep11_exp1
	expert_11_ep11_exp1 -> expert_comp_11_ep11_exp1
	expert_comp_11_ep11_exp1 -> expert_agg_11
	token_route_11_ep11 -> expert_11_ep11_exp2
	expert_11_ep11_exp2 -> expert_comp_11_ep11_exp2
	expert_comp_11_ep11_exp2 -> expert_agg_11
	token_route_11_ep11 -> expert_11_ep11_exp3
	expert_11_ep11_exp3 -> expert_comp_11_ep11_exp3
	expert_comp_11_ep11_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep12
	token_route_11_ep12 -> expert_11_ep12_exp0
	expert_11_ep12_exp0 -> expert_comp_11_ep12_exp0
	expert_comp_11_ep12_exp0 -> expert_agg_11
	token_route_11_ep12 -> expert_11_ep12_exp1
	expert_11_ep12_exp1 -> expert_comp_11_ep12_exp1
	expert_comp_11_ep12_exp1 -> expert_agg_11
	token_route_11_ep12 -> expert_11_ep12_exp2
	expert_11_ep12_exp2 -> expert_comp_11_ep12_exp2
	expert_comp_11_ep12_exp2 -> expert_agg_11
	token_route_11_ep12 -> expert_11_ep12_exp3
	expert_11_ep12_exp3 -> expert_comp_11_ep12_exp3
	expert_comp_11_ep12_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep13
	token_route_11_ep13 -> expert_11_ep13_exp0
	expert_11_ep13_exp0 -> expert_comp_11_ep13_exp0
	expert_comp_11_ep13_exp0 -> expert_agg_11
	token_route_11_ep13 -> expert_11_ep13_exp1
	expert_11_ep13_exp1 -> expert_comp_11_ep13_exp1
	expert_comp_11_ep13_exp1 -> expert_agg_11
	token_route_11_ep13 -> expert_11_ep13_exp2
	expert_11_ep13_exp2 -> expert_comp_11_ep13_exp2
	expert_comp_11_ep13_exp2 -> expert_agg_11
	token_route_11_ep13 -> expert_11_ep13_exp3
	expert_11_ep13_exp3 -> expert_comp_11_ep13_exp3
	expert_comp_11_ep13_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep14
	token_route_11_ep14 -> expert_11_ep14_exp0
	expert_11_ep14_exp0 -> expert_comp_11_ep14_exp0
	expert_comp_11_ep14_exp0 -> expert_agg_11
	token_route_11_ep14 -> expert_11_ep14_exp1
	expert_11_ep14_exp1 -> expert_comp_11_ep14_exp1
	expert_comp_11_ep14_exp1 -> expert_agg_11
	token_route_11_ep14 -> expert_11_ep14_exp2
	expert_11_ep14_exp2 -> expert_comp_11_ep14_exp2
	expert_comp_11_ep14_exp2 -> expert_agg_11
	token_route_11_ep14 -> expert_11_ep14_exp3
	expert_11_ep14_exp3 -> expert_comp_11_ep14_exp3
	expert_comp_11_ep14_exp3 -> expert_agg_11
	expert_select_11 -> token_route_11_ep15
	token_route_11_ep15 -> expert_11_ep15_exp0
	expert_11_ep15_exp0 -> expert_comp_11_ep15_exp0
	expert_comp_11_ep15_exp0 -> expert_agg_11
	token_route_11_ep15 -> expert_11_ep15_exp1
	expert_11_ep15_exp1 -> expert_comp_11_ep15_exp1
	expert_comp_11_ep15_exp1 -> expert_agg_11
	token_route_11_ep15 -> expert_11_ep15_exp2
	expert_11_ep15_exp2 -> expert_comp_11_ep15_exp2
	expert_comp_11_ep15_exp2 -> expert_agg_11
	token_route_11_ep15 -> expert_11_ep15_exp3
	expert_11_ep15_exp3 -> expert_comp_11_ep15_exp3
	expert_comp_11_ep15_exp3 -> expert_agg_11
	expert_agg_11 -> moe_out_linear_11_tp0
	moe_out_linear_11_tp0 -> allreduce_moe_11
	moe_out_linear_11_tp1 -> allreduce_moe_11
	moe_out_linear_11_tp2 -> allreduce_moe_11
	moe_out_linear_11_tp3 -> allreduce_moe_11
	allreduce_moe_11 -> layernorm_11
	layernorm_11 -> qkv_linear_12_tp0
	allreduce_att_12 -> gate_12 [style=dashed]
	gate_12 -> expert_select_12
	expert_select_12 -> token_route_12_ep0
	token_route_12_ep0 -> expert_12_ep0_exp0
	expert_12_ep0_exp0 -> expert_comp_12_ep0_exp0
	expert_comp_12_ep0_exp0 -> expert_agg_12
	token_route_12_ep0 -> expert_12_ep0_exp1
	expert_12_ep0_exp1 -> expert_comp_12_ep0_exp1
	expert_comp_12_ep0_exp1 -> expert_agg_12
	token_route_12_ep0 -> expert_12_ep0_exp2
	expert_12_ep0_exp2 -> expert_comp_12_ep0_exp2
	expert_comp_12_ep0_exp2 -> expert_agg_12
	token_route_12_ep0 -> expert_12_ep0_exp3
	expert_12_ep0_exp3 -> expert_comp_12_ep0_exp3
	expert_comp_12_ep0_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep1
	token_route_12_ep1 -> expert_12_ep1_exp0
	expert_12_ep1_exp0 -> expert_comp_12_ep1_exp0
	expert_comp_12_ep1_exp0 -> expert_agg_12
	token_route_12_ep1 -> expert_12_ep1_exp1
	expert_12_ep1_exp1 -> expert_comp_12_ep1_exp1
	expert_comp_12_ep1_exp1 -> expert_agg_12
	token_route_12_ep1 -> expert_12_ep1_exp2
	expert_12_ep1_exp2 -> expert_comp_12_ep1_exp2
	expert_comp_12_ep1_exp2 -> expert_agg_12
	token_route_12_ep1 -> expert_12_ep1_exp3
	expert_12_ep1_exp3 -> expert_comp_12_ep1_exp3
	expert_comp_12_ep1_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep2
	token_route_12_ep2 -> expert_12_ep2_exp0
	expert_12_ep2_exp0 -> expert_comp_12_ep2_exp0
	expert_comp_12_ep2_exp0 -> expert_agg_12
	token_route_12_ep2 -> expert_12_ep2_exp1
	expert_12_ep2_exp1 -> expert_comp_12_ep2_exp1
	expert_comp_12_ep2_exp1 -> expert_agg_12
	token_route_12_ep2 -> expert_12_ep2_exp2
	expert_12_ep2_exp2 -> expert_comp_12_ep2_exp2
	expert_comp_12_ep2_exp2 -> expert_agg_12
	token_route_12_ep2 -> expert_12_ep2_exp3
	expert_12_ep2_exp3 -> expert_comp_12_ep2_exp3
	expert_comp_12_ep2_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep3
	token_route_12_ep3 -> expert_12_ep3_exp0
	expert_12_ep3_exp0 -> expert_comp_12_ep3_exp0
	expert_comp_12_ep3_exp0 -> expert_agg_12
	token_route_12_ep3 -> expert_12_ep3_exp1
	expert_12_ep3_exp1 -> expert_comp_12_ep3_exp1
	expert_comp_12_ep3_exp1 -> expert_agg_12
	token_route_12_ep3 -> expert_12_ep3_exp2
	expert_12_ep3_exp2 -> expert_comp_12_ep3_exp2
	expert_comp_12_ep3_exp2 -> expert_agg_12
	token_route_12_ep3 -> expert_12_ep3_exp3
	expert_12_ep3_exp3 -> expert_comp_12_ep3_exp3
	expert_comp_12_ep3_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep4
	token_route_12_ep4 -> expert_12_ep4_exp0
	expert_12_ep4_exp0 -> expert_comp_12_ep4_exp0
	expert_comp_12_ep4_exp0 -> expert_agg_12
	token_route_12_ep4 -> expert_12_ep4_exp1
	expert_12_ep4_exp1 -> expert_comp_12_ep4_exp1
	expert_comp_12_ep4_exp1 -> expert_agg_12
	token_route_12_ep4 -> expert_12_ep4_exp2
	expert_12_ep4_exp2 -> expert_comp_12_ep4_exp2
	expert_comp_12_ep4_exp2 -> expert_agg_12
	token_route_12_ep4 -> expert_12_ep4_exp3
	expert_12_ep4_exp3 -> expert_comp_12_ep4_exp3
	expert_comp_12_ep4_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep5
	token_route_12_ep5 -> expert_12_ep5_exp0
	expert_12_ep5_exp0 -> expert_comp_12_ep5_exp0
	expert_comp_12_ep5_exp0 -> expert_agg_12
	token_route_12_ep5 -> expert_12_ep5_exp1
	expert_12_ep5_exp1 -> expert_comp_12_ep5_exp1
	expert_comp_12_ep5_exp1 -> expert_agg_12
	token_route_12_ep5 -> expert_12_ep5_exp2
	expert_12_ep5_exp2 -> expert_comp_12_ep5_exp2
	expert_comp_12_ep5_exp2 -> expert_agg_12
	token_route_12_ep5 -> expert_12_ep5_exp3
	expert_12_ep5_exp3 -> expert_comp_12_ep5_exp3
	expert_comp_12_ep5_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep6
	token_route_12_ep6 -> expert_12_ep6_exp0
	expert_12_ep6_exp0 -> expert_comp_12_ep6_exp0
	expert_comp_12_ep6_exp0 -> expert_agg_12
	token_route_12_ep6 -> expert_12_ep6_exp1
	expert_12_ep6_exp1 -> expert_comp_12_ep6_exp1
	expert_comp_12_ep6_exp1 -> expert_agg_12
	token_route_12_ep6 -> expert_12_ep6_exp2
	expert_12_ep6_exp2 -> expert_comp_12_ep6_exp2
	expert_comp_12_ep6_exp2 -> expert_agg_12
	token_route_12_ep6 -> expert_12_ep6_exp3
	expert_12_ep6_exp3 -> expert_comp_12_ep6_exp3
	expert_comp_12_ep6_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep7
	token_route_12_ep7 -> expert_12_ep7_exp0
	expert_12_ep7_exp0 -> expert_comp_12_ep7_exp0
	expert_comp_12_ep7_exp0 -> expert_agg_12
	token_route_12_ep7 -> expert_12_ep7_exp1
	expert_12_ep7_exp1 -> expert_comp_12_ep7_exp1
	expert_comp_12_ep7_exp1 -> expert_agg_12
	token_route_12_ep7 -> expert_12_ep7_exp2
	expert_12_ep7_exp2 -> expert_comp_12_ep7_exp2
	expert_comp_12_ep7_exp2 -> expert_agg_12
	token_route_12_ep7 -> expert_12_ep7_exp3
	expert_12_ep7_exp3 -> expert_comp_12_ep7_exp3
	expert_comp_12_ep7_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep8
	token_route_12_ep8 -> expert_12_ep8_exp0
	expert_12_ep8_exp0 -> expert_comp_12_ep8_exp0
	expert_comp_12_ep8_exp0 -> expert_agg_12
	token_route_12_ep8 -> expert_12_ep8_exp1
	expert_12_ep8_exp1 -> expert_comp_12_ep8_exp1
	expert_comp_12_ep8_exp1 -> expert_agg_12
	token_route_12_ep8 -> expert_12_ep8_exp2
	expert_12_ep8_exp2 -> expert_comp_12_ep8_exp2
	expert_comp_12_ep8_exp2 -> expert_agg_12
	token_route_12_ep8 -> expert_12_ep8_exp3
	expert_12_ep8_exp3 -> expert_comp_12_ep8_exp3
	expert_comp_12_ep8_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep9
	token_route_12_ep9 -> expert_12_ep9_exp0
	expert_12_ep9_exp0 -> expert_comp_12_ep9_exp0
	expert_comp_12_ep9_exp0 -> expert_agg_12
	token_route_12_ep9 -> expert_12_ep9_exp1
	expert_12_ep9_exp1 -> expert_comp_12_ep9_exp1
	expert_comp_12_ep9_exp1 -> expert_agg_12
	token_route_12_ep9 -> expert_12_ep9_exp2
	expert_12_ep9_exp2 -> expert_comp_12_ep9_exp2
	expert_comp_12_ep9_exp2 -> expert_agg_12
	token_route_12_ep9 -> expert_12_ep9_exp3
	expert_12_ep9_exp3 -> expert_comp_12_ep9_exp3
	expert_comp_12_ep9_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep10
	token_route_12_ep10 -> expert_12_ep10_exp0
	expert_12_ep10_exp0 -> expert_comp_12_ep10_exp0
	expert_comp_12_ep10_exp0 -> expert_agg_12
	token_route_12_ep10 -> expert_12_ep10_exp1
	expert_12_ep10_exp1 -> expert_comp_12_ep10_exp1
	expert_comp_12_ep10_exp1 -> expert_agg_12
	token_route_12_ep10 -> expert_12_ep10_exp2
	expert_12_ep10_exp2 -> expert_comp_12_ep10_exp2
	expert_comp_12_ep10_exp2 -> expert_agg_12
	token_route_12_ep10 -> expert_12_ep10_exp3
	expert_12_ep10_exp3 -> expert_comp_12_ep10_exp3
	expert_comp_12_ep10_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep11
	token_route_12_ep11 -> expert_12_ep11_exp0
	expert_12_ep11_exp0 -> expert_comp_12_ep11_exp0
	expert_comp_12_ep11_exp0 -> expert_agg_12
	token_route_12_ep11 -> expert_12_ep11_exp1
	expert_12_ep11_exp1 -> expert_comp_12_ep11_exp1
	expert_comp_12_ep11_exp1 -> expert_agg_12
	token_route_12_ep11 -> expert_12_ep11_exp2
	expert_12_ep11_exp2 -> expert_comp_12_ep11_exp2
	expert_comp_12_ep11_exp2 -> expert_agg_12
	token_route_12_ep11 -> expert_12_ep11_exp3
	expert_12_ep11_exp3 -> expert_comp_12_ep11_exp3
	expert_comp_12_ep11_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep12
	token_route_12_ep12 -> expert_12_ep12_exp0
	expert_12_ep12_exp0 -> expert_comp_12_ep12_exp0
	expert_comp_12_ep12_exp0 -> expert_agg_12
	token_route_12_ep12 -> expert_12_ep12_exp1
	expert_12_ep12_exp1 -> expert_comp_12_ep12_exp1
	expert_comp_12_ep12_exp1 -> expert_agg_12
	token_route_12_ep12 -> expert_12_ep12_exp2
	expert_12_ep12_exp2 -> expert_comp_12_ep12_exp2
	expert_comp_12_ep12_exp2 -> expert_agg_12
	token_route_12_ep12 -> expert_12_ep12_exp3
	expert_12_ep12_exp3 -> expert_comp_12_ep12_exp3
	expert_comp_12_ep12_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep13
	token_route_12_ep13 -> expert_12_ep13_exp0
	expert_12_ep13_exp0 -> expert_comp_12_ep13_exp0
	expert_comp_12_ep13_exp0 -> expert_agg_12
	token_route_12_ep13 -> expert_12_ep13_exp1
	expert_12_ep13_exp1 -> expert_comp_12_ep13_exp1
	expert_comp_12_ep13_exp1 -> expert_agg_12
	token_route_12_ep13 -> expert_12_ep13_exp2
	expert_12_ep13_exp2 -> expert_comp_12_ep13_exp2
	expert_comp_12_ep13_exp2 -> expert_agg_12
	token_route_12_ep13 -> expert_12_ep13_exp3
	expert_12_ep13_exp3 -> expert_comp_12_ep13_exp3
	expert_comp_12_ep13_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep14
	token_route_12_ep14 -> expert_12_ep14_exp0
	expert_12_ep14_exp0 -> expert_comp_12_ep14_exp0
	expert_comp_12_ep14_exp0 -> expert_agg_12
	token_route_12_ep14 -> expert_12_ep14_exp1
	expert_12_ep14_exp1 -> expert_comp_12_ep14_exp1
	expert_comp_12_ep14_exp1 -> expert_agg_12
	token_route_12_ep14 -> expert_12_ep14_exp2
	expert_12_ep14_exp2 -> expert_comp_12_ep14_exp2
	expert_comp_12_ep14_exp2 -> expert_agg_12
	token_route_12_ep14 -> expert_12_ep14_exp3
	expert_12_ep14_exp3 -> expert_comp_12_ep14_exp3
	expert_comp_12_ep14_exp3 -> expert_agg_12
	expert_select_12 -> token_route_12_ep15
	token_route_12_ep15 -> expert_12_ep15_exp0
	expert_12_ep15_exp0 -> expert_comp_12_ep15_exp0
	expert_comp_12_ep15_exp0 -> expert_agg_12
	token_route_12_ep15 -> expert_12_ep15_exp1
	expert_12_ep15_exp1 -> expert_comp_12_ep15_exp1
	expert_comp_12_ep15_exp1 -> expert_agg_12
	token_route_12_ep15 -> expert_12_ep15_exp2
	expert_12_ep15_exp2 -> expert_comp_12_ep15_exp2
	expert_comp_12_ep15_exp2 -> expert_agg_12
	token_route_12_ep15 -> expert_12_ep15_exp3
	expert_12_ep15_exp3 -> expert_comp_12_ep15_exp3
	expert_comp_12_ep15_exp3 -> expert_agg_12
	expert_agg_12 -> moe_out_linear_12_tp0
	moe_out_linear_12_tp0 -> allreduce_moe_12
	moe_out_linear_12_tp1 -> allreduce_moe_12
	moe_out_linear_12_tp2 -> allreduce_moe_12
	moe_out_linear_12_tp3 -> allreduce_moe_12
	allreduce_moe_12 -> layernorm_12
	layernorm_12 -> qkv_linear_13_tp0
	allreduce_att_13 -> gate_13 [style=dashed]
	gate_13 -> expert_select_13
	expert_select_13 -> token_route_13_ep0
	token_route_13_ep0 -> expert_13_ep0_exp0
	expert_13_ep0_exp0 -> expert_comp_13_ep0_exp0
	expert_comp_13_ep0_exp0 -> expert_agg_13
	token_route_13_ep0 -> expert_13_ep0_exp1
	expert_13_ep0_exp1 -> expert_comp_13_ep0_exp1
	expert_comp_13_ep0_exp1 -> expert_agg_13
	token_route_13_ep0 -> expert_13_ep0_exp2
	expert_13_ep0_exp2 -> expert_comp_13_ep0_exp2
	expert_comp_13_ep0_exp2 -> expert_agg_13
	token_route_13_ep0 -> expert_13_ep0_exp3
	expert_13_ep0_exp3 -> expert_comp_13_ep0_exp3
	expert_comp_13_ep0_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep1
	token_route_13_ep1 -> expert_13_ep1_exp0
	expert_13_ep1_exp0 -> expert_comp_13_ep1_exp0
	expert_comp_13_ep1_exp0 -> expert_agg_13
	token_route_13_ep1 -> expert_13_ep1_exp1
	expert_13_ep1_exp1 -> expert_comp_13_ep1_exp1
	expert_comp_13_ep1_exp1 -> expert_agg_13
	token_route_13_ep1 -> expert_13_ep1_exp2
	expert_13_ep1_exp2 -> expert_comp_13_ep1_exp2
	expert_comp_13_ep1_exp2 -> expert_agg_13
	token_route_13_ep1 -> expert_13_ep1_exp3
	expert_13_ep1_exp3 -> expert_comp_13_ep1_exp3
	expert_comp_13_ep1_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep2
	token_route_13_ep2 -> expert_13_ep2_exp0
	expert_13_ep2_exp0 -> expert_comp_13_ep2_exp0
	expert_comp_13_ep2_exp0 -> expert_agg_13
	token_route_13_ep2 -> expert_13_ep2_exp1
	expert_13_ep2_exp1 -> expert_comp_13_ep2_exp1
	expert_comp_13_ep2_exp1 -> expert_agg_13
	token_route_13_ep2 -> expert_13_ep2_exp2
	expert_13_ep2_exp2 -> expert_comp_13_ep2_exp2
	expert_comp_13_ep2_exp2 -> expert_agg_13
	token_route_13_ep2 -> expert_13_ep2_exp3
	expert_13_ep2_exp3 -> expert_comp_13_ep2_exp3
	expert_comp_13_ep2_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep3
	token_route_13_ep3 -> expert_13_ep3_exp0
	expert_13_ep3_exp0 -> expert_comp_13_ep3_exp0
	expert_comp_13_ep3_exp0 -> expert_agg_13
	token_route_13_ep3 -> expert_13_ep3_exp1
	expert_13_ep3_exp1 -> expert_comp_13_ep3_exp1
	expert_comp_13_ep3_exp1 -> expert_agg_13
	token_route_13_ep3 -> expert_13_ep3_exp2
	expert_13_ep3_exp2 -> expert_comp_13_ep3_exp2
	expert_comp_13_ep3_exp2 -> expert_agg_13
	token_route_13_ep3 -> expert_13_ep3_exp3
	expert_13_ep3_exp3 -> expert_comp_13_ep3_exp3
	expert_comp_13_ep3_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep4
	token_route_13_ep4 -> expert_13_ep4_exp0
	expert_13_ep4_exp0 -> expert_comp_13_ep4_exp0
	expert_comp_13_ep4_exp0 -> expert_agg_13
	token_route_13_ep4 -> expert_13_ep4_exp1
	expert_13_ep4_exp1 -> expert_comp_13_ep4_exp1
	expert_comp_13_ep4_exp1 -> expert_agg_13
	token_route_13_ep4 -> expert_13_ep4_exp2
	expert_13_ep4_exp2 -> expert_comp_13_ep4_exp2
	expert_comp_13_ep4_exp2 -> expert_agg_13
	token_route_13_ep4 -> expert_13_ep4_exp3
	expert_13_ep4_exp3 -> expert_comp_13_ep4_exp3
	expert_comp_13_ep4_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep5
	token_route_13_ep5 -> expert_13_ep5_exp0
	expert_13_ep5_exp0 -> expert_comp_13_ep5_exp0
	expert_comp_13_ep5_exp0 -> expert_agg_13
	token_route_13_ep5 -> expert_13_ep5_exp1
	expert_13_ep5_exp1 -> expert_comp_13_ep5_exp1
	expert_comp_13_ep5_exp1 -> expert_agg_13
	token_route_13_ep5 -> expert_13_ep5_exp2
	expert_13_ep5_exp2 -> expert_comp_13_ep5_exp2
	expert_comp_13_ep5_exp2 -> expert_agg_13
	token_route_13_ep5 -> expert_13_ep5_exp3
	expert_13_ep5_exp3 -> expert_comp_13_ep5_exp3
	expert_comp_13_ep5_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep6
	token_route_13_ep6 -> expert_13_ep6_exp0
	expert_13_ep6_exp0 -> expert_comp_13_ep6_exp0
	expert_comp_13_ep6_exp0 -> expert_agg_13
	token_route_13_ep6 -> expert_13_ep6_exp1
	expert_13_ep6_exp1 -> expert_comp_13_ep6_exp1
	expert_comp_13_ep6_exp1 -> expert_agg_13
	token_route_13_ep6 -> expert_13_ep6_exp2
	expert_13_ep6_exp2 -> expert_comp_13_ep6_exp2
	expert_comp_13_ep6_exp2 -> expert_agg_13
	token_route_13_ep6 -> expert_13_ep6_exp3
	expert_13_ep6_exp3 -> expert_comp_13_ep6_exp3
	expert_comp_13_ep6_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep7
	token_route_13_ep7 -> expert_13_ep7_exp0
	expert_13_ep7_exp0 -> expert_comp_13_ep7_exp0
	expert_comp_13_ep7_exp0 -> expert_agg_13
	token_route_13_ep7 -> expert_13_ep7_exp1
	expert_13_ep7_exp1 -> expert_comp_13_ep7_exp1
	expert_comp_13_ep7_exp1 -> expert_agg_13
	token_route_13_ep7 -> expert_13_ep7_exp2
	expert_13_ep7_exp2 -> expert_comp_13_ep7_exp2
	expert_comp_13_ep7_exp2 -> expert_agg_13
	token_route_13_ep7 -> expert_13_ep7_exp3
	expert_13_ep7_exp3 -> expert_comp_13_ep7_exp3
	expert_comp_13_ep7_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep8
	token_route_13_ep8 -> expert_13_ep8_exp0
	expert_13_ep8_exp0 -> expert_comp_13_ep8_exp0
	expert_comp_13_ep8_exp0 -> expert_agg_13
	token_route_13_ep8 -> expert_13_ep8_exp1
	expert_13_ep8_exp1 -> expert_comp_13_ep8_exp1
	expert_comp_13_ep8_exp1 -> expert_agg_13
	token_route_13_ep8 -> expert_13_ep8_exp2
	expert_13_ep8_exp2 -> expert_comp_13_ep8_exp2
	expert_comp_13_ep8_exp2 -> expert_agg_13
	token_route_13_ep8 -> expert_13_ep8_exp3
	expert_13_ep8_exp3 -> expert_comp_13_ep8_exp3
	expert_comp_13_ep8_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep9
	token_route_13_ep9 -> expert_13_ep9_exp0
	expert_13_ep9_exp0 -> expert_comp_13_ep9_exp0
	expert_comp_13_ep9_exp0 -> expert_agg_13
	token_route_13_ep9 -> expert_13_ep9_exp1
	expert_13_ep9_exp1 -> expert_comp_13_ep9_exp1
	expert_comp_13_ep9_exp1 -> expert_agg_13
	token_route_13_ep9 -> expert_13_ep9_exp2
	expert_13_ep9_exp2 -> expert_comp_13_ep9_exp2
	expert_comp_13_ep9_exp2 -> expert_agg_13
	token_route_13_ep9 -> expert_13_ep9_exp3
	expert_13_ep9_exp3 -> expert_comp_13_ep9_exp3
	expert_comp_13_ep9_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep10
	token_route_13_ep10 -> expert_13_ep10_exp0
	expert_13_ep10_exp0 -> expert_comp_13_ep10_exp0
	expert_comp_13_ep10_exp0 -> expert_agg_13
	token_route_13_ep10 -> expert_13_ep10_exp1
	expert_13_ep10_exp1 -> expert_comp_13_ep10_exp1
	expert_comp_13_ep10_exp1 -> expert_agg_13
	token_route_13_ep10 -> expert_13_ep10_exp2
	expert_13_ep10_exp2 -> expert_comp_13_ep10_exp2
	expert_comp_13_ep10_exp2 -> expert_agg_13
	token_route_13_ep10 -> expert_13_ep10_exp3
	expert_13_ep10_exp3 -> expert_comp_13_ep10_exp3
	expert_comp_13_ep10_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep11
	token_route_13_ep11 -> expert_13_ep11_exp0
	expert_13_ep11_exp0 -> expert_comp_13_ep11_exp0
	expert_comp_13_ep11_exp0 -> expert_agg_13
	token_route_13_ep11 -> expert_13_ep11_exp1
	expert_13_ep11_exp1 -> expert_comp_13_ep11_exp1
	expert_comp_13_ep11_exp1 -> expert_agg_13
	token_route_13_ep11 -> expert_13_ep11_exp2
	expert_13_ep11_exp2 -> expert_comp_13_ep11_exp2
	expert_comp_13_ep11_exp2 -> expert_agg_13
	token_route_13_ep11 -> expert_13_ep11_exp3
	expert_13_ep11_exp3 -> expert_comp_13_ep11_exp3
	expert_comp_13_ep11_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep12
	token_route_13_ep12 -> expert_13_ep12_exp0
	expert_13_ep12_exp0 -> expert_comp_13_ep12_exp0
	expert_comp_13_ep12_exp0 -> expert_agg_13
	token_route_13_ep12 -> expert_13_ep12_exp1
	expert_13_ep12_exp1 -> expert_comp_13_ep12_exp1
	expert_comp_13_ep12_exp1 -> expert_agg_13
	token_route_13_ep12 -> expert_13_ep12_exp2
	expert_13_ep12_exp2 -> expert_comp_13_ep12_exp2
	expert_comp_13_ep12_exp2 -> expert_agg_13
	token_route_13_ep12 -> expert_13_ep12_exp3
	expert_13_ep12_exp3 -> expert_comp_13_ep12_exp3
	expert_comp_13_ep12_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep13
	token_route_13_ep13 -> expert_13_ep13_exp0
	expert_13_ep13_exp0 -> expert_comp_13_ep13_exp0
	expert_comp_13_ep13_exp0 -> expert_agg_13
	token_route_13_ep13 -> expert_13_ep13_exp1
	expert_13_ep13_exp1 -> expert_comp_13_ep13_exp1
	expert_comp_13_ep13_exp1 -> expert_agg_13
	token_route_13_ep13 -> expert_13_ep13_exp2
	expert_13_ep13_exp2 -> expert_comp_13_ep13_exp2
	expert_comp_13_ep13_exp2 -> expert_agg_13
	token_route_13_ep13 -> expert_13_ep13_exp3
	expert_13_ep13_exp3 -> expert_comp_13_ep13_exp3
	expert_comp_13_ep13_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep14
	token_route_13_ep14 -> expert_13_ep14_exp0
	expert_13_ep14_exp0 -> expert_comp_13_ep14_exp0
	expert_comp_13_ep14_exp0 -> expert_agg_13
	token_route_13_ep14 -> expert_13_ep14_exp1
	expert_13_ep14_exp1 -> expert_comp_13_ep14_exp1
	expert_comp_13_ep14_exp1 -> expert_agg_13
	token_route_13_ep14 -> expert_13_ep14_exp2
	expert_13_ep14_exp2 -> expert_comp_13_ep14_exp2
	expert_comp_13_ep14_exp2 -> expert_agg_13
	token_route_13_ep14 -> expert_13_ep14_exp3
	expert_13_ep14_exp3 -> expert_comp_13_ep14_exp3
	expert_comp_13_ep14_exp3 -> expert_agg_13
	expert_select_13 -> token_route_13_ep15
	token_route_13_ep15 -> expert_13_ep15_exp0
	expert_13_ep15_exp0 -> expert_comp_13_ep15_exp0
	expert_comp_13_ep15_exp0 -> expert_agg_13
	token_route_13_ep15 -> expert_13_ep15_exp1
	expert_13_ep15_exp1 -> expert_comp_13_ep15_exp1
	expert_comp_13_ep15_exp1 -> expert_agg_13
	token_route_13_ep15 -> expert_13_ep15_exp2
	expert_13_ep15_exp2 -> expert_comp_13_ep15_exp2
	expert_comp_13_ep15_exp2 -> expert_agg_13
	token_route_13_ep15 -> expert_13_ep15_exp3
	expert_13_ep15_exp3 -> expert_comp_13_ep15_exp3
	expert_comp_13_ep15_exp3 -> expert_agg_13
	expert_agg_13 -> moe_out_linear_13_tp0
	moe_out_linear_13_tp0 -> allreduce_moe_13
	moe_out_linear_13_tp1 -> allreduce_moe_13
	moe_out_linear_13_tp2 -> allreduce_moe_13
	moe_out_linear_13_tp3 -> allreduce_moe_13
	allreduce_moe_13 -> layernorm_13
	layernorm_13 -> qkv_linear_14_tp0
	allreduce_att_14 -> gate_14 [style=dashed]
	gate_14 -> expert_select_14
	expert_select_14 -> token_route_14_ep0
	token_route_14_ep0 -> expert_14_ep0_exp0
	expert_14_ep0_exp0 -> expert_comp_14_ep0_exp0
	expert_comp_14_ep0_exp0 -> expert_agg_14
	token_route_14_ep0 -> expert_14_ep0_exp1
	expert_14_ep0_exp1 -> expert_comp_14_ep0_exp1
	expert_comp_14_ep0_exp1 -> expert_agg_14
	token_route_14_ep0 -> expert_14_ep0_exp2
	expert_14_ep0_exp2 -> expert_comp_14_ep0_exp2
	expert_comp_14_ep0_exp2 -> expert_agg_14
	token_route_14_ep0 -> expert_14_ep0_exp3
	expert_14_ep0_exp3 -> expert_comp_14_ep0_exp3
	expert_comp_14_ep0_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep1
	token_route_14_ep1 -> expert_14_ep1_exp0
	expert_14_ep1_exp0 -> expert_comp_14_ep1_exp0
	expert_comp_14_ep1_exp0 -> expert_agg_14
	token_route_14_ep1 -> expert_14_ep1_exp1
	expert_14_ep1_exp1 -> expert_comp_14_ep1_exp1
	expert_comp_14_ep1_exp1 -> expert_agg_14
	token_route_14_ep1 -> expert_14_ep1_exp2
	expert_14_ep1_exp2 -> expert_comp_14_ep1_exp2
	expert_comp_14_ep1_exp2 -> expert_agg_14
	token_route_14_ep1 -> expert_14_ep1_exp3
	expert_14_ep1_exp3 -> expert_comp_14_ep1_exp3
	expert_comp_14_ep1_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep2
	token_route_14_ep2 -> expert_14_ep2_exp0
	expert_14_ep2_exp0 -> expert_comp_14_ep2_exp0
	expert_comp_14_ep2_exp0 -> expert_agg_14
	token_route_14_ep2 -> expert_14_ep2_exp1
	expert_14_ep2_exp1 -> expert_comp_14_ep2_exp1
	expert_comp_14_ep2_exp1 -> expert_agg_14
	token_route_14_ep2 -> expert_14_ep2_exp2
	expert_14_ep2_exp2 -> expert_comp_14_ep2_exp2
	expert_comp_14_ep2_exp2 -> expert_agg_14
	token_route_14_ep2 -> expert_14_ep2_exp3
	expert_14_ep2_exp3 -> expert_comp_14_ep2_exp3
	expert_comp_14_ep2_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep3
	token_route_14_ep3 -> expert_14_ep3_exp0
	expert_14_ep3_exp0 -> expert_comp_14_ep3_exp0
	expert_comp_14_ep3_exp0 -> expert_agg_14
	token_route_14_ep3 -> expert_14_ep3_exp1
	expert_14_ep3_exp1 -> expert_comp_14_ep3_exp1
	expert_comp_14_ep3_exp1 -> expert_agg_14
	token_route_14_ep3 -> expert_14_ep3_exp2
	expert_14_ep3_exp2 -> expert_comp_14_ep3_exp2
	expert_comp_14_ep3_exp2 -> expert_agg_14
	token_route_14_ep3 -> expert_14_ep3_exp3
	expert_14_ep3_exp3 -> expert_comp_14_ep3_exp3
	expert_comp_14_ep3_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep4
	token_route_14_ep4 -> expert_14_ep4_exp0
	expert_14_ep4_exp0 -> expert_comp_14_ep4_exp0
	expert_comp_14_ep4_exp0 -> expert_agg_14
	token_route_14_ep4 -> expert_14_ep4_exp1
	expert_14_ep4_exp1 -> expert_comp_14_ep4_exp1
	expert_comp_14_ep4_exp1 -> expert_agg_14
	token_route_14_ep4 -> expert_14_ep4_exp2
	expert_14_ep4_exp2 -> expert_comp_14_ep4_exp2
	expert_comp_14_ep4_exp2 -> expert_agg_14
	token_route_14_ep4 -> expert_14_ep4_exp3
	expert_14_ep4_exp3 -> expert_comp_14_ep4_exp3
	expert_comp_14_ep4_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep5
	token_route_14_ep5 -> expert_14_ep5_exp0
	expert_14_ep5_exp0 -> expert_comp_14_ep5_exp0
	expert_comp_14_ep5_exp0 -> expert_agg_14
	token_route_14_ep5 -> expert_14_ep5_exp1
	expert_14_ep5_exp1 -> expert_comp_14_ep5_exp1
	expert_comp_14_ep5_exp1 -> expert_agg_14
	token_route_14_ep5 -> expert_14_ep5_exp2
	expert_14_ep5_exp2 -> expert_comp_14_ep5_exp2
	expert_comp_14_ep5_exp2 -> expert_agg_14
	token_route_14_ep5 -> expert_14_ep5_exp3
	expert_14_ep5_exp3 -> expert_comp_14_ep5_exp3
	expert_comp_14_ep5_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep6
	token_route_14_ep6 -> expert_14_ep6_exp0
	expert_14_ep6_exp0 -> expert_comp_14_ep6_exp0
	expert_comp_14_ep6_exp0 -> expert_agg_14
	token_route_14_ep6 -> expert_14_ep6_exp1
	expert_14_ep6_exp1 -> expert_comp_14_ep6_exp1
	expert_comp_14_ep6_exp1 -> expert_agg_14
	token_route_14_ep6 -> expert_14_ep6_exp2
	expert_14_ep6_exp2 -> expert_comp_14_ep6_exp2
	expert_comp_14_ep6_exp2 -> expert_agg_14
	token_route_14_ep6 -> expert_14_ep6_exp3
	expert_14_ep6_exp3 -> expert_comp_14_ep6_exp3
	expert_comp_14_ep6_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep7
	token_route_14_ep7 -> expert_14_ep7_exp0
	expert_14_ep7_exp0 -> expert_comp_14_ep7_exp0
	expert_comp_14_ep7_exp0 -> expert_agg_14
	token_route_14_ep7 -> expert_14_ep7_exp1
	expert_14_ep7_exp1 -> expert_comp_14_ep7_exp1
	expert_comp_14_ep7_exp1 -> expert_agg_14
	token_route_14_ep7 -> expert_14_ep7_exp2
	expert_14_ep7_exp2 -> expert_comp_14_ep7_exp2
	expert_comp_14_ep7_exp2 -> expert_agg_14
	token_route_14_ep7 -> expert_14_ep7_exp3
	expert_14_ep7_exp3 -> expert_comp_14_ep7_exp3
	expert_comp_14_ep7_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep8
	token_route_14_ep8 -> expert_14_ep8_exp0
	expert_14_ep8_exp0 -> expert_comp_14_ep8_exp0
	expert_comp_14_ep8_exp0 -> expert_agg_14
	token_route_14_ep8 -> expert_14_ep8_exp1
	expert_14_ep8_exp1 -> expert_comp_14_ep8_exp1
	expert_comp_14_ep8_exp1 -> expert_agg_14
	token_route_14_ep8 -> expert_14_ep8_exp2
	expert_14_ep8_exp2 -> expert_comp_14_ep8_exp2
	expert_comp_14_ep8_exp2 -> expert_agg_14
	token_route_14_ep8 -> expert_14_ep8_exp3
	expert_14_ep8_exp3 -> expert_comp_14_ep8_exp3
	expert_comp_14_ep8_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep9
	token_route_14_ep9 -> expert_14_ep9_exp0
	expert_14_ep9_exp0 -> expert_comp_14_ep9_exp0
	expert_comp_14_ep9_exp0 -> expert_agg_14
	token_route_14_ep9 -> expert_14_ep9_exp1
	expert_14_ep9_exp1 -> expert_comp_14_ep9_exp1
	expert_comp_14_ep9_exp1 -> expert_agg_14
	token_route_14_ep9 -> expert_14_ep9_exp2
	expert_14_ep9_exp2 -> expert_comp_14_ep9_exp2
	expert_comp_14_ep9_exp2 -> expert_agg_14
	token_route_14_ep9 -> expert_14_ep9_exp3
	expert_14_ep9_exp3 -> expert_comp_14_ep9_exp3
	expert_comp_14_ep9_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep10
	token_route_14_ep10 -> expert_14_ep10_exp0
	expert_14_ep10_exp0 -> expert_comp_14_ep10_exp0
	expert_comp_14_ep10_exp0 -> expert_agg_14
	token_route_14_ep10 -> expert_14_ep10_exp1
	expert_14_ep10_exp1 -> expert_comp_14_ep10_exp1
	expert_comp_14_ep10_exp1 -> expert_agg_14
	token_route_14_ep10 -> expert_14_ep10_exp2
	expert_14_ep10_exp2 -> expert_comp_14_ep10_exp2
	expert_comp_14_ep10_exp2 -> expert_agg_14
	token_route_14_ep10 -> expert_14_ep10_exp3
	expert_14_ep10_exp3 -> expert_comp_14_ep10_exp3
	expert_comp_14_ep10_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep11
	token_route_14_ep11 -> expert_14_ep11_exp0
	expert_14_ep11_exp0 -> expert_comp_14_ep11_exp0
	expert_comp_14_ep11_exp0 -> expert_agg_14
	token_route_14_ep11 -> expert_14_ep11_exp1
	expert_14_ep11_exp1 -> expert_comp_14_ep11_exp1
	expert_comp_14_ep11_exp1 -> expert_agg_14
	token_route_14_ep11 -> expert_14_ep11_exp2
	expert_14_ep11_exp2 -> expert_comp_14_ep11_exp2
	expert_comp_14_ep11_exp2 -> expert_agg_14
	token_route_14_ep11 -> expert_14_ep11_exp3
	expert_14_ep11_exp3 -> expert_comp_14_ep11_exp3
	expert_comp_14_ep11_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep12
	token_route_14_ep12 -> expert_14_ep12_exp0
	expert_14_ep12_exp0 -> expert_comp_14_ep12_exp0
	expert_comp_14_ep12_exp0 -> expert_agg_14
	token_route_14_ep12 -> expert_14_ep12_exp1
	expert_14_ep12_exp1 -> expert_comp_14_ep12_exp1
	expert_comp_14_ep12_exp1 -> expert_agg_14
	token_route_14_ep12 -> expert_14_ep12_exp2
	expert_14_ep12_exp2 -> expert_comp_14_ep12_exp2
	expert_comp_14_ep12_exp2 -> expert_agg_14
	token_route_14_ep12 -> expert_14_ep12_exp3
	expert_14_ep12_exp3 -> expert_comp_14_ep12_exp3
	expert_comp_14_ep12_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep13
	token_route_14_ep13 -> expert_14_ep13_exp0
	expert_14_ep13_exp0 -> expert_comp_14_ep13_exp0
	expert_comp_14_ep13_exp0 -> expert_agg_14
	token_route_14_ep13 -> expert_14_ep13_exp1
	expert_14_ep13_exp1 -> expert_comp_14_ep13_exp1
	expert_comp_14_ep13_exp1 -> expert_agg_14
	token_route_14_ep13 -> expert_14_ep13_exp2
	expert_14_ep13_exp2 -> expert_comp_14_ep13_exp2
	expert_comp_14_ep13_exp2 -> expert_agg_14
	token_route_14_ep13 -> expert_14_ep13_exp3
	expert_14_ep13_exp3 -> expert_comp_14_ep13_exp3
	expert_comp_14_ep13_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep14
	token_route_14_ep14 -> expert_14_ep14_exp0
	expert_14_ep14_exp0 -> expert_comp_14_ep14_exp0
	expert_comp_14_ep14_exp0 -> expert_agg_14
	token_route_14_ep14 -> expert_14_ep14_exp1
	expert_14_ep14_exp1 -> expert_comp_14_ep14_exp1
	expert_comp_14_ep14_exp1 -> expert_agg_14
	token_route_14_ep14 -> expert_14_ep14_exp2
	expert_14_ep14_exp2 -> expert_comp_14_ep14_exp2
	expert_comp_14_ep14_exp2 -> expert_agg_14
	token_route_14_ep14 -> expert_14_ep14_exp3
	expert_14_ep14_exp3 -> expert_comp_14_ep14_exp3
	expert_comp_14_ep14_exp3 -> expert_agg_14
	expert_select_14 -> token_route_14_ep15
	token_route_14_ep15 -> expert_14_ep15_exp0
	expert_14_ep15_exp0 -> expert_comp_14_ep15_exp0
	expert_comp_14_ep15_exp0 -> expert_agg_14
	token_route_14_ep15 -> expert_14_ep15_exp1
	expert_14_ep15_exp1 -> expert_comp_14_ep15_exp1
	expert_comp_14_ep15_exp1 -> expert_agg_14
	token_route_14_ep15 -> expert_14_ep15_exp2
	expert_14_ep15_exp2 -> expert_comp_14_ep15_exp2
	expert_comp_14_ep15_exp2 -> expert_agg_14
	token_route_14_ep15 -> expert_14_ep15_exp3
	expert_14_ep15_exp3 -> expert_comp_14_ep15_exp3
	expert_comp_14_ep15_exp3 -> expert_agg_14
	expert_agg_14 -> moe_out_linear_14_tp0
	moe_out_linear_14_tp0 -> allreduce_moe_14
	moe_out_linear_14_tp1 -> allreduce_moe_14
	moe_out_linear_14_tp2 -> allreduce_moe_14
	moe_out_linear_14_tp3 -> allreduce_moe_14
	allreduce_moe_14 -> layernorm_14
	layernorm_14 -> qkv_linear_15_tp0
	allreduce_att_15 -> gate_15 [style=dashed]
	gate_15 -> expert_select_15
	expert_select_15 -> token_route_15_ep0
	token_route_15_ep0 -> expert_15_ep0_exp0
	expert_15_ep0_exp0 -> expert_comp_15_ep0_exp0
	expert_comp_15_ep0_exp0 -> expert_agg_15
	token_route_15_ep0 -> expert_15_ep0_exp1
	expert_15_ep0_exp1 -> expert_comp_15_ep0_exp1
	expert_comp_15_ep0_exp1 -> expert_agg_15
	token_route_15_ep0 -> expert_15_ep0_exp2
	expert_15_ep0_exp2 -> expert_comp_15_ep0_exp2
	expert_comp_15_ep0_exp2 -> expert_agg_15
	token_route_15_ep0 -> expert_15_ep0_exp3
	expert_15_ep0_exp3 -> expert_comp_15_ep0_exp3
	expert_comp_15_ep0_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep1
	token_route_15_ep1 -> expert_15_ep1_exp0
	expert_15_ep1_exp0 -> expert_comp_15_ep1_exp0
	expert_comp_15_ep1_exp0 -> expert_agg_15
	token_route_15_ep1 -> expert_15_ep1_exp1
	expert_15_ep1_exp1 -> expert_comp_15_ep1_exp1
	expert_comp_15_ep1_exp1 -> expert_agg_15
	token_route_15_ep1 -> expert_15_ep1_exp2
	expert_15_ep1_exp2 -> expert_comp_15_ep1_exp2
	expert_comp_15_ep1_exp2 -> expert_agg_15
	token_route_15_ep1 -> expert_15_ep1_exp3
	expert_15_ep1_exp3 -> expert_comp_15_ep1_exp3
	expert_comp_15_ep1_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep2
	token_route_15_ep2 -> expert_15_ep2_exp0
	expert_15_ep2_exp0 -> expert_comp_15_ep2_exp0
	expert_comp_15_ep2_exp0 -> expert_agg_15
	token_route_15_ep2 -> expert_15_ep2_exp1
	expert_15_ep2_exp1 -> expert_comp_15_ep2_exp1
	expert_comp_15_ep2_exp1 -> expert_agg_15
	token_route_15_ep2 -> expert_15_ep2_exp2
	expert_15_ep2_exp2 -> expert_comp_15_ep2_exp2
	expert_comp_15_ep2_exp2 -> expert_agg_15
	token_route_15_ep2 -> expert_15_ep2_exp3
	expert_15_ep2_exp3 -> expert_comp_15_ep2_exp3
	expert_comp_15_ep2_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep3
	token_route_15_ep3 -> expert_15_ep3_exp0
	expert_15_ep3_exp0 -> expert_comp_15_ep3_exp0
	expert_comp_15_ep3_exp0 -> expert_agg_15
	token_route_15_ep3 -> expert_15_ep3_exp1
	expert_15_ep3_exp1 -> expert_comp_15_ep3_exp1
	expert_comp_15_ep3_exp1 -> expert_agg_15
	token_route_15_ep3 -> expert_15_ep3_exp2
	expert_15_ep3_exp2 -> expert_comp_15_ep3_exp2
	expert_comp_15_ep3_exp2 -> expert_agg_15
	token_route_15_ep3 -> expert_15_ep3_exp3
	expert_15_ep3_exp3 -> expert_comp_15_ep3_exp3
	expert_comp_15_ep3_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep4
	token_route_15_ep4 -> expert_15_ep4_exp0
	expert_15_ep4_exp0 -> expert_comp_15_ep4_exp0
	expert_comp_15_ep4_exp0 -> expert_agg_15
	token_route_15_ep4 -> expert_15_ep4_exp1
	expert_15_ep4_exp1 -> expert_comp_15_ep4_exp1
	expert_comp_15_ep4_exp1 -> expert_agg_15
	token_route_15_ep4 -> expert_15_ep4_exp2
	expert_15_ep4_exp2 -> expert_comp_15_ep4_exp2
	expert_comp_15_ep4_exp2 -> expert_agg_15
	token_route_15_ep4 -> expert_15_ep4_exp3
	expert_15_ep4_exp3 -> expert_comp_15_ep4_exp3
	expert_comp_15_ep4_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep5
	token_route_15_ep5 -> expert_15_ep5_exp0
	expert_15_ep5_exp0 -> expert_comp_15_ep5_exp0
	expert_comp_15_ep5_exp0 -> expert_agg_15
	token_route_15_ep5 -> expert_15_ep5_exp1
	expert_15_ep5_exp1 -> expert_comp_15_ep5_exp1
	expert_comp_15_ep5_exp1 -> expert_agg_15
	token_route_15_ep5 -> expert_15_ep5_exp2
	expert_15_ep5_exp2 -> expert_comp_15_ep5_exp2
	expert_comp_15_ep5_exp2 -> expert_agg_15
	token_route_15_ep5 -> expert_15_ep5_exp3
	expert_15_ep5_exp3 -> expert_comp_15_ep5_exp3
	expert_comp_15_ep5_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep6
	token_route_15_ep6 -> expert_15_ep6_exp0
	expert_15_ep6_exp0 -> expert_comp_15_ep6_exp0
	expert_comp_15_ep6_exp0 -> expert_agg_15
	token_route_15_ep6 -> expert_15_ep6_exp1
	expert_15_ep6_exp1 -> expert_comp_15_ep6_exp1
	expert_comp_15_ep6_exp1 -> expert_agg_15
	token_route_15_ep6 -> expert_15_ep6_exp2
	expert_15_ep6_exp2 -> expert_comp_15_ep6_exp2
	expert_comp_15_ep6_exp2 -> expert_agg_15
	token_route_15_ep6 -> expert_15_ep6_exp3
	expert_15_ep6_exp3 -> expert_comp_15_ep6_exp3
	expert_comp_15_ep6_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep7
	token_route_15_ep7 -> expert_15_ep7_exp0
	expert_15_ep7_exp0 -> expert_comp_15_ep7_exp0
	expert_comp_15_ep7_exp0 -> expert_agg_15
	token_route_15_ep7 -> expert_15_ep7_exp1
	expert_15_ep7_exp1 -> expert_comp_15_ep7_exp1
	expert_comp_15_ep7_exp1 -> expert_agg_15
	token_route_15_ep7 -> expert_15_ep7_exp2
	expert_15_ep7_exp2 -> expert_comp_15_ep7_exp2
	expert_comp_15_ep7_exp2 -> expert_agg_15
	token_route_15_ep7 -> expert_15_ep7_exp3
	expert_15_ep7_exp3 -> expert_comp_15_ep7_exp3
	expert_comp_15_ep7_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep8
	token_route_15_ep8 -> expert_15_ep8_exp0
	expert_15_ep8_exp0 -> expert_comp_15_ep8_exp0
	expert_comp_15_ep8_exp0 -> expert_agg_15
	token_route_15_ep8 -> expert_15_ep8_exp1
	expert_15_ep8_exp1 -> expert_comp_15_ep8_exp1
	expert_comp_15_ep8_exp1 -> expert_agg_15
	token_route_15_ep8 -> expert_15_ep8_exp2
	expert_15_ep8_exp2 -> expert_comp_15_ep8_exp2
	expert_comp_15_ep8_exp2 -> expert_agg_15
	token_route_15_ep8 -> expert_15_ep8_exp3
	expert_15_ep8_exp3 -> expert_comp_15_ep8_exp3
	expert_comp_15_ep8_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep9
	token_route_15_ep9 -> expert_15_ep9_exp0
	expert_15_ep9_exp0 -> expert_comp_15_ep9_exp0
	expert_comp_15_ep9_exp0 -> expert_agg_15
	token_route_15_ep9 -> expert_15_ep9_exp1
	expert_15_ep9_exp1 -> expert_comp_15_ep9_exp1
	expert_comp_15_ep9_exp1 -> expert_agg_15
	token_route_15_ep9 -> expert_15_ep9_exp2
	expert_15_ep9_exp2 -> expert_comp_15_ep9_exp2
	expert_comp_15_ep9_exp2 -> expert_agg_15
	token_route_15_ep9 -> expert_15_ep9_exp3
	expert_15_ep9_exp3 -> expert_comp_15_ep9_exp3
	expert_comp_15_ep9_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep10
	token_route_15_ep10 -> expert_15_ep10_exp0
	expert_15_ep10_exp0 -> expert_comp_15_ep10_exp0
	expert_comp_15_ep10_exp0 -> expert_agg_15
	token_route_15_ep10 -> expert_15_ep10_exp1
	expert_15_ep10_exp1 -> expert_comp_15_ep10_exp1
	expert_comp_15_ep10_exp1 -> expert_agg_15
	token_route_15_ep10 -> expert_15_ep10_exp2
	expert_15_ep10_exp2 -> expert_comp_15_ep10_exp2
	expert_comp_15_ep10_exp2 -> expert_agg_15
	token_route_15_ep10 -> expert_15_ep10_exp3
	expert_15_ep10_exp3 -> expert_comp_15_ep10_exp3
	expert_comp_15_ep10_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep11
	token_route_15_ep11 -> expert_15_ep11_exp0
	expert_15_ep11_exp0 -> expert_comp_15_ep11_exp0
	expert_comp_15_ep11_exp0 -> expert_agg_15
	token_route_15_ep11 -> expert_15_ep11_exp1
	expert_15_ep11_exp1 -> expert_comp_15_ep11_exp1
	expert_comp_15_ep11_exp1 -> expert_agg_15
	token_route_15_ep11 -> expert_15_ep11_exp2
	expert_15_ep11_exp2 -> expert_comp_15_ep11_exp2
	expert_comp_15_ep11_exp2 -> expert_agg_15
	token_route_15_ep11 -> expert_15_ep11_exp3
	expert_15_ep11_exp3 -> expert_comp_15_ep11_exp3
	expert_comp_15_ep11_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep12
	token_route_15_ep12 -> expert_15_ep12_exp0
	expert_15_ep12_exp0 -> expert_comp_15_ep12_exp0
	expert_comp_15_ep12_exp0 -> expert_agg_15
	token_route_15_ep12 -> expert_15_ep12_exp1
	expert_15_ep12_exp1 -> expert_comp_15_ep12_exp1
	expert_comp_15_ep12_exp1 -> expert_agg_15
	token_route_15_ep12 -> expert_15_ep12_exp2
	expert_15_ep12_exp2 -> expert_comp_15_ep12_exp2
	expert_comp_15_ep12_exp2 -> expert_agg_15
	token_route_15_ep12 -> expert_15_ep12_exp3
	expert_15_ep12_exp3 -> expert_comp_15_ep12_exp3
	expert_comp_15_ep12_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep13
	token_route_15_ep13 -> expert_15_ep13_exp0
	expert_15_ep13_exp0 -> expert_comp_15_ep13_exp0
	expert_comp_15_ep13_exp0 -> expert_agg_15
	token_route_15_ep13 -> expert_15_ep13_exp1
	expert_15_ep13_exp1 -> expert_comp_15_ep13_exp1
	expert_comp_15_ep13_exp1 -> expert_agg_15
	token_route_15_ep13 -> expert_15_ep13_exp2
	expert_15_ep13_exp2 -> expert_comp_15_ep13_exp2
	expert_comp_15_ep13_exp2 -> expert_agg_15
	token_route_15_ep13 -> expert_15_ep13_exp3
	expert_15_ep13_exp3 -> expert_comp_15_ep13_exp3
	expert_comp_15_ep13_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep14
	token_route_15_ep14 -> expert_15_ep14_exp0
	expert_15_ep14_exp0 -> expert_comp_15_ep14_exp0
	expert_comp_15_ep14_exp0 -> expert_agg_15
	token_route_15_ep14 -> expert_15_ep14_exp1
	expert_15_ep14_exp1 -> expert_comp_15_ep14_exp1
	expert_comp_15_ep14_exp1 -> expert_agg_15
	token_route_15_ep14 -> expert_15_ep14_exp2
	expert_15_ep14_exp2 -> expert_comp_15_ep14_exp2
	expert_comp_15_ep14_exp2 -> expert_agg_15
	token_route_15_ep14 -> expert_15_ep14_exp3
	expert_15_ep14_exp3 -> expert_comp_15_ep14_exp3
	expert_comp_15_ep14_exp3 -> expert_agg_15
	expert_select_15 -> token_route_15_ep15
	token_route_15_ep15 -> expert_15_ep15_exp0
	expert_15_ep15_exp0 -> expert_comp_15_ep15_exp0
	expert_comp_15_ep15_exp0 -> expert_agg_15
	token_route_15_ep15 -> expert_15_ep15_exp1
	expert_15_ep15_exp1 -> expert_comp_15_ep15_exp1
	expert_comp_15_ep15_exp1 -> expert_agg_15
	token_route_15_ep15 -> expert_15_ep15_exp2
	expert_15_ep15_exp2 -> expert_comp_15_ep15_exp2
	expert_comp_15_ep15_exp2 -> expert_agg_15
	token_route_15_ep15 -> expert_15_ep15_exp3
	expert_15_ep15_exp3 -> expert_comp_15_ep15_exp3
	expert_comp_15_ep15_exp3 -> expert_agg_15
	expert_agg_15 -> moe_out_linear_15_tp0
	moe_out_linear_15_tp0 -> allreduce_moe_15
	moe_out_linear_15_tp1 -> allreduce_moe_15
	moe_out_linear_15_tp2 -> allreduce_moe_15
	moe_out_linear_15_tp3 -> allreduce_moe_15
	allreduce_moe_15 -> layernorm_15
	layernorm_15 -> output
}
