<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: DeepSeek_R1_Helix Pages: 1 -->
<svg width="1440pt" height="305pt"
 viewBox="0.00 0.00 1440.00 305.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.26 0.26) rotate(0) translate(4 1165)">
<title>DeepSeek_R1_Helix</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1165 5508,-1165 5508,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attention</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2330,-759 2330,-1095 5496,-1095 5496,-759 2330,-759"/>
<text text-anchor="middle" x="3913" y="-1079.8" font-family="Times,serif" font-size="14.00">Attention Phase (KV Parallelism)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ffn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-86 8,-751 4038,-751 4038,-86 8,-86"/>
<text text-anchor="middle" x="2023" y="-735.8" font-family="Times,serif" font-size="14.00">FFN Phase (TPÃ—EP)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="3913" cy="-1132" rx="170.02" ry="29"/>
<text text-anchor="middle" x="3913" y="-1135" font-family="Times,serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="3913" y="-1124" font-family="Times,serif" font-size="10.00">Input: [batch_size=B, seq_len=1, hidden_dim=16384]</text>
</g>
<!-- qkv_0 -->
<g id="node2" class="node">
<title>qkv_0</title>
<polygon fill="lightyellow" stroke="black" points="5488,-1064 5308,-1064 5308,-1006 5488,-1006 5488,-1064"/>
<text text-anchor="middle" x="5398" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5398" y="-1038" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="5398" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="5398" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;qkv_0</title>
<path fill="none" stroke="black" d="M4083.09,-1131.4C4427.68,-1131.5 5185.27,-1127.91 5299,-1095 5317.65,-1089.6 5336.38,-1079.82 5352.46,-1069.75"/>
<polygon fill="black" stroke="black" points="5354.61,-1072.53 5361.1,-1064.16 5350.8,-1066.66 5354.61,-1072.53"/>
</g>
<!-- qkv_1 -->
<g id="node5" class="node">
<title>qkv_1</title>
<polygon fill="lightyellow" stroke="black" points="5290,-1064 5110,-1064 5110,-1006 5290,-1006 5290,-1064"/>
<text text-anchor="middle" x="5200" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5200" y="-1038" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="5200" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="5200" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_1 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;qkv_1</title>
<path fill="none" stroke="black" d="M4082.88,-1130.57C4388.04,-1129.09 5006.14,-1122.68 5101,-1095 5119.64,-1089.56 5138.37,-1079.77 5154.45,-1069.71"/>
<polygon fill="black" stroke="black" points="5156.59,-1072.49 5163.09,-1064.11 5152.79,-1066.61 5156.59,-1072.49"/>
</g>
<!-- qkv_2 -->
<g id="node7" class="node">
<title>qkv_2</title>
<polygon fill="lightyellow" stroke="black" points="5092,-1064 4912,-1064 4912,-1006 5092,-1006 5092,-1064"/>
<text text-anchor="middle" x="5002" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5002" y="-1038" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="5002" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="5002" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_2 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;qkv_2</title>
<path fill="none" stroke="black" d="M4082.4,-1129.41C4344.65,-1126.27 4826.78,-1117.49 4903,-1095 4921.62,-1089.51 4940.35,-1079.7 4956.43,-1069.64"/>
<polygon fill="black" stroke="black" points="4958.57,-1072.42 4965.07,-1064.05 4954.77,-1066.54 4958.57,-1072.42"/>
</g>
<!-- qkv_3 -->
<g id="node9" class="node">
<title>qkv_3</title>
<polygon fill="lightyellow" stroke="black" points="4894,-1064 4714,-1064 4714,-1006 4894,-1006 4894,-1064"/>
<text text-anchor="middle" x="4804" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4804" y="-1038" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="4804" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="4804" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_3 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;qkv_3</title>
<path fill="none" stroke="black" d="M4081.53,-1127.71C4296.4,-1122.83 4647.16,-1112.35 4705,-1095 4723.43,-1089.47 4741.99,-1079.77 4757.98,-1069.81"/>
<polygon fill="black" stroke="black" points="4760.06,-1072.63 4766.58,-1064.27 4756.27,-1066.74 4760.06,-1072.63"/>
</g>
<!-- qkv_4 -->
<g id="node11" class="node">
<title>qkv_4</title>
<polygon fill="lightyellow" stroke="black" points="4696,-1064 4516,-1064 4516,-1006 4696,-1006 4696,-1064"/>
<text text-anchor="middle" x="4606" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4606" y="-1038" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="4606" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="4606" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_4 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;qkv_4</title>
<path fill="none" stroke="black" d="M4082.76,-1129.6C4229.84,-1126.77 4430.67,-1118.53 4507,-1095 4525.39,-1089.33 4543.94,-1079.59 4559.93,-1069.64"/>
<polygon fill="black" stroke="black" points="4562.01,-1072.47 4568.53,-1064.12 4558.23,-1066.58 4562.01,-1072.47"/>
</g>
<!-- qkv_5 -->
<g id="node13" class="node">
<title>qkv_5</title>
<polygon fill="lightyellow" stroke="black" points="4498,-1064 4318,-1064 4318,-1006 4498,-1006 4498,-1064"/>
<text text-anchor="middle" x="4408" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4408" y="-1038" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4408" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="4408" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_5 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;qkv_5</title>
<path fill="none" stroke="black" d="M4075.6,-1123.48C4165.07,-1117.91 4266.36,-1108.85 4309,-1095 4327.14,-1089.11 4345.5,-1079.42 4361.4,-1069.58"/>
<polygon fill="black" stroke="black" points="4363.42,-1072.45 4369.97,-1064.12 4359.65,-1066.55 4363.42,-1072.45"/>
</g>
<!-- qkv_6 -->
<g id="node15" class="node">
<title>qkv_6</title>
<polygon fill="lightyellow" stroke="black" points="4300,-1064 4120,-1064 4120,-1006 4300,-1006 4300,-1064"/>
<text text-anchor="middle" x="4210" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4210" y="-1038" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4210" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="4210" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_6 -->
<g id="edge19" class="edge">
<title>input&#45;&gt;qkv_6</title>
<path fill="none" stroke="black" d="M4045.26,-1113.76C4067.57,-1108.93 4090.23,-1102.79 4111,-1095 4128.23,-1088.54 4145.85,-1079.11 4161.37,-1069.68"/>
<polygon fill="black" stroke="black" points="4163.6,-1072.41 4170.24,-1064.14 4159.9,-1066.47 4163.6,-1072.41"/>
</g>
<!-- qkv_7 -->
<g id="node17" class="node">
<title>qkv_7</title>
<polygon fill="lightyellow" stroke="black" points="4102,-1064 3922,-1064 3922,-1006 4102,-1006 4102,-1064"/>
<text text-anchor="middle" x="4012" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4012" y="-1038" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4012" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="4012" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_7 -->
<g id="edge22" class="edge">
<title>input&#45;&gt;qkv_7</title>
<path fill="none" stroke="black" d="M3941.9,-1103.27C3952.29,-1093.3 3964.15,-1081.92 3975.12,-1071.39"/>
<polygon fill="black" stroke="black" points="3977.76,-1073.71 3982.55,-1064.26 3972.91,-1068.66 3977.76,-1073.71"/>
</g>
<!-- qkv_8 -->
<g id="node19" class="node">
<title>qkv_8</title>
<polygon fill="lightyellow" stroke="black" points="3904,-1064 3724,-1064 3724,-1006 3904,-1006 3904,-1064"/>
<text text-anchor="middle" x="3814" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3814" y="-1038" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3814" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3814" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_8 -->
<g id="edge25" class="edge">
<title>input&#45;&gt;qkv_8</title>
<path fill="none" stroke="black" d="M3884.1,-1103.27C3873.71,-1093.3 3861.85,-1081.92 3850.88,-1071.39"/>
<polygon fill="black" stroke="black" points="3853.09,-1068.66 3843.45,-1064.26 3848.24,-1073.71 3853.09,-1068.66"/>
</g>
<!-- qkv_9 -->
<g id="node21" class="node">
<title>qkv_9</title>
<polygon fill="lightyellow" stroke="black" points="3706,-1064 3526,-1064 3526,-1006 3706,-1006 3706,-1064"/>
<text text-anchor="middle" x="3616" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3616" y="-1038" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3616" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3616" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_9 -->
<g id="edge28" class="edge">
<title>input&#45;&gt;qkv_9</title>
<path fill="none" stroke="black" d="M3780.74,-1113.76C3758.43,-1108.93 3735.77,-1102.79 3715,-1095 3697.77,-1088.54 3680.15,-1079.11 3664.63,-1069.68"/>
<polygon fill="black" stroke="black" points="3666.1,-1066.47 3655.76,-1064.14 3662.4,-1072.41 3666.1,-1066.47"/>
</g>
<!-- qkv_10 -->
<g id="node23" class="node">
<title>qkv_10</title>
<polygon fill="lightyellow" stroke="black" points="3508,-1064 3328,-1064 3328,-1006 3508,-1006 3508,-1064"/>
<text text-anchor="middle" x="3418" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3418" y="-1038" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3418" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3418" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_10 -->
<g id="edge31" class="edge">
<title>input&#45;&gt;qkv_10</title>
<path fill="none" stroke="black" d="M3750.4,-1123.48C3660.93,-1117.91 3559.64,-1108.85 3517,-1095 3498.86,-1089.11 3480.5,-1079.42 3464.6,-1069.58"/>
<polygon fill="black" stroke="black" points="3466.35,-1066.55 3456.03,-1064.12 3462.58,-1072.45 3466.35,-1066.55"/>
</g>
<!-- qkv_11 -->
<g id="node25" class="node">
<title>qkv_11</title>
<polygon fill="lightyellow" stroke="black" points="3310,-1064 3130,-1064 3130,-1006 3310,-1006 3310,-1064"/>
<text text-anchor="middle" x="3220" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3220" y="-1038" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3220" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3220" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_11 -->
<g id="edge34" class="edge">
<title>input&#45;&gt;qkv_11</title>
<path fill="none" stroke="black" d="M3743.24,-1129.6C3596.16,-1126.77 3395.33,-1118.53 3319,-1095 3300.61,-1089.33 3282.06,-1079.59 3266.07,-1069.64"/>
<polygon fill="black" stroke="black" points="3267.77,-1066.58 3257.47,-1064.12 3263.99,-1072.47 3267.77,-1066.58"/>
</g>
<!-- qkv_12 -->
<g id="node27" class="node">
<title>qkv_12</title>
<polygon fill="lightyellow" stroke="black" points="3112,-1064 2932,-1064 2932,-1006 3112,-1006 3112,-1064"/>
<text text-anchor="middle" x="3022" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3022" y="-1038" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3022" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3022" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_12 -->
<g id="edge37" class="edge">
<title>input&#45;&gt;qkv_12</title>
<path fill="none" stroke="black" d="M3744.47,-1127.71C3529.6,-1122.83 3178.84,-1112.35 3121,-1095 3102.57,-1089.47 3084.01,-1079.77 3068.02,-1069.81"/>
<polygon fill="black" stroke="black" points="3069.73,-1066.74 3059.42,-1064.27 3065.94,-1072.63 3069.73,-1066.74"/>
</g>
<!-- qkv_13 -->
<g id="node29" class="node">
<title>qkv_13</title>
<polygon fill="lightyellow" stroke="black" points="2914,-1064 2734,-1064 2734,-1006 2914,-1006 2914,-1064"/>
<text text-anchor="middle" x="2824" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2824" y="-1038" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2824" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2824" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_13 -->
<g id="edge40" class="edge">
<title>input&#45;&gt;qkv_13</title>
<path fill="none" stroke="black" d="M3743.6,-1129.41C3481.35,-1126.27 2999.22,-1117.49 2923,-1095 2904.38,-1089.51 2885.65,-1079.7 2869.57,-1069.64"/>
<polygon fill="black" stroke="black" points="2871.23,-1066.54 2860.93,-1064.05 2867.43,-1072.42 2871.23,-1066.54"/>
</g>
<!-- qkv_14 -->
<g id="node31" class="node">
<title>qkv_14</title>
<polygon fill="lightyellow" stroke="black" points="2716,-1064 2536,-1064 2536,-1006 2716,-1006 2716,-1064"/>
<text text-anchor="middle" x="2626" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2626" y="-1038" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2626" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2626" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_14 -->
<g id="edge43" class="edge">
<title>input&#45;&gt;qkv_14</title>
<path fill="none" stroke="black" d="M3743.12,-1130.57C3437.96,-1129.09 2819.86,-1122.68 2725,-1095 2706.36,-1089.56 2687.63,-1079.77 2671.55,-1069.71"/>
<polygon fill="black" stroke="black" points="2673.21,-1066.61 2662.91,-1064.11 2669.41,-1072.49 2673.21,-1066.61"/>
</g>
<!-- qkv_15 -->
<g id="node33" class="node">
<title>qkv_15</title>
<polygon fill="lightyellow" stroke="black" points="2518,-1064 2338,-1064 2338,-1006 2518,-1006 2518,-1064"/>
<text text-anchor="middle" x="2428" y="-1049" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2428" y="-1038" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2428" y="-1027" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2428" y="-1016" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- input&#45;&gt;qkv_15 -->
<g id="edge46" class="edge">
<title>input&#45;&gt;qkv_15</title>
<path fill="none" stroke="black" d="M3742.91,-1131.4C3398.32,-1131.5 2640.73,-1127.91 2527,-1095 2508.35,-1089.6 2489.62,-1079.82 2473.54,-1069.75"/>
<polygon fill="black" stroke="black" points="2475.2,-1066.66 2464.9,-1064.16 2471.39,-1072.53 2475.2,-1066.66"/>
</g>
<!-- attn_0 -->
<g id="node3" class="node">
<title>attn_0</title>
<polygon fill="lightgreen" stroke="black" points="5488,-970 5308,-970 5308,-907 5488,-907 5488,-970"/>
<text text-anchor="middle" x="5398" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5398" y="-947" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="5398" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 0:16S/16]</text>
<text text-anchor="middle" x="5398" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="5398" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_0&#45;&gt;attn_0 -->
<g id="edge2" class="edge">
<title>qkv_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M5398,-1005.9C5398,-997.93 5398,-989.09 5398,-980.53"/>
<polygon fill="black" stroke="black" points="5401.5,-980.29 5398,-970.29 5394.5,-980.29 5401.5,-980.29"/>
</g>
<!-- hopb -->
<g id="node4" class="node">
<title>hopb</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4057.22,-871 3827.8,-871 3768.78,-767 3998.2,-767 4057.22,-871"/>
<text text-anchor="middle" x="3913" y="-833" font-family="Times,serif" font-size="10.00">HOP&#45;B All&#45;to&#45;All</text>
<text text-anchor="middle" x="3913" y="-822" font-family="Times,serif" font-size="10.00">Communication</text>
<text text-anchor="middle" x="3913" y="-811" font-family="Times,serif" font-size="10.00">Volume: [B, 16384]</text>
<text text-anchor="middle" x="3913" y="-800" font-family="Times,serif" font-size="10.00">Overlap with next token</text>
</g>
<!-- attn_0&#45;&gt;hopb -->
<g id="edge3" class="edge">
<title>attn_0&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M5307.85,-908.76C5304.87,-908.12 5301.92,-907.53 5299,-907 5059.7,-863.26 4336.46,-834.42 4040.92,-824.17"/>
<polygon fill="black" stroke="black" points="4040.7,-820.66 4030.59,-823.81 4040.46,-827.65 4040.7,-820.66"/>
</g>
<!-- gate_0 -->
<g id="node35" class="node">
<title>gate_0</title>
<polygon fill="lightpink" stroke="black" points="4030.31,-720 3843.7,-720 3795.69,-616 3982.3,-616 4030.31,-720"/>
<text text-anchor="middle" x="3913" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3913" y="-671" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="3913" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3913" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- hopb&#45;&gt;gate_0 -->
<g id="edge49" class="edge">
<title>hopb&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M3913,-766.72C3913,-764.96 3913,-763.19 3913,-761.39"/>
<polygon fill="black" stroke="black" points="3916.5,-761 3913,-751 3909.5,-761 3916.5,-761"/>
</g>
<!-- attn_1 -->
<g id="node6" class="node">
<title>attn_1</title>
<polygon fill="lightgreen" stroke="black" points="5290,-970 5110,-970 5110,-907 5290,-907 5290,-970"/>
<text text-anchor="middle" x="5200" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5200" y="-947" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="5200" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 16:32S/16]</text>
<text text-anchor="middle" x="5200" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="5200" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_1&#45;&gt;attn_1 -->
<g id="edge5" class="edge">
<title>qkv_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M5200,-1005.9C5200,-997.93 5200,-989.09 5200,-980.53"/>
<polygon fill="black" stroke="black" points="5203.5,-980.29 5200,-970.29 5196.5,-980.29 5203.5,-980.29"/>
</g>
<!-- attn_1&#45;&gt;hopb -->
<g id="edge6" class="edge">
<title>attn_1&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M5109.84,-908.8C5106.87,-908.15 5103.92,-907.55 5101,-907 4718.63,-835.06 4256.64,-821.87 4038.58,-819.93"/>
<polygon fill="black" stroke="black" points="4038.41,-816.43 4028.38,-819.85 4038.35,-823.43 4038.41,-816.43"/>
</g>
<!-- attn_2 -->
<g id="node8" class="node">
<title>attn_2</title>
<polygon fill="lightgreen" stroke="black" points="5092,-970 4912,-970 4912,-907 5092,-907 5092,-970"/>
<text text-anchor="middle" x="5002" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5002" y="-947" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="5002" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 32:48S/16]</text>
<text text-anchor="middle" x="5002" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="5002" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_2&#45;&gt;attn_2 -->
<g id="edge8" class="edge">
<title>qkv_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M5002,-1005.9C5002,-997.93 5002,-989.09 5002,-980.53"/>
<polygon fill="black" stroke="black" points="5005.5,-980.29 5002,-970.29 4998.5,-980.29 5005.5,-980.29"/>
</g>
<!-- attn_2&#45;&gt;hopb -->
<g id="edge9" class="edge">
<title>attn_2&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M4911.83,-908.86C4908.86,-908.19 4905.91,-907.57 4903,-907 4596.92,-847.1 4229.48,-828.42 4039.95,-822.61"/>
<polygon fill="black" stroke="black" points="4040.05,-819.11 4029.95,-822.31 4039.84,-826.1 4040.05,-819.11"/>
</g>
<!-- attn_3 -->
<g id="node10" class="node">
<title>attn_3</title>
<polygon fill="lightgreen" stroke="black" points="4894,-970 4714,-970 4714,-907 4894,-907 4894,-970"/>
<text text-anchor="middle" x="4804" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4804" y="-947" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="4804" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 48:64S/16]</text>
<text text-anchor="middle" x="4804" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="4804" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_3&#45;&gt;attn_3 -->
<g id="edge11" class="edge">
<title>qkv_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M4804,-1005.9C4804,-997.93 4804,-989.09 4804,-980.53"/>
<polygon fill="black" stroke="black" points="4807.5,-980.29 4804,-970.29 4800.5,-980.29 4807.5,-980.29"/>
</g>
<!-- attn_3&#45;&gt;hopb -->
<g id="edge12" class="edge">
<title>attn_3&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M4713.81,-908.94C4710.85,-908.25 4707.91,-907.6 4705,-907 4474.21,-859.22 4199.79,-836.5 4042.06,-826.65"/>
<polygon fill="black" stroke="black" points="4042.04,-823.14 4031.84,-826.02 4041.6,-830.13 4042.04,-823.14"/>
</g>
<!-- attn_4 -->
<g id="node12" class="node">
<title>attn_4</title>
<polygon fill="lightgreen" stroke="black" points="4696,-970 4516,-970 4516,-907 4696,-907 4696,-970"/>
<text text-anchor="middle" x="4606" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4606" y="-947" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="4606" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 64:80S/16]</text>
<text text-anchor="middle" x="4606" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="4606" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_4&#45;&gt;attn_4 -->
<g id="edge14" class="edge">
<title>qkv_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M4606,-1005.9C4606,-997.93 4606,-989.09 4606,-980.53"/>
<polygon fill="black" stroke="black" points="4609.5,-980.29 4606,-970.29 4602.5,-980.29 4609.5,-980.29"/>
</g>
<!-- attn_4&#45;&gt;hopb -->
<g id="edge15" class="edge">
<title>attn_4&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M4515.78,-909.08C4512.83,-908.35 4509.89,-907.65 4507,-907 4350.14,-871.57 4166.6,-847.25 4045.51,-833.51"/>
<polygon fill="black" stroke="black" points="4045.78,-830.02 4035.45,-832.38 4044.99,-836.97 4045.78,-830.02"/>
</g>
<!-- attn_5 -->
<g id="node14" class="node">
<title>attn_5</title>
<polygon fill="lightgreen" stroke="black" points="4498,-970 4318,-970 4318,-907 4498,-907 4498,-970"/>
<text text-anchor="middle" x="4408" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4408" y="-947" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4408" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 80:96S/16]</text>
<text text-anchor="middle" x="4408" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="4408" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_5&#45;&gt;attn_5 -->
<g id="edge17" class="edge">
<title>qkv_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M4408,-1005.9C4408,-997.93 4408,-989.09 4408,-980.53"/>
<polygon fill="black" stroke="black" points="4411.5,-980.29 4408,-970.29 4404.5,-980.29 4411.5,-980.29"/>
</g>
<!-- attn_5&#45;&gt;hopb -->
<g id="edge18" class="edge">
<title>attn_5&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M4317.98,-909.42C4314.96,-908.59 4311.96,-907.78 4309,-907 4224.64,-884.78 4129.15,-863.68 4053.08,-847.83"/>
<polygon fill="black" stroke="black" points="4053.45,-844.33 4042.95,-845.73 4052.03,-851.19 4053.45,-844.33"/>
</g>
<!-- attn_6 -->
<g id="node16" class="node">
<title>attn_6</title>
<polygon fill="lightgreen" stroke="black" points="4300,-970 4120,-970 4120,-907 4300,-907 4300,-970"/>
<text text-anchor="middle" x="4210" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4210" y="-947" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4210" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 96:112S/16]</text>
<text text-anchor="middle" x="4210" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="4210" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_6&#45;&gt;attn_6 -->
<g id="edge20" class="edge">
<title>qkv_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M4210,-1005.9C4210,-997.93 4210,-989.09 4210,-980.53"/>
<polygon fill="black" stroke="black" points="4213.5,-980.29 4210,-970.29 4206.5,-980.29 4213.5,-980.29"/>
</g>
<!-- attn_6&#45;&gt;hopb -->
<g id="edge21" class="edge">
<title>attn_6&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M4132.74,-906.93C4107.8,-897.07 4079.35,-885.81 4051.38,-874.75"/>
<polygon fill="black" stroke="black" points="4052.51,-871.43 4041.92,-871 4049.93,-877.94 4052.51,-871.43"/>
</g>
<!-- attn_7 -->
<g id="node18" class="node">
<title>attn_7</title>
<polygon fill="lightgreen" stroke="black" points="4102,-970 3922,-970 3922,-907 4102,-907 4102,-970"/>
<text text-anchor="middle" x="4012" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4012" y="-947" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="4012" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 112:128S/16]</text>
<text text-anchor="middle" x="4012" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="4012" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_7&#45;&gt;attn_7 -->
<g id="edge23" class="edge">
<title>qkv_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M4012,-1005.9C4012,-997.93 4012,-989.09 4012,-980.53"/>
<polygon fill="black" stroke="black" points="4015.5,-980.29 4012,-970.29 4008.5,-980.29 4015.5,-980.29"/>
</g>
<!-- attn_7&#45;&gt;hopb -->
<g id="edge24" class="edge">
<title>attn_7&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3986.25,-906.93C3979.01,-898.35 3970.89,-888.71 3962.77,-879.07"/>
<polygon fill="black" stroke="black" points="3965.38,-876.74 3956.26,-871.34 3960.03,-881.25 3965.38,-876.74"/>
</g>
<!-- attn_8 -->
<g id="node20" class="node">
<title>attn_8</title>
<polygon fill="lightgreen" stroke="black" points="3904,-970 3724,-970 3724,-907 3904,-907 3904,-970"/>
<text text-anchor="middle" x="3814" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3814" y="-947" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3814" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 128:144S/16]</text>
<text text-anchor="middle" x="3814" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="3814" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_8&#45;&gt;attn_8 -->
<g id="edge26" class="edge">
<title>qkv_8&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M3814,-1005.9C3814,-997.93 3814,-989.09 3814,-980.53"/>
<polygon fill="black" stroke="black" points="3817.5,-980.29 3814,-970.29 3810.5,-980.29 3817.5,-980.29"/>
</g>
<!-- attn_8&#45;&gt;hopb -->
<g id="edge27" class="edge">
<title>attn_8&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3839.75,-906.93C3846.99,-898.35 3855.11,-888.71 3863.23,-879.07"/>
<polygon fill="black" stroke="black" points="3865.97,-881.25 3869.74,-871.34 3860.62,-876.74 3865.97,-881.25"/>
</g>
<!-- attn_9 -->
<g id="node22" class="node">
<title>attn_9</title>
<polygon fill="lightgreen" stroke="black" points="3706,-970 3526,-970 3526,-907 3706,-907 3706,-970"/>
<text text-anchor="middle" x="3616" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3616" y="-947" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3616" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 144:160S/16]</text>
<text text-anchor="middle" x="3616" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="3616" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_9&#45;&gt;attn_9 -->
<g id="edge29" class="edge">
<title>qkv_9&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M3616,-1005.9C3616,-997.93 3616,-989.09 3616,-980.53"/>
<polygon fill="black" stroke="black" points="3619.5,-980.29 3616,-970.29 3612.5,-980.29 3619.5,-980.29"/>
</g>
<!-- attn_9&#45;&gt;hopb -->
<g id="edge30" class="edge">
<title>attn_9&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3693.26,-906.93C3728.91,-892.83 3771.74,-875.89 3810.08,-860.72"/>
<polygon fill="black" stroke="black" points="3811.71,-863.84 3819.72,-856.9 3809.14,-857.33 3811.71,-863.84"/>
</g>
<!-- attn_10 -->
<g id="node24" class="node">
<title>attn_10</title>
<polygon fill="lightgreen" stroke="black" points="3508,-970 3328,-970 3328,-907 3508,-907 3508,-970"/>
<text text-anchor="middle" x="3418" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3418" y="-947" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3418" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 160:176S/16]</text>
<text text-anchor="middle" x="3418" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="3418" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_10&#45;&gt;attn_10 -->
<g id="edge32" class="edge">
<title>qkv_10&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M3418,-1005.9C3418,-997.93 3418,-989.09 3418,-980.53"/>
<polygon fill="black" stroke="black" points="3421.5,-980.29 3418,-970.29 3414.5,-980.29 3421.5,-980.29"/>
</g>
<!-- attn_10&#45;&gt;hopb -->
<g id="edge33" class="edge">
<title>attn_10&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3508.02,-909.42C3511.04,-908.59 3514.04,-907.78 3517,-907 3611.65,-882.07 3720.31,-858.55 3799.84,-842.27"/>
<polygon fill="black" stroke="black" points="3800.78,-845.65 3809.88,-840.22 3799.38,-838.79 3800.78,-845.65"/>
</g>
<!-- attn_11 -->
<g id="node26" class="node">
<title>attn_11</title>
<polygon fill="lightgreen" stroke="black" points="3310,-970 3130,-970 3130,-907 3310,-907 3310,-970"/>
<text text-anchor="middle" x="3220" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3220" y="-947" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3220" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 176:192S/16]</text>
<text text-anchor="middle" x="3220" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="3220" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_11&#45;&gt;attn_11 -->
<g id="edge35" class="edge">
<title>qkv_11&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M3220,-1005.9C3220,-997.93 3220,-989.09 3220,-980.53"/>
<polygon fill="black" stroke="black" points="3223.5,-980.29 3220,-970.29 3216.5,-980.29 3223.5,-980.29"/>
</g>
<!-- attn_11&#45;&gt;hopb -->
<g id="edge36" class="edge">
<title>attn_11&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3310.22,-909.08C3313.17,-908.35 3316.11,-907.65 3319,-907 3482.16,-870.15 3674.2,-845.31 3794.78,-831.9"/>
<polygon fill="black" stroke="black" points="3795.22,-835.38 3804.78,-830.8 3794.46,-828.42 3795.22,-835.38"/>
</g>
<!-- attn_12 -->
<g id="node28" class="node">
<title>attn_12</title>
<polygon fill="lightgreen" stroke="black" points="3112,-970 2932,-970 2932,-907 3112,-907 3112,-970"/>
<text text-anchor="middle" x="3022" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3022" y="-947" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3022" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 192:208S/16]</text>
<text text-anchor="middle" x="3022" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="3022" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_12&#45;&gt;attn_12 -->
<g id="edge38" class="edge">
<title>qkv_12&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M3022,-1005.9C3022,-997.93 3022,-989.09 3022,-980.53"/>
<polygon fill="black" stroke="black" points="3025.5,-980.29 3022,-970.29 3018.5,-980.29 3025.5,-980.29"/>
</g>
<!-- attn_12&#45;&gt;hopb -->
<g id="edge39" class="edge">
<title>attn_12&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M3112.19,-908.94C3115.15,-908.25 3118.09,-907.6 3121,-907 3355.6,-858.43 3635.28,-835.76 3791.66,-826.17"/>
<polygon fill="black" stroke="black" points="3792.01,-829.66 3801.78,-825.56 3791.59,-822.67 3792.01,-829.66"/>
</g>
<!-- attn_13 -->
<g id="node30" class="node">
<title>attn_13</title>
<polygon fill="lightgreen" stroke="black" points="2914,-970 2734,-970 2734,-907 2914,-907 2914,-970"/>
<text text-anchor="middle" x="2824" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2824" y="-947" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2824" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 208:224S/16]</text>
<text text-anchor="middle" x="2824" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="2824" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_13&#45;&gt;attn_13 -->
<g id="edge41" class="edge">
<title>qkv_13&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M2824,-1005.9C2824,-997.93 2824,-989.09 2824,-980.53"/>
<polygon fill="black" stroke="black" points="2827.5,-980.29 2824,-970.29 2820.5,-980.29 2827.5,-980.29"/>
</g>
<!-- attn_13&#45;&gt;hopb -->
<g id="edge42" class="edge">
<title>attn_13&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M2914.17,-908.86C2917.14,-908.19 2920.09,-907.57 2923,-907 3231.01,-846.72 3601.15,-828.18 3789.61,-822.5"/>
<polygon fill="black" stroke="black" points="3789.93,-825.99 3799.82,-822.2 3789.73,-818.99 3789.93,-825.99"/>
</g>
<!-- attn_14 -->
<g id="node32" class="node">
<title>attn_14</title>
<polygon fill="lightgreen" stroke="black" points="2716,-970 2536,-970 2536,-907 2716,-907 2716,-970"/>
<text text-anchor="middle" x="2626" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2626" y="-947" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2626" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 224:240S/16]</text>
<text text-anchor="middle" x="2626" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="2626" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_14&#45;&gt;attn_14 -->
<g id="edge44" class="edge">
<title>qkv_14&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M2626,-1005.9C2626,-997.93 2626,-989.09 2626,-980.53"/>
<polygon fill="black" stroke="black" points="2629.5,-980.29 2626,-970.29 2622.5,-980.29 2629.5,-980.29"/>
</g>
<!-- attn_14&#45;&gt;hopb -->
<g id="edge45" class="edge">
<title>attn_14&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M2716.16,-908.8C2719.13,-908.15 2722.08,-907.55 2725,-907 3107.87,-834.96 3570.57,-821.83 3788.28,-819.93"/>
<polygon fill="black" stroke="black" points="3788.49,-823.42 3798.46,-819.84 3788.43,-816.42 3788.49,-823.42"/>
</g>
<!-- attn_15 -->
<g id="node34" class="node">
<title>attn_15</title>
<polygon fill="lightgreen" stroke="black" points="2518,-970 2338,-970 2338,-907 2518,-907 2518,-970"/>
<text text-anchor="middle" x="2428" y="-958" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2428" y="-947" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2428" y="-936" font-family="Times,serif" font-size="10.00">KV slice: [tokens 240:256S/16]</text>
<text text-anchor="middle" x="2428" y="-925" font-family="Times,serif" font-size="10.00">Input: [B, 1, 128, 128]</text>
<text text-anchor="middle" x="2428" y="-914" font-family="Times,serif" font-size="10.00">Output: [B, 1, 128, 128]</text>
</g>
<!-- qkv_15&#45;&gt;attn_15 -->
<g id="edge47" class="edge">
<title>qkv_15&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M2428,-1005.9C2428,-997.93 2428,-989.09 2428,-980.53"/>
<polygon fill="black" stroke="black" points="2431.5,-980.29 2428,-970.29 2424.5,-980.29 2431.5,-980.29"/>
</g>
<!-- attn_15&#45;&gt;hopb -->
<g id="edge48" class="edge">
<title>attn_15&#45;&gt;hopb</title>
<path fill="none" stroke="black" d="M2518.15,-908.76C2521.13,-908.12 2524.08,-907.53 2527,-907 2767.76,-863 3498.41,-834.07 3790.46,-823.98"/>
<polygon fill="black" stroke="black" points="3790.79,-827.47 3800.66,-823.63 3790.55,-820.48 3790.79,-827.47"/>
</g>
<!-- expert_0_tp_0 -->
<g id="node36" class="node">
<title>expert_0_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="3951,-580 3771,-580 3771,-506 3951,-506 3951,-580"/>
<text text-anchor="middle" x="3861" y="-568" font-family="Times,serif" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3861" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="3861" y="-546" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="3861" y="-535" font-family="Times,serif" font-size="10.00">Experts: [0:2]</text>
<text text-anchor="middle" x="3861" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="3861" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_0&#45;&gt;expert_0_tp_0 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;expert_0_tp_0</title>
<path fill="none" stroke="black" d="M3891.4,-615.91C3887.71,-607.18 3883.9,-598.16 3880.27,-589.59"/>
<polygon fill="black" stroke="black" points="3883.39,-587.98 3876.28,-580.14 3876.95,-590.71 3883.39,-587.98"/>
</g>
<!-- ffn_0_tp_0 -->
<g id="node37" class="node">
<title>ffn_0_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3924,-470 3744,-470 3744,-396 3924,-396 3924,-470"/>
<text text-anchor="middle" x="3834" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="3834" y="-447" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="3834" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3834" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3834" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="3834" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_0_tp_0&#45;&gt;ffn_0_tp_0 -->
<g id="edge51" class="edge">
<title>expert_0_tp_0&#45;&gt;ffn_0_tp_0</title>
<path fill="none" stroke="black" d="M3851.93,-505.74C3849.89,-497.54 3847.68,-488.74 3845.55,-480.2"/>
<polygon fill="black" stroke="black" points="3848.91,-479.2 3843.09,-470.35 3842.12,-480.9 3848.91,-479.2"/>
</g>
<!-- allreduce_0 -->
<g id="node38" class="node">
<title>allreduce_0</title>
<polygon fill="gold" stroke="black" points="3554.69,-360 3348.38,-360 3295.31,-234 3501.62,-234 3554.69,-360"/>
<text text-anchor="middle" x="3425" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3425" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3425" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="3425" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="3425" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_0_tp_0&#45;&gt;allreduce_0 -->
<g id="edge52" class="edge">
<title>ffn_0_tp_0&#45;&gt;allreduce_0</title>
<path fill="none" stroke="black" d="M3743.99,-402.51C3688.62,-384.37 3616.74,-360.82 3555.22,-340.67"/>
<polygon fill="black" stroke="black" points="3556.04,-337.25 3545.45,-337.46 3553.86,-343.9 3556.04,-337.25"/>
</g>
<!-- ep_allgather -->
<g id="node39" class="node">
<title>ep_allgather</title>
<polygon fill="gold" stroke="black" points="2150.91,-198 1939.48,-198 1885.09,-94 2096.52,-94 2150.91,-198"/>
<text text-anchor="middle" x="2018" y="-160" font-family="Times,serif" font-size="10.00">EP All&#45;Gather</text>
<text text-anchor="middle" x="2018" y="-149" font-family="Times,serif" font-size="10.00">8 experts</text>
<text text-anchor="middle" x="2018" y="-138" font-family="Times,serif" font-size="10.00">Input: [B/{8}, 1, 2048]</text>
<text text-anchor="middle" x="2018" y="-127" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16384]</text>
</g>
<!-- allreduce_0&#45;&gt;ep_allgather -->
<g id="edge53" class="edge">
<title>allreduce_0&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M3311.61,-273.01C3246.61,-259.86 3163.44,-244.03 3089,-234 2744.97,-187.66 2335.72,-162.92 2137.43,-152.72"/>
<polygon fill="black" stroke="black" points="2137.44,-149.22 2127.28,-152.2 2137.08,-156.21 2137.44,-149.22"/>
</g>
<!-- allreduce_0&#45;&gt;ep_allgather -->
<g id="edge57" class="edge">
<title>allreduce_0&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M3310.17,-269.47C3249.96,-257.1 3174.86,-243.14 3107,-234 2756.33,-186.77 2337.89,-161.98 2137.04,-152.15"/>
<polygon fill="black" stroke="black" points="2136.92,-148.64 2126.76,-151.65 2136.58,-155.63 2136.92,-148.64"/>
</g>
<!-- output -->
<g id="node92" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="2018" cy="-29" rx="90" ry="29"/>
<text text-anchor="middle" x="2018" y="-37.5" font-family="Times,serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="2018" y="-26.5" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2018" y="-15.5" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16384]</text>
</g>
<!-- ep_allgather&#45;&gt;output -->
<g id="edge114" class="edge">
<title>ep_allgather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2018,-93.89C2018,-85.29 2018,-76.49 2018,-68.28"/>
<polygon fill="black" stroke="black" points="2021.5,-68.26 2018,-58.26 2014.5,-68.26 2021.5,-68.26"/>
</g>
<!-- gate_1 -->
<g id="node40" class="node">
<title>gate_1</title>
<polygon fill="lightpink" stroke="black" points="3778.31,-720 3591.7,-720 3543.69,-616 3730.3,-616 3778.31,-720"/>
<text text-anchor="middle" x="3661" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3661" y="-671" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="3661" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3661" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_0_tp_1 -->
<g id="node41" class="node">
<title>expert_0_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="3699,-580 3519,-580 3519,-506 3699,-506 3699,-580"/>
<text text-anchor="middle" x="3609" y="-568" font-family="Times,serif" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3609" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="3609" y="-546" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="3609" y="-535" font-family="Times,serif" font-size="10.00">Experts: [0:2]</text>
<text text-anchor="middle" x="3609" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="3609" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_1&#45;&gt;expert_0_tp_1 -->
<g id="edge54" class="edge">
<title>gate_1&#45;&gt;expert_0_tp_1</title>
<path fill="none" stroke="black" d="M3639.4,-615.91C3635.71,-607.18 3631.9,-598.16 3628.27,-589.59"/>
<polygon fill="black" stroke="black" points="3631.39,-587.98 3624.28,-580.14 3624.95,-590.71 3631.39,-587.98"/>
</g>
<!-- ffn_0_tp_1 -->
<g id="node42" class="node">
<title>ffn_0_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="3673,-470 3493,-470 3493,-396 3673,-396 3673,-470"/>
<text text-anchor="middle" x="3583" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="3583" y="-447" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="3583" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3583" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3583" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="3583" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_0_tp_1&#45;&gt;ffn_0_tp_1 -->
<g id="edge55" class="edge">
<title>expert_0_tp_1&#45;&gt;ffn_0_tp_1</title>
<path fill="none" stroke="black" d="M3600.27,-505.74C3598.3,-497.54 3596.18,-488.74 3594.12,-480.2"/>
<polygon fill="black" stroke="black" points="3597.49,-479.25 3591.75,-470.35 3590.69,-480.89 3597.49,-479.25"/>
</g>
<!-- ffn_0_tp_1&#45;&gt;allreduce_0 -->
<g id="edge56" class="edge">
<title>ffn_0_tp_1&#45;&gt;allreduce_0</title>
<path fill="none" stroke="black" d="M3540.24,-395.74C3529.6,-386.71 3517.83,-376.73 3506,-366.7"/>
<polygon fill="black" stroke="black" points="3508.13,-363.91 3498.23,-360.11 3503.6,-369.25 3508.13,-363.91"/>
</g>
<!-- gate_2 -->
<g id="node43" class="node">
<title>gate_2</title>
<polygon fill="lightpink" stroke="black" points="3526.31,-720 3339.7,-720 3291.69,-616 3478.3,-616 3526.31,-720"/>
<text text-anchor="middle" x="3409" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3409" y="-671" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3409" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3409" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_1_tp_0 -->
<g id="node44" class="node">
<title>expert_1_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="3448,-580 3268,-580 3268,-506 3448,-506 3448,-580"/>
<text text-anchor="middle" x="3358" y="-568" font-family="Times,serif" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3358" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="3358" y="-546" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3358" y="-535" font-family="Times,serif" font-size="10.00">Experts: [2:4]</text>
<text text-anchor="middle" x="3358" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="3358" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_2&#45;&gt;expert_1_tp_0 -->
<g id="edge58" class="edge">
<title>gate_2&#45;&gt;expert_1_tp_0</title>
<path fill="none" stroke="black" d="M3387.81,-615.91C3384.2,-607.18 3380.46,-598.16 3376.9,-589.59"/>
<polygon fill="black" stroke="black" points="3380.05,-588.03 3372.98,-580.14 3373.58,-590.71 3380.05,-588.03"/>
</g>
<!-- ffn_1_tp_0 -->
<g id="node45" class="node">
<title>ffn_1_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3422,-470 3242,-470 3242,-396 3422,-396 3422,-470"/>
<text text-anchor="middle" x="3332" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="3332" y="-447" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3332" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3332" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3332" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="3332" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_1_tp_0&#45;&gt;ffn_1_tp_0 -->
<g id="edge59" class="edge">
<title>expert_1_tp_0&#45;&gt;ffn_1_tp_0</title>
<path fill="none" stroke="black" d="M3349.27,-505.74C3347.3,-497.54 3345.18,-488.74 3343.12,-480.2"/>
<polygon fill="black" stroke="black" points="3346.49,-479.25 3340.75,-470.35 3339.69,-480.89 3346.49,-479.25"/>
</g>
<!-- allreduce_1 -->
<g id="node46" class="node">
<title>allreduce_1</title>
<polygon fill="gold" stroke="black" points="3088.69,-360 2882.38,-360 2829.31,-234 3035.62,-234 3088.69,-360"/>
<text text-anchor="middle" x="2959" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2959" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2959" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="2959" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2959" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_1_tp_0&#45;&gt;allreduce_1 -->
<g id="edge60" class="edge">
<title>ffn_1_tp_0&#45;&gt;allreduce_1</title>
<path fill="none" stroke="black" d="M3241.71,-399.56C3196.44,-383.3 3140.75,-363.29 3090.81,-345.35"/>
<polygon fill="black" stroke="black" points="3091.82,-342 3081.23,-341.91 3089.45,-348.58 3091.82,-342"/>
</g>
<!-- allreduce_1&#45;&gt;ep_allgather -->
<g id="edge61" class="edge">
<title>allreduce_1&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2844.86,-271.54C2788.41,-259.26 2719.25,-244.75 2657,-234 2478.53,-203.18 2270.81,-176.98 2141.81,-161.62"/>
<polygon fill="black" stroke="black" points="2141.84,-158.1 2131.5,-160.39 2141.02,-165.05 2141.84,-158.1"/>
</g>
<!-- allreduce_1&#45;&gt;ep_allgather -->
<g id="edge65" class="edge">
<title>allreduce_1&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2843.32,-267.61C2791.97,-256.26 2730.72,-243.62 2675,-234 2489.81,-202.02 2273.13,-175.02 2140.71,-159.93"/>
<polygon fill="black" stroke="black" points="2140.86,-156.42 2130.53,-158.77 2140.07,-163.38 2140.86,-156.42"/>
</g>
<!-- gate_3 -->
<g id="node47" class="node">
<title>gate_3</title>
<polygon fill="lightpink" stroke="black" points="3274.31,-720 3087.7,-720 3039.69,-616 3226.3,-616 3274.31,-720"/>
<text text-anchor="middle" x="3157" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3157" y="-671" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3157" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3157" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_1_tp_1 -->
<g id="node48" class="node">
<title>expert_1_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="3198,-580 3018,-580 3018,-506 3198,-506 3198,-580"/>
<text text-anchor="middle" x="3108" y="-568" font-family="Times,serif" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3108" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="3108" y="-546" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3108" y="-535" font-family="Times,serif" font-size="10.00">Experts: [2:4]</text>
<text text-anchor="middle" x="3108" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="3108" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_3&#45;&gt;expert_1_tp_1 -->
<g id="edge62" class="edge">
<title>gate_3&#45;&gt;expert_1_tp_1</title>
<path fill="none" stroke="black" d="M3136.65,-615.91C3133.17,-607.18 3129.58,-598.16 3126.16,-589.59"/>
<polygon fill="black" stroke="black" points="3129.35,-588.13 3122.4,-580.14 3122.85,-590.72 3129.35,-588.13"/>
</g>
<!-- ffn_1_tp_1 -->
<g id="node49" class="node">
<title>ffn_1_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="3173,-470 2993,-470 2993,-396 3173,-396 3173,-470"/>
<text text-anchor="middle" x="3083" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="3083" y="-447" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3083" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3083" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="3083" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="3083" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_1_tp_1&#45;&gt;ffn_1_tp_1 -->
<g id="edge63" class="edge">
<title>expert_1_tp_1&#45;&gt;ffn_1_tp_1</title>
<path fill="none" stroke="black" d="M3099.61,-505.74C3097.71,-497.54 3095.67,-488.74 3093.69,-480.2"/>
<polygon fill="black" stroke="black" points="3097.08,-479.3 3091.41,-470.35 3090.26,-480.88 3097.08,-479.3"/>
</g>
<!-- ffn_1_tp_1&#45;&gt;allreduce_1 -->
<g id="edge64" class="edge">
<title>ffn_1_tp_1&#45;&gt;allreduce_1</title>
<path fill="none" stroke="black" d="M3049.44,-395.74C3041.33,-386.97 3032.38,-377.3 3023.37,-367.56"/>
<polygon fill="black" stroke="black" points="3025.84,-365.07 3016.48,-360.11 3020.7,-369.83 3025.84,-365.07"/>
</g>
<!-- gate_4 -->
<g id="node50" class="node">
<title>gate_4</title>
<polygon fill="lightpink" stroke="black" points="3022.31,-720 2835.7,-720 2787.69,-616 2974.3,-616 3022.31,-720"/>
<text text-anchor="middle" x="2905" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2905" y="-671" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2905" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2905" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_2_tp_0 -->
<g id="node51" class="node">
<title>expert_2_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="2949,-580 2769,-580 2769,-506 2949,-506 2949,-580"/>
<text text-anchor="middle" x="2859" y="-568" font-family="Times,serif" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2859" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="2859" y="-546" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2859" y="-535" font-family="Times,serif" font-size="10.00">Experts: [4:6]</text>
<text text-anchor="middle" x="2859" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2859" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_4&#45;&gt;expert_2_tp_0 -->
<g id="edge66" class="edge">
<title>gate_4&#45;&gt;expert_2_tp_0</title>
<path fill="none" stroke="black" d="M2885.89,-615.91C2882.63,-607.18 2879.26,-598.16 2876.05,-589.59"/>
<polygon fill="black" stroke="black" points="2879.3,-588.28 2872.51,-580.14 2872.74,-590.73 2879.3,-588.28"/>
</g>
<!-- ffn_2_tp_0 -->
<g id="node52" class="node">
<title>ffn_2_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="2926,-470 2746,-470 2746,-396 2926,-396 2926,-470"/>
<text text-anchor="middle" x="2836" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="2836" y="-447" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2836" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2836" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2836" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="2836" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_2_tp_0&#45;&gt;ffn_2_tp_0 -->
<g id="edge67" class="edge">
<title>expert_2_tp_0&#45;&gt;ffn_2_tp_0</title>
<path fill="none" stroke="black" d="M2851.28,-505.74C2849.53,-497.54 2847.66,-488.74 2845.84,-480.2"/>
<polygon fill="black" stroke="black" points="2849.25,-479.4 2843.74,-470.35 2842.4,-480.86 2849.25,-479.4"/>
</g>
<!-- allreduce_2 -->
<g id="node53" class="node">
<title>allreduce_2</title>
<polygon fill="gold" stroke="black" points="2656.69,-360 2450.38,-360 2397.31,-234 2603.62,-234 2656.69,-360"/>
<text text-anchor="middle" x="2527" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2527" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2527" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="2527" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2527" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_2_tp_0&#45;&gt;allreduce_2 -->
<g id="edge68" class="edge">
<title>ffn_2_tp_0&#45;&gt;allreduce_2</title>
<path fill="none" stroke="black" d="M2752.79,-395.91C2725.25,-383.97 2693.84,-370.35 2663.38,-357.14"/>
<polygon fill="black" stroke="black" points="2664.53,-353.83 2653.97,-353.06 2661.75,-360.25 2664.53,-353.83"/>
</g>
<!-- allreduce_2&#45;&gt;ep_allgather -->
<g id="edge69" class="edge">
<title>allreduce_2&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2409.6,-263.3C2333.42,-241.36 2233.91,-212.28 2154.25,-188.68"/>
<polygon fill="black" stroke="black" points="2155.22,-185.31 2144.63,-185.83 2153.23,-192.03 2155.22,-185.31"/>
</g>
<!-- allreduce_2&#45;&gt;ep_allgather -->
<g id="edge73" class="edge">
<title>allreduce_2&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2407.74,-259.36C2331.36,-236.68 2232.11,-207.62 2152.86,-184.73"/>
<polygon fill="black" stroke="black" points="2153.38,-181.24 2142.81,-181.83 2151.44,-187.97 2153.38,-181.24"/>
</g>
<!-- gate_5 -->
<g id="node54" class="node">
<title>gate_5</title>
<polygon fill="lightpink" stroke="black" points="2770.31,-720 2583.7,-720 2535.69,-616 2722.3,-616 2770.31,-720"/>
<text text-anchor="middle" x="2653" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2653" y="-671" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2653" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2653" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_2_tp_1 -->
<g id="node55" class="node">
<title>expert_2_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="2704,-580 2524,-580 2524,-506 2704,-506 2704,-580"/>
<text text-anchor="middle" x="2614" y="-568" font-family="Times,serif" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2614" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="2614" y="-546" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2614" y="-535" font-family="Times,serif" font-size="10.00">Experts: [4:6]</text>
<text text-anchor="middle" x="2614" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2614" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_5&#45;&gt;expert_2_tp_1 -->
<g id="edge70" class="edge">
<title>gate_5&#45;&gt;expert_2_tp_1</title>
<path fill="none" stroke="black" d="M2636.8,-615.91C2634.06,-607.27 2631.23,-598.36 2628.54,-589.87"/>
<polygon fill="black" stroke="black" points="2631.82,-588.61 2625.46,-580.14 2625.14,-590.73 2631.82,-588.61"/>
</g>
<!-- ffn_2_tp_1 -->
<g id="node56" class="node">
<title>ffn_2_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2684,-470 2504,-470 2504,-396 2684,-396 2684,-470"/>
<text text-anchor="middle" x="2594" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="2594" y="-447" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2594" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2594" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2594" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="2594" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_2_tp_1&#45;&gt;ffn_2_tp_1 -->
<g id="edge71" class="edge">
<title>expert_2_tp_1&#45;&gt;ffn_2_tp_1</title>
<path fill="none" stroke="black" d="M2607.28,-505.74C2605.77,-497.54 2604.14,-488.74 2602.56,-480.2"/>
<polygon fill="black" stroke="black" points="2605.99,-479.55 2600.73,-470.35 2599.11,-480.82 2605.99,-479.55"/>
</g>
<!-- ffn_2_tp_1&#45;&gt;allreduce_2 -->
<g id="edge72" class="edge">
<title>ffn_2_tp_1&#45;&gt;allreduce_2</title>
<path fill="none" stroke="black" d="M2575.87,-395.74C2571.74,-387.48 2567.22,-378.43 2562.64,-369.28"/>
<polygon fill="black" stroke="black" points="2565.66,-367.49 2558.06,-360.11 2559.4,-370.62 2565.66,-367.49"/>
</g>
<!-- gate_6 -->
<g id="node57" class="node">
<title>gate_6</title>
<polygon fill="lightpink" stroke="black" points="2518.31,-720 2331.7,-720 2283.69,-616 2470.3,-616 2518.31,-720"/>
<text text-anchor="middle" x="2401" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2401" y="-671" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2401" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2401" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_3_tp_0 -->
<g id="node58" class="node">
<title>expert_3_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="2466,-580 2286,-580 2286,-506 2466,-506 2466,-580"/>
<text text-anchor="middle" x="2376" y="-568" font-family="Times,serif" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2376" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="2376" y="-546" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2376" y="-535" font-family="Times,serif" font-size="10.00">Experts: [6:8]</text>
<text text-anchor="middle" x="2376" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2376" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_6&#45;&gt;expert_3_tp_0 -->
<g id="edge74" class="edge">
<title>gate_6&#45;&gt;expert_3_tp_0</title>
<path fill="none" stroke="black" d="M2390.61,-615.91C2388.88,-607.37 2387.09,-598.55 2385.38,-590.14"/>
<polygon fill="black" stroke="black" points="2388.77,-589.24 2383.34,-580.14 2381.91,-590.63 2388.77,-589.24"/>
</g>
<!-- ffn_3_tp_0 -->
<g id="node59" class="node">
<title>ffn_3_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="2453,-470 2273,-470 2273,-396 2453,-396 2453,-470"/>
<text text-anchor="middle" x="2363" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="2363" y="-447" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2363" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2363" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2363" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="2363" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_3_tp_0&#45;&gt;ffn_3_tp_0 -->
<g id="edge75" class="edge">
<title>expert_3_tp_0&#45;&gt;ffn_3_tp_0</title>
<path fill="none" stroke="black" d="M2371.64,-505.74C2370.66,-497.63 2369.61,-488.93 2368.59,-480.48"/>
<polygon fill="black" stroke="black" points="2372.05,-479.86 2367.38,-470.35 2365.1,-480.7 2372.05,-479.86"/>
</g>
<!-- allreduce_3 -->
<g id="node60" class="node">
<title>allreduce_3</title>
<polygon fill="gold" stroke="black" points="2286.69,-360 2080.38,-360 2027.31,-234 2233.62,-234 2286.69,-360"/>
<text text-anchor="middle" x="2157" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2157" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2157" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="2157" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2157" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_3_tp_0&#45;&gt;allreduce_3 -->
<g id="edge76" class="edge">
<title>ffn_3_tp_0&#45;&gt;allreduce_3</title>
<path fill="none" stroke="black" d="M2307.52,-395.91C2293.25,-386.63 2277.41,-376.32 2261.52,-365.99"/>
<polygon fill="black" stroke="black" points="2262.99,-362.77 2252.7,-360.25 2259.17,-368.64 2262.99,-362.77"/>
</g>
<!-- allreduce_3&#45;&gt;ep_allgather -->
<g id="edge77" class="edge">
<title>allreduce_3&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2092.19,-233.67C2083.46,-224.45 2074.64,-214.98 2066.27,-205.83"/>
<polygon fill="black" stroke="black" points="2068.67,-203.27 2059.35,-198.24 2063.5,-207.99 2068.67,-203.27"/>
</g>
<!-- allreduce_3&#45;&gt;ep_allgather -->
<g id="edge81" class="edge">
<title>allreduce_3&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M2105.53,-233.67C2096.96,-224.36 2088.01,-214.79 2079.24,-205.56"/>
<polygon fill="black" stroke="black" points="2081.69,-203.05 2072.25,-198.24 2076.62,-207.89 2081.69,-203.05"/>
</g>
<!-- gate_7 -->
<g id="node61" class="node">
<title>gate_7</title>
<polygon fill="lightpink" stroke="black" points="2266.31,-720 2079.7,-720 2031.69,-616 2218.3,-616 2266.31,-720"/>
<text text-anchor="middle" x="2149" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2149" y="-671" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2149" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2149" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_3_tp_1 -->
<g id="node62" class="node">
<title>expert_3_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="2241,-580 2061,-580 2061,-506 2241,-506 2241,-580"/>
<text text-anchor="middle" x="2151" y="-568" font-family="Times,serif" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2151" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="2151" y="-546" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2151" y="-535" font-family="Times,serif" font-size="10.00">Experts: [6:8]</text>
<text text-anchor="middle" x="2151" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="2151" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_7&#45;&gt;expert_3_tp_1 -->
<g id="edge78" class="edge">
<title>gate_7&#45;&gt;expert_3_tp_1</title>
<path fill="none" stroke="black" d="M2149.83,-615.91C2149.97,-607.37 2150.11,-598.55 2150.25,-590.14"/>
<polygon fill="black" stroke="black" points="2153.75,-590.19 2150.41,-580.14 2146.75,-590.08 2153.75,-590.19"/>
</g>
<!-- ffn_3_tp_1 -->
<g id="node63" class="node">
<title>ffn_3_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2241,-470 2061,-470 2061,-396 2241,-396 2241,-470"/>
<text text-anchor="middle" x="2151" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="2151" y="-447" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2151" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2151" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="2151" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="2151" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_3_tp_1&#45;&gt;ffn_3_tp_1 -->
<g id="edge79" class="edge">
<title>expert_3_tp_1&#45;&gt;ffn_3_tp_1</title>
<path fill="none" stroke="black" d="M2151,-505.74C2151,-497.63 2151,-488.93 2151,-480.48"/>
<polygon fill="black" stroke="black" points="2154.5,-480.35 2151,-470.35 2147.5,-480.35 2154.5,-480.35"/>
</g>
<!-- ffn_3_tp_1&#45;&gt;allreduce_3 -->
<g id="edge80" class="edge">
<title>ffn_3_tp_1&#45;&gt;allreduce_3</title>
<path fill="none" stroke="black" d="M2152.62,-395.74C2152.98,-387.74 2153.37,-379 2153.77,-370.14"/>
<polygon fill="black" stroke="black" points="2157.27,-370.26 2154.22,-360.11 2150.28,-369.94 2157.27,-370.26"/>
</g>
<!-- gate_8 -->
<g id="node64" class="node">
<title>gate_8</title>
<polygon fill="lightpink" stroke="black" points="2014.31,-720 1827.7,-720 1779.69,-616 1966.3,-616 2014.31,-720"/>
<text text-anchor="middle" x="1897" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1897" y="-671" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1897" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1897" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_4_tp_0 -->
<g id="node65" class="node">
<title>expert_4_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="1975,-580 1795,-580 1795,-506 1975,-506 1975,-580"/>
<text text-anchor="middle" x="1885" y="-568" font-family="Times,serif" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1885" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="1885" y="-546" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1885" y="-535" font-family="Times,serif" font-size="10.00">Experts: [8:10]</text>
<text text-anchor="middle" x="1885" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1885" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_8&#45;&gt;expert_4_tp_0 -->
<g id="edge82" class="edge">
<title>gate_8&#45;&gt;expert_4_tp_0</title>
<path fill="none" stroke="black" d="M1892.02,-615.91C1891.18,-607.37 1890.32,-598.55 1889.5,-590.14"/>
<polygon fill="black" stroke="black" points="1892.98,-589.75 1888.53,-580.14 1886.01,-590.43 1892.98,-589.75"/>
</g>
<!-- ffn_4_tp_0 -->
<g id="node66" class="node">
<title>ffn_4_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1972,-470 1792,-470 1792,-396 1972,-396 1972,-470"/>
<text text-anchor="middle" x="1882" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="1882" y="-447" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1882" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1882" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1882" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="1882" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_4_tp_0&#45;&gt;ffn_4_tp_0 -->
<g id="edge83" class="edge">
<title>expert_4_tp_0&#45;&gt;ffn_4_tp_0</title>
<path fill="none" stroke="black" d="M1883.99,-505.74C1883.77,-497.63 1883.53,-488.93 1883.29,-480.48"/>
<polygon fill="black" stroke="black" points="1886.79,-480.25 1883.01,-470.35 1879.79,-480.44 1886.79,-480.25"/>
</g>
<!-- allreduce_4 -->
<g id="node67" class="node">
<title>allreduce_4</title>
<polygon fill="gold" stroke="black" points="2009.69,-360 1803.38,-360 1750.31,-234 1956.62,-234 2009.69,-360"/>
<text text-anchor="middle" x="1880" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1880" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1880" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="1880" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1880" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_4_tp_0&#45;&gt;allreduce_4 -->
<g id="edge84" class="edge">
<title>ffn_4_tp_0&#45;&gt;allreduce_4</title>
<path fill="none" stroke="black" d="M1881.46,-395.74C1881.34,-387.74 1881.21,-379 1881.08,-370.14"/>
<polygon fill="black" stroke="black" points="1884.58,-370.06 1880.93,-360.11 1877.58,-370.16 1884.58,-370.06"/>
</g>
<!-- allreduce_4&#45;&gt;ep_allgather -->
<g id="edge85" class="edge">
<title>allreduce_4&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1931.06,-233.67C1939.56,-224.36 1948.44,-214.79 1957.16,-205.56"/>
<polygon fill="black" stroke="black" points="1959.75,-207.9 1964.1,-198.24 1954.68,-203.09 1959.75,-207.9"/>
</g>
<!-- allreduce_4&#45;&gt;ep_allgather -->
<g id="edge89" class="edge">
<title>allreduce_4&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1944.39,-233.67C1953.06,-224.45 1961.82,-214.98 1970.13,-205.83"/>
<polygon fill="black" stroke="black" points="1972.88,-208 1976.99,-198.24 1967.69,-203.31 1972.88,-208"/>
</g>
<!-- gate_9 -->
<g id="node68" class="node">
<title>gate_9</title>
<polygon fill="lightpink" stroke="black" points="1762.31,-720 1575.7,-720 1527.69,-616 1714.3,-616 1762.31,-720"/>
<text text-anchor="middle" x="1645" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1645" y="-671" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1645" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1645" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_4_tp_1 -->
<g id="node69" class="node">
<title>expert_4_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="1741,-580 1561,-580 1561,-506 1741,-506 1741,-580"/>
<text text-anchor="middle" x="1651" y="-568" font-family="Times,serif" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1651" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="1651" y="-546" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1651" y="-535" font-family="Times,serif" font-size="10.00">Experts: [8:10]</text>
<text text-anchor="middle" x="1651" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1651" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_9&#45;&gt;expert_4_tp_1 -->
<g id="edge86" class="edge">
<title>gate_9&#45;&gt;expert_4_tp_1</title>
<path fill="none" stroke="black" d="M1647.49,-615.91C1647.91,-607.37 1648.34,-598.55 1648.75,-590.14"/>
<polygon fill="black" stroke="black" points="1652.25,-590.3 1649.24,-580.14 1645.25,-589.95 1652.25,-590.3"/>
</g>
<!-- ffn_4_tp_1 -->
<g id="node70" class="node">
<title>ffn_4_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="1747,-470 1567,-470 1567,-396 1747,-396 1747,-470"/>
<text text-anchor="middle" x="1657" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="1657" y="-447" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1657" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1657" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1657" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="1657" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_4_tp_1&#45;&gt;ffn_4_tp_1 -->
<g id="edge87" class="edge">
<title>expert_4_tp_1&#45;&gt;ffn_4_tp_1</title>
<path fill="none" stroke="black" d="M1653.01,-505.74C1653.46,-497.63 1653.95,-488.93 1654.42,-480.48"/>
<polygon fill="black" stroke="black" points="1657.92,-480.53 1654.98,-470.35 1650.93,-480.14 1657.92,-480.53"/>
</g>
<!-- ffn_4_tp_1&#45;&gt;allreduce_4 -->
<g id="edge88" class="edge">
<title>ffn_4_tp_1&#45;&gt;allreduce_4</title>
<path fill="none" stroke="black" d="M1717.05,-395.91C1739.11,-382.66 1764.61,-367.34 1788.8,-352.8"/>
<polygon fill="black" stroke="black" points="1790.87,-355.64 1797.64,-347.49 1787.26,-349.64 1790.87,-355.64"/>
</g>
<!-- gate_10 -->
<g id="node71" class="node">
<title>gate_10</title>
<polygon fill="lightpink" stroke="black" points="1510.31,-720 1323.7,-720 1275.69,-616 1462.3,-616 1510.31,-720"/>
<text text-anchor="middle" x="1393" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1393" y="-671" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1393" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1393" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_5_tp_0 -->
<g id="node72" class="node">
<title>expert_5_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="1509,-580 1329,-580 1329,-506 1509,-506 1509,-580"/>
<text text-anchor="middle" x="1419" y="-568" font-family="Times,serif" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1419" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="1419" y="-546" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1419" y="-535" font-family="Times,serif" font-size="10.00">Experts: [10:12]</text>
<text text-anchor="middle" x="1419" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1419" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_10&#45;&gt;expert_5_tp_0 -->
<g id="edge90" class="edge">
<title>gate_10&#45;&gt;expert_5_tp_0</title>
<path fill="none" stroke="black" d="M1403.8,-615.91C1405.61,-607.37 1407.47,-598.55 1409.25,-590.14"/>
<polygon fill="black" stroke="black" points="1412.72,-590.64 1411.36,-580.14 1405.87,-589.2 1412.72,-590.64"/>
</g>
<!-- ffn_5_tp_0 -->
<g id="node73" class="node">
<title>ffn_5_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1535,-470 1355,-470 1355,-396 1535,-396 1535,-470"/>
<text text-anchor="middle" x="1445" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="1445" y="-447" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1445" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1445" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1445" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="1445" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_5_tp_0&#45;&gt;ffn_5_tp_0 -->
<g id="edge91" class="edge">
<title>expert_5_tp_0&#45;&gt;ffn_5_tp_0</title>
<path fill="none" stroke="black" d="M1427.73,-505.74C1429.7,-497.54 1431.82,-488.74 1433.88,-480.2"/>
<polygon fill="black" stroke="black" points="1437.31,-480.89 1436.25,-470.35 1430.51,-479.25 1437.31,-480.89"/>
</g>
<!-- allreduce_5 -->
<g id="node74" class="node">
<title>allreduce_5</title>
<polygon fill="gold" stroke="black" points="1650.69,-360 1444.38,-360 1391.31,-234 1597.62,-234 1650.69,-360"/>
<text text-anchor="middle" x="1521" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1521" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1521" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="1521" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1521" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_5_tp_0&#45;&gt;allreduce_5 -->
<g id="edge92" class="edge">
<title>ffn_5_tp_0&#45;&gt;allreduce_5</title>
<path fill="none" stroke="black" d="M1465.57,-395.74C1470.3,-387.4 1475.49,-378.24 1480.74,-368.99"/>
<polygon fill="black" stroke="black" points="1483.88,-370.54 1485.77,-360.11 1477.8,-367.08 1483.88,-370.54"/>
</g>
<!-- allreduce_5&#45;&gt;ep_allgather -->
<g id="edge93" class="edge">
<title>allreduce_5&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1611.66,-267.18C1697.75,-240.86 1826.89,-202.14 1916.41,-175.82"/>
<polygon fill="black" stroke="black" points="1917.43,-179.17 1926.03,-172.99 1915.45,-172.45 1917.43,-179.17"/>
</g>
<!-- allreduce_5&#45;&gt;ep_allgather -->
<g id="edge97" class="edge">
<title>allreduce_5&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1612.84,-270.05C1699.48,-244.63 1828.95,-205.85 1918.12,-178.63"/>
<polygon fill="black" stroke="black" points="1919.16,-181.98 1927.7,-175.71 1917.12,-175.28 1919.16,-181.98"/>
</g>
<!-- gate_11 -->
<g id="node75" class="node">
<title>gate_11</title>
<polygon fill="lightpink" stroke="black" points="1258.31,-720 1071.7,-720 1023.69,-616 1210.3,-616 1258.31,-720"/>
<text text-anchor="middle" x="1141" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1141" y="-671" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1141" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1141" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_5_tp_1 -->
<g id="node76" class="node">
<title>expert_5_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="1250,-580 1070,-580 1070,-506 1250,-506 1250,-580"/>
<text text-anchor="middle" x="1160" y="-568" font-family="Times,serif" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1160" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="1160" y="-546" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1160" y="-535" font-family="Times,serif" font-size="10.00">Experts: [10:12]</text>
<text text-anchor="middle" x="1160" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1160" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_11&#45;&gt;expert_5_tp_1 -->
<g id="edge94" class="edge">
<title>gate_11&#45;&gt;expert_5_tp_1</title>
<path fill="none" stroke="black" d="M1148.89,-615.91C1150.21,-607.37 1151.57,-598.55 1152.87,-590.14"/>
<polygon fill="black" stroke="black" points="1156.35,-590.55 1154.42,-580.14 1149.43,-589.48 1156.35,-590.55"/>
</g>
<!-- ffn_5_tp_1 -->
<g id="node77" class="node">
<title>ffn_5_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="1270,-470 1090,-470 1090,-396 1270,-396 1270,-470"/>
<text text-anchor="middle" x="1180" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="1180" y="-447" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1180" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1180" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="1180" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="1180" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_5_tp_1&#45;&gt;ffn_5_tp_1 -->
<g id="edge95" class="edge">
<title>expert_5_tp_1&#45;&gt;ffn_5_tp_1</title>
<path fill="none" stroke="black" d="M1166.72,-505.74C1168.23,-497.54 1169.86,-488.74 1171.44,-480.2"/>
<polygon fill="black" stroke="black" points="1174.89,-480.82 1173.27,-470.35 1168.01,-479.55 1174.89,-480.82"/>
</g>
<!-- ffn_5_tp_1&#45;&gt;allreduce_5 -->
<g id="edge96" class="edge">
<title>ffn_5_tp_1&#45;&gt;allreduce_5</title>
<path fill="none" stroke="black" d="M1270.04,-396.62C1317.21,-378.08 1375.05,-355.35 1423.3,-336.39"/>
<polygon fill="black" stroke="black" points="1424.79,-339.57 1432.82,-332.65 1422.23,-333.05 1424.79,-339.57"/>
</g>
<!-- gate_12 -->
<g id="node78" class="node">
<title>gate_12</title>
<polygon fill="lightpink" stroke="black" points="1006.31,-720 819.7,-720 771.69,-616 958.3,-616 1006.31,-720"/>
<text text-anchor="middle" x="889" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="889" y="-671" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="889" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="889" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_6_tp_0 -->
<g id="node79" class="node">
<title>expert_6_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="1015,-580 835,-580 835,-506 1015,-506 1015,-580"/>
<text text-anchor="middle" x="925" y="-568" font-family="Times,serif" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="925" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="925" y="-546" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="925" y="-535" font-family="Times,serif" font-size="10.00">Experts: [12:14]</text>
<text text-anchor="middle" x="925" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="925" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_12&#45;&gt;expert_6_tp_0 -->
<g id="edge98" class="edge">
<title>gate_12&#45;&gt;expert_6_tp_0</title>
<path fill="none" stroke="black" d="M903.95,-615.91C906.48,-607.27 909.09,-598.36 911.58,-589.87"/>
<polygon fill="black" stroke="black" points="914.97,-590.72 914.42,-580.14 908.26,-588.75 914.97,-590.72"/>
</g>
<!-- ffn_6_tp_0 -->
<g id="node80" class="node">
<title>ffn_6_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1065,-470 885,-470 885,-396 1065,-396 1065,-470"/>
<text text-anchor="middle" x="975" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="975" y="-447" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="975" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="975" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="975" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="975" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_6_tp_0&#45;&gt;ffn_6_tp_0 -->
<g id="edge99" class="edge">
<title>expert_6_tp_0&#45;&gt;ffn_6_tp_0</title>
<path fill="none" stroke="black" d="M941.79,-505.74C945.66,-497.37 949.83,-488.36 953.87,-479.64"/>
<polygon fill="black" stroke="black" points="957.15,-480.9 958.17,-470.35 950.79,-477.96 957.15,-480.9"/>
</g>
<!-- allreduce_6 -->
<g id="node81" class="node">
<title>allreduce_6</title>
<polygon fill="gold" stroke="black" points="1238.69,-360 1032.38,-360 979.31,-234 1185.62,-234 1238.69,-360"/>
<text text-anchor="middle" x="1109" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1109" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1109" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="1109" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="1109" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_6_tp_0&#45;&gt;allreduce_6 -->
<g id="edge100" class="edge">
<title>ffn_6_tp_0&#45;&gt;allreduce_6</title>
<path fill="none" stroke="black" d="M1011.26,-395.74C1020.12,-386.88 1029.89,-377.11 1039.73,-367.27"/>
<polygon fill="black" stroke="black" points="1042.29,-369.66 1046.89,-360.11 1037.34,-364.71 1042.29,-369.66"/>
</g>
<!-- allreduce_6&#45;&gt;ep_allgather -->
<g id="edge101" class="edge">
<title>allreduce_6&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1201.31,-271C1251.78,-258.75 1315.5,-244.44 1373,-234 1559.43,-200.15 1778.76,-172.89 1907.69,-158.39"/>
<polygon fill="black" stroke="black" points="1908.42,-161.83 1917.97,-157.24 1907.64,-154.88 1908.42,-161.83"/>
</g>
<!-- allreduce_6&#45;&gt;ep_allgather -->
<g id="edge105" class="edge">
<title>allreduce_6&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M1202.75,-274.45C1257.53,-261.53 1328,-245.44 1391,-234 1571.69,-201.19 1783.29,-174.57 1908.73,-159.77"/>
<polygon fill="black" stroke="black" points="1909.21,-163.24 1918.73,-158.59 1908.39,-156.28 1909.21,-163.24"/>
</g>
<!-- gate_13 -->
<g id="node82" class="node">
<title>gate_13</title>
<polygon fill="lightpink" stroke="black" points="754.31,-720 567.7,-720 519.69,-616 706.3,-616 754.31,-720"/>
<text text-anchor="middle" x="637" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="637" y="-671" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="637" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="637" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_6_tp_1 -->
<g id="node83" class="node">
<title>expert_6_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="729,-580 549,-580 549,-506 729,-506 729,-580"/>
<text text-anchor="middle" x="639" y="-568" font-family="Times,serif" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="639" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="639" y="-546" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="639" y="-535" font-family="Times,serif" font-size="10.00">Experts: [12:14]</text>
<text text-anchor="middle" x="639" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="639" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_13&#45;&gt;expert_6_tp_1 -->
<g id="edge102" class="edge">
<title>gate_13&#45;&gt;expert_6_tp_1</title>
<path fill="none" stroke="black" d="M637.83,-615.91C637.97,-607.37 638.11,-598.55 638.25,-590.14"/>
<polygon fill="black" stroke="black" points="641.75,-590.19 638.41,-580.14 634.75,-590.08 641.75,-590.19"/>
</g>
<!-- ffn_6_tp_1 -->
<g id="node84" class="node">
<title>ffn_6_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="732,-470 552,-470 552,-396 732,-396 732,-470"/>
<text text-anchor="middle" x="642" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="642" y="-447" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="642" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="642" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="642" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="642" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_6_tp_1&#45;&gt;ffn_6_tp_1 -->
<g id="edge103" class="edge">
<title>expert_6_tp_1&#45;&gt;ffn_6_tp_1</title>
<path fill="none" stroke="black" d="M640.01,-505.74C640.23,-497.63 640.47,-488.93 640.71,-480.48"/>
<polygon fill="black" stroke="black" points="644.21,-480.44 640.99,-470.35 637.21,-480.25 644.21,-480.44"/>
</g>
<!-- ffn_6_tp_1&#45;&gt;allreduce_6 -->
<g id="edge104" class="edge">
<title>ffn_6_tp_1&#45;&gt;allreduce_6</title>
<path fill="none" stroke="black" d="M732.04,-406.16C810.87,-383.54 925.31,-350.71 1007.4,-327.15"/>
<polygon fill="black" stroke="black" points="1008.59,-330.45 1017.24,-324.33 1006.66,-323.72 1008.59,-330.45"/>
</g>
<!-- gate_14 -->
<g id="node85" class="node">
<title>gate_14</title>
<polygon fill="lightpink" stroke="black" points="502.31,-720 315.7,-720 267.69,-616 454.3,-616 502.31,-720"/>
<text text-anchor="middle" x="385" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="385" y="-671" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="385" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="385" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_7_tp_0 -->
<g id="node86" class="node">
<title>expert_7_tp_0</title>
<polygon fill="lightcyan" stroke="black" points="492,-580 312,-580 312,-506 492,-506 492,-580"/>
<text text-anchor="middle" x="402" y="-568" font-family="Times,serif" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="402" y="-557" font-family="Times,serif" font-size="10.00">TP 0</text>
<text text-anchor="middle" x="402" y="-546" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="402" y="-535" font-family="Times,serif" font-size="10.00">Experts: [14:16]</text>
<text text-anchor="middle" x="402" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="402" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_14&#45;&gt;expert_7_tp_0 -->
<g id="edge106" class="edge">
<title>gate_14&#45;&gt;expert_7_tp_0</title>
<path fill="none" stroke="black" d="M392.06,-615.91C393.24,-607.37 394.46,-598.55 395.62,-590.14"/>
<polygon fill="black" stroke="black" points="399.1,-590.52 397.01,-580.14 392.17,-589.56 399.1,-590.52"/>
</g>
<!-- ffn_7_tp_0 -->
<g id="node87" class="node">
<title>ffn_7_tp_0</title>
<polygon fill="lightsteelblue" stroke="black" points="510,-470 330,-470 330,-396 510,-396 510,-470"/>
<text text-anchor="middle" x="420" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="420" y="-447" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="420" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="420" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="420" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="420" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_7_tp_0&#45;&gt;ffn_7_tp_0 -->
<g id="edge107" class="edge">
<title>expert_7_tp_0&#45;&gt;ffn_7_tp_0</title>
<path fill="none" stroke="black" d="M408.04,-505.74C409.39,-497.63 410.84,-488.93 412.25,-480.48"/>
<polygon fill="black" stroke="black" points="415.75,-480.79 413.94,-470.35 408.85,-479.64 415.75,-480.79"/>
</g>
<!-- allreduce_7 -->
<g id="node88" class="node">
<title>allreduce_7</title>
<polygon fill="gold" stroke="black" points="755.69,-360 549.38,-360 496.31,-234 702.62,-234 755.69,-360"/>
<text text-anchor="middle" x="626" y="-316.5" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="626" y="-305.5" font-family="Times,serif" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="626" y="-294.5" font-family="Times,serif" font-size="10.00">TPF=2</text>
<text text-anchor="middle" x="626" y="-283.5" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="626" y="-272.5" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- ffn_7_tp_0&#45;&gt;allreduce_7 -->
<g id="edge108" class="edge">
<title>ffn_7_tp_0&#45;&gt;allreduce_7</title>
<path fill="none" stroke="black" d="M475.48,-395.91C494.33,-383.65 515.9,-369.62 536.71,-356.08"/>
<polygon fill="black" stroke="black" points="538.79,-358.9 545.26,-350.52 534.97,-353.04 538.79,-358.9"/>
</g>
<!-- allreduce_7&#45;&gt;ep_allgather -->
<g id="edge109" class="edge">
<title>allreduce_7&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M719.94,-275.06C786.86,-261.63 879.02,-244.77 961,-234 1303.11,-189.07 1711.27,-163.07 1905.12,-152.53"/>
<polygon fill="black" stroke="black" points="1905.53,-156.01 1915.32,-151.98 1905.15,-149.02 1905.53,-156.01"/>
</g>
<!-- allreduce_7&#45;&gt;ep_allgather -->
<g id="edge113" class="edge">
<title>allreduce_7&#45;&gt;ep_allgather</title>
<path fill="none" stroke="black" d="M721.36,-277.74C792.3,-263.95 891.46,-245.5 979,-234 1314.88,-189.89 1714.44,-164.02 1905.48,-153.12"/>
<polygon fill="black" stroke="black" points="1905.75,-156.61 1915.53,-152.55 1905.35,-149.62 1905.75,-156.61"/>
</g>
<!-- gate_15 -->
<g id="node89" class="node">
<title>gate_15</title>
<polygon fill="lightpink" stroke="black" points="250.31,-720 63.7,-720 15.69,-616 202.3,-616 250.31,-720"/>
<text text-anchor="middle" x="133" y="-682" font-family="Times,serif" font-size="10.00">Gate</text>
<text text-anchor="middle" x="133" y="-671" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="133" y="-660" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="133" y="-649" font-family="Times,serif" font-size="10.00">Output: [B, 1, 256]</text>
</g>
<!-- expert_7_tp_1 -->
<g id="node90" class="node">
<title>expert_7_tp_1</title>
<polygon fill="lightcyan" stroke="black" points="233,-580 53,-580 53,-506 233,-506 233,-580"/>
<text text-anchor="middle" x="143" y="-568" font-family="Times,serif" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="143" y="-557" font-family="Times,serif" font-size="10.00">TP 1</text>
<text text-anchor="middle" x="143" y="-546" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="143" y="-535" font-family="Times,serif" font-size="10.00">Experts: [14:16]</text>
<text text-anchor="middle" x="143" y="-524" font-family="Times,serif" font-size="10.00">Input: [B/8, 1, 2048]</text>
<text text-anchor="middle" x="143" y="-513" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- gate_15&#45;&gt;expert_7_tp_1 -->
<g id="edge110" class="edge">
<title>gate_15&#45;&gt;expert_7_tp_1</title>
<path fill="none" stroke="black" d="M137.15,-615.91C137.85,-607.37 138.57,-598.55 139.25,-590.14"/>
<polygon fill="black" stroke="black" points="142.74,-590.39 140.06,-580.14 135.76,-589.82 142.74,-590.39"/>
</g>
<!-- ffn_7_tp_1 -->
<g id="node91" class="node">
<title>ffn_7_tp_1</title>
<polygon fill="lightsteelblue" stroke="black" points="301,-470 121,-470 121,-396 301,-396 301,-470"/>
<text text-anchor="middle" x="211" y="-458" font-family="Times,serif" font-size="10.00">FFN</text>
<text text-anchor="middle" x="211" y="-447" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="211" y="-436" font-family="Times,serif" font-size="10.00">UP: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="211" y="-425" font-family="Times,serif" font-size="10.00">Gate: [B/8, 2048, 16384/2]</text>
<text text-anchor="middle" x="211" y="-414" font-family="Times,serif" font-size="10.00">Down: [B/8, 16384/2, 2048]</text>
<text text-anchor="middle" x="211" y="-403" font-family="Times,serif" font-size="10.00">Output: [B/8, 1, 2048]</text>
</g>
<!-- expert_7_tp_1&#45;&gt;ffn_7_tp_1 -->
<g id="edge111" class="edge">
<title>expert_7_tp_1&#45;&gt;ffn_7_tp_1</title>
<path fill="none" stroke="black" d="M165.83,-505.74C171.21,-497.19 177.02,-487.97 182.61,-479.09"/>
<polygon fill="black" stroke="black" points="185.75,-480.68 188.11,-470.35 179.82,-476.95 185.75,-480.68"/>
</g>
<!-- ffn_7_tp_1&#45;&gt;allreduce_7 -->
<g id="edge112" class="edge">
<title>ffn_7_tp_1&#45;&gt;allreduce_7</title>
<path fill="none" stroke="black" d="M301.03,-402.49C307.79,-400.29 314.5,-398.11 321,-396 389.16,-373.9 465.96,-349.22 525.44,-330.16"/>
<polygon fill="black" stroke="black" points="526.75,-333.42 535.21,-327.03 524.62,-326.75 526.75,-333.42"/>
</g>
</g>
</svg>
