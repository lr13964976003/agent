// Llama-405B with Helix Parallelism (64 GPUs)
digraph Llama_405B_Helix {
	compound=true rankdir=TB size="25,35"
	node [fontsize=9 height=0.7 width=2.0]
	input [label="Input\nInput: [batch_size=B, seq_len=1, hidden_dim=16384]" fillcolor=lightblue shape=ellipse style=filled]
	subgraph cluster_attention {
		label="Attention Phase (KVÃ—TP)" style=dashed
		subgraph cluster_kvp_0 {
			label="KVP 0 (tokens [0S/8:1S/8])"
			qkv_0 [label="QKV Projection\nGPU 0\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_0 [label="Attention\nGPU 0\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_1 [label="QKV Projection\nGPU 1\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_1 [label="Attention\nGPU 1\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_2 [label="QKV Projection\nGPU 2\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_2 [label="Attention\nGPU 2\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_3 [label="QKV Projection\nGPU 3\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_3 [label="Attention\nGPU 3\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_4 [label="QKV Projection\nGPU 4\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_4 [label="Attention\nGPU 4\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_5 [label="QKV Projection\nGPU 5\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_5 [label="Attention\nGPU 5\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_6 [label="QKV Projection\nGPU 6\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_6 [label="Attention\nGPU 6\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_7 [label="QKV Projection\nGPU 7\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_7 [label="Attention\nGPU 7\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_1 {
			label="KVP 1 (tokens [1S/8:2S/8])"
			qkv_8 [label="QKV Projection\nGPU 8\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_8 [label="Attention\nGPU 8\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_9 [label="QKV Projection\nGPU 9\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_9 [label="Attention\nGPU 9\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_10 [label="QKV Projection\nGPU 10\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_10 [label="Attention\nGPU 10\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_11 [label="QKV Projection\nGPU 11\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_11 [label="Attention\nGPU 11\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_12 [label="QKV Projection\nGPU 12\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_12 [label="Attention\nGPU 12\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_13 [label="QKV Projection\nGPU 13\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_13 [label="Attention\nGPU 13\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_14 [label="QKV Projection\nGPU 14\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_14 [label="Attention\nGPU 14\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_15 [label="QKV Projection\nGPU 15\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_15 [label="Attention\nGPU 15\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_2 {
			label="KVP 2 (tokens [2S/8:3S/8])"
			qkv_16 [label="QKV Projection\nGPU 16\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_16 [label="Attention\nGPU 16\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_17 [label="QKV Projection\nGPU 17\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_17 [label="Attention\nGPU 17\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_18 [label="QKV Projection\nGPU 18\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_18 [label="Attention\nGPU 18\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_19 [label="QKV Projection\nGPU 19\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_19 [label="Attention\nGPU 19\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_20 [label="QKV Projection\nGPU 20\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_20 [label="Attention\nGPU 20\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_21 [label="QKV Projection\nGPU 21\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_21 [label="Attention\nGPU 21\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_22 [label="QKV Projection\nGPU 22\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_22 [label="Attention\nGPU 22\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_23 [label="QKV Projection\nGPU 23\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_23 [label="Attention\nGPU 23\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_3 {
			label="KVP 3 (tokens [3S/8:4S/8])"
			qkv_24 [label="QKV Projection\nGPU 24\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_24 [label="Attention\nGPU 24\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_25 [label="QKV Projection\nGPU 25\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_25 [label="Attention\nGPU 25\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_26 [label="QKV Projection\nGPU 26\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_26 [label="Attention\nGPU 26\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_27 [label="QKV Projection\nGPU 27\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_27 [label="Attention\nGPU 27\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_28 [label="QKV Projection\nGPU 28\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_28 [label="Attention\nGPU 28\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_29 [label="QKV Projection\nGPU 29\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_29 [label="Attention\nGPU 29\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_30 [label="QKV Projection\nGPU 30\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_30 [label="Attention\nGPU 30\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_31 [label="QKV Projection\nGPU 31\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_31 [label="Attention\nGPU 31\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_4 {
			label="KVP 4 (tokens [4S/8:5S/8])"
			qkv_32 [label="QKV Projection\nGPU 32\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_32 [label="Attention\nGPU 32\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_33 [label="QKV Projection\nGPU 33\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_33 [label="Attention\nGPU 33\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_34 [label="QKV Projection\nGPU 34\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_34 [label="Attention\nGPU 34\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_35 [label="QKV Projection\nGPU 35\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_35 [label="Attention\nGPU 35\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_36 [label="QKV Projection\nGPU 36\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_36 [label="Attention\nGPU 36\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_37 [label="QKV Projection\nGPU 37\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_37 [label="Attention\nGPU 37\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_38 [label="QKV Projection\nGPU 38\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_38 [label="Attention\nGPU 38\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_39 [label="QKV Projection\nGPU 39\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_39 [label="Attention\nGPU 39\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_5 {
			label="KVP 5 (tokens [5S/8:6S/8])"
			qkv_40 [label="QKV Projection\nGPU 40\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_40 [label="Attention\nGPU 40\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_41 [label="QKV Projection\nGPU 41\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_41 [label="Attention\nGPU 41\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_42 [label="QKV Projection\nGPU 42\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_42 [label="Attention\nGPU 42\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_43 [label="QKV Projection\nGPU 43\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_43 [label="Attention\nGPU 43\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_44 [label="QKV Projection\nGPU 44\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_44 [label="Attention\nGPU 44\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_45 [label="QKV Projection\nGPU 45\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_45 [label="Attention\nGPU 45\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_46 [label="QKV Projection\nGPU 46\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_46 [label="Attention\nGPU 46\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_47 [label="QKV Projection\nGPU 47\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_47 [label="Attention\nGPU 47\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_6 {
			label="KVP 6 (tokens [6S/8:7S/8])"
			qkv_48 [label="QKV Projection\nGPU 48\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_48 [label="Attention\nGPU 48\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_49 [label="QKV Projection\nGPU 49\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_49 [label="Attention\nGPU 49\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_50 [label="QKV Projection\nGPU 50\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_50 [label="Attention\nGPU 50\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_51 [label="QKV Projection\nGPU 51\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_51 [label="Attention\nGPU 51\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_52 [label="QKV Projection\nGPU 52\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_52 [label="Attention\nGPU 52\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_53 [label="QKV Projection\nGPU 53\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_53 [label="Attention\nGPU 53\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_54 [label="QKV Projection\nGPU 54\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_54 [label="Attention\nGPU 54\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_55 [label="QKV Projection\nGPU 55\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_55 [label="Attention\nGPU 55\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		subgraph cluster_kvp_7 {
			label="KVP 7 (tokens [7S/8:8S/8])"
			qkv_56 [label="QKV Projection\nGPU 56\nQ heads: [0:16]\nKV head: [0:1]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_56 [label="Attention\nGPU 56\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_57 [label="QKV Projection\nGPU 57\nQ heads: [16:32]\nKV head: [1:2]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_57 [label="Attention\nGPU 57\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_58 [label="QKV Projection\nGPU 58\nQ heads: [32:48]\nKV head: [2:3]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_58 [label="Attention\nGPU 58\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_59 [label="QKV Projection\nGPU 59\nQ heads: [48:64]\nKV head: [3:4]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_59 [label="Attention\nGPU 59\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_60 [label="QKV Projection\nGPU 60\nQ heads: [64:80]\nKV head: [4:5]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_60 [label="Attention\nGPU 60\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_61 [label="QKV Projection\nGPU 61\nQ heads: [80:96]\nKV head: [5:6]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_61 [label="Attention\nGPU 61\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_62 [label="QKV Projection\nGPU 62\nQ heads: [96:112]\nKV head: [6:7]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_62 [label="Attention\nGPU 62\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
			qkv_63 [label="QKV Projection\nGPU 63\nQ heads: [112:128]\nKV head: [7:8]\nInput: [B, 1, 16384]\nOutput: [B, 1, 16, 128]" fillcolor=lightyellow shape=rectangle style=filled]
			attn_63 [label="Attention\nGPU 63\nInput: [B, 1, 16, 128]\nOutput: [B, 1, 16, 128]" fillcolor=lightgreen shape=rectangle style=filled]
		}
		hopb [label="HOP-B All-to-All\nTPA=8, KVP=8\nVolume: [B, 2048]\nOverlap with next token" fillcolor=lightcoral shape=parallelogram style=dashed]
	}
	subgraph cluster_ffn {
		label="FFN Phase (TP=64)" style=dashed
		ffn_up_0 [label="FFN UP\nGPU 0\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_0 [label="FFN Gate\nGPU 0\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_0 [label="FFN Down\nGPU 0\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_1 [label="FFN UP\nGPU 1\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_1 [label="FFN Gate\nGPU 1\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_1 [label="FFN Down\nGPU 1\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_2 [label="FFN UP\nGPU 2\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_2 [label="FFN Gate\nGPU 2\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_2 [label="FFN Down\nGPU 2\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_3 [label="FFN UP\nGPU 3\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_3 [label="FFN Gate\nGPU 3\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_3 [label="FFN Down\nGPU 3\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_4 [label="FFN UP\nGPU 4\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_4 [label="FFN Gate\nGPU 4\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_4 [label="FFN Down\nGPU 4\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_5 [label="FFN UP\nGPU 5\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_5 [label="FFN Gate\nGPU 5\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_5 [label="FFN Down\nGPU 5\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_6 [label="FFN UP\nGPU 6\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_6 [label="FFN Gate\nGPU 6\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_6 [label="FFN Down\nGPU 6\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_7 [label="FFN UP\nGPU 7\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_7 [label="FFN Gate\nGPU 7\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_7 [label="FFN Down\nGPU 7\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_8 [label="FFN UP\nGPU 8\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_8 [label="FFN Gate\nGPU 8\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_8 [label="FFN Down\nGPU 8\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_9 [label="FFN UP\nGPU 9\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_9 [label="FFN Gate\nGPU 9\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_9 [label="FFN Down\nGPU 9\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_10 [label="FFN UP\nGPU 10\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_10 [label="FFN Gate\nGPU 10\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_10 [label="FFN Down\nGPU 10\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_11 [label="FFN UP\nGPU 11\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_11 [label="FFN Gate\nGPU 11\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_11 [label="FFN Down\nGPU 11\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_12 [label="FFN UP\nGPU 12\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_12 [label="FFN Gate\nGPU 12\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_12 [label="FFN Down\nGPU 12\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_13 [label="FFN UP\nGPU 13\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_13 [label="FFN Gate\nGPU 13\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_13 [label="FFN Down\nGPU 13\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_14 [label="FFN UP\nGPU 14\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_14 [label="FFN Gate\nGPU 14\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_14 [label="FFN Down\nGPU 14\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_15 [label="FFN UP\nGPU 15\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_15 [label="FFN Gate\nGPU 15\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_15 [label="FFN Down\nGPU 15\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_16 [label="FFN UP\nGPU 16\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_16 [label="FFN Gate\nGPU 16\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_16 [label="FFN Down\nGPU 16\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_17 [label="FFN UP\nGPU 17\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_17 [label="FFN Gate\nGPU 17\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_17 [label="FFN Down\nGPU 17\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_18 [label="FFN UP\nGPU 18\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_18 [label="FFN Gate\nGPU 18\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_18 [label="FFN Down\nGPU 18\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_19 [label="FFN UP\nGPU 19\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_19 [label="FFN Gate\nGPU 19\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_19 [label="FFN Down\nGPU 19\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_20 [label="FFN UP\nGPU 20\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_20 [label="FFN Gate\nGPU 20\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_20 [label="FFN Down\nGPU 20\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_21 [label="FFN UP\nGPU 21\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_21 [label="FFN Gate\nGPU 21\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_21 [label="FFN Down\nGPU 21\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_22 [label="FFN UP\nGPU 22\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_22 [label="FFN Gate\nGPU 22\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_22 [label="FFN Down\nGPU 22\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_23 [label="FFN UP\nGPU 23\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_23 [label="FFN Gate\nGPU 23\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_23 [label="FFN Down\nGPU 23\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_24 [label="FFN UP\nGPU 24\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_24 [label="FFN Gate\nGPU 24\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_24 [label="FFN Down\nGPU 24\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_25 [label="FFN UP\nGPU 25\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_25 [label="FFN Gate\nGPU 25\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_25 [label="FFN Down\nGPU 25\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_26 [label="FFN UP\nGPU 26\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_26 [label="FFN Gate\nGPU 26\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_26 [label="FFN Down\nGPU 26\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_27 [label="FFN UP\nGPU 27\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_27 [label="FFN Gate\nGPU 27\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_27 [label="FFN Down\nGPU 27\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_28 [label="FFN UP\nGPU 28\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_28 [label="FFN Gate\nGPU 28\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_28 [label="FFN Down\nGPU 28\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_29 [label="FFN UP\nGPU 29\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_29 [label="FFN Gate\nGPU 29\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_29 [label="FFN Down\nGPU 29\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_30 [label="FFN UP\nGPU 30\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_30 [label="FFN Gate\nGPU 30\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_30 [label="FFN Down\nGPU 30\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_31 [label="FFN UP\nGPU 31\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_31 [label="FFN Gate\nGPU 31\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_31 [label="FFN Down\nGPU 31\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_32 [label="FFN UP\nGPU 32\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_32 [label="FFN Gate\nGPU 32\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_32 [label="FFN Down\nGPU 32\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_33 [label="FFN UP\nGPU 33\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_33 [label="FFN Gate\nGPU 33\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_33 [label="FFN Down\nGPU 33\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_34 [label="FFN UP\nGPU 34\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_34 [label="FFN Gate\nGPU 34\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_34 [label="FFN Down\nGPU 34\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_35 [label="FFN UP\nGPU 35\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_35 [label="FFN Gate\nGPU 35\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_35 [label="FFN Down\nGPU 35\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_36 [label="FFN UP\nGPU 36\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_36 [label="FFN Gate\nGPU 36\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_36 [label="FFN Down\nGPU 36\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_37 [label="FFN UP\nGPU 37\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_37 [label="FFN Gate\nGPU 37\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_37 [label="FFN Down\nGPU 37\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_38 [label="FFN UP\nGPU 38\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_38 [label="FFN Gate\nGPU 38\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_38 [label="FFN Down\nGPU 38\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_39 [label="FFN UP\nGPU 39\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_39 [label="FFN Gate\nGPU 39\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_39 [label="FFN Down\nGPU 39\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_40 [label="FFN UP\nGPU 40\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_40 [label="FFN Gate\nGPU 40\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_40 [label="FFN Down\nGPU 40\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_41 [label="FFN UP\nGPU 41\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_41 [label="FFN Gate\nGPU 41\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_41 [label="FFN Down\nGPU 41\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_42 [label="FFN UP\nGPU 42\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_42 [label="FFN Gate\nGPU 42\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_42 [label="FFN Down\nGPU 42\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_43 [label="FFN UP\nGPU 43\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_43 [label="FFN Gate\nGPU 43\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_43 [label="FFN Down\nGPU 43\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_44 [label="FFN UP\nGPU 44\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_44 [label="FFN Gate\nGPU 44\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_44 [label="FFN Down\nGPU 44\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_45 [label="FFN UP\nGPU 45\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_45 [label="FFN Gate\nGPU 45\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_45 [label="FFN Down\nGPU 45\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_46 [label="FFN UP\nGPU 46\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_46 [label="FFN Gate\nGPU 46\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_46 [label="FFN Down\nGPU 46\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_47 [label="FFN UP\nGPU 47\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_47 [label="FFN Gate\nGPU 47\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_47 [label="FFN Down\nGPU 47\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_48 [label="FFN UP\nGPU 48\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_48 [label="FFN Gate\nGPU 48\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_48 [label="FFN Down\nGPU 48\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_49 [label="FFN UP\nGPU 49\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_49 [label="FFN Gate\nGPU 49\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_49 [label="FFN Down\nGPU 49\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_50 [label="FFN UP\nGPU 50\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_50 [label="FFN Gate\nGPU 50\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_50 [label="FFN Down\nGPU 50\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_51 [label="FFN UP\nGPU 51\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_51 [label="FFN Gate\nGPU 51\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_51 [label="FFN Down\nGPU 51\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_52 [label="FFN UP\nGPU 52\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_52 [label="FFN Gate\nGPU 52\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_52 [label="FFN Down\nGPU 52\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_53 [label="FFN UP\nGPU 53\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_53 [label="FFN Gate\nGPU 53\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_53 [label="FFN Down\nGPU 53\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_54 [label="FFN UP\nGPU 54\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_54 [label="FFN Gate\nGPU 54\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_54 [label="FFN Down\nGPU 54\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_55 [label="FFN UP\nGPU 55\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_55 [label="FFN Gate\nGPU 55\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_55 [label="FFN Down\nGPU 55\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_56 [label="FFN UP\nGPU 56\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_56 [label="FFN Gate\nGPU 56\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_56 [label="FFN Down\nGPU 56\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_57 [label="FFN UP\nGPU 57\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_57 [label="FFN Gate\nGPU 57\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_57 [label="FFN Down\nGPU 57\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_58 [label="FFN UP\nGPU 58\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_58 [label="FFN Gate\nGPU 58\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_58 [label="FFN Down\nGPU 58\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_59 [label="FFN UP\nGPU 59\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_59 [label="FFN Gate\nGPU 59\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_59 [label="FFN Down\nGPU 59\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_60 [label="FFN UP\nGPU 60\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_60 [label="FFN Gate\nGPU 60\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_60 [label="FFN Down\nGPU 60\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_61 [label="FFN UP\nGPU 61\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_61 [label="FFN Gate\nGPU 61\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_61 [label="FFN Down\nGPU 61\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_62 [label="FFN UP\nGPU 62\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_62 [label="FFN Gate\nGPU 62\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_62 [label="FFN Down\nGPU 62\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_up_63 [label="FFN UP\nGPU 63\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_gate_63 [label="FFN Gate\nGPU 63\nInput: [B, 1, 16384]\nWeights: [16384, 1024]\nOutput: [B, 1, 1024]" fillcolor=lightsteelblue shape=rectangle style=filled]
		ffn_down_63 [label="FFN Down\nGPU 63\nInput: [B, 1, 1024]\nWeights: [1024, 16384]\nOutput: [B, 1, 256]" fillcolor=lightsteelblue shape=rectangle style=filled]
		tp_allreduce [label="TP All-Reduce\nTP=64\nInput: [B, 1, 256]Ã—64\nOutput: [B, 1, 16384]" fillcolor=gold shape=parallelogram style=filled]
	}
	output [label="Output\nInput: [B, 1, 16384]\nOutput: [B, 1, 16384]" fillcolor=lightgreen shape=ellipse style=filled]
	input -> qkv_0
	qkv_0 -> attn_0
	attn_0 -> hopb
	input -> qkv_1
	qkv_1 -> attn_1
	attn_1 -> hopb
	input -> qkv_2
	qkv_2 -> attn_2
	attn_2 -> hopb
	input -> qkv_3
	qkv_3 -> attn_3
	attn_3 -> hopb
	input -> qkv_4
	qkv_4 -> attn_4
	attn_4 -> hopb
	input -> qkv_5
	qkv_5 -> attn_5
	attn_5 -> hopb
	input -> qkv_6
	qkv_6 -> attn_6
	attn_6 -> hopb
	input -> qkv_7
	qkv_7 -> attn_7
	attn_7 -> hopb
	input -> qkv_8
	qkv_8 -> attn_8
	attn_8 -> hopb
	input -> qkv_9
	qkv_9 -> attn_9
	attn_9 -> hopb
	input -> qkv_10
	qkv_10 -> attn_10
	attn_10 -> hopb
	input -> qkv_11
	qkv_11 -> attn_11
	attn_11 -> hopb
	input -> qkv_12
	qkv_12 -> attn_12
	attn_12 -> hopb
	input -> qkv_13
	qkv_13 -> attn_13
	attn_13 -> hopb
	input -> qkv_14
	qkv_14 -> attn_14
	attn_14 -> hopb
	input -> qkv_15
	qkv_15 -> attn_15
	attn_15 -> hopb
	input -> qkv_16
	qkv_16 -> attn_16
	attn_16 -> hopb
	input -> qkv_17
	qkv_17 -> attn_17
	attn_17 -> hopb
	input -> qkv_18
	qkv_18 -> attn_18
	attn_18 -> hopb
	input -> qkv_19
	qkv_19 -> attn_19
	attn_19 -> hopb
	input -> qkv_20
	qkv_20 -> attn_20
	attn_20 -> hopb
	input -> qkv_21
	qkv_21 -> attn_21
	attn_21 -> hopb
	input -> qkv_22
	qkv_22 -> attn_22
	attn_22 -> hopb
	input -> qkv_23
	qkv_23 -> attn_23
	attn_23 -> hopb
	input -> qkv_24
	qkv_24 -> attn_24
	attn_24 -> hopb
	input -> qkv_25
	qkv_25 -> attn_25
	attn_25 -> hopb
	input -> qkv_26
	qkv_26 -> attn_26
	attn_26 -> hopb
	input -> qkv_27
	qkv_27 -> attn_27
	attn_27 -> hopb
	input -> qkv_28
	qkv_28 -> attn_28
	attn_28 -> hopb
	input -> qkv_29
	qkv_29 -> attn_29
	attn_29 -> hopb
	input -> qkv_30
	qkv_30 -> attn_30
	attn_30 -> hopb
	input -> qkv_31
	qkv_31 -> attn_31
	attn_31 -> hopb
	input -> qkv_32
	qkv_32 -> attn_32
	attn_32 -> hopb
	input -> qkv_33
	qkv_33 -> attn_33
	attn_33 -> hopb
	input -> qkv_34
	qkv_34 -> attn_34
	attn_34 -> hopb
	input -> qkv_35
	qkv_35 -> attn_35
	attn_35 -> hopb
	input -> qkv_36
	qkv_36 -> attn_36
	attn_36 -> hopb
	input -> qkv_37
	qkv_37 -> attn_37
	attn_37 -> hopb
	input -> qkv_38
	qkv_38 -> attn_38
	attn_38 -> hopb
	input -> qkv_39
	qkv_39 -> attn_39
	attn_39 -> hopb
	input -> qkv_40
	qkv_40 -> attn_40
	attn_40 -> hopb
	input -> qkv_41
	qkv_41 -> attn_41
	attn_41 -> hopb
	input -> qkv_42
	qkv_42 -> attn_42
	attn_42 -> hopb
	input -> qkv_43
	qkv_43 -> attn_43
	attn_43 -> hopb
	input -> qkv_44
	qkv_44 -> attn_44
	attn_44 -> hopb
	input -> qkv_45
	qkv_45 -> attn_45
	attn_45 -> hopb
	input -> qkv_46
	qkv_46 -> attn_46
	attn_46 -> hopb
	input -> qkv_47
	qkv_47 -> attn_47
	attn_47 -> hopb
	input -> qkv_48
	qkv_48 -> attn_48
	attn_48 -> hopb
	input -> qkv_49
	qkv_49 -> attn_49
	attn_49 -> hopb
	input -> qkv_50
	qkv_50 -> attn_50
	attn_50 -> hopb
	input -> qkv_51
	qkv_51 -> attn_51
	attn_51 -> hopb
	input -> qkv_52
	qkv_52 -> attn_52
	attn_52 -> hopb
	input -> qkv_53
	qkv_53 -> attn_53
	attn_53 -> hopb
	input -> qkv_54
	qkv_54 -> attn_54
	attn_54 -> hopb
	input -> qkv_55
	qkv_55 -> attn_55
	attn_55 -> hopb
	input -> qkv_56
	qkv_56 -> attn_56
	attn_56 -> hopb
	input -> qkv_57
	qkv_57 -> attn_57
	attn_57 -> hopb
	input -> qkv_58
	qkv_58 -> attn_58
	attn_58 -> hopb
	input -> qkv_59
	qkv_59 -> attn_59
	attn_59 -> hopb
	input -> qkv_60
	qkv_60 -> attn_60
	attn_60 -> hopb
	input -> qkv_61
	qkv_61 -> attn_61
	attn_61 -> hopb
	input -> qkv_62
	qkv_62 -> attn_62
	attn_62 -> hopb
	input -> qkv_63
	qkv_63 -> attn_63
	attn_63 -> hopb
	hopb -> ffn_up_0 [lhead=cluster_ffn]
	hopb -> ffn_gate_0
	ffn_up_0 -> ffn_down_0
	ffn_gate_0 -> ffn_down_0
	ffn_down_0 -> tp_allreduce
	hopb -> ffn_up_1 [lhead=cluster_ffn]
	hopb -> ffn_gate_1
	ffn_up_1 -> ffn_down_1
	ffn_gate_1 -> ffn_down_1
	ffn_down_1 -> tp_allreduce
	hopb -> ffn_up_2 [lhead=cluster_ffn]
	hopb -> ffn_gate_2
	ffn_up_2 -> ffn_down_2
	ffn_gate_2 -> ffn_down_2
	ffn_down_2 -> tp_allreduce
	hopb -> ffn_up_3 [lhead=cluster_ffn]
	hopb -> ffn_gate_3
	ffn_up_3 -> ffn_down_3
	ffn_gate_3 -> ffn_down_3
	ffn_down_3 -> tp_allreduce
	hopb -> ffn_up_4 [lhead=cluster_ffn]
	hopb -> ffn_gate_4
	ffn_up_4 -> ffn_down_4
	ffn_gate_4 -> ffn_down_4
	ffn_down_4 -> tp_allreduce
	hopb -> ffn_up_5 [lhead=cluster_ffn]
	hopb -> ffn_gate_5
	ffn_up_5 -> ffn_down_5
	ffn_gate_5 -> ffn_down_5
	ffn_down_5 -> tp_allreduce
	hopb -> ffn_up_6 [lhead=cluster_ffn]
	hopb -> ffn_gate_6
	ffn_up_6 -> ffn_down_6
	ffn_gate_6 -> ffn_down_6
	ffn_down_6 -> tp_allreduce
	hopb -> ffn_up_7 [lhead=cluster_ffn]
	hopb -> ffn_gate_7
	ffn_up_7 -> ffn_down_7
	ffn_gate_7 -> ffn_down_7
	ffn_down_7 -> tp_allreduce
	hopb -> ffn_up_8 [lhead=cluster_ffn]
	hopb -> ffn_gate_8
	ffn_up_8 -> ffn_down_8
	ffn_gate_8 -> ffn_down_8
	ffn_down_8 -> tp_allreduce
	hopb -> ffn_up_9 [lhead=cluster_ffn]
	hopb -> ffn_gate_9
	ffn_up_9 -> ffn_down_9
	ffn_gate_9 -> ffn_down_9
	ffn_down_9 -> tp_allreduce
	hopb -> ffn_up_10 [lhead=cluster_ffn]
	hopb -> ffn_gate_10
	ffn_up_10 -> ffn_down_10
	ffn_gate_10 -> ffn_down_10
	ffn_down_10 -> tp_allreduce
	hopb -> ffn_up_11 [lhead=cluster_ffn]
	hopb -> ffn_gate_11
	ffn_up_11 -> ffn_down_11
	ffn_gate_11 -> ffn_down_11
	ffn_down_11 -> tp_allreduce
	hopb -> ffn_up_12 [lhead=cluster_ffn]
	hopb -> ffn_gate_12
	ffn_up_12 -> ffn_down_12
	ffn_gate_12 -> ffn_down_12
	ffn_down_12 -> tp_allreduce
	hopb -> ffn_up_13 [lhead=cluster_ffn]
	hopb -> ffn_gate_13
	ffn_up_13 -> ffn_down_13
	ffn_gate_13 -> ffn_down_13
	ffn_down_13 -> tp_allreduce
	hopb -> ffn_up_14 [lhead=cluster_ffn]
	hopb -> ffn_gate_14
	ffn_up_14 -> ffn_down_14
	ffn_gate_14 -> ffn_down_14
	ffn_down_14 -> tp_allreduce
	hopb -> ffn_up_15 [lhead=cluster_ffn]
	hopb -> ffn_gate_15
	ffn_up_15 -> ffn_down_15
	ffn_gate_15 -> ffn_down_15
	ffn_down_15 -> tp_allreduce
	hopb -> ffn_up_16 [lhead=cluster_ffn]
	hopb -> ffn_gate_16
	ffn_up_16 -> ffn_down_16
	ffn_gate_16 -> ffn_down_16
	ffn_down_16 -> tp_allreduce
	hopb -> ffn_up_17 [lhead=cluster_ffn]
	hopb -> ffn_gate_17
	ffn_up_17 -> ffn_down_17
	ffn_gate_17 -> ffn_down_17
	ffn_down_17 -> tp_allreduce
	hopb -> ffn_up_18 [lhead=cluster_ffn]
	hopb -> ffn_gate_18
	ffn_up_18 -> ffn_down_18
	ffn_gate_18 -> ffn_down_18
	ffn_down_18 -> tp_allreduce
	hopb -> ffn_up_19 [lhead=cluster_ffn]
	hopb -> ffn_gate_19
	ffn_up_19 -> ffn_down_19
	ffn_gate_19 -> ffn_down_19
	ffn_down_19 -> tp_allreduce
	hopb -> ffn_up_20 [lhead=cluster_ffn]
	hopb -> ffn_gate_20
	ffn_up_20 -> ffn_down_20
	ffn_gate_20 -> ffn_down_20
	ffn_down_20 -> tp_allreduce
	hopb -> ffn_up_21 [lhead=cluster_ffn]
	hopb -> ffn_gate_21
	ffn_up_21 -> ffn_down_21
	ffn_gate_21 -> ffn_down_21
	ffn_down_21 -> tp_allreduce
	hopb -> ffn_up_22 [lhead=cluster_ffn]
	hopb -> ffn_gate_22
	ffn_up_22 -> ffn_down_22
	ffn_gate_22 -> ffn_down_22
	ffn_down_22 -> tp_allreduce
	hopb -> ffn_up_23 [lhead=cluster_ffn]
	hopb -> ffn_gate_23
	ffn_up_23 -> ffn_down_23
	ffn_gate_23 -> ffn_down_23
	ffn_down_23 -> tp_allreduce
	hopb -> ffn_up_24 [lhead=cluster_ffn]
	hopb -> ffn_gate_24
	ffn_up_24 -> ffn_down_24
	ffn_gate_24 -> ffn_down_24
	ffn_down_24 -> tp_allreduce
	hopb -> ffn_up_25 [lhead=cluster_ffn]
	hopb -> ffn_gate_25
	ffn_up_25 -> ffn_down_25
	ffn_gate_25 -> ffn_down_25
	ffn_down_25 -> tp_allreduce
	hopb -> ffn_up_26 [lhead=cluster_ffn]
	hopb -> ffn_gate_26
	ffn_up_26 -> ffn_down_26
	ffn_gate_26 -> ffn_down_26
	ffn_down_26 -> tp_allreduce
	hopb -> ffn_up_27 [lhead=cluster_ffn]
	hopb -> ffn_gate_27
	ffn_up_27 -> ffn_down_27
	ffn_gate_27 -> ffn_down_27
	ffn_down_27 -> tp_allreduce
	hopb -> ffn_up_28 [lhead=cluster_ffn]
	hopb -> ffn_gate_28
	ffn_up_28 -> ffn_down_28
	ffn_gate_28 -> ffn_down_28
	ffn_down_28 -> tp_allreduce
	hopb -> ffn_up_29 [lhead=cluster_ffn]
	hopb -> ffn_gate_29
	ffn_up_29 -> ffn_down_29
	ffn_gate_29 -> ffn_down_29
	ffn_down_29 -> tp_allreduce
	hopb -> ffn_up_30 [lhead=cluster_ffn]
	hopb -> ffn_gate_30
	ffn_up_30 -> ffn_down_30
	ffn_gate_30 -> ffn_down_30
	ffn_down_30 -> tp_allreduce
	hopb -> ffn_up_31 [lhead=cluster_ffn]
	hopb -> ffn_gate_31
	ffn_up_31 -> ffn_down_31
	ffn_gate_31 -> ffn_down_31
	ffn_down_31 -> tp_allreduce
	hopb -> ffn_up_32 [lhead=cluster_ffn]
	hopb -> ffn_gate_32
	ffn_up_32 -> ffn_down_32
	ffn_gate_32 -> ffn_down_32
	ffn_down_32 -> tp_allreduce
	hopb -> ffn_up_33 [lhead=cluster_ffn]
	hopb -> ffn_gate_33
	ffn_up_33 -> ffn_down_33
	ffn_gate_33 -> ffn_down_33
	ffn_down_33 -> tp_allreduce
	hopb -> ffn_up_34 [lhead=cluster_ffn]
	hopb -> ffn_gate_34
	ffn_up_34 -> ffn_down_34
	ffn_gate_34 -> ffn_down_34
	ffn_down_34 -> tp_allreduce
	hopb -> ffn_up_35 [lhead=cluster_ffn]
	hopb -> ffn_gate_35
	ffn_up_35 -> ffn_down_35
	ffn_gate_35 -> ffn_down_35
	ffn_down_35 -> tp_allreduce
	hopb -> ffn_up_36 [lhead=cluster_ffn]
	hopb -> ffn_gate_36
	ffn_up_36 -> ffn_down_36
	ffn_gate_36 -> ffn_down_36
	ffn_down_36 -> tp_allreduce
	hopb -> ffn_up_37 [lhead=cluster_ffn]
	hopb -> ffn_gate_37
	ffn_up_37 -> ffn_down_37
	ffn_gate_37 -> ffn_down_37
	ffn_down_37 -> tp_allreduce
	hopb -> ffn_up_38 [lhead=cluster_ffn]
	hopb -> ffn_gate_38
	ffn_up_38 -> ffn_down_38
	ffn_gate_38 -> ffn_down_38
	ffn_down_38 -> tp_allreduce
	hopb -> ffn_up_39 [lhead=cluster_ffn]
	hopb -> ffn_gate_39
	ffn_up_39 -> ffn_down_39
	ffn_gate_39 -> ffn_down_39
	ffn_down_39 -> tp_allreduce
	hopb -> ffn_up_40 [lhead=cluster_ffn]
	hopb -> ffn_gate_40
	ffn_up_40 -> ffn_down_40
	ffn_gate_40 -> ffn_down_40
	ffn_down_40 -> tp_allreduce
	hopb -> ffn_up_41 [lhead=cluster_ffn]
	hopb -> ffn_gate_41
	ffn_up_41 -> ffn_down_41
	ffn_gate_41 -> ffn_down_41
	ffn_down_41 -> tp_allreduce
	hopb -> ffn_up_42 [lhead=cluster_ffn]
	hopb -> ffn_gate_42
	ffn_up_42 -> ffn_down_42
	ffn_gate_42 -> ffn_down_42
	ffn_down_42 -> tp_allreduce
	hopb -> ffn_up_43 [lhead=cluster_ffn]
	hopb -> ffn_gate_43
	ffn_up_43 -> ffn_down_43
	ffn_gate_43 -> ffn_down_43
	ffn_down_43 -> tp_allreduce
	hopb -> ffn_up_44 [lhead=cluster_ffn]
	hopb -> ffn_gate_44
	ffn_up_44 -> ffn_down_44
	ffn_gate_44 -> ffn_down_44
	ffn_down_44 -> tp_allreduce
	hopb -> ffn_up_45 [lhead=cluster_ffn]
	hopb -> ffn_gate_45
	ffn_up_45 -> ffn_down_45
	ffn_gate_45 -> ffn_down_45
	ffn_down_45 -> tp_allreduce
	hopb -> ffn_up_46 [lhead=cluster_ffn]
	hopb -> ffn_gate_46
	ffn_up_46 -> ffn_down_46
	ffn_gate_46 -> ffn_down_46
	ffn_down_46 -> tp_allreduce
	hopb -> ffn_up_47 [lhead=cluster_ffn]
	hopb -> ffn_gate_47
	ffn_up_47 -> ffn_down_47
	ffn_gate_47 -> ffn_down_47
	ffn_down_47 -> tp_allreduce
	hopb -> ffn_up_48 [lhead=cluster_ffn]
	hopb -> ffn_gate_48
	ffn_up_48 -> ffn_down_48
	ffn_gate_48 -> ffn_down_48
	ffn_down_48 -> tp_allreduce
	hopb -> ffn_up_49 [lhead=cluster_ffn]
	hopb -> ffn_gate_49
	ffn_up_49 -> ffn_down_49
	ffn_gate_49 -> ffn_down_49
	ffn_down_49 -> tp_allreduce
	hopb -> ffn_up_50 [lhead=cluster_ffn]
	hopb -> ffn_gate_50
	ffn_up_50 -> ffn_down_50
	ffn_gate_50 -> ffn_down_50
	ffn_down_50 -> tp_allreduce
	hopb -> ffn_up_51 [lhead=cluster_ffn]
	hopb -> ffn_gate_51
	ffn_up_51 -> ffn_down_51
	ffn_gate_51 -> ffn_down_51
	ffn_down_51 -> tp_allreduce
	hopb -> ffn_up_52 [lhead=cluster_ffn]
	hopb -> ffn_gate_52
	ffn_up_52 -> ffn_down_52
	ffn_gate_52 -> ffn_down_52
	ffn_down_52 -> tp_allreduce
	hopb -> ffn_up_53 [lhead=cluster_ffn]
	hopb -> ffn_gate_53
	ffn_up_53 -> ffn_down_53
	ffn_gate_53 -> ffn_down_53
	ffn_down_53 -> tp_allreduce
	hopb -> ffn_up_54 [lhead=cluster_ffn]
	hopb -> ffn_gate_54
	ffn_up_54 -> ffn_down_54
	ffn_gate_54 -> ffn_down_54
	ffn_down_54 -> tp_allreduce
	hopb -> ffn_up_55 [lhead=cluster_ffn]
	hopb -> ffn_gate_55
	ffn_up_55 -> ffn_down_55
	ffn_gate_55 -> ffn_down_55
	ffn_down_55 -> tp_allreduce
	hopb -> ffn_up_56 [lhead=cluster_ffn]
	hopb -> ffn_gate_56
	ffn_up_56 -> ffn_down_56
	ffn_gate_56 -> ffn_down_56
	ffn_down_56 -> tp_allreduce
	hopb -> ffn_up_57 [lhead=cluster_ffn]
	hopb -> ffn_gate_57
	ffn_up_57 -> ffn_down_57
	ffn_gate_57 -> ffn_down_57
	ffn_down_57 -> tp_allreduce
	hopb -> ffn_up_58 [lhead=cluster_ffn]
	hopb -> ffn_gate_58
	ffn_up_58 -> ffn_down_58
	ffn_gate_58 -> ffn_down_58
	ffn_down_58 -> tp_allreduce
	hopb -> ffn_up_59 [lhead=cluster_ffn]
	hopb -> ffn_gate_59
	ffn_up_59 -> ffn_down_59
	ffn_gate_59 -> ffn_down_59
	ffn_down_59 -> tp_allreduce
	hopb -> ffn_up_60 [lhead=cluster_ffn]
	hopb -> ffn_gate_60
	ffn_up_60 -> ffn_down_60
	ffn_gate_60 -> ffn_down_60
	ffn_down_60 -> tp_allreduce
	hopb -> ffn_up_61 [lhead=cluster_ffn]
	hopb -> ffn_gate_61
	ffn_up_61 -> ffn_down_61
	ffn_gate_61 -> ffn_down_61
	ffn_down_61 -> tp_allreduce
	hopb -> ffn_up_62 [lhead=cluster_ffn]
	hopb -> ffn_gate_62
	ffn_up_62 -> ffn_down_62
	ffn_gate_62 -> ffn_down_62
	ffn_down_62 -> tp_allreduce
	hopb -> ffn_up_63 [lhead=cluster_ffn]
	hopb -> ffn_gate_63
	ffn_up_63 -> ffn_down_63
	ffn_gate_63 -> ffn_down_63
	ffn_down_63 -> tp_allreduce
	tp_allreduce -> output
}
