<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Llama_405B_TP_Baseline Pages: 1 -->
<svg width="1080pt" height="316pt"
 viewBox="0.00 0.00 1080.00 316.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.34 0.34) rotate(0) translate(4 930)">
<title>Llama_405B_TP_Baseline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-930 3186,-930 3186,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attention</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="800,-435 800,-860 2382,-860 2382,-435 800,-435"/>
<text text-anchor="middle" x="1591" y="-844.8" font-family="Times,serif" font-size="14.00">Attention Phase (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ffn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-86 8,-427 3174,-427 3174,-86 8,-86"/>
<text text-anchor="middle" x="1591" y="-411.8" font-family="Times,serif" font-size="14.00">FFN Phase (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="1591" cy="-897" rx="170.02" ry="29"/>
<text text-anchor="middle" x="1591" y="-900" font-family="Times,serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="1591" y="-889" font-family="Times,serif" font-size="10.00">Input: [batch_size=B, seq_len=1, hidden_dim=16384]</text>
</g>
<!-- qkv_0 -->
<g id="node2" class="node">
<title>qkv_0</title>
<polygon fill="lightyellow" stroke="black" points="2374,-829 2194,-829 2194,-771 2374,-771 2374,-829"/>
<text text-anchor="middle" x="2284" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2284" y="-803" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2284" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2284" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;qkv_0</title>
<path fill="none" stroke="black" d="M1760.76,-894.6C1907.84,-891.77 2108.67,-883.53 2185,-860 2203.39,-854.33 2221.94,-844.59 2237.93,-834.64"/>
<polygon fill="black" stroke="black" points="2240.01,-837.47 2246.53,-829.12 2236.23,-831.58 2240.01,-837.47"/>
</g>
<!-- qkv_1 -->
<g id="node3" class="node">
<title>qkv_1</title>
<polygon fill="lightyellow" stroke="black" points="2176,-829 1996,-829 1996,-771 2176,-771 2176,-829"/>
<text text-anchor="middle" x="2086" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2086" y="-803" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2086" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2086" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_1 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;qkv_1</title>
<path fill="none" stroke="black" d="M1753.6,-888.48C1843.07,-882.91 1944.36,-873.85 1987,-860 2005.14,-854.11 2023.5,-844.42 2039.4,-834.58"/>
<polygon fill="black" stroke="black" points="2041.42,-837.45 2047.97,-829.12 2037.65,-831.55 2041.42,-837.45"/>
</g>
<!-- qkv_2 -->
<g id="node4" class="node">
<title>qkv_2</title>
<polygon fill="lightyellow" stroke="black" points="1978,-829 1798,-829 1798,-771 1978,-771 1978,-829"/>
<text text-anchor="middle" x="1888" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1888" y="-803" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1888" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1888" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_2 -->
<g id="edge19" class="edge">
<title>input&#45;&gt;qkv_2</title>
<path fill="none" stroke="black" d="M1723.26,-878.76C1745.57,-873.93 1768.23,-867.79 1789,-860 1806.23,-853.54 1823.85,-844.11 1839.37,-834.68"/>
<polygon fill="black" stroke="black" points="1841.6,-837.41 1848.24,-829.14 1837.9,-831.47 1841.6,-837.41"/>
</g>
<!-- qkv_3 -->
<g id="node5" class="node">
<title>qkv_3</title>
<polygon fill="lightyellow" stroke="black" points="1780,-829 1600,-829 1600,-771 1780,-771 1780,-829"/>
<text text-anchor="middle" x="1690" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1690" y="-803" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1690" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_3 -->
<g id="edge28" class="edge">
<title>input&#45;&gt;qkv_3</title>
<path fill="none" stroke="black" d="M1619.9,-868.27C1630.29,-858.3 1642.15,-846.92 1653.12,-836.39"/>
<polygon fill="black" stroke="black" points="1655.76,-838.71 1660.55,-829.26 1650.91,-833.66 1655.76,-838.71"/>
</g>
<!-- qkv_4 -->
<g id="node6" class="node">
<title>qkv_4</title>
<polygon fill="lightyellow" stroke="black" points="1582,-829 1402,-829 1402,-771 1582,-771 1582,-829"/>
<text text-anchor="middle" x="1492" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1492" y="-803" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1492" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1492" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_4 -->
<g id="edge37" class="edge">
<title>input&#45;&gt;qkv_4</title>
<path fill="none" stroke="black" d="M1562.1,-868.27C1551.71,-858.3 1539.85,-846.92 1528.88,-836.39"/>
<polygon fill="black" stroke="black" points="1531.09,-833.66 1521.45,-829.26 1526.24,-838.71 1531.09,-833.66"/>
</g>
<!-- qkv_5 -->
<g id="node7" class="node">
<title>qkv_5</title>
<polygon fill="lightyellow" stroke="black" points="1384,-829 1204,-829 1204,-771 1384,-771 1384,-829"/>
<text text-anchor="middle" x="1294" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1294" y="-803" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1294" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1294" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_5 -->
<g id="edge46" class="edge">
<title>input&#45;&gt;qkv_5</title>
<path fill="none" stroke="black" d="M1458.74,-878.76C1436.43,-873.93 1413.77,-867.79 1393,-860 1375.77,-853.54 1358.15,-844.11 1342.63,-834.68"/>
<polygon fill="black" stroke="black" points="1344.1,-831.47 1333.76,-829.14 1340.4,-837.41 1344.1,-831.47"/>
</g>
<!-- qkv_6 -->
<g id="node8" class="node">
<title>qkv_6</title>
<polygon fill="lightyellow" stroke="black" points="1186,-829 1006,-829 1006,-771 1186,-771 1186,-829"/>
<text text-anchor="middle" x="1096" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1096" y="-803" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1096" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1096" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_6 -->
<g id="edge55" class="edge">
<title>input&#45;&gt;qkv_6</title>
<path fill="none" stroke="black" d="M1428.4,-888.48C1338.93,-882.91 1237.64,-873.85 1195,-860 1176.86,-854.11 1158.5,-844.42 1142.6,-834.58"/>
<polygon fill="black" stroke="black" points="1144.35,-831.55 1134.03,-829.12 1140.58,-837.45 1144.35,-831.55"/>
</g>
<!-- qkv_7 -->
<g id="node9" class="node">
<title>qkv_7</title>
<polygon fill="lightyellow" stroke="black" points="988,-829 808,-829 808,-771 988,-771 988,-829"/>
<text text-anchor="middle" x="898" y="-814" font-family="Times,serif" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="898" y="-803" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="898" y="-792" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="898" y="-781" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- input&#45;&gt;qkv_7 -->
<g id="edge64" class="edge">
<title>input&#45;&gt;qkv_7</title>
<path fill="none" stroke="black" d="M1421.24,-894.6C1274.16,-891.77 1073.33,-883.53 997,-860 978.61,-854.33 960.06,-844.59 944.07,-834.64"/>
<polygon fill="black" stroke="black" points="945.77,-831.58 935.47,-829.12 941.99,-837.47 945.77,-831.58"/>
</g>
<!-- kv_cache_0 -->
<g id="node10" class="node">
<title>kv_cache_0</title>
<polygon fill="lightgray" stroke="black" points="2374,-735 2194,-735 2194,-677 2374,-677 2374,-735"/>
<text text-anchor="middle" x="2284" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="2284" y="-709" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2284" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="2284" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_0&#45;&gt;kv_cache_0 -->
<g id="edge2" class="edge">
<title>qkv_0&#45;&gt;kv_cache_0</title>
<path fill="none" stroke="black" d="M2284,-770.9C2284,-762.86 2284,-753.95 2284,-745.41"/>
<polygon fill="black" stroke="black" points="2287.5,-745.25 2284,-735.25 2280.5,-745.25 2287.5,-745.25"/>
</g>
<!-- kv_cache_1 -->
<g id="node11" class="node">
<title>kv_cache_1</title>
<polygon fill="lightgray" stroke="black" points="2176,-735 1996,-735 1996,-677 2176,-677 2176,-735"/>
<text text-anchor="middle" x="2086" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="2086" y="-709" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2086" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="2086" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_1&#45;&gt;kv_cache_1 -->
<g id="edge11" class="edge">
<title>qkv_1&#45;&gt;kv_cache_1</title>
<path fill="none" stroke="black" d="M2086,-770.9C2086,-762.86 2086,-753.95 2086,-745.41"/>
<polygon fill="black" stroke="black" points="2089.5,-745.25 2086,-735.25 2082.5,-745.25 2089.5,-745.25"/>
</g>
<!-- kv_cache_2 -->
<g id="node12" class="node">
<title>kv_cache_2</title>
<polygon fill="lightgray" stroke="black" points="1978,-735 1798,-735 1798,-677 1978,-677 1978,-735"/>
<text text-anchor="middle" x="1888" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="1888" y="-709" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1888" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="1888" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_2&#45;&gt;kv_cache_2 -->
<g id="edge20" class="edge">
<title>qkv_2&#45;&gt;kv_cache_2</title>
<path fill="none" stroke="black" d="M1888,-770.9C1888,-762.86 1888,-753.95 1888,-745.41"/>
<polygon fill="black" stroke="black" points="1891.5,-745.25 1888,-735.25 1884.5,-745.25 1891.5,-745.25"/>
</g>
<!-- kv_cache_3 -->
<g id="node13" class="node">
<title>kv_cache_3</title>
<polygon fill="lightgray" stroke="black" points="1780,-735 1600,-735 1600,-677 1780,-677 1780,-735"/>
<text text-anchor="middle" x="1690" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="1690" y="-709" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="1690" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_3&#45;&gt;kv_cache_3 -->
<g id="edge29" class="edge">
<title>qkv_3&#45;&gt;kv_cache_3</title>
<path fill="none" stroke="black" d="M1690,-770.9C1690,-762.86 1690,-753.95 1690,-745.41"/>
<polygon fill="black" stroke="black" points="1693.5,-745.25 1690,-735.25 1686.5,-745.25 1693.5,-745.25"/>
</g>
<!-- kv_cache_4 -->
<g id="node14" class="node">
<title>kv_cache_4</title>
<polygon fill="lightgray" stroke="black" points="1582,-735 1402,-735 1402,-677 1582,-677 1582,-735"/>
<text text-anchor="middle" x="1492" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="1492" y="-709" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1492" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="1492" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_4&#45;&gt;kv_cache_4 -->
<g id="edge38" class="edge">
<title>qkv_4&#45;&gt;kv_cache_4</title>
<path fill="none" stroke="black" d="M1492,-770.9C1492,-762.86 1492,-753.95 1492,-745.41"/>
<polygon fill="black" stroke="black" points="1495.5,-745.25 1492,-735.25 1488.5,-745.25 1495.5,-745.25"/>
</g>
<!-- kv_cache_5 -->
<g id="node15" class="node">
<title>kv_cache_5</title>
<polygon fill="lightgray" stroke="black" points="1384,-735 1204,-735 1204,-677 1384,-677 1384,-735"/>
<text text-anchor="middle" x="1294" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="1294" y="-709" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1294" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="1294" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_5&#45;&gt;kv_cache_5 -->
<g id="edge47" class="edge">
<title>qkv_5&#45;&gt;kv_cache_5</title>
<path fill="none" stroke="black" d="M1294,-770.9C1294,-762.86 1294,-753.95 1294,-745.41"/>
<polygon fill="black" stroke="black" points="1297.5,-745.25 1294,-735.25 1290.5,-745.25 1297.5,-745.25"/>
</g>
<!-- kv_cache_6 -->
<g id="node16" class="node">
<title>kv_cache_6</title>
<polygon fill="lightgray" stroke="black" points="1186,-735 1006,-735 1006,-677 1186,-677 1186,-735"/>
<text text-anchor="middle" x="1096" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="1096" y="-709" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1096" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="1096" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_6&#45;&gt;kv_cache_6 -->
<g id="edge56" class="edge">
<title>qkv_6&#45;&gt;kv_cache_6</title>
<path fill="none" stroke="black" d="M1096,-770.9C1096,-762.86 1096,-753.95 1096,-745.41"/>
<polygon fill="black" stroke="black" points="1099.5,-745.25 1096,-735.25 1092.5,-745.25 1099.5,-745.25"/>
</g>
<!-- kv_cache_7 -->
<g id="node17" class="node">
<title>kv_cache_7</title>
<polygon fill="lightgray" stroke="black" points="988,-735 808,-735 808,-677 988,-677 988,-735"/>
<text text-anchor="middle" x="898" y="-720" font-family="Times,serif" font-size="10.00">KV Cache</text>
<text text-anchor="middle" x="898" y="-709" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="898" y="-698" font-family="Times,serif" font-size="10.00">Full cache: [B, S, 8, 128]</text>
<text text-anchor="middle" x="898" y="-687" font-family="Times,serif" font-size="10.00">(duplicated)</text>
</g>
<!-- qkv_7&#45;&gt;kv_cache_7 -->
<g id="edge65" class="edge">
<title>qkv_7&#45;&gt;kv_cache_7</title>
<path fill="none" stroke="black" d="M898,-770.9C898,-762.86 898,-753.95 898,-745.41"/>
<polygon fill="black" stroke="black" points="901.5,-745.25 898,-735.25 894.5,-745.25 901.5,-745.25"/>
</g>
<!-- attn_0 -->
<g id="node18" class="node">
<title>attn_0</title>
<polygon fill="lightgreen" stroke="black" points="2374,-641 2194,-641 2194,-583 2374,-583 2374,-641"/>
<text text-anchor="middle" x="2284" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2284" y="-615" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2284" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="2284" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_0&#45;&gt;attn_0 -->
<g id="edge3" class="edge">
<title>kv_cache_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M2284,-676.9C2284,-668.86 2284,-659.95 2284,-651.41"/>
<polygon fill="black" stroke="black" points="2287.5,-651.25 2284,-641.25 2280.5,-651.25 2287.5,-651.25"/>
</g>
<!-- attn_1 -->
<g id="node19" class="node">
<title>attn_1</title>
<polygon fill="lightgreen" stroke="black" points="2176,-641 1996,-641 1996,-583 2176,-583 2176,-641"/>
<text text-anchor="middle" x="2086" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2086" y="-615" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2086" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="2086" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_1&#45;&gt;attn_1 -->
<g id="edge12" class="edge">
<title>kv_cache_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M2086,-676.9C2086,-668.86 2086,-659.95 2086,-651.41"/>
<polygon fill="black" stroke="black" points="2089.5,-651.25 2086,-641.25 2082.5,-651.25 2089.5,-651.25"/>
</g>
<!-- attn_2 -->
<g id="node20" class="node">
<title>attn_2</title>
<polygon fill="lightgreen" stroke="black" points="1978,-641 1798,-641 1798,-583 1978,-583 1978,-641"/>
<text text-anchor="middle" x="1888" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1888" y="-615" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1888" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="1888" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_2&#45;&gt;attn_2 -->
<g id="edge21" class="edge">
<title>kv_cache_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M1888,-676.9C1888,-668.86 1888,-659.95 1888,-651.41"/>
<polygon fill="black" stroke="black" points="1891.5,-651.25 1888,-641.25 1884.5,-651.25 1891.5,-651.25"/>
</g>
<!-- attn_3 -->
<g id="node21" class="node">
<title>attn_3</title>
<polygon fill="lightgreen" stroke="black" points="1780,-641 1600,-641 1600,-583 1780,-583 1780,-641"/>
<text text-anchor="middle" x="1690" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1690" y="-615" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="1690" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_3&#45;&gt;attn_3 -->
<g id="edge30" class="edge">
<title>kv_cache_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M1690,-676.9C1690,-668.86 1690,-659.95 1690,-651.41"/>
<polygon fill="black" stroke="black" points="1693.5,-651.25 1690,-641.25 1686.5,-651.25 1693.5,-651.25"/>
</g>
<!-- attn_4 -->
<g id="node22" class="node">
<title>attn_4</title>
<polygon fill="lightgreen" stroke="black" points="1582,-641 1402,-641 1402,-583 1582,-583 1582,-641"/>
<text text-anchor="middle" x="1492" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1492" y="-615" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1492" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="1492" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_4&#45;&gt;attn_4 -->
<g id="edge39" class="edge">
<title>kv_cache_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M1492,-676.9C1492,-668.86 1492,-659.95 1492,-651.41"/>
<polygon fill="black" stroke="black" points="1495.5,-651.25 1492,-641.25 1488.5,-651.25 1495.5,-651.25"/>
</g>
<!-- attn_5 -->
<g id="node23" class="node">
<title>attn_5</title>
<polygon fill="lightgreen" stroke="black" points="1384,-641 1204,-641 1204,-583 1384,-583 1384,-641"/>
<text text-anchor="middle" x="1294" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1294" y="-615" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1294" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="1294" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_5&#45;&gt;attn_5 -->
<g id="edge48" class="edge">
<title>kv_cache_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M1294,-676.9C1294,-668.86 1294,-659.95 1294,-651.41"/>
<polygon fill="black" stroke="black" points="1297.5,-651.25 1294,-641.25 1290.5,-651.25 1297.5,-651.25"/>
</g>
<!-- attn_6 -->
<g id="node24" class="node">
<title>attn_6</title>
<polygon fill="lightgreen" stroke="black" points="1186,-641 1006,-641 1006,-583 1186,-583 1186,-641"/>
<text text-anchor="middle" x="1096" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1096" y="-615" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1096" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="1096" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_6&#45;&gt;attn_6 -->
<g id="edge57" class="edge">
<title>kv_cache_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M1096,-676.9C1096,-668.86 1096,-659.95 1096,-651.41"/>
<polygon fill="black" stroke="black" points="1099.5,-651.25 1096,-641.25 1092.5,-651.25 1099.5,-651.25"/>
</g>
<!-- attn_7 -->
<g id="node25" class="node">
<title>attn_7</title>
<polygon fill="lightgreen" stroke="black" points="988,-641 808,-641 808,-583 988,-583 988,-641"/>
<text text-anchor="middle" x="898" y="-626" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="898" y="-615" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="898" y="-604" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]</text>
<text text-anchor="middle" x="898" y="-593" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16, 128]</text>
</g>
<!-- kv_cache_7&#45;&gt;attn_7 -->
<g id="edge66" class="edge">
<title>kv_cache_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M898,-676.9C898,-668.86 898,-659.95 898,-651.41"/>
<polygon fill="black" stroke="black" points="901.5,-651.25 898,-641.25 894.5,-651.25 901.5,-651.25"/>
</g>
<!-- attn_allreduce -->
<g id="node26" class="node">
<title>attn_allreduce</title>
<polygon fill="gold" stroke="black" points="1729.85,-547 1508.97,-547 1452.15,-443 1673.03,-443 1729.85,-547"/>
<text text-anchor="middle" x="1591" y="-509" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1591" y="-498" font-family="Times,serif" font-size="10.00">TP=8</text>
<text text-anchor="middle" x="1591" y="-487" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16, 128]×8</text>
<text text-anchor="middle" x="1591" y="-476" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16384]</text>
</g>
<!-- attn_0&#45;&gt;attn_allreduce -->
<g id="edge4" class="edge">
<title>attn_0&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M2193.75,-584.95C2190.8,-584.27 2187.88,-583.62 2185,-583 2025.89,-549 1839.94,-524.11 1719.06,-509.87"/>
<polygon fill="black" stroke="black" points="1719.36,-506.38 1709.02,-508.69 1718.54,-513.33 1719.36,-506.38"/>
</g>
<!-- attn_1&#45;&gt;attn_allreduce -->
<g id="edge13" class="edge">
<title>attn_1&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1995.95,-585.29C1992.94,-584.5 1989.95,-583.74 1987,-583 1900.75,-561.35 1803.2,-539.88 1726.49,-523.69"/>
<polygon fill="black" stroke="black" points="1726.8,-520.18 1716.29,-521.54 1725.36,-527.02 1726.8,-520.18"/>
</g>
<!-- attn_2&#45;&gt;attn_allreduce -->
<g id="edge22" class="edge">
<title>attn_2&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1815.35,-582.87C1790.16,-573.12 1761.01,-561.83 1732.21,-550.68"/>
<polygon fill="black" stroke="black" points="1733.47,-547.41 1722.88,-547.07 1730.95,-553.94 1733.47,-547.41"/>
</g>
<!-- attn_3&#45;&gt;attn_allreduce -->
<g id="edge31" class="edge">
<title>attn_3&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1665.78,-582.87C1658.46,-574.37 1650.14,-564.7 1641.77,-554.97"/>
<polygon fill="black" stroke="black" points="1644.24,-552.47 1635.06,-547.18 1638.93,-557.04 1644.24,-552.47"/>
</g>
<!-- attn_4&#45;&gt;attn_allreduce -->
<g id="edge40" class="edge">
<title>attn_4&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1516.22,-582.87C1523.54,-574.37 1531.86,-564.7 1540.23,-554.97"/>
<polygon fill="black" stroke="black" points="1543.07,-557.04 1546.94,-547.18 1537.76,-552.47 1543.07,-557.04"/>
</g>
<!-- attn_5&#45;&gt;attn_allreduce -->
<g id="edge49" class="edge">
<title>attn_5&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1366.65,-582.87C1404.02,-568.4 1450.13,-550.55 1490.82,-534.79"/>
<polygon fill="black" stroke="black" points="1492.16,-538.03 1500.22,-531.15 1489.63,-531.5 1492.16,-538.03"/>
</g>
<!-- attn_6&#45;&gt;attn_allreduce -->
<g id="edge58" class="edge">
<title>attn_6&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M1186.05,-585.29C1189.06,-584.5 1192.05,-583.74 1195,-583 1291.41,-558.8 1401.95,-534.83 1481.69,-518.19"/>
<polygon fill="black" stroke="black" points="1482.68,-521.56 1491.75,-516.1 1481.25,-514.71 1482.68,-521.56"/>
</g>
<!-- attn_7&#45;&gt;attn_allreduce -->
<g id="edge67" class="edge">
<title>attn_7&#45;&gt;attn_allreduce</title>
<path fill="none" stroke="black" d="M988.25,-584.95C991.2,-584.27 994.12,-583.62 997,-583 1162.43,-547.65 1356.87,-522.15 1477.03,-508.22"/>
<polygon fill="black" stroke="black" points="1477.45,-511.7 1486.99,-507.08 1476.65,-504.74 1477.45,-511.7"/>
</g>
<!-- ffn_up_0 -->
<g id="node27" class="node">
<title>ffn_up_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3166,-396 2986,-396 2986,-333 3166,-333 3166,-396"/>
<text text-anchor="middle" x="3076" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="3076" y="-373" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="3076" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="3076" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="3076" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_0 -->
<g id="edge5" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_0</title>
<path fill="none" stroke="black" d="M1699.92,-491.88C1998.36,-485.64 2816.98,-465.5 2967.35,-429.61"/>
<polygon fill="black" stroke="black" points="2968.26,-432.99 2977,-427 2966.43,-426.23 2968.26,-432.99"/>
</g>
<!-- ffn_gate_0 -->
<g id="node28" class="node">
<title>ffn_gate_0</title>
<polygon fill="lightsteelblue" stroke="black" points="2968,-396 2788,-396 2788,-333 2968,-333 2968,-396"/>
<text text-anchor="middle" x="2878" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="2878" y="-373" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2878" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2878" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="2878" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_0 -->
<g id="edge6" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_0</title>
<path fill="none" stroke="black" d="M1701.67,-494.71C1956.94,-495.23 2580.3,-489.8 2779,-427 2796.91,-421.34 2814.84,-411.7 2830.43,-401.71"/>
<polygon fill="black" stroke="black" points="2832.43,-404.59 2838.84,-396.15 2828.57,-398.75 2832.43,-404.59"/>
</g>
<!-- ffn_up_1 -->
<g id="node30" class="node">
<title>ffn_up_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2770,-396 2590,-396 2590,-333 2770,-333 2770,-396"/>
<text text-anchor="middle" x="2680" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="2680" y="-373" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2680" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2680" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="2680" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_1 -->
<g id="edge14" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M1700.9,-493.23C1919.12,-490.64 2400.71,-479.33 2571.19,-429.99"/>
<polygon fill="black" stroke="black" points="2572.46,-433.27 2581,-427 2570.41,-426.57 2572.46,-433.27"/>
</g>
<!-- ffn_gate_1 -->
<g id="node31" class="node">
<title>ffn_gate_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2572,-396 2392,-396 2392,-333 2572,-333 2572,-396"/>
<text text-anchor="middle" x="2482" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="2482" y="-373" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2482" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2482" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="2482" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_1 -->
<g id="edge15" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_1</title>
<path fill="none" stroke="black" d="M1699.55,-491.08C1886.03,-485.02 2259.14,-468.06 2383,-427 2400.66,-421.14 2418.41,-411.56 2433.91,-401.68"/>
<polygon fill="black" stroke="black" points="2435.83,-404.6 2442.27,-396.18 2431.99,-398.75 2435.83,-404.6"/>
</g>
<!-- ffn_up_2 -->
<g id="node33" class="node">
<title>ffn_up_2</title>
<polygon fill="lightsteelblue" stroke="black" points="2374,-396 2194,-396 2194,-333 2374,-333 2374,-396"/>
<text text-anchor="middle" x="2284" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="2284" y="-373" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2284" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2284" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="2284" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_2 -->
<g id="edge23" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M1697.6,-487.63C1838.6,-478.27 2080.32,-458.75 2175.46,-430.08"/>
<polygon fill="black" stroke="black" points="2176.56,-433.4 2185,-427 2174.41,-426.74 2176.56,-433.4"/>
</g>
<!-- ffn_gate_2 -->
<g id="node34" class="node">
<title>ffn_gate_2</title>
<polygon fill="lightsteelblue" stroke="black" points="2176,-396 1996,-396 1996,-333 2176,-333 2176,-396"/>
<text text-anchor="middle" x="2086" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="2086" y="-373" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2086" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="2086" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="2086" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_2 -->
<g id="edge24" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_2</title>
<path fill="none" stroke="black" d="M1697.3,-487.23C1778.74,-479.41 1892.76,-462.66 1987,-427 2003.77,-420.65 2020.79,-411.33 2035.88,-401.86"/>
<polygon fill="black" stroke="black" points="2038.02,-404.64 2044.52,-396.28 2034.22,-398.76 2038.02,-404.64"/>
</g>
<!-- ffn_up_3 -->
<g id="node36" class="node">
<title>ffn_up_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1978,-396 1798,-396 1798,-333 1978,-333 1978,-396"/>
<text text-anchor="middle" x="1888" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="1888" y="-373" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1888" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1888" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="1888" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_3 -->
<g id="edge32" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M1686.16,-466.7C1716.24,-456.91 1749.51,-444.89 1779.73,-431.28"/>
<polygon fill="black" stroke="black" points="1781.38,-434.37 1789,-427 1778.45,-428.01 1781.38,-434.37"/>
</g>
<!-- ffn_gate_3 -->
<g id="node37" class="node">
<title>ffn_gate_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1780,-396 1600,-396 1600,-333 1780,-333 1780,-396"/>
<text text-anchor="middle" x="1690" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1690" y="-373" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1690" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="1690" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_3 -->
<g id="edge33" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_3</title>
<path fill="none" stroke="black" d="M1630.41,-442.84C1640.31,-429.99 1650.78,-416.41 1660.13,-404.28"/>
<polygon fill="black" stroke="black" points="1663.07,-406.19 1666.4,-396.13 1657.52,-401.92 1663.07,-406.19"/>
</g>
<!-- ffn_up_4 -->
<g id="node39" class="node">
<title>ffn_up_4</title>
<polygon fill="lightsteelblue" stroke="black" points="1582,-396 1402,-396 1402,-333 1582,-333 1582,-396"/>
<text text-anchor="middle" x="1492" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="1492" y="-373" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1492" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1492" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="1492" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_4 -->
<g id="edge41" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M1551.59,-442.84C1549.58,-440.24 1547.55,-437.6 1545.51,-434.96"/>
<polygon fill="black" stroke="black" points="1548.26,-432.78 1539.38,-427 1542.71,-437.06 1548.26,-432.78"/>
</g>
<!-- ffn_gate_4 -->
<g id="node40" class="node">
<title>ffn_gate_4</title>
<polygon fill="lightsteelblue" stroke="black" points="1384,-396 1204,-396 1204,-333 1384,-333 1384,-396"/>
<text text-anchor="middle" x="1294" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1294" y="-373" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1294" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1294" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="1294" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_4 -->
<g id="edge42" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_4</title>
<path fill="none" stroke="black" d="M1457.8,-453.63C1435.81,-445.63 1413.51,-436.68 1393,-427 1377.7,-419.77 1361.82,-410.71 1347.39,-401.77"/>
<polygon fill="black" stroke="black" points="1348.93,-398.61 1338.61,-396.24 1345.2,-404.53 1348.93,-398.61"/>
</g>
<!-- ffn_up_5 -->
<g id="node42" class="node">
<title>ffn_up_5</title>
<polygon fill="lightsteelblue" stroke="black" points="1186,-396 1006,-396 1006,-333 1186,-333 1186,-396"/>
<text text-anchor="middle" x="1096" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="1096" y="-373" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1096" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1096" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="1096" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_5 -->
<g id="edge50" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M1475.7,-486.35C1397.83,-478.45 1293.45,-462.53 1204.64,-430.56"/>
<polygon fill="black" stroke="black" points="1205.59,-427.18 1195,-427 1203.17,-433.75 1205.59,-427.18"/>
</g>
<!-- ffn_gate_5 -->
<g id="node43" class="node">
<title>ffn_gate_5</title>
<polygon fill="lightsteelblue" stroke="black" points="988,-396 808,-396 808,-333 988,-333 988,-396"/>
<text text-anchor="middle" x="898" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="898" y="-373" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="898" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="898" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="898" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_5 -->
<g id="edge51" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_5</title>
<path fill="none" stroke="black" d="M1476,-487.07C1328.86,-477.15 1082.79,-456.78 997,-427 979.74,-421.01 962.34,-411.6 947.05,-401.92"/>
<polygon fill="black" stroke="black" points="948.6,-398.75 938.31,-396.21 944.77,-404.61 948.6,-398.75"/>
</g>
<!-- ffn_up_6 -->
<g id="node45" class="node">
<title>ffn_up_6</title>
<polygon fill="lightsteelblue" stroke="black" points="790,-396 610,-396 610,-333 790,-333 790,-396"/>
<text text-anchor="middle" x="700" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="700" y="-373" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="700" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="700" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="700" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_6 -->
<g id="edge59" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M1477.98,-490.93C1294.84,-484.91 940.46,-468.59 808.83,-430.06"/>
<polygon fill="black" stroke="black" points="809.59,-426.63 799,-427 807.51,-433.31 809.59,-426.63"/>
</g>
<!-- ffn_gate_6 -->
<g id="node46" class="node">
<title>ffn_gate_6</title>
<polygon fill="lightsteelblue" stroke="black" points="592,-396 412,-396 412,-333 592,-333 592,-396"/>
<text text-anchor="middle" x="502" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="502" y="-373" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="502" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="502" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="502" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_6 -->
<g id="edge60" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_6</title>
<path fill="none" stroke="black" d="M1479.4,-493.21C1256.01,-490.53 761.58,-478.74 601,-427 583.13,-421.24 565.2,-411.57 549.61,-401.59"/>
<polygon fill="black" stroke="black" points="551.47,-398.63 541.2,-396.03 547.61,-404.47 551.47,-398.63"/>
</g>
<!-- ffn_up_7 -->
<g id="node48" class="node">
<title>ffn_up_7</title>
<polygon fill="lightsteelblue" stroke="black" points="394,-396 214,-396 214,-333 394,-333 394,-396"/>
<text text-anchor="middle" x="304" y="-384" font-family="Times,serif" font-size="10.00">FFN UP</text>
<text text-anchor="middle" x="304" y="-373" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="304" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="304" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="304" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_up_7 -->
<g id="edge68" class="edge">
<title>attn_allreduce&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M1480.33,-494.71C1229.05,-495.22 621.09,-489.96 412.62,-429.9"/>
<polygon fill="black" stroke="black" points="413.58,-426.54 403,-427 411.56,-433.24 413.58,-426.54"/>
</g>
<!-- ffn_gate_7 -->
<g id="node49" class="node">
<title>ffn_gate_7</title>
<polygon fill="lightsteelblue" stroke="black" points="196,-396 16,-396 16,-333 196,-333 196,-396"/>
<text text-anchor="middle" x="106" y="-384" font-family="Times,serif" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="106" y="-373" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="106" y="-362" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="106" y="-351" font-family="Times,serif" font-size="10.00">Weights: [16384, 8192]</text>
<text text-anchor="middle" x="106" y="-340" font-family="Times,serif" font-size="10.00">Output: [B, 1, 8192]</text>
</g>
<!-- attn_allreduce&#45;&gt;ffn_gate_7 -->
<g id="edge69" class="edge">
<title>attn_allreduce&#45;&gt;ffn_gate_7</title>
<path fill="none" stroke="black" d="M1478.77,-491.81C1170.39,-485.34 324.99,-464.39 205,-427 187.07,-421.41 169.13,-411.79 153.54,-401.8"/>
<polygon fill="black" stroke="black" points="155.41,-398.84 145.14,-396.23 151.54,-404.67 155.41,-398.84"/>
</g>
<!-- ffn_down_0 -->
<g id="node29" class="node">
<title>ffn_down_0</title>
<polygon fill="lightsteelblue" stroke="black" points="2968,-297 2788,-297 2788,-234 2968,-234 2968,-297"/>
<text text-anchor="middle" x="2878" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="2878" y="-274" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2878" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="2878" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="2878" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_0&#45;&gt;ffn_down_0 -->
<g id="edge7" class="edge">
<title>ffn_up_0&#45;&gt;ffn_down_0</title>
<path fill="none" stroke="black" d="M3013.62,-332.94C2993.28,-322.98 2970.54,-311.84 2949.58,-301.57"/>
<polygon fill="black" stroke="black" points="2950.92,-298.33 2940.4,-297.07 2947.84,-304.61 2950.92,-298.33"/>
</g>
<!-- ffn_gate_0&#45;&gt;ffn_down_0 -->
<g id="edge8" class="edge">
<title>ffn_gate_0&#45;&gt;ffn_down_0</title>
<path fill="none" stroke="black" d="M2878,-332.81C2878,-324.76 2878,-315.95 2878,-307.46"/>
<polygon fill="black" stroke="black" points="2881.5,-307.32 2878,-297.32 2874.5,-307.32 2881.5,-307.32"/>
</g>
<!-- tp_allreduce -->
<g id="node51" class="node">
<title>tp_allreduce</title>
<polygon fill="gold" stroke="black" points="1717.47,-198 1516.29,-198 1464.53,-94 1665.71,-94 1717.47,-198"/>
<text text-anchor="middle" x="1591" y="-160" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1591" y="-149" font-family="Times,serif" font-size="10.00">TP=8</text>
<text text-anchor="middle" x="1591" y="-138" font-family="Times,serif" font-size="10.00">Input: [B, 1, 2048]×8</text>
<text text-anchor="middle" x="1591" y="-127" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16384]</text>
</g>
<!-- ffn_down_0&#45;&gt;tp_allreduce -->
<g id="edge9" class="edge">
<title>ffn_down_0&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M2787.7,-254.88C2728.86,-248.7 2650.4,-240.61 2581,-234 2264.77,-203.87 1891.34,-172.08 1706.55,-156.6"/>
<polygon fill="black" stroke="black" points="1706.8,-153.11 1696.54,-155.76 1706.21,-160.08 1706.8,-153.11"/>
</g>
<!-- ffn_down_1 -->
<g id="node32" class="node">
<title>ffn_down_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2572,-297 2392,-297 2392,-234 2572,-234 2572,-297"/>
<text text-anchor="middle" x="2482" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="2482" y="-274" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2482" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="2482" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="2482" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_down_1 -->
<g id="edge16" class="edge">
<title>ffn_up_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M2617.62,-332.94C2597.28,-322.98 2574.54,-311.84 2553.58,-301.57"/>
<polygon fill="black" stroke="black" points="2554.92,-298.33 2544.4,-297.07 2551.84,-304.61 2554.92,-298.33"/>
</g>
<!-- ffn_gate_1&#45;&gt;ffn_down_1 -->
<g id="edge17" class="edge">
<title>ffn_gate_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M2482,-332.81C2482,-324.76 2482,-315.95 2482,-307.46"/>
<polygon fill="black" stroke="black" points="2485.5,-307.32 2482,-297.32 2478.5,-307.32 2485.5,-307.32"/>
</g>
<!-- ffn_down_1&#45;&gt;tp_allreduce -->
<g id="edge18" class="edge">
<title>ffn_down_1&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M2391.66,-252.59C2229.7,-231.23 1890.03,-186.43 1709.57,-162.64"/>
<polygon fill="black" stroke="black" points="1709.88,-159.15 1699.51,-161.31 1708.96,-166.09 1709.88,-159.15"/>
</g>
<!-- ffn_down_2 -->
<g id="node35" class="node">
<title>ffn_down_2</title>
<polygon fill="lightsteelblue" stroke="black" points="2176,-297 1996,-297 1996,-234 2176,-234 2176,-297"/>
<text text-anchor="middle" x="2086" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="2086" y="-274" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2086" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="2086" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="2086" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_down_2 -->
<g id="edge25" class="edge">
<title>ffn_up_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M2221.62,-332.94C2201.28,-322.98 2178.54,-311.84 2157.58,-301.57"/>
<polygon fill="black" stroke="black" points="2158.92,-298.33 2148.4,-297.07 2155.84,-304.61 2158.92,-298.33"/>
</g>
<!-- ffn_gate_2&#45;&gt;ffn_down_2 -->
<g id="edge26" class="edge">
<title>ffn_gate_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M2086,-332.81C2086,-324.76 2086,-315.95 2086,-307.46"/>
<polygon fill="black" stroke="black" points="2089.5,-307.32 2086,-297.32 2082.5,-307.32 2089.5,-307.32"/>
</g>
<!-- ffn_down_2&#45;&gt;tp_allreduce -->
<g id="edge27" class="edge">
<title>ffn_down_2&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M1995.78,-243.09C1917.38,-224.47 1803.02,-197.33 1715.84,-176.63"/>
<polygon fill="black" stroke="black" points="1716.42,-173.17 1705.88,-174.27 1714.8,-179.98 1716.42,-173.17"/>
</g>
<!-- ffn_down_3 -->
<g id="node38" class="node">
<title>ffn_down_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1780,-297 1600,-297 1600,-234 1780,-234 1780,-297"/>
<text text-anchor="middle" x="1690" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1690" y="-274" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="1690" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="1690" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_down_3 -->
<g id="edge34" class="edge">
<title>ffn_up_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M1825.62,-332.94C1805.28,-322.98 1782.54,-311.84 1761.58,-301.57"/>
<polygon fill="black" stroke="black" points="1762.92,-298.33 1752.4,-297.07 1759.84,-304.61 1762.92,-298.33"/>
</g>
<!-- ffn_gate_3&#45;&gt;ffn_down_3 -->
<g id="edge35" class="edge">
<title>ffn_gate_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M1690,-332.81C1690,-324.76 1690,-315.95 1690,-307.46"/>
<polygon fill="black" stroke="black" points="1693.5,-307.32 1690,-297.32 1686.5,-307.32 1693.5,-307.32"/>
</g>
<!-- ffn_down_3&#45;&gt;tp_allreduce -->
<g id="edge36" class="edge">
<title>ffn_down_3&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M1664.25,-233.93C1657.01,-225.35 1648.89,-215.71 1640.77,-206.07"/>
<polygon fill="black" stroke="black" points="1643.38,-203.74 1634.26,-198.34 1638.03,-208.25 1643.38,-203.74"/>
</g>
<!-- ffn_down_4 -->
<g id="node41" class="node">
<title>ffn_down_4</title>
<polygon fill="lightsteelblue" stroke="black" points="1582,-297 1402,-297 1402,-234 1582,-234 1582,-297"/>
<text text-anchor="middle" x="1492" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1492" y="-274" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1492" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="1492" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="1492" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_down_4 -->
<g id="edge43" class="edge">
<title>ffn_up_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M1492,-332.81C1492,-324.76 1492,-315.95 1492,-307.46"/>
<polygon fill="black" stroke="black" points="1495.5,-307.32 1492,-297.32 1488.5,-307.32 1495.5,-307.32"/>
</g>
<!-- ffn_gate_4&#45;&gt;ffn_down_4 -->
<g id="edge44" class="edge">
<title>ffn_gate_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M1356.38,-332.94C1376.72,-322.98 1399.46,-311.84 1420.42,-301.57"/>
<polygon fill="black" stroke="black" points="1422.16,-304.61 1429.6,-297.07 1419.08,-298.33 1422.16,-304.61"/>
</g>
<!-- ffn_down_4&#45;&gt;tp_allreduce -->
<g id="edge45" class="edge">
<title>ffn_down_4&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M1517.75,-233.93C1524.99,-225.35 1533.11,-215.71 1541.23,-206.07"/>
<polygon fill="black" stroke="black" points="1543.97,-208.25 1547.74,-198.34 1538.62,-203.74 1543.97,-208.25"/>
</g>
<!-- ffn_down_5 -->
<g id="node44" class="node">
<title>ffn_down_5</title>
<polygon fill="lightsteelblue" stroke="black" points="1186,-297 1006,-297 1006,-234 1186,-234 1186,-297"/>
<text text-anchor="middle" x="1096" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1096" y="-274" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1096" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="1096" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="1096" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_down_5 -->
<g id="edge52" class="edge">
<title>ffn_up_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M1096,-332.81C1096,-324.76 1096,-315.95 1096,-307.46"/>
<polygon fill="black" stroke="black" points="1099.5,-307.32 1096,-297.32 1092.5,-307.32 1099.5,-307.32"/>
</g>
<!-- ffn_gate_5&#45;&gt;ffn_down_5 -->
<g id="edge53" class="edge">
<title>ffn_gate_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M960.38,-332.94C980.72,-322.98 1003.46,-311.84 1024.42,-301.57"/>
<polygon fill="black" stroke="black" points="1026.16,-304.61 1033.6,-297.07 1023.08,-298.33 1026.16,-304.61"/>
</g>
<!-- ffn_down_5&#45;&gt;tp_allreduce -->
<g id="edge54" class="edge">
<title>ffn_down_5&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M1186.22,-243.09C1272.49,-222.6 1402.31,-191.79 1491.55,-170.61"/>
<polygon fill="black" stroke="black" points="1492.48,-173.98 1501.41,-168.27 1490.87,-167.17 1492.48,-173.98"/>
</g>
<!-- ffn_down_6 -->
<g id="node47" class="node">
<title>ffn_down_6</title>
<polygon fill="lightsteelblue" stroke="black" points="790,-297 610,-297 610,-234 790,-234 790,-297"/>
<text text-anchor="middle" x="700" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="700" y="-274" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="700" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="700" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="700" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_down_6 -->
<g id="edge61" class="edge">
<title>ffn_up_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M700,-332.81C700,-324.76 700,-315.95 700,-307.46"/>
<polygon fill="black" stroke="black" points="703.5,-307.32 700,-297.32 696.5,-307.32 703.5,-307.32"/>
</g>
<!-- ffn_gate_6&#45;&gt;ffn_down_6 -->
<g id="edge62" class="edge">
<title>ffn_gate_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M564.38,-332.94C584.72,-322.98 607.46,-311.84 628.42,-301.57"/>
<polygon fill="black" stroke="black" points="630.16,-304.61 637.6,-297.07 627.08,-298.33 630.16,-304.61"/>
</g>
<!-- ffn_down_6&#45;&gt;tp_allreduce -->
<g id="edge63" class="edge">
<title>ffn_down_6&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M790.34,-252.59C956.67,-230.65 1310.42,-184 1486.68,-160.76"/>
<polygon fill="black" stroke="black" points="1487.28,-164.21 1496.74,-159.43 1486.37,-157.27 1487.28,-164.21"/>
</g>
<!-- ffn_down_7 -->
<g id="node50" class="node">
<title>ffn_down_7</title>
<polygon fill="lightsteelblue" stroke="black" points="394,-297 214,-297 214,-234 394,-234 394,-297"/>
<text text-anchor="middle" x="304" y="-285" font-family="Times,serif" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="304" y="-274" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="304" y="-263" font-family="Times,serif" font-size="10.00">Input: [B, 1, 8192]</text>
<text text-anchor="middle" x="304" y="-252" font-family="Times,serif" font-size="10.00">Weights: [8192, 2048]</text>
<text text-anchor="middle" x="304" y="-241" font-family="Times,serif" font-size="10.00">Output: [B, 1, 2048]</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_down_7 -->
<g id="edge70" class="edge">
<title>ffn_up_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M304,-332.81C304,-324.76 304,-315.95 304,-307.46"/>
<polygon fill="black" stroke="black" points="307.5,-307.32 304,-297.32 300.5,-307.32 307.5,-307.32"/>
</g>
<!-- ffn_gate_7&#45;&gt;ffn_down_7 -->
<g id="edge71" class="edge">
<title>ffn_gate_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M168.38,-332.94C188.72,-322.98 211.46,-311.84 232.42,-301.57"/>
<polygon fill="black" stroke="black" points="234.16,-304.61 241.6,-297.07 231.08,-298.33 234.16,-304.61"/>
</g>
<!-- ffn_down_7&#45;&gt;tp_allreduce -->
<g id="edge72" class="edge">
<title>ffn_down_7&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" d="M394.3,-254.88C453.14,-248.7 531.6,-240.61 601,-234 922.55,-203.36 1303.25,-171.01 1484.62,-155.83"/>
<polygon fill="black" stroke="black" points="1485.02,-159.31 1494.69,-154.99 1484.44,-152.34 1485.02,-159.31"/>
</g>
<!-- output -->
<g id="node52" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="1591" cy="-29" rx="90" ry="29"/>
<text text-anchor="middle" x="1591" y="-37.5" font-family="Times,serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="1591" y="-26.5" font-family="Times,serif" font-size="10.00">Input: [B, 1, 16384]</text>
<text text-anchor="middle" x="1591" y="-15.5" font-family="Times,serif" font-size="10.00">Output: [B, 1, 16384]</text>
</g>
<!-- tp_allreduce&#45;&gt;output -->
<g id="edge73" class="edge">
<title>tp_allreduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1591,-93.89C1591,-85.29 1591,-76.49 1591,-68.28"/>
<polygon fill="black" stroke="black" points="1594.5,-68.26 1591,-58.26 1587.5,-68.26 1594.5,-68.26"/>
</g>
</g>
</svg>
