<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="3037pt" height="8338pt"
 viewBox="0.00 0.00 728.89 2001.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(4.17 4.17) rotate(0) translate(4 1997.04)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1997.04 724.89,-1997.04 724.89,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M404.05,-488.98C404.05,-488.98 690.05,-488.98 690.05,-488.98 696.05,-488.98 702.05,-494.98 702.05,-500.98 702.05,-500.98 702.05,-1896.06 702.05,-1896.06 702.05,-1902.06 696.05,-1908.06 690.05,-1908.06 690.05,-1908.06 404.05,-1908.06 404.05,-1908.06 398.05,-1908.06 392.05,-1902.06 392.05,-1896.06 392.05,-1896.06 392.05,-500.98 392.05,-500.98 392.05,-494.98 398.05,-488.98 404.05,-488.98"/>
<text text-anchor="middle" x="547.05" y="-1892.86" font-family="Times,serif" font-size="14.00">Pipeline Stage 0: Layers 0&#45;3</text>
<text text-anchor="middle" x="547.05" y="-1877.86" font-family="Times,serif" font-size="14.00">GPUs 0&#45;31</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M333.05,-354.98C333.05,-354.98 610.05,-354.98 610.05,-354.98 616.05,-354.98 622.05,-360.98 622.05,-366.98 622.05,-366.98 622.05,-448.98 622.05,-448.98 622.05,-454.98 616.05,-460.98 610.05,-460.98 610.05,-460.98 333.05,-460.98 333.05,-460.98 327.05,-460.98 321.05,-454.98 321.05,-448.98 321.05,-448.98 321.05,-366.98 321.05,-366.98 321.05,-360.98 327.05,-354.98 333.05,-354.98"/>
<text text-anchor="middle" x="471.55" y="-445.78" font-family="Times,serif" font-size="14.00">Pipeline Stage 1: Layers 4&#45;7</text>
<text text-anchor="middle" x="471.55" y="-430.78" font-family="Times,serif" font-size="14.00">GPUs 32&#45;63</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M182.05,-220.98C182.05,-220.98 459.05,-220.98 459.05,-220.98 465.05,-220.98 471.05,-226.98 471.05,-232.98 471.05,-232.98 471.05,-314.98 471.05,-314.98 471.05,-320.98 465.05,-326.98 459.05,-326.98 459.05,-326.98 182.05,-326.98 182.05,-326.98 176.05,-326.98 170.05,-320.98 170.05,-314.98 170.05,-314.98 170.05,-232.98 170.05,-232.98 170.05,-226.98 176.05,-220.98 182.05,-220.98"/>
<text text-anchor="middle" x="320.55" y="-311.78" font-family="Times,serif" font-size="14.00">Pipeline Stage 2: Layers 8&#45;11</text>
<text text-anchor="middle" x="320.55" y="-296.78" font-family="Times,serif" font-size="14.00">GPUs 64&#45;95</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightgray" stroke="black" d="M31.05,-86.98C31.05,-86.98 308.05,-86.98 308.05,-86.98 314.05,-86.98 320.05,-92.98 320.05,-98.98 320.05,-98.98 320.05,-180.98 320.05,-180.98 320.05,-186.98 314.05,-192.98 308.05,-192.98 308.05,-192.98 31.05,-192.98 31.05,-192.98 25.05,-192.98 19.05,-186.98 19.05,-180.98 19.05,-180.98 19.05,-98.98 19.05,-98.98 19.05,-92.98 25.05,-86.98 31.05,-86.98"/>
<text text-anchor="middle" x="169.55" y="-177.78" font-family="Times,serif" font-size="14.00">Pipeline Stage 3: Layers 12&#45;15</text>
<text text-anchor="middle" x="169.55" y="-162.78" font-family="Times,serif" font-size="14.00">GPUs 96&#45;127</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="537.05" cy="-1964.05" rx="183.7" ry="28.98"/>
<text text-anchor="middle" x="537.05" y="-1972.55" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="537.05" y="-1961.55" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="537.05" y="-1950.55" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- layer0_attn_norm -->
<g id="node2" class="node">
<title>layer0_attn_norm</title>
<polygon fill="lightblue" stroke="black" points="603.55,-1862.06 470.55,-1862.06 470.55,-1810.06 603.55,-1810.06 603.55,-1862.06"/>
<text text-anchor="middle" x="537.05" y="-1850.06" font-family="Arial" font-size="10.00">Layer 0 Attention Norm</text>
<text text-anchor="middle" x="537.05" y="-1839.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1828.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="537.05" y="-1817.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- input&#45;&gt;layer0_attn_norm -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_attn_norm</title>
<path fill="none" stroke="black" d="M537.05,-1934.78C537.05,-1916.33 537.05,-1892.1 537.05,-1872.38"/>
<polygon fill="black" stroke="black" points="540.55,-1872.25 537.05,-1862.25 533.55,-1872.25 540.55,-1872.25"/>
</g>
<!-- layer0_qkv_proj -->
<g id="node3" class="node">
<title>layer0_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="603.55,-1773.06 470.55,-1773.06 470.55,-1721.06 603.55,-1721.06 603.55,-1773.06"/>
<text text-anchor="middle" x="537.05" y="-1761.06" font-family="Arial" font-size="10.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="537.05" y="-1750.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1739.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="537.05" y="-1728.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 3072]</text>
</g>
<!-- layer0_attn_norm&#45;&gt;layer0_qkv_proj -->
<g id="edge2" class="edge">
<title>layer0_attn_norm&#45;&gt;layer0_qkv_proj</title>
<path fill="none" stroke="black" d="M537.05,-1809.9C537.05,-1801.6 537.05,-1792.22 537.05,-1783.31"/>
<polygon fill="black" stroke="black" points="540.55,-1783.17 537.05,-1773.17 533.55,-1783.17 540.55,-1783.17"/>
</g>
<!-- layer0_attn_score -->
<g id="node4" class="node">
<title>layer0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="614.55,-1684.06 459.55,-1684.06 459.55,-1632.06 614.55,-1632.06 614.55,-1684.06"/>
<text text-anchor="middle" x="537.05" y="-1672.06" font-family="Arial" font-size="10.00">Layer 0 Attention Score</text>
<text text-anchor="middle" x="537.05" y="-1661.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1650.06" font-family="Arial" font-size="10.00">Input: [128, 16, 10240, 64]</text>
<text text-anchor="middle" x="537.05" y="-1639.06" font-family="Arial" font-size="10.00">Output: [128, 16, 10240, 10240]</text>
</g>
<!-- layer0_qkv_proj&#45;&gt;layer0_attn_score -->
<g id="edge3" class="edge">
<title>layer0_qkv_proj&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M537.05,-1720.9C537.05,-1712.6 537.05,-1703.22 537.05,-1694.31"/>
<polygon fill="black" stroke="black" points="540.55,-1694.17 537.05,-1684.17 533.55,-1694.17 540.55,-1694.17"/>
</g>
<!-- layer0_attn_softmax -->
<g id="node5" class="node">
<title>layer0_attn_softmax</title>
<polygon fill="lightblue" stroke="black" points="614.55,-1595.06 459.55,-1595.06 459.55,-1543.06 614.55,-1543.06 614.55,-1595.06"/>
<text text-anchor="middle" x="537.05" y="-1583.06" font-family="Arial" font-size="10.00">Layer 0 Attention Softmax</text>
<text text-anchor="middle" x="537.05" y="-1572.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1561.06" font-family="Arial" font-size="10.00">Input: [128, 16, 10240, 10240]</text>
<text text-anchor="middle" x="537.05" y="-1550.06" font-family="Arial" font-size="10.00">Output: [128, 16, 10240, 10240]</text>
</g>
<!-- layer0_attn_score&#45;&gt;layer0_attn_softmax -->
<g id="edge4" class="edge">
<title>layer0_attn_score&#45;&gt;layer0_attn_softmax</title>
<path fill="none" stroke="black" d="M537.05,-1631.9C537.05,-1623.6 537.05,-1614.22 537.05,-1605.31"/>
<polygon fill="black" stroke="black" points="540.55,-1605.17 537.05,-1595.17 533.55,-1605.17 540.55,-1605.17"/>
</g>
<!-- layer0_attn_output -->
<g id="node6" class="node">
<title>layer0_attn_output</title>
<polygon fill="lightblue" stroke="black" points="603.55,-1506.06 470.55,-1506.06 470.55,-1454.06 603.55,-1454.06 603.55,-1506.06"/>
<text text-anchor="middle" x="537.05" y="-1494.06" font-family="Arial" font-size="10.00">Layer 0 Attention Output</text>
<text text-anchor="middle" x="537.05" y="-1483.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1472.06" font-family="Arial" font-size="10.00">Input: [128, 16, 10240, 64]</text>
<text text-anchor="middle" x="537.05" y="-1461.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_attn_softmax&#45;&gt;layer0_attn_output -->
<g id="edge5" class="edge">
<title>layer0_attn_softmax&#45;&gt;layer0_attn_output</title>
<path fill="none" stroke="black" d="M537.05,-1542.9C537.05,-1534.6 537.05,-1525.22 537.05,-1516.31"/>
<polygon fill="black" stroke="black" points="540.55,-1516.17 537.05,-1506.17 533.55,-1516.17 540.55,-1516.17"/>
</g>
<!-- layer0_moe_norm -->
<g id="node7" class="node">
<title>layer0_moe_norm</title>
<polygon fill="lightblue" stroke="black" points="603.55,-1417.06 470.55,-1417.06 470.55,-1365.06 603.55,-1365.06 603.55,-1417.06"/>
<text text-anchor="middle" x="537.05" y="-1405.06" font-family="Arial" font-size="10.00">Layer 0 MoE Norm</text>
<text text-anchor="middle" x="537.05" y="-1394.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1383.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="537.05" y="-1372.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_attn_output&#45;&gt;layer0_moe_norm -->
<g id="edge6" class="edge">
<title>layer0_attn_output&#45;&gt;layer0_moe_norm</title>
<path fill="none" stroke="black" d="M537.05,-1453.9C537.05,-1445.6 537.05,-1436.22 537.05,-1427.31"/>
<polygon fill="black" stroke="black" points="540.55,-1427.17 537.05,-1417.17 533.55,-1427.17 540.55,-1427.17"/>
</g>
<!-- layer0_gate -->
<g id="node8" class="node">
<title>layer0_gate</title>
<polygon fill="lightyellow" stroke="black" points="666.73,-1328.06 460.43,-1328.06 407.36,-1224.06 613.66,-1224.06 666.73,-1328.06"/>
<text text-anchor="middle" x="537.05" y="-1290.06" font-family="Arial" font-size="10.00">Layer 0 Expert Gate</text>
<text text-anchor="middle" x="537.05" y="-1279.06" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="537.05" y="-1268.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="537.05" y="-1257.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 64]</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_gate -->
<g id="edge7" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M537.05,-1364.98C537.05,-1357.06 537.05,-1347.92 537.05,-1338.6"/>
<polygon fill="black" stroke="black" points="540.55,-1338.46 537.05,-1328.46 533.55,-1338.46 540.55,-1338.46"/>
</g>
<!-- layer0_exp0_gpu0_col -->
<g id="node9" class="node">
<title>layer0_exp0_gpu0_col</title>
<polygon fill="lightcoral" stroke="black" points="537.55,-1178.06 404.55,-1178.06 404.55,-1126.06 537.55,-1126.06 537.55,-1178.06"/>
<text text-anchor="middle" x="471.05" y="-1166.06" font-family="Arial" font-size="10.00">Expert 0 Col Linear GPU0</text>
<text text-anchor="middle" x="471.05" y="-1155.06" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="471.05" y="-1144.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="471.05" y="-1133.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp0_gpu0_col -->
<g id="edge8" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp0_gpu0_col</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M509.44,-1224.03C502.69,-1211.56 495.64,-1198.52 489.44,-1187.07"/>
<polygon fill="black" stroke="black" points="492.52,-1185.4 484.68,-1178.27 486.36,-1188.73 492.52,-1185.4"/>
<text text-anchor="middle" x="525.55" y="-1198.86" font-family="Arial" font-size="9.00">expert_select</text>
</g>
<!-- layer0_exp0_gpu1_col -->
<g id="node10" class="node">
<title>layer0_exp0_gpu1_col</title>
<polygon fill="lightcoral" stroke="black" points="688.55,-1178.06 555.55,-1178.06 555.55,-1126.06 688.55,-1126.06 688.55,-1178.06"/>
<text text-anchor="middle" x="622.05" y="-1166.06" font-family="Arial" font-size="10.00">Expert 0 Col Linear GPU1</text>
<text text-anchor="middle" x="622.05" y="-1155.06" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="622.05" y="-1144.06" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="622.05" y="-1133.06" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp0_gpu1_col -->
<g id="edge9" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp0_gpu1_col</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M572.6,-1224.03C581.37,-1211.44 590.55,-1198.26 598.59,-1186.73"/>
<polygon fill="black" stroke="black" points="601.64,-1188.48 604.48,-1178.27 595.89,-1184.47 601.64,-1188.48"/>
<text text-anchor="middle" x="616.55" y="-1198.86" font-family="Arial" font-size="9.00">expert_select</text>
</g>
<!-- layer0_exp0_allreduce -->
<g id="node11" class="node">
<title>layer0_exp0_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="547.05" cy="-1052.29" rx="94.09" ry="36.54"/>
<text text-anchor="middle" x="547.05" y="-1066.29" font-family="Arial" font-size="10.00">Expert 0 All&#45;Reduce</text>
<text text-anchor="middle" x="547.05" y="-1055.29" font-family="Arial" font-size="10.00">GPU: 0,1</text>
<text text-anchor="middle" x="547.05" y="-1044.29" font-family="Arial" font-size="10.00">Input: [128, 10240, 2048]</text>
<text text-anchor="middle" x="547.05" y="-1033.29" font-family="Arial" font-size="10.00">Output: [128, 10240, 2048]</text>
</g>
<!-- layer0_exp0_gpu0_col&#45;&gt;layer0_exp0_allreduce -->
<g id="edge10" class="edge">
<title>layer0_exp0_gpu0_col&#45;&gt;layer0_exp0_allreduce</title>
<path fill="none" stroke="black" d="M490.62,-1125.88C497.77,-1116.69 506.06,-1106.01 514.06,-1095.73"/>
<polygon fill="black" stroke="black" points="517.01,-1097.64 520.38,-1087.6 511.48,-1093.34 517.01,-1097.64"/>
</g>
<!-- layer0_exp0_gpu1_col&#45;&gt;layer0_exp0_allreduce -->
<g id="edge11" class="edge">
<title>layer0_exp0_gpu1_col&#45;&gt;layer0_exp0_allreduce</title>
<path fill="none" stroke="black" d="M602.73,-1125.88C595.68,-1116.69 587.49,-1106.01 579.6,-1095.73"/>
<polygon fill="black" stroke="black" points="582.22,-1093.4 573.36,-1087.6 576.67,-1097.66 582.22,-1093.4"/>
</g>
<!-- layer0_exp0_gpu0_gelu -->
<g id="node12" class="node">
<title>layer0_exp0_gpu0_gelu</title>
<polygon fill="lightcoral" stroke="black" points="537.55,-978.52 404.55,-978.52 404.55,-926.52 537.55,-926.52 537.55,-978.52"/>
<text text-anchor="middle" x="471.05" y="-966.52" font-family="Arial" font-size="10.00">Expert 0 GELU GPU0</text>
<text text-anchor="middle" x="471.05" y="-955.52" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="471.05" y="-944.52" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="471.05" y="-933.52" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_exp0_allreduce&#45;&gt;layer0_exp0_gpu0_gelu -->
<g id="edge12" class="edge">
<title>layer0_exp0_allreduce&#45;&gt;layer0_exp0_gpu0_gelu</title>
<path fill="none" stroke="black" d="M520.25,-1016.82C512.64,-1007.03 504.37,-996.39 496.82,-986.68"/>
<polygon fill="black" stroke="black" points="499.57,-984.52 490.67,-978.77 494.05,-988.82 499.57,-984.52"/>
</g>
<!-- layer0_exp0_gpu1_gelu -->
<g id="node13" class="node">
<title>layer0_exp0_gpu1_gelu</title>
<polygon fill="lightcoral" stroke="black" points="689.55,-978.52 556.55,-978.52 556.55,-926.52 689.55,-926.52 689.55,-978.52"/>
<text text-anchor="middle" x="623.05" y="-966.52" font-family="Arial" font-size="10.00">Expert 0 GELU GPU1</text>
<text text-anchor="middle" x="623.05" y="-955.52" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="623.05" y="-944.52" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="623.05" y="-933.52" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_exp0_allreduce&#45;&gt;layer0_exp0_gpu1_gelu -->
<g id="edge13" class="edge">
<title>layer0_exp0_allreduce&#45;&gt;layer0_exp0_gpu1_gelu</title>
<path fill="none" stroke="black" d="M573.84,-1016.82C581.45,-1007.03 589.72,-996.39 597.27,-986.68"/>
<polygon fill="black" stroke="black" points="600.04,-988.82 603.42,-978.77 594.52,-984.52 600.04,-988.82"/>
</g>
<!-- layer0_exp0_gpu0_row -->
<g id="node14" class="node">
<title>layer0_exp0_gpu0_row</title>
<polygon fill="lightcoral" stroke="black" points="538.05,-889.52 402.05,-889.52 402.05,-837.52 538.05,-837.52 538.05,-889.52"/>
<text text-anchor="middle" x="470.05" y="-877.52" font-family="Arial" font-size="10.00">Expert 0 Row Linear GPU0</text>
<text text-anchor="middle" x="470.05" y="-866.52" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="470.05" y="-855.52" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="470.05" y="-844.52" font-family="Arial" font-size="10.00">Output: [128, 10240, 512]</text>
</g>
<!-- layer0_exp0_gpu0_gelu&#45;&gt;layer0_exp0_gpu0_row -->
<g id="edge14" class="edge">
<title>layer0_exp0_gpu0_gelu&#45;&gt;layer0_exp0_gpu0_row</title>
<path fill="none" stroke="black" d="M470.76,-926.36C470.66,-918.06 470.55,-908.68 470.45,-899.77"/>
<polygon fill="black" stroke="black" points="473.95,-899.59 470.33,-889.63 466.95,-899.67 473.95,-899.59"/>
</g>
<!-- layer0_exp0_gpu1_row -->
<g id="node15" class="node">
<title>layer0_exp0_gpu1_row</title>
<polygon fill="lightcoral" stroke="black" points="692.05,-889.52 556.05,-889.52 556.05,-837.52 692.05,-837.52 692.05,-889.52"/>
<text text-anchor="middle" x="624.05" y="-877.52" font-family="Arial" font-size="10.00">Expert 0 Row Linear GPU1</text>
<text text-anchor="middle" x="624.05" y="-866.52" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="624.05" y="-855.52" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="624.05" y="-844.52" font-family="Arial" font-size="10.00">Output: [128, 10240, 512]</text>
</g>
<!-- layer0_exp0_gpu1_gelu&#45;&gt;layer0_exp0_gpu1_row -->
<g id="edge15" class="edge">
<title>layer0_exp0_gpu1_gelu&#45;&gt;layer0_exp0_gpu1_row</title>
<path fill="none" stroke="black" d="M623.33,-926.36C623.43,-918.06 623.54,-908.68 623.64,-899.77"/>
<polygon fill="black" stroke="black" points="627.14,-899.67 623.76,-889.63 620.14,-899.59 627.14,-899.67"/>
</g>
<!-- layer0_exp0_allreduce2 -->
<g id="node16" class="node">
<title>layer0_exp0_allreduce2</title>
<ellipse fill="lightgreen" stroke="black" cx="547.05" cy="-763.75" rx="94.09" ry="36.54"/>
<text text-anchor="middle" x="547.05" y="-777.75" font-family="Arial" font-size="10.00">Expert 0 Final All&#45;Reduce</text>
<text text-anchor="middle" x="547.05" y="-766.75" font-family="Arial" font-size="10.00">GPU: 0,1</text>
<text text-anchor="middle" x="547.05" y="-755.75" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="547.05" y="-744.75" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_exp0_gpu0_row&#45;&gt;layer0_exp0_allreduce2 -->
<g id="edge16" class="edge">
<title>layer0_exp0_gpu0_row&#45;&gt;layer0_exp0_allreduce2</title>
<path fill="none" stroke="black" d="M489.87,-837.34C497.12,-828.15 505.52,-817.47 513.62,-807.19"/>
<polygon fill="black" stroke="black" points="516.59,-809.08 520.03,-799.06 511.09,-804.75 516.59,-809.08"/>
</g>
<!-- layer0_exp0_gpu1_row&#45;&gt;layer0_exp0_allreduce2 -->
<g id="edge17" class="edge">
<title>layer0_exp0_gpu1_row&#45;&gt;layer0_exp0_allreduce2</title>
<path fill="none" stroke="black" d="M604.22,-837.34C596.97,-828.15 588.57,-817.47 580.47,-807.19"/>
<polygon fill="black" stroke="black" points="583,-804.75 574.06,-799.06 577.5,-809.08 583,-804.75"/>
</g>
<!-- layer0_exp_agg -->
<g id="node17" class="node">
<title>layer0_exp_agg</title>
<polygon fill="lightyellow" stroke="black" points="694.48,-689.98 459.94,-689.98 399.61,-585.98 634.15,-585.98 694.48,-689.98"/>
<text text-anchor="middle" x="547.05" y="-651.98" font-family="Arial" font-size="10.00">Layer 0 Expert Aggregation</text>
<text text-anchor="middle" x="547.05" y="-640.98" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="547.05" y="-629.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024, 64]</text>
<text text-anchor="middle" x="547.05" y="-618.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_exp0_allreduce2&#45;&gt;layer0_exp_agg -->
<g id="edge18" class="edge">
<title>layer0_exp0_allreduce2&#45;&gt;layer0_exp_agg</title>
<path fill="none" stroke="black" d="M547.05,-726.95C547.05,-718.65 547.05,-709.59 547.05,-700.53"/>
<polygon fill="black" stroke="black" points="550.55,-700.35 547.05,-690.35 543.55,-700.35 550.55,-700.35"/>
</g>
<!-- layer0_output -->
<g id="node18" class="node">
<title>layer0_output</title>
<polygon fill="lightblue" stroke="black" points="613.55,-548.98 480.55,-548.98 480.55,-496.98 613.55,-496.98 613.55,-548.98"/>
<text text-anchor="middle" x="547.05" y="-536.98" font-family="Arial" font-size="10.00">Layer 0 Output</text>
<text text-anchor="middle" x="547.05" y="-525.98" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="547.05" y="-514.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="547.05" y="-503.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_exp_agg&#45;&gt;layer0_output -->
<g id="edge19" class="edge">
<title>layer0_exp_agg&#45;&gt;layer0_output</title>
<path fill="none" stroke="black" d="M547.05,-585.77C547.05,-576.82 547.05,-567.69 547.05,-559.29"/>
<polygon fill="black" stroke="black" points="550.55,-559.11 547.05,-549.11 543.55,-559.11 550.55,-559.11"/>
</g>
<!-- layer4_attn_norm -->
<g id="node19" class="node">
<title>layer4_attn_norm</title>
<polygon fill="lightblue" stroke="black" points="613.55,-414.98 480.55,-414.98 480.55,-362.98 613.55,-362.98 613.55,-414.98"/>
<text text-anchor="middle" x="547.05" y="-402.98" font-family="Arial" font-size="10.00">Layer 4 Attention Norm</text>
<text text-anchor="middle" x="547.05" y="-391.98" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="547.05" y="-380.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="547.05" y="-369.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer0_output&#45;&gt;layer4_attn_norm -->
<g id="edge20" class="edge">
<title>layer0_output&#45;&gt;layer4_attn_norm</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M547.05,-496.84C547.05,-476.57 547.05,-447.81 547.05,-425.23"/>
<polygon fill="black" stroke="black" points="550.55,-425.03 547.05,-415.03 543.55,-425.03 550.55,-425.03"/>
<text text-anchor="middle" x="576.55" y="-471.78" font-family="Arial" font-size="9.00">pipeline_send</text>
</g>
<!-- layer4_output -->
<g id="node20" class="node">
<title>layer4_output</title>
<polygon fill="lightblue" stroke="black" points="462.55,-414.98 329.55,-414.98 329.55,-362.98 462.55,-362.98 462.55,-414.98"/>
<text text-anchor="middle" x="396.05" y="-402.98" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="396.05" y="-391.98" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="396.05" y="-380.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="396.05" y="-369.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer8_attn_norm -->
<g id="node21" class="node">
<title>layer8_attn_norm</title>
<polygon fill="lightblue" stroke="black" points="462.55,-280.98 329.55,-280.98 329.55,-228.98 462.55,-228.98 462.55,-280.98"/>
<text text-anchor="middle" x="396.05" y="-268.98" font-family="Arial" font-size="10.00">Layer 8 Attention Norm</text>
<text text-anchor="middle" x="396.05" y="-257.98" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="396.05" y="-246.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="396.05" y="-235.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer4_output&#45;&gt;layer8_attn_norm -->
<g id="edge21" class="edge">
<title>layer4_output&#45;&gt;layer8_attn_norm</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M396.05,-362.84C396.05,-342.57 396.05,-313.81 396.05,-291.23"/>
<polygon fill="black" stroke="black" points="399.55,-291.03 396.05,-281.03 392.55,-291.03 399.55,-291.03"/>
<text text-anchor="middle" x="425.55" y="-337.78" font-family="Arial" font-size="9.00">pipeline_send</text>
</g>
<!-- layer8_output -->
<g id="node22" class="node">
<title>layer8_output</title>
<polygon fill="lightblue" stroke="black" points="311.55,-280.98 178.55,-280.98 178.55,-228.98 311.55,-228.98 311.55,-280.98"/>
<text text-anchor="middle" x="245.05" y="-268.98" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="245.05" y="-257.98" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="245.05" y="-246.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="245.05" y="-235.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer12_attn_norm -->
<g id="node23" class="node">
<title>layer12_attn_norm</title>
<polygon fill="lightblue" stroke="black" points="311.55,-146.98 178.55,-146.98 178.55,-94.98 311.55,-94.98 311.55,-146.98"/>
<text text-anchor="middle" x="245.05" y="-134.98" font-family="Arial" font-size="10.00">Layer 12 Attention Norm</text>
<text text-anchor="middle" x="245.05" y="-123.98" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="245.05" y="-112.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="245.05" y="-101.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer8_output&#45;&gt;layer12_attn_norm -->
<g id="edge22" class="edge">
<title>layer8_output&#45;&gt;layer12_attn_norm</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M245.05,-228.84C245.05,-208.57 245.05,-179.81 245.05,-157.23"/>
<polygon fill="black" stroke="black" points="248.55,-157.03 245.05,-147.03 241.55,-157.03 248.55,-157.03"/>
<text text-anchor="middle" x="274.55" y="-203.78" font-family="Arial" font-size="9.00">pipeline_send</text>
</g>
<!-- layer12_output -->
<g id="node24" class="node">
<title>layer12_output</title>
<polygon fill="lightblue" stroke="black" points="160.55,-146.98 27.55,-146.98 27.55,-94.98 160.55,-94.98 160.55,-146.98"/>
<text text-anchor="middle" x="94.05" y="-134.98" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="94.05" y="-123.98" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="94.05" y="-112.98" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="94.05" y="-101.98" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- output -->
<g id="node25" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="94.05" cy="-28.99" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="94.05" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="94.05" y="-26.49" font-family="Arial" font-size="10.00">Input: [128, 10240, 1024]</text>
<text text-anchor="middle" x="94.05" y="-15.49" font-family="Arial" font-size="10.00">Output: [128, 10240, 1024]</text>
</g>
<!-- layer12_output&#45;&gt;output -->
<g id="edge23" class="edge">
<title>layer12_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M94.05,-94.92C94.05,-86.69 94.05,-77.35 94.05,-68.38"/>
<polygon fill="black" stroke="black" points="97.55,-68.09 94.05,-58.09 90.55,-68.09 97.55,-68.09"/>
</g>
</g>
</svg>
