<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_128GPU_Simplified Pages: 1 -->
<svg width="11455pt" height="621pt"
 viewBox="0.00 0.00 11455.36 621.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 617.48)">
<title>MoE_128GPU_Simplified</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-617.48 11451.36,-617.48 11451.36,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<path fill="lightyellow" stroke="blue" stroke-width="3" d="M20,-157.74C20,-157.74 2723,-157.74 2723,-157.74 2729,-157.74 2735,-163.74 2735,-169.74 2735,-169.74 2735,-282.74 2735,-282.74 2735,-288.74 2729,-294.74 2723,-294.74 2723,-294.74 20,-294.74 20,-294.74 14,-294.74 8,-288.74 8,-282.74 8,-282.74 8,-169.74 8,-169.74 8,-163.74 14,-157.74 20,-157.74"/>
<text text-anchor="middle" x="1371.5" y="-279.54" font-family="Arial" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="1371.5" y="-264.54" font-family="Arial" font-size="14.00">Layers 0&#45;3</text>
<text text-anchor="middle" x="1371.5" y="-249.54" font-family="Arial" font-size="14.00">GPUs 0&#45;31</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_1</title>
<path fill="lightyellow" stroke="blue" stroke-width="3" d="M2788,-157.74C2788,-157.74 5491,-157.74 5491,-157.74 5497,-157.74 5503,-163.74 5503,-169.74 5503,-169.74 5503,-282.74 5503,-282.74 5503,-288.74 5497,-294.74 5491,-294.74 5491,-294.74 2788,-294.74 2788,-294.74 2782,-294.74 2776,-288.74 2776,-282.74 2776,-282.74 2776,-169.74 2776,-169.74 2776,-163.74 2782,-157.74 2788,-157.74"/>
<text text-anchor="middle" x="4139.5" y="-279.54" font-family="Arial" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="4139.5" y="-264.54" font-family="Arial" font-size="14.00">Layers 4&#45;7</text>
<text text-anchor="middle" x="4139.5" y="-249.54" font-family="Arial" font-size="14.00">GPUs 32&#45;63</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_2</title>
<path fill="lightyellow" stroke="blue" stroke-width="3" d="M5556,-157.74C5556,-157.74 8259,-157.74 8259,-157.74 8265,-157.74 8271,-163.74 8271,-169.74 8271,-169.74 8271,-282.74 8271,-282.74 8271,-288.74 8265,-294.74 8259,-294.74 8259,-294.74 5556,-294.74 5556,-294.74 5550,-294.74 5544,-288.74 5544,-282.74 5544,-282.74 5544,-169.74 5544,-169.74 5544,-163.74 5550,-157.74 5556,-157.74"/>
<text text-anchor="middle" x="6907.5" y="-279.54" font-family="Arial" font-size="14.00">Pipeline Stage 2</text>
<text text-anchor="middle" x="6907.5" y="-264.54" font-family="Arial" font-size="14.00">Layers 8&#45;11</text>
<text text-anchor="middle" x="6907.5" y="-249.54" font-family="Arial" font-size="14.00">GPUs 64&#45;95</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_3</title>
<path fill="lightyellow" stroke="blue" stroke-width="3" d="M8324,-157.74C8324,-157.74 11027,-157.74 11027,-157.74 11033,-157.74 11039,-163.74 11039,-169.74 11039,-169.74 11039,-282.74 11039,-282.74 11039,-288.74 11033,-294.74 11027,-294.74 11027,-294.74 8324,-294.74 8324,-294.74 8318,-294.74 8312,-288.74 8312,-282.74 8312,-282.74 8312,-169.74 8312,-169.74 8312,-163.74 8318,-157.74 8324,-157.74"/>
<text text-anchor="middle" x="9675.5" y="-279.54" font-family="Arial" font-size="14.00">Pipeline Stage 3</text>
<text text-anchor="middle" x="9675.5" y="-264.54" font-family="Arial" font-size="14.00">Layers 12&#45;15</text>
<text text-anchor="middle" x="9675.5" y="-249.54" font-family="Arial" font-size="14.00">GPUs 96&#45;127</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" stroke-width="2" cx="5524" cy="-586.61" rx="101.23" ry="26.74"/>
<text text-anchor="middle" x="5524" y="-590.41" font-family="Arial" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="5524" y="-575.41" font-family="Arial" font-size="14.00">[batch_size, seq_len]</text>
</g>
<!-- moe_gate -->
<g id="node66" class="node">
<title>moe_gate</title>
<polygon fill="orange" stroke="black" stroke-width="3" stroke-dasharray="5,2" points="5712.88,-451.74 5412.42,-451.74 5335.12,-345.74 5635.58,-345.74 5712.88,-451.74"/>
<text text-anchor="middle" x="5524" y="-410.04" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="5524" y="-395.04" font-family="Arial" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="5524" y="-380.04" font-family="Arial" font-size="14.00">[64 experts, top&#45;2 selection]</text>
</g>
<!-- input&#45;&gt;moe_gate -->
<g id="edge1" class="edge">
<title>input&#45;&gt;moe_gate</title>
<path fill="none" stroke="black" stroke-width="2" d="M5524,-559.69C5524,-559.69 5524,-461.96 5524,-461.96"/>
<polygon fill="black" stroke="black" stroke-width="2" points="5527.5,-461.96 5524,-451.96 5520.5,-461.96 5527.5,-461.96"/>
</g>
<!-- expert_0_stage_0 -->
<g id="node2" class="node">
<title>expert_0_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2726.5,-233.74 2611.5,-233.74 2611.5,-165.74 2726.5,-165.74 2726.5,-233.74"/>
<text text-anchor="middle" x="2669" y="-218.54" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2669" y="-203.54" font-family="Arial" font-size="14.00">GPUs 0&#45;1</text>
<text text-anchor="middle" x="2669" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="2669" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_1_stage_0 -->
<g id="node3" class="node">
<title>expert_1_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2553.5,-233.74 2438.5,-233.74 2438.5,-165.74 2553.5,-165.74 2553.5,-233.74"/>
<text text-anchor="middle" x="2496" y="-218.54" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2496" y="-203.54" font-family="Arial" font-size="14.00">GPUs 2&#45;3</text>
<text text-anchor="middle" x="2496" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="2496" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_2_stage_0 -->
<g id="node4" class="node">
<title>expert_2_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2380.5,-233.74 2265.5,-233.74 2265.5,-165.74 2380.5,-165.74 2380.5,-233.74"/>
<text text-anchor="middle" x="2323" y="-218.54" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2323" y="-203.54" font-family="Arial" font-size="14.00">GPUs 4&#45;5</text>
<text text-anchor="middle" x="2323" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="2323" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_3_stage_0 -->
<g id="node5" class="node">
<title>expert_3_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2207.5,-233.74 2092.5,-233.74 2092.5,-165.74 2207.5,-165.74 2207.5,-233.74"/>
<text text-anchor="middle" x="2150" y="-218.54" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2150" y="-203.54" font-family="Arial" font-size="14.00">GPUs 6&#45;7</text>
<text text-anchor="middle" x="2150" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="2150" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_4_stage_0 -->
<g id="node6" class="node">
<title>expert_4_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2034.5,-233.74 1919.5,-233.74 1919.5,-165.74 2034.5,-165.74 2034.5,-233.74"/>
<text text-anchor="middle" x="1977" y="-218.54" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1977" y="-203.54" font-family="Arial" font-size="14.00">GPUs 8&#45;9</text>
<text text-anchor="middle" x="1977" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1977" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_5_stage_0 -->
<g id="node7" class="node">
<title>expert_5_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="1861.5,-233.74 1746.5,-233.74 1746.5,-165.74 1861.5,-165.74 1861.5,-233.74"/>
<text text-anchor="middle" x="1804" y="-218.54" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1804" y="-203.54" font-family="Arial" font-size="14.00">GPUs 10&#45;11</text>
<text text-anchor="middle" x="1804" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1804" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_6_stage_0 -->
<g id="node8" class="node">
<title>expert_6_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="1688.5,-233.74 1573.5,-233.74 1573.5,-165.74 1688.5,-165.74 1688.5,-233.74"/>
<text text-anchor="middle" x="1631" y="-218.54" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1631" y="-203.54" font-family="Arial" font-size="14.00">GPUs 12&#45;13</text>
<text text-anchor="middle" x="1631" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1631" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_7_stage_0 -->
<g id="node9" class="node">
<title>expert_7_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="1515.5,-233.74 1400.5,-233.74 1400.5,-165.74 1515.5,-165.74 1515.5,-233.74"/>
<text text-anchor="middle" x="1458" y="-218.54" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1458" y="-203.54" font-family="Arial" font-size="14.00">GPUs 14&#45;15</text>
<text text-anchor="middle" x="1458" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1458" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_8_stage_0 -->
<g id="node10" class="node">
<title>expert_8_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="1342.5,-233.74 1227.5,-233.74 1227.5,-165.74 1342.5,-165.74 1342.5,-233.74"/>
<text text-anchor="middle" x="1285" y="-218.54" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1285" y="-203.54" font-family="Arial" font-size="14.00">GPUs 16&#45;17</text>
<text text-anchor="middle" x="1285" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1285" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_9_stage_0 -->
<g id="node11" class="node">
<title>expert_9_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="1169.5,-233.74 1054.5,-233.74 1054.5,-165.74 1169.5,-165.74 1169.5,-233.74"/>
<text text-anchor="middle" x="1112" y="-218.54" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="1112" y="-203.54" font-family="Arial" font-size="14.00">GPUs 18&#45;19</text>
<text text-anchor="middle" x="1112" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="1112" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_10_stage_0 -->
<g id="node12" class="node">
<title>expert_10_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="996.5,-233.74 881.5,-233.74 881.5,-165.74 996.5,-165.74 996.5,-233.74"/>
<text text-anchor="middle" x="939" y="-218.54" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="939" y="-203.54" font-family="Arial" font-size="14.00">GPUs 20&#45;21</text>
<text text-anchor="middle" x="939" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="939" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_11_stage_0 -->
<g id="node13" class="node">
<title>expert_11_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="823.5,-233.74 708.5,-233.74 708.5,-165.74 823.5,-165.74 823.5,-233.74"/>
<text text-anchor="middle" x="766" y="-218.54" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="766" y="-203.54" font-family="Arial" font-size="14.00">GPUs 22&#45;23</text>
<text text-anchor="middle" x="766" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="766" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_12_stage_0 -->
<g id="node14" class="node">
<title>expert_12_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="650.5,-233.74 535.5,-233.74 535.5,-165.74 650.5,-165.74 650.5,-233.74"/>
<text text-anchor="middle" x="593" y="-218.54" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="593" y="-203.54" font-family="Arial" font-size="14.00">GPUs 24&#45;25</text>
<text text-anchor="middle" x="593" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="593" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_13_stage_0 -->
<g id="node15" class="node">
<title>expert_13_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="477.5,-233.74 362.5,-233.74 362.5,-165.74 477.5,-165.74 477.5,-233.74"/>
<text text-anchor="middle" x="420" y="-218.54" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="420" y="-203.54" font-family="Arial" font-size="14.00">GPUs 26&#45;27</text>
<text text-anchor="middle" x="420" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="420" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_14_stage_0 -->
<g id="node16" class="node">
<title>expert_14_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="304.5,-233.74 189.5,-233.74 189.5,-165.74 304.5,-165.74 304.5,-233.74"/>
<text text-anchor="middle" x="247" y="-218.54" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="247" y="-203.54" font-family="Arial" font-size="14.00">GPUs 28&#45;29</text>
<text text-anchor="middle" x="247" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="247" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_15_stage_0 -->
<g id="node17" class="node">
<title>expert_15_stage_0</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="131.5,-233.74 16.5,-233.74 16.5,-165.74 131.5,-165.74 131.5,-233.74"/>
<text text-anchor="middle" x="74" y="-218.54" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="74" y="-203.54" font-family="Arial" font-size="14.00">GPUs 30&#45;31</text>
<text text-anchor="middle" x="74" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="74" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_16_stage_1 -->
<g id="node18" class="node">
<title>expert_16_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="5494.5,-233.74 5379.5,-233.74 5379.5,-165.74 5494.5,-165.74 5494.5,-233.74"/>
<text text-anchor="middle" x="5437" y="-218.54" font-family="Arial" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="5437" y="-203.54" font-family="Arial" font-size="14.00">GPUs 32&#45;33</text>
<text text-anchor="middle" x="5437" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5437" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_17_stage_1 -->
<g id="node19" class="node">
<title>expert_17_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="5321.5,-233.74 5206.5,-233.74 5206.5,-165.74 5321.5,-165.74 5321.5,-233.74"/>
<text text-anchor="middle" x="5264" y="-218.54" font-family="Arial" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="5264" y="-203.54" font-family="Arial" font-size="14.00">GPUs 34&#45;35</text>
<text text-anchor="middle" x="5264" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5264" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_18_stage_1 -->
<g id="node20" class="node">
<title>expert_18_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="5148.5,-233.74 5033.5,-233.74 5033.5,-165.74 5148.5,-165.74 5148.5,-233.74"/>
<text text-anchor="middle" x="5091" y="-218.54" font-family="Arial" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="5091" y="-203.54" font-family="Arial" font-size="14.00">GPUs 36&#45;37</text>
<text text-anchor="middle" x="5091" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5091" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_19_stage_1 -->
<g id="node21" class="node">
<title>expert_19_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4975.5,-233.74 4860.5,-233.74 4860.5,-165.74 4975.5,-165.74 4975.5,-233.74"/>
<text text-anchor="middle" x="4918" y="-218.54" font-family="Arial" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="4918" y="-203.54" font-family="Arial" font-size="14.00">GPUs 38&#45;39</text>
<text text-anchor="middle" x="4918" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4918" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_20_stage_1 -->
<g id="node22" class="node">
<title>expert_20_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4802.5,-233.74 4687.5,-233.74 4687.5,-165.74 4802.5,-165.74 4802.5,-233.74"/>
<text text-anchor="middle" x="4745" y="-218.54" font-family="Arial" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="4745" y="-203.54" font-family="Arial" font-size="14.00">GPUs 40&#45;41</text>
<text text-anchor="middle" x="4745" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4745" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_21_stage_1 -->
<g id="node23" class="node">
<title>expert_21_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4629.5,-233.74 4514.5,-233.74 4514.5,-165.74 4629.5,-165.74 4629.5,-233.74"/>
<text text-anchor="middle" x="4572" y="-218.54" font-family="Arial" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="4572" y="-203.54" font-family="Arial" font-size="14.00">GPUs 42&#45;43</text>
<text text-anchor="middle" x="4572" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4572" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_22_stage_1 -->
<g id="node24" class="node">
<title>expert_22_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4456.5,-233.74 4341.5,-233.74 4341.5,-165.74 4456.5,-165.74 4456.5,-233.74"/>
<text text-anchor="middle" x="4399" y="-218.54" font-family="Arial" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="4399" y="-203.54" font-family="Arial" font-size="14.00">GPUs 44&#45;45</text>
<text text-anchor="middle" x="4399" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4399" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_23_stage_1 -->
<g id="node25" class="node">
<title>expert_23_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4283.5,-233.74 4168.5,-233.74 4168.5,-165.74 4283.5,-165.74 4283.5,-233.74"/>
<text text-anchor="middle" x="4226" y="-218.54" font-family="Arial" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="4226" y="-203.54" font-family="Arial" font-size="14.00">GPUs 46&#45;47</text>
<text text-anchor="middle" x="4226" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4226" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_24_stage_1 -->
<g id="node26" class="node">
<title>expert_24_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="4110.5,-233.74 3995.5,-233.74 3995.5,-165.74 4110.5,-165.74 4110.5,-233.74"/>
<text text-anchor="middle" x="4053" y="-218.54" font-family="Arial" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="4053" y="-203.54" font-family="Arial" font-size="14.00">GPUs 48&#45;49</text>
<text text-anchor="middle" x="4053" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="4053" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_25_stage_1 -->
<g id="node27" class="node">
<title>expert_25_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3937.5,-233.74 3822.5,-233.74 3822.5,-165.74 3937.5,-165.74 3937.5,-233.74"/>
<text text-anchor="middle" x="3880" y="-218.54" font-family="Arial" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="3880" y="-203.54" font-family="Arial" font-size="14.00">GPUs 50&#45;51</text>
<text text-anchor="middle" x="3880" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3880" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_26_stage_1 -->
<g id="node28" class="node">
<title>expert_26_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3764.5,-233.74 3649.5,-233.74 3649.5,-165.74 3764.5,-165.74 3764.5,-233.74"/>
<text text-anchor="middle" x="3707" y="-218.54" font-family="Arial" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="3707" y="-203.54" font-family="Arial" font-size="14.00">GPUs 52&#45;53</text>
<text text-anchor="middle" x="3707" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3707" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_27_stage_1 -->
<g id="node29" class="node">
<title>expert_27_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3591.5,-233.74 3476.5,-233.74 3476.5,-165.74 3591.5,-165.74 3591.5,-233.74"/>
<text text-anchor="middle" x="3534" y="-218.54" font-family="Arial" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="3534" y="-203.54" font-family="Arial" font-size="14.00">GPUs 54&#45;55</text>
<text text-anchor="middle" x="3534" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3534" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_28_stage_1 -->
<g id="node30" class="node">
<title>expert_28_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3418.5,-233.74 3303.5,-233.74 3303.5,-165.74 3418.5,-165.74 3418.5,-233.74"/>
<text text-anchor="middle" x="3361" y="-218.54" font-family="Arial" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="3361" y="-203.54" font-family="Arial" font-size="14.00">GPUs 56&#45;57</text>
<text text-anchor="middle" x="3361" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3361" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_29_stage_1 -->
<g id="node31" class="node">
<title>expert_29_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3245.5,-233.74 3130.5,-233.74 3130.5,-165.74 3245.5,-165.74 3245.5,-233.74"/>
<text text-anchor="middle" x="3188" y="-218.54" font-family="Arial" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="3188" y="-203.54" font-family="Arial" font-size="14.00">GPUs 58&#45;59</text>
<text text-anchor="middle" x="3188" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3188" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_30_stage_1 -->
<g id="node32" class="node">
<title>expert_30_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="3072.5,-233.74 2957.5,-233.74 2957.5,-165.74 3072.5,-165.74 3072.5,-233.74"/>
<text text-anchor="middle" x="3015" y="-218.54" font-family="Arial" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="3015" y="-203.54" font-family="Arial" font-size="14.00">GPUs 60&#45;61</text>
<text text-anchor="middle" x="3015" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="3015" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_31_stage_1 -->
<g id="node33" class="node">
<title>expert_31_stage_1</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="2899.5,-233.74 2784.5,-233.74 2784.5,-165.74 2899.5,-165.74 2899.5,-233.74"/>
<text text-anchor="middle" x="2842" y="-218.54" font-family="Arial" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="2842" y="-203.54" font-family="Arial" font-size="14.00">GPUs 62&#45;63</text>
<text text-anchor="middle" x="2842" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="2842" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_32_stage_2 -->
<g id="node34" class="node">
<title>expert_32_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8262.5,-233.74 8147.5,-233.74 8147.5,-165.74 8262.5,-165.74 8262.5,-233.74"/>
<text text-anchor="middle" x="8205" y="-218.54" font-family="Arial" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="8205" y="-203.54" font-family="Arial" font-size="14.00">GPUs 64&#45;65</text>
<text text-anchor="middle" x="8205" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8205" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_33_stage_2 -->
<g id="node35" class="node">
<title>expert_33_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8089.5,-233.74 7974.5,-233.74 7974.5,-165.74 8089.5,-165.74 8089.5,-233.74"/>
<text text-anchor="middle" x="8032" y="-218.54" font-family="Arial" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="8032" y="-203.54" font-family="Arial" font-size="14.00">GPUs 66&#45;67</text>
<text text-anchor="middle" x="8032" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8032" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_34_stage_2 -->
<g id="node36" class="node">
<title>expert_34_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7916.5,-233.74 7801.5,-233.74 7801.5,-165.74 7916.5,-165.74 7916.5,-233.74"/>
<text text-anchor="middle" x="7859" y="-218.54" font-family="Arial" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="7859" y="-203.54" font-family="Arial" font-size="14.00">GPUs 68&#45;69</text>
<text text-anchor="middle" x="7859" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="7859" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_35_stage_2 -->
<g id="node37" class="node">
<title>expert_35_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7743.5,-233.74 7628.5,-233.74 7628.5,-165.74 7743.5,-165.74 7743.5,-233.74"/>
<text text-anchor="middle" x="7686" y="-218.54" font-family="Arial" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="7686" y="-203.54" font-family="Arial" font-size="14.00">GPUs 70&#45;71</text>
<text text-anchor="middle" x="7686" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="7686" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_36_stage_2 -->
<g id="node38" class="node">
<title>expert_36_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7570.5,-233.74 7455.5,-233.74 7455.5,-165.74 7570.5,-165.74 7570.5,-233.74"/>
<text text-anchor="middle" x="7513" y="-218.54" font-family="Arial" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="7513" y="-203.54" font-family="Arial" font-size="14.00">GPUs 72&#45;73</text>
<text text-anchor="middle" x="7513" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="7513" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_37_stage_2 -->
<g id="node39" class="node">
<title>expert_37_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7397.5,-233.74 7282.5,-233.74 7282.5,-165.74 7397.5,-165.74 7397.5,-233.74"/>
<text text-anchor="middle" x="7340" y="-218.54" font-family="Arial" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="7340" y="-203.54" font-family="Arial" font-size="14.00">GPUs 74&#45;75</text>
<text text-anchor="middle" x="7340" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="7340" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_38_stage_2 -->
<g id="node40" class="node">
<title>expert_38_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7224.5,-233.74 7109.5,-233.74 7109.5,-165.74 7224.5,-165.74 7224.5,-233.74"/>
<text text-anchor="middle" x="7167" y="-218.54" font-family="Arial" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="7167" y="-203.54" font-family="Arial" font-size="14.00">GPUs 76&#45;77</text>
<text text-anchor="middle" x="7167" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="7167" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_39_stage_2 -->
<g id="node41" class="node">
<title>expert_39_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="7051.5,-233.74 6936.5,-233.74 6936.5,-165.74 7051.5,-165.74 7051.5,-233.74"/>
<text text-anchor="middle" x="6994" y="-218.54" font-family="Arial" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="6994" y="-203.54" font-family="Arial" font-size="14.00">GPUs 78&#45;79</text>
<text text-anchor="middle" x="6994" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6994" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_40_stage_2 -->
<g id="node42" class="node">
<title>expert_40_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6878.5,-233.74 6763.5,-233.74 6763.5,-165.74 6878.5,-165.74 6878.5,-233.74"/>
<text text-anchor="middle" x="6821" y="-218.54" font-family="Arial" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="6821" y="-203.54" font-family="Arial" font-size="14.00">GPUs 80&#45;81</text>
<text text-anchor="middle" x="6821" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6821" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_41_stage_2 -->
<g id="node43" class="node">
<title>expert_41_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6705.5,-233.74 6590.5,-233.74 6590.5,-165.74 6705.5,-165.74 6705.5,-233.74"/>
<text text-anchor="middle" x="6648" y="-218.54" font-family="Arial" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="6648" y="-203.54" font-family="Arial" font-size="14.00">GPUs 82&#45;83</text>
<text text-anchor="middle" x="6648" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6648" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_42_stage_2 -->
<g id="node44" class="node">
<title>expert_42_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6532.5,-233.74 6417.5,-233.74 6417.5,-165.74 6532.5,-165.74 6532.5,-233.74"/>
<text text-anchor="middle" x="6475" y="-218.54" font-family="Arial" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="6475" y="-203.54" font-family="Arial" font-size="14.00">GPUs 84&#45;85</text>
<text text-anchor="middle" x="6475" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6475" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_43_stage_2 -->
<g id="node45" class="node">
<title>expert_43_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6359.5,-233.74 6244.5,-233.74 6244.5,-165.74 6359.5,-165.74 6359.5,-233.74"/>
<text text-anchor="middle" x="6302" y="-218.54" font-family="Arial" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="6302" y="-203.54" font-family="Arial" font-size="14.00">GPUs 86&#45;87</text>
<text text-anchor="middle" x="6302" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6302" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_44_stage_2 -->
<g id="node46" class="node">
<title>expert_44_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6186.5,-233.74 6071.5,-233.74 6071.5,-165.74 6186.5,-165.74 6186.5,-233.74"/>
<text text-anchor="middle" x="6129" y="-218.54" font-family="Arial" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="6129" y="-203.54" font-family="Arial" font-size="14.00">GPUs 88&#45;89</text>
<text text-anchor="middle" x="6129" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="6129" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_45_stage_2 -->
<g id="node47" class="node">
<title>expert_45_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="6013.5,-233.74 5898.5,-233.74 5898.5,-165.74 6013.5,-165.74 6013.5,-233.74"/>
<text text-anchor="middle" x="5956" y="-218.54" font-family="Arial" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="5956" y="-203.54" font-family="Arial" font-size="14.00">GPUs 90&#45;91</text>
<text text-anchor="middle" x="5956" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5956" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_46_stage_2 -->
<g id="node48" class="node">
<title>expert_46_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="5840.5,-233.74 5725.5,-233.74 5725.5,-165.74 5840.5,-165.74 5840.5,-233.74"/>
<text text-anchor="middle" x="5783" y="-218.54" font-family="Arial" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="5783" y="-203.54" font-family="Arial" font-size="14.00">GPUs 92&#45;93</text>
<text text-anchor="middle" x="5783" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5783" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_47_stage_2 -->
<g id="node49" class="node">
<title>expert_47_stage_2</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="5667.5,-233.74 5552.5,-233.74 5552.5,-165.74 5667.5,-165.74 5667.5,-233.74"/>
<text text-anchor="middle" x="5610" y="-218.54" font-family="Arial" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="5610" y="-203.54" font-family="Arial" font-size="14.00">GPUs 94&#45;95</text>
<text text-anchor="middle" x="5610" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="5610" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_48_stage_3 -->
<g id="node50" class="node">
<title>expert_48_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="11030.5,-233.74 10915.5,-233.74 10915.5,-165.74 11030.5,-165.74 11030.5,-233.74"/>
<text text-anchor="middle" x="10973" y="-218.54" font-family="Arial" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="10973" y="-203.54" font-family="Arial" font-size="14.00">GPUs 96&#45;97</text>
<text text-anchor="middle" x="10973" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10973" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_49_stage_3 -->
<g id="node51" class="node">
<title>expert_49_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="10857.5,-233.74 10742.5,-233.74 10742.5,-165.74 10857.5,-165.74 10857.5,-233.74"/>
<text text-anchor="middle" x="10800" y="-218.54" font-family="Arial" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="10800" y="-203.54" font-family="Arial" font-size="14.00">GPUs 98&#45;99</text>
<text text-anchor="middle" x="10800" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10800" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_50_stage_3 -->
<g id="node52" class="node">
<title>expert_50_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="10684.5,-233.74 10569.5,-233.74 10569.5,-165.74 10684.5,-165.74 10684.5,-233.74"/>
<text text-anchor="middle" x="10627" y="-218.54" font-family="Arial" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="10627" y="-203.54" font-family="Arial" font-size="14.00">GPUs 100&#45;101</text>
<text text-anchor="middle" x="10627" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10627" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_51_stage_3 -->
<g id="node53" class="node">
<title>expert_51_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="10511.5,-233.74 10396.5,-233.74 10396.5,-165.74 10511.5,-165.74 10511.5,-233.74"/>
<text text-anchor="middle" x="10454" y="-218.54" font-family="Arial" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="10454" y="-203.54" font-family="Arial" font-size="14.00">GPUs 102&#45;103</text>
<text text-anchor="middle" x="10454" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10454" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_52_stage_3 -->
<g id="node54" class="node">
<title>expert_52_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="10338.5,-233.74 10223.5,-233.74 10223.5,-165.74 10338.5,-165.74 10338.5,-233.74"/>
<text text-anchor="middle" x="10281" y="-218.54" font-family="Arial" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="10281" y="-203.54" font-family="Arial" font-size="14.00">GPUs 104&#45;105</text>
<text text-anchor="middle" x="10281" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10281" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_53_stage_3 -->
<g id="node55" class="node">
<title>expert_53_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="10165.5,-233.74 10050.5,-233.74 10050.5,-165.74 10165.5,-165.74 10165.5,-233.74"/>
<text text-anchor="middle" x="10108" y="-218.54" font-family="Arial" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="10108" y="-203.54" font-family="Arial" font-size="14.00">GPUs 106&#45;107</text>
<text text-anchor="middle" x="10108" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="10108" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_54_stage_3 -->
<g id="node56" class="node">
<title>expert_54_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9992.5,-233.74 9877.5,-233.74 9877.5,-165.74 9992.5,-165.74 9992.5,-233.74"/>
<text text-anchor="middle" x="9935" y="-218.54" font-family="Arial" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="9935" y="-203.54" font-family="Arial" font-size="14.00">GPUs 108&#45;109</text>
<text text-anchor="middle" x="9935" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9935" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_55_stage_3 -->
<g id="node57" class="node">
<title>expert_55_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9819.5,-233.74 9704.5,-233.74 9704.5,-165.74 9819.5,-165.74 9819.5,-233.74"/>
<text text-anchor="middle" x="9762" y="-218.54" font-family="Arial" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="9762" y="-203.54" font-family="Arial" font-size="14.00">GPUs 110&#45;111</text>
<text text-anchor="middle" x="9762" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9762" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_56_stage_3 -->
<g id="node58" class="node">
<title>expert_56_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9646.5,-233.74 9531.5,-233.74 9531.5,-165.74 9646.5,-165.74 9646.5,-233.74"/>
<text text-anchor="middle" x="9589" y="-218.54" font-family="Arial" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="9589" y="-203.54" font-family="Arial" font-size="14.00">GPUs 112&#45;113</text>
<text text-anchor="middle" x="9589" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9589" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_57_stage_3 -->
<g id="node59" class="node">
<title>expert_57_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9473.5,-233.74 9358.5,-233.74 9358.5,-165.74 9473.5,-165.74 9473.5,-233.74"/>
<text text-anchor="middle" x="9416" y="-218.54" font-family="Arial" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="9416" y="-203.54" font-family="Arial" font-size="14.00">GPUs 114&#45;115</text>
<text text-anchor="middle" x="9416" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9416" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_58_stage_3 -->
<g id="node60" class="node">
<title>expert_58_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9300.5,-233.74 9185.5,-233.74 9185.5,-165.74 9300.5,-165.74 9300.5,-233.74"/>
<text text-anchor="middle" x="9243" y="-218.54" font-family="Arial" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="9243" y="-203.54" font-family="Arial" font-size="14.00">GPUs 116&#45;117</text>
<text text-anchor="middle" x="9243" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9243" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_59_stage_3 -->
<g id="node61" class="node">
<title>expert_59_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="9127.5,-233.74 9012.5,-233.74 9012.5,-165.74 9127.5,-165.74 9127.5,-233.74"/>
<text text-anchor="middle" x="9070" y="-218.54" font-family="Arial" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="9070" y="-203.54" font-family="Arial" font-size="14.00">GPUs 118&#45;119</text>
<text text-anchor="middle" x="9070" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="9070" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_60_stage_3 -->
<g id="node62" class="node">
<title>expert_60_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8954.5,-233.74 8839.5,-233.74 8839.5,-165.74 8954.5,-165.74 8954.5,-233.74"/>
<text text-anchor="middle" x="8897" y="-218.54" font-family="Arial" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="8897" y="-203.54" font-family="Arial" font-size="14.00">GPUs 120&#45;121</text>
<text text-anchor="middle" x="8897" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8897" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_61_stage_3 -->
<g id="node63" class="node">
<title>expert_61_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8781.5,-233.74 8666.5,-233.74 8666.5,-165.74 8781.5,-165.74 8781.5,-233.74"/>
<text text-anchor="middle" x="8724" y="-218.54" font-family="Arial" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="8724" y="-203.54" font-family="Arial" font-size="14.00">GPUs 122&#45;123</text>
<text text-anchor="middle" x="8724" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8724" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_62_stage_3 -->
<g id="node64" class="node">
<title>expert_62_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8608.5,-233.74 8493.5,-233.74 8493.5,-165.74 8608.5,-165.74 8608.5,-233.74"/>
<text text-anchor="middle" x="8551" y="-218.54" font-family="Arial" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="8551" y="-203.54" font-family="Arial" font-size="14.00">GPUs 124&#45;125</text>
<text text-anchor="middle" x="8551" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8551" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- expert_63_stage_3 -->
<g id="node65" class="node">
<title>expert_63_stage_3</title>
<polygon fill="lightcyan" stroke="black" stroke-width="2" points="8435.5,-233.74 8320.5,-233.74 8320.5,-165.74 8435.5,-165.74 8435.5,-233.74"/>
<text text-anchor="middle" x="8378" y="-218.54" font-family="Arial" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="8378" y="-203.54" font-family="Arial" font-size="14.00">GPUs 126&#45;127</text>
<text text-anchor="middle" x="8378" y="-188.54" font-family="Arial" font-size="14.00">(Tensor Parallel)</text>
<text text-anchor="middle" x="8378" y="-173.54" font-family="Arial" font-size="14.00">4 Layers</text>
</g>
<!-- moe_gate&#45;&gt;expert_0_stage_0 -->
<g id="edge2" class="edge">
<title>moe_gate&#45;&gt;expert_0_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5372.27,-397C4781.69,-397 2669,-397 2669,-397 2669,-397 2669,-244.1 2669,-244.1"/>
<polygon fill="red" stroke="red" stroke-width="2" points="2672.5,-244.1 2669,-234.1 2665.5,-244.1 2672.5,-244.1"/>
</g>
<!-- moe_gate&#45;&gt;expert_1_stage_0 -->
<g id="edge3" class="edge">
<title>moe_gate&#45;&gt;expert_1_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5374.62,-400C4764.77,-400 2496,-400 2496,-400 2496,-400 2496,-244.17 2496,-244.17"/>
<polygon fill="red" stroke="red" stroke-width="2" points="2499.5,-244.17 2496,-234.17 2492.5,-244.17 2499.5,-244.17"/>
</g>
<!-- moe_gate&#45;&gt;expert_2_stage_0 -->
<g id="edge4" class="edge">
<title>moe_gate&#45;&gt;expert_2_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5376.82,-403C4748.53,-403 2323,-403 2323,-403 2323,-403 2323,-243.76 2323,-243.76"/>
<polygon fill="red" stroke="red" stroke-width="2" points="2326.5,-243.76 2323,-233.76 2319.5,-243.76 2326.5,-243.76"/>
</g>
<!-- moe_gate&#45;&gt;expert_3_stage_0 -->
<g id="edge5" class="edge">
<title>moe_gate&#45;&gt;expert_3_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5379.56,-407C4734.66,-407 2150,-407 2150,-407 2150,-407 2150,-243.96 2150,-243.96"/>
<polygon fill="red" stroke="red" stroke-width="2" points="2153.5,-243.96 2150,-233.96 2146.5,-243.96 2153.5,-243.96"/>
</g>
<!-- moe_gate&#45;&gt;expert_4_stage_0 -->
<g id="edge6" class="edge">
<title>moe_gate&#45;&gt;expert_4_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5381.94,-410C4720.78,-410 1977,-410 1977,-410 1977,-410 1977,-243.99 1977,-243.99"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1980.5,-243.99 1977,-233.99 1973.5,-243.99 1980.5,-243.99"/>
</g>
<!-- moe_gate&#45;&gt;expert_5_stage_0 -->
<g id="edge7" class="edge">
<title>moe_gate&#45;&gt;expert_5_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5384.68,-414C4708.83,-414 1804,-414 1804,-414 1804,-414 1804,-244.16 1804,-244.16"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1807.5,-244.16 1804,-234.16 1800.5,-244.16 1807.5,-244.16"/>
</g>
<!-- moe_gate&#45;&gt;expert_6_stage_0 -->
<g id="edge8" class="edge">
<title>moe_gate&#45;&gt;expert_6_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5386.87,-417C4696.16,-417 1631,-417 1631,-417 1631,-417 1631,-244.17 1631,-244.17"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1634.5,-244.17 1631,-234.17 1627.5,-244.17 1634.5,-244.17"/>
</g>
<!-- moe_gate&#45;&gt;expert_7_stage_0 -->
<g id="edge9" class="edge">
<title>moe_gate&#45;&gt;expert_7_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5389.01,-420C4684.09,-420 1458,-420 1458,-420 1458,-420 1458,-244.16 1458,-244.16"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1461.5,-244.16 1458,-234.16 1454.5,-244.16 1461.5,-244.16"/>
</g>
<!-- moe_gate&#45;&gt;expert_8_stage_0 -->
<g id="edge10" class="edge">
<title>moe_gate&#45;&gt;expert_8_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5391.9,-424C4675.14,-424 1285,-424 1285,-424 1285,-424 1285,-243.8 1285,-243.8"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1288.5,-243.8 1285,-233.8 1281.5,-243.8 1288.5,-243.8"/>
</g>
<!-- moe_gate&#45;&gt;expert_9_stage_0 -->
<g id="edge11" class="edge">
<title>moe_gate&#45;&gt;expert_9_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5394.35,-427C4665.58,-427 1112,-427 1112,-427 1112,-427 1112,-243.76 1112,-243.76"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1115.5,-243.76 1112,-233.76 1108.5,-243.76 1115.5,-243.76"/>
</g>
<!-- moe_gate&#45;&gt;expert_10_stage_0 -->
<g id="edge12" class="edge">
<title>moe_gate&#45;&gt;expert_10_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5397.19,-431C4658.09,-431 939,-431 939,-431 939,-431 939,-243.86 939,-243.86"/>
<polygon fill="red" stroke="red" stroke-width="2" points="942.5,-243.86 939,-233.86 935.5,-243.86 942.5,-243.86"/>
</g>
<!-- moe_gate&#45;&gt;expert_11_stage_0 -->
<g id="edge13" class="edge">
<title>moe_gate&#45;&gt;expert_11_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5399.18,-434C4648.47,-434 766,-434 766,-434 766,-434 766,-243.8 766,-243.8"/>
<polygon fill="red" stroke="red" stroke-width="2" points="769.5,-243.8 766,-233.8 762.5,-243.8 769.5,-243.8"/>
</g>
<!-- moe_gate&#45;&gt;expert_12_stage_0 -->
<g id="edge14" class="edge">
<title>moe_gate&#45;&gt;expert_12_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5402.11,-438C4642.78,-438 593,-438 593,-438 593,-438 593,-243.88 593,-243.88"/>
<polygon fill="red" stroke="red" stroke-width="2" points="596.5,-243.88 593,-233.88 589.5,-243.88 596.5,-243.88"/>
</g>
<!-- moe_gate&#45;&gt;expert_13_stage_0 -->
<g id="edge15" class="edge">
<title>moe_gate&#45;&gt;expert_13_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5404.42,-441C4635.61,-441 420,-441 420,-441 420,-441 420,-243.8 420,-243.8"/>
<polygon fill="red" stroke="red" stroke-width="2" points="423.5,-243.8 420,-233.8 416.5,-243.8 423.5,-243.8"/>
</g>
<!-- moe_gate&#45;&gt;expert_14_stage_0 -->
<g id="edge16" class="edge">
<title>moe_gate&#45;&gt;expert_14_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5406.7,-444C4628.94,-444 247,-444 247,-444 247,-444 247,-243.96 247,-243.96"/>
<polygon fill="red" stroke="red" stroke-width="2" points="250.5,-243.96 247,-233.96 243.5,-243.96 250.5,-243.96"/>
</g>
<!-- moe_gate&#45;&gt;expert_15_stage_0 -->
<g id="edge17" class="edge">
<title>moe_gate&#45;&gt;expert_15_stage_0</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5409.54,-448C4625.1,-448 74,-448 74,-448 74,-448 74,-244 74,-244"/>
<polygon fill="red" stroke="red" stroke-width="2" points="77.5,-244 74,-234 70.5,-244 77.5,-244"/>
</g>
<!-- moe_gate&#45;&gt;expert_16_stage_1 -->
<g id="edge18" class="edge">
<title>moe_gate&#45;&gt;expert_16_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5437,-345.67C5437,-345.67 5437,-243.89 5437,-243.89"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5440.5,-243.89 5437,-233.89 5433.5,-243.89 5440.5,-243.89"/>
</g>
<!-- moe_gate&#45;&gt;expert_17_stage_1 -->
<g id="edge19" class="edge">
<title>moe_gate&#45;&gt;expert_17_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5357.41,-345.74C5357.41,-286.56 5357.41,-199 5357.41,-199 5357.41,-199 5331.56,-199 5331.56,-199"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5331.56,-195.5 5321.56,-199 5331.56,-202.5 5331.56,-195.5"/>
</g>
<!-- moe_gate&#45;&gt;expert_18_stage_1 -->
<g id="edge20" class="edge">
<title>moe_gate&#45;&gt;expert_18_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5337.23,-349C5220.04,-349 5091,-349 5091,-349 5091,-349 5091,-243.98 5091,-243.98"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5094.5,-243.98 5091,-233.98 5087.5,-243.98 5094.5,-243.98"/>
</g>
<!-- moe_gate&#45;&gt;expert_19_stage_1 -->
<g id="edge21" class="edge">
<title>moe_gate&#45;&gt;expert_19_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5339.3,-352C5161.05,-352 4918,-352 4918,-352 4918,-352 4918,-243.91 4918,-243.91"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4921.5,-243.91 4918,-233.91 4914.5,-243.91 4921.5,-243.91"/>
</g>
<!-- moe_gate&#45;&gt;expert_20_stage_1 -->
<g id="edge22" class="edge">
<title>moe_gate&#45;&gt;expert_20_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5341.85,-355C5111.63,-355 4745,-355 4745,-355 4745,-355 4745,-243.81 4745,-243.81"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4748.5,-243.81 4745,-233.81 4741.5,-243.81 4748.5,-243.81"/>
</g>
<!-- moe_gate&#45;&gt;expert_21_stage_1 -->
<g id="edge23" class="edge">
<title>moe_gate&#45;&gt;expert_21_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5344.66,-359C5068.83,-359 4572,-359 4572,-359 4572,-359 4572,-243.91 4572,-243.91"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4575.5,-243.91 4572,-233.91 4568.5,-243.91 4575.5,-243.91"/>
</g>
<!-- moe_gate&#45;&gt;expert_22_stage_1 -->
<g id="edge24" class="edge">
<title>moe_gate&#45;&gt;expert_22_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5346.67,-362C5029.75,-362 4399,-362 4399,-362 4399,-362 4399,-243.76 4399,-243.76"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4402.5,-243.76 4399,-233.76 4395.5,-243.76 4402.5,-243.76"/>
</g>
<!-- moe_gate&#45;&gt;expert_23_stage_1 -->
<g id="edge25" class="edge">
<title>moe_gate&#45;&gt;expert_23_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5349.62,-366C4995.62,-366 4226,-366 4226,-366 4226,-366 4226,-243.79 4226,-243.79"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4229.5,-243.79 4226,-233.79 4222.5,-243.79 4229.5,-243.79"/>
</g>
<!-- moe_gate&#45;&gt;expert_24_stage_1 -->
<g id="edge26" class="edge">
<title>moe_gate&#45;&gt;expert_24_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5352.02,-369C4963.78,-369 4053,-369 4053,-369 4053,-369 4053,-243.99 4053,-243.99"/>
<polygon fill="red" stroke="red" stroke-width="2" points="4056.5,-243.99 4053,-233.99 4049.5,-243.99 4056.5,-243.99"/>
</g>
<!-- moe_gate&#45;&gt;expert_25_stage_1 -->
<g id="edge27" class="edge">
<title>moe_gate&#45;&gt;expert_25_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5354.64,-373C4934.86,-373 3880,-373 3880,-373 3880,-373 3880,-243.97 3880,-243.97"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3883.5,-243.97 3880,-233.97 3876.5,-243.97 3883.5,-243.97"/>
</g>
<!-- moe_gate&#45;&gt;expert_26_stage_1 -->
<g id="edge28" class="edge">
<title>moe_gate&#45;&gt;expert_26_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5357.13,-376C4907.95,-376 3707,-376 3707,-376 3707,-376 3707,-244.14 3707,-244.14"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3710.5,-244.14 3707,-234.14 3703.5,-244.14 3710.5,-244.14"/>
</g>
<!-- moe_gate&#45;&gt;expert_27_stage_1 -->
<g id="edge29" class="edge">
<title>moe_gate&#45;&gt;expert_27_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5359.03,-379C4881.88,-379 3534,-379 3534,-379 3534,-379 3534,-243.88 3534,-243.88"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3537.5,-243.88 3534,-233.88 3530.5,-243.88 3537.5,-243.88"/>
</g>
<!-- moe_gate&#45;&gt;expert_28_stage_1 -->
<g id="edge30" class="edge">
<title>moe_gate&#45;&gt;expert_28_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5361.87,-383C4859.27,-383 3361,-383 3361,-383 3361,-383 3361,-243.78 3361,-243.78"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3364.5,-243.78 3361,-233.78 3357.5,-243.78 3364.5,-243.78"/>
</g>
<!-- moe_gate&#45;&gt;expert_29_stage_1 -->
<g id="edge31" class="edge">
<title>moe_gate&#45;&gt;expert_29_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5364.36,-386C4837.58,-386 3188,-386 3188,-386 3188,-386 3188,-243.9 3188,-243.9"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3191.5,-243.9 3188,-233.9 3184.5,-243.9 3191.5,-243.9"/>
</g>
<!-- moe_gate&#45;&gt;expert_30_stage_1 -->
<g id="edge32" class="edge">
<title>moe_gate&#45;&gt;expert_30_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5367.05,-390C4817.77,-390 3015,-390 3015,-390 3015,-390 3015,-243.75 3015,-243.75"/>
<polygon fill="red" stroke="red" stroke-width="2" points="3018.5,-243.75 3015,-233.75 3011.5,-243.75 3018.5,-243.75"/>
</g>
<!-- moe_gate&#45;&gt;expert_31_stage_1 -->
<g id="edge33" class="edge">
<title>moe_gate&#45;&gt;expert_31_stage_1</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5369.19,-393C4798.04,-393 2842,-393 2842,-393 2842,-393 2842,-243.85 2842,-243.85"/>
<polygon fill="red" stroke="red" stroke-width="2" points="2845.5,-243.85 2842,-233.85 2838.5,-243.85 2845.5,-243.85"/>
</g>
<!-- moe_gate&#45;&gt;expert_32_stage_2 -->
<g id="edge34" class="edge">
<title>moe_gate&#45;&gt;expert_32_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5658.79,-377C6202.45,-377 8205,-377 8205,-377 8205,-377 8205,-243.92 8205,-243.92"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8208.5,-243.92 8205,-233.92 8201.5,-243.92 8208.5,-243.92"/>
</g>
<!-- moe_gate&#45;&gt;expert_33_stage_2 -->
<g id="edge35" class="edge">
<title>moe_gate&#45;&gt;expert_33_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5656.63,-374C6174.51,-374 8032,-374 8032,-374 8032,-374 8032,-243.75 8032,-243.75"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8035.5,-243.75 8032,-233.75 8028.5,-243.75 8035.5,-243.75"/>
</g>
<!-- moe_gate&#45;&gt;expert_34_stage_2 -->
<g id="edge36" class="edge">
<title>moe_gate&#45;&gt;expert_34_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5652.87,-369C6142.37,-369 7859,-369 7859,-369 7859,-369 7859,-243.99 7859,-243.99"/>
<polygon fill="red" stroke="red" stroke-width="2" points="7862.5,-243.99 7859,-233.99 7855.5,-243.99 7862.5,-243.99"/>
</g>
<!-- moe_gate&#45;&gt;expert_35_stage_2 -->
<g id="edge37" class="edge">
<title>moe_gate&#45;&gt;expert_35_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5651.17,-367C6114.61,-367 7686,-367 7686,-367 7686,-367 7686,-243.99 7686,-243.99"/>
<polygon fill="red" stroke="red" stroke-width="2" points="7689.5,-243.99 7686,-233.99 7682.5,-243.99 7689.5,-243.99"/>
</g>
<!-- moe_gate&#45;&gt;expert_36_stage_2 -->
<g id="edge38" class="edge">
<title>moe_gate&#45;&gt;expert_36_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5649.93,-365C6087.15,-365 7513,-365 7513,-365 7513,-365 7513,-243.98 7513,-243.98"/>
<polygon fill="red" stroke="red" stroke-width="2" points="7516.5,-243.98 7513,-233.98 7509.5,-243.98 7516.5,-243.98"/>
</g>
<!-- moe_gate&#45;&gt;expert_37_stage_2 -->
<g id="edge39" class="edge">
<title>moe_gate&#45;&gt;expert_37_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5648.46,-363C6058.36,-363 7340,-363 7340,-363 7340,-363 7340,-243.96 7340,-243.96"/>
<polygon fill="red" stroke="red" stroke-width="2" points="7343.5,-243.96 7340,-233.96 7336.5,-243.96 7343.5,-243.96"/>
</g>
<!-- moe_gate&#45;&gt;expert_38_stage_2 -->
<g id="edge40" class="edge">
<title>moe_gate&#45;&gt;expert_38_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5646.82,-361C6028.26,-361 7167,-361 7167,-361 7167,-361 7167,-243.94 7167,-243.94"/>
<polygon fill="red" stroke="red" stroke-width="2" points="7170.5,-243.94 7167,-233.94 7163.5,-243.94 7170.5,-243.94"/>
</g>
<!-- moe_gate&#45;&gt;expert_39_stage_2 -->
<g id="edge41" class="edge">
<title>moe_gate&#45;&gt;expert_39_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5645.55,-359C5997.74,-359 6994,-359 6994,-359 6994,-359 6994,-243.91 6994,-243.91"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6997.5,-243.91 6994,-233.91 6990.5,-243.91 6997.5,-243.91"/>
</g>
<!-- moe_gate&#45;&gt;expert_40_stage_2 -->
<g id="edge42" class="edge">
<title>moe_gate&#45;&gt;expert_40_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5643.98,-357C5965.29,-357 6821,-357 6821,-357 6821,-357 6821,-243.86 6821,-243.86"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6824.5,-243.86 6821,-233.86 6817.5,-243.86 6824.5,-243.86"/>
</g>
<!-- moe_gate&#45;&gt;expert_41_stage_2 -->
<g id="edge43" class="edge">
<title>moe_gate&#45;&gt;expert_41_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5642.43,-355C5931.18,-355 6648,-355 6648,-355 6648,-355 6648,-243.81 6648,-243.81"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6651.5,-243.81 6648,-233.81 6644.5,-243.81 6651.5,-243.81"/>
</g>
<!-- moe_gate&#45;&gt;expert_42_stage_2 -->
<g id="edge44" class="edge">
<title>moe_gate&#45;&gt;expert_42_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5641.09,-353C5895.28,-353 6475,-353 6475,-353 6475,-353 6475,-243.75 6475,-243.75"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6478.5,-243.75 6475,-233.75 6471.5,-243.75 6478.5,-243.75"/>
</g>
<!-- moe_gate&#45;&gt;expert_43_stage_2 -->
<g id="edge45" class="edge">
<title>moe_gate&#45;&gt;expert_43_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5639.63,-351C5856.36,-351 6302,-351 6302,-351 6302,-351 6302,-244.06 6302,-244.06"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6305.5,-244.06 6302,-234.06 6298.5,-244.06 6305.5,-244.06"/>
</g>
<!-- moe_gate&#45;&gt;expert_44_stage_2 -->
<g id="edge46" class="edge">
<title>moe_gate&#45;&gt;expert_44_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5638.15,-349C5813.48,-349 6129,-349 6129,-349 6129,-349 6129,-243.98 6129,-243.98"/>
<polygon fill="red" stroke="red" stroke-width="2" points="6132.5,-243.98 6129,-233.98 6125.5,-243.98 6132.5,-243.98"/>
</g>
<!-- moe_gate&#45;&gt;expert_45_stage_2 -->
<g id="edge47" class="edge">
<title>moe_gate&#45;&gt;expert_45_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5636.66,-347C5764.66,-347 5956,-347 5956,-347 5956,-347 5956,-243.89 5956,-243.89"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5959.5,-243.89 5956,-233.89 5952.5,-243.89 5959.5,-243.89"/>
</g>
<!-- moe_gate&#45;&gt;expert_46_stage_2 -->
<g id="edge48" class="edge">
<title>moe_gate&#45;&gt;expert_46_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5690.09,-398.6C5690.09,-392.55 5690.09,-199 5690.09,-199 5690.09,-199 5715.48,-199 5715.48,-199"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5715.48,-202.5 5725.48,-199 5715.48,-195.5 5715.48,-202.5"/>
</g>
<!-- moe_gate&#45;&gt;expert_47_stage_2 -->
<g id="edge49" class="edge">
<title>moe_gate&#45;&gt;expert_47_stage_2</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5610,-345.67C5610,-345.67 5610,-243.89 5610,-243.89"/>
<polygon fill="red" stroke="red" stroke-width="2" points="5613.5,-243.89 5610,-233.89 5606.5,-243.89 5613.5,-243.89"/>
</g>
<!-- moe_gate&#45;&gt;expert_48_stage_3 -->
<g id="edge50" class="edge">
<title>moe_gate&#45;&gt;expert_48_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5691.55,-422C6608.02,-422 10973,-422 10973,-422 10973,-422 10973,-243.98 10973,-243.98"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10976.5,-243.98 10973,-233.98 10969.5,-243.98 10976.5,-243.98"/>
</g>
<!-- moe_gate&#45;&gt;expert_49_stage_3 -->
<g id="edge51" class="edge">
<title>moe_gate&#45;&gt;expert_49_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5689.15,-419C6582.83,-419 10800,-419 10800,-419 10800,-419 10800,-244 10800,-244"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10803.5,-244 10800,-234 10796.5,-244 10803.5,-244"/>
</g>
<!-- moe_gate&#45;&gt;expert_50_stage_3 -->
<g id="edge52" class="edge">
<title>moe_gate&#45;&gt;expert_50_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5687.65,-417C6560.35,-417 10627,-417 10627,-417 10627,-417 10627,-244.17 10627,-244.17"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10630.5,-244.17 10627,-234.17 10623.5,-244.17 10630.5,-244.17"/>
</g>
<!-- moe_gate&#45;&gt;expert_51_stage_3 -->
<g id="edge53" class="edge">
<title>moe_gate&#45;&gt;expert_51_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5685.58,-414C6535.95,-414 10454,-414 10454,-414 10454,-414 10454,-244.16 10454,-244.16"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10457.5,-244.16 10454,-234.16 10450.5,-244.16 10457.5,-244.16"/>
</g>
<!-- moe_gate&#45;&gt;expert_52_stage_3 -->
<g id="edge54" class="edge">
<title>moe_gate&#45;&gt;expert_52_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5683.29,-411C6510.79,-411 10281,-411 10281,-411 10281,-411 10281,-244.15 10281,-244.15"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10284.5,-244.15 10281,-234.15 10277.5,-244.15 10284.5,-244.15"/>
</g>
<!-- moe_gate&#45;&gt;expert_53_stage_3 -->
<g id="edge55" class="edge">
<title>moe_gate&#45;&gt;expert_53_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5681.13,-408C6485.85,-408 10108,-408 10108,-408 10108,-408 10108,-244.13 10108,-244.13"/>
<polygon fill="red" stroke="red" stroke-width="2" points="10111.5,-244.13 10108,-234.13 10104.5,-244.13 10111.5,-244.13"/>
</g>
<!-- moe_gate&#45;&gt;expert_54_stage_3 -->
<g id="edge56" class="edge">
<title>moe_gate&#45;&gt;expert_54_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5679.05,-405C6461.03,-405 9935,-405 9935,-405 9935,-405 9935,-244.1 9935,-244.1"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9938.5,-244.1 9935,-234.1 9931.5,-244.1 9938.5,-244.1"/>
</g>
<!-- moe_gate&#45;&gt;expert_55_stage_3 -->
<g id="edge57" class="edge">
<title>moe_gate&#45;&gt;expert_55_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5676.71,-402C6435.29,-402 9762,-402 9762,-402 9762,-402 9762,-244.05 9762,-244.05"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9765.5,-244.05 9762,-234.05 9758.5,-244.05 9765.5,-244.05"/>
</g>
<!-- moe_gate&#45;&gt;expert_56_stage_3 -->
<g id="edge58" class="edge">
<title>moe_gate&#45;&gt;expert_56_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5675.32,-400C6412.14,-400 9589,-400 9589,-400 9589,-400 9589,-244.17 9589,-244.17"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9592.5,-244.17 9589,-234.17 9585.5,-244.17 9592.5,-244.17"/>
</g>
<!-- moe_gate&#45;&gt;expert_57_stage_3 -->
<g id="edge59" class="edge">
<title>moe_gate&#45;&gt;expert_57_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5673,-397C6386.09,-397 9416,-397 9416,-397 9416,-397 9416,-244.1 9416,-244.1"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9419.5,-244.1 9416,-234.1 9412.5,-244.1 9419.5,-244.1"/>
</g>
<!-- moe_gate&#45;&gt;expert_58_stage_3 -->
<g id="edge60" class="edge">
<title>moe_gate&#45;&gt;expert_58_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5670.93,-394C6360.58,-394 9243,-394 9243,-394 9243,-394 9243,-244.02 9243,-244.02"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9246.5,-244.02 9243,-234.02 9239.5,-244.02 9246.5,-244.02"/>
</g>
<!-- moe_gate&#45;&gt;expert_59_stage_3 -->
<g id="edge61" class="edge">
<title>moe_gate&#45;&gt;expert_59_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5668.78,-391C6334.6,-391 9070,-391 9070,-391 9070,-391 9070,-243.93 9070,-243.93"/>
<polygon fill="red" stroke="red" stroke-width="2" points="9073.5,-243.93 9070,-233.93 9066.5,-243.93 9073.5,-243.93"/>
</g>
<!-- moe_gate&#45;&gt;expert_60_stage_3 -->
<g id="edge62" class="edge">
<title>moe_gate&#45;&gt;expert_60_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5666.51,-388C6308.06,-388 8897,-388 8897,-388 8897,-388 8897,-243.83 8897,-243.83"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8900.5,-243.83 8897,-233.83 8893.5,-243.83 8900.5,-243.83"/>
</g>
<!-- moe_gate&#45;&gt;expert_61_stage_3 -->
<g id="edge63" class="edge">
<title>moe_gate&#45;&gt;expert_61_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5665.11,-386C6283.56,-386 8724,-386 8724,-386 8724,-386 8724,-243.9 8724,-243.9"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8727.5,-243.9 8724,-233.9 8720.5,-243.9 8727.5,-243.9"/>
</g>
<!-- moe_gate&#45;&gt;expert_62_stage_3 -->
<g id="edge64" class="edge">
<title>moe_gate&#45;&gt;expert_62_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5662.93,-383C6256.67,-383 8551,-383 8551,-383 8551,-383 8551,-243.78 8551,-243.78"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8554.5,-243.78 8551,-233.78 8547.5,-243.78 8554.5,-243.78"/>
</g>
<!-- moe_gate&#45;&gt;expert_63_stage_3 -->
<g id="edge65" class="edge">
<title>moe_gate&#45;&gt;expert_63_stage_3</title>
<path fill="none" stroke="red" stroke-width="2" stroke-dasharray="5,2" d="M5660.69,-380C6229.33,-380 8378,-380 8378,-380 8378,-380 8378,-244.07 8378,-244.07"/>
<polygon fill="red" stroke="red" stroke-width="2" points="8381.5,-244.07 8378,-234.07 8374.5,-244.07 8381.5,-244.07"/>
</g>
<!-- allreduce_attn -->
<g id="node67" class="node">
<title>allreduce_attn</title>
<ellipse fill="yellow" stroke="black" stroke-width="2" stroke-dasharray="5,2" cx="11268" cy="-586.61" rx="86.03" ry="26.74"/>
<text text-anchor="middle" x="11268" y="-590.41" font-family="Arial" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11268" y="-575.41" font-family="Arial" font-size="14.00">Attention Outputs</text>
</g>
<!-- allreduce_mlp -->
<g id="node68" class="node">
<title>allreduce_mlp</title>
<ellipse fill="yellow" stroke="black" stroke-width="2" stroke-dasharray="5,2" cx="11268" cy="-398.74" rx="68.68" ry="26.74"/>
<text text-anchor="middle" x="11268" y="-402.54" font-family="Arial" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11268" y="-387.54" font-family="Arial" font-size="14.00">MLP Outputs</text>
</g>
<!-- allreduce_attn&#45;&gt;allreduce_mlp -->
<g id="edge66" class="edge">
<title>allreduce_attn&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="blue" stroke-width="2" stroke-dasharray="5,2" d="M11268,-559.69C11268,-559.69 11268,-435.91 11268,-435.91"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="11271.5,-435.91 11268,-425.91 11264.5,-435.91 11271.5,-435.91"/>
</g>
<!-- expert_agg -->
<g id="node69" class="node">
<title>expert_agg</title>
<polygon fill="orange" stroke="black" stroke-width="3" stroke-dasharray="5,2" points="11447.22,-237.74 11162.12,-237.74 11088.78,-161.74 11373.88,-161.74 11447.22,-237.74"/>
<text text-anchor="middle" x="11268" y="-203.54" font-family="Arial" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11268" y="-188.54" font-family="Arial" font-size="14.00">Top&#45;2 Expert Combination</text>
</g>
<!-- allreduce_mlp&#45;&gt;expert_agg -->
<g id="edge67" class="edge">
<title>allreduce_mlp&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" stroke-width="2" d="M11268,-371.49C11268,-371.49 11268,-247.89 11268,-247.89"/>
<polygon fill="black" stroke="black" stroke-width="2" points="11271.5,-247.89 11268,-237.89 11264.5,-247.89 11271.5,-247.89"/>
</g>
<!-- output -->
<g id="node70" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" stroke-width="2" cx="11268" cy="-26.87" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="11268" y="-30.67" font-family="Arial" font-size="14.00">Output Logits</text>
<text text-anchor="middle" x="11268" y="-15.67" font-family="Arial" font-size="14.00">[vocab_size]</text>
</g>
<!-- expert_agg&#45;&gt;output -->
<g id="edge68" class="edge">
<title>expert_agg&#45;&gt;output</title>
<path fill="none" stroke="black" stroke-width="3" d="M11268,-161.37C11268,-161.37 11268,-63.86 11268,-63.86"/>
<polygon fill="black" stroke="black" stroke-width="3" points="11271.5,-63.86 11268,-53.86 11264.5,-63.86 11271.5,-63.86"/>
</g>
</g>
</svg>
