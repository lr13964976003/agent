{
  "memory": {
    "model_memory_gb": 60.0,
    "activation_memory_gb": 42.94967296,
    "checkpointed_activation_gb": 21.47483648,
    "total_memory_gb": 81.47483648
  },
  "distribution": {
    "total_gpus": 512,
    "memory_per_gpu_gb": 0.15913054,
    "params_per_gpu_gb": 0.1171875,
    "layers_per_gpu": 4.0,
    "experts_per_gpu": 1.0,
    "expert_parallel_degree": 64,
    "tensor_parallel_degree": 2,
    "pipeline_parallel_degree": 4
  },
  "balance": {
    "expert_balance": true,
    "layer_balance": true,
    "memory_balance": true,
    "param_balance": true,
    "overall_balance": true
  },
  "performance": {
    "effective_flops_per_gpu": 240.0,
    "total_system_flops": 122.88,
    "effective_bandwidth_per_gpu": 1.44,
    "theoretical_throughput": 2048000.0,
    "estimated_latency_ms": 0.00048828125,
    "total_gpus": 512
  },
  "mapping_sample": [
    {
      "pipeline_stage": 0,
      "expert_id": 0,
      "tensor_parallel_rank": 0,
      "gpu_id": 0,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        0,
        1
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 0,
      "tensor_parallel_rank": 1,
      "gpu_id": 1,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        0,
        1
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 1,
      "tensor_parallel_rank": 0,
      "gpu_id": 2,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        2,
        3
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 1,
      "tensor_parallel_rank": 1,
      "gpu_id": 3,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        2,
        3
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 2,
      "tensor_parallel_rank": 0,
      "gpu_id": 4,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        4,
        5
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 2,
      "tensor_parallel_rank": 1,
      "gpu_id": 5,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        4,
        5
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 3,
      "tensor_parallel_rank": 0,
      "gpu_id": 6,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        6,
        7
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 3,
      "tensor_parallel_rank": 1,
      "gpu_id": 7,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        6,
        7
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 4,
      "tensor_parallel_rank": 0,
      "gpu_id": 8,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        8,
        9
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 4,
      "tensor_parallel_rank": 1,
      "gpu_id": 9,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        8,
        9
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 5,
      "tensor_parallel_rank": 0,
      "gpu_id": 10,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        10,
        11
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 5,
      "tensor_parallel_rank": 1,
      "gpu_id": 11,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        10,
        11
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 6,
      "tensor_parallel_rank": 0,
      "gpu_id": 12,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        12,
        13
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 6,
      "tensor_parallel_rank": 1,
      "gpu_id": 13,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        12,
        13
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 7,
      "tensor_parallel_rank": 0,
      "gpu_id": 14,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        14,
        15
      ]
    },
    {
      "pipeline_stage": 0,
      "expert_id": 7,
      "tensor_parallel_rank": 1,
      "gpu_id": 15,
      "layers": [
        0,
        1,
        2,
        3
      ],
      "tensor_parallel_group": [
        14,
        15
      ]
    }
  ]
}