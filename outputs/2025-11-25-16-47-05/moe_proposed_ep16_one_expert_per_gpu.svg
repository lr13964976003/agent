<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Proposed_EP16_OneExpertPerGPU Pages: 1 -->
<svg width="2160pt" height="962pt"
 viewBox="0.00 0.00 2160.00 961.61" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.39 0.39) rotate(0) translate(4 2475.48)">
<title>MoE_Proposed_EP16_OneExpertPerGPU</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2475.48 5565.5,-2475.48 5565.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4250.5" cy="-2444.61" rx="258.19" ry="26.74"/>
<text text-anchor="middle" x="4250.5" y="-2448.41" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4250.5" y="-2433.41" font-family="Times,serif" font-size="14.00">batch_size=128, seq_len=10000, d_model=4096</text>
</g>
<!-- l0_attn_gpu0 -->
<g id="node2" class="node">
<title>l0_attn_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="4451,-2381.74 4050,-2381.74 4050,-2328.74 4451,-2328.74 4451,-2381.74"/>
<text text-anchor="middle" x="4250.5" y="-2366.54" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="4250.5" y="-2351.54" font-family="Times,serif" font-size="14.00">All heads on GPU 0</text>
<text text-anchor="middle" x="4250.5" y="-2336.54" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], Output: [128,10000,4096]</text>
</g>
<!-- input&#45;&gt;l0_attn_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_attn_gpu0</title>
<path fill="none" stroke="black" d="M4250.5,-2417.4C4250.5,-2409.39 4250.5,-2400.45 4250.5,-2391.93"/>
<polygon fill="black" stroke="black" points="4254,-2391.83 4250.5,-2381.83 4247,-2391.83 4254,-2391.83"/>
</g>
<!-- l0_gate_gpu0 -->
<g id="node3" class="node">
<title>l0_gate_gpu0</title>
<polygon fill="lightpink" stroke="black" points="4423.96,-2292.74 3829.87,-2292.74 3677.04,-2186.74 4271.13,-2186.74 4423.96,-2292.74"/>
<text text-anchor="middle" x="4050.5" y="-2251.04" font-family="Times,serif" font-size="14.00">Gate Layer 0</text>
<text text-anchor="middle" x="4050.5" y="-2236.04" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="4050.5" y="-2221.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,2]</text>
</g>
<!-- l0_attn_gpu0&#45;&gt;l0_gate_gpu0 -->
<g id="edge2" class="edge">
<title>l0_attn_gpu0&#45;&gt;l0_gate_gpu0</title>
<path fill="none" stroke="black" d="M4205.12,-2328.49C4188.93,-2319.3 4169.98,-2308.54 4151.01,-2297.78"/>
<polygon fill="black" stroke="black" points="4152.73,-2294.73 4142.3,-2292.84 4149.27,-2300.82 4152.73,-2294.73"/>
</g>
<!-- l0_residual -->
<g id="node22" class="node">
<title>l0_residual</title>
<polygon fill="lightgreen" stroke="black" points="4250.5,-1747.74 3723.5,-1694.74 4250.5,-1641.74 4777.5,-1694.74 4250.5,-1747.74"/>
<text text-anchor="middle" x="4250.5" y="-1706.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4250.5" y="-1691.04" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="4250.5" y="-1676.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]+[128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_gpu0&#45;&gt;l0_residual -->
<g id="edge37" class="edge">
<title>l0_attn_gpu0&#45;&gt;l0_residual</title>
<path fill="none" stroke="black" d="M4451.04,-2353.88C4818.29,-2347.76 5561.5,-2307.71 5561.5,-2083.74 5561.5,-2083.74 5561.5,-2083.74 5561.5,-1951.24 5561.5,-1846.7 4910.92,-1762.65 4526.36,-1722.11"/>
<polygon fill="black" stroke="black" points="4526.51,-1718.6 4516.2,-1721.04 4525.77,-1725.56 4526.51,-1718.6"/>
</g>
<!-- l0_route -->
<g id="node4" class="node">
<title>l0_route</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-2150.74 2792.34,-2150.74 2689.71,-2014.74 3088.66,-2014.74 3191.29,-2150.74"/>
<text text-anchor="middle" x="2940.5" y="-2101.54" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="2940.5" y="-2086.54" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2940.5" y="-2071.54" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="2940.5" y="-2056.54" font-family="Times,serif" font-size="14.00">[128,10000,4096] → 16 experts</text>
</g>
<!-- l0_gate_gpu0&#45;&gt;l0_route -->
<g id="edge3" class="edge">
<title>l0_gate_gpu0&#45;&gt;l0_route</title>
<path fill="none" stroke="black" d="M3677.8,-2186.7C3511.41,-2163.46 3320.44,-2136.79 3174.54,-2116.42"/>
<polygon fill="black" stroke="black" points="3174.95,-2112.94 3164.56,-2115.03 3173.98,-2119.88 3174.95,-2112.94"/>
</g>
<!-- l0_expert0_gpu1 -->
<g id="node5" class="node">
<title>l0_expert0_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="329,-1978.74 0,-1978.74 0,-1925.74 329,-1925.74 329,-1978.74"/>
<text text-anchor="middle" x="164.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 0 Layer 0</text>
<text text-anchor="middle" x="164.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="164.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert0_gpu1 -->
<g id="edge4" class="edge">
<title>l0_route&#45;&gt;l0_expert0_gpu1</title>
<path fill="none" stroke="black" d="M2739.58,-2081.09C2303.67,-2078.08 1238.62,-2062.11 339.51,-1978.89"/>
<polygon fill="black" stroke="black" points="339.56,-1975.38 329.28,-1977.94 338.91,-1982.35 339.56,-1975.38"/>
</g>
<!-- l0_expert1_gpu2 -->
<g id="node6" class="node">
<title>l0_expert1_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="676,-1978.74 347,-1978.74 347,-1925.74 676,-1925.74 676,-1978.74"/>
<text text-anchor="middle" x="511.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 1 Layer 0</text>
<text text-anchor="middle" x="511.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="511.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert1_gpu2 -->
<g id="edge5" class="edge">
<title>l0_route&#45;&gt;l0_expert1_gpu2</title>
<path fill="none" stroke="black" d="M2738.17,-2079.33C2344.46,-2073.13 1447.84,-2051.66 686.35,-1978.88"/>
<polygon fill="black" stroke="black" points="686.57,-1975.39 676.28,-1977.92 685.9,-1982.36 686.57,-1975.39"/>
</g>
<!-- l0_expert2_gpu3 -->
<g id="node7" class="node">
<title>l0_expert2_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="1023,-1978.74 694,-1978.74 694,-1925.74 1023,-1925.74 1023,-1978.74"/>
<text text-anchor="middle" x="858.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 2 Layer 0</text>
<text text-anchor="middle" x="858.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="858.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert2_gpu3 -->
<g id="edge6" class="edge">
<title>l0_route&#45;&gt;l0_expert2_gpu3</title>
<path fill="none" stroke="black" d="M2736.61,-2076.92C2388.82,-2067.33 1658.6,-2041.23 1033.4,-1978.9"/>
<polygon fill="black" stroke="black" points="1033.58,-1975.4 1023.28,-1977.89 1032.88,-1982.36 1033.58,-1975.4"/>
</g>
<!-- l0_expert3_gpu4 -->
<g id="node8" class="node">
<title>l0_expert3_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="1370,-1978.74 1041,-1978.74 1041,-1925.74 1370,-1925.74 1370,-1978.74"/>
<text text-anchor="middle" x="1205.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 3 Layer 0</text>
<text text-anchor="middle" x="1205.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1205.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert3_gpu4 -->
<g id="edge7" class="edge">
<title>l0_route&#45;&gt;l0_expert3_gpu4</title>
<path fill="none" stroke="black" d="M2733.8,-2073.41C2436.41,-2060.24 1870.54,-2030.72 1380.4,-1978.91"/>
<polygon fill="black" stroke="black" points="1380.6,-1975.41 1370.29,-1977.84 1379.86,-1982.38 1380.6,-1975.41"/>
</g>
<!-- l0_expert4_gpu5 -->
<g id="node9" class="node">
<title>l0_expert4_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="1717,-1978.74 1388,-1978.74 1388,-1925.74 1717,-1925.74 1717,-1978.74"/>
<text text-anchor="middle" x="1552.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 4 Layer 0</text>
<text text-anchor="middle" x="1552.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1552.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert4_gpu5 -->
<g id="edge8" class="edge">
<title>l0_route&#45;&gt;l0_expert4_gpu5</title>
<path fill="none" stroke="black" d="M2729.66,-2067.84C2489.28,-2051.07 2084.4,-2020.06 1727.31,-1978.93"/>
<polygon fill="black" stroke="black" points="1727.63,-1975.44 1717.29,-1977.77 1726.83,-1982.39 1727.63,-1975.44"/>
</g>
<!-- l0_expert5_gpu6 -->
<g id="node10" class="node">
<title>l0_expert5_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="2064,-1978.74 1735,-1978.74 1735,-1925.74 2064,-1925.74 2064,-1978.74"/>
<text text-anchor="middle" x="1899.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 5 Layer 0</text>
<text text-anchor="middle" x="1899.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1899.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert5_gpu6 -->
<g id="edge9" class="edge">
<title>l0_route&#45;&gt;l0_expert5_gpu6</title>
<path fill="none" stroke="black" d="M2721.79,-2057.52C2548.72,-2037.94 2300.64,-2008.96 2074.39,-1978.98"/>
<polygon fill="black" stroke="black" points="2074.68,-1975.49 2064.31,-1977.64 2073.76,-1982.43 2074.68,-1975.49"/>
</g>
<!-- l0_expert6_gpu7 -->
<g id="node11" class="node">
<title>l0_expert6_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="2411,-1978.74 2082,-1978.74 2082,-1925.74 2411,-1925.74 2411,-1978.74"/>
<text text-anchor="middle" x="2246.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 6 Layer 0</text>
<text text-anchor="middle" x="2246.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2246.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert6_gpu7 -->
<g id="edge10" class="edge">
<title>l0_route&#45;&gt;l0_expert6_gpu7</title>
<path fill="none" stroke="black" d="M2707.48,-2038.59C2603.95,-2019.42 2485.19,-1997.43 2394.14,-1980.58"/>
<polygon fill="black" stroke="black" points="2394.77,-1977.13 2384.3,-1978.75 2393.49,-1984.02 2394.77,-1977.13"/>
</g>
<!-- l0_expert7_gpu8 -->
<g id="node12" class="node">
<title>l0_expert7_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="2758,-1978.74 2429,-1978.74 2429,-1925.74 2758,-1925.74 2758,-1978.74"/>
<text text-anchor="middle" x="2593.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 7 Layer 0</text>
<text text-anchor="middle" x="2593.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2593.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert7_gpu8 -->
<g id="edge11" class="edge">
<title>l0_route&#45;&gt;l0_expert7_gpu8</title>
<path fill="none" stroke="black" d="M2759.38,-2014.67C2728.64,-2003.29 2698.23,-1992.02 2672,-1982.31"/>
<polygon fill="black" stroke="black" points="2673.13,-1979 2662.53,-1978.8 2670.7,-1985.56 2673.13,-1979"/>
</g>
<!-- l0_expert8_gpu9 -->
<g id="node13" class="node">
<title>l0_expert8_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="3105,-1978.74 2776,-1978.74 2776,-1925.74 3105,-1925.74 3105,-1978.74"/>
<text text-anchor="middle" x="2940.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 8 Layer 0</text>
<text text-anchor="middle" x="2940.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2940.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert8_gpu9 -->
<g id="edge12" class="edge">
<title>l0_route&#45;&gt;l0_expert8_gpu9</title>
<path fill="none" stroke="black" d="M2940.5,-2014.48C2940.5,-2005.7 2940.5,-1996.99 2940.5,-1989.02"/>
<polygon fill="black" stroke="black" points="2944,-1989.01 2940.5,-1979.01 2937,-1989.01 2944,-1989.01"/>
</g>
<!-- l0_expert9_gpu10 -->
<g id="node14" class="node">
<title>l0_expert9_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="3452,-1978.74 3123,-1978.74 3123,-1925.74 3452,-1925.74 3452,-1978.74"/>
<text text-anchor="middle" x="3287.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 9 Layer 0</text>
<text text-anchor="middle" x="3287.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3287.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert9_gpu10 -->
<g id="edge13" class="edge">
<title>l0_route&#45;&gt;l0_expert9_gpu10</title>
<path fill="none" stroke="black" d="M3095.98,-2024.16C3135.04,-2009.7 3175.33,-1994.78 3208.82,-1982.38"/>
<polygon fill="black" stroke="black" points="3210.37,-1985.54 3218.53,-1978.78 3207.94,-1978.97 3210.37,-1985.54"/>
</g>
<!-- l0_expert10_gpu11 -->
<g id="node15" class="node">
<title>l0_expert10_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="3799,-1978.74 3470,-1978.74 3470,-1925.74 3799,-1925.74 3799,-1978.74"/>
<text text-anchor="middle" x="3634.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 10 Layer 0</text>
<text text-anchor="middle" x="3634.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="3634.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert10_gpu11 -->
<g id="edge14" class="edge">
<title>l0_route&#45;&gt;l0_expert10_gpu11</title>
<path fill="none" stroke="black" d="M3115.18,-2049.4C3229.75,-2028.18 3377.92,-2000.75 3486.65,-1980.62"/>
<polygon fill="black" stroke="black" points="3487.52,-1984.01 3496.71,-1978.75 3486.24,-1977.13 3487.52,-1984.01"/>
</g>
<!-- l0_expert11_gpu12 -->
<g id="node16" class="node">
<title>l0_expert11_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="4146,-1978.74 3817,-1978.74 3817,-1925.74 4146,-1925.74 4146,-1978.74"/>
<text text-anchor="middle" x="3981.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 11 Layer 0</text>
<text text-anchor="middle" x="3981.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3981.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert11_gpu12 -->
<g id="edge15" class="edge">
<title>l0_route&#45;&gt;l0_expert11_gpu12</title>
<path fill="none" stroke="black" d="M3123.99,-2061.49C3297.4,-2041.99 3565.08,-2010.99 3806.66,-1978.97"/>
<polygon fill="black" stroke="black" points="3807.24,-1982.43 3816.69,-1977.64 3806.32,-1975.49 3807.24,-1982.43"/>
</g>
<!-- l0_expert12_gpu13 -->
<g id="node17" class="node">
<title>l0_expert12_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="4493,-1978.74 4164,-1978.74 4164,-1925.74 4493,-1925.74 4493,-1978.74"/>
<text text-anchor="middle" x="4328.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 12 Layer 0</text>
<text text-anchor="middle" x="4328.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="4328.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert12_gpu13 -->
<g id="edge16" class="edge">
<title>l0_route&#45;&gt;l0_expert12_gpu13</title>
<path fill="none" stroke="black" d="M3130.01,-2069.32C3367.2,-2052.94 3786.03,-2021.28 4153.67,-1978.93"/>
<polygon fill="black" stroke="black" points="4154.17,-1982.39 4163.71,-1977.77 4153.37,-1975.44 4154.17,-1982.39"/>
</g>
<!-- l0_expert13_gpu14 -->
<g id="node18" class="node">
<title>l0_expert13_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="4840,-1978.74 4511,-1978.74 4511,-1925.74 4840,-1925.74 4840,-1978.74"/>
<text text-anchor="middle" x="4675.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 13 Layer 0</text>
<text text-anchor="middle" x="4675.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="4675.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert13_gpu14 -->
<g id="edge17" class="edge">
<title>l0_route&#45;&gt;l0_expert13_gpu14</title>
<path fill="none" stroke="black" d="M3133.61,-2074.01C3427.05,-2061.15 4002.89,-2031.51 4500.45,-1978.93"/>
<polygon fill="black" stroke="black" points="4501.14,-1982.38 4510.71,-1977.84 4500.4,-1975.41 4501.14,-1982.38"/>
</g>
<!-- l0_expert14_gpu15 -->
<g id="node19" class="node">
<title>l0_expert14_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="5187,-1978.74 4858,-1978.74 4858,-1925.74 5187,-1925.74 5187,-1978.74"/>
<text text-anchor="middle" x="5022.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 14 Layer 0</text>
<text text-anchor="middle" x="5022.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5022.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert14_gpu15 -->
<g id="edge18" class="edge">
<title>l0_route&#45;&gt;l0_expert14_gpu15</title>
<path fill="none" stroke="black" d="M3136.08,-2077.15C3480.41,-2067.75 4217.37,-2041.72 4847.52,-1978.91"/>
<polygon fill="black" stroke="black" points="4848.12,-1982.36 4857.72,-1977.89 4847.42,-1975.4 4848.12,-1982.36"/>
</g>
<!-- l0_expert15_gpu16 -->
<g id="node20" class="node">
<title>l0_expert15_gpu16</title>
<polygon fill="lightyellow" stroke="black" points="5534,-1978.74 5205,-1978.74 5205,-1925.74 5534,-1925.74 5534,-1978.74"/>
<text text-anchor="middle" x="5369.5" y="-1963.54" font-family="Times,serif" font-size="14.00">Expert 15 Layer 0</text>
<text text-anchor="middle" x="5369.5" y="-1948.54" font-family="Times,serif" font-size="14.00">GPU 16</text>
<text text-anchor="middle" x="5369.5" y="-1933.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l0_route&#45;&gt;l0_expert15_gpu16 -->
<g id="edge19" class="edge">
<title>l0_route&#45;&gt;l0_expert15_gpu16</title>
<path fill="none" stroke="black" d="M3137.5,-2079.41C3528.38,-2073.32 4429.7,-2051.99 5194.6,-1978.89"/>
<polygon fill="black" stroke="black" points="5195.1,-1982.36 5204.72,-1977.92 5194.43,-1975.39 5195.1,-1982.36"/>
</g>
<!-- l0_aggregate -->
<g id="node21" class="node">
<title>l0_aggregate</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-1889.74 2792.34,-1889.74 2689.71,-1783.74 3088.66,-1783.74 3191.29,-1889.74"/>
<text text-anchor="middle" x="2940.5" y="-1848.04" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2940.5" y="-1833.04" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2940.5" y="-1818.04" font-family="Times,serif" font-size="14.00">16 experts → [128,10000,4096]</text>
</g>
<!-- l0_expert0_gpu1&#45;&gt;l0_aggregate -->
<g id="edge20" class="edge">
<title>l0_expert0_gpu1&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M329.27,-1926.52C332.04,-1926.25 334.78,-1925.99 337.5,-1925.74 1224.65,-1845.62 2287.84,-1836.7 2730.8,-1836.84"/>
<polygon fill="black" stroke="black" points="2730.82,-1840.34 2740.82,-1836.85 2730.83,-1833.34 2730.82,-1840.34"/>
</g>
<!-- l0_expert1_gpu2&#45;&gt;l0_aggregate -->
<g id="edge21" class="edge">
<title>l0_expert1_gpu2&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M676.28,-1926.54C679.04,-1926.26 681.78,-1925.99 684.5,-1925.74 1436.15,-1855.89 2333.67,-1841.33 2732.18,-1838.41"/>
<polygon fill="black" stroke="black" points="2732.4,-1841.9 2742.37,-1838.33 2732.35,-1834.9 2732.4,-1841.9"/>
</g>
<!-- l0_expert2_gpu3&#45;&gt;l0_aggregate -->
<g id="edge22" class="edge">
<title>l0_expert2_gpu3&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M1023.28,-1926.57C1026.04,-1926.28 1028.78,-1926 1031.5,-1925.74 1649.3,-1866.12 2383.61,-1846.64 2734.23,-1840.48"/>
<polygon fill="black" stroke="black" points="2734.3,-1843.98 2744.23,-1840.3 2734.18,-1836.98 2734.3,-1843.98"/>
</g>
<!-- l0_expert3_gpu4&#45;&gt;l0_aggregate -->
<g id="edge23" class="edge">
<title>l0_expert3_gpu4&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M1370.28,-1926.6C1373.04,-1926.3 1375.78,-1926.02 1378.5,-1925.74 1864.44,-1876.34 2438.45,-1852.92 2737.01,-1843.36"/>
<polygon fill="black" stroke="black" points="2737.19,-1846.85 2747.08,-1843.03 2736.97,-1839.86 2737.19,-1846.85"/>
</g>
<!-- l0_expert4_gpu5&#45;&gt;l0_aggregate -->
<g id="edge24" class="edge">
<title>l0_expert4_gpu5&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M1717.29,-1926.67C1720.05,-1926.35 1722.78,-1926.04 1725.5,-1925.74 2082.1,-1886.6 2499.57,-1860.69 2740.68,-1847.67"/>
<polygon fill="black" stroke="black" points="2741.16,-1851.15 2750.96,-1847.11 2740.78,-1844.16 2741.16,-1851.15"/>
</g>
<!-- l0_expert5_gpu6&#45;&gt;l0_aggregate -->
<g id="edge25" class="edge">
<title>l0_expert5_gpu6&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M2064.3,-1926.77C2067.05,-1926.42 2069.79,-1926.08 2072.5,-1925.74 2303.99,-1896.96 2571.1,-1870.96 2747.19,-1854.81"/>
<polygon fill="black" stroke="black" points="2747.71,-1858.28 2757.34,-1853.88 2747.07,-1851.31 2747.71,-1858.28"/>
</g>
<!-- l0_expert6_gpu7&#45;&gt;l0_aggregate -->
<g id="edge26" class="edge">
<title>l0_expert6_gpu7&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M2402.68,-1925.7C2508.41,-1908.41 2648.44,-1885.5 2759.11,-1867.4"/>
<polygon fill="black" stroke="black" points="2759.75,-1870.85 2769.05,-1865.78 2758.62,-1863.94 2759.75,-1870.85"/>
</g>
<!-- l0_expert7_gpu8&#45;&gt;l0_aggregate -->
<g id="edge27" class="edge">
<title>l0_expert7_gpu8&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M2671.81,-1925.63C2703.96,-1915.11 2742.44,-1902.52 2780.08,-1890.21"/>
<polygon fill="black" stroke="black" points="2781.22,-1893.52 2789.63,-1887.09 2779.04,-1886.87 2781.22,-1893.52"/>
</g>
<!-- l0_expert8_gpu9&#45;&gt;l0_aggregate -->
<g id="edge28" class="edge">
<title>l0_expert8_gpu9&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M2940.5,-1925.49C2940.5,-1917.79 2940.5,-1908.99 2940.5,-1900.01"/>
<polygon fill="black" stroke="black" points="2944,-1899.84 2940.5,-1889.84 2937,-1899.84 2944,-1899.84"/>
</g>
<!-- l0_expert9_gpu10&#45;&gt;l0_aggregate -->
<g id="edge29" class="edge">
<title>l0_expert9_gpu10&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M3209.19,-1925.63C3179.5,-1915.92 3144.43,-1904.44 3109.59,-1893.05"/>
<polygon fill="black" stroke="black" points="3110.36,-1889.62 3099.77,-1889.84 3108.19,-1896.27 3110.36,-1889.62"/>
</g>
<!-- l0_expert10_gpu11&#45;&gt;l0_aggregate -->
<g id="edge30" class="edge">
<title>l0_expert10_gpu11&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M3478.32,-1925.7C3393.01,-1911.75 3285.38,-1894.14 3188.85,-1878.36"/>
<polygon fill="black" stroke="black" points="3189.38,-1874.9 3178.94,-1876.74 3188.25,-1881.8 3189.38,-1874.9"/>
</g>
<!-- l0_expert11_gpu12&#45;&gt;l0_aggregate -->
<g id="edge31" class="edge">
<title>l0_expert11_gpu12&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M3816.7,-1926.77C3813.95,-1926.42 3811.21,-1926.08 3808.5,-1925.74 3592.49,-1898.88 3345.47,-1874.45 3170.32,-1858.18"/>
<polygon fill="black" stroke="black" points="3170.48,-1854.68 3160.2,-1857.24 3169.84,-1861.65 3170.48,-1854.68"/>
</g>
<!-- l0_expert12_gpu13&#45;&gt;l0_aggregate -->
<g id="edge32" class="edge">
<title>l0_expert12_gpu13&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M4163.71,-1926.67C4160.95,-1926.35 4158.22,-1926.04 4155.5,-1925.74 3809.09,-1887.72 3405.24,-1862.18 3161.42,-1848.81"/>
<polygon fill="black" stroke="black" points="3161.55,-1845.32 3151.37,-1848.27 3161.17,-1852.31 3161.55,-1845.32"/>
</g>
<!-- l0_expert13_gpu14&#45;&gt;l0_aggregate -->
<g id="edge33" class="edge">
<title>l0_expert13_gpu14&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M4510.72,-1926.6C4507.96,-1926.3 4505.22,-1926.02 4502.5,-1925.74 4023.41,-1877.04 3458.7,-1853.58 3156.77,-1843.77"/>
<polygon fill="black" stroke="black" points="3156.69,-1840.26 3146.59,-1843.44 3156.47,-1847.26 3156.69,-1840.26"/>
</g>
<!-- l0_expert14_gpu15&#45;&gt;l0_aggregate -->
<g id="edge34" class="edge">
<title>l0_expert14_gpu15&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M4857.72,-1926.57C4854.96,-1926.28 4852.22,-1926 4849.5,-1925.74 4235.78,-1866.51 3507.1,-1846.9 3153.78,-1840.6"/>
<polygon fill="black" stroke="black" points="3153.76,-1837.1 3143.7,-1840.42 3153.63,-1844.1 3153.76,-1837.1"/>
</g>
<!-- l0_expert15_gpu16&#45;&gt;l0_aggregate -->
<g id="edge35" class="edge">
<title>l0_expert15_gpu16&#45;&gt;l0_aggregate</title>
<path fill="none" stroke="black" d="M5204.72,-1926.54C5201.96,-1926.26 5199.22,-1925.99 5196.5,-1925.74 4446.79,-1856.07 3551.95,-1841.41 3151.91,-1838.43"/>
<polygon fill="black" stroke="black" points="3151.7,-1834.93 3141.68,-1838.35 3151.65,-1841.93 3151.7,-1834.93"/>
</g>
<!-- l0_aggregate&#45;&gt;l0_residual -->
<g id="edge36" class="edge">
<title>l0_aggregate&#45;&gt;l0_residual</title>
<path fill="none" stroke="black" d="M3120.59,-1816.49C3345.51,-1792.46 3732,-1751.15 3989.39,-1723.64"/>
<polygon fill="black" stroke="black" points="3990.07,-1727.09 3999.64,-1722.55 3989.32,-1720.13 3990.07,-1727.09"/>
</g>
<!-- l1_attn_gpu16 -->
<g id="node23" class="node">
<title>l1_attn_gpu16</title>
<polygon fill="lightcoral" stroke="black" points="4451,-1605.74 4050,-1605.74 4050,-1552.74 4451,-1552.74 4451,-1605.74"/>
<text text-anchor="middle" x="4250.5" y="-1590.54" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="4250.5" y="-1575.54" font-family="Times,serif" font-size="14.00">All heads on GPU 16</text>
<text text-anchor="middle" x="4250.5" y="-1560.54" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], Output: [128,10000,4096]</text>
</g>
<!-- l0_residual&#45;&gt;l1_attn_gpu16 -->
<g id="edge38" class="edge">
<title>l0_residual&#45;&gt;l1_attn_gpu16</title>
<path fill="none" stroke="black" d="M4250.5,-1641.64C4250.5,-1632.97 4250.5,-1624.15 4250.5,-1616.01"/>
<polygon fill="black" stroke="black" points="4254,-1615.75 4250.5,-1605.75 4247,-1615.75 4254,-1615.75"/>
</g>
<!-- l1_gate_gpu16 -->
<g id="node24" class="node">
<title>l1_gate_gpu16</title>
<polygon fill="lightpink" stroke="black" points="4423.96,-1516.74 3829.87,-1516.74 3677.04,-1410.74 4271.13,-1410.74 4423.96,-1516.74"/>
<text text-anchor="middle" x="4050.5" y="-1475.04" font-family="Times,serif" font-size="14.00">Gate Layer 1</text>
<text text-anchor="middle" x="4050.5" y="-1460.04" font-family="Times,serif" font-size="14.00">GPU 16</text>
<text text-anchor="middle" x="4050.5" y="-1445.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,2]</text>
</g>
<!-- l1_attn_gpu16&#45;&gt;l1_gate_gpu16 -->
<g id="edge39" class="edge">
<title>l1_attn_gpu16&#45;&gt;l1_gate_gpu16</title>
<path fill="none" stroke="black" d="M4205.12,-1552.49C4188.93,-1543.3 4169.98,-1532.54 4151.01,-1521.78"/>
<polygon fill="black" stroke="black" points="4152.73,-1518.73 4142.3,-1516.84 4149.27,-1524.82 4152.73,-1518.73"/>
</g>
<!-- l1_residual -->
<g id="node43" class="node">
<title>l1_residual</title>
<polygon fill="lightgreen" stroke="black" points="4250.5,-971.74 3723.5,-918.74 4250.5,-865.74 4777.5,-918.74 4250.5,-971.74"/>
<text text-anchor="middle" x="4250.5" y="-930.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4250.5" y="-915.04" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4250.5" y="-900.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]+[128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_gpu16&#45;&gt;l1_residual -->
<g id="edge74" class="edge">
<title>l1_attn_gpu16&#45;&gt;l1_residual</title>
<path fill="none" stroke="black" d="M4451.04,-1577.88C4818.29,-1571.76 5561.5,-1531.71 5561.5,-1307.74 5561.5,-1307.74 5561.5,-1307.74 5561.5,-1175.24 5561.5,-1070.7 4910.92,-986.65 4526.36,-946.11"/>
<polygon fill="black" stroke="black" points="4526.51,-942.6 4516.2,-945.04 4525.77,-949.56 4526.51,-942.6"/>
</g>
<!-- l1_route -->
<g id="node25" class="node">
<title>l1_route</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-1374.74 2792.34,-1374.74 2689.71,-1238.74 3088.66,-1238.74 3191.29,-1374.74"/>
<text text-anchor="middle" x="2940.5" y="-1325.54" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="2940.5" y="-1310.54" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2940.5" y="-1295.54" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="2940.5" y="-1280.54" font-family="Times,serif" font-size="14.00">[128,10000,4096] → 16 experts</text>
</g>
<!-- l1_gate_gpu16&#45;&gt;l1_route -->
<g id="edge40" class="edge">
<title>l1_gate_gpu16&#45;&gt;l1_route</title>
<path fill="none" stroke="black" d="M3677.8,-1410.7C3511.41,-1387.46 3320.44,-1360.79 3174.54,-1340.42"/>
<polygon fill="black" stroke="black" points="3174.95,-1336.94 3164.56,-1339.03 3173.98,-1343.88 3174.95,-1336.94"/>
</g>
<!-- l1_expert0_gpu17 -->
<g id="node26" class="node">
<title>l1_expert0_gpu17</title>
<polygon fill="lightyellow" stroke="black" points="329,-1202.74 0,-1202.74 0,-1149.74 329,-1149.74 329,-1202.74"/>
<text text-anchor="middle" x="164.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 0 Layer 1</text>
<text text-anchor="middle" x="164.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 17</text>
<text text-anchor="middle" x="164.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert0_gpu17 -->
<g id="edge41" class="edge">
<title>l1_route&#45;&gt;l1_expert0_gpu17</title>
<path fill="none" stroke="black" d="M2739.58,-1305.09C2303.67,-1302.08 1238.62,-1286.11 339.51,-1202.89"/>
<polygon fill="black" stroke="black" points="339.56,-1199.38 329.28,-1201.94 338.91,-1206.35 339.56,-1199.38"/>
</g>
<!-- l1_expert1_gpu18 -->
<g id="node27" class="node">
<title>l1_expert1_gpu18</title>
<polygon fill="lightyellow" stroke="black" points="676,-1202.74 347,-1202.74 347,-1149.74 676,-1149.74 676,-1202.74"/>
<text text-anchor="middle" x="511.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 1 Layer 1</text>
<text text-anchor="middle" x="511.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 18</text>
<text text-anchor="middle" x="511.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert1_gpu18 -->
<g id="edge42" class="edge">
<title>l1_route&#45;&gt;l1_expert1_gpu18</title>
<path fill="none" stroke="black" d="M2738.17,-1303.33C2344.46,-1297.13 1447.84,-1275.66 686.35,-1202.88"/>
<polygon fill="black" stroke="black" points="686.57,-1199.39 676.28,-1201.92 685.9,-1206.36 686.57,-1199.39"/>
</g>
<!-- l1_expert2_gpu19 -->
<g id="node28" class="node">
<title>l1_expert2_gpu19</title>
<polygon fill="lightyellow" stroke="black" points="1023,-1202.74 694,-1202.74 694,-1149.74 1023,-1149.74 1023,-1202.74"/>
<text text-anchor="middle" x="858.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 2 Layer 1</text>
<text text-anchor="middle" x="858.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 19</text>
<text text-anchor="middle" x="858.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert2_gpu19 -->
<g id="edge43" class="edge">
<title>l1_route&#45;&gt;l1_expert2_gpu19</title>
<path fill="none" stroke="black" d="M2736.61,-1300.92C2388.82,-1291.33 1658.6,-1265.23 1033.4,-1202.9"/>
<polygon fill="black" stroke="black" points="1033.58,-1199.4 1023.28,-1201.89 1032.88,-1206.36 1033.58,-1199.4"/>
</g>
<!-- l1_expert3_gpu20 -->
<g id="node29" class="node">
<title>l1_expert3_gpu20</title>
<polygon fill="lightyellow" stroke="black" points="1370,-1202.74 1041,-1202.74 1041,-1149.74 1370,-1149.74 1370,-1202.74"/>
<text text-anchor="middle" x="1205.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 3 Layer 1</text>
<text text-anchor="middle" x="1205.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 20</text>
<text text-anchor="middle" x="1205.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert3_gpu20 -->
<g id="edge44" class="edge">
<title>l1_route&#45;&gt;l1_expert3_gpu20</title>
<path fill="none" stroke="black" d="M2733.8,-1297.41C2436.41,-1284.24 1870.54,-1254.72 1380.4,-1202.91"/>
<polygon fill="black" stroke="black" points="1380.6,-1199.41 1370.29,-1201.84 1379.86,-1206.38 1380.6,-1199.41"/>
</g>
<!-- l1_expert4_gpu21 -->
<g id="node30" class="node">
<title>l1_expert4_gpu21</title>
<polygon fill="lightyellow" stroke="black" points="1717,-1202.74 1388,-1202.74 1388,-1149.74 1717,-1149.74 1717,-1202.74"/>
<text text-anchor="middle" x="1552.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 4 Layer 1</text>
<text text-anchor="middle" x="1552.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 21</text>
<text text-anchor="middle" x="1552.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert4_gpu21 -->
<g id="edge45" class="edge">
<title>l1_route&#45;&gt;l1_expert4_gpu21</title>
<path fill="none" stroke="black" d="M2729.66,-1291.84C2489.28,-1275.07 2084.4,-1244.06 1727.31,-1202.93"/>
<polygon fill="black" stroke="black" points="1727.63,-1199.44 1717.29,-1201.77 1726.83,-1206.39 1727.63,-1199.44"/>
</g>
<!-- l1_expert5_gpu22 -->
<g id="node31" class="node">
<title>l1_expert5_gpu22</title>
<polygon fill="lightyellow" stroke="black" points="2064,-1202.74 1735,-1202.74 1735,-1149.74 2064,-1149.74 2064,-1202.74"/>
<text text-anchor="middle" x="1899.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 5 Layer 1</text>
<text text-anchor="middle" x="1899.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 22</text>
<text text-anchor="middle" x="1899.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert5_gpu22 -->
<g id="edge46" class="edge">
<title>l1_route&#45;&gt;l1_expert5_gpu22</title>
<path fill="none" stroke="black" d="M2721.79,-1281.52C2548.72,-1261.94 2300.64,-1232.96 2074.39,-1202.98"/>
<polygon fill="black" stroke="black" points="2074.68,-1199.49 2064.31,-1201.64 2073.76,-1206.43 2074.68,-1199.49"/>
</g>
<!-- l1_expert6_gpu23 -->
<g id="node32" class="node">
<title>l1_expert6_gpu23</title>
<polygon fill="lightyellow" stroke="black" points="2411,-1202.74 2082,-1202.74 2082,-1149.74 2411,-1149.74 2411,-1202.74"/>
<text text-anchor="middle" x="2246.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 6 Layer 1</text>
<text text-anchor="middle" x="2246.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 23</text>
<text text-anchor="middle" x="2246.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert6_gpu23 -->
<g id="edge47" class="edge">
<title>l1_route&#45;&gt;l1_expert6_gpu23</title>
<path fill="none" stroke="black" d="M2707.48,-1262.59C2603.95,-1243.42 2485.19,-1221.43 2394.14,-1204.58"/>
<polygon fill="black" stroke="black" points="2394.77,-1201.13 2384.3,-1202.75 2393.49,-1208.02 2394.77,-1201.13"/>
</g>
<!-- l1_expert7_gpu24 -->
<g id="node33" class="node">
<title>l1_expert7_gpu24</title>
<polygon fill="lightyellow" stroke="black" points="2758,-1202.74 2429,-1202.74 2429,-1149.74 2758,-1149.74 2758,-1202.74"/>
<text text-anchor="middle" x="2593.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 7 Layer 1</text>
<text text-anchor="middle" x="2593.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 24</text>
<text text-anchor="middle" x="2593.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert7_gpu24 -->
<g id="edge48" class="edge">
<title>l1_route&#45;&gt;l1_expert7_gpu24</title>
<path fill="none" stroke="black" d="M2759.38,-1238.67C2728.64,-1227.29 2698.23,-1216.02 2672,-1206.31"/>
<polygon fill="black" stroke="black" points="2673.13,-1203 2662.53,-1202.8 2670.7,-1209.56 2673.13,-1203"/>
</g>
<!-- l1_expert8_gpu25 -->
<g id="node34" class="node">
<title>l1_expert8_gpu25</title>
<polygon fill="lightyellow" stroke="black" points="3105,-1202.74 2776,-1202.74 2776,-1149.74 3105,-1149.74 3105,-1202.74"/>
<text text-anchor="middle" x="2940.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 8 Layer 1</text>
<text text-anchor="middle" x="2940.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 25</text>
<text text-anchor="middle" x="2940.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert8_gpu25 -->
<g id="edge49" class="edge">
<title>l1_route&#45;&gt;l1_expert8_gpu25</title>
<path fill="none" stroke="black" d="M2940.5,-1238.48C2940.5,-1229.7 2940.5,-1220.99 2940.5,-1213.02"/>
<polygon fill="black" stroke="black" points="2944,-1213.01 2940.5,-1203.01 2937,-1213.01 2944,-1213.01"/>
</g>
<!-- l1_expert9_gpu26 -->
<g id="node35" class="node">
<title>l1_expert9_gpu26</title>
<polygon fill="lightyellow" stroke="black" points="3452,-1202.74 3123,-1202.74 3123,-1149.74 3452,-1149.74 3452,-1202.74"/>
<text text-anchor="middle" x="3287.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 9 Layer 1</text>
<text text-anchor="middle" x="3287.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 26</text>
<text text-anchor="middle" x="3287.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert9_gpu26 -->
<g id="edge50" class="edge">
<title>l1_route&#45;&gt;l1_expert9_gpu26</title>
<path fill="none" stroke="black" d="M3095.98,-1248.16C3135.04,-1233.7 3175.33,-1218.78 3208.82,-1206.38"/>
<polygon fill="black" stroke="black" points="3210.37,-1209.54 3218.53,-1202.78 3207.94,-1202.97 3210.37,-1209.54"/>
</g>
<!-- l1_expert10_gpu27 -->
<g id="node36" class="node">
<title>l1_expert10_gpu27</title>
<polygon fill="lightyellow" stroke="black" points="3799,-1202.74 3470,-1202.74 3470,-1149.74 3799,-1149.74 3799,-1202.74"/>
<text text-anchor="middle" x="3634.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 10 Layer 1</text>
<text text-anchor="middle" x="3634.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 27</text>
<text text-anchor="middle" x="3634.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert10_gpu27 -->
<g id="edge51" class="edge">
<title>l1_route&#45;&gt;l1_expert10_gpu27</title>
<path fill="none" stroke="black" d="M3115.18,-1273.4C3229.75,-1252.18 3377.92,-1224.75 3486.65,-1204.62"/>
<polygon fill="black" stroke="black" points="3487.52,-1208.01 3496.71,-1202.75 3486.24,-1201.13 3487.52,-1208.01"/>
</g>
<!-- l1_expert11_gpu28 -->
<g id="node37" class="node">
<title>l1_expert11_gpu28</title>
<polygon fill="lightyellow" stroke="black" points="4146,-1202.74 3817,-1202.74 3817,-1149.74 4146,-1149.74 4146,-1202.74"/>
<text text-anchor="middle" x="3981.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 11 Layer 1</text>
<text text-anchor="middle" x="3981.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 28</text>
<text text-anchor="middle" x="3981.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert11_gpu28 -->
<g id="edge52" class="edge">
<title>l1_route&#45;&gt;l1_expert11_gpu28</title>
<path fill="none" stroke="black" d="M3123.99,-1285.49C3297.4,-1265.99 3565.08,-1234.99 3806.66,-1202.97"/>
<polygon fill="black" stroke="black" points="3807.24,-1206.43 3816.69,-1201.64 3806.32,-1199.49 3807.24,-1206.43"/>
</g>
<!-- l1_expert12_gpu29 -->
<g id="node38" class="node">
<title>l1_expert12_gpu29</title>
<polygon fill="lightyellow" stroke="black" points="4493,-1202.74 4164,-1202.74 4164,-1149.74 4493,-1149.74 4493,-1202.74"/>
<text text-anchor="middle" x="4328.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 12 Layer 1</text>
<text text-anchor="middle" x="4328.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 29</text>
<text text-anchor="middle" x="4328.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert12_gpu29 -->
<g id="edge53" class="edge">
<title>l1_route&#45;&gt;l1_expert12_gpu29</title>
<path fill="none" stroke="black" d="M3130.01,-1293.32C3367.2,-1276.94 3786.03,-1245.28 4153.67,-1202.93"/>
<polygon fill="black" stroke="black" points="4154.17,-1206.39 4163.71,-1201.77 4153.37,-1199.44 4154.17,-1206.39"/>
</g>
<!-- l1_expert13_gpu30 -->
<g id="node39" class="node">
<title>l1_expert13_gpu30</title>
<polygon fill="lightyellow" stroke="black" points="4840,-1202.74 4511,-1202.74 4511,-1149.74 4840,-1149.74 4840,-1202.74"/>
<text text-anchor="middle" x="4675.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 13 Layer 1</text>
<text text-anchor="middle" x="4675.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 30</text>
<text text-anchor="middle" x="4675.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert13_gpu30 -->
<g id="edge54" class="edge">
<title>l1_route&#45;&gt;l1_expert13_gpu30</title>
<path fill="none" stroke="black" d="M3133.61,-1298.01C3427.05,-1285.15 4002.89,-1255.51 4500.45,-1202.93"/>
<polygon fill="black" stroke="black" points="4501.14,-1206.38 4510.71,-1201.84 4500.4,-1199.41 4501.14,-1206.38"/>
</g>
<!-- l1_expert14_gpu31 -->
<g id="node40" class="node">
<title>l1_expert14_gpu31</title>
<polygon fill="lightyellow" stroke="black" points="5187,-1202.74 4858,-1202.74 4858,-1149.74 5187,-1149.74 5187,-1202.74"/>
<text text-anchor="middle" x="5022.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 14 Layer 1</text>
<text text-anchor="middle" x="5022.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 31</text>
<text text-anchor="middle" x="5022.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert14_gpu31 -->
<g id="edge55" class="edge">
<title>l1_route&#45;&gt;l1_expert14_gpu31</title>
<path fill="none" stroke="black" d="M3136.08,-1301.15C3480.41,-1291.75 4217.37,-1265.72 4847.52,-1202.91"/>
<polygon fill="black" stroke="black" points="4848.12,-1206.36 4857.72,-1201.89 4847.42,-1199.4 4848.12,-1206.36"/>
</g>
<!-- l1_expert15_gpu32 -->
<g id="node41" class="node">
<title>l1_expert15_gpu32</title>
<polygon fill="lightyellow" stroke="black" points="5534,-1202.74 5205,-1202.74 5205,-1149.74 5534,-1149.74 5534,-1202.74"/>
<text text-anchor="middle" x="5369.5" y="-1187.54" font-family="Times,serif" font-size="14.00">Expert 15 Layer 1</text>
<text text-anchor="middle" x="5369.5" y="-1172.54" font-family="Times,serif" font-size="14.00">GPU 32</text>
<text text-anchor="middle" x="5369.5" y="-1157.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l1_route&#45;&gt;l1_expert15_gpu32 -->
<g id="edge56" class="edge">
<title>l1_route&#45;&gt;l1_expert15_gpu32</title>
<path fill="none" stroke="black" d="M3137.5,-1303.41C3528.38,-1297.32 4429.7,-1275.99 5194.6,-1202.89"/>
<polygon fill="black" stroke="black" points="5195.1,-1206.36 5204.72,-1201.92 5194.43,-1199.39 5195.1,-1206.36"/>
</g>
<!-- l1_aggregate -->
<g id="node42" class="node">
<title>l1_aggregate</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-1113.74 2792.34,-1113.74 2689.71,-1007.74 3088.66,-1007.74 3191.29,-1113.74"/>
<text text-anchor="middle" x="2940.5" y="-1072.04" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2940.5" y="-1057.04" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2940.5" y="-1042.04" font-family="Times,serif" font-size="14.00">16 experts → [128,10000,4096]</text>
</g>
<!-- l1_expert0_gpu17&#45;&gt;l1_aggregate -->
<g id="edge57" class="edge">
<title>l1_expert0_gpu17&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M329.27,-1150.52C332.04,-1150.25 334.78,-1149.99 337.5,-1149.74 1224.65,-1069.62 2287.84,-1060.7 2730.8,-1060.84"/>
<polygon fill="black" stroke="black" points="2730.82,-1064.34 2740.82,-1060.85 2730.83,-1057.34 2730.82,-1064.34"/>
</g>
<!-- l1_expert1_gpu18&#45;&gt;l1_aggregate -->
<g id="edge58" class="edge">
<title>l1_expert1_gpu18&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M676.28,-1150.54C679.04,-1150.26 681.78,-1149.99 684.5,-1149.74 1436.15,-1079.89 2333.67,-1065.33 2732.18,-1062.41"/>
<polygon fill="black" stroke="black" points="2732.4,-1065.9 2742.37,-1062.33 2732.35,-1058.9 2732.4,-1065.9"/>
</g>
<!-- l1_expert2_gpu19&#45;&gt;l1_aggregate -->
<g id="edge59" class="edge">
<title>l1_expert2_gpu19&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M1023.28,-1150.57C1026.04,-1150.28 1028.78,-1150 1031.5,-1149.74 1649.3,-1090.12 2383.61,-1070.64 2734.23,-1064.48"/>
<polygon fill="black" stroke="black" points="2734.3,-1067.98 2744.23,-1064.3 2734.18,-1060.98 2734.3,-1067.98"/>
</g>
<!-- l1_expert3_gpu20&#45;&gt;l1_aggregate -->
<g id="edge60" class="edge">
<title>l1_expert3_gpu20&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M1370.28,-1150.6C1373.04,-1150.3 1375.78,-1150.02 1378.5,-1149.74 1864.44,-1100.34 2438.45,-1076.92 2737.01,-1067.36"/>
<polygon fill="black" stroke="black" points="2737.19,-1070.85 2747.08,-1067.03 2736.97,-1063.86 2737.19,-1070.85"/>
</g>
<!-- l1_expert4_gpu21&#45;&gt;l1_aggregate -->
<g id="edge61" class="edge">
<title>l1_expert4_gpu21&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M1717.29,-1150.67C1720.05,-1150.35 1722.78,-1150.04 1725.5,-1149.74 2082.1,-1110.6 2499.57,-1084.69 2740.68,-1071.67"/>
<polygon fill="black" stroke="black" points="2741.16,-1075.15 2750.96,-1071.11 2740.78,-1068.16 2741.16,-1075.15"/>
</g>
<!-- l1_expert5_gpu22&#45;&gt;l1_aggregate -->
<g id="edge62" class="edge">
<title>l1_expert5_gpu22&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M2064.3,-1150.77C2067.05,-1150.42 2069.79,-1150.08 2072.5,-1149.74 2303.99,-1120.96 2571.1,-1094.96 2747.19,-1078.81"/>
<polygon fill="black" stroke="black" points="2747.71,-1082.28 2757.34,-1077.88 2747.07,-1075.31 2747.71,-1082.28"/>
</g>
<!-- l1_expert6_gpu23&#45;&gt;l1_aggregate -->
<g id="edge63" class="edge">
<title>l1_expert6_gpu23&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M2402.68,-1149.7C2508.41,-1132.41 2648.44,-1109.5 2759.11,-1091.4"/>
<polygon fill="black" stroke="black" points="2759.75,-1094.85 2769.05,-1089.78 2758.62,-1087.94 2759.75,-1094.85"/>
</g>
<!-- l1_expert7_gpu24&#45;&gt;l1_aggregate -->
<g id="edge64" class="edge">
<title>l1_expert7_gpu24&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M2671.81,-1149.63C2703.96,-1139.11 2742.44,-1126.52 2780.08,-1114.21"/>
<polygon fill="black" stroke="black" points="2781.22,-1117.52 2789.63,-1111.09 2779.04,-1110.87 2781.22,-1117.52"/>
</g>
<!-- l1_expert8_gpu25&#45;&gt;l1_aggregate -->
<g id="edge65" class="edge">
<title>l1_expert8_gpu25&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M2940.5,-1149.49C2940.5,-1141.79 2940.5,-1132.99 2940.5,-1124.01"/>
<polygon fill="black" stroke="black" points="2944,-1123.84 2940.5,-1113.84 2937,-1123.84 2944,-1123.84"/>
</g>
<!-- l1_expert9_gpu26&#45;&gt;l1_aggregate -->
<g id="edge66" class="edge">
<title>l1_expert9_gpu26&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M3209.19,-1149.63C3179.5,-1139.92 3144.43,-1128.44 3109.59,-1117.05"/>
<polygon fill="black" stroke="black" points="3110.36,-1113.62 3099.77,-1113.84 3108.19,-1120.27 3110.36,-1113.62"/>
</g>
<!-- l1_expert10_gpu27&#45;&gt;l1_aggregate -->
<g id="edge67" class="edge">
<title>l1_expert10_gpu27&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M3478.32,-1149.7C3393.01,-1135.75 3285.38,-1118.14 3188.85,-1102.36"/>
<polygon fill="black" stroke="black" points="3189.38,-1098.9 3178.94,-1100.74 3188.25,-1105.8 3189.38,-1098.9"/>
</g>
<!-- l1_expert11_gpu28&#45;&gt;l1_aggregate -->
<g id="edge68" class="edge">
<title>l1_expert11_gpu28&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M3816.7,-1150.77C3813.95,-1150.42 3811.21,-1150.08 3808.5,-1149.74 3592.49,-1122.88 3345.47,-1098.45 3170.32,-1082.18"/>
<polygon fill="black" stroke="black" points="3170.48,-1078.68 3160.2,-1081.24 3169.84,-1085.65 3170.48,-1078.68"/>
</g>
<!-- l1_expert12_gpu29&#45;&gt;l1_aggregate -->
<g id="edge69" class="edge">
<title>l1_expert12_gpu29&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M4163.71,-1150.67C4160.95,-1150.35 4158.22,-1150.04 4155.5,-1149.74 3809.09,-1111.72 3405.24,-1086.18 3161.42,-1072.81"/>
<polygon fill="black" stroke="black" points="3161.55,-1069.32 3151.37,-1072.27 3161.17,-1076.31 3161.55,-1069.32"/>
</g>
<!-- l1_expert13_gpu30&#45;&gt;l1_aggregate -->
<g id="edge70" class="edge">
<title>l1_expert13_gpu30&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M4510.72,-1150.6C4507.96,-1150.3 4505.22,-1150.02 4502.5,-1149.74 4023.41,-1101.04 3458.7,-1077.58 3156.77,-1067.77"/>
<polygon fill="black" stroke="black" points="3156.69,-1064.26 3146.59,-1067.44 3156.47,-1071.26 3156.69,-1064.26"/>
</g>
<!-- l1_expert14_gpu31&#45;&gt;l1_aggregate -->
<g id="edge71" class="edge">
<title>l1_expert14_gpu31&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M4857.72,-1150.57C4854.96,-1150.28 4852.22,-1150 4849.5,-1149.74 4235.78,-1090.51 3507.1,-1070.9 3153.78,-1064.6"/>
<polygon fill="black" stroke="black" points="3153.76,-1061.1 3143.7,-1064.42 3153.63,-1068.1 3153.76,-1061.1"/>
</g>
<!-- l1_expert15_gpu32&#45;&gt;l1_aggregate -->
<g id="edge72" class="edge">
<title>l1_expert15_gpu32&#45;&gt;l1_aggregate</title>
<path fill="none" stroke="black" d="M5204.72,-1150.54C5201.96,-1150.26 5199.22,-1149.99 5196.5,-1149.74 4446.79,-1080.07 3551.95,-1065.41 3151.91,-1062.43"/>
<polygon fill="black" stroke="black" points="3151.7,-1058.93 3141.68,-1062.35 3151.65,-1065.93 3151.7,-1058.93"/>
</g>
<!-- l1_aggregate&#45;&gt;l1_residual -->
<g id="edge73" class="edge">
<title>l1_aggregate&#45;&gt;l1_residual</title>
<path fill="none" stroke="black" d="M3120.59,-1040.49C3345.51,-1016.46 3732,-975.15 3989.39,-947.64"/>
<polygon fill="black" stroke="black" points="3990.07,-951.09 3999.64,-946.55 3989.32,-944.13 3990.07,-951.09"/>
</g>
<!-- l15_attn_gpu240 -->
<g id="node44" class="node">
<title>l15_attn_gpu240</title>
<polygon fill="lightcoral" stroke="black" points="4451,-829.74 4050,-829.74 4050,-776.74 4451,-776.74 4451,-829.74"/>
<text text-anchor="middle" x="4250.5" y="-814.54" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="4250.5" y="-799.54" font-family="Times,serif" font-size="14.00">All heads on GPU 240</text>
<text text-anchor="middle" x="4250.5" y="-784.54" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], Output: [128,10000,4096]</text>
</g>
<!-- l1_residual&#45;&gt;l15_attn_gpu240 -->
<g id="edge75" class="edge">
<title>l1_residual&#45;&gt;l15_attn_gpu240</title>
<path fill="none" stroke="black" d="M4250.5,-865.64C4250.5,-856.97 4250.5,-848.15 4250.5,-840.01"/>
<polygon fill="black" stroke="black" points="4254,-839.75 4250.5,-829.75 4247,-839.75 4254,-839.75"/>
</g>
<!-- l15_gate_gpu240 -->
<g id="node45" class="node">
<title>l15_gate_gpu240</title>
<polygon fill="lightpink" stroke="black" points="4423.96,-740.74 3829.87,-740.74 3677.04,-634.74 4271.13,-634.74 4423.96,-740.74"/>
<text text-anchor="middle" x="4050.5" y="-699.04" font-family="Times,serif" font-size="14.00">Gate Layer 15</text>
<text text-anchor="middle" x="4050.5" y="-684.04" font-family="Times,serif" font-size="14.00">GPU 240</text>
<text text-anchor="middle" x="4050.5" y="-669.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,2]</text>
</g>
<!-- l15_attn_gpu240&#45;&gt;l15_gate_gpu240 -->
<g id="edge76" class="edge">
<title>l15_attn_gpu240&#45;&gt;l15_gate_gpu240</title>
<path fill="none" stroke="black" d="M4205.12,-776.49C4188.93,-767.3 4169.98,-756.54 4151.01,-745.78"/>
<polygon fill="black" stroke="black" points="4152.73,-742.73 4142.3,-740.84 4149.27,-748.82 4152.73,-742.73"/>
</g>
<!-- l15_residual -->
<g id="node64" class="node">
<title>l15_residual</title>
<polygon fill="lightgreen" stroke="black" points="4250.5,-195.74 3723.5,-142.74 4250.5,-89.74 4777.5,-142.74 4250.5,-195.74"/>
<text text-anchor="middle" x="4250.5" y="-154.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4250.5" y="-139.04" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="4250.5" y="-124.04" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]+[128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_gpu240&#45;&gt;l15_residual -->
<g id="edge111" class="edge">
<title>l15_attn_gpu240&#45;&gt;l15_residual</title>
<path fill="none" stroke="black" d="M4451.04,-801.88C4818.29,-795.76 5561.5,-755.71 5561.5,-531.74 5561.5,-531.74 5561.5,-531.74 5561.5,-399.24 5561.5,-294.7 4910.92,-210.65 4526.36,-170.11"/>
<polygon fill="black" stroke="black" points="4526.51,-166.6 4516.2,-169.04 4525.77,-173.56 4526.51,-166.6"/>
</g>
<!-- l15_route -->
<g id="node46" class="node">
<title>l15_route</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-598.74 2792.34,-598.74 2689.71,-462.74 3088.66,-462.74 3191.29,-598.74"/>
<text text-anchor="middle" x="2940.5" y="-549.54" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="2940.5" y="-534.54" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="2940.5" y="-519.54" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="2940.5" y="-504.54" font-family="Times,serif" font-size="14.00">[128,10000,4096] → 16 experts</text>
</g>
<!-- l15_gate_gpu240&#45;&gt;l15_route -->
<g id="edge77" class="edge">
<title>l15_gate_gpu240&#45;&gt;l15_route</title>
<path fill="none" stroke="black" d="M3677.8,-634.7C3511.41,-611.46 3320.44,-584.79 3174.54,-564.42"/>
<polygon fill="black" stroke="black" points="3174.95,-560.94 3164.56,-563.03 3173.98,-567.88 3174.95,-560.94"/>
</g>
<!-- l15_expert0_gpu241 -->
<g id="node47" class="node">
<title>l15_expert0_gpu241</title>
<polygon fill="lightyellow" stroke="black" points="329,-426.74 0,-426.74 0,-373.74 329,-373.74 329,-426.74"/>
<text text-anchor="middle" x="164.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 0 Layer 15</text>
<text text-anchor="middle" x="164.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 241</text>
<text text-anchor="middle" x="164.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert0_gpu241 -->
<g id="edge78" class="edge">
<title>l15_route&#45;&gt;l15_expert0_gpu241</title>
<path fill="none" stroke="black" d="M2739.58,-529.09C2303.67,-526.08 1238.62,-510.11 339.51,-426.89"/>
<polygon fill="black" stroke="black" points="339.56,-423.38 329.28,-425.94 338.91,-430.35 339.56,-423.38"/>
</g>
<!-- l15_expert1_gpu242 -->
<g id="node48" class="node">
<title>l15_expert1_gpu242</title>
<polygon fill="lightyellow" stroke="black" points="676,-426.74 347,-426.74 347,-373.74 676,-373.74 676,-426.74"/>
<text text-anchor="middle" x="511.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 1 Layer 15</text>
<text text-anchor="middle" x="511.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 242</text>
<text text-anchor="middle" x="511.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert1_gpu242 -->
<g id="edge79" class="edge">
<title>l15_route&#45;&gt;l15_expert1_gpu242</title>
<path fill="none" stroke="black" d="M2738.17,-527.33C2344.46,-521.13 1447.84,-499.66 686.35,-426.88"/>
<polygon fill="black" stroke="black" points="686.57,-423.39 676.28,-425.92 685.9,-430.36 686.57,-423.39"/>
</g>
<!-- l15_expert2_gpu243 -->
<g id="node49" class="node">
<title>l15_expert2_gpu243</title>
<polygon fill="lightyellow" stroke="black" points="1023,-426.74 694,-426.74 694,-373.74 1023,-373.74 1023,-426.74"/>
<text text-anchor="middle" x="858.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 2 Layer 15</text>
<text text-anchor="middle" x="858.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 243</text>
<text text-anchor="middle" x="858.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert2_gpu243 -->
<g id="edge80" class="edge">
<title>l15_route&#45;&gt;l15_expert2_gpu243</title>
<path fill="none" stroke="black" d="M2736.61,-524.92C2388.82,-515.33 1658.6,-489.23 1033.4,-426.9"/>
<polygon fill="black" stroke="black" points="1033.58,-423.4 1023.28,-425.89 1032.88,-430.36 1033.58,-423.4"/>
</g>
<!-- l15_expert3_gpu244 -->
<g id="node50" class="node">
<title>l15_expert3_gpu244</title>
<polygon fill="lightyellow" stroke="black" points="1370,-426.74 1041,-426.74 1041,-373.74 1370,-373.74 1370,-426.74"/>
<text text-anchor="middle" x="1205.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 3 Layer 15</text>
<text text-anchor="middle" x="1205.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 244</text>
<text text-anchor="middle" x="1205.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert3_gpu244 -->
<g id="edge81" class="edge">
<title>l15_route&#45;&gt;l15_expert3_gpu244</title>
<path fill="none" stroke="black" d="M2733.8,-521.41C2436.41,-508.24 1870.54,-478.72 1380.4,-426.91"/>
<polygon fill="black" stroke="black" points="1380.6,-423.41 1370.29,-425.84 1379.86,-430.38 1380.6,-423.41"/>
</g>
<!-- l15_expert4_gpu245 -->
<g id="node51" class="node">
<title>l15_expert4_gpu245</title>
<polygon fill="lightyellow" stroke="black" points="1717,-426.74 1388,-426.74 1388,-373.74 1717,-373.74 1717,-426.74"/>
<text text-anchor="middle" x="1552.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 4 Layer 15</text>
<text text-anchor="middle" x="1552.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 245</text>
<text text-anchor="middle" x="1552.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert4_gpu245 -->
<g id="edge82" class="edge">
<title>l15_route&#45;&gt;l15_expert4_gpu245</title>
<path fill="none" stroke="black" d="M2729.66,-515.84C2489.28,-499.07 2084.4,-468.06 1727.31,-426.93"/>
<polygon fill="black" stroke="black" points="1727.63,-423.44 1717.29,-425.77 1726.83,-430.39 1727.63,-423.44"/>
</g>
<!-- l15_expert5_gpu246 -->
<g id="node52" class="node">
<title>l15_expert5_gpu246</title>
<polygon fill="lightyellow" stroke="black" points="2064,-426.74 1735,-426.74 1735,-373.74 2064,-373.74 2064,-426.74"/>
<text text-anchor="middle" x="1899.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 5 Layer 15</text>
<text text-anchor="middle" x="1899.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 246</text>
<text text-anchor="middle" x="1899.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert5_gpu246 -->
<g id="edge83" class="edge">
<title>l15_route&#45;&gt;l15_expert5_gpu246</title>
<path fill="none" stroke="black" d="M2721.79,-505.52C2548.72,-485.94 2300.64,-456.96 2074.39,-426.98"/>
<polygon fill="black" stroke="black" points="2074.68,-423.49 2064.31,-425.64 2073.76,-430.43 2074.68,-423.49"/>
</g>
<!-- l15_expert6_gpu247 -->
<g id="node53" class="node">
<title>l15_expert6_gpu247</title>
<polygon fill="lightyellow" stroke="black" points="2411,-426.74 2082,-426.74 2082,-373.74 2411,-373.74 2411,-426.74"/>
<text text-anchor="middle" x="2246.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 6 Layer 15</text>
<text text-anchor="middle" x="2246.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 247</text>
<text text-anchor="middle" x="2246.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert6_gpu247 -->
<g id="edge84" class="edge">
<title>l15_route&#45;&gt;l15_expert6_gpu247</title>
<path fill="none" stroke="black" d="M2707.48,-486.59C2603.95,-467.42 2485.19,-445.43 2394.14,-428.58"/>
<polygon fill="black" stroke="black" points="2394.77,-425.13 2384.3,-426.75 2393.49,-432.02 2394.77,-425.13"/>
</g>
<!-- l15_expert7_gpu248 -->
<g id="node54" class="node">
<title>l15_expert7_gpu248</title>
<polygon fill="lightyellow" stroke="black" points="2758,-426.74 2429,-426.74 2429,-373.74 2758,-373.74 2758,-426.74"/>
<text text-anchor="middle" x="2593.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 7 Layer 15</text>
<text text-anchor="middle" x="2593.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 248</text>
<text text-anchor="middle" x="2593.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert7_gpu248 -->
<g id="edge85" class="edge">
<title>l15_route&#45;&gt;l15_expert7_gpu248</title>
<path fill="none" stroke="black" d="M2759.38,-462.67C2728.64,-451.29 2698.23,-440.02 2672,-430.31"/>
<polygon fill="black" stroke="black" points="2673.13,-427 2662.53,-426.8 2670.7,-433.56 2673.13,-427"/>
</g>
<!-- l15_expert8_gpu249 -->
<g id="node55" class="node">
<title>l15_expert8_gpu249</title>
<polygon fill="lightyellow" stroke="black" points="3105,-426.74 2776,-426.74 2776,-373.74 3105,-373.74 3105,-426.74"/>
<text text-anchor="middle" x="2940.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 8 Layer 15</text>
<text text-anchor="middle" x="2940.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 249</text>
<text text-anchor="middle" x="2940.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert8_gpu249 -->
<g id="edge86" class="edge">
<title>l15_route&#45;&gt;l15_expert8_gpu249</title>
<path fill="none" stroke="black" d="M2940.5,-462.48C2940.5,-453.7 2940.5,-444.99 2940.5,-437.02"/>
<polygon fill="black" stroke="black" points="2944,-437.01 2940.5,-427.01 2937,-437.01 2944,-437.01"/>
</g>
<!-- l15_expert9_gpu250 -->
<g id="node56" class="node">
<title>l15_expert9_gpu250</title>
<polygon fill="lightyellow" stroke="black" points="3452,-426.74 3123,-426.74 3123,-373.74 3452,-373.74 3452,-426.74"/>
<text text-anchor="middle" x="3287.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 9 Layer 15</text>
<text text-anchor="middle" x="3287.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 250</text>
<text text-anchor="middle" x="3287.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert9_gpu250 -->
<g id="edge87" class="edge">
<title>l15_route&#45;&gt;l15_expert9_gpu250</title>
<path fill="none" stroke="black" d="M3095.98,-472.16C3135.04,-457.7 3175.33,-442.78 3208.82,-430.38"/>
<polygon fill="black" stroke="black" points="3210.37,-433.54 3218.53,-426.78 3207.94,-426.97 3210.37,-433.54"/>
</g>
<!-- l15_expert10_gpu251 -->
<g id="node57" class="node">
<title>l15_expert10_gpu251</title>
<polygon fill="lightyellow" stroke="black" points="3799,-426.74 3470,-426.74 3470,-373.74 3799,-373.74 3799,-426.74"/>
<text text-anchor="middle" x="3634.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 10 Layer 15</text>
<text text-anchor="middle" x="3634.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 251</text>
<text text-anchor="middle" x="3634.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert10_gpu251 -->
<g id="edge88" class="edge">
<title>l15_route&#45;&gt;l15_expert10_gpu251</title>
<path fill="none" stroke="black" d="M3115.18,-497.4C3229.75,-476.18 3377.92,-448.75 3486.65,-428.62"/>
<polygon fill="black" stroke="black" points="3487.52,-432.01 3496.71,-426.75 3486.24,-425.13 3487.52,-432.01"/>
</g>
<!-- l15_expert11_gpu252 -->
<g id="node58" class="node">
<title>l15_expert11_gpu252</title>
<polygon fill="lightyellow" stroke="black" points="4146,-426.74 3817,-426.74 3817,-373.74 4146,-373.74 4146,-426.74"/>
<text text-anchor="middle" x="3981.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 11 Layer 15</text>
<text text-anchor="middle" x="3981.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 252</text>
<text text-anchor="middle" x="3981.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert11_gpu252 -->
<g id="edge89" class="edge">
<title>l15_route&#45;&gt;l15_expert11_gpu252</title>
<path fill="none" stroke="black" d="M3123.99,-509.49C3297.4,-489.99 3565.08,-458.99 3806.66,-426.97"/>
<polygon fill="black" stroke="black" points="3807.24,-430.43 3816.69,-425.64 3806.32,-423.49 3807.24,-430.43"/>
</g>
<!-- l15_expert12_gpu253 -->
<g id="node59" class="node">
<title>l15_expert12_gpu253</title>
<polygon fill="lightyellow" stroke="black" points="4493,-426.74 4164,-426.74 4164,-373.74 4493,-373.74 4493,-426.74"/>
<text text-anchor="middle" x="4328.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 12 Layer 15</text>
<text text-anchor="middle" x="4328.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 253</text>
<text text-anchor="middle" x="4328.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert12_gpu253 -->
<g id="edge90" class="edge">
<title>l15_route&#45;&gt;l15_expert12_gpu253</title>
<path fill="none" stroke="black" d="M3130.01,-517.32C3367.2,-500.94 3786.03,-469.28 4153.67,-426.93"/>
<polygon fill="black" stroke="black" points="4154.17,-430.39 4163.71,-425.77 4153.37,-423.44 4154.17,-430.39"/>
</g>
<!-- l15_expert13_gpu254 -->
<g id="node60" class="node">
<title>l15_expert13_gpu254</title>
<polygon fill="lightyellow" stroke="black" points="4840,-426.74 4511,-426.74 4511,-373.74 4840,-373.74 4840,-426.74"/>
<text text-anchor="middle" x="4675.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 13 Layer 15</text>
<text text-anchor="middle" x="4675.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 254</text>
<text text-anchor="middle" x="4675.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert13_gpu254 -->
<g id="edge91" class="edge">
<title>l15_route&#45;&gt;l15_expert13_gpu254</title>
<path fill="none" stroke="black" d="M3133.61,-522.01C3427.05,-509.15 4002.89,-479.51 4500.45,-426.93"/>
<polygon fill="black" stroke="black" points="4501.14,-430.38 4510.71,-425.84 4500.4,-423.41 4501.14,-430.38"/>
</g>
<!-- l15_expert14_gpu255 -->
<g id="node61" class="node">
<title>l15_expert14_gpu255</title>
<polygon fill="lightyellow" stroke="black" points="5187,-426.74 4858,-426.74 4858,-373.74 5187,-373.74 5187,-426.74"/>
<text text-anchor="middle" x="5022.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 14 Layer 15</text>
<text text-anchor="middle" x="5022.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 255</text>
<text text-anchor="middle" x="5022.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert14_gpu255 -->
<g id="edge92" class="edge">
<title>l15_route&#45;&gt;l15_expert14_gpu255</title>
<path fill="none" stroke="black" d="M3136.08,-525.15C3480.41,-515.75 4217.37,-489.72 4847.52,-426.91"/>
<polygon fill="black" stroke="black" points="4848.12,-430.36 4857.72,-425.89 4847.42,-423.4 4848.12,-430.36"/>
</g>
<!-- l15_expert15_gpu256 -->
<g id="node62" class="node">
<title>l15_expert15_gpu256</title>
<polygon fill="lightyellow" stroke="black" points="5534,-426.74 5205,-426.74 5205,-373.74 5534,-373.74 5534,-426.74"/>
<text text-anchor="middle" x="5369.5" y="-411.54" font-family="Times,serif" font-size="14.00">Expert 15 Layer 15</text>
<text text-anchor="middle" x="5369.5" y="-396.54" font-family="Times,serif" font-size="14.00">GPU 256</text>
<text text-anchor="middle" x="5369.5" y="-381.54" font-family="Times,serif" font-size="14.00">Input: [tokens,4096], Output: [tokens,4096]</text>
</g>
<!-- l15_route&#45;&gt;l15_expert15_gpu256 -->
<g id="edge93" class="edge">
<title>l15_route&#45;&gt;l15_expert15_gpu256</title>
<path fill="none" stroke="black" d="M3137.5,-527.41C3528.38,-521.32 4429.7,-499.99 5194.6,-426.89"/>
<polygon fill="black" stroke="black" points="5195.1,-430.36 5204.72,-425.92 5194.43,-423.39 5195.1,-430.36"/>
</g>
<!-- l15_aggregate -->
<g id="node63" class="node">
<title>l15_aggregate</title>
<polygon fill="lightgray" stroke="black" points="3191.29,-337.74 2792.34,-337.74 2689.71,-231.74 3088.66,-231.74 3191.29,-337.74"/>
<text text-anchor="middle" x="2940.5" y="-296.04" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2940.5" y="-281.04" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="2940.5" y="-266.04" font-family="Times,serif" font-size="14.00">16 experts → [128,10000,4096]</text>
</g>
<!-- l15_expert0_gpu241&#45;&gt;l15_aggregate -->
<g id="edge94" class="edge">
<title>l15_expert0_gpu241&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M329.27,-374.52C332.04,-374.25 334.78,-373.99 337.5,-373.74 1224.65,-293.62 2287.84,-284.7 2730.8,-284.84"/>
<polygon fill="black" stroke="black" points="2730.82,-288.34 2740.82,-284.85 2730.83,-281.34 2730.82,-288.34"/>
</g>
<!-- l15_expert1_gpu242&#45;&gt;l15_aggregate -->
<g id="edge95" class="edge">
<title>l15_expert1_gpu242&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M676.28,-374.54C679.04,-374.26 681.78,-373.99 684.5,-373.74 1436.15,-303.89 2333.67,-289.33 2732.18,-286.41"/>
<polygon fill="black" stroke="black" points="2732.4,-289.9 2742.37,-286.33 2732.35,-282.9 2732.4,-289.9"/>
</g>
<!-- l15_expert2_gpu243&#45;&gt;l15_aggregate -->
<g id="edge96" class="edge">
<title>l15_expert2_gpu243&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M1023.28,-374.57C1026.04,-374.28 1028.78,-374 1031.5,-373.74 1649.3,-314.12 2383.61,-294.64 2734.23,-288.48"/>
<polygon fill="black" stroke="black" points="2734.3,-291.98 2744.23,-288.3 2734.18,-284.98 2734.3,-291.98"/>
</g>
<!-- l15_expert3_gpu244&#45;&gt;l15_aggregate -->
<g id="edge97" class="edge">
<title>l15_expert3_gpu244&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M1370.28,-374.6C1373.04,-374.3 1375.78,-374.02 1378.5,-373.74 1864.44,-324.34 2438.45,-300.92 2737.01,-291.36"/>
<polygon fill="black" stroke="black" points="2737.19,-294.85 2747.08,-291.03 2736.97,-287.86 2737.19,-294.85"/>
</g>
<!-- l15_expert4_gpu245&#45;&gt;l15_aggregate -->
<g id="edge98" class="edge">
<title>l15_expert4_gpu245&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M1717.29,-374.67C1720.05,-374.35 1722.78,-374.04 1725.5,-373.74 2082.1,-334.6 2499.57,-308.69 2740.68,-295.67"/>
<polygon fill="black" stroke="black" points="2741.16,-299.15 2750.96,-295.11 2740.78,-292.16 2741.16,-299.15"/>
</g>
<!-- l15_expert5_gpu246&#45;&gt;l15_aggregate -->
<g id="edge99" class="edge">
<title>l15_expert5_gpu246&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M2064.3,-374.77C2067.05,-374.42 2069.79,-374.08 2072.5,-373.74 2303.99,-344.96 2571.1,-318.96 2747.19,-302.81"/>
<polygon fill="black" stroke="black" points="2747.71,-306.28 2757.34,-301.88 2747.07,-299.31 2747.71,-306.28"/>
</g>
<!-- l15_expert6_gpu247&#45;&gt;l15_aggregate -->
<g id="edge100" class="edge">
<title>l15_expert6_gpu247&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M2402.68,-373.7C2508.41,-356.41 2648.44,-333.5 2759.11,-315.4"/>
<polygon fill="black" stroke="black" points="2759.75,-318.85 2769.05,-313.78 2758.62,-311.94 2759.75,-318.85"/>
</g>
<!-- l15_expert7_gpu248&#45;&gt;l15_aggregate -->
<g id="edge101" class="edge">
<title>l15_expert7_gpu248&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M2671.81,-373.63C2703.96,-363.11 2742.44,-350.52 2780.08,-338.21"/>
<polygon fill="black" stroke="black" points="2781.22,-341.52 2789.63,-335.09 2779.04,-334.87 2781.22,-341.52"/>
</g>
<!-- l15_expert8_gpu249&#45;&gt;l15_aggregate -->
<g id="edge102" class="edge">
<title>l15_expert8_gpu249&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M2940.5,-373.49C2940.5,-365.79 2940.5,-356.99 2940.5,-348.01"/>
<polygon fill="black" stroke="black" points="2944,-347.84 2940.5,-337.84 2937,-347.84 2944,-347.84"/>
</g>
<!-- l15_expert9_gpu250&#45;&gt;l15_aggregate -->
<g id="edge103" class="edge">
<title>l15_expert9_gpu250&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M3209.19,-373.63C3179.5,-363.92 3144.43,-352.44 3109.59,-341.05"/>
<polygon fill="black" stroke="black" points="3110.36,-337.62 3099.77,-337.84 3108.19,-344.27 3110.36,-337.62"/>
</g>
<!-- l15_expert10_gpu251&#45;&gt;l15_aggregate -->
<g id="edge104" class="edge">
<title>l15_expert10_gpu251&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M3478.32,-373.7C3393.01,-359.75 3285.38,-342.14 3188.85,-326.36"/>
<polygon fill="black" stroke="black" points="3189.38,-322.9 3178.94,-324.74 3188.25,-329.8 3189.38,-322.9"/>
</g>
<!-- l15_expert11_gpu252&#45;&gt;l15_aggregate -->
<g id="edge105" class="edge">
<title>l15_expert11_gpu252&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M3816.7,-374.77C3813.95,-374.42 3811.21,-374.08 3808.5,-373.74 3592.49,-346.88 3345.47,-322.45 3170.32,-306.18"/>
<polygon fill="black" stroke="black" points="3170.48,-302.68 3160.2,-305.24 3169.84,-309.65 3170.48,-302.68"/>
</g>
<!-- l15_expert12_gpu253&#45;&gt;l15_aggregate -->
<g id="edge106" class="edge">
<title>l15_expert12_gpu253&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M4163.71,-374.67C4160.95,-374.35 4158.22,-374.04 4155.5,-373.74 3809.09,-335.72 3405.24,-310.18 3161.42,-296.81"/>
<polygon fill="black" stroke="black" points="3161.55,-293.32 3151.37,-296.27 3161.17,-300.31 3161.55,-293.32"/>
</g>
<!-- l15_expert13_gpu254&#45;&gt;l15_aggregate -->
<g id="edge107" class="edge">
<title>l15_expert13_gpu254&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M4510.72,-374.6C4507.96,-374.3 4505.22,-374.02 4502.5,-373.74 4023.41,-325.04 3458.7,-301.58 3156.77,-291.77"/>
<polygon fill="black" stroke="black" points="3156.69,-288.26 3146.59,-291.44 3156.47,-295.26 3156.69,-288.26"/>
</g>
<!-- l15_expert14_gpu255&#45;&gt;l15_aggregate -->
<g id="edge108" class="edge">
<title>l15_expert14_gpu255&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M4857.72,-374.57C4854.96,-374.28 4852.22,-374 4849.5,-373.74 4235.78,-314.51 3507.1,-294.9 3153.78,-288.6"/>
<polygon fill="black" stroke="black" points="3153.76,-285.1 3143.7,-288.42 3153.63,-292.1 3153.76,-285.1"/>
</g>
<!-- l15_expert15_gpu256&#45;&gt;l15_aggregate -->
<g id="edge109" class="edge">
<title>l15_expert15_gpu256&#45;&gt;l15_aggregate</title>
<path fill="none" stroke="black" d="M5204.72,-374.54C5201.96,-374.26 5199.22,-373.99 5196.5,-373.74 4446.79,-304.07 3551.95,-289.41 3151.91,-286.43"/>
<polygon fill="black" stroke="black" points="3151.7,-282.93 3141.68,-286.35 3151.65,-289.93 3151.7,-282.93"/>
</g>
<!-- l15_aggregate&#45;&gt;l15_residual -->
<g id="edge110" class="edge">
<title>l15_aggregate&#45;&gt;l15_residual</title>
<path fill="none" stroke="black" d="M3120.59,-264.49C3345.51,-240.46 3732,-199.15 3989.39,-171.64"/>
<polygon fill="black" stroke="black" points="3990.07,-175.09 3999.64,-170.55 3989.32,-168.13 3990.07,-175.09"/>
</g>
<!-- output -->
<g id="node65" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="4250.5" cy="-26.87" rx="258.19" ry="26.74"/>
<text text-anchor="middle" x="4250.5" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="4250.5" y="-15.67" font-family="Times,serif" font-size="14.00">batch_size=128, seq_len=10000, d_model=4096</text>
</g>
<!-- l15_residual&#45;&gt;output -->
<g id="edge112" class="edge">
<title>l15_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4250.5,-89.47C4250.5,-80.85 4250.5,-72.09 4250.5,-63.98"/>
<polygon fill="black" stroke="black" points="4254,-63.77 4250.5,-53.77 4247,-63.77 4254,-63.77"/>
</g>
<!-- note -->
<g id="node66" class="node">
<title>note</title>
<polygon fill="white" stroke="black" points="4812,-2463.61 4527,-2463.61 4527,-2425.61 4818,-2425.61 4818,-2457.61 4812,-2463.61"/>
<polyline fill="none" stroke="black" points="4812,-2463.61 4812,-2457.61 "/>
<polyline fill="none" stroke="black" points="4818,-2457.61 4812,-2457.61 "/>
<text text-anchor="middle" x="4672.5" y="-2448.41" font-family="Times,serif" font-size="14.00">Note: Layers 2&#45;14 follow same pattern</text>
<text text-anchor="middle" x="4672.5" y="-2433.41" font-family="Times,serif" font-size="14.00">Each layer uses next 16 GPUs</text>
</g>
</g>
</svg>
