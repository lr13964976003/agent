digraph MoE_Baseline_TP8_PP2 {
	rankdir=TB size="20,30"
	node [fillcolor=lightblue shape=rectangle style=filled]
	input [label="Input
batch_size=128, seq_len=10000, d_model=4096" fillcolor=lightgreen shape=ellipse]
	l0_attn_tp0_gpu0 [label="Attention
L0 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp1_gpu1 [label="Attention
L0 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp2_gpu2 [label="Attention
L0 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp3_gpu3 [label="Attention
L0 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp4_gpu4 [label="Attention
L0 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp5_gpu5 [label="Attention
L0 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp6_gpu6 [label="Attention
L0 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_attn_tp7_gpu7 [label="Attention
L0 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l0_moe_tp0_gpu0 [label="MoE
L0 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp1_gpu1 [label="MoE
L0 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp2_gpu2 [label="MoE
L0 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp3_gpu3 [label="MoE
L0 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp4_gpu4 [label="MoE
L0 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp5_gpu5 [label="MoE
L0 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp6_gpu6 [label="MoE
L0 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l0_moe_tp7_gpu7 [label="MoE
L0 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_attn_tp0_gpu0 [label="Attention
L1 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp1_gpu1 [label="Attention
L1 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp2_gpu2 [label="Attention
L1 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp3_gpu3 [label="Attention
L1 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp4_gpu4 [label="Attention
L1 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp5_gpu5 [label="Attention
L1 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp6_gpu6 [label="Attention
L1 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_attn_tp7_gpu7 [label="Attention
L1 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l1_moe_tp0_gpu0 [label="MoE
L1 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp1_gpu1 [label="MoE
L1 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp2_gpu2 [label="MoE
L1 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp3_gpu3 [label="MoE
L1 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp4_gpu4 [label="MoE
L1 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp5_gpu5 [label="MoE
L1 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp6_gpu6 [label="MoE
L1 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l1_moe_tp7_gpu7 [label="MoE
L1 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_attn_tp0_gpu0 [label="Attention
L2 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp1_gpu1 [label="Attention
L2 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp2_gpu2 [label="Attention
L2 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp3_gpu3 [label="Attention
L2 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp4_gpu4 [label="Attention
L2 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp5_gpu5 [label="Attention
L2 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp6_gpu6 [label="Attention
L2 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_attn_tp7_gpu7 [label="Attention
L2 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l2_moe_tp0_gpu0 [label="MoE
L2 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp1_gpu1 [label="MoE
L2 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp2_gpu2 [label="MoE
L2 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp3_gpu3 [label="MoE
L2 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp4_gpu4 [label="MoE
L2 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp5_gpu5 [label="MoE
L2 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp6_gpu6 [label="MoE
L2 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l2_moe_tp7_gpu7 [label="MoE
L2 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_attn_tp0_gpu0 [label="Attention
L3 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp1_gpu1 [label="Attention
L3 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp2_gpu2 [label="Attention
L3 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp3_gpu3 [label="Attention
L3 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp4_gpu4 [label="Attention
L3 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp5_gpu5 [label="Attention
L3 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp6_gpu6 [label="Attention
L3 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_attn_tp7_gpu7 [label="Attention
L3 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l3_moe_tp0_gpu0 [label="MoE
L3 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp1_gpu1 [label="MoE
L3 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp2_gpu2 [label="MoE
L3 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp3_gpu3 [label="MoE
L3 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp4_gpu4 [label="MoE
L3 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp5_gpu5 [label="MoE
L3 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp6_gpu6 [label="MoE
L3 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l3_moe_tp7_gpu7 [label="MoE
L3 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_attn_tp0_gpu0 [label="Attention
L4 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp1_gpu1 [label="Attention
L4 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp2_gpu2 [label="Attention
L4 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp3_gpu3 [label="Attention
L4 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp4_gpu4 [label="Attention
L4 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp5_gpu5 [label="Attention
L4 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp6_gpu6 [label="Attention
L4 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_attn_tp7_gpu7 [label="Attention
L4 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l4_moe_tp0_gpu0 [label="MoE
L4 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp1_gpu1 [label="MoE
L4 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp2_gpu2 [label="MoE
L4 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp3_gpu3 [label="MoE
L4 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp4_gpu4 [label="MoE
L4 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp5_gpu5 [label="MoE
L4 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp6_gpu6 [label="MoE
L4 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l4_moe_tp7_gpu7 [label="MoE
L4 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_attn_tp0_gpu0 [label="Attention
L5 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp1_gpu1 [label="Attention
L5 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp2_gpu2 [label="Attention
L5 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp3_gpu3 [label="Attention
L5 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp4_gpu4 [label="Attention
L5 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp5_gpu5 [label="Attention
L5 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp6_gpu6 [label="Attention
L5 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_attn_tp7_gpu7 [label="Attention
L5 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l5_moe_tp0_gpu0 [label="MoE
L5 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp1_gpu1 [label="MoE
L5 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp2_gpu2 [label="MoE
L5 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp3_gpu3 [label="MoE
L5 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp4_gpu4 [label="MoE
L5 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp5_gpu5 [label="MoE
L5 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp6_gpu6 [label="MoE
L5 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l5_moe_tp7_gpu7 [label="MoE
L5 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_attn_tp0_gpu0 [label="Attention
L6 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp1_gpu1 [label="Attention
L6 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp2_gpu2 [label="Attention
L6 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp3_gpu3 [label="Attention
L6 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp4_gpu4 [label="Attention
L6 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp5_gpu5 [label="Attention
L6 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp6_gpu6 [label="Attention
L6 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_attn_tp7_gpu7 [label="Attention
L6 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l6_moe_tp0_gpu0 [label="MoE
L6 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp1_gpu1 [label="MoE
L6 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp2_gpu2 [label="MoE
L6 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp3_gpu3 [label="MoE
L6 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp4_gpu4 [label="MoE
L6 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp5_gpu5 [label="MoE
L6 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp6_gpu6 [label="MoE
L6 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l6_moe_tp7_gpu7 [label="MoE
L6 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_attn_tp0_gpu0 [label="Attention
L7 TP0
GPU0
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp1_gpu1 [label="Attention
L7 TP1
GPU1
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp2_gpu2 [label="Attention
L7 TP2
GPU2
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp3_gpu3 [label="Attention
L7 TP3
GPU3
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp4_gpu4 [label="Attention
L7 TP4
GPU4
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp5_gpu5 [label="Attention
L7 TP5
GPU5
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp6_gpu6 [label="Attention
L7 TP6
GPU6
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_attn_tp7_gpu7 [label="Attention
L7 TP7
GPU7
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l7_moe_tp0_gpu0 [label="MoE
L7 E0-1
GPU0
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp1_gpu1 [label="MoE
L7 E2-3
GPU1
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp2_gpu2 [label="MoE
L7 E4-5
GPU2
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp3_gpu3 [label="MoE
L7 E6-7
GPU3
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp4_gpu4 [label="MoE
L7 E8-9
GPU4
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp5_gpu5 [label="MoE
L7 E10-11
GPU5
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp6_gpu6 [label="MoE
L7 E12-13
GPU6
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l7_moe_tp7_gpu7 [label="MoE
L7 E14-15
GPU7
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_attn_tp0_gpu8 [label="Attention
L8 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp1_gpu9 [label="Attention
L8 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp2_gpu10 [label="Attention
L8 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp3_gpu11 [label="Attention
L8 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp4_gpu12 [label="Attention
L8 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp5_gpu13 [label="Attention
L8 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp6_gpu14 [label="Attention
L8 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_attn_tp7_gpu15 [label="Attention
L8 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l8_moe_tp0_gpu8 [label="MoE
L8 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp1_gpu9 [label="MoE
L8 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp2_gpu10 [label="MoE
L8 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp3_gpu11 [label="MoE
L8 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp4_gpu12 [label="MoE
L8 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp5_gpu13 [label="MoE
L8 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp6_gpu14 [label="MoE
L8 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l8_moe_tp7_gpu15 [label="MoE
L8 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_attn_tp0_gpu8 [label="Attention
L9 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp1_gpu9 [label="Attention
L9 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp2_gpu10 [label="Attention
L9 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp3_gpu11 [label="Attention
L9 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp4_gpu12 [label="Attention
L9 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp5_gpu13 [label="Attention
L9 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp6_gpu14 [label="Attention
L9 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_attn_tp7_gpu15 [label="Attention
L9 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l9_moe_tp0_gpu8 [label="MoE
L9 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp1_gpu9 [label="MoE
L9 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp2_gpu10 [label="MoE
L9 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp3_gpu11 [label="MoE
L9 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp4_gpu12 [label="MoE
L9 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp5_gpu13 [label="MoE
L9 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp6_gpu14 [label="MoE
L9 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l9_moe_tp7_gpu15 [label="MoE
L9 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_attn_tp0_gpu8 [label="Attention
L10 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp1_gpu9 [label="Attention
L10 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp2_gpu10 [label="Attention
L10 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp3_gpu11 [label="Attention
L10 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp4_gpu12 [label="Attention
L10 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp5_gpu13 [label="Attention
L10 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp6_gpu14 [label="Attention
L10 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_attn_tp7_gpu15 [label="Attention
L10 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l10_moe_tp0_gpu8 [label="MoE
L10 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp1_gpu9 [label="MoE
L10 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp2_gpu10 [label="MoE
L10 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp3_gpu11 [label="MoE
L10 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp4_gpu12 [label="MoE
L10 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp5_gpu13 [label="MoE
L10 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp6_gpu14 [label="MoE
L10 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l10_moe_tp7_gpu15 [label="MoE
L10 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_attn_tp0_gpu8 [label="Attention
L11 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp1_gpu9 [label="Attention
L11 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp2_gpu10 [label="Attention
L11 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp3_gpu11 [label="Attention
L11 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp4_gpu12 [label="Attention
L11 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp5_gpu13 [label="Attention
L11 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp6_gpu14 [label="Attention
L11 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_attn_tp7_gpu15 [label="Attention
L11 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l11_moe_tp0_gpu8 [label="MoE
L11 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp1_gpu9 [label="MoE
L11 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp2_gpu10 [label="MoE
L11 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp3_gpu11 [label="MoE
L11 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp4_gpu12 [label="MoE
L11 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp5_gpu13 [label="MoE
L11 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp6_gpu14 [label="MoE
L11 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l11_moe_tp7_gpu15 [label="MoE
L11 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_attn_tp0_gpu8 [label="Attention
L12 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp1_gpu9 [label="Attention
L12 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp2_gpu10 [label="Attention
L12 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp3_gpu11 [label="Attention
L12 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp4_gpu12 [label="Attention
L12 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp5_gpu13 [label="Attention
L12 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp6_gpu14 [label="Attention
L12 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_attn_tp7_gpu15 [label="Attention
L12 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l12_moe_tp0_gpu8 [label="MoE
L12 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp1_gpu9 [label="MoE
L12 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp2_gpu10 [label="MoE
L12 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp3_gpu11 [label="MoE
L12 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp4_gpu12 [label="MoE
L12 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp5_gpu13 [label="MoE
L12 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp6_gpu14 [label="MoE
L12 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l12_moe_tp7_gpu15 [label="MoE
L12 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_attn_tp0_gpu8 [label="Attention
L13 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp1_gpu9 [label="Attention
L13 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp2_gpu10 [label="Attention
L13 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp3_gpu11 [label="Attention
L13 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp4_gpu12 [label="Attention
L13 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp5_gpu13 [label="Attention
L13 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp6_gpu14 [label="Attention
L13 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_attn_tp7_gpu15 [label="Attention
L13 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l13_moe_tp0_gpu8 [label="MoE
L13 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp1_gpu9 [label="MoE
L13 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp2_gpu10 [label="MoE
L13 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp3_gpu11 [label="MoE
L13 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp4_gpu12 [label="MoE
L13 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp5_gpu13 [label="MoE
L13 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp6_gpu14 [label="MoE
L13 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l13_moe_tp7_gpu15 [label="MoE
L13 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_attn_tp0_gpu8 [label="Attention
L14 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp1_gpu9 [label="Attention
L14 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp2_gpu10 [label="Attention
L14 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp3_gpu11 [label="Attention
L14 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp4_gpu12 [label="Attention
L14 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp5_gpu13 [label="Attention
L14 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp6_gpu14 [label="Attention
L14 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_attn_tp7_gpu15 [label="Attention
L14 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l14_moe_tp0_gpu8 [label="MoE
L14 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp1_gpu9 [label="MoE
L14 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp2_gpu10 [label="MoE
L14 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp3_gpu11 [label="MoE
L14 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp4_gpu12 [label="MoE
L14 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp5_gpu13 [label="MoE
L14 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp6_gpu14 [label="MoE
L14 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l14_moe_tp7_gpu15 [label="MoE
L14 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_attn_tp0_gpu8 [label="Attention
L15 TP0
GPU8
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp1_gpu9 [label="Attention
L15 TP1
GPU9
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp2_gpu10 [label="Attention
L15 TP2
GPU10
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp3_gpu11 [label="Attention
L15 TP3
GPU11
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp4_gpu12 [label="Attention
L15 TP4
GPU12
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp5_gpu13 [label="Attention
L15 TP5
GPU13
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp6_gpu14 [label="Attention
L15 TP6
GPU14
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_attn_tp7_gpu15 [label="Attention
L15 TP7
GPU15
In:[128,10000,4,128]
Out:[128,10000,4,128]" fillcolor=lightcoral]
	l15_moe_tp0_gpu8 [label="MoE
L15 E0-1
GPU8
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp1_gpu9 [label="MoE
L15 E2-3
GPU9
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp2_gpu10 [label="MoE
L15 E4-5
GPU10
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp3_gpu11 [label="MoE
L15 E6-7
GPU11
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp4_gpu12 [label="MoE
L15 E8-9
GPU12
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp5_gpu13 [label="MoE
L15 E10-11
GPU13
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp6_gpu14 [label="MoE
L15 E12-13
GPU14
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	l15_moe_tp7_gpu15 [label="MoE
L15 E14-15
GPU15
In:[128,10000,4096]
Out:[128,10000,4096]" fillcolor=lightyellow]
	input -> l0_attn_tp0_gpu0
	input -> l0_attn_tp1_gpu1
	input -> l0_attn_tp2_gpu2
	input -> l0_attn_tp3_gpu3
	input -> l0_attn_tp4_gpu4
	input -> l0_attn_tp5_gpu5
	input -> l0_attn_tp6_gpu6
	input -> l0_attn_tp7_gpu7
	l0_attn_tp0_gpu0 -> l0_moe_tp0_gpu0
	l0_attn_tp1_gpu1 -> l0_moe_tp1_gpu1
	l0_attn_tp2_gpu2 -> l0_moe_tp2_gpu2
	l0_attn_tp3_gpu3 -> l0_moe_tp3_gpu3
	l0_attn_tp4_gpu4 -> l0_moe_tp4_gpu4
	l0_attn_tp5_gpu5 -> l0_moe_tp5_gpu5
	l0_attn_tp6_gpu6 -> l0_moe_tp6_gpu6
	l0_attn_tp7_gpu7 -> l0_moe_tp7_gpu7
	l0_allreduce [label="TP All-Reduce
Layer 0" fillcolor=lightgray shape=parallelogram]
	l0_moe_tp0_gpu0 -> l0_allreduce
	l0_allreduce -> l1_attn_tp0_gpu0
	l0_moe_tp1_gpu1 -> l0_allreduce
	l0_allreduce -> l1_attn_tp1_gpu1
	l0_moe_tp2_gpu2 -> l0_allreduce
	l0_allreduce -> l1_attn_tp2_gpu2
	l0_moe_tp3_gpu3 -> l0_allreduce
	l0_allreduce -> l1_attn_tp3_gpu3
	l0_moe_tp4_gpu4 -> l0_allreduce
	l0_allreduce -> l1_attn_tp4_gpu4
	l0_moe_tp5_gpu5 -> l0_allreduce
	l0_allreduce -> l1_attn_tp5_gpu5
	l0_moe_tp6_gpu6 -> l0_allreduce
	l0_allreduce -> l1_attn_tp6_gpu6
	l0_moe_tp7_gpu7 -> l0_allreduce
	l0_allreduce -> l1_attn_tp7_gpu7
	l1_attn_tp0_gpu0 -> l1_moe_tp0_gpu0
	l1_attn_tp1_gpu1 -> l1_moe_tp1_gpu1
	l1_attn_tp2_gpu2 -> l1_moe_tp2_gpu2
	l1_attn_tp3_gpu3 -> l1_moe_tp3_gpu3
	l1_attn_tp4_gpu4 -> l1_moe_tp4_gpu4
	l1_attn_tp5_gpu5 -> l1_moe_tp5_gpu5
	l1_attn_tp6_gpu6 -> l1_moe_tp6_gpu6
	l1_attn_tp7_gpu7 -> l1_moe_tp7_gpu7
	l1_allreduce [label="TP All-Reduce
Layer 1" fillcolor=lightgray shape=parallelogram]
	l1_moe_tp0_gpu0 -> l1_allreduce
	l1_allreduce -> l2_attn_tp0_gpu0
	l1_moe_tp1_gpu1 -> l1_allreduce
	l1_allreduce -> l2_attn_tp1_gpu1
	l1_moe_tp2_gpu2 -> l1_allreduce
	l1_allreduce -> l2_attn_tp2_gpu2
	l1_moe_tp3_gpu3 -> l1_allreduce
	l1_allreduce -> l2_attn_tp3_gpu3
	l1_moe_tp4_gpu4 -> l1_allreduce
	l1_allreduce -> l2_attn_tp4_gpu4
	l1_moe_tp5_gpu5 -> l1_allreduce
	l1_allreduce -> l2_attn_tp5_gpu5
	l1_moe_tp6_gpu6 -> l1_allreduce
	l1_allreduce -> l2_attn_tp6_gpu6
	l1_moe_tp7_gpu7 -> l1_allreduce
	l1_allreduce -> l2_attn_tp7_gpu7
	l2_attn_tp0_gpu0 -> l2_moe_tp0_gpu0
	l2_attn_tp1_gpu1 -> l2_moe_tp1_gpu1
	l2_attn_tp2_gpu2 -> l2_moe_tp2_gpu2
	l2_attn_tp3_gpu3 -> l2_moe_tp3_gpu3
	l2_attn_tp4_gpu4 -> l2_moe_tp4_gpu4
	l2_attn_tp5_gpu5 -> l2_moe_tp5_gpu5
	l2_attn_tp6_gpu6 -> l2_moe_tp6_gpu6
	l2_attn_tp7_gpu7 -> l2_moe_tp7_gpu7
	l2_allreduce [label="TP All-Reduce
Layer 2" fillcolor=lightgray shape=parallelogram]
	l2_moe_tp0_gpu0 -> l2_allreduce
	l2_allreduce -> l3_attn_tp0_gpu0
	l2_moe_tp1_gpu1 -> l2_allreduce
	l2_allreduce -> l3_attn_tp1_gpu1
	l2_moe_tp2_gpu2 -> l2_allreduce
	l2_allreduce -> l3_attn_tp2_gpu2
	l2_moe_tp3_gpu3 -> l2_allreduce
	l2_allreduce -> l3_attn_tp3_gpu3
	l2_moe_tp4_gpu4 -> l2_allreduce
	l2_allreduce -> l3_attn_tp4_gpu4
	l2_moe_tp5_gpu5 -> l2_allreduce
	l2_allreduce -> l3_attn_tp5_gpu5
	l2_moe_tp6_gpu6 -> l2_allreduce
	l2_allreduce -> l3_attn_tp6_gpu6
	l2_moe_tp7_gpu7 -> l2_allreduce
	l2_allreduce -> l3_attn_tp7_gpu7
	l3_attn_tp0_gpu0 -> l3_moe_tp0_gpu0
	l3_attn_tp1_gpu1 -> l3_moe_tp1_gpu1
	l3_attn_tp2_gpu2 -> l3_moe_tp2_gpu2
	l3_attn_tp3_gpu3 -> l3_moe_tp3_gpu3
	l3_attn_tp4_gpu4 -> l3_moe_tp4_gpu4
	l3_attn_tp5_gpu5 -> l3_moe_tp5_gpu5
	l3_attn_tp6_gpu6 -> l3_moe_tp6_gpu6
	l3_attn_tp7_gpu7 -> l3_moe_tp7_gpu7
	l3_allreduce [label="TP All-Reduce
Layer 3" fillcolor=lightgray shape=parallelogram]
	l3_moe_tp0_gpu0 -> l3_allreduce
	l3_allreduce -> l4_attn_tp0_gpu0
	l3_moe_tp1_gpu1 -> l3_allreduce
	l3_allreduce -> l4_attn_tp1_gpu1
	l3_moe_tp2_gpu2 -> l3_allreduce
	l3_allreduce -> l4_attn_tp2_gpu2
	l3_moe_tp3_gpu3 -> l3_allreduce
	l3_allreduce -> l4_attn_tp3_gpu3
	l3_moe_tp4_gpu4 -> l3_allreduce
	l3_allreduce -> l4_attn_tp4_gpu4
	l3_moe_tp5_gpu5 -> l3_allreduce
	l3_allreduce -> l4_attn_tp5_gpu5
	l3_moe_tp6_gpu6 -> l3_allreduce
	l3_allreduce -> l4_attn_tp6_gpu6
	l3_moe_tp7_gpu7 -> l3_allreduce
	l3_allreduce -> l4_attn_tp7_gpu7
	l4_attn_tp0_gpu0 -> l4_moe_tp0_gpu0
	l4_attn_tp1_gpu1 -> l4_moe_tp1_gpu1
	l4_attn_tp2_gpu2 -> l4_moe_tp2_gpu2
	l4_attn_tp3_gpu3 -> l4_moe_tp3_gpu3
	l4_attn_tp4_gpu4 -> l4_moe_tp4_gpu4
	l4_attn_tp5_gpu5 -> l4_moe_tp5_gpu5
	l4_attn_tp6_gpu6 -> l4_moe_tp6_gpu6
	l4_attn_tp7_gpu7 -> l4_moe_tp7_gpu7
	l4_allreduce [label="TP All-Reduce
Layer 4" fillcolor=lightgray shape=parallelogram]
	l4_moe_tp0_gpu0 -> l4_allreduce
	l4_allreduce -> l5_attn_tp0_gpu0
	l4_moe_tp1_gpu1 -> l4_allreduce
	l4_allreduce -> l5_attn_tp1_gpu1
	l4_moe_tp2_gpu2 -> l4_allreduce
	l4_allreduce -> l5_attn_tp2_gpu2
	l4_moe_tp3_gpu3 -> l4_allreduce
	l4_allreduce -> l5_attn_tp3_gpu3
	l4_moe_tp4_gpu4 -> l4_allreduce
	l4_allreduce -> l5_attn_tp4_gpu4
	l4_moe_tp5_gpu5 -> l4_allreduce
	l4_allreduce -> l5_attn_tp5_gpu5
	l4_moe_tp6_gpu6 -> l4_allreduce
	l4_allreduce -> l5_attn_tp6_gpu6
	l4_moe_tp7_gpu7 -> l4_allreduce
	l4_allreduce -> l5_attn_tp7_gpu7
	l5_attn_tp0_gpu0 -> l5_moe_tp0_gpu0
	l5_attn_tp1_gpu1 -> l5_moe_tp1_gpu1
	l5_attn_tp2_gpu2 -> l5_moe_tp2_gpu2
	l5_attn_tp3_gpu3 -> l5_moe_tp3_gpu3
	l5_attn_tp4_gpu4 -> l5_moe_tp4_gpu4
	l5_attn_tp5_gpu5 -> l5_moe_tp5_gpu5
	l5_attn_tp6_gpu6 -> l5_moe_tp6_gpu6
	l5_attn_tp7_gpu7 -> l5_moe_tp7_gpu7
	l5_allreduce [label="TP All-Reduce
Layer 5" fillcolor=lightgray shape=parallelogram]
	l5_moe_tp0_gpu0 -> l5_allreduce
	l5_allreduce -> l6_attn_tp0_gpu0
	l5_moe_tp1_gpu1 -> l5_allreduce
	l5_allreduce -> l6_attn_tp1_gpu1
	l5_moe_tp2_gpu2 -> l5_allreduce
	l5_allreduce -> l6_attn_tp2_gpu2
	l5_moe_tp3_gpu3 -> l5_allreduce
	l5_allreduce -> l6_attn_tp3_gpu3
	l5_moe_tp4_gpu4 -> l5_allreduce
	l5_allreduce -> l6_attn_tp4_gpu4
	l5_moe_tp5_gpu5 -> l5_allreduce
	l5_allreduce -> l6_attn_tp5_gpu5
	l5_moe_tp6_gpu6 -> l5_allreduce
	l5_allreduce -> l6_attn_tp6_gpu6
	l5_moe_tp7_gpu7 -> l5_allreduce
	l5_allreduce -> l6_attn_tp7_gpu7
	l6_attn_tp0_gpu0 -> l6_moe_tp0_gpu0
	l6_attn_tp1_gpu1 -> l6_moe_tp1_gpu1
	l6_attn_tp2_gpu2 -> l6_moe_tp2_gpu2
	l6_attn_tp3_gpu3 -> l6_moe_tp3_gpu3
	l6_attn_tp4_gpu4 -> l6_moe_tp4_gpu4
	l6_attn_tp5_gpu5 -> l6_moe_tp5_gpu5
	l6_attn_tp6_gpu6 -> l6_moe_tp6_gpu6
	l6_attn_tp7_gpu7 -> l6_moe_tp7_gpu7
	l6_allreduce [label="TP All-Reduce
Layer 6" fillcolor=lightgray shape=parallelogram]
	l6_moe_tp0_gpu0 -> l6_allreduce
	l6_allreduce -> l7_attn_tp0_gpu0
	l6_moe_tp1_gpu1 -> l6_allreduce
	l6_allreduce -> l7_attn_tp1_gpu1
	l6_moe_tp2_gpu2 -> l6_allreduce
	l6_allreduce -> l7_attn_tp2_gpu2
	l6_moe_tp3_gpu3 -> l6_allreduce
	l6_allreduce -> l7_attn_tp3_gpu3
	l6_moe_tp4_gpu4 -> l6_allreduce
	l6_allreduce -> l7_attn_tp4_gpu4
	l6_moe_tp5_gpu5 -> l6_allreduce
	l6_allreduce -> l7_attn_tp5_gpu5
	l6_moe_tp6_gpu6 -> l6_allreduce
	l6_allreduce -> l7_attn_tp6_gpu6
	l6_moe_tp7_gpu7 -> l6_allreduce
	l6_allreduce -> l7_attn_tp7_gpu7
	l7_attn_tp0_gpu0 -> l7_moe_tp0_gpu0
	l7_attn_tp1_gpu1 -> l7_moe_tp1_gpu1
	l7_attn_tp2_gpu2 -> l7_moe_tp2_gpu2
	l7_attn_tp3_gpu3 -> l7_moe_tp3_gpu3
	l7_attn_tp4_gpu4 -> l7_moe_tp4_gpu4
	l7_attn_tp5_gpu5 -> l7_moe_tp5_gpu5
	l7_attn_tp6_gpu6 -> l7_moe_tp6_gpu6
	l7_attn_tp7_gpu7 -> l7_moe_tp7_gpu7
	l7_allreduce [label="TP All-Reduce
Layer 7" fillcolor=lightgray shape=parallelogram]
	l7_moe_tp0_gpu0 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp1_gpu1 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp2_gpu2 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp3_gpu3 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp4_gpu4 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp5_gpu5 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp6_gpu6 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l7_moe_tp7_gpu7 -> l7_allreduce
	pipeline_stage_0_1 [label="Pipeline Comm
Stage0→Stage1" fillcolor=orange shape=parallelogram style=dashed]
	l7_allreduce -> pipeline_stage_0_1
	pipeline_stage_0_1 -> l8_attn_tp0_gpu8
	pipeline_stage_0_1 -> l8_attn_tp1_gpu9
	pipeline_stage_0_1 -> l8_attn_tp2_gpu10
	pipeline_stage_0_1 -> l8_attn_tp3_gpu11
	pipeline_stage_0_1 -> l8_attn_tp4_gpu12
	pipeline_stage_0_1 -> l8_attn_tp5_gpu13
	pipeline_stage_0_1 -> l8_attn_tp6_gpu14
	pipeline_stage_0_1 -> l8_attn_tp7_gpu15
	l8_attn_tp0_gpu8 -> l8_moe_tp0_gpu8
	l8_attn_tp1_gpu9 -> l8_moe_tp1_gpu9
	l8_attn_tp2_gpu10 -> l8_moe_tp2_gpu10
	l8_attn_tp3_gpu11 -> l8_moe_tp3_gpu11
	l8_attn_tp4_gpu12 -> l8_moe_tp4_gpu12
	l8_attn_tp5_gpu13 -> l8_moe_tp5_gpu13
	l8_attn_tp6_gpu14 -> l8_moe_tp6_gpu14
	l8_attn_tp7_gpu15 -> l8_moe_tp7_gpu15
	l8_allreduce [label="TP All-Reduce
Layer 8" fillcolor=lightgray shape=parallelogram]
	l8_moe_tp0_gpu8 -> l8_allreduce
	l8_allreduce -> l9_attn_tp0_gpu8
	l8_moe_tp1_gpu9 -> l8_allreduce
	l8_allreduce -> l9_attn_tp1_gpu9
	l8_moe_tp2_gpu10 -> l8_allreduce
	l8_allreduce -> l9_attn_tp2_gpu10
	l8_moe_tp3_gpu11 -> l8_allreduce
	l8_allreduce -> l9_attn_tp3_gpu11
	l8_moe_tp4_gpu12 -> l8_allreduce
	l8_allreduce -> l9_attn_tp4_gpu12
	l8_moe_tp5_gpu13 -> l8_allreduce
	l8_allreduce -> l9_attn_tp5_gpu13
	l8_moe_tp6_gpu14 -> l8_allreduce
	l8_allreduce -> l9_attn_tp6_gpu14
	l8_moe_tp7_gpu15 -> l8_allreduce
	l8_allreduce -> l9_attn_tp7_gpu15
	l9_attn_tp0_gpu8 -> l9_moe_tp0_gpu8
	l9_attn_tp1_gpu9 -> l9_moe_tp1_gpu9
	l9_attn_tp2_gpu10 -> l9_moe_tp2_gpu10
	l9_attn_tp3_gpu11 -> l9_moe_tp3_gpu11
	l9_attn_tp4_gpu12 -> l9_moe_tp4_gpu12
	l9_attn_tp5_gpu13 -> l9_moe_tp5_gpu13
	l9_attn_tp6_gpu14 -> l9_moe_tp6_gpu14
	l9_attn_tp7_gpu15 -> l9_moe_tp7_gpu15
	l9_allreduce [label="TP All-Reduce
Layer 9" fillcolor=lightgray shape=parallelogram]
	l9_moe_tp0_gpu8 -> l9_allreduce
	l9_allreduce -> l10_attn_tp0_gpu8
	l9_moe_tp1_gpu9 -> l9_allreduce
	l9_allreduce -> l10_attn_tp1_gpu9
	l9_moe_tp2_gpu10 -> l9_allreduce
	l9_allreduce -> l10_attn_tp2_gpu10
	l9_moe_tp3_gpu11 -> l9_allreduce
	l9_allreduce -> l10_attn_tp3_gpu11
	l9_moe_tp4_gpu12 -> l9_allreduce
	l9_allreduce -> l10_attn_tp4_gpu12
	l9_moe_tp5_gpu13 -> l9_allreduce
	l9_allreduce -> l10_attn_tp5_gpu13
	l9_moe_tp6_gpu14 -> l9_allreduce
	l9_allreduce -> l10_attn_tp6_gpu14
	l9_moe_tp7_gpu15 -> l9_allreduce
	l9_allreduce -> l10_attn_tp7_gpu15
	l10_attn_tp0_gpu8 -> l10_moe_tp0_gpu8
	l10_attn_tp1_gpu9 -> l10_moe_tp1_gpu9
	l10_attn_tp2_gpu10 -> l10_moe_tp2_gpu10
	l10_attn_tp3_gpu11 -> l10_moe_tp3_gpu11
	l10_attn_tp4_gpu12 -> l10_moe_tp4_gpu12
	l10_attn_tp5_gpu13 -> l10_moe_tp5_gpu13
	l10_attn_tp6_gpu14 -> l10_moe_tp6_gpu14
	l10_attn_tp7_gpu15 -> l10_moe_tp7_gpu15
	l10_allreduce [label="TP All-Reduce
Layer 10" fillcolor=lightgray shape=parallelogram]
	l10_moe_tp0_gpu8 -> l10_allreduce
	l10_allreduce -> l11_attn_tp0_gpu8
	l10_moe_tp1_gpu9 -> l10_allreduce
	l10_allreduce -> l11_attn_tp1_gpu9
	l10_moe_tp2_gpu10 -> l10_allreduce
	l10_allreduce -> l11_attn_tp2_gpu10
	l10_moe_tp3_gpu11 -> l10_allreduce
	l10_allreduce -> l11_attn_tp3_gpu11
	l10_moe_tp4_gpu12 -> l10_allreduce
	l10_allreduce -> l11_attn_tp4_gpu12
	l10_moe_tp5_gpu13 -> l10_allreduce
	l10_allreduce -> l11_attn_tp5_gpu13
	l10_moe_tp6_gpu14 -> l10_allreduce
	l10_allreduce -> l11_attn_tp6_gpu14
	l10_moe_tp7_gpu15 -> l10_allreduce
	l10_allreduce -> l11_attn_tp7_gpu15
	l11_attn_tp0_gpu8 -> l11_moe_tp0_gpu8
	l11_attn_tp1_gpu9 -> l11_moe_tp1_gpu9
	l11_attn_tp2_gpu10 -> l11_moe_tp2_gpu10
	l11_attn_tp3_gpu11 -> l11_moe_tp3_gpu11
	l11_attn_tp4_gpu12 -> l11_moe_tp4_gpu12
	l11_attn_tp5_gpu13 -> l11_moe_tp5_gpu13
	l11_attn_tp6_gpu14 -> l11_moe_tp6_gpu14
	l11_attn_tp7_gpu15 -> l11_moe_tp7_gpu15
	l11_allreduce [label="TP All-Reduce
Layer 11" fillcolor=lightgray shape=parallelogram]
	l11_moe_tp0_gpu8 -> l11_allreduce
	l11_allreduce -> l12_attn_tp0_gpu8
	l11_moe_tp1_gpu9 -> l11_allreduce
	l11_allreduce -> l12_attn_tp1_gpu9
	l11_moe_tp2_gpu10 -> l11_allreduce
	l11_allreduce -> l12_attn_tp2_gpu10
	l11_moe_tp3_gpu11 -> l11_allreduce
	l11_allreduce -> l12_attn_tp3_gpu11
	l11_moe_tp4_gpu12 -> l11_allreduce
	l11_allreduce -> l12_attn_tp4_gpu12
	l11_moe_tp5_gpu13 -> l11_allreduce
	l11_allreduce -> l12_attn_tp5_gpu13
	l11_moe_tp6_gpu14 -> l11_allreduce
	l11_allreduce -> l12_attn_tp6_gpu14
	l11_moe_tp7_gpu15 -> l11_allreduce
	l11_allreduce -> l12_attn_tp7_gpu15
	l12_attn_tp0_gpu8 -> l12_moe_tp0_gpu8
	l12_attn_tp1_gpu9 -> l12_moe_tp1_gpu9
	l12_attn_tp2_gpu10 -> l12_moe_tp2_gpu10
	l12_attn_tp3_gpu11 -> l12_moe_tp3_gpu11
	l12_attn_tp4_gpu12 -> l12_moe_tp4_gpu12
	l12_attn_tp5_gpu13 -> l12_moe_tp5_gpu13
	l12_attn_tp6_gpu14 -> l12_moe_tp6_gpu14
	l12_attn_tp7_gpu15 -> l12_moe_tp7_gpu15
	l12_allreduce [label="TP All-Reduce
Layer 12" fillcolor=lightgray shape=parallelogram]
	l12_moe_tp0_gpu8 -> l12_allreduce
	l12_allreduce -> l13_attn_tp0_gpu8
	l12_moe_tp1_gpu9 -> l12_allreduce
	l12_allreduce -> l13_attn_tp1_gpu9
	l12_moe_tp2_gpu10 -> l12_allreduce
	l12_allreduce -> l13_attn_tp2_gpu10
	l12_moe_tp3_gpu11 -> l12_allreduce
	l12_allreduce -> l13_attn_tp3_gpu11
	l12_moe_tp4_gpu12 -> l12_allreduce
	l12_allreduce -> l13_attn_tp4_gpu12
	l12_moe_tp5_gpu13 -> l12_allreduce
	l12_allreduce -> l13_attn_tp5_gpu13
	l12_moe_tp6_gpu14 -> l12_allreduce
	l12_allreduce -> l13_attn_tp6_gpu14
	l12_moe_tp7_gpu15 -> l12_allreduce
	l12_allreduce -> l13_attn_tp7_gpu15
	l13_attn_tp0_gpu8 -> l13_moe_tp0_gpu8
	l13_attn_tp1_gpu9 -> l13_moe_tp1_gpu9
	l13_attn_tp2_gpu10 -> l13_moe_tp2_gpu10
	l13_attn_tp3_gpu11 -> l13_moe_tp3_gpu11
	l13_attn_tp4_gpu12 -> l13_moe_tp4_gpu12
	l13_attn_tp5_gpu13 -> l13_moe_tp5_gpu13
	l13_attn_tp6_gpu14 -> l13_moe_tp6_gpu14
	l13_attn_tp7_gpu15 -> l13_moe_tp7_gpu15
	l13_allreduce [label="TP All-Reduce
Layer 13" fillcolor=lightgray shape=parallelogram]
	l13_moe_tp0_gpu8 -> l13_allreduce
	l13_allreduce -> l14_attn_tp0_gpu8
	l13_moe_tp1_gpu9 -> l13_allreduce
	l13_allreduce -> l14_attn_tp1_gpu9
	l13_moe_tp2_gpu10 -> l13_allreduce
	l13_allreduce -> l14_attn_tp2_gpu10
	l13_moe_tp3_gpu11 -> l13_allreduce
	l13_allreduce -> l14_attn_tp3_gpu11
	l13_moe_tp4_gpu12 -> l13_allreduce
	l13_allreduce -> l14_attn_tp4_gpu12
	l13_moe_tp5_gpu13 -> l13_allreduce
	l13_allreduce -> l14_attn_tp5_gpu13
	l13_moe_tp6_gpu14 -> l13_allreduce
	l13_allreduce -> l14_attn_tp6_gpu14
	l13_moe_tp7_gpu15 -> l13_allreduce
	l13_allreduce -> l14_attn_tp7_gpu15
	l14_attn_tp0_gpu8 -> l14_moe_tp0_gpu8
	l14_attn_tp1_gpu9 -> l14_moe_tp1_gpu9
	l14_attn_tp2_gpu10 -> l14_moe_tp2_gpu10
	l14_attn_tp3_gpu11 -> l14_moe_tp3_gpu11
	l14_attn_tp4_gpu12 -> l14_moe_tp4_gpu12
	l14_attn_tp5_gpu13 -> l14_moe_tp5_gpu13
	l14_attn_tp6_gpu14 -> l14_moe_tp6_gpu14
	l14_attn_tp7_gpu15 -> l14_moe_tp7_gpu15
	l14_allreduce [label="TP All-Reduce
Layer 14" fillcolor=lightgray shape=parallelogram]
	l14_moe_tp0_gpu8 -> l14_allreduce
	l14_allreduce -> l15_attn_tp0_gpu8
	l14_moe_tp1_gpu9 -> l14_allreduce
	l14_allreduce -> l15_attn_tp1_gpu9
	l14_moe_tp2_gpu10 -> l14_allreduce
	l14_allreduce -> l15_attn_tp2_gpu10
	l14_moe_tp3_gpu11 -> l14_allreduce
	l14_allreduce -> l15_attn_tp3_gpu11
	l14_moe_tp4_gpu12 -> l14_allreduce
	l14_allreduce -> l15_attn_tp4_gpu12
	l14_moe_tp5_gpu13 -> l14_allreduce
	l14_allreduce -> l15_attn_tp5_gpu13
	l14_moe_tp6_gpu14 -> l14_allreduce
	l14_allreduce -> l15_attn_tp6_gpu14
	l14_moe_tp7_gpu15 -> l14_allreduce
	l14_allreduce -> l15_attn_tp7_gpu15
	l15_attn_tp0_gpu8 -> l15_moe_tp0_gpu8
	l15_attn_tp1_gpu9 -> l15_moe_tp1_gpu9
	l15_attn_tp2_gpu10 -> l15_moe_tp2_gpu10
	l15_attn_tp3_gpu11 -> l15_moe_tp3_gpu11
	l15_attn_tp4_gpu12 -> l15_moe_tp4_gpu12
	l15_attn_tp5_gpu13 -> l15_moe_tp5_gpu13
	l15_attn_tp6_gpu14 -> l15_moe_tp6_gpu14
	l15_attn_tp7_gpu15 -> l15_moe_tp7_gpu15
	output [label="Output
batch_size=128, seq_len=10000, d_model=4096" fillcolor=lightgreen shape=ellipse]
	l15_moe_tp0_gpu8 -> output
	l15_moe_tp1_gpu9 -> output
	l15_moe_tp2_gpu10 -> output
	l15_moe_tp3_gpu11 -> output
	l15_moe_tp4_gpu12 -> output
	l15_moe_tp5_gpu13 -> output
	l15_moe_tp6_gpu14 -> output
	l15_moe_tp7_gpu15 -> output
}
