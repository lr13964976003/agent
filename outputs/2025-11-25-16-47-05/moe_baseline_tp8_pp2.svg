<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Baseline_TP8_PP2 Pages: 1 -->
<svg width="1440pt" height="43pt"
 viewBox="0.00 0.00 1440.00 43.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 845.74)">
<title>MoE_Baseline_TP8_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-845.74 28128.78,-845.74 28128.78,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="616.57,-554 616.57,-780 27110.57,-780 27110.57,-554 616.57,-554"/>
<text text-anchor="middle" x="13863.57" y="-764.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="13863.57" y="-749.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="739.57,-104 739.57,-330 27233.57,-330 27233.57,-104 739.57,-104"/>
<text text-anchor="middle" x="13986.57" y="-314.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="13986.57" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="15519.57" cy="-814.87" rx="258.19" ry="26.74"/>
<text text-anchor="middle" x="15519.57" y="-818.67" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="15519.57" y="-803.67" font-family="Times,serif" font-size="14.00">batch_size=128, seq_len=10000, d_model=4096</text>
</g>
<!-- l0_attn_tp0_gpu0 -->
<g id="node2" class="node">
<title>l0_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="16752.57,-734 16356.57,-734 16356.57,-666 16752.57,-666 16752.57,-734"/>
<text text-anchor="middle" x="16554.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="16554.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="16554.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="16554.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp0_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M15776.56,-812.39C15978.43,-809.54 16242.4,-801.62 16347.57,-780 16391.16,-771.04 16437.63,-754.04 16475.47,-738.1"/>
<polygon fill="black" stroke="black" points="16477.08,-741.22 16484.9,-734.08 16474.33,-734.79 16477.08,-741.22"/>
</g>
<!-- l0_attn_tp1_gpu1 -->
<g id="node3" class="node">
<title>l0_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="16338.57,-734 15942.57,-734 15942.57,-666 16338.57,-666 16338.57,-734"/>
<text text-anchor="middle" x="16140.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="16140.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="16140.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="16140.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp1_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;l0_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M15761.85,-805.59C15818.66,-800.48 15878.62,-792.47 15933.57,-780 15976.28,-770.31 16021.94,-753.61 16059.48,-738.06"/>
<polygon fill="black" stroke="black" points="16060.97,-741.23 16068.84,-734.13 16058.27,-734.77 16060.97,-741.23"/>
</g>
<!-- l0_attn_tp2_gpu2 -->
<g id="node4" class="node">
<title>l0_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="15924.57,-734 15528.57,-734 15528.57,-666 15924.57,-666 15924.57,-734"/>
<text text-anchor="middle" x="15726.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="15726.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="15726.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="15726.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp2_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;l0_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M15566.28,-788.4C15592.97,-773.84 15626.96,-755.31 15656.77,-739.06"/>
<polygon fill="black" stroke="black" points="15658.77,-741.96 15665.87,-734.1 15655.42,-735.81 15658.77,-741.96"/>
</g>
<!-- l0_attn_tp3_gpu3 -->
<g id="node5" class="node">
<title>l0_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="15510.57,-734 15114.57,-734 15114.57,-666 15510.57,-666 15510.57,-734"/>
<text text-anchor="middle" x="15312.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="15312.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="15312.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="15312.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp3_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;l0_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M15472.86,-788.4C15446.16,-773.84 15412.17,-755.31 15382.37,-739.06"/>
<polygon fill="black" stroke="black" points="15383.72,-735.81 15373.27,-734.1 15380.37,-741.96 15383.72,-735.81"/>
</g>
<!-- l0_attn_tp4_gpu4 -->
<g id="node6" class="node">
<title>l0_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="15096.57,-734 14700.57,-734 14700.57,-666 15096.57,-666 15096.57,-734"/>
<text text-anchor="middle" x="14898.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="14898.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="14898.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14898.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp4_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;l0_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M15277.28,-805.59C15220.48,-800.48 15160.51,-792.47 15105.57,-780 15062.86,-770.31 15017.2,-753.61 14979.65,-738.06"/>
<polygon fill="black" stroke="black" points="14980.87,-734.77 14970.29,-734.13 14978.16,-741.23 14980.87,-734.77"/>
</g>
<!-- l0_attn_tp5_gpu5 -->
<g id="node7" class="node">
<title>l0_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="14682.57,-734 14286.57,-734 14286.57,-666 14682.57,-666 14682.57,-734"/>
<text text-anchor="middle" x="14484.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="14484.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="14484.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14484.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp5_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;l0_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M15262.58,-812.39C15060.71,-809.54 14796.73,-801.62 14691.57,-780 14647.98,-771.04 14601.51,-754.04 14563.66,-738.1"/>
<polygon fill="black" stroke="black" points="14564.81,-734.79 14554.24,-734.08 14562.06,-741.22 14564.81,-734.79"/>
</g>
<!-- l0_attn_tp6_gpu6 -->
<g id="node8" class="node">
<title>l0_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="14268.57,-734 13872.57,-734 13872.57,-666 14268.57,-666 14268.57,-734"/>
<text text-anchor="middle" x="14070.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="14070.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="14070.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14070.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp6_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;l0_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M15263.42,-811.48C14927.9,-807.64 14371.09,-798.56 14277.57,-780 14233.74,-771.3 14187.07,-754.23 14149.16,-738.18"/>
<polygon fill="black" stroke="black" points="14150.29,-734.86 14139.72,-734.13 14147.52,-741.29 14150.29,-734.86"/>
</g>
<!-- l0_attn_tp7_gpu7 -->
<g id="node9" class="node">
<title>l0_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="17166.57,-734 16770.57,-734 16770.57,-666 17166.57,-666 17166.57,-734"/>
<text text-anchor="middle" x="16968.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 0</text>
<text text-anchor="middle" x="16968.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="16968.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="16968.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- input&#45;&gt;l0_attn_tp7_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;l0_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M15775.72,-811.48C16111.24,-807.64 16668.04,-798.56 16761.57,-780 16805.39,-771.3 16852.07,-754.23 16889.98,-738.18"/>
<polygon fill="black" stroke="black" points="16891.61,-741.29 16899.42,-734.13 16888.85,-734.86 16891.61,-741.29"/>
</g>
<!-- l0_moe_tp0_gpu0 -->
<g id="node10" class="node">
<title>l0_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="13737.07,-630 13350.07,-630 13350.07,-562 13737.07,-562 13737.07,-630"/>
<text text-anchor="middle" x="13543.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="13543.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="13543.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="13543.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp0_gpu0&#45;&gt;l0_moe_tp0_gpu0 -->
<g id="edge9" class="edge">
<title>l0_attn_tp0_gpu0&#45;&gt;l0_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M16356.33,-666.8C16353.39,-666.52 16350.47,-666.25 16347.57,-666 15199.1,-567.03 14900.01,-730.07 13747.35,-630.01"/>
<polygon fill="black" stroke="black" points="13747.43,-626.51 13737.16,-629.12 13746.82,-633.48 13747.43,-626.51"/>
</g>
<!-- l0_moe_tp1_gpu1 -->
<g id="node11" class="node">
<title>l0_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="13332.07,-630 12945.07,-630 12945.07,-562 13332.07,-562 13332.07,-630"/>
<text text-anchor="middle" x="13138.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="13138.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="13138.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13138.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp1_gpu1&#45;&gt;l0_moe_tp1_gpu1 -->
<g id="edge10" class="edge">
<title>l0_attn_tp1_gpu1&#45;&gt;l0_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M15942.33,-666.8C15939.39,-666.52 15936.47,-666.25 15933.57,-666 14789.08,-567.34 14491.01,-729.75 13342.31,-630.01"/>
<polygon fill="black" stroke="black" points="13342.43,-626.51 13332.16,-629.12 13341.82,-633.48 13342.43,-626.51"/>
</g>
<!-- l0_moe_tp2_gpu2 -->
<g id="node12" class="node">
<title>l0_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="12927.07,-630 12540.07,-630 12540.07,-562 12927.07,-562 12927.07,-630"/>
<text text-anchor="middle" x="12733.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="12733.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="12733.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12733.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp2_gpu2&#45;&gt;l0_moe_tp2_gpu2 -->
<g id="edge11" class="edge">
<title>l0_attn_tp2_gpu2&#45;&gt;l0_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M15528.33,-666.8C15525.39,-666.52 15522.47,-666.25 15519.57,-666 14379.05,-567.66 14082.02,-729.43 12937.28,-630.01"/>
<polygon fill="black" stroke="black" points="12937.43,-626.51 12927.16,-629.12 12936.82,-633.48 12937.43,-626.51"/>
</g>
<!-- l0_moe_tp3_gpu3 -->
<g id="node13" class="node">
<title>l0_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="12522.07,-630 12135.07,-630 12135.07,-562 12522.07,-562 12522.07,-630"/>
<text text-anchor="middle" x="12328.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="12328.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="12328.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12328.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp3_gpu3&#45;&gt;l0_moe_tp3_gpu3 -->
<g id="edge12" class="edge">
<title>l0_attn_tp3_gpu3&#45;&gt;l0_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M15114.33,-666.8C15111.39,-666.52 15108.47,-666.25 15105.57,-666 13969.03,-567.97 13673.03,-729.11 12532.24,-630"/>
<polygon fill="black" stroke="black" points="12532.43,-626.51 12522.16,-629.12 12531.82,-633.48 12532.43,-626.51"/>
</g>
<!-- l0_moe_tp4_gpu4 -->
<g id="node14" class="node">
<title>l0_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="12117.07,-630 11730.07,-630 11730.07,-562 12117.07,-562 12117.07,-630"/>
<text text-anchor="middle" x="11923.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="11923.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="11923.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="11923.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp4_gpu4&#45;&gt;l0_moe_tp4_gpu4 -->
<g id="edge13" class="edge">
<title>l0_attn_tp4_gpu4&#45;&gt;l0_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M14700.33,-666.8C14697.39,-666.52 14694.47,-666.25 14691.57,-666 13559,-568.29 13264.04,-728.79 12127.21,-630"/>
<polygon fill="black" stroke="black" points="12127.43,-626.51 12117.16,-629.12 12126.82,-633.48 12127.43,-626.51"/>
</g>
<!-- l0_moe_tp5_gpu5 -->
<g id="node15" class="node">
<title>l0_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="11712.07,-630 11325.07,-630 11325.07,-562 11712.07,-562 11712.07,-630"/>
<text text-anchor="middle" x="11518.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="11518.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="11518.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="11518.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp5_gpu5&#45;&gt;l0_moe_tp5_gpu5 -->
<g id="edge14" class="edge">
<title>l0_attn_tp5_gpu5&#45;&gt;l0_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M14286.33,-666.8C14283.39,-666.52 14280.47,-666.25 14277.57,-666 13148.98,-568.6 12855.04,-728.47 11722.17,-630"/>
<polygon fill="black" stroke="black" points="11722.43,-626.51 11712.16,-629.12 11721.82,-633.48 11722.43,-626.51"/>
</g>
<!-- l0_moe_tp6_gpu6 -->
<g id="node16" class="node">
<title>l0_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="11307.07,-630 10920.07,-630 10920.07,-562 11307.07,-562 11307.07,-630"/>
<text text-anchor="middle" x="11113.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="11113.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="11113.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11113.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp6_gpu6&#45;&gt;l0_moe_tp6_gpu6 -->
<g id="edge15" class="edge">
<title>l0_attn_tp6_gpu6&#45;&gt;l0_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M13872.33,-666.8C13869.39,-666.52 13866.47,-666.25 13863.57,-666 12738.95,-568.92 12446.05,-728.16 11317.14,-629.99"/>
<polygon fill="black" stroke="black" points="11317.43,-626.51 11307.16,-629.12 11316.82,-633.48 11317.43,-626.51"/>
</g>
<!-- l0_moe_tp7_gpu7 -->
<g id="node17" class="node">
<title>l0_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="14142.07,-630 13755.07,-630 13755.07,-562 14142.07,-562 14142.07,-630"/>
<text text-anchor="middle" x="13948.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 0</text>
<text text-anchor="middle" x="13948.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="13948.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13948.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l0_attn_tp7_gpu7&#45;&gt;l0_moe_tp7_gpu7 -->
<g id="edge16" class="edge">
<title>l0_attn_tp7_gpu7&#45;&gt;l0_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M16770.33,-666.8C16767.39,-666.52 16764.47,-666.25 16761.57,-666 15609.13,-566.71 15309,-730.38 14152.38,-630.01"/>
<polygon fill="black" stroke="black" points="14152.43,-626.51 14142.16,-629.12 14151.82,-633.48 14152.43,-626.51"/>
</g>
<!-- l0_allreduce -->
<g id="node258" class="node">
<title>l0_allreduce</title>
<polygon fill="lightgray" stroke="black" points="8524.6,-526 8333.66,-526 8284.54,-450 8475.48,-450 8524.6,-526"/>
<text text-anchor="middle" x="8404.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8404.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- l0_moe_tp0_gpu0&#45;&gt;l0_allreduce -->
<g id="edge17" class="edge">
<title>l0_moe_tp0_gpu0&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M13397.33,-561.97C13378.65,-558.74 13359.71,-555.94 13341.57,-554 12846.65,-500.99 9185.61,-490.66 8511.19,-489.21"/>
<polygon fill="black" stroke="black" points="8511.01,-485.71 8501.01,-489.18 8511,-492.71 8511.01,-485.71"/>
</g>
<!-- l0_moe_tp1_gpu1&#45;&gt;l0_allreduce -->
<g id="edge19" class="edge">
<title>l0_moe_tp1_gpu1&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M12992.33,-561.99C12973.65,-558.76 12954.71,-555.95 12936.57,-554 12484.38,-505.3 9152.81,-491.55 8511.28,-489.34"/>
<polygon fill="black" stroke="black" points="8511.14,-485.84 8501.13,-489.31 8511.11,-492.84 8511.14,-485.84"/>
</g>
<!-- l0_moe_tp2_gpu2&#45;&gt;l0_allreduce -->
<g id="edge21" class="edge">
<title>l0_moe_tp2_gpu2&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M12587.05,-561.97C12568.46,-558.75 12549.62,-555.96 12531.57,-554 12122.02,-509.6 9118.36,-492.52 8511.34,-489.5"/>
<polygon fill="black" stroke="black" points="8511.3,-486 8501.29,-489.45 8511.27,-493 8511.3,-486"/>
</g>
<!-- l0_moe_tp3_gpu3&#45;&gt;l0_allreduce -->
<g id="edge23" class="edge">
<title>l0_moe_tp3_gpu3&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M12182.05,-562C12163.46,-558.78 12144.62,-555.97 12126.57,-554 11759.61,-513.9 9083.08,-493.6 8511.7,-489.7"/>
<polygon fill="black" stroke="black" points="8511.43,-486.2 8501.41,-489.63 8511.38,-493.2 8511.43,-486.2"/>
</g>
<!-- l0_moe_tp4_gpu4&#45;&gt;l0_allreduce -->
<g id="edge25" class="edge">
<title>l0_moe_tp4_gpu4&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M11776.77,-561.99C11758.27,-558.78 11739.53,-555.98 11721.57,-554 11397.04,-518.18 9045.18,-494.82 8511.9,-489.95"/>
<polygon fill="black" stroke="black" points="8511.56,-486.45 8501.53,-489.85 8511.5,-493.45 8511.56,-486.45"/>
</g>
<!-- l0_moe_tp5_gpu5&#45;&gt;l0_allreduce -->
<g id="edge27" class="edge">
<title>l0_moe_tp5_gpu5&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M11371.49,-561.99C11353.08,-558.79 11334.44,-556 11316.57,-554 10756.88,-491.46 8966.66,-488.54 8510.92,-488.84"/>
<polygon fill="black" stroke="black" points="8510.73,-485.34 8500.73,-488.85 8510.73,-492.34 8510.73,-485.34"/>
</g>
<!-- l0_moe_tp6_gpu6&#45;&gt;l0_allreduce -->
<g id="edge29" class="edge">
<title>l0_moe_tp6_gpu6&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M10965.94,-561.96C10947.7,-558.79 10929.26,-556.01 10911.57,-554 10435.76,-499.96 8926.64,-490.8 8511.29,-489.29"/>
<polygon fill="black" stroke="black" points="8511.1,-485.79 8501.09,-489.25 8511.08,-492.79 8511.1,-485.79"/>
</g>
<!-- l0_moe_tp7_gpu7&#45;&gt;l0_allreduce -->
<g id="edge31" class="edge">
<title>l0_moe_tp7_gpu7&#45;&gt;l0_allreduce</title>
<path fill="none" stroke="black" d="M13802.34,-561.96C13783.65,-558.73 13764.72,-555.93 13746.57,-554 13208.81,-496.67 9216.92,-489.85 8511.07,-489.09"/>
<polygon fill="black" stroke="black" points="8510.92,-485.59 8500.92,-489.08 8510.91,-492.59 8510.92,-485.59"/>
</g>
<!-- l1_attn_tp0_gpu0 -->
<g id="node18" class="node">
<title>l1_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="8472.57,-734 8076.57,-734 8076.57,-666 8472.57,-666 8472.57,-734"/>
<text text-anchor="middle" x="8274.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="8274.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="8274.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8274.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp0_gpu0 -->
<g id="node26" class="node">
<title>l1_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="5637.07,-630 5250.07,-630 5250.07,-562 5637.07,-562 5637.07,-630"/>
<text text-anchor="middle" x="5443.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="5443.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="5443.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5443.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp0_gpu0&#45;&gt;l1_moe_tp0_gpu0 -->
<g id="edge33" class="edge">
<title>l1_attn_tp0_gpu0&#45;&gt;l1_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M8076.33,-666.8C8073.39,-666.52 8070.47,-666.25 8067.57,-666 6998.87,-573.35 6720.29,-723.63 5647.44,-630.02"/>
<polygon fill="black" stroke="black" points="5647.43,-626.51 5637.16,-629.12 5646.82,-633.48 5647.43,-626.51"/>
</g>
<!-- l1_attn_tp1_gpu1 -->
<g id="node19" class="node">
<title>l1_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="9714.57,-734 9318.57,-734 9318.57,-666 9714.57,-666 9714.57,-734"/>
<text text-anchor="middle" x="9516.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="9516.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="9516.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9516.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp1_gpu1 -->
<g id="node27" class="node">
<title>l1_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="6852.07,-630 6465.07,-630 6465.07,-562 6852.07,-562 6852.07,-630"/>
<text text-anchor="middle" x="6658.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="6658.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="6658.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6658.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp1_gpu1&#45;&gt;l1_moe_tp1_gpu1 -->
<g id="edge34" class="edge">
<title>l1_attn_tp1_gpu1&#45;&gt;l1_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M9318.33,-666.8C9315.39,-666.52 9312.47,-666.25 9309.57,-666 8228.82,-572.39 7947.2,-724.62 6862.15,-630"/>
<polygon fill="black" stroke="black" points="6862.43,-626.51 6852.16,-629.12 6861.82,-633.48 6862.43,-626.51"/>
</g>
<!-- l1_attn_tp2_gpu2 -->
<g id="node20" class="node">
<title>l1_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="13854.57,-734 13458.57,-734 13458.57,-666 13854.57,-666 13854.57,-734"/>
<text text-anchor="middle" x="13656.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="13656.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="13656.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13656.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp2_gpu2 -->
<g id="node28" class="node">
<title>l1_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="10902.07,-630 10515.07,-630 10515.07,-562 10902.07,-562 10902.07,-630"/>
<text text-anchor="middle" x="10708.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="10708.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="10708.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10708.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp2_gpu2&#45;&gt;l1_moe_tp2_gpu2 -->
<g id="edge35" class="edge">
<title>l1_attn_tp2_gpu2&#45;&gt;l1_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M13458.33,-666.8C13455.39,-666.52 13452.47,-666.25 13449.57,-666 12329.07,-569.24 12037.13,-727.8 10912.51,-630.03"/>
<polygon fill="black" stroke="black" points="10912.43,-626.51 10902.16,-629.12 10911.82,-633.48 10912.43,-626.51"/>
</g>
<!-- l1_attn_tp3_gpu3 -->
<g id="node21" class="node">
<title>l1_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="8886.57,-734 8490.57,-734 8490.57,-666 8886.57,-666 8886.57,-734"/>
<text text-anchor="middle" x="8688.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="8688.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="8688.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8688.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp3_gpu3 -->
<g id="node29" class="node">
<title>l1_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="6042.07,-630 5655.07,-630 5655.07,-562 6042.07,-562 6042.07,-630"/>
<text text-anchor="middle" x="5848.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="5848.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="5848.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5848.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp3_gpu3&#45;&gt;l1_moe_tp3_gpu3 -->
<g id="edge36" class="edge">
<title>l1_attn_tp3_gpu3&#45;&gt;l1_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M8490.33,-666.8C8487.39,-666.52 8484.47,-666.25 8481.57,-666 7408.9,-573.03 7129.28,-723.95 6052.47,-630.02"/>
<polygon fill="black" stroke="black" points="6052.43,-626.51 6042.16,-629.12 6051.82,-633.48 6052.43,-626.51"/>
</g>
<!-- l1_attn_tp4_gpu4 -->
<g id="node22" class="node">
<title>l1_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="8058.57,-734 7662.57,-734 7662.57,-666 8058.57,-666 8058.57,-734"/>
<text text-anchor="middle" x="7860.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="7860.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="7860.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7860.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp4_gpu4 -->
<g id="node30" class="node">
<title>l1_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="5232.07,-630 4845.07,-630 4845.07,-562 5232.07,-562 5232.07,-630"/>
<text text-anchor="middle" x="5038.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="5038.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="5038.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5038.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp4_gpu4&#45;&gt;l1_moe_tp4_gpu4 -->
<g id="edge37" class="edge">
<title>l1_attn_tp4_gpu4&#45;&gt;l1_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M7662.33,-666.8C7659.39,-666.52 7656.47,-666.25 7653.57,-666 6588.85,-573.66 6311.29,-723.31 5242.4,-630.02"/>
<polygon fill="black" stroke="black" points="5242.43,-626.51 5232.16,-629.12 5241.82,-633.48 5242.43,-626.51"/>
</g>
<!-- l1_attn_tp5_gpu5 -->
<g id="node23" class="node">
<title>l1_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="7644.57,-734 7248.57,-734 7248.57,-666 7644.57,-666 7644.57,-734"/>
<text text-anchor="middle" x="7446.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="7446.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="7446.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="7446.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp5_gpu5 -->
<g id="node31" class="node">
<title>l1_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="4827.07,-630 4440.07,-630 4440.07,-562 4827.07,-562 4827.07,-630"/>
<text text-anchor="middle" x="4633.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="4633.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="4633.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4633.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp5_gpu5&#45;&gt;l1_moe_tp5_gpu5 -->
<g id="edge38" class="edge">
<title>l1_attn_tp5_gpu5&#45;&gt;l1_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M7248.33,-666.8C7245.39,-666.52 7242.47,-666.25 7239.57,-666 6178.82,-573.98 5902.3,-722.99 4837.36,-630.01"/>
<polygon fill="black" stroke="black" points="4837.43,-626.51 4827.16,-629.12 4836.82,-633.48 4837.43,-626.51"/>
</g>
<!-- l1_attn_tp6_gpu6 -->
<g id="node24" class="node">
<title>l1_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="9300.57,-734 8904.57,-734 8904.57,-666 9300.57,-666 9300.57,-734"/>
<text text-anchor="middle" x="9102.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="9102.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="9102.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="9102.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp6_gpu6 -->
<g id="node32" class="node">
<title>l1_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="6447.07,-630 6060.07,-630 6060.07,-562 6447.07,-562 6447.07,-630"/>
<text text-anchor="middle" x="6253.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="6253.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="6253.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="6253.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp6_gpu6&#45;&gt;l1_moe_tp6_gpu6 -->
<g id="edge39" class="edge">
<title>l1_attn_tp6_gpu6&#45;&gt;l1_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M8904.33,-666.8C8901.39,-666.52 8898.47,-666.25 8895.57,-666 7818.92,-572.72 7538.27,-724.26 6457.51,-630.03"/>
<polygon fill="black" stroke="black" points="6457.43,-626.51 6447.16,-629.12 6456.82,-633.48 6457.43,-626.51"/>
</g>
<!-- l1_attn_tp7_gpu7 -->
<g id="node25" class="node">
<title>l1_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="10128.57,-734 9732.57,-734 9732.57,-666 10128.57,-666 10128.57,-734"/>
<text text-anchor="middle" x="9930.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 1</text>
<text text-anchor="middle" x="9930.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="9930.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="9930.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l1_moe_tp7_gpu7 -->
<g id="node33" class="node">
<title>l1_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="7257.07,-630 6870.07,-630 6870.07,-562 7257.07,-562 7257.07,-630"/>
<text text-anchor="middle" x="7063.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="7063.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="7063.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="7063.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l1_attn_tp7_gpu7&#45;&gt;l1_moe_tp7_gpu7 -->
<g id="edge40" class="edge">
<title>l1_attn_tp7_gpu7&#45;&gt;l1_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M9732.33,-666.8C9729.39,-666.52 9726.47,-666.25 9723.57,-666 8638.84,-572.08 8356.19,-724.94 7267.19,-630"/>
<polygon fill="black" stroke="black" points="7267.43,-626.51 7257.16,-629.12 7266.82,-633.48 7267.43,-626.51"/>
</g>
<!-- l1_allreduce -->
<g id="node259" class="node">
<title>l1_allreduce</title>
<polygon fill="lightgray" stroke="black" points="3263.6,-526 3072.66,-526 3023.54,-450 3214.48,-450 3263.6,-526"/>
<text text-anchor="middle" x="3143.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3143.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- l1_moe_tp0_gpu0&#45;&gt;l1_allreduce -->
<g id="edge41" class="edge">
<title>l1_moe_tp0_gpu0&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M5295.65,-561.99C5277.51,-558.83 5259.16,-556.04 5241.57,-554 4849.89,-508.51 3621.14,-493.48 3250.47,-489.92"/>
<polygon fill="black" stroke="black" points="3250.32,-486.42 3240.28,-489.82 3250.25,-493.42 3250.32,-486.42"/>
</g>
<!-- l1_moe_tp1_gpu1&#45;&gt;l1_allreduce -->
<g id="edge43" class="edge">
<title>l1_moe_tp1_gpu1&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M6511.77,-561.99C6493.27,-558.78 6474.53,-555.98 6456.57,-554 6375.09,-545.01 3811.39,-500.48 3251.06,-490.84"/>
<polygon fill="black" stroke="black" points="3251.02,-487.34 3240.96,-490.67 3250.9,-494.34 3251.02,-487.34"/>
</g>
<!-- l1_moe_tp2_gpu2&#45;&gt;l1_allreduce -->
<g id="edge45" class="edge">
<title>l1_moe_tp2_gpu2&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M10563.17,-561.98C10544.22,-558.71 10524.99,-555.9 10506.57,-554 10219.2,-524.35 5595.44,-529.25 5306.57,-526 4517.56,-517.13 3566.79,-497.9 3251.17,-491.29"/>
<polygon fill="black" stroke="black" points="3251.19,-487.79 3241.11,-491.08 3251.04,-494.78 3251.19,-487.79"/>
</g>
<!-- l1_moe_tp3_gpu3&#45;&gt;l1_allreduce -->
<g id="edge47" class="edge">
<title>l1_moe_tp3_gpu3&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M5700.94,-561.96C5682.7,-558.79 5664.26,-556.01 5646.57,-554 5171.52,-500.04 3664.81,-490.82 3250.12,-489.29"/>
<polygon fill="black" stroke="black" points="3249.95,-485.79 3239.93,-489.26 3249.92,-492.79 3249.95,-485.79"/>
</g>
<!-- l1_moe_tp4_gpu4&#45;&gt;l1_allreduce -->
<g id="edge49" class="edge">
<title>l1_moe_tp4_gpu4&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M4889.81,-561.98C4871.94,-558.85 4853.89,-556.08 4836.57,-554 4527.7,-516.97 3573.48,-496.76 3251.18,-490.85"/>
<polygon fill="black" stroke="black" points="3250.97,-487.35 3240.91,-490.66 3250.84,-494.35 3250.97,-487.35"/>
</g>
<!-- l1_moe_tp5_gpu5&#45;&gt;l1_allreduce -->
<g id="edge51" class="edge">
<title>l1_moe_tp5_gpu5&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M4483.69,-561.99C4466.18,-558.9 4448.52,-556.14 4431.57,-554 3995.6,-499.07 3471.09,-490.16 3250.03,-488.99"/>
<polygon fill="black" stroke="black" points="3249.75,-485.49 3239.73,-488.94 3249.72,-492.49 3249.75,-485.49"/>
</g>
<!-- l1_moe_tp6_gpu6&#45;&gt;l1_allreduce -->
<g id="edge53" class="edge">
<title>l1_moe_tp6_gpu6&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M6106.49,-561.99C6088.08,-558.79 6069.44,-556 6051.57,-554 5910.06,-538.18 3760.12,-499.77 3251.05,-490.87"/>
<polygon fill="black" stroke="black" points="3250.83,-487.36 3240.77,-490.69 3250.71,-494.36 3250.83,-487.36"/>
</g>
<!-- l1_moe_tp7_gpu7&#45;&gt;l1_allreduce -->
<g id="edge55" class="edge">
<title>l1_moe_tp7_gpu7&#45;&gt;l1_allreduce</title>
<path fill="none" stroke="black" d="M6916.78,-561.95C6898.27,-558.75 6879.53,-555.96 6861.57,-554 6850.04,-552.74 3859.36,-501.3 3250.86,-490.84"/>
<polygon fill="black" stroke="black" points="3250.84,-487.34 3240.78,-490.67 3250.72,-494.34 3250.84,-487.34"/>
</g>
<!-- l2_attn_tp0_gpu0 -->
<g id="node34" class="node">
<title>l2_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="4746.57,-734 4350.57,-734 4350.57,-666 4746.57,-666 4746.57,-734"/>
<text text-anchor="middle" x="4548.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="4548.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="4548.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="4548.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp0_gpu0 -->
<g id="node42" class="node">
<title>l2_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="4017.07,-630 3630.07,-630 3630.07,-562 4017.07,-562 4017.07,-630"/>
<text text-anchor="middle" x="3823.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="3823.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="3823.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3823.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp0_gpu0&#45;&gt;l2_moe_tp0_gpu0 -->
<g id="edge57" class="edge">
<title>l2_attn_tp0_gpu0&#45;&gt;l2_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M4350.56,-667.24C4347.54,-666.82 4344.54,-666.41 4341.57,-666 4205.23,-647.35 4167.89,-649.21 4027.5,-630.1"/>
<polygon fill="black" stroke="black" points="4027.6,-626.58 4017.21,-628.69 4026.64,-633.52 4027.6,-626.58"/>
</g>
<!-- l2_attn_tp1_gpu1 -->
<g id="node35" class="node">
<title>l2_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="7230.57,-734 6834.57,-734 6834.57,-666 7230.57,-666 7230.57,-734"/>
<text text-anchor="middle" x="7032.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="7032.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="7032.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7032.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp1_gpu1 -->
<g id="node43" class="node">
<title>l2_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="4422.07,-630 4035.07,-630 4035.07,-562 4422.07,-562 4422.07,-630"/>
<text text-anchor="middle" x="4228.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="4228.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="4228.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4228.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp1_gpu1&#45;&gt;l2_moe_tp1_gpu1 -->
<g id="edge58" class="edge">
<title>l2_attn_tp1_gpu1&#45;&gt;l2_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M6834.33,-666.8C6831.39,-666.52 6828.47,-666.25 6825.57,-666 5768.8,-574.29 5493.31,-722.67 4432.32,-630.01"/>
<polygon fill="black" stroke="black" points="4432.43,-626.51 4422.16,-629.12 4431.82,-633.48 4432.43,-626.51"/>
</g>
<!-- l2_attn_tp2_gpu2 -->
<g id="node36" class="node">
<title>l2_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="3090.57,-734 2694.57,-734 2694.57,-666 3090.57,-666 3090.57,-734"/>
<text text-anchor="middle" x="2892.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="2892.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="2892.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2892.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp2_gpu2 -->
<g id="node44" class="node">
<title>l2_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="3207.07,-630 2820.07,-630 2820.07,-562 3207.07,-562 3207.07,-630"/>
<text text-anchor="middle" x="3013.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="3013.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="3013.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3013.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp2_gpu2&#45;&gt;l2_moe_tp2_gpu2 -->
<g id="edge59" class="edge">
<title>l2_attn_tp2_gpu2&#45;&gt;l2_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M2931.85,-665.88C2942.84,-656.62 2954.9,-646.45 2966.3,-636.85"/>
<polygon fill="black" stroke="black" points="2968.68,-639.42 2974.07,-630.3 2964.16,-634.07 2968.68,-639.42"/>
</g>
<!-- l2_attn_tp3_gpu3 -->
<g id="node37" class="node">
<title>l2_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="2262.57,-734 1866.57,-734 1866.57,-666 2262.57,-666 2262.57,-734"/>
<text text-anchor="middle" x="2064.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="2064.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="2064.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2064.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp3_gpu3 -->
<g id="node45" class="node">
<title>l2_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2802.07,-630 2415.07,-630 2415.07,-562 2802.07,-562 2802.07,-630"/>
<text text-anchor="middle" x="2608.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="2608.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="2608.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2608.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp3_gpu3&#45;&gt;l2_moe_tp3_gpu3 -->
<g id="edge60" class="edge">
<title>l2_attn_tp3_gpu3&#45;&gt;l2_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M2240.81,-665.95C2298.75,-655.09 2363.34,-642.98 2422.02,-631.98"/>
<polygon fill="black" stroke="black" points="2422.95,-635.36 2432.14,-630.08 2421.66,-628.48 2422.95,-635.36"/>
</g>
<!-- l2_attn_tp4_gpu4 -->
<g id="node38" class="node">
<title>l2_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="1020.57,-734 624.57,-734 624.57,-666 1020.57,-666 1020.57,-734"/>
<text text-anchor="middle" x="822.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="822.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="822.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="822.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp4_gpu4 -->
<g id="node46" class="node">
<title>l2_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="1587.07,-630 1200.07,-630 1200.07,-562 1587.07,-562 1587.07,-630"/>
<text text-anchor="middle" x="1393.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="1393.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="1393.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1393.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp4_gpu4&#45;&gt;l2_moe_tp4_gpu4 -->
<g id="edge61" class="edge">
<title>l2_attn_tp4_gpu4&#45;&gt;l2_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M1007.56,-665.95C1068.63,-655.05 1136.73,-642.88 1198.52,-631.84"/>
<polygon fill="black" stroke="black" points="1199.15,-635.28 1208.38,-630.08 1197.92,-628.39 1199.15,-635.28"/>
</g>
<!-- l2_attn_tp5_gpu5 -->
<g id="node39" class="node">
<title>l2_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="1434.57,-734 1038.57,-734 1038.57,-666 1434.57,-666 1434.57,-734"/>
<text text-anchor="middle" x="1236.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="1236.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="1236.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1236.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp5_gpu5 -->
<g id="node47" class="node">
<title>l2_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="1992.07,-630 1605.07,-630 1605.07,-562 1992.07,-562 1992.07,-630"/>
<text text-anchor="middle" x="1798.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="1798.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="1798.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1798.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp5_gpu5&#45;&gt;l2_moe_tp5_gpu5 -->
<g id="edge62" class="edge">
<title>l2_attn_tp5_gpu5&#45;&gt;l2_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M1418.65,-665.95C1478.63,-655.07 1545.5,-642.93 1606.22,-631.91"/>
<polygon fill="black" stroke="black" points="1607.09,-635.31 1616.3,-630.08 1605.84,-628.42 1607.09,-635.31"/>
</g>
<!-- l2_attn_tp6_gpu6 -->
<g id="node40" class="node">
<title>l2_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="1848.57,-734 1452.57,-734 1452.57,-666 1848.57,-666 1848.57,-734"/>
<text text-anchor="middle" x="1650.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="1650.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="1650.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1650.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp6_gpu6 -->
<g id="node48" class="node">
<title>l2_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="2397.07,-630 2010.07,-630 2010.07,-562 2397.07,-562 2397.07,-630"/>
<text text-anchor="middle" x="2203.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="2203.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="2203.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2203.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp6_gpu6&#45;&gt;l2_moe_tp6_gpu6 -->
<g id="edge63" class="edge">
<title>l2_attn_tp6_gpu6&#45;&gt;l2_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M1829.73,-665.95C1888.75,-655.07 1954.55,-642.93 2014.3,-631.91"/>
<polygon fill="black" stroke="black" points="2015.02,-635.34 2024.22,-630.08 2013.75,-628.45 2015.02,-635.34"/>
</g>
<!-- l2_attn_tp7_gpu7 -->
<g id="node41" class="node">
<title>l2_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="3918.57,-734 3522.57,-734 3522.57,-666 3918.57,-666 3918.57,-734"/>
<text text-anchor="middle" x="3720.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 2</text>
<text text-anchor="middle" x="3720.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="3720.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3720.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l2_moe_tp7_gpu7 -->
<g id="node49" class="node">
<title>l2_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="3612.07,-630 3225.07,-630 3225.07,-562 3612.07,-562 3612.07,-630"/>
<text text-anchor="middle" x="3418.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="3418.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="3418.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3418.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l2_attn_tp7_gpu7&#45;&gt;l2_moe_tp7_gpu7 -->
<g id="edge64" class="edge">
<title>l2_attn_tp7_gpu7&#45;&gt;l2_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M3622.52,-665.88C3591.69,-655.47 3557.49,-643.92 3526.05,-633.3"/>
<polygon fill="black" stroke="black" points="3526.98,-629.92 3516.39,-630.04 3524.74,-636.55 3526.98,-629.92"/>
</g>
<!-- l2_allreduce -->
<g id="node260" class="node">
<title>l2_allreduce</title>
<polygon fill="lightgray" stroke="black" points="1079.6,-526 888.66,-526 839.54,-450 1030.48,-450 1079.6,-526"/>
<text text-anchor="middle" x="959.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="959.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- l2_moe_tp0_gpu0&#45;&gt;l2_allreduce -->
<g id="edge65" class="edge">
<title>l2_moe_tp0_gpu0&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M3676.21,-561.98C3657.89,-558.79 3639.35,-556.01 3621.57,-554 3365.2,-525.08 1531.86,-497.17 1066.67,-490.5"/>
<polygon fill="black" stroke="black" points="1066.65,-487 1056.6,-490.36 1066.55,-494 1066.65,-487"/>
</g>
<!-- l2_moe_tp1_gpu1&#45;&gt;l2_allreduce -->
<g id="edge67" class="edge">
<title>l2_moe_tp1_gpu1&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M4081.49,-561.97C4063.08,-558.77 4044.44,-555.99 4026.57,-554 3951.54,-545.66 1602.18,-501.08 1067.24,-491.02"/>
<polygon fill="black" stroke="black" points="1067.27,-487.52 1057.21,-490.83 1067.14,-494.52 1067.27,-487.52"/>
</g>
<!-- l2_moe_tp2_gpu2&#45;&gt;l2_allreduce -->
<g id="edge69" class="edge">
<title>l2_moe_tp2_gpu2&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M2865.09,-561.97C2847.13,-558.83 2828.98,-556.06 2811.57,-554 2470.26,-513.65 1408.69,-495.38 1066.82,-490.44"/>
<polygon fill="black" stroke="black" points="1066.72,-486.93 1056.67,-490.29 1066.62,-493.93 1066.72,-486.93"/>
</g>
<!-- l2_moe_tp3_gpu3&#45;&gt;l2_allreduce -->
<g id="edge71" class="edge">
<title>l2_moe_tp3_gpu3&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M2459.25,-561.99C2441.56,-558.88 2423.7,-556.11 2406.57,-554 1907.4,-492.51 1304.99,-487.42 1065.33,-488.14"/>
<polygon fill="black" stroke="black" points="1065.22,-484.64 1055.23,-488.18 1065.24,-491.64 1065.22,-484.64"/>
</g>
<!-- l2_moe_tp4_gpu4&#45;&gt;l2_allreduce -->
<g id="edge73" class="edge">
<title>l2_moe_tp4_gpu4&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M1258.33,-561.97C1202.48,-548.33 1138.16,-532.62 1083.54,-519.28"/>
<polygon fill="black" stroke="black" points="1084.35,-515.87 1073.81,-516.9 1082.69,-522.67 1084.35,-515.87"/>
</g>
<!-- l2_moe_tp5_gpu5&#45;&gt;l2_allreduce -->
<g id="edge75" class="edge">
<title>l2_moe_tp5_gpu5&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M1643.89,-561.99C1627.95,-559.07 1611.96,-556.34 1596.57,-554 1413.06,-526.08 1197.93,-506.93 1070.51,-496.99"/>
<polygon fill="black" stroke="black" points="1070.59,-493.48 1060.35,-496.2 1070.05,-500.46 1070.59,-493.48"/>
</g>
<!-- l2_moe_tp6_gpu6&#45;&gt;l2_allreduce -->
<g id="edge77" class="edge">
<title>l2_moe_tp6_gpu6&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M2052.56,-561.99C2035.42,-558.95 2018.15,-556.19 2001.57,-554 1662.35,-509.21 1256.8,-495.13 1067.21,-490.83"/>
<polygon fill="black" stroke="black" points="1067.04,-487.32 1056.97,-490.6 1066.89,-494.32 1067.04,-487.32"/>
</g>
<!-- l2_moe_tp7_gpu7&#45;&gt;l2_allreduce -->
<g id="edge79" class="edge">
<title>l2_moe_tp7_gpu7&#45;&gt;l2_allreduce</title>
<path fill="none" stroke="black" d="M3270.65,-561.96C3252.51,-558.8 3234.17,-556.02 3216.57,-554 2792.2,-505.19 1454.57,-492.38 1066.24,-489.65"/>
<polygon fill="black" stroke="black" points="1066.16,-486.15 1056.14,-489.58 1066.11,-493.15 1066.16,-486.15"/>
</g>
<!-- l3_attn_tp0_gpu0 -->
<g id="node50" class="node">
<title>l3_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="5988.57,-734 5592.57,-734 5592.57,-666 5988.57,-666 5988.57,-734"/>
<text text-anchor="middle" x="5790.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="5790.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="5790.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5790.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp0_gpu0 -->
<g id="node58" class="node">
<title>l3_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="9687.07,-630 9300.07,-630 9300.07,-562 9687.07,-562 9687.07,-630"/>
<text text-anchor="middle" x="9493.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="9493.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="9493.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9493.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp0_gpu0&#45;&gt;l3_moe_tp0_gpu0 -->
<g id="edge81" class="edge">
<title>l3_attn_tp0_gpu0&#45;&gt;l3_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M5988.81,-666.79C5991.75,-666.51 5994.67,-666.25 5997.57,-666 6723.7,-604.49 8545.7,-692.39 9289.79,-630.1"/>
<polygon fill="black" stroke="black" points="9290.19,-633.58 9299.85,-629.24 9289.59,-626.6 9290.19,-633.58"/>
</g>
<!-- l3_attn_tp1_gpu1 -->
<g id="node51" class="node">
<title>l3_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="6402.57,-734 6006.57,-734 6006.57,-666 6402.57,-666 6402.57,-734"/>
<text text-anchor="middle" x="6204.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="6204.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="6204.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6204.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp1_gpu1 -->
<g id="node59" class="node">
<title>l3_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="10092.07,-630 9705.07,-630 9705.07,-562 10092.07,-562 10092.07,-630"/>
<text text-anchor="middle" x="9898.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="9898.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="9898.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9898.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp1_gpu1&#45;&gt;l3_moe_tp1_gpu1 -->
<g id="edge82" class="edge">
<title>l3_attn_tp1_gpu1&#45;&gt;l3_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M6402.81,-666.79C6405.75,-666.51 6408.67,-666.25 6411.57,-666 7135.72,-604.65 8952.74,-692.23 9694.82,-630.1"/>
<polygon fill="black" stroke="black" points="9695.19,-633.58 9704.85,-629.24 9694.59,-626.6 9695.19,-633.58"/>
</g>
<!-- l3_attn_tp2_gpu2 -->
<g id="node52" class="node">
<title>l3_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="6816.57,-734 6420.57,-734 6420.57,-666 6816.57,-666 6816.57,-734"/>
<text text-anchor="middle" x="6618.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="6618.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="6618.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6618.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp2_gpu2 -->
<g id="node60" class="node">
<title>l3_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="10497.07,-630 10110.07,-630 10110.07,-562 10497.07,-562 10497.07,-630"/>
<text text-anchor="middle" x="10303.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="10303.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="10303.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10303.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp2_gpu2&#45;&gt;l3_moe_tp2_gpu2 -->
<g id="edge83" class="edge">
<title>l3_attn_tp2_gpu2&#45;&gt;l3_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M6816.81,-666.79C6819.75,-666.51 6822.67,-666.25 6825.57,-666 7547.74,-604.8 9359.78,-692.07 10099.85,-630.09"/>
<polygon fill="black" stroke="black" points="10100.19,-633.58 10109.85,-629.24 10099.59,-626.6 10100.19,-633.58"/>
</g>
<!-- l3_attn_tp3_gpu3 -->
<g id="node53" class="node">
<title>l3_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="2676.57,-734 2280.57,-734 2280.57,-666 2676.57,-666 2676.57,-734"/>
<text text-anchor="middle" x="2478.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="2478.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="2478.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2478.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp3_gpu3 -->
<g id="node61" class="node">
<title>l3_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="7662.07,-630 7275.07,-630 7275.07,-562 7662.07,-562 7662.07,-630"/>
<text text-anchor="middle" x="7468.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="7468.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="7468.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="7468.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp3_gpu3&#45;&gt;l3_moe_tp3_gpu3 -->
<g id="edge84" class="edge">
<title>l3_attn_tp3_gpu3&#45;&gt;l3_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M2676.81,-666.77C2679.74,-666.5 2682.67,-666.24 2685.57,-666 3696.75,-581.9 6235.4,-715.44 7264.69,-630.11"/>
<polygon fill="black" stroke="black" points="7265.18,-633.58 7274.85,-629.25 7264.6,-626.6 7265.18,-633.58"/>
</g>
<!-- l3_attn_tp4_gpu4 -->
<g id="node54" class="node">
<title>l3_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="5574.57,-734 5178.57,-734 5178.57,-666 5574.57,-666 5574.57,-734"/>
<text text-anchor="middle" x="5376.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="5376.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="5376.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5376.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp4_gpu4 -->
<g id="node62" class="node">
<title>l3_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="9282.07,-630 8895.07,-630 8895.07,-562 9282.07,-562 9282.07,-630"/>
<text text-anchor="middle" x="9088.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="9088.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="9088.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="9088.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp4_gpu4&#45;&gt;l3_moe_tp4_gpu4 -->
<g id="edge85" class="edge">
<title>l3_attn_tp4_gpu4&#45;&gt;l3_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M5574.81,-666.79C5577.75,-666.51 5580.67,-666.25 5583.57,-666 6311.69,-604.33 8138.66,-692.55 8884.76,-630.1"/>
<polygon fill="black" stroke="black" points="8885.19,-633.58 8894.85,-629.24 8884.59,-626.6 8885.19,-633.58"/>
</g>
<!-- l3_attn_tp5_gpu5 -->
<g id="node55" class="node">
<title>l3_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="4332.57,-734 3936.57,-734 3936.57,-666 4332.57,-666 4332.57,-734"/>
<text text-anchor="middle" x="4134.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="4134.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="4134.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4134.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp5_gpu5 -->
<g id="node63" class="node">
<title>l3_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="8472.07,-630 8085.07,-630 8085.07,-562 8472.07,-562 8472.07,-630"/>
<text text-anchor="middle" x="8278.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="8278.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="8278.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8278.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp5_gpu5&#45;&gt;l3_moe_tp5_gpu5 -->
<g id="edge86" class="edge">
<title>l3_attn_tp5_gpu5&#45;&gt;l3_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M4332.81,-666.78C4335.75,-666.5 4338.67,-666.24 4341.57,-666 5165.36,-596.75 7232.84,-700.28 8074.7,-630.11"/>
<polygon fill="black" stroke="black" points="8075.18,-633.58 8084.85,-629.25 8074.59,-626.6 8075.18,-633.58"/>
</g>
<!-- l3_attn_tp6_gpu6 -->
<g id="node56" class="node">
<title>l3_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="3504.57,-734 3108.57,-734 3108.57,-666 3504.57,-666 3504.57,-734"/>
<text text-anchor="middle" x="3306.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="3306.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="3306.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3306.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp6_gpu6 -->
<g id="node64" class="node">
<title>l3_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="8067.07,-630 7680.07,-630 7680.07,-562 8067.07,-562 8067.07,-630"/>
<text text-anchor="middle" x="7873.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="7873.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="7873.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="7873.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp6_gpu6&#45;&gt;l3_moe_tp6_gpu6 -->
<g id="edge87" class="edge">
<title>l3_attn_tp6_gpu6&#45;&gt;l3_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M3504.81,-666.78C3507.74,-666.5 3510.67,-666.24 3513.57,-666 4431.02,-589.33 6733.95,-707.85 7669.59,-630.11"/>
<polygon fill="black" stroke="black" points="7670.18,-633.58 7679.85,-629.25 7669.59,-626.6 7670.18,-633.58"/>
</g>
<!-- l3_attn_tp7_gpu7 -->
<g id="node57" class="node">
<title>l3_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="5160.57,-734 4764.57,-734 4764.57,-666 5160.57,-666 5160.57,-734"/>
<text text-anchor="middle" x="4962.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 3</text>
<text text-anchor="middle" x="4962.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="4962.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4962.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l3_moe_tp7_gpu7 -->
<g id="node65" class="node">
<title>l3_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8877.07,-630 8490.07,-630 8490.07,-562 8877.07,-562 8877.07,-630"/>
<text text-anchor="middle" x="8683.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="8683.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="8683.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8683.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l3_attn_tp7_gpu7&#45;&gt;l3_moe_tp7_gpu7 -->
<g id="edge88" class="edge">
<title>l3_attn_tp7_gpu7&#45;&gt;l3_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M5160.81,-666.79C5163.75,-666.51 5166.67,-666.25 5169.57,-666 5899.67,-604.17 7731.62,-692.71 8479.74,-630.1"/>
<polygon fill="black" stroke="black" points="8480.19,-633.58 8489.85,-629.24 8479.59,-626.6 8480.19,-633.58"/>
</g>
<!-- l3_allreduce -->
<g id="node261" class="node">
<title>l3_allreduce</title>
<polygon fill="lightgray" stroke="black" points="5555.6,-526 5364.66,-526 5315.54,-450 5506.48,-450 5555.6,-526"/>
<text text-anchor="middle" x="5435.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5435.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- l3_moe_tp0_gpu0&#45;&gt;l3_allreduce -->
<g id="edge89" class="edge">
<title>l3_moe_tp0_gpu0&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M9347.05,-561.99C9328.46,-558.77 9309.62,-555.97 9291.57,-554 9100.45,-533.17 6147.67,-497.39 5543.18,-490.26"/>
<polygon fill="black" stroke="black" points="5542.78,-486.75 5532.74,-490.13 5542.69,-493.75 5542.78,-486.75"/>
</g>
<!-- l3_moe_tp1_gpu1&#45;&gt;l3_allreduce -->
<g id="edge91" class="edge">
<title>l3_moe_tp1_gpu1&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M9752.06,-561.96C9733.46,-558.74 9714.62,-555.95 9696.57,-554 9590.19,-542.49 6194.49,-498.68 5543.04,-490.37"/>
<polygon fill="black" stroke="black" points="5542.77,-486.86 5532.73,-490.23 5542.68,-493.86 5542.77,-486.86"/>
</g>
<!-- l3_moe_tp2_gpu2&#45;&gt;l3_allreduce -->
<g id="edge93" class="edge">
<title>l3_moe_tp2_gpu2&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M10157.33,-561.99C10138.65,-558.75 10119.71,-555.95 10101.57,-554 10042.98,-547.7 6234.45,-499.13 5542.72,-490.36"/>
<polygon fill="black" stroke="black" points="5542.56,-486.85 5532.52,-490.23 5542.47,-493.85 5542.56,-486.85"/>
</g>
<!-- l3_moe_tp3_gpu3&#45;&gt;l3_allreduce -->
<g id="edge95" class="edge">
<title>l3_moe_tp3_gpu3&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M7320.09,-561.98C7302.13,-558.84 7283.98,-556.06 7266.57,-554 6929.52,-514.09 5882.03,-495.55 5542.78,-490.48"/>
<polygon fill="black" stroke="black" points="5542.76,-486.98 5532.71,-490.34 5542.65,-493.98 5542.76,-486.98"/>
</g>
<!-- l3_moe_tp4_gpu4&#45;&gt;l3_allreduce -->
<g id="edge97" class="edge">
<title>l3_moe_tp4_gpu4&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M8941.77,-561.98C8923.27,-558.77 8904.53,-555.98 8886.57,-554 8548,-516.76 6088.78,-494.4 5542.77,-489.86"/>
<polygon fill="black" stroke="black" points="5542.57,-486.36 5532.54,-489.78 5542.51,-493.36 5542.57,-486.36"/>
</g>
<!-- l3_moe_tp5_gpu5&#45;&gt;l3_allreduce -->
<g id="edge99" class="edge">
<title>l3_moe_tp5_gpu5&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M8131.21,-561.98C8112.89,-558.79 8094.35,-556.01 8076.57,-554 7573.07,-497.15 5971.29,-490.01 5542.19,-489.12"/>
<polygon fill="black" stroke="black" points="5541.97,-485.62 5531.96,-489.1 5541.96,-492.62 5541.97,-485.62"/>
</g>
<!-- l3_moe_tp6_gpu6&#45;&gt;l3_allreduce -->
<g id="edge101" class="edge">
<title>l3_moe_tp6_gpu6&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M7725.65,-561.96C7707.51,-558.8 7689.17,-556.03 7671.57,-554 7251.51,-505.63 5928.23,-492.52 5542.24,-489.68"/>
<polygon fill="black" stroke="black" points="5542.22,-486.18 5532.19,-489.61 5542.17,-493.18 5542.22,-486.18"/>
</g>
<!-- l3_moe_tp7_gpu7&#45;&gt;l3_allreduce -->
<g id="edge103" class="edge">
<title>l3_moe_tp7_gpu7&#45;&gt;l3_allreduce</title>
<path fill="none" stroke="black" d="M8536.49,-561.97C8518.08,-558.78 8499.44,-555.99 8481.57,-554 7894,-488.63 6010.07,-487.86 5541.74,-488.72"/>
<polygon fill="black" stroke="black" points="5541.6,-485.22 5531.6,-488.74 5541.61,-492.22 5541.6,-485.22"/>
</g>
<!-- l4_attn_tp0_gpu0 -->
<g id="node66" class="node">
<title>l4_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="12612.57,-734 12216.57,-734 12216.57,-666 12612.57,-666 12612.57,-734"/>
<text text-anchor="middle" x="12414.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="12414.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="12414.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="12414.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp0_gpu0 -->
<g id="node74" class="node">
<title>l4_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="19407.07,-630 19020.07,-630 19020.07,-562 19407.07,-562 19407.07,-630"/>
<text text-anchor="middle" x="19213.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="19213.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="19213.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="19213.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp0_gpu0&#45;&gt;l4_moe_tp0_gpu0 -->
<g id="edge105" class="edge">
<title>l4_attn_tp0_gpu0&#45;&gt;l4_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M12612.81,-666.76C12615.74,-666.49 12618.67,-666.24 12621.57,-666 13325.92,-608.21 18257.99,-688.67 19009.62,-630.09"/>
<polygon fill="black" stroke="black" points="19010.17,-633.56 19019.85,-629.26 19009.6,-626.58 19010.17,-633.56"/>
</g>
<!-- l4_attn_tp1_gpu1 -->
<g id="node67" class="node">
<title>l4_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="13026.57,-734 12630.57,-734 12630.57,-666 13026.57,-666 13026.57,-734"/>
<text text-anchor="middle" x="12828.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="12828.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="12828.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="12828.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp1_gpu1 -->
<g id="node75" class="node">
<title>l4_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="19812.07,-630 19425.07,-630 19425.07,-562 19812.07,-562 19812.07,-630"/>
<text text-anchor="middle" x="19618.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="19618.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="19618.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="19618.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp1_gpu1&#45;&gt;l4_moe_tp1_gpu1 -->
<g id="edge106" class="edge">
<title>l4_attn_tp1_gpu1&#45;&gt;l4_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M13026.81,-666.76C13029.74,-666.49 13032.67,-666.24 13035.57,-666 13738.93,-608.29 18664.05,-688.59 19414.63,-630.09"/>
<polygon fill="black" stroke="black" points="19415.17,-633.56 19424.85,-629.26 19414.6,-626.58 19415.17,-633.56"/>
</g>
<!-- l4_attn_tp2_gpu2 -->
<g id="node68" class="node">
<title>l4_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="13440.57,-734 13044.57,-734 13044.57,-666 13440.57,-666 13440.57,-734"/>
<text text-anchor="middle" x="13242.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="13242.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="13242.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13242.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp2_gpu2 -->
<g id="node76" class="node">
<title>l4_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="20217.07,-630 19830.07,-630 19830.07,-562 20217.07,-562 20217.07,-630"/>
<text text-anchor="middle" x="20023.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="20023.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="20023.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="20023.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp2_gpu2&#45;&gt;l4_moe_tp2_gpu2 -->
<g id="edge107" class="edge">
<title>l4_attn_tp2_gpu2&#45;&gt;l4_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M13440.81,-666.76C13443.74,-666.49 13446.67,-666.24 13449.57,-666 14151.93,-608.37 19070.11,-688.51 19819.65,-630.09"/>
<polygon fill="black" stroke="black" points="19820.17,-633.56 19829.85,-629.26 19819.6,-626.58 19820.17,-633.56"/>
</g>
<!-- l4_attn_tp3_gpu3 -->
<g id="node69" class="node">
<title>l4_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="10542.57,-734 10146.57,-734 10146.57,-666 10542.57,-666 10542.57,-734"/>
<text text-anchor="middle" x="10344.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="10344.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="10344.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10344.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp3_gpu3 -->
<g id="node77" class="node">
<title>l4_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="17382.07,-630 16995.07,-630 16995.07,-562 17382.07,-562 17382.07,-630"/>
<text text-anchor="middle" x="17188.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="17188.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="17188.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="17188.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp3_gpu3&#45;&gt;l4_moe_tp3_gpu3 -->
<g id="edge108" class="edge">
<title>l4_attn_tp3_gpu3&#45;&gt;l4_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M10542.81,-666.76C10545.74,-666.49 10548.67,-666.24 10551.57,-666 11260.97,-607.81 16228.9,-689.08 16984.83,-630.07"/>
<polygon fill="black" stroke="black" points="16985.17,-633.56 16994.85,-629.26 16984.6,-626.58 16985.17,-633.56"/>
</g>
<!-- l4_attn_tp4_gpu4 -->
<g id="node70" class="node">
<title>l4_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="10956.57,-734 10560.57,-734 10560.57,-666 10956.57,-666 10956.57,-734"/>
<text text-anchor="middle" x="10758.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="10758.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="10758.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10758.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp4_gpu4 -->
<g id="node78" class="node">
<title>l4_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="17787.07,-630 17400.07,-630 17400.07,-562 17787.07,-562 17787.07,-630"/>
<text text-anchor="middle" x="17593.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="17593.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="17593.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="17593.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp4_gpu4&#45;&gt;l4_moe_tp4_gpu4 -->
<g id="edge109" class="edge">
<title>l4_attn_tp4_gpu4&#45;&gt;l4_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M10956.81,-666.76C10959.74,-666.49 10962.67,-666.24 10965.57,-666 11673.98,-607.89 16634.96,-689 17389.84,-630.07"/>
<polygon fill="black" stroke="black" points="17390.17,-633.56 17399.85,-629.26 17389.6,-626.58 17390.17,-633.56"/>
</g>
<!-- l4_attn_tp5_gpu5 -->
<g id="node71" class="node">
<title>l4_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="11370.57,-734 10974.57,-734 10974.57,-666 11370.57,-666 11370.57,-734"/>
<text text-anchor="middle" x="11172.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="11172.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="11172.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="11172.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp5_gpu5 -->
<g id="node79" class="node">
<title>l4_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="18192.07,-630 17805.07,-630 17805.07,-562 18192.07,-562 18192.07,-630"/>
<text text-anchor="middle" x="17998.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="17998.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="17998.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17998.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp5_gpu5&#45;&gt;l4_moe_tp5_gpu5 -->
<g id="edge110" class="edge">
<title>l4_attn_tp5_gpu5&#45;&gt;l4_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M11370.81,-666.76C11373.74,-666.49 11376.67,-666.24 11379.57,-666 12086.98,-607.97 17041.02,-688.92 17794.85,-630.07"/>
<polygon fill="black" stroke="black" points="17795.17,-633.56 17804.85,-629.26 17794.6,-626.58 17795.17,-633.56"/>
</g>
<!-- l4_attn_tp6_gpu6 -->
<g id="node72" class="node">
<title>l4_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="11784.57,-734 11388.57,-734 11388.57,-666 11784.57,-666 11784.57,-734"/>
<text text-anchor="middle" x="11586.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="11586.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="11586.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11586.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp6_gpu6 -->
<g id="node80" class="node">
<title>l4_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="18597.07,-630 18210.07,-630 18210.07,-562 18597.07,-562 18597.07,-630"/>
<text text-anchor="middle" x="18403.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="18403.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="18403.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="18403.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp6_gpu6&#45;&gt;l4_moe_tp6_gpu6 -->
<g id="edge111" class="edge">
<title>l4_attn_tp6_gpu6&#45;&gt;l4_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M11784.81,-666.76C11787.74,-666.49 11790.67,-666.24 11793.57,-666 12499.99,-608.05 17447.08,-688.84 18199.87,-630.07"/>
<polygon fill="black" stroke="black" points="18200.17,-633.56 18209.85,-629.26 18199.6,-626.58 18200.17,-633.56"/>
</g>
<!-- l4_attn_tp7_gpu7 -->
<g id="node73" class="node">
<title>l4_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="12198.57,-734 11802.57,-734 11802.57,-666 12198.57,-666 12198.57,-734"/>
<text text-anchor="middle" x="12000.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 4</text>
<text text-anchor="middle" x="12000.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="12000.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="12000.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l4_moe_tp7_gpu7 -->
<g id="node81" class="node">
<title>l4_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="19002.07,-630 18615.07,-630 18615.07,-562 19002.07,-562 19002.07,-630"/>
<text text-anchor="middle" x="18808.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="18808.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="18808.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="18808.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l4_attn_tp7_gpu7&#45;&gt;l4_moe_tp7_gpu7 -->
<g id="edge112" class="edge">
<title>l4_attn_tp7_gpu7&#45;&gt;l4_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M12198.81,-666.76C12201.74,-666.49 12204.67,-666.24 12207.57,-666 12913,-608.13 17853.14,-688.76 18604.88,-630.07"/>
<polygon fill="black" stroke="black" points="18605.17,-633.56 18614.85,-629.26 18604.6,-626.58 18605.17,-633.56"/>
</g>
<!-- l4_allreduce -->
<g id="node262" class="node">
<title>l4_allreduce</title>
<polygon fill="lightgray" stroke="black" points="23589.6,-526 23398.66,-526 23349.54,-450 23540.48,-450 23589.6,-526"/>
<text text-anchor="middle" x="23469.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="23469.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- l4_moe_tp0_gpu0&#45;&gt;l4_allreduce -->
<g id="edge113" class="edge">
<title>l4_moe_tp0_gpu0&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M19360.81,-561.98C19379.5,-558.76 19398.43,-555.96 19416.57,-554 19818.8,-510.53 22768.73,-492.71 23364.76,-489.53"/>
<polygon fill="black" stroke="black" points="23365.07,-493.03 23375.05,-489.48 23365.03,-486.03 23365.07,-493.03"/>
</g>
<!-- l4_moe_tp1_gpu1&#45;&gt;l4_allreduce -->
<g id="edge115" class="edge">
<title>l4_moe_tp1_gpu1&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M19766.09,-561.96C19784.69,-558.75 19803.52,-555.97 19821.57,-554 20181.34,-514.79 22805.98,-493.79 23365.03,-489.73"/>
<polygon fill="black" stroke="black" points="23365.12,-493.23 23375.09,-489.66 23365.07,-486.23 23365.12,-493.23"/>
</g>
<!-- l4_moe_tp2_gpu2&#45;&gt;l4_allreduce -->
<g id="edge117" class="edge">
<title>l4_moe_tp2_gpu2&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M20171.1,-562C20189.69,-558.79 20208.52,-555.99 20226.57,-554 20855.48,-484.75 22879,-486.99 23364.25,-488.57"/>
<polygon fill="black" stroke="black" points="23364.39,-492.07 23374.4,-488.61 23364.41,-485.07 23364.39,-492.07"/>
</g>
<!-- l4_moe_tp3_gpu3&#45;&gt;l4_allreduce -->
<g id="edge119" class="edge">
<title>l4_moe_tp3_gpu3&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M17335.25,-561.98C17354.12,-558.73 17373.24,-555.93 17391.57,-554 18007.71,-489.07 22608.21,-488.57 23364.49,-488.93"/>
<polygon fill="black" stroke="black" points="23364.55,-492.43 23374.55,-488.93 23364.55,-485.43 23364.55,-492.43"/>
</g>
<!-- l4_moe_tp4_gpu4&#45;&gt;l4_allreduce -->
<g id="edge121" class="edge">
<title>l4_moe_tp4_gpu4&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M17740.25,-561.99C17759.12,-558.74 17778.24,-555.94 17796.57,-554 18369.74,-493.38 22637.38,-489.27 23364.41,-489.01"/>
<polygon fill="black" stroke="black" points="23364.6,-492.51 23374.6,-489.01 23364.6,-485.51 23364.6,-492.51"/>
</g>
<!-- l4_moe_tp5_gpu5&#45;&gt;l4_allreduce -->
<g id="edge123" class="edge">
<title>l4_moe_tp5_gpu5&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M18145.53,-561.96C18164.31,-558.73 18183.33,-555.94 18201.57,-554 18731.9,-497.67 22668.48,-490.03 23364.54,-489.11"/>
<polygon fill="black" stroke="black" points="23364.56,-492.61 23374.56,-489.1 23364.55,-485.61 23364.56,-492.61"/>
</g>
<!-- l4_moe_tp6_gpu6&#45;&gt;l4_allreduce -->
<g id="edge125" class="edge">
<title>l4_moe_tp6_gpu6&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M18550.53,-561.98C18569.31,-558.74 18588.33,-555.95 18606.57,-554 19094.16,-501.96 22701.2,-490.84 23364.81,-489.23"/>
<polygon fill="black" stroke="black" points="23364.84,-492.73 23374.83,-489.21 23364.82,-485.73 23364.84,-492.73"/>
</g>
<!-- l4_moe_tp7_gpu7&#45;&gt;l4_allreduce -->
<g id="edge127" class="edge">
<title>l4_moe_tp7_gpu7&#45;&gt;l4_allreduce</title>
<path fill="none" stroke="black" d="M18955.53,-562C18974.31,-558.76 18993.34,-555.96 19011.57,-554 19456.28,-506.26 22731.94,-491.74 23364.13,-489.37"/>
<polygon fill="black" stroke="black" points="23364.6,-492.87 23374.59,-489.33 23364.57,-485.87 23364.6,-492.87"/>
</g>
<!-- l5_attn_tp0_gpu0 -->
<g id="node82" class="node">
<title>l5_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="22548.57,-734 22152.57,-734 22152.57,-666 22548.57,-666 22548.57,-734"/>
<text text-anchor="middle" x="22350.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="22350.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="22350.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="22350.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp0_gpu0 -->
<g id="node90" class="node">
<title>l5_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="25482.07,-630 25095.07,-630 25095.07,-562 25482.07,-562 25482.07,-630"/>
<text text-anchor="middle" x="25288.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="25288.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="25288.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="25288.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp0_gpu0&#45;&gt;l5_moe_tp0_gpu0 -->
<g id="edge129" class="edge">
<title>l5_attn_tp0_gpu0&#45;&gt;l5_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M22548.81,-666.8C22551.75,-666.52 22554.67,-666.25 22557.57,-666 23674.09,-569.56 23965.04,-727.92 25084.55,-630.13"/>
<polygon fill="black" stroke="black" points="25085.2,-633.59 25094.85,-629.23 25084.58,-626.62 25085.2,-633.59"/>
</g>
<!-- l5_attn_tp1_gpu1 -->
<g id="node83" class="node">
<title>l5_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="23790.57,-734 23394.57,-734 23394.57,-666 23790.57,-666 23790.57,-734"/>
<text text-anchor="middle" x="23592.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="23592.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="23592.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="23592.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp1_gpu1 -->
<g id="node91" class="node">
<title>l5_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="26292.07,-630 25905.07,-630 25905.07,-562 26292.07,-562 26292.07,-630"/>
<text text-anchor="middle" x="26098.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="26098.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="26098.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="26098.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp1_gpu1&#45;&gt;l5_moe_tp1_gpu1 -->
<g id="edge130" class="edge">
<title>l5_attn_tp1_gpu1&#45;&gt;l5_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M23790.81,-666.81C23793.75,-666.53 23796.67,-666.25 23799.57,-666 24724.73,-584.72 24966.4,-712.42 25894.59,-630.13"/>
<polygon fill="black" stroke="black" points="25895.2,-633.59 25904.85,-629.22 25894.58,-626.62 25895.2,-633.59"/>
</g>
<!-- l5_attn_tp2_gpu2 -->
<g id="node84" class="node">
<title>l5_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="24618.57,-734 24222.57,-734 24222.57,-666 24618.57,-666 24618.57,-734"/>
<text text-anchor="middle" x="24420.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="24420.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="24420.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="24420.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp2_gpu2 -->
<g id="node92" class="node">
<title>l5_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="26697.07,-630 26310.07,-630 26310.07,-562 26697.07,-562 26697.07,-630"/>
<text text-anchor="middle" x="26503.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="26503.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="26503.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="26503.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp2_gpu2&#45;&gt;l5_moe_tp2_gpu2 -->
<g id="edge131" class="edge">
<title>l5_attn_tp2_gpu2&#45;&gt;l5_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M24618.81,-666.83C24621.75,-666.54 24624.67,-666.26 24627.57,-666 25365.39,-599.57 25558.78,-697.27 26299.73,-630.12"/>
<polygon fill="black" stroke="black" points="26300.21,-633.59 26309.85,-629.2 26299.57,-626.62 26300.21,-633.59"/>
</g>
<!-- l5_attn_tp3_gpu3 -->
<g id="node85" class="node">
<title>l5_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="20478.57,-734 20082.57,-734 20082.57,-666 20478.57,-666 20478.57,-734"/>
<text text-anchor="middle" x="20280.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="20280.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="20280.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="20280.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp3_gpu3 -->
<g id="node93" class="node">
<title>l5_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="23862.07,-630 23475.07,-630 23475.07,-562 23862.07,-562 23862.07,-630"/>
<text text-anchor="middle" x="23668.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="23668.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="23668.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23668.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp3_gpu3&#45;&gt;l5_moe_tp3_gpu3 -->
<g id="edge132" class="edge">
<title>l5_attn_tp3_gpu3&#45;&gt;l5_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M20478.81,-666.79C20481.75,-666.51 20484.67,-666.25 20487.57,-666 21143.84,-610.02 22790.03,-686.74 23464.5,-630.12"/>
<polygon fill="black" stroke="black" points="23465.19,-633.58 23474.85,-629.24 23464.59,-626.6 23465.19,-633.58"/>
</g>
<!-- l5_attn_tp4_gpu4 -->
<g id="node86" class="node">
<title>l5_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="21720.57,-734 21324.57,-734 21324.57,-666 21720.57,-666 21720.57,-734"/>
<text text-anchor="middle" x="21522.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="21522.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="21522.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="21522.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp4_gpu4 -->
<g id="node94" class="node">
<title>l5_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="25077.07,-630 24690.07,-630 24690.07,-562 25077.07,-562 25077.07,-630"/>
<text text-anchor="middle" x="24883.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="24883.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="24883.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24883.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp4_gpu4&#45;&gt;l5_moe_tp4_gpu4 -->
<g id="edge133" class="edge">
<title>l5_attn_tp4_gpu4&#45;&gt;l5_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M21720.81,-666.79C21723.75,-666.51 21726.67,-666.25 21729.57,-666 22379.89,-610.5 24011.17,-686.26 24679.59,-630.11"/>
<polygon fill="black" stroke="black" points="24680.19,-633.58 24689.85,-629.24 24679.59,-626.6 24680.19,-633.58"/>
</g>
<!-- l5_attn_tp5_gpu5 -->
<g id="node87" class="node">
<title>l5_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="20892.57,-734 20496.57,-734 20496.57,-666 20892.57,-666 20892.57,-734"/>
<text text-anchor="middle" x="20694.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="20694.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="20694.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="20694.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp5_gpu5 -->
<g id="node95" class="node">
<title>l5_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="24267.07,-630 23880.07,-630 23880.07,-562 24267.07,-562 24267.07,-630"/>
<text text-anchor="middle" x="24073.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="24073.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="24073.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="24073.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp5_gpu5&#45;&gt;l5_moe_tp5_gpu5 -->
<g id="edge134" class="edge">
<title>l5_attn_tp5_gpu5&#45;&gt;l5_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M20892.81,-666.79C20895.75,-666.51 20898.67,-666.25 20901.57,-666 21555.86,-610.18 23197.08,-686.58 23869.53,-630.12"/>
<polygon fill="black" stroke="black" points="23870.19,-633.58 23879.85,-629.24 23869.59,-626.6 23870.19,-633.58"/>
</g>
<!-- l5_attn_tp6_gpu6 -->
<g id="node88" class="node">
<title>l5_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="22962.57,-734 22566.57,-734 22566.57,-666 22962.57,-666 22962.57,-734"/>
<text text-anchor="middle" x="22764.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="22764.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="22764.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22764.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp6_gpu6 -->
<g id="node96" class="node">
<title>l5_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="25887.07,-630 25500.07,-630 25500.07,-562 25887.07,-562 25887.07,-630"/>
<text text-anchor="middle" x="25693.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="25693.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="25693.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25693.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp6_gpu6&#45;&gt;l5_moe_tp6_gpu6 -->
<g id="edge135" class="edge">
<title>l5_attn_tp6_gpu6&#45;&gt;l5_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M22962.81,-666.8C22965.75,-666.52 22968.67,-666.25 22971.57,-666 24084.12,-569.87 24374.03,-727.6 25489.58,-630.13"/>
<polygon fill="black" stroke="black" points="25490.2,-633.59 25499.85,-629.23 25489.58,-626.62 25490.2,-633.59"/>
</g>
<!-- l5_attn_tp7_gpu7 -->
<g id="node89" class="node">
<title>l5_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="21306.57,-734 20910.57,-734 20910.57,-666 21306.57,-666 21306.57,-734"/>
<text text-anchor="middle" x="21108.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 5</text>
<text text-anchor="middle" x="21108.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="21108.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="21108.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l5_moe_tp7_gpu7 -->
<g id="node97" class="node">
<title>l5_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="24672.07,-630 24285.07,-630 24285.07,-562 24672.07,-562 24672.07,-630"/>
<text text-anchor="middle" x="24478.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="24478.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="24478.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="24478.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l5_attn_tp7_gpu7&#45;&gt;l5_moe_tp7_gpu7 -->
<g id="edge136" class="edge">
<title>l5_attn_tp7_gpu7&#45;&gt;l5_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M21306.81,-666.79C21309.75,-666.51 21312.67,-666.25 21315.57,-666 21967.87,-610.34 23604.12,-686.42 24274.56,-630.12"/>
<polygon fill="black" stroke="black" points="24275.19,-633.58 24284.85,-629.24 24274.59,-626.6 24275.19,-633.58"/>
</g>
<!-- l5_allreduce -->
<g id="node263" class="node">
<title>l5_allreduce</title>
<polygon fill="lightgray" stroke="black" points="27686.6,-526 27495.66,-526 27446.54,-450 27637.48,-450 27686.6,-526"/>
<text text-anchor="middle" x="27566.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="27566.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
</g>
<!-- l5_moe_tp0_gpu0&#45;&gt;l5_allreduce -->
<g id="edge137" class="edge">
<title>l5_moe_tp0_gpu0&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M25435.81,-561.99C25454.5,-558.76 25473.43,-555.97 25491.57,-554 25862.56,-513.78 26797.97,-546.48 27170.57,-526 27272.22,-520.41 27388.14,-508.99 27468.17,-500.3"/>
<polygon fill="black" stroke="black" points="27468.68,-503.77 27478.24,-499.2 27467.92,-496.81 27468.68,-503.77"/>
</g>
<!-- l5_moe_tp1_gpu1&#45;&gt;l5_allreduce -->
<g id="edge139" class="edge">
<title>l5_moe_tp1_gpu1&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M26247.5,-561.97C26265.64,-558.82 26283.98,-556.05 26301.57,-554 26685.41,-509.37 26784.9,-550.21 27170.57,-526 27272.01,-519.63 27387.73,-508.35 27467.76,-499.92"/>
<polygon fill="black" stroke="black" points="27468.25,-503.39 27477.83,-498.85 27467.52,-496.42 27468.25,-503.39"/>
</g>
<!-- l5_moe_tp2_gpu2&#45;&gt;l5_allreduce -->
<g id="edge141" class="edge">
<title>l5_moe_tp2_gpu2&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M26655.32,-561.96C26672.55,-558.92 26689.9,-556.18 26706.57,-554 26911.43,-527.26 26964.58,-541.83 27170.57,-526 27271.75,-518.22 27387.27,-507.18 27467.31,-499.19"/>
<polygon fill="black" stroke="black" points="27467.78,-502.66 27477.39,-498.18 27467.09,-495.69 27467.78,-502.66"/>
</g>
<!-- l5_moe_tp3_gpu3&#45;&gt;l5_allreduce -->
<g id="edge143" class="edge">
<title>l5_moe_tp3_gpu3&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M23814.97,-561.99C23833.93,-558.73 23853.15,-555.92 23871.57,-554 24236.16,-515.99 26804.47,-544.62 27170.57,-526 27272.25,-520.83 27388.16,-509.34 27468.19,-500.53"/>
<polygon fill="black" stroke="black" points="27468.7,-503.99 27478.25,-499.41 27467.93,-497.03 27468.7,-503.99"/>
</g>
<!-- l5_moe_tp4_gpu4&#45;&gt;l5_allreduce -->
<g id="edge145" class="edge">
<title>l5_moe_tp4_gpu4&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M25030.53,-561.98C25049.31,-558.74 25068.33,-555.95 25086.57,-554 25547.1,-504.83 26708.07,-550.67 27170.57,-526 27272.23,-520.58 27388.15,-509.13 27468.18,-500.39"/>
<polygon fill="black" stroke="black" points="27468.69,-503.86 27478.25,-499.29 27467.93,-496.9 27468.69,-503.86"/>
</g>
<!-- l5_moe_tp5_gpu5&#45;&gt;l5_allreduce -->
<g id="edge147" class="edge">
<title>l5_moe_tp5_gpu5&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M24220.25,-561.96C24239.12,-558.72 24258.24,-555.92 24276.57,-554 24596.39,-520.46 26849.42,-542.53 27170.57,-526 27272.24,-520.77 27388.16,-509.29 27468.19,-500.49"/>
<polygon fill="black" stroke="black" points="27468.7,-503.96 27478.25,-499.38 27467.93,-497 27468.7,-503.96"/>
</g>
<!-- l5_moe_tp6_gpu6&#45;&gt;l5_allreduce -->
<g id="edge149" class="edge">
<title>l5_moe_tp6_gpu6&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M25841.38,-561.98C25859.88,-558.79 25878.61,-555.99 25896.57,-554 26459.46,-491.47 26605.15,-558.59 27170.57,-526 27272.21,-520.14 27388.13,-508.76 27468.17,-500.16"/>
<polygon fill="black" stroke="black" points="27468.67,-503.62 27478.24,-499.07 27467.92,-496.66 27468.67,-503.62"/>
</g>
<!-- l5_moe_tp7_gpu7&#45;&gt;l5_allreduce -->
<g id="edge151" class="edge">
<title>l5_moe_tp7_gpu7&#45;&gt;l5_allreduce</title>
<path fill="none" stroke="black" d="M24625.25,-561.99C24644.12,-558.74 24663.24,-555.94 24681.57,-554 25231.65,-495.88 26618.18,-554.86 27170.57,-526 27272.24,-520.69 27388.16,-509.22 27468.18,-500.45"/>
<polygon fill="black" stroke="black" points="27468.69,-503.92 27478.25,-499.34 27467.93,-496.96 27468.69,-503.92"/>
</g>
<!-- l6_attn_tp0_gpu0 -->
<g id="node98" class="node">
<title>l6_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="26274.57,-734 25878.57,-734 25878.57,-666 26274.57,-666 26274.57,-734"/>
<text text-anchor="middle" x="26076.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="26076.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="26076.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="26076.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp0_gpu0 -->
<g id="node106" class="node">
<title>l6_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="23052.07,-630 22665.07,-630 22665.07,-562 23052.07,-562 23052.07,-630"/>
<text text-anchor="middle" x="22858.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="22858.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="22858.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="22858.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp0_gpu0&#45;&gt;l6_moe_tp0_gpu0 -->
<g id="edge153" class="edge">
<title>l6_attn_tp0_gpu0&#45;&gt;l6_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M25878.33,-666.79C25875.39,-666.51 25872.47,-666.25 25869.57,-666 25251.13,-613.02 23700.04,-683.45 23062.41,-630"/>
<polygon fill="black" stroke="black" points="23062.42,-626.49 23052.16,-629.13 23061.83,-633.47 23062.42,-626.49"/>
</g>
<!-- l6_attn_tp1_gpu1 -->
<g id="node99" class="node">
<title>l6_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="26688.57,-734 26292.57,-734 26292.57,-666 26688.57,-666 26688.57,-734"/>
<text text-anchor="middle" x="26490.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="26490.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="26490.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="26490.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp1_gpu1 -->
<g id="node107" class="node">
<title>l6_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="23457.07,-630 23070.07,-630 23070.07,-562 23457.07,-562 23457.07,-630"/>
<text text-anchor="middle" x="23263.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="23263.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="23263.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="23263.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp1_gpu1&#45;&gt;l6_moe_tp1_gpu1 -->
<g id="edge154" class="edge">
<title>l6_attn_tp1_gpu1&#45;&gt;l6_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M26292.33,-666.79C26289.39,-666.51 26286.47,-666.25 26283.57,-666 25663.15,-612.87 24107.09,-683.61 23467.44,-630.01"/>
<polygon fill="black" stroke="black" points="23467.42,-626.49 23457.16,-629.13 23466.83,-633.47 23467.42,-626.49"/>
</g>
<!-- l6_attn_tp2_gpu2 -->
<g id="node100" class="node">
<title>l6_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="27102.57,-734 26706.57,-734 26706.57,-666 27102.57,-666 27102.57,-734"/>
<text text-anchor="middle" x="26904.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="26904.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="26904.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="26904.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp2_gpu2 -->
<g id="node108" class="node">
<title>l6_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="27102.07,-630 26715.07,-630 26715.07,-562 27102.07,-562 27102.07,-630"/>
<text text-anchor="middle" x="26908.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="26908.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="26908.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="26908.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp2_gpu2&#45;&gt;l6_moe_tp2_gpu2 -->
<g id="edge155" class="edge">
<title>l6_attn_tp2_gpu2&#45;&gt;l6_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M26905.87,-665.88C26906.18,-657.78 26906.53,-648.98 26906.86,-640.47"/>
<polygon fill="black" stroke="black" points="26910.37,-640.43 26907.26,-630.3 26903.37,-640.15 26910.37,-640.43"/>
</g>
<!-- l6_attn_tp3_gpu3 -->
<g id="node101" class="node">
<title>l6_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="23376.57,-734 22980.57,-734 22980.57,-666 23376.57,-666 23376.57,-734"/>
<text text-anchor="middle" x="23178.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="23178.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="23178.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23178.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp3_gpu3 -->
<g id="node109" class="node">
<title>l6_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="21027.07,-630 20640.07,-630 20640.07,-562 21027.07,-562 21027.07,-630"/>
<text text-anchor="middle" x="20833.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="20833.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="20833.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="20833.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp3_gpu3&#45;&gt;l6_moe_tp3_gpu3 -->
<g id="edge156" class="edge">
<title>l6_attn_tp3_gpu3&#45;&gt;l6_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M22980.33,-666.82C22977.39,-666.53 22974.47,-666.26 22971.57,-666 22118.12,-590.4 21894.99,-706.29 21037.29,-630.01"/>
<polygon fill="black" stroke="black" points="21037.44,-626.51 21027.17,-629.1 21036.81,-633.48 21037.44,-626.51"/>
</g>
<!-- l6_attn_tp4_gpu4 -->
<g id="node102" class="node">
<title>l6_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="24204.57,-734 23808.57,-734 23808.57,-666 24204.57,-666 24204.57,-734"/>
<text text-anchor="middle" x="24006.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="24006.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="24006.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24006.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp4_gpu4 -->
<g id="node110" class="node">
<title>l6_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="21432.07,-630 21045.07,-630 21045.07,-562 21432.07,-562 21432.07,-630"/>
<text text-anchor="middle" x="21238.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="21238.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="21238.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="21238.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp4_gpu4&#45;&gt;l6_moe_tp4_gpu4 -->
<g id="edge157" class="edge">
<title>l6_attn_tp4_gpu4&#45;&gt;l6_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M23808.33,-666.8C23805.39,-666.52 23802.47,-666.25 23799.57,-666 22758.69,-575.55 22487.34,-721.4 21442.17,-630"/>
<polygon fill="black" stroke="black" points="21442.43,-626.51 21432.16,-629.12 21441.82,-633.48 21442.43,-626.51"/>
</g>
<!-- l6_attn_tp5_gpu5 -->
<g id="node103" class="node">
<title>l6_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="25032.57,-734 24636.57,-734 24636.57,-666 25032.57,-666 25032.57,-734"/>
<text text-anchor="middle" x="24834.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="24834.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="24834.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="24834.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp5_gpu5 -->
<g id="node111" class="node">
<title>l6_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="21837.07,-630 21450.07,-630 21450.07,-562 21837.07,-562 21837.07,-630"/>
<text text-anchor="middle" x="21643.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="21643.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="21643.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21643.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp5_gpu5&#45;&gt;l6_moe_tp5_gpu5 -->
<g id="edge158" class="edge">
<title>l6_attn_tp5_gpu5&#45;&gt;l6_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M24636.33,-666.79C24633.39,-666.51 24630.47,-666.25 24627.57,-666 24015.08,-613.49 22478.9,-682.98 21847.32,-630"/>
<polygon fill="black" stroke="black" points="21847.43,-626.49 21837.16,-629.13 21846.83,-633.47 21847.43,-626.49"/>
</g>
<!-- l6_attn_tp6_gpu6 -->
<g id="node104" class="node">
<title>l6_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="25446.57,-734 25050.57,-734 25050.57,-666 25446.57,-666 25446.57,-734"/>
<text text-anchor="middle" x="25248.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="25248.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="25248.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="25248.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp6_gpu6 -->
<g id="node112" class="node">
<title>l6_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="22242.07,-630 21855.07,-630 21855.07,-562 22242.07,-562 22242.07,-630"/>
<text text-anchor="middle" x="22048.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="22048.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="22048.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22048.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp6_gpu6&#45;&gt;l6_moe_tp6_gpu6 -->
<g id="edge159" class="edge">
<title>l6_attn_tp6_gpu6&#45;&gt;l6_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M25050.33,-666.79C25047.39,-666.51 25044.47,-666.25 25041.57,-666 24427.1,-613.34 22885.94,-683.14 22252.35,-630"/>
<polygon fill="black" stroke="black" points="22252.43,-626.49 22242.16,-629.13 22251.83,-633.47 22252.43,-626.49"/>
</g>
<!-- l6_attn_tp7_gpu7 -->
<g id="node105" class="node">
<title>l6_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="25860.57,-734 25464.57,-734 25464.57,-666 25860.57,-666 25860.57,-734"/>
<text text-anchor="middle" x="25662.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 6</text>
<text text-anchor="middle" x="25662.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="25662.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25662.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l6_moe_tp7_gpu7 -->
<g id="node113" class="node">
<title>l6_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="22647.07,-630 22260.07,-630 22260.07,-562 22647.07,-562 22647.07,-630"/>
<text text-anchor="middle" x="22453.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="22453.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="22453.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="22453.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l6_attn_tp7_gpu7&#45;&gt;l6_moe_tp7_gpu7 -->
<g id="edge160" class="edge">
<title>l6_attn_tp7_gpu7&#45;&gt;l6_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M25464.33,-666.79C25461.39,-666.51 25458.47,-666.25 25455.57,-666 24839.12,-613.18 23292.99,-683.29 22657.38,-630"/>
<polygon fill="black" stroke="black" points="22657.42,-626.49 22647.16,-629.13 22656.83,-633.47 22657.42,-626.49"/>
</g>
<!-- l6_allreduce -->
<g id="node264" class="node">
<title>l6_allreduce</title>
<polygon fill="lightgray" stroke="black" points="27161.6,-526 26970.66,-526 26921.54,-450 27112.48,-450 27161.6,-526"/>
<text text-anchor="middle" x="27041.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="27041.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
</g>
<!-- l6_moe_tp0_gpu0&#45;&gt;l6_allreduce -->
<g id="edge161" class="edge">
<title>l6_moe_tp0_gpu0&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M23005.81,-561.98C23024.5,-558.76 23043.43,-555.96 23061.57,-554 23456.12,-511.3 26347.09,-492.89 26936.74,-489.56"/>
<polygon fill="black" stroke="black" points="26936.94,-493.06 26946.92,-489.51 26936.9,-486.06 26936.94,-493.06"/>
</g>
<!-- l6_moe_tp1_gpu1&#45;&gt;l6_allreduce -->
<g id="edge163" class="edge">
<title>l6_moe_tp1_gpu1&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M23411.09,-561.97C23429.69,-558.76 23448.52,-555.97 23466.57,-554 23818.57,-515.57 26383.01,-494.01 26936.47,-489.78"/>
<polygon fill="black" stroke="black" points="26936.85,-493.27 26946.83,-489.7 26936.8,-486.27 26936.85,-493.27"/>
</g>
<!-- l6_moe_tp2_gpu2&#45;&gt;l6_allreduce -->
<g id="edge165" class="edge">
<title>l6_moe_tp2_gpu2&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M26950.29,-561.75C26961.91,-552.49 26974.71,-542.28 26986.96,-532.52"/>
<polygon fill="black" stroke="black" points="26989.27,-535.16 26994.91,-526.19 26984.91,-529.68 26989.27,-535.16"/>
</g>
<!-- l6_moe_tp3_gpu3&#45;&gt;l6_allreduce -->
<g id="edge167" class="edge">
<title>l6_moe_tp3_gpu3&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M20980.25,-561.98C20999.12,-558.73 21018.24,-555.93 21036.57,-554 21041.35,-553.5 26140.14,-498.69 26937.3,-490.12"/>
<polygon fill="black" stroke="black" points="26937.36,-493.62 26947.32,-490.01 26937.29,-486.62 26937.36,-493.62"/>
</g>
<!-- l6_moe_tp4_gpu4&#45;&gt;l6_allreduce -->
<g id="edge169" class="edge">
<title>l6_moe_tp4_gpu4&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M21385.25,-561.99C21404.12,-558.75 21423.24,-555.94 21441.57,-554 21477.1,-550.24 26173.63,-498.53 26937.21,-490.14"/>
<polygon fill="black" stroke="black" points="26937.4,-493.64 26947.36,-490.03 26937.32,-486.64 26937.4,-493.64"/>
</g>
<!-- l6_moe_tp5_gpu5&#45;&gt;l6_allreduce -->
<g id="edge171" class="edge">
<title>l6_moe_tp5_gpu5&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M21790.53,-561.96C21809.31,-558.73 21828.33,-555.94 21846.57,-554 21977.82,-540.05 26214.29,-497.25 26937.18,-490.04"/>
<polygon fill="black" stroke="black" points="26937.34,-493.54 26947.31,-489.94 26937.27,-486.54 26937.34,-493.54"/>
</g>
<!-- l6_moe_tp6_gpu6&#45;&gt;l6_allreduce -->
<g id="edge173" class="edge">
<title>l6_moe_tp6_gpu6&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M22195.53,-561.98C22214.31,-558.75 22233.33,-555.95 22251.57,-554 22372.1,-541.12 26247.88,-497.77 26937.24,-490.15"/>
<polygon fill="black" stroke="black" points="26937.44,-493.65 26947.4,-490.04 26937.36,-486.65 26937.44,-493.65"/>
</g>
<!-- l6_moe_tp7_gpu7&#45;&gt;l6_allreduce -->
<g id="edge175" class="edge">
<title>l6_moe_tp7_gpu7&#45;&gt;l6_allreduce</title>
<path fill="none" stroke="black" d="M22600.81,-561.95C22619.5,-558.74 22638.43,-555.95 22656.57,-554 22875.86,-530.43 26291.67,-496.27 26936.87,-490"/>
<polygon fill="black" stroke="black" points="26937.12,-493.5 26947.08,-489.91 26937.05,-486.5 26937.12,-493.5"/>
</g>
<!-- l7_attn_tp0_gpu0 -->
<g id="node114" class="node">
<title>l7_attn_tp0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="19236.57,-734 18840.57,-734 18840.57,-666 19236.57,-666 19236.57,-734"/>
<text text-anchor="middle" x="19038.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="19038.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="19038.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="19038.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp0_gpu0 -->
<g id="node122" class="node">
<title>l7_moe_tp0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="16167.07,-630 15780.07,-630 15780.07,-562 16167.07,-562 16167.07,-630"/>
<text text-anchor="middle" x="15973.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="15973.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="15973.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="15973.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp0_gpu0&#45;&gt;l7_moe_tp0_gpu0 -->
<g id="edge177" class="edge">
<title>l7_attn_tp0_gpu0&#45;&gt;l7_moe_tp0_gpu0</title>
<path fill="none" stroke="black" d="M18840.33,-666.8C18837.39,-666.52 18834.47,-666.25 18831.57,-666 17659.25,-565.14 17353.96,-731.97 16177.56,-630.03"/>
<polygon fill="black" stroke="black" points="16177.43,-626.51 16167.16,-629.12 16176.82,-633.48 16177.43,-626.51"/>
</g>
<!-- l7_attn_tp1_gpu1 -->
<g id="node115" class="node">
<title>l7_attn_tp1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="20064.57,-734 19668.57,-734 19668.57,-666 20064.57,-666 20064.57,-734"/>
<text text-anchor="middle" x="19866.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="19866.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="19866.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="19866.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp1_gpu1 -->
<g id="node123" class="node">
<title>l7_moe_tp1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="16977.07,-630 16590.07,-630 16590.07,-562 16977.07,-562 16977.07,-630"/>
<text text-anchor="middle" x="16783.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="16783.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="16783.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="16783.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp1_gpu1&#45;&gt;l7_moe_tp1_gpu1 -->
<g id="edge178" class="edge">
<title>l7_attn_tp1_gpu1&#45;&gt;l7_moe_tp1_gpu1</title>
<path fill="none" stroke="black" d="M19668.33,-666.8C19665.39,-666.52 19662.47,-666.25 19659.57,-666 18479.15,-564.5 18171.87,-732.65 16987.19,-630"/>
<polygon fill="black" stroke="black" points="16987.43,-626.51 16977.16,-629.12 16986.82,-633.48 16987.43,-626.51"/>
</g>
<!-- l7_attn_tp2_gpu2 -->
<g id="node116" class="node">
<title>l7_attn_tp2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="22134.57,-734 21738.57,-734 21738.57,-666 22134.57,-666 22134.57,-734"/>
<text text-anchor="middle" x="21936.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="21936.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="21936.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="21936.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp2_gpu2 -->
<g id="node124" class="node">
<title>l7_moe_tp2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="20622.07,-630 20235.07,-630 20235.07,-562 20622.07,-562 20622.07,-630"/>
<text text-anchor="middle" x="20428.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="20428.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="20428.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="20428.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp2_gpu2&#45;&gt;l7_moe_tp2_gpu2 -->
<g id="edge179" class="edge">
<title>l7_attn_tp2_gpu2&#45;&gt;l7_moe_tp2_gpu2</title>
<path fill="none" stroke="black" d="M21738.32,-666.88C21735.39,-666.57 21732.47,-666.28 21729.57,-666 21246.85,-619.79 21119.28,-676.48 20632.28,-630.01"/>
<polygon fill="black" stroke="black" points="20632.46,-626.52 20622.17,-629.04 20631.79,-633.48 20632.46,-626.52"/>
</g>
<!-- l7_attn_tp3_gpu3 -->
<g id="node117" class="node">
<title>l7_attn_tp3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="18822.57,-734 18426.57,-734 18426.57,-666 18822.57,-666 18822.57,-734"/>
<text text-anchor="middle" x="18624.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="18624.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="18624.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="18624.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp3_gpu3 -->
<g id="node125" class="node">
<title>l7_moe_tp3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="15762.07,-630 15375.07,-630 15375.07,-562 15762.07,-562 15762.07,-630"/>
<text text-anchor="middle" x="15568.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="15568.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="15568.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="15568.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp3_gpu3&#45;&gt;l7_moe_tp3_gpu3 -->
<g id="edge180" class="edge">
<title>l7_attn_tp3_gpu3&#45;&gt;l7_moe_tp3_gpu3</title>
<path fill="none" stroke="black" d="M18426.33,-666.8C18423.39,-666.52 18420.47,-666.25 18417.57,-666 17249.22,-565.45 16944.97,-731.66 15772.52,-630.03"/>
<polygon fill="black" stroke="black" points="15772.43,-626.51 15762.16,-629.12 15771.82,-633.48 15772.43,-626.51"/>
</g>
<!-- l7_attn_tp4_gpu4 -->
<g id="node118" class="node">
<title>l7_attn_tp4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="17994.57,-734 17598.57,-734 17598.57,-666 17994.57,-666 17994.57,-734"/>
<text text-anchor="middle" x="17796.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="17796.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="17796.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="17796.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp4_gpu4 -->
<g id="node126" class="node">
<title>l7_moe_tp4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="14952.07,-630 14565.07,-630 14565.07,-562 14952.07,-562 14952.07,-630"/>
<text text-anchor="middle" x="14758.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="14758.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="14758.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14758.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp4_gpu4&#45;&gt;l7_moe_tp4_gpu4 -->
<g id="edge181" class="edge">
<title>l7_attn_tp4_gpu4&#45;&gt;l7_moe_tp4_gpu4</title>
<path fill="none" stroke="black" d="M17598.33,-666.8C17595.39,-666.52 17592.47,-666.25 17589.57,-666 16429.17,-566.08 16126.98,-731.02 14962.45,-630.02"/>
<polygon fill="black" stroke="black" points="14962.43,-626.51 14952.16,-629.12 14961.82,-633.48 14962.43,-626.51"/>
</g>
<!-- l7_attn_tp5_gpu5 -->
<g id="node119" class="node">
<title>l7_attn_tp5_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="17580.57,-734 17184.57,-734 17184.57,-666 17580.57,-666 17580.57,-734"/>
<text text-anchor="middle" x="17382.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="17382.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="17382.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17382.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp5_gpu5 -->
<g id="node127" class="node">
<title>l7_moe_tp5_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="14547.07,-630 14160.07,-630 14160.07,-562 14547.07,-562 14547.07,-630"/>
<text text-anchor="middle" x="14353.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="14353.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="14353.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14353.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp5_gpu5&#45;&gt;l7_moe_tp5_gpu5 -->
<g id="edge182" class="edge">
<title>l7_attn_tp5_gpu5&#45;&gt;l7_moe_tp5_gpu5</title>
<path fill="none" stroke="black" d="M17184.33,-666.8C17181.39,-666.52 17178.47,-666.25 17175.57,-666 16019.15,-566.4 15717.99,-730.7 14557.42,-630.02"/>
<polygon fill="black" stroke="black" points="14557.43,-626.51 14547.16,-629.12 14556.82,-633.48 14557.43,-626.51"/>
</g>
<!-- l7_attn_tp6_gpu6 -->
<g id="node120" class="node">
<title>l7_attn_tp6_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="19650.57,-734 19254.57,-734 19254.57,-666 19650.57,-666 19650.57,-734"/>
<text text-anchor="middle" x="19452.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="19452.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="19452.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="19452.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp6_gpu6 -->
<g id="node128" class="node">
<title>l7_moe_tp6_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="16572.07,-630 16185.07,-630 16185.07,-562 16572.07,-562 16572.07,-630"/>
<text text-anchor="middle" x="16378.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="16378.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="16378.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="16378.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp6_gpu6&#45;&gt;l7_moe_tp6_gpu6 -->
<g id="edge183" class="edge">
<title>l7_attn_tp6_gpu6&#45;&gt;l7_moe_tp6_gpu6</title>
<path fill="none" stroke="black" d="M19254.33,-666.8C19251.39,-666.52 19248.47,-666.25 19245.57,-666 18069.13,-564.81 17762.88,-732.33 16582.16,-630"/>
<polygon fill="black" stroke="black" points="16582.43,-626.51 16572.16,-629.12 16581.82,-633.48 16582.43,-626.51"/>
</g>
<!-- l7_attn_tp7_gpu7 -->
<g id="node121" class="node">
<title>l7_attn_tp7_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="18408.57,-734 18012.57,-734 18012.57,-666 18408.57,-666 18408.57,-734"/>
<text text-anchor="middle" x="18210.57" y="-718.8" font-family="Times,serif" font-size="14.00">Attention Layer 7</text>
<text text-anchor="middle" x="18210.57" y="-703.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="18210.57" y="-688.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="18210.57" y="-673.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l7_moe_tp7_gpu7 -->
<g id="node129" class="node">
<title>l7_moe_tp7_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="15357.07,-630 14970.07,-630 14970.07,-562 15357.07,-562 15357.07,-630"/>
<text text-anchor="middle" x="15163.57" y="-614.8" font-family="Times,serif" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="15163.57" y="-599.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="15163.57" y="-584.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15163.57" y="-569.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l7_attn_tp7_gpu7&#45;&gt;l7_moe_tp7_gpu7 -->
<g id="edge184" class="edge">
<title>l7_attn_tp7_gpu7&#45;&gt;l7_moe_tp7_gpu7</title>
<path fill="none" stroke="black" d="M18012.33,-666.8C18009.39,-666.52 18006.47,-666.25 18003.57,-666 16839.2,-565.77 16535.98,-731.34 15367.49,-630.02"/>
<polygon fill="black" stroke="black" points="15367.43,-626.51 15357.16,-629.12 15366.82,-633.48 15367.43,-626.51"/>
</g>
<!-- l7_allreduce -->
<g id="node265" class="node">
<title>l7_allreduce</title>
<polygon fill="lightgray" stroke="black" points="15829.6,-526 15638.66,-526 15589.54,-450 15780.48,-450 15829.6,-526"/>
<text text-anchor="middle" x="15709.57" y="-491.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="15709.57" y="-476.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
</g>
<!-- l7_moe_tp0_gpu0&#45;&gt;l7_allreduce -->
<g id="edge185" class="edge">
<title>l7_moe_tp0_gpu0&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M15891.12,-561.9C15865.93,-551.78 15837.91,-540.53 15811.58,-529.96"/>
<polygon fill="black" stroke="black" points="15812.54,-526.57 15801.96,-526.1 15809.94,-533.07 15812.54,-526.57"/>
</g>
<!-- l7_moe_tp1_gpu1&#45;&gt;l7_allreduce -->
<g id="edge195" class="edge">
<title>l7_moe_tp1_gpu1&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M16631.43,-562C16614.66,-558.99 16597.79,-556.24 16581.57,-554 16308.33,-516.24 15983.69,-499.34 15818.25,-492.71"/>
<polygon fill="black" stroke="black" points="15818.2,-489.2 15808.07,-492.3 15817.93,-496.2 15818.2,-489.2"/>
</g>
<!-- l7_moe_tp2_gpu2&#45;&gt;l7_allreduce -->
<g id="edge205" class="edge">
<title>l7_moe_tp2_gpu2&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M20282.33,-561.99C20263.65,-558.76 20244.71,-555.95 20226.57,-554 19776,-505.46 16457.12,-491.58 15816.45,-489.35"/>
<polygon fill="black" stroke="black" points="15816.31,-485.85 15806.3,-489.31 15816.29,-492.85 15816.31,-485.85"/>
</g>
<!-- l7_moe_tp3_gpu3&#45;&gt;l7_allreduce -->
<g id="edge215" class="edge">
<title>l7_moe_tp3_gpu3&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M15612.79,-561.75C15625.23,-552.4 15638.95,-542.09 15652.04,-532.25"/>
<polygon fill="black" stroke="black" points="15654.21,-535 15660.1,-526.19 15650,-529.4 15654.21,-535"/>
</g>
<!-- l7_moe_tp4_gpu4&#45;&gt;l7_allreduce -->
<g id="edge225" class="edge">
<title>l7_moe_tp4_gpu4&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M14912.87,-561.95C14929.27,-559.01 14945.73,-556.28 14961.57,-554 15191.2,-520.94 15463.08,-502.43 15607.47,-494.22"/>
<polygon fill="black" stroke="black" points="15607.86,-497.7 15617.64,-493.65 15607.46,-490.72 15607.86,-497.7"/>
</g>
<!-- l7_moe_tp5_gpu5&#45;&gt;l7_allreduce -->
<g id="edge235" class="edge">
<title>l7_moe_tp5_gpu5&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M14504.76,-561.99C14522.17,-558.93 14539.72,-556.17 14556.57,-554 14940.83,-504.62 15401.94,-492.75 15604.93,-489.9"/>
<polygon fill="black" stroke="black" points="15605.04,-493.4 15614.99,-489.76 15604.94,-486.4 15605.04,-493.4"/>
</g>
<!-- l7_moe_tp6_gpu6&#45;&gt;l7_allreduce -->
<g id="edge245" class="edge">
<title>l7_moe_tp6_gpu6&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M16220.78,-562C16205.86,-559.17 16190.94,-556.46 16176.57,-554 16056.87,-533.54 15919.08,-514.97 15824.36,-502.96"/>
<polygon fill="black" stroke="black" points="15824.54,-499.46 15814.18,-501.68 15823.67,-506.4 15824.54,-499.46"/>
</g>
<!-- l7_moe_tp7_gpu7&#45;&gt;l7_allreduce -->
<g id="edge255" class="edge">
<title>l7_moe_tp7_gpu7&#45;&gt;l7_allreduce</title>
<path fill="none" stroke="black" d="M15326.13,-561.99C15339.81,-559.26 15353.42,-556.57 15366.57,-554 15450.33,-537.61 15545.73,-519.58 15614.62,-506.68"/>
<polygon fill="black" stroke="black" points="15615.4,-510.09 15624.59,-504.81 15614.11,-503.21 15615.4,-510.09"/>
</g>
<!-- l8_attn_tp0_gpu8 -->
<g id="node130" class="node">
<title>l8_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="16875.57,-284 16479.57,-284 16479.57,-216 16875.57,-216 16875.57,-284"/>
<text text-anchor="middle" x="16677.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="16677.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="16677.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16677.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp0_gpu8 -->
<g id="node138" class="node">
<title>l8_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="13860.07,-180 13473.07,-180 13473.07,-112 13860.07,-112 13860.07,-180"/>
<text text-anchor="middle" x="13666.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="13666.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="13666.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="13666.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp0_gpu8&#45;&gt;l8_moe_tp0_gpu8 -->
<g id="edge265" class="edge">
<title>l8_attn_tp0_gpu8&#45;&gt;l8_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M16479.33,-216.8C16476.39,-216.52 16473.47,-216.25 16470.57,-216 15322.1,-117.03 15023.01,-280.07 13870.35,-180.01"/>
<polygon fill="black" stroke="black" points="13870.43,-176.51 13860.16,-179.12 13869.82,-183.48 13870.43,-176.51"/>
</g>
<!-- l8_attn_tp1_gpu9 -->
<g id="node131" class="node">
<title>l8_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="16461.57,-284 16065.57,-284 16065.57,-216 16461.57,-216 16461.57,-284"/>
<text text-anchor="middle" x="16263.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="16263.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="16263.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="16263.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp1_gpu9 -->
<g id="node139" class="node">
<title>l8_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="13455.07,-180 13068.07,-180 13068.07,-112 13455.07,-112 13455.07,-180"/>
<text text-anchor="middle" x="13261.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="13261.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="13261.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13261.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp1_gpu9&#45;&gt;l8_moe_tp1_gpu9 -->
<g id="edge266" class="edge">
<title>l8_attn_tp1_gpu9&#45;&gt;l8_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M16065.33,-216.8C16062.39,-216.52 16059.47,-216.25 16056.57,-216 14912.08,-117.34 14614.01,-279.75 13465.31,-180.01"/>
<polygon fill="black" stroke="black" points="13465.43,-176.51 13455.16,-179.12 13464.82,-183.48 13465.43,-176.51"/>
</g>
<!-- l8_attn_tp2_gpu10 -->
<g id="node132" class="node">
<title>l8_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="16047.57,-284 15651.57,-284 15651.57,-216 16047.57,-216 16047.57,-284"/>
<text text-anchor="middle" x="15849.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="15849.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="15849.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="15849.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp2_gpu10 -->
<g id="node140" class="node">
<title>l8_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="13050.07,-180 12663.07,-180 12663.07,-112 13050.07,-112 13050.07,-180"/>
<text text-anchor="middle" x="12856.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="12856.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="12856.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12856.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp2_gpu10&#45;&gt;l8_moe_tp2_gpu10 -->
<g id="edge267" class="edge">
<title>l8_attn_tp2_gpu10&#45;&gt;l8_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15651.33,-216.8C15648.39,-216.52 15645.47,-216.25 15642.57,-216 14502.05,-117.66 14205.02,-279.43 13060.28,-180.01"/>
<polygon fill="black" stroke="black" points="13060.43,-176.51 13050.16,-179.12 13059.82,-183.48 13060.43,-176.51"/>
</g>
<!-- l8_attn_tp3_gpu11 -->
<g id="node133" class="node">
<title>l8_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="15633.57,-284 15237.57,-284 15237.57,-216 15633.57,-216 15633.57,-284"/>
<text text-anchor="middle" x="15435.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="15435.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="15435.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="15435.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp3_gpu11 -->
<g id="node141" class="node">
<title>l8_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="12645.07,-180 12258.07,-180 12258.07,-112 12645.07,-112 12645.07,-180"/>
<text text-anchor="middle" x="12451.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="12451.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="12451.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="12451.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp3_gpu11&#45;&gt;l8_moe_tp3_gpu11 -->
<g id="edge268" class="edge">
<title>l8_attn_tp3_gpu11&#45;&gt;l8_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15237.33,-216.8C15234.39,-216.52 15231.47,-216.25 15228.57,-216 14092.03,-117.97 13796.03,-279.11 12655.24,-180"/>
<polygon fill="black" stroke="black" points="12655.43,-176.51 12645.16,-179.12 12654.82,-183.48 12655.43,-176.51"/>
</g>
<!-- l8_attn_tp4_gpu12 -->
<g id="node134" class="node">
<title>l8_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="15219.57,-284 14823.57,-284 14823.57,-216 15219.57,-216 15219.57,-284"/>
<text text-anchor="middle" x="15021.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="15021.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="15021.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="15021.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp4_gpu12 -->
<g id="node142" class="node">
<title>l8_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="12240.07,-180 11853.07,-180 11853.07,-112 12240.07,-112 12240.07,-180"/>
<text text-anchor="middle" x="12046.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="12046.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="12046.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12046.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp4_gpu12&#45;&gt;l8_moe_tp4_gpu12 -->
<g id="edge269" class="edge">
<title>l8_attn_tp4_gpu12&#45;&gt;l8_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M14823.33,-216.8C14820.39,-216.52 14817.47,-216.25 14814.57,-216 13682,-118.29 13387.04,-278.79 12250.21,-180"/>
<polygon fill="black" stroke="black" points="12250.43,-176.51 12240.16,-179.12 12249.82,-183.48 12250.43,-176.51"/>
</g>
<!-- l8_attn_tp5_gpu13 -->
<g id="node135" class="node">
<title>l8_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="14805.57,-284 14409.57,-284 14409.57,-216 14805.57,-216 14805.57,-284"/>
<text text-anchor="middle" x="14607.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="14607.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="14607.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14607.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp5_gpu13 -->
<g id="node143" class="node">
<title>l8_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="11835.07,-180 11448.07,-180 11448.07,-112 11835.07,-112 11835.07,-180"/>
<text text-anchor="middle" x="11641.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="11641.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="11641.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11641.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp5_gpu13&#45;&gt;l8_moe_tp5_gpu13 -->
<g id="edge270" class="edge">
<title>l8_attn_tp5_gpu13&#45;&gt;l8_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M14409.33,-216.8C14406.39,-216.52 14403.47,-216.25 14400.57,-216 13271.98,-118.6 12978.04,-278.47 11845.17,-180"/>
<polygon fill="black" stroke="black" points="11845.43,-176.51 11835.16,-179.12 11844.82,-183.48 11845.43,-176.51"/>
</g>
<!-- l8_attn_tp6_gpu14 -->
<g id="node136" class="node">
<title>l8_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="14391.57,-284 13995.57,-284 13995.57,-216 14391.57,-216 14391.57,-284"/>
<text text-anchor="middle" x="14193.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="14193.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="14193.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14193.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp6_gpu14 -->
<g id="node144" class="node">
<title>l8_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="11430.07,-180 11043.07,-180 11043.07,-112 11430.07,-112 11430.07,-180"/>
<text text-anchor="middle" x="11236.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="11236.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="11236.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11236.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp6_gpu14&#45;&gt;l8_moe_tp6_gpu14 -->
<g id="edge271" class="edge">
<title>l8_attn_tp6_gpu14&#45;&gt;l8_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M13995.33,-216.8C13992.39,-216.52 13989.47,-216.25 13986.57,-216 12861.95,-118.92 12569.05,-278.16 11440.14,-179.99"/>
<polygon fill="black" stroke="black" points="11440.43,-176.51 11430.16,-179.12 11439.82,-183.48 11440.43,-176.51"/>
</g>
<!-- l8_attn_tp7_gpu15 -->
<g id="node137" class="node">
<title>l8_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17289.57,-284 16893.57,-284 16893.57,-216 17289.57,-216 17289.57,-284"/>
<text text-anchor="middle" x="17091.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 8</text>
<text text-anchor="middle" x="17091.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="17091.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17091.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l8_moe_tp7_gpu15 -->
<g id="node145" class="node">
<title>l8_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="14265.07,-180 13878.07,-180 13878.07,-112 14265.07,-112 14265.07,-180"/>
<text text-anchor="middle" x="14071.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="14071.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="14071.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14071.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l8_attn_tp7_gpu15&#45;&gt;l8_moe_tp7_gpu15 -->
<g id="edge272" class="edge">
<title>l8_attn_tp7_gpu15&#45;&gt;l8_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M16893.33,-216.8C16890.39,-216.52 16887.47,-216.25 16884.57,-216 15732.13,-116.71 15432,-280.38 14275.38,-180.01"/>
<polygon fill="black" stroke="black" points="14275.43,-176.51 14265.16,-179.12 14274.82,-183.48 14275.43,-176.51"/>
</g>
<!-- l8_allreduce -->
<g id="node267" class="node">
<title>l8_allreduce</title>
<polygon fill="lightgray" stroke="black" points="6917.6,-76 6726.66,-76 6677.54,0 6868.48,0 6917.6,-76"/>
<text text-anchor="middle" x="6797.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6797.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
</g>
<!-- l8_moe_tp0_gpu8&#45;&gt;l8_allreduce -->
<g id="edge273" class="edge">
<title>l8_moe_tp0_gpu8&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M13520.61,-111.96C13501.84,-108.72 13482.81,-105.92 13464.57,-104 12786.23,-32.51 7705.1,-37.56 6903.81,-38.81"/>
<polygon fill="black" stroke="black" points="6903.73,-35.31 6893.74,-38.83 6903.74,-42.31 6903.73,-35.31"/>
</g>
<!-- l8_moe_tp1_gpu9&#45;&gt;l8_allreduce -->
<g id="edge275" class="edge">
<title>l8_moe_tp1_gpu9&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M13115.61,-111.97C13096.84,-108.73 13077.81,-105.93 13059.57,-104 12424.3,-36.85 7677.47,-38.21 6903.97,-38.89"/>
<polygon fill="black" stroke="black" points="6903.69,-35.39 6893.69,-38.89 6903.7,-42.39 6903.69,-35.39"/>
</g>
<!-- l8_moe_tp2_gpu10&#45;&gt;l8_allreduce -->
<g id="edge277" class="edge">
<title>l8_moe_tp2_gpu10&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M12710.61,-111.98C12691.84,-108.74 12672.81,-105.93 12654.57,-104 12062.28,-41.18 7648.64,-38.9 6904.08,-38.97"/>
<polygon fill="black" stroke="black" points="6903.91,-35.47 6893.91,-38.97 6903.91,-42.47 6903.91,-35.47"/>
</g>
<!-- l8_moe_tp3_gpu11&#45;&gt;l8_allreduce -->
<g id="edge279" class="edge">
<title>l8_moe_tp3_gpu11&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M12305.61,-112C12286.84,-108.75 12267.8,-105.94 12249.57,-104 11700.15,-45.5 7618.03,-39.64 6903.99,-39.06"/>
<polygon fill="black" stroke="black" points="6903.98,-35.56 6893.97,-39.05 6903.97,-42.56 6903.98,-35.56"/>
</g>
<!-- l8_moe_tp4_gpu12&#45;&gt;l8_allreduce -->
<g id="edge281" class="edge">
<title>l8_moe_tp4_gpu12&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M11900.33,-111.97C11881.65,-108.74 11862.71,-105.94 11844.57,-104 11338.01,-49.81 7587.07,-40.44 6904.11,-39.17"/>
<polygon fill="black" stroke="black" points="6904.05,-35.67 6894.04,-39.15 6904.03,-42.67 6904.05,-35.67"/>
</g>
<!-- l8_moe_tp5_gpu13&#45;&gt;l8_allreduce -->
<g id="edge283" class="edge">
<title>l8_moe_tp5_gpu13&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M11495.33,-111.99C11476.65,-108.75 11457.71,-105.95 11439.57,-104 10975.78,-54.13 7554.79,-41.3 6904.24,-39.3"/>
<polygon fill="black" stroke="black" points="6903.95,-35.8 6893.94,-39.27 6903.93,-42.8 6903.95,-35.8"/>
</g>
<!-- l8_moe_tp6_gpu14&#45;&gt;l8_allreduce -->
<g id="edge285" class="edge">
<title>l8_moe_tp6_gpu14&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M11090.05,-111.96C11071.46,-108.74 11052.62,-105.95 11034.57,-104 10613.42,-58.43 7520.37,-42.24 6904.17,-39.46"/>
<polygon fill="black" stroke="black" points="6903.99,-35.95 6893.97,-39.41 6903.95,-42.95 6903.99,-35.95"/>
</g>
<!-- l8_moe_tp7_gpu15&#45;&gt;l8_allreduce -->
<g id="edge287" class="edge">
<title>l8_moe_tp7_gpu15&#45;&gt;l8_allreduce</title>
<path fill="none" stroke="black" d="M13925.89,-112C13907.03,-108.74 13887.9,-105.93 13869.57,-104 13508.04,-66 7761.73,-42.68 6904.25,-39.4"/>
<polygon fill="black" stroke="black" points="6904.1,-35.9 6894.08,-39.36 6904.07,-42.9 6904.1,-35.9"/>
</g>
<!-- l9_attn_tp0_gpu8 -->
<g id="node146" class="node">
<title>l9_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="8595.57,-284 8199.57,-284 8199.57,-216 8595.57,-216 8595.57,-284"/>
<text text-anchor="middle" x="8397.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="8397.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="8397.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="8397.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp0_gpu8 -->
<g id="node154" class="node">
<title>l9_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="5760.07,-180 5373.07,-180 5373.07,-112 5760.07,-112 5760.07,-180"/>
<text text-anchor="middle" x="5566.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="5566.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="5566.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5566.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp0_gpu8&#45;&gt;l9_moe_tp0_gpu8 -->
<g id="edge289" class="edge">
<title>l9_attn_tp0_gpu8&#45;&gt;l9_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M8199.33,-216.8C8196.39,-216.52 8193.47,-216.25 8190.57,-216 7121.87,-123.35 6843.29,-273.63 5770.44,-180.02"/>
<polygon fill="black" stroke="black" points="5770.43,-176.51 5760.16,-179.12 5769.82,-183.48 5770.43,-176.51"/>
</g>
<!-- l9_attn_tp1_gpu9 -->
<g id="node147" class="node">
<title>l9_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="9837.57,-284 9441.57,-284 9441.57,-216 9837.57,-216 9837.57,-284"/>
<text text-anchor="middle" x="9639.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="9639.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="9639.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="9639.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp1_gpu9 -->
<g id="node155" class="node">
<title>l9_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="6975.07,-180 6588.07,-180 6588.07,-112 6975.07,-112 6975.07,-180"/>
<text text-anchor="middle" x="6781.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="6781.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="6781.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6781.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp1_gpu9&#45;&gt;l9_moe_tp1_gpu9 -->
<g id="edge290" class="edge">
<title>l9_attn_tp1_gpu9&#45;&gt;l9_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M9441.33,-216.8C9438.39,-216.52 9435.47,-216.25 9432.57,-216 8351.82,-122.39 8070.2,-274.62 6985.15,-180"/>
<polygon fill="black" stroke="black" points="6985.43,-176.51 6975.16,-179.12 6984.82,-183.48 6985.43,-176.51"/>
</g>
<!-- l9_attn_tp2_gpu10 -->
<g id="node148" class="node">
<title>l9_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="13977.57,-284 13581.57,-284 13581.57,-216 13977.57,-216 13977.57,-284"/>
<text text-anchor="middle" x="13779.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="13779.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="13779.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13779.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp2_gpu10 -->
<g id="node156" class="node">
<title>l9_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="11025.07,-180 10638.07,-180 10638.07,-112 11025.07,-112 11025.07,-180"/>
<text text-anchor="middle" x="10831.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="10831.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="10831.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10831.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp2_gpu10&#45;&gt;l9_moe_tp2_gpu10 -->
<g id="edge291" class="edge">
<title>l9_attn_tp2_gpu10&#45;&gt;l9_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M13581.33,-216.8C13578.39,-216.52 13575.47,-216.25 13572.57,-216 12452.07,-119.24 12160.13,-277.8 11035.51,-180.03"/>
<polygon fill="black" stroke="black" points="11035.43,-176.51 11025.16,-179.12 11034.82,-183.48 11035.43,-176.51"/>
</g>
<!-- l9_attn_tp3_gpu11 -->
<g id="node149" class="node">
<title>l9_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="9009.57,-284 8613.57,-284 8613.57,-216 9009.57,-216 9009.57,-284"/>
<text text-anchor="middle" x="8811.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="8811.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="8811.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="8811.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp3_gpu11 -->
<g id="node157" class="node">
<title>l9_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="6165.07,-180 5778.07,-180 5778.07,-112 6165.07,-112 6165.07,-180"/>
<text text-anchor="middle" x="5971.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="5971.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="5971.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5971.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp3_gpu11&#45;&gt;l9_moe_tp3_gpu11 -->
<g id="edge292" class="edge">
<title>l9_attn_tp3_gpu11&#45;&gt;l9_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M8613.33,-216.8C8610.39,-216.52 8607.47,-216.25 8604.57,-216 7531.9,-123.03 7252.28,-273.95 6175.47,-180.02"/>
<polygon fill="black" stroke="black" points="6175.43,-176.51 6165.16,-179.12 6174.82,-183.48 6175.43,-176.51"/>
</g>
<!-- l9_attn_tp4_gpu12 -->
<g id="node150" class="node">
<title>l9_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="8181.57,-284 7785.57,-284 7785.57,-216 8181.57,-216 8181.57,-284"/>
<text text-anchor="middle" x="7983.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="7983.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="7983.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7983.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp4_gpu12 -->
<g id="node158" class="node">
<title>l9_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="5355.07,-180 4968.07,-180 4968.07,-112 5355.07,-112 5355.07,-180"/>
<text text-anchor="middle" x="5161.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="5161.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="5161.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5161.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp4_gpu12&#45;&gt;l9_moe_tp4_gpu12 -->
<g id="edge293" class="edge">
<title>l9_attn_tp4_gpu12&#45;&gt;l9_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M7785.33,-216.8C7782.39,-216.52 7779.47,-216.25 7776.57,-216 6711.85,-123.66 6434.29,-273.31 5365.4,-180.02"/>
<polygon fill="black" stroke="black" points="5365.43,-176.51 5355.16,-179.12 5364.82,-183.48 5365.43,-176.51"/>
</g>
<!-- l9_attn_tp5_gpu13 -->
<g id="node151" class="node">
<title>l9_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="7767.57,-284 7371.57,-284 7371.57,-216 7767.57,-216 7767.57,-284"/>
<text text-anchor="middle" x="7569.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="7569.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="7569.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7569.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp5_gpu13 -->
<g id="node159" class="node">
<title>l9_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="4950.07,-180 4563.07,-180 4563.07,-112 4950.07,-112 4950.07,-180"/>
<text text-anchor="middle" x="4756.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="4756.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="4756.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="4756.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp5_gpu13&#45;&gt;l9_moe_tp5_gpu13 -->
<g id="edge294" class="edge">
<title>l9_attn_tp5_gpu13&#45;&gt;l9_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M7371.33,-216.8C7368.39,-216.52 7365.47,-216.25 7362.57,-216 6301.82,-123.98 6025.3,-272.99 4960.36,-180.01"/>
<polygon fill="black" stroke="black" points="4960.43,-176.51 4950.16,-179.12 4959.82,-183.48 4960.43,-176.51"/>
</g>
<!-- l9_attn_tp6_gpu14 -->
<g id="node152" class="node">
<title>l9_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="9423.57,-284 9027.57,-284 9027.57,-216 9423.57,-216 9423.57,-284"/>
<text text-anchor="middle" x="9225.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="9225.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="9225.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="9225.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp6_gpu14 -->
<g id="node160" class="node">
<title>l9_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="6570.07,-180 6183.07,-180 6183.07,-112 6570.07,-112 6570.07,-180"/>
<text text-anchor="middle" x="6376.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="6376.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="6376.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="6376.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp6_gpu14&#45;&gt;l9_moe_tp6_gpu14 -->
<g id="edge295" class="edge">
<title>l9_attn_tp6_gpu14&#45;&gt;l9_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M9027.33,-216.8C9024.39,-216.52 9021.47,-216.25 9018.57,-216 7941.92,-122.72 7661.27,-274.26 6580.51,-180.03"/>
<polygon fill="black" stroke="black" points="6580.43,-176.51 6570.16,-179.12 6579.82,-183.48 6580.43,-176.51"/>
</g>
<!-- l9_attn_tp7_gpu15 -->
<g id="node153" class="node">
<title>l9_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="10251.57,-284 9855.57,-284 9855.57,-216 10251.57,-216 10251.57,-284"/>
<text text-anchor="middle" x="10053.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 9</text>
<text text-anchor="middle" x="10053.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="10053.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="10053.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l9_moe_tp7_gpu15 -->
<g id="node161" class="node">
<title>l9_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="7380.07,-180 6993.07,-180 6993.07,-112 7380.07,-112 7380.07,-180"/>
<text text-anchor="middle" x="7186.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="7186.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="7186.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="7186.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l9_attn_tp7_gpu15&#45;&gt;l9_moe_tp7_gpu15 -->
<g id="edge296" class="edge">
<title>l9_attn_tp7_gpu15&#45;&gt;l9_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M9855.33,-216.8C9852.39,-216.52 9849.47,-216.25 9846.57,-216 8761.84,-122.08 8479.19,-274.94 7390.19,-180"/>
<polygon fill="black" stroke="black" points="7390.43,-176.51 7380.16,-179.12 7389.82,-183.48 7390.43,-176.51"/>
</g>
<!-- l9_allreduce -->
<g id="node268" class="node">
<title>l9_allreduce</title>
<polygon fill="lightgray" stroke="black" points="1517.6,-76 1326.66,-76 1277.54,0 1468.48,0 1517.6,-76"/>
<text text-anchor="middle" x="1397.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1397.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
</g>
<!-- l9_moe_tp0_gpu8&#45;&gt;l9_allreduce -->
<g id="edge297" class="edge">
<title>l9_moe_tp0_gpu8&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M5420.89,-111.97C5402.03,-108.71 5382.9,-105.91 5364.57,-104 4942.95,-60.08 1970.26,-128.03 1549.57,-76 1541.24,-74.97 1532.7,-73.65 1524.14,-72.12"/>
<polygon fill="black" stroke="black" points="1524.55,-68.64 1514.07,-70.24 1523.26,-75.52 1524.55,-68.64"/>
</g>
<!-- l9_moe_tp1_gpu9&#45;&gt;l9_allreduce -->
<g id="edge299" class="edge">
<title>l9_moe_tp1_gpu9&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M6636.17,-111.98C6617.22,-108.71 6597.99,-105.9 6579.57,-104 6023.63,-46.59 2104.3,-144.11 1549.57,-76 1541.24,-74.98 1532.7,-73.66 1524.13,-72.14"/>
<polygon fill="black" stroke="black" points="1524.54,-68.66 1514.07,-70.26 1523.26,-75.54 1524.54,-68.66"/>
</g>
<!-- l9_moe_tp2_gpu10&#45;&gt;l9_allreduce -->
<g id="edge301" class="edge">
<title>l9_moe_tp2_gpu10&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M10686.45,-111.99C10667.41,-108.7 10648.08,-105.89 10629.57,-104 10127.73,-52.8 2050.33,-136.85 1549.57,-76 1541.24,-74.99 1532.7,-73.68 1524.13,-72.16"/>
<polygon fill="black" stroke="black" points="1524.54,-68.68 1514.07,-70.29 1523.26,-75.56 1524.54,-68.68"/>
</g>
<!-- l9_moe_tp3_gpu11&#45;&gt;l9_allreduce -->
<g id="edge303" class="edge">
<title>l9_moe_tp3_gpu11&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M5825.9,-111.95C5807.03,-108.7 5787.9,-105.9 5769.57,-104 5303.18,-55.58 2014.94,-133.39 1549.57,-76 1541.24,-74.97 1532.7,-73.65 1524.13,-72.13"/>
<polygon fill="black" stroke="black" points="1524.54,-68.65 1514.07,-70.25 1523.26,-75.53 1524.54,-68.65"/>
</g>
<!-- l9_moe_tp4_gpu12&#45;&gt;l9_allreduce -->
<g id="edge305" class="edge">
<title>l9_moe_tp4_gpu12&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M5015.89,-111.98C4997.03,-108.72 4977.9,-105.92 4959.57,-104 4582.72,-64.58 1925.58,-122.67 1549.57,-76 1541.24,-74.97 1532.7,-73.64 1524.14,-72.11"/>
<polygon fill="black" stroke="black" points="1524.55,-68.63 1514.07,-70.23 1523.26,-75.51 1524.55,-68.63"/>
</g>
<!-- l9_moe_tp5_gpu13&#45;&gt;l9_allreduce -->
<g id="edge307" class="edge">
<title>l9_moe_tp5_gpu13&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M4610.62,-111.95C4591.84,-108.71 4572.81,-105.92 4554.57,-104 4222.5,-69.08 1880.91,-117.31 1549.57,-76 1541.24,-74.96 1532.7,-73.63 1524.14,-72.1"/>
<polygon fill="black" stroke="black" points="1524.55,-68.62 1514.08,-70.22 1523.26,-75.5 1524.55,-68.62"/>
</g>
<!-- l9_moe_tp6_gpu14&#45;&gt;l9_allreduce -->
<g id="edge309" class="edge">
<title>l9_moe_tp6_gpu14&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M6231.17,-111.99C6212.22,-108.72 6192.99,-105.91 6174.57,-104 5663.4,-51.08 2059.62,-138.75 1549.57,-76 1541.24,-74.98 1532.7,-73.66 1524.13,-72.14"/>
<polygon fill="black" stroke="black" points="1524.54,-68.65 1514.07,-70.26 1523.26,-75.53 1524.54,-68.65"/>
</g>
<!-- l9_moe_tp7_gpu15&#45;&gt;l9_allreduce -->
<g id="edge311" class="edge">
<title>l9_moe_tp7_gpu15&#45;&gt;l9_allreduce</title>
<path fill="none" stroke="black" d="M7041.17,-111.97C7022.22,-108.7 7002.99,-105.9 6984.57,-104 6383.85,-42.09 2148.98,-149.47 1549.57,-76 1541.24,-74.98 1532.7,-73.66 1524.13,-72.14"/>
<polygon fill="black" stroke="black" points="1524.54,-68.66 1514.07,-70.27 1523.26,-75.54 1524.54,-68.66"/>
</g>
<!-- l10_attn_tp0_gpu8 -->
<g id="node162" class="node">
<title>l10_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4869.57,-284 4473.57,-284 4473.57,-216 4869.57,-216 4869.57,-284"/>
<text text-anchor="middle" x="4671.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="4671.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="4671.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4671.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp0_gpu8 -->
<g id="node170" class="node">
<title>l10_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="4140.07,-180 3753.07,-180 3753.07,-112 4140.07,-112 4140.07,-180"/>
<text text-anchor="middle" x="3946.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="3946.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="3946.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="3946.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp0_gpu8&#45;&gt;l10_moe_tp0_gpu8 -->
<g id="edge313" class="edge">
<title>l10_attn_tp0_gpu8&#45;&gt;l10_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M4473.56,-217.24C4470.54,-216.82 4467.54,-216.41 4464.57,-216 4328.23,-197.35 4290.89,-199.21 4150.5,-180.1"/>
<polygon fill="black" stroke="black" points="4150.6,-176.58 4140.21,-178.69 4149.64,-183.52 4150.6,-176.58"/>
</g>
<!-- l10_attn_tp1_gpu9 -->
<g id="node163" class="node">
<title>l10_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="7353.57,-284 6957.57,-284 6957.57,-216 7353.57,-216 7353.57,-284"/>
<text text-anchor="middle" x="7155.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="7155.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="7155.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="7155.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp1_gpu9 -->
<g id="node171" class="node">
<title>l10_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="4545.07,-180 4158.07,-180 4158.07,-112 4545.07,-112 4545.07,-180"/>
<text text-anchor="middle" x="4351.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="4351.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="4351.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4351.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp1_gpu9&#45;&gt;l10_moe_tp1_gpu9 -->
<g id="edge314" class="edge">
<title>l10_attn_tp1_gpu9&#45;&gt;l10_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M6957.33,-216.8C6954.39,-216.52 6951.47,-216.25 6948.57,-216 5891.8,-124.29 5616.31,-272.67 4555.32,-180.01"/>
<polygon fill="black" stroke="black" points="4555.43,-176.51 4545.16,-179.12 4554.82,-183.48 4555.43,-176.51"/>
</g>
<!-- l10_attn_tp2_gpu10 -->
<g id="node164" class="node">
<title>l10_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="3213.57,-284 2817.57,-284 2817.57,-216 3213.57,-216 3213.57,-284"/>
<text text-anchor="middle" x="3015.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="3015.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="3015.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3015.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp2_gpu10 -->
<g id="node172" class="node">
<title>l10_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="3330.07,-180 2943.07,-180 2943.07,-112 3330.07,-112 3330.07,-180"/>
<text text-anchor="middle" x="3136.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="3136.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="3136.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3136.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp2_gpu10&#45;&gt;l10_moe_tp2_gpu10 -->
<g id="edge315" class="edge">
<title>l10_attn_tp2_gpu10&#45;&gt;l10_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M3054.85,-215.88C3065.84,-206.62 3077.9,-196.45 3089.3,-186.85"/>
<polygon fill="black" stroke="black" points="3091.68,-189.42 3097.07,-180.3 3087.16,-184.07 3091.68,-189.42"/>
</g>
<!-- l10_attn_tp3_gpu11 -->
<g id="node165" class="node">
<title>l10_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="2385.57,-284 1989.57,-284 1989.57,-216 2385.57,-216 2385.57,-284"/>
<text text-anchor="middle" x="2187.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="2187.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="2187.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2187.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp3_gpu11 -->
<g id="node173" class="node">
<title>l10_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="2925.07,-180 2538.07,-180 2538.07,-112 2925.07,-112 2925.07,-180"/>
<text text-anchor="middle" x="2731.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="2731.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="2731.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2731.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp3_gpu11&#45;&gt;l10_moe_tp3_gpu11 -->
<g id="edge316" class="edge">
<title>l10_attn_tp3_gpu11&#45;&gt;l10_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M2363.81,-215.95C2421.75,-205.09 2486.34,-192.98 2545.02,-181.98"/>
<polygon fill="black" stroke="black" points="2545.95,-185.36 2555.14,-180.08 2544.66,-178.48 2545.95,-185.36"/>
</g>
<!-- l10_attn_tp4_gpu12 -->
<g id="node166" class="node">
<title>l10_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="1143.57,-284 747.57,-284 747.57,-216 1143.57,-216 1143.57,-284"/>
<text text-anchor="middle" x="945.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="945.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="945.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="945.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp4_gpu12 -->
<g id="node174" class="node">
<title>l10_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="1710.07,-180 1323.07,-180 1323.07,-112 1710.07,-112 1710.07,-180"/>
<text text-anchor="middle" x="1516.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="1516.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="1516.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="1516.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp4_gpu12&#45;&gt;l10_moe_tp4_gpu12 -->
<g id="edge317" class="edge">
<title>l10_attn_tp4_gpu12&#45;&gt;l10_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M1130.56,-215.95C1191.63,-205.05 1259.73,-192.88 1321.52,-181.84"/>
<polygon fill="black" stroke="black" points="1322.15,-185.28 1331.38,-180.08 1320.92,-178.39 1322.15,-185.28"/>
</g>
<!-- l10_attn_tp5_gpu13 -->
<g id="node167" class="node">
<title>l10_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="1557.57,-284 1161.57,-284 1161.57,-216 1557.57,-216 1557.57,-284"/>
<text text-anchor="middle" x="1359.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="1359.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="1359.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="1359.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp5_gpu13 -->
<g id="node175" class="node">
<title>l10_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="2115.07,-180 1728.07,-180 1728.07,-112 2115.07,-112 2115.07,-180"/>
<text text-anchor="middle" x="1921.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="1921.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="1921.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="1921.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp5_gpu13&#45;&gt;l10_moe_tp5_gpu13 -->
<g id="edge318" class="edge">
<title>l10_attn_tp5_gpu13&#45;&gt;l10_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M1541.65,-215.95C1601.63,-205.07 1668.5,-192.93 1729.22,-181.91"/>
<polygon fill="black" stroke="black" points="1730.09,-185.31 1739.3,-180.08 1728.84,-178.42 1730.09,-185.31"/>
</g>
<!-- l10_attn_tp6_gpu14 -->
<g id="node168" class="node">
<title>l10_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="1971.57,-284 1575.57,-284 1575.57,-216 1971.57,-216 1971.57,-284"/>
<text text-anchor="middle" x="1773.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="1773.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="1773.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1773.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp6_gpu14 -->
<g id="node176" class="node">
<title>l10_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="2520.07,-180 2133.07,-180 2133.07,-112 2520.07,-112 2520.07,-180"/>
<text text-anchor="middle" x="2326.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="2326.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="2326.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2326.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp6_gpu14&#45;&gt;l10_moe_tp6_gpu14 -->
<g id="edge319" class="edge">
<title>l10_attn_tp6_gpu14&#45;&gt;l10_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M1952.73,-215.95C2011.75,-205.07 2077.55,-192.93 2137.3,-181.91"/>
<polygon fill="black" stroke="black" points="2138.02,-185.34 2147.22,-180.08 2136.75,-178.45 2138.02,-185.34"/>
</g>
<!-- l10_attn_tp7_gpu15 -->
<g id="node169" class="node">
<title>l10_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="4041.57,-284 3645.57,-284 3645.57,-216 4041.57,-216 4041.57,-284"/>
<text text-anchor="middle" x="3843.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 10</text>
<text text-anchor="middle" x="3843.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="3843.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3843.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l10_moe_tp7_gpu15 -->
<g id="node177" class="node">
<title>l10_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="3735.07,-180 3348.07,-180 3348.07,-112 3735.07,-112 3735.07,-180"/>
<text text-anchor="middle" x="3541.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="3541.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="3541.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3541.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l10_attn_tp7_gpu15&#45;&gt;l10_moe_tp7_gpu15 -->
<g id="edge320" class="edge">
<title>l10_attn_tp7_gpu15&#45;&gt;l10_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M3745.52,-215.88C3714.69,-205.47 3680.49,-193.92 3649.05,-183.3"/>
<polygon fill="black" stroke="black" points="3649.98,-179.92 3639.39,-180.04 3647.74,-186.55 3649.98,-179.92"/>
</g>
<!-- l10_allreduce -->
<g id="node269" class="node">
<title>l10_allreduce</title>
<polygon fill="lightgray" stroke="black" points="1213.6,-76 1022.66,-76 973.54,0 1164.48,0 1213.6,-76"/>
<text text-anchor="middle" x="1093.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1093.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
</g>
<!-- l10_moe_tp0_gpu8&#45;&gt;l10_allreduce -->
<g id="edge321" class="edge">
<title>l10_moe_tp0_gpu8&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M3800.61,-111.99C3781.84,-108.74 3762.81,-105.94 3744.57,-104 3197.39,-45.9 1815.51,-136.32 1268.57,-76 1252.05,-74.18 1234.8,-71.5 1217.84,-68.41"/>
<polygon fill="black" stroke="black" points="1218.36,-64.95 1207.89,-66.54 1217.07,-71.83 1218.36,-64.95"/>
</g>
<!-- l10_moe_tp1_gpu9&#45;&gt;l10_allreduce -->
<g id="edge323" class="edge">
<title>l10_moe_tp1_gpu9&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M4205.62,-111.96C4186.84,-108.72 4167.81,-105.92 4149.57,-104 3512.84,-36.91 1905.02,-145.67 1268.57,-76 1252.05,-74.19 1234.8,-71.52 1217.83,-68.43"/>
<polygon fill="black" stroke="black" points="1218.36,-64.97 1207.89,-66.57 1217.07,-71.85 1218.36,-64.97"/>
</g>
<!-- l10_moe_tp2_gpu10&#45;&gt;l10_allreduce -->
<g id="edge325" class="edge">
<title>l10_moe_tp2_gpu10&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M2990.05,-111.99C2971.46,-108.77 2952.62,-105.97 2934.57,-104 2566.47,-63.89 1636.5,-117.6 1268.57,-76 1251.93,-74.12 1234.54,-71.39 1217.45,-68.25"/>
<polygon fill="black" stroke="black" points="1217.9,-64.78 1207.43,-66.36 1216.6,-71.65 1217.9,-64.78"/>
</g>
<!-- l10_moe_tp3_gpu11&#45;&gt;l10_allreduce -->
<g id="edge327" class="edge">
<title>l10_moe_tp3_gpu11&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M2584.49,-111.99C2566.08,-108.79 2547.44,-106 2529.57,-104 1972.45,-41.78 1825.43,-140.48 1268.57,-76 1251.94,-74.07 1234.55,-71.32 1217.46,-68.17"/>
<polygon fill="black" stroke="black" points="1217.91,-64.69 1207.44,-66.27 1216.61,-71.57 1217.91,-64.69"/>
</g>
<!-- l10_moe_tp4_gpu12&#45;&gt;l10_allreduce -->
<g id="edge329" class="edge">
<title>l10_moe_tp4_gpu12&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M1384.76,-111.97C1331.68,-98.67 1270.77,-83.4 1218.42,-70.29"/>
<polygon fill="black" stroke="black" points="1218.96,-66.81 1208.4,-67.78 1217.25,-73.6 1218.96,-66.81"/>
</g>
<!-- l10_moe_tp5_gpu13&#45;&gt;l10_allreduce -->
<g id="edge331" class="edge">
<title>l10_moe_tp5_gpu13&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M1770.56,-111.99C1753.42,-108.94 1736.15,-106.19 1719.57,-104 1520.46,-77.74 1467.57,-103.07 1268.57,-76 1251.85,-73.73 1234.34,-70.75 1217.14,-67.47"/>
<polygon fill="black" stroke="black" points="1217.54,-63.99 1207.05,-65.51 1216.2,-70.86 1217.54,-63.99"/>
</g>
<!-- l10_moe_tp6_gpu14&#45;&gt;l10_allreduce -->
<g id="edge333" class="edge">
<title>l10_moe_tp6_gpu14&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M2178.37,-111.98C2160.32,-108.83 2142.07,-106.05 2124.57,-104 1746.5,-59.76 1646.45,-121.77 1268.57,-76 1251.95,-73.99 1234.56,-71.18 1217.48,-68"/>
<polygon fill="black" stroke="black" points="1217.94,-64.53 1207.46,-66.09 1216.63,-71.41 1217.94,-64.53"/>
</g>
<!-- l10_moe_tp7_gpu15&#45;&gt;l10_allreduce -->
<g id="edge335" class="edge">
<title>l10_moe_tp7_gpu15&#45;&gt;l10_allreduce</title>
<path fill="none" stroke="black" d="M3395.33,-111.98C3376.65,-108.75 3357.71,-105.95 3339.57,-104 2881.93,-54.9 1726,-126.96 1268.57,-76 1251.93,-74.15 1234.53,-71.43 1217.44,-68.3"/>
<polygon fill="black" stroke="black" points="1217.9,-64.83 1207.42,-66.41 1216.6,-71.71 1217.9,-64.83"/>
</g>
<!-- l11_attn_tp0_gpu8 -->
<g id="node178" class="node">
<title>l11_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="6111.57,-284 5715.57,-284 5715.57,-216 6111.57,-216 6111.57,-284"/>
<text text-anchor="middle" x="5913.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="5913.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="5913.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5913.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp0_gpu8 -->
<g id="node186" class="node">
<title>l11_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="9810.07,-180 9423.07,-180 9423.07,-112 9810.07,-112 9810.07,-180"/>
<text text-anchor="middle" x="9616.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="9616.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="9616.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="9616.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp0_gpu8&#45;&gt;l11_moe_tp0_gpu8 -->
<g id="edge337" class="edge">
<title>l11_attn_tp0_gpu8&#45;&gt;l11_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M6111.81,-216.79C6114.75,-216.51 6117.67,-216.25 6120.57,-216 6846.7,-154.49 8668.7,-242.39 9412.79,-180.1"/>
<polygon fill="black" stroke="black" points="9413.19,-183.58 9422.85,-179.24 9412.59,-176.6 9413.19,-183.58"/>
</g>
<!-- l11_attn_tp1_gpu9 -->
<g id="node179" class="node">
<title>l11_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="6525.57,-284 6129.57,-284 6129.57,-216 6525.57,-216 6525.57,-284"/>
<text text-anchor="middle" x="6327.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="6327.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="6327.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6327.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp1_gpu9 -->
<g id="node187" class="node">
<title>l11_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="10215.07,-180 9828.07,-180 9828.07,-112 10215.07,-112 10215.07,-180"/>
<text text-anchor="middle" x="10021.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="10021.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="10021.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10021.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp1_gpu9&#45;&gt;l11_moe_tp1_gpu9 -->
<g id="edge338" class="edge">
<title>l11_attn_tp1_gpu9&#45;&gt;l11_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M6525.81,-216.79C6528.75,-216.51 6531.67,-216.25 6534.57,-216 7258.72,-154.65 9075.74,-242.23 9817.82,-180.1"/>
<polygon fill="black" stroke="black" points="9818.19,-183.58 9827.85,-179.24 9817.59,-176.6 9818.19,-183.58"/>
</g>
<!-- l11_attn_tp2_gpu10 -->
<g id="node180" class="node">
<title>l11_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="6939.57,-284 6543.57,-284 6543.57,-216 6939.57,-216 6939.57,-284"/>
<text text-anchor="middle" x="6741.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="6741.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="6741.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6741.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp2_gpu10 -->
<g id="node188" class="node">
<title>l11_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="10620.07,-180 10233.07,-180 10233.07,-112 10620.07,-112 10620.07,-180"/>
<text text-anchor="middle" x="10426.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="10426.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="10426.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="10426.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp2_gpu10&#45;&gt;l11_moe_tp2_gpu10 -->
<g id="edge339" class="edge">
<title>l11_attn_tp2_gpu10&#45;&gt;l11_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M6939.81,-216.79C6942.75,-216.51 6945.67,-216.25 6948.57,-216 7670.74,-154.8 9482.78,-242.07 10222.85,-180.09"/>
<polygon fill="black" stroke="black" points="10223.19,-183.58 10232.85,-179.24 10222.59,-176.6 10223.19,-183.58"/>
</g>
<!-- l11_attn_tp3_gpu11 -->
<g id="node181" class="node">
<title>l11_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="2799.57,-284 2403.57,-284 2403.57,-216 2799.57,-216 2799.57,-284"/>
<text text-anchor="middle" x="2601.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="2601.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="2601.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2601.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp3_gpu11 -->
<g id="node189" class="node">
<title>l11_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="7785.07,-180 7398.07,-180 7398.07,-112 7785.07,-112 7785.07,-180"/>
<text text-anchor="middle" x="7591.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="7591.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="7591.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7591.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp3_gpu11&#45;&gt;l11_moe_tp3_gpu11 -->
<g id="edge340" class="edge">
<title>l11_attn_tp3_gpu11&#45;&gt;l11_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M2799.81,-216.77C2802.74,-216.5 2805.67,-216.24 2808.57,-216 3819.75,-131.9 6358.4,-265.44 7387.69,-180.11"/>
<polygon fill="black" stroke="black" points="7388.18,-183.58 7397.85,-179.25 7387.6,-176.6 7388.18,-183.58"/>
</g>
<!-- l11_attn_tp4_gpu12 -->
<g id="node182" class="node">
<title>l11_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="5697.57,-284 5301.57,-284 5301.57,-216 5697.57,-216 5697.57,-284"/>
<text text-anchor="middle" x="5499.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="5499.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="5499.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5499.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp4_gpu12 -->
<g id="node190" class="node">
<title>l11_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="9405.07,-180 9018.07,-180 9018.07,-112 9405.07,-112 9405.07,-180"/>
<text text-anchor="middle" x="9211.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="9211.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="9211.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9211.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp4_gpu12&#45;&gt;l11_moe_tp4_gpu12 -->
<g id="edge341" class="edge">
<title>l11_attn_tp4_gpu12&#45;&gt;l11_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M5697.81,-216.79C5700.75,-216.51 5703.67,-216.25 5706.57,-216 6434.69,-154.33 8261.66,-242.55 9007.76,-180.1"/>
<polygon fill="black" stroke="black" points="9008.19,-183.58 9017.85,-179.24 9007.59,-176.6 9008.19,-183.58"/>
</g>
<!-- l11_attn_tp5_gpu13 -->
<g id="node183" class="node">
<title>l11_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="4455.57,-284 4059.57,-284 4059.57,-216 4455.57,-216 4455.57,-284"/>
<text text-anchor="middle" x="4257.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="4257.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="4257.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="4257.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp5_gpu13 -->
<g id="node191" class="node">
<title>l11_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="8595.07,-180 8208.07,-180 8208.07,-112 8595.07,-112 8595.07,-180"/>
<text text-anchor="middle" x="8401.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="8401.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="8401.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8401.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp5_gpu13&#45;&gt;l11_moe_tp5_gpu13 -->
<g id="edge342" class="edge">
<title>l11_attn_tp5_gpu13&#45;&gt;l11_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M4455.81,-216.78C4458.75,-216.5 4461.67,-216.24 4464.57,-216 5288.36,-146.75 7355.84,-250.28 8197.7,-180.11"/>
<polygon fill="black" stroke="black" points="8198.18,-183.58 8207.85,-179.25 8197.59,-176.6 8198.18,-183.58"/>
</g>
<!-- l11_attn_tp6_gpu14 -->
<g id="node184" class="node">
<title>l11_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="3627.57,-284 3231.57,-284 3231.57,-216 3627.57,-216 3627.57,-284"/>
<text text-anchor="middle" x="3429.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="3429.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="3429.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3429.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp6_gpu14 -->
<g id="node192" class="node">
<title>l11_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="8190.07,-180 7803.07,-180 7803.07,-112 8190.07,-112 8190.07,-180"/>
<text text-anchor="middle" x="7996.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="7996.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="7996.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7996.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp6_gpu14&#45;&gt;l11_moe_tp6_gpu14 -->
<g id="edge343" class="edge">
<title>l11_attn_tp6_gpu14&#45;&gt;l11_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M3627.81,-216.78C3630.74,-216.5 3633.67,-216.24 3636.57,-216 4554.02,-139.33 6856.95,-257.85 7792.59,-180.11"/>
<polygon fill="black" stroke="black" points="7793.18,-183.58 7802.85,-179.25 7792.59,-176.6 7793.18,-183.58"/>
</g>
<!-- l11_attn_tp7_gpu15 -->
<g id="node185" class="node">
<title>l11_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="5283.57,-284 4887.57,-284 4887.57,-216 5283.57,-216 5283.57,-284"/>
<text text-anchor="middle" x="5085.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 11</text>
<text text-anchor="middle" x="5085.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="5085.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5085.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l11_moe_tp7_gpu15 -->
<g id="node193" class="node">
<title>l11_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="9000.07,-180 8613.07,-180 8613.07,-112 9000.07,-112 9000.07,-180"/>
<text text-anchor="middle" x="8806.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="8806.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="8806.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8806.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l11_attn_tp7_gpu15&#45;&gt;l11_moe_tp7_gpu15 -->
<g id="edge344" class="edge">
<title>l11_attn_tp7_gpu15&#45;&gt;l11_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M5283.81,-216.79C5286.75,-216.51 5289.67,-216.25 5292.57,-216 6022.67,-154.17 7854.62,-242.71 8602.74,-180.1"/>
<polygon fill="black" stroke="black" points="8603.19,-183.58 8612.85,-179.24 8602.59,-176.6 8603.19,-183.58"/>
</g>
<!-- l11_allreduce -->
<g id="node270" class="node">
<title>l11_allreduce</title>
<polygon fill="lightgray" stroke="black" points="1798.6,-76 1607.66,-76 1558.54,0 1749.48,0 1798.6,-76"/>
<text text-anchor="middle" x="1678.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1678.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
</g>
<!-- l11_moe_tp0_gpu8&#45;&gt;l11_allreduce -->
<g id="edge345" class="edge">
<title>l11_moe_tp0_gpu8&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M9470.89,-111.98C9452.03,-108.73 9432.9,-105.92 9414.57,-104 9315.19,-93.59 2710.65,-46.33 1785.7,-39.76"/>
<polygon fill="black" stroke="black" points="1785.43,-36.26 1775.41,-39.69 1785.38,-43.26 1785.43,-36.26"/>
</g>
<!-- l11_moe_tp1_gpu9&#45;&gt;l11_allreduce -->
<g id="edge347" class="edge">
<title>l11_moe_tp1_gpu9&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M9875.89,-111.98C9857.03,-108.72 9837.9,-105.92 9819.57,-104 9767.16,-98.52 2740.99,-46.79 1785.66,-39.78"/>
<polygon fill="black" stroke="black" points="1785.39,-36.28 1775.37,-39.71 1785.34,-43.28 1785.39,-36.28"/>
</g>
<!-- l11_moe_tp2_gpu10&#45;&gt;l11_allreduce -->
<g id="edge349" class="edge">
<title>l11_moe_tp2_gpu10&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M10280.89,-111.97C10262.03,-108.71 10242.9,-105.91 10224.57,-104 10210.79,-102.56 2770.52,-47.13 1785.73,-39.8"/>
<polygon fill="black" stroke="black" points="1785.51,-36.3 1775.48,-39.72 1785.46,-43.3 1785.51,-36.3"/>
</g>
<!-- l11_moe_tp3_gpu11&#45;&gt;l11_allreduce -->
<g id="edge351" class="edge">
<title>l11_moe_tp3_gpu11&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M7445.61,-111.99C7426.84,-108.74 7407.81,-105.94 7389.57,-104 7100.39,-73.29 2544.23,-44.27 1785.34,-39.64"/>
<polygon fill="black" stroke="black" points="1785.26,-36.14 1775.24,-39.58 1785.22,-43.14 1785.26,-36.14"/>
</g>
<!-- l11_moe_tp4_gpu12&#45;&gt;l11_allreduce -->
<g id="edge353" class="edge">
<title>l11_moe_tp4_gpu12&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M9065.89,-111.99C9047.03,-108.73 9027.9,-105.92 9009.57,-104 8915.59,-94.14 2682.68,-46.6 1785.64,-39.81"/>
<polygon fill="black" stroke="black" points="1785.36,-36.31 1775.34,-39.73 1785.31,-43.31 1785.36,-36.31"/>
</g>
<!-- l11_moe_tp5_gpu13&#45;&gt;l11_allreduce -->
<g id="edge355" class="edge">
<title>l11_moe_tp5_gpu13&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M8255.61,-111.96C8236.84,-108.72 8217.81,-105.92 8199.57,-104 8033.29,-86.46 2618.15,-45.92 1785.56,-39.78"/>
<polygon fill="black" stroke="black" points="1785.41,-36.28 1775.39,-39.71 1785.36,-43.28 1785.41,-36.28"/>
</g>
<!-- l11_moe_tp6_gpu14&#45;&gt;l11_allreduce -->
<g id="edge357" class="edge">
<title>l11_moe_tp6_gpu14&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M7850.61,-111.98C7831.84,-108.73 7812.81,-105.93 7794.57,-104 7483.89,-71.12 2574.62,-43.76 1785.29,-39.56"/>
<polygon fill="black" stroke="black" points="1785.1,-36.06 1775.08,-39.5 1785.06,-43.06 1785.1,-36.06"/>
</g>
<!-- l11_moe_tp7_gpu15&#45;&gt;l11_allreduce -->
<g id="edge359" class="edge">
<title>l11_moe_tp7_gpu15&#45;&gt;l11_allreduce</title>
<path fill="none" stroke="black" d="M8660.62,-111.95C8641.84,-108.71 8622.81,-105.92 8604.57,-104 8427.49,-85.37 2646.26,-45.55 1785.34,-39.72"/>
<polygon fill="black" stroke="black" points="1785.16,-36.22 1775.13,-39.65 1785.11,-43.22 1785.16,-36.22"/>
</g>
<!-- l12_attn_tp0_gpu8 -->
<g id="node194" class="node">
<title>l12_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="12735.57,-284 12339.57,-284 12339.57,-216 12735.57,-216 12735.57,-284"/>
<text text-anchor="middle" x="12537.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="12537.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="12537.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="12537.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp0_gpu8 -->
<g id="node202" class="node">
<title>l12_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="19530.07,-180 19143.07,-180 19143.07,-112 19530.07,-112 19530.07,-180"/>
<text text-anchor="middle" x="19336.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="19336.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="19336.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="19336.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp0_gpu8&#45;&gt;l12_moe_tp0_gpu8 -->
<g id="edge361" class="edge">
<title>l12_attn_tp0_gpu8&#45;&gt;l12_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M12735.81,-216.76C12738.74,-216.49 12741.67,-216.24 12744.57,-216 13448.92,-158.21 18380.99,-238.67 19132.62,-180.09"/>
<polygon fill="black" stroke="black" points="19133.17,-183.56 19142.85,-179.26 19132.6,-176.58 19133.17,-183.56"/>
</g>
<!-- l12_attn_tp1_gpu9 -->
<g id="node195" class="node">
<title>l12_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="13149.57,-284 12753.57,-284 12753.57,-216 13149.57,-216 13149.57,-284"/>
<text text-anchor="middle" x="12951.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="12951.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="12951.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="12951.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp1_gpu9 -->
<g id="node203" class="node">
<title>l12_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="19935.07,-180 19548.07,-180 19548.07,-112 19935.07,-112 19935.07,-180"/>
<text text-anchor="middle" x="19741.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="19741.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="19741.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="19741.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp1_gpu9&#45;&gt;l12_moe_tp1_gpu9 -->
<g id="edge362" class="edge">
<title>l12_attn_tp1_gpu9&#45;&gt;l12_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M13149.81,-216.76C13152.74,-216.49 13155.67,-216.24 13158.57,-216 13861.93,-158.29 18787.05,-238.59 19537.63,-180.09"/>
<polygon fill="black" stroke="black" points="19538.17,-183.56 19547.85,-179.26 19537.6,-176.58 19538.17,-183.56"/>
</g>
<!-- l12_attn_tp2_gpu10 -->
<g id="node196" class="node">
<title>l12_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="13563.57,-284 13167.57,-284 13167.57,-216 13563.57,-216 13563.57,-284"/>
<text text-anchor="middle" x="13365.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="13365.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="13365.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="13365.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp2_gpu10 -->
<g id="node204" class="node">
<title>l12_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="20340.07,-180 19953.07,-180 19953.07,-112 20340.07,-112 20340.07,-180"/>
<text text-anchor="middle" x="20146.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="20146.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="20146.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="20146.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp2_gpu10&#45;&gt;l12_moe_tp2_gpu10 -->
<g id="edge363" class="edge">
<title>l12_attn_tp2_gpu10&#45;&gt;l12_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M13563.81,-216.76C13566.74,-216.49 13569.67,-216.24 13572.57,-216 14274.93,-158.37 19193.11,-238.51 19942.65,-180.09"/>
<polygon fill="black" stroke="black" points="19943.17,-183.56 19952.85,-179.26 19942.6,-176.58 19943.17,-183.56"/>
</g>
<!-- l12_attn_tp3_gpu11 -->
<g id="node197" class="node">
<title>l12_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="10665.57,-284 10269.57,-284 10269.57,-216 10665.57,-216 10665.57,-284"/>
<text text-anchor="middle" x="10467.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="10467.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="10467.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10467.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp3_gpu11 -->
<g id="node205" class="node">
<title>l12_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="17505.07,-180 17118.07,-180 17118.07,-112 17505.07,-112 17505.07,-180"/>
<text text-anchor="middle" x="17311.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="17311.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="17311.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="17311.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp3_gpu11&#45;&gt;l12_moe_tp3_gpu11 -->
<g id="edge364" class="edge">
<title>l12_attn_tp3_gpu11&#45;&gt;l12_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M10665.81,-216.76C10668.74,-216.49 10671.67,-216.24 10674.57,-216 11383.97,-157.81 16351.9,-239.08 17107.83,-180.07"/>
<polygon fill="black" stroke="black" points="17108.17,-183.56 17117.85,-179.26 17107.6,-176.58 17108.17,-183.56"/>
</g>
<!-- l12_attn_tp4_gpu12 -->
<g id="node198" class="node">
<title>l12_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="11079.57,-284 10683.57,-284 10683.57,-216 11079.57,-216 11079.57,-284"/>
<text text-anchor="middle" x="10881.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="10881.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="10881.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="10881.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp4_gpu12 -->
<g id="node206" class="node">
<title>l12_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="17910.07,-180 17523.07,-180 17523.07,-112 17910.07,-112 17910.07,-180"/>
<text text-anchor="middle" x="17716.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="17716.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="17716.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17716.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp4_gpu12&#45;&gt;l12_moe_tp4_gpu12 -->
<g id="edge365" class="edge">
<title>l12_attn_tp4_gpu12&#45;&gt;l12_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M11079.81,-216.76C11082.74,-216.49 11085.67,-216.24 11088.57,-216 11796.98,-157.89 16757.96,-239 17512.84,-180.07"/>
<polygon fill="black" stroke="black" points="17513.17,-183.56 17522.85,-179.26 17512.6,-176.58 17513.17,-183.56"/>
</g>
<!-- l12_attn_tp5_gpu13 -->
<g id="node199" class="node">
<title>l12_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="11493.57,-284 11097.57,-284 11097.57,-216 11493.57,-216 11493.57,-284"/>
<text text-anchor="middle" x="11295.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="11295.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="11295.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11295.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp5_gpu13 -->
<g id="node207" class="node">
<title>l12_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="18315.07,-180 17928.07,-180 17928.07,-112 18315.07,-112 18315.07,-180"/>
<text text-anchor="middle" x="18121.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="18121.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="18121.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="18121.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp5_gpu13&#45;&gt;l12_moe_tp5_gpu13 -->
<g id="edge366" class="edge">
<title>l12_attn_tp5_gpu13&#45;&gt;l12_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M11493.81,-216.76C11496.74,-216.49 11499.67,-216.24 11502.57,-216 12209.98,-157.97 17164.02,-238.92 17917.85,-180.07"/>
<polygon fill="black" stroke="black" points="17918.17,-183.56 17927.85,-179.26 17917.6,-176.58 17918.17,-183.56"/>
</g>
<!-- l12_attn_tp6_gpu14 -->
<g id="node200" class="node">
<title>l12_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="11907.57,-284 11511.57,-284 11511.57,-216 11907.57,-216 11907.57,-284"/>
<text text-anchor="middle" x="11709.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="11709.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="11709.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11709.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp6_gpu14 -->
<g id="node208" class="node">
<title>l12_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="18720.07,-180 18333.07,-180 18333.07,-112 18720.07,-112 18720.07,-180"/>
<text text-anchor="middle" x="18526.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="18526.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="18526.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="18526.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp6_gpu14&#45;&gt;l12_moe_tp6_gpu14 -->
<g id="edge367" class="edge">
<title>l12_attn_tp6_gpu14&#45;&gt;l12_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M11907.81,-216.76C11910.74,-216.49 11913.67,-216.24 11916.57,-216 12622.99,-158.05 17570.08,-238.84 18322.87,-180.07"/>
<polygon fill="black" stroke="black" points="18323.17,-183.56 18332.85,-179.26 18322.6,-176.58 18323.17,-183.56"/>
</g>
<!-- l12_attn_tp7_gpu15 -->
<g id="node201" class="node">
<title>l12_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="12321.57,-284 11925.57,-284 11925.57,-216 12321.57,-216 12321.57,-284"/>
<text text-anchor="middle" x="12123.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 12</text>
<text text-anchor="middle" x="12123.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="12123.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12123.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l12_moe_tp7_gpu15 -->
<g id="node209" class="node">
<title>l12_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="19125.07,-180 18738.07,-180 18738.07,-112 19125.07,-112 19125.07,-180"/>
<text text-anchor="middle" x="18931.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="18931.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="18931.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18931.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l12_attn_tp7_gpu15&#45;&gt;l12_moe_tp7_gpu15 -->
<g id="edge368" class="edge">
<title>l12_attn_tp7_gpu15&#45;&gt;l12_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M12321.81,-216.76C12324.74,-216.49 12327.67,-216.24 12330.57,-216 13036,-158.13 17976.14,-238.76 18727.88,-180.07"/>
<polygon fill="black" stroke="black" points="18728.17,-183.56 18737.85,-179.26 18727.6,-176.58 18728.17,-183.56"/>
</g>
<!-- l12_allreduce -->
<g id="node271" class="node">
<title>l12_allreduce</title>
<polygon fill="lightgray" stroke="black" points="23712.6,-76 23521.66,-76 23472.54,0 23663.48,0 23712.6,-76"/>
<text text-anchor="middle" x="23592.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="23592.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
</g>
<!-- l12_moe_tp0_gpu8&#45;&gt;l12_allreduce -->
<g id="edge369" class="edge">
<title>l12_moe_tp0_gpu8&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M19483.81,-111.98C19502.5,-108.76 19521.43,-105.96 19539.57,-104 19941.8,-60.53 22891.73,-42.71 23487.76,-39.53"/>
<polygon fill="black" stroke="black" points="23488.07,-43.03 23498.05,-39.48 23488.03,-36.03 23488.07,-43.03"/>
</g>
<!-- l12_moe_tp1_gpu9&#45;&gt;l12_allreduce -->
<g id="edge371" class="edge">
<title>l12_moe_tp1_gpu9&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M19889.09,-111.96C19907.69,-108.75 19926.52,-105.97 19944.57,-104 20304.34,-64.79 22928.98,-43.79 23488.03,-39.73"/>
<polygon fill="black" stroke="black" points="23488.12,-43.23 23498.09,-39.66 23488.07,-36.23 23488.12,-43.23"/>
</g>
<!-- l12_moe_tp2_gpu10&#45;&gt;l12_allreduce -->
<g id="edge373" class="edge">
<title>l12_moe_tp2_gpu10&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M20294.1,-112C20312.69,-108.79 20331.52,-105.99 20349.57,-104 20978.48,-34.75 23002,-36.99 23487.25,-38.57"/>
<polygon fill="black" stroke="black" points="23487.39,-42.07 23497.4,-38.61 23487.41,-35.07 23487.39,-42.07"/>
</g>
<!-- l12_moe_tp3_gpu11&#45;&gt;l12_allreduce -->
<g id="edge375" class="edge">
<title>l12_moe_tp3_gpu11&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M17458.25,-111.98C17477.12,-108.73 17496.24,-105.93 17514.57,-104 18130.71,-39.07 22731.21,-38.57 23487.49,-38.93"/>
<polygon fill="black" stroke="black" points="23487.55,-42.43 23497.55,-38.93 23487.55,-35.43 23487.55,-42.43"/>
</g>
<!-- l12_moe_tp4_gpu12&#45;&gt;l12_allreduce -->
<g id="edge377" class="edge">
<title>l12_moe_tp4_gpu12&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M17863.25,-111.99C17882.12,-108.74 17901.24,-105.94 17919.57,-104 18492.74,-43.38 22760.38,-39.27 23487.41,-39.01"/>
<polygon fill="black" stroke="black" points="23487.6,-42.51 23497.6,-39.01 23487.6,-35.51 23487.6,-42.51"/>
</g>
<!-- l12_moe_tp5_gpu13&#45;&gt;l12_allreduce -->
<g id="edge379" class="edge">
<title>l12_moe_tp5_gpu13&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M18268.53,-111.96C18287.31,-108.73 18306.33,-105.94 18324.57,-104 18854.9,-47.67 22791.48,-40.03 23487.54,-39.11"/>
<polygon fill="black" stroke="black" points="23487.56,-42.61 23497.56,-39.1 23487.55,-35.61 23487.56,-42.61"/>
</g>
<!-- l12_moe_tp6_gpu14&#45;&gt;l12_allreduce -->
<g id="edge381" class="edge">
<title>l12_moe_tp6_gpu14&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M18673.53,-111.98C18692.31,-108.74 18711.33,-105.95 18729.57,-104 19217.16,-51.96 22824.2,-40.84 23487.81,-39.23"/>
<polygon fill="black" stroke="black" points="23487.84,-42.73 23497.83,-39.21 23487.82,-35.73 23487.84,-42.73"/>
</g>
<!-- l12_moe_tp7_gpu15&#45;&gt;l12_allreduce -->
<g id="edge383" class="edge">
<title>l12_moe_tp7_gpu15&#45;&gt;l12_allreduce</title>
<path fill="none" stroke="black" d="M19078.53,-112C19097.31,-108.76 19116.34,-105.96 19134.57,-104 19579.28,-56.26 22854.94,-41.74 23487.13,-39.37"/>
<polygon fill="black" stroke="black" points="23487.6,-42.87 23497.59,-39.33 23487.57,-35.87 23487.6,-42.87"/>
</g>
<!-- l13_attn_tp0_gpu8 -->
<g id="node210" class="node">
<title>l13_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="22671.57,-284 22275.57,-284 22275.57,-216 22671.57,-216 22671.57,-284"/>
<text text-anchor="middle" x="22473.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="22473.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="22473.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="22473.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp0_gpu8 -->
<g id="node218" class="node">
<title>l13_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="25605.07,-180 25218.07,-180 25218.07,-112 25605.07,-112 25605.07,-180"/>
<text text-anchor="middle" x="25411.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="25411.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="25411.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="25411.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp0_gpu8&#45;&gt;l13_moe_tp0_gpu8 -->
<g id="edge385" class="edge">
<title>l13_attn_tp0_gpu8&#45;&gt;l13_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M22671.81,-216.8C22674.75,-216.52 22677.67,-216.25 22680.57,-216 23797.09,-119.56 24088.04,-277.92 25207.55,-180.13"/>
<polygon fill="black" stroke="black" points="25208.2,-183.59 25217.85,-179.23 25207.58,-176.62 25208.2,-183.59"/>
</g>
<!-- l13_attn_tp1_gpu9 -->
<g id="node211" class="node">
<title>l13_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="23913.57,-284 23517.57,-284 23517.57,-216 23913.57,-216 23913.57,-284"/>
<text text-anchor="middle" x="23715.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="23715.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="23715.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23715.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp1_gpu9 -->
<g id="node219" class="node">
<title>l13_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="26415.07,-180 26028.07,-180 26028.07,-112 26415.07,-112 26415.07,-180"/>
<text text-anchor="middle" x="26221.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="26221.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="26221.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="26221.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp1_gpu9&#45;&gt;l13_moe_tp1_gpu9 -->
<g id="edge386" class="edge">
<title>l13_attn_tp1_gpu9&#45;&gt;l13_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M23913.81,-216.81C23916.75,-216.53 23919.67,-216.25 23922.57,-216 24847.73,-134.72 25089.4,-262.42 26017.59,-180.13"/>
<polygon fill="black" stroke="black" points="26018.2,-183.59 26027.85,-179.22 26017.58,-176.62 26018.2,-183.59"/>
</g>
<!-- l13_attn_tp2_gpu10 -->
<g id="node212" class="node">
<title>l13_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="24741.57,-284 24345.57,-284 24345.57,-216 24741.57,-216 24741.57,-284"/>
<text text-anchor="middle" x="24543.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="24543.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="24543.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="24543.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp2_gpu10 -->
<g id="node220" class="node">
<title>l13_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="26820.07,-180 26433.07,-180 26433.07,-112 26820.07,-112 26820.07,-180"/>
<text text-anchor="middle" x="26626.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="26626.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="26626.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="26626.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp2_gpu10&#45;&gt;l13_moe_tp2_gpu10 -->
<g id="edge387" class="edge">
<title>l13_attn_tp2_gpu10&#45;&gt;l13_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M24741.81,-216.83C24744.75,-216.54 24747.67,-216.26 24750.57,-216 25488.39,-149.57 25681.78,-247.27 26422.73,-180.12"/>
<polygon fill="black" stroke="black" points="26423.21,-183.59 26432.85,-179.2 26422.57,-176.62 26423.21,-183.59"/>
</g>
<!-- l13_attn_tp3_gpu11 -->
<g id="node213" class="node">
<title>l13_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="20601.57,-284 20205.57,-284 20205.57,-216 20601.57,-216 20601.57,-284"/>
<text text-anchor="middle" x="20403.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="20403.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="20403.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="20403.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp3_gpu11 -->
<g id="node221" class="node">
<title>l13_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="23985.07,-180 23598.07,-180 23598.07,-112 23985.07,-112 23985.07,-180"/>
<text text-anchor="middle" x="23791.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="23791.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="23791.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="23791.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp3_gpu11&#45;&gt;l13_moe_tp3_gpu11 -->
<g id="edge388" class="edge">
<title>l13_attn_tp3_gpu11&#45;&gt;l13_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M20601.81,-216.79C20604.75,-216.51 20607.67,-216.25 20610.57,-216 21266.84,-160.02 22913.03,-236.74 23587.5,-180.12"/>
<polygon fill="black" stroke="black" points="23588.19,-183.58 23597.85,-179.24 23587.59,-176.6 23588.19,-183.58"/>
</g>
<!-- l13_attn_tp4_gpu12 -->
<g id="node214" class="node">
<title>l13_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="21843.57,-284 21447.57,-284 21447.57,-216 21843.57,-216 21843.57,-284"/>
<text text-anchor="middle" x="21645.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="21645.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="21645.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="21645.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp4_gpu12 -->
<g id="node222" class="node">
<title>l13_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="25200.07,-180 24813.07,-180 24813.07,-112 25200.07,-112 25200.07,-180"/>
<text text-anchor="middle" x="25006.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="25006.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="25006.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="25006.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp4_gpu12&#45;&gt;l13_moe_tp4_gpu12 -->
<g id="edge389" class="edge">
<title>l13_attn_tp4_gpu12&#45;&gt;l13_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M21843.81,-216.79C21846.75,-216.51 21849.67,-216.25 21852.57,-216 22502.89,-160.5 24134.17,-236.26 24802.59,-180.11"/>
<polygon fill="black" stroke="black" points="24803.19,-183.58 24812.85,-179.24 24802.59,-176.6 24803.19,-183.58"/>
</g>
<!-- l13_attn_tp5_gpu13 -->
<g id="node215" class="node">
<title>l13_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="21015.57,-284 20619.57,-284 20619.57,-216 21015.57,-216 21015.57,-284"/>
<text text-anchor="middle" x="20817.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="20817.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="20817.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="20817.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp5_gpu13 -->
<g id="node223" class="node">
<title>l13_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="24390.07,-180 24003.07,-180 24003.07,-112 24390.07,-112 24390.07,-180"/>
<text text-anchor="middle" x="24196.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="24196.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="24196.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="24196.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp5_gpu13&#45;&gt;l13_moe_tp5_gpu13 -->
<g id="edge390" class="edge">
<title>l13_attn_tp5_gpu13&#45;&gt;l13_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M21015.81,-216.79C21018.75,-216.51 21021.67,-216.25 21024.57,-216 21678.86,-160.18 23320.08,-236.58 23992.53,-180.12"/>
<polygon fill="black" stroke="black" points="23993.19,-183.58 24002.85,-179.24 23992.59,-176.6 23993.19,-183.58"/>
</g>
<!-- l13_attn_tp6_gpu14 -->
<g id="node216" class="node">
<title>l13_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="23085.57,-284 22689.57,-284 22689.57,-216 23085.57,-216 23085.57,-284"/>
<text text-anchor="middle" x="22887.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="22887.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="22887.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="22887.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp6_gpu14 -->
<g id="node224" class="node">
<title>l13_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="26010.07,-180 25623.07,-180 25623.07,-112 26010.07,-112 26010.07,-180"/>
<text text-anchor="middle" x="25816.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="25816.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="25816.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="25816.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp6_gpu14&#45;&gt;l13_moe_tp6_gpu14 -->
<g id="edge391" class="edge">
<title>l13_attn_tp6_gpu14&#45;&gt;l13_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M23085.81,-216.8C23088.75,-216.52 23091.67,-216.25 23094.57,-216 24207.12,-119.87 24497.03,-277.6 25612.58,-180.13"/>
<polygon fill="black" stroke="black" points="25613.2,-183.59 25622.85,-179.23 25612.58,-176.62 25613.2,-183.59"/>
</g>
<!-- l13_attn_tp7_gpu15 -->
<g id="node217" class="node">
<title>l13_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="21429.57,-284 21033.57,-284 21033.57,-216 21429.57,-216 21429.57,-284"/>
<text text-anchor="middle" x="21231.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 13</text>
<text text-anchor="middle" x="21231.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="21231.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="21231.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l13_moe_tp7_gpu15 -->
<g id="node225" class="node">
<title>l13_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="24795.07,-180 24408.07,-180 24408.07,-112 24795.07,-112 24795.07,-180"/>
<text text-anchor="middle" x="24601.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="24601.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="24601.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="24601.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l13_attn_tp7_gpu15&#45;&gt;l13_moe_tp7_gpu15 -->
<g id="edge392" class="edge">
<title>l13_attn_tp7_gpu15&#45;&gt;l13_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M21429.81,-216.79C21432.75,-216.51 21435.67,-216.25 21438.57,-216 22090.87,-160.34 23727.12,-236.42 24397.56,-180.12"/>
<polygon fill="black" stroke="black" points="24398.19,-183.58 24407.85,-179.24 24397.59,-176.6 24398.19,-183.58"/>
</g>
<!-- l13_allreduce -->
<g id="node272" class="node">
<title>l13_allreduce</title>
<polygon fill="lightgray" stroke="black" points="27809.6,-76 27618.66,-76 27569.54,0 27760.48,0 27809.6,-76"/>
<text text-anchor="middle" x="27689.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="27689.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
</g>
<!-- l13_moe_tp0_gpu8&#45;&gt;l13_allreduce -->
<g id="edge393" class="edge">
<title>l13_moe_tp0_gpu8&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M25558.81,-111.99C25577.5,-108.76 25596.43,-105.97 25614.57,-104 25985.56,-63.78 26920.97,-96.48 27293.57,-76 27395.22,-70.41 27511.14,-58.99 27591.17,-50.3"/>
<polygon fill="black" stroke="black" points="27591.68,-53.77 27601.24,-49.2 27590.92,-46.81 27591.68,-53.77"/>
</g>
<!-- l13_moe_tp1_gpu9&#45;&gt;l13_allreduce -->
<g id="edge395" class="edge">
<title>l13_moe_tp1_gpu9&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M26370.5,-111.97C26388.64,-108.82 26406.98,-106.05 26424.57,-104 26808.41,-59.37 26907.9,-100.21 27293.57,-76 27395.01,-69.63 27510.73,-58.35 27590.76,-49.92"/>
<polygon fill="black" stroke="black" points="27591.25,-53.39 27600.83,-48.85 27590.52,-46.42 27591.25,-53.39"/>
</g>
<!-- l13_moe_tp2_gpu10&#45;&gt;l13_allreduce -->
<g id="edge397" class="edge">
<title>l13_moe_tp2_gpu10&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M26778.32,-111.96C26795.55,-108.92 26812.9,-106.18 26829.57,-104 27034.43,-77.26 27087.58,-91.83 27293.57,-76 27394.75,-68.22 27510.27,-57.18 27590.31,-49.19"/>
<polygon fill="black" stroke="black" points="27590.78,-52.66 27600.39,-48.18 27590.09,-45.69 27590.78,-52.66"/>
</g>
<!-- l13_moe_tp3_gpu11&#45;&gt;l13_allreduce -->
<g id="edge399" class="edge">
<title>l13_moe_tp3_gpu11&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M23937.97,-111.99C23956.93,-108.73 23976.15,-105.92 23994.57,-104 24359.16,-65.99 26927.47,-94.62 27293.57,-76 27395.25,-70.83 27511.16,-59.34 27591.19,-50.53"/>
<polygon fill="black" stroke="black" points="27591.7,-53.99 27601.25,-49.41 27590.93,-47.03 27591.7,-53.99"/>
</g>
<!-- l13_moe_tp4_gpu12&#45;&gt;l13_allreduce -->
<g id="edge401" class="edge">
<title>l13_moe_tp4_gpu12&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M25153.53,-111.98C25172.31,-108.74 25191.33,-105.95 25209.57,-104 25670.1,-54.83 26831.07,-100.67 27293.57,-76 27395.23,-70.58 27511.15,-59.13 27591.18,-50.39"/>
<polygon fill="black" stroke="black" points="27591.69,-53.86 27601.25,-49.29 27590.93,-46.9 27591.69,-53.86"/>
</g>
<!-- l13_moe_tp5_gpu13&#45;&gt;l13_allreduce -->
<g id="edge403" class="edge">
<title>l13_moe_tp5_gpu13&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M24343.25,-111.96C24362.12,-108.72 24381.24,-105.92 24399.57,-104 24719.39,-70.46 26972.42,-92.53 27293.57,-76 27395.24,-70.77 27511.16,-59.29 27591.19,-50.49"/>
<polygon fill="black" stroke="black" points="27591.7,-53.96 27601.25,-49.38 27590.93,-47 27591.7,-53.96"/>
</g>
<!-- l13_moe_tp6_gpu14&#45;&gt;l13_allreduce -->
<g id="edge405" class="edge">
<title>l13_moe_tp6_gpu14&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M25964.38,-111.98C25982.88,-108.79 26001.61,-105.99 26019.57,-104 26582.46,-41.47 26728.15,-108.59 27293.57,-76 27395.21,-70.14 27511.13,-58.76 27591.17,-50.16"/>
<polygon fill="black" stroke="black" points="27591.67,-53.62 27601.24,-49.07 27590.92,-46.66 27591.67,-53.62"/>
</g>
<!-- l13_moe_tp7_gpu15&#45;&gt;l13_allreduce -->
<g id="edge407" class="edge">
<title>l13_moe_tp7_gpu15&#45;&gt;l13_allreduce</title>
<path fill="none" stroke="black" d="M24748.25,-111.99C24767.12,-108.74 24786.24,-105.94 24804.57,-104 25354.65,-45.88 26741.18,-104.86 27293.57,-76 27395.24,-70.69 27511.16,-59.22 27591.18,-50.45"/>
<polygon fill="black" stroke="black" points="27591.69,-53.92 27601.25,-49.34 27590.93,-46.96 27591.69,-53.92"/>
</g>
<!-- l14_attn_tp0_gpu8 -->
<g id="node226" class="node">
<title>l14_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="26397.57,-284 26001.57,-284 26001.57,-216 26397.57,-216 26397.57,-284"/>
<text text-anchor="middle" x="26199.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="26199.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="26199.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="26199.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp0_gpu8 -->
<g id="node234" class="node">
<title>l14_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="23175.07,-180 22788.07,-180 22788.07,-112 23175.07,-112 23175.07,-180"/>
<text text-anchor="middle" x="22981.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="22981.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="22981.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="22981.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp0_gpu8&#45;&gt;l14_moe_tp0_gpu8 -->
<g id="edge409" class="edge">
<title>l14_attn_tp0_gpu8&#45;&gt;l14_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M26001.33,-216.79C25998.39,-216.51 25995.47,-216.25 25992.57,-216 25374.13,-163.02 23823.04,-233.45 23185.41,-180"/>
<polygon fill="black" stroke="black" points="23185.42,-176.49 23175.16,-179.13 23184.83,-183.47 23185.42,-176.49"/>
</g>
<!-- l14_attn_tp1_gpu9 -->
<g id="node227" class="node">
<title>l14_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="26811.57,-284 26415.57,-284 26415.57,-216 26811.57,-216 26811.57,-284"/>
<text text-anchor="middle" x="26613.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="26613.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="26613.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="26613.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp1_gpu9 -->
<g id="node235" class="node">
<title>l14_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="23580.07,-180 23193.07,-180 23193.07,-112 23580.07,-112 23580.07,-180"/>
<text text-anchor="middle" x="23386.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="23386.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="23386.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23386.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp1_gpu9&#45;&gt;l14_moe_tp1_gpu9 -->
<g id="edge410" class="edge">
<title>l14_attn_tp1_gpu9&#45;&gt;l14_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M26415.33,-216.79C26412.39,-216.51 26409.47,-216.25 26406.57,-216 25786.15,-162.87 24230.09,-233.61 23590.44,-180.01"/>
<polygon fill="black" stroke="black" points="23590.42,-176.49 23580.16,-179.13 23589.83,-183.47 23590.42,-176.49"/>
</g>
<!-- l14_attn_tp2_gpu10 -->
<g id="node228" class="node">
<title>l14_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="27225.57,-284 26829.57,-284 26829.57,-216 27225.57,-216 27225.57,-284"/>
<text text-anchor="middle" x="27027.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="27027.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="27027.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="27027.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp2_gpu10 -->
<g id="node236" class="node">
<title>l14_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="27225.07,-180 26838.07,-180 26838.07,-112 27225.07,-112 27225.07,-180"/>
<text text-anchor="middle" x="27031.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="27031.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="27031.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="27031.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp2_gpu10&#45;&gt;l14_moe_tp2_gpu10 -->
<g id="edge411" class="edge">
<title>l14_attn_tp2_gpu10&#45;&gt;l14_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M27028.87,-215.88C27029.18,-207.78 27029.53,-198.98 27029.86,-190.47"/>
<polygon fill="black" stroke="black" points="27033.37,-190.43 27030.26,-180.3 27026.37,-190.15 27033.37,-190.43"/>
</g>
<!-- l14_attn_tp3_gpu11 -->
<g id="node229" class="node">
<title>l14_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="23499.57,-284 23103.57,-284 23103.57,-216 23499.57,-216 23499.57,-284"/>
<text text-anchor="middle" x="23301.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="23301.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="23301.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="23301.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp3_gpu11 -->
<g id="node237" class="node">
<title>l14_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="21150.07,-180 20763.07,-180 20763.07,-112 21150.07,-112 21150.07,-180"/>
<text text-anchor="middle" x="20956.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="20956.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="20956.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="20956.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp3_gpu11&#45;&gt;l14_moe_tp3_gpu11 -->
<g id="edge412" class="edge">
<title>l14_attn_tp3_gpu11&#45;&gt;l14_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M23103.33,-216.82C23100.39,-216.53 23097.47,-216.26 23094.57,-216 22241.12,-140.4 22017.99,-256.29 21160.29,-180.01"/>
<polygon fill="black" stroke="black" points="21160.44,-176.51 21150.17,-179.1 21159.81,-183.48 21160.44,-176.51"/>
</g>
<!-- l14_attn_tp4_gpu12 -->
<g id="node230" class="node">
<title>l14_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="24327.57,-284 23931.57,-284 23931.57,-216 24327.57,-216 24327.57,-284"/>
<text text-anchor="middle" x="24129.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="24129.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="24129.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="24129.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp4_gpu12 -->
<g id="node238" class="node">
<title>l14_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="21555.07,-180 21168.07,-180 21168.07,-112 21555.07,-112 21555.07,-180"/>
<text text-anchor="middle" x="21361.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="21361.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="21361.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="21361.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp4_gpu12&#45;&gt;l14_moe_tp4_gpu12 -->
<g id="edge413" class="edge">
<title>l14_attn_tp4_gpu12&#45;&gt;l14_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M23931.33,-216.8C23928.39,-216.52 23925.47,-216.25 23922.57,-216 22881.69,-125.55 22610.34,-271.4 21565.17,-180"/>
<polygon fill="black" stroke="black" points="21565.43,-176.51 21555.16,-179.12 21564.82,-183.48 21565.43,-176.51"/>
</g>
<!-- l14_attn_tp5_gpu13 -->
<g id="node231" class="node">
<title>l14_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="25155.57,-284 24759.57,-284 24759.57,-216 25155.57,-216 25155.57,-284"/>
<text text-anchor="middle" x="24957.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="24957.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="24957.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="24957.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp5_gpu13 -->
<g id="node239" class="node">
<title>l14_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="21960.07,-180 21573.07,-180 21573.07,-112 21960.07,-112 21960.07,-180"/>
<text text-anchor="middle" x="21766.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="21766.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="21766.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="21766.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp5_gpu13&#45;&gt;l14_moe_tp5_gpu13 -->
<g id="edge414" class="edge">
<title>l14_attn_tp5_gpu13&#45;&gt;l14_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M24759.33,-216.79C24756.39,-216.51 24753.47,-216.25 24750.57,-216 24138.08,-163.49 22601.9,-232.98 21970.32,-180"/>
<polygon fill="black" stroke="black" points="21970.43,-176.49 21960.16,-179.13 21969.83,-183.47 21970.43,-176.49"/>
</g>
<!-- l14_attn_tp6_gpu14 -->
<g id="node232" class="node">
<title>l14_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="25569.57,-284 25173.57,-284 25173.57,-216 25569.57,-216 25569.57,-284"/>
<text text-anchor="middle" x="25371.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="25371.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="25371.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="25371.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp6_gpu14 -->
<g id="node240" class="node">
<title>l14_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="22365.07,-180 21978.07,-180 21978.07,-112 22365.07,-112 22365.07,-180"/>
<text text-anchor="middle" x="22171.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="22171.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="22171.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="22171.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp6_gpu14&#45;&gt;l14_moe_tp6_gpu14 -->
<g id="edge415" class="edge">
<title>l14_attn_tp6_gpu14&#45;&gt;l14_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M25173.33,-216.79C25170.39,-216.51 25167.47,-216.25 25164.57,-216 24550.1,-163.34 23008.94,-233.14 22375.35,-180"/>
<polygon fill="black" stroke="black" points="22375.43,-176.49 22365.16,-179.13 22374.83,-183.47 22375.43,-176.49"/>
</g>
<!-- l14_attn_tp7_gpu15 -->
<g id="node233" class="node">
<title>l14_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="25983.57,-284 25587.57,-284 25587.57,-216 25983.57,-216 25983.57,-284"/>
<text text-anchor="middle" x="25785.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 14</text>
<text text-anchor="middle" x="25785.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="25785.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="25785.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l14_moe_tp7_gpu15 -->
<g id="node241" class="node">
<title>l14_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="22770.07,-180 22383.07,-180 22383.07,-112 22770.07,-112 22770.07,-180"/>
<text text-anchor="middle" x="22576.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="22576.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="22576.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="22576.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l14_attn_tp7_gpu15&#45;&gt;l14_moe_tp7_gpu15 -->
<g id="edge416" class="edge">
<title>l14_attn_tp7_gpu15&#45;&gt;l14_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M25587.33,-216.79C25584.39,-216.51 25581.47,-216.25 25578.57,-216 24962.12,-163.18 23415.99,-233.29 22780.38,-180"/>
<polygon fill="black" stroke="black" points="22780.42,-176.49 22770.16,-179.13 22779.83,-183.47 22780.42,-176.49"/>
</g>
<!-- l14_allreduce -->
<g id="node273" class="node">
<title>l14_allreduce</title>
<polygon fill="lightgray" stroke="black" points="27284.6,-76 27093.66,-76 27044.54,0 27235.48,0 27284.6,-76"/>
<text text-anchor="middle" x="27164.57" y="-41.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="27164.57" y="-26.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
</g>
<!-- l14_moe_tp0_gpu8&#45;&gt;l14_allreduce -->
<g id="edge417" class="edge">
<title>l14_moe_tp0_gpu8&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M23128.81,-111.98C23147.5,-108.76 23166.43,-105.96 23184.57,-104 23579.12,-61.3 26470.09,-42.89 27059.74,-39.56"/>
<polygon fill="black" stroke="black" points="27059.94,-43.06 27069.92,-39.51 27059.9,-36.06 27059.94,-43.06"/>
</g>
<!-- l14_moe_tp1_gpu9&#45;&gt;l14_allreduce -->
<g id="edge419" class="edge">
<title>l14_moe_tp1_gpu9&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M23534.09,-111.97C23552.69,-108.76 23571.52,-105.97 23589.57,-104 23941.57,-65.57 26506.01,-44.01 27059.47,-39.78"/>
<polygon fill="black" stroke="black" points="27059.85,-43.27 27069.83,-39.7 27059.8,-36.27 27059.85,-43.27"/>
</g>
<!-- l14_moe_tp2_gpu10&#45;&gt;l14_allreduce -->
<g id="edge421" class="edge">
<title>l14_moe_tp2_gpu10&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M27073.29,-111.75C27084.91,-102.49 27097.71,-92.28 27109.96,-82.52"/>
<polygon fill="black" stroke="black" points="27112.27,-85.16 27117.91,-76.19 27107.91,-79.68 27112.27,-85.16"/>
</g>
<!-- l14_moe_tp3_gpu11&#45;&gt;l14_allreduce -->
<g id="edge423" class="edge">
<title>l14_moe_tp3_gpu11&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M21103.25,-111.98C21122.12,-108.73 21141.24,-105.93 21159.57,-104 21164.35,-103.5 26263.14,-48.69 27060.3,-40.12"/>
<polygon fill="black" stroke="black" points="27060.36,-43.62 27070.32,-40.01 27060.29,-36.62 27060.36,-43.62"/>
</g>
<!-- l14_moe_tp4_gpu12&#45;&gt;l14_allreduce -->
<g id="edge425" class="edge">
<title>l14_moe_tp4_gpu12&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M21508.25,-111.99C21527.12,-108.75 21546.24,-105.94 21564.57,-104 21600.1,-100.24 26296.63,-48.53 27060.21,-40.14"/>
<polygon fill="black" stroke="black" points="27060.4,-43.64 27070.36,-40.03 27060.32,-36.64 27060.4,-43.64"/>
</g>
<!-- l14_moe_tp5_gpu13&#45;&gt;l14_allreduce -->
<g id="edge427" class="edge">
<title>l14_moe_tp5_gpu13&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M21913.53,-111.96C21932.31,-108.73 21951.33,-105.94 21969.57,-104 22100.82,-90.05 26337.29,-47.25 27060.18,-40.04"/>
<polygon fill="black" stroke="black" points="27060.34,-43.54 27070.31,-39.94 27060.27,-36.54 27060.34,-43.54"/>
</g>
<!-- l14_moe_tp6_gpu14&#45;&gt;l14_allreduce -->
<g id="edge429" class="edge">
<title>l14_moe_tp6_gpu14&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M22318.53,-111.98C22337.31,-108.75 22356.33,-105.95 22374.57,-104 22495.1,-91.12 26370.88,-47.77 27060.24,-40.15"/>
<polygon fill="black" stroke="black" points="27060.44,-43.65 27070.4,-40.04 27060.36,-36.65 27060.44,-43.65"/>
</g>
<!-- l14_moe_tp7_gpu15&#45;&gt;l14_allreduce -->
<g id="edge431" class="edge">
<title>l14_moe_tp7_gpu15&#45;&gt;l14_allreduce</title>
<path fill="none" stroke="black" d="M22723.81,-111.95C22742.5,-108.74 22761.43,-105.95 22779.57,-104 22998.86,-80.43 26414.67,-46.27 27059.87,-40"/>
<polygon fill="black" stroke="black" points="27060.12,-43.5 27070.08,-39.91 27060.05,-36.5 27060.12,-43.5"/>
</g>
<!-- l15_attn_tp0_gpu8 -->
<g id="node242" class="node">
<title>l15_attn_tp0_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="19359.57,-284 18963.57,-284 18963.57,-216 19359.57,-216 19359.57,-284"/>
<text text-anchor="middle" x="19161.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="19161.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 0</text>
<text text-anchor="middle" x="19161.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="19161.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp0_gpu8 -->
<g id="node250" class="node">
<title>l15_moe_tp0_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="16290.07,-180 15903.07,-180 15903.07,-112 16290.07,-112 16290.07,-180"/>
<text text-anchor="middle" x="16096.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="16096.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 0&#45;1</text>
<text text-anchor="middle" x="16096.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16096.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp0_gpu8&#45;&gt;l15_moe_tp0_gpu8 -->
<g id="edge433" class="edge">
<title>l15_attn_tp0_gpu8&#45;&gt;l15_moe_tp0_gpu8</title>
<path fill="none" stroke="black" d="M18963.33,-216.8C18960.39,-216.52 18957.47,-216.25 18954.57,-216 17782.25,-115.14 17476.96,-281.97 16300.56,-180.03"/>
<polygon fill="black" stroke="black" points="16300.43,-176.51 16290.16,-179.12 16299.82,-183.48 16300.43,-176.51"/>
</g>
<!-- l15_attn_tp1_gpu9 -->
<g id="node243" class="node">
<title>l15_attn_tp1_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="20187.57,-284 19791.57,-284 19791.57,-216 20187.57,-216 20187.57,-284"/>
<text text-anchor="middle" x="19989.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="19989.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 1</text>
<text text-anchor="middle" x="19989.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="19989.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp1_gpu9 -->
<g id="node251" class="node">
<title>l15_moe_tp1_gpu9</title>
<polygon fill="lightyellow" stroke="black" points="17100.07,-180 16713.07,-180 16713.07,-112 17100.07,-112 17100.07,-180"/>
<text text-anchor="middle" x="16906.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="16906.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 2&#45;3</text>
<text text-anchor="middle" x="16906.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="16906.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp1_gpu9&#45;&gt;l15_moe_tp1_gpu9 -->
<g id="edge434" class="edge">
<title>l15_attn_tp1_gpu9&#45;&gt;l15_moe_tp1_gpu9</title>
<path fill="none" stroke="black" d="M19791.33,-216.8C19788.39,-216.52 19785.47,-216.25 19782.57,-216 18602.15,-114.5 18294.87,-282.65 17110.19,-180"/>
<polygon fill="black" stroke="black" points="17110.43,-176.51 17100.16,-179.12 17109.82,-183.48 17110.43,-176.51"/>
</g>
<!-- l15_attn_tp2_gpu10 -->
<g id="node244" class="node">
<title>l15_attn_tp2_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="22257.57,-284 21861.57,-284 21861.57,-216 22257.57,-216 22257.57,-284"/>
<text text-anchor="middle" x="22059.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="22059.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 2</text>
<text text-anchor="middle" x="22059.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="22059.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp2_gpu10 -->
<g id="node252" class="node">
<title>l15_moe_tp2_gpu10</title>
<polygon fill="lightyellow" stroke="black" points="20745.07,-180 20358.07,-180 20358.07,-112 20745.07,-112 20745.07,-180"/>
<text text-anchor="middle" x="20551.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="20551.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 4&#45;5</text>
<text text-anchor="middle" x="20551.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="20551.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp2_gpu10&#45;&gt;l15_moe_tp2_gpu10 -->
<g id="edge435" class="edge">
<title>l15_attn_tp2_gpu10&#45;&gt;l15_moe_tp2_gpu10</title>
<path fill="none" stroke="black" d="M21861.32,-216.88C21858.39,-216.57 21855.47,-216.28 21852.57,-216 21369.85,-169.79 21242.28,-226.48 20755.28,-180.01"/>
<polygon fill="black" stroke="black" points="20755.46,-176.52 20745.17,-179.04 20754.79,-183.48 20755.46,-176.52"/>
</g>
<!-- l15_attn_tp3_gpu11 -->
<g id="node245" class="node">
<title>l15_attn_tp3_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="18945.57,-284 18549.57,-284 18549.57,-216 18945.57,-216 18945.57,-284"/>
<text text-anchor="middle" x="18747.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="18747.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 3</text>
<text text-anchor="middle" x="18747.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="18747.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp3_gpu11 -->
<g id="node253" class="node">
<title>l15_moe_tp3_gpu11</title>
<polygon fill="lightyellow" stroke="black" points="15885.07,-180 15498.07,-180 15498.07,-112 15885.07,-112 15885.07,-180"/>
<text text-anchor="middle" x="15691.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="15691.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 6&#45;7</text>
<text text-anchor="middle" x="15691.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="15691.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp3_gpu11&#45;&gt;l15_moe_tp3_gpu11 -->
<g id="edge436" class="edge">
<title>l15_attn_tp3_gpu11&#45;&gt;l15_moe_tp3_gpu11</title>
<path fill="none" stroke="black" d="M18549.33,-216.8C18546.39,-216.52 18543.47,-216.25 18540.57,-216 17372.22,-115.45 17067.97,-281.66 15895.52,-180.03"/>
<polygon fill="black" stroke="black" points="15895.43,-176.51 15885.16,-179.12 15894.82,-183.48 15895.43,-176.51"/>
</g>
<!-- l15_attn_tp4_gpu12 -->
<g id="node246" class="node">
<title>l15_attn_tp4_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="18117.57,-284 17721.57,-284 17721.57,-216 18117.57,-216 18117.57,-284"/>
<text text-anchor="middle" x="17919.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="17919.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 4</text>
<text text-anchor="middle" x="17919.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17919.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp4_gpu12 -->
<g id="node254" class="node">
<title>l15_moe_tp4_gpu12</title>
<polygon fill="lightyellow" stroke="black" points="15075.07,-180 14688.07,-180 14688.07,-112 15075.07,-112 15075.07,-180"/>
<text text-anchor="middle" x="14881.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="14881.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 8&#45;9</text>
<text text-anchor="middle" x="14881.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="14881.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp4_gpu12&#45;&gt;l15_moe_tp4_gpu12 -->
<g id="edge437" class="edge">
<title>l15_attn_tp4_gpu12&#45;&gt;l15_moe_tp4_gpu12</title>
<path fill="none" stroke="black" d="M17721.33,-216.8C17718.39,-216.52 17715.47,-216.25 17712.57,-216 16552.17,-116.08 16249.98,-281.02 15085.45,-180.02"/>
<polygon fill="black" stroke="black" points="15085.43,-176.51 15075.16,-179.12 15084.82,-183.48 15085.43,-176.51"/>
</g>
<!-- l15_attn_tp5_gpu13 -->
<g id="node247" class="node">
<title>l15_attn_tp5_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="17703.57,-284 17307.57,-284 17307.57,-216 17703.57,-216 17703.57,-284"/>
<text text-anchor="middle" x="17505.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="17505.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 5</text>
<text text-anchor="middle" x="17505.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="17505.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp5_gpu13 -->
<g id="node255" class="node">
<title>l15_moe_tp5_gpu13</title>
<polygon fill="lightyellow" stroke="black" points="14670.07,-180 14283.07,-180 14283.07,-112 14670.07,-112 14670.07,-180"/>
<text text-anchor="middle" x="14476.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="14476.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 10&#45;11</text>
<text text-anchor="middle" x="14476.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14476.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp5_gpu13&#45;&gt;l15_moe_tp5_gpu13 -->
<g id="edge438" class="edge">
<title>l15_attn_tp5_gpu13&#45;&gt;l15_moe_tp5_gpu13</title>
<path fill="none" stroke="black" d="M17307.33,-216.8C17304.39,-216.52 17301.47,-216.25 17298.57,-216 16142.15,-116.4 15840.99,-280.7 14680.42,-180.02"/>
<polygon fill="black" stroke="black" points="14680.43,-176.51 14670.16,-179.12 14679.82,-183.48 14680.43,-176.51"/>
</g>
<!-- l15_attn_tp6_gpu14 -->
<g id="node248" class="node">
<title>l15_attn_tp6_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="19773.57,-284 19377.57,-284 19377.57,-216 19773.57,-216 19773.57,-284"/>
<text text-anchor="middle" x="19575.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="19575.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 6</text>
<text text-anchor="middle" x="19575.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="19575.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp6_gpu14 -->
<g id="node256" class="node">
<title>l15_moe_tp6_gpu14</title>
<polygon fill="lightyellow" stroke="black" points="16695.07,-180 16308.07,-180 16308.07,-112 16695.07,-112 16695.07,-180"/>
<text text-anchor="middle" x="16501.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="16501.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 12&#45;13</text>
<text text-anchor="middle" x="16501.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16501.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp6_gpu14&#45;&gt;l15_moe_tp6_gpu14 -->
<g id="edge439" class="edge">
<title>l15_attn_tp6_gpu14&#45;&gt;l15_moe_tp6_gpu14</title>
<path fill="none" stroke="black" d="M19377.33,-216.8C19374.39,-216.52 19371.47,-216.25 19368.57,-216 18192.13,-114.81 17885.88,-282.33 16705.16,-180"/>
<polygon fill="black" stroke="black" points="16705.43,-176.51 16695.16,-179.12 16704.82,-183.48 16705.43,-176.51"/>
</g>
<!-- l15_attn_tp7_gpu15 -->
<g id="node249" class="node">
<title>l15_attn_tp7_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="18531.57,-284 18135.57,-284 18135.57,-216 18531.57,-216 18531.57,-284"/>
<text text-anchor="middle" x="18333.57" y="-268.8" font-family="Times,serif" font-size="14.00">Attention Layer 15</text>
<text text-anchor="middle" x="18333.57" y="-253.8" font-family="Times,serif" font-size="14.00">TP Shard 7</text>
<text text-anchor="middle" x="18333.57" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18333.57" y="-223.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4,128], Output: [128,10000,4,128]</text>
</g>
<!-- l15_moe_tp7_gpu15 -->
<g id="node257" class="node">
<title>l15_moe_tp7_gpu15</title>
<polygon fill="lightyellow" stroke="black" points="15480.07,-180 15093.07,-180 15093.07,-112 15480.07,-112 15480.07,-180"/>
<text text-anchor="middle" x="15286.57" y="-164.8" font-family="Times,serif" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="15286.57" y="-149.8" font-family="Times,serif" font-size="14.00">Experts 14&#45;15</text>
<text text-anchor="middle" x="15286.57" y="-134.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="15286.57" y="-119.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], Output: [128,10000,4096]</text>
</g>
<!-- l15_attn_tp7_gpu15&#45;&gt;l15_moe_tp7_gpu15 -->
<g id="edge440" class="edge">
<title>l15_attn_tp7_gpu15&#45;&gt;l15_moe_tp7_gpu15</title>
<path fill="none" stroke="black" d="M18135.33,-216.8C18132.39,-216.52 18129.47,-216.25 18126.57,-216 16962.2,-115.77 16658.98,-281.34 15490.49,-180.02"/>
<polygon fill="black" stroke="black" points="15490.43,-176.51 15480.16,-179.12 15489.82,-183.48 15490.43,-176.51"/>
</g>
<!-- output -->
<g id="node274" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="15894.57" cy="-38" rx="258.19" ry="26.74"/>
<text text-anchor="middle" x="15894.57" y="-41.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="15894.57" y="-26.8" font-family="Times,serif" font-size="14.00">batch_size=128, seq_len=10000, d_model=4096</text>
</g>
<!-- l15_moe_tp0_gpu8&#45;&gt;output -->
<g id="edge441" class="edge">
<title>l15_moe_tp0_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16033.48,-111.9C16007.5,-98.26 15977.61,-82.58 15952.22,-69.25"/>
<polygon fill="black" stroke="black" points="15953.57,-66.01 15943.09,-64.46 15950.32,-72.21 15953.57,-66.01"/>
</g>
<!-- l15_moe_tp1_gpu9&#45;&gt;output -->
<g id="edge442" class="edge">
<title>l15_moe_tp1_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16753.87,-111.99C16737.28,-109.01 16720.6,-106.26 16704.57,-104 16514.21,-77.14 16296.99,-60.46 16135.45,-50.73"/>
<polygon fill="black" stroke="black" points="16135.57,-47.23 16125.38,-50.13 16135.15,-54.22 16135.57,-47.23"/>
</g>
<!-- l15_moe_tp2_gpu10&#45;&gt;output -->
<g id="edge443" class="edge">
<title>l15_moe_tp2_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M20405.33,-112C20386.65,-108.76 20367.71,-105.96 20349.57,-104 19935.19,-59.32 17060.89,-43.8 16162.37,-40.01"/>
<polygon fill="black" stroke="black" points="16162.23,-36.51 16152.21,-39.97 16162.2,-43.51 16162.23,-36.51"/>
</g>
<!-- l15_moe_tp3_gpu11&#45;&gt;output -->
<g id="edge444" class="edge">
<title>l15_moe_tp3_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15754.96,-111.9C15781.07,-98.26 15811.12,-82.58 15836.63,-69.25"/>
<polygon fill="black" stroke="black" points="15838.57,-72.19 15845.81,-64.46 15835.33,-65.99 15838.57,-72.19"/>
</g>
<!-- l15_moe_tp4_gpu12&#45;&gt;output -->
<g id="edge445" class="edge">
<title>l15_moe_tp4_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15035.03,-112C15051.7,-109.01 15068.46,-106.27 15084.57,-104 15275.12,-77.21 15492.55,-60.52 15654.13,-50.76"/>
<polygon fill="black" stroke="black" points="15654.43,-54.25 15664.21,-50.16 15654.02,-47.26 15654.43,-54.25"/>
</g>
<!-- l15_moe_tp5_gpu13&#45;&gt;output -->
<g id="edge446" class="edge">
<title>l15_moe_tp5_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14627.48,-111.99C14644.98,-108.92 14662.63,-106.15 14679.57,-104 15004.72,-62.69 15382.06,-47.58 15628.88,-42.08"/>
<polygon fill="black" stroke="black" points="15629.15,-45.58 15639.07,-41.86 15628.99,-38.58 15629.15,-45.58"/>
</g>
<!-- l15_moe_tp6_gpu14&#45;&gt;output -->
<g id="edge447" class="edge">
<title>l15_moe_tp6_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16342.08,-111.99C16327.72,-109.21 16313.39,-106.51 16299.57,-104 16216.42,-88.9 16123.33,-73.83 16047.38,-62.01"/>
<polygon fill="black" stroke="black" points="16047.68,-58.51 16037.26,-60.43 16046.6,-65.43 16047.68,-58.51"/>
</g>
<!-- l15_moe_tp7_gpu15&#45;&gt;output -->
<g id="edge448" class="edge">
<title>l15_moe_tp7_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15447.13,-111.95C15461.47,-109.19 15475.77,-106.5 15489.57,-104 15572.72,-88.94 15665.81,-73.87 15741.76,-62.04"/>
<polygon fill="black" stroke="black" points="15742.54,-65.46 15751.88,-60.47 15741.46,-58.55 15742.54,-65.46"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp0_gpu0 -->
<g id="edge18" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.97 6643.48,-515.69 5564.57,-526 5532.65,-526.31 990.07,-531.36 967.57,-554 943.76,-577.96 943.74,-606.06 967.57,-630 1001.7,-664.3 7760.47,-662.08 8066.01,-666.5"/>
<polygon fill="black" stroke="black" points="8066.25,-670.01 8076.33,-666.76 8066.42,-663.01 8066.25,-670.01"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp1_gpu1 -->
<g id="edge20" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.95 6643.48,-515.6 5564.57,-526 5533.44,-526.3 1103.51,-531.92 1081.57,-554 1057.76,-577.96 1057.74,-606.06 1081.57,-630 1121.19,-669.8 8977.07,-661.66 9307.98,-666.5"/>
<polygon fill="black" stroke="black" points="9308.25,-670 9318.33,-666.76 9308.42,-663.01 9308.25,-670"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp2_gpu2 -->
<g id="edge22" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M8310.49,-490.45C7952.85,-495.92 6643.48,-515.52 5564.57,-526 5534.2,-526.3 1212.97,-532.46 1191.57,-554 1167.76,-577.96 1167.72,-606.08 1191.57,-630 1221.17,-659.69 13046.89,-662.5 13448.05,-666.57"/>
<polygon fill="black" stroke="black" points="13448.27,-670.07 13458.33,-666.75 13448.4,-663.07 13448.27,-670.07"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp3_gpu3 -->
<g id="edge24" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.96 6643.48,-515.66 5564.57,-526 5532.91,-526.3 1027.89,-531.54 1005.57,-554 981.76,-577.96 981.74,-606.06 1005.57,-630 1041.53,-666.13 8165.29,-661.94 8479.96,-666.5"/>
<polygon fill="black" stroke="black" points="8480.25,-670.01 8490.33,-666.76 8480.42,-663.01 8480.25,-670.01"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp4_gpu4 -->
<g id="edge26" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.98 6643.48,-515.7 5564.57,-526 5532.49,-526.31 968.18,-531.25 945.57,-554 921.76,-577.96 921.75,-606.05 945.57,-630 977.79,-662.4 7357.07,-662.22 7652.12,-666.51"/>
<polygon fill="black" stroke="black" points="7652.25,-670.01 7662.33,-666.76 7652.42,-663.01 7652.25,-670.01"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp5_gpu5 -->
<g id="edge28" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.98 6643.48,-515.72 5564.57,-526 5532.34,-526.31 946.29,-531.14 923.57,-554 899.76,-577.96 899.75,-606.05 923.57,-630 953.89,-660.5 6954.42,-662.35 7238.27,-666.51"/>
<polygon fill="black" stroke="black" points="7238.25,-670.01 7248.33,-666.77 7238.42,-663.02 7238.25,-670.01"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp6_gpu6 -->
<g id="edge30" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M8310.49,-490.46C7952.85,-495.96 6643.48,-515.63 5564.57,-526 5533.17,-526.3 1065.7,-531.73 1043.57,-554 1019.76,-577.96 1019.74,-606.06 1043.57,-630 1081.36,-667.97 8570.82,-661.8 8893.95,-666.5"/>
<polygon fill="black" stroke="black" points="8894.25,-670.01 8904.33,-666.76 8894.42,-663.01 8894.25,-670.01"/>
</g>
<!-- l0_allreduce&#45;&gt;l1_attn_tp7_gpu7 -->
<g id="edge32" class="edge">
<title>l0_allreduce&#45;&gt;l1_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M8310.49,-490.45C7952.85,-495.93 6643.48,-515.54 5564.57,-526 5533.96,-526.3 1179.14,-532.29 1157.57,-554 1133.76,-577.96 1133.73,-606.07 1157.57,-630 1198.85,-671.45 9385.54,-661.53 9722.08,-666.49"/>
<polygon fill="black" stroke="black" points="9722.24,-670 9732.33,-666.76 9722.43,-663 9722.24,-670"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp0_gpu0 -->
<g id="edge42" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M3049.44,-490.47C2586.42,-497.84 571.84,-531.17 549.57,-554 525.98,-578.18 525.8,-606 549.57,-630 585.76,-666.54 4117.54,-661.84 4340.12,-666.43"/>
<polygon fill="black" stroke="black" points="4340.22,-669.94 4350.33,-666.78 4340.45,-662.94 4340.22,-669.94"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp1_gpu1 -->
<g id="edge44" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M3049.68,-490.51C2591.3,-497.97 609.49,-531.51 587.57,-554 563.99,-578.19 563.75,-606.05 587.57,-630 617.5,-660.11 6538.04,-662.37 6823.96,-666.51"/>
<polygon fill="black" stroke="black" points="6824.25,-670.02 6834.33,-666.77 6824.42,-663.02 6824.25,-670.02"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp2_gpu2 -->
<g id="edge46" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M3049.27,-490.38C2573.56,-497.43 458.89,-530.11 435.57,-554 411.97,-578.17 411.88,-605.93 435.57,-630 478.24,-673.36 2509.66,-661.27 2684.2,-666.35"/>
<polygon fill="black" stroke="black" points="2684.18,-669.85 2694.33,-666.81 2684.5,-662.86 2684.18,-669.85"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp3_gpu3 -->
<g id="edge48" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M3049.29,-490.36C2571.27,-497.35 437.1,-529.9 413.57,-554 389.97,-578.17 389.98,-605.82 413.57,-630 440.57,-657.69 1719.93,-662.04 1855.97,-666.36"/>
<polygon fill="black" stroke="black" points="1856.17,-669.87 1866.32,-666.84 1856.5,-662.88 1856.17,-669.87"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp4_gpu4 -->
<g id="edge50" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M3049.78,-490.74C2564.4,-499.8 359.65,-541.64 347.57,-554 254.46,-649.29 446.79,-682.38 613.91,-693.63"/>
<polygon fill="black" stroke="black" points="614.17,-697.16 624.38,-694.31 614.62,-690.17 614.17,-697.16"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp5_gpu5 -->
<g id="edge52" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M3049.72,-490.76C2566.56,-499.87 381.54,-541.74 369.57,-554 345.97,-578.16 346.34,-605.47 369.57,-630 418.29,-681.45 919.42,-659.88 1028.04,-666.16"/>
<polygon fill="black" stroke="black" points="1028.07,-669.67 1038.31,-666.96 1028.62,-662.7 1028.07,-669.67"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp6_gpu6 -->
<g id="edge54" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M3049.68,-490.78C2568.76,-499.94 403.44,-541.84 391.57,-554 367.97,-578.16 368.1,-605.71 391.57,-630 430.78,-670.57 1319.47,-661.14 1442.05,-666.26"/>
<polygon fill="black" stroke="black" points="1442.13,-669.77 1452.32,-666.88 1442.55,-662.78 1442.13,-669.77"/>
</g>
<!-- l1_allreduce&#45;&gt;l2_attn_tp7_gpu7 -->
<g id="edge56" class="edge">
<title>l1_allreduce&#45;&gt;l2_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M3049.43,-490.41C2578.11,-497.56 496.54,-530.46 473.57,-554 449.98,-578.17 449.83,-605.97 473.57,-630 502.47,-659.24 3317.01,-662.27 3512.33,-666.45"/>
<polygon fill="black" stroke="black" points="3512.21,-669.95 3522.33,-666.79 3512.45,-662.95 3512.21,-669.95"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp0_gpu0 -->
<g id="edge66" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M865.47,-490.18C673.53,-493.57 251.22,-506.41 207.57,-554 184.74,-578.89 183.76,-606.04 207.57,-630 259.19,-681.97 5311.13,-660.71 5582.03,-666.41"/>
<polygon fill="black" stroke="black" points="5582.21,-669.91 5592.33,-666.77 5582.46,-662.92 5582.21,-669.91"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp1_gpu1 -->
<g id="edge68" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M865.41,-490.32C704.02,-495.5 402.02,-519.73 511.57,-630 537.84,-656.45 5729.15,-662.61 5995.98,-666.51"/>
<polygon fill="black" stroke="black" points="5996.25,-670.02 6006.33,-666.77 5996.42,-663.02 5996.25,-670.02"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp2_gpu2 -->
<g id="edge70" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M865.73,-491C761.62,-495.44 603.3,-509.53 565.57,-554 543.71,-579.76 541.76,-606.04 565.57,-630 593.6,-658.2 6136.58,-662.5 6410.17,-666.52"/>
<polygon fill="black" stroke="black" points="6410.25,-670.02 6420.33,-666.77 6410.42,-663.02 6410.25,-670.02"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp3_gpu3 -->
<g id="edge72" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M864.14,-488.39C636.16,-487.92 74.47,-493.03 17.57,-554 -5.48,-578.69 -6.12,-605.93 17.57,-630 60.31,-673.43 2095.35,-661.27 2270.18,-666.35"/>
<polygon fill="black" stroke="black" points="2270.18,-669.85 2280.33,-666.81 2270.5,-662.86 2270.18,-669.85"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp4_gpu4 -->
<g id="edge74" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M864.91,-489.76C665.32,-492.36 215.84,-503.77 169.57,-554 146.68,-578.84 145.77,-606.03 169.57,-630 217.54,-678.32 4911.5,-660.98 5168.34,-666.42"/>
<polygon fill="black" stroke="black" points="5168.21,-669.92 5178.33,-666.77 5168.46,-662.92 5168.21,-669.92"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp5_gpu5 -->
<g id="edge76" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M864.36,-489.02C650.2,-490.05 145.13,-498.42 93.57,-554 70.59,-578.76 69.8,-606 93.57,-630 130.17,-666.94 3701.06,-661.82 3926.01,-666.43"/>
<polygon fill="black" stroke="black" points="3926.22,-669.94 3936.33,-666.78 3926.45,-662.94 3926.22,-669.94"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp6_gpu6 -->
<g id="edge78" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M864.33,-488.69C643.23,-488.96 109.8,-495.72 55.57,-554 32.56,-578.73 31.83,-605.97 55.57,-630 84.5,-659.28 2902.75,-662.27 3098.32,-666.45"/>
<polygon fill="black" stroke="black" points="3098.22,-669.95 3108.33,-666.79 3098.45,-662.95 3098.22,-669.95"/>
</g>
<!-- l2_allreduce&#45;&gt;l3_attn_tp7_gpu7 -->
<g id="edge80" class="edge">
<title>l2_allreduce&#45;&gt;l3_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M864.68,-489.37C657.76,-491.18 180.48,-501.1 131.57,-554 108.64,-578.8 107.78,-606.02 131.57,-630 175.88,-674.65 4508.27,-661.27 4754.33,-666.42"/>
<polygon fill="black" stroke="black" points="4754.21,-669.92 4764.33,-666.77 4754.46,-662.93 4754.21,-669.92"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp0_gpu0 -->
<g id="edge90" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M5341.76,-490.8C5040.94,-496.51 4073.4,-514.59 3272.57,-526 3238.44,-526.49 839.56,-529.73 815.57,-554 791.82,-578.02 791.72,-606.08 815.57,-630 843.06,-657.58 11822.45,-662.66 12206.19,-666.57"/>
<polygon fill="black" stroke="black" points="12206.27,-670.07 12216.33,-666.75 12206.4,-663.08 12206.27,-670.07"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp1_gpu1 -->
<g id="edge92" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M5341.76,-490.74C5040.94,-496.3 4073.39,-513.94 3272.57,-526 3242.67,-526.45 1140.58,-532.72 1119.57,-554 1095.84,-578.04 1095.72,-606.08 1119.57,-630 1147.33,-657.85 12232.73,-662.64 12620.09,-666.57"/>
<polygon fill="black" stroke="black" points="12620.27,-670.07 12630.33,-666.75 12620.4,-663.08 12620.27,-670.07"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp2_gpu2 -->
<g id="edge94" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M5341.75,-490.73C5040.94,-496.26 4073.39,-513.82 3272.57,-526 3243.36,-526.44 1190.09,-533.21 1169.57,-554 1145.84,-578.04 1145.72,-606.08 1169.57,-630 1198.22,-658.74 12640.1,-662.57 13034.08,-666.57"/>
<polygon fill="black" stroke="black" points="13034.27,-670.07 13044.33,-666.75 13034.4,-663.07 13034.27,-670.07"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp3_gpu3 -->
<g id="edge96" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M5341.76,-490.82C5040.95,-496.62 4073.41,-514.91 3272.57,-526 3235.81,-526.51 651.43,-527.87 625.57,-554 601.81,-578.01 601.73,-606.07 625.57,-630 671.46,-676.07 9780.28,-661.15 10136.08,-666.49"/>
<polygon fill="black" stroke="black" points="10136.24,-669.99 10146.33,-666.76 10136.43,-663 10136.24,-669.99"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp4_gpu4 -->
<g id="edge98" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M5341.76,-490.82C5040.95,-496.6 4073.41,-514.85 3272.57,-526 3236.33,-526.5 689.05,-528.24 663.57,-554 639.81,-578.01 639.73,-606.07 663.57,-630 711.3,-677.91 10189.55,-660.99 10550.23,-666.49"/>
<polygon fill="black" stroke="black" points="10550.24,-669.99 10560.33,-666.76 10550.43,-662.99 10550.24,-669.99"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp5_gpu5 -->
<g id="edge100" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M5341.76,-490.81C5040.95,-496.58 4073.4,-514.79 3272.57,-526 3236.86,-526.5 726.68,-528.61 701.57,-554 677.81,-578.01 677.73,-606.07 701.57,-630 751.13,-679.74 10594.66,-660.83 10964.14,-666.48"/>
<polygon fill="black" stroke="black" points="10964.24,-669.99 10974.33,-666.76 10964.43,-662.99 10964.24,-669.99"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp6_gpu6 -->
<g id="edge102" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M5341.76,-490.81C5040.94,-496.56 4073.4,-514.72 3272.57,-526 3237.39,-526.5 764.31,-528.98 739.57,-554 715.82,-578.02 715.72,-606.08 739.57,-630 790.96,-681.57 11000.13,-660.68 11378.06,-666.48"/>
<polygon fill="black" stroke="black" points="11378.24,-669.99 11388.33,-666.76 11378.43,-662.99 11378.24,-669.99"/>
</g>
<!-- l3_allreduce&#45;&gt;l4_attn_tp7_gpu7 -->
<g id="edge104" class="edge">
<title>l3_allreduce&#45;&gt;l4_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M5341.76,-490.8C5040.94,-496.54 4073.4,-514.66 3272.57,-526 3237.92,-526.49 801.93,-529.36 777.57,-554 753.82,-578.02 753.72,-606.08 777.57,-630 804.15,-656.67 11415.89,-662.73 11792.23,-666.57"/>
<polygon fill="black" stroke="black" points="11792.27,-670.07 11802.33,-666.76 11792.4,-663.08 11792.27,-670.07"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp0_gpu0 -->
<g id="edge114" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M23566.6,-489.74C24155.37,-494.36 27225.21,-520.07 27258.57,-554 27282.25,-578.09 27282.36,-606.02 27258.57,-630 27213.52,-675.4 22808.99,-661.21 22558.97,-666.42"/>
<polygon fill="black" stroke="black" points="22558.68,-662.93 22548.81,-666.77 22558.92,-669.92 22558.68,-662.93"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp1_gpu1 -->
<g id="edge116" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M23566.61,-489.71C24162.36,-494.18 27300.5,-519.35 27334.57,-554 27358.25,-578.08 27358.33,-605.99 27334.57,-630 27300.87,-664.04 24014.99,-662 23801,-666.44"/>
<polygon fill="black" stroke="black" points="23800.68,-662.95 23790.81,-666.78 23800.92,-669.94 23800.68,-662.95"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp2_gpu2 -->
<g id="edge118" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M23566.19,-489.7C24162.9,-494.12 27322.29,-519.14 27356.57,-554 27380.25,-578.08 27380.29,-605.96 27356.57,-630 27330.7,-656.22 24814.14,-662.41 24628.94,-666.45"/>
<polygon fill="black" stroke="black" points="24628.68,-662.95 24618.81,-666.8 24628.92,-669.95 24628.68,-662.95"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp3_gpu3 -->
<g id="edge120" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M23565.61,-488.87C24135.24,-488.35 27047.6,-488.88 27111.57,-554 27135.24,-578.1 27135.39,-606.05 27111.57,-630 27079.75,-661.99 20780.35,-662.25 20488.9,-666.51"/>
<polygon fill="black" stroke="black" points="20488.71,-663.01 20478.81,-666.76 20488.89,-670.01 20488.71,-663.01"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp4_gpu4 -->
<g id="edge122" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M23566.57,-489.76C24151.78,-494.46 27187.57,-520.42 27220.57,-554 27244.24,-578.09 27244.37,-606.04 27220.57,-630 27194.27,-656.47 21998.23,-662.6 21731.16,-666.51"/>
<polygon fill="black" stroke="black" points="21730.72,-663.02 21720.81,-666.77 21730.89,-670.02 21730.72,-663.02"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp5_gpu5 -->
<g id="edge124" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M23566.02,-488.86C24139.68,-488.24 27080,-488.28 27144.57,-554 27168.24,-578.09 27168.38,-606.05 27144.57,-630 27114.61,-660.13 21189.33,-662.37 20903.18,-666.51"/>
<polygon fill="black" stroke="black" points="20902.72,-663.02 20892.81,-666.77 20902.89,-670.02 20902.72,-663.02"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp6_gpu6 -->
<g id="edge126" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M23566.61,-489.73C24158.9,-494.27 27262.86,-519.71 27296.57,-554 27320.25,-578.09 27320.35,-606.02 27296.57,-630 27255.18,-671.74 23210.95,-661.48 22972.9,-666.43"/>
<polygon fill="black" stroke="black" points="22972.68,-662.93 22962.81,-666.78 22972.92,-669.93 22972.68,-662.93"/>
</g>
<!-- l4_allreduce&#45;&gt;l5_attn_tp7_gpu7 -->
<g id="edge128" class="edge">
<title>l4_allreduce&#45;&gt;l5_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M23566.53,-489.78C24148.12,-494.55 27149.92,-520.78 27182.57,-554 27206.24,-578.09 27206.38,-606.04 27182.57,-630 27154.44,-658.31 21591.54,-662.49 21317,-666.51"/>
<polygon fill="black" stroke="black" points="21316.72,-663.02 21306.81,-666.77 21316.89,-670.02 21316.72,-663.02"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp0_gpu0 -->
<g id="edge138" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M27666.56,-494.49C27755.1,-501.68 27874.79,-517.95 27904.57,-554 27926.08,-580.04 27928.19,-605.85 27904.57,-630 27874.12,-661.13 26429.33,-661.93 26284.97,-666.36"/>
<polygon fill="black" stroke="black" points="26284.64,-662.87 26274.81,-666.83 26284.96,-669.87 26284.64,-662.87"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp1_gpu1 -->
<g id="edge140" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M27664.7,-492.1C27763.99,-497.55 27907.69,-512.57 27942.57,-554 27964.32,-579.84 27966.1,-605.77 27942.57,-630 27895.86,-678.08 26835.9,-660.73 26699.1,-666.25"/>
<polygon fill="black" stroke="black" points="26698.59,-662.78 26688.81,-666.86 26699,-669.76 26698.59,-662.78"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp2_gpu2 -->
<g id="edge142" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M27664.48,-491.77C27815.21,-499.27 28077.12,-527.06 27980.57,-630 27951.37,-661.13 27417.38,-682.93 27112.86,-692.89"/>
<polygon fill="black" stroke="black" points="27112.46,-689.4 27102.58,-693.23 27112.69,-696.4 27112.46,-689.4"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp3_gpu3 -->
<g id="edge144" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M27651.54,-526.07C27661.53,-533.87 27670.36,-543.11 27676.57,-554 27693.31,-583.34 27700.35,-606.02 27676.57,-630 27635.5,-671.41 23623.07,-661.5 23386.82,-666.43"/>
<polygon fill="black" stroke="black" points="23386.68,-662.93 23376.81,-666.78 23386.92,-669.93 23386.68,-662.93"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp4_gpu4 -->
<g id="edge146" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M27686.67,-525.91C27697.6,-533.58 27707.28,-542.84 27714.57,-554 27733.04,-582.28 27738.33,-605.99 27714.57,-630 27681.2,-663.72 24426.92,-662.02 24214.91,-666.44"/>
<polygon fill="black" stroke="black" points="24214.68,-662.95 24204.81,-666.78 24214.92,-669.94 24214.68,-662.95"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp5_gpu5 -->
<g id="edge148" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M27531.83,-526C27496.88,-560.32 27439.56,-609.15 27378.57,-630 27258.04,-671.21 25249.62,-655.39 25042.79,-666.15"/>
<polygon fill="black" stroke="black" points="25042.56,-662.66 25032.81,-666.8 25043.02,-669.64 25042.56,-662.66"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp6_gpu6 -->
<g id="edge150" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M27670.95,-501.69C27735.15,-511.88 27808.79,-528.71 27828.57,-554 27849.38,-580.61 27852.27,-605.94 27828.57,-630 27783.5,-675.75 25636.79,-661.12 25456.9,-666.34"/>
<polygon fill="black" stroke="black" points="25456.64,-662.85 25446.81,-666.8 25456.96,-669.84 25456.64,-662.85"/>
</g>
<!-- l5_allreduce&#45;&gt;l6_attn_tp7_gpu7 -->
<g id="edge152" class="edge">
<title>l5_allreduce&#45;&gt;l6_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M27668.48,-497.56C27745.41,-506.38 27841.81,-523.3 27866.57,-554 27887.77,-580.29 27890.24,-605.9 27866.57,-630 27828.83,-668.42 26034.73,-661.58 25871.08,-666.35"/>
<polygon fill="black" stroke="black" points="25870.64,-662.87 25860.81,-666.82 25870.96,-669.86 25870.64,-662.87"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp0_gpu0 -->
<g id="edge162" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp0_gpu0</title>
<path fill="none" stroke="black" d="M27142.14,-495.55C27276.27,-505.33 27499.8,-525.68 27524.57,-554 27546.8,-579.43 27548.4,-606.06 27524.57,-630 27484.7,-670.05 19580.12,-661.64 19247.22,-666.49"/>
<polygon fill="black" stroke="black" points="19246.71,-663.01 19236.8,-666.76 19246.89,-670 19246.71,-663.01"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp1_gpu1 -->
<g id="edge164" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp1_gpu1</title>
<path fill="none" stroke="black" d="M27144.33,-499.21C27303.69,-515.29 27593.05,-545.55 27600.57,-554 27623.03,-579.23 27624.4,-606.06 27600.57,-630 27564.36,-666.38 20392.01,-661.93 20075.24,-666.5"/>
<polygon fill="black" stroke="black" points="20074.71,-663.01 20064.8,-666.76 20074.89,-670.01 20074.71,-663.01"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp2_gpu2 -->
<g id="edge166" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp2_gpu2</title>
<path fill="none" stroke="black" d="M27143.83,-498.39C27312.26,-514.1 27630.39,-544.88 27638.57,-554 27661.12,-579.14 27662.37,-606.04 27638.57,-630 27612.25,-656.49 22412.43,-662.6 22145.17,-666.51"/>
<polygon fill="black" stroke="black" points="22144.72,-663.02 22134.81,-666.77 22144.89,-670.02 22144.72,-663.02"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp3_gpu3 -->
<g id="edge168" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp3_gpu3</title>
<path fill="none" stroke="black" d="M27138.95,-490.61C27300.2,-496.3 27594.72,-521.4 27486.57,-630 27444.85,-671.89 19169,-661.49 18832.91,-666.5"/>
<polygon fill="black" stroke="black" points="18832.71,-663 18822.8,-666.76 18832.89,-670 18832.71,-663"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp4_gpu4 -->
<g id="edge170" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp4_gpu4</title>
<path fill="none" stroke="black" d="M27140.13,-492.5C27237.5,-498.28 27376.64,-513.58 27410.57,-554 27432.28,-579.87 27434.41,-606.07 27410.57,-630 27365.18,-675.56 18356.92,-661.19 18004.95,-666.49"/>
<polygon fill="black" stroke="black" points="18004.71,-662.99 17994.8,-666.76 18004.89,-669.99 18004.71,-662.99"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp5_gpu5 -->
<g id="edge172" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp5_gpu5</title>
<path fill="none" stroke="black" d="M27092.43,-526.32C27100.22,-534.51 27107.13,-543.81 27111.57,-554 27125.07,-584.96 27135.41,-606.07 27111.57,-630 27065.62,-676.13 17942.71,-661.14 17590.81,-666.49"/>
<polygon fill="black" stroke="black" points="17590.71,-662.99 17580.8,-666.76 17590.89,-669.99 17590.71,-662.99"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp6_gpu6 -->
<g id="edge174" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp6_gpu6</title>
<path fill="none" stroke="black" d="M27143.86,-498.29C27291.66,-512.2 27548.85,-538.47 27562.57,-554 27584.93,-579.32 27586.4,-606.06 27562.57,-630 27524.53,-668.21 19986.42,-661.79 19661.25,-666.5"/>
<polygon fill="black" stroke="black" points="19660.71,-663.01 19650.8,-666.76 19660.89,-670.01 19660.71,-663.01"/>
</g>
<!-- l6_allreduce&#45;&gt;l7_attn_tp7_gpu7 -->
<g id="edge176" class="edge">
<title>l6_allreduce&#45;&gt;l7_attn_tp7_gpu7</title>
<path fill="none" stroke="black" d="M27138.96,-490.55C27246.47,-494.57 27409.56,-508.27 27448.57,-554 27470.49,-579.7 27472.4,-606.07 27448.57,-630 27405.01,-673.73 18761.08,-661.34 18418.82,-666.49"/>
<polygon fill="black" stroke="black" points="18418.71,-663 18408.8,-666.76 18418.89,-669.99 18418.71,-663"/>
</g>
<!-- pipeline_stage_0_1 -->
<g id="node266" class="node">
<title>pipeline_stage_0_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15907.61,-414 15592.57,-414 15511.53,-338 15826.57,-338 15907.61,-414"/>
<text text-anchor="middle" x="15709.57" y="-379.8" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="15709.57" y="-364.8" font-family="Times,serif" font-size="14.00">Stage 0  Stage 1</text>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge186" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15664.58,-449.76C15662.41,-441.52 15661.8,-432.68 15662.75,-424.1"/>
<polygon fill="black" stroke="black" points="15666.21,-424.67 15664.59,-414.2 15659.32,-423.4 15666.21,-424.67"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge196" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15677.43,-449.76C15675.9,-441.61 15675.46,-432.87 15676.11,-424.38"/>
<polygon fill="black" stroke="black" points="15679.61,-424.57 15677.44,-414.2 15672.67,-423.66 15679.61,-424.57"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge206" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15690.29,-449.76C15689.37,-441.61 15689.1,-432.87 15689.49,-424.38"/>
<polygon fill="black" stroke="black" points="15693,-424.45 15690.29,-414.2 15686.02,-423.9 15693,-424.45"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge216" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15703.14,-449.76C15702.83,-441.61 15702.75,-432.87 15702.88,-424.38"/>
<polygon fill="black" stroke="black" points="15706.38,-424.29 15703.14,-414.2 15699.38,-424.11 15706.38,-424.29"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge226" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15716,-449.76C15716.3,-441.61 15716.39,-432.87 15716.26,-424.38"/>
<polygon fill="black" stroke="black" points="15719.75,-424.11 15715.99,-414.2 15712.76,-424.29 15719.75,-424.11"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge236" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15728.85,-449.76C15729.77,-441.61 15730.03,-432.87 15729.64,-424.38"/>
<polygon fill="black" stroke="black" points="15733.12,-423.9 15728.84,-414.2 15726.14,-424.45 15733.12,-423.9"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge246" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15741.7,-449.76C15743.24,-441.61 15743.68,-432.87 15743.03,-424.38"/>
<polygon fill="black" stroke="black" points="15746.46,-423.66 15741.7,-414.2 15739.52,-424.57 15746.46,-423.66"/>
</g>
<!-- l7_allreduce&#45;&gt;pipeline_stage_0_1 -->
<g id="edge256" class="edge">
<title>l7_allreduce&#45;&gt;pipeline_stage_0_1</title>
<path fill="none" stroke="black" d="M15754.56,-449.76C15756.73,-441.52 15757.33,-432.68 15756.38,-424.1"/>
<polygon fill="black" stroke="black" points="15759.81,-423.4 15754.55,-414.2 15752.93,-424.67 15759.81,-423.4"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge187" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15861.1,-370.08C16034.79,-364.18 16304.46,-352.17 16407.57,-330 16451.27,-320.6 16497.96,-303.45 16541.81,-287.53"/>
<polygon fill="black" stroke="black" points="16543.2,-290.75 16551.41,-284.05 16540.82,-284.17 16543.2,-290.75"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge197" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15861.53,-370.52C16039.14,-364.78 16319.87,-352.73 16425.57,-330 16469.18,-320.62 16515.77,-303.53 16557.86,-287.63"/>
<polygon fill="black" stroke="black" points="16559.21,-290.86 16567.33,-284.05 16556.74,-284.31 16559.21,-290.86"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge207" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15862.05,-370.91C16043.73,-365.34 16335.37,-353.27 16443.57,-330 16487.09,-320.64 16533.57,-303.6 16573.93,-287.73"/>
<polygon fill="black" stroke="black" points="16575.23,-290.98 16583.25,-284.05 16572.66,-284.47 16575.23,-290.98"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge217" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15862.23,-371.29C16048.12,-365.89 16350.86,-353.81 16461.57,-330 16504.73,-320.72 16550.8,-303.88 16589.3,-288.13"/>
<polygon fill="black" stroke="black" points="16591.02,-291.2 16598.92,-284.15 16588.34,-284.74 16591.02,-291.2"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge227" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15862.44,-371.64C16052.76,-366.42 16366.43,-354.33 16479.57,-330 16522.55,-320.76 16568.41,-304.02 16605.21,-288.33"/>
<polygon fill="black" stroke="black" points="16607.07,-291.34 16614.85,-284.15 16604.28,-284.91 16607.07,-291.34"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge237" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15863.08,-371.94C16058.12,-366.9 16382.17,-354.82 16497.57,-330 16540.55,-320.76 16586.41,-304.02 16621.61,-288.33"/>
<polygon fill="black" stroke="black" points="16623.13,-291.48 16630.78,-284.15 16620.23,-285.11 16623.13,-291.48"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge247" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15863.29,-372.23C16063.32,-367.37 16397.9,-355.3 16515.57,-330 16558.36,-320.8 16604.02,-304.16 16637.58,-288.53"/>
<polygon fill="black" stroke="black" points="16639.2,-291.63 16646.71,-284.15 16636.18,-285.32 16639.2,-291.63"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8 -->
<g id="edge257" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M15863.48,-372.49C16068.83,-367.81 16413.72,-355.77 16533.57,-330 16576.18,-320.84 16621.63,-304.31 16653.58,-288.73"/>
<polygon fill="black" stroke="black" points="16655.29,-291.79 16662.64,-284.15 16652.14,-285.54 16655.29,-291.79"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge188" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15847.31,-357.39C15894.24,-350.83 15946.15,-341.95 15993.57,-330 16035.7,-319.39 16080.95,-302.76 16123.78,-287.49"/>
<polygon fill="black" stroke="black" points="16125.21,-290.7 16133.46,-284.05 16122.86,-284.1 16125.21,-290.7"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge198" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15849.87,-359.4C15901.23,-352.67 15959.14,-343.21 16011.57,-330 16053.61,-319.41 16098.76,-302.83 16139.98,-287.59"/>
<polygon fill="black" stroke="black" points="16141.37,-290.8 16149.53,-284.05 16138.94,-284.24 16141.37,-290.8"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge208" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15851.49,-361.35C15907.46,-354.55 15971.84,-344.54 16029.57,-330 16071.52,-319.43 16116.57,-302.9 16156.19,-287.68"/>
<polygon fill="black" stroke="black" points="16157.54,-290.91 16165.61,-284.05 16155.02,-284.38 16157.54,-290.91"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge218" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15853.41,-363.1C15913.91,-356.3 15984.68,-345.84 16047.57,-330 16089.35,-319.48 16134.19,-303.04 16172.18,-287.88"/>
<polygon fill="black" stroke="black" points="16173.71,-291.03 16181.68,-284.05 16171.1,-284.54 16173.71,-291.03"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge228" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15855.09,-364.7C15920.25,-357.97 15997.53,-347.14 16065.57,-330 16107.17,-319.52 16151.81,-303.18 16188.21,-288.07"/>
<polygon fill="black" stroke="black" points="16189.9,-291.15 16197.76,-284.05 16187.18,-284.7 16189.9,-291.15"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge238" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15856.87,-366.12C15926.83,-359.53 16010.52,-348.4 16083.57,-330 16124.99,-319.56 16169.43,-303.32 16204.27,-288.26"/>
<polygon fill="black" stroke="black" points="16206.09,-291.28 16213.83,-284.05 16203.27,-284.88 16206.09,-291.28"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge248" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15858.19,-367.41C15933.3,-361.03 16023.52,-349.66 16101.57,-330 16142.99,-319.56 16187.43,-303.32 16220.8,-288.26"/>
<polygon fill="black" stroke="black" points="16222.3,-291.42 16229.91,-284.05 16219.36,-285.07 16222.3,-291.42"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9 -->
<g id="edge258" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M15859.35,-368.55C15940.02,-362.41 16036.66,-350.89 16119.57,-330 16160.82,-319.61 16205.05,-303.45 16236.92,-288.45"/>
<polygon fill="black" stroke="black" points="16238.52,-291.57 16245.99,-284.05 16235.46,-285.27 16238.52,-291.57"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge189" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15707.86,-337.8C15720.38,-322.68 15739.95,-305.2 15761.42,-289.92"/>
<polygon fill="black" stroke="black" points="15763.5,-292.74 15769.73,-284.17 15759.52,-286.98 15763.5,-292.74"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge199" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15720.35,-337.8C15734.11,-322.74 15753.61,-305.36 15773.78,-290.12"/>
<polygon fill="black" stroke="black" points="15775.87,-292.93 15781.84,-284.17 15771.72,-287.29 15775.87,-292.93"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge209" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15732.84,-337.8C15747.76,-322.88 15767.1,-305.67 15785.93,-290.52"/>
<polygon fill="black" stroke="black" points="15788.28,-293.12 15793.95,-284.17 15783.94,-287.63 15788.28,-293.12"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge219" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15745.33,-337.8C15761.32,-323.07 15780.43,-306.12 15797.91,-291.12"/>
<polygon fill="black" stroke="black" points="15800.48,-293.53 15805.82,-284.38 15795.94,-288.2 15800.48,-293.53"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge229" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15757.82,-337.8C15774.92,-323.21 15793.91,-306.42 15810.19,-291.52"/>
<polygon fill="black" stroke="black" points="15812.96,-293.73 15817.95,-284.38 15808.22,-288.58 15812.96,-293.73"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge239" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15770.31,-337.8C15788.66,-323.21 15807.74,-306.42 15822.94,-291.52"/>
<polygon fill="black" stroke="black" points="15825.49,-293.93 15830.08,-284.38 15820.53,-288.98 15825.49,-293.93"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge249" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15782.8,-337.8C15802.22,-323.34 15821.22,-306.73 15835.31,-291.93"/>
<polygon fill="black" stroke="black" points="15838.05,-294.12 15842.21,-284.38 15832.88,-289.4 15838.05,-294.12"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10 -->
<g id="edge259" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M15795.29,-337.8C15815.77,-323.47 15834.7,-307.03 15847.73,-292.34"/>
<polygon fill="black" stroke="black" points="15850.64,-294.31 15854.34,-284.38 15845.26,-289.84 15850.64,-294.31"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge190" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15584.06,-337.96C15545.07,-322.44 15505.15,-304.41 15475.22,-288.81"/>
<polygon fill="black" stroke="black" points="15476.74,-285.65 15466.26,-284.05 15473.45,-291.83 15476.74,-285.65"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge200" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15596.54,-337.96C15558.72,-322.38 15518.65,-304.26 15487.36,-288.61"/>
<polygon fill="black" stroke="black" points="15488.86,-285.45 15478.36,-284.05 15485.7,-291.69 15488.86,-285.45"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge210" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15609.02,-337.96C15572.39,-322.31 15532.15,-304.1 15499.47,-288.41"/>
<polygon fill="black" stroke="black" points="15500.98,-285.25 15490.46,-284.05 15497.94,-291.56 15500.98,-285.25"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge220" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15621.49,-337.96C15586.22,-322.31 15545.99,-304.1 15511.97,-288.41"/>
<polygon fill="black" stroke="black" points="15513.1,-285.07 15502.55,-284.05 15510.16,-291.43 15513.1,-285.07"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge230" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15633.97,-337.96C15599.91,-322.24 15559.49,-303.95 15524.03,-288.21"/>
<polygon fill="black" stroke="black" points="15525.21,-284.9 15514.65,-284.05 15522.37,-291.3 15525.21,-284.9"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge240" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15646.44,-337.96C15613.6,-322.17 15572.98,-303.79 15536.05,-288.01"/>
<polygon fill="black" stroke="black" points="15537.32,-284.74 15526.75,-284.05 15534.58,-291.18 15537.32,-284.74"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge250" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15658.92,-337.96C15627.45,-322.17 15586.82,-303.79 15548.52,-288.01"/>
<polygon fill="black" stroke="black" points="15549.42,-284.59 15538.84,-284.05 15546.78,-291.07 15549.42,-284.59"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11 -->
<g id="edge260" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M15671.4,-337.96C15641.16,-322.11 15600.32,-303.64 15560.49,-287.81"/>
<polygon fill="black" stroke="black" points="15561.53,-284.45 15550.94,-284.05 15558.97,-290.97 15561.53,-284.45"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge191" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15548.95,-373.12C15437.22,-369.46 15290.24,-359.05 15165.57,-330 15123.63,-320.23 15078.79,-303.89 15046.87,-288.61"/>
<polygon fill="black" stroke="black" points="15048.32,-285.42 15037.81,-284.12 15045.21,-291.7 15048.32,-285.42"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge201" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15548.32,-372.59C15442.03,-368.48 15302.62,-357.74 15183.57,-330 15141.45,-320.19 15096.4,-303.75 15062.93,-288.41"/>
<polygon fill="black" stroke="black" points="15064.35,-285.21 15053.81,-284.12 15061.37,-291.54 15064.35,-285.21"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge211" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15547.64,-371.94C15446.44,-367.39 15314.8,-356.39 15201.57,-330 15159.27,-320.14 15114.02,-303.61 15078.96,-288.21"/>
<polygon fill="black" stroke="black" points="15080.37,-285.01 15069.81,-284.12 15077.51,-291.4 15080.37,-285.01"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge221" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15546.81,-371.15C15450.49,-366.18 15326.78,-354.98 15219.57,-330 15177.27,-320.14 15132.02,-303.61 15095.41,-288.21"/>
<polygon fill="black" stroke="black" points="15096.39,-284.83 15085.82,-284.12 15093.64,-291.26 15096.39,-284.83"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge231" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15545.73,-370.22C15454.17,-364.83 15338.55,-353.53 15237.57,-330 15195.09,-320.1 15149.63,-303.47 15111.38,-288.02"/>
<polygon fill="black" stroke="black" points="15112.4,-284.65 15101.82,-284.12 15109.76,-291.14 15112.4,-284.65"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge241" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15544.57,-369.14C15457.73,-363.36 15350.22,-352.06 15255.57,-330 15212.82,-320.04 15167.06,-303.26 15127.07,-287.73"/>
<polygon fill="black" stroke="black" points="15128.15,-284.39 15117.57,-284.02 15125.61,-290.91 15128.15,-284.39"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge251" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15543.24,-367.88C15461.18,-361.78 15361.79,-350.56 15273.57,-330 15230.64,-320 15184.67,-303.12 15142.95,-287.53"/>
<polygon fill="black" stroke="black" points="15144.15,-284.24 15133.56,-284.02 15141.7,-290.8 15144.15,-284.24"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12 -->
<g id="edge261" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M15541.65,-366.44C15464.51,-360.06 15373.25,-349.03 15291.57,-330 15248.55,-319.98 15202.48,-303.05 15159.06,-287.43"/>
<polygon fill="black" stroke="black" points="15160.14,-284.1 15149.55,-284.02 15157.78,-290.69 15160.14,-284.1"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge192" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15549.19,-373.58C15314.15,-370.36 14895.34,-360.26 14751.57,-330 14708.74,-320.99 14663.1,-304.38 14631.13,-288.71"/>
<polygon fill="black" stroke="black" points="14632.58,-285.52 14622.08,-284.11 14629.4,-291.76 14632.58,-285.52"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge202" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15548.97,-373.42C15318.91,-370.04 14911.06,-359.77 14769.57,-330 14726.56,-320.95 14680.71,-304.24 14647.12,-288.51"/>
<polygon fill="black" stroke="black" points="14648.51,-285.3 14637.98,-284.11 14645.47,-291.6 14648.51,-285.3"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge212" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15548.67,-373.25C15323.28,-369.68 14926.68,-359.27 14787.57,-330 14744.38,-320.91 14698.32,-304.1 14663.07,-288.31"/>
<polygon fill="black" stroke="black" points="14664.44,-285.09 14653.89,-284.11 14661.52,-291.45 14664.44,-285.09"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge222" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15548.74,-373.06C15327.79,-369.32 14942.3,-358.77 14805.57,-330 14762.19,-320.87 14715.92,-303.95 14678.98,-288.11"/>
<polygon fill="black" stroke="black" points="14680.36,-284.89 14669.79,-284.11 14677.56,-291.31 14680.36,-284.89"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge232" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15548.24,-372.84C15331.39,-368.92 14957.73,-358.23 14823.57,-330 14780.19,-320.87 14733.92,-303.95 14695.33,-288.11"/>
<polygon fill="black" stroke="black" points="14696.27,-284.71 14685.7,-284.11 14693.59,-291.18 14696.27,-284.71"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge242" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15548.07,-372.61C15335.17,-368.5 14973.16,-357.69 14841.57,-330 14797.83,-320.8 14751.15,-303.67 14710.68,-287.71"/>
<polygon fill="black" stroke="black" points="14711.93,-284.44 14701.35,-284.01 14709.35,-290.95 14711.93,-284.44"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge252" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15547.74,-372.35C15338.6,-368.06 14988.5,-357.13 14859.57,-330 14815.74,-320.78 14768.95,-303.6 14726.74,-287.61"/>
<polygon fill="black" stroke="black" points="14727.83,-284.28 14717.24,-284.01 14725.35,-290.83 14727.83,-284.28"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13 -->
<g id="edge262" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M15547.7,-372.07C15342.23,-367.6 15003.84,-356.57 14877.57,-330 14833.65,-320.76 14786.76,-303.53 14742.76,-287.51"/>
<polygon fill="black" stroke="black" points="14743.72,-284.14 14733.13,-284.01 14741.33,-290.71 14743.72,-284.14"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge193" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15548.69,-372.97C15209.37,-367.8 14450.82,-352.9 14337.57,-330 14294.5,-321.29 14248.66,-304.63 14216.68,-288.84"/>
<polygon fill="black" stroke="black" points="14218.13,-285.65 14207.63,-284.2 14214.93,-291.88 14218.13,-285.65"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge203" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15548.43,-372.83C15213.43,-367.53 14467.78,-352.68 14355.57,-330 14312.32,-321.26 14266.26,-304.49 14232.65,-288.64"/>
<polygon fill="black" stroke="black" points="14234.04,-285.42 14223.51,-284.2 14230.98,-291.72 14234.04,-285.42"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge213" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15548.45,-372.68C15217.6,-367.25 14484.73,-352.47 14373.57,-330 14330.13,-321.22 14283.87,-304.34 14248.58,-288.43"/>
<polygon fill="black" stroke="black" points="14249.94,-285.21 14239.39,-284.2 14247.01,-291.56 14249.94,-285.21"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge223" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15548.12,-372.51C15220.96,-366.95 14501.62,-352.25 14391.57,-330 14347.95,-321.18 14301.48,-304.2 14264.47,-288.23"/>
<polygon fill="black" stroke="black" points="14265.84,-285.01 14255.27,-284.2 14263.03,-291.42 14265.84,-285.01"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge233" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15548.04,-372.34C15224.46,-366.65 14518.5,-352.02 14409.57,-330 14365.95,-321.18 14319.48,-304.2 14280.81,-288.23"/>
<polygon fill="black" stroke="black" points="14281.73,-284.82 14271.15,-284.2 14279.03,-291.28 14281.73,-284.82"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge243" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15547.91,-372.15C15227.63,-366.34 14535.35,-351.79 14427.57,-330 14383.58,-321.11 14336.7,-303.91 14296.14,-287.83"/>
<polygon fill="black" stroke="black" points="14297.36,-284.55 14286.78,-284.1 14294.77,-291.05 14297.36,-284.55"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge253" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15547.71,-371.96C15230.49,-366.02 14552.17,-351.55 14445.57,-330 14401.49,-321.09 14354.5,-303.84 14312.17,-287.73"/>
<polygon fill="black" stroke="black" points="14313.23,-284.39 14302.64,-284.1 14310.74,-290.93 14313.23,-284.39"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14 -->
<g id="edge263" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M15547.43,-371.75C15233.05,-365.69 14568.95,-351.3 14463.57,-330 14419.4,-321.07 14372.3,-303.77 14328.17,-287.63"/>
<polygon fill="black" stroke="black" points="14329.1,-284.24 14318.51,-284.1 14326.7,-290.82 14329.1,-284.24"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge194" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.23,-375.19C16128.84,-374.14 16640.68,-366.94 16821.57,-330 16865.72,-320.98 16912.81,-303.68 16956.95,-287.55"/>
<polygon fill="black" stroke="black" points="16958.42,-290.74 16966.61,-284.03 16956.02,-284.17 16958.42,-290.74"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge204" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.33,-375.23C16131.91,-374.35 16656.05,-367.47 16839.57,-330 16883.63,-321 16930.62,-303.75 16972.95,-287.65"/>
<polygon fill="black" stroke="black" points="16974.38,-290.86 16982.48,-284.03 16971.89,-284.31 16974.38,-290.86"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge214" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.44,-375.27C16135.21,-374.53 16671.49,-368 16857.57,-330 16901.54,-321.02 16948.42,-303.82 16988.98,-287.75"/>
<polygon fill="black" stroke="black" points="16990.35,-290.98 16998.34,-284.03 16987.76,-284.48 16990.35,-290.98"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge224" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.56,-375.29C16138.73,-374.7 16686.99,-368.51 16875.57,-330 16919.17,-321.1 16965.64,-304.1 17004.31,-288.15"/>
<polygon fill="black" stroke="black" points="17006.09,-291.21 17013.97,-284.13 17003.39,-284.75 17006.09,-291.21"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge234" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.4,-375.31C16142.13,-374.86 16702.49,-369.02 16893.57,-330 16937.17,-321.1 16983.64,-304.1 17020.65,-288.15"/>
<polygon fill="black" stroke="black" points="17022.09,-291.34 17029.85,-284.13 17019.28,-284.93 17022.09,-291.34"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge244" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.49,-375.33C16146.14,-375 16718.12,-369.5 16911.57,-330 16954.99,-321.13 17001.25,-304.25 17036.54,-288.36"/>
<polygon fill="black" stroke="black" points="17038.11,-291.49 17045.73,-284.13 17035.18,-285.13 17038.11,-291.49"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge254" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.53,-375.34C16150.41,-375.13 16733.8,-369.98 16929.57,-330 16972.8,-321.17 17018.85,-304.39 17052.47,-288.56"/>
<polygon fill="black" stroke="black" points="17054.14,-291.64 17061.61,-284.13 17051.08,-285.34 17054.14,-291.64"/>
</g>
<!-- pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15 -->
<g id="edge264" class="edge">
<title>pipeline_stage_0_1&#45;&gt;l8_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M15866.54,-375.34C16154.95,-375.24 16749.55,-370.43 16947.57,-330 16990.62,-321.21 17036.46,-304.54 17068.44,-288.76"/>
<polygon fill="black" stroke="black" points="17070.18,-291.8 17077.49,-284.13 17066.99,-285.57 17070.18,-291.8"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp0_gpu8 -->
<g id="edge274" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M6703.14,-39.62C5962.61,-44.58 1116.3,-77.97 1090.57,-104 1066.82,-128.02 1066.74,-156.06 1090.57,-180 1124.7,-214.3 7883.47,-212.08 8189.01,-216.5"/>
<polygon fill="black" stroke="black" points="8189.25,-220.01 8199.33,-216.76 8189.42,-213.01 8189.25,-220.01"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp1_gpu9 -->
<g id="edge276" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M6702.87,-39.19C5971.91,-40.78 1254.95,-53.03 1204.57,-104 1180.82,-128.02 1180.74,-156.06 1204.57,-180 1244.19,-219.8 9100.07,-211.66 9430.98,-216.5"/>
<polygon fill="black" stroke="black" points="9431.25,-220 9441.33,-216.76 9431.42,-213.01 9431.25,-220"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp2_gpu10 -->
<g id="edge278" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M6702.73,-39.22C5979.58,-40.96 1363.9,-54.08 1314.57,-104 1290.83,-128.03 1290.72,-156.08 1314.57,-180 1344.17,-209.69 13169.89,-212.5 13571.05,-216.57"/>
<polygon fill="black" stroke="black" points="13571.27,-220.07 13581.33,-216.75 13571.4,-213.07 13571.27,-220.07"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp3_gpu11 -->
<g id="edge280" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M6702.89,-39.63C5964.36,-44.63 1154.12,-78.15 1128.57,-104 1104.82,-128.02 1104.74,-156.06 1128.57,-180 1164.53,-216.13 8288.29,-211.94 8602.96,-216.5"/>
<polygon fill="black" stroke="black" points="8603.25,-220.01 8613.33,-216.76 8603.42,-213.01 8603.25,-220.01"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp4_gpu12 -->
<g id="edge282" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M6703.1,-39.62C5959.63,-44.53 1078.48,-77.79 1052.57,-104 1028.82,-128.02 1028.75,-156.05 1052.57,-180 1084.87,-212.48 7479.36,-212.21 7775.09,-216.51"/>
<polygon fill="black" stroke="black" points="7775.25,-220.01 7785.33,-216.76 7775.42,-213.02 7775.25,-220.01"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp5_gpu13 -->
<g id="edge284" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M6703.06,-39.61C5956.69,-44.49 1040.66,-77.61 1014.57,-104 990.82,-128.02 990.75,-156.05 1014.57,-180 1045.04,-210.65 7075.97,-212.34 7361.22,-216.51"/>
<polygon fill="black" stroke="black" points="7361.25,-220.01 7371.33,-216.77 7361.42,-213.02 7361.25,-220.01"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp6_gpu14 -->
<g id="edge286" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M6702.94,-39.64C5967.42,-44.67 1191.94,-78.33 1166.57,-104 1142.82,-128.02 1142.74,-156.06 1166.57,-180 1204.36,-217.97 8693.82,-211.8 9016.95,-216.5"/>
<polygon fill="black" stroke="black" points="9017.25,-220.01 9027.33,-216.76 9017.42,-213.01 9017.25,-220.01"/>
</g>
<!-- l8_allreduce&#45;&gt;l9_attn_tp7_gpu15 -->
<g id="edge288" class="edge">
<title>l8_allreduce&#45;&gt;l9_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M6702.72,-39.21C5976.97,-40.91 1330.23,-53.75 1280.57,-104 1256.82,-128.02 1256.73,-156.07 1280.57,-180 1321.85,-221.45 9508.54,-211.53 9845.08,-216.49"/>
<polygon fill="black" stroke="black" points="9845.24,-220 9855.33,-216.76 9845.43,-213 9845.24,-220"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp0_gpu8 -->
<g id="edge298" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M1315.68,-59.1C1286.47,-65.53 1253.21,-72.01 1222.57,-76 1161.89,-83.91 714.72,-59.65 672.57,-104 649.3,-128.48 648.8,-156 672.57,-180 708.76,-216.54 4240.54,-211.84 4463.12,-216.43"/>
<polygon fill="black" stroke="black" points="4463.22,-219.94 4473.33,-216.78 4463.45,-212.94 4463.22,-219.94"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp1_gpu9 -->
<g id="edge300" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M1315.67,-59.03C1286.46,-65.46 1253.2,-71.95 1222.57,-76 1166.09,-83.47 749.74,-62.63 710.57,-104 687.34,-128.53 686.75,-156.05 710.57,-180 740.5,-210.11 6661.04,-212.37 6946.96,-216.51"/>
<polygon fill="black" stroke="black" points="6947.25,-220.02 6957.33,-216.77 6947.42,-213.02 6947.25,-220.02"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp2_gpu10 -->
<g id="edge302" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M1315.7,-59.25C1286.49,-65.69 1253.22,-72.14 1222.57,-76 1185.94,-80.61 584.12,-77.35 558.57,-104 535.19,-128.38 534.88,-155.93 558.57,-180 601.24,-223.36 2632.66,-211.27 2807.2,-216.35"/>
<polygon fill="black" stroke="black" points="2807.18,-219.85 2817.33,-216.81 2807.5,-212.86 2807.18,-219.85"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp3_gpu11 -->
<g id="edge304" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M1315.7,-59.29C1286.49,-65.73 1253.23,-72.17 1222.57,-76 1183.84,-80.83 547.61,-75.86 520.57,-104 497.16,-128.36 496.98,-155.82 520.57,-180 547.9,-208.02 1844.03,-212.04 1979.28,-216.37"/>
<polygon fill="black" stroke="black" points="1979.17,-219.87 1989.32,-216.84 1979.5,-212.87 1979.17,-219.87"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp4_gpu12 -->
<g id="edge306" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M1315.71,-59.37C1286.5,-65.83 1253.24,-72.25 1222.57,-76 1178.43,-81.4 453.46,-72.01 422.57,-104 399.11,-128.3 400.3,-154.6 422.57,-180 443.88,-204.31 600.83,-222.8 737.28,-234.49"/>
<polygon fill="black" stroke="black" points="737.22,-238 747.48,-235.35 737.81,-231.02 737.22,-238"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp5_gpu13 -->
<g id="edge308" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M1315.71,-59.35C1286.5,-65.81 1253.24,-72.23 1222.57,-76 1179.64,-81.27 474.6,-72.87 444.57,-104 421.12,-128.31 421.3,-155.52 444.57,-180 470.46,-207.24 1055.79,-211.53 1151.08,-216.26"/>
<polygon fill="black" stroke="black" points="1151.1,-219.77 1161.31,-216.95 1151.57,-212.79 1151.1,-219.77"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp6_gpu14 -->
<g id="edge310" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M1315.71,-59.32C1286.5,-65.77 1253.23,-72.21 1222.57,-76 1181.74,-81.05 511.1,-74.36 482.57,-104 459.14,-128.33 459.08,-155.72 482.57,-180 523.03,-221.83 1440.55,-211.07 1565.15,-216.26"/>
<polygon fill="black" stroke="black" points="1565.13,-219.77 1575.32,-216.88 1565.55,-212.78 1565.13,-219.77"/>
</g>
<!-- l9_allreduce&#45;&gt;l10_attn_tp7_gpu15 -->
<g id="edge312" class="edge">
<title>l9_allreduce&#45;&gt;l10_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M1315.69,-59.21C1286.48,-65.64 1253.22,-72.1 1222.57,-76 1188.03,-80.39 620.63,-78.84 596.57,-104 573.22,-128.41 572.83,-155.97 596.57,-180 625.47,-209.24 3440.01,-212.27 3635.33,-216.45"/>
<polygon fill="black" stroke="black" points="3635.21,-219.95 3645.33,-216.79 3635.45,-212.95 3635.21,-219.95"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp0_gpu8 -->
<g id="edge322" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M999.2,-40.06C804.99,-43.22 374.97,-55.65 330.57,-104 307.72,-128.88 306.76,-156.04 330.57,-180 382.19,-231.97 5434.13,-210.71 5705.03,-216.41"/>
<polygon fill="black" stroke="black" points="5705.21,-219.91 5715.33,-216.77 5705.46,-212.92 5705.21,-219.91"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp1_gpu9 -->
<g id="edge324" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M999.09,-39.78C834.31,-44.06 522.13,-66.82 634.57,-180 660.84,-206.45 5852.15,-212.61 6118.98,-216.51"/>
<polygon fill="black" stroke="black" points="6119.25,-220.02 6129.33,-216.77 6119.42,-213.02 6119.25,-220.02"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp2_gpu10 -->
<g id="edge326" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M1000.44,-41.72C847.55,-49.13 570.01,-76.81 672.57,-180 700.68,-208.28 6258.83,-212.5 6533.15,-216.51"/>
<polygon fill="black" stroke="black" points="6533.25,-220.02 6543.33,-216.77 6533.42,-213.02 6533.25,-220.02"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp3_gpu11 -->
<g id="edge328" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M997.88,-38.3C767.79,-37.63 198.23,-42.27 140.57,-104 117.51,-128.68 116.88,-155.93 140.57,-180 183.31,-223.43 2218.35,-211.27 2393.18,-216.35"/>
<polygon fill="black" stroke="black" points="2393.18,-219.85 2403.33,-216.81 2393.5,-212.86 2393.18,-219.85"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp4_gpu12 -->
<g id="edge330" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M999.12,-39.64C797.54,-42 339.62,-52.97 292.57,-104 269.67,-128.83 268.77,-156.03 292.57,-180 340.54,-228.32 5034.5,-210.98 5291.34,-216.42"/>
<polygon fill="black" stroke="black" points="5291.21,-219.92 5301.33,-216.77 5291.46,-212.92 5291.21,-219.92"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp5_gpu13 -->
<g id="edge332" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M998.36,-38.92C782.19,-39.73 268.9,-47.64 216.57,-104 193.58,-128.75 192.8,-156 216.57,-180 253.17,-216.94 3824.06,-211.82 4049.01,-216.43"/>
<polygon fill="black" stroke="black" points="4049.22,-219.94 4059.33,-216.78 4049.45,-212.94 4049.22,-219.94"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp6_gpu14 -->
<g id="edge334" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M998.41,-38.6C775.39,-38.66 233.59,-44.93 178.57,-104 155.55,-128.72 154.83,-155.97 178.57,-180 207.5,-209.28 3025.75,-212.27 3221.32,-216.45"/>
<polygon fill="black" stroke="black" points="3221.22,-219.95 3231.33,-216.79 3221.45,-212.95 3221.22,-219.95"/>
</g>
<!-- l10_allreduce&#45;&gt;l11_attn_tp7_gpu15 -->
<g id="edge336" class="edge">
<title>l10_allreduce&#45;&gt;l11_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M998.6,-39.27C789.57,-40.85 304.25,-50.32 254.57,-104 231.62,-128.79 230.78,-156.02 254.57,-180 298.88,-224.65 4631.27,-211.27 4877.33,-216.42"/>
<polygon fill="black" stroke="black" points="4877.21,-219.92 4887.33,-216.77 4877.46,-212.93 4877.21,-219.92"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp0_gpu8 -->
<g id="edge346" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M1598.27,-61.58C1575.29,-67.21 1550.09,-72.61 1526.57,-76 1494.2,-80.67 961.14,-80.33 938.57,-104 915.26,-128.45 914.72,-156.08 938.57,-180 966.06,-207.58 11945.45,-212.66 12329.19,-216.57"/>
<polygon fill="black" stroke="black" points="12329.27,-220.07 12339.33,-216.75 12329.4,-213.08 12329.27,-220.07"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp1_gpu9 -->
<g id="edge348" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M1597.76,-60.9C1574.88,-66.49 1549.86,-72.04 1526.57,-76 1464.05,-86.64 1285.15,-57.01 1242.57,-104 1219.89,-129.03 1218.72,-156.08 1242.57,-180 1270.33,-207.85 12355.73,-212.64 12743.09,-216.57"/>
<polygon fill="black" stroke="black" points="12743.27,-220.07 12753.33,-216.75 12743.4,-213.08 12743.27,-220.07"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp2_gpu10 -->
<g id="edge350" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M1597.31,-60.68C1574.54,-66.24 1549.69,-71.82 1526.57,-76 1475.03,-85.32 1327.33,-64.83 1292.57,-104 1270.15,-129.26 1268.72,-156.08 1292.57,-180 1321.22,-208.74 12763.1,-212.57 13157.08,-216.57"/>
<polygon fill="black" stroke="black" points="13157.27,-220.07 13167.33,-216.75 13157.4,-213.07 13157.27,-220.07"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp3_gpu11 -->
<g id="edge352" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M1598.3,-61.76C1575.31,-67.39 1550.11,-72.75 1526.57,-76 1483.73,-81.92 778.6,-72.87 748.57,-104 725.12,-128.31 724.73,-156.07 748.57,-180 794.46,-226.07 9903.28,-211.15 10259.08,-216.49"/>
<polygon fill="black" stroke="black" points="10259.24,-219.99 10269.33,-216.76 10259.43,-213 10259.24,-219.99"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp4_gpu12 -->
<g id="edge354" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M1598.29,-61.73C1575.31,-67.36 1550.11,-72.72 1526.57,-76 1485.82,-81.67 815.1,-74.36 786.57,-104 763.14,-128.33 762.73,-156.07 786.57,-180 834.3,-227.91 10312.55,-210.99 10673.23,-216.49"/>
<polygon fill="black" stroke="black" points="10673.24,-219.99 10683.33,-216.76 10673.43,-212.99 10673.24,-219.99"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp5_gpu13 -->
<g id="edge356" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M1598.29,-61.7C1575.31,-67.33 1550.1,-72.7 1526.57,-76 1487.92,-81.42 851.61,-75.86 824.57,-104 801.16,-128.36 800.73,-156.07 824.57,-180 874.13,-229.74 10717.66,-210.83 11087.14,-216.48"/>
<polygon fill="black" stroke="black" points="11087.24,-219.99 11097.33,-216.76 11087.43,-212.99 11087.24,-219.99"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp6_gpu14 -->
<g id="edge358" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M1598.28,-61.66C1575.3,-67.3 1550.1,-72.67 1526.57,-76 1490.01,-81.17 888.12,-77.35 862.57,-104 839.19,-128.38 838.72,-156.08 862.57,-180 913.96,-231.57 11123.13,-210.68 11501.06,-216.48"/>
<polygon fill="black" stroke="black" points="11501.24,-219.99 11511.33,-216.76 11501.43,-212.99 11501.24,-219.99"/>
</g>
<!-- l11_allreduce&#45;&gt;l12_attn_tp7_gpu15 -->
<g id="edge360" class="edge">
<title>l11_allreduce&#45;&gt;l12_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M1598.28,-61.62C1575.3,-67.26 1550.09,-72.64 1526.57,-76 1492.1,-80.92 924.63,-78.84 900.57,-104 877.22,-128.41 876.72,-156.08 900.57,-180 927.15,-206.67 11538.89,-212.73 11915.23,-216.57"/>
<polygon fill="black" stroke="black" points="11915.27,-220.07 11925.33,-216.76 11915.4,-213.08 11915.27,-220.07"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp0_gpu8 -->
<g id="edge370" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M23689.6,-39.74C24278.37,-44.36 27348.21,-70.07 27381.57,-104 27405.25,-128.09 27405.36,-156.02 27381.57,-180 27336.52,-225.4 22931.99,-211.21 22681.97,-216.42"/>
<polygon fill="black" stroke="black" points="22681.68,-212.93 22671.81,-216.77 22681.92,-219.92 22681.68,-212.93"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp1_gpu9 -->
<g id="edge372" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M23689.61,-39.71C24285.36,-44.18 27423.5,-69.35 27457.57,-104 27481.25,-128.08 27481.33,-155.99 27457.57,-180 27423.87,-214.04 24137.99,-212 23924,-216.44"/>
<polygon fill="black" stroke="black" points="23923.68,-212.95 23913.81,-216.78 23923.92,-219.94 23923.68,-212.95"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp2_gpu10 -->
<g id="edge374" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M23689.19,-39.7C24285.9,-44.12 27445.29,-69.14 27479.57,-104 27503.25,-128.08 27503.29,-155.96 27479.57,-180 27453.7,-206.22 24937.14,-212.41 24751.94,-216.45"/>
<polygon fill="black" stroke="black" points="24751.68,-212.95 24741.81,-216.8 24751.92,-219.95 24751.68,-212.95"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp3_gpu11 -->
<g id="edge376" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M23688.61,-38.87C24258.24,-38.35 27170.6,-38.88 27234.57,-104 27258.24,-128.1 27258.39,-156.05 27234.57,-180 27202.75,-211.99 20903.35,-212.25 20611.9,-216.51"/>
<polygon fill="black" stroke="black" points="20611.71,-213.01 20601.81,-216.76 20611.89,-220.01 20611.71,-213.01"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp4_gpu12 -->
<g id="edge378" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M23689.57,-39.76C24274.78,-44.46 27310.57,-70.42 27343.57,-104 27367.24,-128.09 27367.37,-156.04 27343.57,-180 27317.27,-206.47 22121.23,-212.6 21854.16,-216.51"/>
<polygon fill="black" stroke="black" points="21853.72,-213.02 21843.81,-216.77 21853.89,-220.02 21853.72,-213.02"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp5_gpu13 -->
<g id="edge380" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M23689.02,-38.86C24262.68,-38.24 27203,-38.28 27267.57,-104 27291.24,-128.09 27291.38,-156.05 27267.57,-180 27237.61,-210.13 21312.33,-212.37 21026.18,-216.51"/>
<polygon fill="black" stroke="black" points="21025.72,-213.02 21015.81,-216.77 21025.89,-220.02 21025.72,-213.02"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp6_gpu14 -->
<g id="edge382" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M23689.61,-39.73C24281.9,-44.27 27385.86,-69.71 27419.57,-104 27443.25,-128.09 27443.35,-156.02 27419.57,-180 27378.18,-221.74 23333.95,-211.48 23095.9,-216.43"/>
<polygon fill="black" stroke="black" points="23095.68,-212.93 23085.81,-216.78 23095.92,-219.93 23095.68,-212.93"/>
</g>
<!-- l12_allreduce&#45;&gt;l13_attn_tp7_gpu15 -->
<g id="edge384" class="edge">
<title>l12_allreduce&#45;&gt;l13_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M23689.53,-39.78C24271.12,-44.55 27272.92,-70.78 27305.57,-104 27329.24,-128.09 27329.38,-156.04 27305.57,-180 27277.44,-208.31 21714.54,-212.49 21440,-216.51"/>
<polygon fill="black" stroke="black" points="21439.72,-213.02 21429.81,-216.77 21439.89,-220.02 21439.72,-213.02"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp0_gpu8 -->
<g id="edge394" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M27789.56,-44.49C27878.1,-51.68 27997.79,-67.95 28027.57,-104 28049.08,-130.04 28051.19,-155.85 28027.57,-180 27997.12,-211.13 26552.33,-211.93 26407.97,-216.36"/>
<polygon fill="black" stroke="black" points="26407.64,-212.87 26397.81,-216.83 26407.96,-219.87 26407.64,-212.87"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp1_gpu9 -->
<g id="edge396" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M27787.7,-42.1C27886.99,-47.55 28030.69,-62.57 28065.57,-104 28087.32,-129.84 28089.1,-155.77 28065.57,-180 28018.86,-228.08 26958.9,-210.73 26822.1,-216.25"/>
<polygon fill="black" stroke="black" points="26821.59,-212.78 26811.81,-216.86 26822,-219.76 26821.59,-212.78"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp2_gpu10 -->
<g id="edge398" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M27787.48,-41.77C27938.21,-49.27 28200.12,-77.06 28103.57,-180 28074.37,-211.13 27540.38,-232.93 27235.86,-242.89"/>
<polygon fill="black" stroke="black" points="27235.46,-239.4 27225.58,-243.23 27235.69,-246.4 27235.46,-239.4"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp3_gpu11 -->
<g id="edge400" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M27774.54,-76.07C27784.53,-83.87 27793.36,-93.11 27799.57,-104 27816.31,-133.34 27823.35,-156.02 27799.57,-180 27758.5,-221.41 23746.07,-211.5 23509.82,-216.43"/>
<polygon fill="black" stroke="black" points="23509.68,-212.93 23499.81,-216.78 23509.92,-219.93 23509.68,-212.93"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp4_gpu12 -->
<g id="edge402" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M27809.67,-75.91C27820.6,-83.58 27830.28,-92.84 27837.57,-104 27856.04,-132.28 27861.33,-155.99 27837.57,-180 27804.2,-213.72 24549.92,-212.02 24337.91,-216.44"/>
<polygon fill="black" stroke="black" points="24337.68,-212.95 24327.81,-216.78 24337.92,-219.94 24337.68,-212.95"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp5_gpu13 -->
<g id="edge404" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M27654.83,-76C27619.88,-110.32 27562.56,-159.15 27501.57,-180 27381.04,-221.21 25372.62,-205.39 25165.79,-216.15"/>
<polygon fill="black" stroke="black" points="25165.56,-212.66 25155.81,-216.8 25166.02,-219.64 25165.56,-212.66"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp6_gpu14 -->
<g id="edge406" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M27793.95,-51.69C27858.15,-61.88 27931.79,-78.71 27951.57,-104 27972.38,-130.61 27975.27,-155.94 27951.57,-180 27906.5,-225.75 25759.79,-211.12 25579.9,-216.34"/>
<polygon fill="black" stroke="black" points="25579.64,-212.85 25569.81,-216.8 25579.96,-219.84 25579.64,-212.85"/>
</g>
<!-- l13_allreduce&#45;&gt;l14_attn_tp7_gpu15 -->
<g id="edge408" class="edge">
<title>l13_allreduce&#45;&gt;l14_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M27791.48,-47.56C27868.41,-56.38 27964.81,-73.3 27989.57,-104 28010.77,-130.29 28013.24,-155.9 27989.57,-180 27951.83,-218.42 26157.73,-211.58 25994.08,-216.35"/>
<polygon fill="black" stroke="black" points="25993.64,-212.87 25983.81,-216.82 25993.96,-219.86 25993.64,-212.87"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp0_gpu8 -->
<g id="edge418" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp0_gpu8</title>
<path fill="none" stroke="black" d="M27265.14,-45.55C27399.27,-55.33 27622.8,-75.68 27647.57,-104 27669.8,-129.43 27671.4,-156.06 27647.57,-180 27607.7,-220.05 19703.12,-211.64 19370.22,-216.49"/>
<polygon fill="black" stroke="black" points="19369.71,-213.01 19359.8,-216.76 19369.89,-220 19369.71,-213.01"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp1_gpu9 -->
<g id="edge420" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp1_gpu9</title>
<path fill="none" stroke="black" d="M27267.33,-49.21C27426.69,-65.29 27716.05,-95.55 27723.57,-104 27746.03,-129.23 27747.4,-156.06 27723.57,-180 27687.36,-216.38 20515.01,-211.93 20198.24,-216.5"/>
<polygon fill="black" stroke="black" points="20197.71,-213.01 20187.8,-216.76 20197.89,-220.01 20197.71,-213.01"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp2_gpu10 -->
<g id="edge422" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp2_gpu10</title>
<path fill="none" stroke="black" d="M27266.83,-48.39C27435.26,-64.1 27753.39,-94.88 27761.57,-104 27784.12,-129.14 27785.37,-156.04 27761.57,-180 27735.25,-206.49 22535.43,-212.6 22268.17,-216.51"/>
<polygon fill="black" stroke="black" points="22267.72,-213.02 22257.81,-216.77 22267.89,-220.02 22267.72,-213.02"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp3_gpu11 -->
<g id="edge424" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp3_gpu11</title>
<path fill="none" stroke="black" d="M27261.95,-40.61C27423.2,-46.3 27717.72,-71.4 27609.57,-180 27567.85,-221.89 19292,-211.49 18955.91,-216.5"/>
<polygon fill="black" stroke="black" points="18955.71,-213 18945.8,-216.76 18955.89,-220 18955.71,-213"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp4_gpu12 -->
<g id="edge426" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp4_gpu12</title>
<path fill="none" stroke="black" d="M27263.13,-42.5C27360.5,-48.28 27499.64,-63.58 27533.57,-104 27555.28,-129.87 27557.41,-156.07 27533.57,-180 27488.18,-225.56 18479.92,-211.19 18127.95,-216.49"/>
<polygon fill="black" stroke="black" points="18127.71,-212.99 18117.8,-216.76 18127.89,-219.99 18127.71,-212.99"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp5_gpu13 -->
<g id="edge428" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp5_gpu13</title>
<path fill="none" stroke="black" d="M27215.43,-76.32C27223.22,-84.51 27230.13,-93.81 27234.57,-104 27248.07,-134.96 27258.41,-156.07 27234.57,-180 27188.62,-226.13 18065.71,-211.14 17713.81,-216.49"/>
<polygon fill="black" stroke="black" points="17713.71,-212.99 17703.8,-216.76 17713.89,-219.99 17713.71,-212.99"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp6_gpu14 -->
<g id="edge430" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp6_gpu14</title>
<path fill="none" stroke="black" d="M27266.86,-48.29C27414.66,-62.2 27671.85,-88.47 27685.57,-104 27707.93,-129.32 27709.4,-156.06 27685.57,-180 27647.53,-218.21 20109.42,-211.79 19784.25,-216.5"/>
<polygon fill="black" stroke="black" points="19783.71,-213.01 19773.8,-216.76 19783.89,-220.01 19783.71,-213.01"/>
</g>
<!-- l14_allreduce&#45;&gt;l15_attn_tp7_gpu15 -->
<g id="edge432" class="edge">
<title>l14_allreduce&#45;&gt;l15_attn_tp7_gpu15</title>
<path fill="none" stroke="black" d="M27261.96,-40.55C27369.47,-44.57 27532.56,-58.27 27571.57,-104 27593.49,-129.7 27595.4,-156.07 27571.57,-180 27528.01,-223.73 18884.08,-211.34 18541.82,-216.49"/>
<polygon fill="black" stroke="black" points="18541.71,-213 18531.8,-216.76 18541.89,-219.99 18541.71,-213"/>
</g>
</g>
</svg>
