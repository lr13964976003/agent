// Two-Level Attention Partitioning on 16 GPUs
digraph Helix_Proposed_Method {
	rankdir=TB size="20,20"
	node [fontsize=10]
	input [label="Input\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, hidden=4096]" fillcolor=lightblue shape=ellipse style=filled]
	device_0_q_proj [label="Q Projection 0\nW_Q[0,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_0_k_proj [label="K Projection 0\nW_K[0,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_0_v_proj [label="V Projection 0\nW_V[0,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_0_attn [label="Attention 0\nHeadGroup=0, Slice=0\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_0_q_proj -> device_0_attn
	device_0_k_proj -> device_0_attn
	device_0_v_proj -> device_0_attn
	input -> device_0_q_proj
	input -> device_0_k_proj
	input -> device_0_v_proj
	device_1_q_proj [label="Q Projection 1\nW_Q[0,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_1_k_proj [label="K Projection 1\nW_K[0,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_1_v_proj [label="V Projection 1\nW_V[0,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_1_attn [label="Attention 1\nHeadGroup=0, Slice=1\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_1_q_proj -> device_1_attn
	device_1_k_proj -> device_1_attn
	device_1_v_proj -> device_1_attn
	input -> device_1_q_proj
	input -> device_1_k_proj
	input -> device_1_v_proj
	device_2_q_proj [label="Q Projection 2\nW_Q[0,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_2_k_proj [label="K Projection 2\nW_K[0,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_2_v_proj [label="V Projection 2\nW_V[0,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_2_attn [label="Attention 2\nHeadGroup=0, Slice=2\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_2_q_proj -> device_2_attn
	device_2_k_proj -> device_2_attn
	device_2_v_proj -> device_2_attn
	input -> device_2_q_proj
	input -> device_2_k_proj
	input -> device_2_v_proj
	device_3_q_proj [label="Q Projection 3\nW_Q[0,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_3_k_proj [label="K Projection 3\nW_K[0,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_3_v_proj [label="V Projection 3\nW_V[0,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_3_attn [label="Attention 3\nHeadGroup=0, Slice=3\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_3_q_proj -> device_3_attn
	device_3_k_proj -> device_3_attn
	device_3_v_proj -> device_3_attn
	input -> device_3_q_proj
	input -> device_3_k_proj
	input -> device_3_v_proj
	device_4_q_proj [label="Q Projection 4\nW_Q[1,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_4_k_proj [label="K Projection 4\nW_K[1,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_4_v_proj [label="V Projection 4\nW_V[1,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_4_attn [label="Attention 4\nHeadGroup=1, Slice=0\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_4_q_proj -> device_4_attn
	device_4_k_proj -> device_4_attn
	device_4_v_proj -> device_4_attn
	input -> device_4_q_proj
	input -> device_4_k_proj
	input -> device_4_v_proj
	device_5_q_proj [label="Q Projection 5\nW_Q[1,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_5_k_proj [label="K Projection 5\nW_K[1,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_5_v_proj [label="V Projection 5\nW_V[1,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_5_attn [label="Attention 5\nHeadGroup=1, Slice=1\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_5_q_proj -> device_5_attn
	device_5_k_proj -> device_5_attn
	device_5_v_proj -> device_5_attn
	input -> device_5_q_proj
	input -> device_5_k_proj
	input -> device_5_v_proj
	device_6_q_proj [label="Q Projection 6\nW_Q[1,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_6_k_proj [label="K Projection 6\nW_K[1,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_6_v_proj [label="V Projection 6\nW_V[1,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_6_attn [label="Attention 6\nHeadGroup=1, Slice=2\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_6_q_proj -> device_6_attn
	device_6_k_proj -> device_6_attn
	device_6_v_proj -> device_6_attn
	input -> device_6_q_proj
	input -> device_6_k_proj
	input -> device_6_v_proj
	device_7_q_proj [label="Q Projection 7\nW_Q[1,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_7_k_proj [label="K Projection 7\nW_K[1,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_7_v_proj [label="V Projection 7\nW_V[1,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_7_attn [label="Attention 7\nHeadGroup=1, Slice=3\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_7_q_proj -> device_7_attn
	device_7_k_proj -> device_7_attn
	device_7_v_proj -> device_7_attn
	input -> device_7_q_proj
	input -> device_7_k_proj
	input -> device_7_v_proj
	device_8_q_proj [label="Q Projection 8\nW_Q[2,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_8_k_proj [label="K Projection 8\nW_K[2,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_8_v_proj [label="V Projection 8\nW_V[2,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_8_attn [label="Attention 8\nHeadGroup=2, Slice=0\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_8_q_proj -> device_8_attn
	device_8_k_proj -> device_8_attn
	device_8_v_proj -> device_8_attn
	input -> device_8_q_proj
	input -> device_8_k_proj
	input -> device_8_v_proj
	device_9_q_proj [label="Q Projection 9\nW_Q[2,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_9_k_proj [label="K Projection 9\nW_K[2,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_9_v_proj [label="V Projection 9\nW_V[2,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_9_attn [label="Attention 9\nHeadGroup=2, Slice=1\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_9_q_proj -> device_9_attn
	device_9_k_proj -> device_9_attn
	device_9_v_proj -> device_9_attn
	input -> device_9_q_proj
	input -> device_9_k_proj
	input -> device_9_v_proj
	device_10_q_proj [label="Q Projection 10\nW_Q[2,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_10_k_proj [label="K Projection 10\nW_K[2,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_10_v_proj [label="V Projection 10\nW_V[2,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_10_attn [label="Attention 10\nHeadGroup=2, Slice=2\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_10_q_proj -> device_10_attn
	device_10_k_proj -> device_10_attn
	device_10_v_proj -> device_10_attn
	input -> device_10_q_proj
	input -> device_10_k_proj
	input -> device_10_v_proj
	device_11_q_proj [label="Q Projection 11\nW_Q[2,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_11_k_proj [label="K Projection 11\nW_K[2,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_11_v_proj [label="V Projection 11\nW_V[2,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_11_attn [label="Attention 11\nHeadGroup=2, Slice=3\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_11_q_proj -> device_11_attn
	device_11_k_proj -> device_11_attn
	device_11_v_proj -> device_11_attn
	input -> device_11_q_proj
	input -> device_11_k_proj
	input -> device_11_v_proj
	device_12_q_proj [label="Q Projection 12\nW_Q[3,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_12_k_proj [label="K Projection 12\nW_K[3,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_12_v_proj [label="V Projection 12\nW_V[3,0]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_12_attn [label="Attention 12\nHeadGroup=3, Slice=0\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_12_q_proj -> device_12_attn
	device_12_k_proj -> device_12_attn
	device_12_v_proj -> device_12_attn
	input -> device_12_q_proj
	input -> device_12_k_proj
	input -> device_12_v_proj
	device_13_q_proj [label="Q Projection 13\nW_Q[3,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_13_k_proj [label="K Projection 13\nW_K[3,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_13_v_proj [label="V Projection 13\nW_V[3,1]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_13_attn [label="Attention 13\nHeadGroup=3, Slice=1\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_13_q_proj -> device_13_attn
	device_13_k_proj -> device_13_attn
	device_13_v_proj -> device_13_attn
	input -> device_13_q_proj
	input -> device_13_k_proj
	input -> device_13_v_proj
	device_14_q_proj [label="Q Projection 14\nW_Q[3,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_14_k_proj [label="K Projection 14\nW_K[3,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_14_v_proj [label="V Projection 14\nW_V[3,2]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_14_attn [label="Attention 14\nHeadGroup=3, Slice=2\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_14_q_proj -> device_14_attn
	device_14_k_proj -> device_14_attn
	device_14_v_proj -> device_14_attn
	input -> device_14_q_proj
	input -> device_14_k_proj
	input -> device_14_v_proj
	device_15_q_proj [label="Q Projection 15\nW_Q[3,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_15_k_proj [label="K Projection 15\nW_K[3,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_15_v_proj [label="V Projection 15\nW_V[3,3]\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightyellow shape=rectangle style=filled]
	device_15_attn [label="Attention 15\nHeadGroup=3, Slice=3\nsoftmax(QK^T/√32)V\nInput: [batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, slice=256]" fillcolor=lightgreen shape=rectangle style=filled]
	device_15_q_proj -> device_15_attn
	device_15_k_proj -> device_15_attn
	device_15_v_proj -> device_15_attn
	input -> device_15_q_proj
	input -> device_15_k_proj
	input -> device_15_v_proj
	group_0_concat [label="Group 0 Concat\nIntra-group reduction\nInput: 4×[batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, group=1024]" fillcolor=orange shape=parallelogram style=filled]
	device_0_attn -> group_0_concat
	device_1_attn -> group_0_concat
	device_2_attn -> group_0_concat
	device_3_attn -> group_0_concat
	group_1_concat [label="Group 1 Concat\nIntra-group reduction\nInput: 4×[batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, group=1024]" fillcolor=orange shape=parallelogram style=filled]
	device_4_attn -> group_1_concat
	device_5_attn -> group_1_concat
	device_6_attn -> group_1_concat
	device_7_attn -> group_1_concat
	group_2_concat [label="Group 2 Concat\nIntra-group reduction\nInput: 4×[batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, group=1024]" fillcolor=orange shape=parallelogram style=filled]
	device_8_attn -> group_2_concat
	device_9_attn -> group_2_concat
	device_10_attn -> group_2_concat
	device_11_attn -> group_2_concat
	group_3_concat [label="Group 3 Concat\nIntra-group reduction\nInput: 4×[batch=128, seq_len=10000, slice=256]\nOutput: [batch=128, seq_len=10000, group=1024]" fillcolor=orange shape=parallelogram style=filled]
	device_12_attn -> group_3_concat
	device_13_attn -> group_3_concat
	device_14_attn -> group_3_concat
	device_15_attn -> group_3_concat
	final_concat [label="Final Concat\nInter-group concatenation\nInput: 4×[batch=128, seq_len=10000, group=1024]\nOutput: [batch=128, seq_len=10000, hidden=4096]" fillcolor=orange shape=parallelogram style=filled]
	group_0_concat -> final_concat
	group_1_concat -> final_concat
	group_2_concat -> final_concat
	group_3_concat -> final_concat
	output [label="Output\nFinal Output\nInput: [batch=128, seq_len=10000, hidden=4096]\nOutput: [batch=128, seq_len=10000, hidden=4096]" fillcolor=lightblue shape=ellipse style=filled]
	final_concat -> output
}
