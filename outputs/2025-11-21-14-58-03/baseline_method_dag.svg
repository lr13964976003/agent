<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_Baseline_Method Pages: 1 -->
<svg width="1440pt" height="350pt"
 viewBox="0.00 0.00 1440.00 349.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.2 0.2) rotate(0) translate(4 1707.52)">
<title>Helix_Baseline_Method</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1707.52 7043,-1707.52 7043,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="3592" cy="-1674.53" rx="196.65" ry="28.98"/>
<text text-anchor="middle" x="3592" y="-1683.03" font-family="Times,serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="3592" y="-1672.03" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3592" y="-1661.03" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- s0_tp0_q_proj -->
<g id="node3" class="node">
<title>s0_tp0_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="415,-1609.54 145,-1609.54 145,-1546.54 415,-1546.54 415,-1609.54"/>
<text text-anchor="middle" x="280" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP0</text>
<text text-anchor="middle" x="280" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="280" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="280" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="280" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp0_q_proj -->
<g id="edge7" class="edge">
<title>input&#45;&gt;s0_tp0_q_proj</title>
<path fill="none" stroke="black" d="M3396.29,-1671.73C2758.35,-1665.55 761.2,-1643.77 425.51,-1609.56"/>
<polygon fill="black" stroke="black" points="425.48,-1606.04 415.16,-1608.44 424.73,-1613 425.48,-1606.04"/>
</g>
<!-- s0_tp0_k_proj -->
<g id="node4" class="node">
<title>s0_tp0_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="703,-1609.54 433,-1609.54 433,-1546.54 703,-1546.54 703,-1609.54"/>
<text text-anchor="middle" x="568" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP0</text>
<text text-anchor="middle" x="568" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="568" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="568" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="568" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp0_k_proj -->
<g id="edge8" class="edge">
<title>input&#45;&gt;s0_tp0_k_proj</title>
<path fill="none" stroke="black" d="M3395.23,-1673.94C2837.67,-1674.33 1253.37,-1670.03 713.39,-1609.6"/>
<polygon fill="black" stroke="black" points="713.5,-1606.09 703.17,-1608.43 712.71,-1613.04 713.5,-1606.09"/>
</g>
<!-- s0_tp0_v_proj -->
<g id="node5" class="node">
<title>s0_tp0_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="991,-1609.54 721,-1609.54 721,-1546.54 991,-1546.54 991,-1609.54"/>
<text text-anchor="middle" x="856" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP0</text>
<text text-anchor="middle" x="856" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="856" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="856" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="856" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp0_v_proj -->
<g id="edge9" class="edge">
<title>input&#45;&gt;s0_tp0_v_proj</title>
<path fill="none" stroke="black" d="M3395.27,-1673.36C2877.24,-1672.16 1482.93,-1663.94 1001.33,-1609.59"/>
<polygon fill="black" stroke="black" points="1001.5,-1606.09 991.17,-1608.42 1000.7,-1613.04 1001.5,-1606.09"/>
</g>
<!-- s0_tp1_q_proj -->
<g id="node10" class="node">
<title>s0_tp1_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="1279,-1609.54 1009,-1609.54 1009,-1546.54 1279,-1546.54 1279,-1609.54"/>
<text text-anchor="middle" x="1144" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP1</text>
<text text-anchor="middle" x="1144" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1144" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1144" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1144" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp1_q_proj -->
<g id="edge16" class="edge">
<title>input&#45;&gt;s0_tp1_q_proj</title>
<path fill="none" stroke="black" d="M3395.6,-1672.64C2919.58,-1669.76 1712.96,-1657.88 1289.33,-1609.6"/>
<polygon fill="black" stroke="black" points="1289.51,-1606.09 1279.17,-1608.41 1288.7,-1613.04 1289.51,-1606.09"/>
</g>
<!-- s0_tp1_k_proj -->
<g id="node11" class="node">
<title>s0_tp1_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="1567,-1609.54 1297,-1609.54 1297,-1546.54 1567,-1546.54 1567,-1609.54"/>
<text text-anchor="middle" x="1432" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP1</text>
<text text-anchor="middle" x="1432" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1432" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1432" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1432" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp1_k_proj -->
<g id="edge17" class="edge">
<title>input&#45;&gt;s0_tp1_k_proj</title>
<path fill="none" stroke="black" d="M3396.34,-1671.73C2965.19,-1667.05 1943.27,-1651.88 1577.28,-1609.59"/>
<polygon fill="black" stroke="black" points="1577.51,-1606.09 1567.17,-1608.4 1576.69,-1613.05 1577.51,-1606.09"/>
</g>
<!-- s0_tp1_v_proj -->
<g id="node12" class="node">
<title>s0_tp1_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="1855,-1609.54 1585,-1609.54 1585,-1546.54 1855,-1546.54 1855,-1609.54"/>
<text text-anchor="middle" x="1720" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP1</text>
<text text-anchor="middle" x="1720" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1720" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1720" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1720" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp1_v_proj -->
<g id="edge18" class="edge">
<title>input&#45;&gt;s0_tp1_v_proj</title>
<path fill="none" stroke="black" d="M3397.25,-1670.53C3014.31,-1663.94 2174.47,-1645.93 1865.49,-1609.62"/>
<polygon fill="black" stroke="black" points="1865.52,-1606.1 1855.17,-1608.37 1864.68,-1613.05 1865.52,-1606.1"/>
</g>
<!-- s0_tp2_q_proj -->
<g id="node17" class="node">
<title>s0_tp2_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="2143,-1609.54 1873,-1609.54 1873,-1546.54 2143,-1546.54 2143,-1609.54"/>
<text text-anchor="middle" x="2008" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP2</text>
<text text-anchor="middle" x="2008" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2008" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2008" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2008" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp2_q_proj -->
<g id="edge25" class="edge">
<title>input&#45;&gt;s0_tp2_q_proj</title>
<path fill="none" stroke="black" d="M3398.92,-1668.89C3068.27,-1660.29 2405.72,-1640.04 2153.43,-1609.62"/>
<polygon fill="black" stroke="black" points="2153.53,-1606.1 2143.18,-1608.34 2152.67,-1613.05 2153.53,-1606.1"/>
</g>
<!-- s0_tp2_k_proj -->
<g id="node18" class="node">
<title>s0_tp2_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="2431,-1609.54 2161,-1609.54 2161,-1546.54 2431,-1546.54 2431,-1609.54"/>
<text text-anchor="middle" x="2296" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP2</text>
<text text-anchor="middle" x="2296" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2296" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2296" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2296" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp2_k_proj -->
<g id="edge26" class="edge">
<title>input&#45;&gt;s0_tp2_k_proj</title>
<path fill="none" stroke="black" d="M3396.23,-1671.77C3168.59,-1667.64 2781.61,-1654.18 2441.24,-1609.63"/>
<polygon fill="black" stroke="black" points="2441.55,-1606.14 2431.18,-1608.3 2440.64,-1613.08 2441.55,-1606.14"/>
</g>
<!-- s0_tp2_v_proj -->
<g id="node19" class="node">
<title>s0_tp2_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="2719,-1609.54 2449,-1609.54 2449,-1546.54 2719,-1546.54 2719,-1609.54"/>
<text text-anchor="middle" x="2584" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP2</text>
<text text-anchor="middle" x="2584" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2584" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2584" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2584" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp2_v_proj -->
<g id="edge27" class="edge">
<title>input&#45;&gt;s0_tp2_v_proj</title>
<path fill="none" stroke="black" d="M3402.44,-1666.84C3229.35,-1659.02 2966.39,-1642.84 2729.39,-1609.67"/>
<polygon fill="black" stroke="black" points="2729.58,-1606.16 2719.19,-1608.23 2728.6,-1613.09 2729.58,-1606.16"/>
</g>
<!-- s0_tp3_q_proj -->
<g id="node24" class="node">
<title>s0_tp3_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="3007,-1609.54 2737,-1609.54 2737,-1546.54 3007,-1546.54 3007,-1609.54"/>
<text text-anchor="middle" x="2872" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP3</text>
<text text-anchor="middle" x="2872" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2872" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2872" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2872" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp3_q_proj -->
<g id="edge34" class="edge">
<title>input&#45;&gt;s0_tp3_q_proj</title>
<path fill="none" stroke="black" d="M3424.43,-1659.29C3311.89,-1648.68 3160.14,-1632.36 3017.47,-1609.72"/>
<polygon fill="black" stroke="black" points="3017.64,-1606.21 3007.21,-1608.08 3016.54,-1613.12 3017.64,-1606.21"/>
</g>
<!-- s0_tp3_k_proj -->
<g id="node25" class="node">
<title>s0_tp3_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="3295,-1609.54 3025,-1609.54 3025,-1546.54 3295,-1546.54 3295,-1609.54"/>
<text text-anchor="middle" x="3160" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP3</text>
<text text-anchor="middle" x="3160" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3160" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3160" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3160" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp3_k_proj -->
<g id="edge35" class="edge">
<title>input&#45;&gt;s0_tp3_k_proj</title>
<path fill="none" stroke="black" d="M3485.21,-1650.17C3431.01,-1638.32 3364.35,-1623.74 3305.52,-1610.87"/>
<polygon fill="black" stroke="black" points="3305.91,-1607.37 3295.39,-1608.65 3304.41,-1614.21 3305.91,-1607.37"/>
</g>
<!-- s0_tp3_v_proj -->
<g id="node26" class="node">
<title>s0_tp3_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="3583,-1609.54 3313,-1609.54 3313,-1546.54 3583,-1546.54 3583,-1609.54"/>
<text text-anchor="middle" x="3448" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP3</text>
<text text-anchor="middle" x="3448" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3448" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3448" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3448" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp3_v_proj -->
<g id="edge36" class="edge">
<title>input&#45;&gt;s0_tp3_v_proj</title>
<path fill="none" stroke="black" d="M3549.96,-1645.95C3535.32,-1636.34 3518.67,-1625.41 3503.13,-1615.22"/>
<polygon fill="black" stroke="black" points="3504.91,-1612.2 3494.63,-1609.64 3501.07,-1618.05 3504.91,-1612.2"/>
</g>
<!-- s0_tp4_q_proj -->
<g id="node31" class="node">
<title>s0_tp4_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="3871,-1609.54 3601,-1609.54 3601,-1546.54 3871,-1546.54 3871,-1609.54"/>
<text text-anchor="middle" x="3736" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP4</text>
<text text-anchor="middle" x="3736" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3736" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3736" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3736" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp4_q_proj -->
<g id="edge43" class="edge">
<title>input&#45;&gt;s0_tp4_q_proj</title>
<path fill="none" stroke="black" d="M3634.04,-1645.95C3648.68,-1636.34 3665.33,-1625.41 3680.87,-1615.22"/>
<polygon fill="black" stroke="black" points="3682.93,-1618.05 3689.37,-1609.64 3679.09,-1612.2 3682.93,-1618.05"/>
</g>
<!-- s0_tp4_k_proj -->
<g id="node32" class="node">
<title>s0_tp4_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="4159,-1609.54 3889,-1609.54 3889,-1546.54 4159,-1546.54 4159,-1609.54"/>
<text text-anchor="middle" x="4024" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP4</text>
<text text-anchor="middle" x="4024" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="4024" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4024" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4024" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp4_k_proj -->
<g id="edge44" class="edge">
<title>input&#45;&gt;s0_tp4_k_proj</title>
<path fill="none" stroke="black" d="M3698.79,-1650.17C3752.99,-1638.32 3819.65,-1623.74 3878.48,-1610.87"/>
<polygon fill="black" stroke="black" points="3879.59,-1614.21 3888.61,-1608.65 3878.09,-1607.37 3879.59,-1614.21"/>
</g>
<!-- s0_tp4_v_proj -->
<g id="node33" class="node">
<title>s0_tp4_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="4447,-1609.54 4177,-1609.54 4177,-1546.54 4447,-1546.54 4447,-1609.54"/>
<text text-anchor="middle" x="4312" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP4</text>
<text text-anchor="middle" x="4312" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="4312" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4312" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4312" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp4_v_proj -->
<g id="edge45" class="edge">
<title>input&#45;&gt;s0_tp4_v_proj</title>
<path fill="none" stroke="black" d="M3730.7,-1653.95C3753.18,-1650.99 3776.22,-1648.08 3798,-1645.54 3958.9,-1626.79 4003,-1634.38 4166.86,-1609.65"/>
<polygon fill="black" stroke="black" points="4167.44,-1613.1 4176.79,-1608.14 4166.38,-1606.18 4167.44,-1613.1"/>
</g>
<!-- s0_tp5_q_proj -->
<g id="node38" class="node">
<title>s0_tp5_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="4735,-1609.54 4465,-1609.54 4465,-1546.54 4735,-1546.54 4735,-1609.54"/>
<text text-anchor="middle" x="4600" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP5</text>
<text text-anchor="middle" x="4600" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4600" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4600" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4600" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp5_q_proj -->
<g id="edge52" class="edge">
<title>input&#45;&gt;s0_tp5_q_proj</title>
<path fill="none" stroke="black" d="M3727.56,-1653.53C3751.01,-1650.53 3775.18,-1647.71 3798,-1645.54 4086.29,-1618.11 4163.92,-1647.33 4454.82,-1609.62"/>
<polygon fill="black" stroke="black" points="4455.36,-1613.07 4464.82,-1608.3 4454.45,-1606.13 4455.36,-1613.07"/>
</g>
<!-- s0_tp5_k_proj -->
<g id="node39" class="node">
<title>s0_tp5_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="5023,-1609.54 4753,-1609.54 4753,-1546.54 5023,-1546.54 5023,-1609.54"/>
<text text-anchor="middle" x="4888" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP5</text>
<text text-anchor="middle" x="4888" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4888" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4888" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4888" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp5_k_proj -->
<g id="edge53" class="edge">
<title>input&#45;&gt;s0_tp5_k_proj</title>
<path fill="none" stroke="black" d="M3726.42,-1653.35C3750.22,-1650.33 3774.81,-1647.55 3798,-1645.54 4213.9,-1609.45 4324.72,-1660.51 4742.89,-1609.59"/>
<polygon fill="black" stroke="black" points="4743.33,-1613.06 4752.83,-1608.37 4742.47,-1606.12 4743.33,-1613.06"/>
</g>
<!-- s0_tp5_v_proj -->
<g id="node40" class="node">
<title>s0_tp5_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="5311,-1609.54 5041,-1609.54 5041,-1546.54 5311,-1546.54 5311,-1609.54"/>
<text text-anchor="middle" x="5176" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP5</text>
<text text-anchor="middle" x="5176" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="5176" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5176" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5176" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp5_v_proj -->
<g id="edge54" class="edge">
<title>input&#45;&gt;s0_tp5_v_proj</title>
<path fill="none" stroke="black" d="M3725.86,-1653.25C3749.83,-1650.21 3774.62,-1647.46 3798,-1645.54 4341.49,-1600.81 4485.45,-1673.75 5030.74,-1609.6"/>
<polygon fill="black" stroke="black" points="5031.31,-1613.06 5040.83,-1608.41 5030.49,-1606.11 5031.31,-1613.06"/>
</g>
<!-- s0_tp6_q_proj -->
<g id="node45" class="node">
<title>s0_tp6_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="5599,-1609.54 5329,-1609.54 5329,-1546.54 5599,-1546.54 5599,-1609.54"/>
<text text-anchor="middle" x="5464" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP6</text>
<text text-anchor="middle" x="5464" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5464" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5464" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5464" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp6_q_proj -->
<g id="edge61" class="edge">
<title>input&#45;&gt;s0_tp6_q_proj</title>
<path fill="none" stroke="black" d="M3725.3,-1653.21C3749.44,-1650.16 3774.43,-1647.41 3798,-1645.54 4469.21,-1592.17 4646.2,-1687.04 5318.9,-1609.58"/>
<polygon fill="black" stroke="black" points="5319.3,-1613.06 5328.83,-1608.43 5318.5,-1606.1 5319.3,-1613.06"/>
</g>
<!-- s0_tp6_k_proj -->
<g id="node46" class="node">
<title>s0_tp6_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="5887,-1609.54 5617,-1609.54 5617,-1546.54 5887,-1546.54 5887,-1609.54"/>
<text text-anchor="middle" x="5752" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP6</text>
<text text-anchor="middle" x="5752" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5752" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5752" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5752" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp6_k_proj -->
<g id="edge62" class="edge">
<title>input&#45;&gt;s0_tp6_k_proj</title>
<path fill="none" stroke="black" d="M3725.01,-1653.17C3749.25,-1650.12 3774.34,-1647.38 3798,-1645.54 4195.86,-1614.65 5192.1,-1654.77 5606.85,-1609.56"/>
<polygon fill="black" stroke="black" points="5607.29,-1613.03 5616.84,-1608.44 5606.51,-1606.08 5607.29,-1613.03"/>
</g>
<!-- s0_tp6_v_proj -->
<g id="node47" class="node">
<title>s0_tp6_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="6175,-1609.54 5905,-1609.54 5905,-1546.54 6175,-1546.54 6175,-1609.54"/>
<text text-anchor="middle" x="6040" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP6</text>
<text text-anchor="middle" x="6040" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="6040" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6040" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6040" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp6_v_proj -->
<g id="edge63" class="edge">
<title>input&#45;&gt;s0_tp6_v_proj</title>
<path fill="none" stroke="black" d="M3725.01,-1653.12C3749.24,-1650.07 3774.34,-1647.34 3798,-1645.54 4259.65,-1610.34 5416.15,-1661.36 5894.7,-1609.58"/>
<polygon fill="black" stroke="black" points="5895.28,-1613.03 5904.84,-1608.45 5894.51,-1606.08 5895.28,-1613.03"/>
</g>
<!-- s0_tp7_q_proj -->
<g id="node52" class="node">
<title>s0_tp7_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="6463,-1609.54 6193,-1609.54 6193,-1546.54 6463,-1546.54 6463,-1609.54"/>
<text text-anchor="middle" x="6328" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 Q TP7</text>
<text text-anchor="middle" x="6328" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="6328" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6328" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6328" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp7_q_proj -->
<g id="edge70" class="edge">
<title>input&#45;&gt;s0_tp7_q_proj</title>
<path fill="none" stroke="black" d="M3724.73,-1653.11C3749.05,-1650.05 3774.25,-1647.33 3798,-1645.54 4323.43,-1606.02 5640.18,-1667.96 6182.54,-1609.6"/>
<polygon fill="black" stroke="black" points="6183.28,-1613.03 6192.84,-1608.46 6182.51,-1606.08 6183.28,-1613.03"/>
</g>
<!-- s0_tp7_k_proj -->
<g id="node53" class="node">
<title>s0_tp7_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="6751,-1609.54 6481,-1609.54 6481,-1546.54 6751,-1546.54 6751,-1609.54"/>
<text text-anchor="middle" x="6616" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 K TP7</text>
<text text-anchor="middle" x="6616" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="6616" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6616" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6616" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp7_k_proj -->
<g id="edge71" class="edge">
<title>input&#45;&gt;s0_tp7_k_proj</title>
<path fill="none" stroke="black" d="M3724.73,-1653.08C3749.05,-1650.02 3774.24,-1647.31 3798,-1645.54 4387.31,-1601.7 5864.67,-1674.6 6470.66,-1609.58"/>
<polygon fill="black" stroke="black" points="6471.28,-1613.04 6480.84,-1608.47 6470.52,-1606.08 6471.28,-1613.04"/>
</g>
<!-- s0_tp7_v_proj -->
<g id="node54" class="node">
<title>s0_tp7_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="7039,-1609.54 6769,-1609.54 6769,-1546.54 7039,-1546.54 7039,-1609.54"/>
<text text-anchor="middle" x="6904" y="-1597.54" font-family="Times,serif" font-size="10.00">S0 V TP7</text>
<text text-anchor="middle" x="6904" y="-1586.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="6904" y="-1575.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6904" y="-1564.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6904" y="-1553.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- input&#45;&gt;s0_tp7_v_proj -->
<g id="edge72" class="edge">
<title>input&#45;&gt;s0_tp7_v_proj</title>
<path fill="none" stroke="black" d="M3724.45,-1653.09C3748.85,-1650.02 3774.15,-1647.3 3798,-1645.54 4451.12,-1597.38 6088.83,-1681.22 6758.56,-1609.59"/>
<polygon fill="black" stroke="black" points="6759.28,-1613.04 6768.84,-1608.47 6758.52,-1606.08 6759.28,-1613.04"/>
</g>
<!-- stage0_label -->
<g id="node2" class="node">
<title>stage0_label</title>
<text text-anchor="middle" x="3872" y="-1672.03" font-family="Times,serif" font-size="10.00">STAGE 0 &#45; Devices 0&#45;7</text>
</g>
<!-- s0_tp0_attn -->
<g id="node6" class="node">
<title>s0_tp0_attn</title>
<polygon fill="lightgreen" stroke="black" points="841.5,-1510.54 582.5,-1510.54 582.5,-1447.54 841.5,-1447.54 841.5,-1510.54"/>
<text text-anchor="middle" x="712" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP0</text>
<text text-anchor="middle" x="712" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="712" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="712" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="712" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp0_q_proj&#45;&gt;s0_tp0_attn -->
<g id="edge1" class="edge">
<title>s0_tp0_q_proj&#45;&gt;s0_tp0_attn</title>
<path fill="none" stroke="black" d="M415.21,-1546.68C465.21,-1535.45 521.96,-1522.71 572.35,-1511.39"/>
<polygon fill="black" stroke="black" points="573.35,-1514.76 582.34,-1509.15 571.82,-1507.93 573.35,-1514.76"/>
</g>
<!-- s0_tp0_k_proj&#45;&gt;s0_tp0_attn -->
<g id="edge2" class="edge">
<title>s0_tp0_k_proj&#45;&gt;s0_tp0_attn</title>
<path fill="none" stroke="black" d="M613.56,-1546.35C627.61,-1536.88 643.23,-1526.37 657.8,-1516.55"/>
<polygon fill="black" stroke="black" points="659.9,-1519.35 666.24,-1510.86 655.99,-1513.55 659.9,-1519.35"/>
</g>
<!-- s0_tp0_v_proj&#45;&gt;s0_tp0_attn -->
<g id="edge3" class="edge">
<title>s0_tp0_v_proj&#45;&gt;s0_tp0_attn</title>
<path fill="none" stroke="black" d="M810.44,-1546.35C796.39,-1536.88 780.77,-1526.37 766.2,-1516.55"/>
<polygon fill="black" stroke="black" points="768.01,-1513.55 757.76,-1510.86 764.1,-1519.35 768.01,-1513.55"/>
</g>
<!-- s0_tp0_mlp1 -->
<g id="node7" class="node">
<title>s0_tp0_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="1145,-1411.54 889,-1411.54 889,-1348.54 1145,-1348.54 1145,-1411.54"/>
<text text-anchor="middle" x="1017" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP0</text>
<text text-anchor="middle" x="1017" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1017" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1017" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1017" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp0_attn&#45;&gt;s0_tp0_mlp1 -->
<g id="edge4" class="edge">
<title>s0_tp0_attn&#45;&gt;s0_tp0_mlp1</title>
<path fill="none" stroke="black" d="M808.09,-1447.48C840.82,-1437.07 877.6,-1425.37 911.07,-1414.73"/>
<polygon fill="black" stroke="black" points="912.4,-1417.98 920.87,-1411.61 910.28,-1411.31 912.4,-1417.98"/>
</g>
<!-- s0_tp0_mlp2 -->
<g id="node8" class="node">
<title>s0_tp0_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="1317.5,-1312.54 1058.5,-1312.54 1058.5,-1249.54 1317.5,-1249.54 1317.5,-1312.54"/>
<text text-anchor="middle" x="1188" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP0</text>
<text text-anchor="middle" x="1188" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1188" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="1188" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="1188" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp0_mlp1&#45;&gt;s0_tp0_mlp2 -->
<g id="edge5" class="edge">
<title>s0_tp0_mlp1&#45;&gt;s0_tp0_mlp2</title>
<path fill="none" stroke="black" d="M1071.11,-1348.35C1088.19,-1338.66 1107.21,-1327.87 1124.86,-1317.85"/>
<polygon fill="black" stroke="black" points="1126.98,-1320.68 1133.95,-1312.7 1123.53,-1314.59 1126.98,-1320.68"/>
</g>
<!-- s0_tp0_residual -->
<g id="node9" class="node">
<title>s0_tp0_residual</title>
<polygon fill="lightgray" stroke="black" points="1615.98,-1213.54 1178.55,-1213.54 1066.02,-1087.54 1503.45,-1087.54 1615.98,-1213.54"/>
<text text-anchor="middle" x="1341" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP0</text>
<text text-anchor="middle" x="1341" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1341" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1341" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1341" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp0_mlp2&#45;&gt;s0_tp0_residual -->
<g id="edge6" class="edge">
<title>s0_tp0_mlp2&#45;&gt;s0_tp0_residual</title>
<path fill="none" stroke="black" d="M1224.65,-1249.26C1235.16,-1240.43 1247.07,-1230.43 1259.16,-1220.27"/>
<polygon fill="black" stroke="black" points="1261.71,-1222.7 1267.12,-1213.59 1257.21,-1217.34 1261.71,-1222.7"/>
</g>
<!-- s0_allreduce -->
<g id="node59" class="node">
<title>s0_allreduce</title>
<polygon fill="orange" stroke="black" points="3735.43,-1051.54 3276.6,-1051.54 3158.57,-947.54 3617.4,-947.54 3735.43,-1051.54"/>
<text text-anchor="middle" x="3447" y="-1013.54" font-family="Times,serif" font-size="10.00">Stage 0 All&#45;Reduce</text>
<text text-anchor="middle" x="3447" y="-1002.54" font-family="Times,serif" font-size="10.00">Cross&#45;GPU reduction</text>
<text text-anchor="middle" x="3447" y="-991.54" font-family="Times,serif" font-size="10.00">Input: 8×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3447" y="-980.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- s0_tp0_residual&#45;&gt;s0_allreduce -->
<g id="edge73" class="edge">
<title>s0_tp0_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M1526.72,-1113.05C1582.25,-1103.33 1643.42,-1093.81 1700,-1087.54 2238.46,-1027.86 2874.86,-1009.11 3211.19,-1003.22"/>
<polygon fill="black" stroke="black" points="3211.61,-1006.72 3221.54,-1003.04 3211.48,-999.72 3211.61,-1006.72"/>
</g>
<!-- s0_tp1_attn -->
<g id="node13" class="node">
<title>s0_tp1_attn</title>
<polygon fill="lightgreen" stroke="black" points="1700.5,-1510.54 1441.5,-1510.54 1441.5,-1447.54 1700.5,-1447.54 1700.5,-1510.54"/>
<text text-anchor="middle" x="1571" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP1</text>
<text text-anchor="middle" x="1571" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1571" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="1571" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1571" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp1_q_proj&#45;&gt;s0_tp1_attn -->
<g id="edge10" class="edge">
<title>s0_tp1_q_proj&#45;&gt;s0_tp1_attn</title>
<path fill="none" stroke="black" d="M1278.52,-1546.48C1327.12,-1535.44 1382.07,-1522.96 1431.12,-1511.81"/>
<polygon fill="black" stroke="black" points="1432.19,-1515.16 1441.17,-1509.53 1430.64,-1508.33 1432.19,-1515.16"/>
</g>
<!-- s0_tp1_k_proj&#45;&gt;s0_tp1_attn -->
<g id="edge11" class="edge">
<title>s0_tp1_k_proj&#45;&gt;s0_tp1_attn</title>
<path fill="none" stroke="black" d="M1475.98,-1546.35C1489.42,-1536.97 1504.33,-1526.56 1518.29,-1516.83"/>
<polygon fill="black" stroke="black" points="1520.63,-1519.46 1526.83,-1510.86 1516.62,-1513.72 1520.63,-1519.46"/>
</g>
<!-- s0_tp1_v_proj&#45;&gt;s0_tp1_attn -->
<g id="edge12" class="edge">
<title>s0_tp1_v_proj&#45;&gt;s0_tp1_attn</title>
<path fill="none" stroke="black" d="M1672.86,-1546.35C1658.24,-1536.84 1642,-1526.26 1626.86,-1516.41"/>
<polygon fill="black" stroke="black" points="1628.38,-1513.22 1618.09,-1510.7 1624.56,-1519.09 1628.38,-1513.22"/>
</g>
<!-- s0_tp1_mlp1 -->
<g id="node14" class="node">
<title>s0_tp1_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="1769,-1411.54 1513,-1411.54 1513,-1348.54 1769,-1348.54 1769,-1411.54"/>
<text text-anchor="middle" x="1641" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP1</text>
<text text-anchor="middle" x="1641" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1641" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1641" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1641" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp1_attn&#45;&gt;s0_tp1_mlp1 -->
<g id="edge13" class="edge">
<title>s0_tp1_attn&#45;&gt;s0_tp1_mlp1</title>
<path fill="none" stroke="black" d="M1593.15,-1447.35C1599.4,-1438.68 1606.3,-1429.13 1612.85,-1420.04"/>
<polygon fill="black" stroke="black" points="1615.74,-1422.02 1618.76,-1411.86 1610.07,-1417.92 1615.74,-1422.02"/>
</g>
<!-- s0_tp1_mlp2 -->
<g id="node15" class="node">
<title>s0_tp1_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="2043.5,-1312.54 1784.5,-1312.54 1784.5,-1249.54 2043.5,-1249.54 2043.5,-1312.54"/>
<text text-anchor="middle" x="1914" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP1</text>
<text text-anchor="middle" x="1914" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1914" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="1914" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="1914" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp1_mlp1&#45;&gt;s0_tp1_mlp2 -->
<g id="edge14" class="edge">
<title>s0_tp1_mlp1&#45;&gt;s0_tp1_mlp2</title>
<path fill="none" stroke="black" d="M1727,-1348.48C1756.06,-1338.16 1788.66,-1326.57 1818.41,-1316"/>
<polygon fill="black" stroke="black" points="1819.71,-1319.26 1827.96,-1312.61 1817.36,-1312.66 1819.71,-1319.26"/>
</g>
<!-- s0_tp1_residual -->
<g id="node16" class="node">
<title>s0_tp1_residual</title>
<polygon fill="lightgray" stroke="black" points="2258.98,-1213.54 1821.55,-1213.54 1709.02,-1087.54 2146.45,-1087.54 2258.98,-1213.54"/>
<text text-anchor="middle" x="1984" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP1</text>
<text text-anchor="middle" x="1984" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1984" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1984" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1984" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp1_mlp2&#45;&gt;s0_tp1_residual -->
<g id="edge15" class="edge">
<title>s0_tp1_mlp2&#45;&gt;s0_tp1_residual</title>
<path fill="none" stroke="black" d="M1930.77,-1249.26C1935.21,-1241.1 1940.2,-1231.94 1945.29,-1222.59"/>
<polygon fill="black" stroke="black" points="1948.49,-1224.05 1950.2,-1213.59 1942.34,-1220.7 1948.49,-1224.05"/>
</g>
<!-- s0_tp1_residual&#45;&gt;s0_allreduce -->
<g id="edge74" class="edge">
<title>s0_tp1_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M2167.16,-1110.4C2212.07,-1101.85 2260.14,-1093.56 2305,-1087.54 2620.31,-1045.22 2987.56,-1021.82 3218.67,-1010.21"/>
<polygon fill="black" stroke="black" points="3219.07,-1013.7 3228.89,-1009.7 3218.73,-1006.71 3219.07,-1013.7"/>
</g>
<!-- s0_tp2_attn -->
<g id="node20" class="node">
<title>s0_tp2_attn</title>
<polygon fill="lightgreen" stroke="black" points="2569.5,-1510.54 2310.5,-1510.54 2310.5,-1447.54 2569.5,-1447.54 2569.5,-1510.54"/>
<text text-anchor="middle" x="2440" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP2</text>
<text text-anchor="middle" x="2440" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2440" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="2440" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2440" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp2_q_proj&#45;&gt;s0_tp2_attn -->
<g id="edge19" class="edge">
<title>s0_tp2_q_proj&#45;&gt;s0_tp2_attn</title>
<path fill="none" stroke="black" d="M2143.21,-1546.68C2193.21,-1535.45 2249.96,-1522.71 2300.35,-1511.39"/>
<polygon fill="black" stroke="black" points="2301.35,-1514.76 2310.34,-1509.15 2299.82,-1507.93 2301.35,-1514.76"/>
</g>
<!-- s0_tp2_k_proj&#45;&gt;s0_tp2_attn -->
<g id="edge20" class="edge">
<title>s0_tp2_k_proj&#45;&gt;s0_tp2_attn</title>
<path fill="none" stroke="black" d="M2341.56,-1546.35C2355.61,-1536.88 2371.23,-1526.37 2385.8,-1516.55"/>
<polygon fill="black" stroke="black" points="2387.9,-1519.35 2394.24,-1510.86 2383.99,-1513.55 2387.9,-1519.35"/>
</g>
<!-- s0_tp2_v_proj&#45;&gt;s0_tp2_attn -->
<g id="edge21" class="edge">
<title>s0_tp2_v_proj&#45;&gt;s0_tp2_attn</title>
<path fill="none" stroke="black" d="M2538.44,-1546.35C2524.39,-1536.88 2508.77,-1526.37 2494.2,-1516.55"/>
<polygon fill="black" stroke="black" points="2496.01,-1513.55 2485.76,-1510.86 2492.1,-1519.35 2496.01,-1513.55"/>
</g>
<!-- s0_tp2_mlp1 -->
<g id="node21" class="node">
<title>s0_tp2_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="2606,-1411.54 2350,-1411.54 2350,-1348.54 2606,-1348.54 2606,-1411.54"/>
<text text-anchor="middle" x="2478" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP2</text>
<text text-anchor="middle" x="2478" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2478" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2478" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2478" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp2_attn&#45;&gt;s0_tp2_mlp1 -->
<g id="edge22" class="edge">
<title>s0_tp2_attn&#45;&gt;s0_tp2_mlp1</title>
<path fill="none" stroke="black" d="M2452.02,-1447.35C2455.25,-1439.12 2458.78,-1430.1 2462.17,-1421.44"/>
<polygon fill="black" stroke="black" points="2465.54,-1422.45 2465.92,-1411.86 2459.02,-1419.9 2465.54,-1422.45"/>
</g>
<!-- s0_tp2_mlp2 -->
<g id="node22" class="node">
<title>s0_tp2_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="2680.5,-1312.54 2421.5,-1312.54 2421.5,-1249.54 2680.5,-1249.54 2680.5,-1312.54"/>
<text text-anchor="middle" x="2551" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP2</text>
<text text-anchor="middle" x="2551" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2551" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="2551" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="2551" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp2_mlp1&#45;&gt;s0_tp2_mlp2 -->
<g id="edge23" class="edge">
<title>s0_tp2_mlp1&#45;&gt;s0_tp2_mlp2</title>
<path fill="none" stroke="black" d="M2501.1,-1348.35C2507.62,-1339.68 2514.81,-1330.13 2521.65,-1321.04"/>
<polygon fill="black" stroke="black" points="2524.59,-1322.96 2527.8,-1312.86 2518.99,-1318.75 2524.59,-1322.96"/>
</g>
<!-- s0_tp2_residual -->
<g id="node23" class="node">
<title>s0_tp2_residual</title>
<polygon fill="lightgray" stroke="black" points="2863.98,-1213.54 2426.55,-1213.54 2314.02,-1087.54 2751.45,-1087.54 2863.98,-1213.54"/>
<text text-anchor="middle" x="2589" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP2</text>
<text text-anchor="middle" x="2589" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2589" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2589" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2589" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp2_mlp2&#45;&gt;s0_tp2_residual -->
<g id="edge24" class="edge">
<title>s0_tp2_mlp2&#45;&gt;s0_tp2_residual</title>
<path fill="none" stroke="black" d="M2560.1,-1249.26C2562.44,-1241.35 2565.06,-1232.51 2567.73,-1223.46"/>
<polygon fill="black" stroke="black" points="2571.17,-1224.17 2570.65,-1213.59 2564.46,-1222.19 2571.17,-1224.17"/>
</g>
<!-- s0_tp2_residual&#45;&gt;s0_allreduce -->
<g id="edge75" class="edge">
<title>s0_tp2_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M2771.08,-1109.06C2807.1,-1101.53 2844.69,-1094 2880,-1087.54 2998.74,-1065.8 3132.16,-1045.14 3239.73,-1029.41"/>
<polygon fill="black" stroke="black" points="3240.34,-1032.86 3249.73,-1027.96 3239.33,-1025.94 3240.34,-1032.86"/>
</g>
<!-- s0_tp3_attn -->
<g id="node27" class="node">
<title>s0_tp3_attn</title>
<polygon fill="lightgreen" stroke="black" points="3289.5,-1510.54 3030.5,-1510.54 3030.5,-1447.54 3289.5,-1447.54 3289.5,-1510.54"/>
<text text-anchor="middle" x="3160" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP3</text>
<text text-anchor="middle" x="3160" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3160" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="3160" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3160" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp3_q_proj&#45;&gt;s0_tp3_attn -->
<g id="edge28" class="edge">
<title>s0_tp3_q_proj&#45;&gt;s0_tp3_attn</title>
<path fill="none" stroke="black" d="M2962.73,-1546.48C2993.51,-1536.11 3028.07,-1524.47 3059.56,-1513.87"/>
<polygon fill="black" stroke="black" points="3060.87,-1517.12 3069.23,-1510.61 3058.64,-1510.49 3060.87,-1517.12"/>
</g>
<!-- s0_tp3_k_proj&#45;&gt;s0_tp3_attn -->
<g id="edge29" class="edge">
<title>s0_tp3_k_proj&#45;&gt;s0_tp3_attn</title>
<path fill="none" stroke="black" d="M3160,-1546.35C3160,-1538.3 3160,-1529.49 3160,-1520.99"/>
<polygon fill="black" stroke="black" points="3163.5,-1520.86 3160,-1510.86 3156.5,-1520.86 3163.5,-1520.86"/>
</g>
<!-- s0_tp3_v_proj&#45;&gt;s0_tp3_attn -->
<g id="edge30" class="edge">
<title>s0_tp3_v_proj&#45;&gt;s0_tp3_attn</title>
<path fill="none" stroke="black" d="M3357.27,-1546.48C3326.49,-1536.11 3291.93,-1524.47 3260.44,-1513.87"/>
<polygon fill="black" stroke="black" points="3261.36,-1510.49 3250.77,-1510.61 3259.13,-1517.12 3261.36,-1510.49"/>
</g>
<!-- s0_tp3_mlp1 -->
<g id="node28" class="node">
<title>s0_tp3_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="3289,-1411.54 3033,-1411.54 3033,-1348.54 3289,-1348.54 3289,-1411.54"/>
<text text-anchor="middle" x="3161" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP3</text>
<text text-anchor="middle" x="3161" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3161" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3161" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3161" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp3_attn&#45;&gt;s0_tp3_mlp1 -->
<g id="edge31" class="edge">
<title>s0_tp3_attn&#45;&gt;s0_tp3_mlp1</title>
<path fill="none" stroke="black" d="M3160.32,-1447.35C3160.4,-1439.3 3160.49,-1430.49 3160.58,-1421.99"/>
<polygon fill="black" stroke="black" points="3164.08,-1421.9 3160.68,-1411.86 3157.08,-1421.83 3164.08,-1421.9"/>
</g>
<!-- s0_tp3_mlp2 -->
<g id="node29" class="node">
<title>s0_tp3_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="3292.5,-1312.54 3033.5,-1312.54 3033.5,-1249.54 3292.5,-1249.54 3292.5,-1312.54"/>
<text text-anchor="middle" x="3163" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP3</text>
<text text-anchor="middle" x="3163" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3163" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="3163" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="3163" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp3_mlp1&#45;&gt;s0_tp3_mlp2 -->
<g id="edge32" class="edge">
<title>s0_tp3_mlp1&#45;&gt;s0_tp3_mlp2</title>
<path fill="none" stroke="black" d="M3161.63,-1348.35C3161.8,-1340.3 3161.98,-1331.49 3162.16,-1322.99"/>
<polygon fill="black" stroke="black" points="3165.66,-1322.93 3162.36,-1312.86 3158.66,-1322.79 3165.66,-1322.93"/>
</g>
<!-- s0_tp3_residual -->
<g id="node30" class="node">
<title>s0_tp3_residual</title>
<polygon fill="lightgray" stroke="black" points="3438.98,-1213.54 3001.55,-1213.54 2889.02,-1087.54 3326.45,-1087.54 3438.98,-1213.54"/>
<text text-anchor="middle" x="3164" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP3</text>
<text text-anchor="middle" x="3164" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3164" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3164" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3164" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp3_mlp2&#45;&gt;s0_tp3_residual -->
<g id="edge33" class="edge">
<title>s0_tp3_mlp2&#45;&gt;s0_tp3_residual</title>
<path fill="none" stroke="black" d="M3163.24,-1249.26C3163.3,-1241.44 3163.37,-1232.7 3163.44,-1223.75"/>
<polygon fill="black" stroke="black" points="3166.94,-1223.62 3163.52,-1213.59 3159.94,-1223.56 3166.94,-1223.62"/>
</g>
<!-- s0_tp3_residual&#45;&gt;s0_allreduce -->
<g id="edge76" class="edge">
<title>s0_tp3_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M3281.97,-1087.43C3301.48,-1077.16 3321.6,-1066.56 3340.8,-1056.46"/>
<polygon fill="black" stroke="black" points="3342.62,-1059.45 3349.84,-1051.69 3339.36,-1053.26 3342.62,-1059.45"/>
</g>
<!-- s0_tp4_attn -->
<g id="node34" class="node">
<title>s0_tp4_attn</title>
<polygon fill="lightgreen" stroke="black" points="4009.5,-1510.54 3750.5,-1510.54 3750.5,-1447.54 4009.5,-1447.54 4009.5,-1510.54"/>
<text text-anchor="middle" x="3880" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP4</text>
<text text-anchor="middle" x="3880" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3880" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="3880" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3880" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp4_q_proj&#45;&gt;s0_tp4_attn -->
<g id="edge37" class="edge">
<title>s0_tp4_q_proj&#45;&gt;s0_tp4_attn</title>
<path fill="none" stroke="black" d="M3781.56,-1546.35C3795.61,-1536.88 3811.23,-1526.37 3825.8,-1516.55"/>
<polygon fill="black" stroke="black" points="3827.9,-1519.35 3834.24,-1510.86 3823.99,-1513.55 3827.9,-1519.35"/>
</g>
<!-- s0_tp4_k_proj&#45;&gt;s0_tp4_attn -->
<g id="edge38" class="edge">
<title>s0_tp4_k_proj&#45;&gt;s0_tp4_attn</title>
<path fill="none" stroke="black" d="M3978.44,-1546.35C3964.39,-1536.88 3948.77,-1526.37 3934.2,-1516.55"/>
<polygon fill="black" stroke="black" points="3936.01,-1513.55 3925.76,-1510.86 3932.1,-1519.35 3936.01,-1513.55"/>
</g>
<!-- s0_tp4_v_proj&#45;&gt;s0_tp4_attn -->
<g id="edge39" class="edge">
<title>s0_tp4_v_proj&#45;&gt;s0_tp4_attn</title>
<path fill="none" stroke="black" d="M4176.79,-1546.68C4126.79,-1535.45 4070.04,-1522.71 4019.65,-1511.39"/>
<polygon fill="black" stroke="black" points="4020.18,-1507.93 4009.66,-1509.15 4018.65,-1514.76 4020.18,-1507.93"/>
</g>
<!-- s0_tp4_mlp1 -->
<g id="node35" class="node">
<title>s0_tp4_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="3936,-1411.54 3680,-1411.54 3680,-1348.54 3936,-1348.54 3936,-1411.54"/>
<text text-anchor="middle" x="3808" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP4</text>
<text text-anchor="middle" x="3808" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3808" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3808" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3808" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp4_attn&#45;&gt;s0_tp4_mlp1 -->
<g id="edge40" class="edge">
<title>s0_tp4_attn&#45;&gt;s0_tp4_mlp1</title>
<path fill="none" stroke="black" d="M3857.22,-1447.35C3850.78,-1438.68 3843.69,-1429.13 3836.95,-1420.04"/>
<polygon fill="black" stroke="black" points="3839.65,-1417.81 3830.88,-1411.86 3834.03,-1421.98 3839.65,-1417.81"/>
</g>
<!-- s0_tp4_mlp2 -->
<g id="node36" class="node">
<title>s0_tp4_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="3901.5,-1312.54 3642.5,-1312.54 3642.5,-1249.54 3901.5,-1249.54 3901.5,-1312.54"/>
<text text-anchor="middle" x="3772" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP4</text>
<text text-anchor="middle" x="3772" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3772" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="3772" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="3772" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp4_mlp1&#45;&gt;s0_tp4_mlp2 -->
<g id="edge41" class="edge">
<title>s0_tp4_mlp1&#45;&gt;s0_tp4_mlp2</title>
<path fill="none" stroke="black" d="M3796.61,-1348.35C3793.56,-1340.12 3790.21,-1331.1 3786.99,-1322.44"/>
<polygon fill="black" stroke="black" points="3790.2,-1321.02 3783.44,-1312.86 3783.64,-1323.46 3790.2,-1321.02"/>
</g>
<!-- s0_tp4_residual -->
<g id="node37" class="node">
<title>s0_tp4_residual</title>
<polygon fill="lightgray" stroke="black" points="4009.98,-1213.54 3572.55,-1213.54 3460.02,-1087.54 3897.45,-1087.54 4009.98,-1213.54"/>
<text text-anchor="middle" x="3735" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP4</text>
<text text-anchor="middle" x="3735" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3735" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3735" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3735" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp4_mlp2&#45;&gt;s0_tp4_residual -->
<g id="edge42" class="edge">
<title>s0_tp4_mlp2&#45;&gt;s0_tp4_residual</title>
<path fill="none" stroke="black" d="M3763.14,-1249.26C3760.86,-1241.35 3758.31,-1232.51 3755.71,-1223.46"/>
<polygon fill="black" stroke="black" points="3759,-1222.23 3752.87,-1213.59 3752.27,-1224.17 3759,-1222.23"/>
</g>
<!-- s0_tp4_residual&#45;&gt;s0_allreduce -->
<g id="edge77" class="edge">
<title>s0_tp4_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M3614.95,-1087.43C3595,-1077.11 3574.43,-1066.47 3554.82,-1056.32"/>
<polygon fill="black" stroke="black" points="3556.37,-1053.18 3545.88,-1051.69 3553.15,-1059.4 3556.37,-1053.18"/>
</g>
<!-- s0_tp5_attn -->
<g id="node41" class="node">
<title>s0_tp5_attn</title>
<polygon fill="lightgreen" stroke="black" points="5017.5,-1510.54 4758.5,-1510.54 4758.5,-1447.54 5017.5,-1447.54 5017.5,-1510.54"/>
<text text-anchor="middle" x="4888" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP5</text>
<text text-anchor="middle" x="4888" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4888" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="4888" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4888" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp5_q_proj&#45;&gt;s0_tp5_attn -->
<g id="edge46" class="edge">
<title>s0_tp5_q_proj&#45;&gt;s0_tp5_attn</title>
<path fill="none" stroke="black" d="M4690.73,-1546.48C4721.51,-1536.11 4756.07,-1524.47 4787.56,-1513.87"/>
<polygon fill="black" stroke="black" points="4788.87,-1517.12 4797.23,-1510.61 4786.64,-1510.49 4788.87,-1517.12"/>
</g>
<!-- s0_tp5_k_proj&#45;&gt;s0_tp5_attn -->
<g id="edge47" class="edge">
<title>s0_tp5_k_proj&#45;&gt;s0_tp5_attn</title>
<path fill="none" stroke="black" d="M4888,-1546.35C4888,-1538.3 4888,-1529.49 4888,-1520.99"/>
<polygon fill="black" stroke="black" points="4891.5,-1520.86 4888,-1510.86 4884.5,-1520.86 4891.5,-1520.86"/>
</g>
<!-- s0_tp5_v_proj&#45;&gt;s0_tp5_attn -->
<g id="edge48" class="edge">
<title>s0_tp5_v_proj&#45;&gt;s0_tp5_attn</title>
<path fill="none" stroke="black" d="M5085.27,-1546.48C5054.49,-1536.11 5019.93,-1524.47 4988.44,-1513.87"/>
<polygon fill="black" stroke="black" points="4989.36,-1510.49 4978.77,-1510.61 4987.13,-1517.12 4989.36,-1510.49"/>
</g>
<!-- s0_tp5_mlp1 -->
<g id="node42" class="node">
<title>s0_tp5_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="5016,-1411.54 4760,-1411.54 4760,-1348.54 5016,-1348.54 5016,-1411.54"/>
<text text-anchor="middle" x="4888" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP5</text>
<text text-anchor="middle" x="4888" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4888" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4888" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4888" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp5_attn&#45;&gt;s0_tp5_mlp1 -->
<g id="edge49" class="edge">
<title>s0_tp5_attn&#45;&gt;s0_tp5_mlp1</title>
<path fill="none" stroke="black" d="M4888,-1447.35C4888,-1439.3 4888,-1430.49 4888,-1421.99"/>
<polygon fill="black" stroke="black" points="4891.5,-1421.86 4888,-1411.86 4884.5,-1421.86 4891.5,-1421.86"/>
</g>
<!-- s0_tp5_mlp2 -->
<g id="node43" class="node">
<title>s0_tp5_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="4651.5,-1312.54 4392.5,-1312.54 4392.5,-1249.54 4651.5,-1249.54 4651.5,-1312.54"/>
<text text-anchor="middle" x="4522" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP5</text>
<text text-anchor="middle" x="4522" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4522" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="4522" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="4522" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp5_mlp1&#45;&gt;s0_tp5_mlp2 -->
<g id="edge50" class="edge">
<title>s0_tp5_mlp1&#45;&gt;s0_tp5_mlp2</title>
<path fill="none" stroke="black" d="M4772.7,-1348.48C4732.74,-1337.89 4687.76,-1325.97 4647.05,-1315.18"/>
<polygon fill="black" stroke="black" points="4647.91,-1311.79 4637.35,-1312.61 4646.12,-1318.56 4647.91,-1311.79"/>
</g>
<!-- s0_tp5_residual -->
<g id="node44" class="node">
<title>s0_tp5_residual</title>
<polygon fill="lightgray" stroke="black" points="4578.98,-1213.54 4141.55,-1213.54 4029.02,-1087.54 4466.45,-1087.54 4578.98,-1213.54"/>
<text text-anchor="middle" x="4304" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP5</text>
<text text-anchor="middle" x="4304" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="4304" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4304" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4304" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp5_mlp2&#45;&gt;s0_tp5_residual -->
<g id="edge51" class="edge">
<title>s0_tp5_mlp2&#45;&gt;s0_tp5_residual</title>
<path fill="none" stroke="black" d="M4470.06,-1249.42C4454.37,-1240.17 4436.48,-1229.63 4418.39,-1218.97"/>
<polygon fill="black" stroke="black" points="4419.89,-1215.79 4409.5,-1213.73 4416.34,-1221.82 4419.89,-1215.79"/>
</g>
<!-- s0_tp5_residual&#45;&gt;s0_allreduce -->
<g id="edge78" class="edge">
<title>s0_tp5_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M4030.65,-1089.72C4026.75,-1088.98 4022.86,-1088.25 4019,-1087.54 3925.48,-1070.27 3822.9,-1053.88 3730.75,-1040.07"/>
<polygon fill="black" stroke="black" points="3731.13,-1036.59 3720.72,-1038.57 3730.09,-1043.51 3731.13,-1036.59"/>
</g>
<!-- s0_tp6_attn -->
<g id="node48" class="node">
<title>s0_tp6_attn</title>
<polygon fill="lightgreen" stroke="black" points="5737.5,-1510.54 5478.5,-1510.54 5478.5,-1447.54 5737.5,-1447.54 5737.5,-1510.54"/>
<text text-anchor="middle" x="5608" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP6</text>
<text text-anchor="middle" x="5608" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5608" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="5608" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5608" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp6_q_proj&#45;&gt;s0_tp6_attn -->
<g id="edge55" class="edge">
<title>s0_tp6_q_proj&#45;&gt;s0_tp6_attn</title>
<path fill="none" stroke="black" d="M5509.56,-1546.35C5523.61,-1536.88 5539.23,-1526.37 5553.8,-1516.55"/>
<polygon fill="black" stroke="black" points="5555.9,-1519.35 5562.24,-1510.86 5551.99,-1513.55 5555.9,-1519.35"/>
</g>
<!-- s0_tp6_k_proj&#45;&gt;s0_tp6_attn -->
<g id="edge56" class="edge">
<title>s0_tp6_k_proj&#45;&gt;s0_tp6_attn</title>
<path fill="none" stroke="black" d="M5706.44,-1546.35C5692.39,-1536.88 5676.77,-1526.37 5662.2,-1516.55"/>
<polygon fill="black" stroke="black" points="5664.01,-1513.55 5653.76,-1510.86 5660.1,-1519.35 5664.01,-1513.55"/>
</g>
<!-- s0_tp6_v_proj&#45;&gt;s0_tp6_attn -->
<g id="edge57" class="edge">
<title>s0_tp6_v_proj&#45;&gt;s0_tp6_attn</title>
<path fill="none" stroke="black" d="M5904.79,-1546.68C5854.79,-1535.45 5798.04,-1522.71 5747.65,-1511.39"/>
<polygon fill="black" stroke="black" points="5748.18,-1507.93 5737.66,-1509.15 5746.65,-1514.76 5748.18,-1507.93"/>
</g>
<!-- s0_tp6_mlp1 -->
<g id="node49" class="node">
<title>s0_tp6_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="5292,-1411.54 5036,-1411.54 5036,-1348.54 5292,-1348.54 5292,-1411.54"/>
<text text-anchor="middle" x="5164" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP6</text>
<text text-anchor="middle" x="5164" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5164" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5164" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5164" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp6_attn&#45;&gt;s0_tp6_mlp1 -->
<g id="edge58" class="edge">
<title>s0_tp6_attn&#45;&gt;s0_tp6_mlp1</title>
<path fill="none" stroke="black" d="M5478.44,-1449.99C5423.95,-1438.16 5359.88,-1424.23 5302,-1411.54 5301.9,-1411.52 5301.8,-1411.49 5301.7,-1411.47"/>
<polygon fill="black" stroke="black" points="5302.7,-1408.11 5292.18,-1409.38 5301.2,-1414.95 5302.7,-1408.11"/>
</g>
<!-- s0_tp6_mlp2 -->
<g id="node50" class="node">
<title>s0_tp6_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="5146.5,-1312.54 4887.5,-1312.54 4887.5,-1249.54 5146.5,-1249.54 5146.5,-1312.54"/>
<text text-anchor="middle" x="5017" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP6</text>
<text text-anchor="middle" x="5017" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5017" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="5017" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="5017" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp6_mlp1&#45;&gt;s0_tp6_mlp2 -->
<g id="edge59" class="edge">
<title>s0_tp6_mlp1&#45;&gt;s0_tp6_mlp2</title>
<path fill="none" stroke="black" d="M5117.49,-1348.35C5103.07,-1338.84 5087.05,-1328.26 5072.11,-1318.41"/>
<polygon fill="black" stroke="black" points="5073.74,-1315.28 5063.46,-1312.7 5069.88,-1321.13 5073.74,-1315.28"/>
</g>
<!-- s0_tp6_residual -->
<g id="node51" class="node">
<title>s0_tp6_residual</title>
<polygon fill="lightgray" stroke="black" points="5146.98,-1213.54 4709.55,-1213.54 4597.02,-1087.54 5034.45,-1087.54 5146.98,-1213.54"/>
<text text-anchor="middle" x="4872" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP6</text>
<text text-anchor="middle" x="4872" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="4872" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4872" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4872" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp6_mlp2&#45;&gt;s0_tp6_residual -->
<g id="edge60" class="edge">
<title>s0_tp6_mlp2&#45;&gt;s0_tp6_residual</title>
<path fill="none" stroke="black" d="M4982.27,-1249.26C4972.3,-1240.43 4961.02,-1230.43 4949.56,-1220.27"/>
<polygon fill="black" stroke="black" points="4951.83,-1217.6 4942.02,-1213.59 4947.18,-1222.84 4951.83,-1217.6"/>
</g>
<!-- s0_tp6_residual&#45;&gt;s0_allreduce -->
<g id="edge79" class="edge">
<title>s0_tp6_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M4598.17,-1089.07C4594.76,-1088.54 4591.37,-1088.03 4588,-1087.54 4283.43,-1042.9 3929.55,-1020.43 3697.63,-1009.64"/>
<polygon fill="black" stroke="black" points="3697.52,-1006.13 3687.37,-1009.17 3697.2,-1013.12 3697.52,-1006.13"/>
</g>
<!-- s0_tp7_attn -->
<g id="node55" class="node">
<title>s0_tp7_attn</title>
<polygon fill="lightgreen" stroke="black" points="6601.5,-1510.54 6342.5,-1510.54 6342.5,-1447.54 6601.5,-1447.54 6601.5,-1510.54"/>
<text text-anchor="middle" x="6472" y="-1498.54" font-family="Times,serif" font-size="10.00">S0 Attn TP7</text>
<text text-anchor="middle" x="6472" y="-1487.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="6472" y="-1476.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="6472" y="-1465.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="6472" y="-1454.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp7_q_proj&#45;&gt;s0_tp7_attn -->
<g id="edge64" class="edge">
<title>s0_tp7_q_proj&#45;&gt;s0_tp7_attn</title>
<path fill="none" stroke="black" d="M6373.56,-1546.35C6387.61,-1536.88 6403.23,-1526.37 6417.8,-1516.55"/>
<polygon fill="black" stroke="black" points="6419.9,-1519.35 6426.24,-1510.86 6415.99,-1513.55 6419.9,-1519.35"/>
</g>
<!-- s0_tp7_k_proj&#45;&gt;s0_tp7_attn -->
<g id="edge65" class="edge">
<title>s0_tp7_k_proj&#45;&gt;s0_tp7_attn</title>
<path fill="none" stroke="black" d="M6570.44,-1546.35C6556.39,-1536.88 6540.77,-1526.37 6526.2,-1516.55"/>
<polygon fill="black" stroke="black" points="6528.01,-1513.55 6517.76,-1510.86 6524.1,-1519.35 6528.01,-1513.55"/>
</g>
<!-- s0_tp7_v_proj&#45;&gt;s0_tp7_attn -->
<g id="edge66" class="edge">
<title>s0_tp7_v_proj&#45;&gt;s0_tp7_attn</title>
<path fill="none" stroke="black" d="M6768.79,-1546.68C6718.79,-1535.45 6662.04,-1522.71 6611.65,-1511.39"/>
<polygon fill="black" stroke="black" points="6612.18,-1507.93 6601.66,-1509.15 6610.65,-1514.76 6612.18,-1507.93"/>
</g>
<!-- s0_tp7_mlp1 -->
<g id="node56" class="node">
<title>s0_tp7_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="5567,-1411.54 5311,-1411.54 5311,-1348.54 5567,-1348.54 5567,-1411.54"/>
<text text-anchor="middle" x="5439" y="-1399.54" font-family="Times,serif" font-size="10.00">S0 MLP1 TP7</text>
<text text-anchor="middle" x="5439" y="-1388.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="5439" y="-1377.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5439" y="-1366.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5439" y="-1355.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s0_tp7_attn&#45;&gt;s0_tp7_mlp1 -->
<g id="edge67" class="edge">
<title>s0_tp7_attn&#45;&gt;s0_tp7_mlp1</title>
<path fill="none" stroke="black" d="M6342.48,-1465.88C6146.87,-1447.51 5777.68,-1412.84 5577.12,-1394.01"/>
<polygon fill="black" stroke="black" points="5577.4,-1390.52 5567.11,-1393.07 5576.74,-1397.49 5577.4,-1390.52"/>
</g>
<!-- s0_tp7_mlp2 -->
<g id="node57" class="node">
<title>s0_tp7_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="5568.5,-1312.54 5309.5,-1312.54 5309.5,-1249.54 5568.5,-1249.54 5568.5,-1312.54"/>
<text text-anchor="middle" x="5439" y="-1300.54" font-family="Times,serif" font-size="10.00">S0 MLP2 TP7</text>
<text text-anchor="middle" x="5439" y="-1289.54" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="5439" y="-1278.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="5439" y="-1267.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="5439" y="-1256.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp7_mlp1&#45;&gt;s0_tp7_mlp2 -->
<g id="edge68" class="edge">
<title>s0_tp7_mlp1&#45;&gt;s0_tp7_mlp2</title>
<path fill="none" stroke="black" d="M5439,-1348.35C5439,-1340.3 5439,-1331.49 5439,-1322.99"/>
<polygon fill="black" stroke="black" points="5442.5,-1322.86 5439,-1312.86 5435.5,-1322.86 5442.5,-1322.86"/>
</g>
<!-- s0_tp7_residual -->
<g id="node58" class="node">
<title>s0_tp7_residual</title>
<polygon fill="lightgray" stroke="black" points="5713.98,-1213.54 5276.55,-1213.54 5164.02,-1087.54 5601.45,-1087.54 5713.98,-1213.54"/>
<text text-anchor="middle" x="5439" y="-1170.04" font-family="Times,serif" font-size="10.00">S0 Residual TP7</text>
<text text-anchor="middle" x="5439" y="-1159.04" font-family="Times,serif" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="5439" y="-1148.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5439" y="-1137.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5439" y="-1126.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s0_tp7_mlp2&#45;&gt;s0_tp7_residual -->
<g id="edge69" class="edge">
<title>s0_tp7_mlp2&#45;&gt;s0_tp7_residual</title>
<path fill="none" stroke="black" d="M5439,-1249.26C5439,-1241.44 5439,-1232.7 5439,-1223.75"/>
<polygon fill="black" stroke="black" points="5442.5,-1223.59 5439,-1213.59 5435.5,-1223.59 5442.5,-1223.59"/>
</g>
<!-- s0_tp7_residual&#45;&gt;s0_allreduce -->
<g id="edge80" class="edge">
<title>s0_tp7_residual&#45;&gt;s0_allreduce</title>
<path fill="none" stroke="black" d="M5165.02,-1088.79C5162,-1088.36 5158.99,-1087.94 5156,-1087.54 4635.79,-1017.8 4019.66,-1002.88 3687.76,-1000.33"/>
<polygon fill="black" stroke="black" points="3687.56,-996.83 3677.54,-1000.26 3687.51,-1003.83 3687.56,-996.83"/>
</g>
<!-- pipeline_comm -->
<g id="node60" class="node">
<title>pipeline_comm</title>
<polygon fill="purple" stroke="black" points="3735.43,-911.54 3276.6,-911.54 3158.57,-807.54 3617.4,-807.54 3735.43,-911.54"/>
<text text-anchor="middle" x="3447" y="-873.54" font-family="Times,serif" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="3447" y="-862.54" font-family="Times,serif" font-size="10.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="3447" y="-851.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3447" y="-840.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- s0_allreduce&#45;&gt;pipeline_comm -->
<g id="edge81" class="edge">
<title>s0_allreduce&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M3447,-947.15C3447,-938.98 3447,-930.46 3447,-922.08"/>
<polygon fill="black" stroke="black" points="3450.5,-921.97 3447,-911.97 3443.5,-921.97 3450.5,-921.97"/>
</g>
<!-- s1_tp0_q_proj -->
<g id="node62" class="node">
<title>s1_tp0_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="270,-771.54 0,-771.54 0,-708.54 270,-708.54 270,-771.54"/>
<text text-anchor="middle" x="135" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP0</text>
<text text-anchor="middle" x="135" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="135" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="135" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="135" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp0_q_proj -->
<g id="edge138" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp0_q_proj</title>
<path fill="none" stroke="black" d="M3215.14,-857.62C2588.2,-854.28 867.72,-839.15 280.43,-771.61"/>
<polygon fill="black" stroke="black" points="280.51,-768.1 270.17,-770.41 279.69,-775.05 280.51,-768.1"/>
</g>
<!-- s1_tp0_k_proj -->
<g id="node63" class="node">
<title>s1_tp0_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="558,-771.54 288,-771.54 288,-708.54 558,-708.54 558,-771.54"/>
<text text-anchor="middle" x="423" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP0</text>
<text text-anchor="middle" x="423" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="423" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="423" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="423" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp0_k_proj -->
<g id="edge139" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp0_k_proj</title>
<path fill="none" stroke="black" d="M3214.31,-856.87C2627.44,-851.79 1096.84,-833.02 568.18,-771.58"/>
<polygon fill="black" stroke="black" points="568.51,-768.1 558.17,-770.4 567.69,-775.05 568.51,-768.1"/>
</g>
<!-- s1_tp0_v_proj -->
<g id="node64" class="node">
<title>s1_tp0_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="846,-771.54 576,-771.54 576,-708.54 846,-708.54 846,-771.54"/>
<text text-anchor="middle" x="711" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP0</text>
<text text-anchor="middle" x="711" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="711" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="711" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="711" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp0_v_proj -->
<g id="edge140" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp0_v_proj</title>
<path fill="none" stroke="black" d="M3213.49,-855.94C2669.02,-849.04 1326.59,-826.93 856.1,-771.58"/>
<polygon fill="black" stroke="black" points="856.52,-768.1 846.17,-770.39 855.68,-775.05 856.52,-768.1"/>
</g>
<!-- s1_tp1_q_proj -->
<g id="node69" class="node">
<title>s1_tp1_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="1134,-771.54 864,-771.54 864,-708.54 1134,-708.54 1134,-771.54"/>
<text text-anchor="middle" x="999" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP1</text>
<text text-anchor="middle" x="999" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="999" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="999" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="999" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp1_q_proj -->
<g id="edge141" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp1_q_proj</title>
<path fill="none" stroke="black" d="M3212.09,-854.77C2712.47,-845.92 1557.15,-820.86 1144.38,-771.61"/>
<polygon fill="black" stroke="black" points="1144.52,-768.1 1134.17,-770.37 1143.68,-775.05 1144.52,-768.1"/>
</g>
<!-- s1_tp1_k_proj -->
<g id="node70" class="node">
<title>s1_tp1_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="1422,-771.54 1152,-771.54 1152,-708.54 1422,-708.54 1422,-771.54"/>
<text text-anchor="middle" x="1287" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP1</text>
<text text-anchor="middle" x="1287" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1287" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1287" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1287" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp1_k_proj -->
<g id="edge142" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp1_k_proj</title>
<path fill="none" stroke="black" d="M3210.18,-853.24C2758.29,-842.33 1787.17,-814.79 1432.24,-771.6"/>
<polygon fill="black" stroke="black" points="1432.53,-768.11 1422.18,-770.35 1431.67,-775.06 1432.53,-768.11"/>
</g>
<!-- s1_tp1_v_proj -->
<g id="node71" class="node">
<title>s1_tp1_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="1710,-771.54 1440,-771.54 1440,-708.54 1710,-708.54 1710,-771.54"/>
<text text-anchor="middle" x="1575" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP1</text>
<text text-anchor="middle" x="1575" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1575" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1575" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1575" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp1_v_proj -->
<g id="edge143" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp1_v_proj</title>
<path fill="none" stroke="black" d="M3216.06,-858.5C2885.72,-855.84 2259.51,-841.11 1720.11,-771.61"/>
<polygon fill="black" stroke="black" points="1720.55,-768.14 1710.18,-770.32 1719.65,-775.08 1720.55,-768.14"/>
</g>
<!-- s1_tp2_q_proj -->
<g id="node76" class="node">
<title>s1_tp2_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="1998,-771.54 1728,-771.54 1728,-708.54 1998,-708.54 1998,-771.54"/>
<text text-anchor="middle" x="1863" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP2</text>
<text text-anchor="middle" x="1863" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1863" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1863" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp2_q_proj -->
<g id="edge144" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp2_q_proj</title>
<path fill="none" stroke="black" d="M3212.45,-855.04C2928.82,-848.37 2437.15,-829.02 2008.3,-771.64"/>
<polygon fill="black" stroke="black" points="2008.56,-768.15 1998.18,-770.28 2007.63,-775.08 2008.56,-768.15"/>
</g>
<!-- s1_tp2_k_proj -->
<g id="node77" class="node">
<title>s1_tp2_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="2286,-771.54 2016,-771.54 2016,-708.54 2286,-708.54 2286,-771.54"/>
<text text-anchor="middle" x="2151" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP2</text>
<text text-anchor="middle" x="2151" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2151" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2151" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2151" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp2_k_proj -->
<g id="edge145" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp2_k_proj</title>
<path fill="none" stroke="black" d="M3206.32,-849.71C2974.96,-839.05 2615.55,-816.78 2296.11,-771.63"/>
<polygon fill="black" stroke="black" points="2296.59,-768.16 2286.19,-770.22 2295.6,-775.1 2296.59,-768.16"/>
</g>
<!-- s1_tp2_v_proj -->
<g id="node78" class="node">
<title>s1_tp2_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="2574,-771.54 2304,-771.54 2304,-708.54 2574,-708.54 2574,-771.54"/>
<text text-anchor="middle" x="2439" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP2</text>
<text text-anchor="middle" x="2439" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2439" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2439" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2439" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp2_v_proj -->
<g id="edge146" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp2_v_proj</title>
<path fill="none" stroke="black" d="M3195.61,-840.46C3025.43,-826.48 2795.51,-804.21 2584.25,-771.68"/>
<polygon fill="black" stroke="black" points="2584.63,-768.2 2574.21,-770.12 2583.55,-775.11 2584.63,-768.2"/>
</g>
<!-- s1_tp3_q_proj -->
<g id="node83" class="node">
<title>s1_tp3_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="2862,-771.54 2592,-771.54 2592,-708.54 2862,-708.54 2862,-771.54"/>
<text text-anchor="middle" x="2727" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP3</text>
<text text-anchor="middle" x="2727" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2727" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2727" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="2727" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp3_q_proj -->
<g id="edge147" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp3_q_proj</title>
<path fill="none" stroke="black" d="M3173.23,-820.55C3080.43,-806.81 2976.02,-790.41 2872.28,-771.74"/>
<polygon fill="black" stroke="black" points="2872.7,-768.26 2862.24,-769.93 2871.46,-775.15 2872.7,-768.26"/>
</g>
<!-- s1_tp3_k_proj -->
<g id="node84" class="node">
<title>s1_tp3_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="3150,-771.54 2880,-771.54 2880,-708.54 3150,-708.54 3150,-771.54"/>
<text text-anchor="middle" x="3015" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP3</text>
<text text-anchor="middle" x="3015" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3015" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3015" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3015" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp3_k_proj -->
<g id="edge148" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp3_k_proj</title>
<path fill="none" stroke="black" d="M3259.4,-807.51C3218.02,-796.26 3175.21,-784.62 3137.22,-774.28"/>
<polygon fill="black" stroke="black" points="3137.72,-770.79 3127.15,-771.54 3135.88,-777.54 3137.72,-770.79"/>
</g>
<!-- s1_tp3_v_proj -->
<g id="node85" class="node">
<title>s1_tp3_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="3438,-771.54 3168,-771.54 3168,-708.54 3438,-708.54 3438,-771.54"/>
<text text-anchor="middle" x="3303" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP3</text>
<text text-anchor="middle" x="3303" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3303" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3303" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3303" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp3_v_proj -->
<g id="edge149" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp3_v_proj</title>
<path fill="none" stroke="black" d="M3384.26,-807.34C3372.3,-797.59 3360,-787.55 3348.71,-778.33"/>
<polygon fill="black" stroke="black" points="3350.64,-775.39 3340.68,-771.78 3346.21,-780.82 3350.64,-775.39"/>
</g>
<!-- s1_tp4_q_proj -->
<g id="node90" class="node">
<title>s1_tp4_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="3726,-771.54 3456,-771.54 3456,-708.54 3726,-708.54 3726,-771.54"/>
<text text-anchor="middle" x="3591" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP4</text>
<text text-anchor="middle" x="3591" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3591" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3591" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3591" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp4_q_proj -->
<g id="edge150" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp4_q_proj</title>
<path fill="none" stroke="black" d="M3509.74,-807.34C3521.7,-797.59 3534,-787.55 3545.29,-778.33"/>
<polygon fill="black" stroke="black" points="3547.79,-780.82 3553.32,-771.78 3543.36,-775.39 3547.79,-780.82"/>
</g>
<!-- s1_tp4_k_proj -->
<g id="node91" class="node">
<title>s1_tp4_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="4014,-771.54 3744,-771.54 3744,-708.54 4014,-708.54 4014,-771.54"/>
<text text-anchor="middle" x="3879" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP4</text>
<text text-anchor="middle" x="3879" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3879" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3879" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3879" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp4_k_proj -->
<g id="edge151" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp4_k_proj</title>
<path fill="none" stroke="black" d="M3621.47,-811.09C3666.87,-798.74 3714.82,-785.69 3756.88,-774.26"/>
<polygon fill="black" stroke="black" points="3757.86,-777.62 3766.59,-771.61 3756.02,-770.86 3757.86,-777.62"/>
</g>
<!-- s1_tp4_v_proj -->
<g id="node92" class="node">
<title>s1_tp4_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="4302,-771.54 4032,-771.54 4032,-708.54 4302,-708.54 4302,-771.54"/>
<text text-anchor="middle" x="4167" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP4</text>
<text text-anchor="middle" x="4167" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4167" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4167" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4167" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp4_v_proj -->
<g id="edge152" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp4_v_proj</title>
<path fill="none" stroke="black" d="M3644.75,-831.6C3753.29,-816.1 3890.45,-795.35 4021.53,-771.77"/>
<polygon fill="black" stroke="black" points="4022.54,-775.15 4031.76,-769.93 4021.3,-768.26 4022.54,-775.15"/>
</g>
<!-- s1_tp5_q_proj -->
<g id="node97" class="node">
<title>s1_tp5_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="4590,-771.54 4320,-771.54 4320,-708.54 4590,-708.54 4590,-771.54"/>
<text text-anchor="middle" x="4455" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP5</text>
<text text-anchor="middle" x="4455" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4455" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4455" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4455" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp5_q_proj -->
<g id="edge153" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp5_q_proj</title>
<path fill="none" stroke="black" d="M3658.64,-843.66C3831.49,-830 4082.14,-806.72 4309.66,-771.69"/>
<polygon fill="black" stroke="black" points="4310.45,-775.11 4319.79,-770.12 4309.37,-768.19 4310.45,-775.11"/>
</g>
<!-- s1_tp5_k_proj -->
<g id="node98" class="node">
<title>s1_tp5_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="4878,-771.54 4608,-771.54 4608,-708.54 4878,-708.54 4878,-771.54"/>
<text text-anchor="middle" x="4743" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP5</text>
<text text-anchor="middle" x="4743" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4743" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4743" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="4743" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp5_k_proj -->
<g id="edge154" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp5_k_proj</title>
<path fill="none" stroke="black" d="M3666.38,-850.68C3896.47,-840.42 4268.51,-818.16 4597.59,-771.67"/>
<polygon fill="black" stroke="black" points="4598.4,-775.09 4607.81,-770.22 4597.41,-768.16 4598.4,-775.09"/>
</g>
<!-- s1_tp5_v_proj -->
<g id="node99" class="node">
<title>s1_tp5_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="5166,-771.54 4896,-771.54 4896,-708.54 5166,-708.54 5166,-771.54"/>
<text text-anchor="middle" x="5031" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP5</text>
<text text-anchor="middle" x="5031" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5031" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5031" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5031" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp5_v_proj -->
<g id="edge155" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp5_v_proj</title>
<path fill="none" stroke="black" d="M3671.87,-855.26C3953.93,-848.81 4452.19,-829.65 4885.9,-771.62"/>
<polygon fill="black" stroke="black" points="4886.37,-775.08 4895.82,-770.28 4885.44,-768.15 4886.37,-775.08"/>
</g>
<!-- s1_tp6_q_proj -->
<g id="node104" class="node">
<title>s1_tp6_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="5454,-771.54 5184,-771.54 5184,-708.54 5454,-708.54 5454,-771.54"/>
<text text-anchor="middle" x="5319" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP6</text>
<text text-anchor="middle" x="5319" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5319" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5319" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5319" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp6_q_proj -->
<g id="edge156" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp6_q_proj</title>
<path fill="none" stroke="black" d="M3675.5,-858.52C4005.2,-855.92 4633.17,-841.28 5173.87,-771.61"/>
<polygon fill="black" stroke="black" points="5174.35,-775.08 5183.82,-770.32 5173.45,-768.14 5174.35,-775.08"/>
</g>
<!-- s1_tp6_k_proj -->
<g id="node105" class="node">
<title>s1_tp6_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="5742,-771.54 5472,-771.54 5472,-708.54 5742,-708.54 5742,-771.54"/>
<text text-anchor="middle" x="5607" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP6</text>
<text text-anchor="middle" x="5607" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5607" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5607" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5607" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp6_k_proj -->
<g id="edge157" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp6_k_proj</title>
<path fill="none" stroke="black" d="M3669.9,-853.58C4115.4,-842.9 5103.03,-815.23 5461.66,-771.61"/>
<polygon fill="black" stroke="black" points="5462.33,-775.06 5471.82,-770.35 5461.47,-768.11 5462.33,-775.06"/>
</g>
<!-- s1_tp6_v_proj -->
<g id="node106" class="node">
<title>s1_tp6_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="6030,-771.54 5760,-771.54 5760,-708.54 6030,-708.54 6030,-771.54"/>
<text text-anchor="middle" x="5895" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP6</text>
<text text-anchor="middle" x="5895" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5895" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5895" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="5895" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp6_v_proj -->
<g id="edge158" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp6_v_proj</title>
<path fill="none" stroke="black" d="M3671.55,-854.95C4165.46,-846.27 5334.47,-821.18 5749.86,-771.58"/>
<polygon fill="black" stroke="black" points="5750.32,-775.05 5759.83,-770.37 5749.48,-768.11 5750.32,-775.05"/>
</g>
<!-- s1_tp7_q_proj -->
<g id="node111" class="node">
<title>s1_tp7_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="6318,-771.54 6048,-771.54 6048,-708.54 6318,-708.54 6318,-771.54"/>
<text text-anchor="middle" x="6183" y="-759.54" font-family="Times,serif" font-size="10.00">S1 Q TP7</text>
<text text-anchor="middle" x="6183" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6183" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6183" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6183" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp7_q_proj -->
<g id="edge159" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp7_q_proj</title>
<path fill="none" stroke="black" d="M3672.69,-856.04C4212,-849.25 5565.1,-827.19 6037.85,-771.58"/>
<polygon fill="black" stroke="black" points="6038.32,-775.05 6047.83,-770.39 6037.48,-768.1 6038.32,-775.05"/>
</g>
<!-- s1_tp7_k_proj -->
<g id="node112" class="node">
<title>s1_tp7_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="6606,-771.54 6336,-771.54 6336,-708.54 6606,-708.54 6606,-771.54"/>
<text text-anchor="middle" x="6471" y="-759.54" font-family="Times,serif" font-size="10.00">S1 K TP7</text>
<text text-anchor="middle" x="6471" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6471" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6471" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6471" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp7_k_proj -->
<g id="edge160" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp7_k_proj</title>
<path fill="none" stroke="black" d="M3673.53,-856.92C4255.76,-851.93 5795.26,-833.24 6325.79,-771.59"/>
<polygon fill="black" stroke="black" points="6326.31,-775.05 6335.83,-770.4 6325.49,-768.1 6326.31,-775.05"/>
</g>
<!-- s1_tp7_v_proj -->
<g id="node113" class="node">
<title>s1_tp7_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="6894,-771.54 6624,-771.54 6624,-708.54 6894,-708.54 6894,-771.54"/>
<text text-anchor="middle" x="6759" y="-759.54" font-family="Times,serif" font-size="10.00">S1 V TP7</text>
<text text-anchor="middle" x="6759" y="-748.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6759" y="-737.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6759" y="-726.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="6759" y="-715.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- pipeline_comm&#45;&gt;s1_tp7_v_proj -->
<g id="edge161" class="edge">
<title>pipeline_comm&#45;&gt;s1_tp7_v_proj</title>
<path fill="none" stroke="black" d="M3674.33,-857.65C4297.47,-854.36 6024.83,-839.31 6613.54,-771.62"/>
<polygon fill="black" stroke="black" points="6614.31,-775.05 6623.83,-770.41 6613.49,-768.1 6614.31,-775.05"/>
</g>
<!-- stage1_label -->
<g id="node61" class="node">
<title>stage1_label</title>
<text text-anchor="middle" x="4023" y="-1672.03" font-family="Times,serif" font-size="10.00">STAGE 1 &#45; Devices 8&#45;15</text>
</g>
<!-- s1_tp0_attn -->
<g id="node65" class="node">
<title>s1_tp0_attn</title>
<polygon fill="lightgreen" stroke="black" points="696.5,-672.54 437.5,-672.54 437.5,-609.54 696.5,-609.54 696.5,-672.54"/>
<text text-anchor="middle" x="567" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP0</text>
<text text-anchor="middle" x="567" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="567" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="567" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="567" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp0_q_proj&#45;&gt;s1_tp0_attn -->
<g id="edge82" class="edge">
<title>s1_tp0_q_proj&#45;&gt;s1_tp0_attn</title>
<path fill="none" stroke="black" d="M270.21,-708.68C320.21,-697.45 376.96,-684.71 427.35,-673.39"/>
<polygon fill="black" stroke="black" points="428.35,-676.76 437.34,-671.15 426.82,-669.93 428.35,-676.76"/>
</g>
<!-- s1_tp0_k_proj&#45;&gt;s1_tp0_attn -->
<g id="edge83" class="edge">
<title>s1_tp0_k_proj&#45;&gt;s1_tp0_attn</title>
<path fill="none" stroke="black" d="M468.56,-708.35C482.61,-698.88 498.23,-688.37 512.8,-678.55"/>
<polygon fill="black" stroke="black" points="514.9,-681.35 521.24,-672.86 510.99,-675.55 514.9,-681.35"/>
</g>
<!-- s1_tp0_v_proj&#45;&gt;s1_tp0_attn -->
<g id="edge84" class="edge">
<title>s1_tp0_v_proj&#45;&gt;s1_tp0_attn</title>
<path fill="none" stroke="black" d="M665.44,-708.35C651.39,-698.88 635.77,-688.37 621.2,-678.55"/>
<polygon fill="black" stroke="black" points="623.01,-675.55 612.76,-672.86 619.1,-681.35 623.01,-675.55"/>
</g>
<!-- s1_tp0_mlp1 -->
<g id="node66" class="node">
<title>s1_tp0_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="992,-573.54 736,-573.54 736,-510.54 992,-510.54 992,-573.54"/>
<text text-anchor="middle" x="864" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP0</text>
<text text-anchor="middle" x="864" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="864" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="864" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="864" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp0_attn&#45;&gt;s1_tp0_mlp1 -->
<g id="edge85" class="edge">
<title>s1_tp0_attn&#45;&gt;s1_tp0_mlp1</title>
<path fill="none" stroke="black" d="M660.57,-609.48C692.44,-599.07 728.26,-587.37 760.85,-576.73"/>
<polygon fill="black" stroke="black" points="761.98,-580.04 770.4,-573.61 759.8,-573.39 761.98,-580.04"/>
</g>
<!-- s1_tp0_mlp2 -->
<g id="node67" class="node">
<title>s1_tp0_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="1141.5,-474.54 882.5,-474.54 882.5,-411.54 1141.5,-411.54 1141.5,-474.54"/>
<text text-anchor="middle" x="1012" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP0</text>
<text text-anchor="middle" x="1012" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1012" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="1012" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="1012" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp0_mlp1&#45;&gt;s1_tp0_mlp2 -->
<g id="edge86" class="edge">
<title>s1_tp0_mlp1&#45;&gt;s1_tp0_mlp2</title>
<path fill="none" stroke="black" d="M910.83,-510.35C925.34,-500.84 941.47,-490.26 956.51,-480.41"/>
<polygon fill="black" stroke="black" points="958.78,-483.11 965.22,-474.7 954.94,-477.25 958.78,-483.11"/>
</g>
<!-- s1_tp0_residual -->
<g id="node68" class="node">
<title>s1_tp0_residual</title>
<polygon fill="lightgray" stroke="black" points="1360.98,-375.54 923.55,-375.54 811.02,-249.54 1248.45,-249.54 1360.98,-375.54"/>
<text text-anchor="middle" x="1086" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP0</text>
<text text-anchor="middle" x="1086" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1086" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1086" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1086" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp0_mlp2&#45;&gt;s1_tp0_residual -->
<g id="edge87" class="edge">
<title>s1_tp0_mlp2&#45;&gt;s1_tp0_residual</title>
<path fill="none" stroke="black" d="M1029.72,-411.26C1034.47,-403.02 1039.81,-393.75 1045.25,-384.3"/>
<polygon fill="black" stroke="black" points="1048.31,-386 1050.27,-375.59 1042.24,-382.51 1048.31,-386"/>
</g>
<!-- s1_allreduce -->
<g id="node118" class="node">
<title>s1_allreduce</title>
<polygon fill="orange" stroke="black" points="3651.43,-213.54 3192.6,-213.54 3074.57,-109.54 3533.4,-109.54 3651.43,-213.54"/>
<text text-anchor="middle" x="3363" y="-175.54" font-family="Times,serif" font-size="10.00">Stage 1 All&#45;Reduce</text>
<text text-anchor="middle" x="3363" y="-164.54" font-family="Times,serif" font-size="10.00">Cross&#45;GPU reduction</text>
<text text-anchor="middle" x="3363" y="-153.54" font-family="Times,serif" font-size="10.00">Input: 8×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3363" y="-142.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- s1_tp0_residual&#45;&gt;s1_allreduce -->
<g id="edge130" class="edge">
<title>s1_tp0_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M1278.53,-282.91C1365.28,-270.94 1469.11,-257.9 1563,-249.54 2124.25,-199.58 2786.68,-176.86 3130.15,-167.77"/>
<polygon fill="black" stroke="black" points="3130.31,-171.27 3140.22,-167.51 3130.13,-164.27 3130.31,-171.27"/>
</g>
<!-- s1_tp1_attn -->
<g id="node72" class="node">
<title>s1_tp1_attn</title>
<polygon fill="lightgreen" stroke="black" points="1560.5,-672.54 1301.5,-672.54 1301.5,-609.54 1560.5,-609.54 1560.5,-672.54"/>
<text text-anchor="middle" x="1431" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP1</text>
<text text-anchor="middle" x="1431" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1431" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="1431" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1431" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp1_q_proj&#45;&gt;s1_tp1_attn -->
<g id="edge88" class="edge">
<title>s1_tp1_q_proj&#45;&gt;s1_tp1_attn</title>
<path fill="none" stroke="black" d="M1134.21,-708.68C1184.21,-697.45 1240.96,-684.71 1291.35,-673.39"/>
<polygon fill="black" stroke="black" points="1292.35,-676.76 1301.34,-671.15 1290.82,-669.93 1292.35,-676.76"/>
</g>
<!-- s1_tp1_k_proj&#45;&gt;s1_tp1_attn -->
<g id="edge89" class="edge">
<title>s1_tp1_k_proj&#45;&gt;s1_tp1_attn</title>
<path fill="none" stroke="black" d="M1332.56,-708.35C1346.61,-698.88 1362.23,-688.37 1376.8,-678.55"/>
<polygon fill="black" stroke="black" points="1378.9,-681.35 1385.24,-672.86 1374.99,-675.55 1378.9,-681.35"/>
</g>
<!-- s1_tp1_v_proj&#45;&gt;s1_tp1_attn -->
<g id="edge90" class="edge">
<title>s1_tp1_v_proj&#45;&gt;s1_tp1_attn</title>
<path fill="none" stroke="black" d="M1529.44,-708.35C1515.39,-698.88 1499.77,-688.37 1485.2,-678.55"/>
<polygon fill="black" stroke="black" points="1487.01,-675.55 1476.76,-672.86 1483.1,-681.35 1487.01,-675.55"/>
</g>
<!-- s1_tp1_mlp1 -->
<g id="node73" class="node">
<title>s1_tp1_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="1719,-573.54 1463,-573.54 1463,-510.54 1719,-510.54 1719,-573.54"/>
<text text-anchor="middle" x="1591" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP1</text>
<text text-anchor="middle" x="1591" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1591" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="1591" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1591" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp1_attn&#45;&gt;s1_tp1_mlp1 -->
<g id="edge91" class="edge">
<title>s1_tp1_attn&#45;&gt;s1_tp1_mlp1</title>
<path fill="none" stroke="black" d="M1481.62,-609.35C1497.46,-599.75 1515.08,-589.07 1531.47,-579.13"/>
<polygon fill="black" stroke="black" points="1533.69,-581.87 1540.43,-573.7 1530.06,-575.89 1533.69,-581.87"/>
</g>
<!-- s1_tp1_mlp2 -->
<g id="node74" class="node">
<title>s1_tp1_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="1850.5,-474.54 1591.5,-474.54 1591.5,-411.54 1850.5,-411.54 1850.5,-474.54"/>
<text text-anchor="middle" x="1721" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP1</text>
<text text-anchor="middle" x="1721" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1721" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="1721" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="1721" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp1_mlp1&#45;&gt;s1_tp1_mlp2 -->
<g id="edge92" class="edge">
<title>s1_tp1_mlp1&#45;&gt;s1_tp1_mlp2</title>
<path fill="none" stroke="black" d="M1632.13,-510.35C1644.58,-501.06 1658.39,-490.76 1671.33,-481.1"/>
<polygon fill="black" stroke="black" points="1673.77,-483.65 1679.69,-474.86 1669.58,-478.04 1673.77,-483.65"/>
</g>
<!-- s1_tp1_residual -->
<g id="node75" class="node">
<title>s1_tp1_residual</title>
<polygon fill="lightgray" stroke="black" points="2121.98,-375.54 1684.55,-375.54 1572.02,-249.54 2009.45,-249.54 2121.98,-375.54"/>
<text text-anchor="middle" x="1847" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP1</text>
<text text-anchor="middle" x="1847" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1847" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1847" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="1847" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp1_mlp2&#45;&gt;s1_tp1_residual -->
<g id="edge93" class="edge">
<title>s1_tp1_mlp2&#45;&gt;s1_tp1_residual</title>
<path fill="none" stroke="black" d="M1751.18,-411.26C1759.67,-402.6 1769.27,-392.81 1779.03,-382.85"/>
<polygon fill="black" stroke="black" points="1781.65,-385.18 1786.15,-375.59 1776.65,-380.28 1781.65,-385.18"/>
</g>
<!-- s1_tp1_residual&#45;&gt;s1_allreduce -->
<g id="edge131" class="edge">
<title>s1_tp1_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M2029.99,-272.21C2074.64,-263.68 2122.4,-255.46 2167,-249.54 2501.55,-205.12 2891.99,-182.07 3133.38,-171.14"/>
<polygon fill="black" stroke="black" points="3133.86,-174.62 3143.69,-170.67 3133.54,-167.63 3133.86,-174.62"/>
</g>
<!-- s1_tp2_attn -->
<g id="node79" class="node">
<title>s1_tp2_attn</title>
<polygon fill="lightgreen" stroke="black" points="2475.5,-672.54 2216.5,-672.54 2216.5,-609.54 2475.5,-609.54 2475.5,-672.54"/>
<text text-anchor="middle" x="2346" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP2</text>
<text text-anchor="middle" x="2346" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2346" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="2346" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2346" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp2_q_proj&#45;&gt;s1_tp2_attn -->
<g id="edge94" class="edge">
<title>s1_tp2_q_proj&#45;&gt;s1_tp2_attn</title>
<path fill="none" stroke="black" d="M1998.27,-710.33C2001.21,-709.72 2004.12,-709.13 2007,-708.54 2072.41,-695.2 2145.02,-680.89 2206.21,-668.97"/>
<polygon fill="black" stroke="black" points="2207.18,-672.35 2216.32,-667 2205.84,-665.48 2207.18,-672.35"/>
</g>
<!-- s1_tp2_k_proj&#45;&gt;s1_tp2_attn -->
<g id="edge95" class="edge">
<title>s1_tp2_k_proj&#45;&gt;s1_tp2_attn</title>
<path fill="none" stroke="black" d="M2212.43,-708.48C2232.46,-698.52 2254.86,-687.37 2275.51,-677.11"/>
<polygon fill="black" stroke="black" points="2277.15,-680.2 2284.54,-672.61 2274.03,-673.93 2277.15,-680.2"/>
</g>
<!-- s1_tp2_v_proj&#45;&gt;s1_tp2_attn -->
<g id="edge96" class="edge">
<title>s1_tp2_v_proj&#45;&gt;s1_tp2_attn</title>
<path fill="none" stroke="black" d="M2409.57,-708.35C2401.01,-699.41 2391.54,-689.54 2382.59,-680.21"/>
<polygon fill="black" stroke="black" points="2385,-677.66 2375.55,-672.86 2379.95,-682.5 2385,-677.66"/>
</g>
<!-- s1_tp2_mlp1 -->
<g id="node80" class="node">
<title>s1_tp2_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="2541,-573.54 2285,-573.54 2285,-510.54 2541,-510.54 2541,-573.54"/>
<text text-anchor="middle" x="2413" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP2</text>
<text text-anchor="middle" x="2413" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2413" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="2413" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2413" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp2_attn&#45;&gt;s1_tp2_mlp1 -->
<g id="edge97" class="edge">
<title>s1_tp2_attn&#45;&gt;s1_tp2_mlp1</title>
<path fill="none" stroke="black" d="M2367.2,-609.35C2373.13,-600.77 2379.65,-591.32 2385.87,-582.32"/>
<polygon fill="black" stroke="black" points="2388.91,-584.08 2391.71,-573.86 2383.15,-580.1 2388.91,-584.08"/>
</g>
<!-- s1_tp2_mlp2 -->
<g id="node81" class="node">
<title>s1_tp2_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="2546.5,-474.54 2287.5,-474.54 2287.5,-411.54 2546.5,-411.54 2546.5,-474.54"/>
<text text-anchor="middle" x="2417" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP2</text>
<text text-anchor="middle" x="2417" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2417" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="2417" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="2417" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp2_mlp1&#45;&gt;s1_tp2_mlp2 -->
<g id="edge98" class="edge">
<title>s1_tp2_mlp1&#45;&gt;s1_tp2_mlp2</title>
<path fill="none" stroke="black" d="M2414.27,-510.35C2414.6,-502.3 2414.96,-493.49 2415.31,-484.99"/>
<polygon fill="black" stroke="black" points="2418.81,-485 2415.73,-474.86 2411.82,-484.71 2418.81,-485"/>
</g>
<!-- s1_tp2_residual -->
<g id="node82" class="node">
<title>s1_tp2_residual</title>
<polygon fill="lightgray" stroke="black" points="2725.98,-375.54 2288.55,-375.54 2176.02,-249.54 2613.45,-249.54 2725.98,-375.54"/>
<text text-anchor="middle" x="2451" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP2</text>
<text text-anchor="middle" x="2451" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2451" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2451" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="2451" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp2_mlp2&#45;&gt;s1_tp2_residual -->
<g id="edge99" class="edge">
<title>s1_tp2_mlp2&#45;&gt;s1_tp2_residual</title>
<path fill="none" stroke="black" d="M2425.14,-411.26C2427.24,-403.35 2429.58,-394.51 2431.97,-385.46"/>
<polygon fill="black" stroke="black" points="2435.41,-386.15 2434.58,-375.59 2428.64,-384.36 2435.41,-386.15"/>
</g>
<!-- s1_tp2_residual&#45;&gt;s1_allreduce -->
<g id="edge132" class="edge">
<title>s1_tp2_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M2638.41,-276.96C2689.48,-267.78 2744.83,-258.06 2796,-249.54 2915.55,-229.63 3049.58,-208.99 3157.3,-192.81"/>
<polygon fill="black" stroke="black" points="3157.94,-196.25 3167.31,-191.31 3156.9,-189.33 3157.94,-196.25"/>
</g>
<!-- s1_tp3_attn -->
<g id="node86" class="node">
<title>s1_tp3_attn</title>
<polygon fill="lightgreen" stroke="black" points="3144.5,-672.54 2885.5,-672.54 2885.5,-609.54 3144.5,-609.54 3144.5,-672.54"/>
<text text-anchor="middle" x="3015" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP3</text>
<text text-anchor="middle" x="3015" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3015" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="3015" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3015" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp3_q_proj&#45;&gt;s1_tp3_attn -->
<g id="edge100" class="edge">
<title>s1_tp3_q_proj&#45;&gt;s1_tp3_attn</title>
<path fill="none" stroke="black" d="M2817.73,-708.48C2848.51,-698.11 2883.07,-686.47 2914.56,-675.87"/>
<polygon fill="black" stroke="black" points="2915.87,-679.12 2924.23,-672.61 2913.64,-672.49 2915.87,-679.12"/>
</g>
<!-- s1_tp3_k_proj&#45;&gt;s1_tp3_attn -->
<g id="edge101" class="edge">
<title>s1_tp3_k_proj&#45;&gt;s1_tp3_attn</title>
<path fill="none" stroke="black" d="M3015,-708.35C3015,-700.3 3015,-691.49 3015,-682.99"/>
<polygon fill="black" stroke="black" points="3018.5,-682.86 3015,-672.86 3011.5,-682.86 3018.5,-682.86"/>
</g>
<!-- s1_tp3_v_proj&#45;&gt;s1_tp3_attn -->
<g id="edge102" class="edge">
<title>s1_tp3_v_proj&#45;&gt;s1_tp3_attn</title>
<path fill="none" stroke="black" d="M3212.27,-708.48C3181.49,-698.11 3146.93,-686.47 3115.44,-675.87"/>
<polygon fill="black" stroke="black" points="3116.36,-672.49 3105.77,-672.61 3114.13,-679.12 3116.36,-672.49"/>
</g>
<!-- s1_tp3_mlp1 -->
<g id="node87" class="node">
<title>s1_tp3_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="3162,-573.54 2906,-573.54 2906,-510.54 3162,-510.54 3162,-573.54"/>
<text text-anchor="middle" x="3034" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP3</text>
<text text-anchor="middle" x="3034" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3034" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3034" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3034" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp3_attn&#45;&gt;s1_tp3_mlp1 -->
<g id="edge103" class="edge">
<title>s1_tp3_attn&#45;&gt;s1_tp3_mlp1</title>
<path fill="none" stroke="black" d="M3021.01,-609.35C3022.61,-601.21 3024.35,-592.29 3026.03,-583.71"/>
<polygon fill="black" stroke="black" points="3029.47,-584.35 3027.96,-573.86 3022.61,-583 3029.47,-584.35"/>
</g>
<!-- s1_tp3_mlp2 -->
<g id="node88" class="node">
<title>s1_tp3_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="3200.5,-474.54 2941.5,-474.54 2941.5,-411.54 3200.5,-411.54 3200.5,-474.54"/>
<text text-anchor="middle" x="3071" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP3</text>
<text text-anchor="middle" x="3071" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3071" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="3071" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="3071" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp3_mlp1&#45;&gt;s1_tp3_mlp2 -->
<g id="edge104" class="edge">
<title>s1_tp3_mlp1&#45;&gt;s1_tp3_mlp2</title>
<path fill="none" stroke="black" d="M3045.71,-510.35C3048.85,-502.12 3052.29,-493.1 3055.59,-484.44"/>
<polygon fill="black" stroke="black" points="3058.95,-485.45 3059.24,-474.86 3052.41,-482.96 3058.95,-485.45"/>
</g>
<!-- s1_tp3_residual -->
<g id="node89" class="node">
<title>s1_tp3_residual</title>
<polygon fill="lightgray" stroke="black" points="3354.98,-375.54 2917.55,-375.54 2805.02,-249.54 3242.45,-249.54 3354.98,-375.54"/>
<text text-anchor="middle" x="3080" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP3</text>
<text text-anchor="middle" x="3080" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3080" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3080" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3080" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp3_mlp2&#45;&gt;s1_tp3_residual -->
<g id="edge105" class="edge">
<title>s1_tp3_mlp2&#45;&gt;s1_tp3_residual</title>
<path fill="none" stroke="black" d="M3073.16,-411.26C3073.7,-403.44 3074.32,-394.7 3074.94,-385.75"/>
<polygon fill="black" stroke="black" points="3078.45,-385.81 3075.65,-375.59 3071.46,-385.32 3078.45,-385.81"/>
</g>
<!-- s1_tp3_residual&#45;&gt;s1_allreduce -->
<g id="edge133" class="edge">
<title>s1_tp3_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M3197.97,-249.43C3217.48,-239.16 3237.6,-228.56 3256.8,-218.46"/>
<polygon fill="black" stroke="black" points="3258.62,-221.45 3265.84,-213.69 3255.36,-215.26 3258.62,-221.45"/>
</g>
<!-- s1_tp4_attn -->
<g id="node93" class="node">
<title>s1_tp4_attn</title>
<polygon fill="lightgreen" stroke="black" points="4003.5,-672.54 3744.5,-672.54 3744.5,-609.54 4003.5,-609.54 4003.5,-672.54"/>
<text text-anchor="middle" x="3874" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP4</text>
<text text-anchor="middle" x="3874" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3874" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="3874" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3874" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp4_q_proj&#45;&gt;s1_tp4_attn -->
<g id="edge106" class="edge">
<title>s1_tp4_q_proj&#45;&gt;s1_tp4_attn</title>
<path fill="none" stroke="black" d="M3680.15,-708.48C3710.4,-698.11 3744.36,-686.47 3775.31,-675.87"/>
<polygon fill="black" stroke="black" points="3776.48,-679.16 3784.81,-672.61 3774.21,-672.54 3776.48,-679.16"/>
</g>
<!-- s1_tp4_k_proj&#45;&gt;s1_tp4_attn -->
<g id="edge107" class="edge">
<title>s1_tp4_k_proj&#45;&gt;s1_tp4_attn</title>
<path fill="none" stroke="black" d="M3877.42,-708.35C3877,-700.3 3876.55,-691.49 3876.11,-682.99"/>
<polygon fill="black" stroke="black" points="3879.6,-682.67 3875.59,-672.86 3872.61,-683.03 3879.6,-682.67"/>
</g>
<!-- s1_tp4_v_proj&#45;&gt;s1_tp4_attn -->
<g id="edge108" class="edge">
<title>s1_tp4_v_proj&#45;&gt;s1_tp4_attn</title>
<path fill="none" stroke="black" d="M4074.7,-708.48C4043.38,-698.11 4008.22,-686.47 3976.18,-675.87"/>
<polygon fill="black" stroke="black" points="3976.94,-672.43 3966.34,-672.61 3974.74,-679.08 3976.94,-672.43"/>
</g>
<!-- s1_tp4_mlp1 -->
<g id="node94" class="node">
<title>s1_tp4_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="4000,-573.54 3744,-573.54 3744,-510.54 4000,-510.54 4000,-573.54"/>
<text text-anchor="middle" x="3872" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP4</text>
<text text-anchor="middle" x="3872" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3872" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="3872" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3872" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp4_attn&#45;&gt;s1_tp4_mlp1 -->
<g id="edge109" class="edge">
<title>s1_tp4_attn&#45;&gt;s1_tp4_mlp1</title>
<path fill="none" stroke="black" d="M3873.37,-609.35C3873.2,-601.3 3873.02,-592.49 3872.84,-583.99"/>
<polygon fill="black" stroke="black" points="3876.34,-583.79 3872.64,-573.86 3869.34,-583.93 3876.34,-583.79"/>
</g>
<!-- s1_tp4_mlp2 -->
<g id="node95" class="node">
<title>s1_tp4_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="3926.5,-474.54 3667.5,-474.54 3667.5,-411.54 3926.5,-411.54 3926.5,-474.54"/>
<text text-anchor="middle" x="3797" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP4</text>
<text text-anchor="middle" x="3797" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3797" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="3797" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="3797" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp4_mlp1&#45;&gt;s1_tp4_mlp2 -->
<g id="edge110" class="edge">
<title>s1_tp4_mlp1&#45;&gt;s1_tp4_mlp2</title>
<path fill="none" stroke="black" d="M3848.27,-510.35C3841.57,-501.68 3834.18,-492.13 3827.16,-483.04"/>
<polygon fill="black" stroke="black" points="3829.72,-480.63 3820.83,-474.86 3824.18,-484.92 3829.72,-480.63"/>
</g>
<!-- s1_tp4_residual -->
<g id="node96" class="node">
<title>s1_tp4_residual</title>
<polygon fill="lightgray" stroke="black" points="3923.98,-375.54 3486.55,-375.54 3374.02,-249.54 3811.45,-249.54 3923.98,-375.54"/>
<text text-anchor="middle" x="3649" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP4</text>
<text text-anchor="middle" x="3649" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3649" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3649" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="3649" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp4_mlp2&#45;&gt;s1_tp4_residual -->
<g id="edge111" class="edge">
<title>s1_tp4_mlp2&#45;&gt;s1_tp4_residual</title>
<path fill="none" stroke="black" d="M3761.55,-411.26C3751.38,-402.43 3739.86,-392.43 3728.17,-382.27"/>
<polygon fill="black" stroke="black" points="3730.31,-379.51 3720.47,-375.59 3725.73,-384.79 3730.31,-379.51"/>
</g>
<!-- s1_tp4_residual&#45;&gt;s1_allreduce -->
<g id="edge134" class="edge">
<title>s1_tp4_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M3529.78,-249.43C3509.98,-239.11 3489.55,-228.47 3470.07,-218.32"/>
<polygon fill="black" stroke="black" points="3471.68,-215.21 3461.19,-213.69 3468.44,-221.42 3471.68,-215.21"/>
</g>
<!-- s1_tp5_attn -->
<g id="node100" class="node">
<title>s1_tp5_attn</title>
<polygon fill="lightgreen" stroke="black" points="4728.5,-672.54 4469.5,-672.54 4469.5,-609.54 4728.5,-609.54 4728.5,-672.54"/>
<text text-anchor="middle" x="4599" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP5</text>
<text text-anchor="middle" x="4599" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4599" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="4599" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4599" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp5_q_proj&#45;&gt;s1_tp5_attn -->
<g id="edge112" class="edge">
<title>s1_tp5_q_proj&#45;&gt;s1_tp5_attn</title>
<path fill="none" stroke="black" d="M4500.56,-708.35C4514.61,-698.88 4530.23,-688.37 4544.8,-678.55"/>
<polygon fill="black" stroke="black" points="4546.9,-681.35 4553.24,-672.86 4542.99,-675.55 4546.9,-681.35"/>
</g>
<!-- s1_tp5_k_proj&#45;&gt;s1_tp5_attn -->
<g id="edge113" class="edge">
<title>s1_tp5_k_proj&#45;&gt;s1_tp5_attn</title>
<path fill="none" stroke="black" d="M4697.44,-708.35C4683.39,-698.88 4667.77,-688.37 4653.2,-678.55"/>
<polygon fill="black" stroke="black" points="4655.01,-675.55 4644.76,-672.86 4651.1,-681.35 4655.01,-675.55"/>
</g>
<!-- s1_tp5_v_proj&#45;&gt;s1_tp5_attn -->
<g id="edge114" class="edge">
<title>s1_tp5_v_proj&#45;&gt;s1_tp5_attn</title>
<path fill="none" stroke="black" d="M4895.79,-708.68C4845.79,-697.45 4789.04,-684.71 4738.65,-673.39"/>
<polygon fill="black" stroke="black" points="4739.18,-669.93 4728.66,-671.15 4737.65,-676.76 4739.18,-669.93"/>
</g>
<!-- s1_tp5_mlp1 -->
<g id="node101" class="node">
<title>s1_tp5_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="4348,-573.54 4092,-573.54 4092,-510.54 4348,-510.54 4348,-573.54"/>
<text text-anchor="middle" x="4220" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP5</text>
<text text-anchor="middle" x="4220" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4220" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="4220" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4220" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp5_attn&#45;&gt;s1_tp5_mlp1 -->
<g id="edge115" class="edge">
<title>s1_tp5_attn&#45;&gt;s1_tp5_mlp1</title>
<path fill="none" stroke="black" d="M4479.6,-609.48C4438.14,-598.87 4391.45,-586.92 4349.23,-576.11"/>
<polygon fill="black" stroke="black" points="4350,-572.7 4339.45,-573.61 4348.27,-579.48 4350,-572.7"/>
</g>
<!-- s1_tp5_mlp2 -->
<g id="node102" class="node">
<title>s1_tp5_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="4348.5,-474.54 4089.5,-474.54 4089.5,-411.54 4348.5,-411.54 4348.5,-474.54"/>
<text text-anchor="middle" x="4219" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP5</text>
<text text-anchor="middle" x="4219" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4219" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="4219" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="4219" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp5_mlp1&#45;&gt;s1_tp5_mlp2 -->
<g id="edge116" class="edge">
<title>s1_tp5_mlp1&#45;&gt;s1_tp5_mlp2</title>
<path fill="none" stroke="black" d="M4219.68,-510.35C4219.6,-502.3 4219.51,-493.49 4219.42,-484.99"/>
<polygon fill="black" stroke="black" points="4222.92,-484.83 4219.32,-474.86 4215.92,-484.9 4222.92,-484.83"/>
</g>
<!-- s1_tp5_residual -->
<g id="node103" class="node">
<title>s1_tp5_residual</title>
<polygon fill="lightgray" stroke="black" points="4491.98,-375.54 4054.55,-375.54 3942.02,-249.54 4379.45,-249.54 4491.98,-375.54"/>
<text text-anchor="middle" x="4217" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP5</text>
<text text-anchor="middle" x="4217" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4217" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4217" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="4217" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp5_mlp2&#45;&gt;s1_tp5_residual -->
<g id="edge117" class="edge">
<title>s1_tp5_mlp2&#45;&gt;s1_tp5_residual</title>
<path fill="none" stroke="black" d="M4218.52,-411.26C4218.4,-403.44 4218.26,-394.7 4218.12,-385.75"/>
<polygon fill="black" stroke="black" points="4221.62,-385.54 4217.97,-375.59 4214.62,-385.65 4221.62,-385.54"/>
</g>
<!-- s1_tp5_residual&#45;&gt;s1_allreduce -->
<g id="edge135" class="edge">
<title>s1_tp5_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M3943.48,-251.5C3939.97,-250.84 3936.47,-250.18 3933,-249.54 3840.29,-232.36 3738.63,-216.05 3647.17,-202.28"/>
<polygon fill="black" stroke="black" points="3647.62,-198.81 3637.21,-200.79 3646.58,-205.74 3647.62,-198.81"/>
</g>
<!-- s1_tp6_attn -->
<g id="node107" class="node">
<title>s1_tp6_attn</title>
<polygon fill="lightgreen" stroke="black" points="5592.5,-672.54 5333.5,-672.54 5333.5,-609.54 5592.5,-609.54 5592.5,-672.54"/>
<text text-anchor="middle" x="5463" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP6</text>
<text text-anchor="middle" x="5463" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5463" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="5463" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5463" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp6_q_proj&#45;&gt;s1_tp6_attn -->
<g id="edge118" class="edge">
<title>s1_tp6_q_proj&#45;&gt;s1_tp6_attn</title>
<path fill="none" stroke="black" d="M5364.56,-708.35C5378.61,-698.88 5394.23,-688.37 5408.8,-678.55"/>
<polygon fill="black" stroke="black" points="5410.9,-681.35 5417.24,-672.86 5406.99,-675.55 5410.9,-681.35"/>
</g>
<!-- s1_tp6_k_proj&#45;&gt;s1_tp6_attn -->
<g id="edge119" class="edge">
<title>s1_tp6_k_proj&#45;&gt;s1_tp6_attn</title>
<path fill="none" stroke="black" d="M5561.44,-708.35C5547.39,-698.88 5531.77,-688.37 5517.2,-678.55"/>
<polygon fill="black" stroke="black" points="5519.01,-675.55 5508.76,-672.86 5515.1,-681.35 5519.01,-675.55"/>
</g>
<!-- s1_tp6_v_proj&#45;&gt;s1_tp6_attn -->
<g id="edge120" class="edge">
<title>s1_tp6_v_proj&#45;&gt;s1_tp6_attn</title>
<path fill="none" stroke="black" d="M5759.79,-708.68C5709.79,-697.45 5653.04,-684.71 5602.65,-673.39"/>
<polygon fill="black" stroke="black" points="5603.18,-669.93 5592.66,-671.15 5601.65,-676.76 5603.18,-669.93"/>
</g>
<!-- s1_tp6_mlp1 -->
<g id="node108" class="node">
<title>s1_tp6_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="5388,-573.54 5132,-573.54 5132,-510.54 5388,-510.54 5388,-573.54"/>
<text text-anchor="middle" x="5260" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP6</text>
<text text-anchor="middle" x="5260" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5260" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="5260" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5260" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp6_attn&#45;&gt;s1_tp6_mlp1 -->
<g id="edge121" class="edge">
<title>s1_tp6_attn&#45;&gt;s1_tp6_mlp1</title>
<path fill="none" stroke="black" d="M5399.05,-609.48C5378.1,-599.47 5354.67,-588.27 5333.1,-577.97"/>
<polygon fill="black" stroke="black" points="5334.51,-574.76 5323.98,-573.61 5331.49,-581.08 5334.51,-574.76"/>
</g>
<!-- s1_tp6_mlp2 -->
<g id="node109" class="node">
<title>s1_tp6_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="5330.5,-474.54 5071.5,-474.54 5071.5,-411.54 5330.5,-411.54 5330.5,-474.54"/>
<text text-anchor="middle" x="5201" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP6</text>
<text text-anchor="middle" x="5201" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5201" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="5201" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="5201" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp6_mlp1&#45;&gt;s1_tp6_mlp2 -->
<g id="edge122" class="edge">
<title>s1_tp6_mlp1&#45;&gt;s1_tp6_mlp2</title>
<path fill="none" stroke="black" d="M5241.33,-510.35C5236.17,-501.86 5230.49,-492.52 5225.06,-483.6"/>
<polygon fill="black" stroke="black" points="5227.94,-481.59 5219.75,-474.86 5221.96,-485.23 5227.94,-481.59"/>
</g>
<!-- s1_tp6_residual -->
<g id="node110" class="node">
<title>s1_tp6_residual</title>
<polygon fill="lightgray" stroke="black" points="5358.98,-375.54 4921.55,-375.54 4809.02,-249.54 5246.45,-249.54 5358.98,-375.54"/>
<text text-anchor="middle" x="5084" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP6</text>
<text text-anchor="middle" x="5084" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5084" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5084" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5084" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp6_mlp2&#45;&gt;s1_tp6_residual -->
<g id="edge123" class="edge">
<title>s1_tp6_mlp2&#45;&gt;s1_tp6_residual</title>
<path fill="none" stroke="black" d="M5172.98,-411.26C5165.16,-402.68 5156.35,-393 5147.38,-383.14"/>
<polygon fill="black" stroke="black" points="5149.82,-380.63 5140.5,-375.59 5144.64,-385.34 5149.82,-380.63"/>
</g>
<!-- s1_tp6_residual&#45;&gt;s1_allreduce -->
<g id="edge136" class="edge">
<title>s1_tp6_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M4839.5,-283.91C4735.26,-272.55 4612.25,-259.7 4501,-249.54 4200.11,-222.04 3853.92,-196.44 3623.15,-180.22"/>
<polygon fill="black" stroke="black" points="3623.15,-176.72 3612.93,-179.51 3622.66,-183.7 3623.15,-176.72"/>
</g>
<!-- s1_tp7_attn -->
<g id="node114" class="node">
<title>s1_tp7_attn</title>
<polygon fill="lightgreen" stroke="black" points="6456.5,-672.54 6197.5,-672.54 6197.5,-609.54 6456.5,-609.54 6456.5,-672.54"/>
<text text-anchor="middle" x="6327" y="-660.54" font-family="Times,serif" font-size="10.00">S1 Attn TP7</text>
<text text-anchor="middle" x="6327" y="-649.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6327" y="-638.54" font-family="Times,serif" font-size="10.00">Multi&#45;head slice</text>
<text text-anchor="middle" x="6327" y="-627.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="6327" y="-616.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp7_q_proj&#45;&gt;s1_tp7_attn -->
<g id="edge124" class="edge">
<title>s1_tp7_q_proj&#45;&gt;s1_tp7_attn</title>
<path fill="none" stroke="black" d="M6228.56,-708.35C6242.61,-698.88 6258.23,-688.37 6272.8,-678.55"/>
<polygon fill="black" stroke="black" points="6274.9,-681.35 6281.24,-672.86 6270.99,-675.55 6274.9,-681.35"/>
</g>
<!-- s1_tp7_k_proj&#45;&gt;s1_tp7_attn -->
<g id="edge125" class="edge">
<title>s1_tp7_k_proj&#45;&gt;s1_tp7_attn</title>
<path fill="none" stroke="black" d="M6425.44,-708.35C6411.39,-698.88 6395.77,-688.37 6381.2,-678.55"/>
<polygon fill="black" stroke="black" points="6383.01,-675.55 6372.76,-672.86 6379.1,-681.35 6383.01,-675.55"/>
</g>
<!-- s1_tp7_v_proj&#45;&gt;s1_tp7_attn -->
<g id="edge126" class="edge">
<title>s1_tp7_v_proj&#45;&gt;s1_tp7_attn</title>
<path fill="none" stroke="black" d="M6623.79,-708.68C6573.79,-697.45 6517.04,-684.71 6466.65,-673.39"/>
<polygon fill="black" stroke="black" points="6467.18,-669.93 6456.66,-671.15 6465.65,-676.76 6467.18,-669.93"/>
</g>
<!-- s1_tp7_mlp1 -->
<g id="node115" class="node">
<title>s1_tp7_mlp1</title>
<polygon fill="lightcoral" stroke="black" points="6252,-573.54 5996,-573.54 5996,-510.54 6252,-510.54 6252,-573.54"/>
<text text-anchor="middle" x="6124" y="-561.54" font-family="Times,serif" font-size="10.00">S1 MLP1 TP7</text>
<text text-anchor="middle" x="6124" y="-550.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6124" y="-539.54" font-family="Times,serif" font-size="10.00">Column parallel</text>
<text text-anchor="middle" x="6124" y="-528.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="6124" y="-517.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, ffn=1024]</text>
</g>
<!-- s1_tp7_attn&#45;&gt;s1_tp7_mlp1 -->
<g id="edge127" class="edge">
<title>s1_tp7_attn&#45;&gt;s1_tp7_mlp1</title>
<path fill="none" stroke="black" d="M6263.05,-609.48C6242.1,-599.47 6218.67,-588.27 6197.1,-577.97"/>
<polygon fill="black" stroke="black" points="6198.51,-574.76 6187.98,-573.61 6195.49,-581.08 6198.51,-574.76"/>
</g>
<!-- s1_tp7_mlp2 -->
<g id="node116" class="node">
<title>s1_tp7_mlp2</title>
<polygon fill="lightcoral" stroke="black" points="6195.5,-474.54 5936.5,-474.54 5936.5,-411.54 6195.5,-411.54 6195.5,-474.54"/>
<text text-anchor="middle" x="6066" y="-462.54" font-family="Times,serif" font-size="10.00">S1 MLP2 TP7</text>
<text text-anchor="middle" x="6066" y="-451.54" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6066" y="-440.54" font-family="Times,serif" font-size="10.00">Row parallel</text>
<text text-anchor="middle" x="6066" y="-429.54" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, ffn=1024]</text>
<text text-anchor="middle" x="6066" y="-418.54" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp7_mlp1&#45;&gt;s1_tp7_mlp2 -->
<g id="edge128" class="edge">
<title>s1_tp7_mlp1&#45;&gt;s1_tp7_mlp2</title>
<path fill="none" stroke="black" d="M6105.65,-510.35C6100.57,-501.86 6094.99,-492.52 6089.65,-483.6"/>
<polygon fill="black" stroke="black" points="6092.57,-481.65 6084.43,-474.86 6086.56,-485.24 6092.57,-481.65"/>
</g>
<!-- s1_tp7_residual -->
<g id="node117" class="node">
<title>s1_tp7_residual</title>
<polygon fill="lightgray" stroke="black" points="6223.98,-375.54 5786.55,-375.54 5674.02,-249.54 6111.45,-249.54 6223.98,-375.54"/>
<text text-anchor="middle" x="5949" y="-332.04" font-family="Times,serif" font-size="10.00">S1 Residual TP7</text>
<text text-anchor="middle" x="5949" y="-321.04" font-family="Times,serif" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5949" y="-310.04" font-family="Times,serif" font-size="10.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5949" y="-299.04" font-family="Times,serif" font-size="10.00">Input: 2×[batch=128, seq_len=10000, slice=512]</text>
<text text-anchor="middle" x="5949" y="-288.04" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, slice=512]</text>
</g>
<!-- s1_tp7_mlp2&#45;&gt;s1_tp7_residual -->
<g id="edge129" class="edge">
<title>s1_tp7_mlp2&#45;&gt;s1_tp7_residual</title>
<path fill="none" stroke="black" d="M6037.98,-411.26C6030.16,-402.68 6021.35,-393 6012.38,-383.14"/>
<polygon fill="black" stroke="black" points="6014.82,-380.63 6005.5,-375.59 6009.64,-385.34 6014.82,-380.63"/>
</g>
<!-- s1_tp7_residual&#45;&gt;s1_allreduce -->
<g id="edge137" class="edge">
<title>s1_tp7_residual&#45;&gt;s1_allreduce</title>
<path fill="none" stroke="black" d="M5702.65,-281.79C5599.4,-270.22 5478.01,-257.79 5368,-249.54 4735.56,-202.12 3988.8,-178.15 3610.05,-168.26"/>
<polygon fill="black" stroke="black" points="3609.88,-164.75 3599.79,-167.99 3609.69,-171.75 3609.88,-164.75"/>
</g>
<!-- output -->
<g id="node119" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="3363" cy="-36.77" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="3363" y="-50.77" font-family="Times,serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="3363" y="-39.77" font-family="Times,serif" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="3363" y="-28.77" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="3363" y="-17.77" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- s1_allreduce&#45;&gt;output -->
<g id="edge162" class="edge">
<title>s1_allreduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3363,-109.19C3363,-100.78 3363,-92.11 3363,-83.84"/>
<polygon fill="black" stroke="black" points="3366.5,-83.63 3363,-73.63 3359.5,-83.63 3366.5,-83.63"/>
</g>
</g>
</svg>
