<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_dag_final Pages: 1 -->
<svg width="967pt" height="5000pt"
 viewBox="0.00 0.00 967.01 5000.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4996.21)">
<title>baseline_dag_final</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4996.21 963.01,-4996.21 963.01,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<path fill="none" stroke="black" d="M108,-2634.11C108,-2634.11 866,-2634.11 866,-2634.11 872,-2634.11 878,-2640.11 878,-2646.11 878,-2646.11 878,-4897.26 878,-4897.26 878,-4903.26 872,-4909.26 866,-4909.26 866,-4909.26 108,-4909.26 108,-4909.26 102,-4909.26 96,-4903.26 96,-4897.26 96,-4897.26 96,-2646.11 96,-2646.11 96,-2640.11 102,-2634.11 108,-2634.11"/>
<text text-anchor="middle" x="487" y="-4894.06" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="487" y="-4879.06" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="487" y="-4864.06" font-family="Times,serif" font-size="14.00">Tensor Parallel</text>
<text text-anchor="middle" x="487" y="-4849.06" font-family="Times,serif" font-size="14.00">Layers: 0&#45;1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_mha</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="200,-4320.72 200,-4833.26 870,-4833.26 870,-4320.72 200,-4320.72"/>
<text text-anchor="middle" x="535" y="-4818.06" font-family="Times,serif" font-size="14.00">Layer 0 MHA</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_mlp</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="295,-3761.18 295,-4273.72 643,-4273.72 643,-3761.18 295,-3761.18"/>
<text text-anchor="middle" x="469" y="-4258.52" font-family="Times,serif" font-size="14.00">Layer 0 MLP</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer1_mha</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="115,-3201.65 115,-3714.18 785,-3714.18 785,-3201.65 115,-3201.65"/>
<text text-anchor="middle" x="450" y="-3698.98" font-family="Times,serif" font-size="14.00">Layer 1 MHA</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer1_mlp</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="307,-2642.11 307,-3154.65 655,-3154.65 655,-2642.11 307,-2642.11"/>
<text text-anchor="middle" x="481" y="-3139.45" font-family="Times,serif" font-size="14.00">Layer 1 MLP</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage_1</title>
<path fill="none" stroke="black" d="M20,-144.95C20,-144.95 712,-144.95 712,-144.95 718,-144.95 724,-150.95 724,-156.95 724,-156.95 724,-2408.11 724,-2408.11 724,-2414.11 718,-2420.11 712,-2420.11 712,-2420.11 20,-2420.11 20,-2420.11 14,-2420.11 8,-2414.11 8,-2408.11 8,-2408.11 8,-156.95 8,-156.95 8,-150.95 14,-144.95 20,-144.95"/>
<text text-anchor="middle" x="366" y="-2404.91" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="366" y="-2389.91" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="366" y="-2374.91" font-family="Times,serif" font-size="14.00">Tensor Parallel</text>
<text text-anchor="middle" x="366" y="-2359.91" font-family="Times,serif" font-size="14.00">Layers: 2&#45;3</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer2_mha</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="31,-1831.57 31,-2344.11 701,-2344.11 701,-1831.57 31,-1831.57"/>
<text text-anchor="middle" x="366" y="-2328.91" font-family="Times,serif" font-size="14.00">Layer 2 MHA</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer2_mlp</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="219,-1272.03 219,-1784.57 567,-1784.57 567,-1272.03 219,-1272.03"/>
<text text-anchor="middle" x="393" y="-1769.37" font-family="Times,serif" font-size="14.00">Layer 2 MLP</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer3_mha</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="16,-712.49 16,-1225.03 686,-1225.03 686,-712.49 16,-712.49"/>
<text text-anchor="middle" x="351" y="-1209.83" font-family="Times,serif" font-size="14.00">Layer 3 MHA</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer3_mlp</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="260,-152.95 260,-665.49 608,-665.49 608,-152.95 260,-152.95"/>
<text text-anchor="middle" x="434" y="-650.29" font-family="Times,serif" font-size="14.00">Layer 3 MLP</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="650" cy="-4954.74" rx="309.01" ry="37.45"/>
<text text-anchor="middle" x="650" y="-4966.04" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="650" y="-4951.04" font-family="Times,serif" font-size="14.00">GPU: [0&#45;15]</text>
<text text-anchor="middle" x="650" y="-4936.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=128 seq_len=10000 hidden_dim=4096]</text>
</g>
<!-- layer0_q_proj -->
<g id="node4" class="node">
<title>layer0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="862,-4802.26 668,-4802.26 668,-4719.26 862,-4719.26 862,-4802.26"/>
<text text-anchor="middle" x="765" y="-4787.06" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="765" y="-4772.06" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="765" y="-4757.06" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="765" y="-4742.06" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="765" y="-4727.06" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- input&#45;&gt;layer0_q_proj -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_q_proj</title>
<path fill="none" stroke="black" d="M765,-4919.61C765,-4919.61 765,-4812.37 765,-4812.37"/>
<polygon fill="black" stroke="black" points="768.5,-4812.37 765,-4802.37 761.5,-4812.37 768.5,-4812.37"/>
</g>
<!-- layer0_k_proj -->
<g id="node5" class="node">
<title>layer0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="632,-4802.26 438,-4802.26 438,-4719.26 632,-4719.26 632,-4802.26"/>
<text text-anchor="middle" x="535" y="-4787.06" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="535" y="-4772.06" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="535" y="-4757.06" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="535" y="-4742.06" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="535" y="-4727.06" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- input&#45;&gt;layer0_k_proj -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer0_k_proj</title>
<path fill="none" stroke="black" d="M535,-4919.61C535,-4919.61 535,-4812.37 535,-4812.37"/>
<polygon fill="black" stroke="black" points="538.5,-4812.37 535,-4802.37 531.5,-4812.37 538.5,-4812.37"/>
</g>
<!-- layer0_v_proj -->
<g id="node6" class="node">
<title>layer0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="402,-4802.26 208,-4802.26 208,-4719.26 402,-4719.26 402,-4802.26"/>
<text text-anchor="middle" x="305" y="-4787.06" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="305" y="-4772.06" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="305" y="-4757.06" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="305" y="-4742.06" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="305" y="-4727.06" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- input&#45;&gt;layer0_v_proj -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer0_v_proj</title>
<path fill="none" stroke="black" d="M371.5,-4938.2C371.5,-4938.2 371.5,-4812.56 371.5,-4812.56"/>
<polygon fill="black" stroke="black" points="375,-4812.56 371.5,-4802.56 368,-4812.56 375,-4812.56"/>
</g>
<!-- layer0_residual -->
<g id="node8" class="node">
<title>layer0_residual</title>
<polygon fill="lightcoral" stroke="black" points="739,-4396.49 656,-4464.03 490,-4464.03 407,-4396.49 490,-4328.95 656,-4328.95 739,-4396.49"/>
<text text-anchor="middle" x="573" y="-4422.79" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="573" y="-4407.79" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="573" y="-4392.79" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="573" y="-4377.79" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="573" y="-4362.79" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- input&#45;&gt;layer0_residual -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer0_residual</title>
<path fill="none" stroke="black" d="M422.63,-4929.3C422.63,-4929.3 422.63,-4419.29 422.63,-4419.29"/>
<polygon fill="black" stroke="black" points="426.13,-4419.29 422.63,-4409.29 419.13,-4419.29 426.13,-4419.29"/>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="434" cy="-37.48" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="434" y="-48.78" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="434" y="-33.78" font-family="Times,serif" font-size="14.00">GPU: [15]</text>
<text text-anchor="middle" x="434" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128 seq_len=10000 hidden_dim=4096]</text>
</g>
<!-- filled -->
<g id="node3" class="node">
<title>filled</title>
<ellipse fill="lightblue" stroke="black" cx="138" cy="-4760.76" rx="33.6" ry="18"/>
<text text-anchor="middle" x="138" y="-4757.06" font-family="Times,serif" font-size="14.00">filled</text>
</g>
<!-- layer0_attention -->
<g id="node7" class="node">
<title>layer0_attention</title>
<polygon fill="lightgreen" stroke="black" points="647.5,-4633.26 444.5,-4633.26 444.5,-4550.26 647.5,-4550.26 647.5,-4633.26"/>
<text text-anchor="middle" x="546" y="-4618.06" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="546" y="-4603.06" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="546" y="-4588.06" font-family="Times,serif" font-size="14.00">Collective: AllReduce</text>
<text text-anchor="middle" x="546" y="-4573.06" font-family="Times,serif" font-size="14.00">Input: [128 10000 512]×3</text>
<text text-anchor="middle" x="546" y="-4558.06" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer0_q_proj&#45;&gt;layer0_attention -->
<g id="edge4" class="edge">
<title>layer0_q_proj&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M667.86,-4760C651.53,-4760 639.75,-4760 639.75,-4760 639.75,-4760 639.75,-4643.35 639.75,-4643.35"/>
<polygon fill="black" stroke="black" points="643.25,-4643.35 639.75,-4633.35 636.25,-4643.35 643.25,-4643.35"/>
</g>
<!-- layer0_k_proj&#45;&gt;layer0_attention -->
<g id="edge5" class="edge">
<title>layer0_k_proj&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M538.25,-4718.99C538.25,-4718.99 538.25,-4643.35 538.25,-4643.35"/>
<polygon fill="black" stroke="black" points="541.75,-4643.35 538.25,-4633.35 534.75,-4643.35 541.75,-4643.35"/>
</g>
<!-- layer0_v_proj&#45;&gt;layer0_attention -->
<g id="edge6" class="edge">
<title>layer0_v_proj&#45;&gt;layer0_attention</title>
<path fill="none" stroke="black" d="M378.75,-4719.23C378.75,-4668.98 378.75,-4591 378.75,-4591 378.75,-4591 434.37,-4591 434.37,-4591"/>
<polygon fill="black" stroke="black" points="434.37,-4594.5 444.37,-4591 434.37,-4587.5 434.37,-4594.5"/>
</g>
<!-- layer0_attention&#45;&gt;layer0_residual -->
<g id="edge8" class="edge">
<title>layer0_attention&#45;&gt;layer0_residual</title>
<path fill="none" stroke="black" d="M546,-4549.87C546,-4549.87 546,-4474.04 546,-4474.04"/>
<polygon fill="black" stroke="black" points="549.5,-4474.04 546,-4464.04 542.5,-4474.04 549.5,-4474.04"/>
</g>
<!-- layer0_mlp_fc1 -->
<g id="node9" class="node">
<title>layer0_mlp_fc1</title>
<polygon fill="lightgreen" stroke="black" points="558.5,-4242.72 355.5,-4242.72 355.5,-4159.72 558.5,-4159.72 558.5,-4242.72"/>
<text text-anchor="middle" x="457" y="-4227.52" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="457" y="-4212.52" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="457" y="-4197.52" font-family="Times,serif" font-size="14.00">Weight: [4096 2048]</text>
<text text-anchor="middle" x="457" y="-4182.52" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="457" y="-4167.52" font-family="Times,serif" font-size="14.00">Output: [128 10000 2048]</text>
</g>
<!-- layer0_residual&#45;&gt;layer0_mlp_fc1 -->
<g id="edge9" class="edge">
<title>layer0_residual&#45;&gt;layer0_mlp_fc1</title>
<path fill="none" stroke="black" d="M482.88,-4334.71C482.88,-4334.71 482.88,-4252.87 482.88,-4252.87"/>
<polygon fill="black" stroke="black" points="486.38,-4252.87 482.88,-4242.87 479.38,-4252.87 486.38,-4252.87"/>
</g>
<!-- layer0_mlp_residual -->
<g id="node11" class="node">
<title>layer0_mlp_residual</title>
<polygon fill="lightcoral" stroke="black" points="635,-3836.95 552,-3904.49 386,-3904.49 303,-3836.95 386,-3769.41 552,-3769.41 635,-3836.95"/>
<text text-anchor="middle" x="469" y="-3863.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="469" y="-3848.25" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="469" y="-3833.25" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="469" y="-3818.25" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="469" y="-3803.25" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer0_residual&#45;&gt;layer0_mlp_residual -->
<g id="edge11" class="edge">
<title>layer0_residual&#45;&gt;layer0_mlp_residual</title>
<path fill="none" stroke="black" d="M596.62,-4328.72C596.62,-4328.72 596.62,-3878.3 596.62,-3878.3"/>
<polygon fill="black" stroke="black" points="600.12,-3878.3 596.62,-3868.3 593.12,-3878.3 600.12,-3878.3"/>
</g>
<!-- layer0_mlp_fc2 -->
<g id="node10" class="node">
<title>layer0_mlp_fc2</title>
<polygon fill="lightgreen" stroke="black" points="558.5,-4073.72 355.5,-4073.72 355.5,-3990.72 558.5,-3990.72 558.5,-4073.72"/>
<text text-anchor="middle" x="457" y="-4058.52" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="457" y="-4043.52" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="457" y="-4028.52" font-family="Times,serif" font-size="14.00">Weight: [2048 4096]</text>
<text text-anchor="middle" x="457" y="-4013.52" font-family="Times,serif" font-size="14.00">Input: [128 10000 2048]</text>
<text text-anchor="middle" x="457" y="-3998.52" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer0_mlp_fc1&#45;&gt;layer0_mlp_fc2 -->
<g id="edge10" class="edge">
<title>layer0_mlp_fc1&#45;&gt;layer0_mlp_fc2</title>
<path fill="none" stroke="black" d="M457,-4159.45C457,-4159.45 457,-4083.81 457,-4083.81"/>
<polygon fill="black" stroke="black" points="460.5,-4083.81 457,-4073.81 453.5,-4083.81 460.5,-4083.81"/>
</g>
<!-- layer0_mlp_fc2&#45;&gt;layer0_mlp_residual -->
<g id="edge12" class="edge">
<title>layer0_mlp_fc2&#45;&gt;layer0_mlp_residual</title>
<path fill="none" stroke="black" d="M457,-3990.33C457,-3990.33 457,-3914.5 457,-3914.5"/>
<polygon fill="black" stroke="black" points="460.5,-3914.5 457,-3904.5 453.5,-3914.5 460.5,-3914.5"/>
</g>
<!-- layer1_q_proj -->
<g id="node12" class="node">
<title>layer1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="777,-3683.18 583,-3683.18 583,-3600.18 777,-3600.18 777,-3683.18"/>
<text text-anchor="middle" x="680" y="-3667.98" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="680" y="-3652.98" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="680" y="-3637.98" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="680" y="-3622.98" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="680" y="-3607.98" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_q_proj -->
<g id="edge13" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_q_proj</title>
<path fill="none" stroke="black" d="M608.87,-3815.68C608.87,-3815.68 608.87,-3693.39 608.87,-3693.39"/>
<polygon fill="black" stroke="black" points="612.37,-3693.39 608.87,-3683.39 605.37,-3693.39 612.37,-3693.39"/>
</g>
<!-- layer1_k_proj -->
<g id="node13" class="node">
<title>layer1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="547,-3683.18 353,-3683.18 353,-3600.18 547,-3600.18 547,-3683.18"/>
<text text-anchor="middle" x="450" y="-3667.98" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="450" y="-3652.98" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="450" y="-3637.98" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="450" y="-3622.98" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="450" y="-3607.98" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_k_proj -->
<g id="edge14" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_k_proj</title>
<path fill="none" stroke="black" d="M450,-3769.21C450,-3769.21 450,-3693.43 450,-3693.43"/>
<polygon fill="black" stroke="black" points="453.5,-3693.43 450,-3683.43 446.5,-3693.43 453.5,-3693.43"/>
</g>
<!-- layer1_v_proj -->
<g id="node14" class="node">
<title>layer1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="317,-3683.18 123,-3683.18 123,-3600.18 317,-3600.18 317,-3683.18"/>
<text text-anchor="middle" x="220" y="-3667.98" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="220" y="-3652.98" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="220" y="-3637.98" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="220" y="-3622.98" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="220" y="-3607.98" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_v_proj -->
<g id="edge15" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_v_proj</title>
<path fill="none" stroke="black" d="M310.13,-3830.89C310.13,-3830.89 310.13,-3693.56 310.13,-3693.56"/>
<polygon fill="black" stroke="black" points="313.63,-3693.56 310.13,-3683.56 306.63,-3693.56 313.63,-3693.56"/>
</g>
<!-- layer1_residual -->
<g id="node16" class="node">
<title>layer1_residual</title>
<polygon fill="lightcoral" stroke="black" points="732,-3277.41 649,-3344.95 483,-3344.95 400,-3277.41 483,-3209.88 649,-3209.88 732,-3277.41"/>
<text text-anchor="middle" x="566" y="-3303.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="566" y="-3288.71" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="566" y="-3273.71" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="566" y="-3258.71" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="566" y="-3243.71" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer0_mlp_residual&#45;&gt;layer1_residual -->
<g id="edge19" class="edge">
<title>layer0_mlp_residual&#45;&gt;layer1_residual</title>
<path fill="none" stroke="black" d="M335,-3810.7C335,-3699.99 335,-3277 335,-3277 335,-3277 390.27,-3277 390.27,-3277"/>
<polygon fill="black" stroke="black" points="390.27,-3280.5 400.27,-3277 390.27,-3273.5 390.27,-3280.5"/>
</g>
<!-- layer1_attention -->
<g id="node15" class="node">
<title>layer1_attention</title>
<polygon fill="lightgreen" stroke="black" points="596.5,-3514.18 393.5,-3514.18 393.5,-3431.18 596.5,-3431.18 596.5,-3514.18"/>
<text text-anchor="middle" x="495" y="-3498.98" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="495" y="-3483.98" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="495" y="-3468.98" font-family="Times,serif" font-size="14.00">Collective: AllReduce</text>
<text text-anchor="middle" x="495" y="-3453.98" font-family="Times,serif" font-size="14.00">Input: [128 10000 512]×3</text>
<text text-anchor="middle" x="495" y="-3438.98" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer1_q_proj&#45;&gt;layer1_attention -->
<g id="edge16" class="edge">
<title>layer1_q_proj&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M589.75,-3599.91C589.75,-3599.91 589.75,-3524.27 589.75,-3524.27"/>
<polygon fill="black" stroke="black" points="593.25,-3524.27 589.75,-3514.27 586.25,-3524.27 593.25,-3524.27"/>
</g>
<!-- layer1_k_proj&#45;&gt;layer1_attention -->
<g id="edge17" class="edge">
<title>layer1_k_proj&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M470.25,-3599.91C470.25,-3599.91 470.25,-3524.27 470.25,-3524.27"/>
<polygon fill="black" stroke="black" points="473.75,-3524.27 470.25,-3514.27 466.75,-3524.27 473.75,-3524.27"/>
</g>
<!-- layer1_v_proj&#45;&gt;layer1_attention -->
<g id="edge18" class="edge">
<title>layer1_v_proj&#45;&gt;layer1_attention</title>
<path fill="none" stroke="black" d="M293.93,-3600.17C293.93,-3549.94 293.93,-3472 293.93,-3472 293.93,-3472 383.29,-3472 383.29,-3472"/>
<polygon fill="black" stroke="black" points="383.29,-3475.5 393.29,-3472 383.29,-3468.5 383.29,-3475.5"/>
</g>
<!-- layer1_attention&#45;&gt;layer1_residual -->
<g id="edge20" class="edge">
<title>layer1_attention&#45;&gt;layer1_residual</title>
<path fill="none" stroke="black" d="M498.38,-3430.79C498.38,-3430.79 498.38,-3354.96 498.38,-3354.96"/>
<polygon fill="black" stroke="black" points="501.88,-3354.96 498.38,-3344.96 494.88,-3354.96 501.88,-3354.96"/>
</g>
<!-- layer1_mlp_fc1 -->
<g id="node17" class="node">
<title>layer1_mlp_fc1</title>
<polygon fill="lightgreen" stroke="black" points="564.5,-3123.65 361.5,-3123.65 361.5,-3040.65 564.5,-3040.65 564.5,-3123.65"/>
<text text-anchor="middle" x="463" y="-3108.45" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="463" y="-3093.45" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="463" y="-3078.45" font-family="Times,serif" font-size="14.00">Weight: [4096 2048]</text>
<text text-anchor="middle" x="463" y="-3063.45" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="463" y="-3048.45" font-family="Times,serif" font-size="14.00">Output: [128 10000 2048]</text>
</g>
<!-- layer1_residual&#45;&gt;layer1_mlp_fc1 -->
<g id="edge21" class="edge">
<title>layer1_residual&#45;&gt;layer1_mlp_fc1</title>
<path fill="none" stroke="black" d="M482.38,-3210.21C482.38,-3210.21 482.38,-3133.83 482.38,-3133.83"/>
<polygon fill="black" stroke="black" points="485.88,-3133.83 482.38,-3123.83 478.88,-3133.83 485.88,-3133.83"/>
</g>
<!-- layer1_mlp_residual -->
<g id="node19" class="node">
<title>layer1_mlp_residual</title>
<polygon fill="lightcoral" stroke="black" points="647,-2717.88 564,-2785.42 398,-2785.42 315,-2717.88 398,-2650.34 564,-2650.34 647,-2717.88"/>
<text text-anchor="middle" x="481" y="-2744.18" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="481" y="-2729.18" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="481" y="-2714.18" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="481" y="-2699.18" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="481" y="-2684.18" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer1_residual&#45;&gt;layer1_mlp_residual -->
<g id="edge23" class="edge">
<title>layer1_residual&#45;&gt;layer1_mlp_residual</title>
<path fill="none" stroke="black" d="M605.62,-3209.64C605.62,-3209.64 605.62,-2761.79 605.62,-2761.79"/>
<polygon fill="black" stroke="black" points="609.12,-2761.79 605.62,-2751.79 602.12,-2761.79 609.12,-2761.79"/>
</g>
<!-- layer1_mlp_fc2 -->
<g id="node18" class="node">
<title>layer1_mlp_fc2</title>
<polygon fill="lightgreen" stroke="black" points="564.5,-2954.65 361.5,-2954.65 361.5,-2871.65 564.5,-2871.65 564.5,-2954.65"/>
<text text-anchor="middle" x="463" y="-2939.45" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="463" y="-2924.45" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="463" y="-2909.45" font-family="Times,serif" font-size="14.00">Weight: [2048 4096]</text>
<text text-anchor="middle" x="463" y="-2894.45" font-family="Times,serif" font-size="14.00">Input: [128 10000 2048]</text>
<text text-anchor="middle" x="463" y="-2879.45" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer1_mlp_fc1&#45;&gt;layer1_mlp_fc2 -->
<g id="edge22" class="edge">
<title>layer1_mlp_fc1&#45;&gt;layer1_mlp_fc2</title>
<path fill="none" stroke="black" d="M463,-3040.37C463,-3040.37 463,-2964.73 463,-2964.73"/>
<polygon fill="black" stroke="black" points="466.5,-2964.73 463,-2954.73 459.5,-2964.73 466.5,-2964.73"/>
</g>
<!-- layer1_mlp_fc2&#45;&gt;layer1_mlp_residual -->
<g id="edge24" class="edge">
<title>layer1_mlp_fc2&#45;&gt;layer1_mlp_residual</title>
<path fill="none" stroke="black" d="M463,-2871.26C463,-2871.26 463,-2795.43 463,-2795.43"/>
<polygon fill="black" stroke="black" points="466.5,-2795.43 463,-2785.43 459.5,-2795.43 466.5,-2795.43"/>
</g>
<!-- pipeline_comm -->
<g id="node36" class="node">
<title>pipeline_comm</title>
<polygon fill="yellow" stroke="black" points="689.27,-2564.11 357.96,-2564.11 272.73,-2428.11 604.04,-2428.11 689.27,-2564.11"/>
<text text-anchor="middle" x="481" y="-2514.91" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="481" y="-2499.91" font-family="Times,serif" font-size="14.00">GPU: [7] &#45;&gt; [8]</text>
<text text-anchor="middle" x="481" y="-2484.91" font-family="Times,serif" font-size="14.00">Tensor: [128 10000 4096]</text>
<text text-anchor="middle" x="481" y="-2469.91" font-family="Times,serif" font-size="14.00">Buffer: 524M elements</text>
</g>
<!-- layer1_mlp_residual&#45;&gt;pipeline_comm -->
<g id="edge25" class="edge">
<title>layer1_mlp_residual&#45;&gt;pipeline_comm</title>
<path fill="none" stroke="black" d="M481,-2650.13C481,-2650.13 481,-2574.2 481,-2574.2"/>
<polygon fill="black" stroke="black" points="484.5,-2574.2 481,-2564.2 477.5,-2574.2 484.5,-2574.2"/>
</g>
<!-- layer2_q_proj -->
<g id="node20" class="node">
<title>layer2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="693,-2313.11 499,-2313.11 499,-2230.11 693,-2230.11 693,-2313.11"/>
<text text-anchor="middle" x="596" y="-2297.91" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="596" y="-2282.91" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="596" y="-2267.91" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="596" y="-2252.91" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="596" y="-2237.91" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_attention -->
<g id="node23" class="node">
<title>layer2_attention</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-2144.11 353.5,-2144.11 353.5,-2061.11 556.5,-2061.11 556.5,-2144.11"/>
<text text-anchor="middle" x="455" y="-2128.91" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="455" y="-2113.91" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="455" y="-2098.91" font-family="Times,serif" font-size="14.00">Collective: AllReduce</text>
<text text-anchor="middle" x="455" y="-2083.91" font-family="Times,serif" font-size="14.00">Input: [128 10000 512]×3</text>
<text text-anchor="middle" x="455" y="-2068.91" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer2_q_proj&#45;&gt;layer2_attention -->
<g id="edge29" class="edge">
<title>layer2_q_proj&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M527.75,-2229.83C527.75,-2229.83 527.75,-2154.19 527.75,-2154.19"/>
<polygon fill="black" stroke="black" points="531.25,-2154.19 527.75,-2144.19 524.25,-2154.19 531.25,-2154.19"/>
</g>
<!-- layer2_k_proj -->
<g id="node21" class="node">
<title>layer2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="463,-2313.11 269,-2313.11 269,-2230.11 463,-2230.11 463,-2313.11"/>
<text text-anchor="middle" x="366" y="-2297.91" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="366" y="-2282.91" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="366" y="-2267.91" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="366" y="-2252.91" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="366" y="-2237.91" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_k_proj&#45;&gt;layer2_attention -->
<g id="edge30" class="edge">
<title>layer2_k_proj&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M408.25,-2229.83C408.25,-2229.83 408.25,-2154.19 408.25,-2154.19"/>
<polygon fill="black" stroke="black" points="411.75,-2154.19 408.25,-2144.19 404.75,-2154.19 411.75,-2154.19"/>
</g>
<!-- layer2_v_proj -->
<g id="node22" class="node">
<title>layer2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="233,-2313.11 39,-2313.11 39,-2230.11 233,-2230.11 233,-2313.11"/>
<text text-anchor="middle" x="136" y="-2297.91" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="136" y="-2282.91" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="136" y="-2267.91" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="136" y="-2252.91" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="136" y="-2237.91" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_v_proj&#45;&gt;layer2_attention -->
<g id="edge31" class="edge">
<title>layer2_v_proj&#45;&gt;layer2_attention</title>
<path fill="none" stroke="black" d="M222.63,-2229.68C222.63,-2179.46 222.63,-2102 222.63,-2102 222.63,-2102 343.42,-2102 343.42,-2102"/>
<polygon fill="black" stroke="black" points="343.42,-2105.5 353.42,-2102 343.42,-2098.5 343.42,-2105.5"/>
</g>
<!-- layer2_residual -->
<g id="node24" class="node">
<title>layer2_residual</title>
<polygon fill="lightcoral" stroke="black" points="650,-1907.34 567,-1974.88 401,-1974.88 318,-1907.34 401,-1839.8 567,-1839.8 650,-1907.34"/>
<text text-anchor="middle" x="484" y="-1933.64" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="484" y="-1918.64" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="484" y="-1903.64" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="484" y="-1888.64" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="484" y="-1873.64" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer2_attention&#45;&gt;layer2_residual -->
<g id="edge33" class="edge">
<title>layer2_attention&#45;&gt;layer2_residual</title>
<path fill="none" stroke="black" d="M455,-2060.72C455,-2060.72 455,-1984.89 455,-1984.89"/>
<polygon fill="black" stroke="black" points="458.5,-1984.89 455,-1974.89 451.5,-1984.89 458.5,-1984.89"/>
</g>
<!-- layer2_mlp_fc1 -->
<g id="node25" class="node">
<title>layer2_mlp_fc1</title>
<polygon fill="lightgreen" stroke="black" points="461.5,-1753.57 258.5,-1753.57 258.5,-1670.57 461.5,-1670.57 461.5,-1753.57"/>
<text text-anchor="middle" x="360" y="-1738.37" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="360" y="-1723.37" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="360" y="-1708.37" font-family="Times,serif" font-size="14.00">Weight: [4096 2048]</text>
<text text-anchor="middle" x="360" y="-1693.37" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="360" y="-1678.37" font-family="Times,serif" font-size="14.00">Output: [128 10000 2048]</text>
</g>
<!-- layer2_residual&#45;&gt;layer2_mlp_fc1 -->
<g id="edge34" class="edge">
<title>layer2_residual&#45;&gt;layer2_mlp_fc1</title>
<path fill="none" stroke="black" d="M389.88,-1848.75C389.88,-1848.75 389.88,-1763.87 389.88,-1763.87"/>
<polygon fill="black" stroke="black" points="393.38,-1763.87 389.88,-1753.87 386.38,-1763.87 393.38,-1763.87"/>
</g>
<!-- layer2_mlp_residual -->
<g id="node27" class="node">
<title>layer2_mlp_residual</title>
<polygon fill="lightcoral" stroke="black" points="559,-1347.8 476,-1415.34 310,-1415.34 227,-1347.8 310,-1280.26 476,-1280.26 559,-1347.8"/>
<text text-anchor="middle" x="393" y="-1374.1" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="393" y="-1359.1" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="393" y="-1344.1" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="393" y="-1329.1" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="393" y="-1314.1" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer2_residual&#45;&gt;layer2_mlp_residual -->
<g id="edge36" class="edge">
<title>layer2_residual&#45;&gt;layer2_mlp_residual</title>
<path fill="none" stroke="black" d="M510.12,-1839.57C510.12,-1839.57 510.12,-1397.82 510.12,-1397.82"/>
<polygon fill="black" stroke="black" points="513.62,-1397.82 510.12,-1387.82 506.62,-1397.82 513.62,-1397.82"/>
</g>
<!-- layer2_mlp_fc2 -->
<g id="node26" class="node">
<title>layer2_mlp_fc2</title>
<polygon fill="lightgreen" stroke="black" points="461.5,-1584.57 258.5,-1584.57 258.5,-1501.57 461.5,-1501.57 461.5,-1584.57"/>
<text text-anchor="middle" x="360" y="-1569.37" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="360" y="-1554.37" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="360" y="-1539.37" font-family="Times,serif" font-size="14.00">Weight: [2048 4096]</text>
<text text-anchor="middle" x="360" y="-1524.37" font-family="Times,serif" font-size="14.00">Input: [128 10000 2048]</text>
<text text-anchor="middle" x="360" y="-1509.37" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer2_mlp_fc1&#45;&gt;layer2_mlp_fc2 -->
<g id="edge35" class="edge">
<title>layer2_mlp_fc1&#45;&gt;layer2_mlp_fc2</title>
<path fill="none" stroke="black" d="M360,-1670.29C360,-1670.29 360,-1594.66 360,-1594.66"/>
<polygon fill="black" stroke="black" points="363.5,-1594.66 360,-1584.66 356.5,-1594.66 363.5,-1594.66"/>
</g>
<!-- layer2_mlp_fc2&#45;&gt;layer2_mlp_residual -->
<g id="edge37" class="edge">
<title>layer2_mlp_fc2&#45;&gt;layer2_mlp_residual</title>
<path fill="none" stroke="black" d="M360,-1501.18C360,-1501.18 360,-1425.35 360,-1425.35"/>
<polygon fill="black" stroke="black" points="363.5,-1425.35 360,-1415.35 356.5,-1425.35 363.5,-1425.35"/>
</g>
<!-- layer3_q_proj -->
<g id="node28" class="node">
<title>layer3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="678,-1194.03 484,-1194.03 484,-1111.03 678,-1111.03 678,-1194.03"/>
<text text-anchor="middle" x="581" y="-1178.83" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="581" y="-1163.83" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="581" y="-1148.83" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="581" y="-1133.83" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="581" y="-1118.83" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_q_proj -->
<g id="edge38" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_q_proj</title>
<path fill="none" stroke="black" d="M521.37,-1316.86C521.37,-1316.86 521.37,-1204.23 521.37,-1204.23"/>
<polygon fill="black" stroke="black" points="524.87,-1204.23 521.37,-1194.23 517.87,-1204.23 524.87,-1204.23"/>
</g>
<!-- layer3_k_proj -->
<g id="node29" class="node">
<title>layer3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="448,-1194.03 254,-1194.03 254,-1111.03 448,-1111.03 448,-1194.03"/>
<text text-anchor="middle" x="351" y="-1178.83" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="351" y="-1163.83" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="351" y="-1148.83" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="351" y="-1133.83" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="351" y="-1118.83" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_k_proj -->
<g id="edge39" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_k_proj</title>
<path fill="none" stroke="black" d="M351,-1280.05C351,-1280.05 351,-1204.27 351,-1204.27"/>
<polygon fill="black" stroke="black" points="354.5,-1204.27 351,-1194.27 347.5,-1204.27 354.5,-1204.27"/>
</g>
<!-- layer3_v_proj -->
<g id="node30" class="node">
<title>layer3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="218,-1194.03 24,-1194.03 24,-1111.03 218,-1111.03 218,-1194.03"/>
<text text-anchor="middle" x="121" y="-1178.83" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="121" y="-1163.83" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="121" y="-1148.83" font-family="Times,serif" font-size="14.00">Weight: [4096 512]</text>
<text text-anchor="middle" x="121" y="-1133.83" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="121" y="-1118.83" font-family="Times,serif" font-size="14.00">Output: [128 10000 512]</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_v_proj -->
<g id="edge40" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_v_proj</title>
<path fill="none" stroke="black" d="M236.17,-1339.88C236.17,-1303.25 236.17,-1152 236.17,-1152 236.17,-1152 228.17,-1152 228.17,-1152"/>
<polygon fill="black" stroke="black" points="228.17,-1148.5 218.17,-1152 228.17,-1155.5 228.17,-1148.5"/>
</g>
<!-- layer3_residual -->
<g id="node32" class="node">
<title>layer3_residual</title>
<polygon fill="lightcoral" stroke="black" points="637,-788.26 554,-855.8 388,-855.8 305,-788.26 388,-720.72 554,-720.72 637,-788.26"/>
<text text-anchor="middle" x="471" y="-814.56" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="471" y="-799.56" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="471" y="-784.56" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="471" y="-769.56" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="471" y="-754.56" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer2_mlp_residual&#45;&gt;layer3_residual -->
<g id="edge44" class="edge">
<title>layer2_mlp_residual&#45;&gt;layer3_residual</title>
<path fill="none" stroke="black" d="M245.08,-1332.83C245.08,-1243.8 245.08,-788 245.08,-788 245.08,-788 295.03,-788 295.03,-788"/>
<polygon fill="black" stroke="black" points="295.03,-791.5 305.03,-788 295.03,-784.5 295.03,-791.5"/>
</g>
<!-- layer3_attention -->
<g id="node31" class="node">
<title>layer3_attention</title>
<polygon fill="lightgreen" stroke="black" points="492.5,-1025.03 289.5,-1025.03 289.5,-942.03 492.5,-942.03 492.5,-1025.03"/>
<text text-anchor="middle" x="391" y="-1009.83" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="391" y="-994.83" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="391" y="-979.83" font-family="Times,serif" font-size="14.00">Collective: AllReduce</text>
<text text-anchor="middle" x="391" y="-964.83" font-family="Times,serif" font-size="14.00">Input: [128 10000 512]×3</text>
<text text-anchor="middle" x="391" y="-949.83" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer3_q_proj&#45;&gt;layer3_attention -->
<g id="edge41" class="edge">
<title>layer3_q_proj&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M488.25,-1110.75C488.25,-1110.75 488.25,-1035.12 488.25,-1035.12"/>
<polygon fill="black" stroke="black" points="491.75,-1035.12 488.25,-1025.12 484.75,-1035.12 491.75,-1035.12"/>
</g>
<!-- layer3_k_proj&#45;&gt;layer3_attention -->
<g id="edge42" class="edge">
<title>layer3_k_proj&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M368.75,-1110.75C368.75,-1110.75 368.75,-1035.12 368.75,-1035.12"/>
<polygon fill="black" stroke="black" points="372.25,-1035.12 368.75,-1025.12 365.25,-1035.12 372.25,-1035.12"/>
</g>
<!-- layer3_v_proj&#45;&gt;layer3_attention -->
<g id="edge43" class="edge">
<title>layer3_v_proj&#45;&gt;layer3_attention</title>
<path fill="none" stroke="black" d="M167.25,-1110.62C167.25,-1060.42 167.25,-983 167.25,-983 167.25,-983 279.28,-983 279.28,-983"/>
<polygon fill="black" stroke="black" points="279.28,-986.5 289.28,-983 279.28,-979.5 279.28,-986.5"/>
</g>
<!-- layer3_attention&#45;&gt;layer3_residual -->
<g id="edge45" class="edge">
<title>layer3_attention&#45;&gt;layer3_residual</title>
<path fill="none" stroke="black" d="M398.88,-941.64C398.88,-941.64 398.88,-865.81 398.88,-865.81"/>
<polygon fill="black" stroke="black" points="402.38,-865.81 398.88,-855.81 395.38,-865.81 402.38,-865.81"/>
</g>
<!-- layer3_mlp_fc1 -->
<g id="node33" class="node">
<title>layer3_mlp_fc1</title>
<polygon fill="lightgreen" stroke="black" points="502.5,-634.49 299.5,-634.49 299.5,-551.49 502.5,-551.49 502.5,-634.49"/>
<text text-anchor="middle" x="401" y="-619.29" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="401" y="-604.29" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="401" y="-589.29" font-family="Times,serif" font-size="14.00">Weight: [4096 2048]</text>
<text text-anchor="middle" x="401" y="-574.29" font-family="Times,serif" font-size="14.00">Input: [128 10000 4096]</text>
<text text-anchor="middle" x="401" y="-559.29" font-family="Times,serif" font-size="14.00">Output: [128 10000 2048]</text>
</g>
<!-- layer3_residual&#45;&gt;layer3_mlp_fc1 -->
<g id="edge46" class="edge">
<title>layer3_residual&#45;&gt;layer3_mlp_fc1</title>
<path fill="none" stroke="black" d="M403.88,-720.51C403.88,-720.51 403.88,-644.73 403.88,-644.73"/>
<polygon fill="black" stroke="black" points="407.38,-644.73 403.88,-634.73 400.38,-644.73 407.38,-644.73"/>
</g>
<!-- layer3_mlp_residual -->
<g id="node35" class="node">
<title>layer3_mlp_residual</title>
<polygon fill="lightcoral" stroke="black" points="600,-228.72 517,-296.26 351,-296.26 268,-228.72 351,-161.18 517,-161.18 600,-228.72"/>
<text text-anchor="middle" x="434" y="-255.02" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="434" y="-240.02" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="434" y="-225.02" font-family="Times,serif" font-size="14.00">Input1: [128 10000 4096]</text>
<text text-anchor="middle" x="434" y="-210.02" font-family="Times,serif" font-size="14.00">Input2: [128 10000 4096]</text>
<text text-anchor="middle" x="434" y="-195.02" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer3_residual&#45;&gt;layer3_mlp_residual -->
<g id="edge48" class="edge">
<title>layer3_residual&#45;&gt;layer3_mlp_residual</title>
<path fill="none" stroke="black" d="M551.12,-720.49C551.12,-720.49 551.12,-278.74 551.12,-278.74"/>
<polygon fill="black" stroke="black" points="554.62,-278.74 551.12,-268.74 547.62,-278.74 554.62,-278.74"/>
</g>
<!-- layer3_mlp_fc2 -->
<g id="node34" class="node">
<title>layer3_mlp_fc2</title>
<polygon fill="lightgreen" stroke="black" points="502.5,-465.49 299.5,-465.49 299.5,-382.49 502.5,-382.49 502.5,-465.49"/>
<text text-anchor="middle" x="401" y="-450.29" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="401" y="-435.29" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="401" y="-420.29" font-family="Times,serif" font-size="14.00">Weight: [2048 4096]</text>
<text text-anchor="middle" x="401" y="-405.29" font-family="Times,serif" font-size="14.00">Input: [128 10000 2048]</text>
<text text-anchor="middle" x="401" y="-390.29" font-family="Times,serif" font-size="14.00">Output: [128 10000 4096]</text>
</g>
<!-- layer3_mlp_fc1&#45;&gt;layer3_mlp_fc2 -->
<g id="edge47" class="edge">
<title>layer3_mlp_fc1&#45;&gt;layer3_mlp_fc2</title>
<path fill="none" stroke="black" d="M401,-551.22C401,-551.22 401,-475.58 401,-475.58"/>
<polygon fill="black" stroke="black" points="404.5,-475.58 401,-465.58 397.5,-475.58 404.5,-475.58"/>
</g>
<!-- layer3_mlp_fc2&#45;&gt;layer3_mlp_residual -->
<g id="edge49" class="edge">
<title>layer3_mlp_fc2&#45;&gt;layer3_mlp_residual</title>
<path fill="none" stroke="black" d="M401,-382.1C401,-382.1 401,-306.27 401,-306.27"/>
<polygon fill="black" stroke="black" points="404.5,-306.27 401,-296.27 397.5,-306.27 404.5,-306.27"/>
</g>
<!-- layer3_mlp_residual&#45;&gt;output -->
<g id="edge50" class="edge">
<title>layer3_mlp_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M434,-161.03C434,-161.03 434,-85.02 434,-85.02"/>
<polygon fill="black" stroke="black" points="437.5,-85.02 434,-75.02 430.5,-85.02 437.5,-85.02"/>
</g>
<!-- pipeline_comm&#45;&gt;layer2_q_proj -->
<g id="edge26" class="edge">
<title>pipeline_comm&#45;&gt;layer2_q_proj</title>
<path fill="none" stroke="black" d="M594.19,-2427.84C594.19,-2427.84 594.19,-2323.15 594.19,-2323.15"/>
<polygon fill="black" stroke="black" points="597.69,-2323.15 594.19,-2313.15 590.69,-2323.15 597.69,-2323.15"/>
</g>
<!-- pipeline_comm&#45;&gt;layer2_k_proj -->
<g id="edge27" class="edge">
<title>pipeline_comm&#45;&gt;layer2_k_proj</title>
<path fill="none" stroke="black" d="M367.81,-2427.84C367.81,-2427.84 367.81,-2323.15 367.81,-2323.15"/>
<polygon fill="black" stroke="black" points="371.31,-2323.15 367.81,-2313.15 364.31,-2323.15 371.31,-2323.15"/>
</g>
<!-- pipeline_comm&#45;&gt;layer2_v_proj -->
<g id="edge28" class="edge">
<title>pipeline_comm&#45;&gt;layer2_v_proj</title>
<path fill="none" stroke="black" d="M314.87,-2496C244.3,-2496 178,-2496 178,-2496 178,-2496 178,-2323.29 178,-2323.29"/>
<polygon fill="black" stroke="black" points="181.5,-2323.29 178,-2313.29 174.5,-2323.29 181.5,-2323.29"/>
</g>
<!-- pipeline_comm&#45;&gt;layer2_residual -->
<g id="edge32" class="edge">
<title>pipeline_comm&#45;&gt;layer2_residual</title>
<path fill="none" stroke="black" d="M481,-2427.89C481,-2336.86 481,-2187 481,-2187 481,-2187 603.12,-2187 603.12,-2187 603.12,-2187 603.12,-1955.64 603.12,-1955.64"/>
<polygon fill="black" stroke="black" points="606.62,-1955.64 603.12,-1945.64 599.62,-1955.64 606.62,-1955.64"/>
</g>
</g>
</svg>
