<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: layer_1_ma Pages: 1 -->
<svg width="8945pt" height="1699pt"
 viewBox="0.00 0.00 8944.50 1699.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1695)">
<title>layer_1_ma</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1695 8940.5,-1695 8940.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attn_group_1</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="3288,-716 3288,-1589 8674,-1589 8674,-716 3288,-716"/>
<text text-anchor="middle" x="5981" y="-1573.8" font-family="Times,serif" font-size="14.00">Attention Group (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_moe_group_1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-8 8,-503 6202,-503 6202,-8 8,-8"/>
<text text-anchor="middle" x="3105" y="-487.8" font-family="Times,serif" font-size="14.00">MoE Group (GPUs 8&#45;15)</text>
</g>
<!-- l1_q_gpu0 -->
<g id="node1" class="node">
<title>l1_q_gpu0</title>
<polygon fill="yellow" stroke="black" points="3490,-1398 3296,-1398 3296,-1330 3490,-1330 3490,-1398"/>
<text text-anchor="middle" x="3393" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU0</text>
<text text-anchor="middle" x="3393" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3393" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="3393" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_attn_gpu0 -->
<g id="node2" class="node">
<title>l1_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3991.5,-1238 3468.5,-1238 3468.5,-1170 3991.5,-1170 3991.5,-1238"/>
<text text-anchor="middle" x="3730" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU0</text>
<text text-anchor="middle" x="3730" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="3730" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="3730" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_q_gpu0&#45;&gt;l1_attn_gpu0 -->
<g id="edge1" class="edge">
<title>l1_q_gpu0&#45;&gt;l1_attn_gpu0</title>
<path fill="none" stroke="black" d="M3479.25,-1329.68C3479.25,-1329.68 3479.25,-1248.27 3479.25,-1248.27"/>
<polygon fill="black" stroke="black" points="3482.75,-1248.27 3479.25,-1238.27 3475.75,-1248.27 3482.75,-1248.27"/>
</g>
<!-- l1_proj_gpu0 -->
<g id="node6" class="node">
<title>l1_proj_gpu0</title>
<polygon fill="yellow" stroke="black" points="3938.5,-1112 3735.5,-1112 3735.5,-1044 3938.5,-1044 3938.5,-1112"/>
<text text-anchor="middle" x="3837" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU0</text>
<text text-anchor="middle" x="3837" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="3837" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3837" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_attn_gpu0&#45;&gt;l1_proj_gpu0 -->
<g id="edge5" class="edge">
<title>l1_attn_gpu0&#45;&gt;l1_proj_gpu0</title>
<path fill="none" stroke="black" d="M3837,-1169.9C3837,-1169.9 3837,-1122.12 3837,-1122.12"/>
<polygon fill="black" stroke="black" points="3840.5,-1122.12 3837,-1112.12 3833.5,-1122.12 3840.5,-1122.12"/>
</g>
<!-- l1_k_gpu0 -->
<g id="node3" class="node">
<title>l1_k_gpu0</title>
<polygon fill="yellow" stroke="black" points="3833,-1558 3639,-1558 3639,-1490 3833,-1490 3833,-1558"/>
<text text-anchor="middle" x="3736" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU0</text>
<text text-anchor="middle" x="3736" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3736" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="3736" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_kv_gather_gpu0 -->
<g id="node4" class="node">
<title>l1_kv_gather_gpu0</title>
<polygon fill="lightcyan" stroke="black" points="3948.47,-1432 3600.93,-1432 3511.53,-1296 3859.07,-1296 3948.47,-1432"/>
<text text-anchor="middle" x="3730" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="3730" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="3730" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="3730" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_k_gpu0&#45;&gt;l1_kv_gather_gpu0 -->
<g id="edge2" class="edge">
<title>l1_k_gpu0&#45;&gt;l1_kv_gather_gpu0</title>
<path fill="none" stroke="black" d="M3736,-1489.68C3736,-1489.68 3736,-1442.17 3736,-1442.17"/>
<polygon fill="black" stroke="black" points="3739.5,-1442.17 3736,-1432.17 3732.5,-1442.17 3739.5,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu0&#45;&gt;l1_attn_gpu0 -->
<g id="edge4" class="edge">
<title>l1_kv_gather_gpu0&#45;&gt;l1_attn_gpu0</title>
<path fill="none" stroke="black" d="M3730,-1295.68C3730,-1295.68 3730,-1248.16 3730,-1248.16"/>
<polygon fill="black" stroke="black" points="3733.5,-1248.16 3730,-1238.16 3726.5,-1248.16 3733.5,-1248.16"/>
</g>
<!-- l1_v_gpu0 -->
<g id="node5" class="node">
<title>l1_v_gpu0</title>
<polygon fill="yellow" stroke="black" points="4062,-1558 3868,-1558 3868,-1490 4062,-1490 4062,-1558"/>
<text text-anchor="middle" x="3965" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU0</text>
<text text-anchor="middle" x="3965" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3965" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="3965" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_v_gpu0&#45;&gt;l1_kv_gather_gpu0 -->
<g id="edge3" class="edge">
<title>l1_v_gpu0&#45;&gt;l1_kv_gather_gpu0</title>
<path fill="none" stroke="black" d="M3908.12,-1489.68C3908.12,-1489.68 3908.12,-1442.17 3908.12,-1442.17"/>
<polygon fill="black" stroke="black" points="3911.62,-1442.17 3908.12,-1432.17 3904.62,-1442.17 3911.62,-1442.17"/>
</g>
<!-- l1_attn_allreduce -->
<g id="node7" class="node">
<title>l1_attn_allreduce</title>
<polygon fill="lightcyan" stroke="black" points="6568.17,-986 6205.2,-986 6111.83,-850 6474.8,-850 6568.17,-986"/>
<text text-anchor="middle" x="6340" y="-936.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="6340" y="-921.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="6340" y="-906.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6340" y="-891.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_proj_gpu0&#45;&gt;l1_attn_allreduce -->
<g id="edge6" class="edge">
<title>l1_proj_gpu0&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3923,-1043.76C3923,-988.07 3923,-884 3923,-884 3923,-884 6124.97,-884 6124.97,-884"/>
<polygon fill="black" stroke="black" points="6124.97,-887.5 6134.97,-884 6124.97,-880.5 6124.97,-887.5"/>
</g>
<!-- l1_attn_res -->
<g id="node50" class="node">
<title>l1_attn_res</title>
<polygon fill="orange" stroke="black" points="7585,-792 7257,-792 7257,-724 7585,-724 7585,-792"/>
<text text-anchor="middle" x="7421" y="-776.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7421" y="-761.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="7421" y="-746.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7421" y="-731.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_attn_allreduce&#45;&gt;l1_attn_res -->
<g id="edge49" class="edge">
<title>l1_attn_allreduce&#45;&gt;l1_attn_res</title>
<path fill="none" stroke="black" d="M6560.9,-917.88C6560.9,-912.67 6560.9,-746 6560.9,-746 6560.9,-746 7246.94,-746 7246.94,-746"/>
<polygon fill="black" stroke="black" points="7246.94,-749.5 7256.94,-746 7246.94,-742.5 7246.94,-749.5"/>
</g>
<!-- l1_q_gpu1 -->
<g id="node8" class="node">
<title>l1_q_gpu1</title>
<polygon fill="yellow" stroke="black" points="7370,-1398 7176,-1398 7176,-1330 7370,-1330 7370,-1398"/>
<text text-anchor="middle" x="7273" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU1</text>
<text text-anchor="middle" x="7273" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7273" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="7273" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_attn_gpu1 -->
<g id="node9" class="node">
<title>l1_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4966.5,-1238 4443.5,-1238 4443.5,-1170 4966.5,-1170 4966.5,-1238"/>
<text text-anchor="middle" x="4705" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU1</text>
<text text-anchor="middle" x="4705" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="4705" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="4705" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_q_gpu1&#45;&gt;l1_attn_gpu1 -->
<g id="edge7" class="edge">
<title>l1_q_gpu1&#45;&gt;l1_attn_gpu1</title>
<path fill="none" stroke="black" d="M7273,-1329.6C7273,-1310.28 7273,-1290 7273,-1290 7273,-1290 4926.13,-1290 4926.13,-1290 4926.13,-1290 4926.13,-1248.48 4926.13,-1248.48"/>
<polygon fill="black" stroke="black" points="4929.63,-1248.48 4926.13,-1238.48 4922.63,-1248.48 4929.63,-1248.48"/>
</g>
<!-- l1_proj_gpu1 -->
<g id="node13" class="node">
<title>l1_proj_gpu1</title>
<polygon fill="yellow" stroke="black" points="5018.5,-1112 4815.5,-1112 4815.5,-1044 5018.5,-1044 5018.5,-1112"/>
<text text-anchor="middle" x="4917" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU1</text>
<text text-anchor="middle" x="4917" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="4917" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4917" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_attn_gpu1&#45;&gt;l1_proj_gpu1 -->
<g id="edge11" class="edge">
<title>l1_attn_gpu1&#45;&gt;l1_proj_gpu1</title>
<path fill="none" stroke="black" d="M4891,-1169.9C4891,-1169.9 4891,-1122.12 4891,-1122.12"/>
<polygon fill="black" stroke="black" points="4894.5,-1122.12 4891,-1112.12 4887.5,-1122.12 4894.5,-1122.12"/>
</g>
<!-- l1_k_gpu1 -->
<g id="node10" class="node">
<title>l1_k_gpu1</title>
<polygon fill="yellow" stroke="black" points="4520,-1558 4326,-1558 4326,-1490 4520,-1490 4520,-1558"/>
<text text-anchor="middle" x="4423" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU1</text>
<text text-anchor="middle" x="4423" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4423" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="4423" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_kv_gather_gpu1 -->
<g id="node11" class="node">
<title>l1_kv_gather_gpu1</title>
<polygon fill="lightcyan" stroke="black" points="4406.47,-1432 4058.93,-1432 3969.53,-1296 4317.07,-1296 4406.47,-1432"/>
<text text-anchor="middle" x="4188" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="4188" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="4188" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="4188" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_k_gpu1&#45;&gt;l1_kv_gather_gpu1 -->
<g id="edge8" class="edge">
<title>l1_k_gpu1&#45;&gt;l1_kv_gather_gpu1</title>
<path fill="none" stroke="black" d="M4366.12,-1489.68C4366.12,-1489.68 4366.12,-1442.17 4366.12,-1442.17"/>
<polygon fill="black" stroke="black" points="4369.62,-1442.17 4366.12,-1432.17 4362.62,-1442.17 4369.62,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu1&#45;&gt;l1_attn_gpu1 -->
<g id="edge10" class="edge">
<title>l1_kv_gather_gpu1&#45;&gt;l1_attn_gpu1</title>
<path fill="none" stroke="black" d="M4399.12,-1363.88C4399.12,-1359.04 4399.12,-1204 4399.12,-1204 4399.12,-1204 4433.27,-1204 4433.27,-1204"/>
<polygon fill="black" stroke="black" points="4433.27,-1207.5 4443.27,-1204 4433.27,-1200.5 4433.27,-1207.5"/>
</g>
<!-- l1_v_gpu1 -->
<g id="node12" class="node">
<title>l1_v_gpu1</title>
<polygon fill="yellow" stroke="black" points="4291,-1558 4097,-1558 4097,-1490 4291,-1490 4291,-1558"/>
<text text-anchor="middle" x="4194" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU1</text>
<text text-anchor="middle" x="4194" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4194" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="4194" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_v_gpu1&#45;&gt;l1_kv_gather_gpu1 -->
<g id="edge9" class="edge">
<title>l1_v_gpu1&#45;&gt;l1_kv_gather_gpu1</title>
<path fill="none" stroke="black" d="M4194,-1489.68C4194,-1489.68 4194,-1442.17 4194,-1442.17"/>
<polygon fill="black" stroke="black" points="4197.5,-1442.17 4194,-1432.17 4190.5,-1442.17 4197.5,-1442.17"/>
</g>
<!-- l1_proj_gpu1&#45;&gt;l1_attn_allreduce -->
<g id="edge12" class="edge">
<title>l1_proj_gpu1&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4939,-1043.68C4939,-996.66 4939,-918 4939,-918 4939,-918 6148.28,-918 6148.28,-918"/>
<polygon fill="black" stroke="black" points="6148.28,-921.5 6158.28,-918 6148.28,-914.5 6148.28,-921.5"/>
</g>
<!-- l1_q_gpu2 -->
<g id="node14" class="node">
<title>l1_q_gpu2</title>
<polygon fill="yellow" stroke="black" points="8450,-1398 8256,-1398 8256,-1330 8450,-1330 8450,-1398"/>
<text text-anchor="middle" x="8353" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU2</text>
<text text-anchor="middle" x="8353" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8353" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="8353" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_attn_gpu2 -->
<g id="node15" class="node">
<title>l1_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="7691.5,-1238 7168.5,-1238 7168.5,-1170 7691.5,-1170 7691.5,-1238"/>
<text text-anchor="middle" x="7430" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU2</text>
<text text-anchor="middle" x="7430" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="7430" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7430" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_q_gpu2&#45;&gt;l1_attn_gpu2 -->
<g id="edge13" class="edge">
<title>l1_q_gpu2&#45;&gt;l1_attn_gpu2</title>
<path fill="none" stroke="black" d="M8265.25,-1329.86C8265.25,-1317.72 8265.25,-1307 8265.25,-1307 8265.25,-1307 7663.67,-1307 7663.67,-1307 7663.67,-1307 7663.67,-1248.01 7663.67,-1248.01"/>
<polygon fill="black" stroke="black" points="7667.17,-1248.01 7663.67,-1238.01 7660.17,-1248.01 7667.17,-1248.01"/>
</g>
<!-- l1_proj_gpu2 -->
<g id="node19" class="node">
<title>l1_proj_gpu2</title>
<polygon fill="yellow" stroke="black" points="7371.5,-1112 7168.5,-1112 7168.5,-1044 7371.5,-1044 7371.5,-1112"/>
<text text-anchor="middle" x="7270" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU2</text>
<text text-anchor="middle" x="7270" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7270" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7270" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_attn_gpu2&#45;&gt;l1_proj_gpu2 -->
<g id="edge17" class="edge">
<title>l1_attn_gpu2&#45;&gt;l1_proj_gpu2</title>
<path fill="none" stroke="black" d="M7270,-1169.9C7270,-1169.9 7270,-1122.12 7270,-1122.12"/>
<polygon fill="black" stroke="black" points="7273.5,-1122.12 7270,-1112.12 7266.5,-1122.12 7273.5,-1122.12"/>
</g>
<!-- l1_k_gpu2 -->
<g id="node16" class="node">
<title>l1_k_gpu2</title>
<polygon fill="yellow" stroke="black" points="6713,-1558 6519,-1558 6519,-1490 6713,-1490 6713,-1558"/>
<text text-anchor="middle" x="6616" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU2</text>
<text text-anchor="middle" x="6616" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6616" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="6616" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_kv_gather_gpu2 -->
<g id="node17" class="node">
<title>l1_kv_gather_gpu2</title>
<polygon fill="lightcyan" stroke="black" points="6696.47,-1432 6348.93,-1432 6259.53,-1296 6607.07,-1296 6696.47,-1432"/>
<text text-anchor="middle" x="6478" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="6478" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="6478" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="6478" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_k_gpu2&#45;&gt;l1_kv_gather_gpu2 -->
<g id="edge14" class="edge">
<title>l1_k_gpu2&#45;&gt;l1_kv_gather_gpu2</title>
<path fill="none" stroke="black" d="M6607.62,-1489.68C6607.62,-1489.68 6607.62,-1442.17 6607.62,-1442.17"/>
<polygon fill="black" stroke="black" points="6611.12,-1442.17 6607.62,-1432.17 6604.12,-1442.17 6611.12,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu2&#45;&gt;l1_attn_gpu2 -->
<g id="edge16" class="edge">
<title>l1_kv_gather_gpu2&#45;&gt;l1_attn_gpu2</title>
<path fill="none" stroke="black" d="M6671.99,-1363.93C6671.99,-1360.9 6671.99,-1264 6671.99,-1264 6671.99,-1264 7172.25,-1264 7172.25,-1264 7172.25,-1264 7172.25,-1248.21 7172.25,-1248.21"/>
<polygon fill="black" stroke="black" points="7175.75,-1248.21 7172.25,-1238.21 7168.75,-1248.21 7175.75,-1248.21"/>
</g>
<!-- l1_v_gpu2 -->
<g id="node18" class="node">
<title>l1_v_gpu2</title>
<polygon fill="yellow" stroke="black" points="6497,-1558 6303,-1558 6303,-1490 6497,-1490 6497,-1558"/>
<text text-anchor="middle" x="6400" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU2</text>
<text text-anchor="middle" x="6400" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6400" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="6400" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_v_gpu2&#45;&gt;l1_kv_gather_gpu2 -->
<g id="edge15" class="edge">
<title>l1_v_gpu2&#45;&gt;l1_kv_gather_gpu2</title>
<path fill="none" stroke="black" d="M6400,-1489.68C6400,-1489.68 6400,-1442.17 6400,-1442.17"/>
<polygon fill="black" stroke="black" points="6403.5,-1442.17 6400,-1432.17 6396.5,-1442.17 6403.5,-1442.17"/>
</g>
<!-- l1_proj_gpu2&#45;&gt;l1_attn_allreduce -->
<g id="edge18" class="edge">
<title>l1_proj_gpu2&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M7174.49,-1043.89C7174.49,-1003.02 7174.49,-940 7174.49,-940 7174.49,-940 6546.7,-940 6546.7,-940"/>
<polygon fill="black" stroke="black" points="6546.71,-936.5 6536.7,-940 6546.7,-943.5 6546.71,-936.5"/>
</g>
<!-- l1_q_gpu3 -->
<g id="node20" class="node">
<title>l1_q_gpu3</title>
<polygon fill="yellow" stroke="black" points="7586,-1398 7392,-1398 7392,-1330 7586,-1330 7586,-1398"/>
<text text-anchor="middle" x="7489" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU3</text>
<text text-anchor="middle" x="7489" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7489" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="7489" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_attn_gpu3 -->
<g id="node21" class="node">
<title>l1_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="5511.5,-1238 4988.5,-1238 4988.5,-1170 5511.5,-1170 5511.5,-1238"/>
<text text-anchor="middle" x="5250" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU3</text>
<text text-anchor="middle" x="5250" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="5250" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="5250" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_q_gpu3&#45;&gt;l1_attn_gpu3 -->
<g id="edge19" class="edge">
<title>l1_q_gpu3&#45;&gt;l1_attn_gpu3</title>
<path fill="none" stroke="black" d="M7489,-1329.58C7489,-1308.29 7489,-1285 7489,-1285 7489,-1285 5427.63,-1285 5427.63,-1285 5427.63,-1285 5427.63,-1248.35 5427.63,-1248.35"/>
<polygon fill="black" stroke="black" points="5431.13,-1248.35 5427.63,-1238.35 5424.13,-1248.35 5431.13,-1248.35"/>
</g>
<!-- l1_proj_gpu3 -->
<g id="node25" class="node">
<title>l1_proj_gpu3</title>
<polygon fill="yellow" stroke="black" points="5670.5,-1112 5467.5,-1112 5467.5,-1044 5670.5,-1044 5670.5,-1112"/>
<text text-anchor="middle" x="5569" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU3</text>
<text text-anchor="middle" x="5569" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="5569" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5569" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_attn_gpu3&#45;&gt;l1_proj_gpu3 -->
<g id="edge23" class="edge">
<title>l1_attn_gpu3&#45;&gt;l1_proj_gpu3</title>
<path fill="none" stroke="black" d="M5489.5,-1169.9C5489.5,-1169.9 5489.5,-1122.12 5489.5,-1122.12"/>
<polygon fill="black" stroke="black" points="5493,-1122.12 5489.5,-1112.12 5486,-1122.12 5493,-1122.12"/>
</g>
<!-- l1_k_gpu3 -->
<g id="node22" class="node">
<title>l1_k_gpu3</title>
<polygon fill="yellow" stroke="black" points="4749,-1558 4555,-1558 4555,-1490 4749,-1490 4749,-1558"/>
<text text-anchor="middle" x="4652" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU3</text>
<text text-anchor="middle" x="4652" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4652" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="4652" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_kv_gather_gpu3 -->
<g id="node23" class="node">
<title>l1_kv_gather_gpu3</title>
<polygon fill="lightcyan" stroke="black" points="4864.47,-1432 4516.93,-1432 4427.53,-1296 4775.07,-1296 4864.47,-1432"/>
<text text-anchor="middle" x="4646" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="4646" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="4646" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="4646" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_k_gpu3&#45;&gt;l1_kv_gather_gpu3 -->
<g id="edge20" class="edge">
<title>l1_k_gpu3&#45;&gt;l1_kv_gather_gpu3</title>
<path fill="none" stroke="black" d="M4652,-1489.68C4652,-1489.68 4652,-1442.17 4652,-1442.17"/>
<polygon fill="black" stroke="black" points="4655.5,-1442.17 4652,-1432.17 4648.5,-1442.17 4655.5,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu3&#45;&gt;l1_attn_gpu3 -->
<g id="edge22" class="edge">
<title>l1_kv_gather_gpu3&#45;&gt;l1_attn_gpu3</title>
<path fill="none" stroke="black" d="M4653.87,-1295.72C4653.87,-1268.27 4653.87,-1243 4653.87,-1243 4653.87,-1243 5099.75,-1243 5099.75,-1243 5099.75,-1243 5099.75,-1242.52 5099.75,-1242.52"/>
<polygon fill="black" stroke="black" points="5103.25,-1248.22 5099.75,-1238.22 5096.25,-1248.22 5103.25,-1248.22"/>
</g>
<!-- l1_v_gpu3 -->
<g id="node24" class="node">
<title>l1_v_gpu3</title>
<polygon fill="yellow" stroke="black" points="4972,-1558 4778,-1558 4778,-1490 4972,-1490 4972,-1558"/>
<text text-anchor="middle" x="4875" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU3</text>
<text text-anchor="middle" x="4875" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4875" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="4875" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_v_gpu3&#45;&gt;l1_kv_gather_gpu3 -->
<g id="edge21" class="edge">
<title>l1_v_gpu3&#45;&gt;l1_kv_gather_gpu3</title>
<path fill="none" stroke="black" d="M4821.12,-1489.68C4821.12,-1489.68 4821.12,-1442.17 4821.12,-1442.17"/>
<polygon fill="black" stroke="black" points="4824.62,-1442.17 4821.12,-1432.17 4817.62,-1442.17 4824.62,-1442.17"/>
</g>
<!-- l1_proj_gpu3&#45;&gt;l1_attn_allreduce -->
<g id="edge24" class="edge">
<title>l1_proj_gpu3&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M5611.5,-1043.9C5611.5,-1006.59 5611.5,-952 5611.5,-952 5611.5,-952 6171.48,-952 6171.48,-952"/>
<polygon fill="black" stroke="black" points="6171.48,-955.5 6181.48,-952 6171.48,-948.5 6171.48,-955.5"/>
</g>
<!-- l1_q_gpu4 -->
<g id="node26" class="node">
<title>l1_q_gpu4</title>
<polygon fill="yellow" stroke="black" points="8666,-1398 8472,-1398 8472,-1330 8666,-1330 8666,-1398"/>
<text text-anchor="middle" x="8569" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU4</text>
<text text-anchor="middle" x="8569" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8569" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="8569" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_attn_gpu4 -->
<g id="node27" class="node">
<title>l1_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="8236.5,-1238 7713.5,-1238 7713.5,-1170 8236.5,-1170 8236.5,-1238"/>
<text text-anchor="middle" x="7975" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU4</text>
<text text-anchor="middle" x="7975" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="7975" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7975" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_q_gpu4&#45;&gt;l1_attn_gpu4 -->
<g id="edge25" class="edge">
<title>l1_q_gpu4&#45;&gt;l1_attn_gpu4</title>
<path fill="none" stroke="black" d="M8533.25,-1329.68C8533.25,-1282.66 8533.25,-1204 8533.25,-1204 8533.25,-1204 8246.55,-1204 8246.55,-1204"/>
<polygon fill="black" stroke="black" points="8246.55,-1200.5 8236.55,-1204 8246.55,-1207.5 8246.55,-1200.5"/>
</g>
<!-- l1_proj_gpu4 -->
<g id="node31" class="node">
<title>l1_proj_gpu4</title>
<polygon fill="yellow" stroke="black" points="7836.5,-1112 7633.5,-1112 7633.5,-1044 7836.5,-1044 7836.5,-1112"/>
<text text-anchor="middle" x="7735" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU4</text>
<text text-anchor="middle" x="7735" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7735" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7735" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_attn_gpu4&#45;&gt;l1_proj_gpu4 -->
<g id="edge29" class="edge">
<title>l1_attn_gpu4&#45;&gt;l1_proj_gpu4</title>
<path fill="none" stroke="black" d="M7775,-1169.9C7775,-1169.9 7775,-1122.12 7775,-1122.12"/>
<polygon fill="black" stroke="black" points="7778.5,-1122.12 7775,-1112.12 7771.5,-1122.12 7778.5,-1122.12"/>
</g>
<!-- l1_k_gpu4 -->
<g id="node28" class="node">
<title>l1_k_gpu4</title>
<polygon fill="yellow" stroke="black" points="6929,-1558 6735,-1558 6735,-1490 6929,-1490 6929,-1558"/>
<text text-anchor="middle" x="6832" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU4</text>
<text text-anchor="middle" x="6832" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6832" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="6832" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_kv_gather_gpu4 -->
<g id="node29" class="node">
<title>l1_kv_gather_gpu4</title>
<polygon fill="lightcyan" stroke="black" points="7154.47,-1432 6806.93,-1432 6717.53,-1296 7065.07,-1296 7154.47,-1432"/>
<text text-anchor="middle" x="6936" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="6936" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="6936" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="6936" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_k_gpu4&#45;&gt;l1_kv_gather_gpu4 -->
<g id="edge26" class="edge">
<title>l1_k_gpu4&#45;&gt;l1_kv_gather_gpu4</title>
<path fill="none" stroke="black" d="M6832,-1489.68C6832,-1489.68 6832,-1442.17 6832,-1442.17"/>
<polygon fill="black" stroke="black" points="6835.5,-1442.17 6832,-1432.17 6828.5,-1442.17 6835.5,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu4&#45;&gt;l1_attn_gpu4 -->
<g id="edge28" class="edge">
<title>l1_kv_gather_gpu4&#45;&gt;l1_attn_gpu4</title>
<path fill="none" stroke="black" d="M7079.61,-1318C7315.16,-1318 7757.75,-1318 7757.75,-1318 7757.75,-1318 7757.75,-1248.2 7757.75,-1248.2"/>
<polygon fill="black" stroke="black" points="7761.25,-1248.2 7757.75,-1238.2 7754.25,-1248.2 7761.25,-1248.2"/>
</g>
<!-- l1_v_gpu4 -->
<g id="node30" class="node">
<title>l1_v_gpu4</title>
<polygon fill="yellow" stroke="black" points="7145,-1558 6951,-1558 6951,-1490 7145,-1490 7145,-1558"/>
<text text-anchor="middle" x="7048" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU4</text>
<text text-anchor="middle" x="7048" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7048" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="7048" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_v_gpu4&#45;&gt;l1_kv_gather_gpu4 -->
<g id="edge27" class="edge">
<title>l1_v_gpu4&#45;&gt;l1_kv_gather_gpu4</title>
<path fill="none" stroke="black" d="M7048,-1489.68C7048,-1489.68 7048,-1442.17 7048,-1442.17"/>
<polygon fill="black" stroke="black" points="7051.5,-1442.17 7048,-1432.17 7044.5,-1442.17 7051.5,-1442.17"/>
</g>
<!-- l1_proj_gpu4&#45;&gt;l1_attn_allreduce -->
<g id="edge30" class="edge">
<title>l1_proj_gpu4&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M7647.51,-1043.58C7647.51,-990.57 7647.51,-895 7647.51,-895 7647.51,-895 6515.93,-895 6515.93,-895"/>
<polygon fill="black" stroke="black" points="6515.93,-891.5 6505.93,-895 6515.93,-898.5 6515.93,-891.5"/>
</g>
<!-- l1_q_gpu5 -->
<g id="node32" class="node">
<title>l1_q_gpu5</title>
<polygon fill="yellow" stroke="black" points="8234,-1398 8040,-1398 8040,-1330 8234,-1330 8234,-1398"/>
<text text-anchor="middle" x="8137" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU5</text>
<text text-anchor="middle" x="8137" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8137" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="8137" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_attn_gpu5 -->
<g id="node33" class="node">
<title>l1_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="7146.5,-1238 6623.5,-1238 6623.5,-1170 7146.5,-1170 7146.5,-1238"/>
<text text-anchor="middle" x="6885" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU5</text>
<text text-anchor="middle" x="6885" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="6885" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6885" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_q_gpu5&#45;&gt;l1_attn_gpu5 -->
<g id="edge31" class="edge">
<title>l1_q_gpu5&#45;&gt;l1_attn_gpu5</title>
<path fill="none" stroke="black" d="M8137,-1329.97C8137,-1302.71 8137,-1269 8137,-1269 8137,-1269 6932.13,-1269 6932.13,-1269 6932.13,-1269 6932.13,-1248.02 6932.13,-1248.02"/>
<polygon fill="black" stroke="black" points="6935.63,-1248.02 6932.13,-1238.02 6928.63,-1248.02 6935.63,-1248.02"/>
</g>
<!-- l1_proj_gpu5 -->
<g id="node37" class="node">
<title>l1_proj_gpu5</title>
<polygon fill="yellow" stroke="black" points="6826.5,-1112 6623.5,-1112 6623.5,-1044 6826.5,-1044 6826.5,-1112"/>
<text text-anchor="middle" x="6725" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU5</text>
<text text-anchor="middle" x="6725" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6725" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6725" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_attn_gpu5&#45;&gt;l1_proj_gpu5 -->
<g id="edge35" class="edge">
<title>l1_attn_gpu5&#45;&gt;l1_proj_gpu5</title>
<path fill="none" stroke="black" d="M6725,-1169.9C6725,-1169.9 6725,-1122.12 6725,-1122.12"/>
<polygon fill="black" stroke="black" points="6728.5,-1122.12 6725,-1112.12 6721.5,-1122.12 6728.5,-1122.12"/>
</g>
<!-- l1_k_gpu5 -->
<g id="node34" class="node">
<title>l1_k_gpu5</title>
<polygon fill="yellow" stroke="black" points="6065,-1558 5871,-1558 5871,-1490 6065,-1490 6065,-1558"/>
<text text-anchor="middle" x="5968" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU5</text>
<text text-anchor="middle" x="5968" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5968" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="5968" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_kv_gather_gpu5 -->
<g id="node35" class="node">
<title>l1_kv_gather_gpu5</title>
<polygon fill="lightcyan" stroke="black" points="6238.47,-1432 5890.93,-1432 5801.53,-1296 6149.07,-1296 6238.47,-1432"/>
<text text-anchor="middle" x="6020" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="6020" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="6020" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="6020" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_k_gpu5&#45;&gt;l1_kv_gather_gpu5 -->
<g id="edge32" class="edge">
<title>l1_k_gpu5&#45;&gt;l1_kv_gather_gpu5</title>
<path fill="none" stroke="black" d="M5968,-1489.68C5968,-1489.68 5968,-1442.17 5968,-1442.17"/>
<polygon fill="black" stroke="black" points="5971.5,-1442.17 5968,-1432.17 5964.5,-1442.17 5971.5,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu5&#45;&gt;l1_attn_gpu5 -->
<g id="edge34" class="edge">
<title>l1_kv_gather_gpu5&#45;&gt;l1_attn_gpu5</title>
<path fill="none" stroke="black" d="M6184.99,-1350.27C6184.99,-1321.81 6184.99,-1259 6184.99,-1259 6184.99,-1259 6647.75,-1259 6647.75,-1259 6647.75,-1259 6647.75,-1248.21 6647.75,-1248.21"/>
<polygon fill="black" stroke="black" points="6651.25,-1248.21 6647.75,-1238.21 6644.25,-1248.21 6651.25,-1248.21"/>
</g>
<!-- l1_v_gpu5 -->
<g id="node36" class="node">
<title>l1_v_gpu5</title>
<polygon fill="yellow" stroke="black" points="6281,-1558 6087,-1558 6087,-1490 6281,-1490 6281,-1558"/>
<text text-anchor="middle" x="6184" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU5</text>
<text text-anchor="middle" x="6184" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6184" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="6184" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_v_gpu5&#45;&gt;l1_kv_gather_gpu5 -->
<g id="edge33" class="edge">
<title>l1_v_gpu5&#45;&gt;l1_kv_gather_gpu5</title>
<path fill="none" stroke="black" d="M6162.62,-1489.68C6162.62,-1489.68 6162.62,-1442.17 6162.62,-1442.17"/>
<polygon fill="black" stroke="black" points="6166.12,-1442.17 6162.62,-1432.17 6159.12,-1442.17 6166.12,-1442.17"/>
</g>
<!-- l1_proj_gpu5&#45;&gt;l1_attn_allreduce -->
<g id="edge36" class="edge">
<title>l1_proj_gpu5&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6623.28,-1078C6565.58,-1078 6504.79,-1078 6504.79,-1078 6504.79,-1078 6504.79,-996.32 6504.79,-996.32"/>
<polygon fill="black" stroke="black" points="6508.29,-996.32 6504.79,-986.32 6501.29,-996.32 6508.29,-996.32"/>
</g>
<!-- l1_q_gpu6 -->
<g id="node38" class="node">
<title>l1_q_gpu6</title>
<polygon fill="yellow" stroke="black" points="7802,-1398 7608,-1398 7608,-1330 7802,-1330 7802,-1398"/>
<text text-anchor="middle" x="7705" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU6</text>
<text text-anchor="middle" x="7705" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7705" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="7705" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_attn_gpu6 -->
<g id="node39" class="node">
<title>l1_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="6056.5,-1238 5533.5,-1238 5533.5,-1170 6056.5,-1170 6056.5,-1238"/>
<text text-anchor="middle" x="5795" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU6</text>
<text text-anchor="middle" x="5795" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="5795" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="5795" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_q_gpu6&#45;&gt;l1_attn_gpu6 -->
<g id="edge37" class="edge">
<title>l1_q_gpu6&#45;&gt;l1_attn_gpu6</title>
<path fill="none" stroke="black" d="M7635.83,-1329.83C7635.83,-1306.58 7635.83,-1280 7635.83,-1280 7635.83,-1280 5929.13,-1280 5929.13,-1280 5929.13,-1280 5929.13,-1248.44 5929.13,-1248.44"/>
<polygon fill="black" stroke="black" points="5932.63,-1248.44 5929.13,-1238.44 5925.63,-1248.44 5932.63,-1248.44"/>
</g>
<!-- l1_proj_gpu6 -->
<g id="node43" class="node">
<title>l1_proj_gpu6</title>
<polygon fill="yellow" stroke="black" points="6109.5,-1112 5906.5,-1112 5906.5,-1044 6109.5,-1044 6109.5,-1112"/>
<text text-anchor="middle" x="6008" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU6</text>
<text text-anchor="middle" x="6008" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6008" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6008" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_attn_gpu6&#45;&gt;l1_proj_gpu6 -->
<g id="edge41" class="edge">
<title>l1_attn_gpu6&#45;&gt;l1_proj_gpu6</title>
<path fill="none" stroke="black" d="M5981.5,-1169.9C5981.5,-1169.9 5981.5,-1122.12 5981.5,-1122.12"/>
<polygon fill="black" stroke="black" points="5985,-1122.12 5981.5,-1112.12 5978,-1122.12 5985,-1122.12"/>
</g>
<!-- l1_k_gpu6 -->
<g id="node40" class="node">
<title>l1_k_gpu6</title>
<polygon fill="yellow" stroke="black" points="5417,-1558 5223,-1558 5223,-1490 5417,-1490 5417,-1558"/>
<text text-anchor="middle" x="5320" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU6</text>
<text text-anchor="middle" x="5320" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5320" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="5320" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_kv_gather_gpu6 -->
<g id="node41" class="node">
<title>l1_kv_gather_gpu6</title>
<polygon fill="lightcyan" stroke="black" points="5322.47,-1432 4974.93,-1432 4885.53,-1296 5233.07,-1296 5322.47,-1432"/>
<text text-anchor="middle" x="5104" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="5104" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="5104" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="5104" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_k_gpu6&#45;&gt;l1_kv_gather_gpu6 -->
<g id="edge38" class="edge">
<title>l1_k_gpu6&#45;&gt;l1_kv_gather_gpu6</title>
<path fill="none" stroke="black" d="M5272.62,-1489.68C5272.62,-1489.68 5272.62,-1442.17 5272.62,-1442.17"/>
<polygon fill="black" stroke="black" points="5276.12,-1442.17 5272.62,-1432.17 5269.12,-1442.17 5276.12,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu6&#45;&gt;l1_attn_gpu6 -->
<g id="edge40" class="edge">
<title>l1_kv_gather_gpu6&#45;&gt;l1_attn_gpu6</title>
<path fill="none" stroke="black" d="M5210.99,-1295.85C5210.99,-1270.6 5210.99,-1248 5210.99,-1248 5210.99,-1248 5615.75,-1248 5615.75,-1248 5615.75,-1248 5615.75,-1247.02 5615.75,-1247.02"/>
<polygon fill="black" stroke="black" points="5619.25,-1248.23 5615.75,-1238.23 5612.25,-1248.24 5619.25,-1248.23"/>
</g>
<!-- l1_v_gpu6 -->
<g id="node42" class="node">
<title>l1_v_gpu6</title>
<polygon fill="yellow" stroke="black" points="5201,-1558 5007,-1558 5007,-1490 5201,-1490 5201,-1558"/>
<text text-anchor="middle" x="5104" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU6</text>
<text text-anchor="middle" x="5104" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5104" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="5104" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_v_gpu6&#45;&gt;l1_kv_gather_gpu6 -->
<g id="edge39" class="edge">
<title>l1_v_gpu6&#45;&gt;l1_kv_gather_gpu6</title>
<path fill="none" stroke="black" d="M5104,-1489.68C5104,-1489.68 5104,-1442.17 5104,-1442.17"/>
<polygon fill="black" stroke="black" points="5107.5,-1442.17 5104,-1432.17 5100.5,-1442.17 5107.5,-1442.17"/>
</g>
<!-- l1_proj_gpu6&#45;&gt;l1_attn_allreduce -->
<g id="edge42" class="edge">
<title>l1_proj_gpu6&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6109.6,-1078C6144.62,-1078 6175.21,-1078 6175.21,-1078 6175.21,-1078 6175.21,-952.65 6175.21,-952.65"/>
<polygon fill="black" stroke="black" points="6178.71,-952.65 6175.21,-942.65 6171.71,-952.65 6178.71,-952.65"/>
</g>
<!-- l1_q_gpu7 -->
<g id="node44" class="node">
<title>l1_q_gpu7</title>
<polygon fill="yellow" stroke="black" points="8018,-1398 7824,-1398 7824,-1330 8018,-1330 8018,-1398"/>
<text text-anchor="middle" x="7921" y="-1382.8" font-family="Times,serif" font-size="14.00">Q Projection GPU7</text>
<text text-anchor="middle" x="7921" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7921" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="7921" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_attn_gpu7 -->
<g id="node45" class="node">
<title>l1_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="6601.5,-1238 6078.5,-1238 6078.5,-1170 6601.5,-1170 6601.5,-1238"/>
<text text-anchor="middle" x="6340" y="-1222.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention GPU7</text>
<text text-anchor="middle" x="6340" y="-1207.8" font-family="Times,serif" font-size="14.00">Input: Q=[1024,2048,128], K=[1024,2048,1024], V=[1024,2048,1024]</text>
<text text-anchor="middle" x="6340" y="-1192.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6340" y="-1177.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_q_gpu7&#45;&gt;l1_attn_gpu7 -->
<g id="edge43" class="edge">
<title>l1_q_gpu7&#45;&gt;l1_attn_gpu7</title>
<path fill="none" stroke="black" d="M7921,-1329.97C7921,-1304.49 7921,-1274 7921,-1274 7921,-1274 6430.63,-1274 6430.63,-1274 6430.63,-1274 6430.63,-1248.18 6430.63,-1248.18"/>
<polygon fill="black" stroke="black" points="6434.13,-1248.18 6430.63,-1238.18 6427.13,-1248.18 6434.13,-1248.18"/>
</g>
<!-- l1_proj_gpu7 -->
<g id="node49" class="node">
<title>l1_proj_gpu7</title>
<polygon fill="yellow" stroke="black" points="6441.5,-1112 6238.5,-1112 6238.5,-1044 6441.5,-1044 6441.5,-1112"/>
<text text-anchor="middle" x="6340" y="-1096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU7</text>
<text text-anchor="middle" x="6340" y="-1081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6340" y="-1066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6340" y="-1051.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_attn_gpu7&#45;&gt;l1_proj_gpu7 -->
<g id="edge47" class="edge">
<title>l1_attn_gpu7&#45;&gt;l1_proj_gpu7</title>
<path fill="none" stroke="black" d="M6340,-1169.9C6340,-1169.9 6340,-1122.12 6340,-1122.12"/>
<polygon fill="black" stroke="black" points="6343.5,-1122.12 6340,-1112.12 6336.5,-1122.12 6343.5,-1122.12"/>
</g>
<!-- l1_k_gpu7 -->
<g id="node46" class="node">
<title>l1_k_gpu7</title>
<polygon fill="yellow" stroke="black" points="5633,-1558 5439,-1558 5439,-1490 5633,-1490 5633,-1558"/>
<text text-anchor="middle" x="5536" y="-1542.8" font-family="Times,serif" font-size="14.00">K Projection GPU7</text>
<text text-anchor="middle" x="5536" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5536" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="5536" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_kv_gather_gpu7 -->
<g id="node47" class="node">
<title>l1_kv_gather_gpu7</title>
<polygon fill="lightcyan" stroke="black" points="5780.47,-1432 5432.93,-1432 5343.53,-1296 5691.07,-1296 5780.47,-1432"/>
<text text-anchor="middle" x="5562" y="-1382.8" font-family="Times,serif" font-size="14.00">Gather K,V</text>
<text text-anchor="middle" x="5562" y="-1367.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="5562" y="-1352.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,1024]</text>
<text text-anchor="middle" x="5562" y="-1337.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_k_gpu7&#45;&gt;l1_kv_gather_gpu7 -->
<g id="edge44" class="edge">
<title>l1_k_gpu7&#45;&gt;l1_kv_gather_gpu7</title>
<path fill="none" stroke="black" d="M5536,-1489.68C5536,-1489.68 5536,-1442.17 5536,-1442.17"/>
<polygon fill="black" stroke="black" points="5539.5,-1442.17 5536,-1432.17 5532.5,-1442.17 5539.5,-1442.17"/>
</g>
<!-- l1_kv_gather_gpu7&#45;&gt;l1_attn_gpu7 -->
<g id="edge46" class="edge">
<title>l1_kv_gather_gpu7&#45;&gt;l1_attn_gpu7</title>
<path fill="none" stroke="black" d="M5697.99,-1306.22C5697.99,-1279.25 5697.99,-1253 5697.99,-1253 5697.99,-1253 6131.75,-1253 6131.75,-1253 6131.75,-1253 6131.75,-1248.03 6131.75,-1248.03"/>
<polygon fill="black" stroke="black" points="6135.25,-1248.03 6131.75,-1238.03 6128.25,-1248.03 6135.25,-1248.03"/>
</g>
<!-- l1_v_gpu7 -->
<g id="node48" class="node">
<title>l1_v_gpu7</title>
<polygon fill="yellow" stroke="black" points="5849,-1558 5655,-1558 5655,-1490 5849,-1490 5849,-1558"/>
<text text-anchor="middle" x="5752" y="-1542.8" font-family="Times,serif" font-size="14.00">V Projection GPU7</text>
<text text-anchor="middle" x="5752" y="-1527.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5752" y="-1512.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="5752" y="-1497.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_v_gpu7&#45;&gt;l1_kv_gather_gpu7 -->
<g id="edge45" class="edge">
<title>l1_v_gpu7&#45;&gt;l1_kv_gather_gpu7</title>
<path fill="none" stroke="black" d="M5717.62,-1489.68C5717.62,-1489.68 5717.62,-1442.17 5717.62,-1442.17"/>
<polygon fill="black" stroke="black" points="5721.12,-1442.17 5717.62,-1432.17 5714.12,-1442.17 5721.12,-1442.17"/>
</g>
<!-- l1_proj_gpu7&#45;&gt;l1_attn_allreduce -->
<g id="edge48" class="edge">
<title>l1_proj_gpu7&#45;&gt;l1_attn_allreduce</title>
<path fill="none" stroke="black" d="M6340,-1043.68C6340,-1043.68 6340,-996.17 6340,-996.17"/>
<polygon fill="black" stroke="black" points="6343.5,-996.17 6340,-986.17 6336.5,-996.17 6343.5,-996.17"/>
</g>
<!-- l1_attn_moe_comm -->
<g id="node80" class="node">
<title>l1_attn_moe_comm</title>
<polygon fill="gray" stroke="black" points="7661.55,-666 7278.89,-666 7180.45,-530 7563.11,-530 7661.55,-666"/>
<text text-anchor="middle" x="7421" y="-616.8" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="7421" y="-601.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7421" y="-586.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="7421" y="-571.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- l1_attn_res&#45;&gt;l1_attn_moe_comm -->
<g id="edge84" class="edge">
<title>l1_attn_res&#45;&gt;l1_attn_moe_comm</title>
<path fill="none" stroke="black" d="M7421,-723.68C7421,-723.68 7421,-676.17 7421,-676.17"/>
<polygon fill="black" stroke="black" points="7424.5,-676.17 7421,-666.17 7417.5,-676.17 7424.5,-676.17"/>
</g>
<!-- l1_gate -->
<g id="node51" class="node">
<title>l1_gate</title>
<polygon fill="lightcoral" stroke="black" points="5743.5,-438 5552.5,-438 5552.5,-370 5743.5,-370 5743.5,-438"/>
<text text-anchor="middle" x="5648" y="-422.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5648" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5648" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="5648" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_router -->
<g id="node52" class="node">
<title>l1_router</title>
<polygon fill="lightgreen" stroke="black" points="6194.18,-472 5853.47,-472 5765.82,-336 6106.53,-336 6194.18,-472"/>
<text text-anchor="middle" x="5980" y="-422.8" font-family="Times,serif" font-size="14.00">Top&#45;2 Router</text>
<text text-anchor="middle" x="5980" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16]</text>
<text text-anchor="middle" x="5980" y="-392.8" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
<text text-anchor="middle" x="5980" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_expert&#45;8_gpu8 -->
<g id="node81" class="node">
<title>l1_expert&#45;8_gpu8</title>
<polygon fill="lightblue" stroke="black" points="7595,-422 7455,-422 7455,-386 7595,-386 7595,-422"/>
<text text-anchor="middle" x="7525" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;8_gpu8</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;8_gpu8 -->
<g id="edge104" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;8_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6173.93,-440C6581.57,-440 7490,-440 7490,-440 7490,-440 7490,-432.42 7490,-432.42"/>
<polygon fill="black" stroke="black" points="7493.5,-432.42 7490,-422.42 7486.5,-432.42 7493.5,-432.42"/>
</g>
<!-- l1_expert&#45;7_gpu8 -->
<g id="node82" class="node">
<title>l1_expert&#45;7_gpu8</title>
<polygon fill="lightblue" stroke="black" points="7757,-422 7617,-422 7617,-386 7757,-386 7757,-422"/>
<text text-anchor="middle" x="7687" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;7_gpu8</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;7_gpu8 -->
<g id="edge105" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6175.53,-443C6612.11,-443 7628.13,-443 7628.13,-443 7628.13,-443 7628.13,-432.13 7628.13,-432.13"/>
<polygon fill="black" stroke="black" points="7631.63,-432.13 7628.13,-422.13 7624.63,-432.13 7631.63,-432.13"/>
</g>
<!-- l1_expert&#45;7_gpu9 -->
<g id="node83" class="node">
<title>l1_expert&#45;7_gpu9</title>
<polygon fill="lightblue" stroke="black" points="7919,-422 7779,-422 7779,-386 7919,-386 7919,-422"/>
<text text-anchor="middle" x="7849" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;7_gpu9</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;7_gpu9 -->
<g id="edge106" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;7_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6178.38,-447C6648.91,-447 7793.38,-447 7793.38,-447 7793.38,-447 7793.38,-432.49 7793.38,-432.49"/>
<polygon fill="black" stroke="black" points="7796.88,-432.49 7793.38,-422.49 7789.88,-432.49 7796.88,-432.49"/>
</g>
<!-- l1_expert&#45;6_gpu9 -->
<g id="node84" class="node">
<title>l1_expert&#45;6_gpu9</title>
<polygon fill="lightblue" stroke="black" points="8081,-422 7941,-422 7941,-386 8081,-386 8081,-422"/>
<text text-anchor="middle" x="8011" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;6_gpu9</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;6_gpu9 -->
<g id="edge107" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;6_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6180.06,-450C6685.9,-450 7976,-450 7976,-450 7976,-450 7976,-432.18 7976,-432.18"/>
<polygon fill="black" stroke="black" points="7979.5,-432.18 7976,-422.18 7972.5,-432.18 7979.5,-432.18"/>
</g>
<!-- l1_expert&#45;6_gpu10 -->
<g id="node85" class="node">
<title>l1_expert&#45;6_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8252.5,-422 8103.5,-422 8103.5,-386 8252.5,-386 8252.5,-422"/>
<text text-anchor="middle" x="8178" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;6_gpu10</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;6_gpu10 -->
<g id="edge108" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;6_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6182.42,-453C6718.94,-453 8136.75,-453 8136.75,-453 8136.75,-453 8136.75,-432.25 8136.75,-432.25"/>
<polygon fill="black" stroke="black" points="8140.25,-432.25 8136.75,-422.25 8133.25,-432.25 8140.25,-432.25"/>
</g>
<!-- l1_expert&#45;5_gpu10 -->
<g id="node86" class="node">
<title>l1_expert&#45;5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8423.5,-422 8274.5,-422 8274.5,-386 8423.5,-386 8423.5,-422"/>
<text text-anchor="middle" x="8349" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;5_gpu10</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;5_gpu10 -->
<g id="edge109" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;5_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6184.12,-456C6752.48,-456 8311.75,-456 8311.75,-456 8311.75,-456 8311.75,-432.19 8311.75,-432.19"/>
<polygon fill="black" stroke="black" points="8315.25,-432.19 8311.75,-422.19 8308.25,-432.19 8315.25,-432.19"/>
</g>
<!-- l1_expert&#45;5_gpu11 -->
<g id="node87" class="node">
<title>l1_expert&#45;5_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8594.5,-422 8445.5,-422 8445.5,-386 8594.5,-386 8594.5,-422"/>
<text text-anchor="middle" x="8520" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;5_gpu11</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;5_gpu11 -->
<g id="edge110" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;5_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6186.01,-459C6780.27,-459 8455.5,-459 8455.5,-459 8455.5,-459 8455.5,-432.01 8455.5,-432.01"/>
<polygon fill="black" stroke="black" points="8459,-432.01 8455.5,-422.01 8452,-432.01 8459,-432.01"/>
</g>
<!-- l1_expert&#45;4_gpu11 -->
<g id="node88" class="node">
<title>l1_expert&#45;4_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8765.5,-422 8616.5,-422 8616.5,-386 8765.5,-386 8765.5,-422"/>
<text text-anchor="middle" x="8691" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;4_gpu11</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;4_gpu11 -->
<g id="edge111" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;4_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6187.85,-462C6812.3,-462 8628.88,-462 8628.88,-462 8628.88,-462 8628.88,-432.03 8628.88,-432.03"/>
<polygon fill="black" stroke="black" points="8632.38,-432.03 8628.88,-422.03 8625.38,-432.03 8632.38,-432.03"/>
</g>
<!-- l1_expert&#45;4_gpu12 -->
<g id="node89" class="node">
<title>l1_expert&#45;4_gpu12</title>
<polygon fill="lightblue" stroke="black" points="8936.5,-422 8787.5,-422 8787.5,-386 8936.5,-386 8936.5,-422"/>
<text text-anchor="middle" x="8862" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;4_gpu12</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;4_gpu12 -->
<g id="edge112" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;4_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6189.76,-465C6847.3,-465 8824.75,-465 8824.75,-465 8824.75,-465 8824.75,-432.3 8824.75,-432.3"/>
<polygon fill="black" stroke="black" points="8828.25,-432.3 8824.75,-422.3 8821.25,-432.3 8828.25,-432.3"/>
</g>
<!-- l1_expert&#45;3_gpu12 -->
<g id="node90" class="node">
<title>l1_expert&#45;3_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6365.5,-422 6216.5,-422 6216.5,-386 6365.5,-386 6365.5,-422"/>
<text text-anchor="middle" x="6291" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;3_gpu12</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;3_gpu12 -->
<g id="edge113" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6150.51,-404C6150.51,-404 6206.31,-404 6206.31,-404"/>
<polygon fill="black" stroke="black" points="6206.31,-407.5 6216.31,-404 6206.31,-400.5 6206.31,-407.5"/>
</g>
<!-- l1_expert&#45;3_gpu13 -->
<g id="node91" class="node">
<title>l1_expert&#45;3_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6536.5,-422 6387.5,-422 6387.5,-386 6536.5,-386 6536.5,-422"/>
<text text-anchor="middle" x="6462" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;3_gpu13</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;3_gpu13 -->
<g id="edge114" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;3_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6122.87,-361C6272.76,-361 6486.83,-361 6486.83,-361 6486.83,-361 6486.83,-375.51 6486.83,-375.51"/>
<polygon fill="black" stroke="black" points="6483.33,-375.51 6486.83,-385.51 6490.33,-375.51 6483.33,-375.51"/>
</g>
<!-- l1_expert&#45;2_gpu13 -->
<g id="node92" class="node">
<title>l1_expert&#45;2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6707.5,-422 6558.5,-422 6558.5,-386 6707.5,-386 6707.5,-422"/>
<text text-anchor="middle" x="6633" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;2_gpu13</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;2_gpu13 -->
<g id="edge115" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;2_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6164.16,-425C6335.09,-425 6563.29,-425 6563.29,-425 6563.29,-425 6563.29,-424.71 6563.29,-424.71"/>
<polygon fill="black" stroke="black" points="6566.79,-432.08 6563.29,-422.08 6559.79,-432.08 6566.79,-432.08"/>
</g>
<!-- l1_expert&#45;2_gpu14 -->
<g id="node93" class="node">
<title>l1_expert&#45;2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6878.5,-422 6729.5,-422 6729.5,-386 6878.5,-386 6878.5,-422"/>
<text text-anchor="middle" x="6804" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;2_gpu14</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;2_gpu14 -->
<g id="edge116" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;2_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6166.28,-428C6397.53,-428 6761.83,-428 6761.83,-428 6761.83,-428 6761.83,-427.42 6761.83,-427.42"/>
<polygon fill="black" stroke="black" points="6765.33,-432.19 6761.83,-422.19 6758.33,-432.19 6765.33,-432.19"/>
</g>
<!-- l1_expert&#45;1_gpu14 -->
<g id="node94" class="node">
<title>l1_expert&#45;1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="7049.5,-422 6900.5,-422 6900.5,-386 7049.5,-386 7049.5,-422"/>
<text text-anchor="middle" x="6975" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;1_gpu14</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;1_gpu14 -->
<g id="edge117" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;1_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6167.79,-431C6446.67,-431 6937.75,-431 6937.75,-431 6937.75,-431 6937.75,-430.12 6937.75,-430.12"/>
<polygon fill="black" stroke="black" points="6941.25,-432.16 6937.75,-422.16 6934.25,-432.16 6941.25,-432.16"/>
</g>
<!-- l1_expert&#45;1_gpu15 -->
<g id="node95" class="node">
<title>l1_expert&#45;1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7220.5,-422 7071.5,-422 7071.5,-386 7220.5,-386 7220.5,-422"/>
<text text-anchor="middle" x="7146" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert&#45;1_gpu15</text>
</g>
<!-- l1_router&#45;&gt;l1_expert&#45;1_gpu15 -->
<g id="edge118" class="edge">
<title>l1_router&#45;&gt;l1_expert&#45;1_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6169.72,-434C6488.34,-434 7096.5,-434 7096.5,-434 7096.5,-434 7096.5,-432.14 7096.5,-432.14"/>
<polygon fill="black" stroke="black" points="7100,-432.14 7096.5,-422.14 7093,-432.14 7100,-432.14"/>
</g>
<!-- l1_expert0_gpu15 -->
<g id="node96" class="node">
<title>l1_expert0_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7387,-422 7243,-422 7243,-386 7387,-386 7387,-422"/>
<text text-anchor="middle" x="7315" y="-400.3" font-family="Times,serif" font-size="14.00">l1_expert0_gpu15</text>
</g>
<!-- l1_router&#45;&gt;l1_expert0_gpu15 -->
<g id="edge119" class="edge">
<title>l1_router&#45;&gt;l1_expert0_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6171.67,-437C6533.01,-437 7279,-437 7279,-437 7279,-437 7279,-432.04 7279,-432.04"/>
<polygon fill="black" stroke="black" points="7282.5,-432.04 7279,-422.04 7275.5,-432.04 7282.5,-432.04"/>
</g>
<!-- l1_expert0_gpu8 -->
<g id="node53" class="node">
<title>l1_expert0_gpu8</title>
<polygon fill="lightpink" stroke="black" points="5530,-438 5318,-438 5318,-370 5530,-370 5530,-438"/>
<text text-anchor="middle" x="5424" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5424" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5424" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="5424" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l1_expert1_gpu8 -->
<g id="node54" class="node">
<title>l1_expert1_gpu8</title>
<polygon fill="lightpink" stroke="black" points="5296,-438 5084,-438 5084,-370 5296,-370 5296,-438"/>
<text text-anchor="middle" x="5190" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5190" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5190" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="5190" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l1_expert_down_gpu8 -->
<g id="node55" class="node">
<title>l1_expert_down_gpu8</title>
<polygon fill="lightpink" stroke="black" points="2294.5,-438 2091.5,-438 2091.5,-370 2294.5,-370 2294.5,-438"/>
<text text-anchor="middle" x="2193" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU8</text>
<text text-anchor="middle" x="2193" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="2193" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2193" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l1_moe_agg -->
<g id="node56" class="node">
<title>l1_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="3113.17,-278 2750.2,-278 2656.83,-142 3019.8,-142 3113.17,-278"/>
<text text-anchor="middle" x="2885" y="-228.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2885" y="-213.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—2</text>
<text text-anchor="middle" x="2885" y="-198.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2885" y="-183.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_expert_down_gpu8&#45;&gt;l1_moe_agg -->
<g id="edge50" class="edge">
<title>l1_expert_down_gpu8&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M2193,-369.82C2193,-324.45 2193,-250 2193,-250 2193,-250 2720.56,-250 2720.56,-250"/>
<polygon fill="black" stroke="black" points="2720.56,-253.5 2730.56,-250 2720.56,-246.5 2720.56,-253.5"/>
</g>
<!-- l1_moe_res -->
<g id="node78" class="node">
<title>l1_moe_res</title>
<polygon fill="orange" stroke="black" points="4621,-84 4293,-84 4293,-16 4621,-16 4621,-84"/>
<text text-anchor="middle" x="4457" y="-68.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4457" y="-53.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="4457" y="-38.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4457" y="-23.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_moe_agg&#45;&gt;l1_moe_res -->
<g id="edge58" class="edge">
<title>l1_moe_agg&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M3038.45,-169C3413.21,-169 4344.67,-169 4344.67,-169 4344.67,-169 4344.67,-94.1 4344.67,-94.1"/>
<polygon fill="black" stroke="black" points="4348.17,-94.1 4344.67,-84.1 4341.17,-94.1 4348.17,-94.1"/>
</g>
<!-- l1_expert2_gpu9 -->
<g id="node57" class="node">
<title>l1_expert2_gpu9</title>
<polygon fill="lightpink" stroke="black" points="4838,-438 4626,-438 4626,-370 4838,-370 4838,-438"/>
<text text-anchor="middle" x="4732" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4732" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4732" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="4732" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l1_expert3_gpu9 -->
<g id="node58" class="node">
<title>l1_expert3_gpu9</title>
<polygon fill="lightpink" stroke="black" points="4604,-438 4392,-438 4392,-370 4604,-370 4604,-438"/>
<text text-anchor="middle" x="4498" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4498" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4498" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="4498" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l1_expert_down_gpu9 -->
<g id="node59" class="node">
<title>l1_expert_down_gpu9</title>
<polygon fill="lightpink" stroke="black" points="1602.5,-438 1399.5,-438 1399.5,-370 1602.5,-370 1602.5,-438"/>
<text text-anchor="middle" x="1501" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU9</text>
<text text-anchor="middle" x="1501" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="1501" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1501" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l1_expert_down_gpu9&#45;&gt;l1_moe_agg -->
<g id="edge51" class="edge">
<title>l1_expert_down_gpu9&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M1501,-369.96C1501,-317.52 1501,-223 1501,-223 1501,-223 2702.16,-223 2702.16,-223"/>
<polygon fill="black" stroke="black" points="2702.16,-226.5 2712.16,-223 2702.16,-219.5 2702.16,-226.5"/>
</g>
<!-- l1_expert4_gpu10 -->
<g id="node60" class="node">
<title>l1_expert4_gpu10</title>
<polygon fill="lightpink" stroke="black" points="4146,-438 3934,-438 3934,-370 4146,-370 4146,-438"/>
<text text-anchor="middle" x="4040" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4040" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4040" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="4040" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l1_expert5_gpu10 -->
<g id="node61" class="node">
<title>l1_expert5_gpu10</title>
<polygon fill="lightpink" stroke="black" points="3912,-438 3700,-438 3700,-370 3912,-370 3912,-438"/>
<text text-anchor="middle" x="3806" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3806" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3806" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="3806" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l1_expert_down_gpu10 -->
<g id="node62" class="node">
<title>l1_expert_down_gpu10</title>
<polygon fill="lightpink" stroke="black" points="910.5,-438 707.5,-438 707.5,-370 910.5,-370 910.5,-438"/>
<text text-anchor="middle" x="809" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU10</text>
<text text-anchor="middle" x="809" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="809" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="809" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l1_expert_down_gpu10&#45;&gt;l1_moe_agg -->
<g id="edge52" class="edge">
<title>l1_expert_down_gpu10&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M809,-369.65C809,-310.58 809,-196 809,-196 809,-196 2683.88,-196 2683.88,-196"/>
<polygon fill="black" stroke="black" points="2683.88,-199.5 2693.88,-196 2683.88,-192.5 2683.88,-199.5"/>
</g>
<!-- l1_expert6_gpu11 -->
<g id="node63" class="node">
<title>l1_expert6_gpu11</title>
<polygon fill="lightpink" stroke="black" points="3454,-438 3242,-438 3242,-370 3454,-370 3454,-438"/>
<text text-anchor="middle" x="3348" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3348" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3348" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="3348" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l1_expert7_gpu11 -->
<g id="node64" class="node">
<title>l1_expert7_gpu11</title>
<polygon fill="lightpink" stroke="black" points="3220,-438 3008,-438 3008,-370 3220,-370 3220,-438"/>
<text text-anchor="middle" x="3114" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3114" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3114" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="3114" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l1_expert_down_gpu11 -->
<g id="node65" class="node">
<title>l1_expert_down_gpu11</title>
<polygon fill="lightpink" stroke="black" points="218.5,-438 15.5,-438 15.5,-370 218.5,-370 218.5,-438"/>
<text text-anchor="middle" x="117" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU11</text>
<text text-anchor="middle" x="117" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="117" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="117" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l1_expert_down_gpu11&#45;&gt;l1_moe_agg -->
<g id="edge53" class="edge">
<title>l1_expert_down_gpu11&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M117,-369.83C117,-304.65 117,-169 117,-169 117,-169 2665.25,-169 2665.25,-169"/>
<polygon fill="black" stroke="black" points="2665.25,-172.5 2675.25,-169 2665.25,-165.5 2665.25,-172.5"/>
</g>
<!-- l1_expert8_gpu12 -->
<g id="node66" class="node">
<title>l1_expert8_gpu12</title>
<polygon fill="lightpink" stroke="black" points="2762,-438 2550,-438 2550,-370 2762,-370 2762,-438"/>
<text text-anchor="middle" x="2656" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2656" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2656" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="2656" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l1_expert9_gpu12 -->
<g id="node67" class="node">
<title>l1_expert9_gpu12</title>
<polygon fill="lightpink" stroke="black" points="2528,-438 2316,-438 2316,-370 2528,-370 2528,-438"/>
<text text-anchor="middle" x="2422" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2422" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2422" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="2422" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l1_expert_down_gpu12 -->
<g id="node68" class="node">
<title>l1_expert_down_gpu12</title>
<polygon fill="lightpink" stroke="black" points="5062.5,-438 4859.5,-438 4859.5,-370 5062.5,-370 5062.5,-438"/>
<text text-anchor="middle" x="4961" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU12</text>
<text text-anchor="middle" x="4961" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="4961" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4961" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l1_expert_down_gpu12&#45;&gt;l1_moe_agg -->
<g id="edge54" class="edge">
<title>l1_expert_down_gpu12&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M4961,-369.65C4961,-310.58 4961,-196 4961,-196 4961,-196 3067.1,-196 3067.1,-196"/>
<polygon fill="black" stroke="black" points="3067.1,-192.5 3057.1,-196 3067.1,-199.5 3067.1,-192.5"/>
</g>
<!-- l1_expert10_gpu13 -->
<g id="node69" class="node">
<title>l1_expert10_gpu13</title>
<polygon fill="lightpink" stroke="black" points="2070,-438 1858,-438 1858,-370 2070,-370 2070,-438"/>
<text text-anchor="middle" x="1964" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="1964" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1964" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="1964" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l1_expert11_gpu13 -->
<g id="node70" class="node">
<title>l1_expert11_gpu13</title>
<polygon fill="lightpink" stroke="black" points="1836,-438 1624,-438 1624,-370 1836,-370 1836,-438"/>
<text text-anchor="middle" x="1730" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="1730" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1730" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="1730" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l1_expert_down_gpu13 -->
<g id="node71" class="node">
<title>l1_expert_down_gpu13</title>
<polygon fill="lightpink" stroke="black" points="4370.5,-438 4167.5,-438 4167.5,-370 4370.5,-370 4370.5,-438"/>
<text text-anchor="middle" x="4269" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU13</text>
<text text-anchor="middle" x="4269" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="4269" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4269" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l1_expert_down_gpu13&#45;&gt;l1_moe_agg -->
<g id="edge55" class="edge">
<title>l1_expert_down_gpu13&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M4230.25,-369.96C4230.25,-317.52 4230.25,-223 4230.25,-223 4230.25,-223 3085.6,-223 3085.6,-223"/>
<polygon fill="black" stroke="black" points="3085.6,-219.5 3075.6,-223 3085.6,-226.5 3085.6,-219.5"/>
</g>
<!-- l1_expert12_gpu14 -->
<g id="node72" class="node">
<title>l1_expert12_gpu14</title>
<polygon fill="lightpink" stroke="black" points="1378,-438 1166,-438 1166,-370 1378,-370 1378,-438"/>
<text text-anchor="middle" x="1272" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="1272" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1272" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="1272" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l1_expert13_gpu14 -->
<g id="node73" class="node">
<title>l1_expert13_gpu14</title>
<polygon fill="lightpink" stroke="black" points="1144,-438 932,-438 932,-370 1144,-370 1144,-438"/>
<text text-anchor="middle" x="1038" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="1038" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1038" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="1038" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l1_expert_down_gpu14 -->
<g id="node74" class="node">
<title>l1_expert_down_gpu14</title>
<polygon fill="lightpink" stroke="black" points="3678.5,-438 3475.5,-438 3475.5,-370 3678.5,-370 3678.5,-438"/>
<text text-anchor="middle" x="3577" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU14</text>
<text text-anchor="middle" x="3577" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="3577" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3577" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l1_expert_down_gpu14&#45;&gt;l1_moe_agg -->
<g id="edge56" class="edge">
<title>l1_expert_down_gpu14&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M3577,-369.82C3577,-324.45 3577,-250 3577,-250 3577,-250 3104.03,-250 3104.03,-250"/>
<polygon fill="black" stroke="black" points="3104.03,-246.5 3094.03,-250 3104.03,-253.5 3104.03,-246.5"/>
</g>
<!-- l1_expert14_gpu15 -->
<g id="node75" class="node">
<title>l1_expert14_gpu15</title>
<polygon fill="lightpink" stroke="black" points="686,-438 474,-438 474,-370 686,-370 686,-438"/>
<text text-anchor="middle" x="580" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="580" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="580" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="580" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l1_expert15_gpu15 -->
<g id="node76" class="node">
<title>l1_expert15_gpu15</title>
<polygon fill="lightpink" stroke="black" points="452,-438 240,-438 240,-370 452,-370 452,-438"/>
<text text-anchor="middle" x="346" y="-422.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="346" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="346" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16384]</text>
<text text-anchor="middle" x="346" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l1_expert_down_gpu15 -->
<g id="node77" class="node">
<title>l1_expert_down_gpu15</title>
<polygon fill="lightpink" stroke="black" points="2986.5,-438 2783.5,-438 2783.5,-370 2986.5,-370 2986.5,-438"/>
<text text-anchor="middle" x="2885" y="-422.8" font-family="Times,serif" font-size="14.00">Expert Down Proj GPU15</text>
<text text-anchor="middle" x="2885" y="-407.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,16384]</text>
<text text-anchor="middle" x="2885" y="-392.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2885" y="-377.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l1_expert_down_gpu15&#45;&gt;l1_moe_agg -->
<g id="edge57" class="edge">
<title>l1_expert_down_gpu15&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M2885,-369.76C2885,-369.76 2885,-288.04 2885,-288.04"/>
<polygon fill="black" stroke="black" points="2888.5,-288.04 2885,-278.04 2881.5,-288.04 2888.5,-288.04"/>
</g>
<!-- layer1_input -->
<g id="node79" class="node">
<title>layer1_input</title>
<ellipse fill="lightgreen" stroke="black" cx="6184" cy="-1653.5" rx="135" ry="37.5"/>
<text text-anchor="middle" x="6184" y="-1664.8" font-family="Times,serif" font-size="14.00">Layer 1 Input</text>
<text text-anchor="middle" x="6184" y="-1649.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6184" y="-1634.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu0 -->
<g id="edge59" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu0</title>
<path fill="none" stroke="black" d="M6105.34,-1684C5651.99,-1684 3393,-1684 3393,-1684 3393,-1684 3393,-1408.25 3393,-1408.25"/>
<polygon fill="black" stroke="black" points="3396.5,-1408.25 3393,-1398.25 3389.5,-1408.25 3396.5,-1408.25"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu0 -->
<g id="edge60" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu0</title>
<path fill="none" stroke="black" d="M6081.54,-1678C5617.58,-1678 3736,-1678 3736,-1678 3736,-1678 3736,-1568.18 3736,-1568.18"/>
<polygon fill="black" stroke="black" points="3739.5,-1568.18 3736,-1558.18 3732.5,-1568.18 3739.5,-1568.18"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu0 -->
<g id="edge61" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu0</title>
<path fill="none" stroke="black" d="M6066.26,-1672C5607.51,-1672 3965,-1672 3965,-1672 3965,-1672 3965,-1568.33 3965,-1568.33"/>
<polygon fill="black" stroke="black" points="3968.5,-1568.33 3965,-1558.33 3961.5,-1568.33 3968.5,-1568.33"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu1 -->
<g id="edge62" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu1</title>
<path fill="none" stroke="black" d="M6316.99,-1647C6607.5,-1647 7273,-1647 7273,-1647 7273,-1647 7273,-1408.14 7273,-1408.14"/>
<polygon fill="black" stroke="black" points="7276.5,-1408.14 7273,-1398.14 7269.5,-1408.14 7276.5,-1408.14"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu1 -->
<g id="edge63" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu1</title>
<path fill="none" stroke="black" d="M6050.19,-1659C5639.24,-1659 4423,-1659 4423,-1659 4423,-1659 4423,-1568.07 4423,-1568.07"/>
<polygon fill="black" stroke="black" points="4426.5,-1568.07 4423,-1558.07 4419.5,-1568.07 4426.5,-1568.07"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu1 -->
<g id="edge64" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu1</title>
<path fill="none" stroke="black" d="M6056.49,-1666C5617.28,-1666 4194,-1666 4194,-1666 4194,-1666 4194,-1568.01 4194,-1568.01"/>
<polygon fill="black" stroke="black" points="4197.5,-1568.01 4194,-1558.01 4190.5,-1568.01 4197.5,-1568.01"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu2 -->
<g id="edge65" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu2</title>
<path fill="none" stroke="black" d="M6286.43,-1678C6716.37,-1678 8353,-1678 8353,-1678 8353,-1678 8353,-1408.2 8353,-1408.2"/>
<polygon fill="black" stroke="black" points="8356.5,-1408.2 8353,-1398.2 8349.5,-1408.2 8356.5,-1408.2"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu2 -->
<g id="edge66" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu2</title>
<path fill="none" stroke="black" d="M6257.28,-1622C6380.53,-1622 6616,-1622 6616,-1622 6616,-1622 6616,-1568 6616,-1568"/>
<polygon fill="black" stroke="black" points="6619.5,-1568 6616,-1558 6612.5,-1568 6619.5,-1568"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu2 -->
<g id="edge67" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu2</title>
<path fill="none" stroke="black" d="M6311,-1640.61C6311,-1640.61 6311,-1568.09 6311,-1568.09"/>
<polygon fill="black" stroke="black" points="6314.5,-1568.09 6311,-1558.09 6307.5,-1568.09 6314.5,-1568.09"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu3 -->
<g id="edge68" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu3</title>
<path fill="none" stroke="black" d="M6319.05,-1653C6652.68,-1653 7489,-1653 7489,-1653 7489,-1653 7489,-1408 7489,-1408"/>
<polygon fill="black" stroke="black" points="7492.5,-1408 7489,-1398 7485.5,-1408 7492.5,-1408"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu3 -->
<g id="edge69" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu3</title>
<path fill="none" stroke="black" d="M6048.72,-1653C5674.33,-1653 4652,-1653 4652,-1653 4652,-1653 4652,-1568.23 4652,-1568.23"/>
<polygon fill="black" stroke="black" points="4655.5,-1568.23 4652,-1558.23 4648.5,-1568.23 4655.5,-1568.23"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu3 -->
<g id="edge70" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu3</title>
<path fill="none" stroke="black" d="M6050.98,-1647C5717.98,-1647 4875,-1647 4875,-1647 4875,-1647 4875,-1568.26 4875,-1568.26"/>
<polygon fill="black" stroke="black" points="4878.5,-1568.26 4875,-1558.26 4871.5,-1568.26 4878.5,-1568.26"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu4 -->
<g id="edge71" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu4</title>
<path fill="none" stroke="black" d="M6262.67,-1684C6675.11,-1684 8569,-1684 8569,-1684 8569,-1684 8569,-1408.25 8569,-1408.25"/>
<polygon fill="black" stroke="black" points="8572.5,-1408.25 8569,-1398.25 8565.5,-1408.25 8572.5,-1408.25"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu4 -->
<g id="edge72" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu4</title>
<path fill="none" stroke="black" d="M6283.12,-1628C6464.65,-1628 6832,-1628 6832,-1628 6832,-1628 6832,-1568.05 6832,-1568.05"/>
<polygon fill="black" stroke="black" points="6835.5,-1568.05 6832,-1558.05 6828.5,-1568.05 6835.5,-1568.05"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu4 -->
<g id="edge73" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu4</title>
<path fill="none" stroke="black" d="M6299.63,-1634C6535.06,-1634 7048,-1634 7048,-1634 7048,-1634 7048,-1568.2 7048,-1568.2"/>
<polygon fill="black" stroke="black" points="7051.5,-1568.2 7048,-1558.2 7044.5,-1568.2 7051.5,-1568.2"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu5 -->
<g id="edge74" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu5</title>
<path fill="none" stroke="black" d="M6301.77,-1672C6724.01,-1672 8137,-1672 8137,-1672 8137,-1672 8137,-1408.14 8137,-1408.14"/>
<polygon fill="black" stroke="black" points="8140.5,-1408.14 8137,-1398.14 8133.5,-1408.14 8140.5,-1408.14"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu5 -->
<g id="edge75" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu5</title>
<path fill="none" stroke="black" d="M6057,-1640.61C6057,-1640.61 6057,-1568.09 6057,-1568.09"/>
<polygon fill="black" stroke="black" points="6060.5,-1568.09 6057,-1558.09 6053.5,-1568.09 6060.5,-1568.09"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu5 -->
<g id="edge76" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu5</title>
<path fill="none" stroke="black" d="M6184,-1615.7C6184,-1615.7 6184,-1568.1 6184,-1568.1"/>
<polygon fill="black" stroke="black" points="6187.5,-1568.1 6184,-1558.1 6180.5,-1568.1 6187.5,-1568.1"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu6 -->
<g id="edge77" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu6</title>
<path fill="none" stroke="black" d="M6317.65,-1659C6688.8,-1659 7705,-1659 7705,-1659 7705,-1659 7705,-1408.13 7705,-1408.13"/>
<polygon fill="black" stroke="black" points="7708.5,-1408.13 7705,-1398.13 7701.5,-1408.13 7708.5,-1408.13"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu6 -->
<g id="edge78" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu6</title>
<path fill="none" stroke="black" d="M6068.37,-1634C5832.94,-1634 5320,-1634 5320,-1634 5320,-1634 5320,-1568.2 5320,-1568.2"/>
<polygon fill="black" stroke="black" points="5323.5,-1568.2 5320,-1558.2 5316.5,-1568.2 5323.5,-1568.2"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu6 -->
<g id="edge79" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu6</title>
<path fill="none" stroke="black" d="M6056.67,-1641C5771.03,-1641 5104,-1641 5104,-1641 5104,-1641 5104,-1568.16 5104,-1568.16"/>
<polygon fill="black" stroke="black" points="5107.5,-1568.16 5104,-1558.16 5100.5,-1568.16 5107.5,-1568.16"/>
</g>
<!-- layer1_input&#45;&gt;l1_q_gpu7 -->
<g id="edge80" class="edge">
<title>layer1_input&#45;&gt;l1_q_gpu7</title>
<path fill="none" stroke="black" d="M6311.37,-1666C6712.16,-1666 7921,-1666 7921,-1666 7921,-1666 7921,-1408.06 7921,-1408.06"/>
<polygon fill="black" stroke="black" points="7924.5,-1408.06 7921,-1398.06 7917.5,-1408.06 7924.5,-1408.06"/>
</g>
<!-- layer1_input&#45;&gt;l1_k_gpu7 -->
<g id="edge81" class="edge">
<title>layer1_input&#45;&gt;l1_k_gpu7</title>
<path fill="none" stroke="black" d="M6084.88,-1628C5903.35,-1628 5536,-1628 5536,-1628 5536,-1628 5536,-1568.05 5536,-1568.05"/>
<polygon fill="black" stroke="black" points="5539.5,-1568.05 5536,-1558.05 5532.5,-1568.05 5539.5,-1568.05"/>
</g>
<!-- layer1_input&#45;&gt;l1_v_gpu7 -->
<g id="edge82" class="edge">
<title>layer1_input&#45;&gt;l1_v_gpu7</title>
<path fill="none" stroke="black" d="M6110.72,-1622C5987.47,-1622 5752,-1622 5752,-1622 5752,-1622 5752,-1568 5752,-1568"/>
<polygon fill="black" stroke="black" points="5755.5,-1568 5752,-1558 5748.5,-1568 5755.5,-1568"/>
</g>
<!-- layer1_input&#45;&gt;l1_attn_res -->
<g id="edge83" class="edge">
<title>layer1_input&#45;&gt;l1_attn_res</title>
<path fill="none" stroke="black" d="M6311.52,-1641C6576.33,-1641 7161.37,-1641 7161.37,-1641 7161.37,-1641 7161.37,-769 7161.37,-769 7161.37,-769 7246.94,-769 7246.94,-769"/>
<polygon fill="black" stroke="black" points="7246.94,-772.5 7256.94,-769 7246.94,-765.5 7246.94,-772.5"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_gate -->
<g id="edge85" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_gate</title>
<path fill="none" stroke="black" d="M7253.93,-632C6822.92,-632 5707,-632 5707,-632 5707,-632 5707,-448.13 5707,-448.13"/>
<polygon fill="black" stroke="black" points="5710.5,-448.13 5707,-438.13 5703.5,-448.13 5710.5,-448.13"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_router -->
<g id="edge86" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_router</title>
<path fill="none" stroke="black" d="M7193.82,-529.95C7193.82,-498.5 7193.82,-468 7193.82,-468 7193.82,-468 6201.78,-468 6201.78,-468"/>
<polygon fill="black" stroke="black" points="6201.78,-464.5 6191.78,-468 6201.78,-471.5 6201.78,-464.5"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_moe_res -->
<g id="edge87" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M7266.5,-649C6678.41,-649 4612.5,-649 4612.5,-649 4612.5,-649 4612.5,-94.36 4612.5,-94.36"/>
<polygon fill="black" stroke="black" points="4616,-94.36 4612.5,-84.36 4609,-94.36 4616,-94.36"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;8_gpu8 -->
<g id="edge88" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;8_gpu8</title>
<path fill="none" stroke="black" d="M7560,-529.88C7560,-529.88 7560,-432.35 7560,-432.35"/>
<polygon fill="black" stroke="black" points="7563.5,-432.35 7560,-422.35 7556.5,-432.35 7563.5,-432.35"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;7_gpu8 -->
<g id="edge89" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;7_gpu8</title>
<path fill="none" stroke="black" d="M7650.4,-597.86C7650.4,-597.86 7650.4,-432.07 7650.4,-432.07"/>
<polygon fill="black" stroke="black" points="7653.9,-432.07 7650.4,-422.07 7646.9,-432.07 7653.9,-432.07"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;7_gpu9 -->
<g id="edge90" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;7_gpu9</title>
<path fill="none" stroke="black" d="M7575.51,-547C7688.51,-547 7822.12,-547 7822.12,-547 7822.12,-547 7822.12,-432.11 7822.12,-432.11"/>
<polygon fill="black" stroke="black" points="7825.63,-432.11 7822.12,-422.11 7818.63,-432.11 7825.63,-432.11"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;6_gpu9 -->
<g id="edge91" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;6_gpu9</title>
<path fill="none" stroke="black" d="M7588.08,-564C7773.22,-564 8046,-564 8046,-564 8046,-564 8046,-432.04 8046,-432.04"/>
<polygon fill="black" stroke="black" points="8049.5,-432.04 8046,-422.04 8042.5,-432.04 8049.5,-432.04"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;6_gpu10 -->
<g id="edge92" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;6_gpu10</title>
<path fill="none" stroke="black" d="M7600.46,-581C7831.41,-581 8203.25,-581 8203.25,-581 8203.25,-581 8203.25,-432.28 8203.25,-432.28"/>
<polygon fill="black" stroke="black" points="8206.75,-432.28 8203.25,-422.28 8199.75,-432.28 8206.75,-432.28"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;5_gpu10 -->
<g id="edge93" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;5_gpu10</title>
<path fill="none" stroke="black" d="M7612.57,-598C7894.02,-598 8386.25,-598 8386.25,-598 8386.25,-598 8386.25,-432.25 8386.25,-432.25"/>
<polygon fill="black" stroke="black" points="8389.75,-432.25 8386.25,-422.25 8382.75,-432.25 8389.75,-432.25"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;5_gpu11 -->
<g id="edge94" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;5_gpu11</title>
<path fill="none" stroke="black" d="M7624.75,-615C7928.96,-615 8466.5,-615 8466.5,-615 8466.5,-615 8466.5,-432.36 8466.5,-432.36"/>
<polygon fill="black" stroke="black" points="8470,-432.36 8466.5,-422.36 8463,-432.36 8470,-432.36"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;4_gpu11 -->
<g id="edge95" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;4_gpu11</title>
<path fill="none" stroke="black" d="M7637.12,-632C7990.63,-632 8653.62,-632 8653.62,-632 8653.62,-632 8653.62,-432.27 8653.62,-432.27"/>
<polygon fill="black" stroke="black" points="8657.13,-432.27 8653.62,-422.27 8650.13,-432.27 8657.13,-432.27"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;4_gpu12 -->
<g id="edge96" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;4_gpu12</title>
<path fill="none" stroke="black" d="M7649.55,-649C8064.48,-649 8899.25,-649 8899.25,-649 8899.25,-649 8899.25,-432.02 8899.25,-432.02"/>
<polygon fill="black" stroke="black" points="8902.75,-432.02 8899.25,-422.02 8895.75,-432.02 8902.75,-432.02"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;3_gpu12 -->
<g id="edge97" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;3_gpu12</title>
<path fill="none" stroke="black" d="M7241.9,-615C6929.02,-615 6315.83,-615 6315.83,-615 6315.83,-615 6315.83,-432.36 6315.83,-432.36"/>
<polygon fill="black" stroke="black" points="6319.33,-432.36 6315.83,-422.36 6312.33,-432.36 6319.33,-432.36"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;3_gpu13 -->
<g id="edge98" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;3_gpu13</title>
<path fill="none" stroke="black" d="M7229.52,-598C6949.71,-598 6462,-598 6462,-598 6462,-598 6462,-432.25 6462,-432.25"/>
<polygon fill="black" stroke="black" points="6465.5,-432.25 6462,-422.25 6458.5,-432.25 6465.5,-432.25"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;2_gpu13 -->
<g id="edge99" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;2_gpu13</title>
<path fill="none" stroke="black" d="M7217.05,-581C6993.29,-581 6665.5,-581 6665.5,-581 6665.5,-581 6665.5,-432.28 6665.5,-432.28"/>
<polygon fill="black" stroke="black" points="6669,-432.28 6665.5,-422.28 6662,-432.28 6669,-432.28"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;2_gpu14 -->
<g id="edge100" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;2_gpu14</title>
<path fill="none" stroke="black" d="M7204.86,-564C7044.12,-564 6852.5,-564 6852.5,-564 6852.5,-564 6852.5,-432.04 6852.5,-432.04"/>
<polygon fill="black" stroke="black" points="6856,-432.04 6852.5,-422.04 6849,-432.04 6856,-432.04"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;1_gpu14 -->
<g id="edge101" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;1_gpu14</title>
<path fill="none" stroke="black" d="M7192.72,-547C7099.09,-547 7012.25,-547 7012.25,-547 7012.25,-547 7012.25,-432.11 7012.25,-432.11"/>
<polygon fill="black" stroke="black" points="7015.75,-432.11 7012.25,-422.11 7008.75,-432.11 7015.75,-432.11"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert&#45;1_gpu15 -->
<g id="edge102" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert&#45;1_gpu15</title>
<path fill="none" stroke="black" d="M7207.16,-597.86C7207.16,-597.86 7207.16,-432.07 7207.16,-432.07"/>
<polygon fill="black" stroke="black" points="7210.66,-432.07 7207.16,-422.07 7203.66,-432.07 7210.66,-432.07"/>
</g>
<!-- l1_attn_moe_comm&#45;&gt;l1_expert0_gpu15 -->
<g id="edge103" class="edge">
<title>l1_attn_moe_comm&#45;&gt;l1_expert0_gpu15</title>
<path fill="none" stroke="black" d="M7351,-529.88C7351,-529.88 7351,-432.35 7351,-432.35"/>
<polygon fill="black" stroke="black" points="7354.5,-432.35 7351,-422.35 7347.5,-432.35 7354.5,-432.35"/>
</g>
<!-- l1_expert&#45;8_gpu8&#45;&gt;l1_expert_down_gpu8 -->
<g id="edge120" class="edge">
<title>l1_expert&#45;8_gpu8&#45;&gt;l1_expert_down_gpu8</title>
<path fill="none" stroke="black" d="M7525,-422.24C7525,-450.34 7525,-501 7525,-501 7525,-501 2226.83,-501 2226.83,-501 2226.83,-501 2226.83,-448.2 2226.83,-448.2"/>
<polygon fill="black" stroke="black" points="2230.33,-448.2 2226.83,-438.2 2223.33,-448.2 2230.33,-448.2"/>
</g>
<!-- l1_expert&#45;7_gpu8&#45;&gt;l1_expert_down_gpu8 -->
<g id="edge121" class="edge">
<title>l1_expert&#45;7_gpu8&#45;&gt;l1_expert_down_gpu8</title>
<path fill="none" stroke="black" d="M7639.26,-422.34C7639.26,-451.21 7639.26,-504 7639.26,-504 7639.26,-504 2159.17,-504 2159.17,-504 2159.17,-504 2159.17,-448.13 2159.17,-448.13"/>
<polygon fill="black" stroke="black" points="2162.67,-448.13 2159.17,-438.13 2155.67,-448.13 2162.67,-448.13"/>
</g>
<!-- l1_expert&#45;7_gpu9&#45;&gt;l1_expert_down_gpu9 -->
<g id="edge122" class="edge">
<title>l1_expert&#45;7_gpu9&#45;&gt;l1_expert_down_gpu9</title>
<path fill="none" stroke="black" d="M7807.75,-422.12C7807.75,-451.91 7807.75,-508 7807.75,-508 7807.75,-508 1534.83,-508 1534.83,-508 1534.83,-508 1534.83,-448.05 1534.83,-448.05"/>
<polygon fill="black" stroke="black" points="1538.33,-448.05 1534.83,-438.05 1531.33,-448.05 1538.33,-448.05"/>
</g>
<!-- l1_expert&#45;6_gpu9&#45;&gt;l1_expert_down_gpu9 -->
<g id="edge123" class="edge">
<title>l1_expert&#45;6_gpu9&#45;&gt;l1_expert_down_gpu9</title>
<path fill="none" stroke="black" d="M8011,-422.15C8011,-452.68 8011,-511 8011,-511 8011,-511 1467.17,-511 1467.17,-511 1467.17,-511 1467.17,-448.15 1467.17,-448.15"/>
<polygon fill="black" stroke="black" points="1470.67,-448.15 1467.17,-438.15 1463.67,-448.15 1470.67,-448.15"/>
</g>
<!-- l1_expert&#45;6_gpu10&#45;&gt;l1_expert_down_gpu10 -->
<g id="edge124" class="edge">
<title>l1_expert&#45;6_gpu10&#45;&gt;l1_expert_down_gpu10</title>
<path fill="none" stroke="black" d="M8170,-422.33C8170,-453.86 8170,-515 8170,-515 8170,-515 842.83,-515 842.83,-515 842.83,-515 842.83,-448.21 842.83,-448.21"/>
<polygon fill="black" stroke="black" points="846.33,-448.21 842.83,-438.21 839.33,-448.21 846.33,-448.21"/>
</g>
<!-- l1_expert&#45;5_gpu10&#45;&gt;l1_expert_down_gpu10 -->
<g id="edge125" class="edge">
<title>l1_expert&#45;5_gpu10&#45;&gt;l1_expert_down_gpu10</title>
<path fill="none" stroke="black" d="M8349,-422.22C8349,-454.65 8349,-519 8349,-519 8349,-519 775.17,-519 775.17,-519 775.17,-519 775.17,-448.19 775.17,-448.19"/>
<polygon fill="black" stroke="black" points="778.67,-448.19 775.17,-438.19 771.67,-448.19 778.67,-448.19"/>
</g>
<!-- l1_expert&#45;5_gpu11&#45;&gt;l1_expert_down_gpu11 -->
<g id="edge126" class="edge">
<title>l1_expert&#45;5_gpu11&#45;&gt;l1_expert_down_gpu11</title>
<path fill="none" stroke="black" d="M8461,-422.18C8461,-455.28 8461,-522 8461,-522 8461,-522 150.83,-522 150.83,-522 150.83,-522 150.83,-448.13 150.83,-448.13"/>
<polygon fill="black" stroke="black" points="154.33,-448.13 150.83,-438.13 147.33,-448.13 154.33,-448.13"/>
</g>
<!-- l1_expert&#45;4_gpu11&#45;&gt;l1_expert_down_gpu11 -->
<g id="edge127" class="edge">
<title>l1_expert&#45;4_gpu11&#45;&gt;l1_expert_down_gpu11</title>
<path fill="none" stroke="black" d="M8641.25,-422C8641.25,-455.94 8641.25,-526 8641.25,-526 8641.25,-526 83.17,-526 83.17,-526 83.17,-526 83.17,-448.31 83.17,-448.31"/>
<polygon fill="black" stroke="black" points="86.67,-448.31 83.17,-438.31 79.67,-448.31 86.67,-448.31"/>
</g>
<!-- l1_expert&#45;4_gpu12&#45;&gt;l1_expert_down_gpu12 -->
<g id="edge128" class="edge">
<title>l1_expert&#45;4_gpu12&#45;&gt;l1_expert_down_gpu12</title>
<path fill="none" stroke="black" d="M8862,-422.24C8862,-447.48 8862,-490 8862,-490 8862,-490 5033.17,-490 5033.17,-490 5033.17,-490 5033.17,-448.48 5033.17,-448.48"/>
<polygon fill="black" stroke="black" points="5036.67,-448.48 5033.17,-438.48 5029.67,-448.48 5036.67,-448.48"/>
</g>
<!-- l1_expert&#45;3_gpu12&#45;&gt;l1_expert_down_gpu12 -->
<g id="edge129" class="edge">
<title>l1_expert&#45;3_gpu12&#45;&gt;l1_expert_down_gpu12</title>
<path fill="none" stroke="black" d="M6266.17,-422.28C6266.17,-443.32 6266.17,-475 6266.17,-475 6266.17,-475 5047.83,-475 5047.83,-475 5047.83,-475 5047.83,-448.25 5047.83,-448.25"/>
<polygon fill="black" stroke="black" points="5051.33,-448.25 5047.83,-438.25 5044.33,-448.25 5051.33,-448.25"/>
</g>
<!-- l1_expert&#45;3_gpu13&#45;&gt;l1_expert_down_gpu13 -->
<g id="edge130" class="edge">
<title>l1_expert&#45;3_gpu13&#45;&gt;l1_expert_down_gpu13</title>
<path fill="none" stroke="black" d="M6437.17,-385.76C6437.17,-357.66 6437.17,-307 6437.17,-307 6437.17,-307 4318.83,-307 4318.83,-307 4318.83,-307 4318.83,-359.8 4318.83,-359.8"/>
<polygon fill="black" stroke="black" points="4315.33,-359.8 4318.83,-369.8 4322.33,-359.8 4315.33,-359.8"/>
</g>
<!-- l1_expert&#45;2_gpu13&#45;&gt;l1_expert_down_gpu13 -->
<g id="edge131" class="edge">
<title>l1_expert&#45;2_gpu13&#45;&gt;l1_expert_down_gpu13</title>
<path fill="none" stroke="black" d="M6565.69,-422.16C6565.69,-444.35 6565.69,-479 6565.69,-479 6565.69,-479 4269,-479 4269,-479 4269,-479 4269,-448.43 4269,-448.43"/>
<polygon fill="black" stroke="black" points="4272.5,-448.43 4269,-438.43 4265.5,-448.43 4272.5,-448.43"/>
</g>
<!-- l1_expert&#45;2_gpu14&#45;&gt;l1_expert_down_gpu14 -->
<g id="edge132" class="edge">
<title>l1_expert&#45;2_gpu14&#45;&gt;l1_expert_down_gpu14</title>
<path fill="none" stroke="black" d="M6794.17,-422.09C6794.17,-445.13 6794.17,-482 6794.17,-482 6794.17,-482 3610.83,-482 3610.83,-482 3610.83,-482 3610.83,-448.44 3610.83,-448.44"/>
<polygon fill="black" stroke="black" points="3614.33,-448.44 3610.83,-438.44 3607.33,-448.44 3614.33,-448.44"/>
</g>
<!-- l1_expert&#45;1_gpu14&#45;&gt;l1_expert_down_gpu14 -->
<g id="edge133" class="edge">
<title>l1_expert&#45;1_gpu14&#45;&gt;l1_expert_down_gpu14</title>
<path fill="none" stroke="black" d="M6975,-422.2C6975,-446.36 6975,-486 6975,-486 6975,-486 3543.17,-486 3543.17,-486 3543.17,-486 3543.17,-448.3 3543.17,-448.3"/>
<polygon fill="black" stroke="black" points="3546.67,-448.3 3543.17,-438.3 3539.67,-448.3 3546.67,-448.3"/>
</g>
<!-- l1_expert&#45;1_gpu15&#45;&gt;l1_expert_down_gpu15 -->
<g id="edge134" class="edge">
<title>l1_expert&#45;1_gpu15&#45;&gt;l1_expert_down_gpu15</title>
<path fill="none" stroke="black" d="M7121.5,-422.01C7121.5,-448.02 7121.5,-493 7121.5,-493 7121.5,-493 2918.83,-493 2918.83,-493 2918.83,-493 2918.83,-448.16 2918.83,-448.16"/>
<polygon fill="black" stroke="black" points="2922.33,-448.16 2918.83,-438.16 2915.33,-448.16 2922.33,-448.16"/>
</g>
<!-- l1_expert0_gpu15&#45;&gt;l1_expert_down_gpu15 -->
<g id="edge135" class="edge">
<title>l1_expert0_gpu15&#45;&gt;l1_expert_down_gpu15</title>
<path fill="none" stroke="black" d="M7315,-422.37C7315,-449.48 7315,-497 7315,-497 7315,-497 2851.17,-497 2851.17,-497 2851.17,-497 2851.17,-448.1 2851.17,-448.1"/>
<polygon fill="black" stroke="black" points="2854.67,-448.1 2851.17,-438.1 2847.67,-448.1 2854.67,-448.1"/>
</g>
</g>
</svg>
