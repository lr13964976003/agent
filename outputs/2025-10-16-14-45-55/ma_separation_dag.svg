<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ma_separation_moe_model Pages: 1 -->
<svg width="16958pt" height="3591pt"
 viewBox="0.00 0.00 16958.00 3591.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3587)">
<title>ma_separation_moe_model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3587 16954,-3587 16954,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="13136,-2482 13136,-3498 16942,-3498 16942,-2482 13136,-2482"/>
<text text-anchor="middle" x="15039" y="-3482.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_attention_0</title>
<path fill="none" stroke="red" d="M15055,-2490C15055,-2490 16922,-2490 16922,-2490 16928,-2490 16934,-2496 16934,-2502 16934,-2502 16934,-3455 16934,-3455 16934,-3461 16928,-3467 16922,-3467 16922,-3467 15055,-3467 15055,-3467 15049,-3467 15043,-3461 15043,-3455 15043,-3455 15043,-2502 15043,-2502 15043,-2496 15049,-2490 15055,-2490"/>
<text text-anchor="middle" x="15988.5" y="-3451.8" font-family="Times,serif" font-size="14.00">Attention Group (GPUs 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_moe_0</title>
<path fill="none" stroke="blue" d="M13156,-2872C13156,-2872 15023,-2872 15023,-2872 15029,-2872 15035,-2878 15035,-2884 15035,-2884 15035,-3421 15035,-3421 15035,-3427 15029,-3433 15023,-3433 15023,-3433 13156,-3433 13156,-3433 13150,-3433 13144,-3427 13144,-3421 13144,-3421 13144,-2884 13144,-2884 13144,-2878 13150,-2872 13156,-2872"/>
<text text-anchor="middle" x="14089.5" y="-3417.8" font-family="Times,serif" font-size="14.00">MoE Group (GPUs 8&#45;15)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="8706,-1646 8706,-2662 12512,-2662 12512,-1646 8706,-1646"/>
<text text-anchor="middle" x="10609" y="-2646.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_attention_1</title>
<path fill="none" stroke="red" d="M10625,-1654C10625,-1654 12492,-1654 12492,-1654 12498,-1654 12504,-1660 12504,-1666 12504,-1666 12504,-2619 12504,-2619 12504,-2625 12498,-2631 12492,-2631 12492,-2631 10625,-2631 10625,-2631 10619,-2631 10613,-2625 10613,-2619 10613,-2619 10613,-1666 10613,-1666 10613,-1660 10619,-1654 10625,-1654"/>
<text text-anchor="middle" x="11558.5" y="-2615.8" font-family="Times,serif" font-size="14.00">Attention Group (GPUs 0&#45;7)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_moe_1</title>
<path fill="none" stroke="blue" d="M8726,-2036C8726,-2036 10593,-2036 10593,-2036 10599,-2036 10605,-2042 10605,-2048 10605,-2048 10605,-2585 10605,-2585 10605,-2591 10599,-2597 10593,-2597 10593,-2597 8726,-2597 8726,-2597 8720,-2597 8714,-2591 8714,-2585 8714,-2585 8714,-2048 8714,-2048 8714,-2042 8720,-2036 8726,-2036"/>
<text text-anchor="middle" x="9659.5" y="-2581.8" font-family="Times,serif" font-size="14.00">MoE Group (GPUs 8&#45;15)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="4357,-810 4357,-1826 8163,-1826 8163,-810 4357,-810"/>
<text text-anchor="middle" x="6260" y="-1810.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_attention_2</title>
<path fill="none" stroke="red" d="M6276,-818C6276,-818 8143,-818 8143,-818 8149,-818 8155,-824 8155,-830 8155,-830 8155,-1783 8155,-1783 8155,-1789 8149,-1795 8143,-1795 8143,-1795 6276,-1795 6276,-1795 6270,-1795 6264,-1789 6264,-1783 6264,-1783 6264,-830 6264,-830 6264,-824 6270,-818 6276,-818"/>
<text text-anchor="middle" x="7209.5" y="-1779.8" font-family="Times,serif" font-size="14.00">Attention Group (GPUs 0&#45;7)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_moe_2</title>
<path fill="none" stroke="blue" d="M4377,-1200C4377,-1200 6244,-1200 6244,-1200 6250,-1200 6256,-1206 6256,-1212 6256,-1212 6256,-1749 6256,-1749 6256,-1755 6250,-1761 6244,-1761 6244,-1761 4377,-1761 4377,-1761 4371,-1761 4365,-1755 4365,-1749 4365,-1749 4365,-1212 4365,-1212 4365,-1206 4371,-1200 4377,-1200"/>
<text text-anchor="middle" x="5310.5" y="-1745.8" font-family="Times,serif" font-size="14.00">MoE Group (GPUs 8&#45;15)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="8,-8 8,-990 3814,-990 3814,-8 8,-8"/>
<text text-anchor="middle" x="1911" y="-974.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_attention_3</title>
<path fill="none" stroke="red" d="M28,-16C28,-16 1895,-16 1895,-16 1901,-16 1907,-22 1907,-28 1907,-28 1907,-947 1907,-947 1907,-953 1901,-959 1895,-959 1895,-959 28,-959 28,-959 22,-959 16,-953 16,-947 16,-947 16,-28 16,-28 16,-22 22,-16 28,-16"/>
<text text-anchor="middle" x="961.5" y="-943.8" font-family="Times,serif" font-size="14.00">Attention Group (GPUs 0&#45;7)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_moe_3</title>
<path fill="none" stroke="blue" d="M1927,-364C1927,-364 3794,-364 3794,-364 3800,-364 3806,-370 3806,-376 3806,-376 3806,-913 3806,-913 3806,-919 3800,-925 3794,-925 3794,-925 1927,-925 1927,-925 1921,-925 1915,-919 1915,-913 1915,-913 1915,-376 1915,-376 1915,-370 1921,-364 1927,-364"/>
<text text-anchor="middle" x="2860.5" y="-909.8" font-family="Times,serif" font-size="14.00">MoE Group (GPUs 8&#45;15)</text>
</g>
<!-- l0_qkv_all_gather -->
<g id="node1" class="node">
<title>l0_qkv_all_gather</title>
<polygon fill="lightcyan" stroke="black" points="16348.55,-3436 15965.89,-3436 15867.45,-3300 16250.11,-3300 16348.55,-3436"/>
<text text-anchor="middle" x="16108" y="-3386.8" font-family="Times,serif" font-size="14.00">All&#45;Gather QKV</text>
<text text-anchor="middle" x="16108" y="-3371.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16108" y="-3356.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="16108" y="-3341.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_qkv_gpu0 -->
<g id="node2" class="node">
<title>l0_qkv_gpu0</title>
<polygon fill="yellow" stroke="black" points="16205,-3228 16011,-3228 16011,-3160 16205,-3160 16205,-3228"/>
<text text-anchor="middle" x="16108" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU0</text>
<text text-anchor="middle" x="16108" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16108" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16108" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M16108,-3299.73C16108,-3299.73 16108,-3238.11 16108,-3238.11"/>
<polygon fill="black" stroke="black" points="16111.5,-3238.11 16108,-3228.11 16104.5,-3238.11 16111.5,-3238.11"/>
</g>
<!-- l0_qkv_gpu1 -->
<g id="node3" class="node">
<title>l0_qkv_gpu1</title>
<polygon fill="yellow" stroke="black" points="16439,-3228 16245,-3228 16245,-3160 16439,-3160 16439,-3228"/>
<text text-anchor="middle" x="16342" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU1</text>
<text text-anchor="middle" x="16342" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16342" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16342" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M16296.76,-3364.37C16296.76,-3364.37 16296.76,-3238.1 16296.76,-3238.1"/>
<polygon fill="black" stroke="black" points="16300.26,-3238.1 16296.76,-3228.1 16293.26,-3238.1 16300.26,-3238.1"/>
</g>
<!-- l0_qkv_gpu2 -->
<g id="node4" class="node">
<title>l0_qkv_gpu2</title>
<polygon fill="yellow" stroke="black" points="16675,-3228 16481,-3228 16481,-3160 16675,-3160 16675,-3228"/>
<text text-anchor="middle" x="16578" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU2</text>
<text text-anchor="middle" x="16578" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16578" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16578" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M16283.01,-3345C16416.64,-3345 16578,-3345 16578,-3345 16578,-3345 16578,-3238.26 16578,-3238.26"/>
<polygon fill="black" stroke="black" points="16581.5,-3238.26 16578,-3228.26 16574.5,-3238.26 16581.5,-3238.26"/>
</g>
<!-- l0_qkv_gpu3 -->
<g id="node5" class="node">
<title>l0_qkv_gpu3</title>
<polygon fill="yellow" stroke="black" points="16910,-3228 16716,-3228 16716,-3160 16910,-3160 16910,-3228"/>
<text text-anchor="middle" x="16813" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU3</text>
<text text-anchor="middle" x="16813" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16813" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16813" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M16315.4,-3390C16511.68,-3390 16776.5,-3390 16776.5,-3390 16776.5,-3390 16776.5,-3238.14 16776.5,-3238.14"/>
<polygon fill="black" stroke="black" points="16780,-3238.14 16776.5,-3228.14 16773,-3238.14 16780,-3238.14"/>
</g>
<!-- l0_qkv_gpu4 -->
<g id="node6" class="node">
<title>l0_qkv_gpu4</title>
<polygon fill="yellow" stroke="black" points="15263,-3228 15069,-3228 15069,-3160 15263,-3160 15263,-3228"/>
<text text-anchor="middle" x="15166" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU4</text>
<text text-anchor="middle" x="15166" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15166" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15166" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu4 -->
<g id="edge5" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M15878.16,-3315C15599.31,-3315 15166,-3315 15166,-3315 15166,-3315 15166,-3238.03 15166,-3238.03"/>
<polygon fill="black" stroke="black" points="15169.5,-3238.03 15166,-3228.03 15162.5,-3238.03 15169.5,-3238.03"/>
</g>
<!-- l0_qkv_gpu5 -->
<g id="node7" class="node">
<title>l0_qkv_gpu5</title>
<polygon fill="yellow" stroke="black" points="15502,-3228 15308,-3228 15308,-3160 15502,-3160 15502,-3228"/>
<text text-anchor="middle" x="15405" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU5</text>
<text text-anchor="middle" x="15405" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15405" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15405" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu5 -->
<g id="edge6" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M15873.91,-3309C15669.41,-3309 15405,-3309 15405,-3309 15405,-3309 15405,-3238.19 15405,-3238.19"/>
<polygon fill="black" stroke="black" points="15408.5,-3238.19 15405,-3228.19 15401.5,-3238.19 15408.5,-3238.19"/>
</g>
<!-- l0_qkv_gpu6 -->
<g id="node8" class="node">
<title>l0_qkv_gpu6</title>
<polygon fill="yellow" stroke="black" points="15739,-3228 15545,-3228 15545,-3160 15739,-3160 15739,-3228"/>
<text text-anchor="middle" x="15642" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU6</text>
<text text-anchor="middle" x="15642" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15642" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15642" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu6 -->
<g id="edge7" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M15869.54,-3303C15754.89,-3303 15642,-3303 15642,-3303 15642,-3303 15642,-3238.19 15642,-3238.19"/>
<polygon fill="black" stroke="black" points="15645.5,-3238.19 15642,-3228.19 15638.5,-3238.19 15645.5,-3238.19"/>
</g>
<!-- l0_qkv_gpu7 -->
<g id="node9" class="node">
<title>l0_qkv_gpu7</title>
<polygon fill="yellow" stroke="black" points="15973,-3228 15779,-3228 15779,-3160 15973,-3160 15973,-3228"/>
<text text-anchor="middle" x="15876" y="-3212.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU7</text>
<text text-anchor="middle" x="15876" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15876" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15876" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_qkv_all_gather&#45;&gt;l0_qkv_gpu7 -->
<g id="edge8" class="edge">
<title>l0_qkv_all_gather&#45;&gt;l0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M15920.24,-3299.73C15920.24,-3299.73 15920.24,-3238.11 15920.24,-3238.11"/>
<polygon fill="black" stroke="black" points="15923.74,-3238.11 15920.24,-3228.11 15916.74,-3238.11 15923.74,-3238.11"/>
</g>
<!-- l0_attn_gpu0 -->
<g id="node10" class="node">
<title>l0_attn_gpu0</title>
<polygon fill="yellow" stroke="black" points="16205,-3088 16011,-3088 16011,-3020 16205,-3020 16205,-3088"/>
<text text-anchor="middle" x="16108" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU0</text>
<text text-anchor="middle" x="16108" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16108" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16108" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_qkv_gpu0&#45;&gt;l0_attn_gpu0 -->
<g id="edge9" class="edge">
<title>l0_qkv_gpu0&#45;&gt;l0_attn_gpu0</title>
<path fill="none" stroke="black" d="M16108,-3159.75C16108,-3159.75 16108,-3098.38 16108,-3098.38"/>
<polygon fill="black" stroke="black" points="16111.5,-3098.38 16108,-3088.38 16104.5,-3098.38 16111.5,-3098.38"/>
</g>
<!-- l0_attn_gpu1 -->
<g id="node13" class="node">
<title>l0_attn_gpu1</title>
<polygon fill="yellow" stroke="black" points="16441,-3088 16247,-3088 16247,-3020 16441,-3020 16441,-3088"/>
<text text-anchor="middle" x="16344" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU1</text>
<text text-anchor="middle" x="16344" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16344" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16344" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_qkv_gpu1&#45;&gt;l0_attn_gpu1 -->
<g id="edge12" class="edge">
<title>l0_qkv_gpu1&#45;&gt;l0_attn_gpu1</title>
<path fill="none" stroke="black" d="M16343,-3159.75C16343,-3159.75 16343,-3098.38 16343,-3098.38"/>
<polygon fill="black" stroke="black" points="16346.5,-3098.38 16343,-3088.38 16339.5,-3098.38 16346.5,-3098.38"/>
</g>
<!-- l0_attn_gpu2 -->
<g id="node15" class="node">
<title>l0_attn_gpu2</title>
<polygon fill="yellow" stroke="black" points="16678,-3088 16484,-3088 16484,-3020 16678,-3020 16678,-3088"/>
<text text-anchor="middle" x="16581" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU2</text>
<text text-anchor="middle" x="16581" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16581" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16581" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_qkv_gpu2&#45;&gt;l0_attn_gpu2 -->
<g id="edge15" class="edge">
<title>l0_qkv_gpu2&#45;&gt;l0_attn_gpu2</title>
<path fill="none" stroke="black" d="M16579.5,-3159.75C16579.5,-3159.75 16579.5,-3098.38 16579.5,-3098.38"/>
<polygon fill="black" stroke="black" points="16583,-3098.38 16579.5,-3088.38 16576,-3098.38 16583,-3098.38"/>
</g>
<!-- l0_attn_gpu3 -->
<g id="node17" class="node">
<title>l0_attn_gpu3</title>
<polygon fill="yellow" stroke="black" points="16914,-3088 16720,-3088 16720,-3020 16914,-3020 16914,-3088"/>
<text text-anchor="middle" x="16817" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU3</text>
<text text-anchor="middle" x="16817" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16817" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="16817" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_qkv_gpu3&#45;&gt;l0_attn_gpu3 -->
<g id="edge18" class="edge">
<title>l0_qkv_gpu3&#45;&gt;l0_attn_gpu3</title>
<path fill="none" stroke="black" d="M16815,-3159.75C16815,-3159.75 16815,-3098.38 16815,-3098.38"/>
<polygon fill="black" stroke="black" points="16818.5,-3098.38 16815,-3088.38 16811.5,-3098.38 16818.5,-3098.38"/>
</g>
<!-- l0_attn_gpu4 -->
<g id="node19" class="node">
<title>l0_attn_gpu4</title>
<polygon fill="yellow" stroke="black" points="15256,-3088 15062,-3088 15062,-3020 15256,-3020 15256,-3088"/>
<text text-anchor="middle" x="15159" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU4</text>
<text text-anchor="middle" x="15159" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15159" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15159" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_qkv_gpu4&#45;&gt;l0_attn_gpu4 -->
<g id="edge21" class="edge">
<title>l0_qkv_gpu4&#45;&gt;l0_attn_gpu4</title>
<path fill="none" stroke="black" d="M15162.5,-3159.75C15162.5,-3159.75 15162.5,-3098.38 15162.5,-3098.38"/>
<polygon fill="black" stroke="black" points="15166,-3098.38 15162.5,-3088.38 15159,-3098.38 15166,-3098.38"/>
</g>
<!-- l0_attn_gpu5 -->
<g id="node21" class="node">
<title>l0_attn_gpu5</title>
<polygon fill="yellow" stroke="black" points="15501,-3088 15307,-3088 15307,-3020 15501,-3020 15501,-3088"/>
<text text-anchor="middle" x="15404" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU5</text>
<text text-anchor="middle" x="15404" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15404" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15404" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_qkv_gpu5&#45;&gt;l0_attn_gpu5 -->
<g id="edge24" class="edge">
<title>l0_qkv_gpu5&#45;&gt;l0_attn_gpu5</title>
<path fill="none" stroke="black" d="M15404.5,-3159.75C15404.5,-3159.75 15404.5,-3098.38 15404.5,-3098.38"/>
<polygon fill="black" stroke="black" points="15408,-3098.38 15404.5,-3088.38 15401,-3098.38 15408,-3098.38"/>
</g>
<!-- l0_attn_gpu6 -->
<g id="node23" class="node">
<title>l0_attn_gpu6</title>
<polygon fill="yellow" stroke="black" points="15736,-3088 15542,-3088 15542,-3020 15736,-3020 15736,-3088"/>
<text text-anchor="middle" x="15639" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU6</text>
<text text-anchor="middle" x="15639" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15639" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15639" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_qkv_gpu6&#45;&gt;l0_attn_gpu6 -->
<g id="edge27" class="edge">
<title>l0_qkv_gpu6&#45;&gt;l0_attn_gpu6</title>
<path fill="none" stroke="black" d="M15640.5,-3159.75C15640.5,-3159.75 15640.5,-3098.38 15640.5,-3098.38"/>
<polygon fill="black" stroke="black" points="15644,-3098.38 15640.5,-3088.38 15637,-3098.38 15644,-3098.38"/>
</g>
<!-- l0_attn_gpu7 -->
<g id="node25" class="node">
<title>l0_attn_gpu7</title>
<polygon fill="yellow" stroke="black" points="15968,-3088 15774,-3088 15774,-3020 15968,-3020 15968,-3088"/>
<text text-anchor="middle" x="15871" y="-3072.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU7</text>
<text text-anchor="middle" x="15871" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15871" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15871" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_qkv_gpu7&#45;&gt;l0_attn_gpu7 -->
<g id="edge30" class="edge">
<title>l0_qkv_gpu7&#45;&gt;l0_attn_gpu7</title>
<path fill="none" stroke="black" d="M15873.5,-3159.75C15873.5,-3159.75 15873.5,-3098.38 15873.5,-3098.38"/>
<polygon fill="black" stroke="black" points="15877,-3098.38 15873.5,-3088.38 15870,-3098.38 15877,-3098.38"/>
</g>
<!-- l0_out_gpu0 -->
<g id="node11" class="node">
<title>l0_out_gpu0</title>
<polygon fill="yellow" stroke="black" points="16209.5,-2948 16006.5,-2948 16006.5,-2880 16209.5,-2880 16209.5,-2948"/>
<text text-anchor="middle" x="16108" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU0</text>
<text text-anchor="middle" x="16108" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16108" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16108" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_attn_gpu0&#45;&gt;l0_out_gpu0 -->
<g id="edge10" class="edge">
<title>l0_attn_gpu0&#45;&gt;l0_out_gpu0</title>
<path fill="none" stroke="black" d="M16108,-3019.75C16108,-3019.75 16108,-2958.38 16108,-2958.38"/>
<polygon fill="black" stroke="black" points="16111.5,-2958.38 16108,-2948.38 16104.5,-2958.38 16111.5,-2958.38"/>
</g>
<!-- l0_attn_all_reduce -->
<g id="node12" class="node">
<title>l0_attn_all_reduce</title>
<polygon fill="lightcyan" stroke="black" points="16216.17,-2808 15853.2,-2808 15759.83,-2672 16122.8,-2672 16216.17,-2808"/>
<text text-anchor="middle" x="15988" y="-2758.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="15988" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="15988" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15988" y="-2713.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_out_gpu0&#45;&gt;l0_attn_all_reduce -->
<g id="edge11" class="edge">
<title>l0_out_gpu0&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M16108,-2879.62C16108,-2879.62 16108,-2818.14 16108,-2818.14"/>
<polygon fill="black" stroke="black" points="16111.5,-2818.14 16108,-2808.14 16104.5,-2818.14 16111.5,-2818.14"/>
</g>
<!-- l0_attn_res -->
<g id="node27" class="node">
<title>l0_attn_res</title>
<polygon fill="orange" stroke="black" points="16152,-2566 15824,-2566 15824,-2498 16152,-2498 16152,-2566"/>
<text text-anchor="middle" x="15988" y="-2550.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15988" y="-2535.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="15988" y="-2520.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15988" y="-2505.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_attn_all_reduce&#45;&gt;l0_attn_res -->
<g id="edge33" class="edge">
<title>l0_attn_all_reduce&#45;&gt;l0_attn_res</title>
<path fill="none" stroke="black" d="M15988,-2671.89C15988,-2671.89 15988,-2576.1 15988,-2576.1"/>
<polygon fill="black" stroke="black" points="15991.5,-2576.1 15988,-2566.1 15984.5,-2576.1 15991.5,-2576.1"/>
</g>
<!-- l0_out_gpu1 -->
<g id="node14" class="node">
<title>l0_out_gpu1</title>
<polygon fill="yellow" stroke="black" points="16448.5,-2948 16245.5,-2948 16245.5,-2880 16448.5,-2880 16448.5,-2948"/>
<text text-anchor="middle" x="16347" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU1</text>
<text text-anchor="middle" x="16347" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16347" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16347" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_attn_gpu1&#45;&gt;l0_out_gpu1 -->
<g id="edge13" class="edge">
<title>l0_attn_gpu1&#45;&gt;l0_out_gpu1</title>
<path fill="none" stroke="black" d="M16344,-3019.75C16344,-3019.75 16344,-2958.38 16344,-2958.38"/>
<polygon fill="black" stroke="black" points="16347.5,-2958.38 16344,-2948.38 16340.5,-2958.38 16347.5,-2958.38"/>
</g>
<!-- l0_out_gpu1&#45;&gt;l0_attn_all_reduce -->
<g id="edge14" class="edge">
<title>l0_out_gpu1&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M16347,-2879.75C16347,-2838.31 16347,-2774 16347,-2774 16347,-2774 16202.93,-2774 16202.93,-2774"/>
<polygon fill="black" stroke="black" points="16202.93,-2770.5 16192.93,-2774 16202.93,-2777.5 16202.93,-2770.5"/>
</g>
<!-- l0_out_gpu2 -->
<g id="node16" class="node">
<title>l0_out_gpu2</title>
<polygon fill="yellow" stroke="black" points="16687.5,-2948 16484.5,-2948 16484.5,-2880 16687.5,-2880 16687.5,-2948"/>
<text text-anchor="middle" x="16586" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU2</text>
<text text-anchor="middle" x="16586" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16586" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16586" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_attn_gpu2&#45;&gt;l0_out_gpu2 -->
<g id="edge16" class="edge">
<title>l0_attn_gpu2&#45;&gt;l0_out_gpu2</title>
<path fill="none" stroke="black" d="M16581.25,-3019.75C16581.25,-3019.75 16581.25,-2958.38 16581.25,-2958.38"/>
<polygon fill="black" stroke="black" points="16584.75,-2958.38 16581.25,-2948.38 16577.75,-2958.38 16584.75,-2958.38"/>
</g>
<!-- l0_out_gpu2&#45;&gt;l0_attn_all_reduce -->
<g id="edge17" class="edge">
<title>l0_out_gpu2&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M16586,-2879.62C16586,-2828.91 16586,-2740 16586,-2740 16586,-2740 16179.86,-2740 16179.86,-2740"/>
<polygon fill="black" stroke="black" points="16179.86,-2736.5 16169.86,-2740 16179.86,-2743.5 16179.86,-2736.5"/>
</g>
<!-- l0_out_gpu3 -->
<g id="node18" class="node">
<title>l0_out_gpu3</title>
<polygon fill="yellow" stroke="black" points="16926.5,-2948 16723.5,-2948 16723.5,-2880 16926.5,-2880 16926.5,-2948"/>
<text text-anchor="middle" x="16825" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU3</text>
<text text-anchor="middle" x="16825" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16825" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16825" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_attn_gpu3&#45;&gt;l0_out_gpu3 -->
<g id="edge19" class="edge">
<title>l0_attn_gpu3&#45;&gt;l0_out_gpu3</title>
<path fill="none" stroke="black" d="M16818.75,-3019.75C16818.75,-3019.75 16818.75,-2958.38 16818.75,-2958.38"/>
<polygon fill="black" stroke="black" points="16822.25,-2958.38 16818.75,-2948.38 16815.25,-2958.38 16822.25,-2958.38"/>
</g>
<!-- l0_out_gpu3&#45;&gt;l0_attn_all_reduce -->
<g id="edge20" class="edge">
<title>l0_out_gpu3&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M16825,-2879.65C16825,-2820.58 16825,-2706 16825,-2706 16825,-2706 16156.42,-2706 16156.42,-2706"/>
<polygon fill="black" stroke="black" points="16156.42,-2702.5 16146.42,-2706 16156.42,-2709.5 16156.42,-2702.5"/>
</g>
<!-- l0_out_gpu4 -->
<g id="node20" class="node">
<title>l0_out_gpu4</title>
<polygon fill="yellow" stroke="black" points="15253.5,-2948 15050.5,-2948 15050.5,-2880 15253.5,-2880 15253.5,-2948"/>
<text text-anchor="middle" x="15152" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU4</text>
<text text-anchor="middle" x="15152" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15152" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15152" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l0_attn_gpu4&#45;&gt;l0_out_gpu4 -->
<g id="edge22" class="edge">
<title>l0_attn_gpu4&#45;&gt;l0_out_gpu4</title>
<path fill="none" stroke="black" d="M15157.75,-3019.75C15157.75,-3019.75 15157.75,-2958.38 15157.75,-2958.38"/>
<polygon fill="black" stroke="black" points="15161.25,-2958.38 15157.75,-2948.38 15154.25,-2958.38 15161.25,-2958.38"/>
</g>
<!-- l0_out_gpu4&#45;&gt;l0_attn_all_reduce -->
<g id="edge23" class="edge">
<title>l0_out_gpu4&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M15152,-2879.75C15152,-2838.31 15152,-2774 15152,-2774 15152,-2774 15819.77,-2774 15819.77,-2774"/>
<polygon fill="black" stroke="black" points="15819.77,-2777.5 15829.77,-2774 15819.77,-2770.5 15819.77,-2777.5"/>
</g>
<!-- l0_out_gpu5 -->
<g id="node22" class="node">
<title>l0_out_gpu5</title>
<polygon fill="yellow" stroke="black" points="15492.5,-2948 15289.5,-2948 15289.5,-2880 15492.5,-2880 15492.5,-2948"/>
<text text-anchor="middle" x="15391" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU5</text>
<text text-anchor="middle" x="15391" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15391" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15391" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l0_attn_gpu5&#45;&gt;l0_out_gpu5 -->
<g id="edge25" class="edge">
<title>l0_attn_gpu5&#45;&gt;l0_out_gpu5</title>
<path fill="none" stroke="black" d="M15399.75,-3019.75C15399.75,-3019.75 15399.75,-2958.38 15399.75,-2958.38"/>
<polygon fill="black" stroke="black" points="15403.25,-2958.38 15399.75,-2948.38 15396.25,-2958.38 15403.25,-2958.38"/>
</g>
<!-- l0_out_gpu5&#45;&gt;l0_attn_all_reduce -->
<g id="edge26" class="edge">
<title>l0_out_gpu5&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M15391,-2879.74C15391,-2843.34 15391,-2791 15391,-2791 15391,-2791 15831.19,-2791 15831.19,-2791"/>
<polygon fill="black" stroke="black" points="15831.19,-2794.5 15841.19,-2791 15831.19,-2787.5 15831.19,-2794.5"/>
</g>
<!-- l0_out_gpu6 -->
<g id="node24" class="node">
<title>l0_out_gpu6</title>
<polygon fill="yellow" stroke="black" points="15731.5,-2948 15528.5,-2948 15528.5,-2880 15731.5,-2880 15731.5,-2948"/>
<text text-anchor="middle" x="15630" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU6</text>
<text text-anchor="middle" x="15630" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15630" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15630" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l0_attn_gpu6&#45;&gt;l0_out_gpu6 -->
<g id="edge28" class="edge">
<title>l0_attn_gpu6&#45;&gt;l0_out_gpu6</title>
<path fill="none" stroke="black" d="M15636.75,-3019.75C15636.75,-3019.75 15636.75,-2958.38 15636.75,-2958.38"/>
<polygon fill="black" stroke="black" points="15640.25,-2958.38 15636.75,-2948.38 15633.25,-2958.38 15640.25,-2958.38"/>
</g>
<!-- l0_out_gpu6&#45;&gt;l0_attn_all_reduce -->
<g id="edge29" class="edge">
<title>l0_out_gpu6&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M15731.68,-2914C15750.16,-2914 15763.71,-2914 15763.71,-2914 15763.71,-2914 15763.71,-2750.13 15763.71,-2750.13"/>
<polygon fill="black" stroke="black" points="15767.21,-2750.13 15763.71,-2740.13 15760.21,-2750.13 15767.21,-2750.13"/>
</g>
<!-- l0_out_gpu7 -->
<g id="node26" class="node">
<title>l0_out_gpu7</title>
<polygon fill="yellow" stroke="black" points="15970.5,-2948 15767.5,-2948 15767.5,-2880 15970.5,-2880 15970.5,-2948"/>
<text text-anchor="middle" x="15869" y="-2932.8" font-family="Times,serif" font-size="14.00">Output Projection GPU7</text>
<text text-anchor="middle" x="15869" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="15869" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15869" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l0_attn_gpu7&#45;&gt;l0_out_gpu7 -->
<g id="edge31" class="edge">
<title>l0_attn_gpu7&#45;&gt;l0_out_gpu7</title>
<path fill="none" stroke="black" d="M15871,-3019.75C15871,-3019.75 15871,-2958.38 15871,-2958.38"/>
<polygon fill="black" stroke="black" points="15874.5,-2958.38 15871,-2948.38 15867.5,-2958.38 15874.5,-2958.38"/>
</g>
<!-- l0_out_gpu7&#45;&gt;l0_attn_all_reduce -->
<g id="edge32" class="edge">
<title>l0_out_gpu7&#45;&gt;l0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M15869,-2879.62C15869,-2879.62 15869,-2818.14 15869,-2818.14"/>
<polygon fill="black" stroke="black" points="15872.5,-2818.14 15869,-2808.14 15865.5,-2818.14 15872.5,-2818.14"/>
</g>
<!-- l0_attn_to_moe -->
<g id="node154" class="node">
<title>l0_attn_to_moe</title>
<polygon fill="gray" stroke="black" points="13128.47,-3436 12780.93,-3436 12691.53,-3300 13039.07,-3300 13128.47,-3436"/>
<text text-anchor="middle" x="12910" y="-3386.8" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="12910" y="-3371.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12910" y="-3356.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12910" y="-3341.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- l0_attn_res&#45;&gt;l0_attn_to_moe -->
<g id="edge213" class="edge">
<title>l0_attn_res&#45;&gt;l0_attn_to_moe</title>
<path fill="none" stroke="black" d="M15823.75,-2532C15199.16,-2532 13006.93,-2532 13006.93,-2532 13006.93,-2532 13006.93,-3289.94 13006.93,-3289.94"/>
<polygon fill="black" stroke="black" points="13003.43,-3289.94 13006.93,-3299.94 13010.43,-3289.94 13003.43,-3289.94"/>
</g>
<!-- l0_moe_gate -->
<g id="node28" class="node">
<title>l0_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="14065.5,-3402 13874.5,-3402 13874.5,-3334 14065.5,-3334 14065.5,-3402"/>
<text text-anchor="middle" x="13970" y="-3386.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="13970" y="-3371.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13970" y="-3356.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="13970" y="-3341.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l0_exp_gpu8 -->
<g id="node29" class="node">
<title>l0_exp_gpu8</title>
<polygon fill="lightpink" stroke="black" points="13832.5,-3228 13629.5,-3228 13629.5,-3160 13832.5,-3160 13832.5,-3228"/>
<text text-anchor="middle" x="13731" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 0,1</text>
<text text-anchor="middle" x="13731" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13731" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13731" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu8 -->
<g id="edge34" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13874.32,-3347C13820.84,-3347 13764.83,-3347 13764.83,-3347 13764.83,-3347 13764.83,-3238.34 13764.83,-3238.34"/>
<polygon fill="black" stroke="black" points="13768.33,-3238.34 13764.83,-3228.34 13761.33,-3238.34 13768.33,-3238.34"/>
</g>
<!-- l0_exp_gpu9 -->
<g id="node30" class="node">
<title>l0_exp_gpu9</title>
<polygon fill="lightpink" stroke="black" points="14071.5,-3228 13868.5,-3228 13868.5,-3160 14071.5,-3160 14071.5,-3228"/>
<text text-anchor="middle" x="13970" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 2,3</text>
<text text-anchor="middle" x="13970" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13970" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13970" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu9 -->
<g id="edge35" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14001.83,-3333.62C14001.83,-3333.62 14001.83,-3238.01 14001.83,-3238.01"/>
<polygon fill="black" stroke="black" points="14005.33,-3238.01 14001.83,-3228.01 13998.33,-3238.01 14005.33,-3238.01"/>
</g>
<!-- l0_exp_gpu10 -->
<g id="node31" class="node">
<title>l0_exp_gpu10</title>
<polygon fill="lightpink" stroke="black" points="14310.5,-3228 14107.5,-3228 14107.5,-3160 14310.5,-3160 14310.5,-3228"/>
<text text-anchor="middle" x="14209" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 4,5</text>
<text text-anchor="middle" x="14209" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="14209" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="14209" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu10 -->
<g id="edge36" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14065.81,-3347C14144.42,-3347 14242.83,-3347 14242.83,-3347 14242.83,-3347 14242.83,-3238.34 14242.83,-3238.34"/>
<polygon fill="black" stroke="black" points="14246.33,-3238.34 14242.83,-3228.34 14239.33,-3238.34 14246.33,-3238.34"/>
</g>
<!-- l0_exp_gpu11 -->
<g id="node32" class="node">
<title>l0_exp_gpu11</title>
<polygon fill="lightpink" stroke="black" points="14549.5,-3228 14346.5,-3228 14346.5,-3160 14549.5,-3160 14549.5,-3228"/>
<text text-anchor="middle" x="14448" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 6,7</text>
<text text-anchor="middle" x="14448" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="14448" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="14448" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu11 -->
<g id="edge37" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14065.67,-3361C14213.81,-3361 14481.83,-3361 14481.83,-3361 14481.83,-3361 14481.83,-3238.2 14481.83,-3238.2"/>
<polygon fill="black" stroke="black" points="14485.33,-3238.2 14481.83,-3228.2 14478.33,-3238.2 14485.33,-3238.2"/>
</g>
<!-- l0_exp_gpu12 -->
<g id="node33" class="node">
<title>l0_exp_gpu12</title>
<polygon fill="lightpink" stroke="black" points="14788.5,-3228 14585.5,-3228 14585.5,-3160 14788.5,-3160 14788.5,-3228"/>
<text text-anchor="middle" x="14687" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 8,9</text>
<text text-anchor="middle" x="14687" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="14687" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="14687" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu12 -->
<g id="edge38" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14065.86,-3374C14268.27,-3374 14720.83,-3374 14720.83,-3374 14720.83,-3374 14720.83,-3238.28 14720.83,-3238.28"/>
<polygon fill="black" stroke="black" points="14724.33,-3238.28 14720.83,-3228.28 14717.33,-3238.28 14724.33,-3238.28"/>
</g>
<!-- l0_exp_gpu13 -->
<g id="node34" class="node">
<title>l0_exp_gpu13</title>
<polygon fill="lightpink" stroke="black" points="15027.5,-3228 14824.5,-3228 14824.5,-3160 15027.5,-3160 15027.5,-3228"/>
<text text-anchor="middle" x="14926" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 10,11</text>
<text text-anchor="middle" x="14926" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="14926" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="14926" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu13 -->
<g id="edge39" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14065.81,-3388C14314.22,-3388 14959.83,-3388 14959.83,-3388 14959.83,-3388 14959.83,-3238.24 14959.83,-3238.24"/>
<polygon fill="black" stroke="black" points="14963.33,-3238.24 14959.83,-3228.24 14956.33,-3238.24 14963.33,-3238.24"/>
</g>
<!-- l0_exp_gpu14 -->
<g id="node35" class="node">
<title>l0_exp_gpu14</title>
<polygon fill="lightpink" stroke="black" points="13354.5,-3228 13151.5,-3228 13151.5,-3160 13354.5,-3160 13354.5,-3228"/>
<text text-anchor="middle" x="13253" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 12,13</text>
<text text-anchor="middle" x="13253" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13253" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13253" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu14 -->
<g id="edge40" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13874.42,-3374C13679.21,-3374 13253,-3374 13253,-3374 13253,-3374 13253,-3238.28 13253,-3238.28"/>
<polygon fill="black" stroke="black" points="13256.5,-3238.28 13253,-3228.28 13249.5,-3238.28 13256.5,-3238.28"/>
</g>
<!-- l0_exp_gpu15 -->
<g id="node36" class="node">
<title>l0_exp_gpu15</title>
<polygon fill="lightpink" stroke="black" points="13593.5,-3228 13390.5,-3228 13390.5,-3160 13593.5,-3160 13593.5,-3228"/>
<text text-anchor="middle" x="13492" y="-3212.8" font-family="Times,serif" font-size="14.00">Experts 14,15</text>
<text text-anchor="middle" x="13492" y="-3197.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13492" y="-3182.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13492" y="-3167.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_exp_gpu15 -->
<g id="edge41" class="edge">
<title>l0_moe_gate&#45;&gt;l0_exp_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13874.44,-3361C13743.9,-3361 13525.83,-3361 13525.83,-3361 13525.83,-3361 13525.83,-3238.2 13525.83,-3238.2"/>
<polygon fill="black" stroke="black" points="13529.33,-3238.2 13525.83,-3228.2 13522.33,-3238.2 13529.33,-3238.2"/>
</g>
<!-- l0_moe_agg -->
<g id="node37" class="node">
<title>l0_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="14076,-3088 13864,-3088 13864,-3020 14076,-3020 14076,-3088"/>
<text text-anchor="middle" x="13970" y="-3072.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13970" y="-3057.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—2</text>
<text text-anchor="middle" x="13970" y="-3042.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13970" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l0_exp_gpu8&#45;&gt;l0_moe_agg -->
<g id="edge42" class="edge">
<title>l0_exp_gpu8&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M13731,-3159.93C13731,-3124.46 13731,-3074 13731,-3074 13731,-3074 13853.78,-3074 13853.78,-3074"/>
<polygon fill="black" stroke="black" points="13853.78,-3077.5 13863.78,-3074 13853.78,-3070.5 13853.78,-3077.5"/>
</g>
<!-- l0_exp_gpu9&#45;&gt;l0_moe_agg -->
<g id="edge43" class="edge">
<title>l0_exp_gpu9&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M13970,-3159.75C13970,-3159.75 13970,-3098.38 13970,-3098.38"/>
<polygon fill="black" stroke="black" points="13973.5,-3098.38 13970,-3088.38 13966.5,-3098.38 13973.5,-3098.38"/>
</g>
<!-- l0_exp_gpu10&#45;&gt;l0_moe_agg -->
<g id="edge44" class="edge">
<title>l0_exp_gpu10&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M14209,-3159.93C14209,-3124.46 14209,-3074 14209,-3074 14209,-3074 14086.22,-3074 14086.22,-3074"/>
<polygon fill="black" stroke="black" points="14086.22,-3070.5 14076.22,-3074 14086.22,-3077.5 14086.22,-3070.5"/>
</g>
<!-- l0_exp_gpu11&#45;&gt;l0_moe_agg -->
<g id="edge45" class="edge">
<title>l0_exp_gpu11&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M14448,-3159.84C14448,-3120.14 14448,-3060 14448,-3060 14448,-3060 14086.08,-3060 14086.08,-3060"/>
<polygon fill="black" stroke="black" points="14086.08,-3056.5 14076.08,-3060 14086.08,-3063.5 14086.08,-3056.5"/>
</g>
<!-- l0_exp_gpu12&#45;&gt;l0_moe_agg -->
<g id="edge46" class="edge">
<title>l0_exp_gpu12&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M14687,-3159.91C14687,-3116.48 14687,-3047 14687,-3047 14687,-3047 14086.18,-3047 14086.18,-3047"/>
<polygon fill="black" stroke="black" points="14086.18,-3043.5 14076.18,-3047 14086.18,-3050.5 14086.18,-3043.5"/>
</g>
<!-- l0_exp_gpu13&#45;&gt;l0_moe_agg -->
<g id="edge47" class="edge">
<title>l0_exp_gpu13&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M14926,-3159.86C14926,-3112.6 14926,-3033 14926,-3033 14926,-3033 14086.42,-3033 14086.42,-3033"/>
<polygon fill="black" stroke="black" points="14086.42,-3029.5 14076.42,-3033 14086.42,-3036.5 14086.42,-3029.5"/>
</g>
<!-- l0_exp_gpu14&#45;&gt;l0_moe_agg -->
<g id="edge48" class="edge">
<title>l0_exp_gpu14&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M13253.25,-3159.91C13253.25,-3116.48 13253.25,-3047 13253.25,-3047 13253.25,-3047 13853.86,-3047 13853.86,-3047"/>
<polygon fill="black" stroke="black" points="13853.86,-3050.5 13863.86,-3047 13853.86,-3043.5 13853.86,-3050.5"/>
</g>
<!-- l0_exp_gpu15&#45;&gt;l0_moe_agg -->
<g id="edge49" class="edge">
<title>l0_exp_gpu15&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M13536.75,-3159.84C13536.75,-3120.14 13536.75,-3060 13536.75,-3060 13536.75,-3060 13853.74,-3060 13853.74,-3060"/>
<polygon fill="black" stroke="black" points="13853.74,-3063.5 13863.74,-3060 13853.74,-3056.5 13853.74,-3063.5"/>
</g>
<!-- l0_moe_res -->
<g id="node38" class="node">
<title>l0_moe_res</title>
<polygon fill="orange" stroke="black" points="13480,-2948 13152,-2948 13152,-2880 13480,-2880 13480,-2948"/>
<text text-anchor="middle" x="13316" y="-2932.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13316" y="-2917.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="13316" y="-2902.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13316" y="-2887.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l0_moe_agg&#45;&gt;l0_moe_res -->
<g id="edge50" class="edge">
<title>l0_moe_agg&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M13863.71,-3033C13707.76,-3033 13435.25,-3033 13435.25,-3033 13435.25,-3033 13435.25,-2958.1 13435.25,-2958.1"/>
<polygon fill="black" stroke="black" points="13438.75,-2958.1 13435.25,-2948.1 13431.75,-2958.1 13438.75,-2958.1"/>
</g>
<!-- prev_layer_0 -->
<g id="node155" class="node">
<title>prev_layer_0</title>
<polygon fill="lightblue" stroke="black" points="12966.5,-2758 12859.5,-2758 12859.5,-2722 12966.5,-2722 12966.5,-2758"/>
<text text-anchor="middle" x="12913" y="-2736.3" font-family="Times,serif" font-size="14.00">prev_layer_0</text>
</g>
<!-- l0_moe_res&#45;&gt;prev_layer_0 -->
<g id="edge214" class="edge">
<title>l0_moe_res&#45;&gt;prev_layer_0</title>
<path fill="none" stroke="black" d="M13151.79,-2902C13040.29,-2902 12913,-2902 12913,-2902 12913,-2902 12913,-2768.27 12913,-2768.27"/>
<polygon fill="black" stroke="black" points="12916.5,-2768.27 12913,-2758.27 12909.5,-2768.27 12916.5,-2768.27"/>
</g>
<!-- l1_qkv_all_gather -->
<g id="node39" class="node">
<title>l1_qkv_all_gather</title>
<polygon fill="lightcyan" stroke="black" points="11918.55,-2600 11535.89,-2600 11437.45,-2464 11820.11,-2464 11918.55,-2600"/>
<text text-anchor="middle" x="11678" y="-2550.8" font-family="Times,serif" font-size="14.00">All&#45;Gather QKV</text>
<text text-anchor="middle" x="11678" y="-2535.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11678" y="-2520.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="11678" y="-2505.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_qkv_gpu0 -->
<g id="node40" class="node">
<title>l1_qkv_gpu0</title>
<polygon fill="yellow" stroke="black" points="11775,-2392 11581,-2392 11581,-2324 11775,-2324 11775,-2392"/>
<text text-anchor="middle" x="11678" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU0</text>
<text text-anchor="middle" x="11678" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11678" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu0 -->
<g id="edge51" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11678,-2463.73C11678,-2463.73 11678,-2402.11 11678,-2402.11"/>
<polygon fill="black" stroke="black" points="11681.5,-2402.11 11678,-2392.11 11674.5,-2402.11 11681.5,-2402.11"/>
</g>
<!-- l1_qkv_gpu1 -->
<g id="node41" class="node">
<title>l1_qkv_gpu1</title>
<polygon fill="yellow" stroke="black" points="12009,-2392 11815,-2392 11815,-2324 12009,-2324 12009,-2392"/>
<text text-anchor="middle" x="11912" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU1</text>
<text text-anchor="middle" x="11912" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11912" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11912" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu1 -->
<g id="edge52" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M11866.76,-2528.37C11866.76,-2528.37 11866.76,-2402.1 11866.76,-2402.1"/>
<polygon fill="black" stroke="black" points="11870.26,-2402.1 11866.76,-2392.1 11863.26,-2402.1 11870.26,-2402.1"/>
</g>
<!-- l1_qkv_gpu2 -->
<g id="node42" class="node">
<title>l1_qkv_gpu2</title>
<polygon fill="yellow" stroke="black" points="12239,-2392 12045,-2392 12045,-2324 12239,-2324 12239,-2392"/>
<text text-anchor="middle" x="12142" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU2</text>
<text text-anchor="middle" x="12142" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12142" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12142" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu2 -->
<g id="edge53" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M11852.76,-2509C11984.29,-2509 12142,-2509 12142,-2509 12142,-2509 12142,-2402.26 12142,-2402.26"/>
<polygon fill="black" stroke="black" points="12145.5,-2402.26 12142,-2392.26 12138.5,-2402.26 12145.5,-2402.26"/>
</g>
<!-- l1_qkv_gpu3 -->
<g id="node43" class="node">
<title>l1_qkv_gpu3</title>
<polygon fill="yellow" stroke="black" points="12474,-2392 12280,-2392 12280,-2324 12474,-2324 12474,-2392"/>
<text text-anchor="middle" x="12377" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU3</text>
<text text-anchor="middle" x="12377" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12377" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12377" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu3 -->
<g id="edge54" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M11885.36,-2554C12091.44,-2554 12377,-2554 12377,-2554 12377,-2554 12377,-2402.14 12377,-2402.14"/>
<polygon fill="black" stroke="black" points="12380.5,-2402.14 12377,-2392.14 12373.5,-2402.14 12380.5,-2402.14"/>
</g>
<!-- l1_qkv_gpu4 -->
<g id="node44" class="node">
<title>l1_qkv_gpu4</title>
<polygon fill="yellow" stroke="black" points="10830,-2392 10636,-2392 10636,-2324 10830,-2324 10830,-2392"/>
<text text-anchor="middle" x="10733" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU4</text>
<text text-anchor="middle" x="10733" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10733" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10733" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu4 -->
<g id="edge55" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M11455.24,-2489C11175.86,-2489 10733,-2489 10733,-2489 10733,-2489 10733,-2402.08 10733,-2402.08"/>
<polygon fill="black" stroke="black" points="10736.5,-2402.08 10733,-2392.08 10729.5,-2402.08 10736.5,-2402.08"/>
</g>
<!-- l1_qkv_gpu5 -->
<g id="node45" class="node">
<title>l1_qkv_gpu5</title>
<polygon fill="yellow" stroke="black" points="11073,-2392 10879,-2392 10879,-2324 11073,-2324 11073,-2392"/>
<text text-anchor="middle" x="10976" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU5</text>
<text text-anchor="middle" x="10976" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10976" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10976" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu5 -->
<g id="edge56" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M11449.6,-2481C11244.68,-2481 10976,-2481 10976,-2481 10976,-2481 10976,-2402.26 10976,-2402.26"/>
<polygon fill="black" stroke="black" points="10979.5,-2402.26 10976,-2392.26 10972.5,-2402.26 10979.5,-2402.26"/>
</g>
<!-- l1_qkv_gpu6 -->
<g id="node46" class="node">
<title>l1_qkv_gpu6</title>
<polygon fill="yellow" stroke="black" points="11310,-2392 11116,-2392 11116,-2324 11310,-2324 11310,-2392"/>
<text text-anchor="middle" x="11213" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU6</text>
<text text-anchor="middle" x="11213" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11213" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11213" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu6 -->
<g id="edge57" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M11443.12,-2472C11327.67,-2472 11213,-2472 11213,-2472 11213,-2472 11213,-2402.2 11213,-2402.2"/>
<polygon fill="black" stroke="black" points="11216.5,-2402.2 11213,-2392.2 11209.5,-2402.2 11216.5,-2402.2"/>
</g>
<!-- l1_qkv_gpu7 -->
<g id="node47" class="node">
<title>l1_qkv_gpu7</title>
<polygon fill="yellow" stroke="black" points="11543,-2392 11349,-2392 11349,-2324 11543,-2324 11543,-2392"/>
<text text-anchor="middle" x="11446" y="-2376.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU7</text>
<text text-anchor="middle" x="11446" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11446" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11446" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_qkv_all_gather&#45;&gt;l1_qkv_gpu7 -->
<g id="edge58" class="edge">
<title>l1_qkv_all_gather&#45;&gt;l1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M11490.24,-2463.73C11490.24,-2463.73 11490.24,-2402.11 11490.24,-2402.11"/>
<polygon fill="black" stroke="black" points="11493.74,-2402.11 11490.24,-2392.11 11486.74,-2402.11 11493.74,-2402.11"/>
</g>
<!-- l1_attn_gpu0 -->
<g id="node48" class="node">
<title>l1_attn_gpu0</title>
<polygon fill="yellow" stroke="black" points="11775,-2252 11581,-2252 11581,-2184 11775,-2184 11775,-2252"/>
<text text-anchor="middle" x="11678" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU0</text>
<text text-anchor="middle" x="11678" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_qkv_gpu0&#45;&gt;l1_attn_gpu0 -->
<g id="edge59" class="edge">
<title>l1_qkv_gpu0&#45;&gt;l1_attn_gpu0</title>
<path fill="none" stroke="black" d="M11678,-2323.75C11678,-2323.75 11678,-2262.38 11678,-2262.38"/>
<polygon fill="black" stroke="black" points="11681.5,-2262.38 11678,-2252.38 11674.5,-2262.38 11681.5,-2262.38"/>
</g>
<!-- l1_attn_gpu1 -->
<g id="node51" class="node">
<title>l1_attn_gpu1</title>
<polygon fill="yellow" stroke="black" points="12011,-2252 11817,-2252 11817,-2184 12011,-2184 12011,-2252"/>
<text text-anchor="middle" x="11914" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU1</text>
<text text-anchor="middle" x="11914" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11914" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11914" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_qkv_gpu1&#45;&gt;l1_attn_gpu1 -->
<g id="edge62" class="edge">
<title>l1_qkv_gpu1&#45;&gt;l1_attn_gpu1</title>
<path fill="none" stroke="black" d="M11913,-2323.75C11913,-2323.75 11913,-2262.38 11913,-2262.38"/>
<polygon fill="black" stroke="black" points="11916.5,-2262.38 11913,-2252.38 11909.5,-2262.38 11916.5,-2262.38"/>
</g>
<!-- l1_attn_gpu2 -->
<g id="node53" class="node">
<title>l1_attn_gpu2</title>
<polygon fill="yellow" stroke="black" points="12244,-2252 12050,-2252 12050,-2184 12244,-2184 12244,-2252"/>
<text text-anchor="middle" x="12147" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU2</text>
<text text-anchor="middle" x="12147" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12147" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12147" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_qkv_gpu2&#45;&gt;l1_attn_gpu2 -->
<g id="edge65" class="edge">
<title>l1_qkv_gpu2&#45;&gt;l1_attn_gpu2</title>
<path fill="none" stroke="black" d="M12144.5,-2323.75C12144.5,-2323.75 12144.5,-2262.38 12144.5,-2262.38"/>
<polygon fill="black" stroke="black" points="12148,-2262.38 12144.5,-2252.38 12141,-2262.38 12148,-2262.38"/>
</g>
<!-- l1_attn_gpu3 -->
<g id="node55" class="node">
<title>l1_attn_gpu3</title>
<polygon fill="yellow" stroke="black" points="12476,-2252 12282,-2252 12282,-2184 12476,-2184 12476,-2252"/>
<text text-anchor="middle" x="12379" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU3</text>
<text text-anchor="middle" x="12379" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12379" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12379" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_qkv_gpu3&#45;&gt;l1_attn_gpu3 -->
<g id="edge68" class="edge">
<title>l1_qkv_gpu3&#45;&gt;l1_attn_gpu3</title>
<path fill="none" stroke="black" d="M12378,-2323.75C12378,-2323.75 12378,-2262.38 12378,-2262.38"/>
<polygon fill="black" stroke="black" points="12381.5,-2262.38 12378,-2252.38 12374.5,-2262.38 12381.5,-2262.38"/>
</g>
<!-- l1_attn_gpu4 -->
<g id="node57" class="node">
<title>l1_attn_gpu4</title>
<polygon fill="yellow" stroke="black" points="10824,-2252 10630,-2252 10630,-2184 10824,-2184 10824,-2252"/>
<text text-anchor="middle" x="10727" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU4</text>
<text text-anchor="middle" x="10727" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10727" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10727" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_qkv_gpu4&#45;&gt;l1_attn_gpu4 -->
<g id="edge71" class="edge">
<title>l1_qkv_gpu4&#45;&gt;l1_attn_gpu4</title>
<path fill="none" stroke="black" d="M10730,-2323.75C10730,-2323.75 10730,-2262.38 10730,-2262.38"/>
<polygon fill="black" stroke="black" points="10733.5,-2262.38 10730,-2252.38 10726.5,-2262.38 10733.5,-2262.38"/>
</g>
<!-- l1_attn_gpu5 -->
<g id="node59" class="node">
<title>l1_attn_gpu5</title>
<polygon fill="yellow" stroke="black" points="11068,-2252 10874,-2252 10874,-2184 11068,-2184 11068,-2252"/>
<text text-anchor="middle" x="10971" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU5</text>
<text text-anchor="middle" x="10971" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10971" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10971" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_qkv_gpu5&#45;&gt;l1_attn_gpu5 -->
<g id="edge74" class="edge">
<title>l1_qkv_gpu5&#45;&gt;l1_attn_gpu5</title>
<path fill="none" stroke="black" d="M10973.5,-2323.75C10973.5,-2323.75 10973.5,-2262.38 10973.5,-2262.38"/>
<polygon fill="black" stroke="black" points="10977,-2262.38 10973.5,-2252.38 10970,-2262.38 10977,-2262.38"/>
</g>
<!-- l1_attn_gpu6 -->
<g id="node61" class="node">
<title>l1_attn_gpu6</title>
<polygon fill="yellow" stroke="black" points="11302,-2252 11108,-2252 11108,-2184 11302,-2184 11302,-2252"/>
<text text-anchor="middle" x="11205" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU6</text>
<text text-anchor="middle" x="11205" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11205" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11205" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_qkv_gpu6&#45;&gt;l1_attn_gpu6 -->
<g id="edge77" class="edge">
<title>l1_qkv_gpu6&#45;&gt;l1_attn_gpu6</title>
<path fill="none" stroke="black" d="M11209,-2323.75C11209,-2323.75 11209,-2262.38 11209,-2262.38"/>
<polygon fill="black" stroke="black" points="11212.5,-2262.38 11209,-2252.38 11205.5,-2262.38 11212.5,-2262.38"/>
</g>
<!-- l1_attn_gpu7 -->
<g id="node63" class="node">
<title>l1_attn_gpu7</title>
<polygon fill="yellow" stroke="black" points="11540,-2252 11346,-2252 11346,-2184 11540,-2184 11540,-2252"/>
<text text-anchor="middle" x="11443" y="-2236.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU7</text>
<text text-anchor="middle" x="11443" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11443" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11443" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_qkv_gpu7&#45;&gt;l1_attn_gpu7 -->
<g id="edge80" class="edge">
<title>l1_qkv_gpu7&#45;&gt;l1_attn_gpu7</title>
<path fill="none" stroke="black" d="M11444.5,-2323.75C11444.5,-2323.75 11444.5,-2262.38 11444.5,-2262.38"/>
<polygon fill="black" stroke="black" points="11448,-2262.38 11444.5,-2252.38 11441,-2262.38 11448,-2262.38"/>
</g>
<!-- l1_out_gpu0 -->
<g id="node49" class="node">
<title>l1_out_gpu0</title>
<polygon fill="yellow" stroke="black" points="11779.5,-2112 11576.5,-2112 11576.5,-2044 11779.5,-2044 11779.5,-2112"/>
<text text-anchor="middle" x="11678" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU0</text>
<text text-anchor="middle" x="11678" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11678" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l1_attn_gpu0&#45;&gt;l1_out_gpu0 -->
<g id="edge60" class="edge">
<title>l1_attn_gpu0&#45;&gt;l1_out_gpu0</title>
<path fill="none" stroke="black" d="M11678,-2183.75C11678,-2183.75 11678,-2122.38 11678,-2122.38"/>
<polygon fill="black" stroke="black" points="11681.5,-2122.38 11678,-2112.38 11674.5,-2122.38 11681.5,-2122.38"/>
</g>
<!-- l1_attn_all_reduce -->
<g id="node50" class="node">
<title>l1_attn_all_reduce</title>
<polygon fill="lightcyan" stroke="black" points="11906.17,-1972 11543.2,-1972 11449.83,-1836 11812.8,-1836 11906.17,-1972"/>
<text text-anchor="middle" x="11678" y="-1922.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="11678" y="-1907.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="11678" y="-1892.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11678" y="-1877.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_out_gpu0&#45;&gt;l1_attn_all_reduce -->
<g id="edge61" class="edge">
<title>l1_out_gpu0&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11678,-2043.62C11678,-2043.62 11678,-1982.14 11678,-1982.14"/>
<polygon fill="black" stroke="black" points="11681.5,-1982.14 11678,-1972.14 11674.5,-1982.14 11681.5,-1982.14"/>
</g>
<!-- l1_attn_res -->
<g id="node65" class="node">
<title>l1_attn_res</title>
<polygon fill="orange" stroke="black" points="12496,-1730 12168,-1730 12168,-1662 12496,-1662 12496,-1730"/>
<text text-anchor="middle" x="12332" y="-1714.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12332" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="12332" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12332" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_attn_all_reduce&#45;&gt;l1_attn_res -->
<g id="edge83" class="edge">
<title>l1_attn_all_reduce&#45;&gt;l1_attn_res</title>
<path fill="none" stroke="black" d="M11836.27,-1870C11993.96,-1870 12212.75,-1870 12212.75,-1870 12212.75,-1870 12212.75,-1740.38 12212.75,-1740.38"/>
<polygon fill="black" stroke="black" points="12216.25,-1740.38 12212.75,-1730.38 12209.25,-1740.38 12216.25,-1740.38"/>
</g>
<!-- l1_out_gpu1 -->
<g id="node52" class="node">
<title>l1_out_gpu1</title>
<polygon fill="yellow" stroke="black" points="12018.5,-2112 11815.5,-2112 11815.5,-2044 12018.5,-2044 12018.5,-2112"/>
<text text-anchor="middle" x="11917" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU1</text>
<text text-anchor="middle" x="11917" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11917" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l1_attn_gpu1&#45;&gt;l1_out_gpu1 -->
<g id="edge63" class="edge">
<title>l1_attn_gpu1&#45;&gt;l1_out_gpu1</title>
<path fill="none" stroke="black" d="M11914,-2183.75C11914,-2183.75 11914,-2122.38 11914,-2122.38"/>
<polygon fill="black" stroke="black" points="11917.5,-2122.38 11914,-2112.38 11910.5,-2122.38 11917.5,-2122.38"/>
</g>
<!-- l1_out_gpu1&#45;&gt;l1_attn_all_reduce -->
<g id="edge64" class="edge">
<title>l1_out_gpu1&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11860.79,-2043.62C11860.79,-2043.62 11860.79,-1982.14 11860.79,-1982.14"/>
<polygon fill="black" stroke="black" points="11864.29,-1982.14 11860.79,-1972.14 11857.29,-1982.14 11864.29,-1982.14"/>
</g>
<!-- l1_out_gpu2 -->
<g id="node54" class="node">
<title>l1_out_gpu2</title>
<polygon fill="yellow" stroke="black" points="12257.5,-2112 12054.5,-2112 12054.5,-2044 12257.5,-2044 12257.5,-2112"/>
<text text-anchor="middle" x="12156" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU2</text>
<text text-anchor="middle" x="12156" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12156" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12156" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l1_attn_gpu2&#45;&gt;l1_out_gpu2 -->
<g id="edge66" class="edge">
<title>l1_attn_gpu2&#45;&gt;l1_out_gpu2</title>
<path fill="none" stroke="black" d="M12149.25,-2183.75C12149.25,-2183.75 12149.25,-2122.38 12149.25,-2122.38"/>
<polygon fill="black" stroke="black" points="12152.75,-2122.38 12149.25,-2112.38 12145.75,-2122.38 12152.75,-2122.38"/>
</g>
<!-- l1_out_gpu2&#45;&gt;l1_attn_all_reduce -->
<g id="edge67" class="edge">
<title>l1_out_gpu2&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M12111.25,-2043.75C12111.25,-2002.31 12111.25,-1938 12111.25,-1938 12111.25,-1938 11892.89,-1938 11892.89,-1938"/>
<polygon fill="black" stroke="black" points="11892.89,-1934.5 11882.89,-1938 11892.89,-1941.5 11892.89,-1934.5"/>
</g>
<!-- l1_out_gpu3 -->
<g id="node56" class="node">
<title>l1_out_gpu3</title>
<polygon fill="yellow" stroke="black" points="12496.5,-2112 12293.5,-2112 12293.5,-2044 12496.5,-2044 12496.5,-2112"/>
<text text-anchor="middle" x="12395" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU3</text>
<text text-anchor="middle" x="12395" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12395" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12395" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l1_attn_gpu3&#45;&gt;l1_out_gpu3 -->
<g id="edge69" class="edge">
<title>l1_attn_gpu3&#45;&gt;l1_out_gpu3</title>
<path fill="none" stroke="black" d="M12384.75,-2183.75C12384.75,-2183.75 12384.75,-2122.38 12384.75,-2122.38"/>
<polygon fill="black" stroke="black" points="12388.25,-2122.38 12384.75,-2112.38 12381.25,-2122.38 12388.25,-2122.38"/>
</g>
<!-- l1_out_gpu3&#45;&gt;l1_attn_all_reduce -->
<g id="edge70" class="edge">
<title>l1_out_gpu3&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M12394.75,-2043.62C12394.75,-1992.91 12394.75,-1904 12394.75,-1904 12394.75,-1904 11869.79,-1904 11869.79,-1904"/>
<polygon fill="black" stroke="black" points="11869.79,-1900.5 11859.79,-1904 11869.79,-1907.5 11869.79,-1900.5"/>
</g>
<!-- l1_out_gpu4 -->
<g id="node58" class="node">
<title>l1_out_gpu4</title>
<polygon fill="yellow" stroke="black" points="10823.5,-2112 10620.5,-2112 10620.5,-2044 10823.5,-2044 10823.5,-2112"/>
<text text-anchor="middle" x="10722" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU4</text>
<text text-anchor="middle" x="10722" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10722" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10722" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_attn_gpu4&#45;&gt;l1_out_gpu4 -->
<g id="edge72" class="edge">
<title>l1_attn_gpu4&#45;&gt;l1_out_gpu4</title>
<path fill="none" stroke="black" d="M10726.75,-2183.75C10726.75,-2183.75 10726.75,-2122.38 10726.75,-2122.38"/>
<polygon fill="black" stroke="black" points="10730.25,-2122.38 10726.75,-2112.38 10723.25,-2122.38 10730.25,-2122.38"/>
</g>
<!-- l1_out_gpu4&#45;&gt;l1_attn_all_reduce -->
<g id="edge73" class="edge">
<title>l1_out_gpu4&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10722,-2043.87C10722,-2001.29 10722,-1934 10722,-1934 10722,-1934 11506.91,-1934 11506.91,-1934"/>
<polygon fill="black" stroke="black" points="11506.91,-1937.5 11516.91,-1934 11506.91,-1930.5 11506.91,-1937.5"/>
</g>
<!-- l1_out_gpu5 -->
<g id="node60" class="node">
<title>l1_out_gpu5</title>
<polygon fill="yellow" stroke="black" points="11062.5,-2112 10859.5,-2112 10859.5,-2044 11062.5,-2044 11062.5,-2112"/>
<text text-anchor="middle" x="10961" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU5</text>
<text text-anchor="middle" x="10961" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10961" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10961" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_attn_gpu5&#45;&gt;l1_out_gpu5 -->
<g id="edge75" class="edge">
<title>l1_attn_gpu5&#45;&gt;l1_out_gpu5</title>
<path fill="none" stroke="black" d="M10968.25,-2183.75C10968.25,-2183.75 10968.25,-2122.38 10968.25,-2122.38"/>
<polygon fill="black" stroke="black" points="10971.75,-2122.38 10968.25,-2112.38 10964.75,-2122.38 10971.75,-2122.38"/>
</g>
<!-- l1_out_gpu5&#45;&gt;l1_attn_all_reduce -->
<g id="edge76" class="edge">
<title>l1_out_gpu5&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10961,-2043.92C10961,-2005.11 10961,-1947 10961,-1947 10961,-1947 11515.94,-1947 11515.94,-1947"/>
<polygon fill="black" stroke="black" points="11515.94,-1950.5 11525.94,-1947 11515.94,-1943.5 11515.94,-1950.5"/>
</g>
<!-- l1_out_gpu6 -->
<g id="node62" class="node">
<title>l1_out_gpu6</title>
<polygon fill="yellow" stroke="black" points="11301.5,-2112 11098.5,-2112 11098.5,-2044 11301.5,-2044 11301.5,-2112"/>
<text text-anchor="middle" x="11200" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU6</text>
<text text-anchor="middle" x="11200" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11200" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11200" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_attn_gpu6&#45;&gt;l1_out_gpu6 -->
<g id="edge78" class="edge">
<title>l1_attn_gpu6&#45;&gt;l1_out_gpu6</title>
<path fill="none" stroke="black" d="M11204.75,-2183.75C11204.75,-2183.75 11204.75,-2122.38 11204.75,-2122.38"/>
<polygon fill="black" stroke="black" points="11208.25,-2122.38 11204.75,-2112.38 11201.25,-2122.38 11208.25,-2122.38"/>
</g>
<!-- l1_out_gpu6&#45;&gt;l1_attn_all_reduce -->
<g id="edge79" class="edge">
<title>l1_out_gpu6&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11200,-2043.9C11200,-2008.74 11200,-1959 11200,-1959 11200,-1959 11524.26,-1959 11524.26,-1959"/>
<polygon fill="black" stroke="black" points="11524.26,-1962.5 11534.26,-1959 11524.26,-1955.5 11524.26,-1962.5"/>
</g>
<!-- l1_out_gpu7 -->
<g id="node64" class="node">
<title>l1_out_gpu7</title>
<polygon fill="yellow" stroke="black" points="11540.5,-2112 11337.5,-2112 11337.5,-2044 11540.5,-2044 11540.5,-2112"/>
<text text-anchor="middle" x="11439" y="-2096.8" font-family="Times,serif" font-size="14.00">Output Projection GPU7</text>
<text text-anchor="middle" x="11439" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11439" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11439" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_attn_gpu7&#45;&gt;l1_out_gpu7 -->
<g id="edge81" class="edge">
<title>l1_attn_gpu7&#45;&gt;l1_out_gpu7</title>
<path fill="none" stroke="black" d="M11443,-2183.75C11443,-2183.75 11443,-2122.38 11443,-2122.38"/>
<polygon fill="black" stroke="black" points="11446.5,-2122.38 11443,-2112.38 11439.5,-2122.38 11446.5,-2122.38"/>
</g>
<!-- l1_out_gpu7&#45;&gt;l1_attn_all_reduce -->
<g id="edge82" class="edge">
<title>l1_out_gpu7&#45;&gt;l1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11495.21,-2043.62C11495.21,-2043.62 11495.21,-1914.06 11495.21,-1914.06"/>
<polygon fill="black" stroke="black" points="11498.71,-1914.06 11495.21,-1904.06 11491.71,-1914.06 11498.71,-1914.06"/>
</g>
<!-- l1_attn_to_moe -->
<g id="node156" class="node">
<title>l1_attn_to_moe</title>
<polygon fill="gray" stroke="black" points="12956.47,-2600 12608.93,-2600 12519.53,-2464 12867.07,-2464 12956.47,-2600"/>
<text text-anchor="middle" x="12738" y="-2550.8" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="12738" y="-2535.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12738" y="-2520.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12738" y="-2505.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- l1_attn_res&#45;&gt;l1_attn_to_moe -->
<g id="edge225" class="edge">
<title>l1_attn_res&#45;&gt;l1_attn_to_moe</title>
<path fill="none" stroke="black" d="M12496.39,-1707C12669.28,-1707 12916.56,-1707 12916.56,-1707 12916.56,-1707 12916.56,-2521.85 12916.56,-2521.85"/>
<polygon fill="black" stroke="black" points="12913.06,-2521.85 12916.56,-2531.85 12920.06,-2521.85 12913.06,-2521.85"/>
</g>
<!-- l1_moe_gate -->
<g id="node66" class="node">
<title>l1_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="9874.5,-2566 9683.5,-2566 9683.5,-2498 9874.5,-2498 9874.5,-2566"/>
<text text-anchor="middle" x="9779" y="-2550.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="9779" y="-2535.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9779" y="-2520.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="9779" y="-2505.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_exp_gpu8 -->
<g id="node67" class="node">
<title>l1_exp_gpu8</title>
<polygon fill="lightpink" stroke="black" points="9402.5,-2392 9199.5,-2392 9199.5,-2324 9402.5,-2324 9402.5,-2392"/>
<text text-anchor="middle" x="9301" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 0,1</text>
<text text-anchor="middle" x="9301" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9301" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9301" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu8 -->
<g id="edge84" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.33,-2525C9535.19,-2525 9267.17,-2525 9267.17,-2525 9267.17,-2525 9267.17,-2402.2 9267.17,-2402.2"/>
<polygon fill="black" stroke="black" points="9270.67,-2402.2 9267.17,-2392.2 9263.67,-2402.2 9270.67,-2402.2"/>
</g>
<!-- l1_exp_gpu9 -->
<g id="node68" class="node">
<title>l1_exp_gpu9</title>
<polygon fill="lightpink" stroke="black" points="9641.5,-2392 9438.5,-2392 9438.5,-2324 9641.5,-2324 9641.5,-2392"/>
<text text-anchor="middle" x="9540" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 2,3</text>
<text text-anchor="middle" x="9540" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9540" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9540" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu9 -->
<g id="edge85" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.19,-2511C9604.58,-2511 9506.17,-2511 9506.17,-2511 9506.17,-2511 9506.17,-2402.34 9506.17,-2402.34"/>
<polygon fill="black" stroke="black" points="9509.67,-2402.34 9506.17,-2392.34 9502.67,-2402.34 9509.67,-2402.34"/>
</g>
<!-- l1_exp_gpu10 -->
<g id="node69" class="node">
<title>l1_exp_gpu10</title>
<polygon fill="lightpink" stroke="black" points="9880.5,-2392 9677.5,-2392 9677.5,-2324 9880.5,-2324 9880.5,-2392"/>
<text text-anchor="middle" x="9779" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 4,5</text>
<text text-anchor="middle" x="9779" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9779" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9779" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu10 -->
<g id="edge86" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9747.17,-2497.62C9747.17,-2497.62 9747.17,-2402.01 9747.17,-2402.01"/>
<polygon fill="black" stroke="black" points="9750.67,-2402.01 9747.17,-2392.01 9743.67,-2402.01 9750.67,-2402.01"/>
</g>
<!-- l1_exp_gpu11 -->
<g id="node70" class="node">
<title>l1_exp_gpu11</title>
<polygon fill="lightpink" stroke="black" points="10119.5,-2392 9916.5,-2392 9916.5,-2324 10119.5,-2324 10119.5,-2392"/>
<text text-anchor="middle" x="10018" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 6,7</text>
<text text-anchor="middle" x="10018" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10018" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10018" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu11 -->
<g id="edge87" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9874.68,-2515C9928.16,-2515 9984.17,-2515 9984.17,-2515 9984.17,-2515 9984.17,-2402.07 9984.17,-2402.07"/>
<polygon fill="black" stroke="black" points="9987.67,-2402.07 9984.17,-2392.07 9980.67,-2402.07 9987.67,-2402.07"/>
</g>
<!-- l1_exp_gpu12 -->
<g id="node71" class="node">
<title>l1_exp_gpu12</title>
<polygon fill="lightpink" stroke="black" points="10358.5,-2392 10155.5,-2392 10155.5,-2324 10358.5,-2324 10358.5,-2392"/>
<text text-anchor="middle" x="10257" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 8,9</text>
<text text-anchor="middle" x="10257" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10257" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10257" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu12 -->
<g id="edge88" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9874.56,-2532C10005.1,-2532 10223.17,-2532 10223.17,-2532 10223.17,-2532 10223.17,-2402.38 10223.17,-2402.38"/>
<polygon fill="black" stroke="black" points="10226.67,-2402.38 10223.17,-2392.38 10219.67,-2402.38 10226.67,-2402.38"/>
</g>
<!-- l1_exp_gpu13 -->
<g id="node72" class="node">
<title>l1_exp_gpu13</title>
<polygon fill="lightpink" stroke="black" points="10597.5,-2392 10394.5,-2392 10394.5,-2324 10597.5,-2324 10597.5,-2392"/>
<text text-anchor="middle" x="10496" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 10,11</text>
<text text-anchor="middle" x="10496" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10496" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10496" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu13 -->
<g id="edge89" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9874.71,-2549C10062.73,-2549 10462.17,-2549 10462.17,-2549 10462.17,-2549 10462.17,-2402.15 10462.17,-2402.15"/>
<polygon fill="black" stroke="black" points="10465.67,-2402.15 10462.17,-2392.15 10458.67,-2402.15 10465.67,-2402.15"/>
</g>
<!-- l1_exp_gpu14 -->
<g id="node73" class="node">
<title>l1_exp_gpu14</title>
<polygon fill="lightpink" stroke="black" points="8924.5,-2392 8721.5,-2392 8721.5,-2324 8924.5,-2324 8924.5,-2392"/>
<text text-anchor="middle" x="8823" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 12,13</text>
<text text-anchor="middle" x="8823" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8823" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="8823" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu14 -->
<g id="edge90" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.19,-2552C9434.78,-2552 8789.17,-2552 8789.17,-2552 8789.17,-2552 8789.17,-2402.24 8789.17,-2402.24"/>
<polygon fill="black" stroke="black" points="8792.67,-2402.24 8789.17,-2392.24 8785.67,-2402.24 8792.67,-2402.24"/>
</g>
<!-- l1_exp_gpu15 -->
<g id="node74" class="node">
<title>l1_exp_gpu15</title>
<polygon fill="lightpink" stroke="black" points="9163.5,-2392 8960.5,-2392 8960.5,-2324 9163.5,-2324 9163.5,-2392"/>
<text text-anchor="middle" x="9062" y="-2376.8" font-family="Times,serif" font-size="14.00">Experts 14,15</text>
<text text-anchor="middle" x="9062" y="-2361.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9062" y="-2346.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9062" y="-2331.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_exp_gpu15 -->
<g id="edge91" class="edge">
<title>l1_moe_gate&#45;&gt;l1_exp_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9683.14,-2538C9480.73,-2538 9028.17,-2538 9028.17,-2538 9028.17,-2538 9028.17,-2402.28 9028.17,-2402.28"/>
<polygon fill="black" stroke="black" points="9031.67,-2402.28 9028.17,-2392.28 9024.67,-2402.28 9031.67,-2402.28"/>
</g>
<!-- l1_moe_agg -->
<g id="node75" class="node">
<title>l1_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="9765,-2252 9553,-2252 9553,-2184 9765,-2184 9765,-2252"/>
<text text-anchor="middle" x="9659" y="-2236.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9659" y="-2221.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—2</text>
<text text-anchor="middle" x="9659" y="-2206.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9659" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_exp_gpu8&#45;&gt;l1_moe_agg -->
<g id="edge92" class="edge">
<title>l1_exp_gpu8&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M9301,-2323.74C9301,-2287.34 9301,-2235 9301,-2235 9301,-2235 9542.56,-2235 9542.56,-2235"/>
<polygon fill="black" stroke="black" points="9542.56,-2238.5 9552.56,-2235 9542.56,-2231.5 9542.56,-2238.5"/>
</g>
<!-- l1_exp_gpu9&#45;&gt;l1_moe_agg -->
<g id="edge93" class="edge">
<title>l1_exp_gpu9&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M9597.25,-2323.75C9597.25,-2323.75 9597.25,-2262.38 9597.25,-2262.38"/>
<polygon fill="black" stroke="black" points="9600.75,-2262.38 9597.25,-2252.38 9593.75,-2262.38 9600.75,-2262.38"/>
</g>
<!-- l1_exp_gpu10&#45;&gt;l1_moe_agg -->
<g id="edge94" class="edge">
<title>l1_exp_gpu10&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M9721.25,-2323.75C9721.25,-2323.75 9721.25,-2262.38 9721.25,-2262.38"/>
<polygon fill="black" stroke="black" points="9724.75,-2262.38 9721.25,-2252.38 9717.75,-2262.38 9724.75,-2262.38"/>
</g>
<!-- l1_exp_gpu11&#45;&gt;l1_moe_agg -->
<g id="edge95" class="edge">
<title>l1_exp_gpu11&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M10018,-2323.74C10018,-2287.34 10018,-2235 10018,-2235 10018,-2235 9775.25,-2235 9775.25,-2235"/>
<polygon fill="black" stroke="black" points="9775.25,-2231.5 9765.25,-2235 9775.25,-2238.5 9775.25,-2231.5"/>
</g>
<!-- l1_exp_gpu12&#45;&gt;l1_moe_agg -->
<g id="edge96" class="edge">
<title>l1_exp_gpu12&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M10257,-2323.75C10257,-2282.31 10257,-2218 10257,-2218 10257,-2218 9775.22,-2218 9775.22,-2218"/>
<polygon fill="black" stroke="black" points="9775.22,-2214.5 9765.22,-2218 9775.22,-2221.5 9775.22,-2214.5"/>
</g>
<!-- l1_exp_gpu13&#45;&gt;l1_moe_agg -->
<g id="edge97" class="edge">
<title>l1_exp_gpu13&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M10496,-2323.93C10496,-2277.76 10496,-2201 10496,-2201 10496,-2201 9775.01,-2201 9775.01,-2201"/>
<polygon fill="black" stroke="black" points="9775.01,-2197.5 9765.01,-2201 9775.01,-2204.5 9775.01,-2197.5"/>
</g>
<!-- l1_exp_gpu14&#45;&gt;l1_moe_agg -->
<g id="edge98" class="edge">
<title>l1_exp_gpu14&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M8823,-2323.93C8823,-2277.76 8823,-2201 8823,-2201 8823,-2201 9542.7,-2201 9542.7,-2201"/>
<polygon fill="black" stroke="black" points="9542.7,-2204.5 9552.7,-2201 9542.7,-2197.5 9542.7,-2204.5"/>
</g>
<!-- l1_exp_gpu15&#45;&gt;l1_moe_agg -->
<g id="edge99" class="edge">
<title>l1_exp_gpu15&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M9062,-2323.75C9062,-2282.31 9062,-2218 9062,-2218 9062,-2218 9542.96,-2218 9542.96,-2218"/>
<polygon fill="black" stroke="black" points="9542.96,-2221.5 9552.96,-2218 9542.96,-2214.5 9542.96,-2221.5"/>
</g>
<!-- l1_moe_res -->
<g id="node76" class="node">
<title>l1_moe_res</title>
<polygon fill="orange" stroke="black" points="9823,-2112 9495,-2112 9495,-2044 9823,-2044 9823,-2112"/>
<text text-anchor="middle" x="9659" y="-2096.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9659" y="-2081.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="9659" y="-2066.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9659" y="-2051.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l1_moe_agg&#45;&gt;l1_moe_res -->
<g id="edge100" class="edge">
<title>l1_moe_agg&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M9659,-2183.75C9659,-2183.75 9659,-2122.38 9659,-2122.38"/>
<polygon fill="black" stroke="black" points="9662.5,-2122.38 9659,-2112.38 9655.5,-2122.38 9662.5,-2122.38"/>
</g>
<!-- prev_layer_1 -->
<g id="node157" class="node">
<title>prev_layer_1</title>
<polygon fill="lightblue" stroke="black" points="8698.5,-1922 8591.5,-1922 8591.5,-1886 8698.5,-1886 8698.5,-1922"/>
<text text-anchor="middle" x="8645" y="-1900.3" font-family="Times,serif" font-size="14.00">prev_layer_1</text>
</g>
<!-- l1_moe_res&#45;&gt;prev_layer_1 -->
<g id="edge226" class="edge">
<title>l1_moe_res&#45;&gt;prev_layer_1</title>
<path fill="none" stroke="black" d="M9494.96,-2078C9207.97,-2078 8645,-2078 8645,-2078 8645,-2078 8645,-1932.29 8645,-1932.29"/>
<polygon fill="black" stroke="black" points="8648.5,-1932.29 8645,-1922.29 8641.5,-1932.29 8648.5,-1932.29"/>
</g>
<!-- l2_qkv_all_gather -->
<g id="node77" class="node">
<title>l2_qkv_all_gather</title>
<polygon fill="lightcyan" stroke="black" points="7569.55,-1764 7186.89,-1764 7088.45,-1628 7471.11,-1628 7569.55,-1764"/>
<text text-anchor="middle" x="7329" y="-1714.8" font-family="Times,serif" font-size="14.00">All&#45;Gather QKV</text>
<text text-anchor="middle" x="7329" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7329" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="7329" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_qkv_gpu0 -->
<g id="node78" class="node">
<title>l2_qkv_gpu0</title>
<polygon fill="yellow" stroke="black" points="7426,-1556 7232,-1556 7232,-1488 7426,-1488 7426,-1556"/>
<text text-anchor="middle" x="7329" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU0</text>
<text text-anchor="middle" x="7329" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7329" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7329" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu0 -->
<g id="edge101" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M7329,-1627.73C7329,-1627.73 7329,-1566.11 7329,-1566.11"/>
<polygon fill="black" stroke="black" points="7332.5,-1566.11 7329,-1556.11 7325.5,-1566.11 7332.5,-1566.11"/>
</g>
<!-- l2_qkv_gpu1 -->
<g id="node79" class="node">
<title>l2_qkv_gpu1</title>
<polygon fill="yellow" stroke="black" points="7656,-1556 7462,-1556 7462,-1488 7656,-1488 7656,-1556"/>
<text text-anchor="middle" x="7559" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU1</text>
<text text-anchor="middle" x="7559" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7559" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7559" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu1 -->
<g id="edge102" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M7515.76,-1689.39C7515.76,-1689.39 7515.76,-1566.24 7515.76,-1566.24"/>
<polygon fill="black" stroke="black" points="7519.26,-1566.24 7515.76,-1556.24 7512.26,-1566.24 7519.26,-1566.24"/>
</g>
<!-- l2_qkv_gpu2 -->
<g id="node80" class="node">
<title>l2_qkv_gpu2</title>
<polygon fill="yellow" stroke="black" points="7892,-1556 7698,-1556 7698,-1488 7892,-1488 7892,-1556"/>
<text text-anchor="middle" x="7795" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU2</text>
<text text-anchor="middle" x="7795" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7795" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7795" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu2 -->
<g id="edge103" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M7503.85,-1673C7636.08,-1673 7795,-1673 7795,-1673 7795,-1673 7795,-1566.26 7795,-1566.26"/>
<polygon fill="black" stroke="black" points="7798.5,-1566.26 7795,-1556.26 7791.5,-1566.26 7798.5,-1566.26"/>
</g>
<!-- l2_qkv_gpu3 -->
<g id="node81" class="node">
<title>l2_qkv_gpu3</title>
<polygon fill="yellow" stroke="black" points="8122,-1556 7928,-1556 7928,-1488 8122,-1488 8122,-1556"/>
<text text-anchor="middle" x="8025" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU3</text>
<text text-anchor="middle" x="8025" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8025" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="8025" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu3 -->
<g id="edge104" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M7536.41,-1718C7741.53,-1718 8025,-1718 8025,-1718 8025,-1718 8025,-1566.14 8025,-1566.14"/>
<polygon fill="black" stroke="black" points="8028.5,-1566.14 8025,-1556.14 8021.5,-1566.14 8028.5,-1566.14"/>
</g>
<!-- l2_qkv_gpu4 -->
<g id="node82" class="node">
<title>l2_qkv_gpu4</title>
<polygon fill="yellow" stroke="black" points="6486,-1556 6292,-1556 6292,-1488 6486,-1488 6486,-1556"/>
<text text-anchor="middle" x="6389" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU4</text>
<text text-anchor="middle" x="6389" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6389" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6389" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu4 -->
<g id="edge105" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M7106.53,-1653C6828.58,-1653 6389,-1653 6389,-1653 6389,-1653 6389,-1566.08 6389,-1566.08"/>
<polygon fill="black" stroke="black" points="6392.5,-1566.08 6389,-1556.08 6385.5,-1566.08 6392.5,-1566.08"/>
</g>
<!-- l2_qkv_gpu5 -->
<g id="node83" class="node">
<title>l2_qkv_gpu5</title>
<polygon fill="yellow" stroke="black" points="6716,-1556 6522,-1556 6522,-1488 6716,-1488 6716,-1556"/>
<text text-anchor="middle" x="6619" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU5</text>
<text text-anchor="middle" x="6619" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6619" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6619" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu5 -->
<g id="edge106" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M7100.44,-1645C6892.89,-1645 6619,-1645 6619,-1645 6619,-1645 6619,-1566.26 6619,-1566.26"/>
<polygon fill="black" stroke="black" points="6622.5,-1566.26 6619,-1556.26 6615.5,-1566.26 6622.5,-1566.26"/>
</g>
<!-- l2_qkv_gpu6 -->
<g id="node84" class="node">
<title>l2_qkv_gpu6</title>
<polygon fill="yellow" stroke="black" points="6959,-1556 6765,-1556 6765,-1488 6959,-1488 6959,-1556"/>
<text text-anchor="middle" x="6862" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU6</text>
<text text-anchor="middle" x="6862" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6862" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6862" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu6 -->
<g id="edge107" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M7094.13,-1636C6977.84,-1636 6862,-1636 6862,-1636 6862,-1636 6862,-1566.2 6862,-1566.2"/>
<polygon fill="black" stroke="black" points="6865.5,-1566.2 6862,-1556.2 6858.5,-1566.2 6865.5,-1566.2"/>
</g>
<!-- l2_qkv_gpu7 -->
<g id="node85" class="node">
<title>l2_qkv_gpu7</title>
<polygon fill="yellow" stroke="black" points="7196,-1556 7002,-1556 7002,-1488 7196,-1488 7196,-1556"/>
<text text-anchor="middle" x="7099" y="-1540.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU7</text>
<text text-anchor="middle" x="7099" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7099" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7099" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l2_qkv_all_gather&#45;&gt;l2_qkv_gpu7 -->
<g id="edge108" class="edge">
<title>l2_qkv_all_gather&#45;&gt;l2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M7142.24,-1627.73C7142.24,-1627.73 7142.24,-1566.11 7142.24,-1566.11"/>
<polygon fill="black" stroke="black" points="7145.74,-1566.11 7142.24,-1556.11 7138.74,-1566.11 7145.74,-1566.11"/>
</g>
<!-- l2_attn_gpu0 -->
<g id="node86" class="node">
<title>l2_attn_gpu0</title>
<polygon fill="yellow" stroke="black" points="7426,-1416 7232,-1416 7232,-1348 7426,-1348 7426,-1416"/>
<text text-anchor="middle" x="7329" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU0</text>
<text text-anchor="middle" x="7329" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7329" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7329" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l2_qkv_gpu0&#45;&gt;l2_attn_gpu0 -->
<g id="edge109" class="edge">
<title>l2_qkv_gpu0&#45;&gt;l2_attn_gpu0</title>
<path fill="none" stroke="black" d="M7329,-1487.75C7329,-1487.75 7329,-1426.38 7329,-1426.38"/>
<polygon fill="black" stroke="black" points="7332.5,-1426.38 7329,-1416.38 7325.5,-1426.38 7332.5,-1426.38"/>
</g>
<!-- l2_attn_gpu1 -->
<g id="node89" class="node">
<title>l2_attn_gpu1</title>
<polygon fill="yellow" stroke="black" points="7660,-1416 7466,-1416 7466,-1348 7660,-1348 7660,-1416"/>
<text text-anchor="middle" x="7563" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU1</text>
<text text-anchor="middle" x="7563" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7563" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7563" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l2_qkv_gpu1&#45;&gt;l2_attn_gpu1 -->
<g id="edge112" class="edge">
<title>l2_qkv_gpu1&#45;&gt;l2_attn_gpu1</title>
<path fill="none" stroke="black" d="M7561,-1487.75C7561,-1487.75 7561,-1426.38 7561,-1426.38"/>
<polygon fill="black" stroke="black" points="7564.5,-1426.38 7561,-1416.38 7557.5,-1426.38 7564.5,-1426.38"/>
</g>
<!-- l2_attn_gpu2 -->
<g id="node91" class="node">
<title>l2_attn_gpu2</title>
<polygon fill="yellow" stroke="black" points="7897,-1416 7703,-1416 7703,-1348 7897,-1348 7897,-1416"/>
<text text-anchor="middle" x="7800" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU2</text>
<text text-anchor="middle" x="7800" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7800" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7800" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l2_qkv_gpu2&#45;&gt;l2_attn_gpu2 -->
<g id="edge115" class="edge">
<title>l2_qkv_gpu2&#45;&gt;l2_attn_gpu2</title>
<path fill="none" stroke="black" d="M7797.5,-1487.75C7797.5,-1487.75 7797.5,-1426.38 7797.5,-1426.38"/>
<polygon fill="black" stroke="black" points="7801,-1426.38 7797.5,-1416.38 7794,-1426.38 7801,-1426.38"/>
</g>
<!-- l2_attn_gpu3 -->
<g id="node93" class="node">
<title>l2_attn_gpu3</title>
<polygon fill="yellow" stroke="black" points="8135,-1416 7941,-1416 7941,-1348 8135,-1348 8135,-1416"/>
<text text-anchor="middle" x="8038" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU3</text>
<text text-anchor="middle" x="8038" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="8038" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="8038" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l2_qkv_gpu3&#45;&gt;l2_attn_gpu3 -->
<g id="edge118" class="edge">
<title>l2_qkv_gpu3&#45;&gt;l2_attn_gpu3</title>
<path fill="none" stroke="black" d="M8031.5,-1487.75C8031.5,-1487.75 8031.5,-1426.38 8031.5,-1426.38"/>
<polygon fill="black" stroke="black" points="8035,-1426.38 8031.5,-1416.38 8028,-1426.38 8035,-1426.38"/>
</g>
<!-- l2_attn_gpu4 -->
<g id="node95" class="node">
<title>l2_attn_gpu4</title>
<polygon fill="yellow" stroke="black" points="6477,-1416 6283,-1416 6283,-1348 6477,-1348 6477,-1416"/>
<text text-anchor="middle" x="6380" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU4</text>
<text text-anchor="middle" x="6380" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6380" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6380" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l2_qkv_gpu4&#45;&gt;l2_attn_gpu4 -->
<g id="edge121" class="edge">
<title>l2_qkv_gpu4&#45;&gt;l2_attn_gpu4</title>
<path fill="none" stroke="black" d="M6384.5,-1487.75C6384.5,-1487.75 6384.5,-1426.38 6384.5,-1426.38"/>
<polygon fill="black" stroke="black" points="6388,-1426.38 6384.5,-1416.38 6381,-1426.38 6388,-1426.38"/>
</g>
<!-- l2_attn_gpu5 -->
<g id="node97" class="node">
<title>l2_attn_gpu5</title>
<polygon fill="yellow" stroke="black" points="6713,-1416 6519,-1416 6519,-1348 6713,-1348 6713,-1416"/>
<text text-anchor="middle" x="6616" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU5</text>
<text text-anchor="middle" x="6616" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6616" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6616" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l2_qkv_gpu5&#45;&gt;l2_attn_gpu5 -->
<g id="edge124" class="edge">
<title>l2_qkv_gpu5&#45;&gt;l2_attn_gpu5</title>
<path fill="none" stroke="black" d="M6617.5,-1487.75C6617.5,-1487.75 6617.5,-1426.38 6617.5,-1426.38"/>
<polygon fill="black" stroke="black" points="6621,-1426.38 6617.5,-1416.38 6614,-1426.38 6621,-1426.38"/>
</g>
<!-- l2_attn_gpu6 -->
<g id="node99" class="node">
<title>l2_attn_gpu6</title>
<polygon fill="yellow" stroke="black" points="6954,-1416 6760,-1416 6760,-1348 6954,-1348 6954,-1416"/>
<text text-anchor="middle" x="6857" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU6</text>
<text text-anchor="middle" x="6857" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6857" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="6857" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l2_qkv_gpu6&#45;&gt;l2_attn_gpu6 -->
<g id="edge127" class="edge">
<title>l2_qkv_gpu6&#45;&gt;l2_attn_gpu6</title>
<path fill="none" stroke="black" d="M6859.5,-1487.75C6859.5,-1487.75 6859.5,-1426.38 6859.5,-1426.38"/>
<polygon fill="black" stroke="black" points="6863,-1426.38 6859.5,-1416.38 6856,-1426.38 6863,-1426.38"/>
</g>
<!-- l2_attn_gpu7 -->
<g id="node101" class="node">
<title>l2_attn_gpu7</title>
<polygon fill="yellow" stroke="black" points="7193,-1416 6999,-1416 6999,-1348 7193,-1348 7193,-1416"/>
<text text-anchor="middle" x="7096" y="-1400.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU7</text>
<text text-anchor="middle" x="7096" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7096" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7096" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l2_qkv_gpu7&#45;&gt;l2_attn_gpu7 -->
<g id="edge130" class="edge">
<title>l2_qkv_gpu7&#45;&gt;l2_attn_gpu7</title>
<path fill="none" stroke="black" d="M7097.5,-1487.75C7097.5,-1487.75 7097.5,-1426.38 7097.5,-1426.38"/>
<polygon fill="black" stroke="black" points="7101,-1426.38 7097.5,-1416.38 7094,-1426.38 7101,-1426.38"/>
</g>
<!-- l2_out_gpu0 -->
<g id="node87" class="node">
<title>l2_out_gpu0</title>
<polygon fill="yellow" stroke="black" points="7430.5,-1276 7227.5,-1276 7227.5,-1208 7430.5,-1208 7430.5,-1276"/>
<text text-anchor="middle" x="7329" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU0</text>
<text text-anchor="middle" x="7329" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7329" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7329" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l2_attn_gpu0&#45;&gt;l2_out_gpu0 -->
<g id="edge110" class="edge">
<title>l2_attn_gpu0&#45;&gt;l2_out_gpu0</title>
<path fill="none" stroke="black" d="M7329,-1347.75C7329,-1347.75 7329,-1286.38 7329,-1286.38"/>
<polygon fill="black" stroke="black" points="7332.5,-1286.38 7329,-1276.38 7325.5,-1286.38 7332.5,-1286.38"/>
</g>
<!-- l2_attn_all_reduce -->
<g id="node88" class="node">
<title>l2_attn_all_reduce</title>
<polygon fill="lightcyan" stroke="black" points="7557.17,-1136 7194.2,-1136 7100.83,-1000 7463.8,-1000 7557.17,-1136"/>
<text text-anchor="middle" x="7329" y="-1086.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="7329" y="-1071.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="7329" y="-1056.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7329" y="-1041.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_out_gpu0&#45;&gt;l2_attn_all_reduce -->
<g id="edge111" class="edge">
<title>l2_out_gpu0&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7329,-1207.62C7329,-1207.62 7329,-1146.14 7329,-1146.14"/>
<polygon fill="black" stroke="black" points="7332.5,-1146.14 7329,-1136.14 7325.5,-1146.14 7332.5,-1146.14"/>
</g>
<!-- l2_attn_res -->
<g id="node103" class="node">
<title>l2_attn_res</title>
<polygon fill="orange" stroke="black" points="8147,-894 7819,-894 7819,-826 8147,-826 8147,-894"/>
<text text-anchor="middle" x="7983" y="-878.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7983" y="-863.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="7983" y="-848.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7983" y="-833.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_attn_all_reduce&#45;&gt;l2_attn_res -->
<g id="edge133" class="edge">
<title>l2_attn_all_reduce&#45;&gt;l2_attn_res</title>
<path fill="none" stroke="black" d="M7487.27,-1034C7644.96,-1034 7863.75,-1034 7863.75,-1034 7863.75,-1034 7863.75,-904.38 7863.75,-904.38"/>
<polygon fill="black" stroke="black" points="7867.25,-904.38 7863.75,-894.38 7860.25,-904.38 7867.25,-904.38"/>
</g>
<!-- l2_out_gpu1 -->
<g id="node90" class="node">
<title>l2_out_gpu1</title>
<polygon fill="yellow" stroke="black" points="7669.5,-1276 7466.5,-1276 7466.5,-1208 7669.5,-1208 7669.5,-1276"/>
<text text-anchor="middle" x="7568" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU1</text>
<text text-anchor="middle" x="7568" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7568" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7568" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l2_attn_gpu1&#45;&gt;l2_out_gpu1 -->
<g id="edge113" class="edge">
<title>l2_attn_gpu1&#45;&gt;l2_out_gpu1</title>
<path fill="none" stroke="black" d="M7563.25,-1347.75C7563.25,-1347.75 7563.25,-1286.38 7563.25,-1286.38"/>
<polygon fill="black" stroke="black" points="7566.75,-1286.38 7563.25,-1276.38 7559.75,-1286.38 7566.75,-1286.38"/>
</g>
<!-- l2_out_gpu1&#45;&gt;l2_attn_all_reduce -->
<g id="edge114" class="edge">
<title>l2_out_gpu1&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7511.79,-1207.62C7511.79,-1207.62 7511.79,-1146.14 7511.79,-1146.14"/>
<polygon fill="black" stroke="black" points="7515.29,-1146.14 7511.79,-1136.14 7508.29,-1146.14 7515.29,-1146.14"/>
</g>
<!-- l2_out_gpu2 -->
<g id="node92" class="node">
<title>l2_out_gpu2</title>
<polygon fill="yellow" stroke="black" points="7908.5,-1276 7705.5,-1276 7705.5,-1208 7908.5,-1208 7908.5,-1276"/>
<text text-anchor="middle" x="7807" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU2</text>
<text text-anchor="middle" x="7807" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7807" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7807" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l2_attn_gpu2&#45;&gt;l2_out_gpu2 -->
<g id="edge116" class="edge">
<title>l2_attn_gpu2&#45;&gt;l2_out_gpu2</title>
<path fill="none" stroke="black" d="M7801.25,-1347.75C7801.25,-1347.75 7801.25,-1286.38 7801.25,-1286.38"/>
<polygon fill="black" stroke="black" points="7804.75,-1286.38 7801.25,-1276.38 7797.75,-1286.38 7804.75,-1286.38"/>
</g>
<!-- l2_out_gpu2&#45;&gt;l2_attn_all_reduce -->
<g id="edge117" class="edge">
<title>l2_out_gpu2&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7762.25,-1207.75C7762.25,-1166.31 7762.25,-1102 7762.25,-1102 7762.25,-1102 7543.89,-1102 7543.89,-1102"/>
<polygon fill="black" stroke="black" points="7543.89,-1098.5 7533.89,-1102 7543.89,-1105.5 7543.89,-1098.5"/>
</g>
<!-- l2_out_gpu3 -->
<g id="node94" class="node">
<title>l2_out_gpu3</title>
<polygon fill="yellow" stroke="black" points="8147.5,-1276 7944.5,-1276 7944.5,-1208 8147.5,-1208 8147.5,-1276"/>
<text text-anchor="middle" x="8046" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU3</text>
<text text-anchor="middle" x="8046" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="8046" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="8046" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l2_attn_gpu3&#45;&gt;l2_out_gpu3 -->
<g id="edge119" class="edge">
<title>l2_attn_gpu3&#45;&gt;l2_out_gpu3</title>
<path fill="none" stroke="black" d="M8039.75,-1347.75C8039.75,-1347.75 8039.75,-1286.38 8039.75,-1286.38"/>
<polygon fill="black" stroke="black" points="8043.25,-1286.38 8039.75,-1276.38 8036.25,-1286.38 8043.25,-1286.38"/>
</g>
<!-- l2_out_gpu3&#45;&gt;l2_attn_all_reduce -->
<g id="edge120" class="edge">
<title>l2_out_gpu3&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M8045.75,-1207.62C8045.75,-1156.91 8045.75,-1068 8045.75,-1068 8045.75,-1068 7520.79,-1068 7520.79,-1068"/>
<polygon fill="black" stroke="black" points="7520.79,-1064.5 7510.79,-1068 7520.79,-1071.5 7520.79,-1064.5"/>
</g>
<!-- l2_out_gpu4 -->
<g id="node96" class="node">
<title>l2_out_gpu4</title>
<polygon fill="yellow" stroke="black" points="6474.5,-1276 6271.5,-1276 6271.5,-1208 6474.5,-1208 6474.5,-1276"/>
<text text-anchor="middle" x="6373" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU4</text>
<text text-anchor="middle" x="6373" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6373" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6373" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l2_attn_gpu4&#45;&gt;l2_out_gpu4 -->
<g id="edge122" class="edge">
<title>l2_attn_gpu4&#45;&gt;l2_out_gpu4</title>
<path fill="none" stroke="black" d="M6378.75,-1347.75C6378.75,-1347.75 6378.75,-1286.38 6378.75,-1286.38"/>
<polygon fill="black" stroke="black" points="6382.25,-1286.38 6378.75,-1276.38 6375.25,-1286.38 6382.25,-1286.38"/>
</g>
<!-- l2_out_gpu4&#45;&gt;l2_attn_all_reduce -->
<g id="edge123" class="edge">
<title>l2_out_gpu4&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6373,-1207.87C6373,-1165.29 6373,-1098 6373,-1098 6373,-1098 7157.91,-1098 7157.91,-1098"/>
<polygon fill="black" stroke="black" points="7157.91,-1101.5 7167.91,-1098 7157.91,-1094.5 7157.91,-1101.5"/>
</g>
<!-- l2_out_gpu5 -->
<g id="node98" class="node">
<title>l2_out_gpu5</title>
<polygon fill="yellow" stroke="black" points="6713.5,-1276 6510.5,-1276 6510.5,-1208 6713.5,-1208 6713.5,-1276"/>
<text text-anchor="middle" x="6612" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU5</text>
<text text-anchor="middle" x="6612" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6612" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6612" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l2_attn_gpu5&#45;&gt;l2_out_gpu5 -->
<g id="edge125" class="edge">
<title>l2_attn_gpu5&#45;&gt;l2_out_gpu5</title>
<path fill="none" stroke="black" d="M6616,-1347.75C6616,-1347.75 6616,-1286.38 6616,-1286.38"/>
<polygon fill="black" stroke="black" points="6619.5,-1286.38 6616,-1276.38 6612.5,-1286.38 6619.5,-1286.38"/>
</g>
<!-- l2_out_gpu5&#45;&gt;l2_attn_all_reduce -->
<g id="edge126" class="edge">
<title>l2_out_gpu5&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6612,-1207.92C6612,-1169.11 6612,-1111 6612,-1111 6612,-1111 7166.94,-1111 7166.94,-1111"/>
<polygon fill="black" stroke="black" points="7166.94,-1114.5 7176.94,-1111 7166.94,-1107.5 7166.94,-1114.5"/>
</g>
<!-- l2_out_gpu6 -->
<g id="node100" class="node">
<title>l2_out_gpu6</title>
<polygon fill="yellow" stroke="black" points="6952.5,-1276 6749.5,-1276 6749.5,-1208 6952.5,-1208 6952.5,-1276"/>
<text text-anchor="middle" x="6851" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU6</text>
<text text-anchor="middle" x="6851" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="6851" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6851" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l2_attn_gpu6&#45;&gt;l2_out_gpu6 -->
<g id="edge128" class="edge">
<title>l2_attn_gpu6&#45;&gt;l2_out_gpu6</title>
<path fill="none" stroke="black" d="M6856.25,-1347.75C6856.25,-1347.75 6856.25,-1286.38 6856.25,-1286.38"/>
<polygon fill="black" stroke="black" points="6859.75,-1286.38 6856.25,-1276.38 6852.75,-1286.38 6859.75,-1286.38"/>
</g>
<!-- l2_out_gpu6&#45;&gt;l2_attn_all_reduce -->
<g id="edge129" class="edge">
<title>l2_out_gpu6&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6851,-1207.9C6851,-1172.74 6851,-1123 6851,-1123 6851,-1123 7175.26,-1123 7175.26,-1123"/>
<polygon fill="black" stroke="black" points="7175.26,-1126.5 7185.26,-1123 7175.26,-1119.5 7175.26,-1126.5"/>
</g>
<!-- l2_out_gpu7 -->
<g id="node102" class="node">
<title>l2_out_gpu7</title>
<polygon fill="yellow" stroke="black" points="7191.5,-1276 6988.5,-1276 6988.5,-1208 7191.5,-1208 7191.5,-1276"/>
<text text-anchor="middle" x="7090" y="-1260.8" font-family="Times,serif" font-size="14.00">Output Projection GPU7</text>
<text text-anchor="middle" x="7090" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7090" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7090" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l2_attn_gpu7&#45;&gt;l2_out_gpu7 -->
<g id="edge131" class="edge">
<title>l2_attn_gpu7&#45;&gt;l2_out_gpu7</title>
<path fill="none" stroke="black" d="M7095.25,-1347.75C7095.25,-1347.75 7095.25,-1286.38 7095.25,-1286.38"/>
<polygon fill="black" stroke="black" points="7098.75,-1286.38 7095.25,-1276.38 7091.75,-1286.38 7098.75,-1286.38"/>
</g>
<!-- l2_out_gpu7&#45;&gt;l2_attn_all_reduce -->
<g id="edge132" class="edge">
<title>l2_out_gpu7&#45;&gt;l2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7146.21,-1207.62C7146.21,-1207.62 7146.21,-1078.06 7146.21,-1078.06"/>
<polygon fill="black" stroke="black" points="7149.71,-1078.06 7146.21,-1068.06 7142.71,-1078.06 7149.71,-1078.06"/>
</g>
<!-- l2_attn_to_moe -->
<g id="node158" class="node">
<title>l2_attn_to_moe</title>
<polygon fill="gray" stroke="black" points="8607.47,-1764 8259.93,-1764 8170.53,-1628 8518.07,-1628 8607.47,-1764"/>
<text text-anchor="middle" x="8389" y="-1714.8" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="8389" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="8389" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="8389" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- l2_attn_res&#45;&gt;l2_attn_to_moe -->
<g id="edge237" class="edge">
<title>l2_attn_res&#45;&gt;l2_attn_to_moe</title>
<path fill="none" stroke="black" d="M8147.39,-871C8320.28,-871 8567.56,-871 8567.56,-871 8567.56,-871 8567.56,-1685.85 8567.56,-1685.85"/>
<polygon fill="black" stroke="black" points="8564.06,-1685.85 8567.56,-1695.85 8571.06,-1685.85 8564.06,-1685.85"/>
</g>
<!-- l2_moe_gate -->
<g id="node104" class="node">
<title>l2_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="5525.5,-1730 5334.5,-1730 5334.5,-1662 5525.5,-1662 5525.5,-1730"/>
<text text-anchor="middle" x="5430" y="-1714.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5430" y="-1699.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5430" y="-1684.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="5430" y="-1669.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_exp_gpu8 -->
<g id="node105" class="node">
<title>l2_exp_gpu8</title>
<polygon fill="lightpink" stroke="black" points="5053.5,-1556 4850.5,-1556 4850.5,-1488 5053.5,-1488 5053.5,-1556"/>
<text text-anchor="middle" x="4952" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 0,1</text>
<text text-anchor="middle" x="4952" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4952" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4952" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu8 -->
<g id="edge134" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5334.33,-1689C5186.19,-1689 4918.17,-1689 4918.17,-1689 4918.17,-1689 4918.17,-1566.2 4918.17,-1566.2"/>
<polygon fill="black" stroke="black" points="4921.67,-1566.2 4918.17,-1556.2 4914.67,-1566.2 4921.67,-1566.2"/>
</g>
<!-- l2_exp_gpu9 -->
<g id="node106" class="node">
<title>l2_exp_gpu9</title>
<polygon fill="lightpink" stroke="black" points="5292.5,-1556 5089.5,-1556 5089.5,-1488 5292.5,-1488 5292.5,-1556"/>
<text text-anchor="middle" x="5191" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 2,3</text>
<text text-anchor="middle" x="5191" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5191" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5191" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu9 -->
<g id="edge135" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5334.19,-1675C5255.58,-1675 5157.17,-1675 5157.17,-1675 5157.17,-1675 5157.17,-1566.34 5157.17,-1566.34"/>
<polygon fill="black" stroke="black" points="5160.67,-1566.34 5157.17,-1556.34 5153.67,-1566.34 5160.67,-1566.34"/>
</g>
<!-- l2_exp_gpu10 -->
<g id="node107" class="node">
<title>l2_exp_gpu10</title>
<polygon fill="lightpink" stroke="black" points="5531.5,-1556 5328.5,-1556 5328.5,-1488 5531.5,-1488 5531.5,-1556"/>
<text text-anchor="middle" x="5430" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 4,5</text>
<text text-anchor="middle" x="5430" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5430" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5430" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu10 -->
<g id="edge136" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5398.17,-1661.62C5398.17,-1661.62 5398.17,-1566.01 5398.17,-1566.01"/>
<polygon fill="black" stroke="black" points="5401.67,-1566.01 5398.17,-1556.01 5394.67,-1566.01 5401.67,-1566.01"/>
</g>
<!-- l2_exp_gpu11 -->
<g id="node108" class="node">
<title>l2_exp_gpu11</title>
<polygon fill="lightpink" stroke="black" points="5770.5,-1556 5567.5,-1556 5567.5,-1488 5770.5,-1488 5770.5,-1556"/>
<text text-anchor="middle" x="5669" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 6,7</text>
<text text-anchor="middle" x="5669" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5669" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5669" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu11 -->
<g id="edge137" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5525.68,-1679C5579.16,-1679 5635.17,-1679 5635.17,-1679 5635.17,-1679 5635.17,-1566.07 5635.17,-1566.07"/>
<polygon fill="black" stroke="black" points="5638.67,-1566.07 5635.17,-1556.07 5631.67,-1566.07 5638.67,-1566.07"/>
</g>
<!-- l2_exp_gpu12 -->
<g id="node109" class="node">
<title>l2_exp_gpu12</title>
<polygon fill="lightpink" stroke="black" points="6009.5,-1556 5806.5,-1556 5806.5,-1488 6009.5,-1488 6009.5,-1556"/>
<text text-anchor="middle" x="5908" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 8,9</text>
<text text-anchor="middle" x="5908" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5908" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5908" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu12 -->
<g id="edge138" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5525.56,-1696C5656.1,-1696 5874.17,-1696 5874.17,-1696 5874.17,-1696 5874.17,-1566.38 5874.17,-1566.38"/>
<polygon fill="black" stroke="black" points="5877.67,-1566.38 5874.17,-1556.38 5870.67,-1566.38 5877.67,-1566.38"/>
</g>
<!-- l2_exp_gpu13 -->
<g id="node110" class="node">
<title>l2_exp_gpu13</title>
<polygon fill="lightpink" stroke="black" points="6248.5,-1556 6045.5,-1556 6045.5,-1488 6248.5,-1488 6248.5,-1556"/>
<text text-anchor="middle" x="6147" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 10,11</text>
<text text-anchor="middle" x="6147" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6147" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6147" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu13 -->
<g id="edge139" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5525.71,-1713C5713.73,-1713 6113.17,-1713 6113.17,-1713 6113.17,-1713 6113.17,-1566.15 6113.17,-1566.15"/>
<polygon fill="black" stroke="black" points="6116.67,-1566.15 6113.17,-1556.15 6109.67,-1566.15 6116.67,-1566.15"/>
</g>
<!-- l2_exp_gpu14 -->
<g id="node111" class="node">
<title>l2_exp_gpu14</title>
<polygon fill="lightpink" stroke="black" points="4575.5,-1556 4372.5,-1556 4372.5,-1488 4575.5,-1488 4575.5,-1556"/>
<text text-anchor="middle" x="4474" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 12,13</text>
<text text-anchor="middle" x="4474" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4474" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4474" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu14 -->
<g id="edge140" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5334.19,-1716C5085.78,-1716 4440.17,-1716 4440.17,-1716 4440.17,-1716 4440.17,-1566.24 4440.17,-1566.24"/>
<polygon fill="black" stroke="black" points="4443.67,-1566.24 4440.17,-1556.24 4436.67,-1566.24 4443.67,-1566.24"/>
</g>
<!-- l2_exp_gpu15 -->
<g id="node112" class="node">
<title>l2_exp_gpu15</title>
<polygon fill="lightpink" stroke="black" points="4814.5,-1556 4611.5,-1556 4611.5,-1488 4814.5,-1488 4814.5,-1556"/>
<text text-anchor="middle" x="4713" y="-1540.8" font-family="Times,serif" font-size="14.00">Experts 14,15</text>
<text text-anchor="middle" x="4713" y="-1525.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4713" y="-1510.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4713" y="-1495.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp_gpu15 -->
<g id="edge141" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5334.14,-1702C5131.73,-1702 4679.17,-1702 4679.17,-1702 4679.17,-1702 4679.17,-1566.28 4679.17,-1566.28"/>
<polygon fill="black" stroke="black" points="4682.67,-1566.28 4679.17,-1556.28 4675.67,-1566.28 4682.67,-1566.28"/>
</g>
<!-- l2_moe_agg -->
<g id="node113" class="node">
<title>l2_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="5416,-1416 5204,-1416 5204,-1348 5416,-1348 5416,-1416"/>
<text text-anchor="middle" x="5310" y="-1400.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5310" y="-1385.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—2</text>
<text text-anchor="middle" x="5310" y="-1370.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5310" y="-1355.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_exp_gpu8&#45;&gt;l2_moe_agg -->
<g id="edge142" class="edge">
<title>l2_exp_gpu8&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M4952,-1487.74C4952,-1451.34 4952,-1399 4952,-1399 4952,-1399 5193.56,-1399 5193.56,-1399"/>
<polygon fill="black" stroke="black" points="5193.56,-1402.5 5203.56,-1399 5193.56,-1395.5 5193.56,-1402.5"/>
</g>
<!-- l2_exp_gpu9&#45;&gt;l2_moe_agg -->
<g id="edge143" class="edge">
<title>l2_exp_gpu9&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M5248.25,-1487.75C5248.25,-1487.75 5248.25,-1426.38 5248.25,-1426.38"/>
<polygon fill="black" stroke="black" points="5251.75,-1426.38 5248.25,-1416.38 5244.75,-1426.38 5251.75,-1426.38"/>
</g>
<!-- l2_exp_gpu10&#45;&gt;l2_moe_agg -->
<g id="edge144" class="edge">
<title>l2_exp_gpu10&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M5372.25,-1487.75C5372.25,-1487.75 5372.25,-1426.38 5372.25,-1426.38"/>
<polygon fill="black" stroke="black" points="5375.75,-1426.38 5372.25,-1416.38 5368.75,-1426.38 5375.75,-1426.38"/>
</g>
<!-- l2_exp_gpu11&#45;&gt;l2_moe_agg -->
<g id="edge145" class="edge">
<title>l2_exp_gpu11&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M5669,-1487.74C5669,-1451.34 5669,-1399 5669,-1399 5669,-1399 5426.25,-1399 5426.25,-1399"/>
<polygon fill="black" stroke="black" points="5426.25,-1395.5 5416.25,-1399 5426.25,-1402.5 5426.25,-1395.5"/>
</g>
<!-- l2_exp_gpu12&#45;&gt;l2_moe_agg -->
<g id="edge146" class="edge">
<title>l2_exp_gpu12&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M5908,-1487.75C5908,-1446.31 5908,-1382 5908,-1382 5908,-1382 5426.22,-1382 5426.22,-1382"/>
<polygon fill="black" stroke="black" points="5426.22,-1378.5 5416.22,-1382 5426.22,-1385.5 5426.22,-1378.5"/>
</g>
<!-- l2_exp_gpu13&#45;&gt;l2_moe_agg -->
<g id="edge147" class="edge">
<title>l2_exp_gpu13&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M6147,-1487.93C6147,-1441.76 6147,-1365 6147,-1365 6147,-1365 5426.01,-1365 5426.01,-1365"/>
<polygon fill="black" stroke="black" points="5426.01,-1361.5 5416.01,-1365 5426.01,-1368.5 5426.01,-1361.5"/>
</g>
<!-- l2_exp_gpu14&#45;&gt;l2_moe_agg -->
<g id="edge148" class="edge">
<title>l2_exp_gpu14&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M4474,-1487.93C4474,-1441.76 4474,-1365 4474,-1365 4474,-1365 5193.7,-1365 5193.7,-1365"/>
<polygon fill="black" stroke="black" points="5193.7,-1368.5 5203.7,-1365 5193.7,-1361.5 5193.7,-1368.5"/>
</g>
<!-- l2_exp_gpu15&#45;&gt;l2_moe_agg -->
<g id="edge149" class="edge">
<title>l2_exp_gpu15&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M4713,-1487.75C4713,-1446.31 4713,-1382 4713,-1382 4713,-1382 5193.96,-1382 5193.96,-1382"/>
<polygon fill="black" stroke="black" points="5193.96,-1385.5 5203.96,-1382 5193.96,-1378.5 5193.96,-1385.5"/>
</g>
<!-- l2_moe_res -->
<g id="node114" class="node">
<title>l2_moe_res</title>
<polygon fill="orange" stroke="black" points="5474,-1276 5146,-1276 5146,-1208 5474,-1208 5474,-1276"/>
<text text-anchor="middle" x="5310" y="-1260.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5310" y="-1245.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="5310" y="-1230.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5310" y="-1215.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_moe_agg&#45;&gt;l2_moe_res -->
<g id="edge150" class="edge">
<title>l2_moe_agg&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M5310,-1347.75C5310,-1347.75 5310,-1286.38 5310,-1286.38"/>
<polygon fill="black" stroke="black" points="5313.5,-1286.38 5310,-1276.38 5306.5,-1286.38 5313.5,-1286.38"/>
</g>
<!-- prev_layer_2 -->
<g id="node159" class="node">
<title>prev_layer_2</title>
<polygon fill="lightblue" stroke="black" points="4349.5,-1086 4242.5,-1086 4242.5,-1050 4349.5,-1050 4349.5,-1086"/>
<text text-anchor="middle" x="4296" y="-1064.3" font-family="Times,serif" font-size="14.00">prev_layer_2</text>
</g>
<!-- l2_moe_res&#45;&gt;prev_layer_2 -->
<g id="edge238" class="edge">
<title>l2_moe_res&#45;&gt;prev_layer_2</title>
<path fill="none" stroke="black" d="M5145.96,-1242C4858.97,-1242 4296,-1242 4296,-1242 4296,-1242 4296,-1096.29 4296,-1096.29"/>
<polygon fill="black" stroke="black" points="4299.5,-1096.29 4296,-1086.29 4292.5,-1096.29 4299.5,-1096.29"/>
</g>
<!-- l3_qkv_all_gather -->
<g id="node115" class="node">
<title>l3_qkv_all_gather</title>
<polygon fill="lightcyan" stroke="black" points="1321.55,-928 938.89,-928 840.45,-792 1223.11,-792 1321.55,-928"/>
<text text-anchor="middle" x="1081" y="-878.8" font-family="Times,serif" font-size="14.00">All&#45;Gather QKV</text>
<text text-anchor="middle" x="1081" y="-863.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1081" y="-848.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="1081" y="-833.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l3_qkv_gpu0 -->
<g id="node116" class="node">
<title>l3_qkv_gpu0</title>
<polygon fill="yellow" stroke="black" points="1178,-720 984,-720 984,-652 1178,-652 1178,-720"/>
<text text-anchor="middle" x="1081" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU0</text>
<text text-anchor="middle" x="1081" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1081" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1081" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu0 -->
<g id="edge151" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1081,-791.73C1081,-791.73 1081,-730.11 1081,-730.11"/>
<polygon fill="black" stroke="black" points="1084.5,-730.11 1081,-720.11 1077.5,-730.11 1084.5,-730.11"/>
</g>
<!-- l3_qkv_gpu1 -->
<g id="node117" class="node">
<title>l3_qkv_gpu1</title>
<polygon fill="yellow" stroke="black" points="1410,-720 1216,-720 1216,-652 1410,-652 1410,-720"/>
<text text-anchor="middle" x="1313" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU1</text>
<text text-anchor="middle" x="1313" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1313" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1313" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu1 -->
<g id="edge152" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1268.76,-854.98C1268.76,-854.98 1268.76,-730.19 1268.76,-730.19"/>
<polygon fill="black" stroke="black" points="1272.26,-730.19 1268.76,-720.19 1265.26,-730.19 1272.26,-730.19"/>
</g>
<!-- l3_qkv_gpu2 -->
<g id="node118" class="node">
<title>l3_qkv_gpu2</title>
<polygon fill="yellow" stroke="black" points="1641,-720 1447,-720 1447,-652 1641,-652 1641,-720"/>
<text text-anchor="middle" x="1544" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU2</text>
<text text-anchor="middle" x="1544" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1544" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1544" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu2 -->
<g id="edge153" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1226.86,-797C1362.57,-797 1544,-797 1544,-797 1544,-797 1544,-730.21 1544,-730.21"/>
<polygon fill="black" stroke="black" points="1547.5,-730.21 1544,-720.21 1540.5,-730.21 1547.5,-730.21"/>
</g>
<!-- l3_qkv_gpu3 -->
<g id="node119" class="node">
<title>l3_qkv_gpu3</title>
<polygon fill="yellow" stroke="black" points="1872,-720 1678,-720 1678,-652 1872,-652 1872,-720"/>
<text text-anchor="middle" x="1775" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU3</text>
<text text-anchor="middle" x="1775" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1775" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1775" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu3 -->
<g id="edge154" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1231.16,-803C1435.22,-803 1775,-803 1775,-803 1775,-803 1775,-730.16 1775,-730.16"/>
<polygon fill="black" stroke="black" points="1778.5,-730.16 1775,-720.16 1771.5,-730.16 1778.5,-730.16"/>
</g>
<!-- l3_qkv_gpu4 -->
<g id="node120" class="node">
<title>l3_qkv_gpu4</title>
<polygon fill="yellow" stroke="black" points="241,-720 47,-720 47,-652 241,-652 241,-720"/>
<text text-anchor="middle" x="144" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU4</text>
<text text-anchor="middle" x="144" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="144" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="144" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu4 -->
<g id="edge155" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M914.02,-894C644.64,-894 144,-894 144,-894 144,-894 144,-730.35 144,-730.35"/>
<polygon fill="black" stroke="black" points="147.5,-730.35 144,-720.35 140.5,-730.35 147.5,-730.35"/>
</g>
<!-- l3_qkv_gpu5 -->
<g id="node121" class="node">
<title>l3_qkv_gpu5</title>
<polygon fill="yellow" stroke="black" points="488,-720 294,-720 294,-652 488,-652 488,-720"/>
<text text-anchor="middle" x="391" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU5</text>
<text text-anchor="middle" x="391" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="391" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="391" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu5 -->
<g id="edge156" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M889.25,-860C685.07,-860 391,-860 391,-860 391,-860 391,-730.38 391,-730.38"/>
<polygon fill="black" stroke="black" points="394.5,-730.38 391,-720.38 387.5,-730.38 394.5,-730.38"/>
</g>
<!-- l3_qkv_gpu6 -->
<g id="node122" class="node">
<title>l3_qkv_gpu6</title>
<polygon fill="yellow" stroke="black" points="718,-720 524,-720 524,-652 718,-652 718,-720"/>
<text text-anchor="middle" x="621" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU6</text>
<text text-anchor="middle" x="621" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="621" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="621" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu6 -->
<g id="edge157" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M864.81,-826C745.39,-826 621,-826 621,-826 621,-826 621,-730.25 621,-730.25"/>
<polygon fill="black" stroke="black" points="624.5,-730.25 621,-720.25 617.5,-730.25 624.5,-730.25"/>
</g>
<!-- l3_qkv_gpu7 -->
<g id="node123" class="node">
<title>l3_qkv_gpu7</title>
<polygon fill="yellow" stroke="black" points="948,-720 754,-720 754,-652 948,-652 948,-720"/>
<text text-anchor="middle" x="851" y="-704.8" font-family="Times,serif" font-size="14.00">QKV Projection GPU7</text>
<text text-anchor="middle" x="851" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="851" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="851" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l3_qkv_all_gather&#45;&gt;l3_qkv_gpu7 -->
<g id="edge158" class="edge">
<title>l3_qkv_all_gather&#45;&gt;l3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M894.24,-791.73C894.24,-791.73 894.24,-730.11 894.24,-730.11"/>
<polygon fill="black" stroke="black" points="897.74,-730.11 894.24,-720.11 890.74,-730.11 897.74,-730.11"/>
</g>
<!-- l3_attn_gpu0 -->
<g id="node124" class="node">
<title>l3_attn_gpu0</title>
<polygon fill="yellow" stroke="black" points="1178,-580 984,-580 984,-512 1178,-512 1178,-580"/>
<text text-anchor="middle" x="1081" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU0</text>
<text text-anchor="middle" x="1081" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1081" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1081" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l3_qkv_gpu0&#45;&gt;l3_attn_gpu0 -->
<g id="edge159" class="edge">
<title>l3_qkv_gpu0&#45;&gt;l3_attn_gpu0</title>
<path fill="none" stroke="black" d="M1081,-651.75C1081,-651.75 1081,-590.38 1081,-590.38"/>
<polygon fill="black" stroke="black" points="1084.5,-590.38 1081,-580.38 1077.5,-590.38 1084.5,-590.38"/>
</g>
<!-- l3_attn_gpu1 -->
<g id="node127" class="node">
<title>l3_attn_gpu1</title>
<polygon fill="yellow" stroke="black" points="1412,-580 1218,-580 1218,-512 1412,-512 1412,-580"/>
<text text-anchor="middle" x="1315" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU1</text>
<text text-anchor="middle" x="1315" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1315" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1315" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l3_qkv_gpu1&#45;&gt;l3_attn_gpu1 -->
<g id="edge162" class="edge">
<title>l3_qkv_gpu1&#45;&gt;l3_attn_gpu1</title>
<path fill="none" stroke="black" d="M1314,-651.75C1314,-651.75 1314,-590.38 1314,-590.38"/>
<polygon fill="black" stroke="black" points="1317.5,-590.38 1314,-580.38 1310.5,-590.38 1317.5,-590.38"/>
</g>
<!-- l3_attn_gpu2 -->
<g id="node129" class="node">
<title>l3_attn_gpu2</title>
<polygon fill="yellow" stroke="black" points="1645,-580 1451,-580 1451,-512 1645,-512 1645,-580"/>
<text text-anchor="middle" x="1548" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU2</text>
<text text-anchor="middle" x="1548" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1548" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1548" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l3_qkv_gpu2&#45;&gt;l3_attn_gpu2 -->
<g id="edge165" class="edge">
<title>l3_qkv_gpu2&#45;&gt;l3_attn_gpu2</title>
<path fill="none" stroke="black" d="M1546,-651.75C1546,-651.75 1546,-590.38 1546,-590.38"/>
<polygon fill="black" stroke="black" points="1549.5,-590.38 1546,-580.38 1542.5,-590.38 1549.5,-590.38"/>
</g>
<!-- l3_attn_gpu3 -->
<g id="node131" class="node">
<title>l3_attn_gpu3</title>
<polygon fill="yellow" stroke="black" points="1876,-580 1682,-580 1682,-512 1876,-512 1876,-580"/>
<text text-anchor="middle" x="1779" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU3</text>
<text text-anchor="middle" x="1779" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1779" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1779" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l3_qkv_gpu3&#45;&gt;l3_attn_gpu3 -->
<g id="edge168" class="edge">
<title>l3_qkv_gpu3&#45;&gt;l3_attn_gpu3</title>
<path fill="none" stroke="black" d="M1777,-651.75C1777,-651.75 1777,-590.38 1777,-590.38"/>
<polygon fill="black" stroke="black" points="1780.5,-590.38 1777,-580.38 1773.5,-590.38 1780.5,-590.38"/>
</g>
<!-- l3_attn_gpu4 -->
<g id="node133" class="node">
<title>l3_attn_gpu4</title>
<polygon fill="yellow" stroke="black" points="225,-580 31,-580 31,-512 225,-512 225,-580"/>
<text text-anchor="middle" x="128" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU4</text>
<text text-anchor="middle" x="128" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="128" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="128" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l3_qkv_gpu4&#45;&gt;l3_attn_gpu4 -->
<g id="edge171" class="edge">
<title>l3_qkv_gpu4&#45;&gt;l3_attn_gpu4</title>
<path fill="none" stroke="black" d="M136,-651.75C136,-651.75 136,-590.38 136,-590.38"/>
<polygon fill="black" stroke="black" points="139.5,-590.38 136,-580.38 132.5,-590.38 139.5,-590.38"/>
</g>
<!-- l3_attn_gpu5 -->
<g id="node135" class="node">
<title>l3_attn_gpu5</title>
<polygon fill="yellow" stroke="black" points="473,-580 279,-580 279,-512 473,-512 473,-580"/>
<text text-anchor="middle" x="376" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU5</text>
<text text-anchor="middle" x="376" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="376" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="376" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l3_qkv_gpu5&#45;&gt;l3_attn_gpu5 -->
<g id="edge174" class="edge">
<title>l3_qkv_gpu5&#45;&gt;l3_attn_gpu5</title>
<path fill="none" stroke="black" d="M383.5,-651.75C383.5,-651.75 383.5,-590.38 383.5,-590.38"/>
<polygon fill="black" stroke="black" points="387,-590.38 383.5,-580.38 380,-590.38 387,-590.38"/>
</g>
<!-- l3_attn_gpu6 -->
<g id="node137" class="node">
<title>l3_attn_gpu6</title>
<polygon fill="yellow" stroke="black" points="712,-580 518,-580 518,-512 712,-512 712,-580"/>
<text text-anchor="middle" x="615" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU6</text>
<text text-anchor="middle" x="615" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="615" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="615" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l3_qkv_gpu6&#45;&gt;l3_attn_gpu6 -->
<g id="edge177" class="edge">
<title>l3_qkv_gpu6&#45;&gt;l3_attn_gpu6</title>
<path fill="none" stroke="black" d="M618,-651.75C618,-651.75 618,-590.38 618,-590.38"/>
<polygon fill="black" stroke="black" points="621.5,-590.38 618,-580.38 614.5,-590.38 621.5,-590.38"/>
</g>
<!-- l3_attn_gpu7 -->
<g id="node139" class="node">
<title>l3_attn_gpu7</title>
<polygon fill="yellow" stroke="black" points="946,-580 752,-580 752,-512 946,-512 946,-580"/>
<text text-anchor="middle" x="849" y="-564.8" font-family="Times,serif" font-size="14.00">Attention Heads GPU7</text>
<text text-anchor="middle" x="849" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="849" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="849" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l3_qkv_gpu7&#45;&gt;l3_attn_gpu7 -->
<g id="edge180" class="edge">
<title>l3_qkv_gpu7&#45;&gt;l3_attn_gpu7</title>
<path fill="none" stroke="black" d="M850,-651.75C850,-651.75 850,-590.38 850,-590.38"/>
<polygon fill="black" stroke="black" points="853.5,-590.38 850,-580.38 846.5,-590.38 853.5,-590.38"/>
</g>
<!-- l3_out_gpu0 -->
<g id="node125" class="node">
<title>l3_out_gpu0</title>
<polygon fill="yellow" stroke="black" points="1182.5,-440 979.5,-440 979.5,-372 1182.5,-372 1182.5,-440"/>
<text text-anchor="middle" x="1081" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU0</text>
<text text-anchor="middle" x="1081" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1081" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1081" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l3_attn_gpu0&#45;&gt;l3_out_gpu0 -->
<g id="edge160" class="edge">
<title>l3_attn_gpu0&#45;&gt;l3_out_gpu0</title>
<path fill="none" stroke="black" d="M1081,-511.75C1081,-511.75 1081,-450.38 1081,-450.38"/>
<polygon fill="black" stroke="black" points="1084.5,-450.38 1081,-440.38 1077.5,-450.38 1084.5,-450.38"/>
</g>
<!-- l3_attn_all_reduce -->
<g id="node126" class="node">
<title>l3_attn_all_reduce</title>
<polygon fill="lightcyan" stroke="black" points="1309.17,-300 946.2,-300 852.83,-164 1215.8,-164 1309.17,-300"/>
<text text-anchor="middle" x="1081" y="-250.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1081" y="-235.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="1081" y="-220.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1081" y="-205.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l3_out_gpu0&#45;&gt;l3_attn_all_reduce -->
<g id="edge161" class="edge">
<title>l3_out_gpu0&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M1081,-371.62C1081,-371.62 1081,-310.14 1081,-310.14"/>
<polygon fill="black" stroke="black" points="1084.5,-310.14 1081,-300.14 1077.5,-310.14 1084.5,-310.14"/>
</g>
<!-- l3_attn_res -->
<g id="node141" class="node">
<title>l3_attn_res</title>
<polygon fill="orange" stroke="black" points="1899,-92 1571,-92 1571,-24 1899,-24 1899,-92"/>
<text text-anchor="middle" x="1735" y="-76.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1735" y="-61.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="1735" y="-46.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1735" y="-31.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l3_attn_all_reduce&#45;&gt;l3_attn_res -->
<g id="edge183" class="edge">
<title>l3_attn_all_reduce&#45;&gt;l3_attn_res</title>
<path fill="none" stroke="black" d="M1222.2,-173C1380.63,-173 1615.75,-173 1615.75,-173 1615.75,-173 1615.75,-102.19 1615.75,-102.19"/>
<polygon fill="black" stroke="black" points="1619.25,-102.19 1615.75,-92.19 1612.25,-102.19 1619.25,-102.19"/>
</g>
<!-- l3_out_gpu1 -->
<g id="node128" class="node">
<title>l3_out_gpu1</title>
<polygon fill="yellow" stroke="black" points="1421.5,-440 1218.5,-440 1218.5,-372 1421.5,-372 1421.5,-440"/>
<text text-anchor="middle" x="1320" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU1</text>
<text text-anchor="middle" x="1320" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1320" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1320" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l3_attn_gpu1&#45;&gt;l3_out_gpu1 -->
<g id="edge163" class="edge">
<title>l3_attn_gpu1&#45;&gt;l3_out_gpu1</title>
<path fill="none" stroke="black" d="M1315.25,-511.75C1315.25,-511.75 1315.25,-450.38 1315.25,-450.38"/>
<polygon fill="black" stroke="black" points="1318.75,-450.38 1315.25,-440.38 1311.75,-450.38 1318.75,-450.38"/>
</g>
<!-- l3_out_gpu1&#45;&gt;l3_attn_all_reduce -->
<g id="edge164" class="edge">
<title>l3_out_gpu1&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M1263.79,-371.62C1263.79,-371.62 1263.79,-310.14 1263.79,-310.14"/>
<polygon fill="black" stroke="black" points="1267.29,-310.14 1263.79,-300.14 1260.29,-310.14 1267.29,-310.14"/>
</g>
<!-- l3_out_gpu2 -->
<g id="node130" class="node">
<title>l3_out_gpu2</title>
<polygon fill="yellow" stroke="black" points="1660.5,-440 1457.5,-440 1457.5,-372 1660.5,-372 1660.5,-440"/>
<text text-anchor="middle" x="1559" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU2</text>
<text text-anchor="middle" x="1559" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1559" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1559" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l3_attn_gpu2&#45;&gt;l3_out_gpu2 -->
<g id="edge166" class="edge">
<title>l3_attn_gpu2&#45;&gt;l3_out_gpu2</title>
<path fill="none" stroke="black" d="M1551.25,-511.75C1551.25,-511.75 1551.25,-450.38 1551.25,-450.38"/>
<polygon fill="black" stroke="black" points="1554.75,-450.38 1551.25,-440.38 1547.75,-450.38 1554.75,-450.38"/>
</g>
<!-- l3_out_gpu2&#45;&gt;l3_attn_all_reduce -->
<g id="edge167" class="edge">
<title>l3_out_gpu2&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M1514.25,-371.79C1514.25,-338.53 1514.25,-293 1514.25,-293 1514.25,-293 1314.61,-293 1314.61,-293"/>
<polygon fill="black" stroke="black" points="1314.61,-289.5 1304.61,-293 1314.6,-296.5 1314.61,-289.5"/>
</g>
<!-- l3_out_gpu3 -->
<g id="node132" class="node">
<title>l3_out_gpu3</title>
<polygon fill="yellow" stroke="black" points="1899.5,-440 1696.5,-440 1696.5,-372 1899.5,-372 1899.5,-440"/>
<text text-anchor="middle" x="1798" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU3</text>
<text text-anchor="middle" x="1798" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1798" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1798" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l3_attn_gpu3&#45;&gt;l3_out_gpu3 -->
<g id="edge169" class="edge">
<title>l3_attn_gpu3&#45;&gt;l3_out_gpu3</title>
<path fill="none" stroke="black" d="M1786.25,-511.75C1786.25,-511.75 1786.25,-450.38 1786.25,-450.38"/>
<polygon fill="black" stroke="black" points="1789.75,-450.38 1786.25,-440.38 1782.75,-450.38 1789.75,-450.38"/>
</g>
<!-- l3_out_gpu3&#45;&gt;l3_attn_all_reduce -->
<g id="edge170" class="edge">
<title>l3_out_gpu3&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M1797.75,-371.93C1797.75,-336.46 1797.75,-286 1797.75,-286 1797.75,-286 1309.94,-286 1309.94,-286"/>
<polygon fill="black" stroke="black" points="1309.94,-282.5 1299.94,-286 1309.94,-289.5 1309.94,-282.5"/>
</g>
<!-- l3_out_gpu4 -->
<g id="node134" class="node">
<title>l3_out_gpu4</title>
<polygon fill="yellow" stroke="black" points="226.5,-440 23.5,-440 23.5,-372 226.5,-372 226.5,-440"/>
<text text-anchor="middle" x="125" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU4</text>
<text text-anchor="middle" x="125" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="125" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l3_attn_gpu4&#45;&gt;l3_out_gpu4 -->
<g id="edge172" class="edge">
<title>l3_attn_gpu4&#45;&gt;l3_out_gpu4</title>
<path fill="none" stroke="black" d="M128,-511.75C128,-511.75 128,-450.38 128,-450.38"/>
<polygon fill="black" stroke="black" points="131.5,-450.38 128,-440.38 124.5,-450.38 131.5,-450.38"/>
</g>
<!-- l3_out_gpu4&#45;&gt;l3_attn_all_reduce -->
<g id="edge173" class="edge">
<title>l3_out_gpu4&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M125,-371.65C125,-312.58 125,-198 125,-198 125,-198 865.91,-198 865.91,-198"/>
<polygon fill="black" stroke="black" points="865.91,-201.5 875.91,-198 865.91,-194.5 865.91,-201.5"/>
</g>
<!-- l3_out_gpu5 -->
<g id="node136" class="node">
<title>l3_out_gpu5</title>
<polygon fill="yellow" stroke="black" points="465.5,-440 262.5,-440 262.5,-372 465.5,-372 465.5,-440"/>
<text text-anchor="middle" x="364" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU5</text>
<text text-anchor="middle" x="364" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="364" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="364" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l3_attn_gpu5&#45;&gt;l3_out_gpu5 -->
<g id="edge175" class="edge">
<title>l3_attn_gpu5&#45;&gt;l3_out_gpu5</title>
<path fill="none" stroke="black" d="M372.25,-511.75C372.25,-511.75 372.25,-450.38 372.25,-450.38"/>
<polygon fill="black" stroke="black" points="375.75,-450.38 372.25,-440.38 368.75,-450.38 375.75,-450.38"/>
</g>
<!-- l3_out_gpu5&#45;&gt;l3_attn_all_reduce -->
<g id="edge176" class="edge">
<title>l3_out_gpu5&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M364,-371.62C364,-320.91 364,-232 364,-232 364,-232 889.14,-232 889.14,-232"/>
<polygon fill="black" stroke="black" points="889.14,-235.5 899.14,-232 889.14,-228.5 889.14,-235.5"/>
</g>
<!-- l3_out_gpu6 -->
<g id="node138" class="node">
<title>l3_out_gpu6</title>
<polygon fill="yellow" stroke="black" points="704.5,-440 501.5,-440 501.5,-372 704.5,-372 704.5,-440"/>
<text text-anchor="middle" x="603" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU6</text>
<text text-anchor="middle" x="603" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="603" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l3_attn_gpu6&#45;&gt;l3_out_gpu6 -->
<g id="edge178" class="edge">
<title>l3_attn_gpu6&#45;&gt;l3_out_gpu6</title>
<path fill="none" stroke="black" d="M611.25,-511.75C611.25,-511.75 611.25,-450.38 611.25,-450.38"/>
<polygon fill="black" stroke="black" points="614.75,-450.38 611.25,-440.38 607.75,-450.38 614.75,-450.38"/>
</g>
<!-- l3_out_gpu6&#45;&gt;l3_attn_all_reduce -->
<g id="edge179" class="edge">
<title>l3_out_gpu6&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M603,-371.75C603,-330.31 603,-266 603,-266 603,-266 912.83,-266 912.83,-266"/>
<polygon fill="black" stroke="black" points="912.83,-269.5 922.83,-266 912.83,-262.5 912.83,-269.5"/>
</g>
<!-- l3_out_gpu7 -->
<g id="node140" class="node">
<title>l3_out_gpu7</title>
<polygon fill="yellow" stroke="black" points="943.5,-440 740.5,-440 740.5,-372 943.5,-372 943.5,-440"/>
<text text-anchor="middle" x="842" y="-424.8" font-family="Times,serif" font-size="14.00">Output Projection GPU7</text>
<text text-anchor="middle" x="842" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="842" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="842" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l3_attn_gpu7&#45;&gt;l3_out_gpu7 -->
<g id="edge181" class="edge">
<title>l3_attn_gpu7&#45;&gt;l3_out_gpu7</title>
<path fill="none" stroke="black" d="M847.75,-511.75C847.75,-511.75 847.75,-450.38 847.75,-450.38"/>
<polygon fill="black" stroke="black" points="851.25,-450.38 847.75,-440.38 844.25,-450.38 851.25,-450.38"/>
</g>
<!-- l3_out_gpu7&#45;&gt;l3_attn_all_reduce -->
<g id="edge182" class="edge">
<title>l3_out_gpu7&#45;&gt;l3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M898.21,-371.62C898.21,-371.62 898.21,-242.06 898.21,-242.06"/>
<polygon fill="black" stroke="black" points="901.71,-242.06 898.21,-232.06 894.71,-242.06 901.71,-242.06"/>
</g>
<!-- l3_attn_to_moe -->
<g id="node160" class="node">
<title>l3_attn_to_moe</title>
<polygon fill="gray" stroke="black" points="4258.47,-928 3910.93,-928 3821.53,-792 4169.07,-792 4258.47,-928"/>
<text text-anchor="middle" x="4040" y="-878.8" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="4040" y="-863.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4040" y="-848.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4040" y="-833.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- l3_attn_res&#45;&gt;l3_attn_to_moe -->
<g id="edge249" class="edge">
<title>l3_attn_res&#45;&gt;l3_attn_to_moe</title>
<path fill="none" stroke="black" d="M1669.25,-92.36C1669.25,-241.21 1669.25,-823 1669.25,-823 1669.25,-823 3831.7,-823 3831.7,-823"/>
<polygon fill="black" stroke="black" points="3831.7,-826.5 3841.7,-823 3831.7,-819.5 3831.7,-826.5"/>
</g>
<!-- l3_moe_gate -->
<g id="node142" class="node">
<title>l3_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="3075.5,-894 2884.5,-894 2884.5,-826 3075.5,-826 3075.5,-894"/>
<text text-anchor="middle" x="2980" y="-878.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2980" y="-863.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2980" y="-848.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="2980" y="-833.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_exp_gpu8 -->
<g id="node143" class="node">
<title>l3_exp_gpu8</title>
<polygon fill="lightpink" stroke="black" points="2603.5,-720 2400.5,-720 2400.5,-652 2603.5,-652 2603.5,-720"/>
<text text-anchor="middle" x="2502" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 0,1</text>
<text text-anchor="middle" x="2502" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2502" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2502" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu8 -->
<g id="edge184" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2884.33,-853C2736.19,-853 2468.17,-853 2468.17,-853 2468.17,-853 2468.17,-730.2 2468.17,-730.2"/>
<polygon fill="black" stroke="black" points="2471.67,-730.2 2468.17,-720.2 2464.67,-730.2 2471.67,-730.2"/>
</g>
<!-- l3_exp_gpu9 -->
<g id="node144" class="node">
<title>l3_exp_gpu9</title>
<polygon fill="lightpink" stroke="black" points="2842.5,-720 2639.5,-720 2639.5,-652 2842.5,-652 2842.5,-720"/>
<text text-anchor="middle" x="2741" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 2,3</text>
<text text-anchor="middle" x="2741" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2741" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2741" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu9 -->
<g id="edge185" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2884.19,-839C2805.58,-839 2707.17,-839 2707.17,-839 2707.17,-839 2707.17,-730.34 2707.17,-730.34"/>
<polygon fill="black" stroke="black" points="2710.67,-730.34 2707.17,-720.34 2703.67,-730.34 2710.67,-730.34"/>
</g>
<!-- l3_exp_gpu10 -->
<g id="node145" class="node">
<title>l3_exp_gpu10</title>
<polygon fill="lightpink" stroke="black" points="3081.5,-720 2878.5,-720 2878.5,-652 3081.5,-652 3081.5,-720"/>
<text text-anchor="middle" x="2980" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 4,5</text>
<text text-anchor="middle" x="2980" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2980" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2980" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu10 -->
<g id="edge186" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2948.17,-825.62C2948.17,-825.62 2948.17,-730.01 2948.17,-730.01"/>
<polygon fill="black" stroke="black" points="2951.67,-730.01 2948.17,-720.01 2944.67,-730.01 2951.67,-730.01"/>
</g>
<!-- l3_exp_gpu11 -->
<g id="node146" class="node">
<title>l3_exp_gpu11</title>
<polygon fill="lightpink" stroke="black" points="3320.5,-720 3117.5,-720 3117.5,-652 3320.5,-652 3320.5,-720"/>
<text text-anchor="middle" x="3219" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 6,7</text>
<text text-anchor="middle" x="3219" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3219" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3219" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu11 -->
<g id="edge187" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3075.68,-839C3129.16,-839 3185.17,-839 3185.17,-839 3185.17,-839 3185.17,-730.34 3185.17,-730.34"/>
<polygon fill="black" stroke="black" points="3188.67,-730.34 3185.17,-720.34 3181.67,-730.34 3188.67,-730.34"/>
</g>
<!-- l3_exp_gpu12 -->
<g id="node147" class="node">
<title>l3_exp_gpu12</title>
<polygon fill="lightpink" stroke="black" points="3559.5,-720 3356.5,-720 3356.5,-652 3559.5,-652 3559.5,-720"/>
<text text-anchor="middle" x="3458" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 8,9</text>
<text text-anchor="middle" x="3458" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3458" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3458" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu12 -->
<g id="edge188" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3075.56,-853C3206.1,-853 3424.17,-853 3424.17,-853 3424.17,-853 3424.17,-730.2 3424.17,-730.2"/>
<polygon fill="black" stroke="black" points="3427.67,-730.2 3424.17,-720.2 3420.67,-730.2 3427.67,-730.2"/>
</g>
<!-- l3_exp_gpu13 -->
<g id="node148" class="node">
<title>l3_exp_gpu13</title>
<polygon fill="lightpink" stroke="black" points="3798.5,-720 3595.5,-720 3595.5,-652 3798.5,-652 3798.5,-720"/>
<text text-anchor="middle" x="3697" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 10,11</text>
<text text-anchor="middle" x="3697" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3697" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3697" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu13 -->
<g id="edge189" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3075.71,-866C3263.73,-866 3663.17,-866 3663.17,-866 3663.17,-866 3663.17,-730.28 3663.17,-730.28"/>
<polygon fill="black" stroke="black" points="3666.67,-730.28 3663.17,-720.28 3659.67,-730.28 3666.67,-730.28"/>
</g>
<!-- l3_exp_gpu14 -->
<g id="node149" class="node">
<title>l3_exp_gpu14</title>
<polygon fill="lightpink" stroke="black" points="2125.5,-720 1922.5,-720 1922.5,-652 2125.5,-652 2125.5,-720"/>
<text text-anchor="middle" x="2024" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 12,13</text>
<text text-anchor="middle" x="2024" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2024" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2024" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu14 -->
<g id="edge190" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2884.19,-880C2635.78,-880 1990.17,-880 1990.17,-880 1990.17,-880 1990.17,-730.24 1990.17,-730.24"/>
<polygon fill="black" stroke="black" points="1993.67,-730.24 1990.17,-720.24 1986.67,-730.24 1993.67,-730.24"/>
</g>
<!-- l3_exp_gpu15 -->
<g id="node150" class="node">
<title>l3_exp_gpu15</title>
<polygon fill="lightpink" stroke="black" points="2364.5,-720 2161.5,-720 2161.5,-652 2364.5,-652 2364.5,-720"/>
<text text-anchor="middle" x="2263" y="-704.8" font-family="Times,serif" font-size="14.00">Experts 14,15</text>
<text text-anchor="middle" x="2263" y="-689.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="2263" y="-674.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2263" y="-659.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_exp_gpu15 -->
<g id="edge191" class="edge">
<title>l3_moe_gate&#45;&gt;l3_exp_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2884.14,-866C2681.73,-866 2229.17,-866 2229.17,-866 2229.17,-866 2229.17,-730.28 2229.17,-730.28"/>
<polygon fill="black" stroke="black" points="2232.67,-730.28 2229.17,-720.28 2225.67,-730.28 2232.67,-730.28"/>
</g>
<!-- l3_moe_agg -->
<g id="node151" class="node">
<title>l3_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="3086,-580 2874,-580 2874,-512 3086,-512 3086,-580"/>
<text text-anchor="middle" x="2980" y="-564.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2980" y="-549.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—2</text>
<text text-anchor="middle" x="2980" y="-534.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="2980" y="-519.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_exp_gpu8&#45;&gt;l3_moe_agg -->
<g id="edge192" class="edge">
<title>l3_exp_gpu8&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M2502,-651.84C2502,-612.14 2502,-552 2502,-552 2502,-552 2863.92,-552 2863.92,-552"/>
<polygon fill="black" stroke="black" points="2863.92,-555.5 2873.92,-552 2863.92,-548.5 2863.92,-555.5"/>
</g>
<!-- l3_exp_gpu9&#45;&gt;l3_moe_agg -->
<g id="edge193" class="edge">
<title>l3_exp_gpu9&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M2741,-651.93C2741,-616.46 2741,-566 2741,-566 2741,-566 2863.78,-566 2863.78,-566"/>
<polygon fill="black" stroke="black" points="2863.78,-569.5 2873.78,-566 2863.78,-562.5 2863.78,-569.5"/>
</g>
<!-- l3_exp_gpu10&#45;&gt;l3_moe_agg -->
<g id="edge194" class="edge">
<title>l3_exp_gpu10&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M2980,-651.75C2980,-651.75 2980,-590.38 2980,-590.38"/>
<polygon fill="black" stroke="black" points="2983.5,-590.38 2980,-580.38 2976.5,-590.38 2983.5,-590.38"/>
</g>
<!-- l3_exp_gpu11&#45;&gt;l3_moe_agg -->
<g id="edge195" class="edge">
<title>l3_exp_gpu11&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M3219,-651.93C3219,-616.46 3219,-566 3219,-566 3219,-566 3096.22,-566 3096.22,-566"/>
<polygon fill="black" stroke="black" points="3096.22,-562.5 3086.22,-566 3096.22,-569.5 3096.22,-562.5"/>
</g>
<!-- l3_exp_gpu12&#45;&gt;l3_moe_agg -->
<g id="edge196" class="edge">
<title>l3_exp_gpu12&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M3413.25,-651.84C3413.25,-612.14 3413.25,-552 3413.25,-552 3413.25,-552 3096.26,-552 3096.26,-552"/>
<polygon fill="black" stroke="black" points="3096.26,-548.5 3086.26,-552 3096.26,-555.5 3096.26,-548.5"/>
</g>
<!-- l3_exp_gpu13&#45;&gt;l3_moe_agg -->
<g id="edge197" class="edge">
<title>l3_exp_gpu13&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M3696.75,-651.91C3696.75,-608.48 3696.75,-539 3696.75,-539 3696.75,-539 3096.14,-539 3096.14,-539"/>
<polygon fill="black" stroke="black" points="3096.14,-535.5 3086.14,-539 3096.14,-542.5 3096.14,-535.5"/>
</g>
<!-- l3_exp_gpu14&#45;&gt;l3_moe_agg -->
<g id="edge198" class="edge">
<title>l3_exp_gpu14&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M2024,-651.86C2024,-604.6 2024,-525 2024,-525 2024,-525 2863.58,-525 2863.58,-525"/>
<polygon fill="black" stroke="black" points="2863.58,-528.5 2873.58,-525 2863.58,-521.5 2863.58,-528.5"/>
</g>
<!-- l3_exp_gpu15&#45;&gt;l3_moe_agg -->
<g id="edge199" class="edge">
<title>l3_exp_gpu15&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M2263,-651.91C2263,-608.48 2263,-539 2263,-539 2263,-539 2863.82,-539 2863.82,-539"/>
<polygon fill="black" stroke="black" points="2863.82,-542.5 2873.82,-539 2863.82,-535.5 2863.82,-542.5"/>
</g>
<!-- l3_moe_res -->
<g id="node152" class="node">
<title>l3_moe_res</title>
<polygon fill="orange" stroke="black" points="3798,-440 3470,-440 3470,-372 3798,-372 3798,-440"/>
<text text-anchor="middle" x="3634" y="-424.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3634" y="-409.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="3634" y="-394.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3634" y="-379.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_moe_agg&#45;&gt;l3_moe_res -->
<g id="edge200" class="edge">
<title>l3_moe_agg&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M3086.29,-525C3242.24,-525 3514.75,-525 3514.75,-525 3514.75,-525 3514.75,-450.1 3514.75,-450.1"/>
<polygon fill="black" stroke="black" points="3518.25,-450.1 3514.75,-440.1 3511.25,-450.1 3518.25,-450.1"/>
</g>
<!-- output -->
<g id="node161" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="3966" cy="-232" rx="143.59" ry="48.17"/>
<text text-anchor="middle" x="3966" y="-250.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="3966" y="-235.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3966" y="-220.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3966" y="-205.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_moe_res&#45;&gt;output -->
<g id="edge250" class="edge">
<title>l3_moe_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3798.12,-394C3900.85,-394 4013.85,-394 4013.85,-394 4013.85,-394 4013.85,-287.56 4013.85,-287.56"/>
<polygon fill="black" stroke="black" points="4017.35,-287.56 4013.85,-277.56 4010.35,-287.56 4017.35,-287.56"/>
</g>
<!-- input -->
<g id="node153" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="16545" cy="-3545.5" rx="292" ry="37.5"/>
<text text-anchor="middle" x="16545" y="-3556.8" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="16545" y="-3541.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="16545" y="-3526.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;l0_qkv_all_gather -->
<g id="edge201" class="edge">
<title>input&#45;&gt;l0_qkv_all_gather</title>
<path fill="none" stroke="black" d="M16300.76,-3524.79C16300.76,-3524.79 16300.76,-3446.35 16300.76,-3446.35"/>
<polygon fill="black" stroke="black" points="16304.26,-3446.35 16300.76,-3436.35 16297.26,-3446.35 16304.26,-3446.35"/>
</g>
<!-- input&#45;&gt;l0_attn_res -->
<g id="edge202" class="edge">
<title>input&#45;&gt;l0_attn_res</title>
<path fill="none" stroke="black" d="M16464.75,-3509.43C16464.75,-3328.88 16464.75,-2532 16464.75,-2532 16464.75,-2532 16162.07,-2532 16162.07,-2532"/>
<polygon fill="black" stroke="black" points="16162.07,-2528.5 16152.07,-2532 16162.07,-2535.5 16162.07,-2528.5"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_moe_gate -->
<g id="edge203" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_moe_gate</title>
<path fill="none" stroke="black" d="M13097.07,-3388C13097.07,-3388 13864.35,-3388 13864.35,-3388"/>
<polygon fill="black" stroke="black" points="13864.35,-3391.5 13874.35,-3388 13864.35,-3384.5 13864.35,-3391.5"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu8 -->
<g id="edge204" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu8</title>
<path fill="none" stroke="black" d="M13047.11,-3312C13272.64,-3312 13697.17,-3312 13697.17,-3312 13697.17,-3312 13697.17,-3238.13 13697.17,-3238.13"/>
<polygon fill="black" stroke="black" points="13700.67,-3238.13 13697.17,-3228.13 13693.67,-3238.13 13700.67,-3238.13"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu9 -->
<g id="edge205" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu9</title>
<path fill="none" stroke="black" d="M13051.08,-3318C13332.78,-3318 13938.17,-3318 13938.17,-3318 13938.17,-3318 13938.17,-3238.21 13938.17,-3238.21"/>
<polygon fill="black" stroke="black" points="13941.67,-3238.21 13938.17,-3228.21 13934.67,-3238.21 13941.67,-3238.21"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu10 -->
<g id="edge206" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu10</title>
<path fill="none" stroke="black" d="M13052.98,-3321C13384.03,-3321 14175.17,-3321 14175.17,-3321 14175.17,-3321 14175.17,-3238.03 14175.17,-3238.03"/>
<polygon fill="black" stroke="black" points="14178.67,-3238.03 14175.17,-3228.03 14171.67,-3238.03 14178.67,-3238.03"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu11 -->
<g id="edge207" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu11</title>
<path fill="none" stroke="black" d="M13054.91,-3324C13431.89,-3324 14414.17,-3324 14414.17,-3324 14414.17,-3324 14414.17,-3238.16 14414.17,-3238.16"/>
<polygon fill="black" stroke="black" points="14417.67,-3238.16 14414.17,-3228.16 14410.67,-3238.16 14417.67,-3238.16"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu12 -->
<g id="edge208" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu12</title>
<path fill="none" stroke="black" d="M13057.12,-3327C13477.37,-3327 14653.17,-3327 14653.17,-3327 14653.17,-3327 14653.17,-3238.25 14653.17,-3238.25"/>
<polygon fill="black" stroke="black" points="14656.67,-3238.25 14653.17,-3228.25 14649.67,-3238.25 14656.67,-3238.25"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu13 -->
<g id="edge209" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu13</title>
<path fill="none" stroke="black" d="M13058.98,-3330C13519.96,-3330 14892.17,-3330 14892.17,-3330 14892.17,-3330 14892.17,-3238.32 14892.17,-3238.32"/>
<polygon fill="black" stroke="black" points="14895.67,-3238.32 14892.17,-3228.32 14888.67,-3238.32 14895.67,-3238.32"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu14 -->
<g id="edge210" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu14</title>
<path fill="none" stroke="black" d="M13087.8,-3367.87C13087.8,-3362.6 13087.8,-3194 13087.8,-3194 13087.8,-3194 13141.2,-3194 13141.2,-3194"/>
<polygon fill="black" stroke="black" points="13141.2,-3197.5 13151.2,-3194 13141.2,-3190.5 13141.2,-3197.5"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_exp_gpu15 -->
<g id="edge211" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_exp_gpu15</title>
<path fill="none" stroke="black" d="M13043.05,-3306C13205.29,-3306 13458.17,-3306 13458.17,-3306 13458.17,-3306 13458.17,-3238.21 13458.17,-3238.21"/>
<polygon fill="black" stroke="black" points="13461.67,-3238.21 13458.17,-3228.21 13454.67,-3238.21 13461.67,-3238.21"/>
</g>
<!-- l0_attn_to_moe&#45;&gt;l0_moe_res -->
<g id="edge212" class="edge">
<title>l0_attn_to_moe&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M13047.37,-3312.34C13047.37,-3193.36 13047.37,-2925 13047.37,-2925 13047.37,-2925 13142,-2925 13142,-2925"/>
<polygon fill="black" stroke="black" points="13142,-2928.5 13152,-2925 13142,-2921.5 13142,-2928.5"/>
</g>
<!-- prev_layer_0&#45;&gt;l1_qkv_all_gather -->
<g id="edge251" class="edge">
<title>prev_layer_0&#45;&gt;l1_qkv_all_gather</title>
<path fill="none" stroke="black" d="M12859.14,-2740C12621.44,-2740 11678,-2740 11678,-2740 11678,-2740 11678,-2610.11 11678,-2610.11"/>
<polygon fill="black" stroke="black" points="11681.5,-2610.11 11678,-2600.11 11674.5,-2610.11 11681.5,-2610.11"/>
</g>
<!-- prev_layer_0&#45;&gt;l1_attn_res -->
<g id="edge252" class="edge">
<title>prev_layer_0&#45;&gt;l1_attn_res</title>
<path fill="none" stroke="black" d="M12961.37,-2721.67C12961.37,-2581.45 12961.37,-1684 12961.37,-1684 12961.37,-1684 12506.13,-1684 12506.13,-1684"/>
<polygon fill="black" stroke="black" points="12506.13,-1680.5 12496.13,-1684 12506.13,-1687.5 12506.13,-1680.5"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_moe_gate -->
<g id="edge215" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_moe_gate</title>
<path fill="none" stroke="black" d="M12605.76,-2595.19C12605.76,-2616.97 12605.76,-2636 12605.76,-2636 12605.76,-2636 9779,-2636 9779,-2636 9779,-2636 9779,-2576.05 9779,-2576.05"/>
<polygon fill="black" stroke="black" points="9782.5,-2576.05 9779,-2566.05 9775.5,-2576.05 9782.5,-2576.05"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu8 -->
<g id="edge216" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu8</title>
<path fill="none" stroke="black" d="M12638.8,-2463.69C12638.8,-2450.14 12638.8,-2440 12638.8,-2440 12638.8,-2440 9334.83,-2440 9334.83,-2440 9334.83,-2440 9334.83,-2402.3 9334.83,-2402.3"/>
<polygon fill="black" stroke="black" points="9338.33,-2402.3 9334.83,-2392.3 9331.33,-2402.3 9338.33,-2402.3"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu9 -->
<g id="edge217" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu9</title>
<path fill="none" stroke="black" d="M12678.48,-2463.92C12678.48,-2446.21 12678.48,-2432 12678.48,-2432 12678.48,-2432 9573.83,-2432 9573.83,-2432 9573.83,-2432 9573.83,-2402.4 9573.83,-2402.4"/>
<polygon fill="black" stroke="black" points="9577.33,-2402.4 9573.83,-2392.4 9570.33,-2402.4 9577.33,-2402.4"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu10 -->
<g id="edge218" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu10</title>
<path fill="none" stroke="black" d="M12718.16,-2463.91C12718.16,-2442.34 12718.16,-2424 12718.16,-2424 12718.16,-2424 9810.83,-2424 9810.83,-2424 9810.83,-2424 9810.83,-2402.16 9810.83,-2402.16"/>
<polygon fill="black" stroke="black" points="9814.33,-2402.16 9810.83,-2392.16 9807.33,-2402.16 9814.33,-2402.16"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu11 -->
<g id="edge219" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu11</title>
<path fill="none" stroke="black" d="M12757.84,-2463.85C12757.84,-2438.6 12757.84,-2416 12757.84,-2416 12757.84,-2416 10051.83,-2416 10051.83,-2416 10051.83,-2416 10051.83,-2402.07 10051.83,-2402.07"/>
<polygon fill="black" stroke="black" points="10055.33,-2402.07 10051.83,-2392.07 10048.33,-2402.07 10055.33,-2402.07"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu12 -->
<g id="edge220" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu12</title>
<path fill="none" stroke="black" d="M12797.52,-2463.83C12797.52,-2435.02 12797.52,-2408 12797.52,-2408 12797.52,-2408 10290.83,-2408 10290.83,-2408 10290.83,-2408 10290.83,-2402.18 10290.83,-2402.18"/>
<polygon fill="black" stroke="black" points="10294.33,-2402.18 10290.83,-2392.18 10287.33,-2402.18 10294.33,-2402.18"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu13 -->
<g id="edge221" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu13</title>
<path fill="none" stroke="black" d="M12837.2,-2463.68C12837.2,-2431.47 12837.2,-2400 12837.2,-2400 12837.2,-2400 10529.83,-2400 10529.83,-2400 10529.83,-2400 10529.83,-2399.23 10529.83,-2399.23"/>
<polygon fill="black" stroke="black" points="10533.33,-2402.3 10529.83,-2392.3 10526.33,-2402.3 10533.33,-2402.3"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu14 -->
<g id="edge222" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu14</title>
<path fill="none" stroke="black" d="M12559.44,-2463.85C12559.44,-2459.02 12559.44,-2456 12559.44,-2456 12559.44,-2456 8856.83,-2456 8856.83,-2456 8856.83,-2456 8856.83,-2402 8856.83,-2402"/>
<polygon fill="black" stroke="black" points="8860.33,-2402 8856.83,-2392 8853.33,-2402 8860.33,-2402"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_exp_gpu15 -->
<g id="edge223" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_exp_gpu15</title>
<path fill="none" stroke="black" d="M12599.12,-2463.8C12599.12,-2454.46 12599.12,-2448 12599.12,-2448 12599.12,-2448 9095.83,-2448 9095.83,-2448 9095.83,-2448 9095.83,-2402.03 9095.83,-2402.03"/>
<polygon fill="black" stroke="black" points="9099.33,-2402.03 9095.83,-2392.03 9092.33,-2402.03 9099.33,-2402.03"/>
</g>
<!-- l1_attn_to_moe&#45;&gt;l1_moe_res -->
<g id="edge224" class="edge">
<title>l1_attn_to_moe&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M12876.88,-2478.61C12876.88,-2373.09 12876.88,-2148 12876.88,-2148 12876.88,-2148 9794,-2148 9794,-2148 9794,-2148 9794,-2122.18 9794,-2122.18"/>
<polygon fill="black" stroke="black" points="9797.5,-2122.18 9794,-2112.18 9790.5,-2122.18 9797.5,-2122.18"/>
</g>
<!-- prev_layer_1&#45;&gt;l2_qkv_all_gather -->
<g id="edge253" class="edge">
<title>prev_layer_1&#45;&gt;l2_qkv_all_gather</title>
<path fill="none" stroke="black" d="M8591.37,-1904C8344.45,-1904 7329,-1904 7329,-1904 7329,-1904 7329,-1774.11 7329,-1774.11"/>
<polygon fill="black" stroke="black" points="7332.5,-1774.11 7329,-1764.11 7325.5,-1774.11 7332.5,-1774.11"/>
</g>
<!-- prev_layer_1&#45;&gt;l2_attn_res -->
<g id="edge254" class="edge">
<title>prev_layer_1&#45;&gt;l2_attn_res</title>
<path fill="none" stroke="black" d="M8652.87,-1885.67C8652.87,-1745.45 8652.87,-848 8652.87,-848 8652.87,-848 8157.3,-848 8157.3,-848"/>
<polygon fill="black" stroke="black" points="8157.3,-844.5 8147.3,-848 8157.3,-851.5 8157.3,-844.5"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_moe_gate -->
<g id="edge227" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_moe_gate</title>
<path fill="none" stroke="black" d="M8381.13,-1764.21C8381.13,-1783.81 8381.13,-1800 8381.13,-1800 8381.13,-1800 5430,-1800 5430,-1800 5430,-1800 5430,-1740.05 5430,-1740.05"/>
<polygon fill="black" stroke="black" points="5433.5,-1740.05 5430,-1730.05 5426.5,-1740.05 5433.5,-1740.05"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu8 -->
<g id="edge228" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu8</title>
<path fill="none" stroke="black" d="M8289.8,-1627.69C8289.8,-1614.14 8289.8,-1604 8289.8,-1604 8289.8,-1604 4985.83,-1604 4985.83,-1604 4985.83,-1604 4985.83,-1566.3 4985.83,-1566.3"/>
<polygon fill="black" stroke="black" points="4989.33,-1566.3 4985.83,-1556.3 4982.33,-1566.3 4989.33,-1566.3"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu9 -->
<g id="edge229" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu9</title>
<path fill="none" stroke="black" d="M8329.48,-1627.92C8329.48,-1610.21 8329.48,-1596 8329.48,-1596 8329.48,-1596 5224.83,-1596 5224.83,-1596 5224.83,-1596 5224.83,-1566.4 5224.83,-1566.4"/>
<polygon fill="black" stroke="black" points="5228.33,-1566.4 5224.83,-1556.4 5221.33,-1566.4 5228.33,-1566.4"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu10 -->
<g id="edge230" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu10</title>
<path fill="none" stroke="black" d="M8369.16,-1627.91C8369.16,-1606.34 8369.16,-1588 8369.16,-1588 8369.16,-1588 5461.83,-1588 5461.83,-1588 5461.83,-1588 5461.83,-1566.16 5461.83,-1566.16"/>
<polygon fill="black" stroke="black" points="5465.33,-1566.16 5461.83,-1556.16 5458.33,-1566.16 5465.33,-1566.16"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu11 -->
<g id="edge231" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu11</title>
<path fill="none" stroke="black" d="M8408.84,-1627.85C8408.84,-1602.6 8408.84,-1580 8408.84,-1580 8408.84,-1580 5702.83,-1580 5702.83,-1580 5702.83,-1580 5702.83,-1566.07 5702.83,-1566.07"/>
<polygon fill="black" stroke="black" points="5706.33,-1566.07 5702.83,-1556.07 5699.33,-1566.07 5706.33,-1566.07"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu12 -->
<g id="edge232" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu12</title>
<path fill="none" stroke="black" d="M8448.52,-1627.83C8448.52,-1599.02 8448.52,-1572 8448.52,-1572 8448.52,-1572 5941.83,-1572 5941.83,-1572 5941.83,-1572 5941.83,-1566.18 5941.83,-1566.18"/>
<polygon fill="black" stroke="black" points="5945.33,-1566.18 5941.83,-1556.18 5938.33,-1566.18 5945.33,-1566.18"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu13 -->
<g id="edge233" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu13</title>
<path fill="none" stroke="black" d="M8488.2,-1627.68C8488.2,-1595.47 8488.2,-1564 8488.2,-1564 8488.2,-1564 6180.83,-1564 6180.83,-1564 6180.83,-1564 6180.83,-1563.23 6180.83,-1563.23"/>
<polygon fill="black" stroke="black" points="6184.33,-1566.3 6180.83,-1556.3 6177.33,-1566.3 6184.33,-1566.3"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu14 -->
<g id="edge234" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu14</title>
<path fill="none" stroke="black" d="M8210.44,-1627.85C8210.44,-1623.02 8210.44,-1620 8210.44,-1620 8210.44,-1620 4507.83,-1620 4507.83,-1620 4507.83,-1620 4507.83,-1566 4507.83,-1566"/>
<polygon fill="black" stroke="black" points="4511.33,-1566 4507.83,-1556 4504.33,-1566 4511.33,-1566"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_exp_gpu15 -->
<g id="edge235" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_exp_gpu15</title>
<path fill="none" stroke="black" d="M8250.12,-1627.8C8250.12,-1618.46 8250.12,-1612 8250.12,-1612 8250.12,-1612 4746.83,-1612 4746.83,-1612 4746.83,-1612 4746.83,-1566.03 4746.83,-1566.03"/>
<polygon fill="black" stroke="black" points="4750.33,-1566.03 4746.83,-1556.03 4743.33,-1566.03 4750.33,-1566.03"/>
</g>
<!-- l2_attn_to_moe&#45;&gt;l2_moe_res -->
<g id="edge236" class="edge">
<title>l2_attn_to_moe&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M8527.88,-1642.61C8527.88,-1537.09 8527.88,-1312 8527.88,-1312 8527.88,-1312 5445,-1312 5445,-1312 5445,-1312 5445,-1286.18 5445,-1286.18"/>
<polygon fill="black" stroke="black" points="5448.5,-1286.18 5445,-1276.18 5441.5,-1286.18 5448.5,-1286.18"/>
</g>
<!-- prev_layer_2&#45;&gt;l3_qkv_all_gather -->
<g id="edge255" class="edge">
<title>prev_layer_2&#45;&gt;l3_qkv_all_gather</title>
<path fill="none" stroke="black" d="M4242.22,-1068C3821.97,-1068 1081,-1068 1081,-1068 1081,-1068 1081,-938.11 1081,-938.11"/>
<polygon fill="black" stroke="black" points="1084.5,-938.11 1081,-928.11 1077.5,-938.11 1084.5,-938.11"/>
</g>
<!-- prev_layer_2&#45;&gt;l3_attn_res -->
<g id="edge256" class="edge">
<title>prev_layer_2&#45;&gt;l3_attn_res</title>
<path fill="none" stroke="black" d="M4303.87,-1049.61C4303.87,-912.72 4303.87,-58 4303.87,-58 4303.87,-58 1909.11,-58 1909.11,-58"/>
<polygon fill="black" stroke="black" points="1909.11,-54.5 1899.11,-58 1909.11,-61.5 1909.11,-54.5"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_moe_gate -->
<g id="edge239" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_moe_gate</title>
<path fill="none" stroke="black" d="M3879.3,-880C3879.3,-880 3085.63,-880 3085.63,-880"/>
<polygon fill="black" stroke="black" points="3085.63,-876.5 3075.63,-880 3085.63,-883.5 3085.63,-876.5"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu8 -->
<g id="edge240" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu8</title>
<path fill="none" stroke="black" d="M3835.97,-814C3424.87,-814 2535.83,-814 2535.83,-814 2535.83,-814 2535.83,-730.3 2535.83,-730.3"/>
<polygon fill="black" stroke="black" points="2539.33,-730.3 2535.83,-720.3 2532.33,-730.3 2539.33,-730.3"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu9 -->
<g id="edge241" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu9</title>
<path fill="none" stroke="black" d="M3833.91,-811C3475.41,-811 2774.83,-811 2774.83,-811 2774.83,-811 2774.83,-730.16 2774.83,-730.16"/>
<polygon fill="black" stroke="black" points="2778.33,-730.16 2774.83,-720.16 2771.33,-730.16 2778.33,-730.16"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu10 -->
<g id="edge242" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu10</title>
<path fill="none" stroke="black" d="M3832.55,-809C3532.22,-809 3011.83,-809 3011.83,-809 3011.83,-809 3011.83,-730.26 3011.83,-730.26"/>
<polygon fill="black" stroke="black" points="3015.33,-730.26 3011.83,-720.26 3008.33,-730.26 3015.33,-730.26"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu11 -->
<g id="edge243" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu11</title>
<path fill="none" stroke="black" d="M3830.6,-806C3597.41,-806 3252.83,-806 3252.83,-806 3252.83,-806 3252.83,-730.07 3252.83,-730.07"/>
<polygon fill="black" stroke="black" points="3256.33,-730.07 3252.83,-720.07 3249.33,-730.07 3256.33,-730.07"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu12 -->
<g id="edge244" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu12</title>
<path fill="none" stroke="black" d="M3826.49,-800C3672.58,-800 3491.83,-800 3491.83,-800 3491.83,-800 3491.83,-730.2 3491.83,-730.2"/>
<polygon fill="black" stroke="black" points="3495.33,-730.2 3491.83,-720.2 3488.33,-730.2 3495.33,-730.2"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu13 -->
<g id="edge245" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu13</title>
<path fill="none" stroke="black" d="M3822.76,-794C3771.2,-794 3730.83,-794 3730.83,-794 3730.83,-794 3730.83,-730.17 3730.83,-730.17"/>
<polygon fill="black" stroke="black" points="3734.33,-730.17 3730.83,-720.17 3727.33,-730.17 3734.33,-730.17"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu14 -->
<g id="edge246" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu14</title>
<path fill="none" stroke="black" d="M3839.49,-820C3335.88,-820 2057.83,-820 2057.83,-820 2057.83,-820 2057.83,-730.16 2057.83,-730.16"/>
<polygon fill="black" stroke="black" points="2061.33,-730.16 2057.83,-720.16 2054.33,-730.16 2061.33,-730.16"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_exp_gpu15 -->
<g id="edge247" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_exp_gpu15</title>
<path fill="none" stroke="black" d="M3837.91,-817C3378.81,-817 2296.83,-817 2296.83,-817 2296.83,-817 2296.83,-730.08 2296.83,-730.08"/>
<polygon fill="black" stroke="black" points="2300.33,-730.08 2296.83,-720.08 2293.33,-730.08 2300.33,-730.08"/>
</g>
<!-- l3_attn_to_moe&#45;&gt;l3_moe_res -->
<g id="edge248" class="edge">
<title>l3_attn_to_moe&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M3918.15,-791.75C3918.15,-667.49 3918.15,-417 3918.15,-417 3918.15,-417 3808.06,-417 3808.06,-417"/>
<polygon fill="black" stroke="black" points="3808.06,-413.5 3798.06,-417 3808.06,-420.5 3808.06,-413.5"/>
</g>
</g>
</svg>
