<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_model Pages: 1 -->
<svg width="1073pt" height="4965pt"
 viewBox="0.00 0.00 1073.00 4965.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4961.17)">
<title>baseline_moe_model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4961.17 1069,-4961.17 1069,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="8,-2613.17 8,-4874.17 998,-4874.17 998,-2613.17 8,-2613.17"/>
<text text-anchor="middle" x="503" y="-4858.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
<text text-anchor="middle" x="503" y="-4843.97" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="none" stroke="red" d="M28,-3741.17C28,-3741.17 978,-3741.17 978,-3741.17 984,-3741.17 990,-3747.17 990,-3753.17 990,-3753.17 990,-4816.17 990,-4816.17 990,-4822.17 984,-4828.17 978,-4828.17 978,-4828.17 28,-4828.17 28,-4828.17 22,-4828.17 16,-4822.17 16,-4816.17 16,-4816.17 16,-3753.17 16,-3753.17 16,-3747.17 22,-3741.17 28,-3741.17"/>
<text text-anchor="middle" x="503" y="-4812.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="red" d="M28,-2621.17C28,-2621.17 978,-2621.17 978,-2621.17 984,-2621.17 990,-2627.17 990,-2633.17 990,-2633.17 990,-3696.17 990,-3696.17 990,-3702.17 984,-3708.17 978,-3708.17 978,-3708.17 28,-3708.17 28,-3708.17 22,-3708.17 16,-3702.17 16,-3696.17 16,-3696.17 16,-2633.17 16,-2633.17 16,-2627.17 22,-2621.17 28,-2621.17"/>
<text text-anchor="middle" x="503" y="-3692.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline_1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="67,-152.17 67,-2413.17 1057,-2413.17 1057,-152.17 67,-152.17"/>
<text text-anchor="middle" x="562" y="-2397.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
<text text-anchor="middle" x="562" y="-2382.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="blue" d="M87,-1280.17C87,-1280.17 1037,-1280.17 1037,-1280.17 1043,-1280.17 1049,-1286.17 1049,-1292.17 1049,-1292.17 1049,-2355.17 1049,-2355.17 1049,-2361.17 1043,-2367.17 1037,-2367.17 1037,-2367.17 87,-2367.17 87,-2367.17 81,-2367.17 75,-2361.17 75,-2355.17 75,-2355.17 75,-1292.17 75,-1292.17 75,-1286.17 81,-1280.17 87,-1280.17"/>
<text text-anchor="middle" x="562" y="-2351.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="blue" d="M87,-160.17C87,-160.17 1037,-160.17 1037,-160.17 1043,-160.17 1049,-166.17 1049,-172.17 1049,-172.17 1049,-1235.17 1049,-1235.17 1049,-1241.17 1043,-1247.17 1037,-1247.17 1037,-1247.17 87,-1247.17 87,-1247.17 81,-1247.17 75,-1241.17 75,-1235.17 75,-1235.17 75,-172.17 75,-172.17 75,-166.17 81,-160.17 87,-160.17"/>
<text text-anchor="middle" x="562" y="-1231.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- l0_mha_qkv -->
<g id="node1" class="node">
<title>l0_mha_qkv</title>
<polygon fill="yellow" stroke="black" points="740,-4797.17 480,-4797.17 480,-4729.17 740,-4729.17 740,-4797.17"/>
<text text-anchor="middle" x="610" y="-4781.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="610" y="-4766.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="610" y="-4751.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128] per GPU</text>
<text text-anchor="middle" x="610" y="-4736.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_attn -->
<g id="node2" class="node">
<title>l0_mha_attn</title>
<polygon fill="yellow" stroke="black" points="714,-4657.17 520,-4657.17 520,-4589.17 714,-4589.17 714,-4657.17"/>
<text text-anchor="middle" x="617" y="-4641.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="617" y="-4626.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="617" y="-4611.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="617" y="-4596.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_qkv&#45;&gt;l0_mha_attn -->
<g id="edge1" class="edge">
<title>l0_mha_qkv&#45;&gt;l0_mha_attn</title>
<path fill="none" stroke="black" d="M617,-4728.92C617,-4728.92 617,-4667.55 617,-4667.55"/>
<polygon fill="black" stroke="black" points="620.5,-4667.55 617,-4657.55 613.5,-4667.55 620.5,-4667.55"/>
</g>
<!-- l0_mha_out -->
<g id="node3" class="node">
<title>l0_mha_out</title>
<polygon fill="yellow" stroke="black" points="725.5,-4517.17 522.5,-4517.17 522.5,-4449.17 725.5,-4449.17 725.5,-4517.17"/>
<text text-anchor="middle" x="624" y="-4501.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="624" y="-4486.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="624" y="-4471.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="624" y="-4456.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_attn&#45;&gt;l0_mha_out -->
<g id="edge2" class="edge">
<title>l0_mha_attn&#45;&gt;l0_mha_out</title>
<path fill="none" stroke="black" d="M618.25,-4588.92C618.25,-4588.92 618.25,-4527.55 618.25,-4527.55"/>
<polygon fill="black" stroke="black" points="621.75,-4527.55 618.25,-4517.55 614.75,-4527.55 621.75,-4527.55"/>
</g>
<!-- l0_mha_res -->
<g id="node4" class="node">
<title>l0_mha_res</title>
<polygon fill="orange" stroke="black" points="874,-4377.17 546,-4377.17 546,-4309.17 874,-4309.17 874,-4377.17"/>
<text text-anchor="middle" x="710" y="-4361.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="710" y="-4346.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-4331.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-4316.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_out&#45;&gt;l0_mha_res -->
<g id="edge3" class="edge">
<title>l0_mha_out&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M635.75,-4448.92C635.75,-4448.92 635.75,-4387.55 635.75,-4387.55"/>
<polygon fill="black" stroke="black" points="639.25,-4387.55 635.75,-4377.55 632.25,-4387.55 639.25,-4387.55"/>
</g>
<!-- l0_moe_gate -->
<g id="node5" class="node">
<title>l0_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="698.5,-4237.17 507.5,-4237.17 507.5,-4169.17 698.5,-4169.17 698.5,-4237.17"/>
<text text-anchor="middle" x="603" y="-4221.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="603" y="-4206.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-4191.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="603" y="-4176.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_moe_gate -->
<g id="edge4" class="edge">
<title>l0_mha_res&#45;&gt;l0_moe_gate</title>
<path fill="none" stroke="black" d="M622.25,-4308.92C622.25,-4308.92 622.25,-4247.55 622.25,-4247.55"/>
<polygon fill="black" stroke="black" points="625.75,-4247.55 622.25,-4237.55 618.75,-4247.55 625.75,-4247.55"/>
</g>
<!-- l0_moe_res -->
<g id="node6" class="node">
<title>l0_moe_res</title>
<polygon fill="orange" stroke="black" points="809,-3817.17 481,-3817.17 481,-3749.17 809,-3749.17 809,-3817.17"/>
<text text-anchor="middle" x="645" y="-3801.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="645" y="-3786.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="645" y="-3771.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="645" y="-3756.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_moe_res -->
<g id="edge5" class="edge">
<title>l0_mha_res&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M724.75,-4308.98C724.75,-4308.98 724.75,-3827.26 724.75,-3827.26"/>
<polygon fill="black" stroke="black" points="728.25,-3827.26 724.75,-3817.26 721.25,-3827.26 728.25,-3827.26"/>
</g>
<!-- l0_moe_exp0 -->
<g id="node7" class="node">
<title>l0_moe_exp0</title>
<polygon fill="lightpink" stroke="black" points="226.5,-4097.17 23.5,-4097.17 23.5,-4029.17 226.5,-4029.17 226.5,-4097.17"/>
<text text-anchor="middle" x="125" y="-4081.97" font-family="Times,serif" font-size="14.00">Expert 0,1</text>
<text text-anchor="middle" x="125" y="-4066.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-4051.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-4036.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_moe_exp0 -->
<g id="edge6" class="edge">
<title>l0_moe_gate&#45;&gt;l0_moe_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.42,-4214C367.93,-4214 125,-4214 125,-4214 125,-4214 125,-4107.39 125,-4107.39"/>
<polygon fill="black" stroke="black" points="128.5,-4107.39 125,-4097.39 121.5,-4107.39 128.5,-4107.39"/>
</g>
<!-- l0_moe_exp2 -->
<g id="node8" class="node">
<title>l0_moe_exp2</title>
<polygon fill="lightpink" stroke="black" points="465.5,-4097.17 262.5,-4097.17 262.5,-4029.17 465.5,-4029.17 465.5,-4097.17"/>
<text text-anchor="middle" x="364" y="-4081.97" font-family="Times,serif" font-size="14.00">Expert 2,3</text>
<text text-anchor="middle" x="364" y="-4066.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="364" y="-4051.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="364" y="-4036.97" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_moe_exp2 -->
<g id="edge7" class="edge">
<title>l0_moe_gate&#45;&gt;l0_moe_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.35,-4191C470.81,-4191 437.75,-4191 437.75,-4191 437.75,-4191 437.75,-4107.42 437.75,-4107.42"/>
<polygon fill="black" stroke="black" points="441.25,-4107.42 437.75,-4097.42 434.25,-4107.42 441.25,-4107.42"/>
</g>
<!-- l0_moe_exp4 -->
<g id="node9" class="node">
<title>l0_moe_exp4</title>
<polygon fill="lightpink" stroke="black" points="704.5,-4097.17 501.5,-4097.17 501.5,-4029.17 704.5,-4029.17 704.5,-4097.17"/>
<text text-anchor="middle" x="603" y="-4081.97" font-family="Times,serif" font-size="14.00">Expert 4,5</text>
<text text-anchor="middle" x="603" y="-4066.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-4051.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-4036.97" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_moe_exp4 -->
<g id="edge8" class="edge">
<title>l0_moe_gate&#45;&gt;l0_moe_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M603,-4168.92C603,-4168.92 603,-4107.55 603,-4107.55"/>
<polygon fill="black" stroke="black" points="606.5,-4107.55 603,-4097.55 599.5,-4107.55 606.5,-4107.55"/>
</g>
<!-- l0_moe_exp6 -->
<g id="node10" class="node">
<title>l0_moe_exp6</title>
<polygon fill="lightpink" stroke="black" points="943.5,-4097.17 740.5,-4097.17 740.5,-4029.17 943.5,-4029.17 943.5,-4097.17"/>
<text text-anchor="middle" x="842" y="-4081.97" font-family="Times,serif" font-size="14.00">Expert 6,7</text>
<text text-anchor="middle" x="842" y="-4066.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="842" y="-4051.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="842" y="-4036.97" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- l0_moe_gate&#45;&gt;l0_moe_exp6 -->
<g id="edge9" class="edge">
<title>l0_moe_gate&#45;&gt;l0_moe_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M698.55,-4203C751.71,-4203 807.25,-4203 807.25,-4203 807.25,-4203 807.25,-4107.37 807.25,-4107.37"/>
<polygon fill="black" stroke="black" points="810.75,-4107.37 807.25,-4097.37 803.75,-4107.37 810.75,-4107.37"/>
</g>
<!-- l1_mha_qkv -->
<g id="node12" class="node">
<title>l1_mha_qkv</title>
<polygon fill="yellow" stroke="black" points="677,-3677.17 417,-3677.17 417,-3609.17 677,-3609.17 677,-3677.17"/>
<text text-anchor="middle" x="547" y="-3661.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="547" y="-3646.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="547" y="-3631.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128] per GPU</text>
<text text-anchor="middle" x="547" y="-3616.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_moe_res&#45;&gt;l1_mha_qkv -->
<g id="edge29" class="edge">
<title>l0_moe_res&#45;&gt;l1_mha_qkv</title>
<path fill="none" stroke="black" d="M579,-3748.92C579,-3748.92 579,-3687.55 579,-3687.55"/>
<polygon fill="black" stroke="black" points="582.5,-3687.55 579,-3677.55 575.5,-3687.55 582.5,-3687.55"/>
</g>
<!-- l1_mha_res -->
<g id="node15" class="node">
<title>l1_mha_res</title>
<polygon fill="orange" stroke="black" points="822,-3257.17 494,-3257.17 494,-3189.17 822,-3189.17 822,-3257.17"/>
<text text-anchor="middle" x="658" y="-3241.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="658" y="-3226.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="658" y="-3211.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="658" y="-3196.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_moe_res&#45;&gt;l1_mha_res -->
<g id="edge30" class="edge">
<title>l0_moe_res&#45;&gt;l1_mha_res</title>
<path fill="none" stroke="black" d="M743,-3748.98C743,-3748.98 743,-3267.26 743,-3267.26"/>
<polygon fill="black" stroke="black" points="746.5,-3267.26 743,-3257.26 739.5,-3267.26 746.5,-3267.26"/>
</g>
<!-- l0_moe_agg -->
<g id="node11" class="node">
<title>l0_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="709,-3957.17 497,-3957.17 497,-3889.17 709,-3889.17 709,-3957.17"/>
<text text-anchor="middle" x="603" y="-3941.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="603" y="-3926.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]×2</text>
<text text-anchor="middle" x="603" y="-3911.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-3896.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_moe_exp0&#45;&gt;l0_moe_agg -->
<g id="edge10" class="edge">
<title>l0_moe_exp0&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M158.83,-4029.02C158.83,-3984.15 158.83,-3911 158.83,-3911 158.83,-3911 486.89,-3911 486.89,-3911"/>
<polygon fill="black" stroke="black" points="486.89,-3914.5 496.89,-3911 486.89,-3907.5 486.89,-3914.5"/>
</g>
<!-- l0_moe_exp2&#45;&gt;l0_moe_agg -->
<g id="edge11" class="edge">
<title>l0_moe_exp2&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M441.25,-4028.89C441.25,-3990.63 441.25,-3934 441.25,-3934 441.25,-3934 486.92,-3934 486.92,-3934"/>
<polygon fill="black" stroke="black" points="486.92,-3937.5 496.92,-3934 486.92,-3930.5 486.92,-3937.5"/>
</g>
<!-- l0_moe_exp4&#45;&gt;l0_moe_agg -->
<g id="edge12" class="edge">
<title>l0_moe_exp4&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M603,-4028.92C603,-4028.92 603,-3967.55 603,-3967.55"/>
<polygon fill="black" stroke="black" points="606.5,-3967.55 603,-3957.55 599.5,-3967.55 606.5,-3967.55"/>
</g>
<!-- l0_moe_exp6&#45;&gt;l0_moe_agg -->
<g id="edge13" class="edge">
<title>l0_moe_exp6&#45;&gt;l0_moe_agg</title>
<path fill="none" stroke="black" d="M774.75,-4028.88C774.75,-3987.38 774.75,-3923 774.75,-3923 774.75,-3923 719.33,-3923 719.33,-3923"/>
<polygon fill="black" stroke="black" points="719.33,-3919.5 709.33,-3923 719.33,-3926.5 719.33,-3919.5"/>
</g>
<!-- l0_moe_agg&#45;&gt;l0_moe_res -->
<g id="edge14" class="edge">
<title>l0_moe_agg&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M603,-3888.92C603,-3888.92 603,-3827.55 603,-3827.55"/>
<polygon fill="black" stroke="black" points="606.5,-3827.55 603,-3817.55 599.5,-3827.55 606.5,-3827.55"/>
</g>
<!-- l1_mha_attn -->
<g id="node13" class="node">
<title>l1_mha_attn</title>
<polygon fill="yellow" stroke="black" points="651,-3537.17 457,-3537.17 457,-3469.17 651,-3469.17 651,-3537.17"/>
<text text-anchor="middle" x="554" y="-3521.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="554" y="-3506.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="554" y="-3491.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="554" y="-3476.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_qkv&#45;&gt;l1_mha_attn -->
<g id="edge15" class="edge">
<title>l1_mha_qkv&#45;&gt;l1_mha_attn</title>
<path fill="none" stroke="black" d="M554,-3608.92C554,-3608.92 554,-3547.55 554,-3547.55"/>
<polygon fill="black" stroke="black" points="557.5,-3547.55 554,-3537.55 550.5,-3547.55 557.5,-3547.55"/>
</g>
<!-- l1_mha_out -->
<g id="node14" class="node">
<title>l1_mha_out</title>
<polygon fill="yellow" stroke="black" points="662.5,-3397.17 459.5,-3397.17 459.5,-3329.17 662.5,-3329.17 662.5,-3397.17"/>
<text text-anchor="middle" x="561" y="-3381.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="561" y="-3366.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="561" y="-3351.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="561" y="-3336.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_attn&#45;&gt;l1_mha_out -->
<g id="edge16" class="edge">
<title>l1_mha_attn&#45;&gt;l1_mha_out</title>
<path fill="none" stroke="black" d="M555.25,-3468.92C555.25,-3468.92 555.25,-3407.55 555.25,-3407.55"/>
<polygon fill="black" stroke="black" points="558.75,-3407.55 555.25,-3397.55 551.75,-3407.55 558.75,-3407.55"/>
</g>
<!-- l1_mha_out&#45;&gt;l1_mha_res -->
<g id="edge17" class="edge">
<title>l1_mha_out&#45;&gt;l1_mha_res</title>
<path fill="none" stroke="black" d="M578.25,-3328.92C578.25,-3328.92 578.25,-3267.55 578.25,-3267.55"/>
<polygon fill="black" stroke="black" points="581.75,-3267.55 578.25,-3257.55 574.75,-3267.55 581.75,-3267.55"/>
</g>
<!-- l1_moe_gate -->
<g id="node16" class="node">
<title>l1_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="698.5,-3117.17 507.5,-3117.17 507.5,-3049.17 698.5,-3049.17 698.5,-3117.17"/>
<text text-anchor="middle" x="603" y="-3101.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="603" y="-3086.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-3071.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="603" y="-3056.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_moe_gate -->
<g id="edge18" class="edge">
<title>l1_mha_res&#45;&gt;l1_moe_gate</title>
<path fill="none" stroke="black" d="M603,-3188.92C603,-3188.92 603,-3127.55 603,-3127.55"/>
<polygon fill="black" stroke="black" points="606.5,-3127.55 603,-3117.55 599.5,-3127.55 606.5,-3127.55"/>
</g>
<!-- l1_moe_res -->
<g id="node17" class="node">
<title>l1_moe_res</title>
<polygon fill="orange" stroke="black" points="874,-2697.17 546,-2697.17 546,-2629.17 874,-2629.17 874,-2697.17"/>
<text text-anchor="middle" x="710" y="-2681.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="710" y="-2666.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-2651.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-2636.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_moe_res -->
<g id="edge19" class="edge">
<title>l1_mha_res&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M724.75,-3188.98C724.75,-3188.98 724.75,-2707.26 724.75,-2707.26"/>
<polygon fill="black" stroke="black" points="728.25,-2707.26 724.75,-2697.26 721.25,-2707.26 728.25,-2707.26"/>
</g>
<!-- l1_moe_exp0 -->
<g id="node18" class="node">
<title>l1_moe_exp0</title>
<polygon fill="lightpink" stroke="black" points="226.5,-2977.17 23.5,-2977.17 23.5,-2909.17 226.5,-2909.17 226.5,-2977.17"/>
<text text-anchor="middle" x="125" y="-2961.97" font-family="Times,serif" font-size="14.00">Expert 0,1</text>
<text text-anchor="middle" x="125" y="-2946.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-2931.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="125" y="-2916.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_moe_exp0 -->
<g id="edge20" class="edge">
<title>l1_moe_gate&#45;&gt;l1_moe_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.33,-3094C359.19,-3094 91.17,-3094 91.17,-3094 91.17,-3094 91.17,-2987.39 91.17,-2987.39"/>
<polygon fill="black" stroke="black" points="94.67,-2987.39 91.17,-2977.39 87.67,-2987.39 94.67,-2987.39"/>
</g>
<!-- l1_moe_exp2 -->
<g id="node19" class="node">
<title>l1_moe_exp2</title>
<polygon fill="lightpink" stroke="black" points="465.5,-2977.17 262.5,-2977.17 262.5,-2909.17 465.5,-2909.17 465.5,-2977.17"/>
<text text-anchor="middle" x="364" y="-2961.97" font-family="Times,serif" font-size="14.00">Expert 2,3</text>
<text text-anchor="middle" x="364" y="-2946.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="364" y="-2931.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="364" y="-2916.97" font-family="Times,serif" font-size="14.00">GPU: 2&#45;3</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_moe_exp2 -->
<g id="edge21" class="edge">
<title>l1_moe_gate&#45;&gt;l1_moe_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.4,-3071C470.5,-3071 437,-3071 437,-3071 437,-3071 437,-2987.42 437,-2987.42"/>
<polygon fill="black" stroke="black" points="440.5,-2987.42 437,-2977.42 433.5,-2987.42 440.5,-2987.42"/>
</g>
<!-- l1_moe_exp4 -->
<g id="node20" class="node">
<title>l1_moe_exp4</title>
<polygon fill="lightpink" stroke="black" points="704.5,-2977.17 501.5,-2977.17 501.5,-2909.17 704.5,-2909.17 704.5,-2977.17"/>
<text text-anchor="middle" x="603" y="-2961.97" font-family="Times,serif" font-size="14.00">Expert 4,5</text>
<text text-anchor="middle" x="603" y="-2946.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-2931.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-2916.97" font-family="Times,serif" font-size="14.00">GPU: 4&#45;5</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_moe_exp4 -->
<g id="edge22" class="edge">
<title>l1_moe_gate&#45;&gt;l1_moe_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M603,-3048.92C603,-3048.92 603,-2987.55 603,-2987.55"/>
<polygon fill="black" stroke="black" points="606.5,-2987.55 603,-2977.55 599.5,-2987.55 606.5,-2987.55"/>
</g>
<!-- l1_moe_exp6 -->
<g id="node21" class="node">
<title>l1_moe_exp6</title>
<polygon fill="lightpink" stroke="black" points="943.5,-2977.17 740.5,-2977.17 740.5,-2909.17 943.5,-2909.17 943.5,-2977.17"/>
<text text-anchor="middle" x="842" y="-2961.97" font-family="Times,serif" font-size="14.00">Expert 6,7</text>
<text text-anchor="middle" x="842" y="-2946.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="842" y="-2931.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="842" y="-2916.97" font-family="Times,serif" font-size="14.00">GPU: 6&#45;7</text>
</g>
<!-- l1_moe_gate&#45;&gt;l1_moe_exp6 -->
<g id="edge23" class="edge">
<title>l1_moe_gate&#45;&gt;l1_moe_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M698.65,-3083C740.93,-3083 781.25,-3083 781.25,-3083 781.25,-3083 781.25,-2987.37 781.25,-2987.37"/>
<polygon fill="black" stroke="black" points="784.75,-2987.37 781.25,-2977.37 777.75,-2987.37 784.75,-2987.37"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node46" class="node">
<title>stage0_to_stage1</title>
<polygon fill="gray" stroke="black" points="928.47,-2557.17 580.93,-2557.17 491.53,-2421.17 839.07,-2421.17 928.47,-2557.17"/>
<text text-anchor="middle" x="710" y="-2507.97" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="710" y="-2492.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-2477.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="710" y="-2462.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 → 8&#45;15</text>
</g>
<!-- l1_moe_res&#45;&gt;stage0_to_stage1 -->
<g id="edge63" class="edge">
<title>l1_moe_res&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" d="M710,-2628.79C710,-2628.79 710,-2567.31 710,-2567.31"/>
<polygon fill="black" stroke="black" points="713.5,-2567.31 710,-2557.31 706.5,-2567.31 713.5,-2567.31"/>
</g>
<!-- l1_moe_agg -->
<g id="node22" class="node">
<title>l1_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="709,-2837.17 497,-2837.17 497,-2769.17 709,-2769.17 709,-2837.17"/>
<text text-anchor="middle" x="603" y="-2821.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="603" y="-2806.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]×2</text>
<text text-anchor="middle" x="603" y="-2791.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="603" y="-2776.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_moe_exp0&#45;&gt;l1_moe_agg -->
<g id="edge24" class="edge">
<title>l1_moe_exp0&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M154.5,-2909.02C154.5,-2864.15 154.5,-2791 154.5,-2791 154.5,-2791 487,-2791 487,-2791"/>
<polygon fill="black" stroke="black" points="487,-2794.5 497,-2791 487,-2787.5 487,-2794.5"/>
</g>
<!-- l1_moe_exp2&#45;&gt;l1_moe_agg -->
<g id="edge25" class="edge">
<title>l1_moe_exp2&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M393.5,-2908.89C393.5,-2870.63 393.5,-2814 393.5,-2814 393.5,-2814 486.72,-2814 486.72,-2814"/>
<polygon fill="black" stroke="black" points="486.72,-2817.5 496.72,-2814 486.72,-2810.5 486.72,-2817.5"/>
</g>
<!-- l1_moe_exp4&#45;&gt;l1_moe_agg -->
<g id="edge26" class="edge">
<title>l1_moe_exp4&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M603,-2908.92C603,-2908.92 603,-2847.55 603,-2847.55"/>
<polygon fill="black" stroke="black" points="606.5,-2847.55 603,-2837.55 599.5,-2847.55 606.5,-2847.55"/>
</g>
<!-- l1_moe_exp6&#45;&gt;l1_moe_agg -->
<g id="edge27" class="edge">
<title>l1_moe_exp6&#45;&gt;l1_moe_agg</title>
<path fill="none" stroke="black" d="M807.25,-2908.88C807.25,-2867.38 807.25,-2803 807.25,-2803 807.25,-2803 719.01,-2803 719.01,-2803"/>
<polygon fill="black" stroke="black" points="719.01,-2799.5 709.01,-2803 719.01,-2806.5 719.01,-2799.5"/>
</g>
<!-- l1_moe_agg&#45;&gt;l1_moe_res -->
<g id="edge28" class="edge">
<title>l1_moe_agg&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M627.5,-2768.92C627.5,-2768.92 627.5,-2707.55 627.5,-2707.55"/>
<polygon fill="black" stroke="black" points="631,-2707.55 627.5,-2697.55 624,-2707.55 631,-2707.55"/>
</g>
<!-- l2_mha_qkv -->
<g id="node23" class="node">
<title>l2_mha_qkv</title>
<polygon fill="yellow" stroke="black" points="748,-2336.17 488,-2336.17 488,-2268.17 748,-2268.17 748,-2336.17"/>
<text text-anchor="middle" x="618" y="-2320.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="618" y="-2305.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="618" y="-2290.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128] per GPU</text>
<text text-anchor="middle" x="618" y="-2275.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_attn -->
<g id="node24" class="node">
<title>l2_mha_attn</title>
<polygon fill="yellow" stroke="black" points="722,-2196.17 528,-2196.17 528,-2128.17 722,-2128.17 722,-2196.17"/>
<text text-anchor="middle" x="625" y="-2180.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="625" y="-2165.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="625" y="-2150.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="625" y="-2135.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_attn -->
<g id="edge31" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M625,-2267.92C625,-2267.92 625,-2206.55 625,-2206.55"/>
<polygon fill="black" stroke="black" points="628.5,-2206.55 625,-2196.55 621.5,-2206.55 628.5,-2206.55"/>
</g>
<!-- l2_mha_out -->
<g id="node25" class="node">
<title>l2_mha_out</title>
<polygon fill="yellow" stroke="black" points="740.5,-2056.17 537.5,-2056.17 537.5,-1988.17 740.5,-1988.17 740.5,-2056.17"/>
<text text-anchor="middle" x="639" y="-2040.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="639" y="-2025.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="639" y="-2010.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="639" y="-1995.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_out -->
<g id="edge32" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_out</title>
<path fill="none" stroke="black" d="M629.75,-2127.92C629.75,-2127.92 629.75,-2066.55 629.75,-2066.55"/>
<polygon fill="black" stroke="black" points="633.25,-2066.55 629.75,-2056.55 626.25,-2066.55 633.25,-2066.55"/>
</g>
<!-- l2_mha_res -->
<g id="node26" class="node">
<title>l2_mha_res</title>
<polygon fill="orange" stroke="black" points="885,-1916.17 557,-1916.17 557,-1848.17 885,-1848.17 885,-1916.17"/>
<text text-anchor="middle" x="721" y="-1900.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="721" y="-1885.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="721" y="-1870.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="721" y="-1855.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_out&#45;&gt;l2_mha_res -->
<g id="edge33" class="edge">
<title>l2_mha_out&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M648.75,-1987.92C648.75,-1987.92 648.75,-1926.55 648.75,-1926.55"/>
<polygon fill="black" stroke="black" points="652.25,-1926.55 648.75,-1916.55 645.25,-1926.55 652.25,-1926.55"/>
</g>
<!-- l2_moe_gate -->
<g id="node27" class="node">
<title>l2_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="757.5,-1776.17 566.5,-1776.17 566.5,-1708.17 757.5,-1708.17 757.5,-1776.17"/>
<text text-anchor="middle" x="662" y="-1760.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="662" y="-1745.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-1730.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="662" y="-1715.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_gate -->
<g id="edge34" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_gate</title>
<path fill="none" stroke="black" d="M662,-1847.92C662,-1847.92 662,-1786.55 662,-1786.55"/>
<polygon fill="black" stroke="black" points="665.5,-1786.55 662,-1776.55 658.5,-1786.55 665.5,-1786.55"/>
</g>
<!-- l2_moe_res -->
<g id="node28" class="node">
<title>l2_moe_res</title>
<polygon fill="orange" stroke="black" points="952,-1356.17 624,-1356.17 624,-1288.17 952,-1288.17 952,-1356.17"/>
<text text-anchor="middle" x="788" y="-1340.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="788" y="-1325.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="788" y="-1310.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="788" y="-1295.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_res -->
<g id="edge35" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M783.75,-1847.98C783.75,-1847.98 783.75,-1366.26 783.75,-1366.26"/>
<polygon fill="black" stroke="black" points="787.25,-1366.26 783.75,-1356.26 780.25,-1366.26 787.25,-1366.26"/>
</g>
<!-- l2_moe_exp0 -->
<g id="node29" class="node">
<title>l2_moe_exp0</title>
<polygon fill="lightpink" stroke="black" points="285.5,-1636.17 82.5,-1636.17 82.5,-1568.17 285.5,-1568.17 285.5,-1636.17"/>
<text text-anchor="middle" x="184" y="-1620.97" font-family="Times,serif" font-size="14.00">Expert 0,1</text>
<text text-anchor="middle" x="184" y="-1605.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="184" y="-1590.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="184" y="-1575.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;9</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_moe_exp0 -->
<g id="edge36" class="edge">
<title>l2_moe_gate&#45;&gt;l2_moe_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M566.09,-1753C451.19,-1753 274,-1753 274,-1753 274,-1753 274,-1646.39 274,-1646.39"/>
<polygon fill="black" stroke="black" points="277.5,-1646.39 274,-1636.39 270.5,-1646.39 277.5,-1646.39"/>
</g>
<!-- l2_moe_exp2 -->
<g id="node30" class="node">
<title>l2_moe_exp2</title>
<polygon fill="lightpink" stroke="black" points="524.5,-1636.17 321.5,-1636.17 321.5,-1568.17 524.5,-1568.17 524.5,-1636.17"/>
<text text-anchor="middle" x="423" y="-1620.97" font-family="Times,serif" font-size="14.00">Expert 2,3</text>
<text text-anchor="middle" x="423" y="-1605.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="423" y="-1590.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="423" y="-1575.97" font-family="Times,serif" font-size="14.00">GPU: 10&#45;11</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_moe_exp2 -->
<g id="edge37" class="edge">
<title>l2_moe_gate&#45;&gt;l2_moe_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M566.47,-1730C534.23,-1730 506.25,-1730 506.25,-1730 506.25,-1730 506.25,-1646.42 506.25,-1646.42"/>
<polygon fill="black" stroke="black" points="509.75,-1646.42 506.25,-1636.42 502.75,-1646.42 509.75,-1646.42"/>
</g>
<!-- l2_moe_exp4 -->
<g id="node31" class="node">
<title>l2_moe_exp4</title>
<polygon fill="lightpink" stroke="black" points="763.5,-1636.17 560.5,-1636.17 560.5,-1568.17 763.5,-1568.17 763.5,-1636.17"/>
<text text-anchor="middle" x="662" y="-1620.97" font-family="Times,serif" font-size="14.00">Expert 4,5</text>
<text text-anchor="middle" x="662" y="-1605.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-1590.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-1575.97" font-family="Times,serif" font-size="14.00">GPU: 12&#45;13</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_moe_exp4 -->
<g id="edge38" class="edge">
<title>l2_moe_gate&#45;&gt;l2_moe_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M662,-1707.92C662,-1707.92 662,-1646.55 662,-1646.55"/>
<polygon fill="black" stroke="black" points="665.5,-1646.55 662,-1636.55 658.5,-1646.55 665.5,-1646.55"/>
</g>
<!-- l2_moe_exp6 -->
<g id="node32" class="node">
<title>l2_moe_exp6</title>
<polygon fill="lightpink" stroke="black" points="1002.5,-1636.17 799.5,-1636.17 799.5,-1568.17 1002.5,-1568.17 1002.5,-1636.17"/>
<text text-anchor="middle" x="901" y="-1620.97" font-family="Times,serif" font-size="14.00">Expert 6,7</text>
<text text-anchor="middle" x="901" y="-1605.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="901" y="-1590.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="901" y="-1575.97" font-family="Times,serif" font-size="14.00">GPU: 14&#45;15</text>
</g>
<!-- l2_moe_gate&#45;&gt;l2_moe_exp6 -->
<g id="edge39" class="edge">
<title>l2_moe_gate&#45;&gt;l2_moe_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M757.67,-1742C800.81,-1742 842.25,-1742 842.25,-1742 842.25,-1742 842.25,-1646.37 842.25,-1646.37"/>
<polygon fill="black" stroke="black" points="845.75,-1646.37 842.25,-1636.37 838.75,-1646.37 845.75,-1646.37"/>
</g>
<!-- l3_mha_qkv -->
<g id="node34" class="node">
<title>l3_mha_qkv</title>
<polygon fill="yellow" stroke="black" points="787,-1216.17 527,-1216.17 527,-1148.17 787,-1148.17 787,-1216.17"/>
<text text-anchor="middle" x="657" y="-1200.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="657" y="-1185.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="657" y="-1170.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128] per GPU</text>
<text text-anchor="middle" x="657" y="-1155.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_moe_res&#45;&gt;l3_mha_qkv -->
<g id="edge59" class="edge">
<title>l2_moe_res&#45;&gt;l3_mha_qkv</title>
<path fill="none" stroke="black" d="M705.5,-1287.92C705.5,-1287.92 705.5,-1226.55 705.5,-1226.55"/>
<polygon fill="black" stroke="black" points="709,-1226.55 705.5,-1216.55 702,-1226.55 709,-1226.55"/>
</g>
<!-- l3_mha_res -->
<g id="node37" class="node">
<title>l3_mha_res</title>
<polygon fill="orange" stroke="black" points="915,-796.17 587,-796.17 587,-728.17 915,-728.17 915,-796.17"/>
<text text-anchor="middle" x="751" y="-780.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="751" y="-765.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="751" y="-750.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="751" y="-735.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_moe_res&#45;&gt;l3_mha_res -->
<g id="edge60" class="edge">
<title>l2_moe_res&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M851,-1287.98C851,-1287.98 851,-806.26 851,-806.26"/>
<polygon fill="black" stroke="black" points="854.5,-806.26 851,-796.26 847.5,-806.26 854.5,-806.26"/>
</g>
<!-- l2_moe_agg -->
<g id="node33" class="node">
<title>l2_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="768,-1496.17 556,-1496.17 556,-1428.17 768,-1428.17 768,-1496.17"/>
<text text-anchor="middle" x="662" y="-1480.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="662" y="-1465.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]×2</text>
<text text-anchor="middle" x="662" y="-1450.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-1435.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_moe_exp0&#45;&gt;l2_moe_agg -->
<g id="edge40" class="edge">
<title>l2_moe_exp0&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M217.83,-1568.02C217.83,-1523.15 217.83,-1450 217.83,-1450 217.83,-1450 545.89,-1450 545.89,-1450"/>
<polygon fill="black" stroke="black" points="545.89,-1453.5 555.89,-1450 545.89,-1446.5 545.89,-1453.5"/>
</g>
<!-- l2_moe_exp2&#45;&gt;l2_moe_agg -->
<g id="edge41" class="edge">
<title>l2_moe_exp2&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M456.83,-1567.89C456.83,-1529.63 456.83,-1473 456.83,-1473 456.83,-1473 545.81,-1473 545.81,-1473"/>
<polygon fill="black" stroke="black" points="545.81,-1476.5 555.81,-1473 545.81,-1469.5 545.81,-1476.5"/>
</g>
<!-- l2_moe_exp4&#45;&gt;l2_moe_agg -->
<g id="edge42" class="edge">
<title>l2_moe_exp4&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M662,-1567.92C662,-1567.92 662,-1506.55 662,-1506.55"/>
<polygon fill="black" stroke="black" points="665.5,-1506.55 662,-1496.55 658.5,-1506.55 665.5,-1506.55"/>
</g>
<!-- l2_moe_exp6&#45;&gt;l2_moe_agg -->
<g id="edge43" class="edge">
<title>l2_moe_exp6&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M875.75,-1567.88C875.75,-1526.38 875.75,-1462 875.75,-1462 875.75,-1462 778.25,-1462 778.25,-1462"/>
<polygon fill="black" stroke="black" points="778.25,-1458.5 768.25,-1462 778.25,-1465.5 778.25,-1458.5"/>
</g>
<!-- l2_moe_agg&#45;&gt;l2_moe_res -->
<g id="edge44" class="edge">
<title>l2_moe_agg&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M696,-1427.92C696,-1427.92 696,-1366.55 696,-1366.55"/>
<polygon fill="black" stroke="black" points="699.5,-1366.55 696,-1356.55 692.5,-1366.55 699.5,-1366.55"/>
</g>
<!-- l3_mha_attn -->
<g id="node35" class="node">
<title>l3_mha_attn</title>
<polygon fill="yellow" stroke="black" points="761,-1076.17 567,-1076.17 567,-1008.17 761,-1008.17 761,-1076.17"/>
<text text-anchor="middle" x="664" y="-1060.97" font-family="Times,serif" font-size="14.00">Attention Computation</text>
<text text-anchor="middle" x="664" y="-1045.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="664" y="-1030.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="664" y="-1015.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_qkv&#45;&gt;l3_mha_attn -->
<g id="edge45" class="edge">
<title>l3_mha_qkv&#45;&gt;l3_mha_attn</title>
<path fill="none" stroke="black" d="M664,-1147.92C664,-1147.92 664,-1086.55 664,-1086.55"/>
<polygon fill="black" stroke="black" points="667.5,-1086.55 664,-1076.55 660.5,-1086.55 667.5,-1086.55"/>
</g>
<!-- l3_mha_out -->
<g id="node36" class="node">
<title>l3_mha_out</title>
<polygon fill="yellow" stroke="black" points="779.5,-936.17 576.5,-936.17 576.5,-868.17 779.5,-868.17 779.5,-936.17"/>
<text text-anchor="middle" x="678" y="-920.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="678" y="-905.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="678" y="-890.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="678" y="-875.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_attn&#45;&gt;l3_mha_out -->
<g id="edge46" class="edge">
<title>l3_mha_attn&#45;&gt;l3_mha_out</title>
<path fill="none" stroke="black" d="M668.75,-1007.92C668.75,-1007.92 668.75,-946.55 668.75,-946.55"/>
<polygon fill="black" stroke="black" points="672.25,-946.55 668.75,-936.55 665.25,-946.55 672.25,-946.55"/>
</g>
<!-- l3_mha_out&#45;&gt;l3_mha_res -->
<g id="edge47" class="edge">
<title>l3_mha_out&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M683.25,-867.92C683.25,-867.92 683.25,-806.55 683.25,-806.55"/>
<polygon fill="black" stroke="black" points="686.75,-806.55 683.25,-796.55 679.75,-806.55 686.75,-806.55"/>
</g>
<!-- l3_moe_gate -->
<g id="node38" class="node">
<title>l3_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="757.5,-656.17 566.5,-656.17 566.5,-588.17 757.5,-588.17 757.5,-656.17"/>
<text text-anchor="middle" x="662" y="-640.97" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="662" y="-625.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-610.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="662" y="-595.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_moe_gate -->
<g id="edge48" class="edge">
<title>l3_mha_res&#45;&gt;l3_moe_gate</title>
<path fill="none" stroke="black" d="M672.25,-727.92C672.25,-727.92 672.25,-666.55 672.25,-666.55"/>
<polygon fill="black" stroke="black" points="675.75,-666.55 672.25,-656.55 668.75,-666.55 675.75,-666.55"/>
</g>
<!-- l3_moe_res -->
<g id="node39" class="node">
<title>l3_moe_res</title>
<polygon fill="orange" stroke="black" points="933,-236.17 605,-236.17 605,-168.17 933,-168.17 933,-236.17"/>
<text text-anchor="middle" x="769" y="-220.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="769" y="-205.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="769" y="-190.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="769" y="-175.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_moe_res -->
<g id="edge49" class="edge">
<title>l3_mha_res&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M783.75,-727.98C783.75,-727.98 783.75,-246.26 783.75,-246.26"/>
<polygon fill="black" stroke="black" points="787.25,-246.26 783.75,-236.26 780.25,-246.26 787.25,-246.26"/>
</g>
<!-- l3_moe_exp0 -->
<g id="node40" class="node">
<title>l3_moe_exp0</title>
<polygon fill="lightpink" stroke="black" points="285.5,-516.17 82.5,-516.17 82.5,-448.17 285.5,-448.17 285.5,-516.17"/>
<text text-anchor="middle" x="184" y="-500.97" font-family="Times,serif" font-size="14.00">Expert 0,1</text>
<text text-anchor="middle" x="184" y="-485.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="184" y="-470.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="184" y="-455.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;9</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_moe_exp0 -->
<g id="edge50" class="edge">
<title>l3_moe_gate&#45;&gt;l3_moe_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M566.33,-633C418.19,-633 150.17,-633 150.17,-633 150.17,-633 150.17,-526.39 150.17,-526.39"/>
<polygon fill="black" stroke="black" points="153.67,-526.39 150.17,-516.39 146.67,-526.39 153.67,-526.39"/>
</g>
<!-- l3_moe_exp2 -->
<g id="node41" class="node">
<title>l3_moe_exp2</title>
<polygon fill="lightpink" stroke="black" points="524.5,-516.17 321.5,-516.17 321.5,-448.17 524.5,-448.17 524.5,-516.17"/>
<text text-anchor="middle" x="423" y="-500.97" font-family="Times,serif" font-size="14.00">Expert 2,3</text>
<text text-anchor="middle" x="423" y="-485.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="423" y="-470.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="423" y="-455.97" font-family="Times,serif" font-size="14.00">GPU: 10&#45;11</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_moe_exp2 -->
<g id="edge51" class="edge">
<title>l3_moe_gate&#45;&gt;l3_moe_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M566.19,-610C487.58,-610 389.17,-610 389.17,-610 389.17,-610 389.17,-526.42 389.17,-526.42"/>
<polygon fill="black" stroke="black" points="392.67,-526.42 389.17,-516.42 385.67,-526.42 392.67,-526.42"/>
</g>
<!-- l3_moe_exp4 -->
<g id="node42" class="node">
<title>l3_moe_exp4</title>
<polygon fill="lightpink" stroke="black" points="763.5,-516.17 560.5,-516.17 560.5,-448.17 763.5,-448.17 763.5,-516.17"/>
<text text-anchor="middle" x="662" y="-500.97" font-family="Times,serif" font-size="14.00">Expert 4,5</text>
<text text-anchor="middle" x="662" y="-485.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-470.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-455.97" font-family="Times,serif" font-size="14.00">GPU: 12&#45;13</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_moe_exp4 -->
<g id="edge52" class="edge">
<title>l3_moe_gate&#45;&gt;l3_moe_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M662,-587.92C662,-587.92 662,-526.55 662,-526.55"/>
<polygon fill="black" stroke="black" points="665.5,-526.55 662,-516.55 658.5,-526.55 665.5,-526.55"/>
</g>
<!-- l3_moe_exp6 -->
<g id="node43" class="node">
<title>l3_moe_exp6</title>
<polygon fill="lightpink" stroke="black" points="1002.5,-516.17 799.5,-516.17 799.5,-448.17 1002.5,-448.17 1002.5,-516.17"/>
<text text-anchor="middle" x="901" y="-500.97" font-family="Times,serif" font-size="14.00">Expert 6,7</text>
<text text-anchor="middle" x="901" y="-485.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="901" y="-470.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="901" y="-455.97" font-family="Times,serif" font-size="14.00">GPU: 14&#45;15</text>
</g>
<!-- l3_moe_gate&#45;&gt;l3_moe_exp6 -->
<g id="edge53" class="edge">
<title>l3_moe_gate&#45;&gt;l3_moe_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M757.62,-622C807.09,-622 857.25,-622 857.25,-622 857.25,-622 857.25,-526.37 857.25,-526.37"/>
<polygon fill="black" stroke="black" points="860.75,-526.37 857.25,-516.37 853.75,-526.37 860.75,-526.37"/>
</g>
<!-- output -->
<g id="node47" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="769" cy="-48.08" rx="143.59" ry="48.17"/>
<text text-anchor="middle" x="769" y="-66.88" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="769" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="769" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="769" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_moe_res&#45;&gt;output -->
<g id="edge66" class="edge">
<title>l3_moe_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M769,-167.97C769,-167.97 769,-106.21 769,-106.21"/>
<polygon fill="black" stroke="black" points="772.5,-106.21 769,-96.21 765.5,-106.21 772.5,-106.21"/>
</g>
<!-- l3_moe_agg -->
<g id="node44" class="node">
<title>l3_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="768,-376.17 556,-376.17 556,-308.17 768,-308.17 768,-376.17"/>
<text text-anchor="middle" x="662" y="-360.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="662" y="-345.97" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]×2</text>
<text text-anchor="middle" x="662" y="-330.97" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="662" y="-315.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_moe_exp0&#45;&gt;l3_moe_agg -->
<g id="edge54" class="edge">
<title>l3_moe_exp0&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M184,-448.02C184,-403.15 184,-330 184,-330 184,-330 545.92,-330 545.92,-330"/>
<polygon fill="black" stroke="black" points="545.92,-333.5 555.92,-330 545.92,-326.5 545.92,-333.5"/>
</g>
<!-- l3_moe_exp2&#45;&gt;l3_moe_agg -->
<g id="edge55" class="edge">
<title>l3_moe_exp2&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M423,-447.89C423,-409.63 423,-353 423,-353 423,-353 545.78,-353 545.78,-353"/>
<polygon fill="black" stroke="black" points="545.78,-356.5 555.78,-353 545.78,-349.5 545.78,-356.5"/>
</g>
<!-- l3_moe_exp4&#45;&gt;l3_moe_agg -->
<g id="edge56" class="edge">
<title>l3_moe_exp4&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M662,-447.92C662,-447.92 662,-386.55 662,-386.55"/>
<polygon fill="black" stroke="black" points="665.5,-386.55 662,-376.55 658.5,-386.55 665.5,-386.55"/>
</g>
<!-- l3_moe_exp6&#45;&gt;l3_moe_agg -->
<g id="edge57" class="edge">
<title>l3_moe_exp6&#45;&gt;l3_moe_agg</title>
<path fill="none" stroke="black" d="M866.25,-447.88C866.25,-406.38 866.25,-342 866.25,-342 866.25,-342 778.01,-342 778.01,-342"/>
<polygon fill="black" stroke="black" points="778.01,-338.5 768.01,-342 778.01,-345.5 778.01,-338.5"/>
</g>
<!-- l3_moe_agg&#45;&gt;l3_moe_res -->
<g id="edge58" class="edge">
<title>l3_moe_agg&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M686.5,-307.92C686.5,-307.92 686.5,-246.55 686.5,-246.55"/>
<polygon fill="black" stroke="black" points="690,-246.55 686.5,-236.55 683,-246.55 690,-246.55"/>
</g>
<!-- input -->
<g id="node45" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="702" cy="-4919.67" rx="292" ry="37.5"/>
<text text-anchor="middle" x="702" y="-4930.97" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="702" y="-4915.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="702" y="-4900.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv -->
<g id="edge61" class="edge">
<title>input&#45;&gt;l0_mha_qkv</title>
<path fill="none" stroke="black" d="M610,-4883.76C610,-4883.76 610,-4807.29 610,-4807.29"/>
<polygon fill="black" stroke="black" points="613.5,-4807.29 610,-4797.29 606.5,-4807.29 613.5,-4807.29"/>
</g>
<!-- input&#45;&gt;l0_mha_res -->
<g id="edge62" class="edge">
<title>input&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M807,-4884.47C807,-4884.47 807,-4387.17 807,-4387.17"/>
<polygon fill="black" stroke="black" points="810.5,-4387.17 807,-4377.17 803.5,-4387.17 810.5,-4387.17"/>
</g>
<!-- stage0_to_stage1&#45;&gt;l2_mha_qkv -->
<g id="edge64" class="edge">
<title>stage0_to_stage1&#45;&gt;l2_mha_qkv</title>
<path fill="none" stroke="black" d="M619.88,-2421.13C619.88,-2421.13 619.88,-2346.32 619.88,-2346.32"/>
<polygon fill="black" stroke="black" points="623.38,-2346.32 619.88,-2336.32 616.38,-2346.32 623.38,-2346.32"/>
</g>
<!-- stage0_to_stage1&#45;&gt;l2_mha_res -->
<g id="edge65" class="edge">
<title>stage0_to_stage1&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M816.5,-2421.01C816.5,-2421.01 816.5,-1926.2 816.5,-1926.2"/>
<polygon fill="black" stroke="black" points="820,-1926.2 816.5,-1916.2 813,-1926.2 820,-1926.2"/>
</g>
</g>
</svg>
