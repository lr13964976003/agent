<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: layer_2_baseline Pages: 1 -->
<svg width="1786pt" height="1091pt"
 viewBox="0.00 0.00 1786.00 1091.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1087)">
<title>layer_2_baseline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1087 1782,-1087 1782,4 -4,4"/>
<!-- layer2_input -->
<g id="node1" class="node">
<title>layer2_input</title>
<ellipse fill="lightgreen" stroke="black" cx="820.5" cy="-1045.5" rx="135" ry="37.5"/>
<text text-anchor="middle" x="820.5" y="-1056.8" font-family="Times,serif" font-size="14.00">Layer 2 Input</text>
<text text-anchor="middle" x="820.5" y="-1041.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="820.5" y="-1026.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_mha_qkv -->
<g id="node2" class="node">
<title>l2_mha_qkv</title>
<polygon fill="yellow" stroke="black" points="1032.5,-950 772.5,-950 772.5,-882 1032.5,-882 1032.5,-950"/>
<text text-anchor="middle" x="902.5" y="-934.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="902.5" y="-919.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="902.5" y="-904.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128] per GPU</text>
<text text-anchor="middle" x="902.5" y="-889.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer2_input&#45;&gt;l2_mha_qkv -->
<g id="edge1" class="edge">
<title>layer2_input&#45;&gt;l2_mha_qkv</title>
<path fill="none" stroke="black" d="M864,-1009.77C864,-1009.77 864,-960.27 864,-960.27"/>
<polygon fill="black" stroke="black" points="867.5,-960.27 864,-950.27 860.5,-960.27 867.5,-960.27"/>
</g>
<!-- l2_mha_res -->
<g id="node3" class="node">
<title>l2_mha_res</title>
<polygon fill="orange" stroke="black" points="970.5,-572 642.5,-572 642.5,-504 970.5,-504 970.5,-572"/>
<text text-anchor="middle" x="806.5" y="-556.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="806.5" y="-541.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="806.5" y="-526.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="806.5" y="-511.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer2_input&#45;&gt;l2_mha_res -->
<g id="edge2" class="edge">
<title>layer2_input&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M729,-1017.85C729,-1017.85 729,-582.18 729,-582.18"/>
<polygon fill="black" stroke="black" points="732.5,-582.18 729,-572.18 725.5,-582.18 732.5,-582.18"/>
</g>
<!-- l2_mha_attn -->
<g id="node4" class="node">
<title>l2_mha_attn</title>
<polygon fill="yellow" stroke="black" points="992.5,-824 798.5,-824 798.5,-756 992.5,-756 992.5,-824"/>
<text text-anchor="middle" x="895.5" y="-808.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="895.5" y="-793.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="895.5" y="-778.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,128]</text>
<text text-anchor="middle" x="895.5" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_attn -->
<g id="edge3" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M895.5,-881.9C895.5,-881.9 895.5,-834.12 895.5,-834.12"/>
<polygon fill="black" stroke="black" points="899,-834.12 895.5,-824.12 892,-834.12 899,-834.12"/>
</g>
<!-- l2_moe_gate -->
<g id="node6" class="node">
<title>l2_moe_gate</title>
<polygon fill="lightcoral" stroke="black" points="967,-446 776,-446 776,-378 967,-378 967,-446"/>
<text text-anchor="middle" x="871.5" y="-430.8" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="871.5" y="-415.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="871.5" y="-400.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16]</text>
<text text-anchor="middle" x="871.5" y="-385.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_gate -->
<g id="edge6" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_gate</title>
<path fill="none" stroke="black" d="M871.5,-503.9C871.5,-503.9 871.5,-456.12 871.5,-456.12"/>
<polygon fill="black" stroke="black" points="875,-456.12 871.5,-446.12 868,-456.12 875,-456.12"/>
</g>
<!-- l2_exp0_gpu0 -->
<g id="node7" class="node">
<title>l2_exp0_gpu0</title>
<polygon fill="lightpink" stroke="black" points="1328,-320 1125,-320 1125,-252 1328,-252 1328,-320"/>
<text text-anchor="middle" x="1226.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 0,1</text>
<text text-anchor="middle" x="1226.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1226.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1226.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp0_gpu0 -->
<g id="edge7" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp0_gpu0</title>
<path fill="none" stroke="black" d="M970.67,-531C1100.6,-531 1260.33,-531 1260.33,-531 1260.33,-531 1260.33,-330.07 1260.33,-330.07"/>
<polygon fill="black" stroke="black" points="1263.83,-330.07 1260.33,-320.07 1256.83,-330.07 1263.83,-330.07"/>
</g>
<!-- l2_exp2_gpu1 -->
<g id="node8" class="node">
<title>l2_exp2_gpu1</title>
<polygon fill="lightpink" stroke="black" points="1553,-320 1350,-320 1350,-252 1553,-252 1553,-320"/>
<text text-anchor="middle" x="1451.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 2,3</text>
<text text-anchor="middle" x="1451.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1451.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1451.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp2_gpu1 -->
<g id="edge8" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp2_gpu1</title>
<path fill="none" stroke="black" d="M970.83,-544C1171.73,-544 1485.33,-544 1485.33,-544 1485.33,-544 1485.33,-330.26 1485.33,-330.26"/>
<polygon fill="black" stroke="black" points="1488.83,-330.26 1485.33,-320.26 1481.83,-330.26 1488.83,-330.26"/>
</g>
<!-- l2_exp4_gpu2 -->
<g id="node9" class="node">
<title>l2_exp4_gpu2</title>
<polygon fill="lightpink" stroke="black" points="1778,-320 1575,-320 1575,-252 1778,-252 1778,-320"/>
<text text-anchor="middle" x="1676.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 4,5</text>
<text text-anchor="middle" x="1676.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1676.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1676.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp4_gpu2 -->
<g id="edge9" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp4_gpu2</title>
<path fill="none" stroke="black" d="M970.7,-558C1231.28,-558 1710.33,-558 1710.33,-558 1710.33,-558 1710.33,-330.17 1710.33,-330.17"/>
<polygon fill="black" stroke="black" points="1713.83,-330.17 1710.33,-320.17 1706.83,-330.17 1713.83,-330.17"/>
</g>
<!-- l2_exp6_gpu3 -->
<g id="node10" class="node">
<title>l2_exp6_gpu3</title>
<polygon fill="lightpink" stroke="black" points="203,-320 0,-320 0,-252 203,-252 203,-320"/>
<text text-anchor="middle" x="101.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 6,7</text>
<text text-anchor="middle" x="101.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="101.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="101.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp6_gpu3 -->
<g id="edge10" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp6_gpu3</title>
<path fill="none" stroke="black" d="M642.07,-549C424.36,-549 67.67,-549 67.67,-549 67.67,-549 67.67,-330.11 67.67,-330.11"/>
<polygon fill="black" stroke="black" points="71.17,-330.11 67.67,-320.11 64.17,-330.11 71.17,-330.11"/>
</g>
<!-- l2_exp8_gpu4 -->
<g id="node11" class="node">
<title>l2_exp8_gpu4</title>
<polygon fill="lightpink" stroke="black" points="428,-320 225,-320 225,-252 428,-252 428,-320"/>
<text text-anchor="middle" x="326.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 8,9</text>
<text text-anchor="middle" x="326.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="326.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="326.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp8_gpu4 -->
<g id="edge11" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp8_gpu4</title>
<path fill="none" stroke="black" d="M642.15,-526C491.82,-526 292.67,-526 292.67,-526 292.67,-526 292.67,-330.13 292.67,-330.13"/>
<polygon fill="black" stroke="black" points="296.17,-330.13 292.67,-320.13 289.17,-330.13 296.17,-330.13"/>
</g>
<!-- l2_exp10_gpu5 -->
<g id="node12" class="node">
<title>l2_exp10_gpu5</title>
<polygon fill="lightpink" stroke="black" points="653,-320 450,-320 450,-252 653,-252 653,-320"/>
<text text-anchor="middle" x="551.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 10,11</text>
<text text-anchor="middle" x="551.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="551.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="551.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp10_gpu5 -->
<g id="edge12" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp10_gpu5</title>
<path fill="none" stroke="black" d="M646,-503.75C646,-503.75 646,-330.17 646,-330.17"/>
<polygon fill="black" stroke="black" points="649.5,-330.17 646,-320.17 642.5,-330.17 649.5,-330.17"/>
</g>
<!-- l2_exp12_gpu6 -->
<g id="node13" class="node">
<title>l2_exp12_gpu6</title>
<polygon fill="lightpink" stroke="black" points="878,-320 675,-320 675,-252 878,-252 878,-320"/>
<text text-anchor="middle" x="776.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 12,13</text>
<text text-anchor="middle" x="776.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="776.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="776.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp12_gpu6 -->
<g id="edge13" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp12_gpu6</title>
<path fill="none" stroke="black" d="M725.5,-503.75C725.5,-503.75 725.5,-330.17 725.5,-330.17"/>
<polygon fill="black" stroke="black" points="729,-330.17 725.5,-320.17 722,-330.17 729,-330.17"/>
</g>
<!-- l2_exp14_gpu7 -->
<g id="node14" class="node">
<title>l2_exp14_gpu7</title>
<polygon fill="lightpink" stroke="black" points="1103,-320 900,-320 900,-252 1103,-252 1103,-320"/>
<text text-anchor="middle" x="1001.5" y="-304.8" font-family="Times,serif" font-size="14.00">Experts 14,15</text>
<text text-anchor="middle" x="1001.5" y="-289.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1001.5" y="-274.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1001.5" y="-259.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_exp14_gpu7 -->
<g id="edge14" class="edge">
<title>l2_mha_res&#45;&gt;l2_exp14_gpu7</title>
<path fill="none" stroke="black" d="M970.66,-517C976.72,-517 980.25,-517 980.25,-517 980.25,-517 980.25,-330.08 980.25,-330.08"/>
<polygon fill="black" stroke="black" points="983.75,-330.08 980.25,-320.08 976.75,-330.08 983.75,-330.08"/>
</g>
<!-- l2_moe_res -->
<g id="node15" class="node">
<title>l2_moe_res</title>
<polygon fill="orange" stroke="black" points="534.5,-68 206.5,-68 206.5,0 534.5,0 534.5,-68"/>
<text text-anchor="middle" x="370.5" y="-52.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="370.5" y="-37.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096], [1024,2048,4096]</text>
<text text-anchor="middle" x="370.5" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="370.5" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_res -->
<g id="edge15" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M661.75,-503.75C661.75,-390.32 661.75,-34 661.75,-34 661.75,-34 544.85,-34 544.85,-34"/>
<polygon fill="black" stroke="black" points="544.85,-30.5 534.85,-34 544.85,-37.5 544.85,-30.5"/>
</g>
<!-- l2_mha_out -->
<g id="node5" class="node">
<title>l2_mha_out</title>
<polygon fill="yellow" stroke="black" points="990,-698 787,-698 787,-630 990,-630 990,-698"/>
<text text-anchor="middle" x="888.5" y="-682.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="888.5" y="-667.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,128]</text>
<text text-anchor="middle" x="888.5" y="-652.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="888.5" y="-637.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_out -->
<g id="edge4" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_out</title>
<path fill="none" stroke="black" d="M894.25,-755.9C894.25,-755.9 894.25,-708.12 894.25,-708.12"/>
<polygon fill="black" stroke="black" points="897.75,-708.12 894.25,-698.12 890.75,-708.12 897.75,-708.12"/>
</g>
<!-- l2_mha_out&#45;&gt;l2_mha_res -->
<g id="edge5" class="edge">
<title>l2_mha_out&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M878.75,-629.9C878.75,-629.9 878.75,-582.12 878.75,-582.12"/>
<polygon fill="black" stroke="black" points="882.25,-582.12 878.75,-572.12 875.25,-582.12 882.25,-582.12"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp0_gpu0 -->
<g id="edge16" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M967.43,-395C1062.06,-395 1192.67,-395 1192.67,-395 1192.67,-395 1192.67,-330.19 1192.67,-330.19"/>
<polygon fill="black" stroke="black" points="1196.17,-330.19 1192.67,-320.19 1189.17,-330.19 1196.17,-330.19"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp2_gpu1 -->
<g id="edge17" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp2_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M967.26,-412C1123.9,-412 1417.67,-412 1417.67,-412 1417.67,-412 1417.67,-330.1 1417.67,-330.1"/>
<polygon fill="black" stroke="black" points="1421.17,-330.1 1417.67,-320.1 1414.17,-330.1 1421.17,-330.1"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp4_gpu2 -->
<g id="edge18" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp4_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M967.22,-429C1173.75,-429 1642.67,-429 1642.67,-429 1642.67,-429 1642.67,-330.25 1642.67,-330.25"/>
<polygon fill="black" stroke="black" points="1646.17,-330.25 1642.67,-320.25 1639.17,-330.25 1646.17,-330.25"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp6_gpu3 -->
<g id="edge19" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp6_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M775.64,-429C576.27,-429 135.33,-429 135.33,-429 135.33,-429 135.33,-330.25 135.33,-330.25"/>
<polygon fill="black" stroke="black" points="138.83,-330.25 135.33,-320.25 131.83,-330.25 138.83,-330.25"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp8_gpu4 -->
<g id="edge20" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp8_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M775.95,-412C628,-412 360.33,-412 360.33,-412 360.33,-412 360.33,-330.1 360.33,-330.1"/>
<polygon fill="black" stroke="black" points="363.83,-330.1 360.33,-320.1 356.83,-330.1 363.83,-330.1"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp10_gpu5 -->
<g id="edge21" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp10_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M775.74,-395C715.66,-395 649.5,-395 649.5,-395 649.5,-395 649.5,-330.19 649.5,-330.19"/>
<polygon fill="black" stroke="black" points="653,-330.19 649.5,-320.19 646,-330.19 653,-330.19"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp12_gpu6 -->
<g id="edge22" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp12_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M827,-377.9C827,-377.9 827,-330.12 827,-330.12"/>
<polygon fill="black" stroke="black" points="830.5,-330.12 827,-320.12 823.5,-330.12 830.5,-330.12"/>
</g>
<!-- l2_moe_gate&#45;&gt;l2_exp14_gpu7 -->
<g id="edge23" class="edge">
<title>l2_moe_gate&#45;&gt;l2_exp14_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M933.5,-377.9C933.5,-377.9 933.5,-330.12 933.5,-330.12"/>
<polygon fill="black" stroke="black" points="937,-330.12 933.5,-320.12 930,-330.12 937,-330.12"/>
</g>
<!-- l2_moe_agg -->
<g id="node16" class="node">
<title>l2_moe_agg</title>
<polygon fill="lightcyan" stroke="black" points="882.5,-194 670.5,-194 670.5,-126 882.5,-126 882.5,-194"/>
<text text-anchor="middle" x="776.5" y="-178.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="776.5" y="-163.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]Ã—8</text>
<text text-anchor="middle" x="776.5" y="-148.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="776.5" y="-133.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l2_exp0_gpu0&#45;&gt;l2_moe_agg -->
<g id="edge24" class="edge">
<title>l2_exp0_gpu0&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M1226.5,-251.93C1226.5,-216.46 1226.5,-166 1226.5,-166 1226.5,-166 892.57,-166 892.57,-166"/>
<polygon fill="black" stroke="black" points="892.57,-162.5 882.57,-166 892.57,-169.5 892.57,-162.5"/>
</g>
<!-- l2_exp2_gpu1&#45;&gt;l2_moe_agg -->
<g id="edge25" class="edge">
<title>l2_exp2_gpu1&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M1451.5,-251.75C1451.5,-212.34 1451.5,-153 1451.5,-153 1451.5,-153 892.71,-153 892.71,-153"/>
<polygon fill="black" stroke="black" points="892.71,-149.5 882.71,-153 892.71,-156.5 892.71,-149.5"/>
</g>
<!-- l2_exp4_gpu2&#45;&gt;l2_moe_agg -->
<g id="edge26" class="edge">
<title>l2_exp4_gpu2&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M1676.5,-251.91C1676.5,-208.48 1676.5,-139 1676.5,-139 1676.5,-139 892.83,-139 892.83,-139"/>
<polygon fill="black" stroke="black" points="892.83,-135.5 882.83,-139 892.83,-142.5 892.83,-135.5"/>
</g>
<!-- l2_exp6_gpu3&#45;&gt;l2_moe_agg -->
<g id="edge27" class="edge">
<title>l2_exp6_gpu3&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M101.5,-251.75C101.5,-212.34 101.5,-153 101.5,-153 101.5,-153 660.29,-153 660.29,-153"/>
<polygon fill="black" stroke="black" points="660.29,-156.5 670.29,-153 660.29,-149.5 660.29,-156.5"/>
</g>
<!-- l2_exp8_gpu4&#45;&gt;l2_moe_agg -->
<g id="edge28" class="edge">
<title>l2_exp8_gpu4&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M326.5,-251.93C326.5,-216.46 326.5,-166 326.5,-166 326.5,-166 660.43,-166 660.43,-166"/>
<polygon fill="black" stroke="black" points="660.43,-169.5 670.43,-166 660.43,-162.5 660.43,-169.5"/>
</g>
<!-- l2_exp10_gpu5&#45;&gt;l2_moe_agg -->
<g id="edge29" class="edge">
<title>l2_exp10_gpu5&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M593.75,-251.88C593.75,-220.89 593.75,-180 593.75,-180 593.75,-180 660.46,-180 660.46,-180"/>
<polygon fill="black" stroke="black" points="660.46,-183.5 670.46,-180 660.46,-176.5 660.46,-183.5"/>
</g>
<!-- l2_exp12_gpu6&#45;&gt;l2_moe_agg -->
<g id="edge30" class="edge">
<title>l2_exp12_gpu6&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M776.5,-251.9C776.5,-251.9 776.5,-204.12 776.5,-204.12"/>
<polygon fill="black" stroke="black" points="780,-204.12 776.5,-194.12 773,-204.12 780,-204.12"/>
</g>
<!-- l2_exp14_gpu7&#45;&gt;l2_moe_agg -->
<g id="edge31" class="edge">
<title>l2_exp14_gpu7&#45;&gt;l2_moe_agg</title>
<path fill="none" stroke="black" d="M1001.5,-251.88C1001.5,-220.89 1001.5,-180 1001.5,-180 1001.5,-180 892.74,-180 892.74,-180"/>
<polygon fill="black" stroke="black" points="892.74,-176.5 882.74,-180 892.74,-183.5 892.74,-176.5"/>
</g>
<!-- l2_moe_agg&#45;&gt;l2_moe_res -->
<g id="edge32" class="edge">
<title>l2_moe_agg&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M670.25,-139C589.51,-139 492.25,-139 492.25,-139 492.25,-139 492.25,-78.09 492.25,-78.09"/>
<polygon fill="black" stroke="black" points="495.75,-78.09 492.25,-68.09 488.75,-78.09 495.75,-78.09"/>
</g>
</g>
</svg>
