digraph baseline_moe_model {
	graph [bb="0,0,1065,4957.1",
		nodesep=0.5,
		rankdir=TB,
		ranksep=1.0,
		splines=ortho
	];
	node [fillcolor=lightblue,
		label="\N",
		shape=rectangle,
		style=filled
	];
	subgraph cluster_pipeline_0 {
		graph [bb="8,2613.2,998,4874.2",
			color=red,
			label="Pipeline Stage 0 (Layers 0-1)
GPUs 0-7",
			lheight=0.42,
			lp="503,4855.2",
			lwidth=2.89,
			style=dashed
		];
		subgraph cluster_layer_0 {
			graph [bb="16,3741.2,990,4828.2",
				label="Layer 0",
				lheight=0.21,
				lp="503,4816.7",
				lwidth=0.76,
				style=rounded
			];
			l0_mha_qkv	[fillcolor=yellow,
				height=0.94444,
				label="QKV Projection
Input: [1024,2048,4096]
Output: [1024,2048,128] per GPU
GPU: 0-7",
				pos="610,4763.2",
				width=3.6111];
			l0_mha_attn	[fillcolor=yellow,
				height=0.94444,
				label="Attention Computation
Input: [1024,2048,128]
Output: [1024,2048,128]
GPU: 0-7",
				pos="617,4623.2",
				width=2.6944];
			l0_mha_qkv -> l0_mha_attn	[pos="e,617,4657.5 617,4728.9 617,4728.9 617,4667.5 617,4667.5"];
			l0_mha_out	[fillcolor=yellow,
				height=0.94444,
				label="Output Projection
Input: [1024,2048,128]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="624,4483.2",
				width=2.8194];
			l0_mha_attn -> l0_mha_out	[pos="e,618.25,4517.5 618.25,4588.9 618.25,4588.9 618.25,4527.5 618.25,4527.5"];
			l0_mha_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="710,4343.2",
				width=4.5556];
			l0_mha_out -> l0_mha_res	[pos="e,635.75,4377.5 635.75,4448.9 635.75,4448.9 635.75,4387.5 635.75,4387.5"];
			l0_moe_gate	[fillcolor=lightcoral,
				height=0.94444,
				label="Gate Network
Input: [1024,2048,4096]
Output: [1024,2048,16]
GPU: 0-7",
				pos="603,4203.2",
				width=2.6528];
			l0_mha_res -> l0_moe_gate	[pos="e,622.25,4237.5 622.25,4308.9 622.25,4308.9 622.25,4247.5 622.25,4247.5"];
			l0_moe_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="729,3783.2",
				width=4.5556];
			l0_mha_res -> l0_moe_res	[pos="e,724.75,3817.3 724.75,4309 724.75,4309 724.75,3827.3 724.75,3827.3"];
			l0_moe_exp0	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 0,1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-1",
				pos="125,4063.2",
				width=2.8194];
			l0_moe_gate -> l0_moe_exp0	[pos="e,125,4097.4 507.42,4214 367.93,4214 125,4214 125,4214 125,4214 125,4107.4 125,4107.4",
				style=dashed];
			l0_moe_exp2	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 2,3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 2-3",
				pos="364,4063.2",
				width=2.8194];
			l0_moe_gate -> l0_moe_exp2	[pos="e,437.73,4097.4 507.34,4191 470.79,4191 437.73,4191 437.73,4191 437.73,4191 437.73,4107.4 437.73,4107.4",
				style=dashed];
			l0_moe_exp4	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 4,5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 4-5",
				pos="603,4063.2",
				width=2.8194];
			l0_moe_gate -> l0_moe_exp4	[pos="e,603,4097.5 603,4168.9 603,4168.9 603,4107.5 603,4107.5",
				style=dashed];
			l0_moe_exp6	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 6,7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 6-7",
				pos="842,4063.2",
				width=2.8194];
			l0_moe_gate -> l0_moe_exp6	[pos="e,807.25,4097.4 698.55,4203 751.71,4203 807.25,4203 807.25,4203 807.25,4203 807.25,4107.4 807.25,4107.4",
				style=dashed];
			l0_moe_agg	[fillcolor=lightcyan,
				height=0.94444,
				label="Expert Aggregation
Input: [1024,2048,4096]×2
Output: [1024,2048,4096]
GPU: 0-7",
				pos="603,3923.2",
				width=2.9444];
			l0_moe_exp0 -> l0_moe_agg	[pos="e,496.89,3911 158.83,4029 158.83,3984.2 158.83,3911 158.83,3911 158.83,3911 486.89,3911 486.89,3911"];
			l0_moe_exp2 -> l0_moe_agg	[pos="e,496.81,3934 397.83,4028.9 397.83,3990.6 397.83,3934 397.83,3934 397.83,3934 486.81,3934 486.81,3934"];
			l0_moe_exp4 -> l0_moe_agg	[pos="e,603,3957.5 603,4028.9 603,4028.9 603,3967.5 603,3967.5"];
			l0_moe_exp6 -> l0_moe_agg	[pos="e,709.25,3923 816.75,4028.9 816.75,3987.4 816.75,3923 816.75,3923 816.75,3923 719.25,3923 719.25,3923"];
			l0_moe_agg -> l0_moe_res	[pos="e,637,3817.5 637,3888.9 637,3888.9 637,3827.5 637,3827.5"];
		}
		subgraph cluster_layer_1 {
			graph [bb="16,2621.2,990,3708.2",
				label="Layer 1",
				lheight=0.21,
				lp="503,3696.7",
				lwidth=0.76,
				style=rounded
			];
			l1_mha_qkv	[fillcolor=yellow,
				height=0.94444,
				label="QKV Projection
Input: [1024,2048,4096]
Output: [1024,2048,128] per GPU
GPU: 0-7",
				pos="600,3643.2",
				width=3.6111];
			l1_mha_attn	[fillcolor=yellow,
				height=0.94444,
				label="Attention Computation
Input: [1024,2048,128]
Output: [1024,2048,128]
GPU: 0-7",
				pos="607,3503.2",
				width=2.6944];
			l1_mha_qkv -> l1_mha_attn	[pos="e,607,3537.5 607,3608.9 607,3608.9 607,3547.5 607,3547.5"];
			l1_mha_out	[fillcolor=yellow,
				height=0.94444,
				label="Output Projection
Input: [1024,2048,128]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="614,3363.2",
				width=2.8194];
			l1_mha_attn -> l1_mha_out	[pos="e,608.25,3397.5 608.25,3468.9 608.25,3468.9 608.25,3407.5 608.25,3407.5"];
			l1_mha_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="691,3223.2",
				width=4.5556];
			l1_mha_out -> l1_mha_res	[pos="e,621.25,3257.5 621.25,3328.9 621.25,3328.9 621.25,3267.5 621.25,3267.5"];
			l1_moe_gate	[fillcolor=lightcoral,
				height=0.94444,
				label="Gate Network
Input: [1024,2048,4096]
Output: [1024,2048,16]
GPU: 0-7",
				pos="603,3083.2",
				width=2.6528];
			l1_mha_res -> l1_moe_gate	[pos="e,612.75,3117.5 612.75,3188.9 612.75,3188.9 612.75,3127.5 612.75,3127.5"];
			l1_moe_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-7",
				pos="710,2663.2",
				width=4.5556];
			l1_mha_res -> l1_moe_res	[pos="e,724.75,2697.3 724.75,3189 724.75,3189 724.75,2707.3 724.75,2707.3"];
			l1_moe_exp0	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 0,1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-1",
				pos="125,2943.2",
				width=2.8194];
			l1_moe_gate -> l1_moe_exp0	[pos="e,91.167,2977.4 507.33,3094 359.19,3094 91.167,3094 91.167,3094 91.167,3094 91.167,2987.4 91.167,2987.4",
				style=dashed];
			l1_moe_exp2	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 2,3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 2-3",
				pos="364,2943.2",
				width=2.8194];
			l1_moe_gate -> l1_moe_exp2	[pos="e,330.17,2977.4 507.19,3071 428.58,3071 330.17,3071 330.17,3071 330.17,3071 330.17,2987.4 330.17,2987.4",
				style=dashed];
			l1_moe_exp4	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 4,5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 4-5",
				pos="603,2943.2",
				width=2.8194];
			l1_moe_gate -> l1_moe_exp4	[pos="e,603,2977.5 603,3048.9 603,3048.9 603,2987.5 603,2987.5",
				style=dashed];
			l1_moe_exp6	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 6,7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 6-7",
				pos="842,2943.2",
				width=2.8194];
			l1_moe_gate -> l1_moe_exp6	[pos="e,797.75,2977.4 698.66,3083 747.91,3083 797.75,3083 797.75,3083 797.75,3083 797.75,2987.4 797.75,2987.4",
				style=dashed];
			l1_moe_agg	[fillcolor=lightcyan,
				height=0.94444,
				label="Expert Aggregation
Input: [1024,2048,4096]×2
Output: [1024,2048,4096]
GPU: 0-7",
				pos="603,2803.2",
				width=2.9444];
			l1_moe_exp0 -> l1_moe_agg	[pos="e,497,2791 154.5,2909 154.5,2864.2 154.5,2791 154.5,2791 154.5,2791 487,2791 487,2791"];
			l1_moe_exp2 -> l1_moe_agg	[pos="e,496.72,2814 393.5,2908.9 393.5,2870.6 393.5,2814 393.5,2814 393.5,2814 486.72,2814 486.72,2814"];
			l1_moe_exp4 -> l1_moe_agg	[pos="e,603,2837.5 603,2908.9 603,2908.9 603,2847.5 603,2847.5"];
			l1_moe_exp6 -> l1_moe_agg	[pos="e,709.01,2803 807.25,2908.9 807.25,2867.4 807.25,2803 807.25,2803 807.25,2803 719.01,2803 719.01,2803"];
			l1_moe_agg -> l1_moe_res	[pos="e,627.5,2697.5 627.5,2768.9 627.5,2768.9 627.5,2707.5 627.5,2707.5"];
		}
		l0_moe_res -> l1_mha_qkv	[pos="e,647.5,3677.5 647.5,3748.9 647.5,3748.9 647.5,3687.5 647.5,3687.5"];
		l0_moe_res -> l1_mha_res	[pos="e,792.5,3257.3 792.5,3749 792.5,3749 792.5,3267.3 792.5,3267.3"];
	}
	subgraph cluster_pipeline_1 {
		graph [bb="67,152.17,1057,2413.2",
			color=blue,
			label="Pipeline Stage 1 (Layers 2-3)
GPUs 8-15",
			lheight=0.42,
			lp="562,2394.2",
			lwidth=2.89,
			style=dashed
		];
		subgraph cluster_layer_2 {
			graph [bb="75,1280.2,1049,2367.2",
				label="Layer 2",
				lheight=0.21,
				lp="562,2355.7",
				lwidth=0.76,
				style=rounded
			];
			l2_mha_qkv	[fillcolor=yellow,
				height=0.94444,
				label="QKV Projection
Input: [1024,2048,4096]
Output: [1024,2048,128] per GPU
GPU: 8-15",
				pos="618,2302.2",
				width=3.6111];
			l2_mha_attn	[fillcolor=yellow,
				height=0.94444,
				label="Attention Computation
Input: [1024,2048,128]
Output: [1024,2048,128]
GPU: 8-15",
				pos="625,2162.2",
				width=2.6944];
			l2_mha_qkv -> l2_mha_attn	[pos="e,625,2196.5 625,2267.9 625,2267.9 625,2206.5 625,2206.5"];
			l2_mha_out	[fillcolor=yellow,
				height=0.94444,
				label="Output Projection
Input: [1024,2048,128]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="639,2022.2",
				width=2.8194];
			l2_mha_attn -> l2_mha_out	[pos="e,629.75,2056.5 629.75,2127.9 629.75,2127.9 629.75,2066.5 629.75,2066.5"];
			l2_mha_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="721,1882.2",
				width=4.5556];
			l2_mha_out -> l2_mha_res	[pos="e,648.75,1916.5 648.75,1987.9 648.75,1987.9 648.75,1926.5 648.75,1926.5"];
			l2_moe_gate	[fillcolor=lightcoral,
				height=0.94444,
				label="Gate Network
Input: [1024,2048,4096]
Output: [1024,2048,16]
GPU: 8-15",
				pos="662,1742.2",
				width=2.6528];
			l2_mha_res -> l2_moe_gate	[pos="e,662,1776.5 662,1847.9 662,1847.9 662,1786.5 662,1786.5"];
			l2_moe_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="788,1322.2",
				width=4.5556];
			l2_mha_res -> l2_moe_res	[pos="e,783.75,1356.3 783.75,1848 783.75,1848 783.75,1366.3 783.75,1366.3"];
			l2_moe_exp0	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 0,1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-9",
				pos="184,1602.2",
				width=2.8194];
			l2_moe_gate -> l2_moe_exp0	[pos="e,274,1636.4 566.09,1753 451.19,1753 274,1753 274,1753 274,1753 274,1646.4 274,1646.4",
				style=dashed];
			l2_moe_exp2	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 2,3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 10-11",
				pos="423,1602.2",
				width=2.8194];
			l2_moe_gate -> l2_moe_exp2	[pos="e,506.25,1636.4 566.47,1730 534.23,1730 506.25,1730 506.25,1730 506.25,1730 506.25,1646.4 506.25,1646.4",
				style=dashed];
			l2_moe_exp4	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 4,5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 12-13",
				pos="662,1602.2",
				width=2.8194];
			l2_moe_gate -> l2_moe_exp4	[pos="e,662,1636.5 662,1707.9 662,1707.9 662,1646.5 662,1646.5",
				style=dashed];
			l2_moe_exp6	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 6,7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 14-15",
				pos="901,1602.2",
				width=2.8194];
			l2_moe_gate -> l2_moe_exp6	[pos="e,842.25,1636.4 757.67,1742 800.81,1742 842.25,1742 842.25,1742 842.25,1742 842.25,1646.4 842.25,1646.4",
				style=dashed];
			l2_moe_agg	[fillcolor=lightcyan,
				height=0.94444,
				label="Expert Aggregation
Input: [1024,2048,4096]×2
Output: [1024,2048,4096]
GPU: 8-15",
				pos="662,1462.2",
				width=2.9444];
			l2_moe_exp0 -> l2_moe_agg	[pos="e,555.89,1450 217.83,1568 217.83,1523.2 217.83,1450 217.83,1450 217.83,1450 545.89,1450 545.89,1450"];
			l2_moe_exp2 -> l2_moe_agg	[pos="e,555.81,1473 456.83,1567.9 456.83,1529.6 456.83,1473 456.83,1473 456.83,1473 545.81,1473 545.81,1473"];
			l2_moe_exp4 -> l2_moe_agg	[pos="e,662,1496.5 662,1567.9 662,1567.9 662,1506.5 662,1506.5"];
			l2_moe_exp6 -> l2_moe_agg	[pos="e,768.25,1462 875.75,1567.9 875.75,1526.4 875.75,1462 875.75,1462 875.75,1462 778.25,1462 778.25,1462"];
			l2_moe_agg -> l2_moe_res	[pos="e,696,1356.5 696,1427.9 696,1427.9 696,1366.5 696,1366.5"];
		}
		subgraph cluster_layer_3 {
			graph [bb="75,160.17,1049,1247.2",
				label="Layer 3",
				lheight=0.21,
				lp="562,1235.7",
				lwidth=0.76,
				style=rounded
			];
			l3_mha_qkv	[fillcolor=yellow,
				height=0.94444,
				label="QKV Projection
Input: [1024,2048,4096]
Output: [1024,2048,128] per GPU
GPU: 8-15",
				pos="659,1182.2",
				width=3.6111];
			l3_mha_attn	[fillcolor=yellow,
				height=0.94444,
				label="Attention Computation
Input: [1024,2048,128]
Output: [1024,2048,128]
GPU: 8-15",
				pos="666,1042.2",
				width=2.6944];
			l3_mha_qkv -> l3_mha_attn	[pos="e,666,1076.5 666,1147.9 666,1147.9 666,1086.5 666,1086.5"];
			l3_mha_out	[fillcolor=yellow,
				height=0.94444,
				label="Output Projection
Input: [1024,2048,128]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="673,902.17",
				width=2.8194];
			l3_mha_attn -> l3_mha_out	[pos="e,667.25,936.55 667.25,1007.9 667.25,1007.9 667.25,946.55 667.25,946.55"];
			l3_mha_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="750,762.17",
				width=4.5556];
			l3_mha_out -> l3_mha_res	[pos="e,680.25,796.55 680.25,867.92 680.25,867.92 680.25,806.55 680.25,806.55"];
			l3_moe_gate	[fillcolor=lightcoral,
				height=0.94444,
				label="Gate Network
Input: [1024,2048,4096]
Output: [1024,2048,16]
GPU: 8-15",
				pos="662,622.17",
				width=2.6528];
			l3_mha_res -> l3_moe_gate	[pos="e,671.75,656.55 671.75,727.92 671.75,727.92 671.75,666.55 671.75,666.55"];
			l3_moe_res	[fillcolor=orange,
				height=0.94444,
				label="Residual Add
Input: [1024,2048,4096], [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-15",
				pos="769,202.17",
				width=4.5556];
			l3_mha_res -> l3_moe_res	[pos="e,783.75,236.26 783.75,727.98 783.75,727.98 783.75,246.26 783.75,246.26"];
			l3_moe_exp0	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 0,1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-9",
				pos="184,482.17",
				width=2.8194];
			l3_moe_gate -> l3_moe_exp0	[pos="e,150.17,516.39 566.33,633 418.19,633 150.17,633 150.17,633 150.17,633 150.17,526.39 150.17,526.39",
				style=dashed];
			l3_moe_exp2	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 2,3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 10-11",
				pos="423,482.17",
				width=2.8194];
			l3_moe_gate -> l3_moe_exp2	[pos="e,389.17,516.42 566.19,610 487.58,610 389.17,610 389.17,610 389.17,610 389.17,526.42 389.17,526.42",
				style=dashed];
			l3_moe_exp4	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 4,5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 12-13",
				pos="662,482.17",
				width=2.8194];
			l3_moe_gate -> l3_moe_exp4	[pos="e,662,516.55 662,587.92 662,587.92 662,526.55 662,526.55",
				style=dashed];
			l3_moe_exp6	[fillcolor=lightpink,
				height=0.94444,
				label="Expert 6,7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 14-15",
				pos="901,482.17",
				width=2.8194];
			l3_moe_gate -> l3_moe_exp6	[pos="e,856.75,516.37 757.66,622 806.91,622 856.75,622 856.75,622 856.75,622 856.75,526.37 856.75,526.37",
				style=dashed];
			l3_moe_agg	[fillcolor=lightcyan,
				height=0.94444,
				label="Expert Aggregation
Input: [1024,2048,4096]×2
Output: [1024,2048,4096]
GPU: 8-15",
				pos="662,342.17",
				width=2.9444];
			l3_moe_exp0 -> l3_moe_agg	[pos="e,555.92,330 184,448.02 184,403.15 184,330 184,330 184,330 545.92,330 545.92,330"];
			l3_moe_exp2 -> l3_moe_agg	[pos="e,555.78,353 423,447.89 423,409.63 423,353 423,353 423,353 545.78,353 545.78,353"];
			l3_moe_exp4 -> l3_moe_agg	[pos="e,662,376.55 662,447.92 662,447.92 662,386.55 662,386.55"];
			l3_moe_exp6 -> l3_moe_agg	[pos="e,768.01,342 866.25,447.88 866.25,406.38 866.25,342 866.25,342 866.25,342 778.01,342 778.01,342"];
			l3_moe_agg -> l3_moe_res	[pos="e,686.5,236.55 686.5,307.92 686.5,307.92 686.5,246.55 686.5,246.55"];
		}
		l2_moe_res -> l3_mha_qkv	[pos="e,706.5,1216.5 706.5,1287.9 706.5,1287.9 706.5,1226.5 706.5,1226.5"];
		l2_moe_res -> l3_mha_res	[pos="e,851.5,796.26 851.5,1288 851.5,1288 851.5,806.26 851.5,806.26"];
	}
	input	[fillcolor=lightgreen,
		height=1.041,
		label="Input Embedding
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: all GPUs",
		pos="702,4919.6",
		shape=ellipse,
		width=8.1121];
	input -> l0_mha_qkv	[pos="e,610,4797.3 610,4883.7 610,4883.7 610,4807.3 610,4807.3"];
	input -> l0_mha_res	[pos="e,807,4377.2 807,4884.4 807,4884.4 807,4387.2 807,4387.2"];
	stage0_to_stage1	[fillcolor=gray,
		height=1.8889,
		label="Pipeline Communication
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 0-7 → 8-15",
		pos="710,2489.2",
		shape=parallelogram,
		width=5.8461];
	l1_moe_res -> stage0_to_stage1	[pos="e,710,2557.3 710,2628.8 710,2628.8 710,2567.3 710,2567.3"];
	stage0_to_stage1 -> l2_mha_qkv	[pos="e,623.77,2336.3 623.77,2421.1 623.77,2421.1 623.77,2346.3 623.77,2346.3"];
	stage0_to_stage1 -> l2_mha_res	[pos="e,816.5,1916.2 816.5,2421 816.5,2421 816.5,1926.2 816.5,1926.2"];
	output	[fillcolor=lightgreen,
		height=1.3356,
		label="Final Output
Input: [1024,2048,4096]
Output: [1024,2048,4096]
GPU: 8-15",
		pos="769,48.083",
		shape=ellipse,
		width=3.9873];
	l3_moe_res -> output	[pos="e,769,96.209 769,167.97 769,167.97 769,106.21 769,106.21"];
}
