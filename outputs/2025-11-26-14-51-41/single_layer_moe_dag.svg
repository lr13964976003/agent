<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="155pt"
 viewBox="0.00 0.00 1440.00 155.39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 2173.47)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2173.47 20174.18,-2173.47 20174.18,4 -4,4"/>
<!-- layer_input -->
<g id="node1" class="node">
<title>layer_input</title>
<ellipse fill="lightcyan" stroke="black" cx="15437.18" cy="-2121.39" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="15437.18" y="-2140.19" font-family="Times,serif" font-size="14.00">Layer Input</text>
<text text-anchor="middle" x="15437.18" y="-2125.19" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="15437.18" y="-2110.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15437.18" y="-2095.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- mha_ln -->
<g id="node2" class="node">
<title>mha_ln</title>
<ellipse fill="lightblue" stroke="black" cx="15274.18" cy="-1989.22" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="15274.18" y="-2008.02" font-family="Times,serif" font-size="14.00">MHA LayerNorm</text>
<text text-anchor="middle" x="15274.18" y="-1993.02" font-family="Times,serif" font-size="14.00">GPU: TP&#45;8</text>
<text text-anchor="middle" x="15274.18" y="-1978.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15274.18" y="-1963.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- layer_input&#45;&gt;mha_ln -->
<g id="edge1" class="edge">
<title>layer_input&#45;&gt;mha_ln</title>
<path fill="none" stroke="black" d="M15379.25,-2074.13C15366.6,-2064.02 15353.11,-2053.26 15340.17,-2042.92"/>
<polygon fill="black" stroke="black" points="15342.19,-2040.06 15332.19,-2036.55 15337.82,-2045.53 15342.19,-2040.06"/>
</g>
<!-- mha_res -->
<g id="node5" class="node">
<title>mha_res</title>
<ellipse fill="lightblue" stroke="black" cx="15436.18" cy="-1582.12" rx="298.3" ry="58.88"/>
<text text-anchor="middle" x="15436.18" y="-1608.42" font-family="Times,serif" font-size="14.00">MHA Residual</text>
<text text-anchor="middle" x="15436.18" y="-1593.42" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="15436.18" y="-1578.42" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15436.18" y="-1563.42" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15436.18" y="-1548.42" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- layer_input&#45;&gt;mha_res -->
<g id="edge5" class="edge">
<title>layer_input&#45;&gt;mha_res</title>
<path fill="none" stroke="black" d="M15537.46,-2075.93C15553.8,-2065.17 15569.25,-2052.34 15581.18,-2037.3 15619.32,-1989.23 15612.19,-1965.85 15621.18,-1905.14 15636.04,-1804.74 15671.24,-1762.71 15617.18,-1676.81 15608.36,-1662.79 15596.72,-1650.77 15583.58,-1640.49"/>
<polygon fill="black" stroke="black" points="15585.34,-1637.43 15575.22,-1634.3 15581.18,-1643.06 15585.34,-1637.43"/>
</g>
<!-- mha_qkv -->
<g id="node3" class="node">
<title>mha_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="15233.18" cy="-1857.06" rx="379.02" ry="48.17"/>
<text text-anchor="middle" x="15233.18" y="-1875.86" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15233.18" y="-1860.86" font-family="Times,serif" font-size="14.00">GPU: TP&#45;8</text>
<text text-anchor="middle" x="15233.18" y="-1845.86" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15233.18" y="-1830.86" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
</g>
<!-- mha_ln&#45;&gt;mha_qkv -->
<g id="edge2" class="edge">
<title>mha_ln&#45;&gt;mha_qkv</title>
<path fill="none" stroke="black" d="M15259.26,-1940.86C15256.6,-1932.41 15253.8,-1923.53 15251.07,-1914.85"/>
<polygon fill="black" stroke="black" points="15254.36,-1913.65 15248.02,-1905.16 15247.68,-1915.75 15254.36,-1913.65"/>
</g>
<!-- mha_attn -->
<g id="node4" class="node">
<title>mha_attn</title>
<ellipse fill="lightblue" stroke="black" cx="15237.18" cy="-1724.89" rx="370.55" ry="48.17"/>
<text text-anchor="middle" x="15237.18" y="-1743.69" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15237.18" y="-1728.69" font-family="Times,serif" font-size="14.00">GPU: TP&#45;8</text>
<text text-anchor="middle" x="15237.18" y="-1713.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
<text text-anchor="middle" x="15237.18" y="-1698.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- mha_qkv&#45;&gt;mha_attn -->
<g id="edge3" class="edge">
<title>mha_qkv&#45;&gt;mha_attn</title>
<path fill="none" stroke="black" d="M15234.63,-1808.69C15234.89,-1800.43 15235.15,-1791.74 15235.41,-1783.24"/>
<polygon fill="black" stroke="black" points="15238.92,-1783.1 15235.73,-1773 15231.92,-1782.88 15238.92,-1783.1"/>
</g>
<!-- mha_attn&#45;&gt;mha_res -->
<g id="edge4" class="edge">
<title>mha_attn&#45;&gt;mha_res</title>
<path fill="none" stroke="black" d="M15302.89,-1677.4C15317.6,-1667 15333.43,-1655.8 15348.86,-1644.88"/>
<polygon fill="black" stroke="black" points="15351.24,-1647.49 15357.38,-1638.86 15347.2,-1641.77 15351.24,-1647.49"/>
</g>
<!-- moe_ln -->
<g id="node6" class="node">
<title>moe_ln</title>
<ellipse fill="lightblue" stroke="black" cx="15273.18" cy="-1439.34" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="15273.18" y="-1458.14" font-family="Times,serif" font-size="14.00">MoE LayerNorm</text>
<text text-anchor="middle" x="15273.18" y="-1443.14" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="15273.18" y="-1428.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15273.18" y="-1413.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- mha_res&#45;&gt;moe_ln -->
<g id="edge6" class="edge">
<title>mha_res&#45;&gt;moe_ln</title>
<path fill="none" stroke="black" d="M15370.82,-1524.67C15358.83,-1514.32 15346.36,-1503.54 15334.49,-1493.3"/>
<polygon fill="black" stroke="black" points="15336.65,-1490.54 15326.79,-1486.65 15332.08,-1495.83 15336.65,-1490.54"/>
</g>
<!-- moe_res -->
<g id="node121" class="node">
<title>moe_res</title>
<ellipse fill="lightblue" stroke="black" cx="15453.18" cy="-190.86" rx="298.3" ry="58.88"/>
<text text-anchor="middle" x="15453.18" y="-217.16" font-family="Times,serif" font-size="14.00">MoE Residual</text>
<text text-anchor="middle" x="15453.18" y="-202.16" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="15453.18" y="-187.16" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15453.18" y="-172.16" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15453.18" y="-157.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- mha_res&#45;&gt;moe_res -->
<g id="edge153" class="edge">
<title>mha_res&#45;&gt;moe_res</title>
<path fill="none" stroke="black" d="M15734.1,-1578.33C16772.62,-1566.67 20170.18,-1511.49 20170.18,-1288.26 20170.18,-1288.26 20170.18,-1288.26 20170.18,-524.55 20170.18,-302.72 16807.1,-218.31 15760.34,-197.4"/>
<polygon fill="black" stroke="black" points="15760.1,-193.9 15750.03,-197.2 15759.96,-200.9 15760.1,-193.9"/>
</g>
<!-- gate -->
<g id="node7" class="node">
<title>gate</title>
<polygon fill="lightgreen" stroke="black" points="11126.31,-1355.26 10450.02,-1355.26 10276.04,-1219.26 10952.34,-1219.26 11126.31,-1355.26"/>
<text text-anchor="middle" x="10701.18" y="-1306.06" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10701.18" y="-1291.06" font-family="Times,serif" font-size="14.00">GPU: Routing</text>
<text text-anchor="middle" x="10701.18" y="-1276.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="10701.18" y="-1261.06" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, top_k=2]</text>
</g>
<!-- moe_ln&#45;&gt;gate -->
<g id="edge7" class="edge">
<title>moe_ln&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M14981.97,-1428.78C14181.26,-1402.5 11947.59,-1329.17 11065.85,-1300.23"/>
<polygon fill="black" stroke="black" points="11065.65,-1296.72 11055.54,-1299.89 11065.42,-1303.72 11065.65,-1296.72"/>
</g>
<!-- split_0 -->
<g id="node88" class="node">
<title>split_0</title>
<polygon fill="lightgreen" stroke="black" points="1375.84,-1183.26 676.43,-1183.26 496.51,-1047.26 1195.92,-1047.26 1375.84,-1183.26"/>
<text text-anchor="middle" x="936.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 0</text>
<text text-anchor="middle" x="936.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="936.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="936.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_0 -->
<g id="edge8" class="edge">
<title>gate&#45;&gt;split_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10360.82,-1285.58C8939.35,-1282.24 3471.02,-1264.28 1747.18,-1183.26 1617.59,-1177.17 1476.62,-1166.83 1349.11,-1156.07"/>
<polygon fill="black" stroke="black" points="1349.04,-1152.55 1338.78,-1155.19 1348.45,-1159.52 1349.04,-1152.55"/>
</g>
<!-- split_1 -->
<g id="node90" class="node">
<title>split_1</title>
<polygon fill="lightgreen" stroke="black" points="2635.84,-1183.26 1936.43,-1183.26 1756.51,-1047.26 2455.92,-1047.26 2635.84,-1183.26"/>
<text text-anchor="middle" x="2196.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 1</text>
<text text-anchor="middle" x="2196.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="2196.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="2196.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_1 -->
<g id="edge17" class="edge">
<title>gate&#45;&gt;split_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10359.81,-1284.83C9066.76,-1278.92 4469.33,-1253.36 3007.18,-1183.26 2877.51,-1177.04 2736.44,-1166.66 2608.87,-1155.9"/>
<polygon fill="black" stroke="black" points="2608.79,-1152.38 2598.53,-1155.02 2608.2,-1159.35 2608.79,-1152.38"/>
</g>
<!-- split_2 -->
<g id="node92" class="node">
<title>split_2</title>
<polygon fill="lightgreen" stroke="black" points="3895.84,-1183.26 3196.43,-1183.26 3016.51,-1047.26 3715.92,-1047.26 3895.84,-1183.26"/>
<text text-anchor="middle" x="3456.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 2</text>
<text text-anchor="middle" x="3456.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3456.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="3456.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_2 -->
<g id="edge26" class="edge">
<title>gate&#45;&gt;split_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10358.55,-1283.78C9205.23,-1274.97 5469.19,-1242.47 4267.18,-1183.26 4137.43,-1176.87 3996.27,-1166.42 3868.62,-1155.66"/>
<polygon fill="black" stroke="black" points="3868.54,-1152.15 3858.28,-1154.79 3867.95,-1159.12 3868.54,-1152.15"/>
</g>
<!-- split_3 -->
<g id="node94" class="node">
<title>split_3</title>
<polygon fill="lightgreen" stroke="black" points="5155.84,-1183.26 4456.43,-1183.26 4276.51,-1047.26 4975.92,-1047.26 5155.84,-1183.26"/>
<text text-anchor="middle" x="4716.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 3</text>
<text text-anchor="middle" x="4716.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4716.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="4716.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_3 -->
<g id="edge35" class="edge">
<title>gate&#45;&gt;split_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10362.29,-1286.84C9535.45,-1286.65 7348.91,-1276.55 5527.18,-1183.26 5397.14,-1176.6 5255.63,-1166.05 5127.75,-1155.28"/>
<polygon fill="black" stroke="black" points="5128.04,-1151.79 5117.78,-1154.44 5127.45,-1158.77 5128.04,-1151.79"/>
</g>
<!-- split_4 -->
<g id="node96" class="node">
<title>split_4</title>
<polygon fill="lightgreen" stroke="black" points="6415.84,-1183.26 5716.43,-1183.26 5536.51,-1047.26 6235.92,-1047.26 6415.84,-1183.26"/>
<text text-anchor="middle" x="5976.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 4</text>
<text text-anchor="middle" x="5976.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5976.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="5976.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_4 -->
<g id="edge44" class="edge">
<title>gate&#45;&gt;split_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10358.32,-1283.7C9677.27,-1277.18 8105.85,-1255.02 6787.18,-1183.26 6656.91,-1176.17 6515.09,-1165.48 6387.01,-1154.7"/>
<polygon fill="black" stroke="black" points="6387.29,-1151.21 6377.03,-1153.86 6386.7,-1158.19 6387.29,-1151.21"/>
</g>
<!-- split_5 -->
<g id="node98" class="node">
<title>split_5</title>
<polygon fill="lightgreen" stroke="black" points="7675.84,-1183.26 6976.43,-1183.26 6796.51,-1047.26 7495.92,-1047.26 7675.84,-1183.26"/>
<text text-anchor="middle" x="7236.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 5</text>
<text text-anchor="middle" x="7236.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7236.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="7236.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_5 -->
<g id="edge53" class="edge">
<title>gate&#45;&gt;split_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10350.5,-1277.52C9842.38,-1263.76 8871.91,-1233.31 8047.18,-1183.26 7916.44,-1175.33 7774.03,-1164.35 7645.55,-1153.58"/>
<polygon fill="black" stroke="black" points="7645.8,-1150.09 7635.54,-1152.74 7645.21,-1157.06 7645.8,-1150.09"/>
</g>
<!-- split_6 -->
<g id="node100" class="node">
<title>split_6</title>
<polygon fill="lightgreen" stroke="black" points="8935.84,-1183.26 8236.43,-1183.26 8056.51,-1047.26 8755.92,-1047.26 8935.84,-1183.26"/>
<text text-anchor="middle" x="8496.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 6</text>
<text text-anchor="middle" x="8496.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8496.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="8496.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_6 -->
<g id="edge62" class="edge">
<title>gate&#45;&gt;split_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10327.25,-1259.51C10046.53,-1239.22 9652.69,-1210.3 9307.18,-1183.26 9175.14,-1172.93 9031.05,-1161.18 8901.44,-1150.43"/>
<polygon fill="black" stroke="black" points="8901.6,-1146.94 8891.34,-1149.6 8901.02,-1153.91 8901.6,-1146.94"/>
</g>
<!-- split_7 -->
<g id="node102" class="node">
<title>split_7</title>
<polygon fill="lightgreen" stroke="black" points="10195.84,-1183.26 9496.43,-1183.26 9316.51,-1047.26 10015.92,-1047.26 10195.84,-1183.26"/>
<text text-anchor="middle" x="9756.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 7</text>
<text text-anchor="middle" x="9756.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9756.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="9756.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_7 -->
<g id="edge71" class="edge">
<title>gate&#45;&gt;split_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10328.71,-1219.25C10266.34,-1208.03 10201.53,-1196.38 10138.91,-1185.11"/>
<polygon fill="black" stroke="black" points="10139.34,-1181.63 10128.88,-1183.31 10138.1,-1188.52 10139.34,-1181.63"/>
</g>
<!-- split_8 -->
<g id="node104" class="node">
<title>split_8</title>
<polygon fill="lightgreen" stroke="black" points="11140.84,-1183.26 10441.43,-1183.26 10261.51,-1047.26 10960.92,-1047.26 11140.84,-1183.26"/>
<text text-anchor="middle" x="10701.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 8</text>
<text text-anchor="middle" x="10701.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10701.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="10701.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_8 -->
<g id="edge80" class="edge">
<title>gate&#45;&gt;split_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10701.18,-1219.07C10701.18,-1210.76 10701.18,-1202.21 10701.18,-1193.75"/>
<polygon fill="black" stroke="black" points="10704.68,-1193.52 10701.18,-1183.52 10697.68,-1193.52 10704.68,-1193.52"/>
</g>
<!-- split_9 -->
<g id="node106" class="node">
<title>split_9</title>
<polygon fill="lightgreen" stroke="black" points="12085.84,-1183.26 11386.43,-1183.26 11206.51,-1047.26 11905.92,-1047.26 12085.84,-1183.26"/>
<text text-anchor="middle" x="11646.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 9</text>
<text text-anchor="middle" x="11646.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11646.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="11646.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_9 -->
<g id="edge89" class="edge">
<title>gate&#45;&gt;split_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10975.14,-1236.97C11094.03,-1215.59 11233.4,-1190.52 11354.23,-1168.78"/>
<polygon fill="black" stroke="black" points="11355.16,-1172.17 11364.38,-1166.95 11353.92,-1165.28 11355.16,-1172.17"/>
</g>
<!-- split_10 -->
<g id="node108" class="node">
<title>split_10</title>
<polygon fill="lightgreen" stroke="black" points="13345.84,-1183.26 12646.43,-1183.26 12466.51,-1047.26 13165.92,-1047.26 13345.84,-1183.26"/>
<text text-anchor="middle" x="12906.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 10</text>
<text text-anchor="middle" x="12906.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12906.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="12906.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_10 -->
<g id="edge98" class="edge">
<title>gate&#45;&gt;split_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11009.91,-1264.22C11292.43,-1243.87 11721.99,-1212.46 12095.18,-1183.26 12255.75,-1170.69 12434.15,-1156.03 12582.65,-1143.63"/>
<polygon fill="black" stroke="black" points="12583.16,-1147.1 12592.83,-1142.78 12582.58,-1140.13 12583.16,-1147.1"/>
</g>
<!-- split_11 -->
<g id="node110" class="node">
<title>split_11</title>
<polygon fill="lightgreen" stroke="black" points="14605.84,-1183.26 13906.43,-1183.26 13726.51,-1047.26 14425.92,-1047.26 14605.84,-1183.26"/>
<text text-anchor="middle" x="14166.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 11</text>
<text text-anchor="middle" x="14166.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14166.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14166.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_11 -->
<g id="edge107" class="edge">
<title>gate&#45;&gt;split_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11027.75,-1278.17C11528.8,-1264.73 12517.21,-1234.11 13355.18,-1183.26 13516.98,-1173.44 13696.66,-1158.96 13845.69,-1145.98"/>
<polygon fill="black" stroke="black" points="13846.25,-1149.44 13855.91,-1145.08 13845.64,-1142.47 13846.25,-1149.44"/>
</g>
<!-- split_12 -->
<g id="node112" class="node">
<title>split_12</title>
<polygon fill="lightgreen" stroke="black" points="15865.84,-1183.26 15166.43,-1183.26 14986.51,-1047.26 15685.92,-1047.26 15865.84,-1183.26"/>
<text text-anchor="middle" x="15426.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 12</text>
<text text-anchor="middle" x="15426.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="15426.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15426.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_12 -->
<g id="edge116" class="edge">
<title>gate&#45;&gt;split_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11034.89,-1283.79C11710.93,-1277.38 13290.56,-1255.35 14615.18,-1183.26 14777.38,-1174.43 14957.49,-1160.02 15106.69,-1146.82"/>
<polygon fill="black" stroke="black" points="15107.27,-1150.28 15116.93,-1145.91 15106.66,-1143.31 15107.27,-1150.28"/>
</g>
<!-- split_13 -->
<g id="node114" class="node">
<title>split_13</title>
<polygon fill="lightgreen" stroke="black" points="17125.84,-1183.26 16426.43,-1183.26 16246.51,-1047.26 16945.92,-1047.26 17125.84,-1183.26"/>
<text text-anchor="middle" x="16686.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 13</text>
<text text-anchor="middle" x="16686.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16686.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="16686.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_13 -->
<g id="edge125" class="edge">
<title>gate&#45;&gt;split_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11038.92,-1286.84C11864.88,-1286.66 14052.61,-1276.59 15875.18,-1183.26 16037.58,-1174.94 16217.9,-1160.56 16367.19,-1147.25"/>
<polygon fill="black" stroke="black" points="16367.78,-1150.71 16377.43,-1146.33 16367.16,-1143.74 16367.78,-1150.71"/>
</g>
<!-- split_14 -->
<g id="node116" class="node">
<title>split_14</title>
<polygon fill="lightgreen" stroke="black" points="18385.84,-1183.26 17686.43,-1183.26 17506.51,-1047.26 18205.92,-1047.26 18385.84,-1183.26"/>
<text text-anchor="middle" x="17946.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 14</text>
<text text-anchor="middle" x="17946.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17946.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="17946.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_14 -->
<g id="edge134" class="edge">
<title>gate&#45;&gt;split_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11035.07,-1283.85C12178.14,-1275.14 15930.11,-1242.62 17135.18,-1183.26 17297.6,-1175.26 17477.92,-1160.91 17627.21,-1147.53"/>
<polygon fill="black" stroke="black" points="17627.8,-1150.99 17637.45,-1146.61 17627.17,-1144.02 17627.8,-1150.99"/>
</g>
<!-- split_15 -->
<g id="node118" class="node">
<title>split_15</title>
<polygon fill="lightgreen" stroke="black" points="19645.84,-1183.26 18946.43,-1183.26 18766.51,-1047.26 19465.92,-1047.26 19645.84,-1183.26"/>
<text text-anchor="middle" x="19206.18" y="-1134.06" font-family="Times,serif" font-size="14.00">Token Split 15</text>
<text text-anchor="middle" x="19206.18" y="-1119.06" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19206.18" y="-1104.06" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="19206.18" y="-1089.06" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_15 -->
<g id="edge143" class="edge">
<title>gate&#45;&gt;split_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11036.49,-1284.86C12321.16,-1279 16930.73,-1253.47 18395.18,-1183.26 18557.78,-1175.46 18738.31,-1161.11 18887.69,-1147.68"/>
<polygon fill="black" stroke="black" points="18888.29,-1151.14 18897.94,-1146.76 18887.66,-1144.17 18888.29,-1151.14"/>
</g>
<!-- expert_0_gate -->
<g id="node8" class="node">
<title>expert_0_gate</title>
<ellipse fill="lightblue" stroke="black" cx="306.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="306.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="306.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="306.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="306.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_0_act -->
<g id="node10" class="node">
<title>expert_0_act</title>
<ellipse fill="lightblue" stroke="black" cx="309.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="309.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="309.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="309.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="309.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_0_gate&#45;&gt;expert_0_act -->
<g id="edge11" class="edge">
<title>expert_0_gate&#45;&gt;expert_0_act</title>
<path fill="none" stroke="black" d="M307.27,-914.81C307.46,-906.55 307.66,-897.86 307.86,-889.36"/>
<polygon fill="black" stroke="black" points="311.36,-889.2 308.09,-879.12 304.36,-889.03 311.36,-889.2"/>
</g>
<!-- expert_0_up -->
<g id="node9" class="node">
<title>expert_0_up</title>
<ellipse fill="lightblue" stroke="black" cx="936.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="936.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="936.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="936.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="936.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_0_down -->
<g id="node12" class="node">
<title>expert_0_down</title>
<ellipse fill="lightblue" stroke="black" cx="936.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="936.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="936.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="936.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="936.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_0_up&#45;&gt;expert_0_down -->
<g id="edge12" class="edge">
<title>expert_0_up&#45;&gt;expert_0_down</title>
<path fill="none" stroke="black" d="M936.18,-914.81C936.18,-906.55 936.18,-897.86 936.18,-889.36"/>
<polygon fill="black" stroke="black" points="939.68,-889.12 936.18,-879.12 932.68,-889.12 939.68,-889.12"/>
</g>
<!-- expert_0_mul -->
<g id="node11" class="node">
<title>expert_0_mul</title>
<ellipse fill="lightblue" stroke="black" cx="936.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="936.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 0 Gate Mul</text>
<text text-anchor="middle" x="936.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="936.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="936.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="936.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_0_act&#45;&gt;expert_0_mul -->
<g id="edge13" class="edge">
<title>expert_0_act&#45;&gt;expert_0_mul</title>
<path fill="none" stroke="black" d="M481.75,-791.26C558.41,-774.05 649.25,-753.66 729.5,-735.64"/>
<polygon fill="black" stroke="black" points="730.74,-738.95 739.73,-733.34 729.21,-732.12 730.74,-738.95"/>
</g>
<!-- agg_0 -->
<g id="node89" class="node">
<title>agg_0</title>
<polygon fill="lightgreen" stroke="black" points="1376.7,-593.55 680.7,-593.55 501.66,-457.55 1197.65,-457.55 1376.7,-593.55"/>
<text text-anchor="middle" x="939.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 0</text>
<text text-anchor="middle" x="939.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="939.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="939.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_0_mul&#45;&gt;agg_0 -->
<g id="edge15" class="edge">
<title>expert_0_mul&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M937.26,-629.22C937.41,-620.95 937.58,-612.34 937.74,-603.77"/>
<polygon fill="black" stroke="black" points="941.23,-603.83 937.92,-593.76 934.24,-603.7 941.23,-603.83"/>
</g>
<!-- expert_0_down&#45;&gt;expert_0_mul -->
<g id="edge14" class="edge">
<title>expert_0_down&#45;&gt;expert_0_mul</title>
<path fill="none" stroke="black" d="M936.18,-782.74C936.18,-774.59 936.18,-765.97 936.18,-757.4"/>
<polygon fill="black" stroke="black" points="939.68,-757.38 936.18,-747.38 932.68,-757.38 939.68,-757.38"/>
</g>
<!-- expert_1_gate -->
<g id="node13" class="node">
<title>expert_1_gate</title>
<ellipse fill="lightblue" stroke="black" cx="1566.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="1566.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1566.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1566.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="1566.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_1_act -->
<g id="node15" class="node">
<title>expert_1_act</title>
<ellipse fill="lightblue" stroke="black" cx="1569.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="1569.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1569.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1569.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="1569.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_1_gate&#45;&gt;expert_1_act -->
<g id="edge20" class="edge">
<title>expert_1_gate&#45;&gt;expert_1_act</title>
<path fill="none" stroke="black" d="M1567.27,-914.81C1567.46,-906.55 1567.66,-897.86 1567.86,-889.36"/>
<polygon fill="black" stroke="black" points="1571.36,-889.2 1568.09,-879.12 1564.36,-889.03 1571.36,-889.2"/>
</g>
<!-- expert_1_up -->
<g id="node14" class="node">
<title>expert_1_up</title>
<ellipse fill="lightblue" stroke="black" cx="2196.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="2196.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="2196.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="2196.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="2196.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_1_down -->
<g id="node17" class="node">
<title>expert_1_down</title>
<ellipse fill="lightblue" stroke="black" cx="2196.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="2196.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2196.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="2196.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2196.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_1_up&#45;&gt;expert_1_down -->
<g id="edge21" class="edge">
<title>expert_1_up&#45;&gt;expert_1_down</title>
<path fill="none" stroke="black" d="M2196.18,-914.81C2196.18,-906.55 2196.18,-897.86 2196.18,-889.36"/>
<polygon fill="black" stroke="black" points="2199.68,-889.12 2196.18,-879.12 2192.68,-889.12 2199.68,-889.12"/>
</g>
<!-- expert_1_mul -->
<g id="node16" class="node">
<title>expert_1_mul</title>
<ellipse fill="lightblue" stroke="black" cx="2196.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="2196.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 1 Gate Mul</text>
<text text-anchor="middle" x="2196.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="2196.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2196.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2196.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_1_act&#45;&gt;expert_1_mul -->
<g id="edge22" class="edge">
<title>expert_1_act&#45;&gt;expert_1_mul</title>
<path fill="none" stroke="black" d="M1741.75,-791.26C1818.41,-774.05 1909.25,-753.66 1989.5,-735.64"/>
<polygon fill="black" stroke="black" points="1990.74,-738.95 1999.73,-733.34 1989.21,-732.12 1990.74,-738.95"/>
</g>
<!-- agg_1 -->
<g id="node91" class="node">
<title>agg_1</title>
<polygon fill="lightgreen" stroke="black" points="3605.7,-593.55 2909.7,-593.55 2730.66,-457.55 3426.65,-457.55 3605.7,-593.55"/>
<text text-anchor="middle" x="3168.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 1</text>
<text text-anchor="middle" x="3168.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="3168.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="3168.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_1_mul&#45;&gt;agg_1 -->
<g id="edge24" class="edge">
<title>expert_1_mul&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2425.6,-649.31C2559.35,-627.2 2729.44,-599.08 2873.08,-575.33"/>
<polygon fill="black" stroke="black" points="2874.08,-578.71 2883.38,-573.63 2872.94,-571.81 2874.08,-578.71"/>
</g>
<!-- expert_1_down&#45;&gt;expert_1_mul -->
<g id="edge23" class="edge">
<title>expert_1_down&#45;&gt;expert_1_mul</title>
<path fill="none" stroke="black" d="M2196.18,-782.74C2196.18,-774.59 2196.18,-765.97 2196.18,-757.4"/>
<polygon fill="black" stroke="black" points="2199.68,-757.38 2196.18,-747.38 2192.68,-757.38 2199.68,-757.38"/>
</g>
<!-- expert_2_gate -->
<g id="node18" class="node">
<title>expert_2_gate</title>
<ellipse fill="lightblue" stroke="black" cx="2826.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="2826.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2826.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="2826.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="2826.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_2_act -->
<g id="node20" class="node">
<title>expert_2_act</title>
<ellipse fill="lightblue" stroke="black" cx="2829.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="2829.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2829.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="2829.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2829.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_2_gate&#45;&gt;expert_2_act -->
<g id="edge29" class="edge">
<title>expert_2_gate&#45;&gt;expert_2_act</title>
<path fill="none" stroke="black" d="M2827.27,-914.81C2827.46,-906.55 2827.66,-897.86 2827.86,-889.36"/>
<polygon fill="black" stroke="black" points="2831.36,-889.2 2828.09,-879.12 2824.36,-889.03 2831.36,-889.2"/>
</g>
<!-- expert_2_up -->
<g id="node19" class="node">
<title>expert_2_up</title>
<ellipse fill="lightblue" stroke="black" cx="3456.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="3456.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="3456.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3456.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="3456.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_2_down -->
<g id="node22" class="node">
<title>expert_2_down</title>
<ellipse fill="lightblue" stroke="black" cx="3456.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="3456.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="3456.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3456.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3456.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_2_up&#45;&gt;expert_2_down -->
<g id="edge30" class="edge">
<title>expert_2_up&#45;&gt;expert_2_down</title>
<path fill="none" stroke="black" d="M3456.18,-914.81C3456.18,-906.55 3456.18,-897.86 3456.18,-889.36"/>
<polygon fill="black" stroke="black" points="3459.68,-889.12 3456.18,-879.12 3452.68,-889.12 3459.68,-889.12"/>
</g>
<!-- expert_2_mul -->
<g id="node21" class="node">
<title>expert_2_mul</title>
<ellipse fill="lightblue" stroke="black" cx="3456.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="3456.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 2 Gate Mul</text>
<text text-anchor="middle" x="3456.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3456.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3456.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3456.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_2_act&#45;&gt;expert_2_mul -->
<g id="edge31" class="edge">
<title>expert_2_act&#45;&gt;expert_2_mul</title>
<path fill="none" stroke="black" d="M3001.75,-791.26C3078.41,-774.05 3169.25,-753.66 3249.5,-735.64"/>
<polygon fill="black" stroke="black" points="3250.74,-738.95 3259.73,-733.34 3249.21,-732.12 3250.74,-738.95"/>
</g>
<!-- agg_2 -->
<g id="node93" class="node">
<title>agg_2</title>
<polygon fill="lightgreen" stroke="black" points="5166.7,-593.55 4470.7,-593.55 4291.66,-457.55 4987.65,-457.55 5166.7,-593.55"/>
<text text-anchor="middle" x="4729.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 2</text>
<text text-anchor="middle" x="4729.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="4729.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="4729.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_2_mul&#45;&gt;agg_2 -->
<g id="edge33" class="edge">
<title>expert_2_mul&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3709.58,-655.25C3914.48,-629.38 4203.72,-592.87 4421.82,-565.34"/>
<polygon fill="black" stroke="black" points="4422.34,-568.81 4431.83,-564.08 4421.47,-561.86 4422.34,-568.81"/>
</g>
<!-- expert_2_down&#45;&gt;expert_2_mul -->
<g id="edge32" class="edge">
<title>expert_2_down&#45;&gt;expert_2_mul</title>
<path fill="none" stroke="black" d="M3456.18,-782.74C3456.18,-774.59 3456.18,-765.97 3456.18,-757.4"/>
<polygon fill="black" stroke="black" points="3459.68,-757.38 3456.18,-747.38 3452.68,-757.38 3459.68,-757.38"/>
</g>
<!-- expert_3_gate -->
<g id="node23" class="node">
<title>expert_3_gate</title>
<ellipse fill="lightblue" stroke="black" cx="4086.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="4086.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="4086.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4086.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="4086.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_3_act -->
<g id="node25" class="node">
<title>expert_3_act</title>
<ellipse fill="lightblue" stroke="black" cx="4089.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="4089.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="4089.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4089.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4089.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_3_gate&#45;&gt;expert_3_act -->
<g id="edge38" class="edge">
<title>expert_3_gate&#45;&gt;expert_3_act</title>
<path fill="none" stroke="black" d="M4087.27,-914.81C4087.46,-906.55 4087.66,-897.86 4087.86,-889.36"/>
<polygon fill="black" stroke="black" points="4091.36,-889.2 4088.09,-879.12 4084.36,-889.03 4091.36,-889.2"/>
</g>
<!-- expert_3_up -->
<g id="node24" class="node">
<title>expert_3_up</title>
<ellipse fill="lightblue" stroke="black" cx="4716.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="4716.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="4716.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4716.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="4716.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_3_down -->
<g id="node27" class="node">
<title>expert_3_down</title>
<ellipse fill="lightblue" stroke="black" cx="4716.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="4716.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="4716.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4716.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4716.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_3_up&#45;&gt;expert_3_down -->
<g id="edge39" class="edge">
<title>expert_3_up&#45;&gt;expert_3_down</title>
<path fill="none" stroke="black" d="M4716.18,-914.81C4716.18,-906.55 4716.18,-897.86 4716.18,-889.36"/>
<polygon fill="black" stroke="black" points="4719.68,-889.12 4716.18,-879.12 4712.68,-889.12 4719.68,-889.12"/>
</g>
<!-- expert_3_mul -->
<g id="node26" class="node">
<title>expert_3_mul</title>
<ellipse fill="lightblue" stroke="black" cx="4716.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="4716.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 3 Gate Mul</text>
<text text-anchor="middle" x="4716.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4716.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4716.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4716.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_3_act&#45;&gt;expert_3_mul -->
<g id="edge40" class="edge">
<title>expert_3_act&#45;&gt;expert_3_mul</title>
<path fill="none" stroke="black" d="M4261.75,-791.26C4338.41,-774.05 4429.25,-753.66 4509.5,-735.64"/>
<polygon fill="black" stroke="black" points="4510.74,-738.95 4519.73,-733.34 4509.21,-732.12 4510.74,-738.95"/>
</g>
<!-- agg_3 -->
<g id="node95" class="node">
<title>agg_3</title>
<polygon fill="lightgreen" stroke="black" points="6393.7,-593.55 5697.7,-593.55 5518.66,-457.55 6214.65,-457.55 6393.7,-593.55"/>
<text text-anchor="middle" x="5956.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 3</text>
<text text-anchor="middle" x="5956.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="5956.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="5956.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_3_mul&#45;&gt;agg_3 -->
<g id="edge42" class="edge">
<title>expert_3_mul&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M4967.48,-654.67C5164.66,-629.12 5439.96,-593.44 5650.01,-566.22"/>
<polygon fill="black" stroke="black" points="5650.49,-569.69 5659.96,-564.93 5649.59,-562.75 5650.49,-569.69"/>
</g>
<!-- expert_3_down&#45;&gt;expert_3_mul -->
<g id="edge41" class="edge">
<title>expert_3_down&#45;&gt;expert_3_mul</title>
<path fill="none" stroke="black" d="M4716.18,-782.74C4716.18,-774.59 4716.18,-765.97 4716.18,-757.4"/>
<polygon fill="black" stroke="black" points="4719.68,-757.38 4716.18,-747.38 4712.68,-757.38 4719.68,-757.38"/>
</g>
<!-- expert_4_gate -->
<g id="node28" class="node">
<title>expert_4_gate</title>
<ellipse fill="lightblue" stroke="black" cx="5346.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="5346.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="5346.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5346.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="5346.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_4_act -->
<g id="node30" class="node">
<title>expert_4_act</title>
<ellipse fill="lightblue" stroke="black" cx="5349.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="5349.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="5349.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5349.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5349.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_4_gate&#45;&gt;expert_4_act -->
<g id="edge47" class="edge">
<title>expert_4_gate&#45;&gt;expert_4_act</title>
<path fill="none" stroke="black" d="M5347.27,-914.81C5347.46,-906.55 5347.66,-897.86 5347.86,-889.36"/>
<polygon fill="black" stroke="black" points="5351.36,-889.2 5348.09,-879.12 5344.36,-889.03 5351.36,-889.2"/>
</g>
<!-- expert_4_up -->
<g id="node29" class="node">
<title>expert_4_up</title>
<ellipse fill="lightblue" stroke="black" cx="5976.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="5976.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="5976.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5976.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="5976.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_4_down -->
<g id="node32" class="node">
<title>expert_4_down</title>
<ellipse fill="lightblue" stroke="black" cx="5976.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="5976.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="5976.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5976.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5976.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_4_up&#45;&gt;expert_4_down -->
<g id="edge48" class="edge">
<title>expert_4_up&#45;&gt;expert_4_down</title>
<path fill="none" stroke="black" d="M5976.18,-914.81C5976.18,-906.55 5976.18,-897.86 5976.18,-889.36"/>
<polygon fill="black" stroke="black" points="5979.68,-889.12 5976.18,-879.12 5972.68,-889.12 5979.68,-889.12"/>
</g>
<!-- expert_4_mul -->
<g id="node31" class="node">
<title>expert_4_mul</title>
<ellipse fill="lightblue" stroke="black" cx="5976.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="5976.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 4 Gate Mul</text>
<text text-anchor="middle" x="5976.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5976.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5976.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5976.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_4_act&#45;&gt;expert_4_mul -->
<g id="edge49" class="edge">
<title>expert_4_act&#45;&gt;expert_4_mul</title>
<path fill="none" stroke="black" d="M5521.75,-791.26C5598.41,-774.05 5689.25,-753.66 5769.5,-735.64"/>
<polygon fill="black" stroke="black" points="5770.74,-738.95 5779.73,-733.34 5769.21,-732.12 5770.74,-738.95"/>
</g>
<!-- agg_4 -->
<g id="node97" class="node">
<title>agg_4</title>
<polygon fill="lightgreen" stroke="black" points="7453.7,-593.55 6757.7,-593.55 6578.66,-457.55 7274.65,-457.55 7453.7,-593.55"/>
<text text-anchor="middle" x="7016.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 4</text>
<text text-anchor="middle" x="7016.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="7016.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="7016.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_4_mul&#45;&gt;agg_4 -->
<g id="edge51" class="edge">
<title>expert_4_mul&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M6212.17,-650.77C6362,-627.62 6557.22,-597.46 6717.77,-572.65"/>
<polygon fill="black" stroke="black" points="6718.46,-576.09 6727.81,-571.1 6717.39,-569.17 6718.46,-576.09"/>
</g>
<!-- expert_4_down&#45;&gt;expert_4_mul -->
<g id="edge50" class="edge">
<title>expert_4_down&#45;&gt;expert_4_mul</title>
<path fill="none" stroke="black" d="M5976.18,-782.74C5976.18,-774.59 5976.18,-765.97 5976.18,-757.4"/>
<polygon fill="black" stroke="black" points="5979.68,-757.38 5976.18,-747.38 5972.68,-757.38 5979.68,-757.38"/>
</g>
<!-- expert_5_gate -->
<g id="node33" class="node">
<title>expert_5_gate</title>
<ellipse fill="lightblue" stroke="black" cx="6606.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="6606.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="6606.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="6606.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="6606.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_5_act -->
<g id="node35" class="node">
<title>expert_5_act</title>
<ellipse fill="lightblue" stroke="black" cx="6609.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="6609.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="6609.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="6609.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="6609.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_5_gate&#45;&gt;expert_5_act -->
<g id="edge56" class="edge">
<title>expert_5_gate&#45;&gt;expert_5_act</title>
<path fill="none" stroke="black" d="M6607.27,-914.81C6607.46,-906.55 6607.66,-897.86 6607.86,-889.36"/>
<polygon fill="black" stroke="black" points="6611.36,-889.2 6608.09,-879.12 6604.36,-889.03 6611.36,-889.2"/>
</g>
<!-- expert_5_up -->
<g id="node34" class="node">
<title>expert_5_up</title>
<ellipse fill="lightblue" stroke="black" cx="7236.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="7236.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="7236.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7236.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="7236.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_5_down -->
<g id="node37" class="node">
<title>expert_5_down</title>
<ellipse fill="lightblue" stroke="black" cx="7236.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="7236.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="7236.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7236.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7236.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_5_up&#45;&gt;expert_5_down -->
<g id="edge57" class="edge">
<title>expert_5_up&#45;&gt;expert_5_down</title>
<path fill="none" stroke="black" d="M7236.18,-914.81C7236.18,-906.55 7236.18,-897.86 7236.18,-889.36"/>
<polygon fill="black" stroke="black" points="7239.68,-889.12 7236.18,-879.12 7232.68,-889.12 7239.68,-889.12"/>
</g>
<!-- expert_5_mul -->
<g id="node36" class="node">
<title>expert_5_mul</title>
<ellipse fill="lightblue" stroke="black" cx="7236.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="7236.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 5 Gate Mul</text>
<text text-anchor="middle" x="7236.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7236.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7236.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7236.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_5_act&#45;&gt;expert_5_mul -->
<g id="edge58" class="edge">
<title>expert_5_act&#45;&gt;expert_5_mul</title>
<path fill="none" stroke="black" d="M6781.75,-791.26C6858.41,-774.05 6949.25,-753.66 7029.5,-735.64"/>
<polygon fill="black" stroke="black" points="7030.74,-738.95 7039.73,-733.34 7029.21,-732.12 7030.74,-738.95"/>
</g>
<!-- agg_5 -->
<g id="node99" class="node">
<title>agg_5</title>
<polygon fill="lightgreen" stroke="black" points="8430.7,-593.55 7734.7,-593.55 7555.66,-457.55 8251.65,-457.55 8430.7,-593.55"/>
<text text-anchor="middle" x="7993.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 5</text>
<text text-anchor="middle" x="7993.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7993.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="7993.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_5_mul&#45;&gt;agg_5 -->
<g id="edge60" class="edge">
<title>expert_5_mul&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M7439.04,-644.17C7522.92,-626.37 7621.58,-605.43 7712.23,-586.18"/>
<polygon fill="black" stroke="black" points="7713.05,-589.59 7722.11,-584.09 7711.6,-582.74 7713.05,-589.59"/>
</g>
<!-- expert_5_down&#45;&gt;expert_5_mul -->
<g id="edge59" class="edge">
<title>expert_5_down&#45;&gt;expert_5_mul</title>
<path fill="none" stroke="black" d="M7236.18,-782.74C7236.18,-774.59 7236.18,-765.97 7236.18,-757.4"/>
<polygon fill="black" stroke="black" points="7239.68,-757.38 7236.18,-747.38 7232.68,-757.38 7239.68,-757.38"/>
</g>
<!-- expert_6_gate -->
<g id="node38" class="node">
<title>expert_6_gate</title>
<ellipse fill="lightblue" stroke="black" cx="7866.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="7866.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="7866.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="7866.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="7866.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_6_act -->
<g id="node40" class="node">
<title>expert_6_act</title>
<ellipse fill="lightblue" stroke="black" cx="7869.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="7869.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="7869.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="7869.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7869.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_6_gate&#45;&gt;expert_6_act -->
<g id="edge65" class="edge">
<title>expert_6_gate&#45;&gt;expert_6_act</title>
<path fill="none" stroke="black" d="M7867.27,-914.81C7867.46,-906.55 7867.66,-897.86 7867.86,-889.36"/>
<polygon fill="black" stroke="black" points="7871.36,-889.2 7868.09,-879.12 7864.36,-889.03 7871.36,-889.2"/>
</g>
<!-- expert_6_up -->
<g id="node39" class="node">
<title>expert_6_up</title>
<ellipse fill="lightblue" stroke="black" cx="8496.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="8496.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="8496.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8496.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="8496.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_6_down -->
<g id="node42" class="node">
<title>expert_6_down</title>
<ellipse fill="lightblue" stroke="black" cx="8496.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="8496.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="8496.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8496.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8496.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_6_up&#45;&gt;expert_6_down -->
<g id="edge66" class="edge">
<title>expert_6_up&#45;&gt;expert_6_down</title>
<path fill="none" stroke="black" d="M8496.18,-914.81C8496.18,-906.55 8496.18,-897.86 8496.18,-889.36"/>
<polygon fill="black" stroke="black" points="8499.68,-889.12 8496.18,-879.12 8492.68,-889.12 8499.68,-889.12"/>
</g>
<!-- expert_6_mul -->
<g id="node41" class="node">
<title>expert_6_mul</title>
<ellipse fill="lightblue" stroke="black" cx="8496.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="8496.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 6 Gate Mul</text>
<text text-anchor="middle" x="8496.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8496.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8496.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8496.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_6_act&#45;&gt;expert_6_mul -->
<g id="edge67" class="edge">
<title>expert_6_act&#45;&gt;expert_6_mul</title>
<path fill="none" stroke="black" d="M8041.75,-791.26C8118.41,-774.05 8209.25,-753.66 8289.5,-735.64"/>
<polygon fill="black" stroke="black" points="8290.74,-738.95 8299.73,-733.34 8289.21,-732.12 8290.74,-738.95"/>
</g>
<!-- agg_6 -->
<g id="node101" class="node">
<title>agg_6</title>
<polygon fill="lightgreen" stroke="black" points="9365.7,-593.55 8669.7,-593.55 8490.66,-457.55 9186.65,-457.55 9365.7,-593.55"/>
<text text-anchor="middle" x="8928.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 6</text>
<text text-anchor="middle" x="8928.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8928.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="8928.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_6_mul&#45;&gt;agg_6 -->
<g id="edge69" class="edge">
<title>expert_6_mul&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8634.35,-635.84C8667.55,-623.49 8703.58,-610.09 8738.66,-597.04"/>
<polygon fill="black" stroke="black" points="8739.89,-600.32 8748.04,-593.55 8737.45,-593.76 8739.89,-600.32"/>
</g>
<!-- expert_6_down&#45;&gt;expert_6_mul -->
<g id="edge68" class="edge">
<title>expert_6_down&#45;&gt;expert_6_mul</title>
<path fill="none" stroke="black" d="M8496.18,-782.74C8496.18,-774.59 8496.18,-765.97 8496.18,-757.4"/>
<polygon fill="black" stroke="black" points="8499.68,-757.38 8496.18,-747.38 8492.68,-757.38 8499.68,-757.38"/>
</g>
<!-- expert_7_gate -->
<g id="node43" class="node">
<title>expert_7_gate</title>
<ellipse fill="lightblue" stroke="black" cx="9126.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="9126.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="9126.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9126.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="9126.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_7_act -->
<g id="node45" class="node">
<title>expert_7_act</title>
<ellipse fill="lightblue" stroke="black" cx="9129.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="9129.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="9129.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9129.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9129.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_7_gate&#45;&gt;expert_7_act -->
<g id="edge74" class="edge">
<title>expert_7_gate&#45;&gt;expert_7_act</title>
<path fill="none" stroke="black" d="M9127.27,-914.81C9127.46,-906.55 9127.66,-897.86 9127.86,-889.36"/>
<polygon fill="black" stroke="black" points="9131.36,-889.2 9128.09,-879.12 9124.36,-889.03 9131.36,-889.2"/>
</g>
<!-- expert_7_up -->
<g id="node44" class="node">
<title>expert_7_up</title>
<ellipse fill="lightblue" stroke="black" cx="9756.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="9756.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="9756.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9756.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="9756.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_7_down -->
<g id="node47" class="node">
<title>expert_7_down</title>
<ellipse fill="lightblue" stroke="black" cx="9756.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="9756.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="9756.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9756.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9756.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_7_up&#45;&gt;expert_7_down -->
<g id="edge75" class="edge">
<title>expert_7_up&#45;&gt;expert_7_down</title>
<path fill="none" stroke="black" d="M9756.18,-914.81C9756.18,-906.55 9756.18,-897.86 9756.18,-889.36"/>
<polygon fill="black" stroke="black" points="9759.68,-889.12 9756.18,-879.12 9752.68,-889.12 9759.68,-889.12"/>
</g>
<!-- expert_7_mul -->
<g id="node46" class="node">
<title>expert_7_mul</title>
<ellipse fill="lightblue" stroke="black" cx="9756.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="9756.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 7 Gate Mul</text>
<text text-anchor="middle" x="9756.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9756.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9756.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9756.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_7_act&#45;&gt;expert_7_mul -->
<g id="edge76" class="edge">
<title>expert_7_act&#45;&gt;expert_7_mul</title>
<path fill="none" stroke="black" d="M9301.75,-791.26C9378.41,-774.05 9469.25,-753.66 9549.5,-735.64"/>
<polygon fill="black" stroke="black" points="9550.74,-738.95 9559.73,-733.34 9549.21,-732.12 9550.74,-738.95"/>
</g>
<!-- agg_7 -->
<g id="node103" class="node">
<title>agg_7</title>
<polygon fill="lightgreen" stroke="black" points="10279.7,-593.55 9583.7,-593.55 9404.66,-457.55 10100.65,-457.55 10279.7,-593.55"/>
<text text-anchor="middle" x="9842.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 7</text>
<text text-anchor="middle" x="9842.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9842.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="9842.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_7_mul&#45;&gt;agg_7 -->
<g id="edge78" class="edge">
<title>expert_7_mul&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M9786.98,-629.68C9791.68,-620.9 9796.59,-611.72 9801.46,-602.62"/>
<polygon fill="black" stroke="black" points="9804.68,-604.03 9806.31,-593.56 9798.51,-600.72 9804.68,-604.03"/>
</g>
<!-- expert_7_down&#45;&gt;expert_7_mul -->
<g id="edge77" class="edge">
<title>expert_7_down&#45;&gt;expert_7_mul</title>
<path fill="none" stroke="black" d="M9756.18,-782.74C9756.18,-774.59 9756.18,-765.97 9756.18,-757.4"/>
<polygon fill="black" stroke="black" points="9759.68,-757.38 9756.18,-747.38 9752.68,-757.38 9759.68,-757.38"/>
</g>
<!-- expert_8_gate -->
<g id="node48" class="node">
<title>expert_8_gate</title>
<ellipse fill="lightblue" stroke="black" cx="10386.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="10386.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="10386.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10386.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="10386.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_8_act -->
<g id="node50" class="node">
<title>expert_8_act</title>
<ellipse fill="lightblue" stroke="black" cx="10387.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="10387.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="10387.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10387.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10387.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_8_gate&#45;&gt;expert_8_act -->
<g id="edge83" class="edge">
<title>expert_8_gate&#45;&gt;expert_8_act</title>
<path fill="none" stroke="black" d="M10386.54,-914.81C10386.6,-906.55 10386.67,-897.86 10386.74,-889.36"/>
<polygon fill="black" stroke="black" points="10390.24,-889.14 10386.82,-879.12 10383.24,-889.09 10390.24,-889.14"/>
</g>
<!-- expert_8_up -->
<g id="node49" class="node">
<title>expert_8_up</title>
<ellipse fill="lightblue" stroke="black" cx="11016.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="11016.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="11016.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="11016.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="11016.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_8_down -->
<g id="node52" class="node">
<title>expert_8_down</title>
<ellipse fill="lightblue" stroke="black" cx="11013.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="11013.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="11013.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="11013.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11013.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_8_up&#45;&gt;expert_8_down -->
<g id="edge84" class="edge">
<title>expert_8_up&#45;&gt;expert_8_down</title>
<path fill="none" stroke="black" d="M11015.09,-914.81C11014.9,-906.55 11014.7,-897.86 11014.5,-889.36"/>
<polygon fill="black" stroke="black" points="11017.99,-889.03 11014.26,-879.12 11010.99,-889.2 11017.99,-889.03"/>
</g>
<!-- expert_8_mul -->
<g id="node51" class="node">
<title>expert_8_mul</title>
<ellipse fill="lightblue" stroke="black" cx="10745.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="10745.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 8 Gate Mul</text>
<text text-anchor="middle" x="10745.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10745.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10745.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10745.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_8_act&#45;&gt;expert_8_mul -->
<g id="edge85" class="edge">
<title>expert_8_act&#45;&gt;expert_8_mul</title>
<path fill="none" stroke="black" d="M10498.98,-786.05C10531.98,-773.07 10568.55,-758.69 10603.19,-745.07"/>
<polygon fill="black" stroke="black" points="10604.88,-748.17 10612.9,-741.25 10602.32,-741.65 10604.88,-748.17"/>
</g>
<!-- agg_8 -->
<g id="node105" class="node">
<title>agg_8</title>
<polygon fill="lightgreen" stroke="black" points="11182.7,-593.55 10486.7,-593.55 10307.66,-457.55 11003.65,-457.55 11182.7,-593.55"/>
<text text-anchor="middle" x="10745.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 8</text>
<text text-anchor="middle" x="10745.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10745.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="10745.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_8_mul&#45;&gt;agg_8 -->
<g id="edge87" class="edge">
<title>expert_8_mul&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M10745.18,-629.22C10745.18,-620.95 10745.18,-612.34 10745.18,-603.77"/>
<polygon fill="black" stroke="black" points="10748.68,-603.76 10745.18,-593.76 10741.68,-603.76 10748.68,-603.76"/>
</g>
<!-- expert_8_down&#45;&gt;expert_8_mul -->
<g id="edge86" class="edge">
<title>expert_8_down&#45;&gt;expert_8_mul</title>
<path fill="none" stroke="black" d="M10927.27,-784.89C10905.15,-773.26 10881,-760.58 10857.74,-748.36"/>
<polygon fill="black" stroke="black" points="10859.35,-745.26 10848.87,-743.7 10856.1,-751.45 10859.35,-745.26"/>
</g>
<!-- expert_9_gate -->
<g id="node53" class="node">
<title>expert_9_gate</title>
<ellipse fill="lightblue" stroke="black" cx="11646.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="11646.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="11646.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11646.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="11646.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_9_act -->
<g id="node55" class="node">
<title>expert_9_act</title>
<ellipse fill="lightblue" stroke="black" cx="11646.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="11646.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="11646.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11646.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11646.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_9_gate&#45;&gt;expert_9_act -->
<g id="edge92" class="edge">
<title>expert_9_gate&#45;&gt;expert_9_act</title>
<path fill="none" stroke="black" d="M11646.18,-914.81C11646.18,-906.55 11646.18,-897.86 11646.18,-889.36"/>
<polygon fill="black" stroke="black" points="11649.68,-889.12 11646.18,-879.12 11642.68,-889.12 11649.68,-889.12"/>
</g>
<!-- expert_9_up -->
<g id="node54" class="node">
<title>expert_9_up</title>
<ellipse fill="lightblue" stroke="black" cx="12276.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="12276.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="12276.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="12276.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="12276.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_9_down -->
<g id="node57" class="node">
<title>expert_9_down</title>
<ellipse fill="lightblue" stroke="black" cx="12273.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="12273.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="12273.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="12273.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12273.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_9_up&#45;&gt;expert_9_down -->
<g id="edge93" class="edge">
<title>expert_9_up&#45;&gt;expert_9_down</title>
<path fill="none" stroke="black" d="M12275.09,-914.81C12274.9,-906.55 12274.7,-897.86 12274.5,-889.36"/>
<polygon fill="black" stroke="black" points="12277.99,-889.03 12274.26,-879.12 12270.99,-889.2 12277.99,-889.03"/>
</g>
<!-- expert_9_mul -->
<g id="node56" class="node">
<title>expert_9_mul</title>
<ellipse fill="lightblue" stroke="black" cx="11646.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="11646.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 9 Gate Mul</text>
<text text-anchor="middle" x="11646.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11646.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11646.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11646.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_9_act&#45;&gt;expert_9_mul -->
<g id="edge94" class="edge">
<title>expert_9_act&#45;&gt;expert_9_mul</title>
<path fill="none" stroke="black" d="M11646.18,-782.74C11646.18,-774.59 11646.18,-765.97 11646.18,-757.4"/>
<polygon fill="black" stroke="black" points="11649.68,-757.38 11646.18,-747.38 11642.68,-757.38 11649.68,-757.38"/>
</g>
<!-- agg_9 -->
<g id="node107" class="node">
<title>agg_9</title>
<polygon fill="lightgreen" stroke="black" points="12080.7,-593.55 11384.7,-593.55 11205.66,-457.55 11901.65,-457.55 12080.7,-593.55"/>
<text text-anchor="middle" x="11643.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 9</text>
<text text-anchor="middle" x="11643.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11643.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="11643.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_9_mul&#45;&gt;agg_9 -->
<g id="edge96" class="edge">
<title>expert_9_mul&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M11645.09,-629.22C11644.94,-620.95 11644.78,-612.34 11644.62,-603.77"/>
<polygon fill="black" stroke="black" points="11648.12,-603.7 11644.43,-593.76 11641.12,-603.83 11648.12,-603.7"/>
</g>
<!-- expert_9_down&#45;&gt;expert_9_mul -->
<g id="edge95" class="edge">
<title>expert_9_down&#45;&gt;expert_9_mul</title>
<path fill="none" stroke="black" d="M12101.85,-791.54C12024.76,-774.23 11933.12,-753.66 11852.31,-735.52"/>
<polygon fill="black" stroke="black" points="11853.03,-732.09 11842.51,-733.32 11851.5,-738.92 11853.03,-732.09"/>
</g>
<!-- expert_10_gate -->
<g id="node58" class="node">
<title>expert_10_gate</title>
<ellipse fill="lightblue" stroke="black" cx="12906.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="12906.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="12906.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12906.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="12906.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_10_act -->
<g id="node60" class="node">
<title>expert_10_act</title>
<ellipse fill="lightblue" stroke="black" cx="12906.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="12906.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="12906.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12906.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12906.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_10_gate&#45;&gt;expert_10_act -->
<g id="edge101" class="edge">
<title>expert_10_gate&#45;&gt;expert_10_act</title>
<path fill="none" stroke="black" d="M12906.18,-914.81C12906.18,-906.55 12906.18,-897.86 12906.18,-889.36"/>
<polygon fill="black" stroke="black" points="12909.68,-889.12 12906.18,-879.12 12902.68,-889.12 12909.68,-889.12"/>
</g>
<!-- expert_10_up -->
<g id="node59" class="node">
<title>expert_10_up</title>
<ellipse fill="lightblue" stroke="black" cx="13536.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="13536.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="13536.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="13536.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="13536.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_10_down -->
<g id="node62" class="node">
<title>expert_10_down</title>
<ellipse fill="lightblue" stroke="black" cx="13533.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="13533.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="13533.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="13533.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="13533.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_10_up&#45;&gt;expert_10_down -->
<g id="edge102" class="edge">
<title>expert_10_up&#45;&gt;expert_10_down</title>
<path fill="none" stroke="black" d="M13535.09,-914.81C13534.9,-906.55 13534.7,-897.86 13534.5,-889.36"/>
<polygon fill="black" stroke="black" points="13537.99,-889.03 13534.26,-879.12 13530.99,-889.2 13537.99,-889.03"/>
</g>
<!-- expert_10_mul -->
<g id="node61" class="node">
<title>expert_10_mul</title>
<ellipse fill="lightblue" stroke="black" cx="12906.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="12906.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 10 Gate Mul</text>
<text text-anchor="middle" x="12906.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12906.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12906.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12906.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_10_act&#45;&gt;expert_10_mul -->
<g id="edge103" class="edge">
<title>expert_10_act&#45;&gt;expert_10_mul</title>
<path fill="none" stroke="black" d="M12906.18,-782.74C12906.18,-774.59 12906.18,-765.97 12906.18,-757.4"/>
<polygon fill="black" stroke="black" points="12909.68,-757.38 12906.18,-747.38 12902.68,-757.38 12909.68,-757.38"/>
</g>
<!-- agg_10 -->
<g id="node109" class="node">
<title>agg_10</title>
<polygon fill="lightgreen" stroke="black" points="13158.7,-593.55 12462.7,-593.55 12283.66,-457.55 12979.65,-457.55 13158.7,-593.55"/>
<text text-anchor="middle" x="12721.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 10</text>
<text text-anchor="middle" x="12721.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12721.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="12721.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_10_mul&#45;&gt;agg_10 -->
<g id="edge105" class="edge">
<title>expert_10_mul&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M12841.21,-630.81C12829.85,-620.94 12817.89,-610.55 12806.08,-600.3"/>
<polygon fill="black" stroke="black" points="12808.2,-597.5 12798.36,-593.59 12803.61,-602.79 12808.2,-597.5"/>
</g>
<!-- expert_10_down&#45;&gt;expert_10_mul -->
<g id="edge104" class="edge">
<title>expert_10_down&#45;&gt;expert_10_mul</title>
<path fill="none" stroke="black" d="M13361.85,-791.54C13284.76,-774.23 13193.12,-753.66 13112.31,-735.52"/>
<polygon fill="black" stroke="black" points="13113.03,-732.09 13102.51,-733.32 13111.5,-738.92 13113.03,-732.09"/>
</g>
<!-- expert_11_gate -->
<g id="node63" class="node">
<title>expert_11_gate</title>
<ellipse fill="lightblue" stroke="black" cx="14166.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="14166.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="14166.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14166.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="14166.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_11_act -->
<g id="node65" class="node">
<title>expert_11_act</title>
<ellipse fill="lightblue" stroke="black" cx="14166.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="14166.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="14166.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14166.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14166.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_11_gate&#45;&gt;expert_11_act -->
<g id="edge110" class="edge">
<title>expert_11_gate&#45;&gt;expert_11_act</title>
<path fill="none" stroke="black" d="M14166.18,-914.81C14166.18,-906.55 14166.18,-897.86 14166.18,-889.36"/>
<polygon fill="black" stroke="black" points="14169.68,-889.12 14166.18,-879.12 14162.68,-889.12 14169.68,-889.12"/>
</g>
<!-- expert_11_up -->
<g id="node64" class="node">
<title>expert_11_up</title>
<ellipse fill="lightblue" stroke="black" cx="14796.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="14796.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="14796.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14796.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="14796.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_11_down -->
<g id="node67" class="node">
<title>expert_11_down</title>
<ellipse fill="lightblue" stroke="black" cx="14793.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="14793.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="14793.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14793.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14793.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_11_up&#45;&gt;expert_11_down -->
<g id="edge111" class="edge">
<title>expert_11_up&#45;&gt;expert_11_down</title>
<path fill="none" stroke="black" d="M14795.09,-914.81C14794.9,-906.55 14794.7,-897.86 14794.5,-889.36"/>
<polygon fill="black" stroke="black" points="14797.99,-889.03 14794.26,-879.12 14790.99,-889.2 14797.99,-889.03"/>
</g>
<!-- expert_11_mul -->
<g id="node66" class="node">
<title>expert_11_mul</title>
<ellipse fill="lightblue" stroke="black" cx="14166.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="14166.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 11 Gate Mul</text>
<text text-anchor="middle" x="14166.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="14166.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14166.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14166.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_11_act&#45;&gt;expert_11_mul -->
<g id="edge112" class="edge">
<title>expert_11_act&#45;&gt;expert_11_mul</title>
<path fill="none" stroke="black" d="M14166.18,-782.74C14166.18,-774.59 14166.18,-765.97 14166.18,-757.4"/>
<polygon fill="black" stroke="black" points="14169.68,-757.38 14166.18,-747.38 14162.68,-757.38 14169.68,-757.38"/>
</g>
<!-- agg_11 -->
<g id="node111" class="node">
<title>agg_11</title>
<polygon fill="lightgreen" stroke="black" points="14420.7,-593.55 13724.7,-593.55 13545.66,-457.55 14241.65,-457.55 14420.7,-593.55"/>
<text text-anchor="middle" x="13983.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 11</text>
<text text-anchor="middle" x="13983.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13983.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="13983.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_11_mul&#45;&gt;agg_11 -->
<g id="edge114" class="edge">
<title>expert_11_mul&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M14101.92,-630.81C14090.68,-620.94 14078.84,-610.55 14067.17,-600.3"/>
<polygon fill="black" stroke="black" points="14069.35,-597.55 14059.53,-593.59 14064.73,-602.81 14069.35,-597.55"/>
</g>
<!-- expert_11_down&#45;&gt;expert_11_mul -->
<g id="edge113" class="edge">
<title>expert_11_down&#45;&gt;expert_11_mul</title>
<path fill="none" stroke="black" d="M14621.85,-791.54C14544.76,-774.23 14453.12,-753.66 14372.31,-735.52"/>
<polygon fill="black" stroke="black" points="14373.03,-732.09 14362.51,-733.32 14371.5,-738.92 14373.03,-732.09"/>
</g>
<!-- expert_12_gate -->
<g id="node68" class="node">
<title>expert_12_gate</title>
<ellipse fill="lightblue" stroke="black" cx="15426.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="15426.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="15426.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="15426.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="15426.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_12_act -->
<g id="node70" class="node">
<title>expert_12_act</title>
<ellipse fill="lightblue" stroke="black" cx="15426.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="15426.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="15426.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="15426.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15426.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_12_gate&#45;&gt;expert_12_act -->
<g id="edge119" class="edge">
<title>expert_12_gate&#45;&gt;expert_12_act</title>
<path fill="none" stroke="black" d="M15426.18,-914.81C15426.18,-906.55 15426.18,-897.86 15426.18,-889.36"/>
<polygon fill="black" stroke="black" points="15429.68,-889.12 15426.18,-879.12 15422.68,-889.12 15429.68,-889.12"/>
</g>
<!-- expert_12_up -->
<g id="node69" class="node">
<title>expert_12_up</title>
<ellipse fill="lightblue" stroke="black" cx="16056.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="16056.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="16056.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="16056.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="16056.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_12_down -->
<g id="node72" class="node">
<title>expert_12_down</title>
<ellipse fill="lightblue" stroke="black" cx="16053.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="16053.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="16053.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="16053.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16053.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_12_up&#45;&gt;expert_12_down -->
<g id="edge120" class="edge">
<title>expert_12_up&#45;&gt;expert_12_down</title>
<path fill="none" stroke="black" d="M16055.09,-914.81C16054.9,-906.55 16054.7,-897.86 16054.5,-889.36"/>
<polygon fill="black" stroke="black" points="16057.99,-889.03 16054.26,-879.12 16050.99,-889.2 16057.99,-889.03"/>
</g>
<!-- expert_12_mul -->
<g id="node71" class="node">
<title>expert_12_mul</title>
<ellipse fill="lightblue" stroke="black" cx="15426.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="15426.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 12 Gate Mul</text>
<text text-anchor="middle" x="15426.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="15426.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15426.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15426.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_12_act&#45;&gt;expert_12_mul -->
<g id="edge121" class="edge">
<title>expert_12_act&#45;&gt;expert_12_mul</title>
<path fill="none" stroke="black" d="M15426.18,-782.74C15426.18,-774.59 15426.18,-765.97 15426.18,-757.4"/>
<polygon fill="black" stroke="black" points="15429.68,-757.38 15426.18,-747.38 15422.68,-757.38 15429.68,-757.38"/>
</g>
<!-- agg_12 -->
<g id="node113" class="node">
<title>agg_12</title>
<polygon fill="lightgreen" stroke="black" points="15588.7,-593.55 14892.7,-593.55 14713.66,-457.55 15409.65,-457.55 15588.7,-593.55"/>
<text text-anchor="middle" x="15151.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 12</text>
<text text-anchor="middle" x="15151.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="15151.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="15151.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_12_mul&#45;&gt;agg_12 -->
<g id="edge123" class="edge">
<title>expert_12_mul&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M15331.92,-632.16C15313.59,-621.45 15294.11,-610.06 15274.98,-598.89"/>
<polygon fill="black" stroke="black" points="15276.63,-595.8 15266.23,-593.77 15273.1,-601.84 15276.63,-595.8"/>
</g>
<!-- expert_12_down&#45;&gt;expert_12_mul -->
<g id="edge122" class="edge">
<title>expert_12_down&#45;&gt;expert_12_mul</title>
<path fill="none" stroke="black" d="M15881.85,-791.54C15804.76,-774.23 15713.12,-753.66 15632.31,-735.52"/>
<polygon fill="black" stroke="black" points="15633.03,-732.09 15622.51,-733.32 15631.5,-738.92 15633.03,-732.09"/>
</g>
<!-- expert_13_gate -->
<g id="node73" class="node">
<title>expert_13_gate</title>
<ellipse fill="lightblue" stroke="black" cx="16686.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="16686.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="16686.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16686.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="16686.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_13_act -->
<g id="node75" class="node">
<title>expert_13_act</title>
<ellipse fill="lightblue" stroke="black" cx="16686.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="16686.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="16686.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16686.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16686.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_13_gate&#45;&gt;expert_13_act -->
<g id="edge128" class="edge">
<title>expert_13_gate&#45;&gt;expert_13_act</title>
<path fill="none" stroke="black" d="M16686.18,-914.81C16686.18,-906.55 16686.18,-897.86 16686.18,-889.36"/>
<polygon fill="black" stroke="black" points="16689.68,-889.12 16686.18,-879.12 16682.68,-889.12 16689.68,-889.12"/>
</g>
<!-- expert_13_up -->
<g id="node74" class="node">
<title>expert_13_up</title>
<ellipse fill="lightblue" stroke="black" cx="17316.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="17316.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="17316.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="17316.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="17316.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_13_down -->
<g id="node77" class="node">
<title>expert_13_down</title>
<ellipse fill="lightblue" stroke="black" cx="17313.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="17313.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="17313.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="17313.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="17313.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_13_up&#45;&gt;expert_13_down -->
<g id="edge129" class="edge">
<title>expert_13_up&#45;&gt;expert_13_down</title>
<path fill="none" stroke="black" d="M17315.09,-914.81C17314.9,-906.55 17314.7,-897.86 17314.5,-889.36"/>
<polygon fill="black" stroke="black" points="17317.99,-889.03 17314.26,-879.12 17310.99,-889.2 17317.99,-889.03"/>
</g>
<!-- expert_13_mul -->
<g id="node76" class="node">
<title>expert_13_mul</title>
<ellipse fill="lightblue" stroke="black" cx="16686.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="16686.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 13 Gate Mul</text>
<text text-anchor="middle" x="16686.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16686.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16686.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16686.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_13_act&#45;&gt;expert_13_mul -->
<g id="edge130" class="edge">
<title>expert_13_act&#45;&gt;expert_13_mul</title>
<path fill="none" stroke="black" d="M16686.18,-782.74C16686.18,-774.59 16686.18,-765.97 16686.18,-757.4"/>
<polygon fill="black" stroke="black" points="16689.68,-757.38 16686.18,-747.38 16682.68,-757.38 16689.68,-757.38"/>
</g>
<!-- agg_13 -->
<g id="node115" class="node">
<title>agg_13</title>
<polygon fill="lightgreen" stroke="black" points="16802.7,-593.55 16106.7,-593.55 15927.66,-457.55 16623.65,-457.55 16802.7,-593.55"/>
<text text-anchor="middle" x="16365.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 13</text>
<text text-anchor="middle" x="16365.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16365.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="16365.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_13_mul&#45;&gt;agg_13 -->
<g id="edge132" class="edge">
<title>expert_13_mul&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M16578.4,-633.28C16555.87,-622 16531.78,-609.94 16508.2,-598.14"/>
<polygon fill="black" stroke="black" points="16509.7,-594.98 16499.19,-593.63 16506.57,-601.24 16509.7,-594.98"/>
</g>
<!-- expert_13_down&#45;&gt;expert_13_mul -->
<g id="edge131" class="edge">
<title>expert_13_down&#45;&gt;expert_13_mul</title>
<path fill="none" stroke="black" d="M17141.85,-791.54C17064.76,-774.23 16973.12,-753.66 16892.31,-735.52"/>
<polygon fill="black" stroke="black" points="16893.03,-732.09 16882.51,-733.32 16891.5,-738.92 16893.03,-732.09"/>
</g>
<!-- expert_14_gate -->
<g id="node78" class="node">
<title>expert_14_gate</title>
<ellipse fill="lightblue" stroke="black" cx="17946.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="17946.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="17946.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17946.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="17946.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_14_act -->
<g id="node80" class="node">
<title>expert_14_act</title>
<ellipse fill="lightblue" stroke="black" cx="17946.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="17946.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="17946.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17946.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="17946.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_14_gate&#45;&gt;expert_14_act -->
<g id="edge137" class="edge">
<title>expert_14_gate&#45;&gt;expert_14_act</title>
<path fill="none" stroke="black" d="M17946.18,-914.81C17946.18,-906.55 17946.18,-897.86 17946.18,-889.36"/>
<polygon fill="black" stroke="black" points="17949.68,-889.12 17946.18,-879.12 17942.68,-889.12 17949.68,-889.12"/>
</g>
<!-- expert_14_up -->
<g id="node79" class="node">
<title>expert_14_up</title>
<ellipse fill="lightblue" stroke="black" cx="18576.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="18576.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="18576.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="18576.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="18576.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_14_down -->
<g id="node82" class="node">
<title>expert_14_down</title>
<ellipse fill="lightblue" stroke="black" cx="18573.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="18573.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="18573.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="18573.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="18573.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_14_up&#45;&gt;expert_14_down -->
<g id="edge138" class="edge">
<title>expert_14_up&#45;&gt;expert_14_down</title>
<path fill="none" stroke="black" d="M18575.09,-914.81C18574.9,-906.55 18574.7,-897.86 18574.5,-889.36"/>
<polygon fill="black" stroke="black" points="18577.99,-889.03 18574.26,-879.12 18570.99,-889.2 18577.99,-889.03"/>
</g>
<!-- expert_14_mul -->
<g id="node81" class="node">
<title>expert_14_mul</title>
<ellipse fill="lightblue" stroke="black" cx="17946.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="17946.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 14 Gate Mul</text>
<text text-anchor="middle" x="17946.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17946.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="17946.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="17946.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_14_act&#45;&gt;expert_14_mul -->
<g id="edge139" class="edge">
<title>expert_14_act&#45;&gt;expert_14_mul</title>
<path fill="none" stroke="black" d="M17946.18,-782.74C17946.18,-774.59 17946.18,-765.97 17946.18,-757.4"/>
<polygon fill="black" stroke="black" points="17949.68,-757.38 17946.18,-747.38 17942.68,-757.38 17949.68,-757.38"/>
</g>
<!-- agg_14 -->
<g id="node117" class="node">
<title>agg_14</title>
<polygon fill="lightgreen" stroke="black" points="18200.7,-593.55 17504.7,-593.55 17325.66,-457.55 18021.65,-457.55 18200.7,-593.55"/>
<text text-anchor="middle" x="17763.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 14</text>
<text text-anchor="middle" x="17763.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17763.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="17763.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_14_mul&#45;&gt;agg_14 -->
<g id="edge141" class="edge">
<title>expert_14_mul&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M17881.92,-630.81C17870.68,-620.94 17858.84,-610.55 17847.17,-600.3"/>
<polygon fill="black" stroke="black" points="17849.35,-597.55 17839.53,-593.59 17844.73,-602.81 17849.35,-597.55"/>
</g>
<!-- expert_14_down&#45;&gt;expert_14_mul -->
<g id="edge140" class="edge">
<title>expert_14_down&#45;&gt;expert_14_mul</title>
<path fill="none" stroke="black" d="M18401.85,-791.54C18324.76,-774.23 18233.12,-753.66 18152.31,-735.52"/>
<polygon fill="black" stroke="black" points="18153.03,-732.09 18142.51,-733.32 18151.5,-738.92 18153.03,-732.09"/>
</g>
<!-- expert_15_gate -->
<g id="node83" class="node">
<title>expert_15_gate</title>
<ellipse fill="lightblue" stroke="black" cx="19206.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="19206.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="19206.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19206.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="19206.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_15_act -->
<g id="node85" class="node">
<title>expert_15_act</title>
<ellipse fill="lightblue" stroke="black" cx="19206.18" cy="-831.01" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="19206.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="19206.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19206.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="19206.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_15_gate&#45;&gt;expert_15_act -->
<g id="edge146" class="edge">
<title>expert_15_gate&#45;&gt;expert_15_act</title>
<path fill="none" stroke="black" d="M19206.18,-914.81C19206.18,-906.55 19206.18,-897.86 19206.18,-889.36"/>
<polygon fill="black" stroke="black" points="19209.68,-889.12 19206.18,-879.12 19202.68,-889.12 19209.68,-889.12"/>
</g>
<!-- expert_15_up -->
<g id="node84" class="node">
<title>expert_15_up</title>
<ellipse fill="lightblue" stroke="black" cx="19836.18" cy="-963.18" rx="306.35" ry="48.17"/>
<text text-anchor="middle" x="19836.18" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="19836.18" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19836.18" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="19836.18" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_15_down -->
<g id="node87" class="node">
<title>expert_15_down</title>
<ellipse fill="lightblue" stroke="black" cx="19833.18" cy="-831.01" rx="299.63" ry="48.17"/>
<text text-anchor="middle" x="19833.18" y="-849.81" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="19833.18" y="-834.81" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19833.18" y="-819.81" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="19833.18" y="-804.81" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
</g>
<!-- expert_15_up&#45;&gt;expert_15_down -->
<g id="edge147" class="edge">
<title>expert_15_up&#45;&gt;expert_15_down</title>
<path fill="none" stroke="black" d="M19835.09,-914.81C19834.9,-906.55 19834.7,-897.86 19834.5,-889.36"/>
<polygon fill="black" stroke="black" points="19837.99,-889.03 19834.26,-879.12 19830.99,-889.2 19837.99,-889.03"/>
</g>
<!-- expert_15_mul -->
<g id="node86" class="node">
<title>expert_15_mul</title>
<ellipse fill="lightblue" stroke="black" cx="19206.18" cy="-688.24" rx="306.35" ry="58.88"/>
<text text-anchor="middle" x="19206.18" y="-714.54" font-family="Times,serif" font-size="14.00">Expert 15 Gate Mul</text>
<text text-anchor="middle" x="19206.18" y="-699.54" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="19206.18" y="-684.54" font-family="Times,serif" font-size="14.00">Input1: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="19206.18" y="-669.54" font-family="Times,serif" font-size="14.00">Input2: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
<text text-anchor="middle" x="19206.18" y="-654.54" font-family="Times,serif" font-size="14.00">Output: [dynamic_batch, dynamic_seq, mlp_hidden=2048]</text>
</g>
<!-- expert_15_act&#45;&gt;expert_15_mul -->
<g id="edge148" class="edge">
<title>expert_15_act&#45;&gt;expert_15_mul</title>
<path fill="none" stroke="black" d="M19206.18,-782.74C19206.18,-774.59 19206.18,-765.97 19206.18,-757.4"/>
<polygon fill="black" stroke="black" points="19209.68,-757.38 19206.18,-747.38 19202.68,-757.38 19209.68,-757.38"/>
</g>
<!-- agg_15 -->
<g id="node119" class="node">
<title>agg_15</title>
<polygon fill="lightgreen" stroke="black" points="19368.7,-593.55 18672.7,-593.55 18493.66,-457.55 19189.65,-457.55 19368.7,-593.55"/>
<text text-anchor="middle" x="18931.18" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate 15</text>
<text text-anchor="middle" x="18931.18" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18931.18" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [dynamic_batch, dynamic_seq, token_dim=7168]</text>
<text text-anchor="middle" x="18931.18" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_15_mul&#45;&gt;agg_15 -->
<g id="edge150" class="edge">
<title>expert_15_mul&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M19111.92,-632.16C19093.59,-621.45 19074.11,-610.06 19054.98,-598.89"/>
<polygon fill="black" stroke="black" points="19056.63,-595.8 19046.23,-593.77 19053.1,-601.84 19056.63,-595.8"/>
</g>
<!-- expert_15_down&#45;&gt;expert_15_mul -->
<g id="edge149" class="edge">
<title>expert_15_down&#45;&gt;expert_15_mul</title>
<path fill="none" stroke="black" d="M19661.85,-791.54C19584.76,-774.23 19493.12,-753.66 19412.31,-735.52"/>
<polygon fill="black" stroke="black" points="19413.03,-732.09 19402.51,-733.32 19411.5,-738.92 19413.03,-732.09"/>
</g>
<!-- split_0&#45;&gt;expert_0_gate -->
<g id="edge9" class="edge">
<title>split_0&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" d="M654.8,-1047.23C596,-1033.22 535.62,-1018.84 481.98,-1006.06"/>
<polygon fill="black" stroke="black" points="482.59,-1002.6 472.05,-1003.69 480.96,-1009.41 482.59,-1002.6"/>
</g>
<!-- split_0&#45;&gt;expert_0_up -->
<g id="edge10" class="edge">
<title>split_0&#45;&gt;expert_0_up</title>
<path fill="none" stroke="black" d="M936.18,-1047.12C936.18,-1038.57 936.18,-1029.89 936.18,-1021.52"/>
<polygon fill="black" stroke="black" points="939.68,-1021.49 936.18,-1011.49 932.68,-1021.49 939.68,-1021.49"/>
</g>
<!-- moe_agg -->
<g id="node120" class="node">
<title>moe_agg</title>
<polygon fill="lightgreen" stroke="black" points="11182.7,-421.55 10486.7,-421.55 10307.66,-285.55 11003.65,-285.55 11182.7,-421.55"/>
<text text-anchor="middle" x="10745.18" y="-372.35" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="10745.18" y="-357.35" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="10745.18" y="-342.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="10745.18" y="-327.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- agg_0&#45;&gt;moe_agg -->
<g id="edge16" class="edge">
<title>agg_0&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M1266.72,-509.8C1624.13,-494.28 2213.22,-470.35 2721.18,-457.55 5684.71,-382.83 9265.36,-361.16 10389.78,-355.97"/>
<polygon fill="black" stroke="black" points="10390.05,-359.47 10400.03,-355.93 10390.02,-352.47 10390.05,-359.47"/>
</g>
<!-- split_1&#45;&gt;expert_1_gate -->
<g id="edge18" class="edge">
<title>split_1&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" d="M1914.8,-1047.23C1856,-1033.22 1795.62,-1018.84 1741.98,-1006.06"/>
<polygon fill="black" stroke="black" points="1742.59,-1002.6 1732.05,-1003.69 1740.96,-1009.41 1742.59,-1002.6"/>
</g>
<!-- split_1&#45;&gt;expert_1_up -->
<g id="edge19" class="edge">
<title>split_1&#45;&gt;expert_1_up</title>
<path fill="none" stroke="black" d="M2196.18,-1047.12C2196.18,-1038.57 2196.18,-1029.89 2196.18,-1021.52"/>
<polygon fill="black" stroke="black" points="2199.68,-1021.49 2196.18,-1011.49 2192.68,-1021.49 2199.68,-1021.49"/>
</g>
<!-- agg_1&#45;&gt;moe_agg -->
<g id="edge25" class="edge">
<title>agg_1&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M3484.91,-501.77C3707.76,-486.65 4013.06,-467.78 4282.18,-457.55 6609.54,-369.06 9411.13,-356.35 10388.33,-354.71"/>
<polygon fill="black" stroke="black" points="10388.68,-358.21 10398.67,-354.69 10388.67,-351.21 10388.68,-358.21"/>
</g>
<!-- split_2&#45;&gt;expert_2_gate -->
<g id="edge27" class="edge">
<title>split_2&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" d="M3174.8,-1047.23C3116,-1033.22 3055.62,-1018.84 3001.98,-1006.06"/>
<polygon fill="black" stroke="black" points="3002.59,-1002.6 2992.05,-1003.69 3000.96,-1009.41 3002.59,-1002.6"/>
</g>
<!-- split_2&#45;&gt;expert_2_up -->
<g id="edge28" class="edge">
<title>split_2&#45;&gt;expert_2_up</title>
<path fill="none" stroke="black" d="M3456.18,-1047.12C3456.18,-1038.57 3456.18,-1029.89 3456.18,-1021.52"/>
<polygon fill="black" stroke="black" points="3459.68,-1021.49 3456.18,-1011.49 3452.68,-1021.49 3459.68,-1021.49"/>
</g>
<!-- agg_2&#45;&gt;moe_agg -->
<g id="edge34" class="edge">
<title>agg_2&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M5035.4,-493.54C5179.08,-480.19 5352.75,-465.79 5509.18,-457.55 6463.08,-407.25 9378.57,-370.13 10392.89,-358.44"/>
<polygon fill="black" stroke="black" points="10393.3,-361.93 10403.26,-358.32 10393.22,-354.93 10393.3,-361.93"/>
</g>
<!-- split_3&#45;&gt;expert_3_gate -->
<g id="edge36" class="edge">
<title>split_3&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" d="M4434.8,-1047.23C4376,-1033.22 4315.62,-1018.84 4261.98,-1006.06"/>
<polygon fill="black" stroke="black" points="4262.59,-1002.6 4252.05,-1003.69 4260.96,-1009.41 4262.59,-1002.6"/>
</g>
<!-- split_3&#45;&gt;expert_3_up -->
<g id="edge37" class="edge">
<title>split_3&#45;&gt;expert_3_up</title>
<path fill="none" stroke="black" d="M4716.18,-1047.12C4716.18,-1038.57 4716.18,-1029.89 4716.18,-1021.52"/>
<polygon fill="black" stroke="black" points="4719.68,-1021.49 4716.18,-1011.49 4712.68,-1021.49 4719.68,-1021.49"/>
</g>
<!-- agg_3&#45;&gt;moe_agg -->
<g id="edge43" class="edge">
<title>agg_3&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M6253.49,-486.96C6353.63,-475.65 6466.1,-464.44 6569.18,-457.55 7308.65,-408.1 9529.2,-371.96 10394.55,-359.39"/>
<polygon fill="black" stroke="black" points="10394.72,-362.89 10404.67,-359.24 10394.62,-355.89 10394.72,-362.89"/>
</g>
<!-- split_4&#45;&gt;expert_4_gate -->
<g id="edge45" class="edge">
<title>split_4&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" d="M5694.8,-1047.23C5636,-1033.22 5575.62,-1018.84 5521.98,-1006.06"/>
<polygon fill="black" stroke="black" points="5522.59,-1002.6 5512.05,-1003.69 5520.96,-1009.41 5522.59,-1002.6"/>
</g>
<!-- split_4&#45;&gt;expert_4_up -->
<g id="edge46" class="edge">
<title>split_4&#45;&gt;expert_4_up</title>
<path fill="none" stroke="black" d="M5976.18,-1047.12C5976.18,-1038.57 5976.18,-1029.89 5976.18,-1021.52"/>
<polygon fill="black" stroke="black" points="5979.68,-1021.49 5976.18,-1011.49 5972.68,-1021.49 5979.68,-1021.49"/>
</g>
<!-- agg_4&#45;&gt;moe_agg -->
<g id="edge52" class="edge">
<title>agg_4&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M7307.95,-482.69C7385.25,-472.96 7468.74,-463.67 7546.18,-457.55 8575.97,-376.06 9797.11,-358.6 10388.62,-355.16"/>
<polygon fill="black" stroke="black" points="10389.04,-358.65 10399.02,-355.1 10389,-351.65 10389.04,-358.65"/>
</g>
<!-- split_5&#45;&gt;expert_5_gate -->
<g id="edge54" class="edge">
<title>split_5&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" d="M6954.8,-1047.23C6896,-1033.22 6835.62,-1018.84 6781.98,-1006.06"/>
<polygon fill="black" stroke="black" points="6782.59,-1002.6 6772.05,-1003.69 6780.96,-1009.41 6782.59,-1002.6"/>
</g>
<!-- split_5&#45;&gt;expert_5_up -->
<g id="edge55" class="edge">
<title>split_5&#45;&gt;expert_5_up</title>
<path fill="none" stroke="black" d="M7236.18,-1047.12C7236.18,-1038.57 7236.18,-1029.89 7236.18,-1021.52"/>
<polygon fill="black" stroke="black" points="7239.68,-1021.49 7236.18,-1011.49 7232.68,-1021.49 7239.68,-1021.49"/>
</g>
<!-- agg_5&#45;&gt;moe_agg -->
<g id="edge61" class="edge">
<title>agg_5&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M8282.01,-480.47C8347.38,-471.73 8416.56,-463.44 8481.18,-457.55 9157.33,-395.88 9950.61,-370.55 10395.9,-360.59"/>
<polygon fill="black" stroke="black" points="10396.11,-364.08 10406.03,-360.36 10395.95,-357.08 10396.11,-364.08"/>
</g>
<!-- split_6&#45;&gt;expert_6_gate -->
<g id="edge63" class="edge">
<title>split_6&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" d="M8214.8,-1047.23C8156,-1033.22 8095.62,-1018.84 8041.98,-1006.06"/>
<polygon fill="black" stroke="black" points="8042.59,-1002.6 8032.05,-1003.69 8040.96,-1009.41 8042.59,-1002.6"/>
</g>
<!-- split_6&#45;&gt;expert_6_up -->
<g id="edge64" class="edge">
<title>split_6&#45;&gt;expert_6_up</title>
<path fill="none" stroke="black" d="M8496.18,-1047.12C8496.18,-1038.57 8496.18,-1029.89 8496.18,-1021.52"/>
<polygon fill="black" stroke="black" points="8499.68,-1021.49 8496.18,-1011.49 8492.68,-1021.49 8499.68,-1021.49"/>
</g>
<!-- agg_6&#45;&gt;moe_agg -->
<g id="edge70" class="edge">
<title>agg_6&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M9216.46,-480.13C9275.49,-471.9 9337.27,-463.9 9395.18,-457.55 9741.38,-419.55 10139.07,-391.03 10412.67,-373.75"/>
<polygon fill="black" stroke="black" points="10412.99,-377.24 10422.75,-373.11 10412.55,-370.25 10412.99,-377.24"/>
</g>
<!-- split_7&#45;&gt;expert_7_gate -->
<g id="edge72" class="edge">
<title>split_7&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" d="M9474.8,-1047.23C9416,-1033.22 9355.62,-1018.84 9301.98,-1006.06"/>
<polygon fill="black" stroke="black" points="9302.59,-1002.6 9292.05,-1003.69 9300.96,-1009.41 9302.59,-1002.6"/>
</g>
<!-- split_7&#45;&gt;expert_7_up -->
<g id="edge73" class="edge">
<title>split_7&#45;&gt;expert_7_up</title>
<path fill="none" stroke="black" d="M9756.18,-1047.12C9756.18,-1038.57 9756.18,-1029.89 9756.18,-1021.52"/>
<polygon fill="black" stroke="black" points="9759.68,-1021.49 9756.18,-1011.49 9752.68,-1021.49 9759.68,-1021.49"/>
</g>
<!-- agg_7&#45;&gt;moe_agg -->
<g id="edge79" class="edge">
<title>agg_7&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M10120.17,-472.21C10227.09,-452.08 10349.33,-429.07 10457.17,-408.77"/>
<polygon fill="black" stroke="black" points="10458.05,-412.16 10467.23,-406.87 10456.75,-405.28 10458.05,-412.16"/>
</g>
<!-- split_8&#45;&gt;expert_8_gate -->
<g id="edge81" class="edge">
<title>split_8&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" d="M10560.26,-1047.12C10536.51,-1035.8 10512.24,-1024.24 10489.66,-1013.48"/>
<polygon fill="black" stroke="black" points="10490.96,-1010.23 10480.43,-1009.08 10487.95,-1016.54 10490.96,-1010.23"/>
</g>
<!-- split_8&#45;&gt;expert_8_up -->
<g id="edge82" class="edge">
<title>split_8&#45;&gt;expert_8_up</title>
<path fill="none" stroke="black" d="M10842.09,-1047.12C10865.85,-1035.8 10890.11,-1024.24 10912.69,-1013.48"/>
<polygon fill="black" stroke="black" points="10914.4,-1016.54 10921.92,-1009.08 10911.39,-1010.23 10914.4,-1016.54"/>
</g>
<!-- agg_8&#45;&gt;moe_agg -->
<g id="edge88" class="edge">
<title>agg_8&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M10745.18,-457.36C10745.18,-449.04 10745.18,-440.49 10745.18,-432.04"/>
<polygon fill="black" stroke="black" points="10748.68,-431.8 10745.18,-421.8 10741.68,-431.8 10748.68,-431.8"/>
</g>
<!-- split_9&#45;&gt;expert_9_gate -->
<g id="edge90" class="edge">
<title>split_9&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" d="M11646.18,-1047.12C11646.18,-1038.57 11646.18,-1029.89 11646.18,-1021.52"/>
<polygon fill="black" stroke="black" points="11649.68,-1021.49 11646.18,-1011.49 11642.68,-1021.49 11649.68,-1021.49"/>
</g>
<!-- split_9&#45;&gt;expert_9_up -->
<g id="edge91" class="edge">
<title>split_9&#45;&gt;expert_9_up</title>
<path fill="none" stroke="black" d="M11911.53,-1051.05C11975.26,-1035.86 12041.78,-1020.01 12100.29,-1006.08"/>
<polygon fill="black" stroke="black" points="12101.44,-1009.4 12110.36,-1003.68 12099.82,-1002.59 12101.44,-1009.4"/>
</g>
<!-- agg_9&#45;&gt;moe_agg -->
<g id="edge97" class="edge">
<title>agg_9&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M11289.23,-457.54C11230.09,-446.34 11168.63,-434.71 11109.24,-423.47"/>
<polygon fill="black" stroke="black" points="11109.82,-420.01 11099.34,-421.59 11108.52,-426.89 11109.82,-420.01"/>
</g>
<!-- split_10&#45;&gt;expert_10_gate -->
<g id="edge99" class="edge">
<title>split_10&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" d="M12906.18,-1047.12C12906.18,-1038.57 12906.18,-1029.89 12906.18,-1021.52"/>
<polygon fill="black" stroke="black" points="12909.68,-1021.49 12906.18,-1011.49 12902.68,-1021.49 12909.68,-1021.49"/>
</g>
<!-- split_10&#45;&gt;expert_10_up -->
<g id="edge100" class="edge">
<title>split_10&#45;&gt;expert_10_up</title>
<path fill="none" stroke="black" d="M13171.53,-1051.05C13235.26,-1035.86 13301.78,-1020.01 13360.29,-1006.08"/>
<polygon fill="black" stroke="black" points="13361.44,-1009.4 13370.36,-1003.68 13359.82,-1002.59 13361.44,-1009.4"/>
</g>
<!-- agg_10&#45;&gt;moe_agg -->
<g id="edge106" class="edge">
<title>agg_10&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M12312.34,-479.37C12238.43,-471.7 12162.04,-464.11 12090.18,-457.55 11770.69,-428.36 11408,-400.91 11139.81,-381.71"/>
<polygon fill="black" stroke="black" points="11139.74,-378.19 11129.52,-380.97 11139.24,-385.17 11139.74,-378.19"/>
</g>
<!-- split_11&#45;&gt;expert_11_gate -->
<g id="edge108" class="edge">
<title>split_11&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" d="M14166.18,-1047.12C14166.18,-1038.57 14166.18,-1029.89 14166.18,-1021.52"/>
<polygon fill="black" stroke="black" points="14169.68,-1021.49 14166.18,-1011.49 14162.68,-1021.49 14169.68,-1021.49"/>
</g>
<!-- split_11&#45;&gt;expert_11_up -->
<g id="edge109" class="edge">
<title>split_11&#45;&gt;expert_11_up</title>
<path fill="none" stroke="black" d="M14431.53,-1051.05C14495.26,-1035.86 14561.78,-1020.01 14620.29,-1006.08"/>
<polygon fill="black" stroke="black" points="14621.44,-1009.4 14630.36,-1003.68 14619.82,-1002.59 14621.44,-1009.4"/>
</g>
<!-- agg_11&#45;&gt;moe_agg -->
<g id="edge115" class="edge">
<title>agg_11&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M13586.75,-488.79C13453.79,-477.64 13304.65,-466.05 13168.18,-457.55 12443.34,-412.36 11595.26,-381.31 11119.09,-365.85"/>
<polygon fill="black" stroke="black" points="11119.07,-362.35 11108.96,-365.53 11118.84,-369.35 11119.07,-362.35"/>
</g>
<!-- split_12&#45;&gt;expert_12_gate -->
<g id="edge117" class="edge">
<title>split_12&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" d="M15426.18,-1047.12C15426.18,-1038.57 15426.18,-1029.89 15426.18,-1021.52"/>
<polygon fill="black" stroke="black" points="15429.68,-1021.49 15426.18,-1011.49 15422.68,-1021.49 15429.68,-1021.49"/>
</g>
<!-- split_12&#45;&gt;expert_12_up -->
<g id="edge118" class="edge">
<title>split_12&#45;&gt;expert_12_up</title>
<path fill="none" stroke="black" d="M15691.53,-1051.05C15755.26,-1035.86 15821.78,-1020.01 15880.29,-1006.08"/>
<polygon fill="black" stroke="black" points="15881.44,-1009.4 15890.36,-1003.68 15879.82,-1002.59 15881.44,-1009.4"/>
</g>
<!-- agg_12&#45;&gt;moe_agg -->
<g id="edge124" class="edge">
<title>agg_12&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M14745.9,-482.24C14643.01,-472.78 14532.6,-463.73 14430.18,-457.55 13214.06,-384.12 11768.95,-362.94 11107.86,-356.91"/>
<polygon fill="black" stroke="black" points="11107.73,-353.41 11097.7,-356.81 11107.67,-360.41 11107.73,-353.41"/>
</g>
<!-- split_13&#45;&gt;expert_13_gate -->
<g id="edge126" class="edge">
<title>split_13&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" d="M16686.18,-1047.12C16686.18,-1038.57 16686.18,-1029.89 16686.18,-1021.52"/>
<polygon fill="black" stroke="black" points="16689.68,-1021.49 16686.18,-1011.49 16682.68,-1021.49 16689.68,-1021.49"/>
</g>
<!-- split_13&#45;&gt;expert_13_up -->
<g id="edge127" class="edge">
<title>split_13&#45;&gt;expert_13_up</title>
<path fill="none" stroke="black" d="M16951.53,-1051.05C17015.26,-1035.86 17081.78,-1020.01 17140.29,-1006.08"/>
<polygon fill="black" stroke="black" points="17141.44,-1009.4 17150.36,-1003.68 17139.82,-1002.59 17141.44,-1009.4"/>
</g>
<!-- agg_13&#45;&gt;moe_agg -->
<g id="edge133" class="edge">
<title>agg_13&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M15962.99,-484.39C15845.5,-474.02 15716.8,-463.98 15598.18,-457.55 13919.04,-366.49 11909.04,-354.8 11104.16,-354.08"/>
<polygon fill="black" stroke="black" points="11104.16,-350.58 11094.16,-354.07 11104.15,-357.58 11104.16,-350.58"/>
</g>
<!-- split_14&#45;&gt;expert_14_gate -->
<g id="edge135" class="edge">
<title>split_14&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" d="M17946.18,-1047.12C17946.18,-1038.57 17946.18,-1029.89 17946.18,-1021.52"/>
<polygon fill="black" stroke="black" points="17949.68,-1021.49 17946.18,-1011.49 17942.68,-1021.49 17949.68,-1021.49"/>
</g>
<!-- split_14&#45;&gt;expert_14_up -->
<g id="edge136" class="edge">
<title>split_14&#45;&gt;expert_14_up</title>
<path fill="none" stroke="black" d="M18211.53,-1051.05C18275.26,-1035.86 18341.78,-1020.01 18400.29,-1006.08"/>
<polygon fill="black" stroke="black" points="18401.44,-1009.4 18410.36,-1003.68 18399.82,-1002.59 18401.44,-1009.4"/>
</g>
<!-- agg_14&#45;&gt;moe_agg -->
<g id="edge142" class="edge">
<title>agg_14&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M17371.03,-492.19C17199.58,-479.27 16996.03,-465.58 16812.18,-457.55 14646.51,-362.94 12042.47,-353.88 11104.05,-353.96"/>
<polygon fill="black" stroke="black" points="11103.77,-350.46 11093.77,-353.96 11103.77,-357.46 11103.77,-350.46"/>
</g>
<!-- split_15&#45;&gt;expert_15_gate -->
<g id="edge144" class="edge">
<title>split_15&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" d="M19206.18,-1047.12C19206.18,-1038.57 19206.18,-1029.89 19206.18,-1021.52"/>
<polygon fill="black" stroke="black" points="19209.68,-1021.49 19206.18,-1011.49 19202.68,-1021.49 19209.68,-1021.49"/>
</g>
<!-- split_15&#45;&gt;expert_15_up -->
<g id="edge145" class="edge">
<title>split_15&#45;&gt;expert_15_up</title>
<path fill="none" stroke="black" d="M19471.53,-1051.05C19535.26,-1035.86 19601.78,-1020.01 19660.29,-1006.08"/>
<polygon fill="black" stroke="black" points="19661.44,-1009.4 19670.36,-1003.68 19659.82,-1002.59 19661.44,-1009.4"/>
</g>
<!-- agg_15&#45;&gt;moe_agg -->
<g id="edge151" class="edge">
<title>agg_15&#45;&gt;moe_agg</title>
<path fill="none" stroke="black" d="M18524.54,-481.11C18422.05,-471.71 18312.17,-462.98 18210.18,-457.55 16803.08,-382.58 12401.14,-360.65 11106.65,-355.75"/>
<polygon fill="black" stroke="black" points="11106.27,-352.25 11096.26,-355.71 11106.25,-359.25 11106.27,-352.25"/>
</g>
<!-- moe_agg&#45;&gt;moe_res -->
<g id="edge152" class="edge">
<title>moe_agg&#45;&gt;moe_res</title>
<path fill="none" stroke="black" d="M11077.17,-341.21C11951.56,-311.37 14308.34,-230.93 15149.61,-202.22"/>
<polygon fill="black" stroke="black" points="15149.87,-205.71 15159.75,-201.87 15149.63,-198.71 15149.87,-205.71"/>
</g>
<!-- layer_output -->
<g id="node122" class="node">
<title>layer_output</title>
<ellipse fill="lightcyan" stroke="black" cx="15453.18" cy="-48.08" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="15453.18" y="-66.88" font-family="Times,serif" font-size="14.00">Layer Output</text>
<text text-anchor="middle" x="15453.18" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="15453.18" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15453.18" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- moe_res&#45;&gt;layer_output -->
<g id="edge154" class="edge">
<title>moe_res&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M15453.18,-131.79C15453.18,-123.39 15453.18,-114.74 15453.18,-106.36"/>
<polygon fill="black" stroke="black" points="15456.68,-106.3 15453.18,-96.3 15449.68,-106.3 15456.68,-106.3"/>
</g>
</g>
</svg>
