<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2880pt" height="410pt"
 viewBox="0.00 0.00 2880.00 409.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.15 0.15) rotate(0) translate(4 2702.14)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2702.14 19013.2,-2702.14 19013.2,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcyan" stroke="black" cx="14029.2" cy="-2650.05" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="14029.2" y="-2668.85" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="14029.2" y="-2653.85" font-family="Times,serif" font-size="14.00">GPU: N/A</text>
<text text-anchor="middle" x="14029.2" y="-2638.85" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14029.2" y="-2623.85" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- ln1 -->
<g id="node3" class="node">
<title>ln1</title>
<ellipse fill="lightblue" stroke="black" cx="13829.2" cy="-2517.89" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="13829.2" y="-2536.69" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13829.2" y="-2521.69" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="13829.2" y="-2506.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="13829.2" y="-2491.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M13958.69,-2603.16C13942.4,-2592.57 13924.98,-2581.22 13908.36,-2570.41"/>
<polygon fill="black" stroke="black" points="13910.04,-2567.33 13899.75,-2564.8 13906.22,-2573.19 13910.04,-2567.33"/>
</g>
<!-- res1 -->
<g id="node14" class="node">
<title>res1</title>
<ellipse fill="lightblue" stroke="black" cx="14412.2" cy="-1582.12" rx="298.3" ry="58.88"/>
<text text-anchor="middle" x="14412.2" y="-1608.42" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="14412.2" y="-1593.42" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="14412.2" y="-1578.42" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14412.2" y="-1563.42" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14412.2" y="-1548.42" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M14298.58,-2629.19C14452.12,-2601.48 14614.2,-2536.71 14614.2,-2386.72 14614.2,-2386.72 14614.2,-2386.72 14614.2,-1856.06 14614.2,-1775.74 14637.09,-1742.73 14591.2,-1676.81 14581.48,-1662.85 14569.03,-1650.82 14555.22,-1640.48"/>
<polygon fill="black" stroke="black" points="14557.12,-1637.54 14546.94,-1634.59 14553.06,-1643.24 14557.12,-1637.54"/>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<ellipse fill="lightcyan" stroke="black" cx="14682.2" cy="-48.08" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="14682.2" y="-66.88" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="14682.2" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: N/A</text>
<text text-anchor="middle" x="14682.2" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14682.2" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- q_proj -->
<g id="node4" class="node">
<title>q_proj</title>
<ellipse fill="lightblue" stroke="black" cx="12681.2" cy="-2385.72" rx="372.79" ry="48.17"/>
<text text-anchor="middle" x="12681.2" y="-2404.52" font-family="Times,serif" font-size="14.00">Q Projection (Column Parallel)</text>
<text text-anchor="middle" x="12681.2" y="-2389.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="12681.2" y="-2374.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="12681.2" y="-2359.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
</g>
<!-- ln1&#45;&gt;q_proj -->
<g id="edge2" class="edge">
<title>ln1&#45;&gt;q_proj</title>
<path fill="none" stroke="black" d="M13582.23,-2490.9C13432.57,-2474.93 13237.83,-2453.77 13065.2,-2433.8 13029.83,-2429.71 12992.63,-2425.3 12955.9,-2420.87"/>
<polygon fill="black" stroke="black" points="12955.9,-2417.34 12945.55,-2419.62 12955.06,-2424.29 12955.9,-2417.34"/>
</g>
<!-- k_proj -->
<g id="node5" class="node">
<title>k_proj</title>
<ellipse fill="lightblue" stroke="black" cx="13447.2" cy="-2385.72" rx="372.79" ry="48.17"/>
<text text-anchor="middle" x="13447.2" y="-2404.52" font-family="Times,serif" font-size="14.00">K Projection (Column Parallel)</text>
<text text-anchor="middle" x="13447.2" y="-2389.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13447.2" y="-2374.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="13447.2" y="-2359.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
</g>
<!-- ln1&#45;&gt;k_proj -->
<g id="edge3" class="edge">
<title>ln1&#45;&gt;k_proj</title>
<path fill="none" stroke="black" d="M13703.85,-2474.18C13666.25,-2461.36 13624.79,-2447.24 13586.35,-2434.14"/>
<polygon fill="black" stroke="black" points="13587.25,-2430.75 13576.65,-2430.83 13584.99,-2437.37 13587.25,-2430.75"/>
</g>
<!-- v_proj -->
<g id="node6" class="node">
<title>v_proj</title>
<ellipse fill="lightblue" stroke="black" cx="14210.2" cy="-2385.72" rx="372.79" ry="48.17"/>
<text text-anchor="middle" x="14210.2" y="-2404.52" font-family="Times,serif" font-size="14.00">V Projection (Column Parallel)</text>
<text text-anchor="middle" x="14210.2" y="-2389.52" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="14210.2" y="-2374.52" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14210.2" y="-2359.52" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
</g>
<!-- ln1&#45;&gt;v_proj -->
<g id="edge4" class="edge">
<title>ln1&#45;&gt;v_proj</title>
<path fill="none" stroke="black" d="M13954.22,-2474.18C13991.72,-2461.36 14033.07,-2447.24 14071.41,-2434.14"/>
<polygon fill="black" stroke="black" points="14072.75,-2437.38 14081.08,-2430.83 14070.49,-2430.75 14072.75,-2437.38"/>
</g>
<!-- comm_q -->
<g id="node7" class="node">
<title>comm_q</title>
<ellipse fill="lightyellow" stroke="black" cx="12675.2" cy="-2253.55" rx="379.02" ry="48.17"/>
<text text-anchor="middle" x="12675.2" y="-2272.35" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="12675.2" y="-2257.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="12675.2" y="-2242.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
<text text-anchor="middle" x="12675.2" y="-2227.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
</g>
<!-- q_proj&#45;&gt;comm_q -->
<g id="edge5" class="edge">
<title>q_proj&#45;&gt;comm_q</title>
<path fill="none" stroke="black" d="M12679.01,-2337.36C12678.63,-2329.09 12678.23,-2320.41 12677.84,-2311.91"/>
<polygon fill="black" stroke="black" points="12681.33,-2311.49 12677.37,-2301.66 12674.33,-2311.81 12681.33,-2311.49"/>
</g>
<!-- comm_k -->
<g id="node8" class="node">
<title>comm_k</title>
<ellipse fill="lightyellow" stroke="black" cx="13451.2" cy="-2253.55" rx="379.02" ry="48.17"/>
<text text-anchor="middle" x="13451.2" y="-2272.35" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="13451.2" y="-2257.35" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13451.2" y="-2242.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
<text text-anchor="middle" x="13451.2" y="-2227.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
</g>
<!-- k_proj&#45;&gt;comm_k -->
<g id="edge6" class="edge">
<title>k_proj&#45;&gt;comm_k</title>
<path fill="none" stroke="black" d="M13448.65,-2337.36C13448.91,-2329.09 13449.17,-2320.41 13449.44,-2311.91"/>
<polygon fill="black" stroke="black" points="13452.94,-2311.77 13449.75,-2301.66 13445.94,-2311.55 13452.94,-2311.77"/>
</g>
<!-- comm_v -->
<g id="node9" class="node">
<title>comm_v</title>
<ellipse fill="lightyellow" stroke="black" cx="14207.2" cy="-2121.39" rx="379.02" ry="48.17"/>
<text text-anchor="middle" x="14207.2" y="-2140.19" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="14207.2" y="-2125.19" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="14207.2" y="-2110.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, num_heads=16, head_dim=128]</text>
<text text-anchor="middle" x="14207.2" y="-2095.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
</g>
<!-- v_proj&#45;&gt;comm_v -->
<g id="edge7" class="edge">
<title>v_proj&#45;&gt;comm_v</title>
<path fill="none" stroke="black" d="M14209.66,-2337.52C14209.15,-2293.27 14208.39,-2227.02 14207.85,-2179.74"/>
<polygon fill="black" stroke="black" points="14211.35,-2179.61 14207.74,-2169.65 14204.35,-2179.69 14211.35,-2179.61"/>
</g>
<!-- attn_score -->
<g id="node10" class="node">
<title>attn_score</title>
<ellipse fill="lightblue" stroke="black" cx="13435.2" cy="-2121.39" rx="374.53" ry="48.17"/>
<text text-anchor="middle" x="13435.2" y="-2140.19" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="13435.2" y="-2125.19" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13435.2" y="-2110.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, seq_len=2048, num_heads=128]</text>
<text text-anchor="middle" x="13435.2" y="-2095.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, seq_len=2048, num_heads=128]</text>
</g>
<!-- comm_q&#45;&gt;attn_score -->
<g id="edge8" class="edge">
<title>comm_q&#45;&gt;attn_score</title>
<path fill="none" stroke="black" d="M12897.06,-2214.56C12993.54,-2198.03 13106.56,-2178.67 13204.05,-2161.98"/>
<polygon fill="black" stroke="black" points="13204.78,-2165.4 13214.04,-2160.27 13203.59,-2158.5 13204.78,-2165.4"/>
</g>
<!-- comm_k&#45;&gt;attn_score -->
<g id="edge9" class="edge">
<title>comm_k&#45;&gt;attn_score</title>
<path fill="none" stroke="black" d="M13445.38,-2205.19C13444.35,-2196.83 13443.27,-2188.05 13442.21,-2179.46"/>
<polygon fill="black" stroke="black" points="13445.68,-2178.99 13440.99,-2169.5 13438.73,-2179.85 13445.68,-2178.99"/>
</g>
<!-- attn_weight -->
<g id="node12" class="node">
<title>attn_weight</title>
<ellipse fill="lightblue" stroke="black" cx="14207.2" cy="-1857.06" rx="379.02" ry="48.17"/>
<text text-anchor="middle" x="14207.2" y="-1875.86" font-family="Times,serif" font-size="14.00">Weighted Values</text>
<text text-anchor="middle" x="14207.2" y="-1860.86" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="14207.2" y="-1845.86" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, seq_len=2048, num_heads=128]</text>
<text text-anchor="middle" x="14207.2" y="-1830.86" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
</g>
<!-- comm_v&#45;&gt;attn_weight -->
<g id="edge12" class="edge">
<title>comm_v&#45;&gt;attn_weight</title>
<path fill="none" stroke="black" d="M14207.2,-2073.19C14207.2,-2028.93 14207.2,-1962.68 14207.2,-1915.41"/>
<polygon fill="black" stroke="black" points="14210.7,-1915.32 14207.2,-1905.32 14203.7,-1915.32 14210.7,-1915.32"/>
</g>
<!-- attn_softmax -->
<g id="node11" class="node">
<title>attn_softmax</title>
<ellipse fill="lightblue" stroke="black" cx="13620.2" cy="-1989.22" rx="374.53" ry="48.17"/>
<text text-anchor="middle" x="13620.2" y="-2008.02" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13620.2" y="-1993.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13620.2" y="-1978.02" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, seq_len=2048, num_heads=128]</text>
<text text-anchor="middle" x="13620.2" y="-1963.02" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, seq_len=2048, num_heads=128]</text>
</g>
<!-- attn_score&#45;&gt;attn_softmax -->
<g id="edge10" class="edge">
<title>attn_score&#45;&gt;attn_softmax</title>
<path fill="none" stroke="black" d="M13501.2,-2073.95C13515.6,-2063.81 13530.94,-2053.03 13545.64,-2042.68"/>
<polygon fill="black" stroke="black" points="13548.05,-2045.26 13554.22,-2036.65 13544.03,-2039.54 13548.05,-2045.26"/>
</g>
<!-- attn_softmax&#45;&gt;attn_weight -->
<g id="edge11" class="edge">
<title>attn_softmax&#45;&gt;attn_weight</title>
<path fill="none" stroke="black" d="M13804.72,-1947.3C13870.8,-1932.65 13945.47,-1916.09 14012.39,-1901.25"/>
<polygon fill="black" stroke="black" points="14013.2,-1904.66 14022.21,-1899.08 14011.69,-1897.82 14013.2,-1904.66"/>
</g>
<!-- o_proj -->
<g id="node13" class="node">
<title>o_proj</title>
<ellipse fill="lightblue" stroke="black" cx="14211.2" cy="-1724.89" rx="370.55" ry="48.17"/>
<text text-anchor="middle" x="14211.2" y="-1743.69" font-family="Times,serif" font-size="14.00">O Projection (Row Parallel)</text>
<text text-anchor="middle" x="14211.2" y="-1728.69" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="14211.2" y="-1713.69" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, num_heads=128, head_dim=128]</text>
<text text-anchor="middle" x="14211.2" y="-1698.69" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- attn_weight&#45;&gt;o_proj -->
<g id="edge13" class="edge">
<title>attn_weight&#45;&gt;o_proj</title>
<path fill="none" stroke="black" d="M14208.65,-1808.69C14208.91,-1800.43 14209.17,-1791.74 14209.44,-1783.24"/>
<polygon fill="black" stroke="black" points="14212.94,-1783.1 14209.75,-1773 14205.94,-1782.88 14212.94,-1783.1"/>
</g>
<!-- o_proj&#45;&gt;res1 -->
<g id="edge14" class="edge">
<title>o_proj&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M14277.57,-1677.4C14292.43,-1667 14308.42,-1655.8 14324,-1644.88"/>
<polygon fill="black" stroke="black" points="14326.43,-1647.46 14332.61,-1638.86 14322.41,-1641.73 14326.43,-1647.46"/>
</g>
<!-- gate -->
<g id="node15" class="node">
<title>gate</title>
<polygon fill="lightgreen" stroke="black" points="10240.34,-1487.43 9564.04,-1487.43 9390.06,-1351.43 10066.36,-1351.43 10240.34,-1487.43"/>
<text text-anchor="middle" x="9815.2" y="-1438.23" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="9815.2" y="-1423.23" font-family="Times,serif" font-size="14.00">GPU: Routing Node</text>
<text text-anchor="middle" x="9815.2" y="-1408.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="9815.2" y="-1393.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, top_k=2]</text>
</g>
<!-- res1&#45;&gt;gate -->
<g id="edge16" class="edge">
<title>res1&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M14118.96,-1570.87C13313.12,-1542.7 11066.18,-1464.15 10180.63,-1433.2"/>
<polygon fill="black" stroke="black" points="10180.71,-1429.7 10170.6,-1432.85 10180.47,-1436.7 10180.71,-1429.7"/>
</g>
<!-- res2 -->
<g id="node129" class="node">
<title>res2</title>
<ellipse fill="lightblue" stroke="black" cx="14682.2" cy="-190.86" rx="298.3" ry="58.88"/>
<text text-anchor="middle" x="14682.2" y="-217.16" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="14682.2" y="-202.16" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="14682.2" y="-187.16" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14682.2" y="-172.16" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14682.2" y="-157.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge162" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M14708.95,-1575.22C15726.1,-1553.07 19009.2,-1464.82 19009.2,-1248.43 19009.2,-1248.43 19009.2,-1248.43 19009.2,-524.55 19009.2,-322.64 15974.5,-225.58 14987.99,-199.36"/>
<polygon fill="black" stroke="black" points="14988,-195.86 14977.91,-199.1 14987.81,-202.86 14988,-195.86"/>
</g>
<!-- split_0 -->
<g id="node16" class="node">
<title>split_0</title>
<polygon fill="lightgreen" stroke="black" points="1429.61,-1315.43 701.97,-1315.43 514.78,-1179.43 1242.43,-1179.43 1429.61,-1315.43"/>
<text text-anchor="middle" x="972.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="972.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="972.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="972.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_0 -->
<g id="edge17" class="edge">
<title>gate&#45;&gt;split_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9473.21,-1416.46C8009.17,-1407.74 2307.96,-1370.52 1506.2,-1315.43 1481.41,-1313.72 1456,-1311.65 1430.38,-1309.3"/>
<polygon fill="black" stroke="black" points="1430.45,-1305.79 1420.17,-1308.35 1429.8,-1312.76 1430.45,-1305.79"/>
</g>
<!-- split_1 -->
<g id="node17" class="node">
<title>split_1</title>
<polygon fill="lightgreen" stroke="black" points="2429.61,-1315.43 1701.97,-1315.43 1514.78,-1179.43 2242.43,-1179.43 2429.61,-1315.43"/>
<text text-anchor="middle" x="1972.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="1972.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1972.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="1972.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_1 -->
<g id="edge18" class="edge">
<title>gate&#45;&gt;split_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9473.39,-1416.75C8247.22,-1410.25 4071.85,-1383.49 2737.2,-1315.43 2629.87,-1309.95 2514.28,-1301.28 2406.28,-1291.97"/>
<polygon fill="black" stroke="black" points="2406.45,-1288.47 2396.19,-1291.1 2405.85,-1295.45 2406.45,-1288.47"/>
</g>
<!-- split_2 -->
<g id="node18" class="node">
<title>split_2</title>
<polygon fill="lightgreen" stroke="black" points="3660.61,-1315.43 2932.97,-1315.43 2745.78,-1179.43 3473.43,-1179.43 3660.61,-1315.43"/>
<text text-anchor="middle" x="3203.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="3203.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3203.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="3203.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_2 -->
<g id="edge19" class="edge">
<title>gate&#45;&gt;split_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9471.24,-1415.07C8396.69,-1404.14 5110.8,-1367.28 4045.2,-1315.43 3910.57,-1308.87 3764.06,-1298.39 3631.57,-1287.64"/>
<polygon fill="black" stroke="black" points="3631.5,-1284.12 3621.25,-1286.8 3630.93,-1291.1 3631.5,-1284.12"/>
</g>
<!-- split_3 -->
<g id="node19" class="node">
<title>split_3</title>
<polygon fill="lightgreen" stroke="black" points="4968.61,-1315.43 4240.97,-1315.43 4053.78,-1179.43 4781.43,-1179.43 4968.61,-1315.43"/>
<text text-anchor="middle" x="4511.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="4511.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4511.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="4511.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_3 -->
<g id="edge20" class="edge">
<title>gate&#45;&gt;split_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9473.84,-1417.1C8726.5,-1412.75 6889.52,-1394.22 5353.2,-1315.43 5218.41,-1308.51 5071.7,-1297.91 4939.07,-1287.16"/>
<polygon fill="black" stroke="black" points="4938.98,-1283.65 4928.73,-1286.32 4938.41,-1290.62 4938.98,-1283.65"/>
</g>
<!-- split_4 -->
<g id="node20" class="node">
<title>split_4</title>
<polygon fill="lightgreen" stroke="black" points="6276.61,-1315.43 5548.97,-1315.43 5361.78,-1179.43 6089.43,-1179.43 6276.61,-1315.43"/>
<text text-anchor="middle" x="5819.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="5819.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5819.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="5819.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_4 -->
<g id="edge21" class="edge">
<title>gate&#45;&gt;split_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9470.27,-1414.27C8874.73,-1405.59 7615.35,-1380.61 6553.2,-1315.43 6456.27,-1309.48 6352.3,-1301.17 6253.98,-1292.42"/>
<polygon fill="black" stroke="black" points="6254.15,-1288.92 6243.87,-1291.51 6253.52,-1295.89 6254.15,-1288.92"/>
</g>
<!-- split_5 -->
<g id="node21" class="node">
<title>split_5</title>
<polygon fill="lightgreen" stroke="black" points="7476.61,-1315.43 6748.97,-1315.43 6561.78,-1179.43 7289.43,-1179.43 7476.61,-1315.43"/>
<text text-anchor="middle" x="7019.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="7019.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7019.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="7019.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_5 -->
<g id="edge22" class="edge">
<title>gate&#45;&gt;split_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9469.54,-1413.78C9016.11,-1405.27 8195.78,-1381.54 7485.58,-1315.44"/>
<polygon fill="black" stroke="black" points="7485.68,-1311.94 7475.4,-1314.49 7485.03,-1318.9 7485.68,-1311.94"/>
</g>
<!-- split_6 -->
<g id="node22" class="node">
<title>split_6</title>
<polygon fill="lightgreen" stroke="black" points="8408.61,-1315.43 7680.97,-1315.43 7493.78,-1179.43 8221.43,-1179.43 8408.61,-1315.43"/>
<text text-anchor="middle" x="7951.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="7951.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="7951.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="7951.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_6 -->
<g id="edge23" class="edge">
<title>gate&#45;&gt;split_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9449.94,-1398.46C9167.5,-1381.34 8766.96,-1353.41 8417.2,-1315.43 8417.09,-1315.41 8416.99,-1315.4 8416.88,-1315.39"/>
<polygon fill="black" stroke="black" points="8417.43,-1311.93 8407.1,-1314.32 8416.66,-1318.89 8417.43,-1311.93"/>
</g>
<!-- split_7 -->
<g id="node23" class="node">
<title>split_7</title>
<polygon fill="lightgreen" stroke="black" points="9340.61,-1315.43 8612.97,-1315.43 8425.78,-1179.43 9153.43,-1179.43 9340.61,-1315.43"/>
<text text-anchor="middle" x="8883.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="8883.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="8883.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="8883.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_7 -->
<g id="edge24" class="edge">
<title>gate&#45;&gt;split_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9447.85,-1351.42C9386.34,-1340.2 9322.43,-1328.54 9260.66,-1317.28"/>
<polygon fill="black" stroke="black" points="9261.24,-1313.82 9250.77,-1315.47 9259.98,-1320.71 9261.24,-1313.82"/>
</g>
<!-- split_8 -->
<g id="node24" class="node">
<title>split_8</title>
<polygon fill="lightgreen" stroke="black" points="10272.61,-1315.43 9544.97,-1315.43 9357.78,-1179.43 10085.43,-1179.43 10272.61,-1315.43"/>
<text text-anchor="middle" x="9815.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="9815.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="9815.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="9815.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_8 -->
<g id="edge25" class="edge">
<title>gate&#45;&gt;split_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9815.2,-1351.24C9815.2,-1342.92 9815.2,-1334.37 9815.2,-1325.92"/>
<polygon fill="black" stroke="black" points="9818.7,-1325.68 9815.2,-1315.68 9811.7,-1325.68 9818.7,-1325.68"/>
</g>
<!-- split_9 -->
<g id="node25" class="node">
<title>split_9</title>
<polygon fill="lightgreen" stroke="black" points="11204.61,-1315.43 10476.97,-1315.43 10289.78,-1179.43 11017.43,-1179.43 11204.61,-1315.43"/>
<text text-anchor="middle" x="10747.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="10747.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="10747.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="10747.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_9 -->
<g id="edge26" class="edge">
<title>gate&#45;&gt;split_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10088.53,-1368.57C10201.13,-1348.03 10331.95,-1324.17 10447.19,-1303.15"/>
<polygon fill="black" stroke="black" points="10448.02,-1306.56 10457.23,-1301.32 10446.76,-1299.67 10448.02,-1306.56"/>
</g>
<!-- split_10 -->
<g id="node26" class="node">
<title>split_10</title>
<polygon fill="lightgreen" stroke="black" points="12136.61,-1315.43 11408.97,-1315.43 11221.78,-1179.43 11949.43,-1179.43 12136.61,-1315.43"/>
<text text-anchor="middle" x="11679.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="11679.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="11679.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="11679.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_10 -->
<g id="edge27" class="edge">
<title>gate&#45;&gt;split_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10130.51,-1401.45C10414.22,-1384.68 10842.27,-1355.71 11213.2,-1315.43 11263.96,-1309.91 11317.7,-1303.1 11369.94,-1295.95"/>
<polygon fill="black" stroke="black" points="11370.59,-1299.39 11380.02,-1294.57 11369.64,-1292.46 11370.59,-1299.39"/>
</g>
<!-- split_11 -->
<g id="node27" class="node">
<title>split_11</title>
<polygon fill="lightgreen" stroke="black" points="13234.61,-1315.43 12506.97,-1315.43 12319.78,-1179.43 13047.43,-1179.43 13234.61,-1315.43"/>
<text text-anchor="middle" x="12777.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="12777.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="12777.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="12777.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_11 -->
<g id="edge28" class="edge">
<title>gate&#45;&gt;split_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10142.12,-1410.31C10593.23,-1397.66 11431.78,-1368.96 12145.2,-1315.43 12246.12,-1307.85 12355.86,-1297.1 12455.14,-1286.43"/>
<polygon fill="black" stroke="black" points="12455.76,-1289.88 12465.33,-1285.33 12455.01,-1282.92 12455.76,-1289.88"/>
</g>
<!-- split_12 -->
<g id="node28" class="node">
<title>split_12</title>
<polygon fill="lightgreen" stroke="black" points="14542.61,-1315.43 13814.97,-1315.43 13627.78,-1179.43 14355.43,-1179.43 14542.61,-1315.43"/>
<text text-anchor="middle" x="14085.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="14085.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14085.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="14085.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_12 -->
<g id="edge29" class="edge">
<title>gate&#45;&gt;split_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10146.35,-1413.91C10758.35,-1404.35 12107.67,-1377.63 13243.2,-1315.43 13411.37,-1306.21 13598.12,-1291.78 13752.93,-1278.67"/>
<polygon fill="black" stroke="black" points="13753.42,-1282.14 13763.08,-1277.81 13752.82,-1275.16 13753.42,-1282.14"/>
</g>
<!-- split_13 -->
<g id="node29" class="node">
<title>split_13</title>
<polygon fill="lightgreen" stroke="black" points="15850.61,-1315.43 15122.97,-1315.43 14935.78,-1179.43 15663.43,-1179.43 15850.61,-1315.43"/>
<text text-anchor="middle" x="15393.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="15393.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15393.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="15393.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_13 -->
<g id="edge30" class="edge">
<title>gate&#45;&gt;split_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10151.36,-1417.77C10927.12,-1414.79 12902.31,-1398.89 14551.2,-1315.43 14719.68,-1306.9 14906.76,-1292.5 15061.71,-1279.24"/>
<polygon fill="black" stroke="black" points="15062.2,-1282.71 15071.87,-1278.37 15061.61,-1275.74 15062.2,-1282.71"/>
</g>
<!-- split_14 -->
<g id="node30" class="node">
<title>split_14</title>
<polygon fill="lightgreen" stroke="black" points="17158.61,-1315.43 16430.97,-1315.43 16243.78,-1179.43 16971.43,-1179.43 17158.61,-1315.43"/>
<text text-anchor="middle" x="16701.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="16701.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16701.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="16701.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_14 -->
<g id="edge31" class="edge">
<title>gate&#45;&gt;split_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10148.69,-1415.49C11245.35,-1405.39 14733.98,-1369.73 15859.2,-1315.43 16027.87,-1307.29 16215.18,-1292.91 16370.22,-1279.56"/>
<polygon fill="black" stroke="black" points="16370.72,-1283.03 16380.39,-1278.68 16370.12,-1276.05 16370.72,-1283.03"/>
</g>
<!-- split_15 -->
<g id="node31" class="node">
<title>split_15</title>
<polygon fill="lightgreen" stroke="black" points="18466.61,-1315.43 17738.97,-1315.43 17551.78,-1179.43 18279.43,-1179.43 18466.61,-1315.43"/>
<text text-anchor="middle" x="18009.2" y="-1266.23" font-family="Times,serif" font-size="14.00">Token Split</text>
<text text-anchor="middle" x="18009.2" y="-1251.23" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18009.2" y="-1236.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="18009.2" y="-1221.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- gate&#45;&gt;split_15 -->
<g id="edge32" class="edge">
<title>gate&#45;&gt;split_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10149.9,-1416.65C11396.97,-1409.58 15773.13,-1380.59 17167.2,-1315.43 17335.98,-1307.54 17523.39,-1293.18 17678.48,-1279.77"/>
<polygon fill="black" stroke="black" points="17678.99,-1283.24 17688.65,-1278.89 17678.38,-1276.26 17678.99,-1283.24"/>
</g>
<!-- expert_gate_0 -->
<g id="node32" class="node">
<title>expert_gate_0</title>
<ellipse fill="lightblue" stroke="black" cx="318.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="318.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="318.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="318.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="318.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_0&#45;&gt;expert_gate_0 -->
<g id="edge33" class="edge">
<title>split_0&#45;&gt;expert_gate_0</title>
<path fill="none" stroke="black" d="M680.11,-1179.39C618.94,-1165.36 556.13,-1150.94 500.35,-1138.14"/>
<polygon fill="black" stroke="black" points="500.92,-1134.68 490.39,-1135.86 499.35,-1141.51 500.92,-1134.68"/>
</g>
<!-- expert_up_0 -->
<g id="node33" class="node">
<title>expert_up_0</title>
<ellipse fill="lightblue" stroke="black" cx="972.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="972.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="972.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="972.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="972.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_0&#45;&gt;expert_up_0 -->
<g id="edge34" class="edge">
<title>split_0&#45;&gt;expert_up_0</title>
<path fill="none" stroke="black" d="M972.2,-1179.29C972.2,-1170.74 972.2,-1162.06 972.2,-1153.69"/>
<polygon fill="black" stroke="black" points="975.7,-1153.66 972.2,-1143.66 968.7,-1153.66 975.7,-1153.66"/>
</g>
<!-- expert_gate_1 -->
<g id="node37" class="node">
<title>expert_gate_1</title>
<ellipse fill="lightblue" stroke="black" cx="1626.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="1626.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1626.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1626.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1626.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_1&#45;&gt;expert_gate_1 -->
<g id="edge40" class="edge">
<title>split_1&#45;&gt;expert_gate_1</title>
<path fill="none" stroke="black" d="M1817.67,-1179.39C1790.88,-1167.78 1763.5,-1155.9 1738.13,-1144.9"/>
<polygon fill="black" stroke="black" points="1739.45,-1141.65 1728.88,-1140.88 1736.66,-1148.07 1739.45,-1141.65"/>
</g>
<!-- expert_up_1 -->
<g id="node38" class="node">
<title>expert_up_1</title>
<ellipse fill="lightblue" stroke="black" cx="1895.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="1895.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="1895.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1895.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="1895.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_1&#45;&gt;expert_up_1 -->
<g id="edge41" class="edge">
<title>split_1&#45;&gt;expert_up_1</title>
<path fill="none" stroke="black" d="M1974.22,-1179.06C1973.36,-1139.56 1968.66,-1089.31 1953.2,-1047.26 1949.74,-1037.85 1944.94,-1028.51 1939.58,-1019.68"/>
<polygon fill="black" stroke="black" points="1942.39,-1017.57 1934.06,-1011.03 1936.49,-1021.34 1942.39,-1017.57"/>
</g>
<!-- expert_gate_2 -->
<g id="node42" class="node">
<title>expert_gate_2</title>
<ellipse fill="lightblue" stroke="black" cx="2703.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="2703.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2703.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="2703.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2703.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_2&#45;&gt;expert_gate_2 -->
<g id="edge47" class="edge">
<title>split_2&#45;&gt;expert_gate_2</title>
<path fill="none" stroke="black" d="M2979.89,-1179.39C2937.1,-1166.55 2893.25,-1153.39 2853.44,-1141.44"/>
<polygon fill="black" stroke="black" points="2854.26,-1138.03 2843.68,-1138.51 2852.25,-1144.74 2854.26,-1138.03"/>
</g>
<!-- expert_up_2 -->
<g id="node43" class="node">
<title>expert_up_2</title>
<ellipse fill="lightblue" stroke="black" cx="3203.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3203.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="3203.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3203.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="3203.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_2&#45;&gt;expert_up_2 -->
<g id="edge48" class="edge">
<title>split_2&#45;&gt;expert_up_2</title>
<path fill="none" stroke="black" d="M3203.2,-1179.18C3203.2,-1131.12 3203.2,-1067.16 3203.2,-1021.51"/>
<polygon fill="black" stroke="black" points="3206.7,-1021.49 3203.2,-1011.49 3199.7,-1021.49 3206.7,-1021.49"/>
</g>
<!-- expert_gate_3 -->
<g id="node47" class="node">
<title>expert_gate_3</title>
<ellipse fill="lightblue" stroke="black" cx="4011.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="4011.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="4011.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4011.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="4011.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_3&#45;&gt;expert_gate_3 -->
<g id="edge54" class="edge">
<title>split_3&#45;&gt;expert_gate_3</title>
<path fill="none" stroke="black" d="M4287.89,-1179.39C4245.1,-1166.55 4201.25,-1153.39 4161.44,-1141.44"/>
<polygon fill="black" stroke="black" points="4162.26,-1138.03 4151.68,-1138.51 4160.25,-1144.74 4162.26,-1138.03"/>
</g>
<!-- expert_up_3 -->
<g id="node48" class="node">
<title>expert_up_3</title>
<ellipse fill="lightblue" stroke="black" cx="4511.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="4511.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="4511.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4511.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="4511.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_3&#45;&gt;expert_up_3 -->
<g id="edge55" class="edge">
<title>split_3&#45;&gt;expert_up_3</title>
<path fill="none" stroke="black" d="M4511.2,-1179.18C4511.2,-1131.12 4511.2,-1067.16 4511.2,-1021.51"/>
<polygon fill="black" stroke="black" points="4514.7,-1021.49 4511.2,-1011.49 4507.7,-1021.49 4514.7,-1021.49"/>
</g>
<!-- expert_gate_4 -->
<g id="node52" class="node">
<title>expert_gate_4</title>
<ellipse fill="lightblue" stroke="black" cx="5319.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="5319.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="5319.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5319.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="5319.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_4&#45;&gt;expert_gate_4 -->
<g id="edge61" class="edge">
<title>split_4&#45;&gt;expert_gate_4</title>
<path fill="none" stroke="black" d="M5595.89,-1179.39C5553.1,-1166.55 5509.25,-1153.39 5469.44,-1141.44"/>
<polygon fill="black" stroke="black" points="5470.26,-1138.03 5459.68,-1138.51 5468.25,-1144.74 5470.26,-1138.03"/>
</g>
<!-- expert_up_4 -->
<g id="node53" class="node">
<title>expert_up_4</title>
<ellipse fill="lightblue" stroke="black" cx="5819.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="5819.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="5819.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5819.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="5819.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_4&#45;&gt;expert_up_4 -->
<g id="edge62" class="edge">
<title>split_4&#45;&gt;expert_up_4</title>
<path fill="none" stroke="black" d="M5819.2,-1179.18C5819.2,-1131.12 5819.2,-1067.16 5819.2,-1021.51"/>
<polygon fill="black" stroke="black" points="5822.7,-1021.49 5819.2,-1011.49 5815.7,-1021.49 5822.7,-1021.49"/>
</g>
<!-- expert_gate_5 -->
<g id="node57" class="node">
<title>expert_gate_5</title>
<ellipse fill="lightblue" stroke="black" cx="6600.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="6600.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="6600.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="6600.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="6600.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_5&#45;&gt;expert_gate_5 -->
<g id="edge68" class="edge">
<title>split_5&#45;&gt;expert_gate_5</title>
<path fill="none" stroke="black" d="M6832.06,-1179.39C6798.07,-1167.22 6763.29,-1154.76 6731.34,-1143.32"/>
<polygon fill="black" stroke="black" points="6732.12,-1139.88 6721.52,-1139.8 6729.76,-1146.47 6732.12,-1139.88"/>
</g>
<!-- expert_up_5 -->
<g id="node58" class="node">
<title>expert_up_5</title>
<ellipse fill="lightblue" stroke="black" cx="7127.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="7127.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="7127.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7127.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="7127.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_5&#45;&gt;expert_up_5 -->
<g id="edge69" class="edge">
<title>split_5&#45;&gt;expert_up_5</title>
<path fill="none" stroke="black" d="M7044.93,-1179.18C7063.39,-1130.92 7088,-1066.62 7105.48,-1020.94"/>
<polygon fill="black" stroke="black" points="7108.79,-1022.08 7109.09,-1011.49 7102.25,-1019.58 7108.79,-1022.08"/>
</g>
<!-- expert_gate_6 -->
<g id="node62" class="node">
<title>expert_gate_6</title>
<ellipse fill="lightblue" stroke="black" cx="7857.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="7857.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="7857.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="7857.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="7857.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_6&#45;&gt;expert_gate_6 -->
<g id="edge75" class="edge">
<title>split_6&#45;&gt;expert_gate_6</title>
<path fill="none" stroke="black" d="M7909.15,-1179.29C7903.5,-1170.27 7897.76,-1161.1 7892.25,-1152.31"/>
<polygon fill="black" stroke="black" points="7895.11,-1150.28 7886.83,-1143.66 7889.18,-1153.99 7895.11,-1150.28"/>
</g>
<!-- expert_up_6 -->
<g id="node63" class="node">
<title>expert_up_6</title>
<ellipse fill="lightblue" stroke="black" cx="8435.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="8435.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="8435.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8435.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="8435.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_6&#45;&gt;expert_up_6 -->
<g id="edge76" class="edge">
<title>split_6&#45;&gt;expert_up_6</title>
<path fill="none" stroke="black" d="M8114.37,-1179.4C8138.18,-1168.16 8162.11,-1156.02 8184.2,-1143.43 8250.07,-1105.87 8319.88,-1055.01 8369.1,-1017.06"/>
<polygon fill="black" stroke="black" points="8371.36,-1019.73 8377.13,-1010.84 8367.08,-1014.2 8371.36,-1019.73"/>
</g>
<!-- expert_gate_7 -->
<g id="node67" class="node">
<title>expert_gate_7</title>
<ellipse fill="lightblue" stroke="black" cx="8777.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="8777.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="8777.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="8777.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="8777.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_7&#45;&gt;expert_gate_7 -->
<g id="edge82" class="edge">
<title>split_7&#45;&gt;expert_gate_7</title>
<path fill="none" stroke="black" d="M8835.78,-1179.29C8829.19,-1169.96 8822.49,-1160.48 8816.09,-1151.41"/>
<polygon fill="black" stroke="black" points="8818.93,-1149.37 8810.31,-1143.22 8813.22,-1153.41 8818.93,-1149.37"/>
</g>
<!-- expert_up_7 -->
<g id="node68" class="node">
<title>expert_up_7</title>
<ellipse fill="lightblue" stroke="black" cx="9743.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="9743.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="9743.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9743.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="9743.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_7&#45;&gt;expert_up_7 -->
<g id="edge83" class="edge">
<title>split_7&#45;&gt;expert_up_7</title>
<path fill="none" stroke="black" d="M9060.58,-1179.4C9076.52,-1168.92 9091.43,-1156.98 9104.2,-1143.43 9135.71,-1109.97 9105.97,-1075.53 9142.2,-1047.26 9190.62,-1009.48 9355.36,-1019.64 9416.2,-1011.26 9445.68,-1007.2 9476.64,-1002.85 9507.28,-998.5"/>
<polygon fill="black" stroke="black" points="9507.8,-1001.96 9517.21,-997.09 9506.81,-995.03 9507.8,-1001.96"/>
</g>
<!-- expert_gate_8 -->
<g id="node72" class="node">
<title>expert_gate_8</title>
<ellipse fill="lightblue" stroke="black" cx="9469.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="9469.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="9469.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="9469.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="9469.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_8&#45;&gt;expert_gate_8 -->
<g id="edge89" class="edge">
<title>split_8&#45;&gt;expert_gate_8</title>
<path fill="none" stroke="black" d="M9660.67,-1179.39C9633.88,-1167.78 9606.5,-1155.9 9581.13,-1144.9"/>
<polygon fill="black" stroke="black" points="9582.45,-1141.65 9571.88,-1140.88 9579.66,-1148.07 9582.45,-1141.65"/>
</g>
<!-- expert_up_8 -->
<g id="node73" class="node">
<title>expert_up_8</title>
<ellipse fill="lightblue" stroke="black" cx="11051.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="11051.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="11051.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="11051.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="11051.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_8&#45;&gt;expert_up_8 -->
<g id="edge90" class="edge">
<title>split_8&#45;&gt;expert_up_8</title>
<path fill="none" stroke="black" d="M9801.35,-1179.02C9796.61,-1135.11 9799.52,-1080.09 9834.2,-1047.26 9870.13,-1013.24 10674.92,-1015.79 10724.2,-1011.26 10756.82,-1008.26 10791.16,-1004.25 10824.83,-999.84"/>
<polygon fill="black" stroke="black" points="10825.32,-1003.31 10834.78,-998.52 10824.4,-996.37 10825.32,-1003.31"/>
</g>
<!-- expert_gate_9 -->
<g id="node77" class="node">
<title>expert_gate_9</title>
<ellipse fill="lightblue" stroke="black" cx="10161.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="10161.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="10161.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="10161.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="10161.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_9&#45;&gt;expert_gate_9 -->
<g id="edge96" class="edge">
<title>split_9&#45;&gt;expert_gate_9</title>
<path fill="none" stroke="black" d="M10485.48,-1179.39C10432.69,-1165.88 10378.54,-1152.01 10329.97,-1139.57"/>
<polygon fill="black" stroke="black" points="10330.57,-1136.11 10320.02,-1137.02 10328.84,-1142.89 10330.57,-1136.11"/>
</g>
<!-- expert_up_9 -->
<g id="node78" class="node">
<title>expert_up_9</title>
<ellipse fill="lightblue" stroke="black" cx="10815.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="10815.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="10815.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="10815.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="10815.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_9&#45;&gt;expert_up_9 -->
<g id="edge97" class="edge">
<title>split_9&#45;&gt;expert_up_9</title>
<path fill="none" stroke="black" d="M10777.62,-1179.29C10781.62,-1170.46 10785.68,-1161.48 10789.59,-1152.86"/>
<polygon fill="black" stroke="black" points="10792.82,-1154.21 10793.76,-1143.66 10786.44,-1151.32 10792.82,-1154.21"/>
</g>
<!-- expert_gate_10 -->
<g id="node82" class="node">
<title>expert_gate_10</title>
<ellipse fill="lightblue" stroke="black" cx="11469.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="11469.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="11469.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="11469.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="11469.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_10&#45;&gt;expert_gate_10 -->
<g id="edge103" class="edge">
<title>split_10&#45;&gt;expert_gate_10</title>
<path fill="none" stroke="black" d="M11585.25,-1179.29C11570.87,-1169.01 11556.22,-1158.53 11542.37,-1148.64"/>
<polygon fill="black" stroke="black" points="11544.04,-1145.53 11533.87,-1142.56 11539.97,-1151.22 11544.04,-1145.53"/>
</g>
<!-- expert_up_10 -->
<g id="node83" class="node">
<title>expert_up_10</title>
<ellipse fill="lightblue" stroke="black" cx="12123.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="12123.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="12123.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12123.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="12123.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_10&#45;&gt;expert_up_10 -->
<g id="edge104" class="edge">
<title>split_10&#45;&gt;expert_up_10</title>
<path fill="none" stroke="black" d="M11877.5,-1179.39C11914.14,-1167.01 11951.66,-1154.33 11985.99,-1142.72"/>
<polygon fill="black" stroke="black" points="11987.24,-1146 11995.59,-1139.48 11985,-1139.36 11987.24,-1146"/>
</g>
<!-- expert_gate_11 -->
<g id="node87" class="node">
<title>expert_gate_11</title>
<ellipse fill="lightblue" stroke="black" cx="12777.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="12777.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="12777.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="12777.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="12777.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_11&#45;&gt;expert_gate_11 -->
<g id="edge110" class="edge">
<title>split_11&#45;&gt;expert_gate_11</title>
<path fill="none" stroke="black" d="M12777.2,-1179.29C12777.2,-1170.74 12777.2,-1162.06 12777.2,-1153.69"/>
<polygon fill="black" stroke="black" points="12780.7,-1153.66 12777.2,-1143.66 12773.7,-1153.66 12780.7,-1153.66"/>
</g>
<!-- expert_up_11 -->
<g id="node88" class="node">
<title>expert_up_11</title>
<ellipse fill="lightblue" stroke="black" cx="13431.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="13431.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="13431.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13431.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="13431.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_11&#45;&gt;expert_up_11 -->
<g id="edge111" class="edge">
<title>split_11&#45;&gt;expert_up_11</title>
<path fill="none" stroke="black" d="M13052.66,-1183.21C13118.96,-1168 13188.16,-1152.12 13248.99,-1138.16"/>
<polygon fill="black" stroke="black" points="13250.1,-1141.49 13259.06,-1135.84 13248.54,-1134.67 13250.1,-1141.49"/>
</g>
<!-- expert_gate_12 -->
<g id="node92" class="node">
<title>expert_gate_12</title>
<ellipse fill="lightblue" stroke="black" cx="14085.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="14085.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="14085.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14085.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="14085.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_12&#45;&gt;expert_gate_12 -->
<g id="edge117" class="edge">
<title>split_12&#45;&gt;expert_gate_12</title>
<path fill="none" stroke="black" d="M14085.2,-1179.29C14085.2,-1170.74 14085.2,-1162.06 14085.2,-1153.69"/>
<polygon fill="black" stroke="black" points="14088.7,-1153.66 14085.2,-1143.66 14081.7,-1153.66 14088.7,-1153.66"/>
</g>
<!-- expert_up_12 -->
<g id="node93" class="node">
<title>expert_up_12</title>
<ellipse fill="lightblue" stroke="black" cx="14739.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="14739.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="14739.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14739.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="14739.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_12&#45;&gt;expert_up_12 -->
<g id="edge118" class="edge">
<title>split_12&#45;&gt;expert_up_12</title>
<path fill="none" stroke="black" d="M14360.66,-1183.21C14426.96,-1168 14496.16,-1152.12 14556.99,-1138.16"/>
<polygon fill="black" stroke="black" points="14558.1,-1141.49 14567.06,-1135.84 14556.54,-1134.67 14558.1,-1141.49"/>
</g>
<!-- expert_gate_13 -->
<g id="node97" class="node">
<title>expert_gate_13</title>
<ellipse fill="lightblue" stroke="black" cx="15393.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="15393.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="15393.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15393.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="15393.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_13&#45;&gt;expert_gate_13 -->
<g id="edge124" class="edge">
<title>split_13&#45;&gt;expert_gate_13</title>
<path fill="none" stroke="black" d="M15393.2,-1179.29C15393.2,-1170.74 15393.2,-1162.06 15393.2,-1153.69"/>
<polygon fill="black" stroke="black" points="15396.7,-1153.66 15393.2,-1143.66 15389.7,-1153.66 15396.7,-1153.66"/>
</g>
<!-- expert_up_13 -->
<g id="node98" class="node">
<title>expert_up_13</title>
<ellipse fill="lightblue" stroke="black" cx="16047.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="16047.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="16047.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="16047.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="16047.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_13&#45;&gt;expert_up_13 -->
<g id="edge125" class="edge">
<title>split_13&#45;&gt;expert_up_13</title>
<path fill="none" stroke="black" d="M15668.66,-1183.21C15734.96,-1168 15804.16,-1152.12 15864.99,-1138.16"/>
<polygon fill="black" stroke="black" points="15866.1,-1141.49 15875.06,-1135.84 15864.54,-1134.67 15866.1,-1141.49"/>
</g>
<!-- expert_gate_14 -->
<g id="node102" class="node">
<title>expert_gate_14</title>
<ellipse fill="lightblue" stroke="black" cx="16701.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="16701.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="16701.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16701.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="16701.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_14&#45;&gt;expert_gate_14 -->
<g id="edge131" class="edge">
<title>split_14&#45;&gt;expert_gate_14</title>
<path fill="none" stroke="black" d="M16701.2,-1179.29C16701.2,-1170.74 16701.2,-1162.06 16701.2,-1153.69"/>
<polygon fill="black" stroke="black" points="16704.7,-1153.66 16701.2,-1143.66 16697.7,-1153.66 16704.7,-1153.66"/>
</g>
<!-- expert_up_14 -->
<g id="node103" class="node">
<title>expert_up_14</title>
<ellipse fill="lightblue" stroke="black" cx="17355.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="17355.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="17355.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="17355.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="17355.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_14&#45;&gt;expert_up_14 -->
<g id="edge132" class="edge">
<title>split_14&#45;&gt;expert_up_14</title>
<path fill="none" stroke="black" d="M16976.66,-1183.21C17042.96,-1168 17112.16,-1152.12 17172.99,-1138.16"/>
<polygon fill="black" stroke="black" points="17174.1,-1141.49 17183.06,-1135.84 17172.54,-1134.67 17174.1,-1141.49"/>
</g>
<!-- expert_gate_15 -->
<g id="node107" class="node">
<title>expert_gate_15</title>
<ellipse fill="lightblue" stroke="black" cx="18009.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="18009.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="18009.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18009.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="18009.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_15&#45;&gt;expert_gate_15 -->
<g id="edge138" class="edge">
<title>split_15&#45;&gt;expert_gate_15</title>
<path fill="none" stroke="black" d="M18009.2,-1179.29C18009.2,-1170.74 18009.2,-1162.06 18009.2,-1153.69"/>
<polygon fill="black" stroke="black" points="18012.7,-1153.66 18009.2,-1143.66 18005.7,-1153.66 18012.7,-1153.66"/>
</g>
<!-- expert_up_15 -->
<g id="node108" class="node">
<title>expert_up_15</title>
<ellipse fill="lightblue" stroke="black" cx="18663.2" cy="-1095.34" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="18663.2" y="-1114.14" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="18663.2" y="-1099.14" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18663.2" y="-1084.14" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="18663.2" y="-1069.14" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- split_15&#45;&gt;expert_up_15 -->
<g id="edge139" class="edge">
<title>split_15&#45;&gt;expert_up_15</title>
<path fill="none" stroke="black" d="M18284.66,-1183.21C18350.96,-1168 18420.16,-1152.12 18480.99,-1138.16"/>
<polygon fill="black" stroke="black" points="18482.1,-1141.49 18491.06,-1135.84 18480.54,-1134.67 18482.1,-1141.49"/>
</g>
<!-- expert_act_0 -->
<g id="node34" class="node">
<title>expert_act_0</title>
<ellipse fill="lightblue" stroke="black" cx="472.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="472.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 0 Activation</text>
<text text-anchor="middle" x="472.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="472.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="472.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_0&#45;&gt;expert_act_0 -->
<g id="edge35" class="edge">
<title>expert_gate_0&#45;&gt;expert_act_0</title>
<path fill="none" stroke="black" d="M373.36,-1047.72C385.04,-1037.84 397.45,-1027.35 409.4,-1017.26"/>
<polygon fill="black" stroke="black" points="411.78,-1019.82 417.16,-1010.69 407.27,-1014.48 411.78,-1019.82"/>
</g>
<!-- expert_mul_0 -->
<g id="node36" class="node">
<title>expert_mul_0</title>
<ellipse fill="lightblue" stroke="black" cx="895.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="895.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 0 Gate Multiply</text>
<text text-anchor="middle" x="895.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="895.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="895.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="895.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_0&#45;&gt;expert_mul_0 -->
<g id="edge36" class="edge">
<title>expert_up_0&#45;&gt;expert_mul_0</title>
<path fill="none" stroke="black" d="M933.38,-1047.47C925.84,-1036.21 918.84,-1023.8 914.2,-1011.26 899.85,-972.5 894.97,-926.42 893.74,-889.37"/>
<polygon fill="black" stroke="black" points="897.24,-889.08 893.49,-879.17 890.24,-889.25 897.24,-889.08"/>
</g>
<!-- expert_act_0&#45;&gt;expert_mul_0 -->
<g id="edge37" class="edge">
<title>expert_act_0&#45;&gt;expert_mul_0</title>
<path fill="none" stroke="black" d="M601.41,-919.17C643.06,-905.31 689.75,-889.77 733.44,-875.23"/>
<polygon fill="black" stroke="black" points="734.63,-878.53 743.01,-872.05 732.41,-871.89 734.63,-878.53"/>
</g>
<!-- expert_down_0 -->
<g id="node35" class="node">
<title>expert_down_0</title>
<ellipse fill="lightblue" stroke="black" cx="1908.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="1908.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="1908.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="1908.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="1908.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_0 -->
<g id="node112" class="node">
<title>agg_0</title>
<polygon fill="lightgreen" stroke="black" points="2598.73,-593.55 1891.58,-593.55 1709.66,-457.55 2416.82,-457.55 2598.73,-593.55"/>
<text text-anchor="middle" x="2154.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="2154.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_0</text>
<text text-anchor="middle" x="2154.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="2154.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_0&#45;&gt;agg_0 -->
<g id="edge39" class="edge">
<title>expert_down_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1983.34,-630.78C1999.86,-620.71 2017.73,-609.8 2035.49,-598.97"/>
<polygon fill="black" stroke="black" points="2037.48,-601.86 2044.19,-593.66 2033.83,-595.88 2037.48,-601.86"/>
</g>
<!-- expert_mul_0&#45;&gt;expert_down_0 -->
<g id="edge38" class="edge">
<title>expert_mul_0&#45;&gt;expert_down_0</title>
<path fill="none" stroke="black" d="M1146.9,-784.42C1306.59,-762.23 1511.96,-733.69 1669.15,-711.85"/>
<polygon fill="black" stroke="black" points="1670.01,-715.26 1679.43,-710.42 1669.04,-708.33 1670.01,-715.26"/>
</g>
<!-- expert_act_1 -->
<g id="node39" class="node">
<title>expert_act_1</title>
<ellipse fill="lightblue" stroke="black" cx="1241.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="1241.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 1 Activation</text>
<text text-anchor="middle" x="1241.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1241.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="1241.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_1&#45;&gt;expert_act_1 -->
<g id="edge42" class="edge">
<title>expert_gate_1&#45;&gt;expert_act_1</title>
<path fill="none" stroke="black" d="M1498.8,-1051.27C1460.25,-1038.24 1417.74,-1023.87 1378.57,-1010.62"/>
<polygon fill="black" stroke="black" points="1379.28,-1007.17 1368.68,-1007.28 1377.04,-1013.8 1379.28,-1007.17"/>
</g>
<!-- expert_mul_1 -->
<g id="node41" class="node">
<title>expert_mul_1</title>
<ellipse fill="lightblue" stroke="black" cx="1895.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="1895.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 1 Gate Multiply</text>
<text text-anchor="middle" x="1895.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="1895.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="1895.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="1895.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_1&#45;&gt;expert_mul_1 -->
<g id="edge43" class="edge">
<title>expert_up_1&#45;&gt;expert_mul_1</title>
<path fill="none" stroke="black" d="M1895.2,-914.91C1895.2,-906.76 1895.2,-898.14 1895.2,-889.57"/>
<polygon fill="black" stroke="black" points="1898.7,-889.55 1895.2,-879.55 1891.7,-889.55 1898.7,-889.55"/>
</g>
<!-- expert_act_1&#45;&gt;expert_mul_1 -->
<g id="edge44" class="edge">
<title>expert_act_1&#45;&gt;expert_mul_1</title>
<path fill="none" stroke="black" d="M1421.2,-923.43C1501.49,-906.15 1596.71,-885.65 1680.67,-867.58"/>
<polygon fill="black" stroke="black" points="1681.55,-870.97 1690.59,-865.44 1680.08,-864.13 1681.55,-870.97"/>
</g>
<!-- expert_down_1 -->
<g id="node40" class="node">
<title>expert_down_1</title>
<ellipse fill="lightblue" stroke="black" cx="2934.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="2934.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="2934.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="2934.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2934.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_1 -->
<g id="node113" class="node">
<title>agg_1</title>
<polygon fill="lightgreen" stroke="black" points="3629.73,-593.55 2922.58,-593.55 2740.66,-457.55 3447.82,-457.55 3629.73,-593.55"/>
<text text-anchor="middle" x="3185.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="3185.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_1</text>
<text text-anchor="middle" x="3185.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="3185.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_1&#45;&gt;agg_1 -->
<g id="edge46" class="edge">
<title>expert_down_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3010.53,-630.99C3027.39,-620.91 3045.65,-609.99 3063.8,-599.14"/>
<polygon fill="black" stroke="black" points="3065.9,-601.96 3072.69,-593.82 3062.31,-595.95 3065.9,-601.96"/>
</g>
<!-- expert_mul_1&#45;&gt;expert_down_1 -->
<g id="edge45" class="edge">
<title>expert_mul_1&#45;&gt;expert_down_1</title>
<path fill="none" stroke="black" d="M2149.03,-785.01C2314.68,-762.57 2529.62,-733.45 2692.73,-711.35"/>
<polygon fill="black" stroke="black" points="2693.46,-714.78 2702.9,-709.97 2692.52,-707.84 2693.46,-714.78"/>
</g>
<!-- expert_act_2 -->
<g id="node44" class="node">
<title>expert_act_2</title>
<ellipse fill="lightblue" stroke="black" cx="2549.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="2549.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 2 Activation</text>
<text text-anchor="middle" x="2549.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="2549.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="2549.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_2&#45;&gt;expert_act_2 -->
<g id="edge49" class="edge">
<title>expert_gate_2&#45;&gt;expert_act_2</title>
<path fill="none" stroke="black" d="M2648.04,-1047.72C2636.35,-1037.84 2623.94,-1027.35 2612,-1017.26"/>
<polygon fill="black" stroke="black" points="2614.13,-1014.48 2604.23,-1010.69 2609.61,-1019.82 2614.13,-1014.48"/>
</g>
<!-- expert_mul_2 -->
<g id="node46" class="node">
<title>expert_mul_2</title>
<ellipse fill="lightblue" stroke="black" cx="3203.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="3203.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 2 Gate Multiply</text>
<text text-anchor="middle" x="3203.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3203.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3203.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3203.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_2&#45;&gt;expert_mul_2 -->
<g id="edge50" class="edge">
<title>expert_up_2&#45;&gt;expert_mul_2</title>
<path fill="none" stroke="black" d="M3203.2,-914.91C3203.2,-906.76 3203.2,-898.14 3203.2,-889.57"/>
<polygon fill="black" stroke="black" points="3206.7,-889.55 3203.2,-879.55 3199.7,-889.55 3206.7,-889.55"/>
</g>
<!-- expert_act_2&#45;&gt;expert_mul_2 -->
<g id="edge51" class="edge">
<title>expert_act_2&#45;&gt;expert_mul_2</title>
<path fill="none" stroke="black" d="M2729.2,-923.43C2809.49,-906.15 2904.71,-885.65 2988.67,-867.58"/>
<polygon fill="black" stroke="black" points="2989.55,-870.97 2998.59,-865.44 2988.08,-864.13 2989.55,-870.97"/>
</g>
<!-- expert_down_2 -->
<g id="node45" class="node">
<title>expert_down_2</title>
<ellipse fill="lightblue" stroke="black" cx="3991.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="3991.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="3991.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="3991.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3991.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_2 -->
<g id="node114" class="node">
<title>agg_2</title>
<polygon fill="lightgreen" stroke="black" points="4598.73,-593.55 3891.58,-593.55 3709.66,-457.55 4416.82,-457.55 4598.73,-593.55"/>
<text text-anchor="middle" x="4154.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="4154.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_2</text>
<text text-anchor="middle" x="4154.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="4154.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_2&#45;&gt;agg_2 -->
<g id="edge53" class="edge">
<title>expert_down_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4041.88,-629.96C4052.05,-620.6 4062.98,-610.54 4073.88,-600.5"/>
<polygon fill="black" stroke="black" points="4076.42,-602.92 4081.41,-593.57 4071.68,-597.77 4076.42,-602.92"/>
</g>
<!-- expert_mul_2&#45;&gt;expert_down_2 -->
<g id="edge52" class="edge">
<title>expert_mul_2&#45;&gt;expert_down_2</title>
<path fill="none" stroke="black" d="M3429.27,-779.02C3539.85,-759.26 3672.14,-735.63 3780.58,-716.26"/>
<polygon fill="black" stroke="black" points="3781.43,-719.66 3790.66,-714.45 3780.2,-712.77 3781.43,-719.66"/>
</g>
<!-- expert_act_3 -->
<g id="node49" class="node">
<title>expert_act_3</title>
<ellipse fill="lightblue" stroke="black" cx="3857.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="3857.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 3 Activation</text>
<text text-anchor="middle" x="3857.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="3857.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="3857.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_3&#45;&gt;expert_act_3 -->
<g id="edge56" class="edge">
<title>expert_gate_3&#45;&gt;expert_act_3</title>
<path fill="none" stroke="black" d="M3956.04,-1047.72C3944.35,-1037.84 3931.94,-1027.35 3920,-1017.26"/>
<polygon fill="black" stroke="black" points="3922.13,-1014.48 3912.23,-1010.69 3917.61,-1019.82 3922.13,-1014.48"/>
</g>
<!-- expert_mul_3 -->
<g id="node51" class="node">
<title>expert_mul_3</title>
<ellipse fill="lightblue" stroke="black" cx="4511.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="4511.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 3 Gate Multiply</text>
<text text-anchor="middle" x="4511.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="4511.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4511.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="4511.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_3&#45;&gt;expert_mul_3 -->
<g id="edge57" class="edge">
<title>expert_up_3&#45;&gt;expert_mul_3</title>
<path fill="none" stroke="black" d="M4511.2,-914.91C4511.2,-906.76 4511.2,-898.14 4511.2,-889.57"/>
<polygon fill="black" stroke="black" points="4514.7,-889.55 4511.2,-879.55 4507.7,-889.55 4514.7,-889.55"/>
</g>
<!-- expert_act_3&#45;&gt;expert_mul_3 -->
<g id="edge58" class="edge">
<title>expert_act_3&#45;&gt;expert_mul_3</title>
<path fill="none" stroke="black" d="M4037.2,-923.43C4117.49,-906.15 4212.71,-885.65 4296.67,-867.58"/>
<polygon fill="black" stroke="black" points="4297.55,-870.97 4306.59,-865.44 4296.08,-864.13 4297.55,-870.97"/>
</g>
<!-- expert_down_3 -->
<g id="node50" class="node">
<title>expert_down_3</title>
<ellipse fill="lightblue" stroke="black" cx="5678.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="5678.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="5678.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="5678.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5678.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_3 -->
<g id="node115" class="node">
<title>agg_3</title>
<polygon fill="lightgreen" stroke="black" points="6295.73,-593.55 5588.58,-593.55 5406.66,-457.55 6113.82,-457.55 6295.73,-593.55"/>
<text text-anchor="middle" x="5851.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="5851.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 0_3</text>
<text text-anchor="middle" x="5851.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="5851.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_3&#45;&gt;agg_3 -->
<g id="edge60" class="edge">
<title>expert_down_3&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M5731.99,-629.96C5742.89,-620.51 5754.61,-610.34 5766.28,-600.21"/>
<polygon fill="black" stroke="black" points="5768.68,-602.76 5773.94,-593.57 5764.1,-597.48 5768.68,-602.76"/>
</g>
<!-- expert_mul_3&#45;&gt;expert_down_3 -->
<g id="edge59" class="edge">
<title>expert_mul_3&#45;&gt;expert_down_3</title>
<path fill="none" stroke="black" d="M4775.28,-787.55C4970.07,-764.05 5233.52,-732.27 5425.55,-709.11"/>
<polygon fill="black" stroke="black" points="5426,-712.58 5435.5,-707.91 5425.16,-705.63 5426,-712.58"/>
</g>
<!-- expert_act_4 -->
<g id="node54" class="node">
<title>expert_act_4</title>
<ellipse fill="lightblue" stroke="black" cx="5165.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="5165.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 4 Activation</text>
<text text-anchor="middle" x="5165.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5165.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5165.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_4&#45;&gt;expert_act_4 -->
<g id="edge63" class="edge">
<title>expert_gate_4&#45;&gt;expert_act_4</title>
<path fill="none" stroke="black" d="M5264.04,-1047.72C5252.35,-1037.84 5239.94,-1027.35 5228,-1017.26"/>
<polygon fill="black" stroke="black" points="5230.13,-1014.48 5220.23,-1010.69 5225.61,-1019.82 5230.13,-1014.48"/>
</g>
<!-- expert_mul_4 -->
<g id="node56" class="node">
<title>expert_mul_4</title>
<ellipse fill="lightblue" stroke="black" cx="5819.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="5819.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 4 Gate Multiply</text>
<text text-anchor="middle" x="5819.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="5819.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5819.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="5819.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_4&#45;&gt;expert_mul_4 -->
<g id="edge64" class="edge">
<title>expert_up_4&#45;&gt;expert_mul_4</title>
<path fill="none" stroke="black" d="M5819.2,-914.91C5819.2,-906.76 5819.2,-898.14 5819.2,-889.57"/>
<polygon fill="black" stroke="black" points="5822.7,-889.55 5819.2,-879.55 5815.7,-889.55 5822.7,-889.55"/>
</g>
<!-- expert_act_4&#45;&gt;expert_mul_4 -->
<g id="edge65" class="edge">
<title>expert_act_4&#45;&gt;expert_mul_4</title>
<path fill="none" stroke="black" d="M5345.2,-923.43C5425.49,-906.15 5520.71,-885.65 5604.67,-867.58"/>
<polygon fill="black" stroke="black" points="5605.55,-870.97 5614.59,-865.44 5604.08,-864.13 5605.55,-870.97"/>
</g>
<!-- expert_down_4 -->
<g id="node55" class="node">
<title>expert_down_4</title>
<ellipse fill="lightblue" stroke="black" cx="6456.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="6456.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="6456.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="6456.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="6456.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_4 -->
<g id="node116" class="node">
<title>agg_4</title>
<polygon fill="lightgreen" stroke="black" points="7210.73,-593.55 6503.58,-593.55 6321.66,-457.55 7028.82,-457.55 7210.73,-593.55"/>
<text text-anchor="middle" x="6766.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="6766.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_0</text>
<text text-anchor="middle" x="6766.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="6766.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_4&#45;&gt;agg_4 -->
<g id="edge67" class="edge">
<title>expert_down_4&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M6549.21,-631.6C6571.11,-621 6594.99,-609.43 6618.64,-597.99"/>
<polygon fill="black" stroke="black" points="6620.21,-601.11 6627.69,-593.61 6617.16,-594.81 6620.21,-601.11"/>
</g>
<!-- expert_mul_4&#45;&gt;expert_down_4 -->
<g id="edge66" class="edge">
<title>expert_mul_4&#45;&gt;expert_down_4</title>
<path fill="none" stroke="black" d="M6020.75,-774.86C6100.79,-757.17 6192.28,-736.95 6270.68,-719.63"/>
<polygon fill="black" stroke="black" points="6271.65,-723 6280.66,-717.42 6270.14,-716.16 6271.65,-723"/>
</g>
<!-- expert_act_5 -->
<g id="node59" class="node">
<title>expert_act_5</title>
<ellipse fill="lightblue" stroke="black" cx="6473.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="6473.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 5 Activation</text>
<text text-anchor="middle" x="6473.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="6473.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="6473.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_5&#45;&gt;expert_act_5 -->
<g id="edge70" class="edge">
<title>expert_gate_5&#45;&gt;expert_act_5</title>
<path fill="none" stroke="black" d="M6554.71,-1047.72C6545.41,-1038.18 6535.54,-1028.07 6526.01,-1018.3"/>
<polygon fill="black" stroke="black" points="6528.29,-1015.63 6518.8,-1010.91 6523.28,-1020.52 6528.29,-1015.63"/>
</g>
<!-- expert_mul_5 -->
<g id="node61" class="node">
<title>expert_mul_5</title>
<ellipse fill="lightblue" stroke="black" cx="7127.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="7127.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 5 Gate Multiply</text>
<text text-anchor="middle" x="7127.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7127.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7127.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7127.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_5&#45;&gt;expert_mul_5 -->
<g id="edge71" class="edge">
<title>expert_up_5&#45;&gt;expert_mul_5</title>
<path fill="none" stroke="black" d="M7127.2,-914.91C7127.2,-906.76 7127.2,-898.14 7127.2,-889.57"/>
<polygon fill="black" stroke="black" points="7130.7,-889.55 7127.2,-879.55 7123.7,-889.55 7130.7,-889.55"/>
</g>
<!-- expert_act_5&#45;&gt;expert_mul_5 -->
<g id="edge72" class="edge">
<title>expert_act_5&#45;&gt;expert_mul_5</title>
<path fill="none" stroke="black" d="M6653.2,-923.43C6733.49,-906.15 6828.71,-885.65 6912.67,-867.58"/>
<polygon fill="black" stroke="black" points="6913.55,-870.97 6922.59,-865.44 6912.08,-864.13 6913.55,-870.97"/>
</g>
<!-- expert_down_5 -->
<g id="node60" class="node">
<title>expert_down_5</title>
<ellipse fill="lightblue" stroke="black" cx="7301.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="7301.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="7301.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7301.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7301.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_5 -->
<g id="node117" class="node">
<title>agg_5</title>
<polygon fill="lightgreen" stroke="black" points="8121.73,-593.55 7414.58,-593.55 7232.66,-457.55 7939.82,-457.55 8121.73,-593.55"/>
<text text-anchor="middle" x="7677.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="7677.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_1</text>
<text text-anchor="middle" x="7677.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="7677.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_5&#45;&gt;agg_5 -->
<g id="edge74" class="edge">
<title>expert_down_5&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M7411.47,-632.61C7439.26,-621.52 7469.79,-609.33 7499.96,-597.29"/>
<polygon fill="black" stroke="black" points="7501.32,-600.52 7509.31,-593.56 7498.72,-594.02 7501.32,-600.52"/>
</g>
<!-- expert_mul_5&#45;&gt;expert_down_5 -->
<g id="edge73" class="edge">
<title>expert_mul_5&#45;&gt;expert_down_5</title>
<path fill="none" stroke="black" d="M7196.97,-762.96C7209.89,-752.5 7223.33,-741.62 7236.11,-731.29"/>
<polygon fill="black" stroke="black" points="7238.39,-733.95 7243.96,-724.94 7233.99,-728.5 7238.39,-733.95"/>
</g>
<!-- expert_act_6 -->
<g id="node64" class="node">
<title>expert_act_6</title>
<ellipse fill="lightblue" stroke="black" cx="7781.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="7781.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 6 Activation</text>
<text text-anchor="middle" x="7781.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="7781.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="7781.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_6&#45;&gt;expert_act_6 -->
<g id="edge77" class="edge">
<title>expert_gate_6&#45;&gt;expert_act_6</title>
<path fill="none" stroke="black" d="M7829.76,-1047.35C7824.54,-1038.41 7819.03,-1028.97 7813.67,-1019.8"/>
<polygon fill="black" stroke="black" points="7816.66,-1017.97 7808.6,-1011.1 7810.62,-1021.5 7816.66,-1017.97"/>
</g>
<!-- expert_mul_6 -->
<g id="node66" class="node">
<title>expert_mul_6</title>
<ellipse fill="lightblue" stroke="black" cx="8435.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="8435.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 6 Gate Multiply</text>
<text text-anchor="middle" x="8435.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8435.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8435.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8435.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_6&#45;&gt;expert_mul_6 -->
<g id="edge78" class="edge">
<title>expert_up_6&#45;&gt;expert_mul_6</title>
<path fill="none" stroke="black" d="M8435.2,-914.91C8435.2,-906.76 8435.2,-898.14 8435.2,-889.57"/>
<polygon fill="black" stroke="black" points="8438.7,-889.55 8435.2,-879.55 8431.7,-889.55 8438.7,-889.55"/>
</g>
<!-- expert_act_6&#45;&gt;expert_mul_6 -->
<g id="edge79" class="edge">
<title>expert_act_6&#45;&gt;expert_mul_6</title>
<path fill="none" stroke="black" d="M7961.2,-923.43C8041.49,-906.15 8136.71,-885.65 8220.67,-867.58"/>
<polygon fill="black" stroke="black" points="8221.55,-870.97 8230.59,-865.44 8220.08,-864.13 8221.55,-870.97"/>
</g>
<!-- expert_down_6 -->
<g id="node65" class="node">
<title>expert_down_6</title>
<ellipse fill="lightblue" stroke="black" cx="8511.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="8511.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="8511.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8511.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="8511.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_6 -->
<g id="node118" class="node">
<title>agg_6</title>
<polygon fill="lightgreen" stroke="black" points="9031.73,-593.55 8324.58,-593.55 8142.66,-457.55 8849.82,-457.55 9031.73,-593.55"/>
<text text-anchor="middle" x="8587.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="8587.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_2</text>
<text text-anchor="middle" x="8587.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="8587.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_6&#45;&gt;agg_6 -->
<g id="edge81" class="edge">
<title>expert_down_6&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8535.04,-629.55C8539.35,-621.04 8543.94,-611.97 8548.55,-602.88"/>
<polygon fill="black" stroke="black" points="8551.75,-604.29 8553.15,-593.79 8545.51,-601.13 8551.75,-604.29"/>
</g>
<!-- expert_mul_6&#45;&gt;expert_down_6 -->
<g id="edge80" class="edge">
<title>expert_mul_6&#45;&gt;expert_down_6</title>
<path fill="none" stroke="black" d="M8466.33,-761.74C8471.19,-752.74 8476.2,-743.46 8481.04,-734.5"/>
<polygon fill="black" stroke="black" points="8484.13,-736.14 8485.8,-725.67 8477.97,-732.81 8484.13,-736.14"/>
</g>
<!-- expert_act_7 -->
<g id="node69" class="node">
<title>expert_act_7</title>
<ellipse fill="lightblue" stroke="black" cx="9089.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="9089.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 7 Activation</text>
<text text-anchor="middle" x="9089.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9089.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9089.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_7&#45;&gt;expert_act_7 -->
<g id="edge84" class="edge">
<title>expert_gate_7&#45;&gt;expert_act_7</title>
<path fill="none" stroke="black" d="M8883.7,-1049.91C8912.61,-1037.85 8944.05,-1024.73 8973.45,-1012.47"/>
<polygon fill="black" stroke="black" points="8975.03,-1015.6 8982.91,-1008.52 8972.34,-1009.14 8975.03,-1015.6"/>
</g>
<!-- expert_mul_7 -->
<g id="node71" class="node">
<title>expert_mul_7</title>
<ellipse fill="lightblue" stroke="black" cx="9496.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="9496.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 7 Gate Multiply</text>
<text text-anchor="middle" x="9496.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9496.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9496.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9496.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_7&#45;&gt;expert_mul_7 -->
<g id="edge85" class="edge">
<title>expert_up_7&#45;&gt;expert_mul_7</title>
<path fill="none" stroke="black" d="M9663,-916.47C9643.41,-905.3 9622.14,-893.18 9601.57,-881.46"/>
<polygon fill="black" stroke="black" points="9603.22,-878.37 9592.8,-876.46 9599.75,-884.45 9603.22,-878.37"/>
</g>
<!-- expert_act_7&#45;&gt;expert_mul_7 -->
<g id="edge86" class="edge">
<title>expert_act_7&#45;&gt;expert_mul_7</title>
<path fill="none" stroke="black" d="M9214.35,-918.89C9253.69,-905.28 9297.64,-890.08 9338.91,-875.81"/>
<polygon fill="black" stroke="black" points="9340.2,-879.06 9348.5,-872.49 9337.91,-872.45 9340.2,-879.06"/>
</g>
<!-- expert_down_7 -->
<g id="node70" class="node">
<title>expert_down_7</title>
<ellipse fill="lightblue" stroke="black" cx="9496.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="9496.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="9496.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9496.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="9496.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_7 -->
<g id="node119" class="node">
<title>agg_7</title>
<polygon fill="lightgreen" stroke="black" points="9940.73,-593.55 9233.58,-593.55 9051.66,-457.55 9758.82,-457.55 9940.73,-593.55"/>
<text text-anchor="middle" x="9496.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="9496.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 1_3</text>
<text text-anchor="middle" x="9496.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="9496.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_7&#45;&gt;agg_7 -->
<g id="edge88" class="edge">
<title>expert_down_7&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M9496.2,-629.14C9496.2,-621.06 9496.2,-612.47 9496.2,-603.85"/>
<polygon fill="black" stroke="black" points="9499.7,-603.74 9496.2,-593.74 9492.7,-603.74 9499.7,-603.74"/>
</g>
<!-- expert_mul_7&#45;&gt;expert_down_7 -->
<g id="edge87" class="edge">
<title>expert_mul_7&#45;&gt;expert_down_7</title>
<path fill="none" stroke="black" d="M9496.2,-761.33C9496.2,-752.93 9496.2,-744.29 9496.2,-735.91"/>
<polygon fill="black" stroke="black" points="9499.7,-735.84 9496.2,-725.84 9492.7,-735.84 9499.7,-735.84"/>
</g>
<!-- expert_act_8 -->
<g id="node74" class="node">
<title>expert_act_8</title>
<ellipse fill="lightblue" stroke="black" cx="10397.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="10397.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 8 Activation</text>
<text text-anchor="middle" x="10397.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10397.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10397.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_8&#45;&gt;expert_act_8 -->
<g id="edge91" class="edge">
<title>expert_gate_8&#45;&gt;expert_act_8</title>
<path fill="none" stroke="black" d="M9697.32,-1061.75C9732.11,-1056.85 9767.6,-1051.89 9801.2,-1047.26 9920.69,-1030.79 9950.72,-1027.85 10070.2,-1011.26 10099.42,-1007.2 10130.1,-1002.87 10160.47,-998.55"/>
<polygon fill="black" stroke="black" points="10161.35,-1001.96 10170.76,-997.08 10160.36,-995.03 10161.35,-1001.96"/>
</g>
<!-- expert_mul_8 -->
<g id="node76" class="node">
<title>expert_mul_8</title>
<ellipse fill="lightblue" stroke="black" cx="10404.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="10404.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 8 Gate Multiply</text>
<text text-anchor="middle" x="10404.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10404.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10404.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10404.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_8&#45;&gt;expert_mul_8 -->
<g id="edge92" class="edge">
<title>expert_up_8&#45;&gt;expert_mul_8</title>
<path fill="none" stroke="black" d="M10872.69,-923.34C10793.71,-906.15 10700.18,-885.8 10617.55,-867.82"/>
<polygon fill="black" stroke="black" points="10618.04,-864.35 10607.52,-865.64 10616.55,-871.19 10618.04,-864.35"/>
</g>
<!-- expert_act_8&#45;&gt;expert_mul_8 -->
<g id="edge93" class="edge">
<title>expert_act_8&#45;&gt;expert_mul_8</title>
<path fill="none" stroke="black" d="M10399.55,-914.91C10399.95,-906.76 10400.38,-898.14 10400.81,-889.57"/>
<polygon fill="black" stroke="black" points="10404.31,-889.71 10401.31,-879.55 10397.31,-889.36 10404.31,-889.71"/>
</g>
<!-- expert_down_8 -->
<g id="node75" class="node">
<title>expert_down_8</title>
<ellipse fill="lightblue" stroke="black" cx="10404.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="10404.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="10404.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10404.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="10404.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_8 -->
<g id="node120" class="node">
<title>agg_8</title>
<polygon fill="lightgreen" stroke="black" points="10848.73,-593.55 10141.58,-593.55 9959.66,-457.55 10666.82,-457.55 10848.73,-593.55"/>
<text text-anchor="middle" x="10404.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="10404.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_0</text>
<text text-anchor="middle" x="10404.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="10404.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_8&#45;&gt;agg_8 -->
<g id="edge95" class="edge">
<title>expert_down_8&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M10404.2,-629.14C10404.2,-621.06 10404.2,-612.47 10404.2,-603.85"/>
<polygon fill="black" stroke="black" points="10407.7,-603.74 10404.2,-593.74 10400.7,-603.74 10407.7,-603.74"/>
</g>
<!-- expert_mul_8&#45;&gt;expert_down_8 -->
<g id="edge94" class="edge">
<title>expert_mul_8&#45;&gt;expert_down_8</title>
<path fill="none" stroke="black" d="M10404.2,-761.33C10404.2,-752.93 10404.2,-744.29 10404.2,-735.91"/>
<polygon fill="black" stroke="black" points="10407.7,-735.84 10404.2,-725.84 10400.7,-735.84 10407.7,-735.84"/>
</g>
<!-- expert_act_9 -->
<g id="node79" class="node">
<title>expert_act_9</title>
<ellipse fill="lightblue" stroke="black" cx="11705.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="11705.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 9 Activation</text>
<text text-anchor="middle" x="11705.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11705.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11705.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_9&#45;&gt;expert_act_9 -->
<g id="edge98" class="edge">
<title>expert_gate_9&#45;&gt;expert_act_9</title>
<path fill="none" stroke="black" d="M10377.62,-1059.99C10414.44,-1055.06 10452.36,-1050.56 10488.2,-1047.26 10882.41,-1011 10983.98,-1047.52 11378.2,-1011.26 11410.82,-1008.26 11445.16,-1004.25 11478.83,-999.84"/>
<polygon fill="black" stroke="black" points="11479.32,-1003.31 11488.78,-998.52 11478.4,-996.37 11479.32,-1003.31"/>
</g>
<!-- expert_mul_9 -->
<g id="node81" class="node">
<title>expert_mul_9</title>
<ellipse fill="lightblue" stroke="black" cx="11705.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="11705.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 9 Gate Multiply</text>
<text text-anchor="middle" x="11705.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11705.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11705.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11705.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_9&#45;&gt;expert_mul_9 -->
<g id="edge99" class="edge">
<title>expert_up_9&#45;&gt;expert_mul_9</title>
<path fill="none" stroke="black" d="M11031.62,-1059.99C11068.44,-1055.06 11106.36,-1050.56 11142.2,-1047.26 11191.47,-1042.73 11997.92,-1046.95 12032.2,-1011.26 12061.8,-980.43 12057.92,-949.22 12032.2,-915.09 12017.72,-895.89 11979.35,-879.42 11933.76,-865.89"/>
<polygon fill="black" stroke="black" points="11934.5,-862.46 11923.92,-863.04 11932.56,-869.18 11934.5,-862.46"/>
</g>
<!-- expert_act_9&#45;&gt;expert_mul_9 -->
<g id="edge100" class="edge">
<title>expert_act_9&#45;&gt;expert_mul_9</title>
<path fill="none" stroke="black" d="M11705.2,-914.91C11705.2,-906.76 11705.2,-898.14 11705.2,-889.57"/>
<polygon fill="black" stroke="black" points="11708.7,-889.55 11705.2,-879.55 11701.7,-889.55 11708.7,-889.55"/>
</g>
<!-- expert_down_9 -->
<g id="node80" class="node">
<title>expert_down_9</title>
<ellipse fill="lightblue" stroke="black" cx="11505.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="11505.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="11505.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11505.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="11505.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_9 -->
<g id="node121" class="node">
<title>agg_9</title>
<polygon fill="lightgreen" stroke="black" points="11756.73,-593.55 11049.58,-593.55 10867.66,-457.55 11574.82,-457.55 11756.73,-593.55"/>
<text text-anchor="middle" x="11312.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="11312.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_1</text>
<text text-anchor="middle" x="11312.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="11312.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_9&#45;&gt;agg_9 -->
<g id="edge102" class="edge">
<title>expert_down_9&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M11445.72,-630.37C11433.33,-620.75 11419.99,-610.37 11406.7,-600.04"/>
<polygon fill="black" stroke="black" points="11408.49,-596.99 11398.44,-593.61 11404.19,-602.52 11408.49,-596.99"/>
</g>
<!-- expert_mul_9&#45;&gt;expert_down_9 -->
<g id="edge101" class="edge">
<title>expert_mul_9&#45;&gt;expert_down_9</title>
<path fill="none" stroke="black" d="M11625.87,-763.56C11610.41,-752.68 11594.26,-741.32 11578.99,-730.57"/>
<polygon fill="black" stroke="black" points="11580.8,-727.56 11570.6,-724.67 11576.77,-733.28 11580.8,-727.56"/>
</g>
<!-- expert_act_10 -->
<g id="node84" class="node">
<title>expert_act_10</title>
<ellipse fill="lightblue" stroke="black" cx="12397.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="12397.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 10 Activation</text>
<text text-anchor="middle" x="12397.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12397.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12397.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_10&#45;&gt;expert_act_10 -->
<g id="edge105" class="edge">
<title>expert_gate_10&#45;&gt;expert_act_10</title>
<path fill="none" stroke="black" d="M11695.64,-1061.44C11729.34,-1056.63 11763.67,-1051.78 11796.2,-1047.26 11915.67,-1030.66 11945.71,-1027.73 12065.2,-1011.26 12095.51,-1007.08 12127.37,-1002.63 12158.87,-998.2"/>
<polygon fill="black" stroke="black" points="12159.66,-1001.63 12169.08,-996.77 12158.69,-994.7 12159.66,-1001.63"/>
</g>
<!-- expert_mul_10 -->
<g id="node86" class="node">
<title>expert_mul_10</title>
<ellipse fill="lightblue" stroke="black" cx="12397.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="12397.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 10 Gate Multiply</text>
<text text-anchor="middle" x="12397.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12397.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12397.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12397.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_10&#45;&gt;expert_mul_10 -->
<g id="edge106" class="edge">
<title>expert_up_10&#45;&gt;expert_mul_10</title>
<path fill="none" stroke="black" d="M12349.19,-1061.43C12383.03,-1056.61 12417.53,-1051.76 12450.2,-1047.26 12511.04,-1038.88 12683.7,-1057.43 12724.2,-1011.26 12752.38,-979.13 12749.92,-949.22 12724.2,-915.09 12709.72,-895.89 12671.35,-879.42 12625.76,-865.89"/>
<polygon fill="black" stroke="black" points="12626.5,-862.46 12615.92,-863.04 12624.56,-869.18 12626.5,-862.46"/>
</g>
<!-- expert_act_10&#45;&gt;expert_mul_10 -->
<g id="edge107" class="edge">
<title>expert_act_10&#45;&gt;expert_mul_10</title>
<path fill="none" stroke="black" d="M12397.2,-914.91C12397.2,-906.76 12397.2,-898.14 12397.2,-889.57"/>
<polygon fill="black" stroke="black" points="12400.7,-889.55 12397.2,-879.55 12393.7,-889.55 12400.7,-889.55"/>
</g>
<!-- expert_down_10 -->
<g id="node85" class="node">
<title>expert_down_10</title>
<ellipse fill="lightblue" stroke="black" cx="12305.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="12305.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="12305.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12305.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="12305.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_10 -->
<g id="node122" class="node">
<title>agg_10</title>
<polygon fill="lightgreen" stroke="black" points="12664.73,-593.55 11957.58,-593.55 11775.66,-457.55 12482.82,-457.55 12664.73,-593.55"/>
<text text-anchor="middle" x="12220.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="12220.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_2</text>
<text text-anchor="middle" x="12220.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="12220.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_10&#45;&gt;agg_10 -->
<g id="edge109" class="edge">
<title>expert_down_10&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M12278.54,-629.55C12273.67,-620.95 12268.47,-611.78 12263.27,-602.59"/>
<polygon fill="black" stroke="black" points="12266.26,-600.77 12258.28,-593.79 12260.17,-604.22 12266.26,-600.77"/>
</g>
<!-- expert_mul_10&#45;&gt;expert_down_10 -->
<g id="edge108" class="edge">
<title>expert_mul_10&#45;&gt;expert_down_10</title>
<path fill="none" stroke="black" d="M12359.51,-761.74C12353.57,-752.65 12347.44,-743.26 12341.53,-734.22"/>
<polygon fill="black" stroke="black" points="12344.34,-732.13 12335.94,-725.67 12338.48,-735.96 12344.34,-732.13"/>
</g>
<!-- expert_act_11 -->
<g id="node89" class="node">
<title>expert_act_11</title>
<ellipse fill="lightblue" stroke="black" cx="13089.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="13089.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 11 Activation</text>
<text text-anchor="middle" x="13089.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13089.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="13089.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_11&#45;&gt;expert_act_11 -->
<g id="edge112" class="edge">
<title>expert_gate_11&#45;&gt;expert_act_11</title>
<path fill="none" stroke="black" d="M12883.7,-1049.91C12912.61,-1037.85 12944.05,-1024.73 12973.45,-1012.47"/>
<polygon fill="black" stroke="black" points="12975.03,-1015.6 12982.91,-1008.52 12972.34,-1009.14 12975.03,-1015.6"/>
</g>
<!-- expert_mul_11 -->
<g id="node91" class="node">
<title>expert_mul_11</title>
<ellipse fill="lightblue" stroke="black" cx="13128.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="13128.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 11 Gate Multiply</text>
<text text-anchor="middle" x="13128.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13128.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="13128.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="13128.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_11&#45;&gt;expert_mul_11 -->
<g id="edge113" class="edge">
<title>expert_up_11&#45;&gt;expert_mul_11</title>
<path fill="none" stroke="black" d="M13440.47,-1047.27C13445.43,-1007.78 13445.48,-952.06 13416.2,-915.09 13400.56,-895.35 13380.7,-879.72 13358.73,-867.35"/>
<polygon fill="black" stroke="black" points="13360.35,-864.24 13349.88,-862.59 13357.03,-870.41 13360.35,-864.24"/>
</g>
<!-- expert_act_11&#45;&gt;expert_mul_11 -->
<g id="edge114" class="edge">
<title>expert_act_11&#45;&gt;expert_mul_11</title>
<path fill="none" stroke="black" d="M13102.29,-914.91C13104.61,-906.55 13107.06,-897.71 13109.49,-888.92"/>
<polygon fill="black" stroke="black" points="13112.93,-889.63 13112.23,-879.05 13106.18,-887.76 13112.93,-889.63"/>
</g>
<!-- expert_down_11 -->
<g id="node90" class="node">
<title>expert_down_11</title>
<ellipse fill="lightblue" stroke="black" cx="13128.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="13128.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="13128.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13128.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="13128.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_11 -->
<g id="node123" class="node">
<title>agg_11</title>
<polygon fill="lightgreen" stroke="black" points="13572.73,-593.55 12865.58,-593.55 12683.66,-457.55 13390.82,-457.55 13572.73,-593.55"/>
<text text-anchor="middle" x="13128.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="13128.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 2_3</text>
<text text-anchor="middle" x="13128.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="13128.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_11&#45;&gt;agg_11 -->
<g id="edge116" class="edge">
<title>expert_down_11&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M13128.2,-629.14C13128.2,-621.06 13128.2,-612.47 13128.2,-603.85"/>
<polygon fill="black" stroke="black" points="13131.7,-603.74 13128.2,-593.74 13124.7,-603.74 13131.7,-603.74"/>
</g>
<!-- expert_mul_11&#45;&gt;expert_down_11 -->
<g id="edge115" class="edge">
<title>expert_mul_11&#45;&gt;expert_down_11</title>
<path fill="none" stroke="black" d="M13128.2,-761.33C13128.2,-752.93 13128.2,-744.29 13128.2,-735.91"/>
<polygon fill="black" stroke="black" points="13131.7,-735.84 13128.2,-725.84 13124.7,-735.84 13131.7,-735.84"/>
</g>
<!-- expert_act_12 -->
<g id="node94" class="node">
<title>expert_act_12</title>
<ellipse fill="lightblue" stroke="black" cx="14085.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="14085.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 12 Activation</text>
<text text-anchor="middle" x="14085.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14085.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14085.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_12&#45;&gt;expert_act_12 -->
<g id="edge119" class="edge">
<title>expert_gate_12&#45;&gt;expert_act_12</title>
<path fill="none" stroke="black" d="M14085.2,-1046.98C14085.2,-1038.71 14085.2,-1030.03 14085.2,-1021.53"/>
<polygon fill="black" stroke="black" points="14088.7,-1021.28 14085.2,-1011.28 14081.7,-1021.28 14088.7,-1021.28"/>
</g>
<!-- expert_mul_12 -->
<g id="node96" class="node">
<title>expert_mul_12</title>
<ellipse fill="lightblue" stroke="black" cx="14085.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="14085.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 12 Gate Multiply</text>
<text text-anchor="middle" x="14085.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14085.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14085.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14085.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_12&#45;&gt;expert_mul_12 -->
<g id="edge120" class="edge">
<title>expert_up_12&#45;&gt;expert_mul_12</title>
<path fill="none" stroke="black" d="M14666.52,-1048.36C14601.75,-1008.89 14503.36,-952.59 14412.2,-915.09 14371.45,-898.33 14326.68,-883.38 14283.69,-870.61"/>
<polygon fill="black" stroke="black" points="14284.55,-867.22 14273.97,-867.75 14282.58,-873.93 14284.55,-867.22"/>
</g>
<!-- expert_act_12&#45;&gt;expert_mul_12 -->
<g id="edge121" class="edge">
<title>expert_act_12&#45;&gt;expert_mul_12</title>
<path fill="none" stroke="black" d="M14085.2,-914.91C14085.2,-906.76 14085.2,-898.14 14085.2,-889.57"/>
<polygon fill="black" stroke="black" points="14088.7,-889.55 14085.2,-879.55 14081.7,-889.55 14088.7,-889.55"/>
</g>
<!-- expert_down_12 -->
<g id="node95" class="node">
<title>expert_down_12</title>
<ellipse fill="lightblue" stroke="black" cx="14070.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="14070.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="14070.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14070.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="14070.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_12 -->
<g id="node124" class="node">
<title>agg_12</title>
<polygon fill="lightgreen" stroke="black" points="14510.73,-593.55 13803.58,-593.55 13621.66,-457.55 14328.82,-457.55 14510.73,-593.55"/>
<text text-anchor="middle" x="14066.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="14066.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_0</text>
<text text-anchor="middle" x="14066.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="14066.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_12&#45;&gt;agg_12 -->
<g id="edge123" class="edge">
<title>expert_down_12&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M14068.93,-629.14C14068.72,-621.06 14068.49,-612.47 14068.26,-603.85"/>
<polygon fill="black" stroke="black" points="14071.75,-603.64 14067.99,-593.74 14064.76,-603.83 14071.75,-603.64"/>
</g>
<!-- expert_mul_12&#45;&gt;expert_down_12 -->
<g id="edge122" class="edge">
<title>expert_mul_12&#45;&gt;expert_down_12</title>
<path fill="none" stroke="black" d="M14079.01,-761.33C14078.12,-752.93 14077.19,-744.29 14076.3,-735.91"/>
<polygon fill="black" stroke="black" points="14079.77,-735.41 14075.23,-725.84 14072.81,-736.16 14079.77,-735.41"/>
</g>
<!-- expert_act_13 -->
<g id="node99" class="node">
<title>expert_act_13</title>
<ellipse fill="lightblue" stroke="black" cx="15393.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="15393.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 13 Activation</text>
<text text-anchor="middle" x="15393.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15393.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15393.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_13&#45;&gt;expert_act_13 -->
<g id="edge126" class="edge">
<title>expert_gate_13&#45;&gt;expert_act_13</title>
<path fill="none" stroke="black" d="M15393.2,-1046.98C15393.2,-1038.71 15393.2,-1030.03 15393.2,-1021.53"/>
<polygon fill="black" stroke="black" points="15396.7,-1021.28 15393.2,-1011.28 15389.7,-1021.28 15396.7,-1021.28"/>
</g>
<!-- expert_mul_13 -->
<g id="node101" class="node">
<title>expert_mul_13</title>
<ellipse fill="lightblue" stroke="black" cx="15393.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="15393.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 13 Gate Multiply</text>
<text text-anchor="middle" x="15393.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15393.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15393.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15393.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_13&#45;&gt;expert_mul_13 -->
<g id="edge127" class="edge">
<title>expert_up_13&#45;&gt;expert_mul_13</title>
<path fill="none" stroke="black" d="M15974.52,-1048.36C15909.75,-1008.89 15811.36,-952.59 15720.2,-915.09 15679.45,-898.33 15634.68,-883.38 15591.69,-870.61"/>
<polygon fill="black" stroke="black" points="15592.55,-867.22 15581.97,-867.75 15590.58,-873.93 15592.55,-867.22"/>
</g>
<!-- expert_act_13&#45;&gt;expert_mul_13 -->
<g id="edge128" class="edge">
<title>expert_act_13&#45;&gt;expert_mul_13</title>
<path fill="none" stroke="black" d="M15393.2,-914.91C15393.2,-906.76 15393.2,-898.14 15393.2,-889.57"/>
<polygon fill="black" stroke="black" points="15396.7,-889.55 15393.2,-879.55 15389.7,-889.55 15396.7,-889.55"/>
</g>
<!-- expert_down_13 -->
<g id="node100" class="node">
<title>expert_down_13</title>
<ellipse fill="lightblue" stroke="black" cx="15283.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="15283.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="15283.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15283.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="15283.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_13 -->
<g id="node125" class="node">
<title>agg_13</title>
<polygon fill="lightgreen" stroke="black" points="15618.73,-593.55 14911.58,-593.55 14729.66,-457.55 15436.82,-457.55 15618.73,-593.55"/>
<text text-anchor="middle" x="15174.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="15174.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_1</text>
<text text-anchor="middle" x="15174.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="15174.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_13&#45;&gt;agg_13 -->
<g id="edge130" class="edge">
<title>expert_down_13&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M15249.01,-629.55C15242.63,-620.78 15235.83,-611.41 15229.01,-602.02"/>
<polygon fill="black" stroke="black" points="15231.74,-599.83 15223.04,-593.79 15226.08,-603.94 15231.74,-599.83"/>
</g>
<!-- expert_mul_13&#45;&gt;expert_down_13 -->
<g id="edge129" class="edge">
<title>expert_mul_13&#45;&gt;expert_down_13</title>
<path fill="none" stroke="black" d="M15348.46,-762.14C15341.1,-752.72 15333.48,-742.98 15326.17,-733.62"/>
<polygon fill="black" stroke="black" points="15328.74,-731.23 15319.83,-725.5 15323.23,-735.54 15328.74,-731.23"/>
</g>
<!-- expert_act_14 -->
<g id="node104" class="node">
<title>expert_act_14</title>
<ellipse fill="lightblue" stroke="black" cx="16701.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="16701.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 14 Activation</text>
<text text-anchor="middle" x="16701.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16701.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16701.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_14&#45;&gt;expert_act_14 -->
<g id="edge133" class="edge">
<title>expert_gate_14&#45;&gt;expert_act_14</title>
<path fill="none" stroke="black" d="M16701.2,-1046.98C16701.2,-1038.71 16701.2,-1030.03 16701.2,-1021.53"/>
<polygon fill="black" stroke="black" points="16704.7,-1021.28 16701.2,-1011.28 16697.7,-1021.28 16704.7,-1021.28"/>
</g>
<!-- expert_mul_14 -->
<g id="node106" class="node">
<title>expert_mul_14</title>
<ellipse fill="lightblue" stroke="black" cx="16701.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="16701.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 14 Gate Multiply</text>
<text text-anchor="middle" x="16701.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16701.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16701.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16701.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_14&#45;&gt;expert_mul_14 -->
<g id="edge134" class="edge">
<title>expert_up_14&#45;&gt;expert_mul_14</title>
<path fill="none" stroke="black" d="M17282.52,-1048.36C17217.75,-1008.89 17119.36,-952.59 17028.2,-915.09 16987.45,-898.33 16942.68,-883.38 16899.69,-870.61"/>
<polygon fill="black" stroke="black" points="16900.55,-867.22 16889.97,-867.75 16898.58,-873.93 16900.55,-867.22"/>
</g>
<!-- expert_act_14&#45;&gt;expert_mul_14 -->
<g id="edge135" class="edge">
<title>expert_act_14&#45;&gt;expert_mul_14</title>
<path fill="none" stroke="black" d="M16701.2,-914.91C16701.2,-906.76 16701.2,-898.14 16701.2,-889.57"/>
<polygon fill="black" stroke="black" points="16704.7,-889.55 16701.2,-879.55 16697.7,-889.55 16704.7,-889.55"/>
</g>
<!-- expert_down_14 -->
<g id="node105" class="node">
<title>expert_down_14</title>
<ellipse fill="lightblue" stroke="black" cx="16544.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="16544.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="16544.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16544.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="16544.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_14 -->
<g id="node126" class="node">
<title>agg_14</title>
<polygon fill="lightgreen" stroke="black" points="16688.73,-593.55 15981.58,-593.55 15799.66,-457.55 16506.82,-457.55 16688.73,-593.55"/>
<text text-anchor="middle" x="16244.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="16244.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_2</text>
<text text-anchor="middle" x="16244.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="16244.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_14&#45;&gt;agg_14 -->
<g id="edge137" class="edge">
<title>expert_down_14&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M16453.78,-631.4C16432.76,-620.88 16409.88,-609.43 16387.21,-598.09"/>
<polygon fill="black" stroke="black" points="16388.71,-594.93 16378.2,-593.58 16385.58,-601.19 16388.71,-594.93"/>
</g>
<!-- expert_mul_14&#45;&gt;expert_down_14 -->
<g id="edge136" class="edge">
<title>expert_mul_14&#45;&gt;expert_down_14</title>
<path fill="none" stroke="black" d="M16637.79,-762.55C16626.59,-752.51 16614.96,-742.08 16603.87,-732.13"/>
<polygon fill="black" stroke="black" points="16606.07,-729.4 16596.28,-725.33 16601.39,-734.61 16606.07,-729.4"/>
</g>
<!-- expert_act_15 -->
<g id="node109" class="node">
<title>expert_act_15</title>
<ellipse fill="lightblue" stroke="black" cx="18009.2" cy="-963.18" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="18009.2" y="-981.98" font-family="Times,serif" font-size="14.00">Expert 15 Activation</text>
<text text-anchor="middle" x="18009.2" y="-966.98" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18009.2" y="-951.98" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="18009.2" y="-936.98" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_gate_15&#45;&gt;expert_act_15 -->
<g id="edge140" class="edge">
<title>expert_gate_15&#45;&gt;expert_act_15</title>
<path fill="none" stroke="black" d="M18009.2,-1046.98C18009.2,-1038.71 18009.2,-1030.03 18009.2,-1021.53"/>
<polygon fill="black" stroke="black" points="18012.7,-1021.28 18009.2,-1011.28 18005.7,-1021.28 18012.7,-1021.28"/>
</g>
<!-- expert_mul_15 -->
<g id="node111" class="node">
<title>expert_mul_15</title>
<ellipse fill="lightblue" stroke="black" cx="18009.2" cy="-820.4" rx="318.4" ry="58.88"/>
<text text-anchor="middle" x="18009.2" y="-846.7" font-family="Times,serif" font-size="14.00">Expert 15 Gate Multiply</text>
<text text-anchor="middle" x="18009.2" y="-831.7" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="18009.2" y="-816.7" font-family="Times,serif" font-size="14.00">Input1: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="18009.2" y="-801.7" font-family="Times,serif" font-size="14.00">Input2: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="18009.2" y="-786.7" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
</g>
<!-- expert_up_15&#45;&gt;expert_mul_15 -->
<g id="edge141" class="edge">
<title>expert_up_15&#45;&gt;expert_mul_15</title>
<path fill="none" stroke="black" d="M18590.52,-1048.36C18525.75,-1008.89 18427.36,-952.59 18336.2,-915.09 18295.45,-898.33 18250.68,-883.38 18207.69,-870.61"/>
<polygon fill="black" stroke="black" points="18208.55,-867.22 18197.97,-867.75 18206.58,-873.93 18208.55,-867.22"/>
</g>
<!-- expert_act_15&#45;&gt;expert_mul_15 -->
<g id="edge142" class="edge">
<title>expert_act_15&#45;&gt;expert_mul_15</title>
<path fill="none" stroke="black" d="M18009.2,-914.91C18009.2,-906.76 18009.2,-898.14 18009.2,-889.57"/>
<polygon fill="black" stroke="black" points="18012.7,-889.55 18009.2,-879.55 18005.7,-889.55 18012.7,-889.55"/>
</g>
<!-- expert_down_15 -->
<g id="node110" class="node">
<title>expert_down_15</title>
<ellipse fill="lightblue" stroke="black" cx="17598.2" cy="-677.63" rx="311.67" ry="48.17"/>
<text text-anchor="middle" x="17598.2" y="-696.43" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="17598.2" y="-681.43" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="17598.2" y="-666.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, mlp_hidden=2048]</text>
<text text-anchor="middle" x="17598.2" y="-651.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
</g>
<!-- agg_15 -->
<g id="node127" class="node">
<title>agg_15</title>
<polygon fill="lightgreen" stroke="black" points="17819.73,-593.55 17112.58,-593.55 16930.66,-457.55 17637.82,-457.55 17819.73,-593.55"/>
<text text-anchor="middle" x="17375.2" y="-544.35" font-family="Times,serif" font-size="14.00">Token Aggregate</text>
<text text-anchor="middle" x="17375.2" y="-529.35" font-family="Times,serif" font-size="14.00">GPU: 3_3</text>
<text text-anchor="middle" x="17375.2" y="-514.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, dynamic_seq_len, token_dim=7168]</text>
<text text-anchor="middle" x="17375.2" y="-499.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- expert_down_15&#45;&gt;agg_15 -->
<g id="edge144" class="edge">
<title>expert_down_15&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M17529.78,-630.58C17515.19,-620.76 17499.45,-610.17 17483.78,-599.62"/>
<polygon fill="black" stroke="black" points="17485.34,-596.45 17475.09,-593.77 17481.43,-602.26 17485.34,-596.45"/>
</g>
<!-- expert_mul_15&#45;&gt;expert_down_15 -->
<g id="edge143" class="edge">
<title>expert_mul_15&#45;&gt;expert_down_15</title>
<path fill="none" stroke="black" d="M17860.53,-768.48C17819.04,-754.27 17774.19,-738.91 17733.52,-724.98"/>
<polygon fill="black" stroke="black" points="17734.41,-721.58 17723.82,-721.66 17732.14,-728.21 17734.41,-721.58"/>
</g>
<!-- final_agg -->
<g id="node128" class="node">
<title>final_agg</title>
<polygon fill="lightgreen" stroke="black" points="10841.72,-421.55 10145.72,-421.55 9966.68,-285.55 10662.67,-285.55 10841.72,-421.55"/>
<text text-anchor="middle" x="10404.2" y="-372.35" font-family="Times,serif" font-size="14.00">Final Expert Aggregation</text>
<text text-anchor="middle" x="10404.2" y="-357.35" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="10404.2" y="-342.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, token_dim=7168]</text>
<text text-anchor="middle" x="10404.2" y="-327.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, token_dim=7168]</text>
</g>
<!-- agg_0&#45;&gt;final_agg -->
<g id="edge145" class="edge">
<title>agg_0&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M2452.4,-484.04C2541.88,-473.47 2640.37,-463.41 2731.2,-457.55 4181.89,-363.83 8735.39,-355.04 10047.25,-354.49"/>
<polygon fill="black" stroke="black" points="10047.3,-357.99 10057.3,-354.49 10047.3,-350.99 10047.3,-357.99"/>
</g>
<!-- agg_1&#45;&gt;final_agg -->
<g id="edge146" class="edge">
<title>agg_1&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M3478.74,-480.48C3550.99,-471.26 3628.26,-462.76 3700.2,-457.55 4950.99,-366.87 8845.58,-355.87 10047.37,-354.66"/>
<polygon fill="black" stroke="black" points="10047.46,-358.16 10057.46,-354.65 10047.45,-351.16 10047.46,-358.16"/>
</g>
<!-- agg_2&#45;&gt;final_agg -->
<g id="edge147" class="edge">
<title>agg_2&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M4479.24,-504.06C4729.95,-488.98 5085.4,-469.15 5397.2,-457.55 7143.1,-392.55 9233.1,-366.13 10051.31,-357.77"/>
<polygon fill="black" stroke="black" points="10051.51,-361.27 10061.47,-357.67 10051.44,-354.27 10051.51,-361.27"/>
</g>
<!-- agg_3&#45;&gt;final_agg -->
<g id="edge148" class="edge">
<title>agg_3&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M6140.16,-477.17C6197.05,-469.37 6256.39,-462.29 6312.2,-457.55 7033.3,-396.29 9197.19,-367.31 10051.62,-358.02"/>
<polygon fill="black" stroke="black" points="10051.96,-361.52 10061.92,-357.91 10051.88,-354.52 10051.96,-361.52"/>
</g>
<!-- agg_4&#45;&gt;final_agg -->
<g id="edge149" class="edge">
<title>agg_4&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M7055.11,-477.14C7110.76,-469.44 7168.69,-462.41 7223.2,-457.55 7763.66,-409.33 9347.18,-374.47 10055.16,-360.85"/>
<polygon fill="black" stroke="black" points="10055.33,-364.35 10065.26,-360.66 10055.19,-357.35 10055.33,-364.35"/>
</g>
<!-- agg_5&#45;&gt;final_agg -->
<g id="edge150" class="edge">
<title>agg_5&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M7966.75,-477.54C8021.9,-469.85 8079.23,-462.72 8133.2,-457.55 8810.89,-392.56 9606.4,-368.38 10053.26,-359.53"/>
<polygon fill="black" stroke="black" points="10053.5,-363.03 10063.43,-359.33 10053.36,-356.03 10053.5,-363.03"/>
</g>
<!-- agg_6&#45;&gt;final_agg -->
<g id="edge151" class="edge">
<title>agg_6&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M8878.07,-478.59C8932.53,-470.87 8989.03,-463.46 9042.2,-457.55 9392.27,-418.58 9794.64,-390.16 10070.76,-373.16"/>
<polygon fill="black" stroke="black" points="10071.17,-376.64 10080.94,-372.54 10070.74,-369.66 10071.17,-376.64"/>
</g>
<!-- agg_7&#45;&gt;final_agg -->
<g id="edge152" class="edge">
<title>agg_7&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M9777.9,-471.81C9885.33,-451.69 10007.87,-428.75 10115.9,-408.52"/>
<polygon fill="black" stroke="black" points="10116.79,-411.92 10125.98,-406.64 10115.5,-405.04 10116.79,-411.92"/>
</g>
<!-- agg_8&#45;&gt;final_agg -->
<g id="edge153" class="edge">
<title>agg_8&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M10404.2,-457.36C10404.2,-449.04 10404.2,-440.49 10404.2,-432.04"/>
<polygon fill="black" stroke="black" points="10407.7,-431.8 10404.2,-421.8 10400.7,-431.8 10407.7,-431.8"/>
</g>
<!-- agg_9&#45;&gt;final_agg -->
<g id="edge154" class="edge">
<title>agg_9&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M10954.31,-457.54C10894.51,-446.34 10832.37,-434.71 10772.32,-423.47"/>
<polygon fill="black" stroke="black" points="10772.78,-419.99 10762.31,-421.59 10771.49,-426.87 10772.78,-419.99"/>
</g>
<!-- agg_10&#45;&gt;final_agg -->
<g id="edge155" class="edge">
<title>agg_10&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M11777.23,-458.79C11773.54,-458.37 11769.86,-457.95 11766.2,-457.55 11438.39,-421.01 11064.72,-393.77 10791.8,-376.51"/>
<polygon fill="black" stroke="black" points="10791.93,-373.01 10781.73,-375.87 10791.49,-380 10791.93,-373.01"/>
</g>
<!-- agg_11&#45;&gt;final_agg -->
<g id="edge156" class="edge">
<title>agg_11&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M12684.95,-458.6C12681.35,-458.24 12677.77,-457.89 12674.2,-457.55 12004.62,-393.11 11219.94,-368.82 10770.54,-359.78"/>
<polygon fill="black" stroke="black" points="10770.39,-356.27 10760.32,-359.57 10770.25,-363.27 10770.39,-356.27"/>
</g>
<!-- agg_12&#45;&gt;final_agg -->
<g id="edge157" class="edge">
<title>agg_12&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M13627.19,-461.72C13612.02,-460.21 13596.99,-458.81 13582.2,-457.55 12562.4,-370.68 11352.8,-355.61 10763.25,-353.91"/>
<polygon fill="black" stroke="black" points="10762.9,-350.41 10752.89,-353.88 10762.88,-357.41 10762.9,-350.41"/>
</g>
<!-- agg_13&#45;&gt;final_agg -->
<g id="edge158" class="edge">
<title>agg_13&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M14755.06,-476.77C14677.08,-469.26 14596.23,-462.38 14520.2,-457.55 13133.32,-369.28 11479.08,-355.68 10763.42,-354.24"/>
<polygon fill="black" stroke="black" points="10763.23,-350.74 10753.22,-354.22 10763.21,-357.74 10763.23,-350.74"/>
</g>
<!-- agg_14&#45;&gt;final_agg -->
<g id="edge159" class="edge">
<title>agg_14&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M15820.89,-473.51C15756.42,-467.19 15690.6,-461.55 15628.2,-457.55 14680.81,-396.8 11790.44,-366.53 10767.61,-357.51"/>
<polygon fill="black" stroke="black" points="10767.55,-354.01 10757.52,-357.42 10767.49,-361.01 10767.55,-354.01"/>
</g>
<!-- agg_15&#45;&gt;final_agg -->
<g id="edge160" class="edge">
<title>agg_15&#45;&gt;final_agg</title>
<path fill="none" stroke="black" d="M16957.6,-477.78C16871.9,-469.72 16782.21,-462.38 16698.2,-457.55 15532.07,-390.42 11924.96,-363.58 10766.43,-356.55"/>
<polygon fill="black" stroke="black" points="10766.3,-353.05 10756.28,-356.49 10766.26,-360.05 10766.3,-353.05"/>
</g>
<!-- final_agg&#45;&gt;res2 -->
<g id="edge161" class="edge">
<title>final_agg&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M10734.55,-340.14C11541.27,-309.84 13602.35,-232.42 14379.51,-203.23"/>
<polygon fill="black" stroke="black" points="14379.87,-206.72 14389.73,-202.84 14379.6,-199.72 14379.87,-206.72"/>
</g>
<!-- res2&#45;&gt;output -->
<g id="edge163" class="edge">
<title>res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14682.2,-131.79C14682.2,-123.39 14682.2,-114.74 14682.2,-106.36"/>
<polygon fill="black" stroke="black" points="14685.7,-106.3 14682.2,-96.3 14678.7,-106.3 14685.7,-106.3"/>
</g>
</g>
</svg>
