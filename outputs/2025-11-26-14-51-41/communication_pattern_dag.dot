// Cross-Node Communication Patterns
digraph {
	fontname=Arial rankdir=LR size="15,20"
	n0_gpu0 [label="Node 0 GPU 0\nExpert 0\nMemory: 64GB\nCompute: 400TFLOPS"]
	n0_gpu1 [label="Node 0 GPU 1\nExpert 1\nMemory: 64GB\nCompute: 400TFLOPS"]
	n0_gpu2 [label="Node 0 GPU 2\nExpert 2\nMemory: 64GB\nCompute: 400TFLOPS"]
	n0_gpu3 [label="Node 0 GPU 3\nExpert 3\nMemory: 64GB\nCompute: 400TFLOPS"]
	n1_gpu0 [label="Node 1 GPU 0\nExpert 4\nMemory: 64GB\nCompute: 400TFLOPS"]
	n1_gpu1 [label="Node 1 GPU 1\nExpert 5\nMemory: 64GB\nCompute: 400TFLOPS"]
	n1_gpu2 [label="Node 1 GPU 2\nExpert 6\nMemory: 64GB\nCompute: 400TFLOPS"]
	n1_gpu3 [label="Node 1 GPU 3\nExpert 7\nMemory: 64GB\nCompute: 400TFLOPS"]
	n2_gpu0 [label="Node 2 GPU 0\nExpert 8\nMemory: 64GB\nCompute: 400TFLOPS"]
	n2_gpu1 [label="Node 2 GPU 1\nExpert 9\nMemory: 64GB\nCompute: 400TFLOPS"]
	n2_gpu2 [label="Node 2 GPU 2\nExpert 10\nMemory: 64GB\nCompute: 400TFLOPS"]
	n2_gpu3 [label="Node 2 GPU 3\nExpert 11\nMemory: 64GB\nCompute: 400TFLOPS"]
	n3_gpu0 [label="Node 3 GPU 0\nExpert 12\nMemory: 64GB\nCompute: 400TFLOPS"]
	n3_gpu1 [label="Node 3 GPU 1\nExpert 13\nMemory: 64GB\nCompute: 400TFLOPS"]
	n3_gpu2 [label="Node 3 GPU 2\nExpert 14\nMemory: 64GB\nCompute: 400TFLOPS"]
	n3_gpu3 [label="Node 3 GPU 3\nExpert 15\nMemory: 64GB\nCompute: 400TFLOPS"]
	router [label="Token Router\nGPU: Routing Node\nInput: [batch_size=4, seq_len=2048, token_dim=7168]\nOutput: Distributed to experts" fillcolor=lightgreen shape=parallelogram style=filled]
	n0_gpu0 -> n0_gpu1 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu0 -> n0_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu0 -> n0_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu1 -> n0_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu1 -> n0_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu2 -> n0_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu0 -> n1_gpu1 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu0 -> n1_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu0 -> n1_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu1 -> n1_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu1 -> n1_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n1_gpu2 -> n1_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu0 -> n2_gpu1 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu0 -> n2_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu0 -> n2_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu1 -> n2_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu1 -> n2_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n2_gpu2 -> n2_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu0 -> n3_gpu1 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu0 -> n3_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu0 -> n3_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu1 -> n3_gpu2 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu1 -> n3_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n3_gpu2 -> n3_gpu3 [label="NVLink 900GB/s" color=blue style=dashed]
	n0_gpu0 -> n1_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu1 -> n1_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu2 -> n1_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu3 -> n1_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu0 -> n2_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu1 -> n2_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu2 -> n2_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu3 -> n2_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu0 -> n3_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu1 -> n3_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu2 -> n3_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n0_gpu3 -> n3_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu0 -> n0_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu1 -> n0_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu2 -> n0_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu3 -> n0_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu0 -> n2_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu1 -> n2_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu2 -> n2_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu3 -> n2_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu0 -> n3_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu1 -> n3_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu2 -> n3_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n1_gpu3 -> n3_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu0 -> n0_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu1 -> n0_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu2 -> n0_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu3 -> n0_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu0 -> n1_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu1 -> n1_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu2 -> n1_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu3 -> n1_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu0 -> n3_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu1 -> n3_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu2 -> n3_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n2_gpu3 -> n3_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu0 -> n0_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu1 -> n0_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu2 -> n0_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu3 -> n0_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu0 -> n1_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu1 -> n1_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu2 -> n1_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu3 -> n1_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu0 -> n2_gpu0 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu1 -> n2_gpu1 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu2 -> n2_gpu2 [label="InfiniBand 400Gbps" color=red style=dotted]
	n3_gpu3 -> n2_gpu3 [label="InfiniBand 400Gbps" color=red style=dotted]
	router -> n0_gpu0 [style=dashed]
	router -> n0_gpu1 [style=dashed]
	router -> n0_gpu2 [style=dashed]
	router -> n0_gpu3 [style=dashed]
	router -> n1_gpu0 [style=dashed]
	router -> n1_gpu1 [style=dashed]
	router -> n1_gpu2 [style=dashed]
	router -> n1_gpu3 [style=dashed]
	router -> n2_gpu0 [style=dashed]
	router -> n2_gpu1 [style=dashed]
	router -> n2_gpu2 [style=dashed]
	router -> n2_gpu3 [style=dashed]
	router -> n3_gpu0 [style=dashed]
	router -> n3_gpu1 [style=dashed]
	router -> n3_gpu2 [style=dashed]
	router -> n3_gpu3 [style=dashed]
}
