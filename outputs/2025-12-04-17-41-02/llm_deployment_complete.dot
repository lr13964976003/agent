// LLM Deployment DAG - EP64_TP2_PP1 Strategy
digraph {
	dpi=300 rankdir=TB size="40,60"
	node [fontname=Arial fontsize=9]
	edge [fontname=Arial fontsize=8]
	node [fillcolor=lightblue shape=rectangle style=filled]
	node [fillcolor=lightgreen shape=ellipse style=filled]
	node [fillcolor=yellow shape=parallelogram style=filled]
	subgraph cluster_input {
		bgcolor=lightgray label="Input Layer" style=rounded
		input [label="Input Tokens\nGPU: All 128 GPUs\nInput: [batch_size=128, seq_len=1024, hidden=1024]\nOutput: [batch_size=128, seq_len=1024, hidden=1024]" fillcolor=lightcoral shape=rectangle]
	}
	subgraph cluster_layer1 {
		bgcolor=lightblue label="Layer 1 - Attention + MoE" style=rounded
		attn_norm_1 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_1 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_1 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_1 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_1 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_1 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_1 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_1 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_1 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_1 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_1 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_1 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_1 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_1 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_1 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_1 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_1 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_1 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_1 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_1 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_1 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_1 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_1 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_1 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_1 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_1 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_1 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_1 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_1 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_1 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_1 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_1 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_1 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_1 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_1 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_1 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_1 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_1 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_1 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_1 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_1 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_1 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_1 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_1 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_1 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_1 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_1 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_1 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_1 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_1 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_1 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_1 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_1 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_1 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_1 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_1 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_1 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_1 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_1 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_1 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_1 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_1 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_1 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_1 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_1 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_1 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_1 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_1 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_1 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_1 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_1 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_1 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_1 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_1 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_1 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_1 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_1 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_1 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_1 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_1 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_1 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_1 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_1 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_1 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_1 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_1 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_1 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_1 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_1 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_1 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_1 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_1 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_1 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_1 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_1 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_1 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_1 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_1 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_1 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_1 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_1 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_1 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_1 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_1 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_1 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_1 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_1 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_1 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_1 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_1 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_1 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_1 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_1 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_1 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_1 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_1 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_1 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_1 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_1 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_1 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_1 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_1 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_1 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_1 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_1 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_1 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_1 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_1 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_1 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_1 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_1 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_1 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_1 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_1 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_1 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_1 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_1 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_1 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_1 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_1 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_1 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_1 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_1 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_1 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_1 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_1 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_1 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_1 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_1 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_1 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_1 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_1 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_1 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_1 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_1 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_1 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_1 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_1 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_1 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_1 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_1 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_1 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_1 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_1 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_1 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_1 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_1 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_1 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_1 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_1 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_1 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_1 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_1 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_1 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_1 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_1 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_1 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_1 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_1 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_1 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_1 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_1 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_1 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_1 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_1 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_1 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_1 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_1 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_1 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_1 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_1 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_1 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_1 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_1 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_1 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_1 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_1 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_1 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_1 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_1 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_1 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_1 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_1 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_1 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_1 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_1 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_1 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_1 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_1 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_1 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_1 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_1 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_1 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_1 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_1 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_1 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_1 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_1 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_1 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_1 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_1 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_1 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_1 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_1 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_1 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_1 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_1 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_1 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_1 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_1 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_1 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_1 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_1 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_1 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_1 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_1 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_1 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_1 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_1 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_1 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_1 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_1 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_1 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_1 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_1 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_1 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_1 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_1 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_1 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_1 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_1 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_1 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_1 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_1 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_1 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_1 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_1 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_1 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_1 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_1 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_1 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_1 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_1 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_1 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_1 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_1 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_1 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_1 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_1 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_1 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_1 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_1 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_1 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_1 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_1 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_1 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_1 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_1 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_1 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_1 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_1 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_1 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_1 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_1 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_1 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_1 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_1 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_1 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_1 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_1 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_1 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_1 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_1 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_1 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_1 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_1 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_1 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_1 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_1 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_1 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_1 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_1 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_1 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_1 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_1 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_1 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_1 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_1 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_1 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_1 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_1 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_1 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_1 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_1 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_1 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_1 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_1 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_1 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_1 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_1 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_1 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_1 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_1 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_1 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_1 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_1 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_1 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_1 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_1 [label="Layer Norm 1\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer2 {
		bgcolor=lightblue label="Layer 2 - Attention + MoE" style=rounded
		attn_norm_2 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_2 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_2 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_2 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_2 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_2 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_2 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_2 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_2 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_2 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_2 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_2 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_2 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_2 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_2 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_2 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_2 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_2 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_2 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_2 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_2 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_2 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_2 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_2 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_2 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_2 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_2 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_2 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_2 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_2 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_2 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_2 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_2 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_2 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_2 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_2 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_2 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_2 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_2 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_2 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_2 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_2 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_2 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_2 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_2 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_2 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_2 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_2 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_2 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_2 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_2 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_2 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_2 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_2 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_2 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_2 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_2 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_2 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_2 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_2 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_2 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_2 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_2 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_2 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_2 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_2 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_2 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_2 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_2 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_2 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_2 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_2 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_2 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_2 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_2 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_2 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_2 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_2 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_2 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_2 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_2 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_2 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_2 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_2 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_2 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_2 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_2 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_2 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_2 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_2 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_2 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_2 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_2 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_2 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_2 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_2 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_2 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_2 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_2 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_2 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_2 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_2 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_2 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_2 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_2 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_2 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_2 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_2 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_2 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_2 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_2 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_2 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_2 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_2 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_2 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_2 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_2 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_2 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_2 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_2 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_2 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_2 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_2 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_2 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_2 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_2 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_2 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_2 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_2 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_2 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_2 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_2 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_2 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_2 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_2 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_2 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_2 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_2 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_2 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_2 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_2 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_2 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_2 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_2 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_2 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_2 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_2 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_2 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_2 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_2 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_2 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_2 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_2 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_2 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_2 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_2 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_2 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_2 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_2 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_2 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_2 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_2 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_2 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_2 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_2 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_2 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_2 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_2 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_2 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_2 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_2 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_2 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_2 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_2 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_2 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_2 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_2 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_2 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_2 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_2 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_2 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_2 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_2 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_2 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_2 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_2 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_2 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_2 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_2 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_2 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_2 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_2 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_2 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_2 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_2 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_2 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_2 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_2 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_2 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_2 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_2 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_2 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_2 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_2 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_2 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_2 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_2 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_2 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_2 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_2 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_2 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_2 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_2 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_2 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_2 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_2 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_2 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_2 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_2 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_2 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_2 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_2 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_2 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_2 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_2 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_2 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_2 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_2 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_2 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_2 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_2 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_2 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_2 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_2 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_2 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_2 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_2 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_2 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_2 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_2 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_2 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_2 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_2 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_2 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_2 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_2 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_2 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_2 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_2 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_2 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_2 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_2 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_2 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_2 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_2 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_2 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_2 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_2 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_2 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_2 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_2 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_2 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_2 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_2 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_2 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_2 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_2 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_2 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_2 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_2 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_2 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_2 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_2 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_2 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_2 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_2 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_2 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_2 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_2 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_2 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_2 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_2 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_2 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_2 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_2 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_2 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_2 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_2 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_2 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_2 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_2 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_2 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_2 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_2 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_2 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_2 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_2 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_2 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_2 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_2 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_2 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_2 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_2 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_2 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_2 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_2 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_2 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_2 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_2 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_2 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_2 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_2 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_2 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_2 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_2 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_2 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_2 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_2 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_2 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_2 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_2 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_2 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_2 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_2 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_2 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_2 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_2 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_2 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_2 [label="Layer Norm 2\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer3 {
		bgcolor=lightblue label="Layer 3 - Attention + MoE" style=rounded
		attn_norm_3 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_3 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_3 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_3 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_3 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_3 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_3 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_3 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_3 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_3 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_3 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_3 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_3 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_3 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_3 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_3 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_3 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_3 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_3 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_3 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_3 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_3 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_3 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_3 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_3 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_3 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_3 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_3 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_3 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_3 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_3 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_3 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_3 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_3 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_3 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_3 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_3 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_3 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_3 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_3 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_3 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_3 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_3 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_3 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_3 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_3 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_3 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_3 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_3 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_3 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_3 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_3 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_3 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_3 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_3 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_3 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_3 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_3 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_3 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_3 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_3 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_3 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_3 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_3 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_3 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_3 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_3 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_3 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_3 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_3 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_3 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_3 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_3 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_3 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_3 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_3 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_3 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_3 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_3 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_3 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_3 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_3 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_3 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_3 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_3 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_3 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_3 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_3 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_3 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_3 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_3 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_3 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_3 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_3 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_3 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_3 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_3 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_3 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_3 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_3 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_3 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_3 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_3 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_3 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_3 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_3 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_3 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_3 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_3 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_3 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_3 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_3 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_3 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_3 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_3 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_3 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_3 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_3 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_3 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_3 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_3 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_3 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_3 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_3 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_3 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_3 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_3 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_3 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_3 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_3 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_3 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_3 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_3 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_3 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_3 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_3 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_3 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_3 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_3 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_3 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_3 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_3 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_3 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_3 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_3 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_3 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_3 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_3 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_3 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_3 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_3 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_3 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_3 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_3 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_3 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_3 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_3 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_3 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_3 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_3 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_3 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_3 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_3 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_3 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_3 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_3 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_3 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_3 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_3 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_3 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_3 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_3 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_3 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_3 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_3 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_3 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_3 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_3 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_3 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_3 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_3 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_3 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_3 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_3 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_3 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_3 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_3 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_3 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_3 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_3 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_3 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_3 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_3 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_3 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_3 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_3 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_3 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_3 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_3 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_3 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_3 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_3 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_3 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_3 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_3 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_3 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_3 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_3 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_3 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_3 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_3 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_3 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_3 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_3 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_3 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_3 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_3 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_3 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_3 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_3 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_3 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_3 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_3 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_3 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_3 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_3 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_3 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_3 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_3 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_3 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_3 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_3 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_3 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_3 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_3 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_3 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_3 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_3 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_3 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_3 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_3 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_3 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_3 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_3 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_3 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_3 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_3 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_3 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_3 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_3 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_3 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_3 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_3 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_3 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_3 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_3 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_3 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_3 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_3 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_3 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_3 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_3 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_3 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_3 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_3 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_3 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_3 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_3 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_3 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_3 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_3 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_3 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_3 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_3 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_3 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_3 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_3 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_3 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_3 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_3 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_3 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_3 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_3 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_3 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_3 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_3 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_3 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_3 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_3 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_3 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_3 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_3 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_3 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_3 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_3 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_3 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_3 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_3 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_3 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_3 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_3 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_3 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_3 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_3 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_3 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_3 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_3 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_3 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_3 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_3 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_3 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_3 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_3 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_3 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_3 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_3 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_3 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_3 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_3 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_3 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_3 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_3 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_3 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_3 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_3 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_3 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_3 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_3 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_3 [label="Layer Norm 3\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer4 {
		bgcolor=lightblue label="Layer 4 - Attention + MoE" style=rounded
		attn_norm_4 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_4 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_4 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_4 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_4 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_4 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_4 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_4 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_4 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_4 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_4 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_4 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_4 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_4 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_4 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_4 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_4 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_4 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_4 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_4 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_4 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_4 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_4 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_4 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_4 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_4 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_4 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_4 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_4 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_4 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_4 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_4 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_4 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_4 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_4 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_4 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_4 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_4 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_4 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_4 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_4 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_4 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_4 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_4 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_4 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_4 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_4 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_4 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_4 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_4 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_4 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_4 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_4 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_4 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_4 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_4 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_4 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_4 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_4 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_4 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_4 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_4 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_4 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_4 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_4 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_4 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_4 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_4 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_4 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_4 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_4 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_4 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_4 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_4 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_4 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_4 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_4 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_4 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_4 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_4 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_4 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_4 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_4 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_4 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_4 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_4 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_4 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_4 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_4 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_4 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_4 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_4 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_4 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_4 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_4 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_4 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_4 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_4 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_4 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_4 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_4 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_4 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_4 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_4 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_4 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_4 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_4 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_4 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_4 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_4 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_4 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_4 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_4 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_4 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_4 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_4 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_4 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_4 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_4 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_4 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_4 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_4 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_4 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_4 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_4 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_4 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_4 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_4 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_4 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_4 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_4 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_4 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_4 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_4 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_4 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_4 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_4 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_4 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_4 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_4 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_4 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_4 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_4 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_4 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_4 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_4 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_4 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_4 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_4 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_4 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_4 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_4 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_4 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_4 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_4 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_4 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_4 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_4 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_4 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_4 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_4 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_4 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_4 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_4 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_4 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_4 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_4 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_4 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_4 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_4 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_4 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_4 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_4 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_4 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_4 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_4 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_4 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_4 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_4 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_4 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_4 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_4 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_4 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_4 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_4 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_4 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_4 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_4 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_4 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_4 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_4 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_4 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_4 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_4 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_4 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_4 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_4 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_4 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_4 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_4 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_4 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_4 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_4 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_4 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_4 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_4 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_4 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_4 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_4 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_4 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_4 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_4 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_4 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_4 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_4 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_4 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_4 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_4 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_4 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_4 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_4 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_4 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_4 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_4 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_4 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_4 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_4 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_4 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_4 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_4 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_4 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_4 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_4 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_4 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_4 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_4 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_4 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_4 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_4 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_4 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_4 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_4 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_4 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_4 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_4 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_4 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_4 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_4 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_4 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_4 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_4 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_4 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_4 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_4 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_4 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_4 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_4 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_4 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_4 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_4 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_4 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_4 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_4 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_4 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_4 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_4 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_4 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_4 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_4 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_4 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_4 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_4 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_4 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_4 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_4 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_4 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_4 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_4 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_4 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_4 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_4 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_4 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_4 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_4 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_4 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_4 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_4 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_4 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_4 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_4 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_4 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_4 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_4 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_4 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_4 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_4 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_4 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_4 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_4 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_4 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_4 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_4 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_4 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_4 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_4 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_4 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_4 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_4 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_4 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_4 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_4 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_4 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_4 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_4 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_4 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_4 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_4 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_4 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_4 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_4 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_4 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_4 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_4 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_4 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_4 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_4 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_4 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_4 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_4 [label="Layer Norm 4\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer5 {
		bgcolor=lightblue label="Layer 5 - Attention + MoE" style=rounded
		attn_norm_5 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_5 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_5 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_5 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_5 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_5 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_5 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_5 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_5 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_5 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_5 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_5 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_5 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_5 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_5 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_5 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_5 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_5 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_5 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_5 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_5 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_5 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_5 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_5 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_5 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_5 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_5 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_5 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_5 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_5 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_5 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_5 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_5 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_5 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_5 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_5 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_5 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_5 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_5 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_5 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_5 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_5 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_5 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_5 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_5 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_5 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_5 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_5 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_5 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_5 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_5 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_5 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_5 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_5 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_5 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_5 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_5 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_5 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_5 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_5 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_5 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_5 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_5 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_5 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_5 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_5 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_5 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_5 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_5 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_5 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_5 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_5 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_5 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_5 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_5 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_5 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_5 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_5 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_5 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_5 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_5 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_5 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_5 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_5 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_5 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_5 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_5 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_5 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_5 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_5 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_5 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_5 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_5 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_5 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_5 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_5 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_5 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_5 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_5 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_5 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_5 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_5 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_5 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_5 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_5 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_5 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_5 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_5 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_5 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_5 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_5 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_5 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_5 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_5 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_5 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_5 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_5 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_5 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_5 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_5 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_5 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_5 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_5 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_5 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_5 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_5 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_5 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_5 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_5 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_5 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_5 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_5 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_5 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_5 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_5 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_5 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_5 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_5 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_5 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_5 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_5 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_5 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_5 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_5 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_5 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_5 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_5 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_5 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_5 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_5 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_5 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_5 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_5 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_5 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_5 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_5 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_5 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_5 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_5 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_5 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_5 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_5 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_5 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_5 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_5 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_5 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_5 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_5 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_5 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_5 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_5 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_5 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_5 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_5 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_5 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_5 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_5 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_5 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_5 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_5 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_5 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_5 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_5 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_5 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_5 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_5 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_5 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_5 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_5 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_5 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_5 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_5 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_5 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_5 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_5 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_5 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_5 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_5 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_5 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_5 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_5 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_5 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_5 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_5 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_5 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_5 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_5 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_5 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_5 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_5 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_5 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_5 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_5 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_5 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_5 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_5 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_5 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_5 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_5 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_5 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_5 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_5 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_5 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_5 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_5 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_5 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_5 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_5 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_5 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_5 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_5 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_5 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_5 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_5 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_5 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_5 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_5 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_5 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_5 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_5 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_5 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_5 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_5 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_5 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_5 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_5 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_5 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_5 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_5 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_5 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_5 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_5 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_5 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_5 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_5 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_5 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_5 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_5 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_5 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_5 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_5 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_5 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_5 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_5 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_5 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_5 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_5 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_5 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_5 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_5 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_5 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_5 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_5 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_5 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_5 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_5 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_5 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_5 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_5 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_5 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_5 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_5 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_5 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_5 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_5 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_5 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_5 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_5 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_5 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_5 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_5 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_5 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_5 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_5 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_5 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_5 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_5 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_5 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_5 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_5 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_5 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_5 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_5 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_5 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_5 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_5 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_5 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_5 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_5 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_5 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_5 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_5 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_5 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_5 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_5 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_5 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_5 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_5 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_5 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_5 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_5 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_5 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_5 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_5 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_5 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_5 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_5 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_5 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_5 [label="Layer Norm 5\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer6 {
		bgcolor=lightblue label="Layer 6 - Attention + MoE" style=rounded
		attn_norm_6 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_6 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_6 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_6 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_6 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_6 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_6 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_6 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_6 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_6 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_6 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_6 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_6 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_6 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_6 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_6 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_6 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_6 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_6 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_6 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_6 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_6 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_6 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_6 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_6 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_6 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_6 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_6 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_6 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_6 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_6 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_6 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_6 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_6 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_6 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_6 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_6 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_6 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_6 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_6 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_6 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_6 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_6 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_6 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_6 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_6 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_6 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_6 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_6 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_6 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_6 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_6 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_6 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_6 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_6 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_6 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_6 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_6 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_6 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_6 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_6 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_6 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_6 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_6 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_6 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_6 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_6 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_6 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_6 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_6 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_6 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_6 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_6 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_6 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_6 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_6 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_6 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_6 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_6 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_6 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_6 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_6 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_6 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_6 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_6 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_6 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_6 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_6 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_6 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_6 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_6 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_6 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_6 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_6 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_6 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_6 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_6 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_6 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_6 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_6 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_6 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_6 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_6 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_6 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_6 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_6 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_6 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_6 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_6 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_6 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_6 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_6 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_6 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_6 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_6 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_6 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_6 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_6 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_6 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_6 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_6 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_6 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_6 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_6 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_6 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_6 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_6 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_6 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_6 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_6 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_6 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_6 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_6 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_6 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_6 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_6 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_6 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_6 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_6 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_6 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_6 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_6 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_6 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_6 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_6 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_6 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_6 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_6 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_6 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_6 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_6 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_6 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_6 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_6 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_6 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_6 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_6 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_6 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_6 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_6 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_6 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_6 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_6 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_6 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_6 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_6 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_6 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_6 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_6 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_6 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_6 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_6 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_6 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_6 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_6 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_6 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_6 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_6 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_6 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_6 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_6 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_6 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_6 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_6 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_6 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_6 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_6 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_6 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_6 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_6 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_6 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_6 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_6 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_6 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_6 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_6 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_6 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_6 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_6 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_6 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_6 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_6 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_6 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_6 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_6 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_6 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_6 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_6 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_6 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_6 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_6 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_6 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_6 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_6 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_6 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_6 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_6 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_6 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_6 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_6 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_6 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_6 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_6 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_6 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_6 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_6 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_6 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_6 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_6 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_6 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_6 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_6 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_6 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_6 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_6 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_6 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_6 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_6 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_6 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_6 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_6 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_6 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_6 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_6 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_6 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_6 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_6 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_6 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_6 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_6 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_6 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_6 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_6 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_6 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_6 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_6 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_6 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_6 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_6 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_6 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_6 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_6 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_6 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_6 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_6 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_6 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_6 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_6 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_6 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_6 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_6 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_6 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_6 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_6 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_6 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_6 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_6 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_6 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_6 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_6 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_6 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_6 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_6 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_6 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_6 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_6 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_6 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_6 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_6 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_6 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_6 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_6 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_6 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_6 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_6 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_6 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_6 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_6 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_6 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_6 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_6 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_6 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_6 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_6 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_6 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_6 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_6 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_6 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_6 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_6 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_6 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_6 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_6 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_6 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_6 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_6 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_6 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_6 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_6 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_6 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_6 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_6 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_6 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_6 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_6 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_6 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_6 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_6 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_6 [label="Layer Norm 6\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer7 {
		bgcolor=lightblue label="Layer 7 - Attention + MoE" style=rounded
		attn_norm_7 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_7 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_7 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_7 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_7 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_7 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_7 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_7 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_7 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_7 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_7 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_7 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_7 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_7 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_7 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_7 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_7 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_7 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_7 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_7 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_7 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_7 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_7 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_7 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_7 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_7 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_7 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_7 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_7 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_7 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_7 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_7 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_7 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_7 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_7 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_7 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_7 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_7 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_7 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_7 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_7 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_7 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_7 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_7 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_7 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_7 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_7 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_7 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_7 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_7 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_7 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_7 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_7 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_7 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_7 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_7 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_7 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_7 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_7 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_7 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_7 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_7 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_7 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_7 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_7 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_7 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_7 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_7 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_7 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_7 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_7 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_7 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_7 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_7 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_7 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_7 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_7 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_7 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_7 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_7 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_7 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_7 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_7 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_7 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_7 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_7 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_7 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_7 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_7 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_7 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_7 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_7 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_7 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_7 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_7 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_7 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_7 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_7 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_7 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_7 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_7 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_7 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_7 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_7 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_7 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_7 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_7 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_7 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_7 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_7 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_7 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_7 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_7 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_7 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_7 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_7 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_7 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_7 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_7 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_7 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_7 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_7 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_7 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_7 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_7 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_7 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_7 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_7 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_7 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_7 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_7 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_7 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_7 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_7 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_7 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_7 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_7 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_7 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_7 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_7 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_7 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_7 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_7 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_7 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_7 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_7 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_7 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_7 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_7 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_7 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_7 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_7 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_7 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_7 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_7 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_7 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_7 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_7 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_7 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_7 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_7 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_7 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_7 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_7 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_7 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_7 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_7 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_7 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_7 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_7 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_7 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_7 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_7 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_7 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_7 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_7 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_7 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_7 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_7 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_7 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_7 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_7 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_7 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_7 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_7 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_7 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_7 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_7 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_7 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_7 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_7 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_7 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_7 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_7 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_7 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_7 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_7 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_7 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_7 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_7 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_7 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_7 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_7 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_7 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_7 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_7 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_7 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_7 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_7 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_7 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_7 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_7 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_7 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_7 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_7 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_7 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_7 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_7 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_7 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_7 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_7 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_7 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_7 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_7 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_7 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_7 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_7 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_7 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_7 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_7 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_7 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_7 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_7 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_7 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_7 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_7 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_7 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_7 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_7 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_7 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_7 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_7 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_7 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_7 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_7 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_7 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_7 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_7 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_7 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_7 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_7 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_7 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_7 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_7 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_7 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_7 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_7 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_7 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_7 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_7 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_7 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_7 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_7 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_7 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_7 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_7 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_7 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_7 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_7 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_7 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_7 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_7 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_7 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_7 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_7 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_7 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_7 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_7 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_7 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_7 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_7 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_7 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_7 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_7 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_7 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_7 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_7 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_7 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_7 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_7 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_7 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_7 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_7 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_7 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_7 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_7 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_7 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_7 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_7 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_7 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_7 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_7 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_7 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_7 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_7 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_7 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_7 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_7 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_7 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_7 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_7 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_7 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_7 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_7 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_7 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_7 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_7 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_7 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_7 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_7 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_7 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_7 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_7 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_7 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_7 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_7 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_7 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_7 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_7 [label="Layer Norm 7\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer8 {
		bgcolor=lightblue label="Layer 8 - Attention + MoE" style=rounded
		attn_norm_8 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_8 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_8 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_8 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_8 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_8 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_8 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_8 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_8 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_8 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_8 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_8 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_8 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_8 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_8 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_8 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_8 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_8 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_8 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_8 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_8 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_8 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_8 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_8 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_8 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_8 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_8 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_8 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_8 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_8 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_8 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_8 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_8 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_8 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_8 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_8 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_8 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_8 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_8 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_8 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_8 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_8 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_8 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_8 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_8 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_8 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_8 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_8 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_8 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_8 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_8 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_8 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_8 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_8 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_8 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_8 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_8 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_8 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_8 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_8 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_8 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_8 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_8 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_8 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_8 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_8 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_8 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_8 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_8 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_8 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_8 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_8 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_8 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_8 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_8 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_8 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_8 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_8 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_8 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_8 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_8 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_8 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_8 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_8 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_8 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_8 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_8 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_8 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_8 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_8 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_8 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_8 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_8 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_8 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_8 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_8 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_8 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_8 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_8 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_8 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_8 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_8 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_8 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_8 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_8 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_8 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_8 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_8 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_8 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_8 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_8 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_8 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_8 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_8 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_8 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_8 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_8 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_8 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_8 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_8 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_8 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_8 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_8 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_8 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_8 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_8 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_8 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_8 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_8 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_8 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_8 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_8 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_8 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_8 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_8 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_8 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_8 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_8 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_8 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_8 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_8 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_8 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_8 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_8 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_8 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_8 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_8 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_8 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_8 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_8 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_8 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_8 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_8 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_8 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_8 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_8 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_8 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_8 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_8 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_8 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_8 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_8 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_8 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_8 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_8 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_8 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_8 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_8 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_8 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_8 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_8 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_8 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_8 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_8 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_8 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_8 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_8 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_8 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_8 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_8 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_8 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_8 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_8 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_8 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_8 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_8 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_8 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_8 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_8 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_8 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_8 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_8 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_8 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_8 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_8 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_8 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_8 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_8 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_8 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_8 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_8 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_8 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_8 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_8 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_8 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_8 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_8 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_8 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_8 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_8 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_8 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_8 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_8 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_8 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_8 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_8 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_8 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_8 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_8 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_8 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_8 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_8 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_8 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_8 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_8 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_8 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_8 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_8 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_8 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_8 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_8 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_8 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_8 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_8 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_8 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_8 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_8 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_8 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_8 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_8 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_8 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_8 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_8 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_8 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_8 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_8 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_8 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_8 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_8 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_8 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_8 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_8 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_8 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_8 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_8 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_8 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_8 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_8 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_8 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_8 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_8 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_8 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_8 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_8 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_8 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_8 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_8 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_8 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_8 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_8 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_8 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_8 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_8 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_8 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_8 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_8 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_8 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_8 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_8 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_8 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_8 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_8 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_8 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_8 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_8 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_8 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_8 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_8 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_8 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_8 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_8 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_8 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_8 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_8 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_8 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_8 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_8 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_8 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_8 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_8 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_8 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_8 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_8 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_8 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_8 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_8 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_8 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_8 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_8 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_8 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_8 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_8 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_8 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_8 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_8 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_8 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_8 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_8 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_8 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_8 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_8 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_8 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_8 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_8 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_8 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_8 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_8 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_8 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_8 [label="Layer Norm 8\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer9 {
		bgcolor=lightblue label="Layer 9 - Attention + MoE" style=rounded
		attn_norm_9 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_9 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_9 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_9 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_9 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_9 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_9 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_9 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_9 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_9 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_9 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_9 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_9 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_9 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_9 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_9 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_9 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_9 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_9 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_9 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_9 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_9 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_9 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_9 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_9 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_9 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_9 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_9 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_9 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_9 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_9 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_9 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_9 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_9 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_9 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_9 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_9 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_9 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_9 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_9 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_9 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_9 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_9 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_9 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_9 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_9 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_9 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_9 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_9 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_9 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_9 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_9 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_9 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_9 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_9 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_9 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_9 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_9 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_9 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_9 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_9 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_9 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_9 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_9 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_9 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_9 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_9 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_9 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_9 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_9 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_9 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_9 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_9 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_9 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_9 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_9 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_9 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_9 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_9 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_9 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_9 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_9 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_9 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_9 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_9 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_9 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_9 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_9 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_9 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_9 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_9 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_9 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_9 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_9 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_9 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_9 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_9 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_9 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_9 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_9 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_9 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_9 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_9 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_9 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_9 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_9 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_9 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_9 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_9 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_9 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_9 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_9 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_9 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_9 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_9 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_9 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_9 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_9 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_9 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_9 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_9 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_9 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_9 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_9 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_9 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_9 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_9 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_9 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_9 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_9 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_9 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_9 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_9 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_9 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_9 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_9 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_9 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_9 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_9 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_9 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_9 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_9 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_9 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_9 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_9 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_9 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_9 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_9 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_9 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_9 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_9 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_9 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_9 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_9 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_9 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_9 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_9 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_9 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_9 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_9 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_9 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_9 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_9 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_9 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_9 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_9 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_9 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_9 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_9 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_9 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_9 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_9 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_9 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_9 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_9 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_9 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_9 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_9 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_9 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_9 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_9 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_9 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_9 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_9 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_9 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_9 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_9 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_9 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_9 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_9 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_9 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_9 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_9 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_9 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_9 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_9 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_9 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_9 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_9 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_9 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_9 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_9 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_9 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_9 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_9 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_9 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_9 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_9 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_9 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_9 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_9 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_9 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_9 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_9 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_9 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_9 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_9 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_9 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_9 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_9 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_9 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_9 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_9 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_9 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_9 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_9 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_9 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_9 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_9 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_9 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_9 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_9 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_9 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_9 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_9 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_9 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_9 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_9 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_9 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_9 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_9 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_9 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_9 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_9 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_9 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_9 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_9 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_9 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_9 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_9 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_9 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_9 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_9 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_9 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_9 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_9 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_9 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_9 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_9 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_9 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_9 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_9 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_9 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_9 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_9 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_9 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_9 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_9 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_9 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_9 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_9 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_9 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_9 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_9 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_9 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_9 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_9 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_9 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_9 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_9 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_9 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_9 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_9 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_9 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_9 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_9 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_9 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_9 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_9 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_9 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_9 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_9 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_9 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_9 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_9 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_9 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_9 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_9 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_9 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_9 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_9 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_9 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_9 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_9 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_9 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_9 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_9 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_9 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_9 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_9 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_9 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_9 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_9 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_9 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_9 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_9 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_9 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_9 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_9 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_9 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_9 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_9 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_9 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_9 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_9 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_9 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_9 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_9 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_9 [label="Layer Norm 9\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer10 {
		bgcolor=lightblue label="Layer 10 - Attention + MoE" style=rounded
		attn_norm_10 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_10 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_10 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_10 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_10 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_10 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_10 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_10 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_10 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_10 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_10 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_10 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_10 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_10 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_10 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_10 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_10 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_10 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_10 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_10 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_10 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_10 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_10 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_10 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_10 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_10 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_10 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_10 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_10 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_10 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_10 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_10 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_10 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_10 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_10 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_10 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_10 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_10 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_10 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_10 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_10 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_10 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_10 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_10 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_10 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_10 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_10 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_10 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_10 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_10 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_10 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_10 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_10 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_10 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_10 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_10 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_10 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_10 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_10 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_10 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_10 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_10 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_10 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_10 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_10 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_10 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_10 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_10 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_10 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_10 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_10 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_10 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_10 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_10 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_10 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_10 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_10 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_10 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_10 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_10 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_10 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_10 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_10 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_10 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_10 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_10 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_10 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_10 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_10 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_10 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_10 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_10 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_10 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_10 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_10 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_10 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_10 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_10 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_10 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_10 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_10 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_10 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_10 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_10 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_10 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_10 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_10 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_10 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_10 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_10 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_10 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_10 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_10 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_10 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_10 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_10 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_10 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_10 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_10 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_10 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_10 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_10 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_10 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_10 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_10 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_10 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_10 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_10 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_10 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_10 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_10 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_10 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_10 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_10 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_10 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_10 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_10 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_10 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_10 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_10 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_10 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_10 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_10 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_10 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_10 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_10 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_10 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_10 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_10 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_10 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_10 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_10 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_10 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_10 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_10 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_10 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_10 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_10 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_10 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_10 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_10 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_10 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_10 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_10 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_10 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_10 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_10 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_10 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_10 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_10 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_10 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_10 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_10 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_10 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_10 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_10 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_10 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_10 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_10 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_10 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_10 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_10 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_10 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_10 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_10 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_10 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_10 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_10 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_10 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_10 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_10 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_10 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_10 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_10 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_10 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_10 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_10 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_10 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_10 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_10 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_10 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_10 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_10 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_10 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_10 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_10 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_10 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_10 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_10 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_10 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_10 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_10 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_10 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_10 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_10 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_10 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_10 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_10 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_10 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_10 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_10 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_10 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_10 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_10 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_10 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_10 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_10 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_10 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_10 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_10 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_10 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_10 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_10 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_10 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_10 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_10 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_10 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_10 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_10 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_10 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_10 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_10 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_10 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_10 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_10 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_10 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_10 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_10 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_10 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_10 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_10 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_10 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_10 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_10 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_10 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_10 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_10 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_10 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_10 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_10 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_10 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_10 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_10 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_10 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_10 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_10 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_10 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_10 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_10 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_10 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_10 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_10 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_10 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_10 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_10 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_10 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_10 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_10 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_10 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_10 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_10 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_10 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_10 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_10 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_10 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_10 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_10 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_10 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_10 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_10 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_10 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_10 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_10 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_10 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_10 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_10 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_10 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_10 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_10 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_10 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_10 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_10 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_10 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_10 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_10 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_10 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_10 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_10 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_10 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_10 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_10 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_10 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_10 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_10 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_10 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_10 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_10 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_10 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_10 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_10 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_10 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_10 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_10 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_10 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_10 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_10 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_10 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_10 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_10 [label="Layer Norm 10\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer11 {
		bgcolor=lightblue label="Layer 11 - Attention + MoE" style=rounded
		attn_norm_11 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_11 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_11 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_11 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_11 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_11 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_11 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_11 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_11 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_11 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_11 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_11 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_11 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_11 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_11 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_11 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_11 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_11 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_11 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_11 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_11 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_11 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_11 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_11 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_11 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_11 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_11 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_11 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_11 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_11 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_11 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_11 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_11 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_11 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_11 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_11 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_11 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_11 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_11 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_11 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_11 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_11 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_11 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_11 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_11 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_11 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_11 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_11 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_11 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_11 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_11 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_11 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_11 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_11 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_11 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_11 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_11 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_11 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_11 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_11 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_11 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_11 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_11 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_11 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_11 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_11 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_11 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_11 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_11 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_11 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_11 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_11 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_11 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_11 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_11 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_11 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_11 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_11 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_11 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_11 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_11 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_11 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_11 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_11 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_11 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_11 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_11 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_11 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_11 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_11 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_11 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_11 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_11 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_11 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_11 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_11 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_11 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_11 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_11 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_11 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_11 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_11 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_11 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_11 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_11 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_11 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_11 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_11 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_11 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_11 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_11 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_11 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_11 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_11 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_11 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_11 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_11 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_11 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_11 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_11 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_11 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_11 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_11 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_11 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_11 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_11 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_11 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_11 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_11 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_11 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_11 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_11 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_11 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_11 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_11 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_11 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_11 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_11 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_11 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_11 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_11 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_11 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_11 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_11 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_11 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_11 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_11 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_11 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_11 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_11 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_11 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_11 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_11 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_11 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_11 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_11 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_11 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_11 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_11 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_11 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_11 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_11 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_11 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_11 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_11 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_11 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_11 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_11 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_11 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_11 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_11 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_11 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_11 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_11 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_11 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_11 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_11 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_11 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_11 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_11 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_11 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_11 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_11 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_11 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_11 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_11 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_11 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_11 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_11 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_11 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_11 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_11 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_11 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_11 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_11 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_11 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_11 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_11 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_11 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_11 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_11 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_11 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_11 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_11 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_11 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_11 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_11 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_11 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_11 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_11 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_11 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_11 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_11 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_11 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_11 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_11 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_11 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_11 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_11 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_11 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_11 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_11 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_11 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_11 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_11 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_11 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_11 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_11 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_11 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_11 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_11 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_11 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_11 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_11 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_11 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_11 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_11 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_11 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_11 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_11 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_11 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_11 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_11 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_11 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_11 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_11 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_11 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_11 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_11 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_11 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_11 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_11 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_11 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_11 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_11 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_11 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_11 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_11 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_11 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_11 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_11 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_11 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_11 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_11 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_11 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_11 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_11 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_11 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_11 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_11 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_11 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_11 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_11 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_11 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_11 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_11 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_11 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_11 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_11 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_11 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_11 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_11 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_11 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_11 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_11 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_11 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_11 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_11 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_11 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_11 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_11 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_11 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_11 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_11 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_11 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_11 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_11 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_11 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_11 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_11 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_11 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_11 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_11 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_11 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_11 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_11 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_11 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_11 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_11 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_11 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_11 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_11 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_11 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_11 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_11 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_11 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_11 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_11 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_11 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_11 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_11 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_11 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_11 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_11 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_11 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_11 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_11 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_11 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_11 [label="Layer Norm 11\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer12 {
		bgcolor=lightblue label="Layer 12 - Attention + MoE" style=rounded
		attn_norm_12 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_12 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_12 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_12 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_12 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_12 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_12 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_12 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_12 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_12 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_12 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_12 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_12 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_12 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_12 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_12 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_12 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_12 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_12 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_12 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_12 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_12 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_12 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_12 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_12 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_12 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_12 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_12 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_12 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_12 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_12 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_12 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_12 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_12 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_12 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_12 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_12 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_12 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_12 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_12 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_12 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_12 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_12 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_12 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_12 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_12 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_12 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_12 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_12 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_12 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_12 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_12 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_12 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_12 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_12 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_12 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_12 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_12 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_12 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_12 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_12 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_12 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_12 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_12 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_12 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_12 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_12 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_12 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_12 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_12 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_12 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_12 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_12 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_12 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_12 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_12 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_12 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_12 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_12 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_12 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_12 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_12 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_12 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_12 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_12 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_12 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_12 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_12 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_12 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_12 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_12 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_12 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_12 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_12 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_12 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_12 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_12 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_12 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_12 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_12 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_12 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_12 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_12 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_12 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_12 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_12 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_12 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_12 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_12 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_12 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_12 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_12 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_12 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_12 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_12 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_12 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_12 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_12 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_12 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_12 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_12 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_12 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_12 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_12 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_12 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_12 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_12 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_12 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_12 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_12 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_12 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_12 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_12 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_12 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_12 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_12 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_12 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_12 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_12 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_12 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_12 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_12 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_12 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_12 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_12 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_12 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_12 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_12 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_12 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_12 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_12 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_12 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_12 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_12 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_12 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_12 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_12 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_12 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_12 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_12 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_12 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_12 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_12 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_12 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_12 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_12 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_12 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_12 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_12 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_12 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_12 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_12 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_12 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_12 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_12 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_12 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_12 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_12 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_12 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_12 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_12 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_12 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_12 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_12 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_12 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_12 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_12 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_12 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_12 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_12 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_12 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_12 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_12 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_12 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_12 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_12 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_12 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_12 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_12 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_12 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_12 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_12 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_12 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_12 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_12 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_12 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_12 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_12 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_12 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_12 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_12 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_12 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_12 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_12 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_12 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_12 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_12 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_12 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_12 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_12 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_12 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_12 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_12 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_12 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_12 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_12 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_12 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_12 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_12 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_12 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_12 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_12 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_12 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_12 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_12 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_12 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_12 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_12 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_12 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_12 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_12 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_12 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_12 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_12 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_12 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_12 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_12 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_12 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_12 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_12 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_12 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_12 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_12 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_12 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_12 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_12 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_12 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_12 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_12 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_12 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_12 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_12 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_12 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_12 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_12 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_12 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_12 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_12 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_12 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_12 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_12 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_12 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_12 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_12 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_12 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_12 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_12 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_12 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_12 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_12 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_12 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_12 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_12 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_12 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_12 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_12 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_12 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_12 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_12 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_12 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_12 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_12 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_12 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_12 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_12 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_12 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_12 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_12 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_12 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_12 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_12 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_12 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_12 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_12 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_12 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_12 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_12 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_12 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_12 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_12 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_12 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_12 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_12 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_12 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_12 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_12 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_12 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_12 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_12 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_12 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_12 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_12 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_12 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_12 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_12 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_12 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_12 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_12 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_12 [label="Layer Norm 12\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer13 {
		bgcolor=lightblue label="Layer 13 - Attention + MoE" style=rounded
		attn_norm_13 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_13 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_13 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_13 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_13 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_13 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_13 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_13 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_13 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_13 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_13 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_13 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_13 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_13 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_13 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_13 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_13 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_13 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_13 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_13 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_13 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_13 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_13 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_13 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_13 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_13 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_13 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_13 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_13 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_13 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_13 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_13 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_13 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_13 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_13 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_13 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_13 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_13 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_13 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_13 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_13 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_13 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_13 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_13 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_13 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_13 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_13 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_13 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_13 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_13 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_13 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_13 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_13 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_13 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_13 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_13 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_13 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_13 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_13 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_13 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_13 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_13 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_13 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_13 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_13 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_13 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_13 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_13 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_13 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_13 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_13 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_13 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_13 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_13 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_13 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_13 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_13 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_13 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_13 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_13 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_13 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_13 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_13 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_13 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_13 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_13 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_13 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_13 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_13 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_13 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_13 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_13 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_13 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_13 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_13 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_13 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_13 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_13 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_13 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_13 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_13 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_13 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_13 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_13 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_13 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_13 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_13 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_13 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_13 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_13 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_13 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_13 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_13 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_13 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_13 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_13 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_13 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_13 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_13 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_13 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_13 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_13 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_13 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_13 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_13 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_13 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_13 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_13 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_13 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_13 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_13 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_13 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_13 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_13 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_13 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_13 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_13 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_13 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_13 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_13 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_13 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_13 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_13 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_13 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_13 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_13 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_13 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_13 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_13 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_13 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_13 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_13 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_13 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_13 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_13 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_13 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_13 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_13 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_13 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_13 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_13 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_13 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_13 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_13 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_13 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_13 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_13 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_13 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_13 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_13 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_13 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_13 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_13 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_13 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_13 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_13 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_13 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_13 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_13 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_13 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_13 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_13 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_13 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_13 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_13 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_13 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_13 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_13 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_13 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_13 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_13 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_13 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_13 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_13 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_13 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_13 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_13 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_13 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_13 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_13 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_13 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_13 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_13 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_13 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_13 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_13 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_13 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_13 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_13 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_13 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_13 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_13 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_13 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_13 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_13 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_13 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_13 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_13 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_13 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_13 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_13 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_13 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_13 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_13 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_13 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_13 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_13 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_13 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_13 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_13 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_13 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_13 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_13 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_13 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_13 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_13 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_13 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_13 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_13 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_13 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_13 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_13 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_13 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_13 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_13 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_13 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_13 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_13 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_13 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_13 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_13 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_13 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_13 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_13 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_13 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_13 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_13 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_13 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_13 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_13 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_13 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_13 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_13 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_13 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_13 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_13 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_13 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_13 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_13 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_13 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_13 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_13 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_13 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_13 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_13 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_13 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_13 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_13 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_13 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_13 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_13 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_13 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_13 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_13 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_13 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_13 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_13 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_13 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_13 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_13 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_13 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_13 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_13 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_13 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_13 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_13 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_13 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_13 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_13 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_13 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_13 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_13 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_13 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_13 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_13 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_13 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_13 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_13 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_13 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_13 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_13 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_13 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_13 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_13 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_13 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_13 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_13 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_13 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_13 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_13 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_13 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_13 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_13 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_13 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_13 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_13 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_13 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_13 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_13 [label="Layer Norm 13\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer14 {
		bgcolor=lightblue label="Layer 14 - Attention + MoE" style=rounded
		attn_norm_14 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_14 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_14 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_14 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_14 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_14 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_14 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_14 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_14 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_14 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_14 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_14 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_14 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_14 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_14 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_14 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_14 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_14 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_14 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_14 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_14 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_14 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_14 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_14 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_14 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_14 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_14 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_14 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_14 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_14 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_14 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_14 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_14 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_14 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_14 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_14 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_14 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_14 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_14 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_14 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_14 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_14 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_14 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_14 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_14 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_14 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_14 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_14 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_14 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_14 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_14 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_14 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_14 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_14 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_14 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_14 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_14 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_14 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_14 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_14 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_14 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_14 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_14 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_14 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_14 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_14 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_14 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_14 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_14 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_14 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_14 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_14 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_14 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_14 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_14 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_14 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_14 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_14 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_14 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_14 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_14 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_14 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_14 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_14 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_14 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_14 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_14 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_14 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_14 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_14 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_14 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_14 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_14 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_14 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_14 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_14 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_14 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_14 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_14 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_14 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_14 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_14 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_14 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_14 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_14 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_14 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_14 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_14 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_14 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_14 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_14 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_14 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_14 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_14 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_14 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_14 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_14 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_14 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_14 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_14 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_14 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_14 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_14 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_14 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_14 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_14 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_14 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_14 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_14 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_14 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_14 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_14 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_14 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_14 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_14 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_14 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_14 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_14 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_14 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_14 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_14 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_14 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_14 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_14 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_14 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_14 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_14 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_14 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_14 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_14 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_14 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_14 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_14 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_14 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_14 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_14 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_14 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_14 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_14 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_14 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_14 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_14 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_14 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_14 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_14 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_14 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_14 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_14 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_14 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_14 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_14 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_14 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_14 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_14 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_14 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_14 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_14 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_14 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_14 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_14 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_14 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_14 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_14 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_14 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_14 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_14 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_14 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_14 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_14 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_14 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_14 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_14 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_14 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_14 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_14 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_14 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_14 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_14 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_14 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_14 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_14 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_14 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_14 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_14 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_14 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_14 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_14 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_14 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_14 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_14 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_14 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_14 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_14 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_14 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_14 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_14 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_14 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_14 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_14 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_14 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_14 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_14 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_14 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_14 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_14 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_14 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_14 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_14 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_14 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_14 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_14 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_14 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_14 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_14 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_14 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_14 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_14 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_14 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_14 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_14 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_14 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_14 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_14 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_14 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_14 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_14 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_14 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_14 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_14 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_14 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_14 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_14 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_14 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_14 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_14 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_14 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_14 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_14 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_14 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_14 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_14 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_14 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_14 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_14 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_14 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_14 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_14 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_14 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_14 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_14 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_14 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_14 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_14 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_14 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_14 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_14 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_14 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_14 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_14 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_14 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_14 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_14 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_14 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_14 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_14 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_14 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_14 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_14 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_14 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_14 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_14 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_14 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_14 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_14 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_14 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_14 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_14 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_14 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_14 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_14 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_14 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_14 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_14 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_14 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_14 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_14 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_14 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_14 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_14 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_14 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_14 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_14 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_14 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_14 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_14 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_14 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_14 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_14 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_14 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_14 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_14 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_14 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_14 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_14 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_14 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_14 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_14 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_14 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_14 [label="Layer Norm 14\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer15 {
		bgcolor=lightblue label="Layer 15 - Attention + MoE" style=rounded
		attn_norm_15 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_15 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_15 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_15 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_15 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_15 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_15 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_15 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_15 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_15 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_15 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_15 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_15 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_15 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_15 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_15 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_15 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_15 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_15 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_15 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_15 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_15 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_15 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_15 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_15 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_15 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_15 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_15 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_15 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_15 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_15 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_15 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_15 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_15 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_15 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_15 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_15 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_15 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_15 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_15 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_15 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_15 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_15 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_15 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_15 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_15 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_15 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_15 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_15 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_15 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_15 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_15 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_15 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_15 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_15 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_15 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_15 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_15 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_15 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_15 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_15 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_15 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_15 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_15 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_15 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_15 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_15 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_15 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_15 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_15 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_15 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_15 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_15 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_15 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_15 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_15 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_15 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_15 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_15 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_15 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_15 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_15 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_15 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_15 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_15 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_15 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_15 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_15 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_15 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_15 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_15 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_15 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_15 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_15 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_15 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_15 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_15 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_15 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_15 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_15 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_15 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_15 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_15 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_15 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_15 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_15 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_15 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_15 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_15 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_15 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_15 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_15 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_15 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_15 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_15 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_15 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_15 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_15 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_15 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_15 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_15 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_15 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_15 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_15 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_15 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_15 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_15 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_15 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_15 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_15 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_15 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_15 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_15 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_15 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_15 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_15 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_15 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_15 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_15 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_15 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_15 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_15 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_15 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_15 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_15 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_15 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_15 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_15 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_15 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_15 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_15 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_15 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_15 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_15 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_15 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_15 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_15 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_15 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_15 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_15 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_15 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_15 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_15 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_15 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_15 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_15 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_15 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_15 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_15 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_15 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_15 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_15 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_15 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_15 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_15 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_15 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_15 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_15 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_15 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_15 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_15 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_15 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_15 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_15 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_15 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_15 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_15 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_15 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_15 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_15 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_15 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_15 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_15 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_15 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_15 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_15 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_15 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_15 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_15 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_15 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_15 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_15 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_15 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_15 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_15 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_15 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_15 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_15 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_15 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_15 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_15 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_15 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_15 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_15 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_15 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_15 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_15 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_15 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_15 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_15 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_15 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_15 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_15 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_15 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_15 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_15 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_15 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_15 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_15 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_15 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_15 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_15 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_15 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_15 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_15 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_15 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_15 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_15 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_15 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_15 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_15 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_15 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_15 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_15 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_15 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_15 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_15 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_15 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_15 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_15 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_15 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_15 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_15 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_15 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_15 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_15 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_15 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_15 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_15 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_15 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_15 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_15 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_15 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_15 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_15 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_15 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_15 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_15 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_15 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_15 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_15 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_15 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_15 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_15 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_15 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_15 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_15 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_15 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_15 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_15 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_15 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_15 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_15 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_15 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_15 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_15 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_15 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_15 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_15 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_15 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_15 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_15 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_15 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_15 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_15 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_15 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_15 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_15 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_15 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_15 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_15 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_15 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_15 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_15 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_15 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_15 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_15 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_15 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_15 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_15 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_15 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_15 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_15 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_15 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_15 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_15 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_15 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_15 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_15 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_15 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_15 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_15 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_15 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_15 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_15 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_15 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_15 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_15 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_15 [label="Layer Norm 15\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer16 {
		bgcolor=lightblue label="Layer 16 - Attention + MoE" style=rounded
		attn_norm_16 [label="Layer Norm (Attention)\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_q_16 [label="Q Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_k_16 [label="K Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_v_16 [label="V Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_score_16 [label="Attention Scores\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		attn_out_16 [label="Attention Output\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		moe_gate_16 [label="MoE Gate\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 64]" fillcolor=yellow shape=parallelogram]
		tp_split_0_16 [label="TP Split Expert 0\nGPU: 0-1\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_0_0_16 [label="Expert 0 Compute Part 0\nGPU: 0\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_0_1_16 [label="Expert 0 Compute Part 1\nGPU: 1\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_0_16 [label="TP All-Reduce Expert 0\nGPU: 0-1\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_0_16 [label="Expert 0 Output\nGPU: 0-1\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_1_16 [label="TP Split Expert 1\nGPU: 2-3\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_1_0_16 [label="Expert 1 Compute Part 0\nGPU: 2\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_1_1_16 [label="Expert 1 Compute Part 1\nGPU: 3\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_1_16 [label="TP All-Reduce Expert 1\nGPU: 2-3\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_1_16 [label="Expert 1 Output\nGPU: 2-3\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_2_16 [label="TP Split Expert 2\nGPU: 4-5\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_2_0_16 [label="Expert 2 Compute Part 0\nGPU: 4\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_2_1_16 [label="Expert 2 Compute Part 1\nGPU: 5\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_2_16 [label="TP All-Reduce Expert 2\nGPU: 4-5\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_2_16 [label="Expert 2 Output\nGPU: 4-5\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_3_16 [label="TP Split Expert 3\nGPU: 6-7\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_3_0_16 [label="Expert 3 Compute Part 0\nGPU: 6\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_3_1_16 [label="Expert 3 Compute Part 1\nGPU: 7\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_3_16 [label="TP All-Reduce Expert 3\nGPU: 6-7\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_3_16 [label="Expert 3 Output\nGPU: 6-7\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_4_16 [label="TP Split Expert 4\nGPU: 8-9\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_4_0_16 [label="Expert 4 Compute Part 0\nGPU: 8\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_4_1_16 [label="Expert 4 Compute Part 1\nGPU: 9\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_4_16 [label="TP All-Reduce Expert 4\nGPU: 8-9\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_4_16 [label="Expert 4 Output\nGPU: 8-9\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_5_16 [label="TP Split Expert 5\nGPU: 10-11\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_5_0_16 [label="Expert 5 Compute Part 0\nGPU: 10\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_5_1_16 [label="Expert 5 Compute Part 1\nGPU: 11\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_5_16 [label="TP All-Reduce Expert 5\nGPU: 10-11\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_5_16 [label="Expert 5 Output\nGPU: 10-11\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_6_16 [label="TP Split Expert 6\nGPU: 12-13\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_6_0_16 [label="Expert 6 Compute Part 0\nGPU: 12\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_6_1_16 [label="Expert 6 Compute Part 1\nGPU: 13\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_6_16 [label="TP All-Reduce Expert 6\nGPU: 12-13\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_6_16 [label="Expert 6 Output\nGPU: 12-13\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_7_16 [label="TP Split Expert 7\nGPU: 14-15\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_7_0_16 [label="Expert 7 Compute Part 0\nGPU: 14\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_7_1_16 [label="Expert 7 Compute Part 1\nGPU: 15\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_7_16 [label="TP All-Reduce Expert 7\nGPU: 14-15\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_7_16 [label="Expert 7 Output\nGPU: 14-15\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_8_16 [label="TP Split Expert 8\nGPU: 16-17\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_8_0_16 [label="Expert 8 Compute Part 0\nGPU: 16\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_8_1_16 [label="Expert 8 Compute Part 1\nGPU: 17\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_8_16 [label="TP All-Reduce Expert 8\nGPU: 16-17\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_8_16 [label="Expert 8 Output\nGPU: 16-17\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_9_16 [label="TP Split Expert 9\nGPU: 18-19\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_9_0_16 [label="Expert 9 Compute Part 0\nGPU: 18\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_9_1_16 [label="Expert 9 Compute Part 1\nGPU: 19\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_9_16 [label="TP All-Reduce Expert 9\nGPU: 18-19\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_9_16 [label="Expert 9 Output\nGPU: 18-19\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_10_16 [label="TP Split Expert 10\nGPU: 20-21\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_10_0_16 [label="Expert 10 Compute Part 0\nGPU: 20\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_10_1_16 [label="Expert 10 Compute Part 1\nGPU: 21\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_10_16 [label="TP All-Reduce Expert 10\nGPU: 20-21\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_10_16 [label="Expert 10 Output\nGPU: 20-21\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_11_16 [label="TP Split Expert 11\nGPU: 22-23\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_11_0_16 [label="Expert 11 Compute Part 0\nGPU: 22\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_11_1_16 [label="Expert 11 Compute Part 1\nGPU: 23\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_11_16 [label="TP All-Reduce Expert 11\nGPU: 22-23\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_11_16 [label="Expert 11 Output\nGPU: 22-23\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_12_16 [label="TP Split Expert 12\nGPU: 24-25\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_12_0_16 [label="Expert 12 Compute Part 0\nGPU: 24\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_12_1_16 [label="Expert 12 Compute Part 1\nGPU: 25\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_12_16 [label="TP All-Reduce Expert 12\nGPU: 24-25\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_12_16 [label="Expert 12 Output\nGPU: 24-25\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_13_16 [label="TP Split Expert 13\nGPU: 26-27\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_13_0_16 [label="Expert 13 Compute Part 0\nGPU: 26\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_13_1_16 [label="Expert 13 Compute Part 1\nGPU: 27\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_13_16 [label="TP All-Reduce Expert 13\nGPU: 26-27\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_13_16 [label="Expert 13 Output\nGPU: 26-27\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_14_16 [label="TP Split Expert 14\nGPU: 28-29\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_14_0_16 [label="Expert 14 Compute Part 0\nGPU: 28\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_14_1_16 [label="Expert 14 Compute Part 1\nGPU: 29\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_14_16 [label="TP All-Reduce Expert 14\nGPU: 28-29\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_14_16 [label="Expert 14 Output\nGPU: 28-29\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_15_16 [label="TP Split Expert 15\nGPU: 30-31\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_15_0_16 [label="Expert 15 Compute Part 0\nGPU: 30\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_15_1_16 [label="Expert 15 Compute Part 1\nGPU: 31\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_15_16 [label="TP All-Reduce Expert 15\nGPU: 30-31\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_15_16 [label="Expert 15 Output\nGPU: 30-31\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_16_16 [label="TP Split Expert 16\nGPU: 32-33\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_16_0_16 [label="Expert 16 Compute Part 0\nGPU: 32\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_16_1_16 [label="Expert 16 Compute Part 1\nGPU: 33\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_16_16 [label="TP All-Reduce Expert 16\nGPU: 32-33\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_16_16 [label="Expert 16 Output\nGPU: 32-33\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_17_16 [label="TP Split Expert 17\nGPU: 34-35\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_17_0_16 [label="Expert 17 Compute Part 0\nGPU: 34\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_17_1_16 [label="Expert 17 Compute Part 1\nGPU: 35\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_17_16 [label="TP All-Reduce Expert 17\nGPU: 34-35\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_17_16 [label="Expert 17 Output\nGPU: 34-35\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_18_16 [label="TP Split Expert 18\nGPU: 36-37\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_18_0_16 [label="Expert 18 Compute Part 0\nGPU: 36\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_18_1_16 [label="Expert 18 Compute Part 1\nGPU: 37\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_18_16 [label="TP All-Reduce Expert 18\nGPU: 36-37\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_18_16 [label="Expert 18 Output\nGPU: 36-37\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_19_16 [label="TP Split Expert 19\nGPU: 38-39\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_19_0_16 [label="Expert 19 Compute Part 0\nGPU: 38\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_19_1_16 [label="Expert 19 Compute Part 1\nGPU: 39\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_19_16 [label="TP All-Reduce Expert 19\nGPU: 38-39\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_19_16 [label="Expert 19 Output\nGPU: 38-39\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_20_16 [label="TP Split Expert 20\nGPU: 40-41\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_20_0_16 [label="Expert 20 Compute Part 0\nGPU: 40\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_20_1_16 [label="Expert 20 Compute Part 1\nGPU: 41\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_20_16 [label="TP All-Reduce Expert 20\nGPU: 40-41\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_20_16 [label="Expert 20 Output\nGPU: 40-41\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_21_16 [label="TP Split Expert 21\nGPU: 42-43\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_21_0_16 [label="Expert 21 Compute Part 0\nGPU: 42\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_21_1_16 [label="Expert 21 Compute Part 1\nGPU: 43\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_21_16 [label="TP All-Reduce Expert 21\nGPU: 42-43\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_21_16 [label="Expert 21 Output\nGPU: 42-43\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_22_16 [label="TP Split Expert 22\nGPU: 44-45\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_22_0_16 [label="Expert 22 Compute Part 0\nGPU: 44\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_22_1_16 [label="Expert 22 Compute Part 1\nGPU: 45\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_22_16 [label="TP All-Reduce Expert 22\nGPU: 44-45\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_22_16 [label="Expert 22 Output\nGPU: 44-45\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_23_16 [label="TP Split Expert 23\nGPU: 46-47\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_23_0_16 [label="Expert 23 Compute Part 0\nGPU: 46\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_23_1_16 [label="Expert 23 Compute Part 1\nGPU: 47\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_23_16 [label="TP All-Reduce Expert 23\nGPU: 46-47\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_23_16 [label="Expert 23 Output\nGPU: 46-47\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_24_16 [label="TP Split Expert 24\nGPU: 48-49\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_24_0_16 [label="Expert 24 Compute Part 0\nGPU: 48\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_24_1_16 [label="Expert 24 Compute Part 1\nGPU: 49\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_24_16 [label="TP All-Reduce Expert 24\nGPU: 48-49\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_24_16 [label="Expert 24 Output\nGPU: 48-49\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_25_16 [label="TP Split Expert 25\nGPU: 50-51\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_25_0_16 [label="Expert 25 Compute Part 0\nGPU: 50\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_25_1_16 [label="Expert 25 Compute Part 1\nGPU: 51\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_25_16 [label="TP All-Reduce Expert 25\nGPU: 50-51\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_25_16 [label="Expert 25 Output\nGPU: 50-51\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_26_16 [label="TP Split Expert 26\nGPU: 52-53\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_26_0_16 [label="Expert 26 Compute Part 0\nGPU: 52\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_26_1_16 [label="Expert 26 Compute Part 1\nGPU: 53\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_26_16 [label="TP All-Reduce Expert 26\nGPU: 52-53\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_26_16 [label="Expert 26 Output\nGPU: 52-53\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_27_16 [label="TP Split Expert 27\nGPU: 54-55\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_27_0_16 [label="Expert 27 Compute Part 0\nGPU: 54\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_27_1_16 [label="Expert 27 Compute Part 1\nGPU: 55\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_27_16 [label="TP All-Reduce Expert 27\nGPU: 54-55\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_27_16 [label="Expert 27 Output\nGPU: 54-55\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_28_16 [label="TP Split Expert 28\nGPU: 56-57\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_28_0_16 [label="Expert 28 Compute Part 0\nGPU: 56\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_28_1_16 [label="Expert 28 Compute Part 1\nGPU: 57\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_28_16 [label="TP All-Reduce Expert 28\nGPU: 56-57\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_28_16 [label="Expert 28 Output\nGPU: 56-57\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_29_16 [label="TP Split Expert 29\nGPU: 58-59\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_29_0_16 [label="Expert 29 Compute Part 0\nGPU: 58\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_29_1_16 [label="Expert 29 Compute Part 1\nGPU: 59\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_29_16 [label="TP All-Reduce Expert 29\nGPU: 58-59\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_29_16 [label="Expert 29 Output\nGPU: 58-59\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_30_16 [label="TP Split Expert 30\nGPU: 60-61\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_30_0_16 [label="Expert 30 Compute Part 0\nGPU: 60\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_30_1_16 [label="Expert 30 Compute Part 1\nGPU: 61\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_30_16 [label="TP All-Reduce Expert 30\nGPU: 60-61\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_30_16 [label="Expert 30 Output\nGPU: 60-61\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_31_16 [label="TP Split Expert 31\nGPU: 62-63\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_31_0_16 [label="Expert 31 Compute Part 0\nGPU: 62\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_31_1_16 [label="Expert 31 Compute Part 1\nGPU: 63\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_31_16 [label="TP All-Reduce Expert 31\nGPU: 62-63\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_31_16 [label="Expert 31 Output\nGPU: 62-63\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_32_16 [label="TP Split Expert 32\nGPU: 64-65\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_32_0_16 [label="Expert 32 Compute Part 0\nGPU: 64\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_32_1_16 [label="Expert 32 Compute Part 1\nGPU: 65\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_32_16 [label="TP All-Reduce Expert 32\nGPU: 64-65\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_32_16 [label="Expert 32 Output\nGPU: 64-65\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_33_16 [label="TP Split Expert 33\nGPU: 66-67\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_33_0_16 [label="Expert 33 Compute Part 0\nGPU: 66\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_33_1_16 [label="Expert 33 Compute Part 1\nGPU: 67\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_33_16 [label="TP All-Reduce Expert 33\nGPU: 66-67\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_33_16 [label="Expert 33 Output\nGPU: 66-67\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_34_16 [label="TP Split Expert 34\nGPU: 68-69\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_34_0_16 [label="Expert 34 Compute Part 0\nGPU: 68\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_34_1_16 [label="Expert 34 Compute Part 1\nGPU: 69\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_34_16 [label="TP All-Reduce Expert 34\nGPU: 68-69\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_34_16 [label="Expert 34 Output\nGPU: 68-69\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_35_16 [label="TP Split Expert 35\nGPU: 70-71\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_35_0_16 [label="Expert 35 Compute Part 0\nGPU: 70\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_35_1_16 [label="Expert 35 Compute Part 1\nGPU: 71\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_35_16 [label="TP All-Reduce Expert 35\nGPU: 70-71\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_35_16 [label="Expert 35 Output\nGPU: 70-71\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_36_16 [label="TP Split Expert 36\nGPU: 72-73\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_36_0_16 [label="Expert 36 Compute Part 0\nGPU: 72\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_36_1_16 [label="Expert 36 Compute Part 1\nGPU: 73\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_36_16 [label="TP All-Reduce Expert 36\nGPU: 72-73\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_36_16 [label="Expert 36 Output\nGPU: 72-73\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_37_16 [label="TP Split Expert 37\nGPU: 74-75\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_37_0_16 [label="Expert 37 Compute Part 0\nGPU: 74\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_37_1_16 [label="Expert 37 Compute Part 1\nGPU: 75\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_37_16 [label="TP All-Reduce Expert 37\nGPU: 74-75\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_37_16 [label="Expert 37 Output\nGPU: 74-75\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_38_16 [label="TP Split Expert 38\nGPU: 76-77\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_38_0_16 [label="Expert 38 Compute Part 0\nGPU: 76\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_38_1_16 [label="Expert 38 Compute Part 1\nGPU: 77\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_38_16 [label="TP All-Reduce Expert 38\nGPU: 76-77\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_38_16 [label="Expert 38 Output\nGPU: 76-77\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_39_16 [label="TP Split Expert 39\nGPU: 78-79\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_39_0_16 [label="Expert 39 Compute Part 0\nGPU: 78\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_39_1_16 [label="Expert 39 Compute Part 1\nGPU: 79\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_39_16 [label="TP All-Reduce Expert 39\nGPU: 78-79\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_39_16 [label="Expert 39 Output\nGPU: 78-79\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_40_16 [label="TP Split Expert 40\nGPU: 80-81\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_40_0_16 [label="Expert 40 Compute Part 0\nGPU: 80\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_40_1_16 [label="Expert 40 Compute Part 1\nGPU: 81\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_40_16 [label="TP All-Reduce Expert 40\nGPU: 80-81\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_40_16 [label="Expert 40 Output\nGPU: 80-81\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_41_16 [label="TP Split Expert 41\nGPU: 82-83\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_41_0_16 [label="Expert 41 Compute Part 0\nGPU: 82\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_41_1_16 [label="Expert 41 Compute Part 1\nGPU: 83\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_41_16 [label="TP All-Reduce Expert 41\nGPU: 82-83\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_41_16 [label="Expert 41 Output\nGPU: 82-83\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_42_16 [label="TP Split Expert 42\nGPU: 84-85\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_42_0_16 [label="Expert 42 Compute Part 0\nGPU: 84\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_42_1_16 [label="Expert 42 Compute Part 1\nGPU: 85\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_42_16 [label="TP All-Reduce Expert 42\nGPU: 84-85\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_42_16 [label="Expert 42 Output\nGPU: 84-85\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_43_16 [label="TP Split Expert 43\nGPU: 86-87\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_43_0_16 [label="Expert 43 Compute Part 0\nGPU: 86\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_43_1_16 [label="Expert 43 Compute Part 1\nGPU: 87\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_43_16 [label="TP All-Reduce Expert 43\nGPU: 86-87\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_43_16 [label="Expert 43 Output\nGPU: 86-87\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_44_16 [label="TP Split Expert 44\nGPU: 88-89\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_44_0_16 [label="Expert 44 Compute Part 0\nGPU: 88\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_44_1_16 [label="Expert 44 Compute Part 1\nGPU: 89\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_44_16 [label="TP All-Reduce Expert 44\nGPU: 88-89\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_44_16 [label="Expert 44 Output\nGPU: 88-89\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_45_16 [label="TP Split Expert 45\nGPU: 90-91\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_45_0_16 [label="Expert 45 Compute Part 0\nGPU: 90\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_45_1_16 [label="Expert 45 Compute Part 1\nGPU: 91\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_45_16 [label="TP All-Reduce Expert 45\nGPU: 90-91\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_45_16 [label="Expert 45 Output\nGPU: 90-91\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_46_16 [label="TP Split Expert 46\nGPU: 92-93\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_46_0_16 [label="Expert 46 Compute Part 0\nGPU: 92\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_46_1_16 [label="Expert 46 Compute Part 1\nGPU: 93\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_46_16 [label="TP All-Reduce Expert 46\nGPU: 92-93\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_46_16 [label="Expert 46 Output\nGPU: 92-93\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_47_16 [label="TP Split Expert 47\nGPU: 94-95\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_47_0_16 [label="Expert 47 Compute Part 0\nGPU: 94\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_47_1_16 [label="Expert 47 Compute Part 1\nGPU: 95\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_47_16 [label="TP All-Reduce Expert 47\nGPU: 94-95\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_47_16 [label="Expert 47 Output\nGPU: 94-95\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_48_16 [label="TP Split Expert 48\nGPU: 96-97\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_48_0_16 [label="Expert 48 Compute Part 0\nGPU: 96\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_48_1_16 [label="Expert 48 Compute Part 1\nGPU: 97\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_48_16 [label="TP All-Reduce Expert 48\nGPU: 96-97\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_48_16 [label="Expert 48 Output\nGPU: 96-97\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_49_16 [label="TP Split Expert 49\nGPU: 98-99\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_49_0_16 [label="Expert 49 Compute Part 0\nGPU: 98\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_49_1_16 [label="Expert 49 Compute Part 1\nGPU: 99\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_49_16 [label="TP All-Reduce Expert 49\nGPU: 98-99\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_49_16 [label="Expert 49 Output\nGPU: 98-99\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_50_16 [label="TP Split Expert 50\nGPU: 100-101\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_50_0_16 [label="Expert 50 Compute Part 0\nGPU: 100\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_50_1_16 [label="Expert 50 Compute Part 1\nGPU: 101\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_50_16 [label="TP All-Reduce Expert 50\nGPU: 100-101\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_50_16 [label="Expert 50 Output\nGPU: 100-101\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_51_16 [label="TP Split Expert 51\nGPU: 102-103\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_51_0_16 [label="Expert 51 Compute Part 0\nGPU: 102\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_51_1_16 [label="Expert 51 Compute Part 1\nGPU: 103\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_51_16 [label="TP All-Reduce Expert 51\nGPU: 102-103\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_51_16 [label="Expert 51 Output\nGPU: 102-103\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_52_16 [label="TP Split Expert 52\nGPU: 104-105\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_52_0_16 [label="Expert 52 Compute Part 0\nGPU: 104\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_52_1_16 [label="Expert 52 Compute Part 1\nGPU: 105\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_52_16 [label="TP All-Reduce Expert 52\nGPU: 104-105\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_52_16 [label="Expert 52 Output\nGPU: 104-105\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_53_16 [label="TP Split Expert 53\nGPU: 106-107\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_53_0_16 [label="Expert 53 Compute Part 0\nGPU: 106\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_53_1_16 [label="Expert 53 Compute Part 1\nGPU: 107\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_53_16 [label="TP All-Reduce Expert 53\nGPU: 106-107\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_53_16 [label="Expert 53 Output\nGPU: 106-107\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_54_16 [label="TP Split Expert 54\nGPU: 108-109\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_54_0_16 [label="Expert 54 Compute Part 0\nGPU: 108\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_54_1_16 [label="Expert 54 Compute Part 1\nGPU: 109\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_54_16 [label="TP All-Reduce Expert 54\nGPU: 108-109\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_54_16 [label="Expert 54 Output\nGPU: 108-109\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_55_16 [label="TP Split Expert 55\nGPU: 110-111\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_55_0_16 [label="Expert 55 Compute Part 0\nGPU: 110\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_55_1_16 [label="Expert 55 Compute Part 1\nGPU: 111\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_55_16 [label="TP All-Reduce Expert 55\nGPU: 110-111\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_55_16 [label="Expert 55 Output\nGPU: 110-111\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_56_16 [label="TP Split Expert 56\nGPU: 112-113\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_56_0_16 [label="Expert 56 Compute Part 0\nGPU: 112\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_56_1_16 [label="Expert 56 Compute Part 1\nGPU: 113\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_56_16 [label="TP All-Reduce Expert 56\nGPU: 112-113\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_56_16 [label="Expert 56 Output\nGPU: 112-113\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_57_16 [label="TP Split Expert 57\nGPU: 114-115\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_57_0_16 [label="Expert 57 Compute Part 0\nGPU: 114\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_57_1_16 [label="Expert 57 Compute Part 1\nGPU: 115\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_57_16 [label="TP All-Reduce Expert 57\nGPU: 114-115\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_57_16 [label="Expert 57 Output\nGPU: 114-115\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_58_16 [label="TP Split Expert 58\nGPU: 116-117\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_58_0_16 [label="Expert 58 Compute Part 0\nGPU: 116\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_58_1_16 [label="Expert 58 Compute Part 1\nGPU: 117\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_58_16 [label="TP All-Reduce Expert 58\nGPU: 116-117\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_58_16 [label="Expert 58 Output\nGPU: 116-117\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_59_16 [label="TP Split Expert 59\nGPU: 118-119\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_59_0_16 [label="Expert 59 Compute Part 0\nGPU: 118\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_59_1_16 [label="Expert 59 Compute Part 1\nGPU: 119\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_59_16 [label="TP All-Reduce Expert 59\nGPU: 118-119\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_59_16 [label="Expert 59 Output\nGPU: 118-119\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_60_16 [label="TP Split Expert 60\nGPU: 120-121\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_60_0_16 [label="Expert 60 Compute Part 0\nGPU: 120\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_60_1_16 [label="Expert 60 Compute Part 1\nGPU: 121\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_60_16 [label="TP All-Reduce Expert 60\nGPU: 120-121\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_60_16 [label="Expert 60 Output\nGPU: 120-121\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_61_16 [label="TP Split Expert 61\nGPU: 122-123\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_61_0_16 [label="Expert 61 Compute Part 0\nGPU: 122\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_61_1_16 [label="Expert 61 Compute Part 1\nGPU: 123\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_61_16 [label="TP All-Reduce Expert 61\nGPU: 122-123\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_61_16 [label="Expert 61 Output\nGPU: 122-123\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_62_16 [label="TP Split Expert 62\nGPU: 124-125\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_62_0_16 [label="Expert 62 Compute Part 0\nGPU: 124\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_62_1_16 [label="Expert 62 Compute Part 1\nGPU: 125\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_62_16 [label="TP All-Reduce Expert 62\nGPU: 124-125\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_62_16 [label="Expert 62 Output\nGPU: 124-125\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		tp_split_63_16 [label="TP Split Expert 63\nGPU: 126-127\nInput: [128, 1024, 16]\nOutput: [128, 1024, 8]" fillcolor=lightgreen shape=ellipse]
		expert_compute_63_0_16 [label="Expert 63 Compute Part 0\nGPU: 126\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		expert_compute_63_1_16 [label="Expert 63 Compute Part 1\nGPU: 127\nInput: [128, 1024, 8]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		tp_allreduce_63_16 [label="TP All-Reduce Expert 63\nGPU: 126-127\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 2048]" fillcolor=lightgreen shape=ellipse]
		expert_63_16 [label="Expert 63 Output\nGPU: 126-127\nInput: [128, 1024, 2048]\nOutput: [128, 1024, 2048]" fillcolor=lightblue shape=rectangle]
		expert_agg_16 [label="Expert Aggregation\nGPU: All 128 GPUs\nInput: [128, 1024, 2048] x 64\nOutput: [128, 1024, 1024]" fillcolor=yellow shape=parallelogram]
		layer_norm_16 [label="Layer Norm 16\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_output {
		bgcolor=lightgray label="Output Layer" style=rounded
		output_norm [label="Final Layer Norm\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, 1024]" fillcolor=lightblue shape=rectangle]
		output_proj [label="Output Projection\nGPU: All 128 GPUs\nInput: [128, 1024, 1024]\nOutput: [128, 1024, vocab_size]" fillcolor=lightblue shape=rectangle]
		output [label="Output Tokens\nGPU: All 128 GPUs\nInput: [128, 1024, vocab_size]\nOutput: [128, 1024]" fillcolor=lightcoral shape=rectangle]
	}
	input -> attn_norm_1 [label="Token embeddings"]
	attn_norm_1 -> attn_q_1
	attn_norm_1 -> attn_k_1
	attn_norm_1 -> attn_v_1
	attn_q_1 -> attn_score_1 [label="Q matrix"]
	attn_k_1 -> attn_score_1 [label="K matrix"]
	attn_v_1 -> attn_out_1 [label="V matrix"]
	attn_score_1 -> attn_out_1 [label="Attention weights"]
	attn_out_1 -> moe_gate_1 [label="Attention output"]
	moe_gate_1 -> tp_split_0_1 [label="Gate selection 0" style=dashed]
	tp_split_0_1 -> expert_compute_0_0_1
	tp_split_0_1 -> expert_compute_0_1_1
	expert_compute_0_0_1 -> tp_allreduce_0_1
	expert_compute_0_1_1 -> tp_allreduce_0_1
	tp_allreduce_0_1 -> expert_0_1
	expert_0_1 -> expert_agg_1 [label="Expert 0 output"]
	moe_gate_1 -> tp_split_1_1 [label="Gate selection 1" style=dashed]
	tp_split_1_1 -> expert_compute_1_0_1
	tp_split_1_1 -> expert_compute_1_1_1
	expert_compute_1_0_1 -> tp_allreduce_1_1
	expert_compute_1_1_1 -> tp_allreduce_1_1
	tp_allreduce_1_1 -> expert_1_1
	expert_1_1 -> expert_agg_1 [label="Expert 1 output"]
	moe_gate_1 -> tp_split_2_1 [label="Gate selection 2" style=dashed]
	tp_split_2_1 -> expert_compute_2_0_1
	tp_split_2_1 -> expert_compute_2_1_1
	expert_compute_2_0_1 -> tp_allreduce_2_1
	expert_compute_2_1_1 -> tp_allreduce_2_1
	tp_allreduce_2_1 -> expert_2_1
	expert_2_1 -> expert_agg_1 [label="Expert 2 output"]
	moe_gate_1 -> tp_split_3_1 [label="Gate selection 3" style=dashed]
	tp_split_3_1 -> expert_compute_3_0_1
	tp_split_3_1 -> expert_compute_3_1_1
	expert_compute_3_0_1 -> tp_allreduce_3_1
	expert_compute_3_1_1 -> tp_allreduce_3_1
	tp_allreduce_3_1 -> expert_3_1
	expert_3_1 -> expert_agg_1 [label="Expert 3 output"]
	moe_gate_1 -> tp_split_4_1 [label="Gate selection 4" style=dashed]
	tp_split_4_1 -> expert_compute_4_0_1
	tp_split_4_1 -> expert_compute_4_1_1
	expert_compute_4_0_1 -> tp_allreduce_4_1
	expert_compute_4_1_1 -> tp_allreduce_4_1
	tp_allreduce_4_1 -> expert_4_1
	expert_4_1 -> expert_agg_1 [label="Expert 4 output"]
	moe_gate_1 -> tp_split_5_1 [label="Gate selection 5" style=dashed]
	tp_split_5_1 -> expert_compute_5_0_1
	tp_split_5_1 -> expert_compute_5_1_1
	expert_compute_5_0_1 -> tp_allreduce_5_1
	expert_compute_5_1_1 -> tp_allreduce_5_1
	tp_allreduce_5_1 -> expert_5_1
	expert_5_1 -> expert_agg_1 [label="Expert 5 output"]
	moe_gate_1 -> tp_split_6_1 [label="Gate selection 6" style=dashed]
	tp_split_6_1 -> expert_compute_6_0_1
	tp_split_6_1 -> expert_compute_6_1_1
	expert_compute_6_0_1 -> tp_allreduce_6_1
	expert_compute_6_1_1 -> tp_allreduce_6_1
	tp_allreduce_6_1 -> expert_6_1
	expert_6_1 -> expert_agg_1 [label="Expert 6 output"]
	moe_gate_1 -> tp_split_7_1 [label="Gate selection 7" style=dashed]
	tp_split_7_1 -> expert_compute_7_0_1
	tp_split_7_1 -> expert_compute_7_1_1
	expert_compute_7_0_1 -> tp_allreduce_7_1
	expert_compute_7_1_1 -> tp_allreduce_7_1
	tp_allreduce_7_1 -> expert_7_1
	expert_7_1 -> expert_agg_1 [label="Expert 7 output"]
	moe_gate_1 -> tp_split_8_1 [label="Gate selection 8" style=dashed]
	tp_split_8_1 -> expert_compute_8_0_1
	tp_split_8_1 -> expert_compute_8_1_1
	expert_compute_8_0_1 -> tp_allreduce_8_1
	expert_compute_8_1_1 -> tp_allreduce_8_1
	tp_allreduce_8_1 -> expert_8_1
	expert_8_1 -> expert_agg_1 [label="Expert 8 output"]
	moe_gate_1 -> tp_split_9_1 [label="Gate selection 9" style=dashed]
	tp_split_9_1 -> expert_compute_9_0_1
	tp_split_9_1 -> expert_compute_9_1_1
	expert_compute_9_0_1 -> tp_allreduce_9_1
	expert_compute_9_1_1 -> tp_allreduce_9_1
	tp_allreduce_9_1 -> expert_9_1
	expert_9_1 -> expert_agg_1 [label="Expert 9 output"]
	moe_gate_1 -> tp_split_10_1 [label="Gate selection 10" style=dashed]
	tp_split_10_1 -> expert_compute_10_0_1
	tp_split_10_1 -> expert_compute_10_1_1
	expert_compute_10_0_1 -> tp_allreduce_10_1
	expert_compute_10_1_1 -> tp_allreduce_10_1
	tp_allreduce_10_1 -> expert_10_1
	expert_10_1 -> expert_agg_1 [label="Expert 10 output"]
	moe_gate_1 -> tp_split_11_1 [label="Gate selection 11" style=dashed]
	tp_split_11_1 -> expert_compute_11_0_1
	tp_split_11_1 -> expert_compute_11_1_1
	expert_compute_11_0_1 -> tp_allreduce_11_1
	expert_compute_11_1_1 -> tp_allreduce_11_1
	tp_allreduce_11_1 -> expert_11_1
	expert_11_1 -> expert_agg_1 [label="Expert 11 output"]
	moe_gate_1 -> tp_split_12_1 [label="Gate selection 12" style=dashed]
	tp_split_12_1 -> expert_compute_12_0_1
	tp_split_12_1 -> expert_compute_12_1_1
	expert_compute_12_0_1 -> tp_allreduce_12_1
	expert_compute_12_1_1 -> tp_allreduce_12_1
	tp_allreduce_12_1 -> expert_12_1
	expert_12_1 -> expert_agg_1 [label="Expert 12 output"]
	moe_gate_1 -> tp_split_13_1 [label="Gate selection 13" style=dashed]
	tp_split_13_1 -> expert_compute_13_0_1
	tp_split_13_1 -> expert_compute_13_1_1
	expert_compute_13_0_1 -> tp_allreduce_13_1
	expert_compute_13_1_1 -> tp_allreduce_13_1
	tp_allreduce_13_1 -> expert_13_1
	expert_13_1 -> expert_agg_1 [label="Expert 13 output"]
	moe_gate_1 -> tp_split_14_1 [label="Gate selection 14" style=dashed]
	tp_split_14_1 -> expert_compute_14_0_1
	tp_split_14_1 -> expert_compute_14_1_1
	expert_compute_14_0_1 -> tp_allreduce_14_1
	expert_compute_14_1_1 -> tp_allreduce_14_1
	tp_allreduce_14_1 -> expert_14_1
	expert_14_1 -> expert_agg_1 [label="Expert 14 output"]
	moe_gate_1 -> tp_split_15_1 [label="Gate selection 15" style=dashed]
	tp_split_15_1 -> expert_compute_15_0_1
	tp_split_15_1 -> expert_compute_15_1_1
	expert_compute_15_0_1 -> tp_allreduce_15_1
	expert_compute_15_1_1 -> tp_allreduce_15_1
	tp_allreduce_15_1 -> expert_15_1
	expert_15_1 -> expert_agg_1 [label="Expert 15 output"]
	moe_gate_1 -> tp_split_16_1 [label="Gate selection 16" style=dashed]
	tp_split_16_1 -> expert_compute_16_0_1
	tp_split_16_1 -> expert_compute_16_1_1
	expert_compute_16_0_1 -> tp_allreduce_16_1
	expert_compute_16_1_1 -> tp_allreduce_16_1
	tp_allreduce_16_1 -> expert_16_1
	expert_16_1 -> expert_agg_1 [label="Expert 16 output"]
	moe_gate_1 -> tp_split_17_1 [label="Gate selection 17" style=dashed]
	tp_split_17_1 -> expert_compute_17_0_1
	tp_split_17_1 -> expert_compute_17_1_1
	expert_compute_17_0_1 -> tp_allreduce_17_1
	expert_compute_17_1_1 -> tp_allreduce_17_1
	tp_allreduce_17_1 -> expert_17_1
	expert_17_1 -> expert_agg_1 [label="Expert 17 output"]
	moe_gate_1 -> tp_split_18_1 [label="Gate selection 18" style=dashed]
	tp_split_18_1 -> expert_compute_18_0_1
	tp_split_18_1 -> expert_compute_18_1_1
	expert_compute_18_0_1 -> tp_allreduce_18_1
	expert_compute_18_1_1 -> tp_allreduce_18_1
	tp_allreduce_18_1 -> expert_18_1
	expert_18_1 -> expert_agg_1 [label="Expert 18 output"]
	moe_gate_1 -> tp_split_19_1 [label="Gate selection 19" style=dashed]
	tp_split_19_1 -> expert_compute_19_0_1
	tp_split_19_1 -> expert_compute_19_1_1
	expert_compute_19_0_1 -> tp_allreduce_19_1
	expert_compute_19_1_1 -> tp_allreduce_19_1
	tp_allreduce_19_1 -> expert_19_1
	expert_19_1 -> expert_agg_1 [label="Expert 19 output"]
	moe_gate_1 -> tp_split_20_1 [label="Gate selection 20" style=dashed]
	tp_split_20_1 -> expert_compute_20_0_1
	tp_split_20_1 -> expert_compute_20_1_1
	expert_compute_20_0_1 -> tp_allreduce_20_1
	expert_compute_20_1_1 -> tp_allreduce_20_1
	tp_allreduce_20_1 -> expert_20_1
	expert_20_1 -> expert_agg_1 [label="Expert 20 output"]
	moe_gate_1 -> tp_split_21_1 [label="Gate selection 21" style=dashed]
	tp_split_21_1 -> expert_compute_21_0_1
	tp_split_21_1 -> expert_compute_21_1_1
	expert_compute_21_0_1 -> tp_allreduce_21_1
	expert_compute_21_1_1 -> tp_allreduce_21_1
	tp_allreduce_21_1 -> expert_21_1
	expert_21_1 -> expert_agg_1 [label="Expert 21 output"]
	moe_gate_1 -> tp_split_22_1 [label="Gate selection 22" style=dashed]
	tp_split_22_1 -> expert_compute_22_0_1
	tp_split_22_1 -> expert_compute_22_1_1
	expert_compute_22_0_1 -> tp_allreduce_22_1
	expert_compute_22_1_1 -> tp_allreduce_22_1
	tp_allreduce_22_1 -> expert_22_1
	expert_22_1 -> expert_agg_1 [label="Expert 22 output"]
	moe_gate_1 -> tp_split_23_1 [label="Gate selection 23" style=dashed]
	tp_split_23_1 -> expert_compute_23_0_1
	tp_split_23_1 -> expert_compute_23_1_1
	expert_compute_23_0_1 -> tp_allreduce_23_1
	expert_compute_23_1_1 -> tp_allreduce_23_1
	tp_allreduce_23_1 -> expert_23_1
	expert_23_1 -> expert_agg_1 [label="Expert 23 output"]
	moe_gate_1 -> tp_split_24_1 [label="Gate selection 24" style=dashed]
	tp_split_24_1 -> expert_compute_24_0_1
	tp_split_24_1 -> expert_compute_24_1_1
	expert_compute_24_0_1 -> tp_allreduce_24_1
	expert_compute_24_1_1 -> tp_allreduce_24_1
	tp_allreduce_24_1 -> expert_24_1
	expert_24_1 -> expert_agg_1 [label="Expert 24 output"]
	moe_gate_1 -> tp_split_25_1 [label="Gate selection 25" style=dashed]
	tp_split_25_1 -> expert_compute_25_0_1
	tp_split_25_1 -> expert_compute_25_1_1
	expert_compute_25_0_1 -> tp_allreduce_25_1
	expert_compute_25_1_1 -> tp_allreduce_25_1
	tp_allreduce_25_1 -> expert_25_1
	expert_25_1 -> expert_agg_1 [label="Expert 25 output"]
	moe_gate_1 -> tp_split_26_1 [label="Gate selection 26" style=dashed]
	tp_split_26_1 -> expert_compute_26_0_1
	tp_split_26_1 -> expert_compute_26_1_1
	expert_compute_26_0_1 -> tp_allreduce_26_1
	expert_compute_26_1_1 -> tp_allreduce_26_1
	tp_allreduce_26_1 -> expert_26_1
	expert_26_1 -> expert_agg_1 [label="Expert 26 output"]
	moe_gate_1 -> tp_split_27_1 [label="Gate selection 27" style=dashed]
	tp_split_27_1 -> expert_compute_27_0_1
	tp_split_27_1 -> expert_compute_27_1_1
	expert_compute_27_0_1 -> tp_allreduce_27_1
	expert_compute_27_1_1 -> tp_allreduce_27_1
	tp_allreduce_27_1 -> expert_27_1
	expert_27_1 -> expert_agg_1 [label="Expert 27 output"]
	moe_gate_1 -> tp_split_28_1 [label="Gate selection 28" style=dashed]
	tp_split_28_1 -> expert_compute_28_0_1
	tp_split_28_1 -> expert_compute_28_1_1
	expert_compute_28_0_1 -> tp_allreduce_28_1
	expert_compute_28_1_1 -> tp_allreduce_28_1
	tp_allreduce_28_1 -> expert_28_1
	expert_28_1 -> expert_agg_1 [label="Expert 28 output"]
	moe_gate_1 -> tp_split_29_1 [label="Gate selection 29" style=dashed]
	tp_split_29_1 -> expert_compute_29_0_1
	tp_split_29_1 -> expert_compute_29_1_1
	expert_compute_29_0_1 -> tp_allreduce_29_1
	expert_compute_29_1_1 -> tp_allreduce_29_1
	tp_allreduce_29_1 -> expert_29_1
	expert_29_1 -> expert_agg_1 [label="Expert 29 output"]
	moe_gate_1 -> tp_split_30_1 [label="Gate selection 30" style=dashed]
	tp_split_30_1 -> expert_compute_30_0_1
	tp_split_30_1 -> expert_compute_30_1_1
	expert_compute_30_0_1 -> tp_allreduce_30_1
	expert_compute_30_1_1 -> tp_allreduce_30_1
	tp_allreduce_30_1 -> expert_30_1
	expert_30_1 -> expert_agg_1 [label="Expert 30 output"]
	moe_gate_1 -> tp_split_31_1 [label="Gate selection 31" style=dashed]
	tp_split_31_1 -> expert_compute_31_0_1
	tp_split_31_1 -> expert_compute_31_1_1
	expert_compute_31_0_1 -> tp_allreduce_31_1
	expert_compute_31_1_1 -> tp_allreduce_31_1
	tp_allreduce_31_1 -> expert_31_1
	expert_31_1 -> expert_agg_1 [label="Expert 31 output"]
	moe_gate_1 -> tp_split_32_1 [label="Gate selection 32" style=dashed]
	tp_split_32_1 -> expert_compute_32_0_1
	tp_split_32_1 -> expert_compute_32_1_1
	expert_compute_32_0_1 -> tp_allreduce_32_1
	expert_compute_32_1_1 -> tp_allreduce_32_1
	tp_allreduce_32_1 -> expert_32_1
	expert_32_1 -> expert_agg_1 [label="Expert 32 output"]
	moe_gate_1 -> tp_split_33_1 [label="Gate selection 33" style=dashed]
	tp_split_33_1 -> expert_compute_33_0_1
	tp_split_33_1 -> expert_compute_33_1_1
	expert_compute_33_0_1 -> tp_allreduce_33_1
	expert_compute_33_1_1 -> tp_allreduce_33_1
	tp_allreduce_33_1 -> expert_33_1
	expert_33_1 -> expert_agg_1 [label="Expert 33 output"]
	moe_gate_1 -> tp_split_34_1 [label="Gate selection 34" style=dashed]
	tp_split_34_1 -> expert_compute_34_0_1
	tp_split_34_1 -> expert_compute_34_1_1
	expert_compute_34_0_1 -> tp_allreduce_34_1
	expert_compute_34_1_1 -> tp_allreduce_34_1
	tp_allreduce_34_1 -> expert_34_1
	expert_34_1 -> expert_agg_1 [label="Expert 34 output"]
	moe_gate_1 -> tp_split_35_1 [label="Gate selection 35" style=dashed]
	tp_split_35_1 -> expert_compute_35_0_1
	tp_split_35_1 -> expert_compute_35_1_1
	expert_compute_35_0_1 -> tp_allreduce_35_1
	expert_compute_35_1_1 -> tp_allreduce_35_1
	tp_allreduce_35_1 -> expert_35_1
	expert_35_1 -> expert_agg_1 [label="Expert 35 output"]
	moe_gate_1 -> tp_split_36_1 [label="Gate selection 36" style=dashed]
	tp_split_36_1 -> expert_compute_36_0_1
	tp_split_36_1 -> expert_compute_36_1_1
	expert_compute_36_0_1 -> tp_allreduce_36_1
	expert_compute_36_1_1 -> tp_allreduce_36_1
	tp_allreduce_36_1 -> expert_36_1
	expert_36_1 -> expert_agg_1 [label="Expert 36 output"]
	moe_gate_1 -> tp_split_37_1 [label="Gate selection 37" style=dashed]
	tp_split_37_1 -> expert_compute_37_0_1
	tp_split_37_1 -> expert_compute_37_1_1
	expert_compute_37_0_1 -> tp_allreduce_37_1
	expert_compute_37_1_1 -> tp_allreduce_37_1
	tp_allreduce_37_1 -> expert_37_1
	expert_37_1 -> expert_agg_1 [label="Expert 37 output"]
	moe_gate_1 -> tp_split_38_1 [label="Gate selection 38" style=dashed]
	tp_split_38_1 -> expert_compute_38_0_1
	tp_split_38_1 -> expert_compute_38_1_1
	expert_compute_38_0_1 -> tp_allreduce_38_1
	expert_compute_38_1_1 -> tp_allreduce_38_1
	tp_allreduce_38_1 -> expert_38_1
	expert_38_1 -> expert_agg_1 [label="Expert 38 output"]
	moe_gate_1 -> tp_split_39_1 [label="Gate selection 39" style=dashed]
	tp_split_39_1 -> expert_compute_39_0_1
	tp_split_39_1 -> expert_compute_39_1_1
	expert_compute_39_0_1 -> tp_allreduce_39_1
	expert_compute_39_1_1 -> tp_allreduce_39_1
	tp_allreduce_39_1 -> expert_39_1
	expert_39_1 -> expert_agg_1 [label="Expert 39 output"]
	moe_gate_1 -> tp_split_40_1 [label="Gate selection 40" style=dashed]
	tp_split_40_1 -> expert_compute_40_0_1
	tp_split_40_1 -> expert_compute_40_1_1
	expert_compute_40_0_1 -> tp_allreduce_40_1
	expert_compute_40_1_1 -> tp_allreduce_40_1
	tp_allreduce_40_1 -> expert_40_1
	expert_40_1 -> expert_agg_1 [label="Expert 40 output"]
	moe_gate_1 -> tp_split_41_1 [label="Gate selection 41" style=dashed]
	tp_split_41_1 -> expert_compute_41_0_1
	tp_split_41_1 -> expert_compute_41_1_1
	expert_compute_41_0_1 -> tp_allreduce_41_1
	expert_compute_41_1_1 -> tp_allreduce_41_1
	tp_allreduce_41_1 -> expert_41_1
	expert_41_1 -> expert_agg_1 [label="Expert 41 output"]
	moe_gate_1 -> tp_split_42_1 [label="Gate selection 42" style=dashed]
	tp_split_42_1 -> expert_compute_42_0_1
	tp_split_42_1 -> expert_compute_42_1_1
	expert_compute_42_0_1 -> tp_allreduce_42_1
	expert_compute_42_1_1 -> tp_allreduce_42_1
	tp_allreduce_42_1 -> expert_42_1
	expert_42_1 -> expert_agg_1 [label="Expert 42 output"]
	moe_gate_1 -> tp_split_43_1 [label="Gate selection 43" style=dashed]
	tp_split_43_1 -> expert_compute_43_0_1
	tp_split_43_1 -> expert_compute_43_1_1
	expert_compute_43_0_1 -> tp_allreduce_43_1
	expert_compute_43_1_1 -> tp_allreduce_43_1
	tp_allreduce_43_1 -> expert_43_1
	expert_43_1 -> expert_agg_1 [label="Expert 43 output"]
	moe_gate_1 -> tp_split_44_1 [label="Gate selection 44" style=dashed]
	tp_split_44_1 -> expert_compute_44_0_1
	tp_split_44_1 -> expert_compute_44_1_1
	expert_compute_44_0_1 -> tp_allreduce_44_1
	expert_compute_44_1_1 -> tp_allreduce_44_1
	tp_allreduce_44_1 -> expert_44_1
	expert_44_1 -> expert_agg_1 [label="Expert 44 output"]
	moe_gate_1 -> tp_split_45_1 [label="Gate selection 45" style=dashed]
	tp_split_45_1 -> expert_compute_45_0_1
	tp_split_45_1 -> expert_compute_45_1_1
	expert_compute_45_0_1 -> tp_allreduce_45_1
	expert_compute_45_1_1 -> tp_allreduce_45_1
	tp_allreduce_45_1 -> expert_45_1
	expert_45_1 -> expert_agg_1 [label="Expert 45 output"]
	moe_gate_1 -> tp_split_46_1 [label="Gate selection 46" style=dashed]
	tp_split_46_1 -> expert_compute_46_0_1
	tp_split_46_1 -> expert_compute_46_1_1
	expert_compute_46_0_1 -> tp_allreduce_46_1
	expert_compute_46_1_1 -> tp_allreduce_46_1
	tp_allreduce_46_1 -> expert_46_1
	expert_46_1 -> expert_agg_1 [label="Expert 46 output"]
	moe_gate_1 -> tp_split_47_1 [label="Gate selection 47" style=dashed]
	tp_split_47_1 -> expert_compute_47_0_1
	tp_split_47_1 -> expert_compute_47_1_1
	expert_compute_47_0_1 -> tp_allreduce_47_1
	expert_compute_47_1_1 -> tp_allreduce_47_1
	tp_allreduce_47_1 -> expert_47_1
	expert_47_1 -> expert_agg_1 [label="Expert 47 output"]
	moe_gate_1 -> tp_split_48_1 [label="Gate selection 48" style=dashed]
	tp_split_48_1 -> expert_compute_48_0_1
	tp_split_48_1 -> expert_compute_48_1_1
	expert_compute_48_0_1 -> tp_allreduce_48_1
	expert_compute_48_1_1 -> tp_allreduce_48_1
	tp_allreduce_48_1 -> expert_48_1
	expert_48_1 -> expert_agg_1 [label="Expert 48 output"]
	moe_gate_1 -> tp_split_49_1 [label="Gate selection 49" style=dashed]
	tp_split_49_1 -> expert_compute_49_0_1
	tp_split_49_1 -> expert_compute_49_1_1
	expert_compute_49_0_1 -> tp_allreduce_49_1
	expert_compute_49_1_1 -> tp_allreduce_49_1
	tp_allreduce_49_1 -> expert_49_1
	expert_49_1 -> expert_agg_1 [label="Expert 49 output"]
	moe_gate_1 -> tp_split_50_1 [label="Gate selection 50" style=dashed]
	tp_split_50_1 -> expert_compute_50_0_1
	tp_split_50_1 -> expert_compute_50_1_1
	expert_compute_50_0_1 -> tp_allreduce_50_1
	expert_compute_50_1_1 -> tp_allreduce_50_1
	tp_allreduce_50_1 -> expert_50_1
	expert_50_1 -> expert_agg_1 [label="Expert 50 output"]
	moe_gate_1 -> tp_split_51_1 [label="Gate selection 51" style=dashed]
	tp_split_51_1 -> expert_compute_51_0_1
	tp_split_51_1 -> expert_compute_51_1_1
	expert_compute_51_0_1 -> tp_allreduce_51_1
	expert_compute_51_1_1 -> tp_allreduce_51_1
	tp_allreduce_51_1 -> expert_51_1
	expert_51_1 -> expert_agg_1 [label="Expert 51 output"]
	moe_gate_1 -> tp_split_52_1 [label="Gate selection 52" style=dashed]
	tp_split_52_1 -> expert_compute_52_0_1
	tp_split_52_1 -> expert_compute_52_1_1
	expert_compute_52_0_1 -> tp_allreduce_52_1
	expert_compute_52_1_1 -> tp_allreduce_52_1
	tp_allreduce_52_1 -> expert_52_1
	expert_52_1 -> expert_agg_1 [label="Expert 52 output"]
	moe_gate_1 -> tp_split_53_1 [label="Gate selection 53" style=dashed]
	tp_split_53_1 -> expert_compute_53_0_1
	tp_split_53_1 -> expert_compute_53_1_1
	expert_compute_53_0_1 -> tp_allreduce_53_1
	expert_compute_53_1_1 -> tp_allreduce_53_1
	tp_allreduce_53_1 -> expert_53_1
	expert_53_1 -> expert_agg_1 [label="Expert 53 output"]
	moe_gate_1 -> tp_split_54_1 [label="Gate selection 54" style=dashed]
	tp_split_54_1 -> expert_compute_54_0_1
	tp_split_54_1 -> expert_compute_54_1_1
	expert_compute_54_0_1 -> tp_allreduce_54_1
	expert_compute_54_1_1 -> tp_allreduce_54_1
	tp_allreduce_54_1 -> expert_54_1
	expert_54_1 -> expert_agg_1 [label="Expert 54 output"]
	moe_gate_1 -> tp_split_55_1 [label="Gate selection 55" style=dashed]
	tp_split_55_1 -> expert_compute_55_0_1
	tp_split_55_1 -> expert_compute_55_1_1
	expert_compute_55_0_1 -> tp_allreduce_55_1
	expert_compute_55_1_1 -> tp_allreduce_55_1
	tp_allreduce_55_1 -> expert_55_1
	expert_55_1 -> expert_agg_1 [label="Expert 55 output"]
	moe_gate_1 -> tp_split_56_1 [label="Gate selection 56" style=dashed]
	tp_split_56_1 -> expert_compute_56_0_1
	tp_split_56_1 -> expert_compute_56_1_1
	expert_compute_56_0_1 -> tp_allreduce_56_1
	expert_compute_56_1_1 -> tp_allreduce_56_1
	tp_allreduce_56_1 -> expert_56_1
	expert_56_1 -> expert_agg_1 [label="Expert 56 output"]
	moe_gate_1 -> tp_split_57_1 [label="Gate selection 57" style=dashed]
	tp_split_57_1 -> expert_compute_57_0_1
	tp_split_57_1 -> expert_compute_57_1_1
	expert_compute_57_0_1 -> tp_allreduce_57_1
	expert_compute_57_1_1 -> tp_allreduce_57_1
	tp_allreduce_57_1 -> expert_57_1
	expert_57_1 -> expert_agg_1 [label="Expert 57 output"]
	moe_gate_1 -> tp_split_58_1 [label="Gate selection 58" style=dashed]
	tp_split_58_1 -> expert_compute_58_0_1
	tp_split_58_1 -> expert_compute_58_1_1
	expert_compute_58_0_1 -> tp_allreduce_58_1
	expert_compute_58_1_1 -> tp_allreduce_58_1
	tp_allreduce_58_1 -> expert_58_1
	expert_58_1 -> expert_agg_1 [label="Expert 58 output"]
	moe_gate_1 -> tp_split_59_1 [label="Gate selection 59" style=dashed]
	tp_split_59_1 -> expert_compute_59_0_1
	tp_split_59_1 -> expert_compute_59_1_1
	expert_compute_59_0_1 -> tp_allreduce_59_1
	expert_compute_59_1_1 -> tp_allreduce_59_1
	tp_allreduce_59_1 -> expert_59_1
	expert_59_1 -> expert_agg_1 [label="Expert 59 output"]
	moe_gate_1 -> tp_split_60_1 [label="Gate selection 60" style=dashed]
	tp_split_60_1 -> expert_compute_60_0_1
	tp_split_60_1 -> expert_compute_60_1_1
	expert_compute_60_0_1 -> tp_allreduce_60_1
	expert_compute_60_1_1 -> tp_allreduce_60_1
	tp_allreduce_60_1 -> expert_60_1
	expert_60_1 -> expert_agg_1 [label="Expert 60 output"]
	moe_gate_1 -> tp_split_61_1 [label="Gate selection 61" style=dashed]
	tp_split_61_1 -> expert_compute_61_0_1
	tp_split_61_1 -> expert_compute_61_1_1
	expert_compute_61_0_1 -> tp_allreduce_61_1
	expert_compute_61_1_1 -> tp_allreduce_61_1
	tp_allreduce_61_1 -> expert_61_1
	expert_61_1 -> expert_agg_1 [label="Expert 61 output"]
	moe_gate_1 -> tp_split_62_1 [label="Gate selection 62" style=dashed]
	tp_split_62_1 -> expert_compute_62_0_1
	tp_split_62_1 -> expert_compute_62_1_1
	expert_compute_62_0_1 -> tp_allreduce_62_1
	expert_compute_62_1_1 -> tp_allreduce_62_1
	tp_allreduce_62_1 -> expert_62_1
	expert_62_1 -> expert_agg_1 [label="Expert 62 output"]
	moe_gate_1 -> tp_split_63_1 [label="Gate selection 63" style=dashed]
	tp_split_63_1 -> expert_compute_63_0_1
	tp_split_63_1 -> expert_compute_63_1_1
	expert_compute_63_0_1 -> tp_allreduce_63_1
	expert_compute_63_1_1 -> tp_allreduce_63_1
	tp_allreduce_63_1 -> expert_63_1
	expert_63_1 -> expert_agg_1 [label="Expert 63 output"]
	expert_agg_1 -> layer_norm_1
	layer_norm_1 -> attn_norm_2
	attn_norm_2 -> attn_q_2
	attn_norm_2 -> attn_k_2
	attn_norm_2 -> attn_v_2
	attn_q_2 -> attn_score_2
	attn_k_2 -> attn_score_2
	attn_v_2 -> attn_out_2
	attn_score_2 -> attn_out_2
	attn_out_2 -> moe_gate_2
	moe_gate_2 -> tp_split_0_2 [label="Gate selection 0" style=dashed]
	tp_split_0_2 -> expert_compute_0_0_2
	tp_split_0_2 -> expert_compute_0_1_2
	expert_compute_0_0_2 -> tp_allreduce_0_2
	expert_compute_0_1_2 -> tp_allreduce_0_2
	tp_allreduce_0_2 -> expert_0_2
	expert_0_2 -> expert_agg_2 [label="Expert 0 output"]
	moe_gate_2 -> tp_split_1_2 [label="Gate selection 1" style=dashed]
	tp_split_1_2 -> expert_compute_1_0_2
	tp_split_1_2 -> expert_compute_1_1_2
	expert_compute_1_0_2 -> tp_allreduce_1_2
	expert_compute_1_1_2 -> tp_allreduce_1_2
	tp_allreduce_1_2 -> expert_1_2
	expert_1_2 -> expert_agg_2 [label="Expert 1 output"]
	moe_gate_2 -> tp_split_2_2 [label="Gate selection 2" style=dashed]
	tp_split_2_2 -> expert_compute_2_0_2
	tp_split_2_2 -> expert_compute_2_1_2
	expert_compute_2_0_2 -> tp_allreduce_2_2
	expert_compute_2_1_2 -> tp_allreduce_2_2
	tp_allreduce_2_2 -> expert_2_2
	expert_2_2 -> expert_agg_2 [label="Expert 2 output"]
	moe_gate_2 -> tp_split_3_2 [label="Gate selection 3" style=dashed]
	tp_split_3_2 -> expert_compute_3_0_2
	tp_split_3_2 -> expert_compute_3_1_2
	expert_compute_3_0_2 -> tp_allreduce_3_2
	expert_compute_3_1_2 -> tp_allreduce_3_2
	tp_allreduce_3_2 -> expert_3_2
	expert_3_2 -> expert_agg_2 [label="Expert 3 output"]
	moe_gate_2 -> tp_split_4_2 [label="Gate selection 4" style=dashed]
	tp_split_4_2 -> expert_compute_4_0_2
	tp_split_4_2 -> expert_compute_4_1_2
	expert_compute_4_0_2 -> tp_allreduce_4_2
	expert_compute_4_1_2 -> tp_allreduce_4_2
	tp_allreduce_4_2 -> expert_4_2
	expert_4_2 -> expert_agg_2 [label="Expert 4 output"]
	moe_gate_2 -> tp_split_5_2 [label="Gate selection 5" style=dashed]
	tp_split_5_2 -> expert_compute_5_0_2
	tp_split_5_2 -> expert_compute_5_1_2
	expert_compute_5_0_2 -> tp_allreduce_5_2
	expert_compute_5_1_2 -> tp_allreduce_5_2
	tp_allreduce_5_2 -> expert_5_2
	expert_5_2 -> expert_agg_2 [label="Expert 5 output"]
	moe_gate_2 -> tp_split_6_2 [label="Gate selection 6" style=dashed]
	tp_split_6_2 -> expert_compute_6_0_2
	tp_split_6_2 -> expert_compute_6_1_2
	expert_compute_6_0_2 -> tp_allreduce_6_2
	expert_compute_6_1_2 -> tp_allreduce_6_2
	tp_allreduce_6_2 -> expert_6_2
	expert_6_2 -> expert_agg_2 [label="Expert 6 output"]
	moe_gate_2 -> tp_split_7_2 [label="Gate selection 7" style=dashed]
	tp_split_7_2 -> expert_compute_7_0_2
	tp_split_7_2 -> expert_compute_7_1_2
	expert_compute_7_0_2 -> tp_allreduce_7_2
	expert_compute_7_1_2 -> tp_allreduce_7_2
	tp_allreduce_7_2 -> expert_7_2
	expert_7_2 -> expert_agg_2 [label="Expert 7 output"]
	moe_gate_2 -> tp_split_8_2 [label="Gate selection 8" style=dashed]
	tp_split_8_2 -> expert_compute_8_0_2
	tp_split_8_2 -> expert_compute_8_1_2
	expert_compute_8_0_2 -> tp_allreduce_8_2
	expert_compute_8_1_2 -> tp_allreduce_8_2
	tp_allreduce_8_2 -> expert_8_2
	expert_8_2 -> expert_agg_2 [label="Expert 8 output"]
	moe_gate_2 -> tp_split_9_2 [label="Gate selection 9" style=dashed]
	tp_split_9_2 -> expert_compute_9_0_2
	tp_split_9_2 -> expert_compute_9_1_2
	expert_compute_9_0_2 -> tp_allreduce_9_2
	expert_compute_9_1_2 -> tp_allreduce_9_2
	tp_allreduce_9_2 -> expert_9_2
	expert_9_2 -> expert_agg_2 [label="Expert 9 output"]
	moe_gate_2 -> tp_split_10_2 [label="Gate selection 10" style=dashed]
	tp_split_10_2 -> expert_compute_10_0_2
	tp_split_10_2 -> expert_compute_10_1_2
	expert_compute_10_0_2 -> tp_allreduce_10_2
	expert_compute_10_1_2 -> tp_allreduce_10_2
	tp_allreduce_10_2 -> expert_10_2
	expert_10_2 -> expert_agg_2 [label="Expert 10 output"]
	moe_gate_2 -> tp_split_11_2 [label="Gate selection 11" style=dashed]
	tp_split_11_2 -> expert_compute_11_0_2
	tp_split_11_2 -> expert_compute_11_1_2
	expert_compute_11_0_2 -> tp_allreduce_11_2
	expert_compute_11_1_2 -> tp_allreduce_11_2
	tp_allreduce_11_2 -> expert_11_2
	expert_11_2 -> expert_agg_2 [label="Expert 11 output"]
	moe_gate_2 -> tp_split_12_2 [label="Gate selection 12" style=dashed]
	tp_split_12_2 -> expert_compute_12_0_2
	tp_split_12_2 -> expert_compute_12_1_2
	expert_compute_12_0_2 -> tp_allreduce_12_2
	expert_compute_12_1_2 -> tp_allreduce_12_2
	tp_allreduce_12_2 -> expert_12_2
	expert_12_2 -> expert_agg_2 [label="Expert 12 output"]
	moe_gate_2 -> tp_split_13_2 [label="Gate selection 13" style=dashed]
	tp_split_13_2 -> expert_compute_13_0_2
	tp_split_13_2 -> expert_compute_13_1_2
	expert_compute_13_0_2 -> tp_allreduce_13_2
	expert_compute_13_1_2 -> tp_allreduce_13_2
	tp_allreduce_13_2 -> expert_13_2
	expert_13_2 -> expert_agg_2 [label="Expert 13 output"]
	moe_gate_2 -> tp_split_14_2 [label="Gate selection 14" style=dashed]
	tp_split_14_2 -> expert_compute_14_0_2
	tp_split_14_2 -> expert_compute_14_1_2
	expert_compute_14_0_2 -> tp_allreduce_14_2
	expert_compute_14_1_2 -> tp_allreduce_14_2
	tp_allreduce_14_2 -> expert_14_2
	expert_14_2 -> expert_agg_2 [label="Expert 14 output"]
	moe_gate_2 -> tp_split_15_2 [label="Gate selection 15" style=dashed]
	tp_split_15_2 -> expert_compute_15_0_2
	tp_split_15_2 -> expert_compute_15_1_2
	expert_compute_15_0_2 -> tp_allreduce_15_2
	expert_compute_15_1_2 -> tp_allreduce_15_2
	tp_allreduce_15_2 -> expert_15_2
	expert_15_2 -> expert_agg_2 [label="Expert 15 output"]
	moe_gate_2 -> tp_split_16_2 [label="Gate selection 16" style=dashed]
	tp_split_16_2 -> expert_compute_16_0_2
	tp_split_16_2 -> expert_compute_16_1_2
	expert_compute_16_0_2 -> tp_allreduce_16_2
	expert_compute_16_1_2 -> tp_allreduce_16_2
	tp_allreduce_16_2 -> expert_16_2
	expert_16_2 -> expert_agg_2 [label="Expert 16 output"]
	moe_gate_2 -> tp_split_17_2 [label="Gate selection 17" style=dashed]
	tp_split_17_2 -> expert_compute_17_0_2
	tp_split_17_2 -> expert_compute_17_1_2
	expert_compute_17_0_2 -> tp_allreduce_17_2
	expert_compute_17_1_2 -> tp_allreduce_17_2
	tp_allreduce_17_2 -> expert_17_2
	expert_17_2 -> expert_agg_2 [label="Expert 17 output"]
	moe_gate_2 -> tp_split_18_2 [label="Gate selection 18" style=dashed]
	tp_split_18_2 -> expert_compute_18_0_2
	tp_split_18_2 -> expert_compute_18_1_2
	expert_compute_18_0_2 -> tp_allreduce_18_2
	expert_compute_18_1_2 -> tp_allreduce_18_2
	tp_allreduce_18_2 -> expert_18_2
	expert_18_2 -> expert_agg_2 [label="Expert 18 output"]
	moe_gate_2 -> tp_split_19_2 [label="Gate selection 19" style=dashed]
	tp_split_19_2 -> expert_compute_19_0_2
	tp_split_19_2 -> expert_compute_19_1_2
	expert_compute_19_0_2 -> tp_allreduce_19_2
	expert_compute_19_1_2 -> tp_allreduce_19_2
	tp_allreduce_19_2 -> expert_19_2
	expert_19_2 -> expert_agg_2 [label="Expert 19 output"]
	moe_gate_2 -> tp_split_20_2 [label="Gate selection 20" style=dashed]
	tp_split_20_2 -> expert_compute_20_0_2
	tp_split_20_2 -> expert_compute_20_1_2
	expert_compute_20_0_2 -> tp_allreduce_20_2
	expert_compute_20_1_2 -> tp_allreduce_20_2
	tp_allreduce_20_2 -> expert_20_2
	expert_20_2 -> expert_agg_2 [label="Expert 20 output"]
	moe_gate_2 -> tp_split_21_2 [label="Gate selection 21" style=dashed]
	tp_split_21_2 -> expert_compute_21_0_2
	tp_split_21_2 -> expert_compute_21_1_2
	expert_compute_21_0_2 -> tp_allreduce_21_2
	expert_compute_21_1_2 -> tp_allreduce_21_2
	tp_allreduce_21_2 -> expert_21_2
	expert_21_2 -> expert_agg_2 [label="Expert 21 output"]
	moe_gate_2 -> tp_split_22_2 [label="Gate selection 22" style=dashed]
	tp_split_22_2 -> expert_compute_22_0_2
	tp_split_22_2 -> expert_compute_22_1_2
	expert_compute_22_0_2 -> tp_allreduce_22_2
	expert_compute_22_1_2 -> tp_allreduce_22_2
	tp_allreduce_22_2 -> expert_22_2
	expert_22_2 -> expert_agg_2 [label="Expert 22 output"]
	moe_gate_2 -> tp_split_23_2 [label="Gate selection 23" style=dashed]
	tp_split_23_2 -> expert_compute_23_0_2
	tp_split_23_2 -> expert_compute_23_1_2
	expert_compute_23_0_2 -> tp_allreduce_23_2
	expert_compute_23_1_2 -> tp_allreduce_23_2
	tp_allreduce_23_2 -> expert_23_2
	expert_23_2 -> expert_agg_2 [label="Expert 23 output"]
	moe_gate_2 -> tp_split_24_2 [label="Gate selection 24" style=dashed]
	tp_split_24_2 -> expert_compute_24_0_2
	tp_split_24_2 -> expert_compute_24_1_2
	expert_compute_24_0_2 -> tp_allreduce_24_2
	expert_compute_24_1_2 -> tp_allreduce_24_2
	tp_allreduce_24_2 -> expert_24_2
	expert_24_2 -> expert_agg_2 [label="Expert 24 output"]
	moe_gate_2 -> tp_split_25_2 [label="Gate selection 25" style=dashed]
	tp_split_25_2 -> expert_compute_25_0_2
	tp_split_25_2 -> expert_compute_25_1_2
	expert_compute_25_0_2 -> tp_allreduce_25_2
	expert_compute_25_1_2 -> tp_allreduce_25_2
	tp_allreduce_25_2 -> expert_25_2
	expert_25_2 -> expert_agg_2 [label="Expert 25 output"]
	moe_gate_2 -> tp_split_26_2 [label="Gate selection 26" style=dashed]
	tp_split_26_2 -> expert_compute_26_0_2
	tp_split_26_2 -> expert_compute_26_1_2
	expert_compute_26_0_2 -> tp_allreduce_26_2
	expert_compute_26_1_2 -> tp_allreduce_26_2
	tp_allreduce_26_2 -> expert_26_2
	expert_26_2 -> expert_agg_2 [label="Expert 26 output"]
	moe_gate_2 -> tp_split_27_2 [label="Gate selection 27" style=dashed]
	tp_split_27_2 -> expert_compute_27_0_2
	tp_split_27_2 -> expert_compute_27_1_2
	expert_compute_27_0_2 -> tp_allreduce_27_2
	expert_compute_27_1_2 -> tp_allreduce_27_2
	tp_allreduce_27_2 -> expert_27_2
	expert_27_2 -> expert_agg_2 [label="Expert 27 output"]
	moe_gate_2 -> tp_split_28_2 [label="Gate selection 28" style=dashed]
	tp_split_28_2 -> expert_compute_28_0_2
	tp_split_28_2 -> expert_compute_28_1_2
	expert_compute_28_0_2 -> tp_allreduce_28_2
	expert_compute_28_1_2 -> tp_allreduce_28_2
	tp_allreduce_28_2 -> expert_28_2
	expert_28_2 -> expert_agg_2 [label="Expert 28 output"]
	moe_gate_2 -> tp_split_29_2 [label="Gate selection 29" style=dashed]
	tp_split_29_2 -> expert_compute_29_0_2
	tp_split_29_2 -> expert_compute_29_1_2
	expert_compute_29_0_2 -> tp_allreduce_29_2
	expert_compute_29_1_2 -> tp_allreduce_29_2
	tp_allreduce_29_2 -> expert_29_2
	expert_29_2 -> expert_agg_2 [label="Expert 29 output"]
	moe_gate_2 -> tp_split_30_2 [label="Gate selection 30" style=dashed]
	tp_split_30_2 -> expert_compute_30_0_2
	tp_split_30_2 -> expert_compute_30_1_2
	expert_compute_30_0_2 -> tp_allreduce_30_2
	expert_compute_30_1_2 -> tp_allreduce_30_2
	tp_allreduce_30_2 -> expert_30_2
	expert_30_2 -> expert_agg_2 [label="Expert 30 output"]
	moe_gate_2 -> tp_split_31_2 [label="Gate selection 31" style=dashed]
	tp_split_31_2 -> expert_compute_31_0_2
	tp_split_31_2 -> expert_compute_31_1_2
	expert_compute_31_0_2 -> tp_allreduce_31_2
	expert_compute_31_1_2 -> tp_allreduce_31_2
	tp_allreduce_31_2 -> expert_31_2
	expert_31_2 -> expert_agg_2 [label="Expert 31 output"]
	moe_gate_2 -> tp_split_32_2 [label="Gate selection 32" style=dashed]
	tp_split_32_2 -> expert_compute_32_0_2
	tp_split_32_2 -> expert_compute_32_1_2
	expert_compute_32_0_2 -> tp_allreduce_32_2
	expert_compute_32_1_2 -> tp_allreduce_32_2
	tp_allreduce_32_2 -> expert_32_2
	expert_32_2 -> expert_agg_2 [label="Expert 32 output"]
	moe_gate_2 -> tp_split_33_2 [label="Gate selection 33" style=dashed]
	tp_split_33_2 -> expert_compute_33_0_2
	tp_split_33_2 -> expert_compute_33_1_2
	expert_compute_33_0_2 -> tp_allreduce_33_2
	expert_compute_33_1_2 -> tp_allreduce_33_2
	tp_allreduce_33_2 -> expert_33_2
	expert_33_2 -> expert_agg_2 [label="Expert 33 output"]
	moe_gate_2 -> tp_split_34_2 [label="Gate selection 34" style=dashed]
	tp_split_34_2 -> expert_compute_34_0_2
	tp_split_34_2 -> expert_compute_34_1_2
	expert_compute_34_0_2 -> tp_allreduce_34_2
	expert_compute_34_1_2 -> tp_allreduce_34_2
	tp_allreduce_34_2 -> expert_34_2
	expert_34_2 -> expert_agg_2 [label="Expert 34 output"]
	moe_gate_2 -> tp_split_35_2 [label="Gate selection 35" style=dashed]
	tp_split_35_2 -> expert_compute_35_0_2
	tp_split_35_2 -> expert_compute_35_1_2
	expert_compute_35_0_2 -> tp_allreduce_35_2
	expert_compute_35_1_2 -> tp_allreduce_35_2
	tp_allreduce_35_2 -> expert_35_2
	expert_35_2 -> expert_agg_2 [label="Expert 35 output"]
	moe_gate_2 -> tp_split_36_2 [label="Gate selection 36" style=dashed]
	tp_split_36_2 -> expert_compute_36_0_2
	tp_split_36_2 -> expert_compute_36_1_2
	expert_compute_36_0_2 -> tp_allreduce_36_2
	expert_compute_36_1_2 -> tp_allreduce_36_2
	tp_allreduce_36_2 -> expert_36_2
	expert_36_2 -> expert_agg_2 [label="Expert 36 output"]
	moe_gate_2 -> tp_split_37_2 [label="Gate selection 37" style=dashed]
	tp_split_37_2 -> expert_compute_37_0_2
	tp_split_37_2 -> expert_compute_37_1_2
	expert_compute_37_0_2 -> tp_allreduce_37_2
	expert_compute_37_1_2 -> tp_allreduce_37_2
	tp_allreduce_37_2 -> expert_37_2
	expert_37_2 -> expert_agg_2 [label="Expert 37 output"]
	moe_gate_2 -> tp_split_38_2 [label="Gate selection 38" style=dashed]
	tp_split_38_2 -> expert_compute_38_0_2
	tp_split_38_2 -> expert_compute_38_1_2
	expert_compute_38_0_2 -> tp_allreduce_38_2
	expert_compute_38_1_2 -> tp_allreduce_38_2
	tp_allreduce_38_2 -> expert_38_2
	expert_38_2 -> expert_agg_2 [label="Expert 38 output"]
	moe_gate_2 -> tp_split_39_2 [label="Gate selection 39" style=dashed]
	tp_split_39_2 -> expert_compute_39_0_2
	tp_split_39_2 -> expert_compute_39_1_2
	expert_compute_39_0_2 -> tp_allreduce_39_2
	expert_compute_39_1_2 -> tp_allreduce_39_2
	tp_allreduce_39_2 -> expert_39_2
	expert_39_2 -> expert_agg_2 [label="Expert 39 output"]
	moe_gate_2 -> tp_split_40_2 [label="Gate selection 40" style=dashed]
	tp_split_40_2 -> expert_compute_40_0_2
	tp_split_40_2 -> expert_compute_40_1_2
	expert_compute_40_0_2 -> tp_allreduce_40_2
	expert_compute_40_1_2 -> tp_allreduce_40_2
	tp_allreduce_40_2 -> expert_40_2
	expert_40_2 -> expert_agg_2 [label="Expert 40 output"]
	moe_gate_2 -> tp_split_41_2 [label="Gate selection 41" style=dashed]
	tp_split_41_2 -> expert_compute_41_0_2
	tp_split_41_2 -> expert_compute_41_1_2
	expert_compute_41_0_2 -> tp_allreduce_41_2
	expert_compute_41_1_2 -> tp_allreduce_41_2
	tp_allreduce_41_2 -> expert_41_2
	expert_41_2 -> expert_agg_2 [label="Expert 41 output"]
	moe_gate_2 -> tp_split_42_2 [label="Gate selection 42" style=dashed]
	tp_split_42_2 -> expert_compute_42_0_2
	tp_split_42_2 -> expert_compute_42_1_2
	expert_compute_42_0_2 -> tp_allreduce_42_2
	expert_compute_42_1_2 -> tp_allreduce_42_2
	tp_allreduce_42_2 -> expert_42_2
	expert_42_2 -> expert_agg_2 [label="Expert 42 output"]
	moe_gate_2 -> tp_split_43_2 [label="Gate selection 43" style=dashed]
	tp_split_43_2 -> expert_compute_43_0_2
	tp_split_43_2 -> expert_compute_43_1_2
	expert_compute_43_0_2 -> tp_allreduce_43_2
	expert_compute_43_1_2 -> tp_allreduce_43_2
	tp_allreduce_43_2 -> expert_43_2
	expert_43_2 -> expert_agg_2 [label="Expert 43 output"]
	moe_gate_2 -> tp_split_44_2 [label="Gate selection 44" style=dashed]
	tp_split_44_2 -> expert_compute_44_0_2
	tp_split_44_2 -> expert_compute_44_1_2
	expert_compute_44_0_2 -> tp_allreduce_44_2
	expert_compute_44_1_2 -> tp_allreduce_44_2
	tp_allreduce_44_2 -> expert_44_2
	expert_44_2 -> expert_agg_2 [label="Expert 44 output"]
	moe_gate_2 -> tp_split_45_2 [label="Gate selection 45" style=dashed]
	tp_split_45_2 -> expert_compute_45_0_2
	tp_split_45_2 -> expert_compute_45_1_2
	expert_compute_45_0_2 -> tp_allreduce_45_2
	expert_compute_45_1_2 -> tp_allreduce_45_2
	tp_allreduce_45_2 -> expert_45_2
	expert_45_2 -> expert_agg_2 [label="Expert 45 output"]
	moe_gate_2 -> tp_split_46_2 [label="Gate selection 46" style=dashed]
	tp_split_46_2 -> expert_compute_46_0_2
	tp_split_46_2 -> expert_compute_46_1_2
	expert_compute_46_0_2 -> tp_allreduce_46_2
	expert_compute_46_1_2 -> tp_allreduce_46_2
	tp_allreduce_46_2 -> expert_46_2
	expert_46_2 -> expert_agg_2 [label="Expert 46 output"]
	moe_gate_2 -> tp_split_47_2 [label="Gate selection 47" style=dashed]
	tp_split_47_2 -> expert_compute_47_0_2
	tp_split_47_2 -> expert_compute_47_1_2
	expert_compute_47_0_2 -> tp_allreduce_47_2
	expert_compute_47_1_2 -> tp_allreduce_47_2
	tp_allreduce_47_2 -> expert_47_2
	expert_47_2 -> expert_agg_2 [label="Expert 47 output"]
	moe_gate_2 -> tp_split_48_2 [label="Gate selection 48" style=dashed]
	tp_split_48_2 -> expert_compute_48_0_2
	tp_split_48_2 -> expert_compute_48_1_2
	expert_compute_48_0_2 -> tp_allreduce_48_2
	expert_compute_48_1_2 -> tp_allreduce_48_2
	tp_allreduce_48_2 -> expert_48_2
	expert_48_2 -> expert_agg_2 [label="Expert 48 output"]
	moe_gate_2 -> tp_split_49_2 [label="Gate selection 49" style=dashed]
	tp_split_49_2 -> expert_compute_49_0_2
	tp_split_49_2 -> expert_compute_49_1_2
	expert_compute_49_0_2 -> tp_allreduce_49_2
	expert_compute_49_1_2 -> tp_allreduce_49_2
	tp_allreduce_49_2 -> expert_49_2
	expert_49_2 -> expert_agg_2 [label="Expert 49 output"]
	moe_gate_2 -> tp_split_50_2 [label="Gate selection 50" style=dashed]
	tp_split_50_2 -> expert_compute_50_0_2
	tp_split_50_2 -> expert_compute_50_1_2
	expert_compute_50_0_2 -> tp_allreduce_50_2
	expert_compute_50_1_2 -> tp_allreduce_50_2
	tp_allreduce_50_2 -> expert_50_2
	expert_50_2 -> expert_agg_2 [label="Expert 50 output"]
	moe_gate_2 -> tp_split_51_2 [label="Gate selection 51" style=dashed]
	tp_split_51_2 -> expert_compute_51_0_2
	tp_split_51_2 -> expert_compute_51_1_2
	expert_compute_51_0_2 -> tp_allreduce_51_2
	expert_compute_51_1_2 -> tp_allreduce_51_2
	tp_allreduce_51_2 -> expert_51_2
	expert_51_2 -> expert_agg_2 [label="Expert 51 output"]
	moe_gate_2 -> tp_split_52_2 [label="Gate selection 52" style=dashed]
	tp_split_52_2 -> expert_compute_52_0_2
	tp_split_52_2 -> expert_compute_52_1_2
	expert_compute_52_0_2 -> tp_allreduce_52_2
	expert_compute_52_1_2 -> tp_allreduce_52_2
	tp_allreduce_52_2 -> expert_52_2
	expert_52_2 -> expert_agg_2 [label="Expert 52 output"]
	moe_gate_2 -> tp_split_53_2 [label="Gate selection 53" style=dashed]
	tp_split_53_2 -> expert_compute_53_0_2
	tp_split_53_2 -> expert_compute_53_1_2
	expert_compute_53_0_2 -> tp_allreduce_53_2
	expert_compute_53_1_2 -> tp_allreduce_53_2
	tp_allreduce_53_2 -> expert_53_2
	expert_53_2 -> expert_agg_2 [label="Expert 53 output"]
	moe_gate_2 -> tp_split_54_2 [label="Gate selection 54" style=dashed]
	tp_split_54_2 -> expert_compute_54_0_2
	tp_split_54_2 -> expert_compute_54_1_2
	expert_compute_54_0_2 -> tp_allreduce_54_2
	expert_compute_54_1_2 -> tp_allreduce_54_2
	tp_allreduce_54_2 -> expert_54_2
	expert_54_2 -> expert_agg_2 [label="Expert 54 output"]
	moe_gate_2 -> tp_split_55_2 [label="Gate selection 55" style=dashed]
	tp_split_55_2 -> expert_compute_55_0_2
	tp_split_55_2 -> expert_compute_55_1_2
	expert_compute_55_0_2 -> tp_allreduce_55_2
	expert_compute_55_1_2 -> tp_allreduce_55_2
	tp_allreduce_55_2 -> expert_55_2
	expert_55_2 -> expert_agg_2 [label="Expert 55 output"]
	moe_gate_2 -> tp_split_56_2 [label="Gate selection 56" style=dashed]
	tp_split_56_2 -> expert_compute_56_0_2
	tp_split_56_2 -> expert_compute_56_1_2
	expert_compute_56_0_2 -> tp_allreduce_56_2
	expert_compute_56_1_2 -> tp_allreduce_56_2
	tp_allreduce_56_2 -> expert_56_2
	expert_56_2 -> expert_agg_2 [label="Expert 56 output"]
	moe_gate_2 -> tp_split_57_2 [label="Gate selection 57" style=dashed]
	tp_split_57_2 -> expert_compute_57_0_2
	tp_split_57_2 -> expert_compute_57_1_2
	expert_compute_57_0_2 -> tp_allreduce_57_2
	expert_compute_57_1_2 -> tp_allreduce_57_2
	tp_allreduce_57_2 -> expert_57_2
	expert_57_2 -> expert_agg_2 [label="Expert 57 output"]
	moe_gate_2 -> tp_split_58_2 [label="Gate selection 58" style=dashed]
	tp_split_58_2 -> expert_compute_58_0_2
	tp_split_58_2 -> expert_compute_58_1_2
	expert_compute_58_0_2 -> tp_allreduce_58_2
	expert_compute_58_1_2 -> tp_allreduce_58_2
	tp_allreduce_58_2 -> expert_58_2
	expert_58_2 -> expert_agg_2 [label="Expert 58 output"]
	moe_gate_2 -> tp_split_59_2 [label="Gate selection 59" style=dashed]
	tp_split_59_2 -> expert_compute_59_0_2
	tp_split_59_2 -> expert_compute_59_1_2
	expert_compute_59_0_2 -> tp_allreduce_59_2
	expert_compute_59_1_2 -> tp_allreduce_59_2
	tp_allreduce_59_2 -> expert_59_2
	expert_59_2 -> expert_agg_2 [label="Expert 59 output"]
	moe_gate_2 -> tp_split_60_2 [label="Gate selection 60" style=dashed]
	tp_split_60_2 -> expert_compute_60_0_2
	tp_split_60_2 -> expert_compute_60_1_2
	expert_compute_60_0_2 -> tp_allreduce_60_2
	expert_compute_60_1_2 -> tp_allreduce_60_2
	tp_allreduce_60_2 -> expert_60_2
	expert_60_2 -> expert_agg_2 [label="Expert 60 output"]
	moe_gate_2 -> tp_split_61_2 [label="Gate selection 61" style=dashed]
	tp_split_61_2 -> expert_compute_61_0_2
	tp_split_61_2 -> expert_compute_61_1_2
	expert_compute_61_0_2 -> tp_allreduce_61_2
	expert_compute_61_1_2 -> tp_allreduce_61_2
	tp_allreduce_61_2 -> expert_61_2
	expert_61_2 -> expert_agg_2 [label="Expert 61 output"]
	moe_gate_2 -> tp_split_62_2 [label="Gate selection 62" style=dashed]
	tp_split_62_2 -> expert_compute_62_0_2
	tp_split_62_2 -> expert_compute_62_1_2
	expert_compute_62_0_2 -> tp_allreduce_62_2
	expert_compute_62_1_2 -> tp_allreduce_62_2
	tp_allreduce_62_2 -> expert_62_2
	expert_62_2 -> expert_agg_2 [label="Expert 62 output"]
	moe_gate_2 -> tp_split_63_2 [label="Gate selection 63" style=dashed]
	tp_split_63_2 -> expert_compute_63_0_2
	tp_split_63_2 -> expert_compute_63_1_2
	expert_compute_63_0_2 -> tp_allreduce_63_2
	expert_compute_63_1_2 -> tp_allreduce_63_2
	tp_allreduce_63_2 -> expert_63_2
	expert_63_2 -> expert_agg_2 [label="Expert 63 output"]
	expert_agg_2 -> layer_norm_2
	layer_norm_2 -> attn_norm_3
	attn_norm_3 -> attn_q_3
	attn_norm_3 -> attn_k_3
	attn_norm_3 -> attn_v_3
	attn_q_3 -> attn_score_3
	attn_k_3 -> attn_score_3
	attn_v_3 -> attn_out_3
	attn_score_3 -> attn_out_3
	attn_out_3 -> moe_gate_3
	moe_gate_3 -> tp_split_0_3 [label="Gate selection 0" style=dashed]
	tp_split_0_3 -> expert_compute_0_0_3
	tp_split_0_3 -> expert_compute_0_1_3
	expert_compute_0_0_3 -> tp_allreduce_0_3
	expert_compute_0_1_3 -> tp_allreduce_0_3
	tp_allreduce_0_3 -> expert_0_3
	expert_0_3 -> expert_agg_3 [label="Expert 0 output"]
	moe_gate_3 -> tp_split_1_3 [label="Gate selection 1" style=dashed]
	tp_split_1_3 -> expert_compute_1_0_3
	tp_split_1_3 -> expert_compute_1_1_3
	expert_compute_1_0_3 -> tp_allreduce_1_3
	expert_compute_1_1_3 -> tp_allreduce_1_3
	tp_allreduce_1_3 -> expert_1_3
	expert_1_3 -> expert_agg_3 [label="Expert 1 output"]
	moe_gate_3 -> tp_split_2_3 [label="Gate selection 2" style=dashed]
	tp_split_2_3 -> expert_compute_2_0_3
	tp_split_2_3 -> expert_compute_2_1_3
	expert_compute_2_0_3 -> tp_allreduce_2_3
	expert_compute_2_1_3 -> tp_allreduce_2_3
	tp_allreduce_2_3 -> expert_2_3
	expert_2_3 -> expert_agg_3 [label="Expert 2 output"]
	moe_gate_3 -> tp_split_3_3 [label="Gate selection 3" style=dashed]
	tp_split_3_3 -> expert_compute_3_0_3
	tp_split_3_3 -> expert_compute_3_1_3
	expert_compute_3_0_3 -> tp_allreduce_3_3
	expert_compute_3_1_3 -> tp_allreduce_3_3
	tp_allreduce_3_3 -> expert_3_3
	expert_3_3 -> expert_agg_3 [label="Expert 3 output"]
	moe_gate_3 -> tp_split_4_3 [label="Gate selection 4" style=dashed]
	tp_split_4_3 -> expert_compute_4_0_3
	tp_split_4_3 -> expert_compute_4_1_3
	expert_compute_4_0_3 -> tp_allreduce_4_3
	expert_compute_4_1_3 -> tp_allreduce_4_3
	tp_allreduce_4_3 -> expert_4_3
	expert_4_3 -> expert_agg_3 [label="Expert 4 output"]
	moe_gate_3 -> tp_split_5_3 [label="Gate selection 5" style=dashed]
	tp_split_5_3 -> expert_compute_5_0_3
	tp_split_5_3 -> expert_compute_5_1_3
	expert_compute_5_0_3 -> tp_allreduce_5_3
	expert_compute_5_1_3 -> tp_allreduce_5_3
	tp_allreduce_5_3 -> expert_5_3
	expert_5_3 -> expert_agg_3 [label="Expert 5 output"]
	moe_gate_3 -> tp_split_6_3 [label="Gate selection 6" style=dashed]
	tp_split_6_3 -> expert_compute_6_0_3
	tp_split_6_3 -> expert_compute_6_1_3
	expert_compute_6_0_3 -> tp_allreduce_6_3
	expert_compute_6_1_3 -> tp_allreduce_6_3
	tp_allreduce_6_3 -> expert_6_3
	expert_6_3 -> expert_agg_3 [label="Expert 6 output"]
	moe_gate_3 -> tp_split_7_3 [label="Gate selection 7" style=dashed]
	tp_split_7_3 -> expert_compute_7_0_3
	tp_split_7_3 -> expert_compute_7_1_3
	expert_compute_7_0_3 -> tp_allreduce_7_3
	expert_compute_7_1_3 -> tp_allreduce_7_3
	tp_allreduce_7_3 -> expert_7_3
	expert_7_3 -> expert_agg_3 [label="Expert 7 output"]
	moe_gate_3 -> tp_split_8_3 [label="Gate selection 8" style=dashed]
	tp_split_8_3 -> expert_compute_8_0_3
	tp_split_8_3 -> expert_compute_8_1_3
	expert_compute_8_0_3 -> tp_allreduce_8_3
	expert_compute_8_1_3 -> tp_allreduce_8_3
	tp_allreduce_8_3 -> expert_8_3
	expert_8_3 -> expert_agg_3 [label="Expert 8 output"]
	moe_gate_3 -> tp_split_9_3 [label="Gate selection 9" style=dashed]
	tp_split_9_3 -> expert_compute_9_0_3
	tp_split_9_3 -> expert_compute_9_1_3
	expert_compute_9_0_3 -> tp_allreduce_9_3
	expert_compute_9_1_3 -> tp_allreduce_9_3
	tp_allreduce_9_3 -> expert_9_3
	expert_9_3 -> expert_agg_3 [label="Expert 9 output"]
	moe_gate_3 -> tp_split_10_3 [label="Gate selection 10" style=dashed]
	tp_split_10_3 -> expert_compute_10_0_3
	tp_split_10_3 -> expert_compute_10_1_3
	expert_compute_10_0_3 -> tp_allreduce_10_3
	expert_compute_10_1_3 -> tp_allreduce_10_3
	tp_allreduce_10_3 -> expert_10_3
	expert_10_3 -> expert_agg_3 [label="Expert 10 output"]
	moe_gate_3 -> tp_split_11_3 [label="Gate selection 11" style=dashed]
	tp_split_11_3 -> expert_compute_11_0_3
	tp_split_11_3 -> expert_compute_11_1_3
	expert_compute_11_0_3 -> tp_allreduce_11_3
	expert_compute_11_1_3 -> tp_allreduce_11_3
	tp_allreduce_11_3 -> expert_11_3
	expert_11_3 -> expert_agg_3 [label="Expert 11 output"]
	moe_gate_3 -> tp_split_12_3 [label="Gate selection 12" style=dashed]
	tp_split_12_3 -> expert_compute_12_0_3
	tp_split_12_3 -> expert_compute_12_1_3
	expert_compute_12_0_3 -> tp_allreduce_12_3
	expert_compute_12_1_3 -> tp_allreduce_12_3
	tp_allreduce_12_3 -> expert_12_3
	expert_12_3 -> expert_agg_3 [label="Expert 12 output"]
	moe_gate_3 -> tp_split_13_3 [label="Gate selection 13" style=dashed]
	tp_split_13_3 -> expert_compute_13_0_3
	tp_split_13_3 -> expert_compute_13_1_3
	expert_compute_13_0_3 -> tp_allreduce_13_3
	expert_compute_13_1_3 -> tp_allreduce_13_3
	tp_allreduce_13_3 -> expert_13_3
	expert_13_3 -> expert_agg_3 [label="Expert 13 output"]
	moe_gate_3 -> tp_split_14_3 [label="Gate selection 14" style=dashed]
	tp_split_14_3 -> expert_compute_14_0_3
	tp_split_14_3 -> expert_compute_14_1_3
	expert_compute_14_0_3 -> tp_allreduce_14_3
	expert_compute_14_1_3 -> tp_allreduce_14_3
	tp_allreduce_14_3 -> expert_14_3
	expert_14_3 -> expert_agg_3 [label="Expert 14 output"]
	moe_gate_3 -> tp_split_15_3 [label="Gate selection 15" style=dashed]
	tp_split_15_3 -> expert_compute_15_0_3
	tp_split_15_3 -> expert_compute_15_1_3
	expert_compute_15_0_3 -> tp_allreduce_15_3
	expert_compute_15_1_3 -> tp_allreduce_15_3
	tp_allreduce_15_3 -> expert_15_3
	expert_15_3 -> expert_agg_3 [label="Expert 15 output"]
	moe_gate_3 -> tp_split_16_3 [label="Gate selection 16" style=dashed]
	tp_split_16_3 -> expert_compute_16_0_3
	tp_split_16_3 -> expert_compute_16_1_3
	expert_compute_16_0_3 -> tp_allreduce_16_3
	expert_compute_16_1_3 -> tp_allreduce_16_3
	tp_allreduce_16_3 -> expert_16_3
	expert_16_3 -> expert_agg_3 [label="Expert 16 output"]
	moe_gate_3 -> tp_split_17_3 [label="Gate selection 17" style=dashed]
	tp_split_17_3 -> expert_compute_17_0_3
	tp_split_17_3 -> expert_compute_17_1_3
	expert_compute_17_0_3 -> tp_allreduce_17_3
	expert_compute_17_1_3 -> tp_allreduce_17_3
	tp_allreduce_17_3 -> expert_17_3
	expert_17_3 -> expert_agg_3 [label="Expert 17 output"]
	moe_gate_3 -> tp_split_18_3 [label="Gate selection 18" style=dashed]
	tp_split_18_3 -> expert_compute_18_0_3
	tp_split_18_3 -> expert_compute_18_1_3
	expert_compute_18_0_3 -> tp_allreduce_18_3
	expert_compute_18_1_3 -> tp_allreduce_18_3
	tp_allreduce_18_3 -> expert_18_3
	expert_18_3 -> expert_agg_3 [label="Expert 18 output"]
	moe_gate_3 -> tp_split_19_3 [label="Gate selection 19" style=dashed]
	tp_split_19_3 -> expert_compute_19_0_3
	tp_split_19_3 -> expert_compute_19_1_3
	expert_compute_19_0_3 -> tp_allreduce_19_3
	expert_compute_19_1_3 -> tp_allreduce_19_3
	tp_allreduce_19_3 -> expert_19_3
	expert_19_3 -> expert_agg_3 [label="Expert 19 output"]
	moe_gate_3 -> tp_split_20_3 [label="Gate selection 20" style=dashed]
	tp_split_20_3 -> expert_compute_20_0_3
	tp_split_20_3 -> expert_compute_20_1_3
	expert_compute_20_0_3 -> tp_allreduce_20_3
	expert_compute_20_1_3 -> tp_allreduce_20_3
	tp_allreduce_20_3 -> expert_20_3
	expert_20_3 -> expert_agg_3 [label="Expert 20 output"]
	moe_gate_3 -> tp_split_21_3 [label="Gate selection 21" style=dashed]
	tp_split_21_3 -> expert_compute_21_0_3
	tp_split_21_3 -> expert_compute_21_1_3
	expert_compute_21_0_3 -> tp_allreduce_21_3
	expert_compute_21_1_3 -> tp_allreduce_21_3
	tp_allreduce_21_3 -> expert_21_3
	expert_21_3 -> expert_agg_3 [label="Expert 21 output"]
	moe_gate_3 -> tp_split_22_3 [label="Gate selection 22" style=dashed]
	tp_split_22_3 -> expert_compute_22_0_3
	tp_split_22_3 -> expert_compute_22_1_3
	expert_compute_22_0_3 -> tp_allreduce_22_3
	expert_compute_22_1_3 -> tp_allreduce_22_3
	tp_allreduce_22_3 -> expert_22_3
	expert_22_3 -> expert_agg_3 [label="Expert 22 output"]
	moe_gate_3 -> tp_split_23_3 [label="Gate selection 23" style=dashed]
	tp_split_23_3 -> expert_compute_23_0_3
	tp_split_23_3 -> expert_compute_23_1_3
	expert_compute_23_0_3 -> tp_allreduce_23_3
	expert_compute_23_1_3 -> tp_allreduce_23_3
	tp_allreduce_23_3 -> expert_23_3
	expert_23_3 -> expert_agg_3 [label="Expert 23 output"]
	moe_gate_3 -> tp_split_24_3 [label="Gate selection 24" style=dashed]
	tp_split_24_3 -> expert_compute_24_0_3
	tp_split_24_3 -> expert_compute_24_1_3
	expert_compute_24_0_3 -> tp_allreduce_24_3
	expert_compute_24_1_3 -> tp_allreduce_24_3
	tp_allreduce_24_3 -> expert_24_3
	expert_24_3 -> expert_agg_3 [label="Expert 24 output"]
	moe_gate_3 -> tp_split_25_3 [label="Gate selection 25" style=dashed]
	tp_split_25_3 -> expert_compute_25_0_3
	tp_split_25_3 -> expert_compute_25_1_3
	expert_compute_25_0_3 -> tp_allreduce_25_3
	expert_compute_25_1_3 -> tp_allreduce_25_3
	tp_allreduce_25_3 -> expert_25_3
	expert_25_3 -> expert_agg_3 [label="Expert 25 output"]
	moe_gate_3 -> tp_split_26_3 [label="Gate selection 26" style=dashed]
	tp_split_26_3 -> expert_compute_26_0_3
	tp_split_26_3 -> expert_compute_26_1_3
	expert_compute_26_0_3 -> tp_allreduce_26_3
	expert_compute_26_1_3 -> tp_allreduce_26_3
	tp_allreduce_26_3 -> expert_26_3
	expert_26_3 -> expert_agg_3 [label="Expert 26 output"]
	moe_gate_3 -> tp_split_27_3 [label="Gate selection 27" style=dashed]
	tp_split_27_3 -> expert_compute_27_0_3
	tp_split_27_3 -> expert_compute_27_1_3
	expert_compute_27_0_3 -> tp_allreduce_27_3
	expert_compute_27_1_3 -> tp_allreduce_27_3
	tp_allreduce_27_3 -> expert_27_3
	expert_27_3 -> expert_agg_3 [label="Expert 27 output"]
	moe_gate_3 -> tp_split_28_3 [label="Gate selection 28" style=dashed]
	tp_split_28_3 -> expert_compute_28_0_3
	tp_split_28_3 -> expert_compute_28_1_3
	expert_compute_28_0_3 -> tp_allreduce_28_3
	expert_compute_28_1_3 -> tp_allreduce_28_3
	tp_allreduce_28_3 -> expert_28_3
	expert_28_3 -> expert_agg_3 [label="Expert 28 output"]
	moe_gate_3 -> tp_split_29_3 [label="Gate selection 29" style=dashed]
	tp_split_29_3 -> expert_compute_29_0_3
	tp_split_29_3 -> expert_compute_29_1_3
	expert_compute_29_0_3 -> tp_allreduce_29_3
	expert_compute_29_1_3 -> tp_allreduce_29_3
	tp_allreduce_29_3 -> expert_29_3
	expert_29_3 -> expert_agg_3 [label="Expert 29 output"]
	moe_gate_3 -> tp_split_30_3 [label="Gate selection 30" style=dashed]
	tp_split_30_3 -> expert_compute_30_0_3
	tp_split_30_3 -> expert_compute_30_1_3
	expert_compute_30_0_3 -> tp_allreduce_30_3
	expert_compute_30_1_3 -> tp_allreduce_30_3
	tp_allreduce_30_3 -> expert_30_3
	expert_30_3 -> expert_agg_3 [label="Expert 30 output"]
	moe_gate_3 -> tp_split_31_3 [label="Gate selection 31" style=dashed]
	tp_split_31_3 -> expert_compute_31_0_3
	tp_split_31_3 -> expert_compute_31_1_3
	expert_compute_31_0_3 -> tp_allreduce_31_3
	expert_compute_31_1_3 -> tp_allreduce_31_3
	tp_allreduce_31_3 -> expert_31_3
	expert_31_3 -> expert_agg_3 [label="Expert 31 output"]
	moe_gate_3 -> tp_split_32_3 [label="Gate selection 32" style=dashed]
	tp_split_32_3 -> expert_compute_32_0_3
	tp_split_32_3 -> expert_compute_32_1_3
	expert_compute_32_0_3 -> tp_allreduce_32_3
	expert_compute_32_1_3 -> tp_allreduce_32_3
	tp_allreduce_32_3 -> expert_32_3
	expert_32_3 -> expert_agg_3 [label="Expert 32 output"]
	moe_gate_3 -> tp_split_33_3 [label="Gate selection 33" style=dashed]
	tp_split_33_3 -> expert_compute_33_0_3
	tp_split_33_3 -> expert_compute_33_1_3
	expert_compute_33_0_3 -> tp_allreduce_33_3
	expert_compute_33_1_3 -> tp_allreduce_33_3
	tp_allreduce_33_3 -> expert_33_3
	expert_33_3 -> expert_agg_3 [label="Expert 33 output"]
	moe_gate_3 -> tp_split_34_3 [label="Gate selection 34" style=dashed]
	tp_split_34_3 -> expert_compute_34_0_3
	tp_split_34_3 -> expert_compute_34_1_3
	expert_compute_34_0_3 -> tp_allreduce_34_3
	expert_compute_34_1_3 -> tp_allreduce_34_3
	tp_allreduce_34_3 -> expert_34_3
	expert_34_3 -> expert_agg_3 [label="Expert 34 output"]
	moe_gate_3 -> tp_split_35_3 [label="Gate selection 35" style=dashed]
	tp_split_35_3 -> expert_compute_35_0_3
	tp_split_35_3 -> expert_compute_35_1_3
	expert_compute_35_0_3 -> tp_allreduce_35_3
	expert_compute_35_1_3 -> tp_allreduce_35_3
	tp_allreduce_35_3 -> expert_35_3
	expert_35_3 -> expert_agg_3 [label="Expert 35 output"]
	moe_gate_3 -> tp_split_36_3 [label="Gate selection 36" style=dashed]
	tp_split_36_3 -> expert_compute_36_0_3
	tp_split_36_3 -> expert_compute_36_1_3
	expert_compute_36_0_3 -> tp_allreduce_36_3
	expert_compute_36_1_3 -> tp_allreduce_36_3
	tp_allreduce_36_3 -> expert_36_3
	expert_36_3 -> expert_agg_3 [label="Expert 36 output"]
	moe_gate_3 -> tp_split_37_3 [label="Gate selection 37" style=dashed]
	tp_split_37_3 -> expert_compute_37_0_3
	tp_split_37_3 -> expert_compute_37_1_3
	expert_compute_37_0_3 -> tp_allreduce_37_3
	expert_compute_37_1_3 -> tp_allreduce_37_3
	tp_allreduce_37_3 -> expert_37_3
	expert_37_3 -> expert_agg_3 [label="Expert 37 output"]
	moe_gate_3 -> tp_split_38_3 [label="Gate selection 38" style=dashed]
	tp_split_38_3 -> expert_compute_38_0_3
	tp_split_38_3 -> expert_compute_38_1_3
	expert_compute_38_0_3 -> tp_allreduce_38_3
	expert_compute_38_1_3 -> tp_allreduce_38_3
	tp_allreduce_38_3 -> expert_38_3
	expert_38_3 -> expert_agg_3 [label="Expert 38 output"]
	moe_gate_3 -> tp_split_39_3 [label="Gate selection 39" style=dashed]
	tp_split_39_3 -> expert_compute_39_0_3
	tp_split_39_3 -> expert_compute_39_1_3
	expert_compute_39_0_3 -> tp_allreduce_39_3
	expert_compute_39_1_3 -> tp_allreduce_39_3
	tp_allreduce_39_3 -> expert_39_3
	expert_39_3 -> expert_agg_3 [label="Expert 39 output"]
	moe_gate_3 -> tp_split_40_3 [label="Gate selection 40" style=dashed]
	tp_split_40_3 -> expert_compute_40_0_3
	tp_split_40_3 -> expert_compute_40_1_3
	expert_compute_40_0_3 -> tp_allreduce_40_3
	expert_compute_40_1_3 -> tp_allreduce_40_3
	tp_allreduce_40_3 -> expert_40_3
	expert_40_3 -> expert_agg_3 [label="Expert 40 output"]
	moe_gate_3 -> tp_split_41_3 [label="Gate selection 41" style=dashed]
	tp_split_41_3 -> expert_compute_41_0_3
	tp_split_41_3 -> expert_compute_41_1_3
	expert_compute_41_0_3 -> tp_allreduce_41_3
	expert_compute_41_1_3 -> tp_allreduce_41_3
	tp_allreduce_41_3 -> expert_41_3
	expert_41_3 -> expert_agg_3 [label="Expert 41 output"]
	moe_gate_3 -> tp_split_42_3 [label="Gate selection 42" style=dashed]
	tp_split_42_3 -> expert_compute_42_0_3
	tp_split_42_3 -> expert_compute_42_1_3
	expert_compute_42_0_3 -> tp_allreduce_42_3
	expert_compute_42_1_3 -> tp_allreduce_42_3
	tp_allreduce_42_3 -> expert_42_3
	expert_42_3 -> expert_agg_3 [label="Expert 42 output"]
	moe_gate_3 -> tp_split_43_3 [label="Gate selection 43" style=dashed]
	tp_split_43_3 -> expert_compute_43_0_3
	tp_split_43_3 -> expert_compute_43_1_3
	expert_compute_43_0_3 -> tp_allreduce_43_3
	expert_compute_43_1_3 -> tp_allreduce_43_3
	tp_allreduce_43_3 -> expert_43_3
	expert_43_3 -> expert_agg_3 [label="Expert 43 output"]
	moe_gate_3 -> tp_split_44_3 [label="Gate selection 44" style=dashed]
	tp_split_44_3 -> expert_compute_44_0_3
	tp_split_44_3 -> expert_compute_44_1_3
	expert_compute_44_0_3 -> tp_allreduce_44_3
	expert_compute_44_1_3 -> tp_allreduce_44_3
	tp_allreduce_44_3 -> expert_44_3
	expert_44_3 -> expert_agg_3 [label="Expert 44 output"]
	moe_gate_3 -> tp_split_45_3 [label="Gate selection 45" style=dashed]
	tp_split_45_3 -> expert_compute_45_0_3
	tp_split_45_3 -> expert_compute_45_1_3
	expert_compute_45_0_3 -> tp_allreduce_45_3
	expert_compute_45_1_3 -> tp_allreduce_45_3
	tp_allreduce_45_3 -> expert_45_3
	expert_45_3 -> expert_agg_3 [label="Expert 45 output"]
	moe_gate_3 -> tp_split_46_3 [label="Gate selection 46" style=dashed]
	tp_split_46_3 -> expert_compute_46_0_3
	tp_split_46_3 -> expert_compute_46_1_3
	expert_compute_46_0_3 -> tp_allreduce_46_3
	expert_compute_46_1_3 -> tp_allreduce_46_3
	tp_allreduce_46_3 -> expert_46_3
	expert_46_3 -> expert_agg_3 [label="Expert 46 output"]
	moe_gate_3 -> tp_split_47_3 [label="Gate selection 47" style=dashed]
	tp_split_47_3 -> expert_compute_47_0_3
	tp_split_47_3 -> expert_compute_47_1_3
	expert_compute_47_0_3 -> tp_allreduce_47_3
	expert_compute_47_1_3 -> tp_allreduce_47_3
	tp_allreduce_47_3 -> expert_47_3
	expert_47_3 -> expert_agg_3 [label="Expert 47 output"]
	moe_gate_3 -> tp_split_48_3 [label="Gate selection 48" style=dashed]
	tp_split_48_3 -> expert_compute_48_0_3
	tp_split_48_3 -> expert_compute_48_1_3
	expert_compute_48_0_3 -> tp_allreduce_48_3
	expert_compute_48_1_3 -> tp_allreduce_48_3
	tp_allreduce_48_3 -> expert_48_3
	expert_48_3 -> expert_agg_3 [label="Expert 48 output"]
	moe_gate_3 -> tp_split_49_3 [label="Gate selection 49" style=dashed]
	tp_split_49_3 -> expert_compute_49_0_3
	tp_split_49_3 -> expert_compute_49_1_3
	expert_compute_49_0_3 -> tp_allreduce_49_3
	expert_compute_49_1_3 -> tp_allreduce_49_3
	tp_allreduce_49_3 -> expert_49_3
	expert_49_3 -> expert_agg_3 [label="Expert 49 output"]
	moe_gate_3 -> tp_split_50_3 [label="Gate selection 50" style=dashed]
	tp_split_50_3 -> expert_compute_50_0_3
	tp_split_50_3 -> expert_compute_50_1_3
	expert_compute_50_0_3 -> tp_allreduce_50_3
	expert_compute_50_1_3 -> tp_allreduce_50_3
	tp_allreduce_50_3 -> expert_50_3
	expert_50_3 -> expert_agg_3 [label="Expert 50 output"]
	moe_gate_3 -> tp_split_51_3 [label="Gate selection 51" style=dashed]
	tp_split_51_3 -> expert_compute_51_0_3
	tp_split_51_3 -> expert_compute_51_1_3
	expert_compute_51_0_3 -> tp_allreduce_51_3
	expert_compute_51_1_3 -> tp_allreduce_51_3
	tp_allreduce_51_3 -> expert_51_3
	expert_51_3 -> expert_agg_3 [label="Expert 51 output"]
	moe_gate_3 -> tp_split_52_3 [label="Gate selection 52" style=dashed]
	tp_split_52_3 -> expert_compute_52_0_3
	tp_split_52_3 -> expert_compute_52_1_3
	expert_compute_52_0_3 -> tp_allreduce_52_3
	expert_compute_52_1_3 -> tp_allreduce_52_3
	tp_allreduce_52_3 -> expert_52_3
	expert_52_3 -> expert_agg_3 [label="Expert 52 output"]
	moe_gate_3 -> tp_split_53_3 [label="Gate selection 53" style=dashed]
	tp_split_53_3 -> expert_compute_53_0_3
	tp_split_53_3 -> expert_compute_53_1_3
	expert_compute_53_0_3 -> tp_allreduce_53_3
	expert_compute_53_1_3 -> tp_allreduce_53_3
	tp_allreduce_53_3 -> expert_53_3
	expert_53_3 -> expert_agg_3 [label="Expert 53 output"]
	moe_gate_3 -> tp_split_54_3 [label="Gate selection 54" style=dashed]
	tp_split_54_3 -> expert_compute_54_0_3
	tp_split_54_3 -> expert_compute_54_1_3
	expert_compute_54_0_3 -> tp_allreduce_54_3
	expert_compute_54_1_3 -> tp_allreduce_54_3
	tp_allreduce_54_3 -> expert_54_3
	expert_54_3 -> expert_agg_3 [label="Expert 54 output"]
	moe_gate_3 -> tp_split_55_3 [label="Gate selection 55" style=dashed]
	tp_split_55_3 -> expert_compute_55_0_3
	tp_split_55_3 -> expert_compute_55_1_3
	expert_compute_55_0_3 -> tp_allreduce_55_3
	expert_compute_55_1_3 -> tp_allreduce_55_3
	tp_allreduce_55_3 -> expert_55_3
	expert_55_3 -> expert_agg_3 [label="Expert 55 output"]
	moe_gate_3 -> tp_split_56_3 [label="Gate selection 56" style=dashed]
	tp_split_56_3 -> expert_compute_56_0_3
	tp_split_56_3 -> expert_compute_56_1_3
	expert_compute_56_0_3 -> tp_allreduce_56_3
	expert_compute_56_1_3 -> tp_allreduce_56_3
	tp_allreduce_56_3 -> expert_56_3
	expert_56_3 -> expert_agg_3 [label="Expert 56 output"]
	moe_gate_3 -> tp_split_57_3 [label="Gate selection 57" style=dashed]
	tp_split_57_3 -> expert_compute_57_0_3
	tp_split_57_3 -> expert_compute_57_1_3
	expert_compute_57_0_3 -> tp_allreduce_57_3
	expert_compute_57_1_3 -> tp_allreduce_57_3
	tp_allreduce_57_3 -> expert_57_3
	expert_57_3 -> expert_agg_3 [label="Expert 57 output"]
	moe_gate_3 -> tp_split_58_3 [label="Gate selection 58" style=dashed]
	tp_split_58_3 -> expert_compute_58_0_3
	tp_split_58_3 -> expert_compute_58_1_3
	expert_compute_58_0_3 -> tp_allreduce_58_3
	expert_compute_58_1_3 -> tp_allreduce_58_3
	tp_allreduce_58_3 -> expert_58_3
	expert_58_3 -> expert_agg_3 [label="Expert 58 output"]
	moe_gate_3 -> tp_split_59_3 [label="Gate selection 59" style=dashed]
	tp_split_59_3 -> expert_compute_59_0_3
	tp_split_59_3 -> expert_compute_59_1_3
	expert_compute_59_0_3 -> tp_allreduce_59_3
	expert_compute_59_1_3 -> tp_allreduce_59_3
	tp_allreduce_59_3 -> expert_59_3
	expert_59_3 -> expert_agg_3 [label="Expert 59 output"]
	moe_gate_3 -> tp_split_60_3 [label="Gate selection 60" style=dashed]
	tp_split_60_3 -> expert_compute_60_0_3
	tp_split_60_3 -> expert_compute_60_1_3
	expert_compute_60_0_3 -> tp_allreduce_60_3
	expert_compute_60_1_3 -> tp_allreduce_60_3
	tp_allreduce_60_3 -> expert_60_3
	expert_60_3 -> expert_agg_3 [label="Expert 60 output"]
	moe_gate_3 -> tp_split_61_3 [label="Gate selection 61" style=dashed]
	tp_split_61_3 -> expert_compute_61_0_3
	tp_split_61_3 -> expert_compute_61_1_3
	expert_compute_61_0_3 -> tp_allreduce_61_3
	expert_compute_61_1_3 -> tp_allreduce_61_3
	tp_allreduce_61_3 -> expert_61_3
	expert_61_3 -> expert_agg_3 [label="Expert 61 output"]
	moe_gate_3 -> tp_split_62_3 [label="Gate selection 62" style=dashed]
	tp_split_62_3 -> expert_compute_62_0_3
	tp_split_62_3 -> expert_compute_62_1_3
	expert_compute_62_0_3 -> tp_allreduce_62_3
	expert_compute_62_1_3 -> tp_allreduce_62_3
	tp_allreduce_62_3 -> expert_62_3
	expert_62_3 -> expert_agg_3 [label="Expert 62 output"]
	moe_gate_3 -> tp_split_63_3 [label="Gate selection 63" style=dashed]
	tp_split_63_3 -> expert_compute_63_0_3
	tp_split_63_3 -> expert_compute_63_1_3
	expert_compute_63_0_3 -> tp_allreduce_63_3
	expert_compute_63_1_3 -> tp_allreduce_63_3
	tp_allreduce_63_3 -> expert_63_3
	expert_63_3 -> expert_agg_3 [label="Expert 63 output"]
	expert_agg_3 -> layer_norm_3
	layer_norm_3 -> attn_norm_4
	attn_norm_4 -> attn_q_4
	attn_norm_4 -> attn_k_4
	attn_norm_4 -> attn_v_4
	attn_q_4 -> attn_score_4
	attn_k_4 -> attn_score_4
	attn_v_4 -> attn_out_4
	attn_score_4 -> attn_out_4
	attn_out_4 -> moe_gate_4
	moe_gate_4 -> tp_split_0_4 [label="Gate selection 0" style=dashed]
	tp_split_0_4 -> expert_compute_0_0_4
	tp_split_0_4 -> expert_compute_0_1_4
	expert_compute_0_0_4 -> tp_allreduce_0_4
	expert_compute_0_1_4 -> tp_allreduce_0_4
	tp_allreduce_0_4 -> expert_0_4
	expert_0_4 -> expert_agg_4 [label="Expert 0 output"]
	moe_gate_4 -> tp_split_1_4 [label="Gate selection 1" style=dashed]
	tp_split_1_4 -> expert_compute_1_0_4
	tp_split_1_4 -> expert_compute_1_1_4
	expert_compute_1_0_4 -> tp_allreduce_1_4
	expert_compute_1_1_4 -> tp_allreduce_1_4
	tp_allreduce_1_4 -> expert_1_4
	expert_1_4 -> expert_agg_4 [label="Expert 1 output"]
	moe_gate_4 -> tp_split_2_4 [label="Gate selection 2" style=dashed]
	tp_split_2_4 -> expert_compute_2_0_4
	tp_split_2_4 -> expert_compute_2_1_4
	expert_compute_2_0_4 -> tp_allreduce_2_4
	expert_compute_2_1_4 -> tp_allreduce_2_4
	tp_allreduce_2_4 -> expert_2_4
	expert_2_4 -> expert_agg_4 [label="Expert 2 output"]
	moe_gate_4 -> tp_split_3_4 [label="Gate selection 3" style=dashed]
	tp_split_3_4 -> expert_compute_3_0_4
	tp_split_3_4 -> expert_compute_3_1_4
	expert_compute_3_0_4 -> tp_allreduce_3_4
	expert_compute_3_1_4 -> tp_allreduce_3_4
	tp_allreduce_3_4 -> expert_3_4
	expert_3_4 -> expert_agg_4 [label="Expert 3 output"]
	moe_gate_4 -> tp_split_4_4 [label="Gate selection 4" style=dashed]
	tp_split_4_4 -> expert_compute_4_0_4
	tp_split_4_4 -> expert_compute_4_1_4
	expert_compute_4_0_4 -> tp_allreduce_4_4
	expert_compute_4_1_4 -> tp_allreduce_4_4
	tp_allreduce_4_4 -> expert_4_4
	expert_4_4 -> expert_agg_4 [label="Expert 4 output"]
	moe_gate_4 -> tp_split_5_4 [label="Gate selection 5" style=dashed]
	tp_split_5_4 -> expert_compute_5_0_4
	tp_split_5_4 -> expert_compute_5_1_4
	expert_compute_5_0_4 -> tp_allreduce_5_4
	expert_compute_5_1_4 -> tp_allreduce_5_4
	tp_allreduce_5_4 -> expert_5_4
	expert_5_4 -> expert_agg_4 [label="Expert 5 output"]
	moe_gate_4 -> tp_split_6_4 [label="Gate selection 6" style=dashed]
	tp_split_6_4 -> expert_compute_6_0_4
	tp_split_6_4 -> expert_compute_6_1_4
	expert_compute_6_0_4 -> tp_allreduce_6_4
	expert_compute_6_1_4 -> tp_allreduce_6_4
	tp_allreduce_6_4 -> expert_6_4
	expert_6_4 -> expert_agg_4 [label="Expert 6 output"]
	moe_gate_4 -> tp_split_7_4 [label="Gate selection 7" style=dashed]
	tp_split_7_4 -> expert_compute_7_0_4
	tp_split_7_4 -> expert_compute_7_1_4
	expert_compute_7_0_4 -> tp_allreduce_7_4
	expert_compute_7_1_4 -> tp_allreduce_7_4
	tp_allreduce_7_4 -> expert_7_4
	expert_7_4 -> expert_agg_4 [label="Expert 7 output"]
	moe_gate_4 -> tp_split_8_4 [label="Gate selection 8" style=dashed]
	tp_split_8_4 -> expert_compute_8_0_4
	tp_split_8_4 -> expert_compute_8_1_4
	expert_compute_8_0_4 -> tp_allreduce_8_4
	expert_compute_8_1_4 -> tp_allreduce_8_4
	tp_allreduce_8_4 -> expert_8_4
	expert_8_4 -> expert_agg_4 [label="Expert 8 output"]
	moe_gate_4 -> tp_split_9_4 [label="Gate selection 9" style=dashed]
	tp_split_9_4 -> expert_compute_9_0_4
	tp_split_9_4 -> expert_compute_9_1_4
	expert_compute_9_0_4 -> tp_allreduce_9_4
	expert_compute_9_1_4 -> tp_allreduce_9_4
	tp_allreduce_9_4 -> expert_9_4
	expert_9_4 -> expert_agg_4 [label="Expert 9 output"]
	moe_gate_4 -> tp_split_10_4 [label="Gate selection 10" style=dashed]
	tp_split_10_4 -> expert_compute_10_0_4
	tp_split_10_4 -> expert_compute_10_1_4
	expert_compute_10_0_4 -> tp_allreduce_10_4
	expert_compute_10_1_4 -> tp_allreduce_10_4
	tp_allreduce_10_4 -> expert_10_4
	expert_10_4 -> expert_agg_4 [label="Expert 10 output"]
	moe_gate_4 -> tp_split_11_4 [label="Gate selection 11" style=dashed]
	tp_split_11_4 -> expert_compute_11_0_4
	tp_split_11_4 -> expert_compute_11_1_4
	expert_compute_11_0_4 -> tp_allreduce_11_4
	expert_compute_11_1_4 -> tp_allreduce_11_4
	tp_allreduce_11_4 -> expert_11_4
	expert_11_4 -> expert_agg_4 [label="Expert 11 output"]
	moe_gate_4 -> tp_split_12_4 [label="Gate selection 12" style=dashed]
	tp_split_12_4 -> expert_compute_12_0_4
	tp_split_12_4 -> expert_compute_12_1_4
	expert_compute_12_0_4 -> tp_allreduce_12_4
	expert_compute_12_1_4 -> tp_allreduce_12_4
	tp_allreduce_12_4 -> expert_12_4
	expert_12_4 -> expert_agg_4 [label="Expert 12 output"]
	moe_gate_4 -> tp_split_13_4 [label="Gate selection 13" style=dashed]
	tp_split_13_4 -> expert_compute_13_0_4
	tp_split_13_4 -> expert_compute_13_1_4
	expert_compute_13_0_4 -> tp_allreduce_13_4
	expert_compute_13_1_4 -> tp_allreduce_13_4
	tp_allreduce_13_4 -> expert_13_4
	expert_13_4 -> expert_agg_4 [label="Expert 13 output"]
	moe_gate_4 -> tp_split_14_4 [label="Gate selection 14" style=dashed]
	tp_split_14_4 -> expert_compute_14_0_4
	tp_split_14_4 -> expert_compute_14_1_4
	expert_compute_14_0_4 -> tp_allreduce_14_4
	expert_compute_14_1_4 -> tp_allreduce_14_4
	tp_allreduce_14_4 -> expert_14_4
	expert_14_4 -> expert_agg_4 [label="Expert 14 output"]
	moe_gate_4 -> tp_split_15_4 [label="Gate selection 15" style=dashed]
	tp_split_15_4 -> expert_compute_15_0_4
	tp_split_15_4 -> expert_compute_15_1_4
	expert_compute_15_0_4 -> tp_allreduce_15_4
	expert_compute_15_1_4 -> tp_allreduce_15_4
	tp_allreduce_15_4 -> expert_15_4
	expert_15_4 -> expert_agg_4 [label="Expert 15 output"]
	moe_gate_4 -> tp_split_16_4 [label="Gate selection 16" style=dashed]
	tp_split_16_4 -> expert_compute_16_0_4
	tp_split_16_4 -> expert_compute_16_1_4
	expert_compute_16_0_4 -> tp_allreduce_16_4
	expert_compute_16_1_4 -> tp_allreduce_16_4
	tp_allreduce_16_4 -> expert_16_4
	expert_16_4 -> expert_agg_4 [label="Expert 16 output"]
	moe_gate_4 -> tp_split_17_4 [label="Gate selection 17" style=dashed]
	tp_split_17_4 -> expert_compute_17_0_4
	tp_split_17_4 -> expert_compute_17_1_4
	expert_compute_17_0_4 -> tp_allreduce_17_4
	expert_compute_17_1_4 -> tp_allreduce_17_4
	tp_allreduce_17_4 -> expert_17_4
	expert_17_4 -> expert_agg_4 [label="Expert 17 output"]
	moe_gate_4 -> tp_split_18_4 [label="Gate selection 18" style=dashed]
	tp_split_18_4 -> expert_compute_18_0_4
	tp_split_18_4 -> expert_compute_18_1_4
	expert_compute_18_0_4 -> tp_allreduce_18_4
	expert_compute_18_1_4 -> tp_allreduce_18_4
	tp_allreduce_18_4 -> expert_18_4
	expert_18_4 -> expert_agg_4 [label="Expert 18 output"]
	moe_gate_4 -> tp_split_19_4 [label="Gate selection 19" style=dashed]
	tp_split_19_4 -> expert_compute_19_0_4
	tp_split_19_4 -> expert_compute_19_1_4
	expert_compute_19_0_4 -> tp_allreduce_19_4
	expert_compute_19_1_4 -> tp_allreduce_19_4
	tp_allreduce_19_4 -> expert_19_4
	expert_19_4 -> expert_agg_4 [label="Expert 19 output"]
	moe_gate_4 -> tp_split_20_4 [label="Gate selection 20" style=dashed]
	tp_split_20_4 -> expert_compute_20_0_4
	tp_split_20_4 -> expert_compute_20_1_4
	expert_compute_20_0_4 -> tp_allreduce_20_4
	expert_compute_20_1_4 -> tp_allreduce_20_4
	tp_allreduce_20_4 -> expert_20_4
	expert_20_4 -> expert_agg_4 [label="Expert 20 output"]
	moe_gate_4 -> tp_split_21_4 [label="Gate selection 21" style=dashed]
	tp_split_21_4 -> expert_compute_21_0_4
	tp_split_21_4 -> expert_compute_21_1_4
	expert_compute_21_0_4 -> tp_allreduce_21_4
	expert_compute_21_1_4 -> tp_allreduce_21_4
	tp_allreduce_21_4 -> expert_21_4
	expert_21_4 -> expert_agg_4 [label="Expert 21 output"]
	moe_gate_4 -> tp_split_22_4 [label="Gate selection 22" style=dashed]
	tp_split_22_4 -> expert_compute_22_0_4
	tp_split_22_4 -> expert_compute_22_1_4
	expert_compute_22_0_4 -> tp_allreduce_22_4
	expert_compute_22_1_4 -> tp_allreduce_22_4
	tp_allreduce_22_4 -> expert_22_4
	expert_22_4 -> expert_agg_4 [label="Expert 22 output"]
	moe_gate_4 -> tp_split_23_4 [label="Gate selection 23" style=dashed]
	tp_split_23_4 -> expert_compute_23_0_4
	tp_split_23_4 -> expert_compute_23_1_4
	expert_compute_23_0_4 -> tp_allreduce_23_4
	expert_compute_23_1_4 -> tp_allreduce_23_4
	tp_allreduce_23_4 -> expert_23_4
	expert_23_4 -> expert_agg_4 [label="Expert 23 output"]
	moe_gate_4 -> tp_split_24_4 [label="Gate selection 24" style=dashed]
	tp_split_24_4 -> expert_compute_24_0_4
	tp_split_24_4 -> expert_compute_24_1_4
	expert_compute_24_0_4 -> tp_allreduce_24_4
	expert_compute_24_1_4 -> tp_allreduce_24_4
	tp_allreduce_24_4 -> expert_24_4
	expert_24_4 -> expert_agg_4 [label="Expert 24 output"]
	moe_gate_4 -> tp_split_25_4 [label="Gate selection 25" style=dashed]
	tp_split_25_4 -> expert_compute_25_0_4
	tp_split_25_4 -> expert_compute_25_1_4
	expert_compute_25_0_4 -> tp_allreduce_25_4
	expert_compute_25_1_4 -> tp_allreduce_25_4
	tp_allreduce_25_4 -> expert_25_4
	expert_25_4 -> expert_agg_4 [label="Expert 25 output"]
	moe_gate_4 -> tp_split_26_4 [label="Gate selection 26" style=dashed]
	tp_split_26_4 -> expert_compute_26_0_4
	tp_split_26_4 -> expert_compute_26_1_4
	expert_compute_26_0_4 -> tp_allreduce_26_4
	expert_compute_26_1_4 -> tp_allreduce_26_4
	tp_allreduce_26_4 -> expert_26_4
	expert_26_4 -> expert_agg_4 [label="Expert 26 output"]
	moe_gate_4 -> tp_split_27_4 [label="Gate selection 27" style=dashed]
	tp_split_27_4 -> expert_compute_27_0_4
	tp_split_27_4 -> expert_compute_27_1_4
	expert_compute_27_0_4 -> tp_allreduce_27_4
	expert_compute_27_1_4 -> tp_allreduce_27_4
	tp_allreduce_27_4 -> expert_27_4
	expert_27_4 -> expert_agg_4 [label="Expert 27 output"]
	moe_gate_4 -> tp_split_28_4 [label="Gate selection 28" style=dashed]
	tp_split_28_4 -> expert_compute_28_0_4
	tp_split_28_4 -> expert_compute_28_1_4
	expert_compute_28_0_4 -> tp_allreduce_28_4
	expert_compute_28_1_4 -> tp_allreduce_28_4
	tp_allreduce_28_4 -> expert_28_4
	expert_28_4 -> expert_agg_4 [label="Expert 28 output"]
	moe_gate_4 -> tp_split_29_4 [label="Gate selection 29" style=dashed]
	tp_split_29_4 -> expert_compute_29_0_4
	tp_split_29_4 -> expert_compute_29_1_4
	expert_compute_29_0_4 -> tp_allreduce_29_4
	expert_compute_29_1_4 -> tp_allreduce_29_4
	tp_allreduce_29_4 -> expert_29_4
	expert_29_4 -> expert_agg_4 [label="Expert 29 output"]
	moe_gate_4 -> tp_split_30_4 [label="Gate selection 30" style=dashed]
	tp_split_30_4 -> expert_compute_30_0_4
	tp_split_30_4 -> expert_compute_30_1_4
	expert_compute_30_0_4 -> tp_allreduce_30_4
	expert_compute_30_1_4 -> tp_allreduce_30_4
	tp_allreduce_30_4 -> expert_30_4
	expert_30_4 -> expert_agg_4 [label="Expert 30 output"]
	moe_gate_4 -> tp_split_31_4 [label="Gate selection 31" style=dashed]
	tp_split_31_4 -> expert_compute_31_0_4
	tp_split_31_4 -> expert_compute_31_1_4
	expert_compute_31_0_4 -> tp_allreduce_31_4
	expert_compute_31_1_4 -> tp_allreduce_31_4
	tp_allreduce_31_4 -> expert_31_4
	expert_31_4 -> expert_agg_4 [label="Expert 31 output"]
	moe_gate_4 -> tp_split_32_4 [label="Gate selection 32" style=dashed]
	tp_split_32_4 -> expert_compute_32_0_4
	tp_split_32_4 -> expert_compute_32_1_4
	expert_compute_32_0_4 -> tp_allreduce_32_4
	expert_compute_32_1_4 -> tp_allreduce_32_4
	tp_allreduce_32_4 -> expert_32_4
	expert_32_4 -> expert_agg_4 [label="Expert 32 output"]
	moe_gate_4 -> tp_split_33_4 [label="Gate selection 33" style=dashed]
	tp_split_33_4 -> expert_compute_33_0_4
	tp_split_33_4 -> expert_compute_33_1_4
	expert_compute_33_0_4 -> tp_allreduce_33_4
	expert_compute_33_1_4 -> tp_allreduce_33_4
	tp_allreduce_33_4 -> expert_33_4
	expert_33_4 -> expert_agg_4 [label="Expert 33 output"]
	moe_gate_4 -> tp_split_34_4 [label="Gate selection 34" style=dashed]
	tp_split_34_4 -> expert_compute_34_0_4
	tp_split_34_4 -> expert_compute_34_1_4
	expert_compute_34_0_4 -> tp_allreduce_34_4
	expert_compute_34_1_4 -> tp_allreduce_34_4
	tp_allreduce_34_4 -> expert_34_4
	expert_34_4 -> expert_agg_4 [label="Expert 34 output"]
	moe_gate_4 -> tp_split_35_4 [label="Gate selection 35" style=dashed]
	tp_split_35_4 -> expert_compute_35_0_4
	tp_split_35_4 -> expert_compute_35_1_4
	expert_compute_35_0_4 -> tp_allreduce_35_4
	expert_compute_35_1_4 -> tp_allreduce_35_4
	tp_allreduce_35_4 -> expert_35_4
	expert_35_4 -> expert_agg_4 [label="Expert 35 output"]
	moe_gate_4 -> tp_split_36_4 [label="Gate selection 36" style=dashed]
	tp_split_36_4 -> expert_compute_36_0_4
	tp_split_36_4 -> expert_compute_36_1_4
	expert_compute_36_0_4 -> tp_allreduce_36_4
	expert_compute_36_1_4 -> tp_allreduce_36_4
	tp_allreduce_36_4 -> expert_36_4
	expert_36_4 -> expert_agg_4 [label="Expert 36 output"]
	moe_gate_4 -> tp_split_37_4 [label="Gate selection 37" style=dashed]
	tp_split_37_4 -> expert_compute_37_0_4
	tp_split_37_4 -> expert_compute_37_1_4
	expert_compute_37_0_4 -> tp_allreduce_37_4
	expert_compute_37_1_4 -> tp_allreduce_37_4
	tp_allreduce_37_4 -> expert_37_4
	expert_37_4 -> expert_agg_4 [label="Expert 37 output"]
	moe_gate_4 -> tp_split_38_4 [label="Gate selection 38" style=dashed]
	tp_split_38_4 -> expert_compute_38_0_4
	tp_split_38_4 -> expert_compute_38_1_4
	expert_compute_38_0_4 -> tp_allreduce_38_4
	expert_compute_38_1_4 -> tp_allreduce_38_4
	tp_allreduce_38_4 -> expert_38_4
	expert_38_4 -> expert_agg_4 [label="Expert 38 output"]
	moe_gate_4 -> tp_split_39_4 [label="Gate selection 39" style=dashed]
	tp_split_39_4 -> expert_compute_39_0_4
	tp_split_39_4 -> expert_compute_39_1_4
	expert_compute_39_0_4 -> tp_allreduce_39_4
	expert_compute_39_1_4 -> tp_allreduce_39_4
	tp_allreduce_39_4 -> expert_39_4
	expert_39_4 -> expert_agg_4 [label="Expert 39 output"]
	moe_gate_4 -> tp_split_40_4 [label="Gate selection 40" style=dashed]
	tp_split_40_4 -> expert_compute_40_0_4
	tp_split_40_4 -> expert_compute_40_1_4
	expert_compute_40_0_4 -> tp_allreduce_40_4
	expert_compute_40_1_4 -> tp_allreduce_40_4
	tp_allreduce_40_4 -> expert_40_4
	expert_40_4 -> expert_agg_4 [label="Expert 40 output"]
	moe_gate_4 -> tp_split_41_4 [label="Gate selection 41" style=dashed]
	tp_split_41_4 -> expert_compute_41_0_4
	tp_split_41_4 -> expert_compute_41_1_4
	expert_compute_41_0_4 -> tp_allreduce_41_4
	expert_compute_41_1_4 -> tp_allreduce_41_4
	tp_allreduce_41_4 -> expert_41_4
	expert_41_4 -> expert_agg_4 [label="Expert 41 output"]
	moe_gate_4 -> tp_split_42_4 [label="Gate selection 42" style=dashed]
	tp_split_42_4 -> expert_compute_42_0_4
	tp_split_42_4 -> expert_compute_42_1_4
	expert_compute_42_0_4 -> tp_allreduce_42_4
	expert_compute_42_1_4 -> tp_allreduce_42_4
	tp_allreduce_42_4 -> expert_42_4
	expert_42_4 -> expert_agg_4 [label="Expert 42 output"]
	moe_gate_4 -> tp_split_43_4 [label="Gate selection 43" style=dashed]
	tp_split_43_4 -> expert_compute_43_0_4
	tp_split_43_4 -> expert_compute_43_1_4
	expert_compute_43_0_4 -> tp_allreduce_43_4
	expert_compute_43_1_4 -> tp_allreduce_43_4
	tp_allreduce_43_4 -> expert_43_4
	expert_43_4 -> expert_agg_4 [label="Expert 43 output"]
	moe_gate_4 -> tp_split_44_4 [label="Gate selection 44" style=dashed]
	tp_split_44_4 -> expert_compute_44_0_4
	tp_split_44_4 -> expert_compute_44_1_4
	expert_compute_44_0_4 -> tp_allreduce_44_4
	expert_compute_44_1_4 -> tp_allreduce_44_4
	tp_allreduce_44_4 -> expert_44_4
	expert_44_4 -> expert_agg_4 [label="Expert 44 output"]
	moe_gate_4 -> tp_split_45_4 [label="Gate selection 45" style=dashed]
	tp_split_45_4 -> expert_compute_45_0_4
	tp_split_45_4 -> expert_compute_45_1_4
	expert_compute_45_0_4 -> tp_allreduce_45_4
	expert_compute_45_1_4 -> tp_allreduce_45_4
	tp_allreduce_45_4 -> expert_45_4
	expert_45_4 -> expert_agg_4 [label="Expert 45 output"]
	moe_gate_4 -> tp_split_46_4 [label="Gate selection 46" style=dashed]
	tp_split_46_4 -> expert_compute_46_0_4
	tp_split_46_4 -> expert_compute_46_1_4
	expert_compute_46_0_4 -> tp_allreduce_46_4
	expert_compute_46_1_4 -> tp_allreduce_46_4
	tp_allreduce_46_4 -> expert_46_4
	expert_46_4 -> expert_agg_4 [label="Expert 46 output"]
	moe_gate_4 -> tp_split_47_4 [label="Gate selection 47" style=dashed]
	tp_split_47_4 -> expert_compute_47_0_4
	tp_split_47_4 -> expert_compute_47_1_4
	expert_compute_47_0_4 -> tp_allreduce_47_4
	expert_compute_47_1_4 -> tp_allreduce_47_4
	tp_allreduce_47_4 -> expert_47_4
	expert_47_4 -> expert_agg_4 [label="Expert 47 output"]
	moe_gate_4 -> tp_split_48_4 [label="Gate selection 48" style=dashed]
	tp_split_48_4 -> expert_compute_48_0_4
	tp_split_48_4 -> expert_compute_48_1_4
	expert_compute_48_0_4 -> tp_allreduce_48_4
	expert_compute_48_1_4 -> tp_allreduce_48_4
	tp_allreduce_48_4 -> expert_48_4
	expert_48_4 -> expert_agg_4 [label="Expert 48 output"]
	moe_gate_4 -> tp_split_49_4 [label="Gate selection 49" style=dashed]
	tp_split_49_4 -> expert_compute_49_0_4
	tp_split_49_4 -> expert_compute_49_1_4
	expert_compute_49_0_4 -> tp_allreduce_49_4
	expert_compute_49_1_4 -> tp_allreduce_49_4
	tp_allreduce_49_4 -> expert_49_4
	expert_49_4 -> expert_agg_4 [label="Expert 49 output"]
	moe_gate_4 -> tp_split_50_4 [label="Gate selection 50" style=dashed]
	tp_split_50_4 -> expert_compute_50_0_4
	tp_split_50_4 -> expert_compute_50_1_4
	expert_compute_50_0_4 -> tp_allreduce_50_4
	expert_compute_50_1_4 -> tp_allreduce_50_4
	tp_allreduce_50_4 -> expert_50_4
	expert_50_4 -> expert_agg_4 [label="Expert 50 output"]
	moe_gate_4 -> tp_split_51_4 [label="Gate selection 51" style=dashed]
	tp_split_51_4 -> expert_compute_51_0_4
	tp_split_51_4 -> expert_compute_51_1_4
	expert_compute_51_0_4 -> tp_allreduce_51_4
	expert_compute_51_1_4 -> tp_allreduce_51_4
	tp_allreduce_51_4 -> expert_51_4
	expert_51_4 -> expert_agg_4 [label="Expert 51 output"]
	moe_gate_4 -> tp_split_52_4 [label="Gate selection 52" style=dashed]
	tp_split_52_4 -> expert_compute_52_0_4
	tp_split_52_4 -> expert_compute_52_1_4
	expert_compute_52_0_4 -> tp_allreduce_52_4
	expert_compute_52_1_4 -> tp_allreduce_52_4
	tp_allreduce_52_4 -> expert_52_4
	expert_52_4 -> expert_agg_4 [label="Expert 52 output"]
	moe_gate_4 -> tp_split_53_4 [label="Gate selection 53" style=dashed]
	tp_split_53_4 -> expert_compute_53_0_4
	tp_split_53_4 -> expert_compute_53_1_4
	expert_compute_53_0_4 -> tp_allreduce_53_4
	expert_compute_53_1_4 -> tp_allreduce_53_4
	tp_allreduce_53_4 -> expert_53_4
	expert_53_4 -> expert_agg_4 [label="Expert 53 output"]
	moe_gate_4 -> tp_split_54_4 [label="Gate selection 54" style=dashed]
	tp_split_54_4 -> expert_compute_54_0_4
	tp_split_54_4 -> expert_compute_54_1_4
	expert_compute_54_0_4 -> tp_allreduce_54_4
	expert_compute_54_1_4 -> tp_allreduce_54_4
	tp_allreduce_54_4 -> expert_54_4
	expert_54_4 -> expert_agg_4 [label="Expert 54 output"]
	moe_gate_4 -> tp_split_55_4 [label="Gate selection 55" style=dashed]
	tp_split_55_4 -> expert_compute_55_0_4
	tp_split_55_4 -> expert_compute_55_1_4
	expert_compute_55_0_4 -> tp_allreduce_55_4
	expert_compute_55_1_4 -> tp_allreduce_55_4
	tp_allreduce_55_4 -> expert_55_4
	expert_55_4 -> expert_agg_4 [label="Expert 55 output"]
	moe_gate_4 -> tp_split_56_4 [label="Gate selection 56" style=dashed]
	tp_split_56_4 -> expert_compute_56_0_4
	tp_split_56_4 -> expert_compute_56_1_4
	expert_compute_56_0_4 -> tp_allreduce_56_4
	expert_compute_56_1_4 -> tp_allreduce_56_4
	tp_allreduce_56_4 -> expert_56_4
	expert_56_4 -> expert_agg_4 [label="Expert 56 output"]
	moe_gate_4 -> tp_split_57_4 [label="Gate selection 57" style=dashed]
	tp_split_57_4 -> expert_compute_57_0_4
	tp_split_57_4 -> expert_compute_57_1_4
	expert_compute_57_0_4 -> tp_allreduce_57_4
	expert_compute_57_1_4 -> tp_allreduce_57_4
	tp_allreduce_57_4 -> expert_57_4
	expert_57_4 -> expert_agg_4 [label="Expert 57 output"]
	moe_gate_4 -> tp_split_58_4 [label="Gate selection 58" style=dashed]
	tp_split_58_4 -> expert_compute_58_0_4
	tp_split_58_4 -> expert_compute_58_1_4
	expert_compute_58_0_4 -> tp_allreduce_58_4
	expert_compute_58_1_4 -> tp_allreduce_58_4
	tp_allreduce_58_4 -> expert_58_4
	expert_58_4 -> expert_agg_4 [label="Expert 58 output"]
	moe_gate_4 -> tp_split_59_4 [label="Gate selection 59" style=dashed]
	tp_split_59_4 -> expert_compute_59_0_4
	tp_split_59_4 -> expert_compute_59_1_4
	expert_compute_59_0_4 -> tp_allreduce_59_4
	expert_compute_59_1_4 -> tp_allreduce_59_4
	tp_allreduce_59_4 -> expert_59_4
	expert_59_4 -> expert_agg_4 [label="Expert 59 output"]
	moe_gate_4 -> tp_split_60_4 [label="Gate selection 60" style=dashed]
	tp_split_60_4 -> expert_compute_60_0_4
	tp_split_60_4 -> expert_compute_60_1_4
	expert_compute_60_0_4 -> tp_allreduce_60_4
	expert_compute_60_1_4 -> tp_allreduce_60_4
	tp_allreduce_60_4 -> expert_60_4
	expert_60_4 -> expert_agg_4 [label="Expert 60 output"]
	moe_gate_4 -> tp_split_61_4 [label="Gate selection 61" style=dashed]
	tp_split_61_4 -> expert_compute_61_0_4
	tp_split_61_4 -> expert_compute_61_1_4
	expert_compute_61_0_4 -> tp_allreduce_61_4
	expert_compute_61_1_4 -> tp_allreduce_61_4
	tp_allreduce_61_4 -> expert_61_4
	expert_61_4 -> expert_agg_4 [label="Expert 61 output"]
	moe_gate_4 -> tp_split_62_4 [label="Gate selection 62" style=dashed]
	tp_split_62_4 -> expert_compute_62_0_4
	tp_split_62_4 -> expert_compute_62_1_4
	expert_compute_62_0_4 -> tp_allreduce_62_4
	expert_compute_62_1_4 -> tp_allreduce_62_4
	tp_allreduce_62_4 -> expert_62_4
	expert_62_4 -> expert_agg_4 [label="Expert 62 output"]
	moe_gate_4 -> tp_split_63_4 [label="Gate selection 63" style=dashed]
	tp_split_63_4 -> expert_compute_63_0_4
	tp_split_63_4 -> expert_compute_63_1_4
	expert_compute_63_0_4 -> tp_allreduce_63_4
	expert_compute_63_1_4 -> tp_allreduce_63_4
	tp_allreduce_63_4 -> expert_63_4
	expert_63_4 -> expert_agg_4 [label="Expert 63 output"]
	expert_agg_4 -> layer_norm_4
	layer_norm_4 -> attn_norm_5
	attn_norm_5 -> attn_q_5
	attn_norm_5 -> attn_k_5
	attn_norm_5 -> attn_v_5
	attn_q_5 -> attn_score_5
	attn_k_5 -> attn_score_5
	attn_v_5 -> attn_out_5
	attn_score_5 -> attn_out_5
	attn_out_5 -> moe_gate_5
	moe_gate_5 -> tp_split_0_5 [label="Gate selection 0" style=dashed]
	tp_split_0_5 -> expert_compute_0_0_5
	tp_split_0_5 -> expert_compute_0_1_5
	expert_compute_0_0_5 -> tp_allreduce_0_5
	expert_compute_0_1_5 -> tp_allreduce_0_5
	tp_allreduce_0_5 -> expert_0_5
	expert_0_5 -> expert_agg_5 [label="Expert 0 output"]
	moe_gate_5 -> tp_split_1_5 [label="Gate selection 1" style=dashed]
	tp_split_1_5 -> expert_compute_1_0_5
	tp_split_1_5 -> expert_compute_1_1_5
	expert_compute_1_0_5 -> tp_allreduce_1_5
	expert_compute_1_1_5 -> tp_allreduce_1_5
	tp_allreduce_1_5 -> expert_1_5
	expert_1_5 -> expert_agg_5 [label="Expert 1 output"]
	moe_gate_5 -> tp_split_2_5 [label="Gate selection 2" style=dashed]
	tp_split_2_5 -> expert_compute_2_0_5
	tp_split_2_5 -> expert_compute_2_1_5
	expert_compute_2_0_5 -> tp_allreduce_2_5
	expert_compute_2_1_5 -> tp_allreduce_2_5
	tp_allreduce_2_5 -> expert_2_5
	expert_2_5 -> expert_agg_5 [label="Expert 2 output"]
	moe_gate_5 -> tp_split_3_5 [label="Gate selection 3" style=dashed]
	tp_split_3_5 -> expert_compute_3_0_5
	tp_split_3_5 -> expert_compute_3_1_5
	expert_compute_3_0_5 -> tp_allreduce_3_5
	expert_compute_3_1_5 -> tp_allreduce_3_5
	tp_allreduce_3_5 -> expert_3_5
	expert_3_5 -> expert_agg_5 [label="Expert 3 output"]
	moe_gate_5 -> tp_split_4_5 [label="Gate selection 4" style=dashed]
	tp_split_4_5 -> expert_compute_4_0_5
	tp_split_4_5 -> expert_compute_4_1_5
	expert_compute_4_0_5 -> tp_allreduce_4_5
	expert_compute_4_1_5 -> tp_allreduce_4_5
	tp_allreduce_4_5 -> expert_4_5
	expert_4_5 -> expert_agg_5 [label="Expert 4 output"]
	moe_gate_5 -> tp_split_5_5 [label="Gate selection 5" style=dashed]
	tp_split_5_5 -> expert_compute_5_0_5
	tp_split_5_5 -> expert_compute_5_1_5
	expert_compute_5_0_5 -> tp_allreduce_5_5
	expert_compute_5_1_5 -> tp_allreduce_5_5
	tp_allreduce_5_5 -> expert_5_5
	expert_5_5 -> expert_agg_5 [label="Expert 5 output"]
	moe_gate_5 -> tp_split_6_5 [label="Gate selection 6" style=dashed]
	tp_split_6_5 -> expert_compute_6_0_5
	tp_split_6_5 -> expert_compute_6_1_5
	expert_compute_6_0_5 -> tp_allreduce_6_5
	expert_compute_6_1_5 -> tp_allreduce_6_5
	tp_allreduce_6_5 -> expert_6_5
	expert_6_5 -> expert_agg_5 [label="Expert 6 output"]
	moe_gate_5 -> tp_split_7_5 [label="Gate selection 7" style=dashed]
	tp_split_7_5 -> expert_compute_7_0_5
	tp_split_7_5 -> expert_compute_7_1_5
	expert_compute_7_0_5 -> tp_allreduce_7_5
	expert_compute_7_1_5 -> tp_allreduce_7_5
	tp_allreduce_7_5 -> expert_7_5
	expert_7_5 -> expert_agg_5 [label="Expert 7 output"]
	moe_gate_5 -> tp_split_8_5 [label="Gate selection 8" style=dashed]
	tp_split_8_5 -> expert_compute_8_0_5
	tp_split_8_5 -> expert_compute_8_1_5
	expert_compute_8_0_5 -> tp_allreduce_8_5
	expert_compute_8_1_5 -> tp_allreduce_8_5
	tp_allreduce_8_5 -> expert_8_5
	expert_8_5 -> expert_agg_5 [label="Expert 8 output"]
	moe_gate_5 -> tp_split_9_5 [label="Gate selection 9" style=dashed]
	tp_split_9_5 -> expert_compute_9_0_5
	tp_split_9_5 -> expert_compute_9_1_5
	expert_compute_9_0_5 -> tp_allreduce_9_5
	expert_compute_9_1_5 -> tp_allreduce_9_5
	tp_allreduce_9_5 -> expert_9_5
	expert_9_5 -> expert_agg_5 [label="Expert 9 output"]
	moe_gate_5 -> tp_split_10_5 [label="Gate selection 10" style=dashed]
	tp_split_10_5 -> expert_compute_10_0_5
	tp_split_10_5 -> expert_compute_10_1_5
	expert_compute_10_0_5 -> tp_allreduce_10_5
	expert_compute_10_1_5 -> tp_allreduce_10_5
	tp_allreduce_10_5 -> expert_10_5
	expert_10_5 -> expert_agg_5 [label="Expert 10 output"]
	moe_gate_5 -> tp_split_11_5 [label="Gate selection 11" style=dashed]
	tp_split_11_5 -> expert_compute_11_0_5
	tp_split_11_5 -> expert_compute_11_1_5
	expert_compute_11_0_5 -> tp_allreduce_11_5
	expert_compute_11_1_5 -> tp_allreduce_11_5
	tp_allreduce_11_5 -> expert_11_5
	expert_11_5 -> expert_agg_5 [label="Expert 11 output"]
	moe_gate_5 -> tp_split_12_5 [label="Gate selection 12" style=dashed]
	tp_split_12_5 -> expert_compute_12_0_5
	tp_split_12_5 -> expert_compute_12_1_5
	expert_compute_12_0_5 -> tp_allreduce_12_5
	expert_compute_12_1_5 -> tp_allreduce_12_5
	tp_allreduce_12_5 -> expert_12_5
	expert_12_5 -> expert_agg_5 [label="Expert 12 output"]
	moe_gate_5 -> tp_split_13_5 [label="Gate selection 13" style=dashed]
	tp_split_13_5 -> expert_compute_13_0_5
	tp_split_13_5 -> expert_compute_13_1_5
	expert_compute_13_0_5 -> tp_allreduce_13_5
	expert_compute_13_1_5 -> tp_allreduce_13_5
	tp_allreduce_13_5 -> expert_13_5
	expert_13_5 -> expert_agg_5 [label="Expert 13 output"]
	moe_gate_5 -> tp_split_14_5 [label="Gate selection 14" style=dashed]
	tp_split_14_5 -> expert_compute_14_0_5
	tp_split_14_5 -> expert_compute_14_1_5
	expert_compute_14_0_5 -> tp_allreduce_14_5
	expert_compute_14_1_5 -> tp_allreduce_14_5
	tp_allreduce_14_5 -> expert_14_5
	expert_14_5 -> expert_agg_5 [label="Expert 14 output"]
	moe_gate_5 -> tp_split_15_5 [label="Gate selection 15" style=dashed]
	tp_split_15_5 -> expert_compute_15_0_5
	tp_split_15_5 -> expert_compute_15_1_5
	expert_compute_15_0_5 -> tp_allreduce_15_5
	expert_compute_15_1_5 -> tp_allreduce_15_5
	tp_allreduce_15_5 -> expert_15_5
	expert_15_5 -> expert_agg_5 [label="Expert 15 output"]
	moe_gate_5 -> tp_split_16_5 [label="Gate selection 16" style=dashed]
	tp_split_16_5 -> expert_compute_16_0_5
	tp_split_16_5 -> expert_compute_16_1_5
	expert_compute_16_0_5 -> tp_allreduce_16_5
	expert_compute_16_1_5 -> tp_allreduce_16_5
	tp_allreduce_16_5 -> expert_16_5
	expert_16_5 -> expert_agg_5 [label="Expert 16 output"]
	moe_gate_5 -> tp_split_17_5 [label="Gate selection 17" style=dashed]
	tp_split_17_5 -> expert_compute_17_0_5
	tp_split_17_5 -> expert_compute_17_1_5
	expert_compute_17_0_5 -> tp_allreduce_17_5
	expert_compute_17_1_5 -> tp_allreduce_17_5
	tp_allreduce_17_5 -> expert_17_5
	expert_17_5 -> expert_agg_5 [label="Expert 17 output"]
	moe_gate_5 -> tp_split_18_5 [label="Gate selection 18" style=dashed]
	tp_split_18_5 -> expert_compute_18_0_5
	tp_split_18_5 -> expert_compute_18_1_5
	expert_compute_18_0_5 -> tp_allreduce_18_5
	expert_compute_18_1_5 -> tp_allreduce_18_5
	tp_allreduce_18_5 -> expert_18_5
	expert_18_5 -> expert_agg_5 [label="Expert 18 output"]
	moe_gate_5 -> tp_split_19_5 [label="Gate selection 19" style=dashed]
	tp_split_19_5 -> expert_compute_19_0_5
	tp_split_19_5 -> expert_compute_19_1_5
	expert_compute_19_0_5 -> tp_allreduce_19_5
	expert_compute_19_1_5 -> tp_allreduce_19_5
	tp_allreduce_19_5 -> expert_19_5
	expert_19_5 -> expert_agg_5 [label="Expert 19 output"]
	moe_gate_5 -> tp_split_20_5 [label="Gate selection 20" style=dashed]
	tp_split_20_5 -> expert_compute_20_0_5
	tp_split_20_5 -> expert_compute_20_1_5
	expert_compute_20_0_5 -> tp_allreduce_20_5
	expert_compute_20_1_5 -> tp_allreduce_20_5
	tp_allreduce_20_5 -> expert_20_5
	expert_20_5 -> expert_agg_5 [label="Expert 20 output"]
	moe_gate_5 -> tp_split_21_5 [label="Gate selection 21" style=dashed]
	tp_split_21_5 -> expert_compute_21_0_5
	tp_split_21_5 -> expert_compute_21_1_5
	expert_compute_21_0_5 -> tp_allreduce_21_5
	expert_compute_21_1_5 -> tp_allreduce_21_5
	tp_allreduce_21_5 -> expert_21_5
	expert_21_5 -> expert_agg_5 [label="Expert 21 output"]
	moe_gate_5 -> tp_split_22_5 [label="Gate selection 22" style=dashed]
	tp_split_22_5 -> expert_compute_22_0_5
	tp_split_22_5 -> expert_compute_22_1_5
	expert_compute_22_0_5 -> tp_allreduce_22_5
	expert_compute_22_1_5 -> tp_allreduce_22_5
	tp_allreduce_22_5 -> expert_22_5
	expert_22_5 -> expert_agg_5 [label="Expert 22 output"]
	moe_gate_5 -> tp_split_23_5 [label="Gate selection 23" style=dashed]
	tp_split_23_5 -> expert_compute_23_0_5
	tp_split_23_5 -> expert_compute_23_1_5
	expert_compute_23_0_5 -> tp_allreduce_23_5
	expert_compute_23_1_5 -> tp_allreduce_23_5
	tp_allreduce_23_5 -> expert_23_5
	expert_23_5 -> expert_agg_5 [label="Expert 23 output"]
	moe_gate_5 -> tp_split_24_5 [label="Gate selection 24" style=dashed]
	tp_split_24_5 -> expert_compute_24_0_5
	tp_split_24_5 -> expert_compute_24_1_5
	expert_compute_24_0_5 -> tp_allreduce_24_5
	expert_compute_24_1_5 -> tp_allreduce_24_5
	tp_allreduce_24_5 -> expert_24_5
	expert_24_5 -> expert_agg_5 [label="Expert 24 output"]
	moe_gate_5 -> tp_split_25_5 [label="Gate selection 25" style=dashed]
	tp_split_25_5 -> expert_compute_25_0_5
	tp_split_25_5 -> expert_compute_25_1_5
	expert_compute_25_0_5 -> tp_allreduce_25_5
	expert_compute_25_1_5 -> tp_allreduce_25_5
	tp_allreduce_25_5 -> expert_25_5
	expert_25_5 -> expert_agg_5 [label="Expert 25 output"]
	moe_gate_5 -> tp_split_26_5 [label="Gate selection 26" style=dashed]
	tp_split_26_5 -> expert_compute_26_0_5
	tp_split_26_5 -> expert_compute_26_1_5
	expert_compute_26_0_5 -> tp_allreduce_26_5
	expert_compute_26_1_5 -> tp_allreduce_26_5
	tp_allreduce_26_5 -> expert_26_5
	expert_26_5 -> expert_agg_5 [label="Expert 26 output"]
	moe_gate_5 -> tp_split_27_5 [label="Gate selection 27" style=dashed]
	tp_split_27_5 -> expert_compute_27_0_5
	tp_split_27_5 -> expert_compute_27_1_5
	expert_compute_27_0_5 -> tp_allreduce_27_5
	expert_compute_27_1_5 -> tp_allreduce_27_5
	tp_allreduce_27_5 -> expert_27_5
	expert_27_5 -> expert_agg_5 [label="Expert 27 output"]
	moe_gate_5 -> tp_split_28_5 [label="Gate selection 28" style=dashed]
	tp_split_28_5 -> expert_compute_28_0_5
	tp_split_28_5 -> expert_compute_28_1_5
	expert_compute_28_0_5 -> tp_allreduce_28_5
	expert_compute_28_1_5 -> tp_allreduce_28_5
	tp_allreduce_28_5 -> expert_28_5
	expert_28_5 -> expert_agg_5 [label="Expert 28 output"]
	moe_gate_5 -> tp_split_29_5 [label="Gate selection 29" style=dashed]
	tp_split_29_5 -> expert_compute_29_0_5
	tp_split_29_5 -> expert_compute_29_1_5
	expert_compute_29_0_5 -> tp_allreduce_29_5
	expert_compute_29_1_5 -> tp_allreduce_29_5
	tp_allreduce_29_5 -> expert_29_5
	expert_29_5 -> expert_agg_5 [label="Expert 29 output"]
	moe_gate_5 -> tp_split_30_5 [label="Gate selection 30" style=dashed]
	tp_split_30_5 -> expert_compute_30_0_5
	tp_split_30_5 -> expert_compute_30_1_5
	expert_compute_30_0_5 -> tp_allreduce_30_5
	expert_compute_30_1_5 -> tp_allreduce_30_5
	tp_allreduce_30_5 -> expert_30_5
	expert_30_5 -> expert_agg_5 [label="Expert 30 output"]
	moe_gate_5 -> tp_split_31_5 [label="Gate selection 31" style=dashed]
	tp_split_31_5 -> expert_compute_31_0_5
	tp_split_31_5 -> expert_compute_31_1_5
	expert_compute_31_0_5 -> tp_allreduce_31_5
	expert_compute_31_1_5 -> tp_allreduce_31_5
	tp_allreduce_31_5 -> expert_31_5
	expert_31_5 -> expert_agg_5 [label="Expert 31 output"]
	moe_gate_5 -> tp_split_32_5 [label="Gate selection 32" style=dashed]
	tp_split_32_5 -> expert_compute_32_0_5
	tp_split_32_5 -> expert_compute_32_1_5
	expert_compute_32_0_5 -> tp_allreduce_32_5
	expert_compute_32_1_5 -> tp_allreduce_32_5
	tp_allreduce_32_5 -> expert_32_5
	expert_32_5 -> expert_agg_5 [label="Expert 32 output"]
	moe_gate_5 -> tp_split_33_5 [label="Gate selection 33" style=dashed]
	tp_split_33_5 -> expert_compute_33_0_5
	tp_split_33_5 -> expert_compute_33_1_5
	expert_compute_33_0_5 -> tp_allreduce_33_5
	expert_compute_33_1_5 -> tp_allreduce_33_5
	tp_allreduce_33_5 -> expert_33_5
	expert_33_5 -> expert_agg_5 [label="Expert 33 output"]
	moe_gate_5 -> tp_split_34_5 [label="Gate selection 34" style=dashed]
	tp_split_34_5 -> expert_compute_34_0_5
	tp_split_34_5 -> expert_compute_34_1_5
	expert_compute_34_0_5 -> tp_allreduce_34_5
	expert_compute_34_1_5 -> tp_allreduce_34_5
	tp_allreduce_34_5 -> expert_34_5
	expert_34_5 -> expert_agg_5 [label="Expert 34 output"]
	moe_gate_5 -> tp_split_35_5 [label="Gate selection 35" style=dashed]
	tp_split_35_5 -> expert_compute_35_0_5
	tp_split_35_5 -> expert_compute_35_1_5
	expert_compute_35_0_5 -> tp_allreduce_35_5
	expert_compute_35_1_5 -> tp_allreduce_35_5
	tp_allreduce_35_5 -> expert_35_5
	expert_35_5 -> expert_agg_5 [label="Expert 35 output"]
	moe_gate_5 -> tp_split_36_5 [label="Gate selection 36" style=dashed]
	tp_split_36_5 -> expert_compute_36_0_5
	tp_split_36_5 -> expert_compute_36_1_5
	expert_compute_36_0_5 -> tp_allreduce_36_5
	expert_compute_36_1_5 -> tp_allreduce_36_5
	tp_allreduce_36_5 -> expert_36_5
	expert_36_5 -> expert_agg_5 [label="Expert 36 output"]
	moe_gate_5 -> tp_split_37_5 [label="Gate selection 37" style=dashed]
	tp_split_37_5 -> expert_compute_37_0_5
	tp_split_37_5 -> expert_compute_37_1_5
	expert_compute_37_0_5 -> tp_allreduce_37_5
	expert_compute_37_1_5 -> tp_allreduce_37_5
	tp_allreduce_37_5 -> expert_37_5
	expert_37_5 -> expert_agg_5 [label="Expert 37 output"]
	moe_gate_5 -> tp_split_38_5 [label="Gate selection 38" style=dashed]
	tp_split_38_5 -> expert_compute_38_0_5
	tp_split_38_5 -> expert_compute_38_1_5
	expert_compute_38_0_5 -> tp_allreduce_38_5
	expert_compute_38_1_5 -> tp_allreduce_38_5
	tp_allreduce_38_5 -> expert_38_5
	expert_38_5 -> expert_agg_5 [label="Expert 38 output"]
	moe_gate_5 -> tp_split_39_5 [label="Gate selection 39" style=dashed]
	tp_split_39_5 -> expert_compute_39_0_5
	tp_split_39_5 -> expert_compute_39_1_5
	expert_compute_39_0_5 -> tp_allreduce_39_5
	expert_compute_39_1_5 -> tp_allreduce_39_5
	tp_allreduce_39_5 -> expert_39_5
	expert_39_5 -> expert_agg_5 [label="Expert 39 output"]
	moe_gate_5 -> tp_split_40_5 [label="Gate selection 40" style=dashed]
	tp_split_40_5 -> expert_compute_40_0_5
	tp_split_40_5 -> expert_compute_40_1_5
	expert_compute_40_0_5 -> tp_allreduce_40_5
	expert_compute_40_1_5 -> tp_allreduce_40_5
	tp_allreduce_40_5 -> expert_40_5
	expert_40_5 -> expert_agg_5 [label="Expert 40 output"]
	moe_gate_5 -> tp_split_41_5 [label="Gate selection 41" style=dashed]
	tp_split_41_5 -> expert_compute_41_0_5
	tp_split_41_5 -> expert_compute_41_1_5
	expert_compute_41_0_5 -> tp_allreduce_41_5
	expert_compute_41_1_5 -> tp_allreduce_41_5
	tp_allreduce_41_5 -> expert_41_5
	expert_41_5 -> expert_agg_5 [label="Expert 41 output"]
	moe_gate_5 -> tp_split_42_5 [label="Gate selection 42" style=dashed]
	tp_split_42_5 -> expert_compute_42_0_5
	tp_split_42_5 -> expert_compute_42_1_5
	expert_compute_42_0_5 -> tp_allreduce_42_5
	expert_compute_42_1_5 -> tp_allreduce_42_5
	tp_allreduce_42_5 -> expert_42_5
	expert_42_5 -> expert_agg_5 [label="Expert 42 output"]
	moe_gate_5 -> tp_split_43_5 [label="Gate selection 43" style=dashed]
	tp_split_43_5 -> expert_compute_43_0_5
	tp_split_43_5 -> expert_compute_43_1_5
	expert_compute_43_0_5 -> tp_allreduce_43_5
	expert_compute_43_1_5 -> tp_allreduce_43_5
	tp_allreduce_43_5 -> expert_43_5
	expert_43_5 -> expert_agg_5 [label="Expert 43 output"]
	moe_gate_5 -> tp_split_44_5 [label="Gate selection 44" style=dashed]
	tp_split_44_5 -> expert_compute_44_0_5
	tp_split_44_5 -> expert_compute_44_1_5
	expert_compute_44_0_5 -> tp_allreduce_44_5
	expert_compute_44_1_5 -> tp_allreduce_44_5
	tp_allreduce_44_5 -> expert_44_5
	expert_44_5 -> expert_agg_5 [label="Expert 44 output"]
	moe_gate_5 -> tp_split_45_5 [label="Gate selection 45" style=dashed]
	tp_split_45_5 -> expert_compute_45_0_5
	tp_split_45_5 -> expert_compute_45_1_5
	expert_compute_45_0_5 -> tp_allreduce_45_5
	expert_compute_45_1_5 -> tp_allreduce_45_5
	tp_allreduce_45_5 -> expert_45_5
	expert_45_5 -> expert_agg_5 [label="Expert 45 output"]
	moe_gate_5 -> tp_split_46_5 [label="Gate selection 46" style=dashed]
	tp_split_46_5 -> expert_compute_46_0_5
	tp_split_46_5 -> expert_compute_46_1_5
	expert_compute_46_0_5 -> tp_allreduce_46_5
	expert_compute_46_1_5 -> tp_allreduce_46_5
	tp_allreduce_46_5 -> expert_46_5
	expert_46_5 -> expert_agg_5 [label="Expert 46 output"]
	moe_gate_5 -> tp_split_47_5 [label="Gate selection 47" style=dashed]
	tp_split_47_5 -> expert_compute_47_0_5
	tp_split_47_5 -> expert_compute_47_1_5
	expert_compute_47_0_5 -> tp_allreduce_47_5
	expert_compute_47_1_5 -> tp_allreduce_47_5
	tp_allreduce_47_5 -> expert_47_5
	expert_47_5 -> expert_agg_5 [label="Expert 47 output"]
	moe_gate_5 -> tp_split_48_5 [label="Gate selection 48" style=dashed]
	tp_split_48_5 -> expert_compute_48_0_5
	tp_split_48_5 -> expert_compute_48_1_5
	expert_compute_48_0_5 -> tp_allreduce_48_5
	expert_compute_48_1_5 -> tp_allreduce_48_5
	tp_allreduce_48_5 -> expert_48_5
	expert_48_5 -> expert_agg_5 [label="Expert 48 output"]
	moe_gate_5 -> tp_split_49_5 [label="Gate selection 49" style=dashed]
	tp_split_49_5 -> expert_compute_49_0_5
	tp_split_49_5 -> expert_compute_49_1_5
	expert_compute_49_0_5 -> tp_allreduce_49_5
	expert_compute_49_1_5 -> tp_allreduce_49_5
	tp_allreduce_49_5 -> expert_49_5
	expert_49_5 -> expert_agg_5 [label="Expert 49 output"]
	moe_gate_5 -> tp_split_50_5 [label="Gate selection 50" style=dashed]
	tp_split_50_5 -> expert_compute_50_0_5
	tp_split_50_5 -> expert_compute_50_1_5
	expert_compute_50_0_5 -> tp_allreduce_50_5
	expert_compute_50_1_5 -> tp_allreduce_50_5
	tp_allreduce_50_5 -> expert_50_5
	expert_50_5 -> expert_agg_5 [label="Expert 50 output"]
	moe_gate_5 -> tp_split_51_5 [label="Gate selection 51" style=dashed]
	tp_split_51_5 -> expert_compute_51_0_5
	tp_split_51_5 -> expert_compute_51_1_5
	expert_compute_51_0_5 -> tp_allreduce_51_5
	expert_compute_51_1_5 -> tp_allreduce_51_5
	tp_allreduce_51_5 -> expert_51_5
	expert_51_5 -> expert_agg_5 [label="Expert 51 output"]
	moe_gate_5 -> tp_split_52_5 [label="Gate selection 52" style=dashed]
	tp_split_52_5 -> expert_compute_52_0_5
	tp_split_52_5 -> expert_compute_52_1_5
	expert_compute_52_0_5 -> tp_allreduce_52_5
	expert_compute_52_1_5 -> tp_allreduce_52_5
	tp_allreduce_52_5 -> expert_52_5
	expert_52_5 -> expert_agg_5 [label="Expert 52 output"]
	moe_gate_5 -> tp_split_53_5 [label="Gate selection 53" style=dashed]
	tp_split_53_5 -> expert_compute_53_0_5
	tp_split_53_5 -> expert_compute_53_1_5
	expert_compute_53_0_5 -> tp_allreduce_53_5
	expert_compute_53_1_5 -> tp_allreduce_53_5
	tp_allreduce_53_5 -> expert_53_5
	expert_53_5 -> expert_agg_5 [label="Expert 53 output"]
	moe_gate_5 -> tp_split_54_5 [label="Gate selection 54" style=dashed]
	tp_split_54_5 -> expert_compute_54_0_5
	tp_split_54_5 -> expert_compute_54_1_5
	expert_compute_54_0_5 -> tp_allreduce_54_5
	expert_compute_54_1_5 -> tp_allreduce_54_5
	tp_allreduce_54_5 -> expert_54_5
	expert_54_5 -> expert_agg_5 [label="Expert 54 output"]
	moe_gate_5 -> tp_split_55_5 [label="Gate selection 55" style=dashed]
	tp_split_55_5 -> expert_compute_55_0_5
	tp_split_55_5 -> expert_compute_55_1_5
	expert_compute_55_0_5 -> tp_allreduce_55_5
	expert_compute_55_1_5 -> tp_allreduce_55_5
	tp_allreduce_55_5 -> expert_55_5
	expert_55_5 -> expert_agg_5 [label="Expert 55 output"]
	moe_gate_5 -> tp_split_56_5 [label="Gate selection 56" style=dashed]
	tp_split_56_5 -> expert_compute_56_0_5
	tp_split_56_5 -> expert_compute_56_1_5
	expert_compute_56_0_5 -> tp_allreduce_56_5
	expert_compute_56_1_5 -> tp_allreduce_56_5
	tp_allreduce_56_5 -> expert_56_5
	expert_56_5 -> expert_agg_5 [label="Expert 56 output"]
	moe_gate_5 -> tp_split_57_5 [label="Gate selection 57" style=dashed]
	tp_split_57_5 -> expert_compute_57_0_5
	tp_split_57_5 -> expert_compute_57_1_5
	expert_compute_57_0_5 -> tp_allreduce_57_5
	expert_compute_57_1_5 -> tp_allreduce_57_5
	tp_allreduce_57_5 -> expert_57_5
	expert_57_5 -> expert_agg_5 [label="Expert 57 output"]
	moe_gate_5 -> tp_split_58_5 [label="Gate selection 58" style=dashed]
	tp_split_58_5 -> expert_compute_58_0_5
	tp_split_58_5 -> expert_compute_58_1_5
	expert_compute_58_0_5 -> tp_allreduce_58_5
	expert_compute_58_1_5 -> tp_allreduce_58_5
	tp_allreduce_58_5 -> expert_58_5
	expert_58_5 -> expert_agg_5 [label="Expert 58 output"]
	moe_gate_5 -> tp_split_59_5 [label="Gate selection 59" style=dashed]
	tp_split_59_5 -> expert_compute_59_0_5
	tp_split_59_5 -> expert_compute_59_1_5
	expert_compute_59_0_5 -> tp_allreduce_59_5
	expert_compute_59_1_5 -> tp_allreduce_59_5
	tp_allreduce_59_5 -> expert_59_5
	expert_59_5 -> expert_agg_5 [label="Expert 59 output"]
	moe_gate_5 -> tp_split_60_5 [label="Gate selection 60" style=dashed]
	tp_split_60_5 -> expert_compute_60_0_5
	tp_split_60_5 -> expert_compute_60_1_5
	expert_compute_60_0_5 -> tp_allreduce_60_5
	expert_compute_60_1_5 -> tp_allreduce_60_5
	tp_allreduce_60_5 -> expert_60_5
	expert_60_5 -> expert_agg_5 [label="Expert 60 output"]
	moe_gate_5 -> tp_split_61_5 [label="Gate selection 61" style=dashed]
	tp_split_61_5 -> expert_compute_61_0_5
	tp_split_61_5 -> expert_compute_61_1_5
	expert_compute_61_0_5 -> tp_allreduce_61_5
	expert_compute_61_1_5 -> tp_allreduce_61_5
	tp_allreduce_61_5 -> expert_61_5
	expert_61_5 -> expert_agg_5 [label="Expert 61 output"]
	moe_gate_5 -> tp_split_62_5 [label="Gate selection 62" style=dashed]
	tp_split_62_5 -> expert_compute_62_0_5
	tp_split_62_5 -> expert_compute_62_1_5
	expert_compute_62_0_5 -> tp_allreduce_62_5
	expert_compute_62_1_5 -> tp_allreduce_62_5
	tp_allreduce_62_5 -> expert_62_5
	expert_62_5 -> expert_agg_5 [label="Expert 62 output"]
	moe_gate_5 -> tp_split_63_5 [label="Gate selection 63" style=dashed]
	tp_split_63_5 -> expert_compute_63_0_5
	tp_split_63_5 -> expert_compute_63_1_5
	expert_compute_63_0_5 -> tp_allreduce_63_5
	expert_compute_63_1_5 -> tp_allreduce_63_5
	tp_allreduce_63_5 -> expert_63_5
	expert_63_5 -> expert_agg_5 [label="Expert 63 output"]
	expert_agg_5 -> layer_norm_5
	layer_norm_5 -> attn_norm_6
	attn_norm_6 -> attn_q_6
	attn_norm_6 -> attn_k_6
	attn_norm_6 -> attn_v_6
	attn_q_6 -> attn_score_6
	attn_k_6 -> attn_score_6
	attn_v_6 -> attn_out_6
	attn_score_6 -> attn_out_6
	attn_out_6 -> moe_gate_6
	moe_gate_6 -> tp_split_0_6 [label="Gate selection 0" style=dashed]
	tp_split_0_6 -> expert_compute_0_0_6
	tp_split_0_6 -> expert_compute_0_1_6
	expert_compute_0_0_6 -> tp_allreduce_0_6
	expert_compute_0_1_6 -> tp_allreduce_0_6
	tp_allreduce_0_6 -> expert_0_6
	expert_0_6 -> expert_agg_6 [label="Expert 0 output"]
	moe_gate_6 -> tp_split_1_6 [label="Gate selection 1" style=dashed]
	tp_split_1_6 -> expert_compute_1_0_6
	tp_split_1_6 -> expert_compute_1_1_6
	expert_compute_1_0_6 -> tp_allreduce_1_6
	expert_compute_1_1_6 -> tp_allreduce_1_6
	tp_allreduce_1_6 -> expert_1_6
	expert_1_6 -> expert_agg_6 [label="Expert 1 output"]
	moe_gate_6 -> tp_split_2_6 [label="Gate selection 2" style=dashed]
	tp_split_2_6 -> expert_compute_2_0_6
	tp_split_2_6 -> expert_compute_2_1_6
	expert_compute_2_0_6 -> tp_allreduce_2_6
	expert_compute_2_1_6 -> tp_allreduce_2_6
	tp_allreduce_2_6 -> expert_2_6
	expert_2_6 -> expert_agg_6 [label="Expert 2 output"]
	moe_gate_6 -> tp_split_3_6 [label="Gate selection 3" style=dashed]
	tp_split_3_6 -> expert_compute_3_0_6
	tp_split_3_6 -> expert_compute_3_1_6
	expert_compute_3_0_6 -> tp_allreduce_3_6
	expert_compute_3_1_6 -> tp_allreduce_3_6
	tp_allreduce_3_6 -> expert_3_6
	expert_3_6 -> expert_agg_6 [label="Expert 3 output"]
	moe_gate_6 -> tp_split_4_6 [label="Gate selection 4" style=dashed]
	tp_split_4_6 -> expert_compute_4_0_6
	tp_split_4_6 -> expert_compute_4_1_6
	expert_compute_4_0_6 -> tp_allreduce_4_6
	expert_compute_4_1_6 -> tp_allreduce_4_6
	tp_allreduce_4_6 -> expert_4_6
	expert_4_6 -> expert_agg_6 [label="Expert 4 output"]
	moe_gate_6 -> tp_split_5_6 [label="Gate selection 5" style=dashed]
	tp_split_5_6 -> expert_compute_5_0_6
	tp_split_5_6 -> expert_compute_5_1_6
	expert_compute_5_0_6 -> tp_allreduce_5_6
	expert_compute_5_1_6 -> tp_allreduce_5_6
	tp_allreduce_5_6 -> expert_5_6
	expert_5_6 -> expert_agg_6 [label="Expert 5 output"]
	moe_gate_6 -> tp_split_6_6 [label="Gate selection 6" style=dashed]
	tp_split_6_6 -> expert_compute_6_0_6
	tp_split_6_6 -> expert_compute_6_1_6
	expert_compute_6_0_6 -> tp_allreduce_6_6
	expert_compute_6_1_6 -> tp_allreduce_6_6
	tp_allreduce_6_6 -> expert_6_6
	expert_6_6 -> expert_agg_6 [label="Expert 6 output"]
	moe_gate_6 -> tp_split_7_6 [label="Gate selection 7" style=dashed]
	tp_split_7_6 -> expert_compute_7_0_6
	tp_split_7_6 -> expert_compute_7_1_6
	expert_compute_7_0_6 -> tp_allreduce_7_6
	expert_compute_7_1_6 -> tp_allreduce_7_6
	tp_allreduce_7_6 -> expert_7_6
	expert_7_6 -> expert_agg_6 [label="Expert 7 output"]
	moe_gate_6 -> tp_split_8_6 [label="Gate selection 8" style=dashed]
	tp_split_8_6 -> expert_compute_8_0_6
	tp_split_8_6 -> expert_compute_8_1_6
	expert_compute_8_0_6 -> tp_allreduce_8_6
	expert_compute_8_1_6 -> tp_allreduce_8_6
	tp_allreduce_8_6 -> expert_8_6
	expert_8_6 -> expert_agg_6 [label="Expert 8 output"]
	moe_gate_6 -> tp_split_9_6 [label="Gate selection 9" style=dashed]
	tp_split_9_6 -> expert_compute_9_0_6
	tp_split_9_6 -> expert_compute_9_1_6
	expert_compute_9_0_6 -> tp_allreduce_9_6
	expert_compute_9_1_6 -> tp_allreduce_9_6
	tp_allreduce_9_6 -> expert_9_6
	expert_9_6 -> expert_agg_6 [label="Expert 9 output"]
	moe_gate_6 -> tp_split_10_6 [label="Gate selection 10" style=dashed]
	tp_split_10_6 -> expert_compute_10_0_6
	tp_split_10_6 -> expert_compute_10_1_6
	expert_compute_10_0_6 -> tp_allreduce_10_6
	expert_compute_10_1_6 -> tp_allreduce_10_6
	tp_allreduce_10_6 -> expert_10_6
	expert_10_6 -> expert_agg_6 [label="Expert 10 output"]
	moe_gate_6 -> tp_split_11_6 [label="Gate selection 11" style=dashed]
	tp_split_11_6 -> expert_compute_11_0_6
	tp_split_11_6 -> expert_compute_11_1_6
	expert_compute_11_0_6 -> tp_allreduce_11_6
	expert_compute_11_1_6 -> tp_allreduce_11_6
	tp_allreduce_11_6 -> expert_11_6
	expert_11_6 -> expert_agg_6 [label="Expert 11 output"]
	moe_gate_6 -> tp_split_12_6 [label="Gate selection 12" style=dashed]
	tp_split_12_6 -> expert_compute_12_0_6
	tp_split_12_6 -> expert_compute_12_1_6
	expert_compute_12_0_6 -> tp_allreduce_12_6
	expert_compute_12_1_6 -> tp_allreduce_12_6
	tp_allreduce_12_6 -> expert_12_6
	expert_12_6 -> expert_agg_6 [label="Expert 12 output"]
	moe_gate_6 -> tp_split_13_6 [label="Gate selection 13" style=dashed]
	tp_split_13_6 -> expert_compute_13_0_6
	tp_split_13_6 -> expert_compute_13_1_6
	expert_compute_13_0_6 -> tp_allreduce_13_6
	expert_compute_13_1_6 -> tp_allreduce_13_6
	tp_allreduce_13_6 -> expert_13_6
	expert_13_6 -> expert_agg_6 [label="Expert 13 output"]
	moe_gate_6 -> tp_split_14_6 [label="Gate selection 14" style=dashed]
	tp_split_14_6 -> expert_compute_14_0_6
	tp_split_14_6 -> expert_compute_14_1_6
	expert_compute_14_0_6 -> tp_allreduce_14_6
	expert_compute_14_1_6 -> tp_allreduce_14_6
	tp_allreduce_14_6 -> expert_14_6
	expert_14_6 -> expert_agg_6 [label="Expert 14 output"]
	moe_gate_6 -> tp_split_15_6 [label="Gate selection 15" style=dashed]
	tp_split_15_6 -> expert_compute_15_0_6
	tp_split_15_6 -> expert_compute_15_1_6
	expert_compute_15_0_6 -> tp_allreduce_15_6
	expert_compute_15_1_6 -> tp_allreduce_15_6
	tp_allreduce_15_6 -> expert_15_6
	expert_15_6 -> expert_agg_6 [label="Expert 15 output"]
	moe_gate_6 -> tp_split_16_6 [label="Gate selection 16" style=dashed]
	tp_split_16_6 -> expert_compute_16_0_6
	tp_split_16_6 -> expert_compute_16_1_6
	expert_compute_16_0_6 -> tp_allreduce_16_6
	expert_compute_16_1_6 -> tp_allreduce_16_6
	tp_allreduce_16_6 -> expert_16_6
	expert_16_6 -> expert_agg_6 [label="Expert 16 output"]
	moe_gate_6 -> tp_split_17_6 [label="Gate selection 17" style=dashed]
	tp_split_17_6 -> expert_compute_17_0_6
	tp_split_17_6 -> expert_compute_17_1_6
	expert_compute_17_0_6 -> tp_allreduce_17_6
	expert_compute_17_1_6 -> tp_allreduce_17_6
	tp_allreduce_17_6 -> expert_17_6
	expert_17_6 -> expert_agg_6 [label="Expert 17 output"]
	moe_gate_6 -> tp_split_18_6 [label="Gate selection 18" style=dashed]
	tp_split_18_6 -> expert_compute_18_0_6
	tp_split_18_6 -> expert_compute_18_1_6
	expert_compute_18_0_6 -> tp_allreduce_18_6
	expert_compute_18_1_6 -> tp_allreduce_18_6
	tp_allreduce_18_6 -> expert_18_6
	expert_18_6 -> expert_agg_6 [label="Expert 18 output"]
	moe_gate_6 -> tp_split_19_6 [label="Gate selection 19" style=dashed]
	tp_split_19_6 -> expert_compute_19_0_6
	tp_split_19_6 -> expert_compute_19_1_6
	expert_compute_19_0_6 -> tp_allreduce_19_6
	expert_compute_19_1_6 -> tp_allreduce_19_6
	tp_allreduce_19_6 -> expert_19_6
	expert_19_6 -> expert_agg_6 [label="Expert 19 output"]
	moe_gate_6 -> tp_split_20_6 [label="Gate selection 20" style=dashed]
	tp_split_20_6 -> expert_compute_20_0_6
	tp_split_20_6 -> expert_compute_20_1_6
	expert_compute_20_0_6 -> tp_allreduce_20_6
	expert_compute_20_1_6 -> tp_allreduce_20_6
	tp_allreduce_20_6 -> expert_20_6
	expert_20_6 -> expert_agg_6 [label="Expert 20 output"]
	moe_gate_6 -> tp_split_21_6 [label="Gate selection 21" style=dashed]
	tp_split_21_6 -> expert_compute_21_0_6
	tp_split_21_6 -> expert_compute_21_1_6
	expert_compute_21_0_6 -> tp_allreduce_21_6
	expert_compute_21_1_6 -> tp_allreduce_21_6
	tp_allreduce_21_6 -> expert_21_6
	expert_21_6 -> expert_agg_6 [label="Expert 21 output"]
	moe_gate_6 -> tp_split_22_6 [label="Gate selection 22" style=dashed]
	tp_split_22_6 -> expert_compute_22_0_6
	tp_split_22_6 -> expert_compute_22_1_6
	expert_compute_22_0_6 -> tp_allreduce_22_6
	expert_compute_22_1_6 -> tp_allreduce_22_6
	tp_allreduce_22_6 -> expert_22_6
	expert_22_6 -> expert_agg_6 [label="Expert 22 output"]
	moe_gate_6 -> tp_split_23_6 [label="Gate selection 23" style=dashed]
	tp_split_23_6 -> expert_compute_23_0_6
	tp_split_23_6 -> expert_compute_23_1_6
	expert_compute_23_0_6 -> tp_allreduce_23_6
	expert_compute_23_1_6 -> tp_allreduce_23_6
	tp_allreduce_23_6 -> expert_23_6
	expert_23_6 -> expert_agg_6 [label="Expert 23 output"]
	moe_gate_6 -> tp_split_24_6 [label="Gate selection 24" style=dashed]
	tp_split_24_6 -> expert_compute_24_0_6
	tp_split_24_6 -> expert_compute_24_1_6
	expert_compute_24_0_6 -> tp_allreduce_24_6
	expert_compute_24_1_6 -> tp_allreduce_24_6
	tp_allreduce_24_6 -> expert_24_6
	expert_24_6 -> expert_agg_6 [label="Expert 24 output"]
	moe_gate_6 -> tp_split_25_6 [label="Gate selection 25" style=dashed]
	tp_split_25_6 -> expert_compute_25_0_6
	tp_split_25_6 -> expert_compute_25_1_6
	expert_compute_25_0_6 -> tp_allreduce_25_6
	expert_compute_25_1_6 -> tp_allreduce_25_6
	tp_allreduce_25_6 -> expert_25_6
	expert_25_6 -> expert_agg_6 [label="Expert 25 output"]
	moe_gate_6 -> tp_split_26_6 [label="Gate selection 26" style=dashed]
	tp_split_26_6 -> expert_compute_26_0_6
	tp_split_26_6 -> expert_compute_26_1_6
	expert_compute_26_0_6 -> tp_allreduce_26_6
	expert_compute_26_1_6 -> tp_allreduce_26_6
	tp_allreduce_26_6 -> expert_26_6
	expert_26_6 -> expert_agg_6 [label="Expert 26 output"]
	moe_gate_6 -> tp_split_27_6 [label="Gate selection 27" style=dashed]
	tp_split_27_6 -> expert_compute_27_0_6
	tp_split_27_6 -> expert_compute_27_1_6
	expert_compute_27_0_6 -> tp_allreduce_27_6
	expert_compute_27_1_6 -> tp_allreduce_27_6
	tp_allreduce_27_6 -> expert_27_6
	expert_27_6 -> expert_agg_6 [label="Expert 27 output"]
	moe_gate_6 -> tp_split_28_6 [label="Gate selection 28" style=dashed]
	tp_split_28_6 -> expert_compute_28_0_6
	tp_split_28_6 -> expert_compute_28_1_6
	expert_compute_28_0_6 -> tp_allreduce_28_6
	expert_compute_28_1_6 -> tp_allreduce_28_6
	tp_allreduce_28_6 -> expert_28_6
	expert_28_6 -> expert_agg_6 [label="Expert 28 output"]
	moe_gate_6 -> tp_split_29_6 [label="Gate selection 29" style=dashed]
	tp_split_29_6 -> expert_compute_29_0_6
	tp_split_29_6 -> expert_compute_29_1_6
	expert_compute_29_0_6 -> tp_allreduce_29_6
	expert_compute_29_1_6 -> tp_allreduce_29_6
	tp_allreduce_29_6 -> expert_29_6
	expert_29_6 -> expert_agg_6 [label="Expert 29 output"]
	moe_gate_6 -> tp_split_30_6 [label="Gate selection 30" style=dashed]
	tp_split_30_6 -> expert_compute_30_0_6
	tp_split_30_6 -> expert_compute_30_1_6
	expert_compute_30_0_6 -> tp_allreduce_30_6
	expert_compute_30_1_6 -> tp_allreduce_30_6
	tp_allreduce_30_6 -> expert_30_6
	expert_30_6 -> expert_agg_6 [label="Expert 30 output"]
	moe_gate_6 -> tp_split_31_6 [label="Gate selection 31" style=dashed]
	tp_split_31_6 -> expert_compute_31_0_6
	tp_split_31_6 -> expert_compute_31_1_6
	expert_compute_31_0_6 -> tp_allreduce_31_6
	expert_compute_31_1_6 -> tp_allreduce_31_6
	tp_allreduce_31_6 -> expert_31_6
	expert_31_6 -> expert_agg_6 [label="Expert 31 output"]
	moe_gate_6 -> tp_split_32_6 [label="Gate selection 32" style=dashed]
	tp_split_32_6 -> expert_compute_32_0_6
	tp_split_32_6 -> expert_compute_32_1_6
	expert_compute_32_0_6 -> tp_allreduce_32_6
	expert_compute_32_1_6 -> tp_allreduce_32_6
	tp_allreduce_32_6 -> expert_32_6
	expert_32_6 -> expert_agg_6 [label="Expert 32 output"]
	moe_gate_6 -> tp_split_33_6 [label="Gate selection 33" style=dashed]
	tp_split_33_6 -> expert_compute_33_0_6
	tp_split_33_6 -> expert_compute_33_1_6
	expert_compute_33_0_6 -> tp_allreduce_33_6
	expert_compute_33_1_6 -> tp_allreduce_33_6
	tp_allreduce_33_6 -> expert_33_6
	expert_33_6 -> expert_agg_6 [label="Expert 33 output"]
	moe_gate_6 -> tp_split_34_6 [label="Gate selection 34" style=dashed]
	tp_split_34_6 -> expert_compute_34_0_6
	tp_split_34_6 -> expert_compute_34_1_6
	expert_compute_34_0_6 -> tp_allreduce_34_6
	expert_compute_34_1_6 -> tp_allreduce_34_6
	tp_allreduce_34_6 -> expert_34_6
	expert_34_6 -> expert_agg_6 [label="Expert 34 output"]
	moe_gate_6 -> tp_split_35_6 [label="Gate selection 35" style=dashed]
	tp_split_35_6 -> expert_compute_35_0_6
	tp_split_35_6 -> expert_compute_35_1_6
	expert_compute_35_0_6 -> tp_allreduce_35_6
	expert_compute_35_1_6 -> tp_allreduce_35_6
	tp_allreduce_35_6 -> expert_35_6
	expert_35_6 -> expert_agg_6 [label="Expert 35 output"]
	moe_gate_6 -> tp_split_36_6 [label="Gate selection 36" style=dashed]
	tp_split_36_6 -> expert_compute_36_0_6
	tp_split_36_6 -> expert_compute_36_1_6
	expert_compute_36_0_6 -> tp_allreduce_36_6
	expert_compute_36_1_6 -> tp_allreduce_36_6
	tp_allreduce_36_6 -> expert_36_6
	expert_36_6 -> expert_agg_6 [label="Expert 36 output"]
	moe_gate_6 -> tp_split_37_6 [label="Gate selection 37" style=dashed]
	tp_split_37_6 -> expert_compute_37_0_6
	tp_split_37_6 -> expert_compute_37_1_6
	expert_compute_37_0_6 -> tp_allreduce_37_6
	expert_compute_37_1_6 -> tp_allreduce_37_6
	tp_allreduce_37_6 -> expert_37_6
	expert_37_6 -> expert_agg_6 [label="Expert 37 output"]
	moe_gate_6 -> tp_split_38_6 [label="Gate selection 38" style=dashed]
	tp_split_38_6 -> expert_compute_38_0_6
	tp_split_38_6 -> expert_compute_38_1_6
	expert_compute_38_0_6 -> tp_allreduce_38_6
	expert_compute_38_1_6 -> tp_allreduce_38_6
	tp_allreduce_38_6 -> expert_38_6
	expert_38_6 -> expert_agg_6 [label="Expert 38 output"]
	moe_gate_6 -> tp_split_39_6 [label="Gate selection 39" style=dashed]
	tp_split_39_6 -> expert_compute_39_0_6
	tp_split_39_6 -> expert_compute_39_1_6
	expert_compute_39_0_6 -> tp_allreduce_39_6
	expert_compute_39_1_6 -> tp_allreduce_39_6
	tp_allreduce_39_6 -> expert_39_6
	expert_39_6 -> expert_agg_6 [label="Expert 39 output"]
	moe_gate_6 -> tp_split_40_6 [label="Gate selection 40" style=dashed]
	tp_split_40_6 -> expert_compute_40_0_6
	tp_split_40_6 -> expert_compute_40_1_6
	expert_compute_40_0_6 -> tp_allreduce_40_6
	expert_compute_40_1_6 -> tp_allreduce_40_6
	tp_allreduce_40_6 -> expert_40_6
	expert_40_6 -> expert_agg_6 [label="Expert 40 output"]
	moe_gate_6 -> tp_split_41_6 [label="Gate selection 41" style=dashed]
	tp_split_41_6 -> expert_compute_41_0_6
	tp_split_41_6 -> expert_compute_41_1_6
	expert_compute_41_0_6 -> tp_allreduce_41_6
	expert_compute_41_1_6 -> tp_allreduce_41_6
	tp_allreduce_41_6 -> expert_41_6
	expert_41_6 -> expert_agg_6 [label="Expert 41 output"]
	moe_gate_6 -> tp_split_42_6 [label="Gate selection 42" style=dashed]
	tp_split_42_6 -> expert_compute_42_0_6
	tp_split_42_6 -> expert_compute_42_1_6
	expert_compute_42_0_6 -> tp_allreduce_42_6
	expert_compute_42_1_6 -> tp_allreduce_42_6
	tp_allreduce_42_6 -> expert_42_6
	expert_42_6 -> expert_agg_6 [label="Expert 42 output"]
	moe_gate_6 -> tp_split_43_6 [label="Gate selection 43" style=dashed]
	tp_split_43_6 -> expert_compute_43_0_6
	tp_split_43_6 -> expert_compute_43_1_6
	expert_compute_43_0_6 -> tp_allreduce_43_6
	expert_compute_43_1_6 -> tp_allreduce_43_6
	tp_allreduce_43_6 -> expert_43_6
	expert_43_6 -> expert_agg_6 [label="Expert 43 output"]
	moe_gate_6 -> tp_split_44_6 [label="Gate selection 44" style=dashed]
	tp_split_44_6 -> expert_compute_44_0_6
	tp_split_44_6 -> expert_compute_44_1_6
	expert_compute_44_0_6 -> tp_allreduce_44_6
	expert_compute_44_1_6 -> tp_allreduce_44_6
	tp_allreduce_44_6 -> expert_44_6
	expert_44_6 -> expert_agg_6 [label="Expert 44 output"]
	moe_gate_6 -> tp_split_45_6 [label="Gate selection 45" style=dashed]
	tp_split_45_6 -> expert_compute_45_0_6
	tp_split_45_6 -> expert_compute_45_1_6
	expert_compute_45_0_6 -> tp_allreduce_45_6
	expert_compute_45_1_6 -> tp_allreduce_45_6
	tp_allreduce_45_6 -> expert_45_6
	expert_45_6 -> expert_agg_6 [label="Expert 45 output"]
	moe_gate_6 -> tp_split_46_6 [label="Gate selection 46" style=dashed]
	tp_split_46_6 -> expert_compute_46_0_6
	tp_split_46_6 -> expert_compute_46_1_6
	expert_compute_46_0_6 -> tp_allreduce_46_6
	expert_compute_46_1_6 -> tp_allreduce_46_6
	tp_allreduce_46_6 -> expert_46_6
	expert_46_6 -> expert_agg_6 [label="Expert 46 output"]
	moe_gate_6 -> tp_split_47_6 [label="Gate selection 47" style=dashed]
	tp_split_47_6 -> expert_compute_47_0_6
	tp_split_47_6 -> expert_compute_47_1_6
	expert_compute_47_0_6 -> tp_allreduce_47_6
	expert_compute_47_1_6 -> tp_allreduce_47_6
	tp_allreduce_47_6 -> expert_47_6
	expert_47_6 -> expert_agg_6 [label="Expert 47 output"]
	moe_gate_6 -> tp_split_48_6 [label="Gate selection 48" style=dashed]
	tp_split_48_6 -> expert_compute_48_0_6
	tp_split_48_6 -> expert_compute_48_1_6
	expert_compute_48_0_6 -> tp_allreduce_48_6
	expert_compute_48_1_6 -> tp_allreduce_48_6
	tp_allreduce_48_6 -> expert_48_6
	expert_48_6 -> expert_agg_6 [label="Expert 48 output"]
	moe_gate_6 -> tp_split_49_6 [label="Gate selection 49" style=dashed]
	tp_split_49_6 -> expert_compute_49_0_6
	tp_split_49_6 -> expert_compute_49_1_6
	expert_compute_49_0_6 -> tp_allreduce_49_6
	expert_compute_49_1_6 -> tp_allreduce_49_6
	tp_allreduce_49_6 -> expert_49_6
	expert_49_6 -> expert_agg_6 [label="Expert 49 output"]
	moe_gate_6 -> tp_split_50_6 [label="Gate selection 50" style=dashed]
	tp_split_50_6 -> expert_compute_50_0_6
	tp_split_50_6 -> expert_compute_50_1_6
	expert_compute_50_0_6 -> tp_allreduce_50_6
	expert_compute_50_1_6 -> tp_allreduce_50_6
	tp_allreduce_50_6 -> expert_50_6
	expert_50_6 -> expert_agg_6 [label="Expert 50 output"]
	moe_gate_6 -> tp_split_51_6 [label="Gate selection 51" style=dashed]
	tp_split_51_6 -> expert_compute_51_0_6
	tp_split_51_6 -> expert_compute_51_1_6
	expert_compute_51_0_6 -> tp_allreduce_51_6
	expert_compute_51_1_6 -> tp_allreduce_51_6
	tp_allreduce_51_6 -> expert_51_6
	expert_51_6 -> expert_agg_6 [label="Expert 51 output"]
	moe_gate_6 -> tp_split_52_6 [label="Gate selection 52" style=dashed]
	tp_split_52_6 -> expert_compute_52_0_6
	tp_split_52_6 -> expert_compute_52_1_6
	expert_compute_52_0_6 -> tp_allreduce_52_6
	expert_compute_52_1_6 -> tp_allreduce_52_6
	tp_allreduce_52_6 -> expert_52_6
	expert_52_6 -> expert_agg_6 [label="Expert 52 output"]
	moe_gate_6 -> tp_split_53_6 [label="Gate selection 53" style=dashed]
	tp_split_53_6 -> expert_compute_53_0_6
	tp_split_53_6 -> expert_compute_53_1_6
	expert_compute_53_0_6 -> tp_allreduce_53_6
	expert_compute_53_1_6 -> tp_allreduce_53_6
	tp_allreduce_53_6 -> expert_53_6
	expert_53_6 -> expert_agg_6 [label="Expert 53 output"]
	moe_gate_6 -> tp_split_54_6 [label="Gate selection 54" style=dashed]
	tp_split_54_6 -> expert_compute_54_0_6
	tp_split_54_6 -> expert_compute_54_1_6
	expert_compute_54_0_6 -> tp_allreduce_54_6
	expert_compute_54_1_6 -> tp_allreduce_54_6
	tp_allreduce_54_6 -> expert_54_6
	expert_54_6 -> expert_agg_6 [label="Expert 54 output"]
	moe_gate_6 -> tp_split_55_6 [label="Gate selection 55" style=dashed]
	tp_split_55_6 -> expert_compute_55_0_6
	tp_split_55_6 -> expert_compute_55_1_6
	expert_compute_55_0_6 -> tp_allreduce_55_6
	expert_compute_55_1_6 -> tp_allreduce_55_6
	tp_allreduce_55_6 -> expert_55_6
	expert_55_6 -> expert_agg_6 [label="Expert 55 output"]
	moe_gate_6 -> tp_split_56_6 [label="Gate selection 56" style=dashed]
	tp_split_56_6 -> expert_compute_56_0_6
	tp_split_56_6 -> expert_compute_56_1_6
	expert_compute_56_0_6 -> tp_allreduce_56_6
	expert_compute_56_1_6 -> tp_allreduce_56_6
	tp_allreduce_56_6 -> expert_56_6
	expert_56_6 -> expert_agg_6 [label="Expert 56 output"]
	moe_gate_6 -> tp_split_57_6 [label="Gate selection 57" style=dashed]
	tp_split_57_6 -> expert_compute_57_0_6
	tp_split_57_6 -> expert_compute_57_1_6
	expert_compute_57_0_6 -> tp_allreduce_57_6
	expert_compute_57_1_6 -> tp_allreduce_57_6
	tp_allreduce_57_6 -> expert_57_6
	expert_57_6 -> expert_agg_6 [label="Expert 57 output"]
	moe_gate_6 -> tp_split_58_6 [label="Gate selection 58" style=dashed]
	tp_split_58_6 -> expert_compute_58_0_6
	tp_split_58_6 -> expert_compute_58_1_6
	expert_compute_58_0_6 -> tp_allreduce_58_6
	expert_compute_58_1_6 -> tp_allreduce_58_6
	tp_allreduce_58_6 -> expert_58_6
	expert_58_6 -> expert_agg_6 [label="Expert 58 output"]
	moe_gate_6 -> tp_split_59_6 [label="Gate selection 59" style=dashed]
	tp_split_59_6 -> expert_compute_59_0_6
	tp_split_59_6 -> expert_compute_59_1_6
	expert_compute_59_0_6 -> tp_allreduce_59_6
	expert_compute_59_1_6 -> tp_allreduce_59_6
	tp_allreduce_59_6 -> expert_59_6
	expert_59_6 -> expert_agg_6 [label="Expert 59 output"]
	moe_gate_6 -> tp_split_60_6 [label="Gate selection 60" style=dashed]
	tp_split_60_6 -> expert_compute_60_0_6
	tp_split_60_6 -> expert_compute_60_1_6
	expert_compute_60_0_6 -> tp_allreduce_60_6
	expert_compute_60_1_6 -> tp_allreduce_60_6
	tp_allreduce_60_6 -> expert_60_6
	expert_60_6 -> expert_agg_6 [label="Expert 60 output"]
	moe_gate_6 -> tp_split_61_6 [label="Gate selection 61" style=dashed]
	tp_split_61_6 -> expert_compute_61_0_6
	tp_split_61_6 -> expert_compute_61_1_6
	expert_compute_61_0_6 -> tp_allreduce_61_6
	expert_compute_61_1_6 -> tp_allreduce_61_6
	tp_allreduce_61_6 -> expert_61_6
	expert_61_6 -> expert_agg_6 [label="Expert 61 output"]
	moe_gate_6 -> tp_split_62_6 [label="Gate selection 62" style=dashed]
	tp_split_62_6 -> expert_compute_62_0_6
	tp_split_62_6 -> expert_compute_62_1_6
	expert_compute_62_0_6 -> tp_allreduce_62_6
	expert_compute_62_1_6 -> tp_allreduce_62_6
	tp_allreduce_62_6 -> expert_62_6
	expert_62_6 -> expert_agg_6 [label="Expert 62 output"]
	moe_gate_6 -> tp_split_63_6 [label="Gate selection 63" style=dashed]
	tp_split_63_6 -> expert_compute_63_0_6
	tp_split_63_6 -> expert_compute_63_1_6
	expert_compute_63_0_6 -> tp_allreduce_63_6
	expert_compute_63_1_6 -> tp_allreduce_63_6
	tp_allreduce_63_6 -> expert_63_6
	expert_63_6 -> expert_agg_6 [label="Expert 63 output"]
	expert_agg_6 -> layer_norm_6
	layer_norm_6 -> attn_norm_7
	attn_norm_7 -> attn_q_7
	attn_norm_7 -> attn_k_7
	attn_norm_7 -> attn_v_7
	attn_q_7 -> attn_score_7
	attn_k_7 -> attn_score_7
	attn_v_7 -> attn_out_7
	attn_score_7 -> attn_out_7
	attn_out_7 -> moe_gate_7
	moe_gate_7 -> tp_split_0_7 [label="Gate selection 0" style=dashed]
	tp_split_0_7 -> expert_compute_0_0_7
	tp_split_0_7 -> expert_compute_0_1_7
	expert_compute_0_0_7 -> tp_allreduce_0_7
	expert_compute_0_1_7 -> tp_allreduce_0_7
	tp_allreduce_0_7 -> expert_0_7
	expert_0_7 -> expert_agg_7 [label="Expert 0 output"]
	moe_gate_7 -> tp_split_1_7 [label="Gate selection 1" style=dashed]
	tp_split_1_7 -> expert_compute_1_0_7
	tp_split_1_7 -> expert_compute_1_1_7
	expert_compute_1_0_7 -> tp_allreduce_1_7
	expert_compute_1_1_7 -> tp_allreduce_1_7
	tp_allreduce_1_7 -> expert_1_7
	expert_1_7 -> expert_agg_7 [label="Expert 1 output"]
	moe_gate_7 -> tp_split_2_7 [label="Gate selection 2" style=dashed]
	tp_split_2_7 -> expert_compute_2_0_7
	tp_split_2_7 -> expert_compute_2_1_7
	expert_compute_2_0_7 -> tp_allreduce_2_7
	expert_compute_2_1_7 -> tp_allreduce_2_7
	tp_allreduce_2_7 -> expert_2_7
	expert_2_7 -> expert_agg_7 [label="Expert 2 output"]
	moe_gate_7 -> tp_split_3_7 [label="Gate selection 3" style=dashed]
	tp_split_3_7 -> expert_compute_3_0_7
	tp_split_3_7 -> expert_compute_3_1_7
	expert_compute_3_0_7 -> tp_allreduce_3_7
	expert_compute_3_1_7 -> tp_allreduce_3_7
	tp_allreduce_3_7 -> expert_3_7
	expert_3_7 -> expert_agg_7 [label="Expert 3 output"]
	moe_gate_7 -> tp_split_4_7 [label="Gate selection 4" style=dashed]
	tp_split_4_7 -> expert_compute_4_0_7
	tp_split_4_7 -> expert_compute_4_1_7
	expert_compute_4_0_7 -> tp_allreduce_4_7
	expert_compute_4_1_7 -> tp_allreduce_4_7
	tp_allreduce_4_7 -> expert_4_7
	expert_4_7 -> expert_agg_7 [label="Expert 4 output"]
	moe_gate_7 -> tp_split_5_7 [label="Gate selection 5" style=dashed]
	tp_split_5_7 -> expert_compute_5_0_7
	tp_split_5_7 -> expert_compute_5_1_7
	expert_compute_5_0_7 -> tp_allreduce_5_7
	expert_compute_5_1_7 -> tp_allreduce_5_7
	tp_allreduce_5_7 -> expert_5_7
	expert_5_7 -> expert_agg_7 [label="Expert 5 output"]
	moe_gate_7 -> tp_split_6_7 [label="Gate selection 6" style=dashed]
	tp_split_6_7 -> expert_compute_6_0_7
	tp_split_6_7 -> expert_compute_6_1_7
	expert_compute_6_0_7 -> tp_allreduce_6_7
	expert_compute_6_1_7 -> tp_allreduce_6_7
	tp_allreduce_6_7 -> expert_6_7
	expert_6_7 -> expert_agg_7 [label="Expert 6 output"]
	moe_gate_7 -> tp_split_7_7 [label="Gate selection 7" style=dashed]
	tp_split_7_7 -> expert_compute_7_0_7
	tp_split_7_7 -> expert_compute_7_1_7
	expert_compute_7_0_7 -> tp_allreduce_7_7
	expert_compute_7_1_7 -> tp_allreduce_7_7
	tp_allreduce_7_7 -> expert_7_7
	expert_7_7 -> expert_agg_7 [label="Expert 7 output"]
	moe_gate_7 -> tp_split_8_7 [label="Gate selection 8" style=dashed]
	tp_split_8_7 -> expert_compute_8_0_7
	tp_split_8_7 -> expert_compute_8_1_7
	expert_compute_8_0_7 -> tp_allreduce_8_7
	expert_compute_8_1_7 -> tp_allreduce_8_7
	tp_allreduce_8_7 -> expert_8_7
	expert_8_7 -> expert_agg_7 [label="Expert 8 output"]
	moe_gate_7 -> tp_split_9_7 [label="Gate selection 9" style=dashed]
	tp_split_9_7 -> expert_compute_9_0_7
	tp_split_9_7 -> expert_compute_9_1_7
	expert_compute_9_0_7 -> tp_allreduce_9_7
	expert_compute_9_1_7 -> tp_allreduce_9_7
	tp_allreduce_9_7 -> expert_9_7
	expert_9_7 -> expert_agg_7 [label="Expert 9 output"]
	moe_gate_7 -> tp_split_10_7 [label="Gate selection 10" style=dashed]
	tp_split_10_7 -> expert_compute_10_0_7
	tp_split_10_7 -> expert_compute_10_1_7
	expert_compute_10_0_7 -> tp_allreduce_10_7
	expert_compute_10_1_7 -> tp_allreduce_10_7
	tp_allreduce_10_7 -> expert_10_7
	expert_10_7 -> expert_agg_7 [label="Expert 10 output"]
	moe_gate_7 -> tp_split_11_7 [label="Gate selection 11" style=dashed]
	tp_split_11_7 -> expert_compute_11_0_7
	tp_split_11_7 -> expert_compute_11_1_7
	expert_compute_11_0_7 -> tp_allreduce_11_7
	expert_compute_11_1_7 -> tp_allreduce_11_7
	tp_allreduce_11_7 -> expert_11_7
	expert_11_7 -> expert_agg_7 [label="Expert 11 output"]
	moe_gate_7 -> tp_split_12_7 [label="Gate selection 12" style=dashed]
	tp_split_12_7 -> expert_compute_12_0_7
	tp_split_12_7 -> expert_compute_12_1_7
	expert_compute_12_0_7 -> tp_allreduce_12_7
	expert_compute_12_1_7 -> tp_allreduce_12_7
	tp_allreduce_12_7 -> expert_12_7
	expert_12_7 -> expert_agg_7 [label="Expert 12 output"]
	moe_gate_7 -> tp_split_13_7 [label="Gate selection 13" style=dashed]
	tp_split_13_7 -> expert_compute_13_0_7
	tp_split_13_7 -> expert_compute_13_1_7
	expert_compute_13_0_7 -> tp_allreduce_13_7
	expert_compute_13_1_7 -> tp_allreduce_13_7
	tp_allreduce_13_7 -> expert_13_7
	expert_13_7 -> expert_agg_7 [label="Expert 13 output"]
	moe_gate_7 -> tp_split_14_7 [label="Gate selection 14" style=dashed]
	tp_split_14_7 -> expert_compute_14_0_7
	tp_split_14_7 -> expert_compute_14_1_7
	expert_compute_14_0_7 -> tp_allreduce_14_7
	expert_compute_14_1_7 -> tp_allreduce_14_7
	tp_allreduce_14_7 -> expert_14_7
	expert_14_7 -> expert_agg_7 [label="Expert 14 output"]
	moe_gate_7 -> tp_split_15_7 [label="Gate selection 15" style=dashed]
	tp_split_15_7 -> expert_compute_15_0_7
	tp_split_15_7 -> expert_compute_15_1_7
	expert_compute_15_0_7 -> tp_allreduce_15_7
	expert_compute_15_1_7 -> tp_allreduce_15_7
	tp_allreduce_15_7 -> expert_15_7
	expert_15_7 -> expert_agg_7 [label="Expert 15 output"]
	moe_gate_7 -> tp_split_16_7 [label="Gate selection 16" style=dashed]
	tp_split_16_7 -> expert_compute_16_0_7
	tp_split_16_7 -> expert_compute_16_1_7
	expert_compute_16_0_7 -> tp_allreduce_16_7
	expert_compute_16_1_7 -> tp_allreduce_16_7
	tp_allreduce_16_7 -> expert_16_7
	expert_16_7 -> expert_agg_7 [label="Expert 16 output"]
	moe_gate_7 -> tp_split_17_7 [label="Gate selection 17" style=dashed]
	tp_split_17_7 -> expert_compute_17_0_7
	tp_split_17_7 -> expert_compute_17_1_7
	expert_compute_17_0_7 -> tp_allreduce_17_7
	expert_compute_17_1_7 -> tp_allreduce_17_7
	tp_allreduce_17_7 -> expert_17_7
	expert_17_7 -> expert_agg_7 [label="Expert 17 output"]
	moe_gate_7 -> tp_split_18_7 [label="Gate selection 18" style=dashed]
	tp_split_18_7 -> expert_compute_18_0_7
	tp_split_18_7 -> expert_compute_18_1_7
	expert_compute_18_0_7 -> tp_allreduce_18_7
	expert_compute_18_1_7 -> tp_allreduce_18_7
	tp_allreduce_18_7 -> expert_18_7
	expert_18_7 -> expert_agg_7 [label="Expert 18 output"]
	moe_gate_7 -> tp_split_19_7 [label="Gate selection 19" style=dashed]
	tp_split_19_7 -> expert_compute_19_0_7
	tp_split_19_7 -> expert_compute_19_1_7
	expert_compute_19_0_7 -> tp_allreduce_19_7
	expert_compute_19_1_7 -> tp_allreduce_19_7
	tp_allreduce_19_7 -> expert_19_7
	expert_19_7 -> expert_agg_7 [label="Expert 19 output"]
	moe_gate_7 -> tp_split_20_7 [label="Gate selection 20" style=dashed]
	tp_split_20_7 -> expert_compute_20_0_7
	tp_split_20_7 -> expert_compute_20_1_7
	expert_compute_20_0_7 -> tp_allreduce_20_7
	expert_compute_20_1_7 -> tp_allreduce_20_7
	tp_allreduce_20_7 -> expert_20_7
	expert_20_7 -> expert_agg_7 [label="Expert 20 output"]
	moe_gate_7 -> tp_split_21_7 [label="Gate selection 21" style=dashed]
	tp_split_21_7 -> expert_compute_21_0_7
	tp_split_21_7 -> expert_compute_21_1_7
	expert_compute_21_0_7 -> tp_allreduce_21_7
	expert_compute_21_1_7 -> tp_allreduce_21_7
	tp_allreduce_21_7 -> expert_21_7
	expert_21_7 -> expert_agg_7 [label="Expert 21 output"]
	moe_gate_7 -> tp_split_22_7 [label="Gate selection 22" style=dashed]
	tp_split_22_7 -> expert_compute_22_0_7
	tp_split_22_7 -> expert_compute_22_1_7
	expert_compute_22_0_7 -> tp_allreduce_22_7
	expert_compute_22_1_7 -> tp_allreduce_22_7
	tp_allreduce_22_7 -> expert_22_7
	expert_22_7 -> expert_agg_7 [label="Expert 22 output"]
	moe_gate_7 -> tp_split_23_7 [label="Gate selection 23" style=dashed]
	tp_split_23_7 -> expert_compute_23_0_7
	tp_split_23_7 -> expert_compute_23_1_7
	expert_compute_23_0_7 -> tp_allreduce_23_7
	expert_compute_23_1_7 -> tp_allreduce_23_7
	tp_allreduce_23_7 -> expert_23_7
	expert_23_7 -> expert_agg_7 [label="Expert 23 output"]
	moe_gate_7 -> tp_split_24_7 [label="Gate selection 24" style=dashed]
	tp_split_24_7 -> expert_compute_24_0_7
	tp_split_24_7 -> expert_compute_24_1_7
	expert_compute_24_0_7 -> tp_allreduce_24_7
	expert_compute_24_1_7 -> tp_allreduce_24_7
	tp_allreduce_24_7 -> expert_24_7
	expert_24_7 -> expert_agg_7 [label="Expert 24 output"]
	moe_gate_7 -> tp_split_25_7 [label="Gate selection 25" style=dashed]
	tp_split_25_7 -> expert_compute_25_0_7
	tp_split_25_7 -> expert_compute_25_1_7
	expert_compute_25_0_7 -> tp_allreduce_25_7
	expert_compute_25_1_7 -> tp_allreduce_25_7
	tp_allreduce_25_7 -> expert_25_7
	expert_25_7 -> expert_agg_7 [label="Expert 25 output"]
	moe_gate_7 -> tp_split_26_7 [label="Gate selection 26" style=dashed]
	tp_split_26_7 -> expert_compute_26_0_7
	tp_split_26_7 -> expert_compute_26_1_7
	expert_compute_26_0_7 -> tp_allreduce_26_7
	expert_compute_26_1_7 -> tp_allreduce_26_7
	tp_allreduce_26_7 -> expert_26_7
	expert_26_7 -> expert_agg_7 [label="Expert 26 output"]
	moe_gate_7 -> tp_split_27_7 [label="Gate selection 27" style=dashed]
	tp_split_27_7 -> expert_compute_27_0_7
	tp_split_27_7 -> expert_compute_27_1_7
	expert_compute_27_0_7 -> tp_allreduce_27_7
	expert_compute_27_1_7 -> tp_allreduce_27_7
	tp_allreduce_27_7 -> expert_27_7
	expert_27_7 -> expert_agg_7 [label="Expert 27 output"]
	moe_gate_7 -> tp_split_28_7 [label="Gate selection 28" style=dashed]
	tp_split_28_7 -> expert_compute_28_0_7
	tp_split_28_7 -> expert_compute_28_1_7
	expert_compute_28_0_7 -> tp_allreduce_28_7
	expert_compute_28_1_7 -> tp_allreduce_28_7
	tp_allreduce_28_7 -> expert_28_7
	expert_28_7 -> expert_agg_7 [label="Expert 28 output"]
	moe_gate_7 -> tp_split_29_7 [label="Gate selection 29" style=dashed]
	tp_split_29_7 -> expert_compute_29_0_7
	tp_split_29_7 -> expert_compute_29_1_7
	expert_compute_29_0_7 -> tp_allreduce_29_7
	expert_compute_29_1_7 -> tp_allreduce_29_7
	tp_allreduce_29_7 -> expert_29_7
	expert_29_7 -> expert_agg_7 [label="Expert 29 output"]
	moe_gate_7 -> tp_split_30_7 [label="Gate selection 30" style=dashed]
	tp_split_30_7 -> expert_compute_30_0_7
	tp_split_30_7 -> expert_compute_30_1_7
	expert_compute_30_0_7 -> tp_allreduce_30_7
	expert_compute_30_1_7 -> tp_allreduce_30_7
	tp_allreduce_30_7 -> expert_30_7
	expert_30_7 -> expert_agg_7 [label="Expert 30 output"]
	moe_gate_7 -> tp_split_31_7 [label="Gate selection 31" style=dashed]
	tp_split_31_7 -> expert_compute_31_0_7
	tp_split_31_7 -> expert_compute_31_1_7
	expert_compute_31_0_7 -> tp_allreduce_31_7
	expert_compute_31_1_7 -> tp_allreduce_31_7
	tp_allreduce_31_7 -> expert_31_7
	expert_31_7 -> expert_agg_7 [label="Expert 31 output"]
	moe_gate_7 -> tp_split_32_7 [label="Gate selection 32" style=dashed]
	tp_split_32_7 -> expert_compute_32_0_7
	tp_split_32_7 -> expert_compute_32_1_7
	expert_compute_32_0_7 -> tp_allreduce_32_7
	expert_compute_32_1_7 -> tp_allreduce_32_7
	tp_allreduce_32_7 -> expert_32_7
	expert_32_7 -> expert_agg_7 [label="Expert 32 output"]
	moe_gate_7 -> tp_split_33_7 [label="Gate selection 33" style=dashed]
	tp_split_33_7 -> expert_compute_33_0_7
	tp_split_33_7 -> expert_compute_33_1_7
	expert_compute_33_0_7 -> tp_allreduce_33_7
	expert_compute_33_1_7 -> tp_allreduce_33_7
	tp_allreduce_33_7 -> expert_33_7
	expert_33_7 -> expert_agg_7 [label="Expert 33 output"]
	moe_gate_7 -> tp_split_34_7 [label="Gate selection 34" style=dashed]
	tp_split_34_7 -> expert_compute_34_0_7
	tp_split_34_7 -> expert_compute_34_1_7
	expert_compute_34_0_7 -> tp_allreduce_34_7
	expert_compute_34_1_7 -> tp_allreduce_34_7
	tp_allreduce_34_7 -> expert_34_7
	expert_34_7 -> expert_agg_7 [label="Expert 34 output"]
	moe_gate_7 -> tp_split_35_7 [label="Gate selection 35" style=dashed]
	tp_split_35_7 -> expert_compute_35_0_7
	tp_split_35_7 -> expert_compute_35_1_7
	expert_compute_35_0_7 -> tp_allreduce_35_7
	expert_compute_35_1_7 -> tp_allreduce_35_7
	tp_allreduce_35_7 -> expert_35_7
	expert_35_7 -> expert_agg_7 [label="Expert 35 output"]
	moe_gate_7 -> tp_split_36_7 [label="Gate selection 36" style=dashed]
	tp_split_36_7 -> expert_compute_36_0_7
	tp_split_36_7 -> expert_compute_36_1_7
	expert_compute_36_0_7 -> tp_allreduce_36_7
	expert_compute_36_1_7 -> tp_allreduce_36_7
	tp_allreduce_36_7 -> expert_36_7
	expert_36_7 -> expert_agg_7 [label="Expert 36 output"]
	moe_gate_7 -> tp_split_37_7 [label="Gate selection 37" style=dashed]
	tp_split_37_7 -> expert_compute_37_0_7
	tp_split_37_7 -> expert_compute_37_1_7
	expert_compute_37_0_7 -> tp_allreduce_37_7
	expert_compute_37_1_7 -> tp_allreduce_37_7
	tp_allreduce_37_7 -> expert_37_7
	expert_37_7 -> expert_agg_7 [label="Expert 37 output"]
	moe_gate_7 -> tp_split_38_7 [label="Gate selection 38" style=dashed]
	tp_split_38_7 -> expert_compute_38_0_7
	tp_split_38_7 -> expert_compute_38_1_7
	expert_compute_38_0_7 -> tp_allreduce_38_7
	expert_compute_38_1_7 -> tp_allreduce_38_7
	tp_allreduce_38_7 -> expert_38_7
	expert_38_7 -> expert_agg_7 [label="Expert 38 output"]
	moe_gate_7 -> tp_split_39_7 [label="Gate selection 39" style=dashed]
	tp_split_39_7 -> expert_compute_39_0_7
	tp_split_39_7 -> expert_compute_39_1_7
	expert_compute_39_0_7 -> tp_allreduce_39_7
	expert_compute_39_1_7 -> tp_allreduce_39_7
	tp_allreduce_39_7 -> expert_39_7
	expert_39_7 -> expert_agg_7 [label="Expert 39 output"]
	moe_gate_7 -> tp_split_40_7 [label="Gate selection 40" style=dashed]
	tp_split_40_7 -> expert_compute_40_0_7
	tp_split_40_7 -> expert_compute_40_1_7
	expert_compute_40_0_7 -> tp_allreduce_40_7
	expert_compute_40_1_7 -> tp_allreduce_40_7
	tp_allreduce_40_7 -> expert_40_7
	expert_40_7 -> expert_agg_7 [label="Expert 40 output"]
	moe_gate_7 -> tp_split_41_7 [label="Gate selection 41" style=dashed]
	tp_split_41_7 -> expert_compute_41_0_7
	tp_split_41_7 -> expert_compute_41_1_7
	expert_compute_41_0_7 -> tp_allreduce_41_7
	expert_compute_41_1_7 -> tp_allreduce_41_7
	tp_allreduce_41_7 -> expert_41_7
	expert_41_7 -> expert_agg_7 [label="Expert 41 output"]
	moe_gate_7 -> tp_split_42_7 [label="Gate selection 42" style=dashed]
	tp_split_42_7 -> expert_compute_42_0_7
	tp_split_42_7 -> expert_compute_42_1_7
	expert_compute_42_0_7 -> tp_allreduce_42_7
	expert_compute_42_1_7 -> tp_allreduce_42_7
	tp_allreduce_42_7 -> expert_42_7
	expert_42_7 -> expert_agg_7 [label="Expert 42 output"]
	moe_gate_7 -> tp_split_43_7 [label="Gate selection 43" style=dashed]
	tp_split_43_7 -> expert_compute_43_0_7
	tp_split_43_7 -> expert_compute_43_1_7
	expert_compute_43_0_7 -> tp_allreduce_43_7
	expert_compute_43_1_7 -> tp_allreduce_43_7
	tp_allreduce_43_7 -> expert_43_7
	expert_43_7 -> expert_agg_7 [label="Expert 43 output"]
	moe_gate_7 -> tp_split_44_7 [label="Gate selection 44" style=dashed]
	tp_split_44_7 -> expert_compute_44_0_7
	tp_split_44_7 -> expert_compute_44_1_7
	expert_compute_44_0_7 -> tp_allreduce_44_7
	expert_compute_44_1_7 -> tp_allreduce_44_7
	tp_allreduce_44_7 -> expert_44_7
	expert_44_7 -> expert_agg_7 [label="Expert 44 output"]
	moe_gate_7 -> tp_split_45_7 [label="Gate selection 45" style=dashed]
	tp_split_45_7 -> expert_compute_45_0_7
	tp_split_45_7 -> expert_compute_45_1_7
	expert_compute_45_0_7 -> tp_allreduce_45_7
	expert_compute_45_1_7 -> tp_allreduce_45_7
	tp_allreduce_45_7 -> expert_45_7
	expert_45_7 -> expert_agg_7 [label="Expert 45 output"]
	moe_gate_7 -> tp_split_46_7 [label="Gate selection 46" style=dashed]
	tp_split_46_7 -> expert_compute_46_0_7
	tp_split_46_7 -> expert_compute_46_1_7
	expert_compute_46_0_7 -> tp_allreduce_46_7
	expert_compute_46_1_7 -> tp_allreduce_46_7
	tp_allreduce_46_7 -> expert_46_7
	expert_46_7 -> expert_agg_7 [label="Expert 46 output"]
	moe_gate_7 -> tp_split_47_7 [label="Gate selection 47" style=dashed]
	tp_split_47_7 -> expert_compute_47_0_7
	tp_split_47_7 -> expert_compute_47_1_7
	expert_compute_47_0_7 -> tp_allreduce_47_7
	expert_compute_47_1_7 -> tp_allreduce_47_7
	tp_allreduce_47_7 -> expert_47_7
	expert_47_7 -> expert_agg_7 [label="Expert 47 output"]
	moe_gate_7 -> tp_split_48_7 [label="Gate selection 48" style=dashed]
	tp_split_48_7 -> expert_compute_48_0_7
	tp_split_48_7 -> expert_compute_48_1_7
	expert_compute_48_0_7 -> tp_allreduce_48_7
	expert_compute_48_1_7 -> tp_allreduce_48_7
	tp_allreduce_48_7 -> expert_48_7
	expert_48_7 -> expert_agg_7 [label="Expert 48 output"]
	moe_gate_7 -> tp_split_49_7 [label="Gate selection 49" style=dashed]
	tp_split_49_7 -> expert_compute_49_0_7
	tp_split_49_7 -> expert_compute_49_1_7
	expert_compute_49_0_7 -> tp_allreduce_49_7
	expert_compute_49_1_7 -> tp_allreduce_49_7
	tp_allreduce_49_7 -> expert_49_7
	expert_49_7 -> expert_agg_7 [label="Expert 49 output"]
	moe_gate_7 -> tp_split_50_7 [label="Gate selection 50" style=dashed]
	tp_split_50_7 -> expert_compute_50_0_7
	tp_split_50_7 -> expert_compute_50_1_7
	expert_compute_50_0_7 -> tp_allreduce_50_7
	expert_compute_50_1_7 -> tp_allreduce_50_7
	tp_allreduce_50_7 -> expert_50_7
	expert_50_7 -> expert_agg_7 [label="Expert 50 output"]
	moe_gate_7 -> tp_split_51_7 [label="Gate selection 51" style=dashed]
	tp_split_51_7 -> expert_compute_51_0_7
	tp_split_51_7 -> expert_compute_51_1_7
	expert_compute_51_0_7 -> tp_allreduce_51_7
	expert_compute_51_1_7 -> tp_allreduce_51_7
	tp_allreduce_51_7 -> expert_51_7
	expert_51_7 -> expert_agg_7 [label="Expert 51 output"]
	moe_gate_7 -> tp_split_52_7 [label="Gate selection 52" style=dashed]
	tp_split_52_7 -> expert_compute_52_0_7
	tp_split_52_7 -> expert_compute_52_1_7
	expert_compute_52_0_7 -> tp_allreduce_52_7
	expert_compute_52_1_7 -> tp_allreduce_52_7
	tp_allreduce_52_7 -> expert_52_7
	expert_52_7 -> expert_agg_7 [label="Expert 52 output"]
	moe_gate_7 -> tp_split_53_7 [label="Gate selection 53" style=dashed]
	tp_split_53_7 -> expert_compute_53_0_7
	tp_split_53_7 -> expert_compute_53_1_7
	expert_compute_53_0_7 -> tp_allreduce_53_7
	expert_compute_53_1_7 -> tp_allreduce_53_7
	tp_allreduce_53_7 -> expert_53_7
	expert_53_7 -> expert_agg_7 [label="Expert 53 output"]
	moe_gate_7 -> tp_split_54_7 [label="Gate selection 54" style=dashed]
	tp_split_54_7 -> expert_compute_54_0_7
	tp_split_54_7 -> expert_compute_54_1_7
	expert_compute_54_0_7 -> tp_allreduce_54_7
	expert_compute_54_1_7 -> tp_allreduce_54_7
	tp_allreduce_54_7 -> expert_54_7
	expert_54_7 -> expert_agg_7 [label="Expert 54 output"]
	moe_gate_7 -> tp_split_55_7 [label="Gate selection 55" style=dashed]
	tp_split_55_7 -> expert_compute_55_0_7
	tp_split_55_7 -> expert_compute_55_1_7
	expert_compute_55_0_7 -> tp_allreduce_55_7
	expert_compute_55_1_7 -> tp_allreduce_55_7
	tp_allreduce_55_7 -> expert_55_7
	expert_55_7 -> expert_agg_7 [label="Expert 55 output"]
	moe_gate_7 -> tp_split_56_7 [label="Gate selection 56" style=dashed]
	tp_split_56_7 -> expert_compute_56_0_7
	tp_split_56_7 -> expert_compute_56_1_7
	expert_compute_56_0_7 -> tp_allreduce_56_7
	expert_compute_56_1_7 -> tp_allreduce_56_7
	tp_allreduce_56_7 -> expert_56_7
	expert_56_7 -> expert_agg_7 [label="Expert 56 output"]
	moe_gate_7 -> tp_split_57_7 [label="Gate selection 57" style=dashed]
	tp_split_57_7 -> expert_compute_57_0_7
	tp_split_57_7 -> expert_compute_57_1_7
	expert_compute_57_0_7 -> tp_allreduce_57_7
	expert_compute_57_1_7 -> tp_allreduce_57_7
	tp_allreduce_57_7 -> expert_57_7
	expert_57_7 -> expert_agg_7 [label="Expert 57 output"]
	moe_gate_7 -> tp_split_58_7 [label="Gate selection 58" style=dashed]
	tp_split_58_7 -> expert_compute_58_0_7
	tp_split_58_7 -> expert_compute_58_1_7
	expert_compute_58_0_7 -> tp_allreduce_58_7
	expert_compute_58_1_7 -> tp_allreduce_58_7
	tp_allreduce_58_7 -> expert_58_7
	expert_58_7 -> expert_agg_7 [label="Expert 58 output"]
	moe_gate_7 -> tp_split_59_7 [label="Gate selection 59" style=dashed]
	tp_split_59_7 -> expert_compute_59_0_7
	tp_split_59_7 -> expert_compute_59_1_7
	expert_compute_59_0_7 -> tp_allreduce_59_7
	expert_compute_59_1_7 -> tp_allreduce_59_7
	tp_allreduce_59_7 -> expert_59_7
	expert_59_7 -> expert_agg_7 [label="Expert 59 output"]
	moe_gate_7 -> tp_split_60_7 [label="Gate selection 60" style=dashed]
	tp_split_60_7 -> expert_compute_60_0_7
	tp_split_60_7 -> expert_compute_60_1_7
	expert_compute_60_0_7 -> tp_allreduce_60_7
	expert_compute_60_1_7 -> tp_allreduce_60_7
	tp_allreduce_60_7 -> expert_60_7
	expert_60_7 -> expert_agg_7 [label="Expert 60 output"]
	moe_gate_7 -> tp_split_61_7 [label="Gate selection 61" style=dashed]
	tp_split_61_7 -> expert_compute_61_0_7
	tp_split_61_7 -> expert_compute_61_1_7
	expert_compute_61_0_7 -> tp_allreduce_61_7
	expert_compute_61_1_7 -> tp_allreduce_61_7
	tp_allreduce_61_7 -> expert_61_7
	expert_61_7 -> expert_agg_7 [label="Expert 61 output"]
	moe_gate_7 -> tp_split_62_7 [label="Gate selection 62" style=dashed]
	tp_split_62_7 -> expert_compute_62_0_7
	tp_split_62_7 -> expert_compute_62_1_7
	expert_compute_62_0_7 -> tp_allreduce_62_7
	expert_compute_62_1_7 -> tp_allreduce_62_7
	tp_allreduce_62_7 -> expert_62_7
	expert_62_7 -> expert_agg_7 [label="Expert 62 output"]
	moe_gate_7 -> tp_split_63_7 [label="Gate selection 63" style=dashed]
	tp_split_63_7 -> expert_compute_63_0_7
	tp_split_63_7 -> expert_compute_63_1_7
	expert_compute_63_0_7 -> tp_allreduce_63_7
	expert_compute_63_1_7 -> tp_allreduce_63_7
	tp_allreduce_63_7 -> expert_63_7
	expert_63_7 -> expert_agg_7 [label="Expert 63 output"]
	expert_agg_7 -> layer_norm_7
	layer_norm_7 -> attn_norm_8
	attn_norm_8 -> attn_q_8
	attn_norm_8 -> attn_k_8
	attn_norm_8 -> attn_v_8
	attn_q_8 -> attn_score_8
	attn_k_8 -> attn_score_8
	attn_v_8 -> attn_out_8
	attn_score_8 -> attn_out_8
	attn_out_8 -> moe_gate_8
	moe_gate_8 -> tp_split_0_8 [label="Gate selection 0" style=dashed]
	tp_split_0_8 -> expert_compute_0_0_8
	tp_split_0_8 -> expert_compute_0_1_8
	expert_compute_0_0_8 -> tp_allreduce_0_8
	expert_compute_0_1_8 -> tp_allreduce_0_8
	tp_allreduce_0_8 -> expert_0_8
	expert_0_8 -> expert_agg_8 [label="Expert 0 output"]
	moe_gate_8 -> tp_split_1_8 [label="Gate selection 1" style=dashed]
	tp_split_1_8 -> expert_compute_1_0_8
	tp_split_1_8 -> expert_compute_1_1_8
	expert_compute_1_0_8 -> tp_allreduce_1_8
	expert_compute_1_1_8 -> tp_allreduce_1_8
	tp_allreduce_1_8 -> expert_1_8
	expert_1_8 -> expert_agg_8 [label="Expert 1 output"]
	moe_gate_8 -> tp_split_2_8 [label="Gate selection 2" style=dashed]
	tp_split_2_8 -> expert_compute_2_0_8
	tp_split_2_8 -> expert_compute_2_1_8
	expert_compute_2_0_8 -> tp_allreduce_2_8
	expert_compute_2_1_8 -> tp_allreduce_2_8
	tp_allreduce_2_8 -> expert_2_8
	expert_2_8 -> expert_agg_8 [label="Expert 2 output"]
	moe_gate_8 -> tp_split_3_8 [label="Gate selection 3" style=dashed]
	tp_split_3_8 -> expert_compute_3_0_8
	tp_split_3_8 -> expert_compute_3_1_8
	expert_compute_3_0_8 -> tp_allreduce_3_8
	expert_compute_3_1_8 -> tp_allreduce_3_8
	tp_allreduce_3_8 -> expert_3_8
	expert_3_8 -> expert_agg_8 [label="Expert 3 output"]
	moe_gate_8 -> tp_split_4_8 [label="Gate selection 4" style=dashed]
	tp_split_4_8 -> expert_compute_4_0_8
	tp_split_4_8 -> expert_compute_4_1_8
	expert_compute_4_0_8 -> tp_allreduce_4_8
	expert_compute_4_1_8 -> tp_allreduce_4_8
	tp_allreduce_4_8 -> expert_4_8
	expert_4_8 -> expert_agg_8 [label="Expert 4 output"]
	moe_gate_8 -> tp_split_5_8 [label="Gate selection 5" style=dashed]
	tp_split_5_8 -> expert_compute_5_0_8
	tp_split_5_8 -> expert_compute_5_1_8
	expert_compute_5_0_8 -> tp_allreduce_5_8
	expert_compute_5_1_8 -> tp_allreduce_5_8
	tp_allreduce_5_8 -> expert_5_8
	expert_5_8 -> expert_agg_8 [label="Expert 5 output"]
	moe_gate_8 -> tp_split_6_8 [label="Gate selection 6" style=dashed]
	tp_split_6_8 -> expert_compute_6_0_8
	tp_split_6_8 -> expert_compute_6_1_8
	expert_compute_6_0_8 -> tp_allreduce_6_8
	expert_compute_6_1_8 -> tp_allreduce_6_8
	tp_allreduce_6_8 -> expert_6_8
	expert_6_8 -> expert_agg_8 [label="Expert 6 output"]
	moe_gate_8 -> tp_split_7_8 [label="Gate selection 7" style=dashed]
	tp_split_7_8 -> expert_compute_7_0_8
	tp_split_7_8 -> expert_compute_7_1_8
	expert_compute_7_0_8 -> tp_allreduce_7_8
	expert_compute_7_1_8 -> tp_allreduce_7_8
	tp_allreduce_7_8 -> expert_7_8
	expert_7_8 -> expert_agg_8 [label="Expert 7 output"]
	moe_gate_8 -> tp_split_8_8 [label="Gate selection 8" style=dashed]
	tp_split_8_8 -> expert_compute_8_0_8
	tp_split_8_8 -> expert_compute_8_1_8
	expert_compute_8_0_8 -> tp_allreduce_8_8
	expert_compute_8_1_8 -> tp_allreduce_8_8
	tp_allreduce_8_8 -> expert_8_8
	expert_8_8 -> expert_agg_8 [label="Expert 8 output"]
	moe_gate_8 -> tp_split_9_8 [label="Gate selection 9" style=dashed]
	tp_split_9_8 -> expert_compute_9_0_8
	tp_split_9_8 -> expert_compute_9_1_8
	expert_compute_9_0_8 -> tp_allreduce_9_8
	expert_compute_9_1_8 -> tp_allreduce_9_8
	tp_allreduce_9_8 -> expert_9_8
	expert_9_8 -> expert_agg_8 [label="Expert 9 output"]
	moe_gate_8 -> tp_split_10_8 [label="Gate selection 10" style=dashed]
	tp_split_10_8 -> expert_compute_10_0_8
	tp_split_10_8 -> expert_compute_10_1_8
	expert_compute_10_0_8 -> tp_allreduce_10_8
	expert_compute_10_1_8 -> tp_allreduce_10_8
	tp_allreduce_10_8 -> expert_10_8
	expert_10_8 -> expert_agg_8 [label="Expert 10 output"]
	moe_gate_8 -> tp_split_11_8 [label="Gate selection 11" style=dashed]
	tp_split_11_8 -> expert_compute_11_0_8
	tp_split_11_8 -> expert_compute_11_1_8
	expert_compute_11_0_8 -> tp_allreduce_11_8
	expert_compute_11_1_8 -> tp_allreduce_11_8
	tp_allreduce_11_8 -> expert_11_8
	expert_11_8 -> expert_agg_8 [label="Expert 11 output"]
	moe_gate_8 -> tp_split_12_8 [label="Gate selection 12" style=dashed]
	tp_split_12_8 -> expert_compute_12_0_8
	tp_split_12_8 -> expert_compute_12_1_8
	expert_compute_12_0_8 -> tp_allreduce_12_8
	expert_compute_12_1_8 -> tp_allreduce_12_8
	tp_allreduce_12_8 -> expert_12_8
	expert_12_8 -> expert_agg_8 [label="Expert 12 output"]
	moe_gate_8 -> tp_split_13_8 [label="Gate selection 13" style=dashed]
	tp_split_13_8 -> expert_compute_13_0_8
	tp_split_13_8 -> expert_compute_13_1_8
	expert_compute_13_0_8 -> tp_allreduce_13_8
	expert_compute_13_1_8 -> tp_allreduce_13_8
	tp_allreduce_13_8 -> expert_13_8
	expert_13_8 -> expert_agg_8 [label="Expert 13 output"]
	moe_gate_8 -> tp_split_14_8 [label="Gate selection 14" style=dashed]
	tp_split_14_8 -> expert_compute_14_0_8
	tp_split_14_8 -> expert_compute_14_1_8
	expert_compute_14_0_8 -> tp_allreduce_14_8
	expert_compute_14_1_8 -> tp_allreduce_14_8
	tp_allreduce_14_8 -> expert_14_8
	expert_14_8 -> expert_agg_8 [label="Expert 14 output"]
	moe_gate_8 -> tp_split_15_8 [label="Gate selection 15" style=dashed]
	tp_split_15_8 -> expert_compute_15_0_8
	tp_split_15_8 -> expert_compute_15_1_8
	expert_compute_15_0_8 -> tp_allreduce_15_8
	expert_compute_15_1_8 -> tp_allreduce_15_8
	tp_allreduce_15_8 -> expert_15_8
	expert_15_8 -> expert_agg_8 [label="Expert 15 output"]
	moe_gate_8 -> tp_split_16_8 [label="Gate selection 16" style=dashed]
	tp_split_16_8 -> expert_compute_16_0_8
	tp_split_16_8 -> expert_compute_16_1_8
	expert_compute_16_0_8 -> tp_allreduce_16_8
	expert_compute_16_1_8 -> tp_allreduce_16_8
	tp_allreduce_16_8 -> expert_16_8
	expert_16_8 -> expert_agg_8 [label="Expert 16 output"]
	moe_gate_8 -> tp_split_17_8 [label="Gate selection 17" style=dashed]
	tp_split_17_8 -> expert_compute_17_0_8
	tp_split_17_8 -> expert_compute_17_1_8
	expert_compute_17_0_8 -> tp_allreduce_17_8
	expert_compute_17_1_8 -> tp_allreduce_17_8
	tp_allreduce_17_8 -> expert_17_8
	expert_17_8 -> expert_agg_8 [label="Expert 17 output"]
	moe_gate_8 -> tp_split_18_8 [label="Gate selection 18" style=dashed]
	tp_split_18_8 -> expert_compute_18_0_8
	tp_split_18_8 -> expert_compute_18_1_8
	expert_compute_18_0_8 -> tp_allreduce_18_8
	expert_compute_18_1_8 -> tp_allreduce_18_8
	tp_allreduce_18_8 -> expert_18_8
	expert_18_8 -> expert_agg_8 [label="Expert 18 output"]
	moe_gate_8 -> tp_split_19_8 [label="Gate selection 19" style=dashed]
	tp_split_19_8 -> expert_compute_19_0_8
	tp_split_19_8 -> expert_compute_19_1_8
	expert_compute_19_0_8 -> tp_allreduce_19_8
	expert_compute_19_1_8 -> tp_allreduce_19_8
	tp_allreduce_19_8 -> expert_19_8
	expert_19_8 -> expert_agg_8 [label="Expert 19 output"]
	moe_gate_8 -> tp_split_20_8 [label="Gate selection 20" style=dashed]
	tp_split_20_8 -> expert_compute_20_0_8
	tp_split_20_8 -> expert_compute_20_1_8
	expert_compute_20_0_8 -> tp_allreduce_20_8
	expert_compute_20_1_8 -> tp_allreduce_20_8
	tp_allreduce_20_8 -> expert_20_8
	expert_20_8 -> expert_agg_8 [label="Expert 20 output"]
	moe_gate_8 -> tp_split_21_8 [label="Gate selection 21" style=dashed]
	tp_split_21_8 -> expert_compute_21_0_8
	tp_split_21_8 -> expert_compute_21_1_8
	expert_compute_21_0_8 -> tp_allreduce_21_8
	expert_compute_21_1_8 -> tp_allreduce_21_8
	tp_allreduce_21_8 -> expert_21_8
	expert_21_8 -> expert_agg_8 [label="Expert 21 output"]
	moe_gate_8 -> tp_split_22_8 [label="Gate selection 22" style=dashed]
	tp_split_22_8 -> expert_compute_22_0_8
	tp_split_22_8 -> expert_compute_22_1_8
	expert_compute_22_0_8 -> tp_allreduce_22_8
	expert_compute_22_1_8 -> tp_allreduce_22_8
	tp_allreduce_22_8 -> expert_22_8
	expert_22_8 -> expert_agg_8 [label="Expert 22 output"]
	moe_gate_8 -> tp_split_23_8 [label="Gate selection 23" style=dashed]
	tp_split_23_8 -> expert_compute_23_0_8
	tp_split_23_8 -> expert_compute_23_1_8
	expert_compute_23_0_8 -> tp_allreduce_23_8
	expert_compute_23_1_8 -> tp_allreduce_23_8
	tp_allreduce_23_8 -> expert_23_8
	expert_23_8 -> expert_agg_8 [label="Expert 23 output"]
	moe_gate_8 -> tp_split_24_8 [label="Gate selection 24" style=dashed]
	tp_split_24_8 -> expert_compute_24_0_8
	tp_split_24_8 -> expert_compute_24_1_8
	expert_compute_24_0_8 -> tp_allreduce_24_8
	expert_compute_24_1_8 -> tp_allreduce_24_8
	tp_allreduce_24_8 -> expert_24_8
	expert_24_8 -> expert_agg_8 [label="Expert 24 output"]
	moe_gate_8 -> tp_split_25_8 [label="Gate selection 25" style=dashed]
	tp_split_25_8 -> expert_compute_25_0_8
	tp_split_25_8 -> expert_compute_25_1_8
	expert_compute_25_0_8 -> tp_allreduce_25_8
	expert_compute_25_1_8 -> tp_allreduce_25_8
	tp_allreduce_25_8 -> expert_25_8
	expert_25_8 -> expert_agg_8 [label="Expert 25 output"]
	moe_gate_8 -> tp_split_26_8 [label="Gate selection 26" style=dashed]
	tp_split_26_8 -> expert_compute_26_0_8
	tp_split_26_8 -> expert_compute_26_1_8
	expert_compute_26_0_8 -> tp_allreduce_26_8
	expert_compute_26_1_8 -> tp_allreduce_26_8
	tp_allreduce_26_8 -> expert_26_8
	expert_26_8 -> expert_agg_8 [label="Expert 26 output"]
	moe_gate_8 -> tp_split_27_8 [label="Gate selection 27" style=dashed]
	tp_split_27_8 -> expert_compute_27_0_8
	tp_split_27_8 -> expert_compute_27_1_8
	expert_compute_27_0_8 -> tp_allreduce_27_8
	expert_compute_27_1_8 -> tp_allreduce_27_8
	tp_allreduce_27_8 -> expert_27_8
	expert_27_8 -> expert_agg_8 [label="Expert 27 output"]
	moe_gate_8 -> tp_split_28_8 [label="Gate selection 28" style=dashed]
	tp_split_28_8 -> expert_compute_28_0_8
	tp_split_28_8 -> expert_compute_28_1_8
	expert_compute_28_0_8 -> tp_allreduce_28_8
	expert_compute_28_1_8 -> tp_allreduce_28_8
	tp_allreduce_28_8 -> expert_28_8
	expert_28_8 -> expert_agg_8 [label="Expert 28 output"]
	moe_gate_8 -> tp_split_29_8 [label="Gate selection 29" style=dashed]
	tp_split_29_8 -> expert_compute_29_0_8
	tp_split_29_8 -> expert_compute_29_1_8
	expert_compute_29_0_8 -> tp_allreduce_29_8
	expert_compute_29_1_8 -> tp_allreduce_29_8
	tp_allreduce_29_8 -> expert_29_8
	expert_29_8 -> expert_agg_8 [label="Expert 29 output"]
	moe_gate_8 -> tp_split_30_8 [label="Gate selection 30" style=dashed]
	tp_split_30_8 -> expert_compute_30_0_8
	tp_split_30_8 -> expert_compute_30_1_8
	expert_compute_30_0_8 -> tp_allreduce_30_8
	expert_compute_30_1_8 -> tp_allreduce_30_8
	tp_allreduce_30_8 -> expert_30_8
	expert_30_8 -> expert_agg_8 [label="Expert 30 output"]
	moe_gate_8 -> tp_split_31_8 [label="Gate selection 31" style=dashed]
	tp_split_31_8 -> expert_compute_31_0_8
	tp_split_31_8 -> expert_compute_31_1_8
	expert_compute_31_0_8 -> tp_allreduce_31_8
	expert_compute_31_1_8 -> tp_allreduce_31_8
	tp_allreduce_31_8 -> expert_31_8
	expert_31_8 -> expert_agg_8 [label="Expert 31 output"]
	moe_gate_8 -> tp_split_32_8 [label="Gate selection 32" style=dashed]
	tp_split_32_8 -> expert_compute_32_0_8
	tp_split_32_8 -> expert_compute_32_1_8
	expert_compute_32_0_8 -> tp_allreduce_32_8
	expert_compute_32_1_8 -> tp_allreduce_32_8
	tp_allreduce_32_8 -> expert_32_8
	expert_32_8 -> expert_agg_8 [label="Expert 32 output"]
	moe_gate_8 -> tp_split_33_8 [label="Gate selection 33" style=dashed]
	tp_split_33_8 -> expert_compute_33_0_8
	tp_split_33_8 -> expert_compute_33_1_8
	expert_compute_33_0_8 -> tp_allreduce_33_8
	expert_compute_33_1_8 -> tp_allreduce_33_8
	tp_allreduce_33_8 -> expert_33_8
	expert_33_8 -> expert_agg_8 [label="Expert 33 output"]
	moe_gate_8 -> tp_split_34_8 [label="Gate selection 34" style=dashed]
	tp_split_34_8 -> expert_compute_34_0_8
	tp_split_34_8 -> expert_compute_34_1_8
	expert_compute_34_0_8 -> tp_allreduce_34_8
	expert_compute_34_1_8 -> tp_allreduce_34_8
	tp_allreduce_34_8 -> expert_34_8
	expert_34_8 -> expert_agg_8 [label="Expert 34 output"]
	moe_gate_8 -> tp_split_35_8 [label="Gate selection 35" style=dashed]
	tp_split_35_8 -> expert_compute_35_0_8
	tp_split_35_8 -> expert_compute_35_1_8
	expert_compute_35_0_8 -> tp_allreduce_35_8
	expert_compute_35_1_8 -> tp_allreduce_35_8
	tp_allreduce_35_8 -> expert_35_8
	expert_35_8 -> expert_agg_8 [label="Expert 35 output"]
	moe_gate_8 -> tp_split_36_8 [label="Gate selection 36" style=dashed]
	tp_split_36_8 -> expert_compute_36_0_8
	tp_split_36_8 -> expert_compute_36_1_8
	expert_compute_36_0_8 -> tp_allreduce_36_8
	expert_compute_36_1_8 -> tp_allreduce_36_8
	tp_allreduce_36_8 -> expert_36_8
	expert_36_8 -> expert_agg_8 [label="Expert 36 output"]
	moe_gate_8 -> tp_split_37_8 [label="Gate selection 37" style=dashed]
	tp_split_37_8 -> expert_compute_37_0_8
	tp_split_37_8 -> expert_compute_37_1_8
	expert_compute_37_0_8 -> tp_allreduce_37_8
	expert_compute_37_1_8 -> tp_allreduce_37_8
	tp_allreduce_37_8 -> expert_37_8
	expert_37_8 -> expert_agg_8 [label="Expert 37 output"]
	moe_gate_8 -> tp_split_38_8 [label="Gate selection 38" style=dashed]
	tp_split_38_8 -> expert_compute_38_0_8
	tp_split_38_8 -> expert_compute_38_1_8
	expert_compute_38_0_8 -> tp_allreduce_38_8
	expert_compute_38_1_8 -> tp_allreduce_38_8
	tp_allreduce_38_8 -> expert_38_8
	expert_38_8 -> expert_agg_8 [label="Expert 38 output"]
	moe_gate_8 -> tp_split_39_8 [label="Gate selection 39" style=dashed]
	tp_split_39_8 -> expert_compute_39_0_8
	tp_split_39_8 -> expert_compute_39_1_8
	expert_compute_39_0_8 -> tp_allreduce_39_8
	expert_compute_39_1_8 -> tp_allreduce_39_8
	tp_allreduce_39_8 -> expert_39_8
	expert_39_8 -> expert_agg_8 [label="Expert 39 output"]
	moe_gate_8 -> tp_split_40_8 [label="Gate selection 40" style=dashed]
	tp_split_40_8 -> expert_compute_40_0_8
	tp_split_40_8 -> expert_compute_40_1_8
	expert_compute_40_0_8 -> tp_allreduce_40_8
	expert_compute_40_1_8 -> tp_allreduce_40_8
	tp_allreduce_40_8 -> expert_40_8
	expert_40_8 -> expert_agg_8 [label="Expert 40 output"]
	moe_gate_8 -> tp_split_41_8 [label="Gate selection 41" style=dashed]
	tp_split_41_8 -> expert_compute_41_0_8
	tp_split_41_8 -> expert_compute_41_1_8
	expert_compute_41_0_8 -> tp_allreduce_41_8
	expert_compute_41_1_8 -> tp_allreduce_41_8
	tp_allreduce_41_8 -> expert_41_8
	expert_41_8 -> expert_agg_8 [label="Expert 41 output"]
	moe_gate_8 -> tp_split_42_8 [label="Gate selection 42" style=dashed]
	tp_split_42_8 -> expert_compute_42_0_8
	tp_split_42_8 -> expert_compute_42_1_8
	expert_compute_42_0_8 -> tp_allreduce_42_8
	expert_compute_42_1_8 -> tp_allreduce_42_8
	tp_allreduce_42_8 -> expert_42_8
	expert_42_8 -> expert_agg_8 [label="Expert 42 output"]
	moe_gate_8 -> tp_split_43_8 [label="Gate selection 43" style=dashed]
	tp_split_43_8 -> expert_compute_43_0_8
	tp_split_43_8 -> expert_compute_43_1_8
	expert_compute_43_0_8 -> tp_allreduce_43_8
	expert_compute_43_1_8 -> tp_allreduce_43_8
	tp_allreduce_43_8 -> expert_43_8
	expert_43_8 -> expert_agg_8 [label="Expert 43 output"]
	moe_gate_8 -> tp_split_44_8 [label="Gate selection 44" style=dashed]
	tp_split_44_8 -> expert_compute_44_0_8
	tp_split_44_8 -> expert_compute_44_1_8
	expert_compute_44_0_8 -> tp_allreduce_44_8
	expert_compute_44_1_8 -> tp_allreduce_44_8
	tp_allreduce_44_8 -> expert_44_8
	expert_44_8 -> expert_agg_8 [label="Expert 44 output"]
	moe_gate_8 -> tp_split_45_8 [label="Gate selection 45" style=dashed]
	tp_split_45_8 -> expert_compute_45_0_8
	tp_split_45_8 -> expert_compute_45_1_8
	expert_compute_45_0_8 -> tp_allreduce_45_8
	expert_compute_45_1_8 -> tp_allreduce_45_8
	tp_allreduce_45_8 -> expert_45_8
	expert_45_8 -> expert_agg_8 [label="Expert 45 output"]
	moe_gate_8 -> tp_split_46_8 [label="Gate selection 46" style=dashed]
	tp_split_46_8 -> expert_compute_46_0_8
	tp_split_46_8 -> expert_compute_46_1_8
	expert_compute_46_0_8 -> tp_allreduce_46_8
	expert_compute_46_1_8 -> tp_allreduce_46_8
	tp_allreduce_46_8 -> expert_46_8
	expert_46_8 -> expert_agg_8 [label="Expert 46 output"]
	moe_gate_8 -> tp_split_47_8 [label="Gate selection 47" style=dashed]
	tp_split_47_8 -> expert_compute_47_0_8
	tp_split_47_8 -> expert_compute_47_1_8
	expert_compute_47_0_8 -> tp_allreduce_47_8
	expert_compute_47_1_8 -> tp_allreduce_47_8
	tp_allreduce_47_8 -> expert_47_8
	expert_47_8 -> expert_agg_8 [label="Expert 47 output"]
	moe_gate_8 -> tp_split_48_8 [label="Gate selection 48" style=dashed]
	tp_split_48_8 -> expert_compute_48_0_8
	tp_split_48_8 -> expert_compute_48_1_8
	expert_compute_48_0_8 -> tp_allreduce_48_8
	expert_compute_48_1_8 -> tp_allreduce_48_8
	tp_allreduce_48_8 -> expert_48_8
	expert_48_8 -> expert_agg_8 [label="Expert 48 output"]
	moe_gate_8 -> tp_split_49_8 [label="Gate selection 49" style=dashed]
	tp_split_49_8 -> expert_compute_49_0_8
	tp_split_49_8 -> expert_compute_49_1_8
	expert_compute_49_0_8 -> tp_allreduce_49_8
	expert_compute_49_1_8 -> tp_allreduce_49_8
	tp_allreduce_49_8 -> expert_49_8
	expert_49_8 -> expert_agg_8 [label="Expert 49 output"]
	moe_gate_8 -> tp_split_50_8 [label="Gate selection 50" style=dashed]
	tp_split_50_8 -> expert_compute_50_0_8
	tp_split_50_8 -> expert_compute_50_1_8
	expert_compute_50_0_8 -> tp_allreduce_50_8
	expert_compute_50_1_8 -> tp_allreduce_50_8
	tp_allreduce_50_8 -> expert_50_8
	expert_50_8 -> expert_agg_8 [label="Expert 50 output"]
	moe_gate_8 -> tp_split_51_8 [label="Gate selection 51" style=dashed]
	tp_split_51_8 -> expert_compute_51_0_8
	tp_split_51_8 -> expert_compute_51_1_8
	expert_compute_51_0_8 -> tp_allreduce_51_8
	expert_compute_51_1_8 -> tp_allreduce_51_8
	tp_allreduce_51_8 -> expert_51_8
	expert_51_8 -> expert_agg_8 [label="Expert 51 output"]
	moe_gate_8 -> tp_split_52_8 [label="Gate selection 52" style=dashed]
	tp_split_52_8 -> expert_compute_52_0_8
	tp_split_52_8 -> expert_compute_52_1_8
	expert_compute_52_0_8 -> tp_allreduce_52_8
	expert_compute_52_1_8 -> tp_allreduce_52_8
	tp_allreduce_52_8 -> expert_52_8
	expert_52_8 -> expert_agg_8 [label="Expert 52 output"]
	moe_gate_8 -> tp_split_53_8 [label="Gate selection 53" style=dashed]
	tp_split_53_8 -> expert_compute_53_0_8
	tp_split_53_8 -> expert_compute_53_1_8
	expert_compute_53_0_8 -> tp_allreduce_53_8
	expert_compute_53_1_8 -> tp_allreduce_53_8
	tp_allreduce_53_8 -> expert_53_8
	expert_53_8 -> expert_agg_8 [label="Expert 53 output"]
	moe_gate_8 -> tp_split_54_8 [label="Gate selection 54" style=dashed]
	tp_split_54_8 -> expert_compute_54_0_8
	tp_split_54_8 -> expert_compute_54_1_8
	expert_compute_54_0_8 -> tp_allreduce_54_8
	expert_compute_54_1_8 -> tp_allreduce_54_8
	tp_allreduce_54_8 -> expert_54_8
	expert_54_8 -> expert_agg_8 [label="Expert 54 output"]
	moe_gate_8 -> tp_split_55_8 [label="Gate selection 55" style=dashed]
	tp_split_55_8 -> expert_compute_55_0_8
	tp_split_55_8 -> expert_compute_55_1_8
	expert_compute_55_0_8 -> tp_allreduce_55_8
	expert_compute_55_1_8 -> tp_allreduce_55_8
	tp_allreduce_55_8 -> expert_55_8
	expert_55_8 -> expert_agg_8 [label="Expert 55 output"]
	moe_gate_8 -> tp_split_56_8 [label="Gate selection 56" style=dashed]
	tp_split_56_8 -> expert_compute_56_0_8
	tp_split_56_8 -> expert_compute_56_1_8
	expert_compute_56_0_8 -> tp_allreduce_56_8
	expert_compute_56_1_8 -> tp_allreduce_56_8
	tp_allreduce_56_8 -> expert_56_8
	expert_56_8 -> expert_agg_8 [label="Expert 56 output"]
	moe_gate_8 -> tp_split_57_8 [label="Gate selection 57" style=dashed]
	tp_split_57_8 -> expert_compute_57_0_8
	tp_split_57_8 -> expert_compute_57_1_8
	expert_compute_57_0_8 -> tp_allreduce_57_8
	expert_compute_57_1_8 -> tp_allreduce_57_8
	tp_allreduce_57_8 -> expert_57_8
	expert_57_8 -> expert_agg_8 [label="Expert 57 output"]
	moe_gate_8 -> tp_split_58_8 [label="Gate selection 58" style=dashed]
	tp_split_58_8 -> expert_compute_58_0_8
	tp_split_58_8 -> expert_compute_58_1_8
	expert_compute_58_0_8 -> tp_allreduce_58_8
	expert_compute_58_1_8 -> tp_allreduce_58_8
	tp_allreduce_58_8 -> expert_58_8
	expert_58_8 -> expert_agg_8 [label="Expert 58 output"]
	moe_gate_8 -> tp_split_59_8 [label="Gate selection 59" style=dashed]
	tp_split_59_8 -> expert_compute_59_0_8
	tp_split_59_8 -> expert_compute_59_1_8
	expert_compute_59_0_8 -> tp_allreduce_59_8
	expert_compute_59_1_8 -> tp_allreduce_59_8
	tp_allreduce_59_8 -> expert_59_8
	expert_59_8 -> expert_agg_8 [label="Expert 59 output"]
	moe_gate_8 -> tp_split_60_8 [label="Gate selection 60" style=dashed]
	tp_split_60_8 -> expert_compute_60_0_8
	tp_split_60_8 -> expert_compute_60_1_8
	expert_compute_60_0_8 -> tp_allreduce_60_8
	expert_compute_60_1_8 -> tp_allreduce_60_8
	tp_allreduce_60_8 -> expert_60_8
	expert_60_8 -> expert_agg_8 [label="Expert 60 output"]
	moe_gate_8 -> tp_split_61_8 [label="Gate selection 61" style=dashed]
	tp_split_61_8 -> expert_compute_61_0_8
	tp_split_61_8 -> expert_compute_61_1_8
	expert_compute_61_0_8 -> tp_allreduce_61_8
	expert_compute_61_1_8 -> tp_allreduce_61_8
	tp_allreduce_61_8 -> expert_61_8
	expert_61_8 -> expert_agg_8 [label="Expert 61 output"]
	moe_gate_8 -> tp_split_62_8 [label="Gate selection 62" style=dashed]
	tp_split_62_8 -> expert_compute_62_0_8
	tp_split_62_8 -> expert_compute_62_1_8
	expert_compute_62_0_8 -> tp_allreduce_62_8
	expert_compute_62_1_8 -> tp_allreduce_62_8
	tp_allreduce_62_8 -> expert_62_8
	expert_62_8 -> expert_agg_8 [label="Expert 62 output"]
	moe_gate_8 -> tp_split_63_8 [label="Gate selection 63" style=dashed]
	tp_split_63_8 -> expert_compute_63_0_8
	tp_split_63_8 -> expert_compute_63_1_8
	expert_compute_63_0_8 -> tp_allreduce_63_8
	expert_compute_63_1_8 -> tp_allreduce_63_8
	tp_allreduce_63_8 -> expert_63_8
	expert_63_8 -> expert_agg_8 [label="Expert 63 output"]
	expert_agg_8 -> layer_norm_8
	layer_norm_8 -> attn_norm_9
	attn_norm_9 -> attn_q_9
	attn_norm_9 -> attn_k_9
	attn_norm_9 -> attn_v_9
	attn_q_9 -> attn_score_9
	attn_k_9 -> attn_score_9
	attn_v_9 -> attn_out_9
	attn_score_9 -> attn_out_9
	attn_out_9 -> moe_gate_9
	moe_gate_9 -> tp_split_0_9 [label="Gate selection 0" style=dashed]
	tp_split_0_9 -> expert_compute_0_0_9
	tp_split_0_9 -> expert_compute_0_1_9
	expert_compute_0_0_9 -> tp_allreduce_0_9
	expert_compute_0_1_9 -> tp_allreduce_0_9
	tp_allreduce_0_9 -> expert_0_9
	expert_0_9 -> expert_agg_9 [label="Expert 0 output"]
	moe_gate_9 -> tp_split_1_9 [label="Gate selection 1" style=dashed]
	tp_split_1_9 -> expert_compute_1_0_9
	tp_split_1_9 -> expert_compute_1_1_9
	expert_compute_1_0_9 -> tp_allreduce_1_9
	expert_compute_1_1_9 -> tp_allreduce_1_9
	tp_allreduce_1_9 -> expert_1_9
	expert_1_9 -> expert_agg_9 [label="Expert 1 output"]
	moe_gate_9 -> tp_split_2_9 [label="Gate selection 2" style=dashed]
	tp_split_2_9 -> expert_compute_2_0_9
	tp_split_2_9 -> expert_compute_2_1_9
	expert_compute_2_0_9 -> tp_allreduce_2_9
	expert_compute_2_1_9 -> tp_allreduce_2_9
	tp_allreduce_2_9 -> expert_2_9
	expert_2_9 -> expert_agg_9 [label="Expert 2 output"]
	moe_gate_9 -> tp_split_3_9 [label="Gate selection 3" style=dashed]
	tp_split_3_9 -> expert_compute_3_0_9
	tp_split_3_9 -> expert_compute_3_1_9
	expert_compute_3_0_9 -> tp_allreduce_3_9
	expert_compute_3_1_9 -> tp_allreduce_3_9
	tp_allreduce_3_9 -> expert_3_9
	expert_3_9 -> expert_agg_9 [label="Expert 3 output"]
	moe_gate_9 -> tp_split_4_9 [label="Gate selection 4" style=dashed]
	tp_split_4_9 -> expert_compute_4_0_9
	tp_split_4_9 -> expert_compute_4_1_9
	expert_compute_4_0_9 -> tp_allreduce_4_9
	expert_compute_4_1_9 -> tp_allreduce_4_9
	tp_allreduce_4_9 -> expert_4_9
	expert_4_9 -> expert_agg_9 [label="Expert 4 output"]
	moe_gate_9 -> tp_split_5_9 [label="Gate selection 5" style=dashed]
	tp_split_5_9 -> expert_compute_5_0_9
	tp_split_5_9 -> expert_compute_5_1_9
	expert_compute_5_0_9 -> tp_allreduce_5_9
	expert_compute_5_1_9 -> tp_allreduce_5_9
	tp_allreduce_5_9 -> expert_5_9
	expert_5_9 -> expert_agg_9 [label="Expert 5 output"]
	moe_gate_9 -> tp_split_6_9 [label="Gate selection 6" style=dashed]
	tp_split_6_9 -> expert_compute_6_0_9
	tp_split_6_9 -> expert_compute_6_1_9
	expert_compute_6_0_9 -> tp_allreduce_6_9
	expert_compute_6_1_9 -> tp_allreduce_6_9
	tp_allreduce_6_9 -> expert_6_9
	expert_6_9 -> expert_agg_9 [label="Expert 6 output"]
	moe_gate_9 -> tp_split_7_9 [label="Gate selection 7" style=dashed]
	tp_split_7_9 -> expert_compute_7_0_9
	tp_split_7_9 -> expert_compute_7_1_9
	expert_compute_7_0_9 -> tp_allreduce_7_9
	expert_compute_7_1_9 -> tp_allreduce_7_9
	tp_allreduce_7_9 -> expert_7_9
	expert_7_9 -> expert_agg_9 [label="Expert 7 output"]
	moe_gate_9 -> tp_split_8_9 [label="Gate selection 8" style=dashed]
	tp_split_8_9 -> expert_compute_8_0_9
	tp_split_8_9 -> expert_compute_8_1_9
	expert_compute_8_0_9 -> tp_allreduce_8_9
	expert_compute_8_1_9 -> tp_allreduce_8_9
	tp_allreduce_8_9 -> expert_8_9
	expert_8_9 -> expert_agg_9 [label="Expert 8 output"]
	moe_gate_9 -> tp_split_9_9 [label="Gate selection 9" style=dashed]
	tp_split_9_9 -> expert_compute_9_0_9
	tp_split_9_9 -> expert_compute_9_1_9
	expert_compute_9_0_9 -> tp_allreduce_9_9
	expert_compute_9_1_9 -> tp_allreduce_9_9
	tp_allreduce_9_9 -> expert_9_9
	expert_9_9 -> expert_agg_9 [label="Expert 9 output"]
	moe_gate_9 -> tp_split_10_9 [label="Gate selection 10" style=dashed]
	tp_split_10_9 -> expert_compute_10_0_9
	tp_split_10_9 -> expert_compute_10_1_9
	expert_compute_10_0_9 -> tp_allreduce_10_9
	expert_compute_10_1_9 -> tp_allreduce_10_9
	tp_allreduce_10_9 -> expert_10_9
	expert_10_9 -> expert_agg_9 [label="Expert 10 output"]
	moe_gate_9 -> tp_split_11_9 [label="Gate selection 11" style=dashed]
	tp_split_11_9 -> expert_compute_11_0_9
	tp_split_11_9 -> expert_compute_11_1_9
	expert_compute_11_0_9 -> tp_allreduce_11_9
	expert_compute_11_1_9 -> tp_allreduce_11_9
	tp_allreduce_11_9 -> expert_11_9
	expert_11_9 -> expert_agg_9 [label="Expert 11 output"]
	moe_gate_9 -> tp_split_12_9 [label="Gate selection 12" style=dashed]
	tp_split_12_9 -> expert_compute_12_0_9
	tp_split_12_9 -> expert_compute_12_1_9
	expert_compute_12_0_9 -> tp_allreduce_12_9
	expert_compute_12_1_9 -> tp_allreduce_12_9
	tp_allreduce_12_9 -> expert_12_9
	expert_12_9 -> expert_agg_9 [label="Expert 12 output"]
	moe_gate_9 -> tp_split_13_9 [label="Gate selection 13" style=dashed]
	tp_split_13_9 -> expert_compute_13_0_9
	tp_split_13_9 -> expert_compute_13_1_9
	expert_compute_13_0_9 -> tp_allreduce_13_9
	expert_compute_13_1_9 -> tp_allreduce_13_9
	tp_allreduce_13_9 -> expert_13_9
	expert_13_9 -> expert_agg_9 [label="Expert 13 output"]
	moe_gate_9 -> tp_split_14_9 [label="Gate selection 14" style=dashed]
	tp_split_14_9 -> expert_compute_14_0_9
	tp_split_14_9 -> expert_compute_14_1_9
	expert_compute_14_0_9 -> tp_allreduce_14_9
	expert_compute_14_1_9 -> tp_allreduce_14_9
	tp_allreduce_14_9 -> expert_14_9
	expert_14_9 -> expert_agg_9 [label="Expert 14 output"]
	moe_gate_9 -> tp_split_15_9 [label="Gate selection 15" style=dashed]
	tp_split_15_9 -> expert_compute_15_0_9
	tp_split_15_9 -> expert_compute_15_1_9
	expert_compute_15_0_9 -> tp_allreduce_15_9
	expert_compute_15_1_9 -> tp_allreduce_15_9
	tp_allreduce_15_9 -> expert_15_9
	expert_15_9 -> expert_agg_9 [label="Expert 15 output"]
	moe_gate_9 -> tp_split_16_9 [label="Gate selection 16" style=dashed]
	tp_split_16_9 -> expert_compute_16_0_9
	tp_split_16_9 -> expert_compute_16_1_9
	expert_compute_16_0_9 -> tp_allreduce_16_9
	expert_compute_16_1_9 -> tp_allreduce_16_9
	tp_allreduce_16_9 -> expert_16_9
	expert_16_9 -> expert_agg_9 [label="Expert 16 output"]
	moe_gate_9 -> tp_split_17_9 [label="Gate selection 17" style=dashed]
	tp_split_17_9 -> expert_compute_17_0_9
	tp_split_17_9 -> expert_compute_17_1_9
	expert_compute_17_0_9 -> tp_allreduce_17_9
	expert_compute_17_1_9 -> tp_allreduce_17_9
	tp_allreduce_17_9 -> expert_17_9
	expert_17_9 -> expert_agg_9 [label="Expert 17 output"]
	moe_gate_9 -> tp_split_18_9 [label="Gate selection 18" style=dashed]
	tp_split_18_9 -> expert_compute_18_0_9
	tp_split_18_9 -> expert_compute_18_1_9
	expert_compute_18_0_9 -> tp_allreduce_18_9
	expert_compute_18_1_9 -> tp_allreduce_18_9
	tp_allreduce_18_9 -> expert_18_9
	expert_18_9 -> expert_agg_9 [label="Expert 18 output"]
	moe_gate_9 -> tp_split_19_9 [label="Gate selection 19" style=dashed]
	tp_split_19_9 -> expert_compute_19_0_9
	tp_split_19_9 -> expert_compute_19_1_9
	expert_compute_19_0_9 -> tp_allreduce_19_9
	expert_compute_19_1_9 -> tp_allreduce_19_9
	tp_allreduce_19_9 -> expert_19_9
	expert_19_9 -> expert_agg_9 [label="Expert 19 output"]
	moe_gate_9 -> tp_split_20_9 [label="Gate selection 20" style=dashed]
	tp_split_20_9 -> expert_compute_20_0_9
	tp_split_20_9 -> expert_compute_20_1_9
	expert_compute_20_0_9 -> tp_allreduce_20_9
	expert_compute_20_1_9 -> tp_allreduce_20_9
	tp_allreduce_20_9 -> expert_20_9
	expert_20_9 -> expert_agg_9 [label="Expert 20 output"]
	moe_gate_9 -> tp_split_21_9 [label="Gate selection 21" style=dashed]
	tp_split_21_9 -> expert_compute_21_0_9
	tp_split_21_9 -> expert_compute_21_1_9
	expert_compute_21_0_9 -> tp_allreduce_21_9
	expert_compute_21_1_9 -> tp_allreduce_21_9
	tp_allreduce_21_9 -> expert_21_9
	expert_21_9 -> expert_agg_9 [label="Expert 21 output"]
	moe_gate_9 -> tp_split_22_9 [label="Gate selection 22" style=dashed]
	tp_split_22_9 -> expert_compute_22_0_9
	tp_split_22_9 -> expert_compute_22_1_9
	expert_compute_22_0_9 -> tp_allreduce_22_9
	expert_compute_22_1_9 -> tp_allreduce_22_9
	tp_allreduce_22_9 -> expert_22_9
	expert_22_9 -> expert_agg_9 [label="Expert 22 output"]
	moe_gate_9 -> tp_split_23_9 [label="Gate selection 23" style=dashed]
	tp_split_23_9 -> expert_compute_23_0_9
	tp_split_23_9 -> expert_compute_23_1_9
	expert_compute_23_0_9 -> tp_allreduce_23_9
	expert_compute_23_1_9 -> tp_allreduce_23_9
	tp_allreduce_23_9 -> expert_23_9
	expert_23_9 -> expert_agg_9 [label="Expert 23 output"]
	moe_gate_9 -> tp_split_24_9 [label="Gate selection 24" style=dashed]
	tp_split_24_9 -> expert_compute_24_0_9
	tp_split_24_9 -> expert_compute_24_1_9
	expert_compute_24_0_9 -> tp_allreduce_24_9
	expert_compute_24_1_9 -> tp_allreduce_24_9
	tp_allreduce_24_9 -> expert_24_9
	expert_24_9 -> expert_agg_9 [label="Expert 24 output"]
	moe_gate_9 -> tp_split_25_9 [label="Gate selection 25" style=dashed]
	tp_split_25_9 -> expert_compute_25_0_9
	tp_split_25_9 -> expert_compute_25_1_9
	expert_compute_25_0_9 -> tp_allreduce_25_9
	expert_compute_25_1_9 -> tp_allreduce_25_9
	tp_allreduce_25_9 -> expert_25_9
	expert_25_9 -> expert_agg_9 [label="Expert 25 output"]
	moe_gate_9 -> tp_split_26_9 [label="Gate selection 26" style=dashed]
	tp_split_26_9 -> expert_compute_26_0_9
	tp_split_26_9 -> expert_compute_26_1_9
	expert_compute_26_0_9 -> tp_allreduce_26_9
	expert_compute_26_1_9 -> tp_allreduce_26_9
	tp_allreduce_26_9 -> expert_26_9
	expert_26_9 -> expert_agg_9 [label="Expert 26 output"]
	moe_gate_9 -> tp_split_27_9 [label="Gate selection 27" style=dashed]
	tp_split_27_9 -> expert_compute_27_0_9
	tp_split_27_9 -> expert_compute_27_1_9
	expert_compute_27_0_9 -> tp_allreduce_27_9
	expert_compute_27_1_9 -> tp_allreduce_27_9
	tp_allreduce_27_9 -> expert_27_9
	expert_27_9 -> expert_agg_9 [label="Expert 27 output"]
	moe_gate_9 -> tp_split_28_9 [label="Gate selection 28" style=dashed]
	tp_split_28_9 -> expert_compute_28_0_9
	tp_split_28_9 -> expert_compute_28_1_9
	expert_compute_28_0_9 -> tp_allreduce_28_9
	expert_compute_28_1_9 -> tp_allreduce_28_9
	tp_allreduce_28_9 -> expert_28_9
	expert_28_9 -> expert_agg_9 [label="Expert 28 output"]
	moe_gate_9 -> tp_split_29_9 [label="Gate selection 29" style=dashed]
	tp_split_29_9 -> expert_compute_29_0_9
	tp_split_29_9 -> expert_compute_29_1_9
	expert_compute_29_0_9 -> tp_allreduce_29_9
	expert_compute_29_1_9 -> tp_allreduce_29_9
	tp_allreduce_29_9 -> expert_29_9
	expert_29_9 -> expert_agg_9 [label="Expert 29 output"]
	moe_gate_9 -> tp_split_30_9 [label="Gate selection 30" style=dashed]
	tp_split_30_9 -> expert_compute_30_0_9
	tp_split_30_9 -> expert_compute_30_1_9
	expert_compute_30_0_9 -> tp_allreduce_30_9
	expert_compute_30_1_9 -> tp_allreduce_30_9
	tp_allreduce_30_9 -> expert_30_9
	expert_30_9 -> expert_agg_9 [label="Expert 30 output"]
	moe_gate_9 -> tp_split_31_9 [label="Gate selection 31" style=dashed]
	tp_split_31_9 -> expert_compute_31_0_9
	tp_split_31_9 -> expert_compute_31_1_9
	expert_compute_31_0_9 -> tp_allreduce_31_9
	expert_compute_31_1_9 -> tp_allreduce_31_9
	tp_allreduce_31_9 -> expert_31_9
	expert_31_9 -> expert_agg_9 [label="Expert 31 output"]
	moe_gate_9 -> tp_split_32_9 [label="Gate selection 32" style=dashed]
	tp_split_32_9 -> expert_compute_32_0_9
	tp_split_32_9 -> expert_compute_32_1_9
	expert_compute_32_0_9 -> tp_allreduce_32_9
	expert_compute_32_1_9 -> tp_allreduce_32_9
	tp_allreduce_32_9 -> expert_32_9
	expert_32_9 -> expert_agg_9 [label="Expert 32 output"]
	moe_gate_9 -> tp_split_33_9 [label="Gate selection 33" style=dashed]
	tp_split_33_9 -> expert_compute_33_0_9
	tp_split_33_9 -> expert_compute_33_1_9
	expert_compute_33_0_9 -> tp_allreduce_33_9
	expert_compute_33_1_9 -> tp_allreduce_33_9
	tp_allreduce_33_9 -> expert_33_9
	expert_33_9 -> expert_agg_9 [label="Expert 33 output"]
	moe_gate_9 -> tp_split_34_9 [label="Gate selection 34" style=dashed]
	tp_split_34_9 -> expert_compute_34_0_9
	tp_split_34_9 -> expert_compute_34_1_9
	expert_compute_34_0_9 -> tp_allreduce_34_9
	expert_compute_34_1_9 -> tp_allreduce_34_9
	tp_allreduce_34_9 -> expert_34_9
	expert_34_9 -> expert_agg_9 [label="Expert 34 output"]
	moe_gate_9 -> tp_split_35_9 [label="Gate selection 35" style=dashed]
	tp_split_35_9 -> expert_compute_35_0_9
	tp_split_35_9 -> expert_compute_35_1_9
	expert_compute_35_0_9 -> tp_allreduce_35_9
	expert_compute_35_1_9 -> tp_allreduce_35_9
	tp_allreduce_35_9 -> expert_35_9
	expert_35_9 -> expert_agg_9 [label="Expert 35 output"]
	moe_gate_9 -> tp_split_36_9 [label="Gate selection 36" style=dashed]
	tp_split_36_9 -> expert_compute_36_0_9
	tp_split_36_9 -> expert_compute_36_1_9
	expert_compute_36_0_9 -> tp_allreduce_36_9
	expert_compute_36_1_9 -> tp_allreduce_36_9
	tp_allreduce_36_9 -> expert_36_9
	expert_36_9 -> expert_agg_9 [label="Expert 36 output"]
	moe_gate_9 -> tp_split_37_9 [label="Gate selection 37" style=dashed]
	tp_split_37_9 -> expert_compute_37_0_9
	tp_split_37_9 -> expert_compute_37_1_9
	expert_compute_37_0_9 -> tp_allreduce_37_9
	expert_compute_37_1_9 -> tp_allreduce_37_9
	tp_allreduce_37_9 -> expert_37_9
	expert_37_9 -> expert_agg_9 [label="Expert 37 output"]
	moe_gate_9 -> tp_split_38_9 [label="Gate selection 38" style=dashed]
	tp_split_38_9 -> expert_compute_38_0_9
	tp_split_38_9 -> expert_compute_38_1_9
	expert_compute_38_0_9 -> tp_allreduce_38_9
	expert_compute_38_1_9 -> tp_allreduce_38_9
	tp_allreduce_38_9 -> expert_38_9
	expert_38_9 -> expert_agg_9 [label="Expert 38 output"]
	moe_gate_9 -> tp_split_39_9 [label="Gate selection 39" style=dashed]
	tp_split_39_9 -> expert_compute_39_0_9
	tp_split_39_9 -> expert_compute_39_1_9
	expert_compute_39_0_9 -> tp_allreduce_39_9
	expert_compute_39_1_9 -> tp_allreduce_39_9
	tp_allreduce_39_9 -> expert_39_9
	expert_39_9 -> expert_agg_9 [label="Expert 39 output"]
	moe_gate_9 -> tp_split_40_9 [label="Gate selection 40" style=dashed]
	tp_split_40_9 -> expert_compute_40_0_9
	tp_split_40_9 -> expert_compute_40_1_9
	expert_compute_40_0_9 -> tp_allreduce_40_9
	expert_compute_40_1_9 -> tp_allreduce_40_9
	tp_allreduce_40_9 -> expert_40_9
	expert_40_9 -> expert_agg_9 [label="Expert 40 output"]
	moe_gate_9 -> tp_split_41_9 [label="Gate selection 41" style=dashed]
	tp_split_41_9 -> expert_compute_41_0_9
	tp_split_41_9 -> expert_compute_41_1_9
	expert_compute_41_0_9 -> tp_allreduce_41_9
	expert_compute_41_1_9 -> tp_allreduce_41_9
	tp_allreduce_41_9 -> expert_41_9
	expert_41_9 -> expert_agg_9 [label="Expert 41 output"]
	moe_gate_9 -> tp_split_42_9 [label="Gate selection 42" style=dashed]
	tp_split_42_9 -> expert_compute_42_0_9
	tp_split_42_9 -> expert_compute_42_1_9
	expert_compute_42_0_9 -> tp_allreduce_42_9
	expert_compute_42_1_9 -> tp_allreduce_42_9
	tp_allreduce_42_9 -> expert_42_9
	expert_42_9 -> expert_agg_9 [label="Expert 42 output"]
	moe_gate_9 -> tp_split_43_9 [label="Gate selection 43" style=dashed]
	tp_split_43_9 -> expert_compute_43_0_9
	tp_split_43_9 -> expert_compute_43_1_9
	expert_compute_43_0_9 -> tp_allreduce_43_9
	expert_compute_43_1_9 -> tp_allreduce_43_9
	tp_allreduce_43_9 -> expert_43_9
	expert_43_9 -> expert_agg_9 [label="Expert 43 output"]
	moe_gate_9 -> tp_split_44_9 [label="Gate selection 44" style=dashed]
	tp_split_44_9 -> expert_compute_44_0_9
	tp_split_44_9 -> expert_compute_44_1_9
	expert_compute_44_0_9 -> tp_allreduce_44_9
	expert_compute_44_1_9 -> tp_allreduce_44_9
	tp_allreduce_44_9 -> expert_44_9
	expert_44_9 -> expert_agg_9 [label="Expert 44 output"]
	moe_gate_9 -> tp_split_45_9 [label="Gate selection 45" style=dashed]
	tp_split_45_9 -> expert_compute_45_0_9
	tp_split_45_9 -> expert_compute_45_1_9
	expert_compute_45_0_9 -> tp_allreduce_45_9
	expert_compute_45_1_9 -> tp_allreduce_45_9
	tp_allreduce_45_9 -> expert_45_9
	expert_45_9 -> expert_agg_9 [label="Expert 45 output"]
	moe_gate_9 -> tp_split_46_9 [label="Gate selection 46" style=dashed]
	tp_split_46_9 -> expert_compute_46_0_9
	tp_split_46_9 -> expert_compute_46_1_9
	expert_compute_46_0_9 -> tp_allreduce_46_9
	expert_compute_46_1_9 -> tp_allreduce_46_9
	tp_allreduce_46_9 -> expert_46_9
	expert_46_9 -> expert_agg_9 [label="Expert 46 output"]
	moe_gate_9 -> tp_split_47_9 [label="Gate selection 47" style=dashed]
	tp_split_47_9 -> expert_compute_47_0_9
	tp_split_47_9 -> expert_compute_47_1_9
	expert_compute_47_0_9 -> tp_allreduce_47_9
	expert_compute_47_1_9 -> tp_allreduce_47_9
	tp_allreduce_47_9 -> expert_47_9
	expert_47_9 -> expert_agg_9 [label="Expert 47 output"]
	moe_gate_9 -> tp_split_48_9 [label="Gate selection 48" style=dashed]
	tp_split_48_9 -> expert_compute_48_0_9
	tp_split_48_9 -> expert_compute_48_1_9
	expert_compute_48_0_9 -> tp_allreduce_48_9
	expert_compute_48_1_9 -> tp_allreduce_48_9
	tp_allreduce_48_9 -> expert_48_9
	expert_48_9 -> expert_agg_9 [label="Expert 48 output"]
	moe_gate_9 -> tp_split_49_9 [label="Gate selection 49" style=dashed]
	tp_split_49_9 -> expert_compute_49_0_9
	tp_split_49_9 -> expert_compute_49_1_9
	expert_compute_49_0_9 -> tp_allreduce_49_9
	expert_compute_49_1_9 -> tp_allreduce_49_9
	tp_allreduce_49_9 -> expert_49_9
	expert_49_9 -> expert_agg_9 [label="Expert 49 output"]
	moe_gate_9 -> tp_split_50_9 [label="Gate selection 50" style=dashed]
	tp_split_50_9 -> expert_compute_50_0_9
	tp_split_50_9 -> expert_compute_50_1_9
	expert_compute_50_0_9 -> tp_allreduce_50_9
	expert_compute_50_1_9 -> tp_allreduce_50_9
	tp_allreduce_50_9 -> expert_50_9
	expert_50_9 -> expert_agg_9 [label="Expert 50 output"]
	moe_gate_9 -> tp_split_51_9 [label="Gate selection 51" style=dashed]
	tp_split_51_9 -> expert_compute_51_0_9
	tp_split_51_9 -> expert_compute_51_1_9
	expert_compute_51_0_9 -> tp_allreduce_51_9
	expert_compute_51_1_9 -> tp_allreduce_51_9
	tp_allreduce_51_9 -> expert_51_9
	expert_51_9 -> expert_agg_9 [label="Expert 51 output"]
	moe_gate_9 -> tp_split_52_9 [label="Gate selection 52" style=dashed]
	tp_split_52_9 -> expert_compute_52_0_9
	tp_split_52_9 -> expert_compute_52_1_9
	expert_compute_52_0_9 -> tp_allreduce_52_9
	expert_compute_52_1_9 -> tp_allreduce_52_9
	tp_allreduce_52_9 -> expert_52_9
	expert_52_9 -> expert_agg_9 [label="Expert 52 output"]
	moe_gate_9 -> tp_split_53_9 [label="Gate selection 53" style=dashed]
	tp_split_53_9 -> expert_compute_53_0_9
	tp_split_53_9 -> expert_compute_53_1_9
	expert_compute_53_0_9 -> tp_allreduce_53_9
	expert_compute_53_1_9 -> tp_allreduce_53_9
	tp_allreduce_53_9 -> expert_53_9
	expert_53_9 -> expert_agg_9 [label="Expert 53 output"]
	moe_gate_9 -> tp_split_54_9 [label="Gate selection 54" style=dashed]
	tp_split_54_9 -> expert_compute_54_0_9
	tp_split_54_9 -> expert_compute_54_1_9
	expert_compute_54_0_9 -> tp_allreduce_54_9
	expert_compute_54_1_9 -> tp_allreduce_54_9
	tp_allreduce_54_9 -> expert_54_9
	expert_54_9 -> expert_agg_9 [label="Expert 54 output"]
	moe_gate_9 -> tp_split_55_9 [label="Gate selection 55" style=dashed]
	tp_split_55_9 -> expert_compute_55_0_9
	tp_split_55_9 -> expert_compute_55_1_9
	expert_compute_55_0_9 -> tp_allreduce_55_9
	expert_compute_55_1_9 -> tp_allreduce_55_9
	tp_allreduce_55_9 -> expert_55_9
	expert_55_9 -> expert_agg_9 [label="Expert 55 output"]
	moe_gate_9 -> tp_split_56_9 [label="Gate selection 56" style=dashed]
	tp_split_56_9 -> expert_compute_56_0_9
	tp_split_56_9 -> expert_compute_56_1_9
	expert_compute_56_0_9 -> tp_allreduce_56_9
	expert_compute_56_1_9 -> tp_allreduce_56_9
	tp_allreduce_56_9 -> expert_56_9
	expert_56_9 -> expert_agg_9 [label="Expert 56 output"]
	moe_gate_9 -> tp_split_57_9 [label="Gate selection 57" style=dashed]
	tp_split_57_9 -> expert_compute_57_0_9
	tp_split_57_9 -> expert_compute_57_1_9
	expert_compute_57_0_9 -> tp_allreduce_57_9
	expert_compute_57_1_9 -> tp_allreduce_57_9
	tp_allreduce_57_9 -> expert_57_9
	expert_57_9 -> expert_agg_9 [label="Expert 57 output"]
	moe_gate_9 -> tp_split_58_9 [label="Gate selection 58" style=dashed]
	tp_split_58_9 -> expert_compute_58_0_9
	tp_split_58_9 -> expert_compute_58_1_9
	expert_compute_58_0_9 -> tp_allreduce_58_9
	expert_compute_58_1_9 -> tp_allreduce_58_9
	tp_allreduce_58_9 -> expert_58_9
	expert_58_9 -> expert_agg_9 [label="Expert 58 output"]
	moe_gate_9 -> tp_split_59_9 [label="Gate selection 59" style=dashed]
	tp_split_59_9 -> expert_compute_59_0_9
	tp_split_59_9 -> expert_compute_59_1_9
	expert_compute_59_0_9 -> tp_allreduce_59_9
	expert_compute_59_1_9 -> tp_allreduce_59_9
	tp_allreduce_59_9 -> expert_59_9
	expert_59_9 -> expert_agg_9 [label="Expert 59 output"]
	moe_gate_9 -> tp_split_60_9 [label="Gate selection 60" style=dashed]
	tp_split_60_9 -> expert_compute_60_0_9
	tp_split_60_9 -> expert_compute_60_1_9
	expert_compute_60_0_9 -> tp_allreduce_60_9
	expert_compute_60_1_9 -> tp_allreduce_60_9
	tp_allreduce_60_9 -> expert_60_9
	expert_60_9 -> expert_agg_9 [label="Expert 60 output"]
	moe_gate_9 -> tp_split_61_9 [label="Gate selection 61" style=dashed]
	tp_split_61_9 -> expert_compute_61_0_9
	tp_split_61_9 -> expert_compute_61_1_9
	expert_compute_61_0_9 -> tp_allreduce_61_9
	expert_compute_61_1_9 -> tp_allreduce_61_9
	tp_allreduce_61_9 -> expert_61_9
	expert_61_9 -> expert_agg_9 [label="Expert 61 output"]
	moe_gate_9 -> tp_split_62_9 [label="Gate selection 62" style=dashed]
	tp_split_62_9 -> expert_compute_62_0_9
	tp_split_62_9 -> expert_compute_62_1_9
	expert_compute_62_0_9 -> tp_allreduce_62_9
	expert_compute_62_1_9 -> tp_allreduce_62_9
	tp_allreduce_62_9 -> expert_62_9
	expert_62_9 -> expert_agg_9 [label="Expert 62 output"]
	moe_gate_9 -> tp_split_63_9 [label="Gate selection 63" style=dashed]
	tp_split_63_9 -> expert_compute_63_0_9
	tp_split_63_9 -> expert_compute_63_1_9
	expert_compute_63_0_9 -> tp_allreduce_63_9
	expert_compute_63_1_9 -> tp_allreduce_63_9
	tp_allreduce_63_9 -> expert_63_9
	expert_63_9 -> expert_agg_9 [label="Expert 63 output"]
	expert_agg_9 -> layer_norm_9
	layer_norm_9 -> attn_norm_10
	attn_norm_10 -> attn_q_10
	attn_norm_10 -> attn_k_10
	attn_norm_10 -> attn_v_10
	attn_q_10 -> attn_score_10
	attn_k_10 -> attn_score_10
	attn_v_10 -> attn_out_10
	attn_score_10 -> attn_out_10
	attn_out_10 -> moe_gate_10
	moe_gate_10 -> tp_split_0_10 [label="Gate selection 0" style=dashed]
	tp_split_0_10 -> expert_compute_0_0_10
	tp_split_0_10 -> expert_compute_0_1_10
	expert_compute_0_0_10 -> tp_allreduce_0_10
	expert_compute_0_1_10 -> tp_allreduce_0_10
	tp_allreduce_0_10 -> expert_0_10
	expert_0_10 -> expert_agg_10 [label="Expert 0 output"]
	moe_gate_10 -> tp_split_1_10 [label="Gate selection 1" style=dashed]
	tp_split_1_10 -> expert_compute_1_0_10
	tp_split_1_10 -> expert_compute_1_1_10
	expert_compute_1_0_10 -> tp_allreduce_1_10
	expert_compute_1_1_10 -> tp_allreduce_1_10
	tp_allreduce_1_10 -> expert_1_10
	expert_1_10 -> expert_agg_10 [label="Expert 1 output"]
	moe_gate_10 -> tp_split_2_10 [label="Gate selection 2" style=dashed]
	tp_split_2_10 -> expert_compute_2_0_10
	tp_split_2_10 -> expert_compute_2_1_10
	expert_compute_2_0_10 -> tp_allreduce_2_10
	expert_compute_2_1_10 -> tp_allreduce_2_10
	tp_allreduce_2_10 -> expert_2_10
	expert_2_10 -> expert_agg_10 [label="Expert 2 output"]
	moe_gate_10 -> tp_split_3_10 [label="Gate selection 3" style=dashed]
	tp_split_3_10 -> expert_compute_3_0_10
	tp_split_3_10 -> expert_compute_3_1_10
	expert_compute_3_0_10 -> tp_allreduce_3_10
	expert_compute_3_1_10 -> tp_allreduce_3_10
	tp_allreduce_3_10 -> expert_3_10
	expert_3_10 -> expert_agg_10 [label="Expert 3 output"]
	moe_gate_10 -> tp_split_4_10 [label="Gate selection 4" style=dashed]
	tp_split_4_10 -> expert_compute_4_0_10
	tp_split_4_10 -> expert_compute_4_1_10
	expert_compute_4_0_10 -> tp_allreduce_4_10
	expert_compute_4_1_10 -> tp_allreduce_4_10
	tp_allreduce_4_10 -> expert_4_10
	expert_4_10 -> expert_agg_10 [label="Expert 4 output"]
	moe_gate_10 -> tp_split_5_10 [label="Gate selection 5" style=dashed]
	tp_split_5_10 -> expert_compute_5_0_10
	tp_split_5_10 -> expert_compute_5_1_10
	expert_compute_5_0_10 -> tp_allreduce_5_10
	expert_compute_5_1_10 -> tp_allreduce_5_10
	tp_allreduce_5_10 -> expert_5_10
	expert_5_10 -> expert_agg_10 [label="Expert 5 output"]
	moe_gate_10 -> tp_split_6_10 [label="Gate selection 6" style=dashed]
	tp_split_6_10 -> expert_compute_6_0_10
	tp_split_6_10 -> expert_compute_6_1_10
	expert_compute_6_0_10 -> tp_allreduce_6_10
	expert_compute_6_1_10 -> tp_allreduce_6_10
	tp_allreduce_6_10 -> expert_6_10
	expert_6_10 -> expert_agg_10 [label="Expert 6 output"]
	moe_gate_10 -> tp_split_7_10 [label="Gate selection 7" style=dashed]
	tp_split_7_10 -> expert_compute_7_0_10
	tp_split_7_10 -> expert_compute_7_1_10
	expert_compute_7_0_10 -> tp_allreduce_7_10
	expert_compute_7_1_10 -> tp_allreduce_7_10
	tp_allreduce_7_10 -> expert_7_10
	expert_7_10 -> expert_agg_10 [label="Expert 7 output"]
	moe_gate_10 -> tp_split_8_10 [label="Gate selection 8" style=dashed]
	tp_split_8_10 -> expert_compute_8_0_10
	tp_split_8_10 -> expert_compute_8_1_10
	expert_compute_8_0_10 -> tp_allreduce_8_10
	expert_compute_8_1_10 -> tp_allreduce_8_10
	tp_allreduce_8_10 -> expert_8_10
	expert_8_10 -> expert_agg_10 [label="Expert 8 output"]
	moe_gate_10 -> tp_split_9_10 [label="Gate selection 9" style=dashed]
	tp_split_9_10 -> expert_compute_9_0_10
	tp_split_9_10 -> expert_compute_9_1_10
	expert_compute_9_0_10 -> tp_allreduce_9_10
	expert_compute_9_1_10 -> tp_allreduce_9_10
	tp_allreduce_9_10 -> expert_9_10
	expert_9_10 -> expert_agg_10 [label="Expert 9 output"]
	moe_gate_10 -> tp_split_10_10 [label="Gate selection 10" style=dashed]
	tp_split_10_10 -> expert_compute_10_0_10
	tp_split_10_10 -> expert_compute_10_1_10
	expert_compute_10_0_10 -> tp_allreduce_10_10
	expert_compute_10_1_10 -> tp_allreduce_10_10
	tp_allreduce_10_10 -> expert_10_10
	expert_10_10 -> expert_agg_10 [label="Expert 10 output"]
	moe_gate_10 -> tp_split_11_10 [label="Gate selection 11" style=dashed]
	tp_split_11_10 -> expert_compute_11_0_10
	tp_split_11_10 -> expert_compute_11_1_10
	expert_compute_11_0_10 -> tp_allreduce_11_10
	expert_compute_11_1_10 -> tp_allreduce_11_10
	tp_allreduce_11_10 -> expert_11_10
	expert_11_10 -> expert_agg_10 [label="Expert 11 output"]
	moe_gate_10 -> tp_split_12_10 [label="Gate selection 12" style=dashed]
	tp_split_12_10 -> expert_compute_12_0_10
	tp_split_12_10 -> expert_compute_12_1_10
	expert_compute_12_0_10 -> tp_allreduce_12_10
	expert_compute_12_1_10 -> tp_allreduce_12_10
	tp_allreduce_12_10 -> expert_12_10
	expert_12_10 -> expert_agg_10 [label="Expert 12 output"]
	moe_gate_10 -> tp_split_13_10 [label="Gate selection 13" style=dashed]
	tp_split_13_10 -> expert_compute_13_0_10
	tp_split_13_10 -> expert_compute_13_1_10
	expert_compute_13_0_10 -> tp_allreduce_13_10
	expert_compute_13_1_10 -> tp_allreduce_13_10
	tp_allreduce_13_10 -> expert_13_10
	expert_13_10 -> expert_agg_10 [label="Expert 13 output"]
	moe_gate_10 -> tp_split_14_10 [label="Gate selection 14" style=dashed]
	tp_split_14_10 -> expert_compute_14_0_10
	tp_split_14_10 -> expert_compute_14_1_10
	expert_compute_14_0_10 -> tp_allreduce_14_10
	expert_compute_14_1_10 -> tp_allreduce_14_10
	tp_allreduce_14_10 -> expert_14_10
	expert_14_10 -> expert_agg_10 [label="Expert 14 output"]
	moe_gate_10 -> tp_split_15_10 [label="Gate selection 15" style=dashed]
	tp_split_15_10 -> expert_compute_15_0_10
	tp_split_15_10 -> expert_compute_15_1_10
	expert_compute_15_0_10 -> tp_allreduce_15_10
	expert_compute_15_1_10 -> tp_allreduce_15_10
	tp_allreduce_15_10 -> expert_15_10
	expert_15_10 -> expert_agg_10 [label="Expert 15 output"]
	moe_gate_10 -> tp_split_16_10 [label="Gate selection 16" style=dashed]
	tp_split_16_10 -> expert_compute_16_0_10
	tp_split_16_10 -> expert_compute_16_1_10
	expert_compute_16_0_10 -> tp_allreduce_16_10
	expert_compute_16_1_10 -> tp_allreduce_16_10
	tp_allreduce_16_10 -> expert_16_10
	expert_16_10 -> expert_agg_10 [label="Expert 16 output"]
	moe_gate_10 -> tp_split_17_10 [label="Gate selection 17" style=dashed]
	tp_split_17_10 -> expert_compute_17_0_10
	tp_split_17_10 -> expert_compute_17_1_10
	expert_compute_17_0_10 -> tp_allreduce_17_10
	expert_compute_17_1_10 -> tp_allreduce_17_10
	tp_allreduce_17_10 -> expert_17_10
	expert_17_10 -> expert_agg_10 [label="Expert 17 output"]
	moe_gate_10 -> tp_split_18_10 [label="Gate selection 18" style=dashed]
	tp_split_18_10 -> expert_compute_18_0_10
	tp_split_18_10 -> expert_compute_18_1_10
	expert_compute_18_0_10 -> tp_allreduce_18_10
	expert_compute_18_1_10 -> tp_allreduce_18_10
	tp_allreduce_18_10 -> expert_18_10
	expert_18_10 -> expert_agg_10 [label="Expert 18 output"]
	moe_gate_10 -> tp_split_19_10 [label="Gate selection 19" style=dashed]
	tp_split_19_10 -> expert_compute_19_0_10
	tp_split_19_10 -> expert_compute_19_1_10
	expert_compute_19_0_10 -> tp_allreduce_19_10
	expert_compute_19_1_10 -> tp_allreduce_19_10
	tp_allreduce_19_10 -> expert_19_10
	expert_19_10 -> expert_agg_10 [label="Expert 19 output"]
	moe_gate_10 -> tp_split_20_10 [label="Gate selection 20" style=dashed]
	tp_split_20_10 -> expert_compute_20_0_10
	tp_split_20_10 -> expert_compute_20_1_10
	expert_compute_20_0_10 -> tp_allreduce_20_10
	expert_compute_20_1_10 -> tp_allreduce_20_10
	tp_allreduce_20_10 -> expert_20_10
	expert_20_10 -> expert_agg_10 [label="Expert 20 output"]
	moe_gate_10 -> tp_split_21_10 [label="Gate selection 21" style=dashed]
	tp_split_21_10 -> expert_compute_21_0_10
	tp_split_21_10 -> expert_compute_21_1_10
	expert_compute_21_0_10 -> tp_allreduce_21_10
	expert_compute_21_1_10 -> tp_allreduce_21_10
	tp_allreduce_21_10 -> expert_21_10
	expert_21_10 -> expert_agg_10 [label="Expert 21 output"]
	moe_gate_10 -> tp_split_22_10 [label="Gate selection 22" style=dashed]
	tp_split_22_10 -> expert_compute_22_0_10
	tp_split_22_10 -> expert_compute_22_1_10
	expert_compute_22_0_10 -> tp_allreduce_22_10
	expert_compute_22_1_10 -> tp_allreduce_22_10
	tp_allreduce_22_10 -> expert_22_10
	expert_22_10 -> expert_agg_10 [label="Expert 22 output"]
	moe_gate_10 -> tp_split_23_10 [label="Gate selection 23" style=dashed]
	tp_split_23_10 -> expert_compute_23_0_10
	tp_split_23_10 -> expert_compute_23_1_10
	expert_compute_23_0_10 -> tp_allreduce_23_10
	expert_compute_23_1_10 -> tp_allreduce_23_10
	tp_allreduce_23_10 -> expert_23_10
	expert_23_10 -> expert_agg_10 [label="Expert 23 output"]
	moe_gate_10 -> tp_split_24_10 [label="Gate selection 24" style=dashed]
	tp_split_24_10 -> expert_compute_24_0_10
	tp_split_24_10 -> expert_compute_24_1_10
	expert_compute_24_0_10 -> tp_allreduce_24_10
	expert_compute_24_1_10 -> tp_allreduce_24_10
	tp_allreduce_24_10 -> expert_24_10
	expert_24_10 -> expert_agg_10 [label="Expert 24 output"]
	moe_gate_10 -> tp_split_25_10 [label="Gate selection 25" style=dashed]
	tp_split_25_10 -> expert_compute_25_0_10
	tp_split_25_10 -> expert_compute_25_1_10
	expert_compute_25_0_10 -> tp_allreduce_25_10
	expert_compute_25_1_10 -> tp_allreduce_25_10
	tp_allreduce_25_10 -> expert_25_10
	expert_25_10 -> expert_agg_10 [label="Expert 25 output"]
	moe_gate_10 -> tp_split_26_10 [label="Gate selection 26" style=dashed]
	tp_split_26_10 -> expert_compute_26_0_10
	tp_split_26_10 -> expert_compute_26_1_10
	expert_compute_26_0_10 -> tp_allreduce_26_10
	expert_compute_26_1_10 -> tp_allreduce_26_10
	tp_allreduce_26_10 -> expert_26_10
	expert_26_10 -> expert_agg_10 [label="Expert 26 output"]
	moe_gate_10 -> tp_split_27_10 [label="Gate selection 27" style=dashed]
	tp_split_27_10 -> expert_compute_27_0_10
	tp_split_27_10 -> expert_compute_27_1_10
	expert_compute_27_0_10 -> tp_allreduce_27_10
	expert_compute_27_1_10 -> tp_allreduce_27_10
	tp_allreduce_27_10 -> expert_27_10
	expert_27_10 -> expert_agg_10 [label="Expert 27 output"]
	moe_gate_10 -> tp_split_28_10 [label="Gate selection 28" style=dashed]
	tp_split_28_10 -> expert_compute_28_0_10
	tp_split_28_10 -> expert_compute_28_1_10
	expert_compute_28_0_10 -> tp_allreduce_28_10
	expert_compute_28_1_10 -> tp_allreduce_28_10
	tp_allreduce_28_10 -> expert_28_10
	expert_28_10 -> expert_agg_10 [label="Expert 28 output"]
	moe_gate_10 -> tp_split_29_10 [label="Gate selection 29" style=dashed]
	tp_split_29_10 -> expert_compute_29_0_10
	tp_split_29_10 -> expert_compute_29_1_10
	expert_compute_29_0_10 -> tp_allreduce_29_10
	expert_compute_29_1_10 -> tp_allreduce_29_10
	tp_allreduce_29_10 -> expert_29_10
	expert_29_10 -> expert_agg_10 [label="Expert 29 output"]
	moe_gate_10 -> tp_split_30_10 [label="Gate selection 30" style=dashed]
	tp_split_30_10 -> expert_compute_30_0_10
	tp_split_30_10 -> expert_compute_30_1_10
	expert_compute_30_0_10 -> tp_allreduce_30_10
	expert_compute_30_1_10 -> tp_allreduce_30_10
	tp_allreduce_30_10 -> expert_30_10
	expert_30_10 -> expert_agg_10 [label="Expert 30 output"]
	moe_gate_10 -> tp_split_31_10 [label="Gate selection 31" style=dashed]
	tp_split_31_10 -> expert_compute_31_0_10
	tp_split_31_10 -> expert_compute_31_1_10
	expert_compute_31_0_10 -> tp_allreduce_31_10
	expert_compute_31_1_10 -> tp_allreduce_31_10
	tp_allreduce_31_10 -> expert_31_10
	expert_31_10 -> expert_agg_10 [label="Expert 31 output"]
	moe_gate_10 -> tp_split_32_10 [label="Gate selection 32" style=dashed]
	tp_split_32_10 -> expert_compute_32_0_10
	tp_split_32_10 -> expert_compute_32_1_10
	expert_compute_32_0_10 -> tp_allreduce_32_10
	expert_compute_32_1_10 -> tp_allreduce_32_10
	tp_allreduce_32_10 -> expert_32_10
	expert_32_10 -> expert_agg_10 [label="Expert 32 output"]
	moe_gate_10 -> tp_split_33_10 [label="Gate selection 33" style=dashed]
	tp_split_33_10 -> expert_compute_33_0_10
	tp_split_33_10 -> expert_compute_33_1_10
	expert_compute_33_0_10 -> tp_allreduce_33_10
	expert_compute_33_1_10 -> tp_allreduce_33_10
	tp_allreduce_33_10 -> expert_33_10
	expert_33_10 -> expert_agg_10 [label="Expert 33 output"]
	moe_gate_10 -> tp_split_34_10 [label="Gate selection 34" style=dashed]
	tp_split_34_10 -> expert_compute_34_0_10
	tp_split_34_10 -> expert_compute_34_1_10
	expert_compute_34_0_10 -> tp_allreduce_34_10
	expert_compute_34_1_10 -> tp_allreduce_34_10
	tp_allreduce_34_10 -> expert_34_10
	expert_34_10 -> expert_agg_10 [label="Expert 34 output"]
	moe_gate_10 -> tp_split_35_10 [label="Gate selection 35" style=dashed]
	tp_split_35_10 -> expert_compute_35_0_10
	tp_split_35_10 -> expert_compute_35_1_10
	expert_compute_35_0_10 -> tp_allreduce_35_10
	expert_compute_35_1_10 -> tp_allreduce_35_10
	tp_allreduce_35_10 -> expert_35_10
	expert_35_10 -> expert_agg_10 [label="Expert 35 output"]
	moe_gate_10 -> tp_split_36_10 [label="Gate selection 36" style=dashed]
	tp_split_36_10 -> expert_compute_36_0_10
	tp_split_36_10 -> expert_compute_36_1_10
	expert_compute_36_0_10 -> tp_allreduce_36_10
	expert_compute_36_1_10 -> tp_allreduce_36_10
	tp_allreduce_36_10 -> expert_36_10
	expert_36_10 -> expert_agg_10 [label="Expert 36 output"]
	moe_gate_10 -> tp_split_37_10 [label="Gate selection 37" style=dashed]
	tp_split_37_10 -> expert_compute_37_0_10
	tp_split_37_10 -> expert_compute_37_1_10
	expert_compute_37_0_10 -> tp_allreduce_37_10
	expert_compute_37_1_10 -> tp_allreduce_37_10
	tp_allreduce_37_10 -> expert_37_10
	expert_37_10 -> expert_agg_10 [label="Expert 37 output"]
	moe_gate_10 -> tp_split_38_10 [label="Gate selection 38" style=dashed]
	tp_split_38_10 -> expert_compute_38_0_10
	tp_split_38_10 -> expert_compute_38_1_10
	expert_compute_38_0_10 -> tp_allreduce_38_10
	expert_compute_38_1_10 -> tp_allreduce_38_10
	tp_allreduce_38_10 -> expert_38_10
	expert_38_10 -> expert_agg_10 [label="Expert 38 output"]
	moe_gate_10 -> tp_split_39_10 [label="Gate selection 39" style=dashed]
	tp_split_39_10 -> expert_compute_39_0_10
	tp_split_39_10 -> expert_compute_39_1_10
	expert_compute_39_0_10 -> tp_allreduce_39_10
	expert_compute_39_1_10 -> tp_allreduce_39_10
	tp_allreduce_39_10 -> expert_39_10
	expert_39_10 -> expert_agg_10 [label="Expert 39 output"]
	moe_gate_10 -> tp_split_40_10 [label="Gate selection 40" style=dashed]
	tp_split_40_10 -> expert_compute_40_0_10
	tp_split_40_10 -> expert_compute_40_1_10
	expert_compute_40_0_10 -> tp_allreduce_40_10
	expert_compute_40_1_10 -> tp_allreduce_40_10
	tp_allreduce_40_10 -> expert_40_10
	expert_40_10 -> expert_agg_10 [label="Expert 40 output"]
	moe_gate_10 -> tp_split_41_10 [label="Gate selection 41" style=dashed]
	tp_split_41_10 -> expert_compute_41_0_10
	tp_split_41_10 -> expert_compute_41_1_10
	expert_compute_41_0_10 -> tp_allreduce_41_10
	expert_compute_41_1_10 -> tp_allreduce_41_10
	tp_allreduce_41_10 -> expert_41_10
	expert_41_10 -> expert_agg_10 [label="Expert 41 output"]
	moe_gate_10 -> tp_split_42_10 [label="Gate selection 42" style=dashed]
	tp_split_42_10 -> expert_compute_42_0_10
	tp_split_42_10 -> expert_compute_42_1_10
	expert_compute_42_0_10 -> tp_allreduce_42_10
	expert_compute_42_1_10 -> tp_allreduce_42_10
	tp_allreduce_42_10 -> expert_42_10
	expert_42_10 -> expert_agg_10 [label="Expert 42 output"]
	moe_gate_10 -> tp_split_43_10 [label="Gate selection 43" style=dashed]
	tp_split_43_10 -> expert_compute_43_0_10
	tp_split_43_10 -> expert_compute_43_1_10
	expert_compute_43_0_10 -> tp_allreduce_43_10
	expert_compute_43_1_10 -> tp_allreduce_43_10
	tp_allreduce_43_10 -> expert_43_10
	expert_43_10 -> expert_agg_10 [label="Expert 43 output"]
	moe_gate_10 -> tp_split_44_10 [label="Gate selection 44" style=dashed]
	tp_split_44_10 -> expert_compute_44_0_10
	tp_split_44_10 -> expert_compute_44_1_10
	expert_compute_44_0_10 -> tp_allreduce_44_10
	expert_compute_44_1_10 -> tp_allreduce_44_10
	tp_allreduce_44_10 -> expert_44_10
	expert_44_10 -> expert_agg_10 [label="Expert 44 output"]
	moe_gate_10 -> tp_split_45_10 [label="Gate selection 45" style=dashed]
	tp_split_45_10 -> expert_compute_45_0_10
	tp_split_45_10 -> expert_compute_45_1_10
	expert_compute_45_0_10 -> tp_allreduce_45_10
	expert_compute_45_1_10 -> tp_allreduce_45_10
	tp_allreduce_45_10 -> expert_45_10
	expert_45_10 -> expert_agg_10 [label="Expert 45 output"]
	moe_gate_10 -> tp_split_46_10 [label="Gate selection 46" style=dashed]
	tp_split_46_10 -> expert_compute_46_0_10
	tp_split_46_10 -> expert_compute_46_1_10
	expert_compute_46_0_10 -> tp_allreduce_46_10
	expert_compute_46_1_10 -> tp_allreduce_46_10
	tp_allreduce_46_10 -> expert_46_10
	expert_46_10 -> expert_agg_10 [label="Expert 46 output"]
	moe_gate_10 -> tp_split_47_10 [label="Gate selection 47" style=dashed]
	tp_split_47_10 -> expert_compute_47_0_10
	tp_split_47_10 -> expert_compute_47_1_10
	expert_compute_47_0_10 -> tp_allreduce_47_10
	expert_compute_47_1_10 -> tp_allreduce_47_10
	tp_allreduce_47_10 -> expert_47_10
	expert_47_10 -> expert_agg_10 [label="Expert 47 output"]
	moe_gate_10 -> tp_split_48_10 [label="Gate selection 48" style=dashed]
	tp_split_48_10 -> expert_compute_48_0_10
	tp_split_48_10 -> expert_compute_48_1_10
	expert_compute_48_0_10 -> tp_allreduce_48_10
	expert_compute_48_1_10 -> tp_allreduce_48_10
	tp_allreduce_48_10 -> expert_48_10
	expert_48_10 -> expert_agg_10 [label="Expert 48 output"]
	moe_gate_10 -> tp_split_49_10 [label="Gate selection 49" style=dashed]
	tp_split_49_10 -> expert_compute_49_0_10
	tp_split_49_10 -> expert_compute_49_1_10
	expert_compute_49_0_10 -> tp_allreduce_49_10
	expert_compute_49_1_10 -> tp_allreduce_49_10
	tp_allreduce_49_10 -> expert_49_10
	expert_49_10 -> expert_agg_10 [label="Expert 49 output"]
	moe_gate_10 -> tp_split_50_10 [label="Gate selection 50" style=dashed]
	tp_split_50_10 -> expert_compute_50_0_10
	tp_split_50_10 -> expert_compute_50_1_10
	expert_compute_50_0_10 -> tp_allreduce_50_10
	expert_compute_50_1_10 -> tp_allreduce_50_10
	tp_allreduce_50_10 -> expert_50_10
	expert_50_10 -> expert_agg_10 [label="Expert 50 output"]
	moe_gate_10 -> tp_split_51_10 [label="Gate selection 51" style=dashed]
	tp_split_51_10 -> expert_compute_51_0_10
	tp_split_51_10 -> expert_compute_51_1_10
	expert_compute_51_0_10 -> tp_allreduce_51_10
	expert_compute_51_1_10 -> tp_allreduce_51_10
	tp_allreduce_51_10 -> expert_51_10
	expert_51_10 -> expert_agg_10 [label="Expert 51 output"]
	moe_gate_10 -> tp_split_52_10 [label="Gate selection 52" style=dashed]
	tp_split_52_10 -> expert_compute_52_0_10
	tp_split_52_10 -> expert_compute_52_1_10
	expert_compute_52_0_10 -> tp_allreduce_52_10
	expert_compute_52_1_10 -> tp_allreduce_52_10
	tp_allreduce_52_10 -> expert_52_10
	expert_52_10 -> expert_agg_10 [label="Expert 52 output"]
	moe_gate_10 -> tp_split_53_10 [label="Gate selection 53" style=dashed]
	tp_split_53_10 -> expert_compute_53_0_10
	tp_split_53_10 -> expert_compute_53_1_10
	expert_compute_53_0_10 -> tp_allreduce_53_10
	expert_compute_53_1_10 -> tp_allreduce_53_10
	tp_allreduce_53_10 -> expert_53_10
	expert_53_10 -> expert_agg_10 [label="Expert 53 output"]
	moe_gate_10 -> tp_split_54_10 [label="Gate selection 54" style=dashed]
	tp_split_54_10 -> expert_compute_54_0_10
	tp_split_54_10 -> expert_compute_54_1_10
	expert_compute_54_0_10 -> tp_allreduce_54_10
	expert_compute_54_1_10 -> tp_allreduce_54_10
	tp_allreduce_54_10 -> expert_54_10
	expert_54_10 -> expert_agg_10 [label="Expert 54 output"]
	moe_gate_10 -> tp_split_55_10 [label="Gate selection 55" style=dashed]
	tp_split_55_10 -> expert_compute_55_0_10
	tp_split_55_10 -> expert_compute_55_1_10
	expert_compute_55_0_10 -> tp_allreduce_55_10
	expert_compute_55_1_10 -> tp_allreduce_55_10
	tp_allreduce_55_10 -> expert_55_10
	expert_55_10 -> expert_agg_10 [label="Expert 55 output"]
	moe_gate_10 -> tp_split_56_10 [label="Gate selection 56" style=dashed]
	tp_split_56_10 -> expert_compute_56_0_10
	tp_split_56_10 -> expert_compute_56_1_10
	expert_compute_56_0_10 -> tp_allreduce_56_10
	expert_compute_56_1_10 -> tp_allreduce_56_10
	tp_allreduce_56_10 -> expert_56_10
	expert_56_10 -> expert_agg_10 [label="Expert 56 output"]
	moe_gate_10 -> tp_split_57_10 [label="Gate selection 57" style=dashed]
	tp_split_57_10 -> expert_compute_57_0_10
	tp_split_57_10 -> expert_compute_57_1_10
	expert_compute_57_0_10 -> tp_allreduce_57_10
	expert_compute_57_1_10 -> tp_allreduce_57_10
	tp_allreduce_57_10 -> expert_57_10
	expert_57_10 -> expert_agg_10 [label="Expert 57 output"]
	moe_gate_10 -> tp_split_58_10 [label="Gate selection 58" style=dashed]
	tp_split_58_10 -> expert_compute_58_0_10
	tp_split_58_10 -> expert_compute_58_1_10
	expert_compute_58_0_10 -> tp_allreduce_58_10
	expert_compute_58_1_10 -> tp_allreduce_58_10
	tp_allreduce_58_10 -> expert_58_10
	expert_58_10 -> expert_agg_10 [label="Expert 58 output"]
	moe_gate_10 -> tp_split_59_10 [label="Gate selection 59" style=dashed]
	tp_split_59_10 -> expert_compute_59_0_10
	tp_split_59_10 -> expert_compute_59_1_10
	expert_compute_59_0_10 -> tp_allreduce_59_10
	expert_compute_59_1_10 -> tp_allreduce_59_10
	tp_allreduce_59_10 -> expert_59_10
	expert_59_10 -> expert_agg_10 [label="Expert 59 output"]
	moe_gate_10 -> tp_split_60_10 [label="Gate selection 60" style=dashed]
	tp_split_60_10 -> expert_compute_60_0_10
	tp_split_60_10 -> expert_compute_60_1_10
	expert_compute_60_0_10 -> tp_allreduce_60_10
	expert_compute_60_1_10 -> tp_allreduce_60_10
	tp_allreduce_60_10 -> expert_60_10
	expert_60_10 -> expert_agg_10 [label="Expert 60 output"]
	moe_gate_10 -> tp_split_61_10 [label="Gate selection 61" style=dashed]
	tp_split_61_10 -> expert_compute_61_0_10
	tp_split_61_10 -> expert_compute_61_1_10
	expert_compute_61_0_10 -> tp_allreduce_61_10
	expert_compute_61_1_10 -> tp_allreduce_61_10
	tp_allreduce_61_10 -> expert_61_10
	expert_61_10 -> expert_agg_10 [label="Expert 61 output"]
	moe_gate_10 -> tp_split_62_10 [label="Gate selection 62" style=dashed]
	tp_split_62_10 -> expert_compute_62_0_10
	tp_split_62_10 -> expert_compute_62_1_10
	expert_compute_62_0_10 -> tp_allreduce_62_10
	expert_compute_62_1_10 -> tp_allreduce_62_10
	tp_allreduce_62_10 -> expert_62_10
	expert_62_10 -> expert_agg_10 [label="Expert 62 output"]
	moe_gate_10 -> tp_split_63_10 [label="Gate selection 63" style=dashed]
	tp_split_63_10 -> expert_compute_63_0_10
	tp_split_63_10 -> expert_compute_63_1_10
	expert_compute_63_0_10 -> tp_allreduce_63_10
	expert_compute_63_1_10 -> tp_allreduce_63_10
	tp_allreduce_63_10 -> expert_63_10
	expert_63_10 -> expert_agg_10 [label="Expert 63 output"]
	expert_agg_10 -> layer_norm_10
	layer_norm_10 -> attn_norm_11
	attn_norm_11 -> attn_q_11
	attn_norm_11 -> attn_k_11
	attn_norm_11 -> attn_v_11
	attn_q_11 -> attn_score_11
	attn_k_11 -> attn_score_11
	attn_v_11 -> attn_out_11
	attn_score_11 -> attn_out_11
	attn_out_11 -> moe_gate_11
	moe_gate_11 -> tp_split_0_11 [label="Gate selection 0" style=dashed]
	tp_split_0_11 -> expert_compute_0_0_11
	tp_split_0_11 -> expert_compute_0_1_11
	expert_compute_0_0_11 -> tp_allreduce_0_11
	expert_compute_0_1_11 -> tp_allreduce_0_11
	tp_allreduce_0_11 -> expert_0_11
	expert_0_11 -> expert_agg_11 [label="Expert 0 output"]
	moe_gate_11 -> tp_split_1_11 [label="Gate selection 1" style=dashed]
	tp_split_1_11 -> expert_compute_1_0_11
	tp_split_1_11 -> expert_compute_1_1_11
	expert_compute_1_0_11 -> tp_allreduce_1_11
	expert_compute_1_1_11 -> tp_allreduce_1_11
	tp_allreduce_1_11 -> expert_1_11
	expert_1_11 -> expert_agg_11 [label="Expert 1 output"]
	moe_gate_11 -> tp_split_2_11 [label="Gate selection 2" style=dashed]
	tp_split_2_11 -> expert_compute_2_0_11
	tp_split_2_11 -> expert_compute_2_1_11
	expert_compute_2_0_11 -> tp_allreduce_2_11
	expert_compute_2_1_11 -> tp_allreduce_2_11
	tp_allreduce_2_11 -> expert_2_11
	expert_2_11 -> expert_agg_11 [label="Expert 2 output"]
	moe_gate_11 -> tp_split_3_11 [label="Gate selection 3" style=dashed]
	tp_split_3_11 -> expert_compute_3_0_11
	tp_split_3_11 -> expert_compute_3_1_11
	expert_compute_3_0_11 -> tp_allreduce_3_11
	expert_compute_3_1_11 -> tp_allreduce_3_11
	tp_allreduce_3_11 -> expert_3_11
	expert_3_11 -> expert_agg_11 [label="Expert 3 output"]
	moe_gate_11 -> tp_split_4_11 [label="Gate selection 4" style=dashed]
	tp_split_4_11 -> expert_compute_4_0_11
	tp_split_4_11 -> expert_compute_4_1_11
	expert_compute_4_0_11 -> tp_allreduce_4_11
	expert_compute_4_1_11 -> tp_allreduce_4_11
	tp_allreduce_4_11 -> expert_4_11
	expert_4_11 -> expert_agg_11 [label="Expert 4 output"]
	moe_gate_11 -> tp_split_5_11 [label="Gate selection 5" style=dashed]
	tp_split_5_11 -> expert_compute_5_0_11
	tp_split_5_11 -> expert_compute_5_1_11
	expert_compute_5_0_11 -> tp_allreduce_5_11
	expert_compute_5_1_11 -> tp_allreduce_5_11
	tp_allreduce_5_11 -> expert_5_11
	expert_5_11 -> expert_agg_11 [label="Expert 5 output"]
	moe_gate_11 -> tp_split_6_11 [label="Gate selection 6" style=dashed]
	tp_split_6_11 -> expert_compute_6_0_11
	tp_split_6_11 -> expert_compute_6_1_11
	expert_compute_6_0_11 -> tp_allreduce_6_11
	expert_compute_6_1_11 -> tp_allreduce_6_11
	tp_allreduce_6_11 -> expert_6_11
	expert_6_11 -> expert_agg_11 [label="Expert 6 output"]
	moe_gate_11 -> tp_split_7_11 [label="Gate selection 7" style=dashed]
	tp_split_7_11 -> expert_compute_7_0_11
	tp_split_7_11 -> expert_compute_7_1_11
	expert_compute_7_0_11 -> tp_allreduce_7_11
	expert_compute_7_1_11 -> tp_allreduce_7_11
	tp_allreduce_7_11 -> expert_7_11
	expert_7_11 -> expert_agg_11 [label="Expert 7 output"]
	moe_gate_11 -> tp_split_8_11 [label="Gate selection 8" style=dashed]
	tp_split_8_11 -> expert_compute_8_0_11
	tp_split_8_11 -> expert_compute_8_1_11
	expert_compute_8_0_11 -> tp_allreduce_8_11
	expert_compute_8_1_11 -> tp_allreduce_8_11
	tp_allreduce_8_11 -> expert_8_11
	expert_8_11 -> expert_agg_11 [label="Expert 8 output"]
	moe_gate_11 -> tp_split_9_11 [label="Gate selection 9" style=dashed]
	tp_split_9_11 -> expert_compute_9_0_11
	tp_split_9_11 -> expert_compute_9_1_11
	expert_compute_9_0_11 -> tp_allreduce_9_11
	expert_compute_9_1_11 -> tp_allreduce_9_11
	tp_allreduce_9_11 -> expert_9_11
	expert_9_11 -> expert_agg_11 [label="Expert 9 output"]
	moe_gate_11 -> tp_split_10_11 [label="Gate selection 10" style=dashed]
	tp_split_10_11 -> expert_compute_10_0_11
	tp_split_10_11 -> expert_compute_10_1_11
	expert_compute_10_0_11 -> tp_allreduce_10_11
	expert_compute_10_1_11 -> tp_allreduce_10_11
	tp_allreduce_10_11 -> expert_10_11
	expert_10_11 -> expert_agg_11 [label="Expert 10 output"]
	moe_gate_11 -> tp_split_11_11 [label="Gate selection 11" style=dashed]
	tp_split_11_11 -> expert_compute_11_0_11
	tp_split_11_11 -> expert_compute_11_1_11
	expert_compute_11_0_11 -> tp_allreduce_11_11
	expert_compute_11_1_11 -> tp_allreduce_11_11
	tp_allreduce_11_11 -> expert_11_11
	expert_11_11 -> expert_agg_11 [label="Expert 11 output"]
	moe_gate_11 -> tp_split_12_11 [label="Gate selection 12" style=dashed]
	tp_split_12_11 -> expert_compute_12_0_11
	tp_split_12_11 -> expert_compute_12_1_11
	expert_compute_12_0_11 -> tp_allreduce_12_11
	expert_compute_12_1_11 -> tp_allreduce_12_11
	tp_allreduce_12_11 -> expert_12_11
	expert_12_11 -> expert_agg_11 [label="Expert 12 output"]
	moe_gate_11 -> tp_split_13_11 [label="Gate selection 13" style=dashed]
	tp_split_13_11 -> expert_compute_13_0_11
	tp_split_13_11 -> expert_compute_13_1_11
	expert_compute_13_0_11 -> tp_allreduce_13_11
	expert_compute_13_1_11 -> tp_allreduce_13_11
	tp_allreduce_13_11 -> expert_13_11
	expert_13_11 -> expert_agg_11 [label="Expert 13 output"]
	moe_gate_11 -> tp_split_14_11 [label="Gate selection 14" style=dashed]
	tp_split_14_11 -> expert_compute_14_0_11
	tp_split_14_11 -> expert_compute_14_1_11
	expert_compute_14_0_11 -> tp_allreduce_14_11
	expert_compute_14_1_11 -> tp_allreduce_14_11
	tp_allreduce_14_11 -> expert_14_11
	expert_14_11 -> expert_agg_11 [label="Expert 14 output"]
	moe_gate_11 -> tp_split_15_11 [label="Gate selection 15" style=dashed]
	tp_split_15_11 -> expert_compute_15_0_11
	tp_split_15_11 -> expert_compute_15_1_11
	expert_compute_15_0_11 -> tp_allreduce_15_11
	expert_compute_15_1_11 -> tp_allreduce_15_11
	tp_allreduce_15_11 -> expert_15_11
	expert_15_11 -> expert_agg_11 [label="Expert 15 output"]
	moe_gate_11 -> tp_split_16_11 [label="Gate selection 16" style=dashed]
	tp_split_16_11 -> expert_compute_16_0_11
	tp_split_16_11 -> expert_compute_16_1_11
	expert_compute_16_0_11 -> tp_allreduce_16_11
	expert_compute_16_1_11 -> tp_allreduce_16_11
	tp_allreduce_16_11 -> expert_16_11
	expert_16_11 -> expert_agg_11 [label="Expert 16 output"]
	moe_gate_11 -> tp_split_17_11 [label="Gate selection 17" style=dashed]
	tp_split_17_11 -> expert_compute_17_0_11
	tp_split_17_11 -> expert_compute_17_1_11
	expert_compute_17_0_11 -> tp_allreduce_17_11
	expert_compute_17_1_11 -> tp_allreduce_17_11
	tp_allreduce_17_11 -> expert_17_11
	expert_17_11 -> expert_agg_11 [label="Expert 17 output"]
	moe_gate_11 -> tp_split_18_11 [label="Gate selection 18" style=dashed]
	tp_split_18_11 -> expert_compute_18_0_11
	tp_split_18_11 -> expert_compute_18_1_11
	expert_compute_18_0_11 -> tp_allreduce_18_11
	expert_compute_18_1_11 -> tp_allreduce_18_11
	tp_allreduce_18_11 -> expert_18_11
	expert_18_11 -> expert_agg_11 [label="Expert 18 output"]
	moe_gate_11 -> tp_split_19_11 [label="Gate selection 19" style=dashed]
	tp_split_19_11 -> expert_compute_19_0_11
	tp_split_19_11 -> expert_compute_19_1_11
	expert_compute_19_0_11 -> tp_allreduce_19_11
	expert_compute_19_1_11 -> tp_allreduce_19_11
	tp_allreduce_19_11 -> expert_19_11
	expert_19_11 -> expert_agg_11 [label="Expert 19 output"]
	moe_gate_11 -> tp_split_20_11 [label="Gate selection 20" style=dashed]
	tp_split_20_11 -> expert_compute_20_0_11
	tp_split_20_11 -> expert_compute_20_1_11
	expert_compute_20_0_11 -> tp_allreduce_20_11
	expert_compute_20_1_11 -> tp_allreduce_20_11
	tp_allreduce_20_11 -> expert_20_11
	expert_20_11 -> expert_agg_11 [label="Expert 20 output"]
	moe_gate_11 -> tp_split_21_11 [label="Gate selection 21" style=dashed]
	tp_split_21_11 -> expert_compute_21_0_11
	tp_split_21_11 -> expert_compute_21_1_11
	expert_compute_21_0_11 -> tp_allreduce_21_11
	expert_compute_21_1_11 -> tp_allreduce_21_11
	tp_allreduce_21_11 -> expert_21_11
	expert_21_11 -> expert_agg_11 [label="Expert 21 output"]
	moe_gate_11 -> tp_split_22_11 [label="Gate selection 22" style=dashed]
	tp_split_22_11 -> expert_compute_22_0_11
	tp_split_22_11 -> expert_compute_22_1_11
	expert_compute_22_0_11 -> tp_allreduce_22_11
	expert_compute_22_1_11 -> tp_allreduce_22_11
	tp_allreduce_22_11 -> expert_22_11
	expert_22_11 -> expert_agg_11 [label="Expert 22 output"]
	moe_gate_11 -> tp_split_23_11 [label="Gate selection 23" style=dashed]
	tp_split_23_11 -> expert_compute_23_0_11
	tp_split_23_11 -> expert_compute_23_1_11
	expert_compute_23_0_11 -> tp_allreduce_23_11
	expert_compute_23_1_11 -> tp_allreduce_23_11
	tp_allreduce_23_11 -> expert_23_11
	expert_23_11 -> expert_agg_11 [label="Expert 23 output"]
	moe_gate_11 -> tp_split_24_11 [label="Gate selection 24" style=dashed]
	tp_split_24_11 -> expert_compute_24_0_11
	tp_split_24_11 -> expert_compute_24_1_11
	expert_compute_24_0_11 -> tp_allreduce_24_11
	expert_compute_24_1_11 -> tp_allreduce_24_11
	tp_allreduce_24_11 -> expert_24_11
	expert_24_11 -> expert_agg_11 [label="Expert 24 output"]
	moe_gate_11 -> tp_split_25_11 [label="Gate selection 25" style=dashed]
	tp_split_25_11 -> expert_compute_25_0_11
	tp_split_25_11 -> expert_compute_25_1_11
	expert_compute_25_0_11 -> tp_allreduce_25_11
	expert_compute_25_1_11 -> tp_allreduce_25_11
	tp_allreduce_25_11 -> expert_25_11
	expert_25_11 -> expert_agg_11 [label="Expert 25 output"]
	moe_gate_11 -> tp_split_26_11 [label="Gate selection 26" style=dashed]
	tp_split_26_11 -> expert_compute_26_0_11
	tp_split_26_11 -> expert_compute_26_1_11
	expert_compute_26_0_11 -> tp_allreduce_26_11
	expert_compute_26_1_11 -> tp_allreduce_26_11
	tp_allreduce_26_11 -> expert_26_11
	expert_26_11 -> expert_agg_11 [label="Expert 26 output"]
	moe_gate_11 -> tp_split_27_11 [label="Gate selection 27" style=dashed]
	tp_split_27_11 -> expert_compute_27_0_11
	tp_split_27_11 -> expert_compute_27_1_11
	expert_compute_27_0_11 -> tp_allreduce_27_11
	expert_compute_27_1_11 -> tp_allreduce_27_11
	tp_allreduce_27_11 -> expert_27_11
	expert_27_11 -> expert_agg_11 [label="Expert 27 output"]
	moe_gate_11 -> tp_split_28_11 [label="Gate selection 28" style=dashed]
	tp_split_28_11 -> expert_compute_28_0_11
	tp_split_28_11 -> expert_compute_28_1_11
	expert_compute_28_0_11 -> tp_allreduce_28_11
	expert_compute_28_1_11 -> tp_allreduce_28_11
	tp_allreduce_28_11 -> expert_28_11
	expert_28_11 -> expert_agg_11 [label="Expert 28 output"]
	moe_gate_11 -> tp_split_29_11 [label="Gate selection 29" style=dashed]
	tp_split_29_11 -> expert_compute_29_0_11
	tp_split_29_11 -> expert_compute_29_1_11
	expert_compute_29_0_11 -> tp_allreduce_29_11
	expert_compute_29_1_11 -> tp_allreduce_29_11
	tp_allreduce_29_11 -> expert_29_11
	expert_29_11 -> expert_agg_11 [label="Expert 29 output"]
	moe_gate_11 -> tp_split_30_11 [label="Gate selection 30" style=dashed]
	tp_split_30_11 -> expert_compute_30_0_11
	tp_split_30_11 -> expert_compute_30_1_11
	expert_compute_30_0_11 -> tp_allreduce_30_11
	expert_compute_30_1_11 -> tp_allreduce_30_11
	tp_allreduce_30_11 -> expert_30_11
	expert_30_11 -> expert_agg_11 [label="Expert 30 output"]
	moe_gate_11 -> tp_split_31_11 [label="Gate selection 31" style=dashed]
	tp_split_31_11 -> expert_compute_31_0_11
	tp_split_31_11 -> expert_compute_31_1_11
	expert_compute_31_0_11 -> tp_allreduce_31_11
	expert_compute_31_1_11 -> tp_allreduce_31_11
	tp_allreduce_31_11 -> expert_31_11
	expert_31_11 -> expert_agg_11 [label="Expert 31 output"]
	moe_gate_11 -> tp_split_32_11 [label="Gate selection 32" style=dashed]
	tp_split_32_11 -> expert_compute_32_0_11
	tp_split_32_11 -> expert_compute_32_1_11
	expert_compute_32_0_11 -> tp_allreduce_32_11
	expert_compute_32_1_11 -> tp_allreduce_32_11
	tp_allreduce_32_11 -> expert_32_11
	expert_32_11 -> expert_agg_11 [label="Expert 32 output"]
	moe_gate_11 -> tp_split_33_11 [label="Gate selection 33" style=dashed]
	tp_split_33_11 -> expert_compute_33_0_11
	tp_split_33_11 -> expert_compute_33_1_11
	expert_compute_33_0_11 -> tp_allreduce_33_11
	expert_compute_33_1_11 -> tp_allreduce_33_11
	tp_allreduce_33_11 -> expert_33_11
	expert_33_11 -> expert_agg_11 [label="Expert 33 output"]
	moe_gate_11 -> tp_split_34_11 [label="Gate selection 34" style=dashed]
	tp_split_34_11 -> expert_compute_34_0_11
	tp_split_34_11 -> expert_compute_34_1_11
	expert_compute_34_0_11 -> tp_allreduce_34_11
	expert_compute_34_1_11 -> tp_allreduce_34_11
	tp_allreduce_34_11 -> expert_34_11
	expert_34_11 -> expert_agg_11 [label="Expert 34 output"]
	moe_gate_11 -> tp_split_35_11 [label="Gate selection 35" style=dashed]
	tp_split_35_11 -> expert_compute_35_0_11
	tp_split_35_11 -> expert_compute_35_1_11
	expert_compute_35_0_11 -> tp_allreduce_35_11
	expert_compute_35_1_11 -> tp_allreduce_35_11
	tp_allreduce_35_11 -> expert_35_11
	expert_35_11 -> expert_agg_11 [label="Expert 35 output"]
	moe_gate_11 -> tp_split_36_11 [label="Gate selection 36" style=dashed]
	tp_split_36_11 -> expert_compute_36_0_11
	tp_split_36_11 -> expert_compute_36_1_11
	expert_compute_36_0_11 -> tp_allreduce_36_11
	expert_compute_36_1_11 -> tp_allreduce_36_11
	tp_allreduce_36_11 -> expert_36_11
	expert_36_11 -> expert_agg_11 [label="Expert 36 output"]
	moe_gate_11 -> tp_split_37_11 [label="Gate selection 37" style=dashed]
	tp_split_37_11 -> expert_compute_37_0_11
	tp_split_37_11 -> expert_compute_37_1_11
	expert_compute_37_0_11 -> tp_allreduce_37_11
	expert_compute_37_1_11 -> tp_allreduce_37_11
	tp_allreduce_37_11 -> expert_37_11
	expert_37_11 -> expert_agg_11 [label="Expert 37 output"]
	moe_gate_11 -> tp_split_38_11 [label="Gate selection 38" style=dashed]
	tp_split_38_11 -> expert_compute_38_0_11
	tp_split_38_11 -> expert_compute_38_1_11
	expert_compute_38_0_11 -> tp_allreduce_38_11
	expert_compute_38_1_11 -> tp_allreduce_38_11
	tp_allreduce_38_11 -> expert_38_11
	expert_38_11 -> expert_agg_11 [label="Expert 38 output"]
	moe_gate_11 -> tp_split_39_11 [label="Gate selection 39" style=dashed]
	tp_split_39_11 -> expert_compute_39_0_11
	tp_split_39_11 -> expert_compute_39_1_11
	expert_compute_39_0_11 -> tp_allreduce_39_11
	expert_compute_39_1_11 -> tp_allreduce_39_11
	tp_allreduce_39_11 -> expert_39_11
	expert_39_11 -> expert_agg_11 [label="Expert 39 output"]
	moe_gate_11 -> tp_split_40_11 [label="Gate selection 40" style=dashed]
	tp_split_40_11 -> expert_compute_40_0_11
	tp_split_40_11 -> expert_compute_40_1_11
	expert_compute_40_0_11 -> tp_allreduce_40_11
	expert_compute_40_1_11 -> tp_allreduce_40_11
	tp_allreduce_40_11 -> expert_40_11
	expert_40_11 -> expert_agg_11 [label="Expert 40 output"]
	moe_gate_11 -> tp_split_41_11 [label="Gate selection 41" style=dashed]
	tp_split_41_11 -> expert_compute_41_0_11
	tp_split_41_11 -> expert_compute_41_1_11
	expert_compute_41_0_11 -> tp_allreduce_41_11
	expert_compute_41_1_11 -> tp_allreduce_41_11
	tp_allreduce_41_11 -> expert_41_11
	expert_41_11 -> expert_agg_11 [label="Expert 41 output"]
	moe_gate_11 -> tp_split_42_11 [label="Gate selection 42" style=dashed]
	tp_split_42_11 -> expert_compute_42_0_11
	tp_split_42_11 -> expert_compute_42_1_11
	expert_compute_42_0_11 -> tp_allreduce_42_11
	expert_compute_42_1_11 -> tp_allreduce_42_11
	tp_allreduce_42_11 -> expert_42_11
	expert_42_11 -> expert_agg_11 [label="Expert 42 output"]
	moe_gate_11 -> tp_split_43_11 [label="Gate selection 43" style=dashed]
	tp_split_43_11 -> expert_compute_43_0_11
	tp_split_43_11 -> expert_compute_43_1_11
	expert_compute_43_0_11 -> tp_allreduce_43_11
	expert_compute_43_1_11 -> tp_allreduce_43_11
	tp_allreduce_43_11 -> expert_43_11
	expert_43_11 -> expert_agg_11 [label="Expert 43 output"]
	moe_gate_11 -> tp_split_44_11 [label="Gate selection 44" style=dashed]
	tp_split_44_11 -> expert_compute_44_0_11
	tp_split_44_11 -> expert_compute_44_1_11
	expert_compute_44_0_11 -> tp_allreduce_44_11
	expert_compute_44_1_11 -> tp_allreduce_44_11
	tp_allreduce_44_11 -> expert_44_11
	expert_44_11 -> expert_agg_11 [label="Expert 44 output"]
	moe_gate_11 -> tp_split_45_11 [label="Gate selection 45" style=dashed]
	tp_split_45_11 -> expert_compute_45_0_11
	tp_split_45_11 -> expert_compute_45_1_11
	expert_compute_45_0_11 -> tp_allreduce_45_11
	expert_compute_45_1_11 -> tp_allreduce_45_11
	tp_allreduce_45_11 -> expert_45_11
	expert_45_11 -> expert_agg_11 [label="Expert 45 output"]
	moe_gate_11 -> tp_split_46_11 [label="Gate selection 46" style=dashed]
	tp_split_46_11 -> expert_compute_46_0_11
	tp_split_46_11 -> expert_compute_46_1_11
	expert_compute_46_0_11 -> tp_allreduce_46_11
	expert_compute_46_1_11 -> tp_allreduce_46_11
	tp_allreduce_46_11 -> expert_46_11
	expert_46_11 -> expert_agg_11 [label="Expert 46 output"]
	moe_gate_11 -> tp_split_47_11 [label="Gate selection 47" style=dashed]
	tp_split_47_11 -> expert_compute_47_0_11
	tp_split_47_11 -> expert_compute_47_1_11
	expert_compute_47_0_11 -> tp_allreduce_47_11
	expert_compute_47_1_11 -> tp_allreduce_47_11
	tp_allreduce_47_11 -> expert_47_11
	expert_47_11 -> expert_agg_11 [label="Expert 47 output"]
	moe_gate_11 -> tp_split_48_11 [label="Gate selection 48" style=dashed]
	tp_split_48_11 -> expert_compute_48_0_11
	tp_split_48_11 -> expert_compute_48_1_11
	expert_compute_48_0_11 -> tp_allreduce_48_11
	expert_compute_48_1_11 -> tp_allreduce_48_11
	tp_allreduce_48_11 -> expert_48_11
	expert_48_11 -> expert_agg_11 [label="Expert 48 output"]
	moe_gate_11 -> tp_split_49_11 [label="Gate selection 49" style=dashed]
	tp_split_49_11 -> expert_compute_49_0_11
	tp_split_49_11 -> expert_compute_49_1_11
	expert_compute_49_0_11 -> tp_allreduce_49_11
	expert_compute_49_1_11 -> tp_allreduce_49_11
	tp_allreduce_49_11 -> expert_49_11
	expert_49_11 -> expert_agg_11 [label="Expert 49 output"]
	moe_gate_11 -> tp_split_50_11 [label="Gate selection 50" style=dashed]
	tp_split_50_11 -> expert_compute_50_0_11
	tp_split_50_11 -> expert_compute_50_1_11
	expert_compute_50_0_11 -> tp_allreduce_50_11
	expert_compute_50_1_11 -> tp_allreduce_50_11
	tp_allreduce_50_11 -> expert_50_11
	expert_50_11 -> expert_agg_11 [label="Expert 50 output"]
	moe_gate_11 -> tp_split_51_11 [label="Gate selection 51" style=dashed]
	tp_split_51_11 -> expert_compute_51_0_11
	tp_split_51_11 -> expert_compute_51_1_11
	expert_compute_51_0_11 -> tp_allreduce_51_11
	expert_compute_51_1_11 -> tp_allreduce_51_11
	tp_allreduce_51_11 -> expert_51_11
	expert_51_11 -> expert_agg_11 [label="Expert 51 output"]
	moe_gate_11 -> tp_split_52_11 [label="Gate selection 52" style=dashed]
	tp_split_52_11 -> expert_compute_52_0_11
	tp_split_52_11 -> expert_compute_52_1_11
	expert_compute_52_0_11 -> tp_allreduce_52_11
	expert_compute_52_1_11 -> tp_allreduce_52_11
	tp_allreduce_52_11 -> expert_52_11
	expert_52_11 -> expert_agg_11 [label="Expert 52 output"]
	moe_gate_11 -> tp_split_53_11 [label="Gate selection 53" style=dashed]
	tp_split_53_11 -> expert_compute_53_0_11
	tp_split_53_11 -> expert_compute_53_1_11
	expert_compute_53_0_11 -> tp_allreduce_53_11
	expert_compute_53_1_11 -> tp_allreduce_53_11
	tp_allreduce_53_11 -> expert_53_11
	expert_53_11 -> expert_agg_11 [label="Expert 53 output"]
	moe_gate_11 -> tp_split_54_11 [label="Gate selection 54" style=dashed]
	tp_split_54_11 -> expert_compute_54_0_11
	tp_split_54_11 -> expert_compute_54_1_11
	expert_compute_54_0_11 -> tp_allreduce_54_11
	expert_compute_54_1_11 -> tp_allreduce_54_11
	tp_allreduce_54_11 -> expert_54_11
	expert_54_11 -> expert_agg_11 [label="Expert 54 output"]
	moe_gate_11 -> tp_split_55_11 [label="Gate selection 55" style=dashed]
	tp_split_55_11 -> expert_compute_55_0_11
	tp_split_55_11 -> expert_compute_55_1_11
	expert_compute_55_0_11 -> tp_allreduce_55_11
	expert_compute_55_1_11 -> tp_allreduce_55_11
	tp_allreduce_55_11 -> expert_55_11
	expert_55_11 -> expert_agg_11 [label="Expert 55 output"]
	moe_gate_11 -> tp_split_56_11 [label="Gate selection 56" style=dashed]
	tp_split_56_11 -> expert_compute_56_0_11
	tp_split_56_11 -> expert_compute_56_1_11
	expert_compute_56_0_11 -> tp_allreduce_56_11
	expert_compute_56_1_11 -> tp_allreduce_56_11
	tp_allreduce_56_11 -> expert_56_11
	expert_56_11 -> expert_agg_11 [label="Expert 56 output"]
	moe_gate_11 -> tp_split_57_11 [label="Gate selection 57" style=dashed]
	tp_split_57_11 -> expert_compute_57_0_11
	tp_split_57_11 -> expert_compute_57_1_11
	expert_compute_57_0_11 -> tp_allreduce_57_11
	expert_compute_57_1_11 -> tp_allreduce_57_11
	tp_allreduce_57_11 -> expert_57_11
	expert_57_11 -> expert_agg_11 [label="Expert 57 output"]
	moe_gate_11 -> tp_split_58_11 [label="Gate selection 58" style=dashed]
	tp_split_58_11 -> expert_compute_58_0_11
	tp_split_58_11 -> expert_compute_58_1_11
	expert_compute_58_0_11 -> tp_allreduce_58_11
	expert_compute_58_1_11 -> tp_allreduce_58_11
	tp_allreduce_58_11 -> expert_58_11
	expert_58_11 -> expert_agg_11 [label="Expert 58 output"]
	moe_gate_11 -> tp_split_59_11 [label="Gate selection 59" style=dashed]
	tp_split_59_11 -> expert_compute_59_0_11
	tp_split_59_11 -> expert_compute_59_1_11
	expert_compute_59_0_11 -> tp_allreduce_59_11
	expert_compute_59_1_11 -> tp_allreduce_59_11
	tp_allreduce_59_11 -> expert_59_11
	expert_59_11 -> expert_agg_11 [label="Expert 59 output"]
	moe_gate_11 -> tp_split_60_11 [label="Gate selection 60" style=dashed]
	tp_split_60_11 -> expert_compute_60_0_11
	tp_split_60_11 -> expert_compute_60_1_11
	expert_compute_60_0_11 -> tp_allreduce_60_11
	expert_compute_60_1_11 -> tp_allreduce_60_11
	tp_allreduce_60_11 -> expert_60_11
	expert_60_11 -> expert_agg_11 [label="Expert 60 output"]
	moe_gate_11 -> tp_split_61_11 [label="Gate selection 61" style=dashed]
	tp_split_61_11 -> expert_compute_61_0_11
	tp_split_61_11 -> expert_compute_61_1_11
	expert_compute_61_0_11 -> tp_allreduce_61_11
	expert_compute_61_1_11 -> tp_allreduce_61_11
	tp_allreduce_61_11 -> expert_61_11
	expert_61_11 -> expert_agg_11 [label="Expert 61 output"]
	moe_gate_11 -> tp_split_62_11 [label="Gate selection 62" style=dashed]
	tp_split_62_11 -> expert_compute_62_0_11
	tp_split_62_11 -> expert_compute_62_1_11
	expert_compute_62_0_11 -> tp_allreduce_62_11
	expert_compute_62_1_11 -> tp_allreduce_62_11
	tp_allreduce_62_11 -> expert_62_11
	expert_62_11 -> expert_agg_11 [label="Expert 62 output"]
	moe_gate_11 -> tp_split_63_11 [label="Gate selection 63" style=dashed]
	tp_split_63_11 -> expert_compute_63_0_11
	tp_split_63_11 -> expert_compute_63_1_11
	expert_compute_63_0_11 -> tp_allreduce_63_11
	expert_compute_63_1_11 -> tp_allreduce_63_11
	tp_allreduce_63_11 -> expert_63_11
	expert_63_11 -> expert_agg_11 [label="Expert 63 output"]
	expert_agg_11 -> layer_norm_11
	layer_norm_11 -> attn_norm_12
	attn_norm_12 -> attn_q_12
	attn_norm_12 -> attn_k_12
	attn_norm_12 -> attn_v_12
	attn_q_12 -> attn_score_12
	attn_k_12 -> attn_score_12
	attn_v_12 -> attn_out_12
	attn_score_12 -> attn_out_12
	attn_out_12 -> moe_gate_12
	moe_gate_12 -> tp_split_0_12 [label="Gate selection 0" style=dashed]
	tp_split_0_12 -> expert_compute_0_0_12
	tp_split_0_12 -> expert_compute_0_1_12
	expert_compute_0_0_12 -> tp_allreduce_0_12
	expert_compute_0_1_12 -> tp_allreduce_0_12
	tp_allreduce_0_12 -> expert_0_12
	expert_0_12 -> expert_agg_12 [label="Expert 0 output"]
	moe_gate_12 -> tp_split_1_12 [label="Gate selection 1" style=dashed]
	tp_split_1_12 -> expert_compute_1_0_12
	tp_split_1_12 -> expert_compute_1_1_12
	expert_compute_1_0_12 -> tp_allreduce_1_12
	expert_compute_1_1_12 -> tp_allreduce_1_12
	tp_allreduce_1_12 -> expert_1_12
	expert_1_12 -> expert_agg_12 [label="Expert 1 output"]
	moe_gate_12 -> tp_split_2_12 [label="Gate selection 2" style=dashed]
	tp_split_2_12 -> expert_compute_2_0_12
	tp_split_2_12 -> expert_compute_2_1_12
	expert_compute_2_0_12 -> tp_allreduce_2_12
	expert_compute_2_1_12 -> tp_allreduce_2_12
	tp_allreduce_2_12 -> expert_2_12
	expert_2_12 -> expert_agg_12 [label="Expert 2 output"]
	moe_gate_12 -> tp_split_3_12 [label="Gate selection 3" style=dashed]
	tp_split_3_12 -> expert_compute_3_0_12
	tp_split_3_12 -> expert_compute_3_1_12
	expert_compute_3_0_12 -> tp_allreduce_3_12
	expert_compute_3_1_12 -> tp_allreduce_3_12
	tp_allreduce_3_12 -> expert_3_12
	expert_3_12 -> expert_agg_12 [label="Expert 3 output"]
	moe_gate_12 -> tp_split_4_12 [label="Gate selection 4" style=dashed]
	tp_split_4_12 -> expert_compute_4_0_12
	tp_split_4_12 -> expert_compute_4_1_12
	expert_compute_4_0_12 -> tp_allreduce_4_12
	expert_compute_4_1_12 -> tp_allreduce_4_12
	tp_allreduce_4_12 -> expert_4_12
	expert_4_12 -> expert_agg_12 [label="Expert 4 output"]
	moe_gate_12 -> tp_split_5_12 [label="Gate selection 5" style=dashed]
	tp_split_5_12 -> expert_compute_5_0_12
	tp_split_5_12 -> expert_compute_5_1_12
	expert_compute_5_0_12 -> tp_allreduce_5_12
	expert_compute_5_1_12 -> tp_allreduce_5_12
	tp_allreduce_5_12 -> expert_5_12
	expert_5_12 -> expert_agg_12 [label="Expert 5 output"]
	moe_gate_12 -> tp_split_6_12 [label="Gate selection 6" style=dashed]
	tp_split_6_12 -> expert_compute_6_0_12
	tp_split_6_12 -> expert_compute_6_1_12
	expert_compute_6_0_12 -> tp_allreduce_6_12
	expert_compute_6_1_12 -> tp_allreduce_6_12
	tp_allreduce_6_12 -> expert_6_12
	expert_6_12 -> expert_agg_12 [label="Expert 6 output"]
	moe_gate_12 -> tp_split_7_12 [label="Gate selection 7" style=dashed]
	tp_split_7_12 -> expert_compute_7_0_12
	tp_split_7_12 -> expert_compute_7_1_12
	expert_compute_7_0_12 -> tp_allreduce_7_12
	expert_compute_7_1_12 -> tp_allreduce_7_12
	tp_allreduce_7_12 -> expert_7_12
	expert_7_12 -> expert_agg_12 [label="Expert 7 output"]
	moe_gate_12 -> tp_split_8_12 [label="Gate selection 8" style=dashed]
	tp_split_8_12 -> expert_compute_8_0_12
	tp_split_8_12 -> expert_compute_8_1_12
	expert_compute_8_0_12 -> tp_allreduce_8_12
	expert_compute_8_1_12 -> tp_allreduce_8_12
	tp_allreduce_8_12 -> expert_8_12
	expert_8_12 -> expert_agg_12 [label="Expert 8 output"]
	moe_gate_12 -> tp_split_9_12 [label="Gate selection 9" style=dashed]
	tp_split_9_12 -> expert_compute_9_0_12
	tp_split_9_12 -> expert_compute_9_1_12
	expert_compute_9_0_12 -> tp_allreduce_9_12
	expert_compute_9_1_12 -> tp_allreduce_9_12
	tp_allreduce_9_12 -> expert_9_12
	expert_9_12 -> expert_agg_12 [label="Expert 9 output"]
	moe_gate_12 -> tp_split_10_12 [label="Gate selection 10" style=dashed]
	tp_split_10_12 -> expert_compute_10_0_12
	tp_split_10_12 -> expert_compute_10_1_12
	expert_compute_10_0_12 -> tp_allreduce_10_12
	expert_compute_10_1_12 -> tp_allreduce_10_12
	tp_allreduce_10_12 -> expert_10_12
	expert_10_12 -> expert_agg_12 [label="Expert 10 output"]
	moe_gate_12 -> tp_split_11_12 [label="Gate selection 11" style=dashed]
	tp_split_11_12 -> expert_compute_11_0_12
	tp_split_11_12 -> expert_compute_11_1_12
	expert_compute_11_0_12 -> tp_allreduce_11_12
	expert_compute_11_1_12 -> tp_allreduce_11_12
	tp_allreduce_11_12 -> expert_11_12
	expert_11_12 -> expert_agg_12 [label="Expert 11 output"]
	moe_gate_12 -> tp_split_12_12 [label="Gate selection 12" style=dashed]
	tp_split_12_12 -> expert_compute_12_0_12
	tp_split_12_12 -> expert_compute_12_1_12
	expert_compute_12_0_12 -> tp_allreduce_12_12
	expert_compute_12_1_12 -> tp_allreduce_12_12
	tp_allreduce_12_12 -> expert_12_12
	expert_12_12 -> expert_agg_12 [label="Expert 12 output"]
	moe_gate_12 -> tp_split_13_12 [label="Gate selection 13" style=dashed]
	tp_split_13_12 -> expert_compute_13_0_12
	tp_split_13_12 -> expert_compute_13_1_12
	expert_compute_13_0_12 -> tp_allreduce_13_12
	expert_compute_13_1_12 -> tp_allreduce_13_12
	tp_allreduce_13_12 -> expert_13_12
	expert_13_12 -> expert_agg_12 [label="Expert 13 output"]
	moe_gate_12 -> tp_split_14_12 [label="Gate selection 14" style=dashed]
	tp_split_14_12 -> expert_compute_14_0_12
	tp_split_14_12 -> expert_compute_14_1_12
	expert_compute_14_0_12 -> tp_allreduce_14_12
	expert_compute_14_1_12 -> tp_allreduce_14_12
	tp_allreduce_14_12 -> expert_14_12
	expert_14_12 -> expert_agg_12 [label="Expert 14 output"]
	moe_gate_12 -> tp_split_15_12 [label="Gate selection 15" style=dashed]
	tp_split_15_12 -> expert_compute_15_0_12
	tp_split_15_12 -> expert_compute_15_1_12
	expert_compute_15_0_12 -> tp_allreduce_15_12
	expert_compute_15_1_12 -> tp_allreduce_15_12
	tp_allreduce_15_12 -> expert_15_12
	expert_15_12 -> expert_agg_12 [label="Expert 15 output"]
	moe_gate_12 -> tp_split_16_12 [label="Gate selection 16" style=dashed]
	tp_split_16_12 -> expert_compute_16_0_12
	tp_split_16_12 -> expert_compute_16_1_12
	expert_compute_16_0_12 -> tp_allreduce_16_12
	expert_compute_16_1_12 -> tp_allreduce_16_12
	tp_allreduce_16_12 -> expert_16_12
	expert_16_12 -> expert_agg_12 [label="Expert 16 output"]
	moe_gate_12 -> tp_split_17_12 [label="Gate selection 17" style=dashed]
	tp_split_17_12 -> expert_compute_17_0_12
	tp_split_17_12 -> expert_compute_17_1_12
	expert_compute_17_0_12 -> tp_allreduce_17_12
	expert_compute_17_1_12 -> tp_allreduce_17_12
	tp_allreduce_17_12 -> expert_17_12
	expert_17_12 -> expert_agg_12 [label="Expert 17 output"]
	moe_gate_12 -> tp_split_18_12 [label="Gate selection 18" style=dashed]
	tp_split_18_12 -> expert_compute_18_0_12
	tp_split_18_12 -> expert_compute_18_1_12
	expert_compute_18_0_12 -> tp_allreduce_18_12
	expert_compute_18_1_12 -> tp_allreduce_18_12
	tp_allreduce_18_12 -> expert_18_12
	expert_18_12 -> expert_agg_12 [label="Expert 18 output"]
	moe_gate_12 -> tp_split_19_12 [label="Gate selection 19" style=dashed]
	tp_split_19_12 -> expert_compute_19_0_12
	tp_split_19_12 -> expert_compute_19_1_12
	expert_compute_19_0_12 -> tp_allreduce_19_12
	expert_compute_19_1_12 -> tp_allreduce_19_12
	tp_allreduce_19_12 -> expert_19_12
	expert_19_12 -> expert_agg_12 [label="Expert 19 output"]
	moe_gate_12 -> tp_split_20_12 [label="Gate selection 20" style=dashed]
	tp_split_20_12 -> expert_compute_20_0_12
	tp_split_20_12 -> expert_compute_20_1_12
	expert_compute_20_0_12 -> tp_allreduce_20_12
	expert_compute_20_1_12 -> tp_allreduce_20_12
	tp_allreduce_20_12 -> expert_20_12
	expert_20_12 -> expert_agg_12 [label="Expert 20 output"]
	moe_gate_12 -> tp_split_21_12 [label="Gate selection 21" style=dashed]
	tp_split_21_12 -> expert_compute_21_0_12
	tp_split_21_12 -> expert_compute_21_1_12
	expert_compute_21_0_12 -> tp_allreduce_21_12
	expert_compute_21_1_12 -> tp_allreduce_21_12
	tp_allreduce_21_12 -> expert_21_12
	expert_21_12 -> expert_agg_12 [label="Expert 21 output"]
	moe_gate_12 -> tp_split_22_12 [label="Gate selection 22" style=dashed]
	tp_split_22_12 -> expert_compute_22_0_12
	tp_split_22_12 -> expert_compute_22_1_12
	expert_compute_22_0_12 -> tp_allreduce_22_12
	expert_compute_22_1_12 -> tp_allreduce_22_12
	tp_allreduce_22_12 -> expert_22_12
	expert_22_12 -> expert_agg_12 [label="Expert 22 output"]
	moe_gate_12 -> tp_split_23_12 [label="Gate selection 23" style=dashed]
	tp_split_23_12 -> expert_compute_23_0_12
	tp_split_23_12 -> expert_compute_23_1_12
	expert_compute_23_0_12 -> tp_allreduce_23_12
	expert_compute_23_1_12 -> tp_allreduce_23_12
	tp_allreduce_23_12 -> expert_23_12
	expert_23_12 -> expert_agg_12 [label="Expert 23 output"]
	moe_gate_12 -> tp_split_24_12 [label="Gate selection 24" style=dashed]
	tp_split_24_12 -> expert_compute_24_0_12
	tp_split_24_12 -> expert_compute_24_1_12
	expert_compute_24_0_12 -> tp_allreduce_24_12
	expert_compute_24_1_12 -> tp_allreduce_24_12
	tp_allreduce_24_12 -> expert_24_12
	expert_24_12 -> expert_agg_12 [label="Expert 24 output"]
	moe_gate_12 -> tp_split_25_12 [label="Gate selection 25" style=dashed]
	tp_split_25_12 -> expert_compute_25_0_12
	tp_split_25_12 -> expert_compute_25_1_12
	expert_compute_25_0_12 -> tp_allreduce_25_12
	expert_compute_25_1_12 -> tp_allreduce_25_12
	tp_allreduce_25_12 -> expert_25_12
	expert_25_12 -> expert_agg_12 [label="Expert 25 output"]
	moe_gate_12 -> tp_split_26_12 [label="Gate selection 26" style=dashed]
	tp_split_26_12 -> expert_compute_26_0_12
	tp_split_26_12 -> expert_compute_26_1_12
	expert_compute_26_0_12 -> tp_allreduce_26_12
	expert_compute_26_1_12 -> tp_allreduce_26_12
	tp_allreduce_26_12 -> expert_26_12
	expert_26_12 -> expert_agg_12 [label="Expert 26 output"]
	moe_gate_12 -> tp_split_27_12 [label="Gate selection 27" style=dashed]
	tp_split_27_12 -> expert_compute_27_0_12
	tp_split_27_12 -> expert_compute_27_1_12
	expert_compute_27_0_12 -> tp_allreduce_27_12
	expert_compute_27_1_12 -> tp_allreduce_27_12
	tp_allreduce_27_12 -> expert_27_12
	expert_27_12 -> expert_agg_12 [label="Expert 27 output"]
	moe_gate_12 -> tp_split_28_12 [label="Gate selection 28" style=dashed]
	tp_split_28_12 -> expert_compute_28_0_12
	tp_split_28_12 -> expert_compute_28_1_12
	expert_compute_28_0_12 -> tp_allreduce_28_12
	expert_compute_28_1_12 -> tp_allreduce_28_12
	tp_allreduce_28_12 -> expert_28_12
	expert_28_12 -> expert_agg_12 [label="Expert 28 output"]
	moe_gate_12 -> tp_split_29_12 [label="Gate selection 29" style=dashed]
	tp_split_29_12 -> expert_compute_29_0_12
	tp_split_29_12 -> expert_compute_29_1_12
	expert_compute_29_0_12 -> tp_allreduce_29_12
	expert_compute_29_1_12 -> tp_allreduce_29_12
	tp_allreduce_29_12 -> expert_29_12
	expert_29_12 -> expert_agg_12 [label="Expert 29 output"]
	moe_gate_12 -> tp_split_30_12 [label="Gate selection 30" style=dashed]
	tp_split_30_12 -> expert_compute_30_0_12
	tp_split_30_12 -> expert_compute_30_1_12
	expert_compute_30_0_12 -> tp_allreduce_30_12
	expert_compute_30_1_12 -> tp_allreduce_30_12
	tp_allreduce_30_12 -> expert_30_12
	expert_30_12 -> expert_agg_12 [label="Expert 30 output"]
	moe_gate_12 -> tp_split_31_12 [label="Gate selection 31" style=dashed]
	tp_split_31_12 -> expert_compute_31_0_12
	tp_split_31_12 -> expert_compute_31_1_12
	expert_compute_31_0_12 -> tp_allreduce_31_12
	expert_compute_31_1_12 -> tp_allreduce_31_12
	tp_allreduce_31_12 -> expert_31_12
	expert_31_12 -> expert_agg_12 [label="Expert 31 output"]
	moe_gate_12 -> tp_split_32_12 [label="Gate selection 32" style=dashed]
	tp_split_32_12 -> expert_compute_32_0_12
	tp_split_32_12 -> expert_compute_32_1_12
	expert_compute_32_0_12 -> tp_allreduce_32_12
	expert_compute_32_1_12 -> tp_allreduce_32_12
	tp_allreduce_32_12 -> expert_32_12
	expert_32_12 -> expert_agg_12 [label="Expert 32 output"]
	moe_gate_12 -> tp_split_33_12 [label="Gate selection 33" style=dashed]
	tp_split_33_12 -> expert_compute_33_0_12
	tp_split_33_12 -> expert_compute_33_1_12
	expert_compute_33_0_12 -> tp_allreduce_33_12
	expert_compute_33_1_12 -> tp_allreduce_33_12
	tp_allreduce_33_12 -> expert_33_12
	expert_33_12 -> expert_agg_12 [label="Expert 33 output"]
	moe_gate_12 -> tp_split_34_12 [label="Gate selection 34" style=dashed]
	tp_split_34_12 -> expert_compute_34_0_12
	tp_split_34_12 -> expert_compute_34_1_12
	expert_compute_34_0_12 -> tp_allreduce_34_12
	expert_compute_34_1_12 -> tp_allreduce_34_12
	tp_allreduce_34_12 -> expert_34_12
	expert_34_12 -> expert_agg_12 [label="Expert 34 output"]
	moe_gate_12 -> tp_split_35_12 [label="Gate selection 35" style=dashed]
	tp_split_35_12 -> expert_compute_35_0_12
	tp_split_35_12 -> expert_compute_35_1_12
	expert_compute_35_0_12 -> tp_allreduce_35_12
	expert_compute_35_1_12 -> tp_allreduce_35_12
	tp_allreduce_35_12 -> expert_35_12
	expert_35_12 -> expert_agg_12 [label="Expert 35 output"]
	moe_gate_12 -> tp_split_36_12 [label="Gate selection 36" style=dashed]
	tp_split_36_12 -> expert_compute_36_0_12
	tp_split_36_12 -> expert_compute_36_1_12
	expert_compute_36_0_12 -> tp_allreduce_36_12
	expert_compute_36_1_12 -> tp_allreduce_36_12
	tp_allreduce_36_12 -> expert_36_12
	expert_36_12 -> expert_agg_12 [label="Expert 36 output"]
	moe_gate_12 -> tp_split_37_12 [label="Gate selection 37" style=dashed]
	tp_split_37_12 -> expert_compute_37_0_12
	tp_split_37_12 -> expert_compute_37_1_12
	expert_compute_37_0_12 -> tp_allreduce_37_12
	expert_compute_37_1_12 -> tp_allreduce_37_12
	tp_allreduce_37_12 -> expert_37_12
	expert_37_12 -> expert_agg_12 [label="Expert 37 output"]
	moe_gate_12 -> tp_split_38_12 [label="Gate selection 38" style=dashed]
	tp_split_38_12 -> expert_compute_38_0_12
	tp_split_38_12 -> expert_compute_38_1_12
	expert_compute_38_0_12 -> tp_allreduce_38_12
	expert_compute_38_1_12 -> tp_allreduce_38_12
	tp_allreduce_38_12 -> expert_38_12
	expert_38_12 -> expert_agg_12 [label="Expert 38 output"]
	moe_gate_12 -> tp_split_39_12 [label="Gate selection 39" style=dashed]
	tp_split_39_12 -> expert_compute_39_0_12
	tp_split_39_12 -> expert_compute_39_1_12
	expert_compute_39_0_12 -> tp_allreduce_39_12
	expert_compute_39_1_12 -> tp_allreduce_39_12
	tp_allreduce_39_12 -> expert_39_12
	expert_39_12 -> expert_agg_12 [label="Expert 39 output"]
	moe_gate_12 -> tp_split_40_12 [label="Gate selection 40" style=dashed]
	tp_split_40_12 -> expert_compute_40_0_12
	tp_split_40_12 -> expert_compute_40_1_12
	expert_compute_40_0_12 -> tp_allreduce_40_12
	expert_compute_40_1_12 -> tp_allreduce_40_12
	tp_allreduce_40_12 -> expert_40_12
	expert_40_12 -> expert_agg_12 [label="Expert 40 output"]
	moe_gate_12 -> tp_split_41_12 [label="Gate selection 41" style=dashed]
	tp_split_41_12 -> expert_compute_41_0_12
	tp_split_41_12 -> expert_compute_41_1_12
	expert_compute_41_0_12 -> tp_allreduce_41_12
	expert_compute_41_1_12 -> tp_allreduce_41_12
	tp_allreduce_41_12 -> expert_41_12
	expert_41_12 -> expert_agg_12 [label="Expert 41 output"]
	moe_gate_12 -> tp_split_42_12 [label="Gate selection 42" style=dashed]
	tp_split_42_12 -> expert_compute_42_0_12
	tp_split_42_12 -> expert_compute_42_1_12
	expert_compute_42_0_12 -> tp_allreduce_42_12
	expert_compute_42_1_12 -> tp_allreduce_42_12
	tp_allreduce_42_12 -> expert_42_12
	expert_42_12 -> expert_agg_12 [label="Expert 42 output"]
	moe_gate_12 -> tp_split_43_12 [label="Gate selection 43" style=dashed]
	tp_split_43_12 -> expert_compute_43_0_12
	tp_split_43_12 -> expert_compute_43_1_12
	expert_compute_43_0_12 -> tp_allreduce_43_12
	expert_compute_43_1_12 -> tp_allreduce_43_12
	tp_allreduce_43_12 -> expert_43_12
	expert_43_12 -> expert_agg_12 [label="Expert 43 output"]
	moe_gate_12 -> tp_split_44_12 [label="Gate selection 44" style=dashed]
	tp_split_44_12 -> expert_compute_44_0_12
	tp_split_44_12 -> expert_compute_44_1_12
	expert_compute_44_0_12 -> tp_allreduce_44_12
	expert_compute_44_1_12 -> tp_allreduce_44_12
	tp_allreduce_44_12 -> expert_44_12
	expert_44_12 -> expert_agg_12 [label="Expert 44 output"]
	moe_gate_12 -> tp_split_45_12 [label="Gate selection 45" style=dashed]
	tp_split_45_12 -> expert_compute_45_0_12
	tp_split_45_12 -> expert_compute_45_1_12
	expert_compute_45_0_12 -> tp_allreduce_45_12
	expert_compute_45_1_12 -> tp_allreduce_45_12
	tp_allreduce_45_12 -> expert_45_12
	expert_45_12 -> expert_agg_12 [label="Expert 45 output"]
	moe_gate_12 -> tp_split_46_12 [label="Gate selection 46" style=dashed]
	tp_split_46_12 -> expert_compute_46_0_12
	tp_split_46_12 -> expert_compute_46_1_12
	expert_compute_46_0_12 -> tp_allreduce_46_12
	expert_compute_46_1_12 -> tp_allreduce_46_12
	tp_allreduce_46_12 -> expert_46_12
	expert_46_12 -> expert_agg_12 [label="Expert 46 output"]
	moe_gate_12 -> tp_split_47_12 [label="Gate selection 47" style=dashed]
	tp_split_47_12 -> expert_compute_47_0_12
	tp_split_47_12 -> expert_compute_47_1_12
	expert_compute_47_0_12 -> tp_allreduce_47_12
	expert_compute_47_1_12 -> tp_allreduce_47_12
	tp_allreduce_47_12 -> expert_47_12
	expert_47_12 -> expert_agg_12 [label="Expert 47 output"]
	moe_gate_12 -> tp_split_48_12 [label="Gate selection 48" style=dashed]
	tp_split_48_12 -> expert_compute_48_0_12
	tp_split_48_12 -> expert_compute_48_1_12
	expert_compute_48_0_12 -> tp_allreduce_48_12
	expert_compute_48_1_12 -> tp_allreduce_48_12
	tp_allreduce_48_12 -> expert_48_12
	expert_48_12 -> expert_agg_12 [label="Expert 48 output"]
	moe_gate_12 -> tp_split_49_12 [label="Gate selection 49" style=dashed]
	tp_split_49_12 -> expert_compute_49_0_12
	tp_split_49_12 -> expert_compute_49_1_12
	expert_compute_49_0_12 -> tp_allreduce_49_12
	expert_compute_49_1_12 -> tp_allreduce_49_12
	tp_allreduce_49_12 -> expert_49_12
	expert_49_12 -> expert_agg_12 [label="Expert 49 output"]
	moe_gate_12 -> tp_split_50_12 [label="Gate selection 50" style=dashed]
	tp_split_50_12 -> expert_compute_50_0_12
	tp_split_50_12 -> expert_compute_50_1_12
	expert_compute_50_0_12 -> tp_allreduce_50_12
	expert_compute_50_1_12 -> tp_allreduce_50_12
	tp_allreduce_50_12 -> expert_50_12
	expert_50_12 -> expert_agg_12 [label="Expert 50 output"]
	moe_gate_12 -> tp_split_51_12 [label="Gate selection 51" style=dashed]
	tp_split_51_12 -> expert_compute_51_0_12
	tp_split_51_12 -> expert_compute_51_1_12
	expert_compute_51_0_12 -> tp_allreduce_51_12
	expert_compute_51_1_12 -> tp_allreduce_51_12
	tp_allreduce_51_12 -> expert_51_12
	expert_51_12 -> expert_agg_12 [label="Expert 51 output"]
	moe_gate_12 -> tp_split_52_12 [label="Gate selection 52" style=dashed]
	tp_split_52_12 -> expert_compute_52_0_12
	tp_split_52_12 -> expert_compute_52_1_12
	expert_compute_52_0_12 -> tp_allreduce_52_12
	expert_compute_52_1_12 -> tp_allreduce_52_12
	tp_allreduce_52_12 -> expert_52_12
	expert_52_12 -> expert_agg_12 [label="Expert 52 output"]
	moe_gate_12 -> tp_split_53_12 [label="Gate selection 53" style=dashed]
	tp_split_53_12 -> expert_compute_53_0_12
	tp_split_53_12 -> expert_compute_53_1_12
	expert_compute_53_0_12 -> tp_allreduce_53_12
	expert_compute_53_1_12 -> tp_allreduce_53_12
	tp_allreduce_53_12 -> expert_53_12
	expert_53_12 -> expert_agg_12 [label="Expert 53 output"]
	moe_gate_12 -> tp_split_54_12 [label="Gate selection 54" style=dashed]
	tp_split_54_12 -> expert_compute_54_0_12
	tp_split_54_12 -> expert_compute_54_1_12
	expert_compute_54_0_12 -> tp_allreduce_54_12
	expert_compute_54_1_12 -> tp_allreduce_54_12
	tp_allreduce_54_12 -> expert_54_12
	expert_54_12 -> expert_agg_12 [label="Expert 54 output"]
	moe_gate_12 -> tp_split_55_12 [label="Gate selection 55" style=dashed]
	tp_split_55_12 -> expert_compute_55_0_12
	tp_split_55_12 -> expert_compute_55_1_12
	expert_compute_55_0_12 -> tp_allreduce_55_12
	expert_compute_55_1_12 -> tp_allreduce_55_12
	tp_allreduce_55_12 -> expert_55_12
	expert_55_12 -> expert_agg_12 [label="Expert 55 output"]
	moe_gate_12 -> tp_split_56_12 [label="Gate selection 56" style=dashed]
	tp_split_56_12 -> expert_compute_56_0_12
	tp_split_56_12 -> expert_compute_56_1_12
	expert_compute_56_0_12 -> tp_allreduce_56_12
	expert_compute_56_1_12 -> tp_allreduce_56_12
	tp_allreduce_56_12 -> expert_56_12
	expert_56_12 -> expert_agg_12 [label="Expert 56 output"]
	moe_gate_12 -> tp_split_57_12 [label="Gate selection 57" style=dashed]
	tp_split_57_12 -> expert_compute_57_0_12
	tp_split_57_12 -> expert_compute_57_1_12
	expert_compute_57_0_12 -> tp_allreduce_57_12
	expert_compute_57_1_12 -> tp_allreduce_57_12
	tp_allreduce_57_12 -> expert_57_12
	expert_57_12 -> expert_agg_12 [label="Expert 57 output"]
	moe_gate_12 -> tp_split_58_12 [label="Gate selection 58" style=dashed]
	tp_split_58_12 -> expert_compute_58_0_12
	tp_split_58_12 -> expert_compute_58_1_12
	expert_compute_58_0_12 -> tp_allreduce_58_12
	expert_compute_58_1_12 -> tp_allreduce_58_12
	tp_allreduce_58_12 -> expert_58_12
	expert_58_12 -> expert_agg_12 [label="Expert 58 output"]
	moe_gate_12 -> tp_split_59_12 [label="Gate selection 59" style=dashed]
	tp_split_59_12 -> expert_compute_59_0_12
	tp_split_59_12 -> expert_compute_59_1_12
	expert_compute_59_0_12 -> tp_allreduce_59_12
	expert_compute_59_1_12 -> tp_allreduce_59_12
	tp_allreduce_59_12 -> expert_59_12
	expert_59_12 -> expert_agg_12 [label="Expert 59 output"]
	moe_gate_12 -> tp_split_60_12 [label="Gate selection 60" style=dashed]
	tp_split_60_12 -> expert_compute_60_0_12
	tp_split_60_12 -> expert_compute_60_1_12
	expert_compute_60_0_12 -> tp_allreduce_60_12
	expert_compute_60_1_12 -> tp_allreduce_60_12
	tp_allreduce_60_12 -> expert_60_12
	expert_60_12 -> expert_agg_12 [label="Expert 60 output"]
	moe_gate_12 -> tp_split_61_12 [label="Gate selection 61" style=dashed]
	tp_split_61_12 -> expert_compute_61_0_12
	tp_split_61_12 -> expert_compute_61_1_12
	expert_compute_61_0_12 -> tp_allreduce_61_12
	expert_compute_61_1_12 -> tp_allreduce_61_12
	tp_allreduce_61_12 -> expert_61_12
	expert_61_12 -> expert_agg_12 [label="Expert 61 output"]
	moe_gate_12 -> tp_split_62_12 [label="Gate selection 62" style=dashed]
	tp_split_62_12 -> expert_compute_62_0_12
	tp_split_62_12 -> expert_compute_62_1_12
	expert_compute_62_0_12 -> tp_allreduce_62_12
	expert_compute_62_1_12 -> tp_allreduce_62_12
	tp_allreduce_62_12 -> expert_62_12
	expert_62_12 -> expert_agg_12 [label="Expert 62 output"]
	moe_gate_12 -> tp_split_63_12 [label="Gate selection 63" style=dashed]
	tp_split_63_12 -> expert_compute_63_0_12
	tp_split_63_12 -> expert_compute_63_1_12
	expert_compute_63_0_12 -> tp_allreduce_63_12
	expert_compute_63_1_12 -> tp_allreduce_63_12
	tp_allreduce_63_12 -> expert_63_12
	expert_63_12 -> expert_agg_12 [label="Expert 63 output"]
	expert_agg_12 -> layer_norm_12
	layer_norm_12 -> attn_norm_13
	attn_norm_13 -> attn_q_13
	attn_norm_13 -> attn_k_13
	attn_norm_13 -> attn_v_13
	attn_q_13 -> attn_score_13
	attn_k_13 -> attn_score_13
	attn_v_13 -> attn_out_13
	attn_score_13 -> attn_out_13
	attn_out_13 -> moe_gate_13
	moe_gate_13 -> tp_split_0_13 [label="Gate selection 0" style=dashed]
	tp_split_0_13 -> expert_compute_0_0_13
	tp_split_0_13 -> expert_compute_0_1_13
	expert_compute_0_0_13 -> tp_allreduce_0_13
	expert_compute_0_1_13 -> tp_allreduce_0_13
	tp_allreduce_0_13 -> expert_0_13
	expert_0_13 -> expert_agg_13 [label="Expert 0 output"]
	moe_gate_13 -> tp_split_1_13 [label="Gate selection 1" style=dashed]
	tp_split_1_13 -> expert_compute_1_0_13
	tp_split_1_13 -> expert_compute_1_1_13
	expert_compute_1_0_13 -> tp_allreduce_1_13
	expert_compute_1_1_13 -> tp_allreduce_1_13
	tp_allreduce_1_13 -> expert_1_13
	expert_1_13 -> expert_agg_13 [label="Expert 1 output"]
	moe_gate_13 -> tp_split_2_13 [label="Gate selection 2" style=dashed]
	tp_split_2_13 -> expert_compute_2_0_13
	tp_split_2_13 -> expert_compute_2_1_13
	expert_compute_2_0_13 -> tp_allreduce_2_13
	expert_compute_2_1_13 -> tp_allreduce_2_13
	tp_allreduce_2_13 -> expert_2_13
	expert_2_13 -> expert_agg_13 [label="Expert 2 output"]
	moe_gate_13 -> tp_split_3_13 [label="Gate selection 3" style=dashed]
	tp_split_3_13 -> expert_compute_3_0_13
	tp_split_3_13 -> expert_compute_3_1_13
	expert_compute_3_0_13 -> tp_allreduce_3_13
	expert_compute_3_1_13 -> tp_allreduce_3_13
	tp_allreduce_3_13 -> expert_3_13
	expert_3_13 -> expert_agg_13 [label="Expert 3 output"]
	moe_gate_13 -> tp_split_4_13 [label="Gate selection 4" style=dashed]
	tp_split_4_13 -> expert_compute_4_0_13
	tp_split_4_13 -> expert_compute_4_1_13
	expert_compute_4_0_13 -> tp_allreduce_4_13
	expert_compute_4_1_13 -> tp_allreduce_4_13
	tp_allreduce_4_13 -> expert_4_13
	expert_4_13 -> expert_agg_13 [label="Expert 4 output"]
	moe_gate_13 -> tp_split_5_13 [label="Gate selection 5" style=dashed]
	tp_split_5_13 -> expert_compute_5_0_13
	tp_split_5_13 -> expert_compute_5_1_13
	expert_compute_5_0_13 -> tp_allreduce_5_13
	expert_compute_5_1_13 -> tp_allreduce_5_13
	tp_allreduce_5_13 -> expert_5_13
	expert_5_13 -> expert_agg_13 [label="Expert 5 output"]
	moe_gate_13 -> tp_split_6_13 [label="Gate selection 6" style=dashed]
	tp_split_6_13 -> expert_compute_6_0_13
	tp_split_6_13 -> expert_compute_6_1_13
	expert_compute_6_0_13 -> tp_allreduce_6_13
	expert_compute_6_1_13 -> tp_allreduce_6_13
	tp_allreduce_6_13 -> expert_6_13
	expert_6_13 -> expert_agg_13 [label="Expert 6 output"]
	moe_gate_13 -> tp_split_7_13 [label="Gate selection 7" style=dashed]
	tp_split_7_13 -> expert_compute_7_0_13
	tp_split_7_13 -> expert_compute_7_1_13
	expert_compute_7_0_13 -> tp_allreduce_7_13
	expert_compute_7_1_13 -> tp_allreduce_7_13
	tp_allreduce_7_13 -> expert_7_13
	expert_7_13 -> expert_agg_13 [label="Expert 7 output"]
	moe_gate_13 -> tp_split_8_13 [label="Gate selection 8" style=dashed]
	tp_split_8_13 -> expert_compute_8_0_13
	tp_split_8_13 -> expert_compute_8_1_13
	expert_compute_8_0_13 -> tp_allreduce_8_13
	expert_compute_8_1_13 -> tp_allreduce_8_13
	tp_allreduce_8_13 -> expert_8_13
	expert_8_13 -> expert_agg_13 [label="Expert 8 output"]
	moe_gate_13 -> tp_split_9_13 [label="Gate selection 9" style=dashed]
	tp_split_9_13 -> expert_compute_9_0_13
	tp_split_9_13 -> expert_compute_9_1_13
	expert_compute_9_0_13 -> tp_allreduce_9_13
	expert_compute_9_1_13 -> tp_allreduce_9_13
	tp_allreduce_9_13 -> expert_9_13
	expert_9_13 -> expert_agg_13 [label="Expert 9 output"]
	moe_gate_13 -> tp_split_10_13 [label="Gate selection 10" style=dashed]
	tp_split_10_13 -> expert_compute_10_0_13
	tp_split_10_13 -> expert_compute_10_1_13
	expert_compute_10_0_13 -> tp_allreduce_10_13
	expert_compute_10_1_13 -> tp_allreduce_10_13
	tp_allreduce_10_13 -> expert_10_13
	expert_10_13 -> expert_agg_13 [label="Expert 10 output"]
	moe_gate_13 -> tp_split_11_13 [label="Gate selection 11" style=dashed]
	tp_split_11_13 -> expert_compute_11_0_13
	tp_split_11_13 -> expert_compute_11_1_13
	expert_compute_11_0_13 -> tp_allreduce_11_13
	expert_compute_11_1_13 -> tp_allreduce_11_13
	tp_allreduce_11_13 -> expert_11_13
	expert_11_13 -> expert_agg_13 [label="Expert 11 output"]
	moe_gate_13 -> tp_split_12_13 [label="Gate selection 12" style=dashed]
	tp_split_12_13 -> expert_compute_12_0_13
	tp_split_12_13 -> expert_compute_12_1_13
	expert_compute_12_0_13 -> tp_allreduce_12_13
	expert_compute_12_1_13 -> tp_allreduce_12_13
	tp_allreduce_12_13 -> expert_12_13
	expert_12_13 -> expert_agg_13 [label="Expert 12 output"]
	moe_gate_13 -> tp_split_13_13 [label="Gate selection 13" style=dashed]
	tp_split_13_13 -> expert_compute_13_0_13
	tp_split_13_13 -> expert_compute_13_1_13
	expert_compute_13_0_13 -> tp_allreduce_13_13
	expert_compute_13_1_13 -> tp_allreduce_13_13
	tp_allreduce_13_13 -> expert_13_13
	expert_13_13 -> expert_agg_13 [label="Expert 13 output"]
	moe_gate_13 -> tp_split_14_13 [label="Gate selection 14" style=dashed]
	tp_split_14_13 -> expert_compute_14_0_13
	tp_split_14_13 -> expert_compute_14_1_13
	expert_compute_14_0_13 -> tp_allreduce_14_13
	expert_compute_14_1_13 -> tp_allreduce_14_13
	tp_allreduce_14_13 -> expert_14_13
	expert_14_13 -> expert_agg_13 [label="Expert 14 output"]
	moe_gate_13 -> tp_split_15_13 [label="Gate selection 15" style=dashed]
	tp_split_15_13 -> expert_compute_15_0_13
	tp_split_15_13 -> expert_compute_15_1_13
	expert_compute_15_0_13 -> tp_allreduce_15_13
	expert_compute_15_1_13 -> tp_allreduce_15_13
	tp_allreduce_15_13 -> expert_15_13
	expert_15_13 -> expert_agg_13 [label="Expert 15 output"]
	moe_gate_13 -> tp_split_16_13 [label="Gate selection 16" style=dashed]
	tp_split_16_13 -> expert_compute_16_0_13
	tp_split_16_13 -> expert_compute_16_1_13
	expert_compute_16_0_13 -> tp_allreduce_16_13
	expert_compute_16_1_13 -> tp_allreduce_16_13
	tp_allreduce_16_13 -> expert_16_13
	expert_16_13 -> expert_agg_13 [label="Expert 16 output"]
	moe_gate_13 -> tp_split_17_13 [label="Gate selection 17" style=dashed]
	tp_split_17_13 -> expert_compute_17_0_13
	tp_split_17_13 -> expert_compute_17_1_13
	expert_compute_17_0_13 -> tp_allreduce_17_13
	expert_compute_17_1_13 -> tp_allreduce_17_13
	tp_allreduce_17_13 -> expert_17_13
	expert_17_13 -> expert_agg_13 [label="Expert 17 output"]
	moe_gate_13 -> tp_split_18_13 [label="Gate selection 18" style=dashed]
	tp_split_18_13 -> expert_compute_18_0_13
	tp_split_18_13 -> expert_compute_18_1_13
	expert_compute_18_0_13 -> tp_allreduce_18_13
	expert_compute_18_1_13 -> tp_allreduce_18_13
	tp_allreduce_18_13 -> expert_18_13
	expert_18_13 -> expert_agg_13 [label="Expert 18 output"]
	moe_gate_13 -> tp_split_19_13 [label="Gate selection 19" style=dashed]
	tp_split_19_13 -> expert_compute_19_0_13
	tp_split_19_13 -> expert_compute_19_1_13
	expert_compute_19_0_13 -> tp_allreduce_19_13
	expert_compute_19_1_13 -> tp_allreduce_19_13
	tp_allreduce_19_13 -> expert_19_13
	expert_19_13 -> expert_agg_13 [label="Expert 19 output"]
	moe_gate_13 -> tp_split_20_13 [label="Gate selection 20" style=dashed]
	tp_split_20_13 -> expert_compute_20_0_13
	tp_split_20_13 -> expert_compute_20_1_13
	expert_compute_20_0_13 -> tp_allreduce_20_13
	expert_compute_20_1_13 -> tp_allreduce_20_13
	tp_allreduce_20_13 -> expert_20_13
	expert_20_13 -> expert_agg_13 [label="Expert 20 output"]
	moe_gate_13 -> tp_split_21_13 [label="Gate selection 21" style=dashed]
	tp_split_21_13 -> expert_compute_21_0_13
	tp_split_21_13 -> expert_compute_21_1_13
	expert_compute_21_0_13 -> tp_allreduce_21_13
	expert_compute_21_1_13 -> tp_allreduce_21_13
	tp_allreduce_21_13 -> expert_21_13
	expert_21_13 -> expert_agg_13 [label="Expert 21 output"]
	moe_gate_13 -> tp_split_22_13 [label="Gate selection 22" style=dashed]
	tp_split_22_13 -> expert_compute_22_0_13
	tp_split_22_13 -> expert_compute_22_1_13
	expert_compute_22_0_13 -> tp_allreduce_22_13
	expert_compute_22_1_13 -> tp_allreduce_22_13
	tp_allreduce_22_13 -> expert_22_13
	expert_22_13 -> expert_agg_13 [label="Expert 22 output"]
	moe_gate_13 -> tp_split_23_13 [label="Gate selection 23" style=dashed]
	tp_split_23_13 -> expert_compute_23_0_13
	tp_split_23_13 -> expert_compute_23_1_13
	expert_compute_23_0_13 -> tp_allreduce_23_13
	expert_compute_23_1_13 -> tp_allreduce_23_13
	tp_allreduce_23_13 -> expert_23_13
	expert_23_13 -> expert_agg_13 [label="Expert 23 output"]
	moe_gate_13 -> tp_split_24_13 [label="Gate selection 24" style=dashed]
	tp_split_24_13 -> expert_compute_24_0_13
	tp_split_24_13 -> expert_compute_24_1_13
	expert_compute_24_0_13 -> tp_allreduce_24_13
	expert_compute_24_1_13 -> tp_allreduce_24_13
	tp_allreduce_24_13 -> expert_24_13
	expert_24_13 -> expert_agg_13 [label="Expert 24 output"]
	moe_gate_13 -> tp_split_25_13 [label="Gate selection 25" style=dashed]
	tp_split_25_13 -> expert_compute_25_0_13
	tp_split_25_13 -> expert_compute_25_1_13
	expert_compute_25_0_13 -> tp_allreduce_25_13
	expert_compute_25_1_13 -> tp_allreduce_25_13
	tp_allreduce_25_13 -> expert_25_13
	expert_25_13 -> expert_agg_13 [label="Expert 25 output"]
	moe_gate_13 -> tp_split_26_13 [label="Gate selection 26" style=dashed]
	tp_split_26_13 -> expert_compute_26_0_13
	tp_split_26_13 -> expert_compute_26_1_13
	expert_compute_26_0_13 -> tp_allreduce_26_13
	expert_compute_26_1_13 -> tp_allreduce_26_13
	tp_allreduce_26_13 -> expert_26_13
	expert_26_13 -> expert_agg_13 [label="Expert 26 output"]
	moe_gate_13 -> tp_split_27_13 [label="Gate selection 27" style=dashed]
	tp_split_27_13 -> expert_compute_27_0_13
	tp_split_27_13 -> expert_compute_27_1_13
	expert_compute_27_0_13 -> tp_allreduce_27_13
	expert_compute_27_1_13 -> tp_allreduce_27_13
	tp_allreduce_27_13 -> expert_27_13
	expert_27_13 -> expert_agg_13 [label="Expert 27 output"]
	moe_gate_13 -> tp_split_28_13 [label="Gate selection 28" style=dashed]
	tp_split_28_13 -> expert_compute_28_0_13
	tp_split_28_13 -> expert_compute_28_1_13
	expert_compute_28_0_13 -> tp_allreduce_28_13
	expert_compute_28_1_13 -> tp_allreduce_28_13
	tp_allreduce_28_13 -> expert_28_13
	expert_28_13 -> expert_agg_13 [label="Expert 28 output"]
	moe_gate_13 -> tp_split_29_13 [label="Gate selection 29" style=dashed]
	tp_split_29_13 -> expert_compute_29_0_13
	tp_split_29_13 -> expert_compute_29_1_13
	expert_compute_29_0_13 -> tp_allreduce_29_13
	expert_compute_29_1_13 -> tp_allreduce_29_13
	tp_allreduce_29_13 -> expert_29_13
	expert_29_13 -> expert_agg_13 [label="Expert 29 output"]
	moe_gate_13 -> tp_split_30_13 [label="Gate selection 30" style=dashed]
	tp_split_30_13 -> expert_compute_30_0_13
	tp_split_30_13 -> expert_compute_30_1_13
	expert_compute_30_0_13 -> tp_allreduce_30_13
	expert_compute_30_1_13 -> tp_allreduce_30_13
	tp_allreduce_30_13 -> expert_30_13
	expert_30_13 -> expert_agg_13 [label="Expert 30 output"]
	moe_gate_13 -> tp_split_31_13 [label="Gate selection 31" style=dashed]
	tp_split_31_13 -> expert_compute_31_0_13
	tp_split_31_13 -> expert_compute_31_1_13
	expert_compute_31_0_13 -> tp_allreduce_31_13
	expert_compute_31_1_13 -> tp_allreduce_31_13
	tp_allreduce_31_13 -> expert_31_13
	expert_31_13 -> expert_agg_13 [label="Expert 31 output"]
	moe_gate_13 -> tp_split_32_13 [label="Gate selection 32" style=dashed]
	tp_split_32_13 -> expert_compute_32_0_13
	tp_split_32_13 -> expert_compute_32_1_13
	expert_compute_32_0_13 -> tp_allreduce_32_13
	expert_compute_32_1_13 -> tp_allreduce_32_13
	tp_allreduce_32_13 -> expert_32_13
	expert_32_13 -> expert_agg_13 [label="Expert 32 output"]
	moe_gate_13 -> tp_split_33_13 [label="Gate selection 33" style=dashed]
	tp_split_33_13 -> expert_compute_33_0_13
	tp_split_33_13 -> expert_compute_33_1_13
	expert_compute_33_0_13 -> tp_allreduce_33_13
	expert_compute_33_1_13 -> tp_allreduce_33_13
	tp_allreduce_33_13 -> expert_33_13
	expert_33_13 -> expert_agg_13 [label="Expert 33 output"]
	moe_gate_13 -> tp_split_34_13 [label="Gate selection 34" style=dashed]
	tp_split_34_13 -> expert_compute_34_0_13
	tp_split_34_13 -> expert_compute_34_1_13
	expert_compute_34_0_13 -> tp_allreduce_34_13
	expert_compute_34_1_13 -> tp_allreduce_34_13
	tp_allreduce_34_13 -> expert_34_13
	expert_34_13 -> expert_agg_13 [label="Expert 34 output"]
	moe_gate_13 -> tp_split_35_13 [label="Gate selection 35" style=dashed]
	tp_split_35_13 -> expert_compute_35_0_13
	tp_split_35_13 -> expert_compute_35_1_13
	expert_compute_35_0_13 -> tp_allreduce_35_13
	expert_compute_35_1_13 -> tp_allreduce_35_13
	tp_allreduce_35_13 -> expert_35_13
	expert_35_13 -> expert_agg_13 [label="Expert 35 output"]
	moe_gate_13 -> tp_split_36_13 [label="Gate selection 36" style=dashed]
	tp_split_36_13 -> expert_compute_36_0_13
	tp_split_36_13 -> expert_compute_36_1_13
	expert_compute_36_0_13 -> tp_allreduce_36_13
	expert_compute_36_1_13 -> tp_allreduce_36_13
	tp_allreduce_36_13 -> expert_36_13
	expert_36_13 -> expert_agg_13 [label="Expert 36 output"]
	moe_gate_13 -> tp_split_37_13 [label="Gate selection 37" style=dashed]
	tp_split_37_13 -> expert_compute_37_0_13
	tp_split_37_13 -> expert_compute_37_1_13
	expert_compute_37_0_13 -> tp_allreduce_37_13
	expert_compute_37_1_13 -> tp_allreduce_37_13
	tp_allreduce_37_13 -> expert_37_13
	expert_37_13 -> expert_agg_13 [label="Expert 37 output"]
	moe_gate_13 -> tp_split_38_13 [label="Gate selection 38" style=dashed]
	tp_split_38_13 -> expert_compute_38_0_13
	tp_split_38_13 -> expert_compute_38_1_13
	expert_compute_38_0_13 -> tp_allreduce_38_13
	expert_compute_38_1_13 -> tp_allreduce_38_13
	tp_allreduce_38_13 -> expert_38_13
	expert_38_13 -> expert_agg_13 [label="Expert 38 output"]
	moe_gate_13 -> tp_split_39_13 [label="Gate selection 39" style=dashed]
	tp_split_39_13 -> expert_compute_39_0_13
	tp_split_39_13 -> expert_compute_39_1_13
	expert_compute_39_0_13 -> tp_allreduce_39_13
	expert_compute_39_1_13 -> tp_allreduce_39_13
	tp_allreduce_39_13 -> expert_39_13
	expert_39_13 -> expert_agg_13 [label="Expert 39 output"]
	moe_gate_13 -> tp_split_40_13 [label="Gate selection 40" style=dashed]
	tp_split_40_13 -> expert_compute_40_0_13
	tp_split_40_13 -> expert_compute_40_1_13
	expert_compute_40_0_13 -> tp_allreduce_40_13
	expert_compute_40_1_13 -> tp_allreduce_40_13
	tp_allreduce_40_13 -> expert_40_13
	expert_40_13 -> expert_agg_13 [label="Expert 40 output"]
	moe_gate_13 -> tp_split_41_13 [label="Gate selection 41" style=dashed]
	tp_split_41_13 -> expert_compute_41_0_13
	tp_split_41_13 -> expert_compute_41_1_13
	expert_compute_41_0_13 -> tp_allreduce_41_13
	expert_compute_41_1_13 -> tp_allreduce_41_13
	tp_allreduce_41_13 -> expert_41_13
	expert_41_13 -> expert_agg_13 [label="Expert 41 output"]
	moe_gate_13 -> tp_split_42_13 [label="Gate selection 42" style=dashed]
	tp_split_42_13 -> expert_compute_42_0_13
	tp_split_42_13 -> expert_compute_42_1_13
	expert_compute_42_0_13 -> tp_allreduce_42_13
	expert_compute_42_1_13 -> tp_allreduce_42_13
	tp_allreduce_42_13 -> expert_42_13
	expert_42_13 -> expert_agg_13 [label="Expert 42 output"]
	moe_gate_13 -> tp_split_43_13 [label="Gate selection 43" style=dashed]
	tp_split_43_13 -> expert_compute_43_0_13
	tp_split_43_13 -> expert_compute_43_1_13
	expert_compute_43_0_13 -> tp_allreduce_43_13
	expert_compute_43_1_13 -> tp_allreduce_43_13
	tp_allreduce_43_13 -> expert_43_13
	expert_43_13 -> expert_agg_13 [label="Expert 43 output"]
	moe_gate_13 -> tp_split_44_13 [label="Gate selection 44" style=dashed]
	tp_split_44_13 -> expert_compute_44_0_13
	tp_split_44_13 -> expert_compute_44_1_13
	expert_compute_44_0_13 -> tp_allreduce_44_13
	expert_compute_44_1_13 -> tp_allreduce_44_13
	tp_allreduce_44_13 -> expert_44_13
	expert_44_13 -> expert_agg_13 [label="Expert 44 output"]
	moe_gate_13 -> tp_split_45_13 [label="Gate selection 45" style=dashed]
	tp_split_45_13 -> expert_compute_45_0_13
	tp_split_45_13 -> expert_compute_45_1_13
	expert_compute_45_0_13 -> tp_allreduce_45_13
	expert_compute_45_1_13 -> tp_allreduce_45_13
	tp_allreduce_45_13 -> expert_45_13
	expert_45_13 -> expert_agg_13 [label="Expert 45 output"]
	moe_gate_13 -> tp_split_46_13 [label="Gate selection 46" style=dashed]
	tp_split_46_13 -> expert_compute_46_0_13
	tp_split_46_13 -> expert_compute_46_1_13
	expert_compute_46_0_13 -> tp_allreduce_46_13
	expert_compute_46_1_13 -> tp_allreduce_46_13
	tp_allreduce_46_13 -> expert_46_13
	expert_46_13 -> expert_agg_13 [label="Expert 46 output"]
	moe_gate_13 -> tp_split_47_13 [label="Gate selection 47" style=dashed]
	tp_split_47_13 -> expert_compute_47_0_13
	tp_split_47_13 -> expert_compute_47_1_13
	expert_compute_47_0_13 -> tp_allreduce_47_13
	expert_compute_47_1_13 -> tp_allreduce_47_13
	tp_allreduce_47_13 -> expert_47_13
	expert_47_13 -> expert_agg_13 [label="Expert 47 output"]
	moe_gate_13 -> tp_split_48_13 [label="Gate selection 48" style=dashed]
	tp_split_48_13 -> expert_compute_48_0_13
	tp_split_48_13 -> expert_compute_48_1_13
	expert_compute_48_0_13 -> tp_allreduce_48_13
	expert_compute_48_1_13 -> tp_allreduce_48_13
	tp_allreduce_48_13 -> expert_48_13
	expert_48_13 -> expert_agg_13 [label="Expert 48 output"]
	moe_gate_13 -> tp_split_49_13 [label="Gate selection 49" style=dashed]
	tp_split_49_13 -> expert_compute_49_0_13
	tp_split_49_13 -> expert_compute_49_1_13
	expert_compute_49_0_13 -> tp_allreduce_49_13
	expert_compute_49_1_13 -> tp_allreduce_49_13
	tp_allreduce_49_13 -> expert_49_13
	expert_49_13 -> expert_agg_13 [label="Expert 49 output"]
	moe_gate_13 -> tp_split_50_13 [label="Gate selection 50" style=dashed]
	tp_split_50_13 -> expert_compute_50_0_13
	tp_split_50_13 -> expert_compute_50_1_13
	expert_compute_50_0_13 -> tp_allreduce_50_13
	expert_compute_50_1_13 -> tp_allreduce_50_13
	tp_allreduce_50_13 -> expert_50_13
	expert_50_13 -> expert_agg_13 [label="Expert 50 output"]
	moe_gate_13 -> tp_split_51_13 [label="Gate selection 51" style=dashed]
	tp_split_51_13 -> expert_compute_51_0_13
	tp_split_51_13 -> expert_compute_51_1_13
	expert_compute_51_0_13 -> tp_allreduce_51_13
	expert_compute_51_1_13 -> tp_allreduce_51_13
	tp_allreduce_51_13 -> expert_51_13
	expert_51_13 -> expert_agg_13 [label="Expert 51 output"]
	moe_gate_13 -> tp_split_52_13 [label="Gate selection 52" style=dashed]
	tp_split_52_13 -> expert_compute_52_0_13
	tp_split_52_13 -> expert_compute_52_1_13
	expert_compute_52_0_13 -> tp_allreduce_52_13
	expert_compute_52_1_13 -> tp_allreduce_52_13
	tp_allreduce_52_13 -> expert_52_13
	expert_52_13 -> expert_agg_13 [label="Expert 52 output"]
	moe_gate_13 -> tp_split_53_13 [label="Gate selection 53" style=dashed]
	tp_split_53_13 -> expert_compute_53_0_13
	tp_split_53_13 -> expert_compute_53_1_13
	expert_compute_53_0_13 -> tp_allreduce_53_13
	expert_compute_53_1_13 -> tp_allreduce_53_13
	tp_allreduce_53_13 -> expert_53_13
	expert_53_13 -> expert_agg_13 [label="Expert 53 output"]
	moe_gate_13 -> tp_split_54_13 [label="Gate selection 54" style=dashed]
	tp_split_54_13 -> expert_compute_54_0_13
	tp_split_54_13 -> expert_compute_54_1_13
	expert_compute_54_0_13 -> tp_allreduce_54_13
	expert_compute_54_1_13 -> tp_allreduce_54_13
	tp_allreduce_54_13 -> expert_54_13
	expert_54_13 -> expert_agg_13 [label="Expert 54 output"]
	moe_gate_13 -> tp_split_55_13 [label="Gate selection 55" style=dashed]
	tp_split_55_13 -> expert_compute_55_0_13
	tp_split_55_13 -> expert_compute_55_1_13
	expert_compute_55_0_13 -> tp_allreduce_55_13
	expert_compute_55_1_13 -> tp_allreduce_55_13
	tp_allreduce_55_13 -> expert_55_13
	expert_55_13 -> expert_agg_13 [label="Expert 55 output"]
	moe_gate_13 -> tp_split_56_13 [label="Gate selection 56" style=dashed]
	tp_split_56_13 -> expert_compute_56_0_13
	tp_split_56_13 -> expert_compute_56_1_13
	expert_compute_56_0_13 -> tp_allreduce_56_13
	expert_compute_56_1_13 -> tp_allreduce_56_13
	tp_allreduce_56_13 -> expert_56_13
	expert_56_13 -> expert_agg_13 [label="Expert 56 output"]
	moe_gate_13 -> tp_split_57_13 [label="Gate selection 57" style=dashed]
	tp_split_57_13 -> expert_compute_57_0_13
	tp_split_57_13 -> expert_compute_57_1_13
	expert_compute_57_0_13 -> tp_allreduce_57_13
	expert_compute_57_1_13 -> tp_allreduce_57_13
	tp_allreduce_57_13 -> expert_57_13
	expert_57_13 -> expert_agg_13 [label="Expert 57 output"]
	moe_gate_13 -> tp_split_58_13 [label="Gate selection 58" style=dashed]
	tp_split_58_13 -> expert_compute_58_0_13
	tp_split_58_13 -> expert_compute_58_1_13
	expert_compute_58_0_13 -> tp_allreduce_58_13
	expert_compute_58_1_13 -> tp_allreduce_58_13
	tp_allreduce_58_13 -> expert_58_13
	expert_58_13 -> expert_agg_13 [label="Expert 58 output"]
	moe_gate_13 -> tp_split_59_13 [label="Gate selection 59" style=dashed]
	tp_split_59_13 -> expert_compute_59_0_13
	tp_split_59_13 -> expert_compute_59_1_13
	expert_compute_59_0_13 -> tp_allreduce_59_13
	expert_compute_59_1_13 -> tp_allreduce_59_13
	tp_allreduce_59_13 -> expert_59_13
	expert_59_13 -> expert_agg_13 [label="Expert 59 output"]
	moe_gate_13 -> tp_split_60_13 [label="Gate selection 60" style=dashed]
	tp_split_60_13 -> expert_compute_60_0_13
	tp_split_60_13 -> expert_compute_60_1_13
	expert_compute_60_0_13 -> tp_allreduce_60_13
	expert_compute_60_1_13 -> tp_allreduce_60_13
	tp_allreduce_60_13 -> expert_60_13
	expert_60_13 -> expert_agg_13 [label="Expert 60 output"]
	moe_gate_13 -> tp_split_61_13 [label="Gate selection 61" style=dashed]
	tp_split_61_13 -> expert_compute_61_0_13
	tp_split_61_13 -> expert_compute_61_1_13
	expert_compute_61_0_13 -> tp_allreduce_61_13
	expert_compute_61_1_13 -> tp_allreduce_61_13
	tp_allreduce_61_13 -> expert_61_13
	expert_61_13 -> expert_agg_13 [label="Expert 61 output"]
	moe_gate_13 -> tp_split_62_13 [label="Gate selection 62" style=dashed]
	tp_split_62_13 -> expert_compute_62_0_13
	tp_split_62_13 -> expert_compute_62_1_13
	expert_compute_62_0_13 -> tp_allreduce_62_13
	expert_compute_62_1_13 -> tp_allreduce_62_13
	tp_allreduce_62_13 -> expert_62_13
	expert_62_13 -> expert_agg_13 [label="Expert 62 output"]
	moe_gate_13 -> tp_split_63_13 [label="Gate selection 63" style=dashed]
	tp_split_63_13 -> expert_compute_63_0_13
	tp_split_63_13 -> expert_compute_63_1_13
	expert_compute_63_0_13 -> tp_allreduce_63_13
	expert_compute_63_1_13 -> tp_allreduce_63_13
	tp_allreduce_63_13 -> expert_63_13
	expert_63_13 -> expert_agg_13 [label="Expert 63 output"]
	expert_agg_13 -> layer_norm_13
	layer_norm_13 -> attn_norm_14
	attn_norm_14 -> attn_q_14
	attn_norm_14 -> attn_k_14
	attn_norm_14 -> attn_v_14
	attn_q_14 -> attn_score_14
	attn_k_14 -> attn_score_14
	attn_v_14 -> attn_out_14
	attn_score_14 -> attn_out_14
	attn_out_14 -> moe_gate_14
	moe_gate_14 -> tp_split_0_14 [label="Gate selection 0" style=dashed]
	tp_split_0_14 -> expert_compute_0_0_14
	tp_split_0_14 -> expert_compute_0_1_14
	expert_compute_0_0_14 -> tp_allreduce_0_14
	expert_compute_0_1_14 -> tp_allreduce_0_14
	tp_allreduce_0_14 -> expert_0_14
	expert_0_14 -> expert_agg_14 [label="Expert 0 output"]
	moe_gate_14 -> tp_split_1_14 [label="Gate selection 1" style=dashed]
	tp_split_1_14 -> expert_compute_1_0_14
	tp_split_1_14 -> expert_compute_1_1_14
	expert_compute_1_0_14 -> tp_allreduce_1_14
	expert_compute_1_1_14 -> tp_allreduce_1_14
	tp_allreduce_1_14 -> expert_1_14
	expert_1_14 -> expert_agg_14 [label="Expert 1 output"]
	moe_gate_14 -> tp_split_2_14 [label="Gate selection 2" style=dashed]
	tp_split_2_14 -> expert_compute_2_0_14
	tp_split_2_14 -> expert_compute_2_1_14
	expert_compute_2_0_14 -> tp_allreduce_2_14
	expert_compute_2_1_14 -> tp_allreduce_2_14
	tp_allreduce_2_14 -> expert_2_14
	expert_2_14 -> expert_agg_14 [label="Expert 2 output"]
	moe_gate_14 -> tp_split_3_14 [label="Gate selection 3" style=dashed]
	tp_split_3_14 -> expert_compute_3_0_14
	tp_split_3_14 -> expert_compute_3_1_14
	expert_compute_3_0_14 -> tp_allreduce_3_14
	expert_compute_3_1_14 -> tp_allreduce_3_14
	tp_allreduce_3_14 -> expert_3_14
	expert_3_14 -> expert_agg_14 [label="Expert 3 output"]
	moe_gate_14 -> tp_split_4_14 [label="Gate selection 4" style=dashed]
	tp_split_4_14 -> expert_compute_4_0_14
	tp_split_4_14 -> expert_compute_4_1_14
	expert_compute_4_0_14 -> tp_allreduce_4_14
	expert_compute_4_1_14 -> tp_allreduce_4_14
	tp_allreduce_4_14 -> expert_4_14
	expert_4_14 -> expert_agg_14 [label="Expert 4 output"]
	moe_gate_14 -> tp_split_5_14 [label="Gate selection 5" style=dashed]
	tp_split_5_14 -> expert_compute_5_0_14
	tp_split_5_14 -> expert_compute_5_1_14
	expert_compute_5_0_14 -> tp_allreduce_5_14
	expert_compute_5_1_14 -> tp_allreduce_5_14
	tp_allreduce_5_14 -> expert_5_14
	expert_5_14 -> expert_agg_14 [label="Expert 5 output"]
	moe_gate_14 -> tp_split_6_14 [label="Gate selection 6" style=dashed]
	tp_split_6_14 -> expert_compute_6_0_14
	tp_split_6_14 -> expert_compute_6_1_14
	expert_compute_6_0_14 -> tp_allreduce_6_14
	expert_compute_6_1_14 -> tp_allreduce_6_14
	tp_allreduce_6_14 -> expert_6_14
	expert_6_14 -> expert_agg_14 [label="Expert 6 output"]
	moe_gate_14 -> tp_split_7_14 [label="Gate selection 7" style=dashed]
	tp_split_7_14 -> expert_compute_7_0_14
	tp_split_7_14 -> expert_compute_7_1_14
	expert_compute_7_0_14 -> tp_allreduce_7_14
	expert_compute_7_1_14 -> tp_allreduce_7_14
	tp_allreduce_7_14 -> expert_7_14
	expert_7_14 -> expert_agg_14 [label="Expert 7 output"]
	moe_gate_14 -> tp_split_8_14 [label="Gate selection 8" style=dashed]
	tp_split_8_14 -> expert_compute_8_0_14
	tp_split_8_14 -> expert_compute_8_1_14
	expert_compute_8_0_14 -> tp_allreduce_8_14
	expert_compute_8_1_14 -> tp_allreduce_8_14
	tp_allreduce_8_14 -> expert_8_14
	expert_8_14 -> expert_agg_14 [label="Expert 8 output"]
	moe_gate_14 -> tp_split_9_14 [label="Gate selection 9" style=dashed]
	tp_split_9_14 -> expert_compute_9_0_14
	tp_split_9_14 -> expert_compute_9_1_14
	expert_compute_9_0_14 -> tp_allreduce_9_14
	expert_compute_9_1_14 -> tp_allreduce_9_14
	tp_allreduce_9_14 -> expert_9_14
	expert_9_14 -> expert_agg_14 [label="Expert 9 output"]
	moe_gate_14 -> tp_split_10_14 [label="Gate selection 10" style=dashed]
	tp_split_10_14 -> expert_compute_10_0_14
	tp_split_10_14 -> expert_compute_10_1_14
	expert_compute_10_0_14 -> tp_allreduce_10_14
	expert_compute_10_1_14 -> tp_allreduce_10_14
	tp_allreduce_10_14 -> expert_10_14
	expert_10_14 -> expert_agg_14 [label="Expert 10 output"]
	moe_gate_14 -> tp_split_11_14 [label="Gate selection 11" style=dashed]
	tp_split_11_14 -> expert_compute_11_0_14
	tp_split_11_14 -> expert_compute_11_1_14
	expert_compute_11_0_14 -> tp_allreduce_11_14
	expert_compute_11_1_14 -> tp_allreduce_11_14
	tp_allreduce_11_14 -> expert_11_14
	expert_11_14 -> expert_agg_14 [label="Expert 11 output"]
	moe_gate_14 -> tp_split_12_14 [label="Gate selection 12" style=dashed]
	tp_split_12_14 -> expert_compute_12_0_14
	tp_split_12_14 -> expert_compute_12_1_14
	expert_compute_12_0_14 -> tp_allreduce_12_14
	expert_compute_12_1_14 -> tp_allreduce_12_14
	tp_allreduce_12_14 -> expert_12_14
	expert_12_14 -> expert_agg_14 [label="Expert 12 output"]
	moe_gate_14 -> tp_split_13_14 [label="Gate selection 13" style=dashed]
	tp_split_13_14 -> expert_compute_13_0_14
	tp_split_13_14 -> expert_compute_13_1_14
	expert_compute_13_0_14 -> tp_allreduce_13_14
	expert_compute_13_1_14 -> tp_allreduce_13_14
	tp_allreduce_13_14 -> expert_13_14
	expert_13_14 -> expert_agg_14 [label="Expert 13 output"]
	moe_gate_14 -> tp_split_14_14 [label="Gate selection 14" style=dashed]
	tp_split_14_14 -> expert_compute_14_0_14
	tp_split_14_14 -> expert_compute_14_1_14
	expert_compute_14_0_14 -> tp_allreduce_14_14
	expert_compute_14_1_14 -> tp_allreduce_14_14
	tp_allreduce_14_14 -> expert_14_14
	expert_14_14 -> expert_agg_14 [label="Expert 14 output"]
	moe_gate_14 -> tp_split_15_14 [label="Gate selection 15" style=dashed]
	tp_split_15_14 -> expert_compute_15_0_14
	tp_split_15_14 -> expert_compute_15_1_14
	expert_compute_15_0_14 -> tp_allreduce_15_14
	expert_compute_15_1_14 -> tp_allreduce_15_14
	tp_allreduce_15_14 -> expert_15_14
	expert_15_14 -> expert_agg_14 [label="Expert 15 output"]
	moe_gate_14 -> tp_split_16_14 [label="Gate selection 16" style=dashed]
	tp_split_16_14 -> expert_compute_16_0_14
	tp_split_16_14 -> expert_compute_16_1_14
	expert_compute_16_0_14 -> tp_allreduce_16_14
	expert_compute_16_1_14 -> tp_allreduce_16_14
	tp_allreduce_16_14 -> expert_16_14
	expert_16_14 -> expert_agg_14 [label="Expert 16 output"]
	moe_gate_14 -> tp_split_17_14 [label="Gate selection 17" style=dashed]
	tp_split_17_14 -> expert_compute_17_0_14
	tp_split_17_14 -> expert_compute_17_1_14
	expert_compute_17_0_14 -> tp_allreduce_17_14
	expert_compute_17_1_14 -> tp_allreduce_17_14
	tp_allreduce_17_14 -> expert_17_14
	expert_17_14 -> expert_agg_14 [label="Expert 17 output"]
	moe_gate_14 -> tp_split_18_14 [label="Gate selection 18" style=dashed]
	tp_split_18_14 -> expert_compute_18_0_14
	tp_split_18_14 -> expert_compute_18_1_14
	expert_compute_18_0_14 -> tp_allreduce_18_14
	expert_compute_18_1_14 -> tp_allreduce_18_14
	tp_allreduce_18_14 -> expert_18_14
	expert_18_14 -> expert_agg_14 [label="Expert 18 output"]
	moe_gate_14 -> tp_split_19_14 [label="Gate selection 19" style=dashed]
	tp_split_19_14 -> expert_compute_19_0_14
	tp_split_19_14 -> expert_compute_19_1_14
	expert_compute_19_0_14 -> tp_allreduce_19_14
	expert_compute_19_1_14 -> tp_allreduce_19_14
	tp_allreduce_19_14 -> expert_19_14
	expert_19_14 -> expert_agg_14 [label="Expert 19 output"]
	moe_gate_14 -> tp_split_20_14 [label="Gate selection 20" style=dashed]
	tp_split_20_14 -> expert_compute_20_0_14
	tp_split_20_14 -> expert_compute_20_1_14
	expert_compute_20_0_14 -> tp_allreduce_20_14
	expert_compute_20_1_14 -> tp_allreduce_20_14
	tp_allreduce_20_14 -> expert_20_14
	expert_20_14 -> expert_agg_14 [label="Expert 20 output"]
	moe_gate_14 -> tp_split_21_14 [label="Gate selection 21" style=dashed]
	tp_split_21_14 -> expert_compute_21_0_14
	tp_split_21_14 -> expert_compute_21_1_14
	expert_compute_21_0_14 -> tp_allreduce_21_14
	expert_compute_21_1_14 -> tp_allreduce_21_14
	tp_allreduce_21_14 -> expert_21_14
	expert_21_14 -> expert_agg_14 [label="Expert 21 output"]
	moe_gate_14 -> tp_split_22_14 [label="Gate selection 22" style=dashed]
	tp_split_22_14 -> expert_compute_22_0_14
	tp_split_22_14 -> expert_compute_22_1_14
	expert_compute_22_0_14 -> tp_allreduce_22_14
	expert_compute_22_1_14 -> tp_allreduce_22_14
	tp_allreduce_22_14 -> expert_22_14
	expert_22_14 -> expert_agg_14 [label="Expert 22 output"]
	moe_gate_14 -> tp_split_23_14 [label="Gate selection 23" style=dashed]
	tp_split_23_14 -> expert_compute_23_0_14
	tp_split_23_14 -> expert_compute_23_1_14
	expert_compute_23_0_14 -> tp_allreduce_23_14
	expert_compute_23_1_14 -> tp_allreduce_23_14
	tp_allreduce_23_14 -> expert_23_14
	expert_23_14 -> expert_agg_14 [label="Expert 23 output"]
	moe_gate_14 -> tp_split_24_14 [label="Gate selection 24" style=dashed]
	tp_split_24_14 -> expert_compute_24_0_14
	tp_split_24_14 -> expert_compute_24_1_14
	expert_compute_24_0_14 -> tp_allreduce_24_14
	expert_compute_24_1_14 -> tp_allreduce_24_14
	tp_allreduce_24_14 -> expert_24_14
	expert_24_14 -> expert_agg_14 [label="Expert 24 output"]
	moe_gate_14 -> tp_split_25_14 [label="Gate selection 25" style=dashed]
	tp_split_25_14 -> expert_compute_25_0_14
	tp_split_25_14 -> expert_compute_25_1_14
	expert_compute_25_0_14 -> tp_allreduce_25_14
	expert_compute_25_1_14 -> tp_allreduce_25_14
	tp_allreduce_25_14 -> expert_25_14
	expert_25_14 -> expert_agg_14 [label="Expert 25 output"]
	moe_gate_14 -> tp_split_26_14 [label="Gate selection 26" style=dashed]
	tp_split_26_14 -> expert_compute_26_0_14
	tp_split_26_14 -> expert_compute_26_1_14
	expert_compute_26_0_14 -> tp_allreduce_26_14
	expert_compute_26_1_14 -> tp_allreduce_26_14
	tp_allreduce_26_14 -> expert_26_14
	expert_26_14 -> expert_agg_14 [label="Expert 26 output"]
	moe_gate_14 -> tp_split_27_14 [label="Gate selection 27" style=dashed]
	tp_split_27_14 -> expert_compute_27_0_14
	tp_split_27_14 -> expert_compute_27_1_14
	expert_compute_27_0_14 -> tp_allreduce_27_14
	expert_compute_27_1_14 -> tp_allreduce_27_14
	tp_allreduce_27_14 -> expert_27_14
	expert_27_14 -> expert_agg_14 [label="Expert 27 output"]
	moe_gate_14 -> tp_split_28_14 [label="Gate selection 28" style=dashed]
	tp_split_28_14 -> expert_compute_28_0_14
	tp_split_28_14 -> expert_compute_28_1_14
	expert_compute_28_0_14 -> tp_allreduce_28_14
	expert_compute_28_1_14 -> tp_allreduce_28_14
	tp_allreduce_28_14 -> expert_28_14
	expert_28_14 -> expert_agg_14 [label="Expert 28 output"]
	moe_gate_14 -> tp_split_29_14 [label="Gate selection 29" style=dashed]
	tp_split_29_14 -> expert_compute_29_0_14
	tp_split_29_14 -> expert_compute_29_1_14
	expert_compute_29_0_14 -> tp_allreduce_29_14
	expert_compute_29_1_14 -> tp_allreduce_29_14
	tp_allreduce_29_14 -> expert_29_14
	expert_29_14 -> expert_agg_14 [label="Expert 29 output"]
	moe_gate_14 -> tp_split_30_14 [label="Gate selection 30" style=dashed]
	tp_split_30_14 -> expert_compute_30_0_14
	tp_split_30_14 -> expert_compute_30_1_14
	expert_compute_30_0_14 -> tp_allreduce_30_14
	expert_compute_30_1_14 -> tp_allreduce_30_14
	tp_allreduce_30_14 -> expert_30_14
	expert_30_14 -> expert_agg_14 [label="Expert 30 output"]
	moe_gate_14 -> tp_split_31_14 [label="Gate selection 31" style=dashed]
	tp_split_31_14 -> expert_compute_31_0_14
	tp_split_31_14 -> expert_compute_31_1_14
	expert_compute_31_0_14 -> tp_allreduce_31_14
	expert_compute_31_1_14 -> tp_allreduce_31_14
	tp_allreduce_31_14 -> expert_31_14
	expert_31_14 -> expert_agg_14 [label="Expert 31 output"]
	moe_gate_14 -> tp_split_32_14 [label="Gate selection 32" style=dashed]
	tp_split_32_14 -> expert_compute_32_0_14
	tp_split_32_14 -> expert_compute_32_1_14
	expert_compute_32_0_14 -> tp_allreduce_32_14
	expert_compute_32_1_14 -> tp_allreduce_32_14
	tp_allreduce_32_14 -> expert_32_14
	expert_32_14 -> expert_agg_14 [label="Expert 32 output"]
	moe_gate_14 -> tp_split_33_14 [label="Gate selection 33" style=dashed]
	tp_split_33_14 -> expert_compute_33_0_14
	tp_split_33_14 -> expert_compute_33_1_14
	expert_compute_33_0_14 -> tp_allreduce_33_14
	expert_compute_33_1_14 -> tp_allreduce_33_14
	tp_allreduce_33_14 -> expert_33_14
	expert_33_14 -> expert_agg_14 [label="Expert 33 output"]
	moe_gate_14 -> tp_split_34_14 [label="Gate selection 34" style=dashed]
	tp_split_34_14 -> expert_compute_34_0_14
	tp_split_34_14 -> expert_compute_34_1_14
	expert_compute_34_0_14 -> tp_allreduce_34_14
	expert_compute_34_1_14 -> tp_allreduce_34_14
	tp_allreduce_34_14 -> expert_34_14
	expert_34_14 -> expert_agg_14 [label="Expert 34 output"]
	moe_gate_14 -> tp_split_35_14 [label="Gate selection 35" style=dashed]
	tp_split_35_14 -> expert_compute_35_0_14
	tp_split_35_14 -> expert_compute_35_1_14
	expert_compute_35_0_14 -> tp_allreduce_35_14
	expert_compute_35_1_14 -> tp_allreduce_35_14
	tp_allreduce_35_14 -> expert_35_14
	expert_35_14 -> expert_agg_14 [label="Expert 35 output"]
	moe_gate_14 -> tp_split_36_14 [label="Gate selection 36" style=dashed]
	tp_split_36_14 -> expert_compute_36_0_14
	tp_split_36_14 -> expert_compute_36_1_14
	expert_compute_36_0_14 -> tp_allreduce_36_14
	expert_compute_36_1_14 -> tp_allreduce_36_14
	tp_allreduce_36_14 -> expert_36_14
	expert_36_14 -> expert_agg_14 [label="Expert 36 output"]
	moe_gate_14 -> tp_split_37_14 [label="Gate selection 37" style=dashed]
	tp_split_37_14 -> expert_compute_37_0_14
	tp_split_37_14 -> expert_compute_37_1_14
	expert_compute_37_0_14 -> tp_allreduce_37_14
	expert_compute_37_1_14 -> tp_allreduce_37_14
	tp_allreduce_37_14 -> expert_37_14
	expert_37_14 -> expert_agg_14 [label="Expert 37 output"]
	moe_gate_14 -> tp_split_38_14 [label="Gate selection 38" style=dashed]
	tp_split_38_14 -> expert_compute_38_0_14
	tp_split_38_14 -> expert_compute_38_1_14
	expert_compute_38_0_14 -> tp_allreduce_38_14
	expert_compute_38_1_14 -> tp_allreduce_38_14
	tp_allreduce_38_14 -> expert_38_14
	expert_38_14 -> expert_agg_14 [label="Expert 38 output"]
	moe_gate_14 -> tp_split_39_14 [label="Gate selection 39" style=dashed]
	tp_split_39_14 -> expert_compute_39_0_14
	tp_split_39_14 -> expert_compute_39_1_14
	expert_compute_39_0_14 -> tp_allreduce_39_14
	expert_compute_39_1_14 -> tp_allreduce_39_14
	tp_allreduce_39_14 -> expert_39_14
	expert_39_14 -> expert_agg_14 [label="Expert 39 output"]
	moe_gate_14 -> tp_split_40_14 [label="Gate selection 40" style=dashed]
	tp_split_40_14 -> expert_compute_40_0_14
	tp_split_40_14 -> expert_compute_40_1_14
	expert_compute_40_0_14 -> tp_allreduce_40_14
	expert_compute_40_1_14 -> tp_allreduce_40_14
	tp_allreduce_40_14 -> expert_40_14
	expert_40_14 -> expert_agg_14 [label="Expert 40 output"]
	moe_gate_14 -> tp_split_41_14 [label="Gate selection 41" style=dashed]
	tp_split_41_14 -> expert_compute_41_0_14
	tp_split_41_14 -> expert_compute_41_1_14
	expert_compute_41_0_14 -> tp_allreduce_41_14
	expert_compute_41_1_14 -> tp_allreduce_41_14
	tp_allreduce_41_14 -> expert_41_14
	expert_41_14 -> expert_agg_14 [label="Expert 41 output"]
	moe_gate_14 -> tp_split_42_14 [label="Gate selection 42" style=dashed]
	tp_split_42_14 -> expert_compute_42_0_14
	tp_split_42_14 -> expert_compute_42_1_14
	expert_compute_42_0_14 -> tp_allreduce_42_14
	expert_compute_42_1_14 -> tp_allreduce_42_14
	tp_allreduce_42_14 -> expert_42_14
	expert_42_14 -> expert_agg_14 [label="Expert 42 output"]
	moe_gate_14 -> tp_split_43_14 [label="Gate selection 43" style=dashed]
	tp_split_43_14 -> expert_compute_43_0_14
	tp_split_43_14 -> expert_compute_43_1_14
	expert_compute_43_0_14 -> tp_allreduce_43_14
	expert_compute_43_1_14 -> tp_allreduce_43_14
	tp_allreduce_43_14 -> expert_43_14
	expert_43_14 -> expert_agg_14 [label="Expert 43 output"]
	moe_gate_14 -> tp_split_44_14 [label="Gate selection 44" style=dashed]
	tp_split_44_14 -> expert_compute_44_0_14
	tp_split_44_14 -> expert_compute_44_1_14
	expert_compute_44_0_14 -> tp_allreduce_44_14
	expert_compute_44_1_14 -> tp_allreduce_44_14
	tp_allreduce_44_14 -> expert_44_14
	expert_44_14 -> expert_agg_14 [label="Expert 44 output"]
	moe_gate_14 -> tp_split_45_14 [label="Gate selection 45" style=dashed]
	tp_split_45_14 -> expert_compute_45_0_14
	tp_split_45_14 -> expert_compute_45_1_14
	expert_compute_45_0_14 -> tp_allreduce_45_14
	expert_compute_45_1_14 -> tp_allreduce_45_14
	tp_allreduce_45_14 -> expert_45_14
	expert_45_14 -> expert_agg_14 [label="Expert 45 output"]
	moe_gate_14 -> tp_split_46_14 [label="Gate selection 46" style=dashed]
	tp_split_46_14 -> expert_compute_46_0_14
	tp_split_46_14 -> expert_compute_46_1_14
	expert_compute_46_0_14 -> tp_allreduce_46_14
	expert_compute_46_1_14 -> tp_allreduce_46_14
	tp_allreduce_46_14 -> expert_46_14
	expert_46_14 -> expert_agg_14 [label="Expert 46 output"]
	moe_gate_14 -> tp_split_47_14 [label="Gate selection 47" style=dashed]
	tp_split_47_14 -> expert_compute_47_0_14
	tp_split_47_14 -> expert_compute_47_1_14
	expert_compute_47_0_14 -> tp_allreduce_47_14
	expert_compute_47_1_14 -> tp_allreduce_47_14
	tp_allreduce_47_14 -> expert_47_14
	expert_47_14 -> expert_agg_14 [label="Expert 47 output"]
	moe_gate_14 -> tp_split_48_14 [label="Gate selection 48" style=dashed]
	tp_split_48_14 -> expert_compute_48_0_14
	tp_split_48_14 -> expert_compute_48_1_14
	expert_compute_48_0_14 -> tp_allreduce_48_14
	expert_compute_48_1_14 -> tp_allreduce_48_14
	tp_allreduce_48_14 -> expert_48_14
	expert_48_14 -> expert_agg_14 [label="Expert 48 output"]
	moe_gate_14 -> tp_split_49_14 [label="Gate selection 49" style=dashed]
	tp_split_49_14 -> expert_compute_49_0_14
	tp_split_49_14 -> expert_compute_49_1_14
	expert_compute_49_0_14 -> tp_allreduce_49_14
	expert_compute_49_1_14 -> tp_allreduce_49_14
	tp_allreduce_49_14 -> expert_49_14
	expert_49_14 -> expert_agg_14 [label="Expert 49 output"]
	moe_gate_14 -> tp_split_50_14 [label="Gate selection 50" style=dashed]
	tp_split_50_14 -> expert_compute_50_0_14
	tp_split_50_14 -> expert_compute_50_1_14
	expert_compute_50_0_14 -> tp_allreduce_50_14
	expert_compute_50_1_14 -> tp_allreduce_50_14
	tp_allreduce_50_14 -> expert_50_14
	expert_50_14 -> expert_agg_14 [label="Expert 50 output"]
	moe_gate_14 -> tp_split_51_14 [label="Gate selection 51" style=dashed]
	tp_split_51_14 -> expert_compute_51_0_14
	tp_split_51_14 -> expert_compute_51_1_14
	expert_compute_51_0_14 -> tp_allreduce_51_14
	expert_compute_51_1_14 -> tp_allreduce_51_14
	tp_allreduce_51_14 -> expert_51_14
	expert_51_14 -> expert_agg_14 [label="Expert 51 output"]
	moe_gate_14 -> tp_split_52_14 [label="Gate selection 52" style=dashed]
	tp_split_52_14 -> expert_compute_52_0_14
	tp_split_52_14 -> expert_compute_52_1_14
	expert_compute_52_0_14 -> tp_allreduce_52_14
	expert_compute_52_1_14 -> tp_allreduce_52_14
	tp_allreduce_52_14 -> expert_52_14
	expert_52_14 -> expert_agg_14 [label="Expert 52 output"]
	moe_gate_14 -> tp_split_53_14 [label="Gate selection 53" style=dashed]
	tp_split_53_14 -> expert_compute_53_0_14
	tp_split_53_14 -> expert_compute_53_1_14
	expert_compute_53_0_14 -> tp_allreduce_53_14
	expert_compute_53_1_14 -> tp_allreduce_53_14
	tp_allreduce_53_14 -> expert_53_14
	expert_53_14 -> expert_agg_14 [label="Expert 53 output"]
	moe_gate_14 -> tp_split_54_14 [label="Gate selection 54" style=dashed]
	tp_split_54_14 -> expert_compute_54_0_14
	tp_split_54_14 -> expert_compute_54_1_14
	expert_compute_54_0_14 -> tp_allreduce_54_14
	expert_compute_54_1_14 -> tp_allreduce_54_14
	tp_allreduce_54_14 -> expert_54_14
	expert_54_14 -> expert_agg_14 [label="Expert 54 output"]
	moe_gate_14 -> tp_split_55_14 [label="Gate selection 55" style=dashed]
	tp_split_55_14 -> expert_compute_55_0_14
	tp_split_55_14 -> expert_compute_55_1_14
	expert_compute_55_0_14 -> tp_allreduce_55_14
	expert_compute_55_1_14 -> tp_allreduce_55_14
	tp_allreduce_55_14 -> expert_55_14
	expert_55_14 -> expert_agg_14 [label="Expert 55 output"]
	moe_gate_14 -> tp_split_56_14 [label="Gate selection 56" style=dashed]
	tp_split_56_14 -> expert_compute_56_0_14
	tp_split_56_14 -> expert_compute_56_1_14
	expert_compute_56_0_14 -> tp_allreduce_56_14
	expert_compute_56_1_14 -> tp_allreduce_56_14
	tp_allreduce_56_14 -> expert_56_14
	expert_56_14 -> expert_agg_14 [label="Expert 56 output"]
	moe_gate_14 -> tp_split_57_14 [label="Gate selection 57" style=dashed]
	tp_split_57_14 -> expert_compute_57_0_14
	tp_split_57_14 -> expert_compute_57_1_14
	expert_compute_57_0_14 -> tp_allreduce_57_14
	expert_compute_57_1_14 -> tp_allreduce_57_14
	tp_allreduce_57_14 -> expert_57_14
	expert_57_14 -> expert_agg_14 [label="Expert 57 output"]
	moe_gate_14 -> tp_split_58_14 [label="Gate selection 58" style=dashed]
	tp_split_58_14 -> expert_compute_58_0_14
	tp_split_58_14 -> expert_compute_58_1_14
	expert_compute_58_0_14 -> tp_allreduce_58_14
	expert_compute_58_1_14 -> tp_allreduce_58_14
	tp_allreduce_58_14 -> expert_58_14
	expert_58_14 -> expert_agg_14 [label="Expert 58 output"]
	moe_gate_14 -> tp_split_59_14 [label="Gate selection 59" style=dashed]
	tp_split_59_14 -> expert_compute_59_0_14
	tp_split_59_14 -> expert_compute_59_1_14
	expert_compute_59_0_14 -> tp_allreduce_59_14
	expert_compute_59_1_14 -> tp_allreduce_59_14
	tp_allreduce_59_14 -> expert_59_14
	expert_59_14 -> expert_agg_14 [label="Expert 59 output"]
	moe_gate_14 -> tp_split_60_14 [label="Gate selection 60" style=dashed]
	tp_split_60_14 -> expert_compute_60_0_14
	tp_split_60_14 -> expert_compute_60_1_14
	expert_compute_60_0_14 -> tp_allreduce_60_14
	expert_compute_60_1_14 -> tp_allreduce_60_14
	tp_allreduce_60_14 -> expert_60_14
	expert_60_14 -> expert_agg_14 [label="Expert 60 output"]
	moe_gate_14 -> tp_split_61_14 [label="Gate selection 61" style=dashed]
	tp_split_61_14 -> expert_compute_61_0_14
	tp_split_61_14 -> expert_compute_61_1_14
	expert_compute_61_0_14 -> tp_allreduce_61_14
	expert_compute_61_1_14 -> tp_allreduce_61_14
	tp_allreduce_61_14 -> expert_61_14
	expert_61_14 -> expert_agg_14 [label="Expert 61 output"]
	moe_gate_14 -> tp_split_62_14 [label="Gate selection 62" style=dashed]
	tp_split_62_14 -> expert_compute_62_0_14
	tp_split_62_14 -> expert_compute_62_1_14
	expert_compute_62_0_14 -> tp_allreduce_62_14
	expert_compute_62_1_14 -> tp_allreduce_62_14
	tp_allreduce_62_14 -> expert_62_14
	expert_62_14 -> expert_agg_14 [label="Expert 62 output"]
	moe_gate_14 -> tp_split_63_14 [label="Gate selection 63" style=dashed]
	tp_split_63_14 -> expert_compute_63_0_14
	tp_split_63_14 -> expert_compute_63_1_14
	expert_compute_63_0_14 -> tp_allreduce_63_14
	expert_compute_63_1_14 -> tp_allreduce_63_14
	tp_allreduce_63_14 -> expert_63_14
	expert_63_14 -> expert_agg_14 [label="Expert 63 output"]
	expert_agg_14 -> layer_norm_14
	layer_norm_14 -> attn_norm_15
	attn_norm_15 -> attn_q_15
	attn_norm_15 -> attn_k_15
	attn_norm_15 -> attn_v_15
	attn_q_15 -> attn_score_15
	attn_k_15 -> attn_score_15
	attn_v_15 -> attn_out_15
	attn_score_15 -> attn_out_15
	attn_out_15 -> moe_gate_15
	moe_gate_15 -> tp_split_0_15 [label="Gate selection 0" style=dashed]
	tp_split_0_15 -> expert_compute_0_0_15
	tp_split_0_15 -> expert_compute_0_1_15
	expert_compute_0_0_15 -> tp_allreduce_0_15
	expert_compute_0_1_15 -> tp_allreduce_0_15
	tp_allreduce_0_15 -> expert_0_15
	expert_0_15 -> expert_agg_15 [label="Expert 0 output"]
	moe_gate_15 -> tp_split_1_15 [label="Gate selection 1" style=dashed]
	tp_split_1_15 -> expert_compute_1_0_15
	tp_split_1_15 -> expert_compute_1_1_15
	expert_compute_1_0_15 -> tp_allreduce_1_15
	expert_compute_1_1_15 -> tp_allreduce_1_15
	tp_allreduce_1_15 -> expert_1_15
	expert_1_15 -> expert_agg_15 [label="Expert 1 output"]
	moe_gate_15 -> tp_split_2_15 [label="Gate selection 2" style=dashed]
	tp_split_2_15 -> expert_compute_2_0_15
	tp_split_2_15 -> expert_compute_2_1_15
	expert_compute_2_0_15 -> tp_allreduce_2_15
	expert_compute_2_1_15 -> tp_allreduce_2_15
	tp_allreduce_2_15 -> expert_2_15
	expert_2_15 -> expert_agg_15 [label="Expert 2 output"]
	moe_gate_15 -> tp_split_3_15 [label="Gate selection 3" style=dashed]
	tp_split_3_15 -> expert_compute_3_0_15
	tp_split_3_15 -> expert_compute_3_1_15
	expert_compute_3_0_15 -> tp_allreduce_3_15
	expert_compute_3_1_15 -> tp_allreduce_3_15
	tp_allreduce_3_15 -> expert_3_15
	expert_3_15 -> expert_agg_15 [label="Expert 3 output"]
	moe_gate_15 -> tp_split_4_15 [label="Gate selection 4" style=dashed]
	tp_split_4_15 -> expert_compute_4_0_15
	tp_split_4_15 -> expert_compute_4_1_15
	expert_compute_4_0_15 -> tp_allreduce_4_15
	expert_compute_4_1_15 -> tp_allreduce_4_15
	tp_allreduce_4_15 -> expert_4_15
	expert_4_15 -> expert_agg_15 [label="Expert 4 output"]
	moe_gate_15 -> tp_split_5_15 [label="Gate selection 5" style=dashed]
	tp_split_5_15 -> expert_compute_5_0_15
	tp_split_5_15 -> expert_compute_5_1_15
	expert_compute_5_0_15 -> tp_allreduce_5_15
	expert_compute_5_1_15 -> tp_allreduce_5_15
	tp_allreduce_5_15 -> expert_5_15
	expert_5_15 -> expert_agg_15 [label="Expert 5 output"]
	moe_gate_15 -> tp_split_6_15 [label="Gate selection 6" style=dashed]
	tp_split_6_15 -> expert_compute_6_0_15
	tp_split_6_15 -> expert_compute_6_1_15
	expert_compute_6_0_15 -> tp_allreduce_6_15
	expert_compute_6_1_15 -> tp_allreduce_6_15
	tp_allreduce_6_15 -> expert_6_15
	expert_6_15 -> expert_agg_15 [label="Expert 6 output"]
	moe_gate_15 -> tp_split_7_15 [label="Gate selection 7" style=dashed]
	tp_split_7_15 -> expert_compute_7_0_15
	tp_split_7_15 -> expert_compute_7_1_15
	expert_compute_7_0_15 -> tp_allreduce_7_15
	expert_compute_7_1_15 -> tp_allreduce_7_15
	tp_allreduce_7_15 -> expert_7_15
	expert_7_15 -> expert_agg_15 [label="Expert 7 output"]
	moe_gate_15 -> tp_split_8_15 [label="Gate selection 8" style=dashed]
	tp_split_8_15 -> expert_compute_8_0_15
	tp_split_8_15 -> expert_compute_8_1_15
	expert_compute_8_0_15 -> tp_allreduce_8_15
	expert_compute_8_1_15 -> tp_allreduce_8_15
	tp_allreduce_8_15 -> expert_8_15
	expert_8_15 -> expert_agg_15 [label="Expert 8 output"]
	moe_gate_15 -> tp_split_9_15 [label="Gate selection 9" style=dashed]
	tp_split_9_15 -> expert_compute_9_0_15
	tp_split_9_15 -> expert_compute_9_1_15
	expert_compute_9_0_15 -> tp_allreduce_9_15
	expert_compute_9_1_15 -> tp_allreduce_9_15
	tp_allreduce_9_15 -> expert_9_15
	expert_9_15 -> expert_agg_15 [label="Expert 9 output"]
	moe_gate_15 -> tp_split_10_15 [label="Gate selection 10" style=dashed]
	tp_split_10_15 -> expert_compute_10_0_15
	tp_split_10_15 -> expert_compute_10_1_15
	expert_compute_10_0_15 -> tp_allreduce_10_15
	expert_compute_10_1_15 -> tp_allreduce_10_15
	tp_allreduce_10_15 -> expert_10_15
	expert_10_15 -> expert_agg_15 [label="Expert 10 output"]
	moe_gate_15 -> tp_split_11_15 [label="Gate selection 11" style=dashed]
	tp_split_11_15 -> expert_compute_11_0_15
	tp_split_11_15 -> expert_compute_11_1_15
	expert_compute_11_0_15 -> tp_allreduce_11_15
	expert_compute_11_1_15 -> tp_allreduce_11_15
	tp_allreduce_11_15 -> expert_11_15
	expert_11_15 -> expert_agg_15 [label="Expert 11 output"]
	moe_gate_15 -> tp_split_12_15 [label="Gate selection 12" style=dashed]
	tp_split_12_15 -> expert_compute_12_0_15
	tp_split_12_15 -> expert_compute_12_1_15
	expert_compute_12_0_15 -> tp_allreduce_12_15
	expert_compute_12_1_15 -> tp_allreduce_12_15
	tp_allreduce_12_15 -> expert_12_15
	expert_12_15 -> expert_agg_15 [label="Expert 12 output"]
	moe_gate_15 -> tp_split_13_15 [label="Gate selection 13" style=dashed]
	tp_split_13_15 -> expert_compute_13_0_15
	tp_split_13_15 -> expert_compute_13_1_15
	expert_compute_13_0_15 -> tp_allreduce_13_15
	expert_compute_13_1_15 -> tp_allreduce_13_15
	tp_allreduce_13_15 -> expert_13_15
	expert_13_15 -> expert_agg_15 [label="Expert 13 output"]
	moe_gate_15 -> tp_split_14_15 [label="Gate selection 14" style=dashed]
	tp_split_14_15 -> expert_compute_14_0_15
	tp_split_14_15 -> expert_compute_14_1_15
	expert_compute_14_0_15 -> tp_allreduce_14_15
	expert_compute_14_1_15 -> tp_allreduce_14_15
	tp_allreduce_14_15 -> expert_14_15
	expert_14_15 -> expert_agg_15 [label="Expert 14 output"]
	moe_gate_15 -> tp_split_15_15 [label="Gate selection 15" style=dashed]
	tp_split_15_15 -> expert_compute_15_0_15
	tp_split_15_15 -> expert_compute_15_1_15
	expert_compute_15_0_15 -> tp_allreduce_15_15
	expert_compute_15_1_15 -> tp_allreduce_15_15
	tp_allreduce_15_15 -> expert_15_15
	expert_15_15 -> expert_agg_15 [label="Expert 15 output"]
	moe_gate_15 -> tp_split_16_15 [label="Gate selection 16" style=dashed]
	tp_split_16_15 -> expert_compute_16_0_15
	tp_split_16_15 -> expert_compute_16_1_15
	expert_compute_16_0_15 -> tp_allreduce_16_15
	expert_compute_16_1_15 -> tp_allreduce_16_15
	tp_allreduce_16_15 -> expert_16_15
	expert_16_15 -> expert_agg_15 [label="Expert 16 output"]
	moe_gate_15 -> tp_split_17_15 [label="Gate selection 17" style=dashed]
	tp_split_17_15 -> expert_compute_17_0_15
	tp_split_17_15 -> expert_compute_17_1_15
	expert_compute_17_0_15 -> tp_allreduce_17_15
	expert_compute_17_1_15 -> tp_allreduce_17_15
	tp_allreduce_17_15 -> expert_17_15
	expert_17_15 -> expert_agg_15 [label="Expert 17 output"]
	moe_gate_15 -> tp_split_18_15 [label="Gate selection 18" style=dashed]
	tp_split_18_15 -> expert_compute_18_0_15
	tp_split_18_15 -> expert_compute_18_1_15
	expert_compute_18_0_15 -> tp_allreduce_18_15
	expert_compute_18_1_15 -> tp_allreduce_18_15
	tp_allreduce_18_15 -> expert_18_15
	expert_18_15 -> expert_agg_15 [label="Expert 18 output"]
	moe_gate_15 -> tp_split_19_15 [label="Gate selection 19" style=dashed]
	tp_split_19_15 -> expert_compute_19_0_15
	tp_split_19_15 -> expert_compute_19_1_15
	expert_compute_19_0_15 -> tp_allreduce_19_15
	expert_compute_19_1_15 -> tp_allreduce_19_15
	tp_allreduce_19_15 -> expert_19_15
	expert_19_15 -> expert_agg_15 [label="Expert 19 output"]
	moe_gate_15 -> tp_split_20_15 [label="Gate selection 20" style=dashed]
	tp_split_20_15 -> expert_compute_20_0_15
	tp_split_20_15 -> expert_compute_20_1_15
	expert_compute_20_0_15 -> tp_allreduce_20_15
	expert_compute_20_1_15 -> tp_allreduce_20_15
	tp_allreduce_20_15 -> expert_20_15
	expert_20_15 -> expert_agg_15 [label="Expert 20 output"]
	moe_gate_15 -> tp_split_21_15 [label="Gate selection 21" style=dashed]
	tp_split_21_15 -> expert_compute_21_0_15
	tp_split_21_15 -> expert_compute_21_1_15
	expert_compute_21_0_15 -> tp_allreduce_21_15
	expert_compute_21_1_15 -> tp_allreduce_21_15
	tp_allreduce_21_15 -> expert_21_15
	expert_21_15 -> expert_agg_15 [label="Expert 21 output"]
	moe_gate_15 -> tp_split_22_15 [label="Gate selection 22" style=dashed]
	tp_split_22_15 -> expert_compute_22_0_15
	tp_split_22_15 -> expert_compute_22_1_15
	expert_compute_22_0_15 -> tp_allreduce_22_15
	expert_compute_22_1_15 -> tp_allreduce_22_15
	tp_allreduce_22_15 -> expert_22_15
	expert_22_15 -> expert_agg_15 [label="Expert 22 output"]
	moe_gate_15 -> tp_split_23_15 [label="Gate selection 23" style=dashed]
	tp_split_23_15 -> expert_compute_23_0_15
	tp_split_23_15 -> expert_compute_23_1_15
	expert_compute_23_0_15 -> tp_allreduce_23_15
	expert_compute_23_1_15 -> tp_allreduce_23_15
	tp_allreduce_23_15 -> expert_23_15
	expert_23_15 -> expert_agg_15 [label="Expert 23 output"]
	moe_gate_15 -> tp_split_24_15 [label="Gate selection 24" style=dashed]
	tp_split_24_15 -> expert_compute_24_0_15
	tp_split_24_15 -> expert_compute_24_1_15
	expert_compute_24_0_15 -> tp_allreduce_24_15
	expert_compute_24_1_15 -> tp_allreduce_24_15
	tp_allreduce_24_15 -> expert_24_15
	expert_24_15 -> expert_agg_15 [label="Expert 24 output"]
	moe_gate_15 -> tp_split_25_15 [label="Gate selection 25" style=dashed]
	tp_split_25_15 -> expert_compute_25_0_15
	tp_split_25_15 -> expert_compute_25_1_15
	expert_compute_25_0_15 -> tp_allreduce_25_15
	expert_compute_25_1_15 -> tp_allreduce_25_15
	tp_allreduce_25_15 -> expert_25_15
	expert_25_15 -> expert_agg_15 [label="Expert 25 output"]
	moe_gate_15 -> tp_split_26_15 [label="Gate selection 26" style=dashed]
	tp_split_26_15 -> expert_compute_26_0_15
	tp_split_26_15 -> expert_compute_26_1_15
	expert_compute_26_0_15 -> tp_allreduce_26_15
	expert_compute_26_1_15 -> tp_allreduce_26_15
	tp_allreduce_26_15 -> expert_26_15
	expert_26_15 -> expert_agg_15 [label="Expert 26 output"]
	moe_gate_15 -> tp_split_27_15 [label="Gate selection 27" style=dashed]
	tp_split_27_15 -> expert_compute_27_0_15
	tp_split_27_15 -> expert_compute_27_1_15
	expert_compute_27_0_15 -> tp_allreduce_27_15
	expert_compute_27_1_15 -> tp_allreduce_27_15
	tp_allreduce_27_15 -> expert_27_15
	expert_27_15 -> expert_agg_15 [label="Expert 27 output"]
	moe_gate_15 -> tp_split_28_15 [label="Gate selection 28" style=dashed]
	tp_split_28_15 -> expert_compute_28_0_15
	tp_split_28_15 -> expert_compute_28_1_15
	expert_compute_28_0_15 -> tp_allreduce_28_15
	expert_compute_28_1_15 -> tp_allreduce_28_15
	tp_allreduce_28_15 -> expert_28_15
	expert_28_15 -> expert_agg_15 [label="Expert 28 output"]
	moe_gate_15 -> tp_split_29_15 [label="Gate selection 29" style=dashed]
	tp_split_29_15 -> expert_compute_29_0_15
	tp_split_29_15 -> expert_compute_29_1_15
	expert_compute_29_0_15 -> tp_allreduce_29_15
	expert_compute_29_1_15 -> tp_allreduce_29_15
	tp_allreduce_29_15 -> expert_29_15
	expert_29_15 -> expert_agg_15 [label="Expert 29 output"]
	moe_gate_15 -> tp_split_30_15 [label="Gate selection 30" style=dashed]
	tp_split_30_15 -> expert_compute_30_0_15
	tp_split_30_15 -> expert_compute_30_1_15
	expert_compute_30_0_15 -> tp_allreduce_30_15
	expert_compute_30_1_15 -> tp_allreduce_30_15
	tp_allreduce_30_15 -> expert_30_15
	expert_30_15 -> expert_agg_15 [label="Expert 30 output"]
	moe_gate_15 -> tp_split_31_15 [label="Gate selection 31" style=dashed]
	tp_split_31_15 -> expert_compute_31_0_15
	tp_split_31_15 -> expert_compute_31_1_15
	expert_compute_31_0_15 -> tp_allreduce_31_15
	expert_compute_31_1_15 -> tp_allreduce_31_15
	tp_allreduce_31_15 -> expert_31_15
	expert_31_15 -> expert_agg_15 [label="Expert 31 output"]
	moe_gate_15 -> tp_split_32_15 [label="Gate selection 32" style=dashed]
	tp_split_32_15 -> expert_compute_32_0_15
	tp_split_32_15 -> expert_compute_32_1_15
	expert_compute_32_0_15 -> tp_allreduce_32_15
	expert_compute_32_1_15 -> tp_allreduce_32_15
	tp_allreduce_32_15 -> expert_32_15
	expert_32_15 -> expert_agg_15 [label="Expert 32 output"]
	moe_gate_15 -> tp_split_33_15 [label="Gate selection 33" style=dashed]
	tp_split_33_15 -> expert_compute_33_0_15
	tp_split_33_15 -> expert_compute_33_1_15
	expert_compute_33_0_15 -> tp_allreduce_33_15
	expert_compute_33_1_15 -> tp_allreduce_33_15
	tp_allreduce_33_15 -> expert_33_15
	expert_33_15 -> expert_agg_15 [label="Expert 33 output"]
	moe_gate_15 -> tp_split_34_15 [label="Gate selection 34" style=dashed]
	tp_split_34_15 -> expert_compute_34_0_15
	tp_split_34_15 -> expert_compute_34_1_15
	expert_compute_34_0_15 -> tp_allreduce_34_15
	expert_compute_34_1_15 -> tp_allreduce_34_15
	tp_allreduce_34_15 -> expert_34_15
	expert_34_15 -> expert_agg_15 [label="Expert 34 output"]
	moe_gate_15 -> tp_split_35_15 [label="Gate selection 35" style=dashed]
	tp_split_35_15 -> expert_compute_35_0_15
	tp_split_35_15 -> expert_compute_35_1_15
	expert_compute_35_0_15 -> tp_allreduce_35_15
	expert_compute_35_1_15 -> tp_allreduce_35_15
	tp_allreduce_35_15 -> expert_35_15
	expert_35_15 -> expert_agg_15 [label="Expert 35 output"]
	moe_gate_15 -> tp_split_36_15 [label="Gate selection 36" style=dashed]
	tp_split_36_15 -> expert_compute_36_0_15
	tp_split_36_15 -> expert_compute_36_1_15
	expert_compute_36_0_15 -> tp_allreduce_36_15
	expert_compute_36_1_15 -> tp_allreduce_36_15
	tp_allreduce_36_15 -> expert_36_15
	expert_36_15 -> expert_agg_15 [label="Expert 36 output"]
	moe_gate_15 -> tp_split_37_15 [label="Gate selection 37" style=dashed]
	tp_split_37_15 -> expert_compute_37_0_15
	tp_split_37_15 -> expert_compute_37_1_15
	expert_compute_37_0_15 -> tp_allreduce_37_15
	expert_compute_37_1_15 -> tp_allreduce_37_15
	tp_allreduce_37_15 -> expert_37_15
	expert_37_15 -> expert_agg_15 [label="Expert 37 output"]
	moe_gate_15 -> tp_split_38_15 [label="Gate selection 38" style=dashed]
	tp_split_38_15 -> expert_compute_38_0_15
	tp_split_38_15 -> expert_compute_38_1_15
	expert_compute_38_0_15 -> tp_allreduce_38_15
	expert_compute_38_1_15 -> tp_allreduce_38_15
	tp_allreduce_38_15 -> expert_38_15
	expert_38_15 -> expert_agg_15 [label="Expert 38 output"]
	moe_gate_15 -> tp_split_39_15 [label="Gate selection 39" style=dashed]
	tp_split_39_15 -> expert_compute_39_0_15
	tp_split_39_15 -> expert_compute_39_1_15
	expert_compute_39_0_15 -> tp_allreduce_39_15
	expert_compute_39_1_15 -> tp_allreduce_39_15
	tp_allreduce_39_15 -> expert_39_15
	expert_39_15 -> expert_agg_15 [label="Expert 39 output"]
	moe_gate_15 -> tp_split_40_15 [label="Gate selection 40" style=dashed]
	tp_split_40_15 -> expert_compute_40_0_15
	tp_split_40_15 -> expert_compute_40_1_15
	expert_compute_40_0_15 -> tp_allreduce_40_15
	expert_compute_40_1_15 -> tp_allreduce_40_15
	tp_allreduce_40_15 -> expert_40_15
	expert_40_15 -> expert_agg_15 [label="Expert 40 output"]
	moe_gate_15 -> tp_split_41_15 [label="Gate selection 41" style=dashed]
	tp_split_41_15 -> expert_compute_41_0_15
	tp_split_41_15 -> expert_compute_41_1_15
	expert_compute_41_0_15 -> tp_allreduce_41_15
	expert_compute_41_1_15 -> tp_allreduce_41_15
	tp_allreduce_41_15 -> expert_41_15
	expert_41_15 -> expert_agg_15 [label="Expert 41 output"]
	moe_gate_15 -> tp_split_42_15 [label="Gate selection 42" style=dashed]
	tp_split_42_15 -> expert_compute_42_0_15
	tp_split_42_15 -> expert_compute_42_1_15
	expert_compute_42_0_15 -> tp_allreduce_42_15
	expert_compute_42_1_15 -> tp_allreduce_42_15
	tp_allreduce_42_15 -> expert_42_15
	expert_42_15 -> expert_agg_15 [label="Expert 42 output"]
	moe_gate_15 -> tp_split_43_15 [label="Gate selection 43" style=dashed]
	tp_split_43_15 -> expert_compute_43_0_15
	tp_split_43_15 -> expert_compute_43_1_15
	expert_compute_43_0_15 -> tp_allreduce_43_15
	expert_compute_43_1_15 -> tp_allreduce_43_15
	tp_allreduce_43_15 -> expert_43_15
	expert_43_15 -> expert_agg_15 [label="Expert 43 output"]
	moe_gate_15 -> tp_split_44_15 [label="Gate selection 44" style=dashed]
	tp_split_44_15 -> expert_compute_44_0_15
	tp_split_44_15 -> expert_compute_44_1_15
	expert_compute_44_0_15 -> tp_allreduce_44_15
	expert_compute_44_1_15 -> tp_allreduce_44_15
	tp_allreduce_44_15 -> expert_44_15
	expert_44_15 -> expert_agg_15 [label="Expert 44 output"]
	moe_gate_15 -> tp_split_45_15 [label="Gate selection 45" style=dashed]
	tp_split_45_15 -> expert_compute_45_0_15
	tp_split_45_15 -> expert_compute_45_1_15
	expert_compute_45_0_15 -> tp_allreduce_45_15
	expert_compute_45_1_15 -> tp_allreduce_45_15
	tp_allreduce_45_15 -> expert_45_15
	expert_45_15 -> expert_agg_15 [label="Expert 45 output"]
	moe_gate_15 -> tp_split_46_15 [label="Gate selection 46" style=dashed]
	tp_split_46_15 -> expert_compute_46_0_15
	tp_split_46_15 -> expert_compute_46_1_15
	expert_compute_46_0_15 -> tp_allreduce_46_15
	expert_compute_46_1_15 -> tp_allreduce_46_15
	tp_allreduce_46_15 -> expert_46_15
	expert_46_15 -> expert_agg_15 [label="Expert 46 output"]
	moe_gate_15 -> tp_split_47_15 [label="Gate selection 47" style=dashed]
	tp_split_47_15 -> expert_compute_47_0_15
	tp_split_47_15 -> expert_compute_47_1_15
	expert_compute_47_0_15 -> tp_allreduce_47_15
	expert_compute_47_1_15 -> tp_allreduce_47_15
	tp_allreduce_47_15 -> expert_47_15
	expert_47_15 -> expert_agg_15 [label="Expert 47 output"]
	moe_gate_15 -> tp_split_48_15 [label="Gate selection 48" style=dashed]
	tp_split_48_15 -> expert_compute_48_0_15
	tp_split_48_15 -> expert_compute_48_1_15
	expert_compute_48_0_15 -> tp_allreduce_48_15
	expert_compute_48_1_15 -> tp_allreduce_48_15
	tp_allreduce_48_15 -> expert_48_15
	expert_48_15 -> expert_agg_15 [label="Expert 48 output"]
	moe_gate_15 -> tp_split_49_15 [label="Gate selection 49" style=dashed]
	tp_split_49_15 -> expert_compute_49_0_15
	tp_split_49_15 -> expert_compute_49_1_15
	expert_compute_49_0_15 -> tp_allreduce_49_15
	expert_compute_49_1_15 -> tp_allreduce_49_15
	tp_allreduce_49_15 -> expert_49_15
	expert_49_15 -> expert_agg_15 [label="Expert 49 output"]
	moe_gate_15 -> tp_split_50_15 [label="Gate selection 50" style=dashed]
	tp_split_50_15 -> expert_compute_50_0_15
	tp_split_50_15 -> expert_compute_50_1_15
	expert_compute_50_0_15 -> tp_allreduce_50_15
	expert_compute_50_1_15 -> tp_allreduce_50_15
	tp_allreduce_50_15 -> expert_50_15
	expert_50_15 -> expert_agg_15 [label="Expert 50 output"]
	moe_gate_15 -> tp_split_51_15 [label="Gate selection 51" style=dashed]
	tp_split_51_15 -> expert_compute_51_0_15
	tp_split_51_15 -> expert_compute_51_1_15
	expert_compute_51_0_15 -> tp_allreduce_51_15
	expert_compute_51_1_15 -> tp_allreduce_51_15
	tp_allreduce_51_15 -> expert_51_15
	expert_51_15 -> expert_agg_15 [label="Expert 51 output"]
	moe_gate_15 -> tp_split_52_15 [label="Gate selection 52" style=dashed]
	tp_split_52_15 -> expert_compute_52_0_15
	tp_split_52_15 -> expert_compute_52_1_15
	expert_compute_52_0_15 -> tp_allreduce_52_15
	expert_compute_52_1_15 -> tp_allreduce_52_15
	tp_allreduce_52_15 -> expert_52_15
	expert_52_15 -> expert_agg_15 [label="Expert 52 output"]
	moe_gate_15 -> tp_split_53_15 [label="Gate selection 53" style=dashed]
	tp_split_53_15 -> expert_compute_53_0_15
	tp_split_53_15 -> expert_compute_53_1_15
	expert_compute_53_0_15 -> tp_allreduce_53_15
	expert_compute_53_1_15 -> tp_allreduce_53_15
	tp_allreduce_53_15 -> expert_53_15
	expert_53_15 -> expert_agg_15 [label="Expert 53 output"]
	moe_gate_15 -> tp_split_54_15 [label="Gate selection 54" style=dashed]
	tp_split_54_15 -> expert_compute_54_0_15
	tp_split_54_15 -> expert_compute_54_1_15
	expert_compute_54_0_15 -> tp_allreduce_54_15
	expert_compute_54_1_15 -> tp_allreduce_54_15
	tp_allreduce_54_15 -> expert_54_15
	expert_54_15 -> expert_agg_15 [label="Expert 54 output"]
	moe_gate_15 -> tp_split_55_15 [label="Gate selection 55" style=dashed]
	tp_split_55_15 -> expert_compute_55_0_15
	tp_split_55_15 -> expert_compute_55_1_15
	expert_compute_55_0_15 -> tp_allreduce_55_15
	expert_compute_55_1_15 -> tp_allreduce_55_15
	tp_allreduce_55_15 -> expert_55_15
	expert_55_15 -> expert_agg_15 [label="Expert 55 output"]
	moe_gate_15 -> tp_split_56_15 [label="Gate selection 56" style=dashed]
	tp_split_56_15 -> expert_compute_56_0_15
	tp_split_56_15 -> expert_compute_56_1_15
	expert_compute_56_0_15 -> tp_allreduce_56_15
	expert_compute_56_1_15 -> tp_allreduce_56_15
	tp_allreduce_56_15 -> expert_56_15
	expert_56_15 -> expert_agg_15 [label="Expert 56 output"]
	moe_gate_15 -> tp_split_57_15 [label="Gate selection 57" style=dashed]
	tp_split_57_15 -> expert_compute_57_0_15
	tp_split_57_15 -> expert_compute_57_1_15
	expert_compute_57_0_15 -> tp_allreduce_57_15
	expert_compute_57_1_15 -> tp_allreduce_57_15
	tp_allreduce_57_15 -> expert_57_15
	expert_57_15 -> expert_agg_15 [label="Expert 57 output"]
	moe_gate_15 -> tp_split_58_15 [label="Gate selection 58" style=dashed]
	tp_split_58_15 -> expert_compute_58_0_15
	tp_split_58_15 -> expert_compute_58_1_15
	expert_compute_58_0_15 -> tp_allreduce_58_15
	expert_compute_58_1_15 -> tp_allreduce_58_15
	tp_allreduce_58_15 -> expert_58_15
	expert_58_15 -> expert_agg_15 [label="Expert 58 output"]
	moe_gate_15 -> tp_split_59_15 [label="Gate selection 59" style=dashed]
	tp_split_59_15 -> expert_compute_59_0_15
	tp_split_59_15 -> expert_compute_59_1_15
	expert_compute_59_0_15 -> tp_allreduce_59_15
	expert_compute_59_1_15 -> tp_allreduce_59_15
	tp_allreduce_59_15 -> expert_59_15
	expert_59_15 -> expert_agg_15 [label="Expert 59 output"]
	moe_gate_15 -> tp_split_60_15 [label="Gate selection 60" style=dashed]
	tp_split_60_15 -> expert_compute_60_0_15
	tp_split_60_15 -> expert_compute_60_1_15
	expert_compute_60_0_15 -> tp_allreduce_60_15
	expert_compute_60_1_15 -> tp_allreduce_60_15
	tp_allreduce_60_15 -> expert_60_15
	expert_60_15 -> expert_agg_15 [label="Expert 60 output"]
	moe_gate_15 -> tp_split_61_15 [label="Gate selection 61" style=dashed]
	tp_split_61_15 -> expert_compute_61_0_15
	tp_split_61_15 -> expert_compute_61_1_15
	expert_compute_61_0_15 -> tp_allreduce_61_15
	expert_compute_61_1_15 -> tp_allreduce_61_15
	tp_allreduce_61_15 -> expert_61_15
	expert_61_15 -> expert_agg_15 [label="Expert 61 output"]
	moe_gate_15 -> tp_split_62_15 [label="Gate selection 62" style=dashed]
	tp_split_62_15 -> expert_compute_62_0_15
	tp_split_62_15 -> expert_compute_62_1_15
	expert_compute_62_0_15 -> tp_allreduce_62_15
	expert_compute_62_1_15 -> tp_allreduce_62_15
	tp_allreduce_62_15 -> expert_62_15
	expert_62_15 -> expert_agg_15 [label="Expert 62 output"]
	moe_gate_15 -> tp_split_63_15 [label="Gate selection 63" style=dashed]
	tp_split_63_15 -> expert_compute_63_0_15
	tp_split_63_15 -> expert_compute_63_1_15
	expert_compute_63_0_15 -> tp_allreduce_63_15
	expert_compute_63_1_15 -> tp_allreduce_63_15
	tp_allreduce_63_15 -> expert_63_15
	expert_63_15 -> expert_agg_15 [label="Expert 63 output"]
	expert_agg_15 -> layer_norm_15
	layer_norm_15 -> attn_norm_16
	attn_norm_16 -> attn_q_16
	attn_norm_16 -> attn_k_16
	attn_norm_16 -> attn_v_16
	attn_q_16 -> attn_score_16
	attn_k_16 -> attn_score_16
	attn_v_16 -> attn_out_16
	attn_score_16 -> attn_out_16
	attn_out_16 -> moe_gate_16
	moe_gate_16 -> tp_split_0_16 [label="Gate selection 0" style=dashed]
	tp_split_0_16 -> expert_compute_0_0_16
	tp_split_0_16 -> expert_compute_0_1_16
	expert_compute_0_0_16 -> tp_allreduce_0_16
	expert_compute_0_1_16 -> tp_allreduce_0_16
	tp_allreduce_0_16 -> expert_0_16
	expert_0_16 -> expert_agg_16 [label="Expert 0 output"]
	moe_gate_16 -> tp_split_1_16 [label="Gate selection 1" style=dashed]
	tp_split_1_16 -> expert_compute_1_0_16
	tp_split_1_16 -> expert_compute_1_1_16
	expert_compute_1_0_16 -> tp_allreduce_1_16
	expert_compute_1_1_16 -> tp_allreduce_1_16
	tp_allreduce_1_16 -> expert_1_16
	expert_1_16 -> expert_agg_16 [label="Expert 1 output"]
	moe_gate_16 -> tp_split_2_16 [label="Gate selection 2" style=dashed]
	tp_split_2_16 -> expert_compute_2_0_16
	tp_split_2_16 -> expert_compute_2_1_16
	expert_compute_2_0_16 -> tp_allreduce_2_16
	expert_compute_2_1_16 -> tp_allreduce_2_16
	tp_allreduce_2_16 -> expert_2_16
	expert_2_16 -> expert_agg_16 [label="Expert 2 output"]
	moe_gate_16 -> tp_split_3_16 [label="Gate selection 3" style=dashed]
	tp_split_3_16 -> expert_compute_3_0_16
	tp_split_3_16 -> expert_compute_3_1_16
	expert_compute_3_0_16 -> tp_allreduce_3_16
	expert_compute_3_1_16 -> tp_allreduce_3_16
	tp_allreduce_3_16 -> expert_3_16
	expert_3_16 -> expert_agg_16 [label="Expert 3 output"]
	moe_gate_16 -> tp_split_4_16 [label="Gate selection 4" style=dashed]
	tp_split_4_16 -> expert_compute_4_0_16
	tp_split_4_16 -> expert_compute_4_1_16
	expert_compute_4_0_16 -> tp_allreduce_4_16
	expert_compute_4_1_16 -> tp_allreduce_4_16
	tp_allreduce_4_16 -> expert_4_16
	expert_4_16 -> expert_agg_16 [label="Expert 4 output"]
	moe_gate_16 -> tp_split_5_16 [label="Gate selection 5" style=dashed]
	tp_split_5_16 -> expert_compute_5_0_16
	tp_split_5_16 -> expert_compute_5_1_16
	expert_compute_5_0_16 -> tp_allreduce_5_16
	expert_compute_5_1_16 -> tp_allreduce_5_16
	tp_allreduce_5_16 -> expert_5_16
	expert_5_16 -> expert_agg_16 [label="Expert 5 output"]
	moe_gate_16 -> tp_split_6_16 [label="Gate selection 6" style=dashed]
	tp_split_6_16 -> expert_compute_6_0_16
	tp_split_6_16 -> expert_compute_6_1_16
	expert_compute_6_0_16 -> tp_allreduce_6_16
	expert_compute_6_1_16 -> tp_allreduce_6_16
	tp_allreduce_6_16 -> expert_6_16
	expert_6_16 -> expert_agg_16 [label="Expert 6 output"]
	moe_gate_16 -> tp_split_7_16 [label="Gate selection 7" style=dashed]
	tp_split_7_16 -> expert_compute_7_0_16
	tp_split_7_16 -> expert_compute_7_1_16
	expert_compute_7_0_16 -> tp_allreduce_7_16
	expert_compute_7_1_16 -> tp_allreduce_7_16
	tp_allreduce_7_16 -> expert_7_16
	expert_7_16 -> expert_agg_16 [label="Expert 7 output"]
	moe_gate_16 -> tp_split_8_16 [label="Gate selection 8" style=dashed]
	tp_split_8_16 -> expert_compute_8_0_16
	tp_split_8_16 -> expert_compute_8_1_16
	expert_compute_8_0_16 -> tp_allreduce_8_16
	expert_compute_8_1_16 -> tp_allreduce_8_16
	tp_allreduce_8_16 -> expert_8_16
	expert_8_16 -> expert_agg_16 [label="Expert 8 output"]
	moe_gate_16 -> tp_split_9_16 [label="Gate selection 9" style=dashed]
	tp_split_9_16 -> expert_compute_9_0_16
	tp_split_9_16 -> expert_compute_9_1_16
	expert_compute_9_0_16 -> tp_allreduce_9_16
	expert_compute_9_1_16 -> tp_allreduce_9_16
	tp_allreduce_9_16 -> expert_9_16
	expert_9_16 -> expert_agg_16 [label="Expert 9 output"]
	moe_gate_16 -> tp_split_10_16 [label="Gate selection 10" style=dashed]
	tp_split_10_16 -> expert_compute_10_0_16
	tp_split_10_16 -> expert_compute_10_1_16
	expert_compute_10_0_16 -> tp_allreduce_10_16
	expert_compute_10_1_16 -> tp_allreduce_10_16
	tp_allreduce_10_16 -> expert_10_16
	expert_10_16 -> expert_agg_16 [label="Expert 10 output"]
	moe_gate_16 -> tp_split_11_16 [label="Gate selection 11" style=dashed]
	tp_split_11_16 -> expert_compute_11_0_16
	tp_split_11_16 -> expert_compute_11_1_16
	expert_compute_11_0_16 -> tp_allreduce_11_16
	expert_compute_11_1_16 -> tp_allreduce_11_16
	tp_allreduce_11_16 -> expert_11_16
	expert_11_16 -> expert_agg_16 [label="Expert 11 output"]
	moe_gate_16 -> tp_split_12_16 [label="Gate selection 12" style=dashed]
	tp_split_12_16 -> expert_compute_12_0_16
	tp_split_12_16 -> expert_compute_12_1_16
	expert_compute_12_0_16 -> tp_allreduce_12_16
	expert_compute_12_1_16 -> tp_allreduce_12_16
	tp_allreduce_12_16 -> expert_12_16
	expert_12_16 -> expert_agg_16 [label="Expert 12 output"]
	moe_gate_16 -> tp_split_13_16 [label="Gate selection 13" style=dashed]
	tp_split_13_16 -> expert_compute_13_0_16
	tp_split_13_16 -> expert_compute_13_1_16
	expert_compute_13_0_16 -> tp_allreduce_13_16
	expert_compute_13_1_16 -> tp_allreduce_13_16
	tp_allreduce_13_16 -> expert_13_16
	expert_13_16 -> expert_agg_16 [label="Expert 13 output"]
	moe_gate_16 -> tp_split_14_16 [label="Gate selection 14" style=dashed]
	tp_split_14_16 -> expert_compute_14_0_16
	tp_split_14_16 -> expert_compute_14_1_16
	expert_compute_14_0_16 -> tp_allreduce_14_16
	expert_compute_14_1_16 -> tp_allreduce_14_16
	tp_allreduce_14_16 -> expert_14_16
	expert_14_16 -> expert_agg_16 [label="Expert 14 output"]
	moe_gate_16 -> tp_split_15_16 [label="Gate selection 15" style=dashed]
	tp_split_15_16 -> expert_compute_15_0_16
	tp_split_15_16 -> expert_compute_15_1_16
	expert_compute_15_0_16 -> tp_allreduce_15_16
	expert_compute_15_1_16 -> tp_allreduce_15_16
	tp_allreduce_15_16 -> expert_15_16
	expert_15_16 -> expert_agg_16 [label="Expert 15 output"]
	moe_gate_16 -> tp_split_16_16 [label="Gate selection 16" style=dashed]
	tp_split_16_16 -> expert_compute_16_0_16
	tp_split_16_16 -> expert_compute_16_1_16
	expert_compute_16_0_16 -> tp_allreduce_16_16
	expert_compute_16_1_16 -> tp_allreduce_16_16
	tp_allreduce_16_16 -> expert_16_16
	expert_16_16 -> expert_agg_16 [label="Expert 16 output"]
	moe_gate_16 -> tp_split_17_16 [label="Gate selection 17" style=dashed]
	tp_split_17_16 -> expert_compute_17_0_16
	tp_split_17_16 -> expert_compute_17_1_16
	expert_compute_17_0_16 -> tp_allreduce_17_16
	expert_compute_17_1_16 -> tp_allreduce_17_16
	tp_allreduce_17_16 -> expert_17_16
	expert_17_16 -> expert_agg_16 [label="Expert 17 output"]
	moe_gate_16 -> tp_split_18_16 [label="Gate selection 18" style=dashed]
	tp_split_18_16 -> expert_compute_18_0_16
	tp_split_18_16 -> expert_compute_18_1_16
	expert_compute_18_0_16 -> tp_allreduce_18_16
	expert_compute_18_1_16 -> tp_allreduce_18_16
	tp_allreduce_18_16 -> expert_18_16
	expert_18_16 -> expert_agg_16 [label="Expert 18 output"]
	moe_gate_16 -> tp_split_19_16 [label="Gate selection 19" style=dashed]
	tp_split_19_16 -> expert_compute_19_0_16
	tp_split_19_16 -> expert_compute_19_1_16
	expert_compute_19_0_16 -> tp_allreduce_19_16
	expert_compute_19_1_16 -> tp_allreduce_19_16
	tp_allreduce_19_16 -> expert_19_16
	expert_19_16 -> expert_agg_16 [label="Expert 19 output"]
	moe_gate_16 -> tp_split_20_16 [label="Gate selection 20" style=dashed]
	tp_split_20_16 -> expert_compute_20_0_16
	tp_split_20_16 -> expert_compute_20_1_16
	expert_compute_20_0_16 -> tp_allreduce_20_16
	expert_compute_20_1_16 -> tp_allreduce_20_16
	tp_allreduce_20_16 -> expert_20_16
	expert_20_16 -> expert_agg_16 [label="Expert 20 output"]
	moe_gate_16 -> tp_split_21_16 [label="Gate selection 21" style=dashed]
	tp_split_21_16 -> expert_compute_21_0_16
	tp_split_21_16 -> expert_compute_21_1_16
	expert_compute_21_0_16 -> tp_allreduce_21_16
	expert_compute_21_1_16 -> tp_allreduce_21_16
	tp_allreduce_21_16 -> expert_21_16
	expert_21_16 -> expert_agg_16 [label="Expert 21 output"]
	moe_gate_16 -> tp_split_22_16 [label="Gate selection 22" style=dashed]
	tp_split_22_16 -> expert_compute_22_0_16
	tp_split_22_16 -> expert_compute_22_1_16
	expert_compute_22_0_16 -> tp_allreduce_22_16
	expert_compute_22_1_16 -> tp_allreduce_22_16
	tp_allreduce_22_16 -> expert_22_16
	expert_22_16 -> expert_agg_16 [label="Expert 22 output"]
	moe_gate_16 -> tp_split_23_16 [label="Gate selection 23" style=dashed]
	tp_split_23_16 -> expert_compute_23_0_16
	tp_split_23_16 -> expert_compute_23_1_16
	expert_compute_23_0_16 -> tp_allreduce_23_16
	expert_compute_23_1_16 -> tp_allreduce_23_16
	tp_allreduce_23_16 -> expert_23_16
	expert_23_16 -> expert_agg_16 [label="Expert 23 output"]
	moe_gate_16 -> tp_split_24_16 [label="Gate selection 24" style=dashed]
	tp_split_24_16 -> expert_compute_24_0_16
	tp_split_24_16 -> expert_compute_24_1_16
	expert_compute_24_0_16 -> tp_allreduce_24_16
	expert_compute_24_1_16 -> tp_allreduce_24_16
	tp_allreduce_24_16 -> expert_24_16
	expert_24_16 -> expert_agg_16 [label="Expert 24 output"]
	moe_gate_16 -> tp_split_25_16 [label="Gate selection 25" style=dashed]
	tp_split_25_16 -> expert_compute_25_0_16
	tp_split_25_16 -> expert_compute_25_1_16
	expert_compute_25_0_16 -> tp_allreduce_25_16
	expert_compute_25_1_16 -> tp_allreduce_25_16
	tp_allreduce_25_16 -> expert_25_16
	expert_25_16 -> expert_agg_16 [label="Expert 25 output"]
	moe_gate_16 -> tp_split_26_16 [label="Gate selection 26" style=dashed]
	tp_split_26_16 -> expert_compute_26_0_16
	tp_split_26_16 -> expert_compute_26_1_16
	expert_compute_26_0_16 -> tp_allreduce_26_16
	expert_compute_26_1_16 -> tp_allreduce_26_16
	tp_allreduce_26_16 -> expert_26_16
	expert_26_16 -> expert_agg_16 [label="Expert 26 output"]
	moe_gate_16 -> tp_split_27_16 [label="Gate selection 27" style=dashed]
	tp_split_27_16 -> expert_compute_27_0_16
	tp_split_27_16 -> expert_compute_27_1_16
	expert_compute_27_0_16 -> tp_allreduce_27_16
	expert_compute_27_1_16 -> tp_allreduce_27_16
	tp_allreduce_27_16 -> expert_27_16
	expert_27_16 -> expert_agg_16 [label="Expert 27 output"]
	moe_gate_16 -> tp_split_28_16 [label="Gate selection 28" style=dashed]
	tp_split_28_16 -> expert_compute_28_0_16
	tp_split_28_16 -> expert_compute_28_1_16
	expert_compute_28_0_16 -> tp_allreduce_28_16
	expert_compute_28_1_16 -> tp_allreduce_28_16
	tp_allreduce_28_16 -> expert_28_16
	expert_28_16 -> expert_agg_16 [label="Expert 28 output"]
	moe_gate_16 -> tp_split_29_16 [label="Gate selection 29" style=dashed]
	tp_split_29_16 -> expert_compute_29_0_16
	tp_split_29_16 -> expert_compute_29_1_16
	expert_compute_29_0_16 -> tp_allreduce_29_16
	expert_compute_29_1_16 -> tp_allreduce_29_16
	tp_allreduce_29_16 -> expert_29_16
	expert_29_16 -> expert_agg_16 [label="Expert 29 output"]
	moe_gate_16 -> tp_split_30_16 [label="Gate selection 30" style=dashed]
	tp_split_30_16 -> expert_compute_30_0_16
	tp_split_30_16 -> expert_compute_30_1_16
	expert_compute_30_0_16 -> tp_allreduce_30_16
	expert_compute_30_1_16 -> tp_allreduce_30_16
	tp_allreduce_30_16 -> expert_30_16
	expert_30_16 -> expert_agg_16 [label="Expert 30 output"]
	moe_gate_16 -> tp_split_31_16 [label="Gate selection 31" style=dashed]
	tp_split_31_16 -> expert_compute_31_0_16
	tp_split_31_16 -> expert_compute_31_1_16
	expert_compute_31_0_16 -> tp_allreduce_31_16
	expert_compute_31_1_16 -> tp_allreduce_31_16
	tp_allreduce_31_16 -> expert_31_16
	expert_31_16 -> expert_agg_16 [label="Expert 31 output"]
	moe_gate_16 -> tp_split_32_16 [label="Gate selection 32" style=dashed]
	tp_split_32_16 -> expert_compute_32_0_16
	tp_split_32_16 -> expert_compute_32_1_16
	expert_compute_32_0_16 -> tp_allreduce_32_16
	expert_compute_32_1_16 -> tp_allreduce_32_16
	tp_allreduce_32_16 -> expert_32_16
	expert_32_16 -> expert_agg_16 [label="Expert 32 output"]
	moe_gate_16 -> tp_split_33_16 [label="Gate selection 33" style=dashed]
	tp_split_33_16 -> expert_compute_33_0_16
	tp_split_33_16 -> expert_compute_33_1_16
	expert_compute_33_0_16 -> tp_allreduce_33_16
	expert_compute_33_1_16 -> tp_allreduce_33_16
	tp_allreduce_33_16 -> expert_33_16
	expert_33_16 -> expert_agg_16 [label="Expert 33 output"]
	moe_gate_16 -> tp_split_34_16 [label="Gate selection 34" style=dashed]
	tp_split_34_16 -> expert_compute_34_0_16
	tp_split_34_16 -> expert_compute_34_1_16
	expert_compute_34_0_16 -> tp_allreduce_34_16
	expert_compute_34_1_16 -> tp_allreduce_34_16
	tp_allreduce_34_16 -> expert_34_16
	expert_34_16 -> expert_agg_16 [label="Expert 34 output"]
	moe_gate_16 -> tp_split_35_16 [label="Gate selection 35" style=dashed]
	tp_split_35_16 -> expert_compute_35_0_16
	tp_split_35_16 -> expert_compute_35_1_16
	expert_compute_35_0_16 -> tp_allreduce_35_16
	expert_compute_35_1_16 -> tp_allreduce_35_16
	tp_allreduce_35_16 -> expert_35_16
	expert_35_16 -> expert_agg_16 [label="Expert 35 output"]
	moe_gate_16 -> tp_split_36_16 [label="Gate selection 36" style=dashed]
	tp_split_36_16 -> expert_compute_36_0_16
	tp_split_36_16 -> expert_compute_36_1_16
	expert_compute_36_0_16 -> tp_allreduce_36_16
	expert_compute_36_1_16 -> tp_allreduce_36_16
	tp_allreduce_36_16 -> expert_36_16
	expert_36_16 -> expert_agg_16 [label="Expert 36 output"]
	moe_gate_16 -> tp_split_37_16 [label="Gate selection 37" style=dashed]
	tp_split_37_16 -> expert_compute_37_0_16
	tp_split_37_16 -> expert_compute_37_1_16
	expert_compute_37_0_16 -> tp_allreduce_37_16
	expert_compute_37_1_16 -> tp_allreduce_37_16
	tp_allreduce_37_16 -> expert_37_16
	expert_37_16 -> expert_agg_16 [label="Expert 37 output"]
	moe_gate_16 -> tp_split_38_16 [label="Gate selection 38" style=dashed]
	tp_split_38_16 -> expert_compute_38_0_16
	tp_split_38_16 -> expert_compute_38_1_16
	expert_compute_38_0_16 -> tp_allreduce_38_16
	expert_compute_38_1_16 -> tp_allreduce_38_16
	tp_allreduce_38_16 -> expert_38_16
	expert_38_16 -> expert_agg_16 [label="Expert 38 output"]
	moe_gate_16 -> tp_split_39_16 [label="Gate selection 39" style=dashed]
	tp_split_39_16 -> expert_compute_39_0_16
	tp_split_39_16 -> expert_compute_39_1_16
	expert_compute_39_0_16 -> tp_allreduce_39_16
	expert_compute_39_1_16 -> tp_allreduce_39_16
	tp_allreduce_39_16 -> expert_39_16
	expert_39_16 -> expert_agg_16 [label="Expert 39 output"]
	moe_gate_16 -> tp_split_40_16 [label="Gate selection 40" style=dashed]
	tp_split_40_16 -> expert_compute_40_0_16
	tp_split_40_16 -> expert_compute_40_1_16
	expert_compute_40_0_16 -> tp_allreduce_40_16
	expert_compute_40_1_16 -> tp_allreduce_40_16
	tp_allreduce_40_16 -> expert_40_16
	expert_40_16 -> expert_agg_16 [label="Expert 40 output"]
	moe_gate_16 -> tp_split_41_16 [label="Gate selection 41" style=dashed]
	tp_split_41_16 -> expert_compute_41_0_16
	tp_split_41_16 -> expert_compute_41_1_16
	expert_compute_41_0_16 -> tp_allreduce_41_16
	expert_compute_41_1_16 -> tp_allreduce_41_16
	tp_allreduce_41_16 -> expert_41_16
	expert_41_16 -> expert_agg_16 [label="Expert 41 output"]
	moe_gate_16 -> tp_split_42_16 [label="Gate selection 42" style=dashed]
	tp_split_42_16 -> expert_compute_42_0_16
	tp_split_42_16 -> expert_compute_42_1_16
	expert_compute_42_0_16 -> tp_allreduce_42_16
	expert_compute_42_1_16 -> tp_allreduce_42_16
	tp_allreduce_42_16 -> expert_42_16
	expert_42_16 -> expert_agg_16 [label="Expert 42 output"]
	moe_gate_16 -> tp_split_43_16 [label="Gate selection 43" style=dashed]
	tp_split_43_16 -> expert_compute_43_0_16
	tp_split_43_16 -> expert_compute_43_1_16
	expert_compute_43_0_16 -> tp_allreduce_43_16
	expert_compute_43_1_16 -> tp_allreduce_43_16
	tp_allreduce_43_16 -> expert_43_16
	expert_43_16 -> expert_agg_16 [label="Expert 43 output"]
	moe_gate_16 -> tp_split_44_16 [label="Gate selection 44" style=dashed]
	tp_split_44_16 -> expert_compute_44_0_16
	tp_split_44_16 -> expert_compute_44_1_16
	expert_compute_44_0_16 -> tp_allreduce_44_16
	expert_compute_44_1_16 -> tp_allreduce_44_16
	tp_allreduce_44_16 -> expert_44_16
	expert_44_16 -> expert_agg_16 [label="Expert 44 output"]
	moe_gate_16 -> tp_split_45_16 [label="Gate selection 45" style=dashed]
	tp_split_45_16 -> expert_compute_45_0_16
	tp_split_45_16 -> expert_compute_45_1_16
	expert_compute_45_0_16 -> tp_allreduce_45_16
	expert_compute_45_1_16 -> tp_allreduce_45_16
	tp_allreduce_45_16 -> expert_45_16
	expert_45_16 -> expert_agg_16 [label="Expert 45 output"]
	moe_gate_16 -> tp_split_46_16 [label="Gate selection 46" style=dashed]
	tp_split_46_16 -> expert_compute_46_0_16
	tp_split_46_16 -> expert_compute_46_1_16
	expert_compute_46_0_16 -> tp_allreduce_46_16
	expert_compute_46_1_16 -> tp_allreduce_46_16
	tp_allreduce_46_16 -> expert_46_16
	expert_46_16 -> expert_agg_16 [label="Expert 46 output"]
	moe_gate_16 -> tp_split_47_16 [label="Gate selection 47" style=dashed]
	tp_split_47_16 -> expert_compute_47_0_16
	tp_split_47_16 -> expert_compute_47_1_16
	expert_compute_47_0_16 -> tp_allreduce_47_16
	expert_compute_47_1_16 -> tp_allreduce_47_16
	tp_allreduce_47_16 -> expert_47_16
	expert_47_16 -> expert_agg_16 [label="Expert 47 output"]
	moe_gate_16 -> tp_split_48_16 [label="Gate selection 48" style=dashed]
	tp_split_48_16 -> expert_compute_48_0_16
	tp_split_48_16 -> expert_compute_48_1_16
	expert_compute_48_0_16 -> tp_allreduce_48_16
	expert_compute_48_1_16 -> tp_allreduce_48_16
	tp_allreduce_48_16 -> expert_48_16
	expert_48_16 -> expert_agg_16 [label="Expert 48 output"]
	moe_gate_16 -> tp_split_49_16 [label="Gate selection 49" style=dashed]
	tp_split_49_16 -> expert_compute_49_0_16
	tp_split_49_16 -> expert_compute_49_1_16
	expert_compute_49_0_16 -> tp_allreduce_49_16
	expert_compute_49_1_16 -> tp_allreduce_49_16
	tp_allreduce_49_16 -> expert_49_16
	expert_49_16 -> expert_agg_16 [label="Expert 49 output"]
	moe_gate_16 -> tp_split_50_16 [label="Gate selection 50" style=dashed]
	tp_split_50_16 -> expert_compute_50_0_16
	tp_split_50_16 -> expert_compute_50_1_16
	expert_compute_50_0_16 -> tp_allreduce_50_16
	expert_compute_50_1_16 -> tp_allreduce_50_16
	tp_allreduce_50_16 -> expert_50_16
	expert_50_16 -> expert_agg_16 [label="Expert 50 output"]
	moe_gate_16 -> tp_split_51_16 [label="Gate selection 51" style=dashed]
	tp_split_51_16 -> expert_compute_51_0_16
	tp_split_51_16 -> expert_compute_51_1_16
	expert_compute_51_0_16 -> tp_allreduce_51_16
	expert_compute_51_1_16 -> tp_allreduce_51_16
	tp_allreduce_51_16 -> expert_51_16
	expert_51_16 -> expert_agg_16 [label="Expert 51 output"]
	moe_gate_16 -> tp_split_52_16 [label="Gate selection 52" style=dashed]
	tp_split_52_16 -> expert_compute_52_0_16
	tp_split_52_16 -> expert_compute_52_1_16
	expert_compute_52_0_16 -> tp_allreduce_52_16
	expert_compute_52_1_16 -> tp_allreduce_52_16
	tp_allreduce_52_16 -> expert_52_16
	expert_52_16 -> expert_agg_16 [label="Expert 52 output"]
	moe_gate_16 -> tp_split_53_16 [label="Gate selection 53" style=dashed]
	tp_split_53_16 -> expert_compute_53_0_16
	tp_split_53_16 -> expert_compute_53_1_16
	expert_compute_53_0_16 -> tp_allreduce_53_16
	expert_compute_53_1_16 -> tp_allreduce_53_16
	tp_allreduce_53_16 -> expert_53_16
	expert_53_16 -> expert_agg_16 [label="Expert 53 output"]
	moe_gate_16 -> tp_split_54_16 [label="Gate selection 54" style=dashed]
	tp_split_54_16 -> expert_compute_54_0_16
	tp_split_54_16 -> expert_compute_54_1_16
	expert_compute_54_0_16 -> tp_allreduce_54_16
	expert_compute_54_1_16 -> tp_allreduce_54_16
	tp_allreduce_54_16 -> expert_54_16
	expert_54_16 -> expert_agg_16 [label="Expert 54 output"]
	moe_gate_16 -> tp_split_55_16 [label="Gate selection 55" style=dashed]
	tp_split_55_16 -> expert_compute_55_0_16
	tp_split_55_16 -> expert_compute_55_1_16
	expert_compute_55_0_16 -> tp_allreduce_55_16
	expert_compute_55_1_16 -> tp_allreduce_55_16
	tp_allreduce_55_16 -> expert_55_16
	expert_55_16 -> expert_agg_16 [label="Expert 55 output"]
	moe_gate_16 -> tp_split_56_16 [label="Gate selection 56" style=dashed]
	tp_split_56_16 -> expert_compute_56_0_16
	tp_split_56_16 -> expert_compute_56_1_16
	expert_compute_56_0_16 -> tp_allreduce_56_16
	expert_compute_56_1_16 -> tp_allreduce_56_16
	tp_allreduce_56_16 -> expert_56_16
	expert_56_16 -> expert_agg_16 [label="Expert 56 output"]
	moe_gate_16 -> tp_split_57_16 [label="Gate selection 57" style=dashed]
	tp_split_57_16 -> expert_compute_57_0_16
	tp_split_57_16 -> expert_compute_57_1_16
	expert_compute_57_0_16 -> tp_allreduce_57_16
	expert_compute_57_1_16 -> tp_allreduce_57_16
	tp_allreduce_57_16 -> expert_57_16
	expert_57_16 -> expert_agg_16 [label="Expert 57 output"]
	moe_gate_16 -> tp_split_58_16 [label="Gate selection 58" style=dashed]
	tp_split_58_16 -> expert_compute_58_0_16
	tp_split_58_16 -> expert_compute_58_1_16
	expert_compute_58_0_16 -> tp_allreduce_58_16
	expert_compute_58_1_16 -> tp_allreduce_58_16
	tp_allreduce_58_16 -> expert_58_16
	expert_58_16 -> expert_agg_16 [label="Expert 58 output"]
	moe_gate_16 -> tp_split_59_16 [label="Gate selection 59" style=dashed]
	tp_split_59_16 -> expert_compute_59_0_16
	tp_split_59_16 -> expert_compute_59_1_16
	expert_compute_59_0_16 -> tp_allreduce_59_16
	expert_compute_59_1_16 -> tp_allreduce_59_16
	tp_allreduce_59_16 -> expert_59_16
	expert_59_16 -> expert_agg_16 [label="Expert 59 output"]
	moe_gate_16 -> tp_split_60_16 [label="Gate selection 60" style=dashed]
	tp_split_60_16 -> expert_compute_60_0_16
	tp_split_60_16 -> expert_compute_60_1_16
	expert_compute_60_0_16 -> tp_allreduce_60_16
	expert_compute_60_1_16 -> tp_allreduce_60_16
	tp_allreduce_60_16 -> expert_60_16
	expert_60_16 -> expert_agg_16 [label="Expert 60 output"]
	moe_gate_16 -> tp_split_61_16 [label="Gate selection 61" style=dashed]
	tp_split_61_16 -> expert_compute_61_0_16
	tp_split_61_16 -> expert_compute_61_1_16
	expert_compute_61_0_16 -> tp_allreduce_61_16
	expert_compute_61_1_16 -> tp_allreduce_61_16
	tp_allreduce_61_16 -> expert_61_16
	expert_61_16 -> expert_agg_16 [label="Expert 61 output"]
	moe_gate_16 -> tp_split_62_16 [label="Gate selection 62" style=dashed]
	tp_split_62_16 -> expert_compute_62_0_16
	tp_split_62_16 -> expert_compute_62_1_16
	expert_compute_62_0_16 -> tp_allreduce_62_16
	expert_compute_62_1_16 -> tp_allreduce_62_16
	tp_allreduce_62_16 -> expert_62_16
	expert_62_16 -> expert_agg_16 [label="Expert 62 output"]
	moe_gate_16 -> tp_split_63_16 [label="Gate selection 63" style=dashed]
	tp_split_63_16 -> expert_compute_63_0_16
	tp_split_63_16 -> expert_compute_63_1_16
	expert_compute_63_0_16 -> tp_allreduce_63_16
	expert_compute_63_1_16 -> tp_allreduce_63_16
	tp_allreduce_63_16 -> expert_63_16
	expert_63_16 -> expert_agg_16 [label="Expert 63 output"]
	expert_agg_16 -> layer_norm_16
	layer_norm_16 -> output_norm
	output_norm -> output_proj
	output_proj -> output
}
